(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[9015],{30389:function(J,b,e){"use strict";e.d(b,{Z:function(){return T}});var _=e(62029),K=e(20228),O=e(11382),C=e(12924),i=e.n(C),m=e(91768),B=e(80991),p={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},x=e(62615),R=e(52670);class Z extends i().Component{render(){var s=this.props,t=s.values,l=s.mode,c=s.onlyChooseDept,n=s.reserveUser,v=s.t,h=s.orgProps,g=s.rangeAuth,f=s.projectId,N=s.onCancel,j=s.onlyCreateUser;return i().createElement(B.l0,{className:"cl-form"},i().createElement(B.gN,(0,_.Z)({component:x.ww,displayType:"Custom",showSectitle:!1,name:"employeeRange",label:v("common.visibleRange"),defaultFieldList:t.employeeRange,validate:R.FI,mode:l,rangeAuth:g,onlyChooseDept:c,onlyCreateUser:j,orgProps:h,reserveUser:n,projectId:f,onCancel:N,qwTicketShow:!0},p)))}}var W=(0,m.Z)()(Z),A=e(18329),z=e(34773);class $ extends i().Component{constructor(){super(...arguments);this.initRefFormik=s=>{this.refFormik=s},this.handleBeforeCreate=()=>{var s=this.refFormik;s.submitForm(),s.runValidations().then(t=>{if(!Object.keys(t).length){var l=s.state.values.employeeRange,c=(0,z.b)(l.rangeList),n={qyWeChatVo:l.qyWeChatVo,id:this.props.actionId,isAll:l.rangeType,groupIds:l.rangeType===2?c.groupIds.join(","):"",departmentIds:l.rangeType===2?c.deptIds.join(","):"",userIds:l.rangeType===2?c.userIds.join(","):"",postIds:l.rangeType===2?c.postIds.join(","):"",clusterIds:l.rangeType===2?c.clusterIds.join(","):"",qy_we_chat_vo:l.qyWeChatVo};this.props.onCreate(n)}})},this.handleBeforeCancel=()=>{var s=this.props.onCancel;s()}}render(){var s=this.props,t=s.visible,l=s.initialParams,c=s.isLoading,n=s.tipInfo,v=s.mode,h=s.onlyChooseDept,g=s.reserveUser,f=g===void 0?[]:g,N=s.t,j=s.title,y=s.orgProps,S=s.rangeAuth,I=s.projectId,D=s.onCancel,F=s.onlyCreateUser,M=s.size;return c?i().createElement(O.Z,{size:"large"}):i().createElement(A.ZP,{wrapClassName:"cl-employee-selector-modal",visible:t,title:j||N("component.changeUser"),okText:N("common.ok"),cancelText:N("common.cancel"),size:M,onCancel:this.handleBeforeCancel,onOk:this.handleBeforeCreate},c?i().createElement(O.Z,{size:"large"}):i().createElement(B.J9,{ref:this.initRefFormik,initialValues:l,render:w=>i().createElement(W,(0,_.Z)({},w,{mode:v,rangeAuth:S,orgProps:y,onlyChooseDept:h,onlyCreateUser:F,reserveUser:f,projectId:I,onCancel:D}))}),n&&i().createElement("p",{style:{padding:"0 24px",wordBreak:"break-all",whiteSpace:"normal"}},n))}}$.defaultProps={visible:!1,initialParams:{employeeRange:{rangeType:1,rangeList:{dept:[],post:[],group:[],user:[],cluster:[]}}},tipInfo:"",isLoading:!1,mode:["all","part"],onlyChooseDept:!1,onlyCreateUser:!1,orgProps:{},onCancel:()=>{},onCreate:()=>{},size:"middle"};var T=(0,m.Z)()($)},63848:function(J,b,e){"use strict";var _=e(36877),K=e(32969),O=e(12924),C=e.n(O),i=e(91768),m=e(56130);class B extends C().PureComponent{constructor(){super(...arguments);this.onChange=(x,R)=>{this.props.onChange(x,R)}}render(){var x=this.props,R=x.value,Z=x.classify,W=x.showLabel,A=x.className,z=x.t,$=x.style;return C().createElement("div",{className:"classify-cascader ".concat(A)},W?C().createElement("span",{className:"classify-cascader-label"},z("component.selectClassifyLabel")):null,C().createElement(K.Z,{changeOnSelect:this.props.changeOnSelect,className:"classify-cascader-select ".concat(A),options:Z,onChange:this.onChange,placeholder:z("component.selectClassifyLabel"),value:R,style:$,loadData:this.props.loadData}))}}B.defaultProps={showLabel:!0,changeOnSelect:!0,onChange:()=>{}},b.Z=(0,m.Z)((0,i.Z)()(B))},51697:function(J,b,e){"use strict";var _=e(22385),K=e(31097),O=e(33565),C=e(12924),i=e.n(C),m=e(28216),B=e(84874),p=R=>{var Z=R.title,W=R.visible,A=R.placement,z=A===void 0?"top":A,$=R.children,T=$===void 0?null:$,V=R.isNewUser,s=V===void 0?"":V,t=R.closeGuide,l=R.guideStatus,c=(0,C.useState)(!1),n=(0,O.Z)(c,2),v=n[0],h=n[1],g=j=>i().createElement("div",{className:"guide-tooltip-title"},j,i().createElement("span",{onClick:f},i().createElement(B.Z,{iconClass:"icon-f-close",size:"12px",color:"#fff"})));(0,C.useEffect)(()=>{h(W)},[W]);var f=j=>{if(j.stopPropagation(),j.preventDefault(),h(!1),t){t();return}s==="true"&&R.dispatch({type:"shouldRenderHeaderGuide",payload:{headerGuideStatus:!0}}),N()},N=()=>{localStorage.setItem("guideStatus","false"),R.dispatch({type:"updateGuideStatus",payload:{guideStatus:"false"}})};return i().createElement(K.Z,{title:g(Z),placement:z,visible:v&&l==="true"&&Z},T)},x=R=>({guideStatus:R.advancedSetting.guideStatus,isNewUser:R.advancedSetting.isNewUser});b.Z=(0,m.$j)(x)(p)},54792:function(J,b,e){"use strict";var _=e(62029),K=e(63185),O=e(9676),C=e(47673),i=e(4107),m=e(88986),B=e(12924),p=e.n(B),x=e(91768),R=e(59239),Z=e(55446),W=e.n(Z),A=e(18329),z=e(2396);class $ extends p().Component{constructor(){super(...arguments);this.state={isChecked:!1},this.handleBeforeCreate=()=>{var s=this.props,t=s.form,l=s.id,c=s.onCreate,n=this.state.isChecked;t.validateFields((v,h)=>{if(!v){var g=(0,m.Z)({},h);n||(g.value=0);var f=(0,m.Z)((0,m.Z)({},g),{},{id:l});c(f),setTimeout(()=>{t.resetFields()},100)}})},this.handleBeforeCancel=()=>{var s=this.props,t=s.form,l=s.onCancel;l(),setTimeout(()=>{t.resetFields()},100)},this.checkScore=(s,t,l)=>{var c=this.props.t,n=this.state.isChecked;if(n&&(0,z.kh)(t)){l(c("component.setScoreRuleTip"));return}l()},this.handleCheckChange=s=>{this.setState({isChecked:s.target.checked})},this.renderItem=()=>{var s=this.props,t=s.form,l=s.initialValue,c=s.labelTxt,n=this.state.isChecked,v=t.getFieldDecorator,h={labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:18}}},g=n?v("value",{initialValue:l,rules:[{validator:this.checkScore}]})(p().createElement(i.Z,{maxLength:30,placeholder:""})):null,f=p().createElement(p().Fragment,null,p().createElement(O.Z,{checked:n,onChange:this.handleCheckChange},c));return p().createElement(R.Z.Item,(0,_.Z)({label:f},h),g)}}componentDidUpdate(s){this.props.visible&&this.props.visible!==s.visible&&this.setState({isChecked:!!this.props.initialValue})}render(){var s=this.props,t=s.visible,l=s.title,c=s.prefixCls;return p().createElement(A.ZP,{size:"small",visible:t,title:l,onCancel:this.handleBeforeCancel,onOk:this.handleBeforeCreate},p().createElement(R.Z,{className:"".concat(c),layout:"horizontal",colon:!1},this.renderItem(),p().createElement("div",{className:"".concat(c,"__children")},this.props.children)))}}$.defaultProps={prefixCls:"cl-setscore",id:"",visible:!1,title:"SetScore",labelTxt:"",initialValue:"",onCancel:()=>{},onCreate:()=>{}};var T=R.Z.create({name:"ClSetupBoxInModal"})($);b.Z=(0,x.Z)()(T)},11449:function(J,b,e){"use strict";e.d(b,{Z:function(){return j}});var _=e(88986),K=e(33565),O=e(12924),C=e.n(O),i=e(3115),m=e(49111),B=e(19650),p=e(62029),x=e(57663),R=e(71577),Z=e(91768),W=e(28216),A=e(37055),z=e(10237);function $(y){var S=A.ZP.getHelpContentByMenuKey(),I={key:y};return z.WY.get({url:S,params:I})}var T=e(74228),V=e.n(T),s=e(1164),t=e(76466),l=e(38642);class c extends C().Component{constructor(S){var I;super(S);I=this,this.getHelpContentByMenuKey=()=>{var D=this.props.defaultMenuKey;$(D).then(F=>{var M=F.data,w=M.help_url,H=M.video_url;this.setState({videoUrl:H,helpUrl:w})})},this.handleOpenHelpUrl=D=>{if((0,l.ve)()){window.open(D,"_blank");return}s.Z.targetTo({path:D,isExternalLink:!0})},this.handleOpenVideo=function(D){var F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:I.props.t("helpCenter.video");I.setState(M=>({resourcePlayInfo:(0,_.Z)((0,_.Z)({},M.resourcePlayInfo),{},{resourceInfo:{originUrl:D,source:{FD:D,OD:D},contentType:"mp4"}}),previewInfo:(0,_.Z)((0,_.Z)({},M.previewInfo),{},{title:F,visible:!0,onCancel:I.handleCancelPreview})}))},this.handleCancelPreview=()=>{var D=this.state.previewInfo;this.setState({resourcePlayInfo:{mode:"preview",watchType:"video",resourceInfo:{}},previewInfo:(0,_.Z)((0,_.Z)({},D),{},{visible:!1})})},this.state={helpUrl:"",videoUrl:"",resourcePlayInfo:{autoPlay:!0,draggable:!0,mode:"preview",resourceInfo:{},watchType:"video"},previewInfo:{visible:!1,destroyOnClose:!0,title:S.t("helpCenter.video")||"\u89C6\u9891\u6307\u5BFC",onCancel:()=>{}}}}componentDidMount(){this.getHelpContentByMenuKey()}render(){var S=this.state,I=S.helpUrl,D=S.resourcePlayInfo,F=S.previewInfo,M=S.videoUrl,w=this.props.t;return C().createElement("div",{className:V().helpCenter},M&&C().createElement(R.Z,{type:"link",className:V()["video-btn"],style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenVideo(M)},w("helpCenter.video")),I&&C().createElement(R.Z,{type:"link",style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenHelpUrl(I)},w("helpCenter.tutorial")),C().createElement(t.Z,(0,p.Z)({},D,{previewInfo:F})))}}var n=y=>({defaultMenuKey:y.currentRoute.menuKey});c.defaultProps={defaultMenuKey:""};var v=(0,W.$j)(n)((0,Z.Z)()(c));function h(y){var S=y.extra,I=localStorage.getItem("dingPersonnel"),D=sessionStorage.getItem("dingPersonnel");return C().createElement(B.Z,null,S,I!=="dingPersonnel"&&D!=="dingPersonnel"&&(0,l.eY)("COMMONEXTRA_HELP_CENTER")&&C().createElement(v,null))}var g=h,f=e(4408);function N(y){var S=(0,O.useState)({helpCenter:(0,l.eY)("HEAD_HELP_CENTER_BUT")}),I=(0,K.Z)(S,1),D=I[0],F=y.pageContainerParams,M=F===void 0?{}:F,w=y.noPadding,H=w===void 0?!1:w,Q=y.isPersonal,q=Q===void 0?!1:Q,Y=y.pageTitle,X=y.className,se=X===void 0?"":X,o={extra:D.helpCenter?C().createElement(g,{extra:M.extra}):M.extra},a=(0,_.Z)((0,_.Z)({},M),o);return C().createElement("div",{className:"page-container-content ".concat(H?"page-container-noPadding":""," ").concat(q?"page-container-content_personal_background":""," ").concat(se)},Y&&C().createElement(f.Z,{title:Y}),q?C().createElement(i.Z,null,y.children):C().createElement(i.Z,a,y.children))}var j=N},88329:function(J,b,e){"use strict";e.r(b),e.d(b,{default:function(){return se}});var _=e(34792),K=e(48086),O=e(88986),C=e(12924),i=e.n(C),m=e(91768),B=e(28216),p=e(57068),x=e(76651),R=e(11449),Z=e(10237),W=e(37055),A=e(86726),z=e(4408),$=e(62117),T=e(72456),V=e(14781),s=e(53431),t=e(62029),l=e(59250),c=e(13013),n=e(30887),v=e(99210),h=e(22385),g=e(31097),f=e(71194),N=e(57016),j=e(77576),y=e(59314),S=e(57119),I=e(57254),D=e(36202),F=e(1164),M=e(6793),w=o=>{var a=o.advancedSetting;return{themeColor:a.themeColor}};class H extends i().Component{constructor(){super(...arguments);this.state={},this.columns=[{title:this.props.t("authentication.jobMapName"),dataIndex:"name",key:"name"},{title:this.props.t("authentication.numberOfLevels"),dataIndex:"checkpoint_total_count",key:"checkpoint_total_count",width:100},{title:this.props.t("authentication.participatingEmployees"),dataIndex:"user_count",key:"user_count",width:100},{title:this.props.t("common.createTime"),dataIndex:"create_time",key:"create_time",width:164,render:(a,r)=>{var d=r.create_time;return(0,M.p6)(d)}},{title:this.props.t("common.creator"),width:106,dataIndex:"create_user_name",key:"create_user_name"},{title:this.props.t("common.status"),dataIndex:"status",key:"status",width:100,render:(a,r)=>i().createElement(y.Z,{checkedChildren:this.props.t("common.activatedStred"),unCheckedChildren:this.props.t("common.deactivatedStr"),checked:r.status==="open",onChange:d=>this.props.onUpdateStatus({isChecked:d,record:r})})},{title:this.props.t("common.operate"),width:110,key:"operate",render:a=>this.renderActions({record:a}),onCell:()=>({style:{minWidth:110}})}],this.handleTableChange=(a,r)=>{this.props.onTableChange({current:a,pageSize:r})},this.handleMenuClick=(a,r)=>{var d=this.props.t;a==="delete"&&N.Z.confirm({icon:i().createElement(S.Z,null),content:this.props.t("authentication.deletePostMapTip"),cancelText:d("common.cancel"),okText:d("common.ok"),onOk:()=>{this.props.handleDelete(r.id)}})},this.renderActions=a=>{var r=a.record,d=this.props,E=d.showRenderDeleteBtn,u=d.t,P=r.status,L=i().createElement(v.Z,{onClick:G=>{var U=G.key;return this.handleMenuClick(U,r)}},i().createElement(v.Z.Item,{key:"edit",disabled:r.status===1},P==="open"?i().createElement(g.Z,{title:this.props.t("lecturerPage.editTip"),placement:"topRight"},i().createElement("span",{className:"cl-pointer cl-disabled"},this.props.t("common.edit"))):i().createElement(F.Z,{to:"/training/authentication/postMap/detail?id=".concat(r.id)},i().createElement("span",{className:"cl-pointer"},this.props.t("common.edit")))),E?i().createElement(v.Z.Item,{key:"delete"},i().createElement("span",{className:"cl-pointer"},u("common.delete"))):null);return i().createElement("div",{className:"cl-table__cell-action"},i().createElement(F.Z,{to:"/training/authentication/postMap/monitor?id=".concat(r.id,"&postMapName=").concat(encodeURIComponent(r.name))},i().createElement("span",{className:"cl-pointer"},this.props.t("common.monitor"))),i().createElement("span",{className:"cl-pointer-divide"}),i().createElement(c.Z,{overlay:L},i().createElement("span",{className:"cl-pointer"},this.props.t("common.more")," ",i().createElement(I.Z,null))))}}render(){var a=this.props,r=a.prefixCls,d=a.list,E=d===void 0?[]:d,u=a.loading,P=a.paginationParams,L=P===void 0?{}:P,G=a.headerTitle,U=a.toolBarRender,k=(0,O.Z)((0,O.Z)({},W.XE.INITIAL_PAGINATION),L);return i().createElement("section",{className:r},i().createElement("div",{className:"postMap-content-list"},i().createElement(D.f,{columns:this.columns,rowKey:"id",dataSource:E,pagination:!1,loading:u,headerTitle:G,toolBarRender:U,tableUUID:"f710be09-12e1-41d9-85ac-d22bb6cd3025"})),i().createElement("div",{className:"postMap-pagination-wrapper"},i().createElement(s.Z,(0,t.Z)({},k,{onChange:this.handleTableChange,className:"postMap-pagination"}))))}}H.defaultProps={prefixCls:"postMap-list-page__content__table"};var Q=(0,B.$j)(w)((0,m.Z)()(H)),q=o=>({userInfo:o.user}),Y={getTableList:W.ZP.PostMapList.getTableList,updateStatus:W.ZP.PostMapList.updateStatus,delete:W.ZP.PostMapList.delete};class X extends i().Component{constructor(){super(...arguments);this.state={allowActions:(0,A.V9)("postMap",this.props.userInfo.modules),params:{status:"",keyword:"",page_number:1,page_size:20,only_see_me:!1},radioList:[{name:this.props.t("common.all"),value:""},{name:this.props.t("common.activated"),value:"open"},{name:this.props.t("common.deactivated"),value:"close"}],tableLoading:!0,tableList:[],tableTotal:0,popOverProps:[{typeText:this.props.t("authentication.jobMap"),contentText:this.props.t("newUserGuidance.createPostMapIntro"),buttonText:this.props.t("lecturerPage.know")}]},this.initData=()=>{this.initTableList()},this.initTableList=()=>{this.setState({tableLoading:!0}),Z.WY.get({url:Y.getTableList(),params:this.state.params}).then(a=>{setTimeout(()=>{this.setState({tableLoading:!1,tableList:a.data.list,tableTotal:a.data.total})},300)})},this.handleQueryRowRadiosChange=a=>{this.resetPagination().then(()=>{this.setState(r=>({params:(0,O.Z)((0,O.Z)({},r.params),{},{status:a})}),()=>{this.initTableList()})})},this.handleQueryRowSearch=a=>{this.resetPagination().then(()=>{this.setState(r=>({params:(0,O.Z)((0,O.Z)({},r.params),{},{keyword:a})}),()=>{this.initTableList()})})},this.handleChangePagination=a=>{var r=a.current,d=a.pageSize;this.setState(E=>({params:(0,O.Z)((0,O.Z)({},E.params),{},{page_number:r,page_size:d})}),()=>{this.initTableList()})},this.handleUpdateStatus=a=>{var r=a.isChecked,d=a.record;Z.WY.post({url:Y.updateStatus({mapId:d.id}),data:{status:r?"open":"close"}}).then(()=>{K.default.success("".concat(r?"\u5F00\u542F":"\u505C\u7528","\u6210\u529F")),this.resetPagination().then(()=>{this.initTableList()})})},this.resetPagination=()=>new Promise(a=>{this.setState(r=>({params:(0,O.Z)((0,O.Z)({},r.params),{},{page_number:1,page_size:20})}),()=>{a()})}),this.handleRowDelete=a=>{Z.WY.post({url:Y.delete(a)}).then(r=>{var d=r.data,E=d.code,u=d.msg;E===200?K.default.success(this.props.t("personal.removeSuccess")):K.default.warning(u),this.initTableList()})},this.changeOnlySeeMe=a=>{var r=this.state.params,d=a;this.setState({params:(0,O.Z)((0,O.Z)({},r),{},{page_number:1,only_see_me:d})},()=>{this.initTableList()})},this.renderLeftRow=()=>{var a=this.state,r=a.allowActions,d=a.popOverProps,E=p.parse(x.m8.location.search),u=E.renderGuide,P=u===void 0?!1:u;return i().createElement(T.Z,{showBtn:(0,A.H3)("add",r),actionText:this.props.t("authentication.jobMap"),tabLink:"/training/authentication/postMap/detail",popOverProps:d,renderGuide:P})},this.renderRightRow=()=>{var a=this.state.radioList;return i().createElement($.Z,{showCheckbox:!0,onCheckboxChange:this.changeOnlySeeMe,radioList:a,onRadiosChange:this.handleQueryRowRadiosChange,onSearch:this.handleQueryRowSearch})}}componentDidMount(){this.initData()}render(){var a=this.props.prefixCls,r=this.state,d=r.tableTotal,E=r.tableList,u=r.tableLoading,P=r.params,L=r.allowActions,G={total:d,current:P.page_number,pageSize:P.page_size};return i().createElement(R.Z,{pageContainerParams:{header:{title:this.props.t("leftMenuLists.jobMap")}}},i().createElement(z.Z,{title:this.props.t("documentTitle.jobMapManagement")}),i().createElement("div",{className:a},i().createElement("div",{className:"".concat(a,"__content"),ref:U=>this.tableRef=U},i().createElement(Q,{showRenderDeleteBtn:(0,A.H3)("delete",L),loading:u,paginationParams:G,list:E,handleDelete:this.handleRowDelete,onTableChange:this.handleChangePagination,onUpdateStatus:this.handleUpdateStatus,headerTitle:this.renderLeftRow(),toolBarRender:this.renderRightRow}))))}}X.defaultProps={prefixCls:"postMap-list-page sticky-table"};var se=(0,B.$j)(q)((0,m.Z)()(X))},72456:function(J,b,e){"use strict";var _=e(49111),K=e(19650),O=e(57663),C=e(71577),i=e(12924),m=e.n(i),B=e(28216),p=e(91768),x=e(84391),R=e(90631),Z=e(49101),W=e(76651),A=e(31945),z=e(1164),$=e(51697),T=s=>{var t=s.user,l=s.currentRoute,c=s.advancedSetting;return{currentPath:l.path,allAuthRoutes:l.allAuthRoutes,userLng:t.lng,themeColor:c.themeColor,qyShield:t.qyShield}};class V extends m().Component{constructor(){super(...arguments);this.handleDownload=()=>{this.props.onDownload()},this.handleImport=()=>{this.props.onImport()},this.handleCreate=()=>{var t=this.props.tabLink;W.m8.push(t)},this.renderActionBtn=()=>{var t=this.props,l=t.prefixCls,c=t.actionText,n=t.t,v=t.tabLink,h=t.showBtn,g=t.renderActionBtn,f=t.newPage,N=t.popOverProps,j=N===void 0?[]:N,y=t.renderGuide,S=y===void 0?!1:y,I=t.showDownloadBtn,D=I===void 0?!1:I,F=t.showImportBtn,M=F===void 0?!1:F,w=t.showCreateBtn,H=w===void 0?!0:w,Q=t.rowReverse,q=Q===void 0?!1:Q,Y="".concat(l,"__action");if(!h&&g&&typeof g=="function")return m().createElement("div",{className:Y},g());if(!h||!c)return null;var X=j.length?j[0].contentText:"";return m().createElement("div",{className:"".concat(Y," ").concat(q&&"row-reverse")},m().createElement(K.Z,{size:16},D&&m().createElement(C.Z,{icon:m().createElement(x.Z,null),onClick:this.handleDownload},n("common.exportData")),M&&m().createElement(C.Z,{icon:m().createElement(R.Z,null),onClick:this.handleImport},n("exam.importTemplate")),H&&f&&m().createElement(z.Z,{to:v},m().createElement($.Z,{visible:X&&S,placement:"topLeft",title:X},m().createElement(C.Z,{type:"primary",id:"create-project-button",icon:m().createElement(Z.Z,null)},c))),H&&!f&&m().createElement(C.Z,{type:"primary",id:"create-project-button",icon:m().createElement(Z.Z,null),onClick:this.handleCreate},c)))},this.renderQueryRow=()=>{var t=this.props,l=t.queryRowParams,c=t.queryRowList,n=t.queryRowSelectedCourseIds,v=t.queryRowSelectedProjectIds,h=t.queryRowOnForceRender,g=t.queryRowOnClassifyChange,f=t.queryRowOnTypeChange,N=t.queryRowOnCourseTypeChange,j=t.queryRowAllowActions,y=t.showNum,S=y===void 0?1:y;return m().createElement(A.Z,{params:l,list:c,selectedCourseIds:n,selectedProjectIds:v,onForceRender:h,onClassifyChange:g,onTypeChange:f,onCourseTypeChange:N,allowActions:j,showNum:S,showRenderCondition:!1})},this.rendeExtraBtn=()=>{var t=this.props,l=t.t,c=t.extraBtnSelectedRowKeys,n=t.extraBtnHandleMultiVisibleRange;return m().createElement(C.Z,{disabled:c.length===0,onClick:n},l("courseManage.setTheVisibility"))}}render(){var t=this.props,l=t.prefixCls,c=t.wrapCls,n=t.showRenderQueryRow,v=t.showRendeExtraBtn;return m().createElement(m().Fragment,null,m().createElement("div",{className:"render_other"},m().createElement("header",{className:"".concat(l," ").concat(c)},m().createElement("section",{className:"".concat(l,"__radiocol")},this.renderActionBtn(),n&&this.renderQueryRow(),v&&this.rendeExtraBtn()))))}}V.defaultProps={prefixCls:"cl-listQueryRow",wrapCls:"",label:"",actionText:"add",showSearch:!0,showBtn:!0,newPage:!0,searchStylesProps:{},selectList:[],renderActionBtn:()=>null},b.Z=(0,B.$j)(T)((0,p.Z)()(V))},62117:function(J,b,e){"use strict";var _=e(63185),K=e(9676),O=e(43358),C=e(34041),i=e(88983),m=e(47933),B=e(12924),p=e.n(B),x=e(28216),R=e(91768),Z=e(48479),W=e(2971),A=e(45601),z=e(7249),$=V=>{var s=V.user,t=V.currentRoute,l=V.advancedSetting;return{currentPath:t.path,allAuthRoutes:t.allAuthRoutes,userLng:s.lng,themeColor:l.themeColor,appType:s.appType,appId:s.appId}};class T extends p().Component{constructor(s){super(s);this.setPlaceholder=()=>{var t=this.props,l=t.currentPath,c=t.allAuthRoutes,n=t.userLng,v=this.state.language,h=c[l],g=this.props,f=g.appType,N=g.appId,j=localStorage.getItem("qyWechatBook"),y=f==="wx_app"&&j==="true"&&N==="9005";if(!!h){var S=v[n].searchInputPlaceholder,I="";h.menuKey==="studyTemplate"||h.menuKey==="examTemplate"?I=S.template:h.menuKey==="employee"||h.menuKey==="obligatory"||h.menuKey==="elective"||h.menuKey==="plan"||h.menuKey==="evaluation"||h.menuKey==="myEvaluationPlan"?I=S.task:h.menuKey==="studyProject"?I=y?S.byProjectName:S.byProjectNameOrCreator:h.menuKey==="management"?I=y?S.byTaskName:S.byTaskNameOrCreator:I=S[h.menuKey],this.setState({currentPlaceholder:I})}},this.handleRadiosChange=t=>{this.props.onRadiosChange(t.target.value)},this.handleSelectChange=t=>{this.props.onSelectChange(t)},this.handleSearch=(t,l)=>{this.props.onSearch(t,l)},this.handleChange=t=>{this.props.onCheckboxChange(t.target.checked)},this.renderRadios=()=>{var t=this.props,l=t.prefixCls,c=t.radioList,n=t.defaultRadioValue,v=t.radioValue;if(!c.length)return null;var h=n||c[0].value,g="".concat(l,"__radios");return p().createElement("div",{className:g},typeof v!="undefined"?p().createElement(m.ZP.Group,{defaultValue:h,value:v,onChange:this.handleRadiosChange},c.map(f=>p().createElement(m.ZP.Button,{key:f.value,value:f.value},f.name))):p().createElement(m.ZP.Group,{defaultValue:h,onChange:this.handleRadiosChange},c.map(f=>p().createElement(m.ZP.Button,{key:f.value,value:f.value},f.name))))},this.renderSelect=()=>{var t=this.props,l=t.prefixCls,c=t.selectList,n=t.defaultSelectValue;if(!c.length)return null;var v=n||c[0].value,h="".concat(l,"__select");return p().createElement("div",{className:h},p().createElement(C.Z,{defaultValue:v,onChange:this.handleSelectChange,style:{minWidth:100}},c.map(g=>p().createElement(C.Z.Option,{key:g.value,value:g.value},g.name))))},this.renderOther=()=>{var t=this.props,l=t.prefixCls,c=t.renderOther,n=t.showOther,v="".concat(l,"__other");if(n&&c&&typeof c=="function")return p().createElement("div",{className:v},c())},this.renderCheckbox=()=>{var t=this.props,l=t.prefixCls,c=t.t,n=t.label,v=t.showCheckbox,h=t.renderActionSelect,g="".concat(l,"__checkbox");return!v&&h&&typeof h=="function"?p().createElement("div",{className:g},h()):v?p().createElement("div",{className:g},p().createElement(K.Z,{onChange:this.handleChange},n||c("common.myCreated"))):null},this.renderSearch=()=>{var t=this.props,l=t.prefixCls,c=t.showSearch,n=t.inputPlaceholder,v=t.maxLength,h=v===void 0?400:v,g=t.value,f="".concat(l,"__search");if(!c)return null;var N=this.state.currentPlaceholder;return n?p().createElement("div",{className:f},p().createElement(Z.Z,{onSearch:this.handleSearch,placeholder:n,width:272,maxLength:h})):p().createElement("div",{className:f},p().createElement(Z.Z,{onSearch:this.handleSearch,placeholder:N,width:272,maxLength:h,value:g}))},this.renderSearchOther=()=>{var t=this.props.renderSearchOther;return t?t():null},this.state={language:{zh_cn:A.Z,en_us:W.Z,zh_hk:z.Z},currentPlaceholder:""}}componentDidMount(){this.setPlaceholder()}componentDidUpdate(s){s.userLng!==this.props.userLng&&this.setPlaceholder()}render(){var s=this.props,t=s.prefixCls,l=s.wrapCls,c=s.showRenderRadios,n=c===void 0?!0:c,v=s.showRenderSelect;return p().createElement(p().Fragment,null,p().createElement("div",{className:"render_other"},this.renderOther(),p().createElement("header",{className:"".concat(t," ").concat(l)},p().createElement("section",{className:"".concat(t,"__searchcol")},this.renderSearchOther(),this.renderCheckbox(),n&&this.renderRadios(),v&&this.renderSelect(),this.renderSearch()))))}}T.defaultProps={prefixCls:"cl-listQueryRow",wrapCls:"",label:"",showRadioList:!0,showCheckbox:!0,showSearch:!0,inputPlaceholder:"",defaultRadioValue:"",radioList:[],searchStylesProps:{},showRenderSelect:!1,selectList:[],renderActionBtn:()=>null,onRadiosChange:()=>{},onSearch:()=>{},onCheckboxChange:()=>{},renderSearchOther:()=>{}},b.Z=(0,x.$j)($)((0,R.Z)()(T))},31945:function(J,b,e){"use strict";e.d(b,{Z:function(){return X}});var _=e(88983),K=e(47933),O=e(20228),C=e(11382),i=e(62029),m=e(30887),B=e(99210),p=e(59250),x=e(13013),R=e(57663),Z=e(71577),W=e(63185),A=e(9676),z=e(71194),$=e(57016),T=e(88986),V=e(34792),s=e(48086),t=e(43358),l=e(34041),c=e(12924),n=e.n(c),v=e(28216),h=e(91768),g=e(57254),f=e(18329);class N extends n().Component{constructor(){super(...arguments);this.onCancel=()=>{this.props.showReferenceCourseList()}}render(){var o=this.props,a=o.visible,r=o.courseList,d=o.t;return n().createElement(f.ZP,{visible:a,title:d("common.tip"),onCancel:this.onCancel,onOk:this.onCancel},n().createElement("div",{className:"referenceWithOtherCourses"},n().createElement("div",{className:"referenceWithOtherCourses__tip"},d("course.deleteCourseTip")),r.map((E,u)=>n().createElement("div",{className:"referenceWithOtherCourses__item",key:u},r.length>1?"".concat(u+1,"\u3001"):null," ",E))))}}var j=(0,h.Z)()(N),y=e(10237),S=e(63848),I=e(58546),D=e(30389),F=e(54792),M=e(86726),w=e(37055),H=l.Z.Option,Q={setClassify:w.ZP.CourseManageList.setClassify,setScore:w.ZP.CourseManageList.setScore,setBatchEmployee:w.ZP.CourseManageList.setBatchEmployee,deleteCourse:w.ZP.CourseManageList.deleteCourse,exportCourseView:w.ZP.CourseManageList.exportCourseView,syncCourse:w.ZP.CourseManageList.syncCourse},q=se=>({qyShield:se.user.qyShield});class Y extends n().Component{constructor(){super(...arguments);this.state={classifyProps:{visible:!1},scoreProps:{title:this.props.t("course.setCredits"),labelTxt:this.props.t("course.credit"),initialValue:"",visible:!1},employeeProps:{visible:!1,initialParams:{employeeRange:{rangeType:3,rangeList:{dept:[],post:[],group:[],user:[]}}}},asyncProps:{value:0,visible:!1},showReferenceCourseListProps:{visible:!1,courseList:[],onOk:this.showReferenceCourseList,onCancel:this.showReferenceCourseList}},this.handleChangeClassify=o=>{this.props.onClassifyChange(o)},this.handleChangeType=o=>{this.props.onTypeChange(o)},this.handleChangeCourseType=o=>{this.props.onCourseTypeChange(o)},this.actionChangeClassify=()=>{this.setState({classifyProps:{visible:!0}})},this.handleCategoryCancel=()=>{this.setState({classifyProps:{visible:!1}})},this.handleCategoryOk=o=>{var a=o.node,r=this.props,d=r.selectedCourseIds,E=r.selectedProjectIds,u=r.onForceRender,P=r.t,L=a.id;L&&y.qg.post({url:Q.setClassify(),data:{course_ids:d.join(","),project_ids:E.join(","),classify_id:L}}).then(()=>{s.default.success(P("course.setCourseClassifySuccess")),u()}),this.handleCategoryCancel()},this.actionSetScore=()=>{this.setState(o=>({scoreProps:(0,T.Z)((0,T.Z)({},o.scoreProps),{},{initialValue:"",visible:!0})}))},this.handleScoreCancel=()=>{this.setState(o=>({scoreProps:(0,T.Z)((0,T.Z)({},o.scoreProps),{},{visible:!1})}))},this.handleScoreOk=o=>{var a=o.value;if(a===0){this.handleScoreCancel();return}var r=this.props,d=r.selectedCourseIds,E=r.selectedProjectIds,u=r.onForceRender,P=r.t;y.qg.post({url:Q.setScore(),data:{course_ids:d.join(","),project_ids:E.join(","),credit:a}}).then(()=>{s.default.success(P("course.setCourseScoreSuccess")),u()}),this.handleScoreCancel()},this.actionSetEmployeeRange=()=>{this.setState(o=>({employeeProps:(0,T.Z)((0,T.Z)({},o.employeeProps),{},{visible:!0})}))},this.handleEmployeeCancel=()=>{this.setState({employeeProps:{visible:!1,initialParams:{employeeRange:{rangeType:3,rangeList:{dept:[],post:[],group:[],user:[]}}}}})},this.handleEmployeeOk=o=>{var a=this.props,r=a.selectedCourseIds,d=a.selectedProjectIds,E=a.onForceRender,u=a.t,P=o.isAll,L=o.departmentIds,G=o.groupIds,U=o.postIds,k=o.userIds,ee=o.qy_we_chat_vo;y.WY.post({url:Q.setBatchEmployee(),data:{course_ids:r.join(","),project_ids:d.join(","),department_ids:L,group_ids:G,is_all:P,post_ids:U,user_ids:k,qy_we_chat_vo:ee}}).then(()=>{s.default.success(u("personal.batchSetRangeSuccess")),E()}),this.handleEmployeeCancel()},this.showReferenceCourseList=o=>{this.setState(a=>({showReferenceCourseListProps:(0,T.Z)((0,T.Z)({},a.showReferenceCourseListProps),{},{visible:!a.showReferenceCourseListProps.visible,courseList:o||[]})}))},this.actionDelete=()=>{var o=this.props,a=o.selectedCourseIds,r=o.selectedProjectIds,d=o.list,E=o.onForceRender,u=o.t,P=0,L=0,G=[];if(d.forEach(U=>{a.includes(U.course_id)&&(U.reference_plan_count>0&&(L+=1),U.reference_plan_count>0&&G.push(U.title),U.can_delete==="true"&&(P+=1))}),L>0)this.showReferenceCourseList(G);else if(P!==a.length)s.default.warning(u("personal.deletePlatformCourseTip"));else{if(r.length>0){s.default.warning(u("personal.deleteProjectCourseTip"));return}$.Z.confirm({title:u("common.tip"),content:u("common.confirmDeleteTitle"),onOk(){y.qg.post({url:Q.deleteCourse(),data:{enterpriseId:w.ZP.enterpriseId,ids:a.join(","),project_ids:r.join(",")}}).then(U=>{var k=U.data,ee=k.code,te=k.msg;s.default["".concat(ee===0?"success":"warning")](te),ee===0&&E()})}})}},this.actionSyncSetting=()=>{this.setState(o=>({asyncProps:(0,T.Z)((0,T.Z)({},o.asyncProps),{},{visible:!0})}))},this.onAsyncChange=o=>{this.setState(a=>({asyncProps:(0,T.Z)((0,T.Z)({},a.asyncProps),{},{value:o.target.value})}))},this.handleSyncCancel=()=>{this.setState({asyncProps:{visible:!1,value:0}})},this.handleSyncOk=()=>{var o=this.props,a=o.selectedCourseIds,r=o.selectedProjectIds,d=o.onForceRender,E=o.t,u=this.state.asyncProps;y.qg.post({url:Q.syncCourse(),data:{course_ids:a.join(","),project_ids:r.join(","),syncProgress:u.value}}).then(P=>{var L=P.data,G=L.code,U=L.msg;G===0?(s.default.success(E("setting.setUpSucceed")),d()):s.default.warning(U)}),this.handleSyncCancel()},this.actionImportDetail=()=>{var o=this.props,a=o.selectedCourseIds,r=o.selectedProjectIds,d=o.onForceRender,E=o.t;if(a.concat(r).length>20){s.default.warning(E("courseManage.exportMoreTip"));return}var u=Q.exportCourseView(),P={course_Ids:a.join(","),project_Ids:r.join(",")};y.WY.get({url:u,params:P}).then(L=>{L.data.code===200&&s.default.success("\u6587\u4EF6\u751F\u6210\u4E2D\uFF0C\u8BF7\u7A0D\u540E\u5728\u6587\u4EF6\u4E0B\u8F7D\u4E2D\u4E0B\u8F7D"),d(),this.getDownloadingNumber()})},this.getDownloadingNumber=()=>{var o=w.ZP.downLoadCenter.getDownLoadingCount();y.WY.get({url:o,params:{}}).then(a=>{sessionStorage.setItem("downloadingCount",a.data.data),this.props.dispatch({type:"download/updateDownloadingNumber",downloadingNumber:a.data.data})}).catch(()=>{sessionStorage.setItem("downloadingCount",0),this.props.dispatch({type:"download/updateDownloadingNumber",downloadingNumber:0})})},this.handleChangeCheckBox=o=>{this.props.onCheckboxChange(o.target.checked)},this.handleSharingQueryRowCheckboxChange=o=>{this.props.onSharingCheckboxChange(o.target.checked)},this.renderCondition=()=>{var o=this.props,a=o.prefixCls,r=o.params,d=o.qyShield,E=o.t,u=r.classify_id?r.classify_id.split(","):[];return n().createElement("div",{className:"".concat(a,"__condition")},this.props.extraDom&&this.props.extraDom(),n().createElement(S.Z,{onChange:this.handleChangeClassify,className:"cl-search-normal-width",value:u,showLabel:!1,placeholder:"Please select",queryType:"course_manage",unclassified:"true"}),n().createElement(l.Z,{value:r.type,className:"cl-search-normal-width",onChange:this.handleChangeType},n().createElement(H,{value:""},this.props.t("courseManage.allOrigin")),n().createElement(H,{value:"original"},this.props.t("courseManage.originalCourse")),n().createElement(H,{value:"notOriginal"},this.props.t("courseManage.nonOriginalCourse")),n().createElement(H,{value:"platform"},this.props.t("courseManage.platformProcurement"))),this.props.courseType&&this.props.courseType=="graphic"?null:n().createElement(l.Z,{value:r.course_type,className:"cl-search-normal-width",onChange:this.handleChangeCourseType},n().createElement(H,{value:"all"},this.props.t("courseManage.allType")),n().createElement(H,{value:"course"},this.props.t("common.courseLabel")),n().createElement(H,{value:"microCourse"},this.props.t("common.microCourse")),n().createElement(H,{value:"project"},this.props.t("leftMenuLists.studyProject"))),n().createElement(A.Z,{onChange:this.handleChangeCheckBox,style:{marginRight:16}},E("common.myCreated")),this.props.courseType&&this.props.courseType==="graphic"&&d==="false"?n().createElement(A.Z,{onChange:this.handleSharingQueryRowCheckboxChange},E("common.sharing")):null)},this.renderActions=()=>{var o=this.props,a=o.prefixCls,r=o.selectedCourseIds,d=o.selectedProjectIds,E=o.showNum,u=E===void 0?1:E,P=this.props.allowActions,L=(0,M.H3)("delete",P),G=(0,M.H3)("adjustment_classification",P),U=(0,M.H3)("set_visible",P),k=(0,M.H3)("export",P),ee=(0,M.H3)("set_score",P),te=(0,M.H3)("progressSync",P),le=[{name:this.props.t("courseManage.adjustClassification"),type:"actionChangeClassify",isShow:G},{name:this.props.t("courseManage.exportViewDetail"),type:"actionImportDetail",isShow:k},{name:this.props.t("courseManage.setCredits"),type:"actionSetScore",isShow:ee},{name:this.props.t("courseManage.setTheVisibilityed"),type:"actionSetEmployeeRange",isShow:U},{name:this.props.t("common.delete"),type:"actionDelete",isShow:L},{name:this.props.t("common.scheduleSyncSetting"),type:"actionSyncSetting",isShow:te}],ne=le.filter(ae=>ae.isShow),oe=[],re=[];if(ne.length)u?(oe=[...ne.slice(0,u)],re=[...ne.slice(u)]):re=[...ne];else return null;return n().createElement("div",{className:"".concat(a,"__action")},oe.map(ae=>n().createElement(Z.Z,{style:{marginRight:"8px"},key:ae.type,disabled:!(r.length+d.length),onClick:this[ae.type]},ae.name)),re.length?n().createElement(x.Z,{disabled:!(r.length+d.length),overlay:this.renderMoreButton({buttons:re})},n().createElement(Z.Z,{className:"cl-pointer"},"".concat(this.props.t("common.more"))," ",n().createElement(g.Z,null))):"")}}renderMoreButton(o){var a=o.buttons,r=this.props,d=r.selectedCourseIds,E=r.selectedProjectIds;return n().createElement(B.Z,{onClick:u=>{var P=u.key;this[P]()}},a.map(u=>u.isShow?n().createElement(B.Z.Item,{key:u.type,disabled:!(d.length+E.length)},n().createElement("span",{className:"cl-pointer"},u.name)):null))}render(){var o=this.props,a=o.prefixCls,r=o.t,d=o.showRenderCondition,E=d===void 0?!0:d,u=o.showRenderActions,P=u===void 0?!0:u,L=this.state,G=L.classifyProps,U=L.scoreProps,k=L.employeeProps,ee=L.showReferenceCourseListProps,te=L.asyncProps;return n().createElement("div",{className:a},E&&this.renderCondition(),P&&this.renderActions(),n().createElement(I.Z,(0,i.Z)({},G,{title:r("personal.chooseClassify"),onCancel:this.handleCategoryCancel,onOk:this.handleCategoryOk})),n().createElement(F.Z,(0,i.Z)({},U,{onCancel:this.handleScoreCancel,onCreate:this.handleScoreOk})),k.visible&&n().createElement(D.Z,(0,i.Z)({},k,{title:r("courseManage.setTheVisibility"),mode:["all","part","private"],orgProps:{title:r("component.chooseVisibleScope")},isLoading:!k.visible,onCancel:this.handleEmployeeCancel,onCreate:this.handleEmployeeOk})),te.visible&&n().createElement(f.ZP,{wrapClassName:"cl-async-selector-modal",visible:te.visible,title:r("common.scheduleSyncSetting"),okText:r("common.ok"),cancelText:r("common.cancel"),onCancel:this.handleSyncCancel,onOk:this.handleSyncOk},te.visible?n().createElement("div",{className:"".concat(a,"__async")},n().createElement("p",null," ",r("common.scheduleSyncSettingTip")),n().createElement(K.ZP.Group,{onChange:this.onAsyncChange,value:te.value},n().createElement(K.ZP,{value:0},r("common.outSync")),n().createElement(K.ZP,{value:1},r("common.synchronization")))):n().createElement(C.Z,{size:"large"})),n().createElement(j,(0,i.Z)({},ee,{showReferenceCourseList:this.showReferenceCourseList})))}}Y.defaultProps={prefixCls:"resource-course-list-page__release__content__queryrow",rangeType:""};var X=(0,h.Z)()((0,v.$j)(q)(Y))}}]);
