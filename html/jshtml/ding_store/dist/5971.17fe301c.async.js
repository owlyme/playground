(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[5971],{26096:function(Ne,ie,s){"use strict";var H=s(30887),j=s(99210),U=s(62029),x=s(22385),e=s(31097),g=s(12924),P=s.n(g),A=s(71967),v=s.n(A),N=s(1164),Z=E=>E.type==="more"?E.disabled?P().createElement(j.Z.Item,(0,U.Z)({},E,{key:E.key,disabled:!0}),E.tooltip?P().createElement(e.Z,{title:E.tooltip},P().createElement("p",{className:"cl-dropdown-menuitem"},E.title)):P().createElement("p",{className:"cl-dropdown-menuitem"},E.title)):E.link?P().createElement(j.Z.Item,(0,U.Z)({},E,{key:E.key}),P().createElement(N.Z,{to:E.link},P().createElement("p",{className:"cl-dropdown-menuitem"},E.title))):P().createElement(j.Z.Item,(0,U.Z)({},E,{key:E.key}),P().createElement("p",{className:"cl-dropdown-menuitem",onClick:E.click},E.title)):E.disabled?E.tooltip?P().createElement(P().Fragment,{key:E.key},P().createElement(e.Z,{title:E.tooltip},P().createElement("span",{className:"".concat(v().pointer," ").concat(v().disabled)},E.title))):P().createElement(P().Fragment,{key:E.key},P().createElement("span",{className:"".concat(v().pointer," ").concat(v().disabled)},E.title)):E.link?P().createElement(P().Fragment,{key:E.key},P().createElement(N.Z,{to:E.link},P().createElement("span",{className:"cl-pointer ".concat(v().pointer)},E.title))):P().createElement(P().Fragment,{key:E.key},P().createElement("span",{className:"cl-pointer ".concat(v().pointer),onClick:E.click},E.title));ie.Z=Z},76343:function(Ne,ie,s){"use strict";var H=s(71194),j=s(57016),U=s(57361),x=s(88986),e=s(57663),g=s(71577),P=s(34792),A=s(48086),v=s(9754),N=s.n(v),Z=s(12924),E=s.n(Z),G=s(91768),C=s(96120),z=s.n(C),W=s(24144);class oe extends Z.PureComponent{constructor(){super(...arguments);this.state={src:null,crop:{unit:"%",width:80,height:80,x:10,y:10,aspect:16/9},imgBold:{},fileName:"",imgType:"image/jpg"},this.onSelectFile=y=>{if(y.target.files&&y.target.files.length>0){var _=new FileReader,h=y.target.files[0];_.addEventListener("load",()=>{this.setState({src:_.result,fileName:h.name,imgType:h.type})}),_.readAsDataURL(h)}},this.onImageLoaded=y=>{this.imageRef=y},this.onCropComplete=y=>{this.makeClientCrop(y)},this.onCropChange=y=>{this.setState({crop:y})},this.onOk=()=>{var y=this.state,_=y.imgBold,h=y.imgType,m=new File([_],_.name,{type:h}),T=new FormData;T.append("file",m),T.append("access_token",localStorage.getItem("token")),(0,W.ws)(T).then(f=>{f.data.code===0&&(this.props.isShowMsg&&A.default.success("".concat(this.props.t("course.courseDetailCoverSuccess"))),this.handleSuccessUpload(f.data))}).catch(f=>{var D=this.props.onUploadFailed;D&&D({error:f,data:{fileList:[{fileName:m.name}]}})})},this.handleSuccessUpload=y=>{var _=this.props.onOk,h=y.data,m=h.fileNewName,T=h.server,f=h.fileName,D="".concat(T,"/").concat(m);_({fileName:f,imgUrl:D,fileNewName:m})},this.renderFooter=()=>{var y=this.props,_=y.prefixCls,h=y.t,m=y.accept,T="".concat(_,"__upload");return E().createElement("div",{className:"".concat(_,"__footer")},E().createElement(g.Z,{type:"default",className:T},h("component.reUpload"),E().createElement("input",{type:"file",multiple:!1,accept:m,onChange:this.onSelectFile})),E().createElement(g.Z,{type:"primary",onClick:this.onOk},h("common.ok")))}}componentDidMount(){var y=this.props,_=y.file,h=y.widthScale,m=y.heightScale,T=this.state.crop,f=new FileReader;f.readAsDataURL(_),f.addEventListener("load",()=>{this.setState({src:f.result,crop:(0,x.Z)((0,x.Z)({},T),{},{aspect:h/m}),fileName:_.name,imgType:_.type})})}getCroppedImg(y,_,h){var m=this.state.imgType,T=this.props.quality,f=document.createElement("canvas"),D=y.naturalWidth/y.width,Y=y.naturalHeight/y.height;T?(f.width=_.width*D,f.height=_.height*D):(f.width=_.width,f.height=_.height);var M=f.getContext("2d");return M.drawImage(y,_.x*D,_.y*Y,_.width*D,_.height*Y,0,0,f.width,f.height),new Promise((K,I)=>{f.toBlob(B=>{if(!B){I(new Error("Canvas is empty"));return}B.name=h,window.URL.revokeObjectURL(this.fileUrl),this.fileUrl=window.URL.createObjectURL(B),this.setState({imgBold:B}),K(this.fileUrl)},m,T)})}makeClientCrop(y){var _=this;return(0,U.Z)(N().mark(function h(){return N().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(!(_.imageRef&&y.width&&y.height)){T.next=3;break}return T.next=3,_.getCroppedImg(_.imageRef,y,_.state.fileName);case 3:case"end":return T.stop()}},h)}))()}render(){var y=this.state,_=y.crop,h=y.src,m=this.props,T=m.visible,f=m.prefixCls,D=m.onCancel;return E().createElement(j.Z,{className:f,title:"\u8C03\u6574\u5C3A\u5BF8",visible:T,footer:this.renderFooter(),width:623,onCancel:D},E().createElement("div",{className:"".concat(f,"__container")},E().createElement("div",{className:"".concat(f,"__container__crop")},h&&E().createElement(z(),{className:"".concat(f,"__crop"),src:h,crop:_,ruleOfThirds:!0,keepSelection:!0,imageStyle:{width:"100%"},onImageLoaded:this.onImageLoaded,onComplete:this.onCropComplete,onChange:this.onCropChange}))))}}oe.defaultProps={prefixCls:"img-corp-modal",visible:!1,widthScale:16,heightScale:9,sizeLimit:1,sizeLimitUnit:"MB",accept:"image/jpg,image/jpeg,image/png",isShowMsg:!1,onCancel:()=>{},onOk:()=>{}},ie.Z=(0,G.Z)()(oe)},72387:function(Ne,ie,s){"use strict";var H=s(12924),j=s.n(H),U=s(84874);class x extends j().PureComponent{constructor(g){super(g);this.onPrev=()=>{var P=this.state.activeIndex;this.setState({activeIndex:P<=0?0:P-1})},this.onNext=()=>{var P=this.props.imgList,A=this.state.activeIndex;this.setState({activeIndex:P.length<=A+1?A:A+1})},this.state={activeIndex:g.defaultActive}}componentDidUpdate(g){g.visible!==this.props.visible&&this.props.visible&&this.setState({activeIndex:this.props.defaultActive})}render(){var g=this.props,P=g.visible,A=g.imgList,v=this.state.activeIndex;return j().createElement("div",{className:"preview-img-mask",style:{display:P?"block":"none"}},j().createElement("div",{className:"preview-img-bg"},j().createElement("div",{className:"preview-img"},j().createElement("img",{src:A[v]}),j().createElement("span",{className:"preview-img-close",onClick:this.props.onClose},j().createElement(U.Z,{iconClass:"iconf-close"})))),v>=1?j().createElement("span",{className:"preview-img-left",onClick:this.onPrev},j().createElement(U.Z,{iconClass:"iconf-arrow-left",size:"20px"})):null,v<=A.length-2?j().createElement("span",{className:"preview-img-right",onClick:this.onNext},j().createElement(U.Z,{iconClass:"iconf-arrow-right",size:"20px"})):null)}}x.defaultProps={visible:!1,imgList:[],defaultActive:0,onClose:()=>{}},ie.Z=x},16598:function(Ne,ie,s){"use strict";var H=s(59250),j=s(13013),U=s(30887),x=s(99210),e=s(62029),g=s(12924),P=s.n(g),A=s(57254),v=s(91768),N=s(26096),Z=(G,C)=>{var z=G.map(W=>P().createElement(N.Z,(0,e.Z)({},W,{type:C,key:W.key||W.type})));return C==="more"?P().createElement(x.Z,null,z):z},E=G=>{var C=G.buttons,z=G.t,W=G.visibleNum,oe=C.filter(h=>h.visible),F=W||1,y=[],_=[];if(oe.length<=F)_=[...oe];else if(oe.length>F)_=[...oe.slice(0,F)],y=[...oe.slice(F)];else return"/";return P().createElement("div",{className:"cl-table__cell-action"},Z(_),_.some(h=>h.visible)&&y.some(h=>h.visible)?P().createElement(P().Fragment,null,P().createElement("span",{className:"cl-pointer-divide"}),P().createElement(j.Z,{overlay:Z(y,"more")},P().createElement("span",{className:"cl-pointer"},z("common.more")," ",P().createElement(A.Z,null)))):null)};E.defaultProps={visibleNum:1},ie.Z=(0,v.Z)()(E)},64630:function(Ne,ie,s){"use strict";var H=s(62029),j=s(62999),U=s(85733),x=s(12924),e=s.n(x),g=s(91768),P=s(10237),A=s(37055),v=s(25547),N=U.Z.TreeNode;class Z extends e().Component{constructor(G){super(G);this.getPostTree=()=>{var C=A.ZP.OrgTree.getPostTree();P.WY.get({url:C}).then(z=>{var W=(0,v.NP)(z.data.posts,{id:"value",post_name:"postName"});this.setState({treeData:W})})},this.handleChange=(C,z,W)=>{this.props.onChange(typeof C=="undefined"?"":C,z,W)},this.renderTreeNodes=C=>C.map(z=>{var W=!0;return this.props.noChildSelect&&(W=z.post_type==="post"),z.children?e().createElement(N,{selectable:!this.props.noChildSelect,title:z.postName,key:z.id,value:z.id,isLeaf:!1,dataRef:z},this.renderTreeNodes(z.children)):e().createElement(N,{selectable:W,title:z.postName,dataRef:z,value:z.id,key:z.id,isLeaf:!0})}),this.renderTreeSelect=()=>{var C=this.props,z=C.t,W=C.defaultValue,oe=W===void 0?[]:W,F=C.multiple,y=F===void 0?!1:F,_=C.width,h=_===void 0?180:_,m={showSearch:!1,style:{width:h},defaultValue:oe,multiple:y,dropdownStyle:{maxHeight:300,overflow:"auto"},placeholder:z("component.choosePostTip"),allowClear:!0,disabled:this.props.disabled};return this.state.treeData.length>0?e().createElement(U.Z,(0,H.Z)({},m,{onChange:this.handleChange,className:this.props.className}),this.renderTreeNodes(this.state.treeData)):e().createElement("div",{style:{textAlign:"center"}})},this.state={treeData:[]}}componentDidMount(){this.getPostTree()}render(){return e().createElement("div",{className:"org-tree-container ".concat(this.props.className)},this.renderTreeSelect())}}Z.defaultProps={disabled:!1,onChange:()=>{}},ie.Z=(0,g.Z)()(Z)},64262:function(Ne,ie,s){"use strict";var H=s(88986),j=s(20228),U=s(11382),x=s(22385),e=s(31097),g=s(32157),P=s(75869),A=s(62999),v=s(85733),N=s(12924),Z=s.n(N),E=s(91768),G=s(60667),C=s(38642),z=s(10237),W=s(37055),oe=v.Z.TreeNode;class F extends Z().Component{constructor(_){super(_);this.getDeptTree=h=>{var m=this.props,T=m.filterAuth,f=m.handleLoadedCbk,D=this.state.whiteList,Y=W.ZP.OrgTree.getDeptTree(),M={recursion:!this.props.asyncLoad,query_user_count:this.props.showUserCount,parent_id:h,filter_auth:T,query_selected_user_id:this.props.querySelectedUserId,sync_organization:D.organizationFlag?"lenovo_sync":this.props.organizationType||""};z.WY.get({url:Y,params:M}).then(K=>{var I=this.sumCheckedKeys(K.data.children||[],K.data.selected==="true"?[K.data.id]:[]);f&&f({department_name:K.data.department_name,id:K.data.id,source_type:K.data.source_type}),this.setState({treeData:[{department_name:K.data.department_name,id:K.data.id,source_type:K.data.source_type,children:K.data.children,user_count:K.data.user_count,enable_edit:K.enable_edit,enable_delete:K.enable_delete}],checkedKeys:I}),this.props.handleCheck&&this.props.handleCheck(I)})},this.sumCheckedKeys=(h,m)=>(h instanceof Array&&h.forEach(T=>{T.selected==="true"?m.push(T.id):T.children&&this.sumCheckedKeys(T.children,m)}),m),this.loadChildren=h=>new Promise(m=>{if(h.props.children){m();return}var T=this.props.filterAuth,f=this.state.whiteList,D=W.ZP.OrgTree.getDeptTree(),Y={recursion:!this.props.asyncLoad,query_user_count:this.props.showUserCount,parent_id:h.props.dataRef.id,filter_auth:T,query_selected_user_id:this.props.querySelectedUserId,sync_organization:f.organizationFlag?"lenovo_sync":this.props.organizationType||""};z.WY.get({url:D,params:Y}).then(M=>{if(M.data.children){var K=M.data.children.map(B=>({department_name:B.department_name,id:B.id,user_count:B.user_count,selected:B.selected,has_children:B.has_children,enable_edit:B.enable_edit,enable_delete:B.enable_delete,source_type:B.source_type}));h.props.dataRef.children=K;var I=this.sumCheckedKeys(K,this.state.checkedKeys);this.setState({treeData:[...this.state.treeData],checkedKeys:I}),this.props.handleCheck&&this.props.handleCheck(I)}else h.props.dataRef.children=[],this.setState({treeData:[...this.state.treeData]});m()})}),this.handleCheck=h=>{this.setState({checkedKeys:h}),this.props.handleCheck&&this.props.handleCheck(h)},this.treeSelectChange=(h,m)=>{this.setState({treeSelectValue:h});var T=this.props,f=T.handleTreeSelectChange,D=T.onTreeSelectChange;f?f(h||"",m):D&&D(h||"",m)},this.renderTreeNodes=h=>h.map(m=>m.children?Z().createElement(P.Z.TreeNode,{title:this.renderTitle(m),key:m.id,value:m.id,isLeaf:m.has_children!=="true",switcherIcon:m.children.length===0?Z().createElement("span",null):null,dataRef:m,selected:m.selected==="true"},this.renderTreeNodes(m.children)):Z().createElement(P.Z.TreeNode,{title:this.renderTitle(m),dataRef:m,value:m.id,key:m.id,isLeaf:m.has_children!=="true",switcherIcon:this.props.asyncLoad?null:Z().createElement("span",null),selected:m.selected==="true"})),this.renderSelectTreeNodes=h=>{var m=this.props.disabledFirstNode,T=this.state.treeData.length?this.state.treeData[0].id:"";return h.map(f=>f.children?Z().createElement(oe,{title:this.renderTitle(f),key:f.id,value:f.id,isLeaf:!1,switcherIcon:f.children.length===0?Z().createElement("span",null):null,dataRef:f,disabled:m?f.id===T:!1,selected:f.selected==="true",departmentName:f.department_name},this.renderSelectTreeNodes(f.children)):Z().createElement(oe,{title:this.renderTitle(f),dataRef:f,value:f.id,key:f.id,isLeaf:!1,switcherIcon:this.props.asyncLoad?null:Z().createElement("span",null),selected:f.selected==="true",departmentName:f.department_name}))},this.dealText=h=>{var m=this.props.showUserCount;return Z().createElement(N.Fragment,null,Z().createElement(G.Z,{type:h.source_type,value:h.id,node:h,name:h.department_name,dataType:"departmentName"}),m&&Z().createElement("span",null,"(",h.user_count,")"))},this.renderTitle=h=>{var m=this.props,T=m.showTitleToolTip,f=m.DeptTreeNodeTitle,D=m.titleOperateProps,Y=D===void 0?{}:D,M=this.dealText(h);return f?Z().createElement(f,{title:M,titleOperateProps:Y,deptId:h.id||"1",deptName:h.department_name,enableEdit:h.enable_edit==="true",enableDelete:h.enable_delete==="true"}):T?Z().createElement(e.Z,{title:M},Z().createElement("span",null,M)):M},this.renderTree=()=>{var h={showLine:{showLeafIcon:!1},checkable:this.props.checkable,checkStrictly:this.props.checkStrictly,checkedKeys:this.state.checkedKeys,onCheck:this.handleCheck,onSelect:this.props.handleSelect,defaultExpandAll:this.props.defaultExpandAll,defaultExpandedKeys:this.state.treeData.length>0?["".concat(this.state.treeData[0].id)]:[""],className:this.props.className};return this.props.asyncLoad&&(h.loadData=this.loadChildren),this.state.treeData.length>0?Z().createElement(P.Z,h,this.renderTreeNodes(this.state.treeData)):Z().createElement("div",{style:{textAlign:"center"}},Z().createElement(U.Z,null))},this.renderTreeSelect=()=>{var h=this.props,m=h.t,T=h.width,f=T===void 0?180:T,D=h.placeholder,Y=h.open,M=(0,H.Z)((0,H.Z)({},this.props),{},{showLine:{showLeafIcon:!1},style:{width:f},value:this.state.treeSelectValue,dropdownStyle:{maxHeight:300,overflow:"scroll",whiteSpace:"nowrap",maxWidth:f},dropdownMatchSelectWidth:!1,treeDefaultExpandedKeys:this.state.treeData.length>0?["".concat(this.state.treeData[0].id)]:[""],placeholder:D||m("component.chooseDeptTip"),allowClear:!0,multiple:this.props.multiple,disabled:this.props.disabled,onChange:this.treeSelectChange,className:this.props.className,treeNodeFilterProp:"departmentName",open:Y});return this.props.asyncLoad&&(M.loadData=this.loadChildren),this.state.treeData.length>=0?Z().createElement(v.Z,M,this.renderSelectTreeNodes(this.state.treeData)):Z().createElement("div",{style:{textAlign:"center"}})},this.state={treeData:[],checkedKeys:[],treeSelectValue:this.props.defaultValue||[],whiteList:{organizationFlag:(0,C.UI)("ORG_TREE_SYNC_ORGANIZATION")}}}componentDidMount(){this.getDeptTree(this.props.parentId)}componentDidUpdate(_){_.refresh!==this.props.refresh&&this.setState({treeData:[],checkedKeys:[],treeSelectValue:this.props.defaultValue||[]},()=>{this.getDeptTree(this.props.parentId)})}render(){return Z().createElement("div",{className:"org-tree-container ".concat(this.props.className)},this.props.treeSelect?this.renderTreeSelect():this.renderTree())}}F.defaultProps={parentId:"",asyncLoad:!1,checkable:!0,disabledFirstNode:!1,querySelectedUserId:"",checkStrictly:!1,showUserCount:!1,showTitleToolTip:!1,defaultExpandAll:!1,multiple:!1,treeSelect:!1,filterAuth:!0,organizationType:"",disabled:!1,handleCheck:()=>{},handleLoadedCbk:()=>{},handleTreeSelectChange:void 0,onTreeSelectChange:void 0},ie.Z=(0,E.Z)("",{withRef:!0})(F)},24144:function(Ne,ie,s){"use strict";s.d(ie,{G2:function(){return B},Sc:function(){return D},Ur:function(){return J},VI:function(){return Qe},Lh:function(){return Re},DZ:function(){return y},ZM:function(){return h},tX:function(){return Y},VQ:function(){return W},_D:function(){return ae},iM:function(){return ue},vx:function(){return Te},$Y:function(){return z},ws:function(){return G},Pd:function(){return C}});var H=s(43185),j=s(53251),U=s(62029),x=s(34792),e=s(48086),g=s(88986),P=s(33565),A=s(12924),v=s.n(A),N=s(91768),Z=s(10237),E=s(37055);function G(u){var L=E.ZP.Common.upload();return Z.WY.post({url:L,data:u})}function C(u){var L=E.ZP.CourseManageList.uploadAiImage();return Z.WY.post({url:L,data:u})}function z(u){var L=E.ZP.CourseManageList.saveAiImage();return Z.WY.post({url:L,data:u})}function W(u){var L=u.idList,de=E.ZP.CourseManageList.deleteAiImage();return Z.WY.put({url:de,data:{id_list:L}})}var oe=s(72387),F=s(76343),y={IMAGE:"image"},_=u=>{var L=u.uploadConfig,de=u.uploadType,ee=u.clip,he=u.size,se=u.quality,Le=u.t,Ze=Array.isArray(u.fileList)?u.fileList:[],_e=(0,A.useState)(!1),pe=(0,P.Z)(_e,2),Ee=pe[0],Pe=pe[1],Ie=(0,A.useState)(!1),Ve=(0,P.Z)(Ie,2),ot=Ve[0],qe=Ve[1],He=(0,A.useState)(0),lt=(0,P.Z)(He,2),Tt=lt[0],Dt=lt[1],Pt=(0,A.useState)(!1),It=(0,P.Z)(Pt,2),mt=It[0],ht=It[1],Ge=(0,A.useState)({}),ze=(0,P.Z)(Ge,2),dt=ze[0],at=ze[1],bt=te=>{var ce=te.file;ee?ct({file:ce},ee):vt({file:ce})},ct=(te,ce)=>{var be=te.file;ce==="crop"&&(at(be),Zt())},vt=te=>{var ce=te.file;Pe(!0);var be=new FormData;be.append("file",ce),ke(be,de).then(Me=>{var Ye="".concat(Me.data.data.server,"/").concat(Me.data.data.fileNewName),At=Me.data.data.fileNewName,$t=[(0,g.Z)({url:Ye,uid:At,name:At,thumbUrl:Ye,status:"done",response:"Server Error 500"},Me.data.data)];ft({newImgList:$t})}).catch(Me=>{Lt({error:Me,data:{fileList:[{fileName:ce.name}]}})}).finally(()=>{Pe(!1)})},gt=te=>{u.onUploadedListChange&&u.onUploadedListChange(te)},ft=te=>{var ce=te.newImgList,be=L.maxCount;u.onUploadSuccess&&u.onUploadSuccess({fileList:[...ce]});var Me=[...Ze,...ce],Ye=[];typeof be=="number"&&be===1?Ye=ce:typeof be=="number"&&Me.length>be?Ye=Me.slice(0,be+1):Ye=Me,gt({fileList:Ye})},Lt=te=>{var ce=te.error,be=te.data;u.onUploadFailed&&u.onUploadFailed({error:ce,data:be})},Zt=()=>{ht(!0)},ne=()=>{ht(!1)},re=te=>{if(u.onBeforeUpload)return u.onBeforeUpload(te);var ce=L.accept;if(ce&&ce.indexOf(te.name.split(".").pop().toLowerCase())<0)return e.default.error(Le("component.imgTypeError")),!1;if(he&&he.value&&he.unit){var be=he.value,Me=he.unit,Ye=Me.toLowerCase()==="kb"?te.size/1024<be:te.size/1024/1024<be;if(!Ye)return e.default.error("".concat(Le("component.imgUploadLimit")).concat(be).concat(Me,"!")),!1}return!0},ge=te=>{var ce=[...Ze],be=ce.findIndex(Me=>Me.uid===te.uid);ce.splice(be,1),gt({fileList:ce})},ye=te=>{var ce=Ze.findIndex(be=>be.uid===te.uid);Dt(ce),qe(!0)},me=()=>{qe(!1)},St=te=>{var ce=te.fileName,be=te.imgUrl,Me=te.fileNewName,Ye={url:be,uid:Me,fileName:ce,name:Me,thumbUrl:be,status:"done"};ft({newImgList:[Ye]}),ht(!1)},ke=(te,ce)=>ce===y.IMAGE?G(te):null,Ut={listType:"picture-card",accept:"*",fileList:[],beforeUpload:re,customRequest:bt,onPreview:ye,onRemove:ge};return v().createElement(v().Fragment,null,v().createElement(j.Z,(0,U.Z)({},Ut,L,u,{className:"upload_container_19fb1b0b-5573-42cb-b6a2-b39518df62cd ".concat(u.className)}),u.render((0,g.Z)((0,g.Z)({},u),{},{loading:Ee}))),v().createElement(oe.Z,{visible:ot,imgList:Ze.map(te=>te.url),defaultActive:Tt,onClose:me}),mt&&v().createElement(F.Z,(0,U.Z)({visible:mt,file:dt,widthScale:16,heightScale:9,sizeLimit:he.value,sizeLimitUnit:he.unit,accept:L.accept,onCancel:ne,onOk:St,onUploadFailed:Lt,quality:se},u.imgCropConfig)))};_.defaultProps={fileList:[],uploadType:"image",size:{},clip:"",quality:void 0};var h=(0,N.Z)()(_);function m(u){return(0,g.Z)((0,g.Z)({},u),{},{lastModified:u.lastModified,lastModifiedDate:u.lastModifiedDate,name:u.name,size:u.size,type:u.type,uid:u.uid,percent:0,originFileObj:u})}var T={IMAGE:"image",VIDEO:"video",AUDIO:"audio"},f=u=>{var L=(0,A.useRef)({fileList:[],file:{}}),de=u.uploadConfig,ee=u.size,he=u.t;(0,A.useEffect)(()=>{L.current.fileList=u.fileList?u.fileList:[]},[u.fileList]);function se(pe){var Ee=!0;if(ee&&ee.value&&ee.unit){var Pe=ee.value,Ie=ee.unit,Ve=Ie.toLowerCase()==="kb"?pe.size/1024<Pe:pe.size/1024/1024<Pe;Ve||(e.default.error("".concat(he("component.imgUploadLimit")).concat(Pe).concat(Ie,"!")),Ee=!1)}return Ee&&(L.current.fileList=[...L.current.fileList,m(pe)]),Ee}function Le(pe){var Ee=pe.file,Pe=pe.onError,Ie=pe.onProgress,Ve=pe.onSuccess,ot=new FormData;return ot.append("file",Ee),G(ot,{onUploadProgress:qe=>{var He=qe.total,lt=qe.loaded;Ie({percent:Math.round(lt/He*100).toFixed(2)},Ee)}}).then(qe=>{var He=qe.data;Ve(He,Ee)}).catch(Pe),{abort(){console.log("upload progress is aborted.")}}}var Ze={listType:"text",accept:"*",beforeUpload:se,customRequest:Le,onStart(pe){L.current.file=pe,L.current.fileList=L.current.fileList.map(Ee=>Ee.uid===pe.uid?(0,g.Z)((0,g.Z)({},Ee),{},{status:"uploading"}):Ee),u.onChange&&u.onChange(Y({file:L.current.file,fileList:L.current.fileList}))},onSuccess(pe,Ee){L.current.file=Ee,L.current.fileList=L.current.fileList.map(Pe=>Pe.uid===Ee.uid?(0,g.Z)((0,g.Z)({},Pe),{},{response:pe,status:"done"}):Pe),u.onChange&&u.onChange(Y({file:L.current.file,fileList:L.current.fileList}))},onError(pe,Ee){u.onChange(Y({file:L.current.file,fileList:L.current.fileList.map(Pe=>Pe.url?Pe:(0,g.Z)((0,g.Z)({},Pe),{},{status:"error"}))}))},onProgress(pe,Ee){var Pe=pe.percent;L.current.file=Ee,L.current.fileList=L.current.fileList.map(Ie=>Ie.uid===Ee.uid?(0,g.Z)((0,g.Z)({},Ie),{},{percent:Pe}):Ie),u.onChange&&u.onChange(Y({file:L.current.file,fileList:L.current.fileList}))}},_e=(0,g.Z)((0,g.Z)({},Ze),de);return v().createElement(v().Fragment,null,v().createElement(j.Z,_e,u.render((0,g.Z)({},u))))},D=(0,N.Z)()(f);function Y(u){var L=u.file,de=u.fileList;return{file:(0,g.Z)({},L),fileList:de.map(ee=>{var he=ee.response,se=ee.name,Le=ee.type,Ze=ee.size,_e=ee.status,pe=ee.percent,Ee=ee.uid,Pe=ee.url;if(he){var Ie=he.data,Ve=he.error;return Ve?(0,g.Z)((0,g.Z)((0,g.Z)({},ee),Ie),{},{status:"error"}):(0,g.Z)((0,g.Z)((0,g.Z)({},ee),Ie),{},{url:"".concat(Ie.server,"/").concat(Ie.fileNewName)})}return{name:se,size:Ze,type:Le,percent:pe,status:_e,url:Pe,uid:Ee}})}}function M(u){var L=u.name,de=L.match(/\.([0-9a-z]+)(?:[\?#]|$)/i),ee=(0,P.Z)(de,1),he=ee[0];switch(he.toLowerCase()){case".mp3":return y.AUDIO;case".mp4":return y.VIDEO;case".webp":case".svg":case".png":case".gif":case".jpg":case".jpeg":case".jfif":case".bmp":case".dpg":case".ico":return y.IMAGE;default:return""}}function K(u){var L=u.split("/"),de=L[L.length-1],ee=de.split(/#|\?/)[0];return(/\.[^./\\]*$/.exec(ee)||[""])[0]}var I=u=>v().createElement(h,(0,U.Z)({},u,{uploadConfig:(0,g.Z)((0,g.Z)({},u.uploadConfig),{},{showUploadList:!1,maxCount:1,fileList:u.fileList}),className:"sample_upload_image_container",render:L=>ae(L)}));I.defaultProps={uploadConfig:{listType:"picture-card",maxCount:1},addTitle:"",size:{value:2,unit:"MB"},fileList:[]};var B=(0,N.Z)()(I),$=s(20228),k=s(11382),O=s(7085),S=s(49101),ae=u=>{var L=u.uploadConfig,de=u.loading,ee=u.fileList,he=u.addTitle,se=u.changeTip,Le=se===void 0?"":se,Ze=u.imageContainerClassName,_e=L.maxCount;return de?v().createElement(O.Z,null):ee.length>0&&ee.length<=_e?v().createElement("div",{className:"avatar_list_container ".concat(Ze)},v().createElement("img",{className:"avatar",src:ee[0].url,alt:"img"}),Le&&v().createElement("div",{className:"change_btn"},Le)):v().createElement("div",{className:"avatar_select_container"},v().createElement(S.Z,null),v().createElement("div",{className:"avatar_select_tip"},he))},ue=u=>{var L=u.uploadConfig,de=u.loading,ee=u.fileList,he=u.selectTip,se=L.maxCount;return de?v().createElement(O.Z,null):ee.length>=se?null:v().createElement("div",{className:"picture_select"},v().createElement(S.Z,null),he&&v().createElement("div",{className:"picture_select_tip"},he))},Te=u=>{var L=u.loading,de=u.fileList,ee=u.changeTip,he=u.addTitle,se=u.renderClassName,Le=(0,P.Z)(de,1),Ze=Le[0];return L?v().createElement(k.Z,{spinning:L,indicator:v().createElement(O.Z,{spin:!0})},v().createElement("div",{className:"class_6f5ad7a8_6cee_4858_99d0_b3dd950f662b ".concat(se)})):Ze?v().createElement("div",{className:"class_6f5ad7a8_6cee_4858_99d0_b3dd950f662b ".concat(se)},v().createElement("img",{src:Ze,alt:"image"}),v().createElement("div",{className:"change_btn"},ee)):v().createElement("div",{className:"upload_btn_container ".concat(se)},v().createElement("div",{className:"upload_btn"},v().createElement(S.Z,null),he&&v().createElement("div",{className:"avatar_select_tip"},he)))},Ae=u=>{var L=u.loading,de=u.fileList,ee=u.changeTip,he=u.reset,se=u.renderClassName,Le=_slicedToArray(de,1),Ze=Le[0],_e=pe=>{pe.stopPropagation(),he.resetEvent&&he.resetEvent(pe)};return L?React.createElement(_Spin,{spinning:L,indicator:React.createElement(LoadingOutlined,{spin:!0})},React.createElement("div",{className:"class_bf5f55ec_25c6_45b1_b5a4_f5b467257caa ".concat(se)})):React.createElement("div",{className:"class_bf5f55ec_25c6_45b1_b5a4_f5b467257caa ".concat(se)},React.createElement("img",{src:Ze,alt:"image"}),React.createElement("div",{className:"change_btns"},React.createElement("span",{className:"operate_item operate_change"},ee),React.createElement("span",{onClick:pe=>{_e(pe)},className:"operate_item operate_reset"},he.tip)))},fe=s(84874),X=u=>{var L=de=>{u.onChange&&u.onChange(de)};return v().createElement(D,(0,U.Z)({onChange:L,uploadType:y.VIDEO},u,{uploadConfig:(0,g.Z)({accept:"video/*",showUploadList:!1},u.uploadConfig),render:()=>v().createElement("span",{className:"icon"},v().createElement(fe.Z,{iconClass:"icon-shipinfujian",color:u.iconColor,size:"16px"}))}))};X.defaultProps={uploadConfig:{listType:"text"},addTitle:""};var le=(0,N.Z)()(X),Oe=u=>{var L=de=>{u.onChange&&u.onChange(de)};return v().createElement(D,(0,U.Z)({onChange:L,uploadType:y.AUDIO},u,{uploadConfig:(0,g.Z)({accept:"audio/*",showUploadList:!1},u.uploadConfig),render:()=>v().createElement("span",{className:"icon"},v().createElement(fe.Z,{iconClass:"icon-yinpinfujian",size:"16px",color:u.iconColor}))}))};Oe.defaultProps={uploadConfig:{listType:"text"},addTitle:""};var Be=(0,N.Z)()(Oe),st=s(22385),we=s(31097),rt=s(86506),xe=s.n(rt),$e=u=>{var L=de=>{u.onChange&&u.onChange(de)};return v().createElement(D,(0,U.Z)({onChange:L,uploadType:y.IMAGE},u,{uploadConfig:(0,g.Z)({accept:"image/*",showUploadList:!1},u.uploadConfig),render:()=>v().createElement(v().Fragment,null,u.uploadImageIcon?u.uploadImageIcon((0,g.Z)({},u.uploadConfig)):v().createElement(we.Z,{title:u.t("examination.uploadImgTip"),overlayStyle:{fontSize:"12px"}},v().createElement("span",{className:xe()["icon-container"]},v().createElement(fe.Z,{iconClass:"icon-tupianfujian",color:"#979797",size:"16px"}))))}))};$e.defaultProps={uploadConfig:{listType:"text"},addTitle:""};var J=(0,N.Z)()($e),_t=s(34669),Fe=s(82833),et=s(12968),Ke=s(44208),Xe=s(54549),it=s(56653),Ue=s.n(it),tt=s(76466),Qe={OPEN:"open",CLOSE:"close",CUSTOM:"custom"},nt=u=>{var L=u.t,de=u.preview,ee=u.previewSize,he=u.remove,se=u.status,Le=u.name,Ze=u.extension,_e=!se||se==="done",pe=se&&se==="error",Ee=u.resourceType||M({name:Le,extension:Ze}),Pe=(0,A.useState)({mode:"preview",watchType:"",resourceInfo:{},autoPlay:!0,draggable:!0}),Ie=(0,P.Z)(Pe,2),Ve=Ie[0],ot=Ie[1],qe=(0,A.useState)({visible:!1,destroyOnClose:!0,title:L("common.resourcePreview"),onCancel:ht}),He=(0,P.Z)(qe,2),lt=He[0],Tt=He[1];function Dt(Ge){var ze=Ge||window.event;ze.stopPropagation(),ze.cancelBubble=!0,u.onDeleteItem&&u.onDeleteItem()}function Pt(Ge){var ze=Ge.percent,dt=Ge.url;if(_e)switch(Ee){case y.IMAGE:return v().createElement("div",{className:Ue().cover},v().createElement(Ke.Z,{width:ee,height:ee,alt:"img",className:Ue()["ant-image-container"],src:dt}));case y.VIDEO:return v().createElement("div",{className:Ue().cover},v().createElement("img",{className:"",src:"https://oss.coolcollege.cn/1815010117263953920.png",alt:"video"}));case y.AUDIO:return v().createElement("div",{className:Ue().cover},v().createElement("img",{className:"",src:"https://oss.coolcollege.cn/1815010117280731136.png",alt:"audio"}));default:return null}if(pe)return v().createElement("div",{className:"".concat(Ue().cover," ").concat(Ue()["error-cover"])},L("component.uploadFailed"));var at=Math.floor(ze);return v().createElement("div",{className:Ue().cover},v().createElement("div",{className:Ue()["cover-content"]},v().createElement(Fe.Z,{showInfo:!1,strokeWidth:4,percent:Math.floor(at)}),v().createElement("span",{className:Ue()["progress-tip"]},at>0?"\u4E0A\u4F20\u4E2D...":"\u7B49\u5F85\u4E2D")))}function It(){switch(Ee){case y.IMAGE:return v().createElement(fe.Z,{iconClass:"icon-FView",size:"16px",color:"#fff"});case y.VIDEO:case y.AUDIO:return v().createElement(fe.Z,{iconClass:"icon-bofang",size:"22px",color:"#fff"});default:return null}}function mt(Ge,ze){var dt=ze.type,at=ze.url,bt=ze.resourceList,ct=ze.resourceType,vt=ze.index,gt=Ge||window.event;if(gt.stopPropagation(),gt.cancelBubble=!0,de!==Qe.CLOSE){if(de===Qe.CUSTOM&&u.onPreview){u.onPreview({resourceList:bt,resourceType:ct,index:vt,e:Ge});return}if(ct.includes(y.VIDEO)||dt.includes(y.AUDIO)){var ft=u.extension==="mp3";ot((0,g.Z)((0,g.Z)({},Ve),{},{watchType:"video",resourceInfo:{source:{FD:at,OD:at},originUrl:at,contentType:ft?"audio/mp3":ct},autoPlay:!0,draggable:!0})),Tt((0,g.Z)((0,g.Z)({},lt),{},{visible:!0}))}}}function ht(Ge){var ze=Ge||window.event;ze.stopPropagation(),ze.cancelBubble=!0,ot({mode:"preview",watchType:"",resourceInfo:{},autoPlay:!0,draggable:!0}),Tt((0,g.Z)((0,g.Z)({},lt),{},{visible:!1}))}return v().createElement(v().Fragment,null,v().createElement("div",{className:Ue()["resource-item-container"],style:{width:"".concat(ee,"px"),height:"".concat(ee,"px")}},Pt(u),(!se||se==="done"||se==="error")&&v().createElement("div",null,de!==Qe.CLOSE&&se!=="error"&&Ee!==y.IMAGE&&v().createElement("div",{className:Ue().mask,onClick:Ge=>{mt(Ge,u)}},It(u)),he&&v().createElement("div",{className:Ue().delete,onClick:Dt},v().createElement(Xe.Z,{className:Ue()["delete-icon"]})))),de===Qe.OPEN&&Ee!==y.IMAGE&&v().createElement(tt.Z,(0,U.Z)({},Ve,{previewInfo:lt})))};nt.defaultProps={preview:Qe.OPEN,previewSize:72,remove:!0,resourceType:""};var Re=(0,N.Z)()(nt)},11449:function(Ne,ie,s){"use strict";s.d(ie,{Z:function(){return K}});var H=s(88986),j=s(33565),U=s(12924),x=s.n(U),e=s(3115),g=s(49111),P=s(19650),A=s(62029),v=s(57663),N=s(71577),Z=s(91768),E=s(28216),G=s(37055),C=s(10237);function z(I){var B=G.ZP.getHelpContentByMenuKey(),$={key:I};return C.WY.get({url:B,params:$})}var W=s(74228),oe=s.n(W),F=s(1164),y=s(76466),_=s(38642);class h extends x().Component{constructor(B){var $;super(B);$=this,this.getHelpContentByMenuKey=()=>{var k=this.props.defaultMenuKey;z(k).then(O=>{var S=O.data,ae=S.help_url,ue=S.video_url;this.setState({videoUrl:ue,helpUrl:ae})})},this.handleOpenHelpUrl=k=>{if((0,_.ve)()){window.open(k,"_blank");return}F.Z.targetTo({path:k,isExternalLink:!0})},this.handleOpenVideo=function(k){var O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$.props.t("helpCenter.video");$.setState(S=>({resourcePlayInfo:(0,H.Z)((0,H.Z)({},S.resourcePlayInfo),{},{resourceInfo:{originUrl:k,source:{FD:k,OD:k},contentType:"mp4"}}),previewInfo:(0,H.Z)((0,H.Z)({},S.previewInfo),{},{title:O,visible:!0,onCancel:$.handleCancelPreview})}))},this.handleCancelPreview=()=>{var k=this.state.previewInfo;this.setState({resourcePlayInfo:{mode:"preview",watchType:"video",resourceInfo:{}},previewInfo:(0,H.Z)((0,H.Z)({},k),{},{visible:!1})})},this.state={helpUrl:"",videoUrl:"",resourcePlayInfo:{autoPlay:!0,draggable:!0,mode:"preview",resourceInfo:{},watchType:"video"},previewInfo:{visible:!1,destroyOnClose:!0,title:B.t("helpCenter.video")||"\u89C6\u9891\u6307\u5BFC",onCancel:()=>{}}}}componentDidMount(){this.getHelpContentByMenuKey()}render(){var B=this.state,$=B.helpUrl,k=B.resourcePlayInfo,O=B.previewInfo,S=B.videoUrl,ae=this.props.t;return x().createElement("div",{className:oe().helpCenter},S&&x().createElement(N.Z,{type:"link",className:oe()["video-btn"],style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenVideo(S)},ae("helpCenter.video")),$&&x().createElement(N.Z,{type:"link",style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenHelpUrl($)},ae("helpCenter.tutorial")),x().createElement(y.Z,(0,A.Z)({},k,{previewInfo:O})))}}var m=I=>({defaultMenuKey:I.currentRoute.menuKey});h.defaultProps={defaultMenuKey:""};var T=(0,E.$j)(m)((0,Z.Z)()(h));function f(I){var B=I.extra,$=localStorage.getItem("dingPersonnel"),k=sessionStorage.getItem("dingPersonnel");return x().createElement(P.Z,null,B,$!=="dingPersonnel"&&k!=="dingPersonnel"&&(0,_.eY)("COMMONEXTRA_HELP_CENTER")&&x().createElement(T,null))}var D=f,Y=s(4408);function M(I){var B=(0,U.useState)({helpCenter:(0,_.eY)("HEAD_HELP_CENTER_BUT")}),$=(0,j.Z)(B,1),k=$[0],O=I.pageContainerParams,S=O===void 0?{}:O,ae=I.noPadding,ue=ae===void 0?!1:ae,Te=I.isPersonal,Ae=Te===void 0?!1:Te,fe=I.pageTitle,X=I.className,le=X===void 0?"":X,Oe={extra:k.helpCenter?x().createElement(D,{extra:S.extra}):S.extra},Be=(0,H.Z)((0,H.Z)({},S),Oe);return x().createElement("div",{className:"page-container-content ".concat(ue?"page-container-noPadding":""," ").concat(Ae?"page-container-content_personal_background":""," ").concat(le)},fe&&x().createElement(Y.Z,{title:fe}),Ae?x().createElement(e.Z,null,I.children):x().createElement(e.Z,Be,I.children))}var K=M},70775:function(Ne,ie,s){"use strict";s.d(ie,{Z:function(){return fe}});var H=s(57663),j=s(71577),U=s(88986),x=s(71194),e=s(57016),g=s(34792),P=s(48086),A=s(57361),v=s(22385),N=s(31097),Z=s(33565),E=s(63185),G=s(9676),C=s(48736),z=s(27049),W=s(9754),oe=s.n(W),F=s(12924),y=s.n(F),_=s(91768),h=s(7145),m=s.n(h),T=s(82729),f=s.n(T),D=s(20050),Y=s.n(D),M=s(37055),K=s(10237);function I(){return K.WY.get({url:M.ZP.Organization.getHandOverInfo(),data:{}})}function B(X){return K.WY.post({url:M.ZP.Organization.submitHandOver(),data:{handed_from:X.handed_from,details:X.details}})}function $(X){var le=X.userIds;return K.WY.get({url:M.ZP.OrgDialog.getUserByName(),params:{userIds:le}})}var k=s(88311),O=s(60667),S=s(80430),ae=s(18329),ue=s(36202),Te=X=>{var le=X.onChange,Oe=X.options,Be=X.checkedIds,st=Be===void 0?[]:Be,we=X.disabledIds,rt=we===void 0?[]:we;return Oe.children.length?y().createElement("div",{className:Y()["checkbox-list"]},y().createElement(z.Z,null),y().createElement("div",{className:Y()["checkbox-item"]},y().createElement(G.Z,{onChange:xe=>le(xe,Oe,"all"),checked:st.includes(Oe.id),disabled:rt.includes(Oe.id)},Oe.name),y().createElement(z.Z,null),Oe.children.map(xe=>y().createElement(G.Z,{onChange:$e=>le($e,xe,"item"),checked:st.includes(xe.id),key:xe.id,disabled:rt.includes(xe.id)},xe.name)))):null},Ae=X=>{var le=X.t,Oe=X.visible,Be=X.onRefresh,st=X.onCancel,we=X.record,rt=(0,F.useRef)(null),xe=(0,F.useState)([]),$e=(0,Z.Z)(xe,2),J=$e[0],_t=$e[1],Fe=(0,F.useState)(!1),et=(0,Z.Z)(Fe,2),Ke=et[0],Xe=et[1],it=(0,F.useState)([]),Ue=(0,Z.Z)(it,2),tt=Ue[0],Qe=Ue[1],nt=(0,F.useState)([]),Re=(0,Z.Z)(nt,2),u=Re[0],L=Re[1],de=(0,F.useState)(!1),ee=(0,Z.Z)(de,2),he=ee[0],se=ee[1],Le=(0,F.useState)({items:[],content:[]}),Ze=(0,Z.Z)(Le,2),_e=Ze[0],pe=Ze[1],Ee=(0,F.useState)({disable:[],enable:[]}),Pe=(0,Z.Z)(Ee,2),Ie=Pe[0],Ve=Pe[1],ot=(0,F.useState)([]),qe=(0,Z.Z)(ot,2),He=qe[0],lt=qe[1];(0,F.useEffect)(()=>{Ge()},[]);var Tt=[{title:le("setting.handoverPerson"),dataIndex:"username",key:"username",width:150,render:(ne,re)=>{var ge=()=>y().createElement(O.Z,{type:re.source_type,name:re.user_name,value:re.user_id,dataType:"userName"});return y().createElement(N.Z,{title:ge()},y().createElement("div",{className:"cl-text-ellipsis",style:{width:140}},ge()))}},{title:le("common.departmentLabel"),dataIndex:"department_infos",key:"department_infos",width:210,render:ne=>{var re=()=>y().createElement(S.Z,{list:ne,displayAll:!0});return y().createElement(N.Z,{title:re()},y().createElement("div",{className:"cl-text-ellipsis",style:{width:200}},re()))}},{title:le("setting.handoverContent"),dataIndex:"content",key:"content",width:220,render:ne=>{var re=ne&&ne.length?ne.join(","):"";return y().createElement(N.Z,{title:re},y().createElement("div",{className:"cl-text-ellipsis",style:{width:220}},re))}},{title:le("common.operate"),key:"operate",width:130,render:(ne,re)=>y().createElement("div",{className:"cl-table__cell-action"},y().createElement("span",{className:"cl-pointer",onClick:()=>ze(re)},le("common.edit")),y().createElement("span",{className:"cl-pointer",onClick:()=>dt(re)},le("common.delete")))}],Dt=function(){var ne=(0,A.Z)(oe().mark(function re(ge){var ye,me,St,ke;return oe().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:if(!ge.user.length){te.next=16;break}return ye=ge.user.map(ce=>ce.id).join(","),te.prev=2,te.next=5,$({userIds:ye});case 5:me=te.sent,St=me.data.users,ke=St.map(ce=>{var be={department_infos:ce.department_infos,user_name:ce.user_name,source_type:ce.source_type,user_id:ce.user_id,department_ids:ce.department_ids,id:ce.id,items:[],content:[]},Me=J.length?J.findIndex(Ye=>Ye.id===ce.id):-1;return Me>-1&&(be.items=J[Me].items,be.content=J[Me].content),be}),_t(ke),L(ge.user),Xe(!1),te.next=16;break;case 13:te.prev=13,te.t0=te.catch(2),console.warn(te.t0);case 16:case"end":return te.stop()}},re,null,[[2,13]])}));return function(ge){return ne.apply(this,arguments)}}(),Pt=()=>{se(!1)},It=()=>{_t(m()(J,{[vt()]:{content:{$set:ht(_e.items)},items:{$set:_e.items}}})),se(!1)},mt=ne=>{var re=[],ge=ye=>{Array.isArray(ye)&&ye.length&&ye.forEach(me=>{Ie.disable.includes(me.id)||re.push(me.id),ge(me.children)})};return ge(ne),re},ht=ne=>{var re=[],ge=ye=>{Array.isArray(ye)&&ye.length&&ye.forEach(me=>{ne.includes(me.id)&&re.push(me.name),ge(me.children)})};return ge(tt),re},Ge=function(){var ne=(0,A.Z)(oe().mark(function re(){var ge;return oe().wrap(function(me){for(;;)switch(me.prev=me.next){case 0:return me.prev=0,me.next=3,I();case 3:ge=me.sent,ge.code==="200000"&&(Qe(ge.data),lt(mt(ge.data))),me.next=10;break;case 7:me.prev=7,me.t0=me.catch(0),console.warn(me.t0,"");case 10:case"end":return me.stop()}},re,null,[[0,7]])}));return function(){return ne.apply(this,arguments)}}(),ze=ne=>{pe(ne),gt(ne),se(!0)},dt=ne=>{var re=J.filter(ye=>ye.id!==ne.id),ge=u.filter(ye=>ye.id!==ne.id);_t(re),L(ge)},at=ne=>{pe(m()(_e,{items:{$set:ne.target.checked?He.filter(re=>!Ie.disable.includes(re)):[]}}))},bt=(ne,re,ge)=>{var ye=ge==="all"?mt([re]):[re.id];ne.target.checked?_e.items.includes(re.id)||pe(m()(_e,{items:{$push:ye}})):pe(m()(_e,{items:{$set:f()(_e.items,me=>!ye.includes(me))}})),tt.forEach(me=>{if(me.children.length){var St=me.children.every(ke=>_e.items.includes(ke.id));St&&!_e.items.includes(me.id)&&pe(m()(_e,{items:{$push:[me.id]}}))}})},ct=()=>{if(!J.length){P.default.warn(le("setting.handOverMinLimit"));return}e.Z.confirm({title:le("setting.submitNoCancel"),content:le("setting.submitNoCancelTips"),onOk:function(){var ne=(0,A.Z)(oe().mark(function ge(){var ye,me;return oe().wrap(function(ke){for(;;)switch(ke.prev=ke.next){case 0:return ke.prev=0,ye=J.map(Ut=>({handed_to:Ut.id,items:Ut.items})),ke.next=4,B({handed_from:we.id,details:ye});case 4:me=ke.sent,me.code==="200000"&&(P.default.success(le("setting.handOverSuccess")),Be()),ke.next=10;break;case 8:ke.prev=8,ke.t0=ke.catch(0);case 10:case"end":return ke.stop()}},ge,null,[[0,8]])}));function re(){return ne.apply(this,arguments)}return re}()})},vt=()=>J.findIndex(ne=>ne.id===_e.id),gt=ne=>{if(J.length>1){var re=[];J.forEach(ye=>{re=re.concat(ye.items)});var ge=re.filter(ye=>!ne.items.includes(ye));Ve(m()(Ie,{disable:{$set:ge},enable:{$set:He.filter(ye=>!ge.includes(ye))}}))}else Ve(m()(Ie,{disable:{$set:[]},enable:{$set:He}}))},ft={okText:le("common.ok"),cancelText:le("common.cancel"),size:"large",destroyOnClose:!0,maskClosable:!1},Lt=(0,U.Z)((0,U.Z)({},ft),{},{okText:le("common.submit"),visible:Oe,onCancel:st,onOk:ct,title:le("common.associate")}),Zt=(0,U.Z)((0,U.Z)({},ft),{},{visible:he,onCancel:Pt,onOk:It,title:le("setting.editHandoverContent")});return y().createElement(y().Fragment,null,y().createElement(k.Z,{title:le("setting.addHandover"),maxUserCount:10,beyondLimitTip:le("setting.handOverMaxLimit"),initData:{user:u},onlyUser:!0,visible:Ke,onOk:Dt,onCancel:()=>Xe(!1)}),y().createElement(ae.ZP,Lt,y().createElement("div",{className:Y()["associate-wrapper"]},y().createElement("div",{className:Y()["wrapper-header"]},y().createElement(j.Z,{type:"primary",onClick:()=>Xe(!0)},le("setting.addHandover"))),y().createElement("div",{className:Y()["wrapper-table"]},y().createElement(ue.f,{ref:rt,dataSource:J,columns:Tt,rowKey:ne=>ne.id,scroll:{x:"max-content",y:"100%"},pagination:!1,toolBarRender:null,headerTitle:null,tableUUID:"60c0b052-c4cf-4b37-9536-69ba77f1f31f"})))),y().createElement(ae.ZP,Zt,y().createElement("div",{className:Y()["associate-content"]},y().createElement("div",{className:Y()["associate-content-title"]},le("setting.waitHandoverContent"),":"),y().createElement(G.Z,{onChange:at,checked:_e.items.length&&Ie.enable.length===_e.items.length,disabled:Ie.disable.length===He.length},le("eTouch.selectAll")),tt.map(ne=>y().createElement(Te,{key:ne.id,checkedIds:_e.items||[],disabledIds:Ie.disable,options:ne,onChange:bt})))))},fe=(0,_.Z)()(Ae)},42706:function(Ne,ie,s){"use strict";var H=s(34669),j=s(82833),U=s(66456),x=s(55313),e=s(43185),g=s(53251),P=s(62029),A=s(57663),v=s(71577),N=s(57361),Z=s(34792),E=s(48086),G=s(9754),C=s.n(G),z=s(12924),W=s.n(z),oe=s(91768),F=s(28216),y=s(18329),_=s(84874),h=s(37055),m=s(10237),T=s(31457),f={downloadTemplate:h.ZP.Organization.downloadTemplate,getParseProcess:h.ZP.Organization.getParseProcess,uploadTemplate:h.ZP.Organization.uploadTemplate,uploadWXTemplate:h.ZP.multiTerminalLogin.nameWXUpload,getParseWXProcess:h.ZP.multiTerminalLogin.getParseWXProcess,importUserGroups:h.ZP.Organization.importUserGroups,importUserInfo:h.ZP.Organization.importUserInfo,downloadByJobNumber:h.ZP.Organization.downloadByJobNumber};class D extends z.Component{constructor(M){var K;super(M);K=this,this.cancelExportUser=()=>{var I=this.props.onHideModal;I&&I()},this.sureExportUser=()=>{var I=this.state.exportUserConfirmConfig;I.okButtonProps.disabled=!0,this.setState({exportUserConfirmConfig:I}),this.props.groupId?this.groupImportSure():this.deptImportSure()},this.groupImportSure=()=>{var I=this.props,B=I.groupId,$=I.onHideModal,k={file_name:this.state.fileName};this.props.exportType==="jobNum"&&(k.type="jobNumber"),this.props.exportType==="phoneID"&&(k.type="mobile"),m.WY.post({url:"".concat(f.importUserGroups({groupId:B})),params:k}).then(O=>{O.data.code===0&&(E.default.success(O.data.msg),$&&$("success"))}).catch(()=>{$&&$()})},this.deptImportSure=()=>{var I=this.props,B=I.deptId,$=I.onHideModal;if(this.props.from){var k=this.state.fileName,O={file_name:k},S="".concat(h.ZP.multiTerminalLogin.nameWXSubmit());m.WY.post({url:S,data:O}).then(ae=>{ae.data.code===0?(E.default.success(ae.data.msg),$&&$("success")):$&&$()})}else m.WY.get({url:"".concat(f.importUserInfo({deptId:B}),"?file_name=").concat(this.state.fileName)}).then(ae=>{ae.data.code===0&&(E.default.success(ae.data.msg),$&&$("success"))}).catch(()=>{$&&$()})},this.downloadBy=()=>{this.props.exportType==="jobNum"?this.downLoadJobNumber():this.props.exportType==="phoneID"?this.downloadIphone():this.downloadAddressBook()},this.downloadIphone=(0,N.Z)(C().mark(function I(){var B,$,k;return C().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return B={type:"mobile"},$=f.downloadByJobNumber(),S.next=4,m.WY.get({url:$,params:B});case 4:k=S.sent,k.data.code===0&&((0,T.Pp)(K.props),E.default.success(K.props.t("study.compoundSucceed")));case 6:case"end":return S.stop()}},I)})),this.downLoadJobNumber=(0,N.Z)(C().mark(function I(){var B;return C().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.next=2,m.WY.get({url:f.downloadByJobNumber(),params:{type:"jobNumber"}});case 2:B=k.sent,B.data.code===0&&((0,T.Pp)(K.props),E.default.success(K.props.t("study.compoundSucceed")));case 4:case"end":return k.stop()}},I)})),this.downloadAddressBook=()=>{var I=this.props.organizationType,B="".concat(f.downloadTemplate(),"?download_type=group&sync_organization=").concat(I);m.WY.get({url:B}).then($=>{$.data.code===0&&((0,T.Pp)(this.props),E.default.success(this.props.t("study.compoundSucceed")))})},this.beforeUploadFile=()=>{var I=this.state.exportUserConfirmConfig;I.okButtonProps.disabled=!0,this.setState({progress:0,errorList:[],exportUserConfirmConfig:I}),this.getProgress()},this.exportTemplate=I=>{var B=this.props.t,$=this.state.exportUserConfirmConfig;if(I.file.status==="done"){E.default.success("".concat(I.file.name," ").concat(B("setting.uploadSuccess")));var k=[{key:I.file.uid,file_name:I.file.name,success_count:I.file.response.data.success_count,failed_count:I.file.response.data.failed_count}];this.setState({fileList:k,progress:100,showUploadProgress:!1}),I.file.response.code===0&&($.okButtonProps.disabled=!1,this.setState({exportUserConfirmConfig:$,fileName:I.file.response.data.file_name}))}else if(I.file.status==="error"){E.default.error("".concat(I.file.name," ").concat(B("setting.uploadFail"))),clearInterval(this.ParseProcessTimer);var O=JSON.parse(I.file.response.message),S=[{key:I.file.uid,file_name:I.file.name,success_count:O.success_count,failed_count:O.failed_count}];I.file.response.code==="enterpriseapi.550001"&&this.setState({progress:0,showUploadProgress:!1,errorList:O.err_msg_list,fileList:S})}},this.getProgress=()=>{this.setState({showUploadProgress:!0}),this.ParseProcessTimer=setInterval(()=>{m.WY.get({url:this.props.from?f.getParseWXProcess():f.getParseProcess()}).then(I=>{I.data.code===0&&(this.setState({progress:Number(I.data.data)}),Number(I.data.data)>=100&&clearInterval(this.ParseProcessTimer))}).catch(()=>{clearInterval(this.ParseProcessTimer),this.setState({showUploadProgress:!1})})},2e3)},this.state={showUploadProgress:!1,progress:0,exportUserConfirmConfig:{title:M.t("setting.importUser"),size:"large",cancelText:M.t("common.cancel"),okText:M.t("common.ok"),onCancel:this.cancelExportUser,onOk:this.sureExportUser,okButtonProps:{disabled:!0}},fileList:[],errorList:[],uploadConfig:{name:"file",action:M.from?"".concat(f.uploadWXTemplate(),"?access_token=").concat(localStorage.getItem("token")):"".concat(f.uploadTemplate(),"?access_token=").concat(localStorage.getItem("token")),headers:{authorization:"authorization-text","Enterprise-Id":localStorage.getItem("enterpriseId")},beforeUpload:this.beforeUploadFile,showUploadList:!1,accept:".xlsx"},fileName:""}}componentWillUnmount(){clearInterval(this.ParseProcessTimer)}componentDidMount(){var M=this.state.exportUserConfirmConfig,K=this.state.uploadConfig;this.props.exportType==="jobNum"?(M.title="".concat(this.props.t("personal.jobNumber")).concat(this.props.t("setting.multipleImport")),K.action="".concat(f.uploadTemplate(),"?access_token=").concat(localStorage.getItem("token"),"&type=jobNumber")):this.props.exportType==="phoneID"&&(M.title="".concat(this.props.t("setting.importPhoneID")).concat(this.props.t("setting.multipleImport")),K.action="".concat(f.uploadTemplate(),"?access_token=").concat(localStorage.getItem("token"),"&type=mobile")),this.setState({exportUserConfirmConfig:M,uploadConfig:K})}render(){var M=this.state,K=M.exportUserConfirmConfig,I=M.fileList,B=M.uploadConfig,$=M.showUploadProgress,k=M.progress,O=M.errorList,S=this.props,ae=S.exportUserModalVisible,ue=S.t,Te=S.from,Ae=[{title:ue("setting.fileName"),dataIndex:"file_name",key:"id"},{title:ue("setting.successLabel"),dataIndex:"success_count",width:100},{title:ue("setting.failLabel"),dataIndex:"failed_count",width:100,className:"last-column"}];return W().createElement(y.ZP,(0,P.Z)({},K,{visible:ae}),W().createElement("div",{className:"export-user-modal"},W().createElement("div",{className:"opreate-area"},Te?W().createElement("span",{className:"tips-wx"},ue("setting.importWXUserTipOfJob")):W().createElement("div",{className:"download"},W().createElement(v.Z,{type:"default",className:"delete-user-btn",onClick:this.downloadBy},W().createElement(_.Z,{iconClass:"iconf-download"}),this.props.exportType==="jobNum"||this.props.exportType==="phoneID"?ue("setting.downloadTemplate"):ue("setting.downloadContacts")),W().createElement("span",{className:"tips"},this.props.exportType==="jobNum"||this.props.exportType==="phoneID"?ue("setting.importUserTipOfJob"):ue("setting.importUserTip"))),W().createElement(g.Z,(0,P.Z)({className:"upload-excel"},B,{onChange:this.exportTemplate}),W().createElement(v.Z,{className:"export-user-btn",type:"primary"},W().createElement(_.Z,{iconClass:"iconf-upload-folder"}),ue("component.importLabel")))),W().createElement("div",{className:"display-area"},W().createElement(x.Z,{key:"group-table",dataSource:I,columns:Ae,bordered:!0,rowKey:fe=>fe.key,size:"middle"}),O.length>0?W().createElement("div",{className:"show-error-message"},W().createElement("div",{className:"tips"},W().createElement(_.Z,{iconClass:"icon-tishi"}),W().createElement("span",null,ue("component.errorTips"),"\uFF1A")),W().createElement("div",{className:"error-content"},O.map((fe,X)=>W().createElement("div",{key:X},fe)))):null),$?W().createElement("div",{className:"show-upload-progress"},W().createElement("span",{className:"label"},ue("setting.importing")),W().createElement(j.Z,{className:"upload-progress",percent:k,showInfo:!1,strokeWidth:8})):null))}}ie.Z=(0,F.$j)()((0,oe.Z)()(D))},13656:function(Ne,ie,s){"use strict";s.d(ie,{Z:function(){return m}});var H=s(47673),j=s(4107),U=s(57663),x=s(71577),e=s(34792),g=s(48086),P=s(71194),A=s(57016),v=s(57361),N=s(33565),Z=s(9754),E=s.n(Z),G=s(12924),C=s.n(G),z=s(91768),W=s(98489),oe=s(37055),F=s(10237);function y(T,f){var D=oe.ZP.Login.adminResetPassword(f);return F.WY.post({url:D,data:T})}var _=s(83940),h=T=>{var f=T.visible,D=T.hideResetPasswordModal,Y=T.t,M=T.userInfo,K=(0,G.useState)(""),I=(0,N.Z)(K,2),B=I[0],$=I[1],k=()=>{$(""),D()},O=function(){var ue=(0,v.Z)(E().mark(function Te(){var Ae,fe,X,le,Oe,Be;return E().wrap(function(we){for(;;)switch(we.prev=we.next){case 0:if(Ae=(0,W.ZX)("",B),!Ae){we.next=4;break}return A.Z.warning({title:Y("account.updateFailed"),content:Ae,centered:!0,okText:Y("common.ok")}),we.abrupt("return",!1);case 4:return fe={password:(0,_.v)(B),encrypt:1},we.next=7,y(fe,M.id);case 7:X=we.sent,le=X.data,Oe=le.code,Be=le.data,Oe===0&&Be&&(g.default.success(Y("account.updateSuccess")),k());case 10:case"end":return we.stop()}},Te)}));return function(){return ue.apply(this,arguments)}}(),S=ue=>{var Te=ue.target.value;$(Te)},ae=C().createElement("div",{className:"reset_modal_footer_btn"},C().createElement(x.Z,{onClick:k},Y("common.cancel")),C().createElement(x.Z,{key:"submit",type:"primary",onClick:O},Y("common.ok")));return C().createElement(A.Z,{title:Y("registerLogin.changePassword"),visible:f,footer:ae,onCancel:k,className:"reset_modal"},C().createElement("div",{className:"reset_modal_container"},C().createElement("div",{className:"modal_container_tip"},Y("registerLogin.inputNewPassword"),":"),C().createElement(j.Z.Password,{className:"modal_container_input",placeholder:Y("account.validatePassword"),maxLength:"20",value:B,onChange:S})))},m=(0,z.Z)()(h)},65971:function(Ne,ie,s){"use strict";s.r(ie),s.d(ie,{default:function(){return Ea}});var H=s(57361),j=s(9754),U=s.n(j),x=s(12924),e=s.n(x),g=s(91768),P=s(18106),A=s(88108),v=s(47673),N=s(4107),Z=s(22385),E=s(31097),G=s(34792),C=s(48086),z=s(28216),W=s(73218),oe=s(76570),F=s(62029),y=s(14781),_=s(53431),h=s(57663),m=s(71577),T=s(62350),f=s(75443),D=s(88986),Y=s(71194),M=s(57016),K=s(43358),I=s(34041),B=s(36202),$=s(85372),k=s(6793),O=s(10237),S=s(37055),ae=s(84874),ue=s(18329),Te=s(64262),Ae=N.Z.Search,fe=I.Z.Option,X={pageNumber:1,pageSize:20};function le(q,d){var i=S.ZP.AuthorizationAccount.removeAuth(),t={department_ids:[],user_ids:q};O.WY.delete({url:i,data:t}).then(()=>{C.default.success("\u89E3\u9664\u6388\u6743\u6210\u529F"),d&&d()}).catch(()=>{C.default.error("\u64CD\u4F5C\u5931\u8D25\uFF0C\u8BF7\u518D\u6B21\u5C1D\u8BD5")})}class Oe extends x.Component{constructor(d){var i;super(d);i=this,this.getAuthorizationCount=()=>{var t=S.ZP.AuthorizationAccount.getAuthorizationCount(),a=this.state.dialogConfig;O.WY.get({url:t}).then(r=>{var n=r.data,o=n.quotaUserCount,l=n.activeUserCount;a.title=this.renderDialogTitle(o,l,o-l),this.setState({dialogConfig:a,quotaUserCount:o,activeUserCount:l})})},this.renderDialogTitle=(t,a,r)=>{var n=this.props.t,o=window.localStorage.getItem("enterpriseName")||"\u9177\u5B66\u9662",l=localStorage.getItem("themeColor")||"#516ae6";return e().createElement("div",{className:"authorization-account-dialog-title"},e().createElement("h3",null,o,n("setting.authorizedLabel"),e().createElement("span",{className:"authorization-account-dialog-title-sub"},"(",n("setting.totalQuota"),e().createElement("span",{style:{color:l}},t,n("common.userUnit")),"\uFF1B",n("setting.remainingQuota"),e().createElement("span",{style:{color:l}},r,n("common.userUnit")),")")))},this.showDialog=()=>{var t=this.state.dialogConfig;t.visible=!0,X.pageNumber=1,X.pageSize=20,this.getAuthorizationCount(),this.getUserList(),this.setState({dialogConfig:t,currectSelectKeys:[]})},this.getUserList=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",a=i.state,r=a.filterDeptId,n=a.type,o=S.ZP.Organization.getDeptUser({deptId:r}),l=t||i.state.keyword,p={keyword:l,type:n,page_number:X.pageNumber,page_size:X.pageSize,recursion:!0,filter_auth:!0};O.WY.get({url:o,params:p}).then(c=>{c.data.list&&c.data.list.forEach(b=>{b.timeLabel=(0,k.p6)(b.create_time,"yyyy-MM-dd"),b.recent_login_time?b.lastLoginTime=(0,k.p6)(b.recent_login_time,"yyyy-MM-dd  hh:mm:ss"):b.lastLoginTime="",b.extend_list&&b.extend_list.map(Q=>{b[Q.column_key]=Q.protect_value})}),i.setState({userList:c.data.list||[],userTotal:c.data.total,currectSelectKeys:[]})})},this.pageChange=t=>{X.pageNumber=t,this.getUserList()},this.pageSizeChange=(t,a)=>{X.pageSize=a,this.getUserList()},this.onSearch=t=>{var a=t.target.value;X.pageNumber=1,this.getUserList(a)},this.handleSelectChange=t=>{this.setState({type:t},()=>{this.getUserList()})},this.onBtnSearch=t=>{X.pageNumber=1,this.getUserList(t)},this.handleSearchChange=t=>{var a=t.target.value;this.setState({keyword:a})},this.handleTreeSelectChange=(t,a)=>{X.pageNumber=1,this.setState({filterDeptId:t||1,filterDeptLabel:a||""},()=>{this.getUserList()})},this.handlePostSelectChange=t=>{this.setState({filterPostId:t},()=>{this.getUserList()})},this.rowSelection=t=>{this.setState({currectSelectKeys:t})},this.cancel=()=>{var t=this.state.dialogConfig;t.visible=!1,this.setState({dialogConfig:t})},this.sure=()=>{var t=this.state.dialogConfig;t.visible=!1,this.setState({dialogConfig:t})},this.addAuth=()=>{var t=this.props.t,a=S.ZP.AuthorizationAccount.addAuth(),r=this.state.selectDeptAndUser,n={user_ids:r.user.map(o=>o.id)};O.WY.post({url:a,data:n}).then(()=>{C.default.success(t("setting.authSuccess")),this.setState({selectDeptAndUser:{dept:[],user:[],post:[],group:[]},currectSelectKeys:[]}),this.getUserList(),this.getAuthorizationCount()}).catch(()=>{this.setState({selectDeptAndUser:{dept:[],user:[],post:[],group:[]},currectSelectKeys:[]})})},this.removeAuth=()=>{var t=this.state,a=t.dialogConfig,r=t.unActiveTipConfig;a.bodyMask=!0,this.setState({dialogConfig:a},()=>{var n=r.title,o=r.content;M.Z.confirm({title:n,content:o,onOk:()=>{this.sureRemoveAuth()},onCancel:()=>{this.cancelRemoveAuth()}})})},this.removeAuthCbk=()=>{this.setState({currectSelectKeys:[]},()=>{this.getUserList(),this.getAuthorizationCount()})},this.cancelRemoveAuth=()=>{var t=this.state.dialogConfig;t.bodyMask=!1,this.setState({dialogConfig:t})},this.sureRemoveAuth=()=>{var t=this.state,a=t.dialogConfig,r=t.currectSelectKeys;a.bodyMask=!1,this.setState({dialogConfig:a}),le(r,()=>{this.removeAuthCbk()})},this.showOrgDialog=()=>{var t=this.state.dialogConfig;t.bodyMask=!0,this.setState({showOrg:!0,dialogConfig:t})},this.onCancelOrg=()=>{var t=this.state.dialogConfig;t.bodyMask=!1,this.setState({showOrg:!1,dialogConfig:t})},this.onOkOrg=t=>{var a=this.state.dialogConfig;a.bodyMask=!1,this.setState({selectDeptAndUser:(0,D.Z)((0,D.Z)({},this.state.selectDeptAndUser),{},{user:t.users||[]}),showOrg:!1,dialogConfig:a},()=>{this.addAuth()})},this.getPlaceholder=()=>{var t=this.state.type,a=this.props.t,r=null;switch(t){case"job_number":r=a("searchInputPlaceholder.jobNumber");break;case"user_name":r=a("searchInputPlaceholder.userName");break;case"login_number":r=a("searchInputPlaceholder.loginBumberBase");break;case"email":r=a("searchInputPlaceholder.emailBase");break;default:r=a("searchInputPlaceholder.mobileNumber");break}return r},this.getTableColumn=()=>{var t=this.props.t,a=this.state.userList,r=a[0]&&a[0].extend_list?a[0].extend_list:[],n=[{title:t("setting.authTableUserName"),dataIndex:"user_name",key:"user_name",width:90,fixed:"left"},{title:t("personal.jobNumber"),dataIndex:"job_number",key:"job_number",width:100},{title:t("common.department"),dataIndex:"department_names",key:"department_names",width:150,render:o=>e().createElement(E.Z,{title:o},e().createElement("div",{className:"cl-text-ellipsis",style:{width:140}},o?o.join("\uFF0C"):""))},{title:t("component.belongPost"),dataIndex:"post_names",key:"post_names",width:150,render:o=>e().createElement(E.Z,{title:o},e().createElement("div",{className:"cl-text-ellipsis",style:{width:140}},o?o.join("\uFF0C"):""))},{title:t("marketing.loginEmail"),dataIndex:"login_email",key:"login_email",width:150,render:o=>o||"--"},{title:t("setting.joinTime"),dataIndex:"timeLabel",key:"timeLabel",width:120,render:o=>o||"--"}];return r.forEach(o=>{var l=o.column_value===t("searchInputPlaceholder.mobileOp")?"mobile":o.column_key;n.push({title:o.column_value,dataIndex:l,key:l,width:150})}),n.push({title:t("setting.activeStatus"),dataIndex:"active",key:"active",width:80,fixed:"right",render:o=>t(o==="true"?"setting.activeLabel":"setting.unActiveLabel")},{title:t("common.operate"),key:"operate",width:100,fixed:"right",render:(o,l)=>{var p=[l.id],c=localStorage.getItem("themeColor")||"#516ae6";return e().createElement(f.Z,{title:t("setting.removeAuthTip"),okText:t("setting.remove"),cancelText:t("common.cancel"),onConfirm:()=>le(p,this.removeAuthCbk)},e().createElement("span",{className:"unactive-label",style:{color:c}},t("setting.removeAuthLabel")))}}),n},this.renderLeftRow=()=>{var t=this.props.t,a=this.state,r=a.currectSelectKeys,n=a.quotaUserCount,o=a.activeUserCount,l=a.type,p=n-o>0?n-o:0;return e().createElement("div",{className:"authorization-account-top"},e().createElement(m.Z,{size:"small",type:"ghost",className:"authorization-account-top-unactive",disabled:r.length===0,onClick:this.removeAuth},t("setting.removeAuthLabel")),e().createElement(Te.Z,{parentId:"",checkable:!1,asyncLoad:!0,treeSelect:!0,className:"authorization-account-top-org",handleTreeSelectChange:this.handleTreeSelectChange}),e().createElement(N.Z.Group,{compact:!0},e().createElement(I.Z,{style:{width:"115px",display:"inline-block"},defaultValue:l,onChange:this.handleSelectChange},e().createElement(fe,{value:"user_name"},t("searchInputPlaceholder.userNameOp")),e().createElement(fe,{value:"job_number"},t("searchInputPlaceholder.jobNumberOp")),e().createElement(fe,{value:"login_number"},t("searchInputPlaceholder.loginNumber")),e().createElement(fe,{value:"email"},t("searchInputPlaceholder.email"))),e().createElement(Ae,{ref:c=>{this.mySearch=c},className:"authorization-account-top-search",onSearch:this.onBtnSearch,onChange:this.handleSearchChange,allowClear:!0,placeholder:t("searchInputPlaceholder.pleaseSelect")})),e().createElement(m.Z,{size:"small",type:"primary",disabled:p<=0,className:"authorization-account-top-active",onClick:this.showOrgDialog},t("setting.addAuthUser")))},this.state={dialogConfig:{visible:!1,mask:!0,bodyMask:!1,title:"",bodyStyle:{padding:"0 20px"},wrapClassName:"authorization-account",onCancel:this.cancel,footer:null,width:750},unActiveTipConfig:{title:d.t("setting.removeAuthTipTitle"),content:d.t("setting.removeAuthTip")},userType:"unactive",quotaUserCount:0,activeUserCount:0,showOrg:!1,selectDeptAndUser:{dept:[],post:[],group:[],user:[]},userList:[],userTotal:0,filterDeptId:1,filterPostId:"",filterDeptLabel:"",keyword:"",type:"user_name",currectSelectKeys:[]}}render(){var d=this.state,i=d.showOrg,t=d.userType,a=d.dialogConfig,r=d.currectSelectKeys,n=d.userTotal,o=d.userList,l=d.filterDeptLabel,p={columnWidth:50,selectedRowKeys:r,onChange:this.rowSelection},c=this.props,b=c.t,Q=c.organizationType,V=localStorage.getItem("themeColor")||"#516ae6";return e().createElement("div",{className:"authorization-account"},e().createElement("div",{className:"authorization-account-btn",style:{color:V},onClick:this.showDialog},e().createElement(ae.Z,{iconClass:"icon-quanxian"}),b("setting.authorizedAccount")),i?e().createElement($.Z,{onOk:this.onOkOrg,onCancel:this.onCancelOrg,tabs:["user"],chooseUserList:["immediate"],visible:i,title:b("setting.addAuth"),userType:t,okText:b("setting.authorizedLabel"),organizationType:Q}):null,e().createElement(ue.ZP,(0,F.Z)({},a,{bodyMask:!1}),e().createElement("div",{className:"authorization-account-body"},e().createElement("div",{className:"user-authorization-account-list"},e().createElement(B.f,{dataSource:o,columns:this.getTableColumn(),bordered:!0,rowKey:R=>R.id,size:"middle",pagination:!1,rowSelection:p,scroll:{y:"100%",x:750},headerTitle:this.renderLeftRow(),tableUUID:"3efa3641-44dd-4623-a9e7-04f8c3a8279c"}),e().createElement("div",{className:"authorization-account-list-pagination"},e().createElement("span",null,l.length>0?l:b("dashboard.authorized"),e().createElement("span",{className:"count",style:{color:V}},n),b("common.userUnit")),e().createElement(_.Z,{showSizeChanger:!0,size:"small",total:+n,onShowSizeChange:this.pageSizeChange,defaultPageSize:20,onChange:this.pageChange}))))))}componentWillUnmount(){X.pageNumber=1,X.pageSize=20}}var Be=(0,g.Z)()(Oe),st=s(59250),we=s(13013),rt=s(30887),xe=s(99210),$e=s(2871);class J extends x.Component{constructor(d){var i;super(d);i=this,this.showDeleteDeptTip=(0,H.Z)(U().mark(function t(){var a,r,n,o,l;return U().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return a=i.props,r=a.t,n=a.titleOperateProps,o=a.deptId,c.next=3,(0,$e.$)("DEPT",o,r("setting.deptLabel"));case 3:if(l=c.sent,!l){c.next=6;break}return c.abrupt("return");case 6:if(!i.state.hasClickDelete){c.next=8;break}return c.abrupt("return");case 8:i.setState({hasClickDelete:!0}),M.Z.confirm({title:i.props.t("common.delete"),content:"\u786E\u5B9A\u5220\u9664\u8BE5\u90E8\u95E8\uFF1F",onOk:()=>{n.remove(o),i.setState({hasClickDelete:!1})},onCancel:()=>{i.setState({hasClickDelete:!1})}});case 10:case"end":return c.stop()}},t)})),this.editDept=()=>{var t=this.props,a=t.titleOperateProps,r=t.deptId,n=t.deptName;a.edit(r,n)},this.addDept=()=>{var t=this.props,a=t.titleOperateProps,r=t.deptId;a.edit(r,"")},this.handleMenuClick=t=>{var a=t.key;switch(a){case"edit":this.editDept();break;case"delete":this.showDeleteDeptTip();break;case"add":this.addDept();break;default:break}},this.state={hasClickDelete:!1}}render(){var d=this.props,i=d.t,t=d.deptId,a=d.enableEdit,r=a===void 0?!0:a,n=d.enableDelete,o=n===void 0?!0:n,l=e().createElement(xe.Z,{onClick:this.handleMenuClick},t!=="1"&&r&&e().createElement(xe.Z.Item,{key:"edit"},i("common.edit")),t!=="1"&&o&&e().createElement(xe.Z.Item,{key:"delete"},i("common.delete")),e().createElement(xe.Z.Item,{key:"add"},i("setting.addNextDept")));return e().createElement("div",{className:"dept tree-node-title"},e().createElement(E.Z,{title:this.props.title},e().createElement("span",{className:"tooltip-span"},this.props.title)),e().createElement(we.Z,{overlay:l},e().createElement(m.Z,{className:"tree-node-operate"},e().createElement(ae.Z,{iconClass:"icon-icon_morex"}))))}}J.defaultProps={};var _t=(0,g.Z)()(J),Fe=s(59239),et=s(55446);class Ke extends e().Component{constructor(d){super(d);this.inputDeptName=t=>{var a=t.target.value;this.setState({deptName:a.trim()})},this.cancelAddDept=()=>{this.props.onAddCbk("cancel")},this.saveAddDept=()=>{var t=this.props,a=t.t,r=t.deptId;if(this.state.deptName.trim().length===0){C.default.error(a("setting.addDeptTip"));return}var n=this.props.type==="add"?S.ZP.Organization.addDept():S.ZP.Organization.editDept({deptId:r}),o={access_token:window.localStorage.getItem("token"),name:this.state.deptName};this.props.type==="add"?o.parent_id=r:o.department_id=r,O.WY.post({url:n,data:o}).then(l=>{l.data.id||l.data.result==="true"?(this.props.onAddCbk("success"),C.default.success(this.props.type==="add"?a("common.addSuccess"):a("common.editSuccess"))):l.data.msg&&C.default.error(l.data.msg)})};var i=e().createElement(m.Z,{key:"submit",type:"primary",onClick:this.saveAddDept},d.t("common.ok"));this.state={deptName:this.props.initValue,addDeptModal:{mask:!0,size:"small",footer:i,onCancel:this.cancelAddDept}}}render(){var d=this.props.t;return e().createElement(ue.ZP,(0,F.Z)({},this.state.addDeptModal,{visible:this.props.visible,title:this.props.type==="add"?d("common.add"):d("common.edit")}),e().createElement("div",{className:"add-user-group-body"},e().createElement(Fe.Z,null,e().createElement(Fe.Z.Item,{label:d("setting.deptLabel"),className:"add-user-group-label"},e().createElement(N.Z,{placeholder:d("setting.addDeptTip"),value:this.state.deptName,onInput:this.inputDeptName,className:"add-user-group-input",maxLength:50})))))}}Ke.defaultProps={type:"add",initValue:"",deptId:"",visible:!1,onAddCbk:()=>{}};var Xe=(0,g.Z)()(Ke),it=q=>({userInfo:q.user});class Ue extends x.Component{constructor(d){super(d);this.loadedRoot=i=>{this.props.onSelectNode&&this.props.onSelectNode(i.id,i.department_name)},this.getEnterpriseInfo=()=>{var i=S.ZP.Organization.getEnterpriseInfo();O.WY.get({url:i}).then(t=>{this.setState({isVip:t.data.isVip})})},this.onSearch=(i,t)=>{var a=typeof t!="undefined"?t:i.target.value;if(a.trim().length===0){this.clearSearch();return}var r=S.ZP.Organization.queryDept(),n={department_name:a,filter_auth:!0};O.WY.get({url:r,params:n}).then(o=>{this.setState({searchDeptResult:o.data.departments,isSearch:!0})})},this.inputSearchText=i=>{var t=i.target.value;this.setState({searchText:t})},this.clearSearch=()=>{this.setState({searchDeptResult:[],searchText:"",isSearch:!1})},this.treeNodeClick=(i,t)=>{var a=t.node;this.setState({activeDeptId:i[0]}),this.props.onSelectNode&&this.props.onSelectNode(i[0],"".concat(a.dataRef.department_name,"(").concat(a.dataRef.user_count,")"))},this.removeDept=i=>{var t=S.ZP.Organization.removeDept({deptId:i});O.WY.post({url:t}).then(()=>{C.default.success(this.props.t("common.deleteSuccess")),this.setState({refresh:this.state.refresh+1})})},this.showAddDept=(i,t)=>{this.setState({showAddDept:!0,currentDeptId:i,editDeptName:t})},this.onAddDeptCbk=i=>{this.setState({showAddDept:!1}),i==="success"&&this.setState({refresh:this.state.refresh+1})},this.onImportUserCbk=()=>{this.setState({refresh:this.state.refresh+1})},this.renderTree=()=>{var i=this.props,t=i.organizationType,a=i.tabStatus,r=a===void 0?"":a,n={remove:this.removeDept,edit:this.showAddDept};return e().createElement("div",{className:"org-tree-padding-wrapper",style:r?{height:"calc(100vh - 379px )"}:{}},e().createElement(Te.Z,{parentId:"",checkable:!1,asyncLoad:!0,showUserCount:!0,showTitleToolTip:!0,refresh:this.state.refresh,DeptTreeNodeTitle:_t,titleOperateProps:n,handleSelect:this.treeNodeClick,handleLoadedCbk:this.loadedRoot,organizationType:t}))},this.renderSearchResult=()=>{var i=this.props,t=i.t,a=i.tabStatus,r=a===void 0?"":a,n=this.state.searchDeptResult.map(o=>e().createElement(E.Z,{title:"".concat(o.department_name,"(").concat(o.user_count).concat(t("common.userUnit"),")"),key:o.id},e().createElement("div",{className:this.state.activeDeptId===o.id?"org-tree-search-one active":"org-tree-search-one",key:o.id,onClick:()=>this.treeNodeClick([o.id],{node:{dataRef:{department_name:o.department_name,user_count:o.user_count}}})},o.path&&"".concat(o.path.slice(1).join("-")).concat(o.path.length>1?"-":"").concat(o.department_name,"(").concat(o.user_count).concat(t("common.userUnit"),")"))));return e().createElement("div",{className:"org-tree-search-result",style:r?{height:"calc(100vh - 379px )"}:{}},n)},this.state={searchDeptResult:[],isSearch:!1,searchText:"",activeDeptId:"",isVip:0,showAddDept:!1,editDeptName:"",currentDeptId:"",refresh:0}}componentDidMount(){this.getEnterpriseInfo(),this.props.onRef&&this.props.onRef(this)}render(){var d=this.props,i=d.t,t=d.organizationType,a=this.state.searchText.length>0?e().createElement(W.Z,{onClick:this.clearSearch}):e().createElement(oe.Z,{onClick:r=>this.onSearch(r,this.state.searchText)});return e().createElement("div",{className:"org-tree-container dept"},e().createElement(N.Z,{className:"org-tree-search",value:this.state.searchText,placeholder:i("searchInputPlaceholder.department"),onInput:this.inputSearchText,onPressEnter:this.onSearch,suffix:a}),e().createElement("div",{className:"org-tree-operate"},this.state.isVip===2||this.state.isVip===5||this.state.isVip===6||this.state.isVip===8?e().createElement(Be,{organizationType:t}):null),this.state.isSearch?this.renderSearchResult():this.renderTree(),this.state.showAddDept?e().createElement(Xe,{visible:this.state.showAddDept,initValue:this.state.editDeptName,deptId:this.state.currentDeptId,type:this.state.editDeptName.length>0?"edit":"add",onAddCbk:this.onAddDeptCbk}):null)}}Ue.defaultProps={onSelectNode:()=>{}};var tt=(0,z.$j)(it)((0,g.Z)()(Ue)),Qe=s(32157),nt=s(75869),Re=s(49101),u=s(62999),L=s(85733),de=s(25547);class ee extends e().Component{constructor(d){super(d);this.getPostList=()=>{var t=this.props,a=t.type,r=t.postId;O.WY.get({url:S.ZP.Organization.getPostGroupTree(),params:{post_group_id:a==="add"?"":r}}).then(n=>{var o=(0,de.NP)(n.data.post_groups,{id:"value",post_group_name:"title"});this.setState({postList:o})})},this.cancelAddPostGroup=()=>{this.props.onAddCbk("cancel")},this.saveAddPostGroup=()=>{var t=this.props,a=t.t,r=t.form,n=t.type,o=t.postId,l=n==="add";r.validateFields((p,c)=>{if(!p){var b=c.postName,Q=c.superiorPostId,V,R={post_group_name:(0,k.fy)(b),parent_id:Q||""};l?V=S.ZP.Organization.addPostGroup():V=S.ZP.Organization.editPostGroup({id:o}),O.WY[l?"post":"put"]({url:V,data:R}).then(()=>{this.props.onAddCbk("success"),C.default.success(a(l?"common.addSuccess":"common.editSuccess"))})}})},this.checkPostName=(t,a,r)=>{var n=this.props.t;if(a){r();return}r(n("setting.addPostGroupCheckNameTip"))};var i=e().createElement(m.Z,{key:"submit",type:"primary",onClick:this.saveAddPostGroup},d.t("common.ok"));this.state={postName:this.props.initValue,superiorPostId:this.props.superiorPostId==="1"?void 0:this.props.superiorPostId,postList:[],addPostGroupModal:{mask:!0,size:"small",footer:i,onCancel:this.cancelAddPostGroup}}}componentDidMount(){this.getPostList()}render(){var d=this.props,i=d.t,t=d.form,a=t.getFieldDecorator,r=this.state,n=r.postName,o=r.superiorPostId,l=r.postList;return e().createElement(ue.ZP,(0,F.Z)({},this.state.addPostGroupModal,{visible:this.props.visible,title:this.props.type==="add"?i("setting.addPostGroup"):i("setting.editPostGroup")}),e().createElement("div",{className:"add-post-group-body"},e().createElement(Fe.Z,null,e().createElement(Fe.Z.Item,{label:i("setting.postGroup"),required:!0,className:"add-post-group-label"},a("postName",{initialValue:n,rules:[{validator:this.checkPostName}]})(e().createElement(N.Z,{placeholder:i("setting.addPostGroupNameTip"),className:"add-post-group-input",maxLength:10}))),e().createElement(Fe.Z.Item,{label:i("setting.superiorPostGroup"),className:"add-post-group-label"},a("superiorPostId",{initialValue:o})(e().createElement(L.Z,{style:{width:348},dropdownStyle:{maxHeight:300,overflow:"auto"},treeData:l,placeholder:i("setting.superiorPostGroupTip"),allowClear:!0,treeDefaultExpandAll:!0}))))))}}ee.defaultProps={type:"add",initValue:"",visible:!1,postId:"",onAddCbk:()=>{}};var he=Fe.Z.create({name:"addPostGroup"})((0,g.Z)()(ee)),se=s(54549),Le=s(88311),Ze=s(2396);class _e extends e().Component{constructor(d){super(d);this.getPostList=()=>{var t=this.props,a=t.type,r=t.currentPostId;O.WY.get({url:S.ZP.Organization.getPostGroupTree(),params:{show_leaf_node:!0,post_group_id:a==="add"?"":r}}).then(n=>{var o=(0,de.NP)(n.data.post_groups,{id:"value",post_group_name:"title"});this.setState({postList:o})})},this.getPostLeader=()=>{var t=S.ZP.Organization.getPostLeader(),a={postId:this.props.currentPostId,id:this.props.currentPostId,pageSize:20};O.WY.get({url:t,params:a}).then(r=>{r.data.code===0&&this.setState({postLeader:{user:r.data.data.userList,dept:[]},parentId:r.data.data.parentId,postName:r.data.data.depathmentName})})},this.showOrgDialog=()=>{this.setState({orgDialogVisible:!0})},this.cancelAddPost=()=>{this.props.onAddCbk("cancel")},this.checkPostName=(t,a,r)=>{var n=this.props.t;if(a){r();return}r(n("setting.addPostCheckNameTip"))},this.checkSuperiorPostId=(t,a,r)=>{var n=this.props.t;if(a){r();return}r(n("setting.superiorPostGroupTip"))},this.saveAddPost=()=>{var t=this.props,a=t.t,r=t.type,n=t.currentPostId,o=r==="add";this.props.form.validateFields((l,p)=>{if(!l){var c=p.postName,b=p.superiorPostId,Q,V={post_name:(0,k.fy)(c),post_group_id:b};o?Q=S.ZP.Organization.addPost():Q=S.ZP.Organization.editPost({id:n}),O.WY[o?"post":"put"]({url:Q,data:V}).then(()=>{this.props.onAddCbk("success"),C.default.success(this.props.type==="add"?a("common.addSuccess"):a("common.editSuccess"))})}})},this.addPostLeader=t=>{this.setState({orgDialogVisible:!1}),this.setState({postLeader:{dept:t.dept,user:t.user}})},this.cancelOrg=()=>{this.setState({orgDialogVisible:!1})},this.removeOneLeader=t=>{var a=[...this.state.postLeader.dept],r=[...this.state.postLeader.user],n=a.findIndex(l=>l.id===t),o=r.findIndex(l=>l.id===t);n!==-1?a.splice(n,1):o!==-1&&r.splice(o,1),this.setState({postLeader:{dept:a,user:r}})},this.renderPostLeader=()=>{var t=[...this.state.postLeader.dept,...this.state.postLeader.user].map(a=>e().createElement("span",{className:"post-leader-one",key:a.id},a.name,e().createElement(se.Z,{onClick:r=>{r.stopPropagation(),this.removeOneLeader(a.id)}})));return t};var i=e().createElement(m.Z,{key:"submit",type:"primary",onClick:this.saveAddPost},d.t("common.ok"));this.state={postName:"",superiorPostId:this.props.superiorPostId==="1"?void 0:this.props.superiorPostId,postList:[],orgDialogVisible:!1,postLeader:{dept:[],user:[]},parentId:"",addPostModal:{mask:!0,size:"small",footer:i,onCancel:this.cancelAddPost}}}componentDidMount(){this.props.type==="edit"&&this.getPostLeader(),this.getPostList()}render(){var d=this.props,i=d.t,t=d.form,a=t.getFieldDecorator,r=this.state,n=r.postName,o=r.superiorPostId,l=r.postList;return e().createElement(ue.ZP,(0,F.Z)({},this.state.addPostModal,{visible:this.props.visible,title:this.props.type==="add"?i("setting.addPost"):i("setting.editPost"),bodyMask:this.state.orgDialogVisible}),e().createElement("div",{className:"add-post-body"},e().createElement(Fe.Z,null,e().createElement(Fe.Z.Item,{label:i("common.post"),required:!0,className:"add-post-label"},a("postName",{initialValue:n,rules:[{validator:this.checkPostName}]})(e().createElement(N.Z,{placeholder:i("setting.addPostNameTip"),className:"add-post-input",maxLength:32,onInput:p=>(0,Ze.q_)(p,32)}))),e().createElement(Fe.Z.Item,{label:i("setting.postGroup"),required:!0,className:"add-post-group-label"},a("superiorPostId",{initialValue:o,rules:[{validator:this.checkSuperiorPostId}]})(e().createElement(L.Z,{style:{width:348},dropdownStyle:{maxHeight:300,overflow:"auto"},treeData:l,placeholder:i("setting.superiorPostGroupTip"),allowClear:!0,treeDefaultExpandAll:!0}))))),e().createElement(Le.Z,{visible:this.state.orgDialogVisible,onOk:this.addPostLeader,displayType:["dept"],initData:this.state.postLeader,modalConfig:{mask:!1},onCancel:this.cancelOrg}))}}_e.defaultProps={type:"add",currentPostId:"",visible:!1,onAddCbk:()=>{}};var pe=Fe.Z.create({name:"addPos"})((0,g.Z)()(_e)),Ee=s(20136),Pe=s(55241);class Ie extends x.Component{constructor(d){var i;super(d);i=this,this.handleCommonDeletePostTip=function(){var t=(0,H.Z)(U().mark(function a(r){var n,o,l,p,c,b=arguments;return U().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return n=b.length>1&&b[1]!==void 0?b[1]:"post",o=i.props,l=o.t,p=o.postId,V.next=4,(0,$e.$)("POST",p,l("setting.postLabel"));case 4:if(c=V.sent,!c){V.next=7;break}return V.abrupt("return");case 7:i.beforeDeleteTip(r,n).then(()=>{n==="post"?i.sureDeletePost():i.sureDeletePostGroup()});case 8:case"end":return V.stop()}},a)}));return function(a){return t.apply(this,arguments)}}(),this.beforeDeleteTip=(t,a)=>(t.stopPropagation(),new Promise(r=>{this.setState({popoverVisible:!1},()=>{var n=a==="post"?this.state.deletePostConfirmConfig:this.state.deletePostGroupConfirmConfig,o=n.title,l=n.content;M.Z.confirm({title:o,content:l,onOk:()=>{r()}})})})),this.handlePopoverVisible=t=>{this.setState({popoverVisible:t})},this.handleAddPostGroup=t=>{t.stopPropagation(),this.setState({popoverVisible:!1},()=>{var a=S.ZP.Organization.getPostGroupNodeInfo({id:this.props.postId});O.WY.get({url:a}).then(r=>{var n=r.data.post_group_level;n==="3"?C.default.warning(this.props.t("setting.isLevel3Tip")):this.props.addPostGroup(this.props.postId,"add")})})},this.handleEditPostGroup=t=>{var a=this.props,r=a.postId,n=a.dataRef;t.stopPropagation(),this.setState({popoverVisible:!1},()=>{this.props.updatePostGroupName(r,n)})},this.handleAddPost=t=>{t.stopPropagation(),this.setState({popoverVisible:!1},()=>{this.props.addPost(this.props.postId,"add",this.props.postId)})},this.sureDeletePostGroup=()=>{var t=this.props,a=t.t,r=t.postId,n=S.ZP.Organization.deletePostGroup({id:r});O.WY.delete({url:n}).then(()=>{C.default.success(a("announcement.deleteSucceed")),this.props.deletePostCbk("success")})},this.handleEditPost=t=>{var a=this.props,r=a.postId,n=a.superiorPostId;t.stopPropagation(),this.setState({popoverVisible:!1},()=>{this.props.addPost(r,"edit",n)})},this.sureDeletePost=()=>{var t=this.props,a=t.t,r=t.postId,n=S.ZP.Organization.deletePost({id:r});O.WY.delete({url:n}).then(o=>{if(o.data.deleted==="false"){var l="",p=JSON.parse(o.data.msg),c=[];for(var b in p)p[b]==="1"&&c.push(b);c.forEach(V=>{switch(V){case"isPostModelAbility":l+="".concat(a("personnelDevelope.isPostModelAbility"),"/");break;case"isPostStudyFunction":l+="".concat(a("personnelDevelope.isPostStudyFunction"),"/");break;case"isPostQualifications":l+="".concat(a("personnelDevelope.isPostQualifications"),"/");break;case"isPostChannel":l+="".concat(a("personnelDevelope.isPostChannel"),"/");break;default:break}});var Q=l.lastIndexOf("/");l="".concat(l.substring(0,Q),"\uFF0C").concat(a("personnelDevelope.noDelete")),C.default.error(l)}else C.default.success(a("announcement.deleteSucceed")),this.props.deletePostCbk("success")})},this.state={deletePostConfirmConfig:{title:d.t("common.delete"),content:d.t("setting.deletePostTip")},deletePostGroupConfirmConfig:{title:d.t("common.delete"),content:d.t("setting.deletePostGroupTip")},popoverVisible:!1}}renderPopoverDom(d,i){var t=this.props,a=t.type,r=t.userCount,n=null;return a==="create"?n=e().createElement(Pe.Z,{placement:"bottom",visible:this.state.popoverVisible,onVisibleChange:this.handlePopoverVisible,content:d,trigger:"hover"},e().createElement(m.Z,{className:"tree-node-operate"},e().createElement(ae.Z,{iconClass:"icon-icon_morex"}))):r===0&&(n=e().createElement(Pe.Z,{placement:"bottom",title:"",content:i,trigger:"hover"},e().createElement(m.Z,{className:"tree-node-operate"},e().createElement(ae.Z,{iconClass:"icon-icon_morex"})))),n}render(){var d=this.props,i=d.t,t=d.isPostGroup,a=d.dataRef,r=e().createElement("div",{className:"tree-node-operate-menu"},e().createElement("div",{onClick:o=>{this.handleCommonDeletePostTip(o)}},i("common.delete"))),n;return t?n=e().createElement("div",{className:"tree-node-operate-menu"},e().createElement("div",{onClick:o=>{this.handleCommonDeletePostTip(o,"postGroup")}},i("common.delete")),e().createElement("div",{onClick:this.handleEditPostGroup},i("common.edit")),e().createElement("div",{onClick:this.handleAddPost},i("setting.addPost")),a.post_group_level&&a.post_group_level!=="3"?e().createElement("div",{onClick:this.handleAddPostGroup},i("setting.addPostGroup")):null):n=e().createElement("div",{className:"tree-node-operate-menu"},e().createElement("div",{onClick:this.handleEditPost},i("common.edit")),e().createElement("div",{onClick:o=>{this.handleCommonDeletePostTip(o)}},i("common.delete"))),e().createElement("div",{className:"tree-node-title"},e().createElement(E.Z,{title:this.props.title},e().createElement("span",{className:"tooltip-span"},this.props.title)),this.renderPopoverDom(n,r))}}Ie.defaultProps={postId:"",isPostGroup:"",title:"",type:"create",deletePostCbk:()=>{},updatePostGroupName:()=>{},addPost:()=>{},addPostGroup:()=>{}};var Ve=(0,g.Z)()(Ie),ot=nt.Z.TreeNode,qe=q=>({treeData:q.organization.postData,hidePosts:q.organization.hidePosts,activePostId:q.organization.activePostId});class He extends x.Component{constructor(d){var i;super(d);i=this,this.onSearch=()=>{var t=this.props.organizationType,a=S.ZP.Organization.getPostTree();if(!this.state.searchText||this.state.searchText&&this.state.searchText.trim().length===0){this.setState({searchDeptResult:[],searchText:"",isSearch:!1});return}var r={filter_auth:!0,post_name:this.state.searchText,sync_organization:t||""};O.WY.get({url:a,params:r}).then(n=>{this.setState({searchPostResult:n.data.posts,isSearch:!0})})},this.onAddPostGroupCbk=t=>{this.setState({showAddPostGroup:!1,editPostGroupName:"",currentOperatePost:""}),t==="success"&&this.props.dispatch({type:"organization/getPostTreeData",payload:{changeActive:!1}})},this.onExpand=(t,a)=>{var r=a.expanded,n=a.node,o=[...this.state.expandedKeys],l=n.props.dataRef.id,p=o.indexOf(l);r?o.push(l):o.splice(p,1),this.setState({expandedKeys:o})},this.inputSearchText=t=>{var a=t.target.value;this.setState({searchText:a})},this.clearSearch=()=>{this.setState({searchDeptResult:[],searchText:"",isSearch:!1})},this.treeNodeClick=(t,a)=>{var r=a.node.props.dataRef.id,n=a.node.props.dataRef.type;if(a.node.props.dataRef.post_group_level){var o=[...this.state.expandedKeys],l=o.indexOf(r);l!==-1?o.splice(l,1):o.push(r),this.setState({expandedKeys:o});return}if(this.props.onSelectNode){if(r===this.props.activePostId)return;this.props.dispatch({type:"organization/setActivePost",payload:{postId:t[0],postType:n}})}},this.searchResultClick=(t,a)=>{if(this.props.onSelectNode){if(t===this.props.activePostId)return;this.props.dispatch({type:"organization/setActivePost",payload:{postId:t,postType:a}})}},this.addPostGroup=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0;i.setState({showAddPostGroup:!0,currentOperatePostGroup:t})},this.deletePostCbk=t=>{t==="success"&&this.props.dispatch({type:"organization/getPostTreeData",payload:{changeActive:!0}})},this.updatePostGroupName=(t,a)=>{this.setState({showAddPostGroup:!0,editPostGroupName:a.post_name,currentOperatePost:t,currentOperatePostGroup:a.parent_id})},this.addPost=(t,a,r)=>{this.setState({showAddPost:!0,currentOperatePost:t,currentOperatePostGroup:r,addPostType:a})},this.addPostCbk=t=>{this.setState({showAddPost:!1,currentOperatePost:""}),t==="success"&&this.props.dispatch({type:"organization/getPostTreeData",payload:{changeActive:!1}})},this.renderTreeNodes=t=>{var a=this.props,r=a.t,n=a.hidePosts;return t.map(o=>{var l={postId:o.id,title:n?"".concat(o.post_name):"".concat(o.post_name,"(").concat(o.user_count).concat(r("common.userUnit"),")"),isPostGroup:!!o.post_group_level,superiorPostId:o.parent_id,deletePostCbk:this.deletePostCbk,updatePostGroupName:this.updatePostGroupName,addPost:this.addPost,addPostGroup:this.addPostGroup,type:o.type,dataRef:(0,D.Z)({},o),userCount:o.user_count};return o.children?e().createElement(ot,{className:o.children?"parent-node":"",title:e().createElement(Ve,l),key:o.id,isLeaf:!1,dataRef:o},this.renderTreeNodes(o.children)):e().createElement(ot,(0,F.Z)({},o,{className:this.props.activePostId===o.id?"active-node":o.children?"parent-node":"",dataRef:o,key:o.id,isLeaf:!0,title:e().createElement(Ve,l)}))})},this.renderSearchResult=()=>{var t=this.props,a=t.t,r=t.tabStatus,n=r===void 0?"":r,o=t.hidePosts,l=this.state.searchPostResult.map(p=>e().createElement("div",{className:this.props.activePostId===p.id?"org-tree-search-one active":"org-tree-search-one",key:p.id,onClick:()=>this.searchResultClick(p.id,p.type)},p.post_name,o?"":"(".concat(p.user_count).concat(a("common.userUnit"),")")));return e().createElement("div",{className:"org-tree-search-result",style:n?{height:"calc(100vh - 379px )"}:{}},l)},this.state={searchPostResult:[],isSearch:!1,searchText:"",showAddPostGroup:!1,editPostGroupName:"",currentOperatePost:"",currentOperatePostGroup:void 0,showAddPost:!1,addPostType:"",expandedKeys:[]}}componentDidMount(){this.props.dispatch({type:"organization/getPostTreeData",payload:{changeActive:!0}})}render(){var d=this.props,i=d.t,t=d.tabStatus,a=t===void 0?"":t,r=this.state.searchText.length>0?e().createElement(W.Z,{onClick:this.clearSearch}):e().createElement(oe.Z,{onClick:this.onSearch}),n=localStorage.getItem("themeColor")||"#516ae6";return e().createElement("div",{className:"org-tree-container post"},e().createElement(N.Z,{className:"org-tree-search",value:this.state.searchText,placeholder:i("searchInputPlaceholder.post"),onInput:this.inputSearchText,onPressEnter:this.onSearch,suffix:r}),e().createElement("div",{className:"add-post-group",style:{color:n},onClick:()=>this.addPostGroup()},e().createElement(Re.Z,null)," ",i("setting.addPostGroup")),this.state.showAddPostGroup?e().createElement(he,{visible:this.state.showAddPostGroup,initValue:this.state.editPostGroupName,postId:this.state.currentOperatePost,superiorPostId:this.state.currentOperatePostGroup,type:this.state.editPostGroupName.length>0?"edit":"add",onAddCbk:this.onAddPostGroupCbk}):null,this.state.isSearch?this.renderSearchResult():e().createElement("div",{className:"post-group-padding-tree",style:a?{height:"calc(100vh - 379px )"}:{}},e().createElement(nt.Z,{showLine:{showLeafIcon:!1},expandedKeys:this.state.expandedKeys,onSelect:this.treeNodeClick,onExpand:this.onExpand},this.renderTreeNodes(this.props.treeData))),this.state.showAddPost?e().createElement(pe,{visible:this.state.showAddPost,type:this.state.addPostType,currentPostId:this.state.currentOperatePost,superiorPostId:this.state.currentOperatePostGroup,onAddCbk:this.addPostCbk}):null)}}He.defaultProps={onSelectNode:()=>{}};var lt=(0,z.$j)(qe)((0,g.Z)()(He)),Tt=s(63185),Dt=s(9676);class Pt extends e().Component{constructor(d){super(d);this.inputGroupName=t=>{this.setState({groupName:t.target.value})},this.cancelAddUserGroup=()=>{this.props.onAddCbk("cancel")},this.saveAddUserGroup=()=>{var t=this.props.t;if(this.state.groupName.trim().length===0){C.default.error(t("setting.addUserGroupTip"));return}var a=this.props.type==="add"?S.ZP.Organization.addUserGroup():S.ZP.Organization.updateUserGroup(),r={access_token:window.localStorage.getItem("token"),name:this.state.groupName,id:this.props.type==="add"?"":this.props.groupId};O.qg.post({url:a,data:r}).then(n=>{n.data.code===0?(this.props.onAddCbk("success"),C.default.success(this.props.type==="add"?t("common.addSuccess"):t("common.editSuccess"))):n.data.msg&&C.default.error(n.data.msg)})};var i=e().createElement(m.Z,{key:"submit",type:"primary",onClick:this.saveAddUserGroup},d.t("common.ok"));this.state={groupName:this.props.initValue,addUserGroupModal:{mask:!0,size:"small",footer:i,onCancel:this.cancelAddUserGroup}}}render(){var d=this.props.t;return e().createElement(ue.ZP,(0,F.Z)({},this.state.addUserGroupModal,{visible:this.props.visible,title:this.props.type==="add"?d("common.add"):d("common.edit")}),e().createElement("div",{className:"add-user-group-body"},e().createElement(Fe.Z,null,e().createElement(Fe.Z.Item,{label:d("setting.groupLabel"),className:"add-user-group-label"},e().createElement(N.Z,{placeholder:d("setting.addUserGroupTip"),value:this.state.groupName,onInput:this.inputGroupName,className:"add-user-group-input",maxLength:15})))))}}Pt.defaultProps={type:"add",initValue:"",groupId:"",visible:!1,onAddCbk:()=>{}};var It=(0,g.Z)()(Pt),mt=s(37882),ht=q=>({groupList:q.organization.groupData,activeGroupId:q.organization.activeGroupId});class Ge extends x.Component{constructor(d){var i;super(d);i=this,this.onSearch=()=>{this.props.dispatch({type:"organization/getGroupTreeData",payload:{keyword:this.state.keyword,only_see_me:this.state.only_see_me,changeActive:!1}})},this.clearSearch=()=>{this.setState({keyword:""},()=>{this.saveSearchParam()}),this.props.dispatch({type:"organization/getGroupTreeData",payload:{keyword:"",only_see_me:this.state.only_see_me,changeActive:!1}})},this.saveSearchParam=()=>{this.props.dispatch({type:"organization/setGroupSearchParams",payload:{keyword:this.state.keyword,only_see_me:this.state.only_see_me}})},this.inputSearchText=t=>{var a=t.target.value;this.setState({keyword:a},()=>{this.saveSearchParam()})},this.addUserGroup=()=>{this.setState({showAddUserGroup:!0,editUserGroupName:""})},this.onAddUserGroupCbk=t=>{this.setState({showAddUserGroup:!1}),t==="success"&&this.props.dispatch({type:"organization/getGroupTreeData",payload:{keyword:this.state.keyword,only_see_me:this.state.only_see_me,changeActive:!1}})},this.editGroup=(t,a)=>{var r=this.state.popoverVisible;Object.keys(r).forEach(n=>{r[n]=!1}),this.setState({editUserGroupName:a,currentOperateGroup:t,showAddUserGroup:!0,popoverVisible:r})},this.deleteGroup=function(){var t=(0,H.Z)(U().mark(function a(r){var n,o;return U().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,$e.$)("USER_GROUP",r,i.props.t("component.userGroup"));case 2:if(n=p.sent,!n){p.next=5;break}return p.abrupt("return");case 5:o=i.state.popoverVisible,Object.keys(o).forEach(c=>{o[c]=!1}),i.setState({currentOperateGroup:r,popoverVisible:o},()=>{var c=i.state.deleteGroupConfirmConfig,b=c.title,Q=c.content;M.Z.confirm({title:b,content:Q,onOk:()=>{i.sureDeleteUserGroup()}})});case 8:case"end":return p.stop()}},a)}));return function(a){return t.apply(this,arguments)}}(),this.cancelDeleteUserGroup=()=>{this.setState({currentOperateGroup:""})},this.sureDeleteUserGroup=()=>{var t=this.props.t,a=S.ZP.Organization.deleteUserGroup(),r={access_token:window.localStorage.getItem("token"),groupId:this.state.currentOperateGroup};mt.qg.post({url:a,data:r}).then(n=>{n.data.code===0?(C.default.success(t("cart.deleteSuccess")),this.setState({currentOperateGroup:""}),this.props.dispatch({type:"organization/getGroupTreeData",payload:{keyword:this.state.keyword,only_see_me:this.state.only_see_me,changeActive:!0}})):n.data.code===1?this.setState({currentOperateGroup:""}):(C.default.error(n.data.msg?n.data.msg:t("announcement.deleteFailed")),this.setState({currentOperateGroup:""}))})},this.treeNodeClick=t=>{this.props.onSelectNode&&this.props.dispatch({type:"organization/setActiveGroup",payload:{groupId:t}})},this.hanldeVisibleChange=t=>{var a=t.visible,r=t.id;this.setState(n=>({popoverVisible:(0,D.Z)((0,D.Z)({},n.popoverVisible),{},{["".concat(r)]:a})}))},this.renderGroupList=()=>{var t=this.props,a=t.t,r=t.tabStatus,n=r===void 0?"":r;if(!this.props.groupList)return null;var o=this.props.groupList.map(l=>{var p=e().createElement("div",{className:"org-group-operate-menu"},e().createElement("div",{onClick:c=>{c.stopPropagation(),this.editGroup(l.id,l.group_name)}},a("common.edit")),e().createElement("div",{onClick:c=>{c.stopPropagation(),this.deleteGroup(l.id)}},a("common.delete")));return e().createElement("div",{className:this.props.activeGroupId===l.id?"org-group-tree-one active":"org-group-tree-one",key:l.id,onClick:c=>this.treeNodeClick(l.id,c)},e().createElement(E.Z,{title:"".concat(l.group_name,"(").concat(l.user_count).concat(a("common.userUnit"),")"),key:l.id},e().createElement("span",null,l.group_name,"(",l.user_count,a("common.userUnit"),")")),e().createElement(Pe.Z,{placement:"bottom",title:"",content:p,visible:this.state.popoverVisible[l.id]||!1,onVisibleChange:c=>this.hanldeVisibleChange({visible:c,id:l.id}),trigger:"hover"},e().createElement(m.Z,{className:"org-group-tree-operate-icon"},e().createElement(ae.Z,{iconClass:"icon-icon_morex"}))))});return e().createElement("div",{className:"org-group-tree-list",style:n?{height:"calc(100vh - 411px )"}:{}},o)},this.searchMyCreate=t=>{this.setState({only_see_me:t.target.checked},()=>{this.onSearch(),this.saveSearchParam()})},this.state={keyword:"",only_see_me:!1,showAddUserGroup:!1,editUserGroupName:"",currentOperateGroup:"",deleteGroupConfirmConfig:{title:d.t("common.delete"),content:d.t("setting.removeGroupTip")},popoverVisible:{}}}componentDidMount(){this.props.dispatch({type:"organization/getGroupTreeData",payload:{keyword:this.state.keyword,only_see_me:this.state.only_see_me,changeActive:!0}})}componentWillUnmount(){this.props.dispatch({type:"organization/resetActiveId"})}render(){var d=this.props.t,i=this.state.keyword.length>0?e().createElement(W.Z,{onClick:this.clearSearch}):e().createElement(oe.Z,{onClick:this.onSearch});return e().createElement("div",{className:"org-tree-container group"},e().createElement(N.Z,{className:"org-tree-search",value:this.state.keyword,placeholder:d("searchInputPlaceholder.userGroup"),onInput:this.inputSearchText,onPressEnter:this.onSearch,suffix:i}),e().createElement("div",{className:"group-button"},e().createElement("div",{className:"add-user-group",onClick:this.addUserGroup},e().createElement(Re.Z,null)," ",d("setting.addUserGroup")),e().createElement("div",null,e().createElement(Dt.Z,{checked:this.state.only_see_me,onChange:this.searchMyCreate},d("common.myCreated")))),this.state.showAddUserGroup?e().createElement(It,{visible:this.state.showAddUserGroup,initValue:this.state.editUserGroupName,groupId:this.state.currentOperateGroup,type:this.state.editUserGroupName.length>0?"edit":"add",onAddCbk:this.onAddUserGroupCbk}):null,this.renderGroupList())}}Ge.defaultProps={onSelectNode:()=>{}};var ze=(0,z.$j)(ht)((0,g.Z)()(Ge)),dt=A.Z.TabPane;class at extends x.Component{constructor(d){super(d);this.changeTab=i=>{var t=this.props.changeDisplayType;t&&typeof t=="function"&&t({activeTab:i})},this.handleDeptNode=(i,t)=>{this.props.onSelectNode({type:"dept",activeId:i,title:t})},this.handlePostNode=i=>{this.props.onSelectNode({type:"post",activeId:i,title:""})},this.handleGroupNode=i=>{this.props.onSelectNode({type:"group",activeId:i,title:""})},this.activeKeyChange=i=>{var t=this.props.changeDisplayType;t&&typeof t=="function"&&t({activeTab:i}),this.setState({activeKey:i})},this.state={activeKey:"dept"}}componentDidMount(){this.props.onRef&&this.props.onRef(this)}render(){var d=this.props,i=d.type,t=d.organizationType,a=d.tabStatus,r=a===void 0?"":a,n=this.state.activeKey,o=n===void 0?"":n;return e().createElement("div",{className:"orgbox-container"},e().createElement(A.Z,{activeKey:o,onChange:this.activeKeyChange,centered:!0},e().createElement(dt,{tab:this.props.t("setting.deptLabel"),key:"dept"},e().createElement(tt,{type:i,onSelectNode:this.handleDeptNode,organizationType:t,tabStatus:r,onRef:l=>{this.deptTreeRef=l}})),e().createElement(dt,{tab:this.props.t("setting.postLabel"),key:"post"},e().createElement(lt,{onSelectNode:this.handlePostNode,tabStatus:r})),e().createElement(dt,{tab:this.props.t("setting.groupLabel"),key:"group"},e().createElement(ze,{onSelectNode:this.handleGroupNode,tabStatus:r}))))}}at.defaultProps={onSelectNode:()=>{}};var bt=(0,g.Z)()(at),ct=s(93485),vt=s(33565),gt=s(57119),ft=s(90631),Lt=s(3255),Zt=s(13656),ne=s(70775),re=s(66456),ge=s(55313),ye=s(43185),me=s(53251),St=s(88983),ke=s(47933),Ut=s(31457),te={downloadTemplate:S.ZP.Organization.zdDownloadTemplate,uploadTemplate:S.ZP.Organization.zdUploadTemplate,importUserInfo:S.ZP.Organization.zdImportSubmit};class ce extends x.Component{constructor(d){super(d);this.cancelExportUser=()=>{var i=this.props.onHideModal;i&&i()},this.sureExportUser=()=>{var i=this.props,t=i.onHideModal,a=i.t,r=this.state,n=r.fileName,o=r.exportUserConfirmConfig,l=r.operateType;o.okButtonProps.disabled=!0,this.setState({exportUserConfirmConfig:o});var p="".concat(te.importUserInfo(),"?new_file_name=").concat(n,"&operation_type=").concat(l);O.WY.post({url:p}).then(c=>{c.data.result==="true"&&(C.default.success(a("courseClaim.importSuccess")),t&&t("success"))}).catch(()=>{t&&t()})},this.downloadAddressBook=()=>{var i=this.props,t=i.deptId,a=i.organizationType,r=this.state.operateType,n="".concat(te.downloadTemplate(),"?access_token=").concat(localStorage.getItem("token"),"&operation_type=").concat(r,"&department_id=").concat(t,"&sync_organization=").concat(a);O.WY.get({url:n}).then(o=>{o.data.code===0&&((0,Ut.Pp)(this.props),C.default.success(this.props.t("study.compoundSucceed")))})},this.beforeUploadFile=i=>{var t=this.state.exportUserConfirmConfig,a=this.props.t;t.okButtonProps.disabled=!0;var r=i.size/1024/1024<2;if(!r)return C.default.error(a("component.templateImportLimitTip")),!1;this.setState({exportUserConfirmConfig:t})},this.changeOperateType=i=>{var t=this.state.uploadConfig;t.action="".concat(te.uploadTemplate(),"?access_token=").concat(localStorage.getItem("token"),"&operation_type=").concat(i.target.value),this.setState({operateType:i.target.value,uploadConfig:t})},this.exportTemplate=i=>{var t=this.props.t,a=this.state,r=a.exportUserConfirmConfig,n=a.operateType,o=a.addErrorList,l=a.updateErrorList;if(i.file.status==="done"){C.default.success("".concat(i.file.name," ").concat(t("setting.uploadSuccess")));var p=[{key:i.file.uid,file_name:i.file.name,success_count:i.file.response.success_count,failed_count:i.file.response.failed_count}];n==="add"?this.setState({addFileList:p}):this.setState({updateFileList:p}),i.file.response.result==="true"?(r.okButtonProps.disabled=!1,this.setState({exportUserConfirmConfig:r,fileName:i.file.response.new_file_name,addErrorList:n==="add"?i.file.response.error_msg_list:o,updateErrorList:n==="add"?l:i.file.response.error_msg_list})):i.file.response.error_msg_list&&(n==="add"?this.setState({addErrorList:i.file.response.error_msg_list}):this.setState({updateErrorList:i.file.response.error_msg_list}))}else if(i.file.status==="error"){C.default.error("".concat(i.file.name," ").concat(t("setting.uploadFail")));var c=[{key:i.file.uid,file_name:i.file.name,success_count:i.file.response.success_count,failed_count:i.file.response.failed_count}];i.file.response.error_msg_list&&(n==="add"?this.setState({addErrorList:i.file.response.error_msg_list,addFileList:c}):this.setState({updateErrorList:i.file.response.error_msg_list,updateFileList:c}))}},this.state={exportUserConfirmConfig:{title:d.t("setting.zdImportUser"),size:"oversized",cancelText:d.t("common.cancel"),okText:d.t("common.ok"),onCancel:this.cancelExportUser,onOk:this.sureExportUser,okButtonProps:{disabled:!0}},updateFileList:[],updateErrorList:[],addFileList:[],addErrorList:[],uploadConfig:{name:"file",action:"".concat(te.uploadTemplate(),"?access_token=").concat(localStorage.getItem("token"),"&operation_type=add"),headers:{authorization:"authorization-text","Enterprise-Id":localStorage.getItem("enterpriseId")},beforeUpload:this.beforeUploadFile,showUploadList:!1,accept:".xlsx"},fileName:"",operateType:"add"}}render(){var d=this.state,i=d.exportUserConfirmConfig,t=d.uploadConfig,a=d.operateType,r=d.addErrorList,n=d.addFileList,o=d.updateErrorList,l=d.updateFileList,p=this.props,c=p.exportUserModalVisible,b=p.t,Q=[{title:b("setting.fileName"),dataIndex:"file_name",key:"id"},{title:b("setting.successLabel"),dataIndex:"success_count",width:100},{title:b("setting.failLabel"),dataIndex:"failed_count",width:100,className:"last-column"}];return e().createElement(ue.ZP,(0,F.Z)({},i,{visible:c}),e().createElement("div",{className:"export-user-modal"},e().createElement("div",{className:"operate-type"},e().createElement(ke.ZP.Group,{value:a,onChange:this.changeOperateType},e().createElement(ke.ZP.Button,{value:"add"},b("setting.zdAddUSer")),e().createElement(ke.ZP.Button,{value:"update"},b("setting.zdUpdateUser")))),e().createElement("div",{className:"opreate-area"},e().createElement("div",{className:"download"},e().createElement(m.Z,{type:"default",className:"delete-user-btn",onClick:this.downloadAddressBook},e().createElement(ae.Z,{iconClass:"iconf-download"}),b(a==="add"?"evaluationManage.downLoadTemplate":"setting.downloadContacts")),e().createElement("span",{className:"tips"},b(a==="add"?"setting.importTemplateTips":"setting.importUserTip"))),e().createElement(me.Z,(0,F.Z)({className:"upload-excel"},t,{onChange:this.exportTemplate}),e().createElement(m.Z,{className:"export-user-btn",type:"primary"},e().createElement(ae.Z,{iconClass:"iconf-upload-folder"}),b("component.importLabel")))),e().createElement("div",{className:"display-area"},e().createElement(ge.Z,{key:"group-table",dataSource:a==="add"?n:l,columns:Q,bordered:!0,rowKey:V=>V.key,size:"middle"}),a==="add"&&r.length>0?e().createElement("div",{className:"show-error-message"},e().createElement("div",{className:"tips"},e().createElement(ae.Z,{iconClass:"icon-tishi"}),e().createElement("span",null,b("component.errorTips"),"\uFF1A")),e().createElement("div",{className:"error-content"},r.map((V,R)=>e().createElement("div",{key:R,className:"error_list"},V)))):null,a==="update"&&o.length>0?e().createElement("div",{className:"show-error-message"},e().createElement("div",{className:"tips"},e().createElement(ae.Z,{iconClass:"icon-tishi"}),e().createElement("span",null,b("component.errorTips"),"\uFF1A")),e().createElement("div",{className:"error-content"},o.map((V,R)=>e().createElement("div",{key:R,className:"error_list"},V)))):null)))}}var be=(0,z.$j)()((0,g.Z)()(ce)),Me=s(76343);class Ye extends e().Component{constructor(d){super(d);this.beforeUpload=t=>{var a=["jpeg","jpg","png"],r=t.type.split("/").pop(),n=a.indexOf(r.toLocaleLowerCase())>-1;n||C.default.error("\u4E0A\u4F20\u683C\u5F0F\u53EA\u80FD\u662F JPG/JPEG/PNG!");var o=t.size/1024/1024<2;return o||C.default.error("\u4E0A\u4F20\u56FE\u7247\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC72M!"),n&&o},this.customRequest=t=>{this.setState({imgFile:t.file,imgUploaderVisible:!0})},this.cancelEditUserField=()=>{this.props.onCancel()},this.saveEditUserField=()=>{var t=this.state,a=t.editField,r=t.imageUrl,n=this.props.t,o=/^[\w]{15,18}$/,l=/^1[\d]{10}$/,p=!1,c=[];if(Object.keys(a).forEach(R=>{c.push({column_key:R,extend_value:a[R].value}),a[R].title==="\u8EAB\u4EFD\u8BC1\u53F7"?(0,k.fy)(a[R].value)!==""&&!a[R].value.match(o)&&(a[R].error="\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u8EAB\u4EFD\u8BC1\u53F7",p=!0):a[R].title==="\u624B\u673A\u53F7"&&(0,k.fy)(a[R].value)!==""&&!a[R].value.match(l)&&(a[R].error="\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7",p=!0)}),this.setState({editField:a}),!p){var b=S.ZP.Organization.setUserFieldValue(),Q=this.props.userInfo,V={user_id:Q.user_id,extend_list:c,face_url:r};O.WY.post({url:b,data:V}).then(R=>{R.data.code===0?(C.default.success("\u7F16\u8F91\u6210\u529F"),this.props.onOk()):R.data.code===1&&R.data.msg==="enterpriseapi.574013"&&C.default.warn(n("component.supervisorErrorTip"))})}},this.handleInput=(t,a)=>{var r=this.state.editField;r[a].value=t.target.value,r[a].error="",this.setState({editField:r})},this.handleCloseImgUpload=()=>{this.setState({imgUploaderVisible:!1})},this.handleUploadSuccess=t=>{var a=t.imgUrl;this.checkFaceImg(a,()=>{this.setState({imgUploaderVisible:!1,imageUrl:a})})},this.handleOrg=t=>{this.setState({orgDialogVisible:t})},this.checkFaceImg=(t,a)=>{var r=S.ZP.Organization.checkImgFace(),n={type:0,imageUrl:t};O.WY.post({url:r,data:n}).then(o=>{o.status===200&&o.data&&o.data.result==="true"&&a()})},this.handleSelectSupervisor=t=>{var a=t.user,r=a===void 0?[]:a,n=this.state.editField,o=r[0]||{},l=o.name,p=o.id;n.reports_to.value={name:l,id:p},this.setState({orgDialogVisible:!1,editField:n})};var i=e().createElement(m.Z,{key:"submit",type:"primary",onClick:this.saveEditUserField},d.t("common.ok"));this.state={addUserFieldModal:{mask:!0,size:"small",footer:i,onCancel:this.cancelEditUserField},editField:{},imgUploaderVisible:!1,imageUrl:"",imgSizeLimited:2,orgDialogVisible:!1}}componentDidUpdate(d){if(d.visible!==this.props.visible&&this.props.visible){var i=this.props.userInfo,t={};i.extend_list.forEach(a=>{t[a.column_key]={error:"",value:a.extend_value||"",title:a.column_value||""}}),this.setState({editField:t,imageUrl:i.face_url||""})}}render(){var d=this.props,i=d.t,t=d.userInfo,a=this.state,r=a.editField,n=a.imgUploaderVisible,o=a.imgFile,l=a.imgSizeLimited,p=a.orgDialogVisible;return e().createElement("div",null,e().createElement(ue.ZP,(0,F.Z)({},this.state.addUserFieldModal,{visible:this.props.visible,title:i("setting.userFieldInfo")}),e().createElement("div",{className:"edit-user-field"},e().createElement("div",{className:"field-item"},e().createElement("div",{className:"field-item-label"},i("common.userName"),":"),e().createElement("div",{className:"field-item-value"},t.user_name)),e().createElement("div",{className:"field-item"},e().createElement("div",{className:"field-item-label"},i("personal.jobNumber"),":"),e().createElement("div",{className:"field-item-value"},t.job_number)),e().createElement("div",{className:"field-item"},e().createElement("div",{className:"field-item-label"},i("common.department"),":"),e().createElement("div",{className:"field-item-value"},t.department_names?t.department_names.join("\uFF0C"):"")),r.reports_to&&e().createElement("div",{className:"field-item"},e().createElement("div",{className:"field-item-label"},i("component.directSupervisor"),":"),e().createElement("div",{className:"field-item-value"},e().createElement(Le.Z,{visible:p,onlyUser:!0,single:!0,initData:{user:r.reports_to.value.id?[r.reports_to.value]:[]},onOk:this.handleSelectSupervisor,onCancel:()=>this.handleOrg(!1)}),e().createElement("div",{className:"direct-supervisor-box"},e().createElement(N.Z,{placeholder:"",value:r.reports_to.value.name,disabled:!0}),e().createElement(m.Z,{className:"direct-supervisor-box-btn",icon:e().createElement(Re.Z,null),onClick:()=>this.handleOrg(!0)},i("component.chooseSupervisor"))))),e().createElement("div",{className:"field-item"},e().createElement("div",{className:"field-item-label"},i("component.belongPost"),":"),e().createElement("div",{className:"field-item-value"},t.post_names?t.post_names.join("\uFF0C"):"")),t.extend_list?t.extend_list.map(c=>e().createElement("div",{className:"field-item",key:c.column_value},e().createElement("div",{className:"field-item-label"},c.column_value,":"),e().createElement("div",{className:"field-item-value"},e().createElement(N.Z,{placeholder:"\u8BF7\u8F93\u5165".concat(c.column_value),value:r[c.column_key]?r[c.column_key].value:"",maxLength:60,onInput:b=>this.handleInput(b,c.column_key)}),r[c.column_key]&&r[c.column_key].error&&e().createElement("p",{className:"field-item-value-tip"},r[c.column_key].error)))):null)),n&&e().createElement(Me.Z,{file:o,sizeLimit:l,isShowMsg:!1,sizeLimitUnit:"MB",widthScale:5,heightScale:7,onCancel:this.handleCloseImgUpload,onOk:this.handleUploadSuccess,visible:n}))}}Ye.defaultProps={visible:!1,onOk:()=>{},onCancel:()=>{}};var At=(0,g.Z)()(Ye),$t=s(77576),Yt=s(59314),Jt=s(64630),Qt=s(54681),Xt=s(24144),wt=s(60667),Ft=s(26885);class Gt extends e().Component{constructor(d){var i;super(d);i=this,this.onUploadChange=a=>{var r=a.fileList,n=r.length>0?r[0].url:"";this.checkFaceImg("".concat(n),()=>{this.setState({imageUrl:n})})},this.cancelAddUser=()=>{this.props.onCancel()},this.handleSaveAddUser=()=>{var a=this.state,r=a.editField,n=a.imageUrl,o=a.qyWeChatVo,l=this.props,p=l.type,c=l.userInfo,b=l.t,Q=/^[\w]{15,18}$/,V=/^[0-9-]+$/,R=/^[A-Za-z0-9]{0,20}$/,Se=/\b[\w.%+-]+@[\w.-]+\.[a-zA-Z]{2,6}\b/,w=!1,ve=[],je="";if(Object.keys(r).forEach((Je,xt)=>{xt>6&&ve.push({column_key:Je,extend_value:r[Je].value}),r[Je].title==="\u8EAB\u4EFD\u8BC1\u53F7"&&(je=(0,k.fy)(r[Je].value),r[Je].value&&(0,k.fy)(r[Je].value)!==""&&!r[Je].value.match(Q)&&(r[Je].error="\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u8EAB\u4EFD\u8BC1\u53F7",w=!0))}),r.user_name.value.trim()===""&&(r.user_name.error="\u8BF7\u8F93\u5165\u59D3\u540D",w=!0),r.mobile.value.trim()===""&&(r.mobile.error="\u8BF7\u8F93\u5165\u624B\u673A\u53F7\u7801",w=!0),(0,k.fy)(r.mobile.value)!==""&&!r.mobile.value.match(V)&&(r.mobile.error="\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7",w=!0),(0,k.fy)(r.email.value)!==""&&!r.email.value.match(Se)&&(r.email.error="\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u90AE\u7BB1",w=!0),r.job_number.value.match(R)||(r.job_number.error="\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u5DE5\u53F7, 20\u4F4D\u4EE5\u5185\u7684\u6570\u5B57\u52A0\u5B57\u6BCD",w=!0),r.dept.value.length===0&&(r.dept.error="\u8BF7\u9009\u62E9\u90E8\u95E8",w=!0),this.setState({editField:r}),!w){var pt=p==="edit"?S.ZP.Organization.editUser():S.ZP.Organization.addUser(),Ct={name:r.user_name.value,mobile:r.mobile.value,email:r.email.value,department_ids:r.dept.value||[],post_ids:r.post.value||[],job_number:r.job_number.value||"",reports_to:r.reports_to.value,qy_we_chat_vo:o,extend_list:ve,face_url:n};p==="edit"&&(Ct.id=c.id),O.WY.post({url:pt,data:Ct}).then(()=>{C.default.success(b(p==="edit"?"common.editSuccess":"common.addSuccess")),this.props.onOk();var Je=localStorage.isSubsidyEnterprise==="true"&&je;p==="edit"&&Je&&this.setSubsidyPhoto(je,n)}).catch(()=>{})}},this.handleInput=(a,r)=>{var n=this.state.editField;r==="user_name"&&(0,Ze.$s)(a.target.value)>50&&(a.target.value=a.target.value.substring(0,(0,Ze.rw)(a.target.value,50))),n[r].value=a.target.value.trim(),n[r].error="",this.setState({editField:n})},this.handlePostSelectChange=a=>{var r=this.state.editField;r.post.value=a,r.post.error="",this.setState({editField:r})},this.handleTreeSelectChange=a=>{var r=this.state.editField;r.dept.value=a,r.dept.error="",this.setState({editField:r})},this.handleSwitch=a=>{a?this.setState({cropType:""}):this.setState({cropType:"crop"})},this.checkFaceImg=(a,r)=>{var n=this.props.t,o=S.ZP.Organization.checkImgFace(),l={type:0,imageUrl:a};O.WY.post({url:o,data:l}).then(p=>{p.status===200&&p.data&&p.data.result==="true"&&r()}).catch(p=>{if(p.response){var c=p.response.data.code;c==="enterpriseapi.568007"&&M.Z.error({title:n("faceImageModalInfo.title"),content:e().createElement("div",null,e().createElement("div",null,n("faceImageModalInfo.contentTitle"),": "),e().createElement("div",null,"1. ",n("faceImageModalInfo.contentTip1")),e().createElement("div",null,"2. ",n("faceImageModalInfo.contentTip2"))),width:600,okText:n("localStorage.onKnow")})}})},this.setSubsidyPhoto=function(){var a=(0,H.Z)(U().mark(function r(n,o){var l,p,c;return U().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return l=S.ZP.subsidyGz.setSubsidyPhoto(),p=(0,D.Z)({ercunPhotoUrl:o,cardNo:n},Qt.Z),Q.next=4,O.WY.post({url:l,data:p});case 4:c=Q.sent,c.data.returnCode==="0"&&C.default.success("\u7F16\u8F91\u6210\u529F\uFF0C\u5E7F\u5DDE\u76D1\u7BA1\u5E73\u53F0\u7167\u7247\u66F4\u65B0\u6210\u529F");case 6:case"end":return Q.stop()}},r)}));return function(r,n){return a.apply(this,arguments)}}(),this.handleSelectSupervisor=function(a){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=a.user,o=n===void 0?[]:n,l=i.state.editField,p=o[0]||{},c=p.name,b=p.id,Q=p.unionid,V=p.user_id,R=p.source_type;l.reports_to.value={name:c,id:b,sync_user_id:Q||V,sync_source_type:R,user_id:V,source_type:R},r||(delete l.reports_to.value.id,l.reports_to.value.name=l.reports_to.value.sync_user_id),i.setState({orgDialogVisible:!1,editField:l})},this.handleSelectWx=()=>{var a=this.props.user,r=[this.state.editField.reports_to.value.sync_user_id];(0,Ft.Sk)({userIds:r,mode:"single"}).then(n=>{(0,Ft.$f)({result:n,user:a,rangeType:"onlyDeptUser",hasDefault:!1}).then(o=>{var l=o.qyWeChatVo,p=o.rangeList;this.setState({qyWeChatVo:l},()=>{this.handleSelectSupervisor(p,!1)})})}).catch(()=>{this.setState({orgDialogVisible:!1})})},this.handleOrg=a=>{var r=localStorage.getItem("authorityType"),n=this.props.user.loginMode;a&&n==="WE_COM"&&r==="1"?this.handleSelectWx():this.setState({orgDialogVisible:a})};var t=e().createElement(m.Z,{key:"submit",type:"primary",onClick:this.handleSaveAddUser},d.t("common.ok"));this.state={addUserFieldModal:{mask:!0,size:"small",footer:t,destroyOnClose:!0,onCancel:this.cancelAddUser},orgDialogVisible:!1,editField:{},imageUrl:"",cropType:"crop",qyWeChatVo:""}}componentDidUpdate(d){if(d.visible!==this.props.visible&&this.props.visible){var i=this.props,t=i.userInfo,a=i.t,r=i.type,n={user_name:{error:"",value:t.user_name||"",title:a("help.name")},mobile:{error:"",value:t.mobile||"",title:a("setting.phoneLabel")},email:{error:"",value:t.login_email||"",title:a("marketing.loginEmail")},job_number:{error:"",value:t.job_number||"",title:a("personal.jobNumber")},post:{error:"",value:t.post_ids||[],title:a("component.belongPost")},reports_to:{error:"",value:t.reports_to?(0,D.Z)((0,D.Z)({},t.reports_to),{},{user_id:t.reports_to.sync_user_id,source_type:t.reports_to.sync_source_type}):{},title:a("component.directSupervisor")},dept:{error:"",value:t.leaf_department_ids||[],title:a("common.department")}};t.extend_list.map(o=>{if(o.column_value!=="\u624B\u673A\u53F7"){var l=r==="edit"?o.extend_value:"";n[o.column_key]={error:"",value:l||"",title:o.column_value||""}}}),this.setState({editField:n,imageUrl:t.face_url||""})}}render(){var d=this.props,i=d.t,t=d.userInfo,a=d.type,r=d.visible,n=d.filterAuth,o=this.state,l=o.editField,p=o.imageUrl,c=o.cropType,b=o.orgDialogVisible,Q=t.source_type,V=t.is_auth_email,R=t.is_auth_mobile,Se=!1;return a==="edit"&&(Se=Q!=="create"),l.user_name?e().createElement(e().Fragment,null,e().createElement(ue.ZP,(0,F.Z)({},this.state.addUserFieldModal,{visible:this.props.visible,title:i(a==="edit"?"setting.zdUpdateUser":"setting.zdAddUSer")}),e().createElement("div",{className:"add-user"},e().createElement("div",{className:"field-item"},e().createElement("div",{className:"field-item-label required name"},i("common.userName"),":"),e().createElement("div",{className:"field-item-value"},e().createElement(N.Z,{disabled:Se,placeholder:i("common.userNameLimit"),value:l.user_name.value,onInput:w=>this.handleInput(w,"user_name")}),l.user_name&&l.user_name.error&&e().createElement("p",{className:"field-item-value-tip"},l.user_name.error))),e().createElement("div",{className:"field-item"},e().createElement("div",{className:"field-item-label required phone"},i("setting.userPhone"),":"),e().createElement("div",{className:"field-item-value"},e().createElement(N.Z,{disabled:R,placeholder:"",value:l.mobile.value,maxLength:16,onInput:w=>this.handleInput(w,"mobile")}),l.mobile&&l.mobile.error&&e().createElement("p",{className:"field-item-value-tip"},l.mobile.error))),e().createElement("div",{className:"field-item"},e().createElement("div",{className:"field-item-label phone"},i("marketing.loginEmail"),":"),e().createElement("div",{className:"field-item-value"},e().createElement(N.Z,{disabled:V===1,placeholder:"",value:l.email.value,onInput:w=>this.handleInput(w,"email")}),l.email&&l.email.error&&e().createElement("p",{className:"field-item-value-tip"},l.email.error))),e().createElement("div",{className:"field-item"},e().createElement("div",{className:"field-item-label required dept"},i("common.department"),":"),e().createElement("div",{className:"field-item-value"},r&&e().createElement(Te.Z,{disabled:Se,className:"",parentId:"",checkable:!1,asyncLoad:!1,treeSelect:!0,multiple:!0,width:"100%",filterAuth:n,defaultValue:t.leaf_department_ids?t.leaf_department_ids:[],handleTreeSelectChange:this.handleTreeSelectChange}),l.dept&&l.dept.error&&e().createElement("p",{className:"field-item-value-tip"},l.dept.error))),l.reports_to&&e().createElement("div",{className:"field-item"},e().createElement("div",{className:"field-item-label"},i("component.directSupervisor"),":"),e().createElement("div",{className:"field-item-value"},e().createElement(Le.Z,{title:i("component.chooseSupervisor"),visible:b,onlyUser:!0,single:!0,initData:{user:l.reports_to.value.id?[l.reports_to.value]:[]},onOk:this.handleSelectSupervisor,onCancel:()=>this.handleOrg(!1)}),e().createElement("div",{className:"direct-supervisor-box"},e().createElement("div",{className:"direct-supervisor-box-text"},e().createElement(wt.Z,{type:l.reports_to.value.sync_source_type,value:l.reports_to.value.sync_user_id,name:l.reports_to.value.name,dataType:"userName"})),e().createElement(m.Z,{className:"direct-supervisor-box-btn",icon:e().createElement(Re.Z,null),onClick:()=>this.handleOrg(!0)},i("component.chooseSupervisor"))))),e().createElement("div",{className:"field-item"},e().createElement("div",{className:"field-item-label"},i("component.belongPost"),":"),e().createElement("div",{className:"field-item-value"},r&&e().createElement(Jt.Z,{width:"100%",noChildSelect:!0,disabled:Se,multiple:!0,defaultValue:t.post_ids?t.post_ids:[],className:"",onChange:this.handlePostSelectChange}))),e().createElement("div",{className:"field-item"},e().createElement("div",{className:"field-item-label"},i("personal.jobNumber"),":"),e().createElement("div",{className:"field-item-value"},e().createElement(N.Z,{disabled:Se,placeholder:"",value:l.job_number.value,maxLength:20,onInput:w=>this.handleInput(w,"job_number")}),l.job_number&&l.job_number.error&&e().createElement("p",{className:"field-item-value-tip"},l.job_number.error))),e().createElement("div",{className:"field-item"},e().createElement("div",{className:"field-item-label"},i("setting.facePhoto"),":"),e().createElement("div",{className:"field-item-value"},e().createElement("div",{style:{marginBottom:"7px"}},e().createElement(Yt.Z,{defaultChecked:!1,onChange:this.handleSwitch}),e().createElement("span",{className:"item-margin"},i("resourceLibrary.originUpload"))),e().createElement("div",{className:"upload-avatar"},e().createElement(Xt.G2,{onUploadedListChange:this.onUploadChange,fileList:p?[{url:p}]:[],clip:c,changeTip:"\u91CD\u65B0\u4E0A\u4F20",uploadConfig:{listType:"picture-card",accept:"jpeg, jpg, png",maxCount:1},size:{value:2,unit:"mb"},imageContainerClassName:"upload_img_container",imgCropConfig:{isShowMsg:!1,widthScale:5,heightScale:7}}),e().createElement("p",{className:"tips"},"\u652F\u6301.jpg/.jpeg/.png")))),t.extend_list?t.extend_list.map(w=>w.column_value==="\u624B\u673A\u53F7"?null:e().createElement("div",{className:"field-item",key:w.column_value},e().createElement("div",{className:"field-item-label"},w.column_value,":"),e().createElement("div",{className:"field-item-value"},e().createElement(N.Z,{placeholder:"\u8BF7\u8F93\u5165".concat(w.column_value),value:l[w.column_key]?l[w.column_key].value:"",maxLength:60,onInput:ve=>this.handleInput(ve,w.column_key)}),l[w.column_key]&&l[w.column_key].error&&e().createElement("p",{className:"field-item-value-tip"},l[w.column_key].error)))):null))):null}}Gt.defaultProps={visible:!1,onOk:()=>{},onCancel:()=>{}};var qt=q=>{var d=q.user;return{user:d,appType:d.appType}},ea=(0,z.$j)(qt)((0,g.Z)()(Gt)),ta={deleteStudentCustom:q=>{var d=S.ZP.Organization.deleteCustomUser(q);return O.WY.get({url:d})}},Mt=s(80430),Wt=s(17215),kt=s(38642),Nt=s(86726),aa=s(16598),sa=N.Z.Search,Rt=I.Z.Option,ut={pageNumber:1,pageSize:20},ra=q=>({modules:q.user.modules,appType:q.user.appType,isAdmin:q.user.isAdmin,enterpriseId:q.user.enterpriseId});class ia extends x.Component{constructor(d){var i;super(d);i=this,this.getUserList=function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";i.setState({loading:!0});var r=S.ZP.Organization.getDeptUser({deptId:t}),n=i.props.organizationType,o=i.state,l=o.sortInfo,p=o.searchType,c="";l.order&&(l.order==="descend"?c="desc":l.order==="ascend"&&(c="asc"));var b={keyword:a,type:p,page_number:ut.pageNumber,page_size:ut.pageSize,recursion:!0,filter_auth:!0,sort:c,sync_organization:n||""};O.WY.get({url:r,params:b}).then(Q=>{Q.data.list&&Q.data.list.forEach(V=>{V.timeLabel=(0,k.p6)(V.create_time,"yyyy-MM-dd"),V.recent_login_time?V.lastLoginTime=(0,k.p6)(V.recent_login_time,"yyyy-MM-dd  hh:mm:ss"):V.lastLoginTime="",V.extend_list.forEach(R=>{V[R.column_key]=R.protect_value})}),i.setState({userList:Q.data.list||[],userTotal:Q.data.total,loading:!1})})},this.getEnterpriseHandover=(0,H.Z)(U().mark(function t(){var a,r,n,o,l,p,c,b;return U().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return a=S.ZP.DdLive.getBlackWhiteList(),r={enterpriseId:localStorage.getItem("enterpriseId"),status:0,type:"handover"},V.next=4,O.WY.get({url:a,params:r});case 4:n=V.sent,o=n.data,l=o.code,p=o.data.list,l===2e5&&(c=p.filter(R=>R.typeName==="handover"),c.length>0&&(b=c[0].whiteList,i.setState({showHandOver:!!(b&&b.length)})));case 7:case"end":return V.stop()}},t)})),this.handleSearch=t=>{this.getUserList(this.props.deptId,t)},this.handleChangeSort=(t,a,r)=>{var n=this.state.sortInfo;r.order&&n.order!==r.order&&(ut.pageNumber=1,this.setState({sortInfo:r},()=>{this.getUserList(this.props.deptId)}))},this.pageChange=t=>{ut.pageNumber=t,this.getUserList(this.props.deptId)},this.pageSizeChange=(t,a)=>{ut.pageNumber=1,ut.pageSize=a,this.getUserList(this.props.deptId)},this.importUser=()=>{this.setState({exportUserModalVisible:!0})},this.hideExportUserModal=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";i.setState({exportUserModalVisible:!1}),i.getUserList(i.props.deptId),t==="success"&&i.props.onImportUserSuccess()},this.hiddenEditField=()=>{this.setState({showEditField:!1})},this.showEditField=t=>{this.setState({showAddUser:!0,currentUser:t})},this.sureEditField=()=>{this.hiddenEditField(),this.getUserList(this.props.deptId)},this.addUser=()=>{var t=this.state.userList;this.setState({showAddUser:!0,currentUser:{user_name:"",job_number:"",mobile:"",department_ids:[],post_ids:[],extend_list:t[0]?t[0].extend_list:[]}})},this.sureAddUser=()=>{this.hiddenAddUser(),this.getUserList(this.props.deptId)},this.hiddenAddUser=()=>{this.setState({showAddUser:!1})},this.showInviteModal=()=>{var t=this.state.inviteModalConfig;this.setState({inviteModalConfig:(0,D.Z)((0,D.Z)({},t),{},{visible:!0})})},this.showDeleteModal=t=>{var a=this.props.t,r=t.user_name;M.Z.confirm({title:e().createElement("div",null,a("common.deleteStudentConfirm")," ",e().createElement("b",null,r)," ",a("common.isDeleteStudent")),icon:e().createElement(gt.Z,{style:{fontSize:"22px",color:"#bf3227"}}),content:a("common.deleteStudentTip"),okText:a("common.ok"),cancelText:a("common.cancel"),onOk:function(){var n=(0,H.Z)(U().mark(function l(){var p;return U().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,ta.deleteStudentCustom(t.id);case 2:p=b.sent,p.data.resultCode==="200000"&&(C.default.success(a("common.deleteSuccess")),setTimeout(()=>{i.getUserList(i.props.deptId)},800));case 4:case"end":return b.stop()}},l)}));function o(){return n.apply(this,arguments)}return o}()})},this.handleCloseInviteModal=()=>{var t=this.state.inviteModalConfig;this.setState({inviteModalConfig:(0,D.Z)((0,D.Z)({},t),{},{visible:!1})})},this.handleCopyLink=()=>{var t=document.getElementById("inviteLink");t.select(),document.execCommand("Copy"),C.default.success(this.props.t("live.copySuccess"))},this.showResetPasswordModal=function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};i.setState({showResetPasswordModal:t,currentUser:a})},this.changeSelectType=t=>{this.setState({searchType:t},()=>{var a=this.mySearch.state.value;this.handleSearch(a)})},this.changeSelectType=t=>{this.setState({searchType:t},()=>{var a=this.mySearch.state.value;this.handleSearch(a)})},this.getPlaceholder=()=>{var t=this.state.searchType,a=this.props.t,r=null;switch(t){case"job_number":r=a("searchInputPlaceholder.jobNumber");break;case"user_name":r=a("searchInputPlaceholder.userName");break;case"login_number":r=a("searchInputPlaceholder.loginBumberBase");break;case"email":r=a("searchInputPlaceholder.emailBase");break;default:r=a("searchInputPlaceholder.mobileNumber");break}return r},this.headerTitle=()=>{var t=this.state.actions,a=this.props.t;return e().createElement("div",{className:"top-operate-container"},e().createElement("div",{className:"top-operate-btn-wrapper"},(0,Nt.H3)("userInsert",t)&&e().createElement("div",{className:"top-operate-btn"},e().createElement(m.Z,{type:"primary",className:"top-operate-btn-btn",onClick:this.addUser},e().createElement(Re.Z,null),a("setting.zdAddUSer"))),(0,Nt.H3)("batchImport",t)&&e().createElement("div",{className:"top-operate-btn"},e().createElement(m.Z,{type:"primary",ghost:!0,className:"top-operate-btn-btn",onClick:this.importUser},e().createElement(ft.Z,null),a("setting.zdImportUser"))),(0,Nt.H3)("invitation",t)&&e().createElement("div",{className:"top-operate-btn"},e().createElement(m.Z,{className:"top-operate-btn-btn",onClick:this.showInviteModal},a("registerLogin.inviteMembers")))))},this.toolBarRender=()=>{var t=this.props.t,a=this.state.searchType;return e().createElement("div",{className:"role-container__content__search"},e().createElement(N.Z.Group,{compact:!0},e().createElement(I.Z,{style:{width:"115px",display:"inline-block"},defaultValue:a,onChange:this.changeSelectType},e().createElement(Rt,{value:"user_name"},t("searchInputPlaceholder.userNameOp")),e().createElement(Rt,{value:"job_number"},t("searchInputPlaceholder.jobNumberOp")),e().createElement(Rt,{value:"login_number"},t("searchInputPlaceholder.loginNumber")),e().createElement(Rt,{value:"email"},t("searchInputPlaceholder.email"))),e().createElement(sa,{ref:r=>{this.mySearch=r},className:"top-operate-search",onSearch:this.handleSearch,onChange:this.searchChange,allowClear:!0,width:172,placeholder:t("searchInputPlaceholder.pleaseSelect")})))},this.getUserInfoColumnConfig=(0,H.Z)(U().mark(function t(){var a,r,n,o,l;return U().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,kt.Kb)((0,Wt.h)());case 2:if(a=c.sent,r=(0,vt.Z)(a,2),n=r[0],o=r[1],!n){c.next=8;break}return c.abrupt("return");case 8:l=o.data,i.setState({extendFields:l.slice(6)});case 10:case"end":return c.stop()}},t)})),this.showFaceImg=t=>{this.setState({faceImgUrl:t,faceModalVisible:!0})},this.hideFaceModal=()=>{this.setState({faceModalVisible:!1,faceImgUrl:""})},this.state={userList:[],userTotal:0,exportUserModalVisible:!1,showEditField:!1,currentUser:{},actions:(0,Nt.V9)("organization",d.modules),showAddUser:!1,inviteModalConfig:{title:d.t("registerLogin.inviteMembers"),visible:!1,centered:!0,width:484,footer:null,onCancel:this.handleCloseInviteModal},showResetPasswordModal:!1,searchType:"user_name",extendFields:[],faceModalVisible:!1,loading:!1,sortInfo:{order:""},associateModalVisible:!1,showHandOver:!1}}componentDidMount(){this.getEnterpriseHandover(),this.getUserInfoColumnConfig(),this.getUserList(1)}UNSAFE_componentWillUpdate(d){!!d.deptId&&d.deptId!==this.props.deptId&&(ut.pageNumber=1,this.getUserList(d.deptId))}componentWillUnmount(){ut.pageNumber=1,ut.pageSize=20}showAssociateModal(d){this.setState({currentRow:d},()=>{this.setState({associateModalVisible:!0})})}render(){var d=this.props,i=d.t,t=d.deptId,a=d.tabStatus,r=a===void 0?"":a,n=d.organizationType,o=d.hasRestPermission,l=this.state,p=l.extendFields,c=l.showEditField,b=l.currentUser,Q=l.actions,V=l.showAddUser,R=l.exportUserModalVisible,Se=l.inviteModalConfig,w=l.showResetPasswordModal,ve=localStorage.getItem("enterpriseName"),je=(0,D.Z)((0,D.Z)({},S.XE.INITIAL_PAGINATION),{},{current:ut.pageNumber,pageSize:ut.pageSize,defaultPageSize:20,total:Number(this.state.userTotal),onChange:this.pageChange,onShowSizeChange:this.pageSizeChange}),pt="".concat(window.location.origin,"/#/account-bind?enterprise_id=").concat(localStorage.getItem("enterpriseId"),"&department_id=").concat(t),Ct=localStorage.getItem("uid"),Je=Ct==="10"||o==="true",xt=[{title:i("common.userName"),dataIndex:"user_name",key:"user_name",width:100,fixed:this.props.appType==="wx_app"?!1:"left",render:(Ce,De)=>{var We=De.user_name;return We||"--"}},{title:i("personal.jobNumber"),dataIndex:"job_number",key:"job_number",width:100,render:(Ce,De)=>{var We=De.job_number;return We||"--"}},{title:i("setting.loginPhoneNumber"),dataIndex:"mobile",key:"mobile",width:100,render:(Ce,De)=>{var We=De.mobile;return We||"--"}},{title:i("common.department"),dataIndex:"department_names",key:"department_names",width:150,render:(Ce,De)=>{var We=De.department_infos;if(We){var Ot=()=>e().createElement(Mt.Z,{list:We,displayAll:!0});return e().createElement(E.Z,{title:Ot()},e().createElement("div",{className:"cl-text-ellipsis",style:{width:150}},Ot()))}return e().createElement(E.Z,{title:Ce?Ce.join("\uFF0C"):"--"},e().createElement("div",{className:"cl-text-ellipsis",style:{width:140}},Ce?Ce.join("\uFF0C"):"--"))}},{title:i("component.directSupervisor"),dataIndex:"reports_to",key:"reports_to",width:100,render:Ce=>e().createElement(wt.Z,{type:Ce.sync_source_type,value:Ce.sync_user_id,dataType:"userName",name:Ce.name||"--"})},{title:i("component.belongPost"),dataIndex:"post_names",key:"post_names",width:150,render:Ce=>e().createElement(E.Z,{title:Ce},e().createElement("div",{className:"cl-text-ellipsis",style:{width:140}},Ce?Ce.join("\uFF0C"):"--"))},{title:this.props.t("marketing.loginEmail"),dataIndex:"login_email",key:"login_email",width:150,render:(Ce,De)=>{var We=De.login_email;return We||"--"}},{title:i("setting.syncTime"),dataIndex:"timeLabel",key:"timeLabel",width:120,render:(Ce,De)=>{var We=De.timeLabel;return We||"--"}},{title:i("setting.activeStatus"),dataIndex:"active",key:"active",width:120,render:Ce=>i(Ce==="true"?"setting.activeLabel":"setting.unActiveLabel")},{title:i("setting.lastLoginTime"),dataIndex:"recent_login_time",key:"recent_login_time",width:130,sorter:!0,sortDirections:["ascend","descend","ascend"],render:(Ce,De)=>{var We=De.recent_login_time;return We&&(0,k.p6)(We,"yyyy-MM-dd hh:mm:ss")||"--"}},{title:i("setting.facePhoto"),dataIndex:"face_url",width:80,render:Ce=>{var De=Ce?"face-icon":"hide-img";return e().createElement("img",{onClick:()=>this.showFaceImg(Ce),className:De,src:Ce,alt:""})}}],zt=(0,ct.Z)(p),jt;try{for(zt.s();!(jt=zt.n()).done;){var Bt=jt.value,ya=function(De){Bt.hasOwnProperty(De)&&xt.push({title:Bt[De],dataIndex:De,key:De,width:150,render:(We,Ot)=>Ot[De]||"--"})};for(var Ca in Bt)ya(Ca)}}catch(Ce){zt.e(Ce)}finally{zt.f()}return xt.push({title:this.props.t("common.operate"),key:"operate",width:100,fixed:"right",render:(Ce,De)=>{var We=this.props,Ot=We.fromStudentMenu,_a=We.isAdmin,Ht=[{type:"edit",visible:(0,Nt.H3)("userEdit",Q),title:this.props.t("common.edit"),click:()=>this.showEditField(De)},{type:"delete",visible:_a,title:this.props.t("common.delete"),click:()=>this.showDeleteModal(De)},{type:"resetPasswords",visible:(0,Nt.H3)("userEdit",Q)&&Je,title:this.props.t("account.resetPasswords"),click:()=>this.showResetPasswordModal(!0,De)},{type:"handOver",visible:this.state.showHandOver,title:this.props.t("common.associate"),click:()=>this.showAssociateModal(De)}],Pa=Ht.filter(Ia=>Ia.visible);return e().createElement("div",{className:"cl-table__cell-action"},Ot&&e().createElement(aa.Z,{buttons:Ht,visibleNum:Pa.length===2?2:1}),!Ot&&(0,Nt.H3)("userEdit",Q)&&e().createElement(e().Fragment,null,e().createElement("span",{onClick:()=>this.showEditField(De),className:"cl-pointer"},this.props.t("common.edit")),Je&&e().createElement("span",{onClick:()=>this.showResetPasswordModal(!0,De),className:"cl-pointer"},this.props.t("account.resetPasswords"))))}}),e().createElement("div",{className:"dept-display-table"},e().createElement(Lt.Z,{organizationType:n,title:this.props.deptTitle,deptId:this.props.deptId}),e().createElement("div",{className:"dept-user-table"},e().createElement("div",{className:"dept-user-content-list",style:r?{minHeight:"calc(100vh - 412px"}:{}},e().createElement(B.f,{key:"dept-table",dataSource:this.state.userList,columns:xt,onChange:this.handleChangeSort,rowKey:Ce=>Ce.id,pagination:!1,scroll:{y:"100%",x:"max-content"},loading:this.state.loading,headerTitle:this.headerTitle(),toolBarRender:this.toolBarRender,tableUUID:"e0795f9a-9a16-4383-be2f-6605c595e41f"})),e().createElement("div",{className:"dept-user-pagination-wrapper"},e().createElement(_.Z,(0,F.Z)({},je,{className:"dept-user-pagination"})))),R?e().createElement(be,{onHideModal:this.hideExportUserModal,exportUserModalVisible:R,groupId:"",deptId:t,organizationType:n}):null,e().createElement(At,{visible:c,userInfo:b,onOk:this.sureEditField,onCancel:this.hiddenEditField}),e().createElement(ea,{visible:V,type:b.id?"edit":"add",userInfo:b,onOk:this.sureAddUser,filterAuth:!1,onCancel:this.hiddenAddUser}),e().createElement(M.Z,Se,e().createElement("div",{className:"dept-display-table-invite"},e().createElement(N.Z,{disabled:!0,value:pt}),e().createElement(N.Z,{style:{opacity:"0",position:"absolute",width:"100px"},value:pt,id:"inviteLink"}),e().createElement(m.Z,{type:"primary",className:"dept-display-table-invite-copy-link",onClick:this.handleCopyLink},i("registerLogin.copyLink"))),e().createElement("div",{className:"dept-display-table-invite-tips"},(0,k.ZT)(i("registerLogin.copyLinkTips"),ve))),e().createElement(M.Z,{title:"\u4EBA\u8138",visible:this.state.faceModalVisible,footer:null,onCancel:this.hideFaceModal,className:"face-modal-width"},e().createElement("img",{src:this.state.faceImgUrl,className:"face-img",alt:""})),e().createElement(Zt.Z,{visible:w,hideResetPasswordModal:()=>{this.showResetPasswordModal(!1)},userInfo:b}),this.state.associateModalVisible?e().createElement(ne.Z,{visible:this.state.associateModalVisible,onRefresh:()=>{this.setState({associateModalVisible:!1})},record:this.state.currentRow,onCancel:()=>{this.setState({associateModalVisible:!1})}}):null)}}var na=(0,g.Z)()((0,z.$j)(ra)(ia)),Kt=s(48479),Et={pageNumber:1,pageSize:20},oa=q=>({postId:q.organization.activePostId,postType:q.organization.activePostType,appType:q.user.appType});class la extends x.Component{constructor(d){var i;super(d);i=this,this.getLeader=t=>{var a=S.ZP.Organization.getPostLeader(),r={postId:t,id:t};O.WY.get({url:a,params:r}).then(n=>{this.setState({postInfo:{id:t,name:n.data.data.depathmentName},leaderList:n.data.data.userList})})},this.getUserList=function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(!!t){var r=i.props.organizationType,n=i.state.searchType,o=S.ZP.Organization.getPostUserList({postId:t}),l={user_name:a,type:n,page_number:Et.pageNumber,page_size:Et.pageSize,filter_auth:!0,sync_organization:r||""};O.WY.get({url:o,params:l}).then(p=>{p.data.list&&p.data.list.forEach(c=>{c.timeLabel=(0,k.p6)(c.create_time,"yyyy-MM-dd"),c.recent_login_time?c.lastLoginTime=(0,k.p6)(c.recent_login_time,"yyyy-MM-dd hh:mm:ss"):c.lastLoginTime="",c.extend_list&&c.extend_list.map(b=>{c[b.column_key]=b.protect_value})}),i.setState({userList:p.data.list||[],userTotal:p.data.total})})}},this.handleSearch=t=>{this.getUserList(this.props.postId,t)},this.pageChange=t=>{Et.pageNumber=t,this.getUserList(this.props.postId)},this.pageSizeChange=(t,a)=>{Et.pageNumber=1,Et.pageSize=a,this.getUserList(this.props.postId)},this.deleteLeader=t=>{this.setState({currentDeleteLeader:t},()=>{var a=this.state.deleteConfirmConfig,r=a.title,n=a.content;M.Z.confirm({title:r,content:n,onOk:()=>{this.sureDeleteLeader()},onCancel:()=>{this.cancelDeleteLeader()}})})},this.cancelDeleteLeader=()=>{this.setState({currentDeleteLeader:""})},this.sureDeleteLeader=()=>{var t=this.props.t,a=S.ZP.Organization.deletePostLeader(),r={access_token:window.localStorage.getItem("token"),userIds:this.state.currentDeleteLeader,departmentId:this.props.postId,postId:this.props.postId};O.qg.post({url:a,data:r}).then(n=>{if(n.data.code===0){C.default.success(t("cart.deleteSuccess"));var o=[...this.state.leaderList],l=o.findIndex(p=>p.id===this.state.currentDeleteLeader);o.splice(l,1),this.setState({leaderList:o,currentDeleteLeader:""})}})},this.showDeleteUser=()=>{var t=this.props.t;if(this.state.checkedUser.length===0)C.default.warn(t("setting.deleteUserTip"));else{var a=this.state.deleteUserConfirmConfig,r=a.title,n=a.content;M.Z.confirm({title:r,content:n,onOk:()=>{this.sureDeleteUser()}})}},this.cancelDeleteUser=()=>{},this.sureDeleteUser=()=>{var t=this.props.t,a=[...this.state.checkedUser],r=S.ZP.Organization.deleteUserFromPost(),n={access_token:window.localStorage.getItem("token"),postId:this.props.postId,id:this.props.postId,userIds:a.join(",")};O.qg.post({url:r,data:n}).then(o=>{o.data.code===0&&(C.default.success(t("cart.deleteSuccess")),this.getUserList(this.props.postId),this.setState({checkedUser:[]}),this.props.dispatch({type:"organization/getPostTreeData",payload:{changeActive:!1}}))})},this.savePostUser=t=>{var a=t.users.map(o=>o.id),r=S.ZP.Organization.addUserToPost(),n={access_token:window.localStorage.getItem("token"),postId:this.props.postId,id:this.props.postId,userIds:a.join(",")};O.qg.post({url:r,data:n}).then(o=>{o.data.code===0&&(this.getUserList(this.props.postId),this.props.dispatch({type:"organization/getPostTreeData",payload:{changeActive:!1}}))}),this.setState({orgDialogVisible:!1})},this.cancelOrg=()=>{this.setState({orgDialogVisible:!1})},this.renderPostLeader=()=>{var t=this.props.t;if(this.state.leaderList.length!==0){var a=this.state.leaderList.map(r=>e().createElement("span",{className:"post-leader-one",key:r.id},r.name,e().createElement(se.Z,{onClick:n=>this.deleteLeader(r.id,n),className:"post-leader-remove"})));return e().createElement("div",{className:"post-leader"},e().createElement("span",{className:"post-leader-label"},t("setting.postCharge"),"\uFF1A"),e().createElement("div",{className:"post-leader-user"},a))}},this.addUser=()=>{this.setState({orgDialogVisible:!0})},this.showFaceImg=t=>{this.setState({faceImgUrl:t,faceModalVisible:!0})},this.hideFaceModal=()=>{this.setState({faceModalVisible:!1,faceImgUrl:""})},this.headerTitle=()=>{var t=this.props.t;return e().createElement("div",{className:"top-operate-container"},e().createElement("div",{className:"top-operate-btn-wrapper"},this.props.postType==="create"?e().createElement(m.Z,{type:"primary",className:"add-user-btn",disabled:!this.props.postId,onClick:this.addUser},e().createElement(ae.Z,{iconClass:"icon-icon_addx"}),t("setting.addUser")):null,this.props.postType==="create"?e().createElement(m.Z,{type:"primary",ghost:!0,disabled:!this.props.postId,className:"delete-user-btn",onClick:this.showDeleteUser},e().createElement(ae.Z,{iconClass:"icon-icon_delex"}),t("setting.multipleDelete")):null),this.state.orgDialogVisible?e().createElement($.Z,{onOk:this.savePostUser,onCancel:this.cancelOrg,tabs:["user"],visible:this.state.orgDialogVisible,title:t("setting.addUser")}):null)},this.toolBarRender=()=>{var t=this.props.t;return e().createElement(Kt.Z,{onSearch:this.handleSearch,prefixCls:"top-operate-search",placeholder:t("searchInputPlaceholder.userName")})},this.getUserInfoColumnConfig=(0,H.Z)(U().mark(function t(){var a,r,n,o,l;return U().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,kt.Kb)((0,Wt.h)());case 2:if(a=c.sent,r=(0,vt.Z)(a,2),n=r[0],o=r[1],!n){c.next=8;break}return c.abrupt("return");case 8:l=o.data,i.setState({extendFields:l.slice(6)});case 10:case"end":return c.stop()}},t)})),this.state={postInfo:{},leaderList:[],userList:[],userTotal:0,orgDialogVisible:!1,deleteConfirmConfig:{title:d.t("common.delete"),content:d.t("setting.deletePostChargeTip")},deleteUserConfirmConfig:{title:d.t("common.delete"),content:d.t("setting.deleteCheckedUser")},currentDeleteLeader:"",checkedUser:[],faceImgUrl:"",faceModalVisible:!1,searchType:"user_name",extendFields:[]}}componentDidMount(){this.getUserInfoColumnConfig(),this.getLeader(this.props.postId),this.getUserList(this.props.postId),this.setState({checkedUser:[]})}UNSAFE_componentWillUpdate(d){!!d.postId&&d.postId!==this.props.postId&&(this.getLeader(d.postId),this.getUserList(d.postId),this.setState({checkedUser:[]}))}render(){var d=this.props,i=d.t,t=d.tabStatus,a=t===void 0?"":t,r=(0,D.Z)((0,D.Z)({},S.XE.INITIAL_PAGINATION),{},{defaultPageSize:20,total:Number(this.state.userTotal),current:Et.pageNumber,pageSize:Et.pageSize,onChange:this.pageChange,onShowSizeChange:this.pageSizeChange}),n={selectedRowKeys:this.state.checkedUser,onChange:R=>{this.setState({checkedUser:R})}},o=this.state.extendFields,l=[{title:i("common.userName"),dataIndex:"user_name",key:"user_name",width:100,fixed:this.props.appType==="wx_app"?!1:"left",render:(R,Se)=>{var w=Se.user_name;return w||"--"}},{title:i("personal.jobNumber"),dataIndex:"job_number",key:"job_number",width:100,render:(R,Se)=>{var w=Se.job_number;return w||"--"}},{title:i("common.department"),dataIndex:"department_names",key:"department_names",width:150,render:(R,Se)=>{var w=Se.department_infos;if(w){var ve=()=>e().createElement(Mt.Z,{list:w,displayAll:!0});return e().createElement(E.Z,{title:ve()},e().createElement("div",{className:"cl-text-ellipsis",style:{width:150}},ve()))}return e().createElement(E.Z,{title:R?R.join("\uFF0C"):"--"},e().createElement("div",{className:"cl-text-ellipsis",style:{width:140}},R?R.join("\uFF0C"):"--"))}},{title:i("component.directSupervisor"),dataIndex:"reports_to",key:"reports_to",width:100,render:R=>R.name||"--"},{title:i("component.belongPost"),dataIndex:"post_names",key:"post_names",width:150,render:R=>e().createElement(E.Z,{title:R},e().createElement("div",{className:"cl-text-ellipsis",style:{width:140}},R?R.join("\uFF0C"):"--"))},{title:i("marketing.loginEmail"),dataIndex:"login_email",key:"login_email",width:150,render:(R,Se)=>{var w=Se.login_email;return w||"--"}},{title:i("setting.facePhoto"),dataIndex:"face_url",key:"face_url",width:80,render:R=>{var Se=R?"face-icon":"hide-img";return e().createElement("img",{onClick:()=>this.showFaceImg(R),className:Se,src:R})}},{title:i("setting.joinTime"),dataIndex:"timeLabel",key:"timeLabel",width:120,render:(R,Se)=>{var w=Se.timeLabel;return w||"--"}}],p=(0,ct.Z)(o),c;try{for(p.s();!(c=p.n()).done;){var b=c.value,Q=function(Se){b.hasOwnProperty(Se)&&l.push({title:b[Se],dataIndex:Se,key:Se,width:150,render:(w,ve)=>ve[Se]||"--"})};for(var V in b)Q(V)}}catch(R){p.e(R)}finally{p.f()}return l.push({title:i("setting.activeStatus"),dataIndex:"active",key:"active",width:100,fixed:"right",render:R=>i(R==="true"?"setting.activeLabel":"setting.unActiveLabel")}),e().createElement("div",{className:"post-display-table"},e().createElement("span",{className:"post-name"},this.state.postInfo.name),e().createElement("div",{className:"post-user-table"},e().createElement("div",{className:"post-user-content-list",style:a?{minHeight:"calc(100vh - 412px"}:{}},e().createElement(B.f,{key:"post-table",rowSelection:n,dataSource:this.state.userList,columns:l,rowKey:R=>R.id,pagination:!1,scroll:{y:"100%",x:"max-content"},headerTitle:this.headerTitle(),toolBarRender:this.toolBarRender,tableUUID:"a5dc61f7-149d-4b9c-9508-7f5657d6f6cc"})),e().createElement("div",{className:"post-user-pagination-wrapper"},e().createElement(_.Z,(0,F.Z)({},r,{className:"post-user-pagination"})))),e().createElement(M.Z,{title:"\u4EBA\u8138",visible:this.state.faceModalVisible,footer:null,onCancel:this.hideFaceModal,className:"face-modal-width"},e().createElement("img",{src:this.state.faceImgUrl,className:"face-img"})))}componentWillUnmount(){Et.pageNumber=1,Et.pageSize=20}}var da=(0,z.$j)(oa)((0,g.Z)()(la)),ca=s(84391),ua=s(42706),pa=s(97593),yt={pageNumber:1,pageSize:20},ma=q=>({groupId:q.organization.activeGroupId,groupTitle:q.organization.activeGroupTitle,createUserName:q.organization.createUserName,appType:q.user.appType,keyword:q.organization.groupSearch.keyword,only_see_me:q.organization.groupSearch.only_see_me});class ha extends x.Component{constructor(d){var i;super(d);i=this,this.getUserList=function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(!!t){var r=S.ZP.Organization.getGroupUserList({groupId:t}),n=i.state.searchType,o={user_name:a,type:n,page_number:yt.pageNumber,page_size:yt.pageSize,filter_auth:!0};O.WY.get({url:r,params:o}).then(l=>{l.data.list&&l.data.list.forEach(p=>{p.timeLabel=(0,k.p6)(p.create_time,"yyyy-MM-dd"),p.recent_login_time?p.lastLoginTime=(0,k.p6)(p.recent_login_time,"yyyy-MM-dd hh:mm:ss"):p.lastLoginTime="",p.extend_list&&p.extend_list.map(c=>{p[c.column_key]=c.protect_value})}),i.setState({userList:l.data.list||[],userTotal:l.data.total})})}},this.handleSearch=t=>{this.getUserList(this.props.groupId,t)},this.pageChange=t=>{yt.pageNumber=t,this.getUserList(this.props.groupId)},this.pageSizeChange=(t,a)=>{yt.pageNumber=1,yt.pageSize=a,this.getUserList(this.props.groupId)},this.showDeleteUser=()=>{var t=this.props.t;if(this.state.checkedUser.length===0)C.default.warn(t("setting.deleteUserTip"));else{var a=this.state.deleteUserConfirmConfig,r=a.title,n=a.content;M.Z.confirm({title:r,content:n,onOk:()=>{this.sureDeleteUser()}})}},this.sureDeleteUser=()=>{var t=this.props.t,a=[...this.state.checkedUser],r=S.ZP.Organization.deleteGroupUser(),n={access_token:window.localStorage.getItem("token"),groupId:this.props.groupId,id:this.props.groupId,userIds:a.join(",")};O.qg.post({url:r,data:n}).then(o=>{o.data.code===0&&(C.default.success(t("cart.deleteSuccess")),this.getUserList(this.props.groupId),this.setState({checkedUser:[],allChecked:!1}),this.props.dispatch({type:"organization/getGroupTreeData",payload:{keyword:this.props.keyword,only_see_me:this.props.only_see_me,changeActive:!1}}))})},this.saveGroupUser=t=>{var a=this.props.t,r=t.users.map(l=>l.id),n=S.ZP.Organization.addGroupUser(),o={access_token:window.localStorage.getItem("token"),groupId:this.props.groupId,id:this.props.groupId,userIds:r.join(",")};O.qg.post({url:n,data:o}).then(l=>{l.data.code===0?(C.default.success(a("setting.addUserSuccess")),this.getUserList(this.props.groupId),this.props.dispatch({type:"organization/getGroupTreeData",payload:{keyword:this.props.keyword,only_see_me:this.props.only_see_me,changeActive:!1}})):C.default.error(a("setting.addUserFail"))}),this.setState({orgDialogVisible:!1})},this.cancelOrg=()=>{this.setState({orgDialogVisible:!1})},this.addUser=()=>{this.setState({orgDialogVisible:!0})},this.showExportUserModal=t=>{this.setState({exportUserModalVisible:!0,exportType:t})},this.hideExportUserModal=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";i.setState({exportUserModalVisible:!1}),t==="success"&&(i.getUserList(i.props.groupId),i.props.dispatch({type:"organization/getGroupTreeData",payload:{keyword:i.props.keyword,only_see_me:i.props.only_see_me,changeActive:!1}}))},this.handleAllChange=t=>{this.setState({allChecked:t.target.checked});var a=this.state,r=a.userList,n=a.checkedUser;if(r.length===n.length)this.handleRowSelectChange([]);else{var o=[];r.forEach(l=>{o.push(l.id)}),this.handleRowSelectChange(o)}},this.handleRowSelectChange=t=>{var a=this.state.userList;a.length===t.length?this.setState({allChecked:!0,checkedUser:t}):this.setState({allChecked:!1,checkedUser:t})},this.showFaceImg=t=>{this.setState({faceImgUrl:t,faceModalVisible:!0})},this.hideFaceModal=()=>{this.setState({faceModalVisible:!1,faceImgUrl:""})},this.renderExportBtn=()=>{var t=this.props.t,a=[...this.state.checkedUser],r=e().createElement(xe.Z,null,e().createElement(xe.Z.Item,{key:"0",disabled:!a.length},e().createElement("div",{onClick:()=>{a.length&&this.exportBelleUser({all:!1})}},t("common.exportData")+t("common.checked")+t("tutorial.student"))),e().createElement(xe.Z.Item,{key:"0"},e().createElement("div",{onClick:()=>{this.exportBelleUser({all:!0})}},t("common.exportData")+t("common.all")+t("tutorial.student"))));return e().createElement(we.Z,{overlay:r},e().createElement(m.Z,{type:"primary",icon:e().createElement(ca.Z,null),disabled:!this.props.groupId,style:{marginLeft:"8px"}},t("common.exportData")))},this.exportBelleUser=t=>{var a=t.all,r=a===void 0?!1:a,n=this.props,o=n.groupId,l=n.t,p=[...this.state.checkedUser],c={userGroupId:o,userIds:r?[]:p};(0,pa.N)({page:"exportBelleGroupUsers",props:this.props,query:c,sendType:"post",rest:{},fail:b=>{C.default.error(l(b.msg||b.data.msg||"community.isError"))}})},this.headerTitle=()=>{var t=this.props,a=t.t,r=t.groupId,n=t.organizationType,o=this.state,l=o.exportType,p=o.exportUserModalVisible,c=o.whiteList;return e().createElement("div",{className:"top-operate-container"},e().createElement("div",{className:"top-operate-btn-wrapper"},e().createElement(m.Z,{type:"primary",disabled:!this.props.groupId,onClick:this.addUser,className:"top-operate-btn-add"},e().createElement(ae.Z,{iconClass:"icon-icon_addx"}),a("setting.addUser")),e().createElement(m.Z,{type:"primary",ghost:!0,disabled:!this.props.groupId,className:"delete-user-btn",onClick:this.showDeleteUser},e().createElement(ae.Z,{iconClass:"icon-icon_delex"}),a("common.delete")),c.belleFlag&&["app","ding"].includes(n)&&this.renderExportBtn()),this.state.orgDialogVisible&&e().createElement($.Z,{onOk:this.saveGroupUser,onCancel:this.cancelOrg,tabs:["user"],visible:this.state.orgDialogVisible,title:a("setting.addUser")}),this.state.exportUserModalVisible?e().createElement(ua.Z,{onHideModal:this.hideExportUserModal,exportUserModalVisible:p,groupId:r,exportType:l,organizationType:n}):null)},this.toolBarRender=()=>{var t=this.props.t;return e().createElement(Kt.Z,{onSearch:this.handleSearch,prefixCls:"top-operate-search",placeholder:t("searchInputPlaceholder.userName")})},this.getUserInfoColumnConfig=(0,H.Z)(U().mark(function t(){var a,r,n,o,l;return U().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,kt.Kb)((0,Wt.h)());case 2:if(a=c.sent,r=(0,vt.Z)(a,2),n=r[0],o=r[1],!n){c.next=8;break}return c.abrupt("return");case 8:l=o.data,i.setState({extendFields:l.slice(6)});case 10:case"end":return c.stop()}},t)})),this.state={userList:[],userTotal:0,orgDialogVisible:!1,deleteUserConfirmConfig:{title:d.t("common.delete"),content:d.t("setting.deleteCheckedUser")},checkedUser:[],exportUserModalVisible:!1,allChecked:!1,selectedRows:[],faceImgUrl:"",faceModalVisible:!1,searchType:"user_name",exportType:"",extendFields:[],whiteList:{belleFlag:(0,kt.UI)("BELLE_CUSTOMER_WHITE")}}}componentDidMount(){this.getUserInfoColumnConfig(),this.getUserList(this.props.groupId),this.setState({checkedUser:[],allChecked:!1})}UNSAFE_componentWillUpdate(d){!!d.groupId&&d.groupId!==this.props.groupId&&(this.getUserList(d.groupId),this.setState({checkedUser:[],allChecked:!1}))}render(){var d=this.props,i=d.t,t=d.tabStatus,a=t===void 0?"":t,r=(0,D.Z)((0,D.Z)({},S.XE.INITIAL_PAGINATION),{},{defaultPageSize:20,total:Number(this.state.userTotal),current:yt.pageNumber,pageSize:yt.pageSize,onChange:this.pageChange,onShowSizeChange:this.pageSizeChange}),n={selectedRowKeys:this.state.checkedUser,onChange:this.handleRowSelectChange},o=this.state,l=o.extendFields,p=o.whiteList,c=[{title:i("common.userName"),dataIndex:"user_name",key:"user_name",width:100,fixed:this.props.appType==="wx_app"?!1:"left",render:(w,ve)=>{var je=ve.user_name,pt=ve.user_id,Ct=ve.source_type;return e().createElement(wt.Z,{dataType:"userName",value:pt,name:je||"--",type:Ct})}},{title:i("personal.jobNumber"),dataIndex:"job_number",key:"job_number",width:100,render:(w,ve)=>{var je=ve.job_number;return je||"--"}},{title:i("common.department"),dataIndex:"department_names",key:"department_names",width:150,render:(w,ve)=>{var je=ve.leaf_department_ids,pt=ve.source_type,Ct=ve.department_infos;if(Ct){var Je=()=>e().createElement(Mt.Z,{list:Ct,displayAll:!0});return e().createElement(E.Z,{title:Je()},e().createElement("div",{className:"cl-text-ellipsis",style:{width:150}},Je()))}return e().createElement(E.Z,{title:e().createElement(Mt.Z,{sourceType:pt,list:je,nameList:w})},e().createElement("div",{className:"cl-text-ellipsis",style:{width:140}},w?e().createElement(Mt.Z,{sourceType:pt,list:je,nameList:w||"--"}):"--"))}},{title:i("component.directSupervisor"),dataIndex:"reports_to",key:"reports_to",width:100,render:w=>e().createElement(wt.Z,{type:w.sync_source_type,value:w.sync_user_id,dataType:"userName",name:w.name||"--"})},{title:i("component.belongPost"),dataIndex:"post_names",key:"post_names",width:150,render:w=>e().createElement(E.Z,{title:w},e().createElement("div",{className:"cl-text-ellipsis",style:{width:140}},w?w.join("\uFF0C"):"--"))},{title:i("marketing.loginEmail"),dataIndex:"login_email",key:"login_email",width:150,render:(w,ve)=>{var je=ve.login_email;return je||"--"}},{title:i("setting.facePhoto"),dataIndex:"face_url",key:"face_url",width:100,render:w=>{var ve=w?"face-icon":"hide-img";return e().createElement("img",{onClick:()=>this.showFaceImg(w),className:ve,src:w})}},{title:i("setting.joinTime"),dataIndex:"timeLabel",key:"timeLabel",width:150,render:(w,ve)=>{var je=ve.timeLabel;return je||"--"}}],b=(0,ct.Z)(l),Q;try{for(b.s();!(Q=b.n()).done;){var V=Q.value,R=function(ve){V.hasOwnProperty(ve)&&c.push({title:V[ve],dataIndex:ve,key:ve,width:150,render:(je,pt)=>pt[ve]||"--"})};for(var Se in V)R(Se)}}catch(w){b.e(w)}finally{b.f()}return c.push({title:i("setting.activeStatus"),dataIndex:"active",key:"active",width:150,fixed:"right",render:w=>i(w==="true"?"setting.activeLabel":"setting.unActiveLabel")}),e().createElement("div",{className:"group-display-table"},e().createElement("span",{className:"group-name"},this.props.groupTitle),p.belleFlag&&e().createElement("div",{className:"create-user-name"},"".concat(i("common.creator"),"\uFF1A ").concat(this.props.createUserName||"--")),e().createElement("div",{className:"group-user-table"},e().createElement("div",{className:"group-user-content-list",style:a?{minHeight:"calc(100vh - 412px"}:{}},e().createElement(B.f,{key:"group-table",rowSelection:n,dataSource:this.state.userList,columns:c,rowKey:w=>w.id,pagination:!1,scroll:{y:"100%",x:"max-content"},headerTitle:this.headerTitle(),toolBarRender:this.toolBarRender,tableUUID:"842099dd-b019-4ed0-af52-1c3fe74f8a34"})),e().createElement("div",{className:"group-user-pagination-wrapper"},e().createElement(_.Z,(0,F.Z)({},r,{className:"group-user-pagination"})))),e().createElement(M.Z,{title:"\u4EBA\u8138",visible:this.state.faceModalVisible,footer:null,onCancel:this.hideFaceModal,className:"face-modal-width"},e().createElement("img",{src:this.state.faceImgUrl,className:"face-img"})))}componentWillUnmount(){yt.pageNumber=1,yt.pageSize=20}}var va=(0,z.$j)(ma)((0,g.Z)()(ha)),ga=s(11449),fa=s(4408);class Vt extends e().Component{constructor(d){var i;super(d);i=this,this.onSelectNode=t=>{var a=t.type,r=t.activeId,n=t.title;!r||a==="dept"&&this.setState({activeDeptId:r,activeDeptTitle:n})},this.onImportUserCbk=()=>{this.orgBoxRef&&this.orgBoxRef.deptTreeRef&&this.orgBoxRef.deptTreeRef.onImportUserCbk()},this.changeDisplayType=t=>{var a=t.activeTab;this.setState({displayTable:a})},this.getSetting=(0,H.Z)(U().mark(function t(){var a,r,n,o;return U().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return a=i.props.t,p.next=3,O.WY.get({url:S.ZP.advancedSetting.getSetting(),params:{page_size:9999,page_number:1}});case 3:r=p.sent,n=r.data,o=!1,n.list&&n.list.forEach(c=>{c.action_list&&c.action_list.length>0&&c.action_list.forEach(b=>{b.param&&b.param.keyValue&&b.param.keyValue.length>0&&b.param.keyValue.forEach(Q=>{Q.columnValue===a("searchInputPlaceholder.mobileOp")&&(o=Q.columnKey)})})}),i.setState({isMobile:o});case 8:case"end":return p.stop()}},t)})),this.renderDisplayTable=()=>{var t=this.props,a=t.organizationType,r=t.tabStatus,n=r===void 0?"":r,o=t.hasRestPermission,l=t.goStudentMenu,p=this.state.isMobile;return e().createElement("div",{className:"organization-table-container"},this.state.displayTable==="dept"?e().createElement("div",{className:"organization-table-one"},e().createElement(na,{fromStudentMenu:l,deptId:this.state.activeDeptId,deptTitle:this.state.activeDeptTitle,organizationType:a,tabStatus:n,isMobile:p,onImportUserSuccess:this.onImportUserCbk,hasRestPermission:o})):null,this.state.displayTable==="post"?e().createElement("div",{className:"organization-table-one"},e().createElement(da,{organizationType:a,tabStatus:n})):null,this.state.displayTable==="group"?e().createElement("div",{className:"organization-table-one"},e().createElement(va,{tabStatus:n,organizationType:a})):null)},this.state={displayTable:"dept",activeDeptId:1,activeDeptTitle:"",isMobile:!1}}componentDidMount(){this.getSetting()}render(){var d=this.props,i=d.prefixCls,t=d.prefixClsContent,a=d.organizationType,r=d.tabStatus,n=r===void 0?"":r,o=d.t;return e().createElement(e().Fragment,null,e().createElement(fa.Z,{title:o("setting.userManagement")}),n?e().createElement("div",{className:i},e().createElement("div",{className:"".concat(i,"__content ").concat(t)},e().createElement("div",{className:"user-organization-left"},e().createElement(bt,{changeDisplayType:this.changeDisplayType,onSelectNode:this.onSelectNode,organizationType:a,tabStatus:n,onRef:l=>{this.orgBoxRef=l}})),e().createElement("div",{className:"user-organization-right"},this.renderDisplayTable()))):e().createElement(ga.Z,{pageContainerParams:{header:{title:this.props.t("setting.userManagement")}}},e().createElement("div",{className:i},e().createElement("div",{className:"".concat(i,"__content ").concat(t)},e().createElement("div",{className:"user-organization-left"},e().createElement(bt,{changeDisplayType:this.changeDisplayType,onSelectNode:this.onSelectNode,organizationType:a,onRef:l=>{this.orgBoxRef=l}})),e().createElement("div",{className:"user-organization-right"},this.renderDisplayTable())))))}}Vt.defaultProps={prefixCls:"organization-container-wrapper",prefixClsContent:"organization-container"};var Ea=(0,g.Z)()(Vt)},3255:function(Ne,ie,s){"use strict";var H=s(57663),j=s(71577),U=s(22385),x=s(31097),e=s(34792),g=s(48086),P=s(88986),A=s(57361),v=s(33565),N=s(9754),Z=s.n(N),E=s(12924),G=s.n(E),C=s(91768),z=s(28216),W=s(79906),oe=s(58767),F=s.n(oe),y=s(86726),_=s(60667),h=s(85372);function m(f){var D=f.t,Y=f.title,M=f.deptId,K=f.organizationType,I=f.isRefresh,B=(0,E.useState)(!1),$=(0,v.Z)(B,2),k=$[0],O=$[1],S=(0,E.useState)(!1),ae=(0,v.Z)(S,2),ue=ae[0],Te=ae[1],Ae=(0,E.useState)([]),fe=(0,v.Z)(Ae,2),X=fe[0],le=fe[1],Oe=(0,E.useState)(10),Be=(0,v.Z)(Oe,2),st=Be[0],we=Be[1],rt=localStorage.getItem("appType"),xe=(0,y.V9)("organization",f.user.modules);(0,E.useEffect)(()=>{$e(M)},[M,I,$e]),(0,E.useEffect)(()=>{setTimeout(()=>{f.dispatch({type:"advancedSetting/judgeShowUpdateGuide",payload:{type:"deptHeads1"}})},200)},[]);var $e=(0,E.useCallback)(function(){var et=(0,A.Z)(Z().mark(function Ke(Xe){var it,Ue,tt,Qe,nt,Re,u,L,de,ee;return Z().wrap(function(se){for(;;)switch(se.prev=se.next){case 0:return se.prev=0,se.next=3,(0,W.z)(Xe);case 3:it=se.sent,Ue=it.data,tt=it.success,tt==="true"&&(Qe=Ue.dept_leaders,nt=Ue.dept_leader_sync_switch,Re=Ue.dept_leader_upper_limit,u=Re===void 0?10:Re,L=["ding","weixin","fs","third_oa_app"],de=nt!=="OPEN"&&L.includes(K)||!L.includes(K),(M==="1"||M===1)&&K==="app"&&rt!=="app"&&(de=nt!=="OPEN"),ee=(0,y.H3)("edit_dept_leader",xe),Te(de&&ee),le(Qe.map(Le=>(0,P.Z)((0,P.Z)({},Le),{},{type:Le.source_type}))),we(u)),se.next=11;break;case 9:se.prev=9,se.t0=se.catch(0);case 11:case"end":return se.stop()}},Ke,null,[[0,9]])}));return function(Ke){return et.apply(this,arguments)}}()),J=et=>{O(et)},_t=function(){var et=(0,A.Z)(Z().mark(function Ke(Xe){var it,Ue,tt,Qe;return Z().wrap(function(Re){for(;;)switch(Re.prev=Re.next){case 0:return it=Xe.users,Ue={dept_leader_ids:it.map(u=>u.id),dept_id:M},Re.next=4,(0,W.E8)(Ue);case 4:tt=Re.sent,Qe=tt.success,Qe==="true"&&(g.default.success(D("common.editSuccess")),$e(M)),J(!1);case 8:case"end":return Re.stop()}},Ke)}));return function(Xe){return et.apply(this,arguments)}}(),Fe=()=>{var et=X.map((Ke,Xe)=>G().createElement(G().Fragment,null,G().createElement(_.Z,{key:Ke.id,dataType:"userName",value:Ke.user_id,name:Ke.name||"--",type:Ke.source_type}),Xe+1<X.length&&G().createElement(G().Fragment,null,"\uFF0C")));return X.length>0?G().createElement(x.Z,{title:et},G().createElement("div",{className:F().display},et)):ue?"":"--"};return G().createElement("div",{className:F()["header-section"]},G().createElement("div",{className:F().title},Y),G().createElement("div",{className:F().header},G().createElement("div",{id:"guide-deptHeads1",className:F().label},D("leftMenuLists.deptHeads"),"\uFF1A"),G().createElement("div",{className:F().value},Fe(),ue&&G().createElement(j.Z,{type:"link",onClick:()=>J(!0)},X.length>0?D("common.edit"):D("common.addSome")))),G().createElement(h.Z,{onOk:_t,onCancel:()=>J(!1),tabs:["user"],visible:k,value:{users:X},chooseUserList:["immediate"],maxUserConfig:{limitCount:st,limitTip:D("leftMenuLists.headsLimitTip",{num:st})},title:"".concat(D("leftMenuLists.editDeptHeads"))}))}m.defaultProps={organizationType:"ding"};var T=f=>{var D=f.user;return{user:D}};ie.Z=(0,z.$j)(T)((0,C.Z)()(m))},2871:function(Ne,ie,s){"use strict";s.d(ie,{$:function(){return v}});var H=s(71194),j=s(57016),U=s(57361),x=s(9754),e=s.n(x),g=s(78001),P=s(37055),A=s(10237),v=function(){var N=(0,U.Z)(e().mark(function Z(E,G){var C,z,W,oe,F,y,_,h=arguments;return e().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return C=h.length>2&&h[2]!==void 0?h[2]:"",z=P.ZP.autoAssigned.getRuleQuote(),W={org_type:E,org_value:G},T.next=5,A.WY.get({url:z,params:W});case 5:if(oe=T.sent,F=oe.data,y=F.success,_=F.data,y==="true"){T.next=10;break}return T.abrupt("return",!0);case 10:if(!_.list.length){T.next=13;break}return j.Z.warning({title:g.Z.t("autoAssign.notice"),content:g.Z.t("autoAssign.deleteDesc",{name:C.toLowerCase()}),okText:g.Z.t("common.close")}),T.abrupt("return",_.list);case 13:return T.abrupt("return",!1);case 14:case"end":return T.stop()}},Z)}));return function(E,G){return N.apply(this,arguments)}}()},54681:function(Ne,ie,s){"use strict";var H=s(91648);localStorage.getItem("subsidyDeviceId")||localStorage.setItem("subsidyDeviceId",(0,H.Z)().split("-").join("")),ie.Z={deviceType:"TYPE_PC",timestamp:new Date().getTime(),deviceId:localStorage.getItem("subsidyDeviceId")}},83940:function(Ne,ie,s){"use strict";s.d(ie,{v:function(){return j}});var H=s(75216);function j(U){var x=new H.Z,e="MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCwp-dZYUGEJ8ixBevMmANELzri9jUet_m5AR8VkrktzuZZ0B0X-F-DYiYWmSn0_2MSWRxtiVU7d2ZzPYodBelubnH3YgxcOKJ8ILaLlCkWZd30L68MAO3JG65NWIgCDq9d0BFiOY6XzRFav2E5-u33hVk1jWspTlgL9ylaEB5ynQIDAQAB";x.setPublicKey(e);var g=x.encrypt(U);return g}},86726:function(Ne,ie,s){"use strict";s.d(ie,{V9:function(){return j},H3:function(){return U},e:function(){return x},F:function(){return e}});var H=s(93485);function j(g){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],A=[];function v(N,Z){var E=(0,H.Z)(Z),G;try{for(E.s();!(G=E.n()).done;){var C=G.value;if(C.key===N){A=C.actions;break}C.children instanceof Array&&C.children.length&&v(g,C.children)}}catch(z){E.e(z)}finally{E.f()}}return v(g,P),A}function U(g){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],A=P.find(v=>v.key===g)||{};return A.checked||!1}function x(g){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],A=!1;function v(N,Z){var E=(0,H.Z)(Z),G;try{for(E.s();!(G=E.n()).done;){var C=G.value;if(C.key===N){A=C.checked;break}C.children instanceof Array&&C.children.length&&v(g,C.children)}}catch(z){E.e(z)}finally{E.f()}}return v(g,P),A}function e(g){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],A="";function v(N,Z){var E=(0,H.Z)(Z),G;try{for(E.s();!(G=E.n()).done;){var C=G.value;if(C.key===N){A=C.id;break}C.children instanceof Array&&C.children.length&&v(g,C.children)}}catch(z){E.e(z)}finally{E.f()}}return v(g,P),A}},26885:function(Ne,ie,s){"use strict";s.d(ie,{mw:function(){return C},kr:function(){return z},w8:function(){return W},Sk:function(){return F},$f:function(){return y}});var H=s(34792),j=s(48086),U=s(88986),x=s(57361),e=s(9754),g=s.n(e),P=s(76651),A=s(78001),v=s(37055),N=s(10237),Z=localStorage.getItem("corpId"),E=(_,h)=>{wx.config({beta:!0,debug:!1,appId:_.corpId||localStorage.getItem("corpId"),timestamp:_.timeStamp,nonceStr:_.nonceStr,signature:_.signature,jsApiList:["openDefaultBrowser","innerSaveWebPerformance"]}),wx.ready(()=>{h&&z()}),wx.error(m=>{console.log("error",m)})},G=(_,h)=>{wx.agentConfig({corpid:_.corpId,agentid:_.agentId,timestamp:_.timeStamp,nonceStr:_.nonceStr,signature:_.signature,jsApiList:["openDefaultBrowser","selectExternalContact","selectEnterpriseContact","selectPrivilegedContact","createChatWithMsg","openEnterpriseChat","openExistedChatWithMsg"],success:()=>{h("success"),(0,P.Qm)()._store.dispatch({type:"user/setWxWorkApiFlag",payload:{wxWorkApiFlag:(0,P.Qm)()._store.getState().user.wxWorkApiFlag+=1}})},fail:m=>{m.errMsg.indexOf("function not exist")>-1&&alert("\u7248\u672C\u8FC7\u4F4E\u8BF7\u5347\u7EA7")}})},C=(_,h,m)=>{window.wx.openEnterpriseChat({userIds:_.join(";"),groupName:h.title,chatId:"",success:function(f){var D=f.chatId;window.wx.invoke("openExistedChatWithMsg",{chatId:D,msg:{msgtype:"link",link:{title:h.title,desc:h.desc,url:h.url,imgUrl:h.imgUrl}}},function(Y){Y.err_msg=="openExistedChatWithMsg:ok"&&m&&m(D)})},fail:function(f){f.errMsg.indexOf("function not exist")>-1&&alert("\u7248\u672C\u8FC7\u4F4E\u8BF7\u5347\u7EA7")}})},z=function(){var _=(0,x.Z)(g().mark(function h(m){var T,f,D,Y,M,K,I=arguments;return g().wrap(function($){for(;;)switch($.prev=$.next){case 0:return T=I.length>1&&I[1]!==void 0?I[1]:()=>{},f=v.ZP.util.getAppSignature(),D=window.location.href.split("#")[0],Y=m||v.ZP.enterpriseId,$.next=6,N.WY.get({url:f,params:{enterprise_id:Y,url:D,batch_id:""}});case 6:M=$.sent,K=M.data,G(K,T);case 9:case"end":return $.stop()}},h)}));return function(m){return _.apply(this,arguments)}}(),W=function(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(navigator.userAgent.toLowerCase().indexOf("wxwork")>-1){var T=v.ZP.util.getCorpSignature(),f=window.location.href.split("#")[0];N.WY.get({url:T,params:{enterprise_id:v.ZP.enterpriseId,url:f,batch_id:m}}).then(D=>{var Y=D.data;E(Y,h)})}else h&&z()},oe=function(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=CONFIG.util.getSignature(),T=window.location.href;request.get({url:m,params:{corpId:Z,url:T,uuid:""}}).then(f=>{var D=f.data;E(D,h)})},F=_=>{var h=_.userIds,m=h===void 0?[]:h,T=_.deptIds,f=T===void 0?[]:T,D=_.mode,Y=D===void 0?"multi":D;return new Promise((M,K)=>{window.wx.invoke("selectPrivilegedContact",{fromDepartmentId:0,mode:Y,selectedContextContact:0,selectedOpenUserIds:m||[],selectedTickets:f||[]},I=>{I.err_msg==="selectPrivilegedContact:ok"?(typeof I.result=="string"&&(I.result=JSON.parse(I.result)),M(I.result)):I.err_msg==="selectPrivilegedContact:cancel"&&K("cancel")})})},y=_=>{var h=_.type,m=h===void 0?"employeeRange":h,T=_.result,f=T===void 0?{}:T,D=_.user,Y=D===void 0?{}:D,M=_.reserveUser,K=M===void 0?[]:M,I=_.rangeType,B=I===void 0?"all":I,$=_.hasDefault,k=$===void 0?!0:$;return new Promise(O=>{var S=f.userList,ae=S===void 0?[]:S,ue=f.selectedUserCount,Te=ae||[];if(m==="employeeRange"){var Ae=Y.unionid,fe="";!ae.length&&ue?(k&&(Te.push({id:Ae,unionid:Ae,openUserId:Ae}),f.userList=[{id:Ae,unionid:Ae,openUserId:Ae}],f.selectedUserCount+=1),fe=!0):fe=!1;var X={dept:[],post:[],group:[],user:Te.map(J=>(0,U.Z)((0,U.Z)({},J),{},{unionid:J.openUserId,id:J.openUserId,user_id:J.openUserId,source_type:"wx_sync"})),classes:[],cluster:[]};B==="onlyDeptUser"&&(X={dept:[],user:Te.map(J=>(0,U.Z)((0,U.Z)({},J),{},{unionid:J.openUserId,id:J.openUserId,user_id:J.openUserId,source_type:"wx_sync"}))});var le={isShowType:fe,qyWeChatVo:JSON.stringify(f),rangeList:X},Oe=f.selectedUserCount-X.user.length;Oe>0&&(fe&&k?j.default.warning(A.Z.t("component.selectedErrorTips",{count:Oe})):j.default.warning(A.Z.t("component.selectedErrorTips2",{count:Oe}))),O(le)}if(m==="supervision"){ae&&(Te.find(J=>J.openUserId===(K[0].unionid||K[0].user_id||K[0].name))&&(f.selectedUserCount-=1),Te=Te.filter(J=>J.openUserId!==K[0].unionid&&J.openUserId!==K[0].user_id&&J.openUserId!==K[0].name).map(J=>J));var Be=Te.map(J=>(0,U.Z)((0,U.Z)({},J),{},{unionid:J.openUserId,id:J.openUserId,user_id:J.openUserId,source_type:"wx_sync"})),st={qyWeChatVo:JSON.stringify(f),user:Be},we=f.selectedUserCount-Be.length;we>0&&j.default.warning(A.Z.t("component.selectedErrorTips2",{count:we})),O(st)}if(m==="normal"){var rt=Te.map(J=>(0,U.Z)((0,U.Z)({},J),{},{unionid:J.openUserId,id:J.openUserId,user_id:J.openUserId,source_type:"wx_sync",qyWeChatVo:JSON.stringify(f)})),xe={qyWeChatVo:JSON.stringify(f),user:rt},$e=f.selectedUserCount-rt.length;$e>0&&j.default.warning(A.Z.t("component.selectedErrorTips2",{count:$e})),O(xe)}})}},15742:function(Ne,ie,s){var H=s(57406),j=s(65776),U=Array.prototype,x=U.splice;function e(g,P){for(var A=g?P.length:0,v=A-1;A--;){var N=P[A];if(A==v||N!==Z){var Z=N;j(N)?x.call(g,N,1):H(g,N)}}return g}Ne.exports=e},57406:function(Ne,ie,s){var H=s(71811),j=s(10928),U=s(53307),x=s(40327);function e(g,P){return P=H(P,g),g=U(g,P),g==null||delete g[x(j(P))]}Ne.exports=e},53307:function(Ne,ie,s){var H=s(97786),j=s(14259);function U(x,e){return e.length<2?x:H(x,j(e,0,-1))}Ne.exports=U},82729:function(Ne,ie,s){var H=s(67206),j=s(15742);function U(x,e){var g=[];if(!(x&&x.length))return g;var P=-1,A=[],v=x.length;for(e=H(e,3);++P<v;){var N=x[P];e(N,P,x)&&(g.push(N),A.push(P))}return j(x,A),g}Ne.exports=U}}]);
