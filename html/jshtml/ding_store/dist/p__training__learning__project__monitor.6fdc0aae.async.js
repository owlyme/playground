(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[1465],{26096:function(Pe,J,e){"use strict";var V=e(30887),T=e(99210),q=e(62029),A=e(22385),H=e(31097),te=e(12924),t=e.n(te),j=e(71967),Z=e.n(j),B=e(1164),N=f=>f.type==="more"?f.disabled?t().createElement(T.Z.Item,(0,q.Z)({},f,{key:f.key,disabled:!0}),f.tooltip?t().createElement(H.Z,{title:f.tooltip},t().createElement("p",{className:"cl-dropdown-menuitem"},f.title)):t().createElement("p",{className:"cl-dropdown-menuitem"},f.title)):f.link?t().createElement(T.Z.Item,(0,q.Z)({},f,{key:f.key}),t().createElement(B.Z,{to:f.link},t().createElement("p",{className:"cl-dropdown-menuitem"},f.title))):t().createElement(T.Z.Item,(0,q.Z)({},f,{key:f.key}),t().createElement("p",{className:"cl-dropdown-menuitem",onClick:f.click},f.title)):f.disabled?f.tooltip?t().createElement(t().Fragment,{key:f.key},t().createElement(H.Z,{title:f.tooltip},t().createElement("span",{className:"".concat(Z().pointer," ").concat(Z().disabled)},f.title))):t().createElement(t().Fragment,{key:f.key},t().createElement("span",{className:"".concat(Z().pointer," ").concat(Z().disabled)},f.title)):f.link?t().createElement(t().Fragment,{key:f.key},t().createElement(B.Z,{to:f.link},t().createElement("span",{className:"cl-pointer ".concat(Z().pointer)},f.title))):t().createElement(t().Fragment,{key:f.key},t().createElement("span",{className:"cl-pointer ".concat(Z().pointer),onClick:f.click},f.title));J.Z=N},16598:function(Pe,J,e){"use strict";var V=e(59250),T=e(13013),q=e(30887),A=e(99210),H=e(62029),te=e(12924),t=e.n(te),j=e(57254),Z=e(91768),B=e(26096),N=(w,W)=>{var D=w.map(k=>t().createElement(B.Z,(0,H.Z)({},k,{type:W,key:k.key||k.type})));return W==="more"?t().createElement(A.Z,null,D):D},f=w=>{var W=w.buttons,D=w.t,k=w.visibleNum,p=W.filter(G=>G.visible),z=k||1,h=[],ee=[];if(p.length<=z)ee=[...p];else if(p.length>z)ee=[...p.slice(0,z)],h=[...p.slice(z)];else return"/";return t().createElement("div",{className:"cl-table__cell-action"},N(ee),ee.some(G=>G.visible)&&h.some(G=>G.visible)?t().createElement(t().Fragment,null,t().createElement("span",{className:"cl-pointer-divide"}),t().createElement(T.Z,{overlay:N(h,"more")},t().createElement("span",{className:"cl-pointer"},D("common.more")," ",t().createElement(j.Z,null)))):null)};f.defaultProps={visibleNum:1},J.Z=(0,Z.Z)()(f)},18884:function(Pe,J,e){"use strict";var V=e(57338),T=e(83107),q=e(57663),A=e(71577),H=e(47673),te=e(4107),t=e(62029),j=e(81211),Z=e(34792),B=e(48086),N=e(57361),f=e(18106),w=e(88108),W=e(9754),D=e.n(W),k=e(12924),p=e.n(k),z=e(91768),h=e(40847),ee=e(99946),G=e(70548),Y=e.n(G),_e=e(79),u=e(66708),ge=e(38642),ve=w.Z.TabPane;class me extends p().Component{constructor(L){var M;super(L);M=this,this.onFormMounted=C=>{this.AddFormInstance=C},this.handleCancelShare=()=>{var C=this.props.onCancel;C&&C()},this.getVisitorConfig=(0,N.Z)(D().mark(function C(){var E,$,F;return D().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return ae.next=2,(0,_e.L)(localStorage.getItem("enterpriseId"));case 2:E=ae.sent,$=E.data,F=E.status,F===200&&($.open_visitor_page==="true"?M.setState({visitorIsOpen:!0,pcDomain:$.pc_domain||""}):M.setState({visitorIsOpen:!1}));case 6:case"end":return ae.stop()}},C)})),this.handleCopy=()=>{var C=document.getElementById("share-link");C.select(),document.execCommand("Copy"),B.default.success(this.props.t("live.copySuccess"))},this.renderContent=()=>{var C=this.props,E=C.t,$=C.tabsTitle,F=C.isProjectShare,K=(0,j.Z)(C,["t","tabsTitle","isProjectShare"]),ae=this.state,pe=ae.active,fe=ae.visitorIsOpen,Ce=ae.pcDomain,se=ae.shareUrl;return fe?p().createElement(w.Z,{defaultActiveKey:pe,onChange:this.handleTabs},p().createElement(ve,{tab:$[0]||E("tutorial.student"),key:"0"},p().createElement("p",{className:Y()["share-tip"]},p().createElement(h.Z,{className:Y()["info-icon"]}),E("common.traineeShareTip")),p().createElement(u.Z,(0,t.Z)({type:"card",center:!1,label:E("setting.Qrcode"),saveText:E("shareInfo.downloadCode"),downloadAsBtn:!0},K)),se&&!F&&p().createElement("div",{className:Y()["url-share"]},p().createElement("label",null,E("common.urlAddress"),":"),p().createElement("div",{className:Y()["right-content"]},p().createElement(te.Z,{className:Y()["share-url-input"],readOnly:!0,value:se,id:"share-link"}),p().createElement(A.Z,{type:"primary",className:Y()["copy-btn"],onClick:this.handleCopy},E("registerLogin.copyLink")),p().createElement("span",{className:Y()["share-tip"]},E("common.shareTip"))))),K.option&&K.option.flag==="exam_task"?null:p().createElement(ve,{tab:$[1]||E("common.tourist"),key:"1"},p().createElement(ee.Z,(0,t.Z)({onFormMounted:this.onFormMounted,handleVisitorTabs:this.visitorTabs,pcDomain:Ce},K)))):p().createElement(k.Fragment,null,p().createElement("p",{className:Y()["share-tip"]},p().createElement(h.Z,{className:Y()["info-icon"]}),E("common.traineeShareTip")),p().createElement(u.Z,(0,t.Z)({type:"card",center:!1,label:E("setting.Qrcode"),saveText:E("shareInfo.downloadCode"),downloadAsBtn:!0},K)),se&&!F&&p().createElement("div",{className:Y()["url-share"]},p().createElement("label",null,E("common.urlAddress"),":"),p().createElement("div",{className:Y()["right-content"]},p().createElement(te.Z,{className:Y()["share-url-input"],readOnly:!0,value:se,id:"share-link"}),p().createElement(A.Z,{type:"primary",className:Y()["copy-btn"],onClick:this.handleCopy},E("registerLogin.copyLink")),p().createElement("span",{className:Y()["share-tip"]},E("common.shareTip")))))},this.state={active:0,visitorIsOpen:!1,pcDomain:"",shareUrl:""}}componentDidMount(){this.getVisitorConfig()}componentDidUpdate(L){var M=this.props.option;if(L.option.flag!==M.flag&&M.flag==="share_course_enterprise"){var C=(0,ge.dU)(),E=localStorage.getItem("enterpriseId");this.setState({shareUrl:"".concat("https://mobile.coolcollege.cn","/assets-share-link.html?env=").concat(C,"&eid=").concat(E,"&").concat(M.scene,"&msgSource=shareLink")})}}render(){var L=this.props,M=L.title,C=L.visible;return p().createElement(T.Z,{title:M,className:Y()["share-modal"],width:560,onClose:this.handleCancelShare,visible:C,destroyOnClose:!0,footerStyle:{textAlign:"right"},bodyStyle:{paddingTop:10,paddingLeft:30,paddingRight:30}},this.renderContent())}}me.defaultProps={visible:!0,title:"",onCancel:()=>{},tip:"",record:{},option:{flag:"",scene:""},tabsTitle:["",""]},J.Z=(0,z.Z)()(me)},41194:function(Pe,J,e){"use strict";var V=e(47673),T=e(4107),q=e(57663),A=e(71577),H=e(34792),te=e(48086),t=e(12924),j=e.n(t),Z=e(91768),B=e(92592),N=e(87797),f=e.n(N);class w extends j().Component{constructor(D){super(D);this.handleDownload=()=>{var k=document.getElementById("code_canvas"),p=this.state.codeUrl,z=new Image;z.crossOrigin="anonymous",z.src=p,z.onload=()=>{var h=k.getContext("2d");h.textAlign="center",h.fillStyle="#fff",h.fillRect(0,0,750,886),h.drawImage(z,185,217,381,381),h.font="42px bold serif",h.fillStyle="#4F4F4F";var ee=k.toDataURL("image/jpeg"),G=document.createElement("a");G.setAttribute("href",ee),G.setAttribute("download","".concat(this.props.t("setting.Qrcode"),".jpg")),document.body.insertAdjacentElement("beforeend",G),G.click(),G.remove()}},this.handleCopy=()=>{var k=this.props.id,p=document.getElementById(k||"visitor-link");p.select(),document.execCommand("Copy"),te.default.success(this.props.t("live.copySuccess"))},this.state={codeUrl:""}}componentDidMount(){this.props.shareUrl&&B.toDataURL(this.props.shareUrl,{width:500}).then(D=>{this.setState({codeUrl:D})}).catch(()=>{te.default.error(this.props.t("integralMall.qrCodeFailed"))})}componentDidUpdate(D){D.shareUrl!==this.props.shareUrl&&this.props.shareUrl&&B.toDataURL(this.props.shareUrl,{width:500}).then(k=>{this.setState({codeUrl:k})}).catch(()=>{te.default.error(this.props.t("integralMall.qrCodeFailed"))})}render(){var D=this.props,k=D.shareUrl,p=D.t,z=D.notShowQrCode,h=D.urlLabel,ee=D.id,G=this.state.codeUrl;return j().createElement(t.Fragment,null,z?null:j().createElement("div",{className:f()["visitor-qrCode-share"]},j().createElement("label",null,p("setting.Qrcode"),":"),j().createElement("div",{className:f()["qrCode-section"]},j().createElement("img",{className:f()["qrCode-img"],src:G,alt:""}),j().createElement("canvas",{className:f()["code-canvas"],id:"code_canvas",width:750,height:886}),j().createElement(A.Z,{type:"primary",className:f()["download-btn"],onClick:this.handleDownload},p("shareInfo.downloadCode")))),j().createElement("div",{className:f()["visitor-url-share"]},j().createElement("label",null,h||p("common.urlAddress"),":"),j().createElement("div",{className:f()["right-content"]},j().createElement(T.Z,{className:f()["share-url-input"],readOnly:!0,value:k,id:ee||"visitor-link"}),j().createElement(A.Z,{type:"primary",className:f()["copy-btn"],onClick:this.handleCopy},p("registerLogin.copyLink")),j().createElement("span",{className:f()["share-tip"]},p("common.shareTip")))))}}w.defaultProps={shareUrl:"",notShowQrCode:!1,urlLabel:"",id:"visitor-link"},J.Z=(0,Z.Z)()(w)},79:function(Pe,J,e){"use strict";e.d(J,{L:function(){return q}});var V=e(5430),T=e(10237);function q(A){var H=V.ZP.visitors.getVisitorSetting(A);return T.WY.get({url:H})}},99946:function(Pe,J,e){"use strict";var V=e(12924),T=e.n(V),q=e(91768),A=e(40847),H=e(41194),te=e(51431),t=e.n(te);class j extends T().Component{constructor(B){super(B);this.handleVisitorTabs=N=>{var f=this.props.handleVisitorTabs;f&&f(N)},this.state={shareUrl:"",excludeDomains:["localhost","127.0.0.1"]}}componentDidMount(){var B=this.state.excludeDomains,N=this.props,f=N.option,w=N.pcDomain,W=w||window.location.hostname||document.domain||"",D=window.location.port,k=localStorage.getItem("enterpriseId");W&&B.indexOf(W)<0?this.setState({shareUrl:"https://".concat(W,"/#/visitor?").concat(f.scene,"&enterpriseId=").concat(k)}):this.setState({shareUrl:"http://".concat(W,":").concat(D,"/#/visitor?").concat(f.scene,"&enterpriseId=").concat(k)})}render(){var B=this.props,N=B.t,f=B.tip,w=B.onlyUrl,W=B.urlLabel,D=B.id,k=this.state.shareUrl;return T().createElement("div",{className:t()["visitor-share-content"]},T().createElement("p",{className:t()["share-tip"]},T().createElement(A.Z,{className:t()["info-icon"]}),f||N("common.visitorShareTip")),T().createElement(H.Z,{id:D,shareUrl:w||k,urlLabel:W}))}}j.defaultProps={record:{},shareUrl:"",tip:"",urlLabel:"",id:""},J.Z=(0,q.Z)()(j)},11449:function(Pe,J,e){"use strict";e.d(J,{Z:function(){return re}});var V=e(88986),T=e(33565),q=e(12924),A=e.n(q),H=e(3115),te=e(49111),t=e(19650),j=e(62029),Z=e(57663),B=e(71577),N=e(91768),f=e(28216),w=e(37055),W=e(10237);function D(L){var M=w.ZP.getHelpContentByMenuKey(),C={key:L};return W.WY.get({url:M,params:C})}var k=e(74228),p=e.n(k),z=e(1164),h=e(76466),ee=e(38642);class G extends A().Component{constructor(M){var C;super(M);C=this,this.getHelpContentByMenuKey=()=>{var E=this.props.defaultMenuKey;D(E).then($=>{var F=$.data,K=F.help_url,ae=F.video_url;this.setState({videoUrl:ae,helpUrl:K})})},this.handleOpenHelpUrl=E=>{if((0,ee.ve)()){window.open(E,"_blank");return}z.Z.targetTo({path:E,isExternalLink:!0})},this.handleOpenVideo=function(E){var $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:C.props.t("helpCenter.video");C.setState(F=>({resourcePlayInfo:(0,V.Z)((0,V.Z)({},F.resourcePlayInfo),{},{resourceInfo:{originUrl:E,source:{FD:E,OD:E},contentType:"mp4"}}),previewInfo:(0,V.Z)((0,V.Z)({},F.previewInfo),{},{title:$,visible:!0,onCancel:C.handleCancelPreview})}))},this.handleCancelPreview=()=>{var E=this.state.previewInfo;this.setState({resourcePlayInfo:{mode:"preview",watchType:"video",resourceInfo:{}},previewInfo:(0,V.Z)((0,V.Z)({},E),{},{visible:!1})})},this.state={helpUrl:"",videoUrl:"",resourcePlayInfo:{autoPlay:!0,draggable:!0,mode:"preview",resourceInfo:{},watchType:"video"},previewInfo:{visible:!1,destroyOnClose:!0,title:M.t("helpCenter.video")||"\u89C6\u9891\u6307\u5BFC",onCancel:()=>{}}}}componentDidMount(){this.getHelpContentByMenuKey()}render(){var M=this.state,C=M.helpUrl,E=M.resourcePlayInfo,$=M.previewInfo,F=M.videoUrl,K=this.props.t;return A().createElement("div",{className:p().helpCenter},F&&A().createElement(B.Z,{type:"link",className:p()["video-btn"],style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenVideo(F)},K("helpCenter.video")),C&&A().createElement(B.Z,{type:"link",style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenHelpUrl(C)},K("helpCenter.tutorial")),A().createElement(h.Z,(0,j.Z)({},E,{previewInfo:$})))}}var Y=L=>({defaultMenuKey:L.currentRoute.menuKey});G.defaultProps={defaultMenuKey:""};var _e=(0,f.$j)(Y)((0,N.Z)()(G));function u(L){var M=L.extra,C=localStorage.getItem("dingPersonnel"),E=sessionStorage.getItem("dingPersonnel");return A().createElement(t.Z,null,M,C!=="dingPersonnel"&&E!=="dingPersonnel"&&(0,ee.eY)("COMMONEXTRA_HELP_CENTER")&&A().createElement(_e,null))}var ge=u,ve=e(4408);function me(L){var M=(0,q.useState)({helpCenter:(0,ee.eY)("HEAD_HELP_CENTER_BUT")}),C=(0,T.Z)(M,1),E=C[0],$=L.pageContainerParams,F=$===void 0?{}:$,K=L.noPadding,ae=K===void 0?!1:K,pe=L.isPersonal,fe=pe===void 0?!1:pe,Ce=L.pageTitle,se=L.className,Te=se===void 0?"":se,ye={extra:E.helpCenter?A().createElement(ge,{extra:F.extra}):F.extra},xe=(0,V.Z)((0,V.Z)({},F),ye);return A().createElement("div",{className:"page-container-content ".concat(ae?"page-container-noPadding":""," ").concat(fe?"page-container-content_personal_background":""," ").concat(Te)},Ce&&A().createElement(ve.Z,{title:Ce}),fe?A().createElement(H.Z,null,L.children):A().createElement(H.Z,xe,L.children))}var re=me},79590:function(Pe,J,e){"use strict";e.d(J,{Z:function(){return me}});var V=e(12924),T=e.n(V),q=e(62029),A=e(88986),H=e(49111),te=e(19650),t=e(57663),j=e(71577),Z=e(91768),B=e(84391),N=e(28216),f=e(1657),w=e(43060),W=e(37055),D=e(10237);function k(re){return D.WY.get({url:W.ZP.lineClassStudy.getStuAttendanceInfo(re),params:{}})}var p=e(36202),z=e(6793),h=e(97593),ee=e(48674),G=e(18329),Y=e(60667),_e=re=>{var L=re.user;return{qyShield:L.qyShield}};class u extends T().Component{constructor(L){super(L);this.onLinkDetail=M=>{this.setState({isEdit:!0,record:M})},this.onCreateQr=M=>{this.setState({qrCodeVisible:!0,qrCodeDetail:M}),k(M.id).then(C=>{var E=C.data.data.open_transfer_student;this.setState({open_transfer_student:E})})},this.onHandleCancel=()=>{this.setState({isEdit:!1})},this.onCancelImport=()=>{this.setState({importVisible:!1})},this.onExportSuccess=()=>{this.setState({importVisible:!1})},this.handleExportExcel=()=>{var M=this.props,C=M.type,E=M.taskId,$=M.projectId,F=C==="study_plan"?E:$,K="?access_token=".concat(window.localStorage.getItem("token"),"&source_type=").concat(C,"&course_id=").concat(E);(0,h.N)({page:"signAnalysisExport",props:this.props,query:K,rest:F})},this.handleImportExcel=()=>{this.setState({importVisible:!0})},this.getTableColumn=()=>{var M=[{title:this.props.t("practiceOperation.attendanceName"),dataIndex:"name",key:"name",fixed:"left"},{title:this.props.t("practiceOperation.outlineName"),dataIndex:"course_title",key:"course_title",render:(C,E)=>T().createElement("span",null,E.course_title||"--")},{title:this.props.t("practiceOperation.lecturer"),dataIndex:"lecturer_name",key:"lecturer_name",render:(C,E)=>{var $=E.teacher_sync_type,F=E.teacher_sync_user_id,K=E.teacher_sync_source_type;return C&&$&&$==="inside"?T().createElement(Y.Z,{dataType:"userName",value:F,name:C,type:K}):T().createElement("span",null,C||"--")}},{title:this.props.t("practiceOperation.classStartTime"),dataIndex:"course_begin_time",key:"course_begin_time",render:(C,E)=>{var $=E.course_begin_time?(0,z.p6)(Number(E.course_begin_time),"yyyy-MM-dd hh:mm"):"--",F=E.course_end_time?(0,z.p6)(Number(E.course_end_time),"yyyy-MM-dd hh:mm"):"--";return"".concat($,"~").concat(F)}},{title:this.props.t("practiceOperation.shouldArrival"),dataIndex:"should_arrive_count",key:"should_arrive_count"},{title:this.props.t("practiceOperation.actualArrival"),dataIndex:"real_arrive_count",key:"real_arrive_count"},{title:this.props.t("practiceOperation.absent"),dataIndex:"absent_count",key:"absent_count"},{title:this.props.t("practiceOperation.vacate"),dataIndex:"leave_count",key:"leave_count"},{title:this.props.t("common.operate"),fixed:"right",key:"operate",render:(C,E)=>this.renderActions({record:E})}];return M},this.renderActions=M=>{var C=M.record,E=this.props.t;return T().createElement("div",{className:"cl-table__cell-action"},T().createElement("span",{className:"cl-pointer",onClick:()=>this.onLinkDetail(C)},E("practiceOperation.attendanceView")),T().createElement("span",{className:"cl-pointer",onClick:()=>this.onCreateQr(C)},E("practiceOperation.attendanceQr")))},this.state={isEdit:!1,record:{},importVisible:!1,qrCodeVisible:!1,qrCodeDetail:{},open_transfer_student:!1}}componentDidMount(){}render(){var L=this.props,M=L.t,C=L.isLoading,E=L.prefixCls,$=L.taskId,F=L.planStatus,K=L.taskType,ae=L.type,pe=L.list,fe=pe===void 0?[]:pe,Ce=L.getAttendanceData,se=this.state,Te=se.isEdit,ye=se.record,xe=se.importVisible,$e=se.qrCodeVisible,ke=se.qrCodeDetail,ce=se.open_transfer_student,Ue=fe.length,Be=this.getTableColumn(),oe={mask:!0,width:700,title:M("lineClassStudy.QRCode"),footer:null,bodyStyle:{padding:0},destroyOnClose:!0,visible:$e,onCancel:()=>this.setState({qrCodeVisible:!1})},Ne={mask:!0,width:900,title:M("practiceOperation.attendanceView"),footer:null,bodyStyle:{padding:"24px"},destroyOnClose:!0,visible:Te,onCancel:()=>this.setState({isEdit:!1})};return T().createElement("section",{className:E},T().createElement(te.Z,null,T().createElement(j.Z,{type:"primary",icon:T().createElement(B.Z,null),onClick:this.handleExportExcel}," ",M("common.exportData")," "),T().createElement(j.Z,{type:"primary",disabled:F&&F==="unpublished"||Ue===0,onClick:this.handleImportExcel}," ",M("lineClass.batchCollection")," ")),T().createElement(p.f,{loading:C,dataSource:fe,columns:Be,rowKey:Ke=>Ke.id,pagination:!1,tableUUID:"ea45645b-4814-4bfa-a36c-b750ef32ecac",style:{minWidth:"100%"}}),T().createElement(w.Z,{visible:xe,onExportSuccess:this.onExportSuccess,onCancel:this.onCancelImport,taskId:$,type:ae}),T().createElement(ee.Z,{modalConfig:oe,detail:(0,A.Z)((0,A.Z)({},ke),{},{title:ke.course_title,sign_address:ke.address,sign_address_detail:ke.address_detail}),open_transfer_student:!ce,can_save:!1,universal:!0}),T().createElement(G.ZP,(0,q.Z)({},Ne,{visible:Te,onCancel:this.onHandleCancel,onOk:this.onHandleCancel}),T().createElement("div",null,T().createElement(f.Z,{taskId:$,taskType:K,record:ye,type:ae,getAttendanceData:Ce}))))}}u.defaultProps={prefixCls:"offline-panel__table"};var ge=(0,N.$j)(_e)((0,Z.Z)()(u));class ve extends T().Component{constructor(L){super(L);this.state={}}render(){var L=this.props,M=L.attendanceInfo,C=L.isLoading,E=L.taskId,$=L.taskType,F=L.type,K=L.planStatus,ae=L.getAttendanceData,pe=L.projectId;return T().createElement("div",{className:"offline-panel-tab"},T().createElement("div",{className:"offline-panel-tab-list"},T().createElement("div",{className:"offline-panel-tab-list-table"},T().createElement(ge,{isLoading:C,list:M.list,taskId:E,projectId:pe,planStatus:K,taskType:$,type:F,getAttendanceData:ae}))))}}var me=ve},945:function(Pe,J,e){"use strict";e.d(J,{Z:function(){return w}});var V=e(62029),T=e(88986),q=e(12924),A=e.n(q),H=e(91768),te=e(55285),t=e(37055),j=e(18329),Z=e(95664),B=e(10237);function N(W){var D=t.ZP.StudyProjectList.getGoodsCountList();return B.WY.get({url:D,params:W})}class f extends A().Component{constructor(D){super(D);this.onPageChange=k=>{var p=this.state.pageConfig;p.pageNumber=k,this.setState({pageConfig:p},()=>{this.getGoodsCountList()})},this.getGoodsCountList=()=>{var k=this.state.pageConfig,p={page_number:k.pageNumber,page_size:k.pageSize,enterprise_id:t.ZP.enterpriseId,order_id:this.props.order_id};N(p).then(z=>{k.totalNum=z.data.total,k.totalPage=z.data.pages;var h=z.data.list;h.forEach(ee=>{var G=(0,T.Z)({},ee);ee.user_info=G}),this.setState({dataList:h,pageConfig:k})})},this.state={dataList:[],pageConfig:{pageNumber:1,pageSize:10}}}componentDidUpdate(D){D.visible!==this.props.visible&&this.props.visible&&this.setState({pageConfig:{pageNumber:1,pageSize:10}},()=>{this.getGoodsCountList()})}render(){var D=this.props.t,k=this.state,p=k.dataList,z=k.pageConfig,h={title:"".concat(D("common.viewDetails")," (").concat(D("payment.allCounts")," ").concat(z.totalNum,")"),size:"medium",destroyOnClose:!0,maskClosable:!1};return A().createElement(j.ZP,(0,V.Z)({},h,{visible:this.props.visible,onCancel:()=>this.props.onHiddenGoodsCount(),footer:null}),A().createElement(te.Z,{dataSource:p,bordered:!0,rowKey:ee=>ee.id,pagination:!1,tableUUID:"40960a22-bea1-4447-add3-52be72448e80"}),A().createElement(Z.Z,{totalNum:z.totalNum,totalPage:z.totalPage,current:z.pageNumber,defaultPageSize:10,showRenderRefresh:!1,onChange:this.onPageChange}))}}f.defaultProps={visible:!1,onHiddenGoodsCount:()=>{},onCancel:()=>{}};var w=(0,H.Z)()(f)},5868:function(Pe,J,e){"use strict";e.r(J),e.d(J,{default:function(){return yt}});var V=e(62029),T=e(71194),q=e(57016),A=e(18106),H=e(88108),te=e(12924),t=e.n(te),j=e(28216),Z=e(91768),B=e(57068),N=e(35925),f=e(79590),w=e(14781),W=e(53431),D=e(63185),k=e(9676),p=e(88986),z=e(88983),h=e(47933),ee=e(57663),G=e(71577),Y=e(57361),_e=e(43358),u=e(34041),ge=e(9754),ve=e.n(ge),me=e(84391),re=e(76651),L=e(34669),M=e(82833),C=e(47745),E=e(59250),$=e(13013),F=e(30887),K=e(99210),ae=e(57254),pe=e(1164);class fe extends t().PureComponent{constructor(o){super(o);this.showStudyRecord=()=>{var n=this.props.record;n.study_count<=0||this.props.showStudyRecord(n.user_id,n)},this.linkToExam=()=>{var n=this.props.record;n.exam_count>0&&n.exam_join_count>0&&this.props.linkToExamRecord(n)},this.linkToOperationRecord=()=>{var n=this.props,a=n.record,s=n.projectId,l=n.id;a.total_operation_count<=0||pe.Z.targetTo({path:"/training/operation/info?id=".concat(l,"&taskId=").concat(s,"&userId=").concat(a.user_id,"&taskType=study_project&renderList=true&page=monitor")})},this.moreOperate=()=>{var n=this.props,a=n.record,s=n.enterpriseId,l=n.t;return t().createElement(K.Z,null,t().createElement(K.Z.Item,{disabled:!(a.exam_count>0&&a.exam_join_count>0&&a.exam_get_score_count>0),key:"assigned"},t().createElement("p",{className:"cl-dropdown-menuitem",onClick:this.linkToExam},l("common.examRecord"))),t().createElement(K.Z.Item,{disabled:a.total_operation_count<=0},t().createElement("p",{className:"cl-dropdown-menuitem",onClick:this.linkToOperationRecord},l(s==="1074539867477774379"?"leftMenuLists.operationRecord2":"leftMenuLists.operationRecord"))))},this.state={}}render(){var o=this.props.record;return t().createElement("div",{className:"cl-table__cell-action"},t().createElement("span",{className:"cl-pointer ".concat(o.study_count>0?"":"cl-disabled"),onClick:this.showStudyRecord},this.props.t("common.studyRecord")),t().createElement("span",{className:"cl-pointer-divide"}),t().createElement($.Z,{overlay:this.moreOperate()},t().createElement("span",{className:"cl-pointer"},this.props.t("common.more")," ",t().createElement(ae.Z,null))))}}fe.defaultProps={record:{},showStudyRecord:()=>{},linkToExamRecord:()=>{}};var Ce=(0,Z.Z)()(fe),se=e(55285),Te=e(6793),ye=e(30311),xe=e(38642);class $e extends t().Component{constructor(){super(...arguments);this.state={autoWidth:"auto",getExamAllGradesProps:{visible:!1,planId:"",userId:"",planTitle:""},whiteList:{zaraFlag:(0,xe.UI)("ZARA_H5")}},this.showEveryExamGrade=(o,n,a)=>{this.setState(s=>({getExamAllGradesProps:(0,p.Z)((0,p.Z)({},s.getExamAllGradesProps),{},{visible:!0,planId:o,userId:n,planTitle:a})}))},this.hideEveryExamGrade=()=>{this.setState(o=>({getExamAllGradesProps:(0,p.Z)((0,p.Z)({},o.getExamAllGradesProps),{},{visible:!1,planId:"",userId:"",planTitle:""})}))},this.getTableColumn=o=>{var n=this.props.list,a=n===void 0?[]:n,s=this.state.whiteList,l=[];a[0]&&(l=a[0].stages.map((I,x)=>{var O=[{title:this.props.t("study.stageProgress"),width:115,dataIndex:["stages",x,"stage_progress"],key:"stage_progress",render:ne=>"".concat(ne,"%")}];return{title:I.stage_name,children:O.concat(I.resources.map((ne,X)=>s.zaraFlag&&String(ne.course_type)==="14"||String(ne.courseType)==="14"?{}:{title:ne.resource_name,dataIndex:["stages",x,"resources",X],key:"resources",width:150,render:R=>{if(R.course_type===7)return t().createElement("span",null,R.study_progress,"%");if(R.courseType===11)return t().createElement("span",null,R.studyProgress>=100?"\u5DF2\u5B8C\u6210":"\u672A\u5B8C\u6210");if(R.course_type===10){var ze=R.operation_status===1?this.props.t("common.pending"):R.operation_status===2?"".concat(this.props.t("common.reject")):R.operation_status===3?"".concat(this.props.t("common.completed")):this.props.t("common.ongoing");return ze}if(R.course_type===6){if(R.is_pass==="true"){var le="".concat(R.score," ").concat(this.props.t("common.minute"),"(").concat(this.props.t("myExamTask.qualified"),")");return R.makeup_count>1?t().createElement(ye.Z,{name:le,onClick:()=>this.showEveryExamGrade(R.course_id,R.user_id,R.title)}):le}if(R.is_pass==="false"){var we="".concat(R.score," ").concat(this.props.t("common.minute"),"(").concat(this.props.t("myExamTask.unqualified"),")");return R.makeup_count>1?t().createElement(ye.Z,{name:we,onClick:()=>this.showEveryExamGrade(R.course_id,R.user_id,R.title)}):we}if(R.is_pass===""){if(R.show_start_exam==="true")return t().createElement("span",null,this.props.t("study.absent"));if(R.show_start_exam==="false")return t().createElement("span",null,this.props.t("myExamTask.absent"));if(R.show_start_exam===""&&R.mark_type!==1){var We="".concat(this.props.t("myExamTask.marking"));return R.makeup_count>1?t().createElement(ye.Z,{name:We,onClick:()=>this.showEveryExamGrade(R.course_id,R.user_id,R.title)}):t().createElement("span",null,We)}}}else return t().createElement("span",null,R.study_progress,"%")}}))}}));var P=[{title:()=>t().createElement("div",{className:"cl-text-ellipsis",style:{width:o}},this.props.t("learning.learningProjectStudyTime")),dataIndex:"create_time",key:"create_time",width:140,render:(I,x)=>{var O=x.create_time;return(0,Te.p6)(O,"yyyy-MM-dd hh:mm")}},{title:()=>t().createElement("div",{className:"cl-text-ellipsis",style:{width:140}},this.props.t("common.updateTime")),dataIndex:"update_time",key:"update_time",width:140,render:(I,x)=>{var O=x.update_time;return(0,Te.p6)(O,"yyyy-MM-dd hh:mm")}},{title:this.props.t("study.passedOrNot"),width:this.props.lng==="en_us"?120:100,dataIndex:"qualified_status_name",key:"qualified_status_name",render:(I,x)=>{var O=x.qualified_status_name;return t().createElement("span",{className:"".concat(O==="\u5408\u683C"?"qualified":""," ").concat(O==="\u4E0D\u5408\u683C"?"un-qualified":"")},O)}},{title:()=>this.props.t("course.transfer"),dataIndex:"join_type",key:"join_type",width:140,render:I=>I==="transfer"?this.props.t("employeeSummary.yes"):this.props.t("employeeSummary.no")},{title:this.props.t("common.status"),width:100,dataIndex:"project_status_name",key:"project_status_name"},{title:this.props.t("study.trainingProgress"),width:150,dataIndex:"process",key:"process",render:(I,x)=>{var O=x.process;return t().createElement(M.Z,{percent:+O,size:"small",status:O>=100?"success":"normal",strokeColor:O>=100?"#58D28B":""})}},{title:this.props.t("study.studyCompleted"),width:this.props.lng==="en_us"?130:100,dataIndex:"study_count",key:"study_count",render:(I,x)=>{var O=x.study_count,ne=x.study_progress;return t().createElement("span",null,O===0?"--":"".concat(ne,"%"))}},{title:this.props.t("study.passedTime"),width:this.props.lng==="en_us"?120:100,dataIndex:"exam_pass_count",key:"exam_pass_count",render:(I,x)=>{var O=x.exam_pass_count;return O+this.props.t("study.examTimes")}},{title:this.props.t("employeeSummary.getScores"),width:this.props.lng==="en_us"?120:88,dataIndex:"credits",key:"credits",render:(I,x)=>{var O=x.credits;return O||"--"}},{title:this.props.t("personal.getCerti"),width:this.props.lng==="en_us"?120:88,dataIndex:"certificate_name",key:"certificate_name",render:(I,x)=>{var O=x.certificate_name;return O||"--"}},{title:this.props.t("common.studyDuration"),dataIndex:"study_duration_str",key:"study_duration_str",width:110,render:(I,x)=>{var O=x.study_duration_str;return O||"--"}},{title:this.props.t("learning.learningOfflineTrainDuration"),dataIndex:"offlineTrainDurationStr",key:"offlineTrainDurationStr",width:110},{title:this.props.t("common.examDuration"),dataIndex:"exam_duration_str",key:"exam_duration_str",width:90,render:(I,x)=>{var O=x.exam_duration_str;return O||"--"}},{title:this.props.t("common.operate"),width:150,fixed:"right",key:"operate",render:(I,x)=>t().createElement(Ce,{id:this.props.id,projectId:this.props.projectId,record:x,showStudyRecord:this.props.showStudyRecord,linkToExamRecord:this.props.linkToExamRecord})}];return P.splice(11,0,...l),P}}componentDidUpdate(){var o=document.querySelector(".ant-table"),n=document.querySelector(".ant-table-tbody"),a=o&&o.getBoundingClientRect().width||0,s=n&&n.getBoundingClientRect().width||0;this.hasComputed||s-a>10&&(this.hasComputed=!0,this.setState({autoWidth:240}))}render(){var o=this.props,n=o.isLoading,a=o.list,s=o.toolBarRender,l=o.headerTitle,P=this.state.getExamAllGradesProps,I=this.getTableColumn(this.state.autoWidth);return t().createElement("section",null,t().createElement(se.Z,{loading:n,dataSource:a,columns:I,rowKey:x=>x.userId,pagination:!1,toolBarRender:s,headerTitle:l,tableUUID:"c6db621b-1222-4148-850b-5fdf16585686"}),t().createElement(C.Z,(0,V.Z)({},P,{hideEveryExamGrade:this.hideEveryExamGrade})))}}var ke=(0,Z.Z)()($e),ce=e(37055),Ue=e(64262),Be=e(48479),oe=e(64630),Ne=e(98417),Ke=e(27763),ue=e(10237),_=u.Z.Option,S=Q=>{var o=Q.publicVariable,n=Q.user;return{isOpenTrainingCamp:o.isOpenTrainingCamp,qyShield:n.qyShield}};class r extends t().Component{constructor(o){var n;super(o);n=this,this.toggleFilterData=()=>{var a=this.state,s=a.score,l=a.deptId,P=a.name,I=a.postId,x=a.taskStatus,O=a.groupId,ne=a.join_type,X=a.userIds;this.props.filterData({taskStatus:x,score:s,deptId:l,name:P,postId:I,groupId:O,join_type:ne,userIds:X})},this.getClusterList=(0,Y.Z)(ve().mark(function a(){var s,l;return ve().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return s={keyword:""},I.next=3,ue.WY.get({url:ce.ZP.OrgDialog.getClusterList(),params:s});case 3:l=I.sent,l.data&&(n.groupList=l.data.data);case 5:case"end":return I.stop()}},a)})),this.handleChangeStatus=a=>{var s=a.target.value;this.setState({taskStatus:s},()=>{this.toggleFilterData()})},this.handleTreeSelectChange=a=>{this.setState({deptId:a},()=>{this.toggleFilterData()})},this.handlePostSelectChange=a=>{this.setState({postId:a},()=>{this.toggleFilterData()})},this.handleChangeScoreStatus=a=>{this.setState({score:a},()=>{this.toggleFilterData()})},this.handleChangeParticipationStatus=a=>{this.setState({join_type:a},()=>{this.toggleFilterData()})},this.handleSearch=(a,s)=>{this.setState({name:a,userIds:s},()=>{this.toggleFilterData()})},this.handleInputSearch=a=>{var s=a.target.value;this.setState({name:s})},this.handleExportExcel=()=>{var a=this.state,s=a.deptId,l=a.name,P=a.taskStatus,I=a.score,x=a.postId,O=a.groupId;this.props.exportExcel({deptId:s,name:l,taskStatus:P,score:I,postId:x,groupId:O})},this.showStudyRecord=(a,s)=>{var l=this.state.taskStudyRecordConfig;l.visible=!0,l.userId=a,l.record=s,this.setState({taskStudyRecordConfig:l})},this.hiddenTaskStudyRecord=()=>{var a=this.state.taskStudyRecordConfig;a.visible=!1,this.setState({taskStudyRecordConfig:a})},this.linkToExamRecord=a=>{re.m8.push({pathname:"/training/examination/result",search:B.stringify({userId:a.user_id,planId:this.props.taskId,pageFrom:"projectMonitor",repeatMarking:!0})})},this.handleEnrollChange=a=>{var s=a.target.checked?"pass":"";this.setState({enrollChecked:a.target.checked}),this.props.enrollStatusChange(s)},this.handleChooseByChange=a=>{this.setState({chooseBy:a,deptId:"",postId:"",groupId:""},()=>{this.toggleFilterData()})},this.handleChangeGroup=a=>{this.setState({groupId:a},()=>{this.toggleFilterData()})},this.renderLeftRow=()=>{var a=this.props.t;return t().createElement(te.Fragment,null,t().createElement("div",{className:"user-panel-monitor-filter-header"},t().createElement(G.Z,{type:"primary",icon:t().createElement(me.Z,null),onClick:this.handleExportExcel},a("common.exportData"))))},this.renderRightRow=()=>{var a=this.props,s=a.t,l=a.statusTypeCount,P=[{label:s("common.all"),keyName:"total_count",value:""},{label:s("common.ongoing"),keyName:"unfinished_count",value:"unfinished"},{label:s("dashboard.completed"),keyName:"finished_count",value:"finished"}];return t().createElement("div",{className:"user-panel-monitor-filter-header"},t().createElement("div",{className:"user-panel-monitor-filter-right"},t().createElement(h.ZP.Group,{defaultValue:"",onChange:this.handleChangeStatus,className:"radiogroup"},P.map((I,x)=>t().createElement(h.ZP.Button,{key:x,value:I.value},I.label,"(",l[I.keyName],")"))),t().createElement(Be.Z,{onSearch:this.handleSearch,prefixCls:"user-panel-monitor-filter-search",placeholder:s("common.searchPlaceholder")})))},this.state={taskStatus:0,score:0,deptId:"",postId:"",name:"",userIds:"",groupId:"",taskStudyRecordConfig:{visible:!1,userId:"",record:{},studyType:"project",onCancel:this.hiddenTaskStudyRecord},enrollChecked:!1,whiteList:{randomPopup:(0,xe.UI)("RANDOM_POPUP_VERIFY")},blackList:{getClusterListFlag:(0,xe.eY)("PROJECT_USERPANEL_GETCLUSTER")},join_type:"",chooseBy:"2"},this.chooseByList=[{value:"2",label:"\u90E8\u95E8"},{value:"1",label:"\u5C97\u4F4D"}],this.groupList=[]}componentDidMount(){var o=this.state.blackList;o.getClusterListFlag&&this.getClusterList(),this.props.dispatch({type:"publicVariable/getHasMenusPermissions",payload:{flag:"TrainingCamp"}})}render(){var o=this.state,n=o.taskStudyRecordConfig,a=o.enrollChecked,s=o.whiteList,l=s.randomPopup,P=this.props,I=P.userMonitorInfo,x=P.pageSize,O=P.pageNumber,ne=P.taskId,X=P.projectId,R=P.isLoading,ze=P.lng,le=P.t,we=P.needEnroll,We=P.isOpenTrainingCamp,Qe=P.mainTaskInfo,Ye=(0,p.Z)((0,p.Z)({},ce.XE.INITIAL_PAGINATION),{},{defaultPageSize:x,current:O,total:I.total,onChange:this.props.pageChange,onShowSizeChange:this.props.pageSizeChange}),De=[{label:le("common.all"),value:0},{label:le("study.employeePass"),value:1},{label:le("study.employeeUnPass"),value:2}],Ve=[{label:le("common.all"),value:""},{label:le("common.yes"),value:"transfer"},{label:le("common.no"),value:"other"}];return We&&(this.chooseByList=[{value:"2",label:le("common.departmentLabel")},{value:"1",label:le("common.post")},{value:"3",label:le("component.useCluster")}]),t().createElement("div",{className:"user-panel-monitor"},t().createElement("div",{className:"user-panel-monitor-filter"},t().createElement("div",{className:"user-panel-monitor-filter-header"},t().createElement(u.Z,{className:"user-panel-monitor-filter-score department-select",placeholder:le("component.pleaseChoose"),defaultValue:this.state.chooseBy,onChange:this.handleChooseByChange},this.chooseByList.map(de=>t().createElement(_,{value:de.value,key:de.value},de.label))),this.state.chooseBy==="2"?t().createElement(Ue.Z,{className:"user-panel-monitor-filter-dept choose-by-select cl-search-normal-width",parentId:"",checkable:!1,asyncLoad:!0,treeSelect:!0,onTreeSelectChange:this.handleTreeSelectChange}):null,this.state.chooseBy==="1"?t().createElement(oe.Z,{className:"user-panel-monitor-filter-dept choose-by-select cl-search-normal-width",disabled:!1,onChange:this.handlePostSelectChange}):null,this.state.chooseBy==="3"?t().createElement(u.Z,{className:"user-panel-monitor-filter-score choose-by-select cl-search-normal-width",placeholder:le("study.pleaseChooseGroup"),onChange:this.handleChangeGroup},this.groupList.map(de=>t().createElement(_,{value:de.id,key:de.id},de.name))):null,t().createElement(u.Z,{className:"user-panel-monitor-filter-score",placeholder:le("study.passedOrNot"),onChange:this.handleChangeScoreStatus},De.map(de=>t().createElement(_,{value:de.value,key:de.value},de.label))),t().createElement(u.Z,{className:"user-panel-monitor-filter-score",placeholder:le("course.isTransfer"),onChange:this.handleChangeParticipationStatus},Ve.map(de=>t().createElement(_,{value:de.value,key:de.value},de.label))),we==="true"?t().createElement(k.Z,{className:"user-panel-monitor-filter-enroll",style:{lineHeight:"31px"},checked:a,onChange:this.handleEnrollChange},le("learning.registrationApproved")):null)),t().createElement("div",{className:"user-panel-monitor-list min-height-monitor",ref:this.props.tableRef},t().createElement("div",{className:"user-panel-monitor-list-table"},t().createElement(ke,{id:ne,lng:ze,projectId:X,isLoading:R,list:I.list,showStudyRecord:this.showStudyRecord,linkToExamRecord:this.linkToExamRecord,toolBarRender:this.renderRightRow,headerTitle:this.renderLeftRow()})),I.total>x||!Ye.hideOnSinglePage?t().createElement("div",{className:"user-panel-monitor-list-pagination"},t().createElement(W.Z,Ye)):null),l?t().createElement(Ke.Z,(0,V.Z)({mainTaskInfo:Qe,generatePdf:!0},n,{taskId:ne,planType:"project"})):t().createElement(Ne.Z,(0,V.Z)({mainTaskInfo:Qe,generatePdf:!0},n,{taskId:ne,planType:"project"})))}}var g=(0,j.$j)(S)((0,Z.Z)()(r)),i=e(36202);class c extends t().PureComponent{constructor(o){super(o);this.linkToDetail=()=>{var n=this.props,a=n.record,s=n.taskId,l=n.needEnroll,P=n.projectId;a.investigate_count<=0||re.m8.push("/training/learning/project/monitor/questionnairePaper?id=".concat(a.id,"&from=studyMonitor&planId=").concat(s,"&studyType=project&needEnroll=").concat(l,"&type=study_project&projectId=").concat(P))},this.state={}}render(){var o=this.props.record;return t().createElement("div",{className:"cl-table__cell-action"},t().createElement("a",{onClick:this.linkToDetail,className:"cl-pointer ".concat(o.investigate_count>0?"":"disabled")},this.props.t("study.viewStatistics")))}}c.defaultProps={record:{}};var m=(0,Z.Z)()(c);class v extends t().Component{constructor(){super(...arguments);this.getTableColumn=()=>{var o=[{title:this.props.t("study.surveyName"),dataIndex:"title",key:"id"},{title:this.props.t("study.collectingResearch"),dataIndex:"investigate_count",key:"investigate_count",width:215,render:(n,a)=>a.investigate_count>0?t().createElement(ye.Z,{name:a.investigate_count,onClick:()=>this.linkToDetail(a)}):a.investigate_count},{title:this.props.t("common.creator"),width:106,dataIndex:"create_user",key:"create_user"},{title:this.props.t("study.releaseTime"),width:164,dataIndex:"update_time",key:"update_time",render:(n,a)=>{var s=a.update_time;return(0,Te.p6)(s,"yyyy-MM-dd hh:mm")}},{title:this.props.t("common.operate"),width:80,key:"operate",render:(n,a)=>t().createElement(m,{record:a,taskId:this.props.taskId,needEnroll:this.props.needEnroll,projectId:this.props.projectId})}];return o},this.linkToDetail=o=>{this.props.linkToDetail(o.id)}}render(){var o=this.props,n=o.isLoading,a=o.list,s=this.getTableColumn();return t().createElement(i.f,{style:{height:"100%",overflow:"hidden"},loading:n,dataSource:a,columns:s,rowKey:l=>l.id,pagination:!1,tableUUID:"195f222f-f9df-4d72-b02e-47384290a5f0"})}}var y=(0,Z.Z)()(v);class d extends t().Component{constructor(o){super(o);this.linkToDetail=n=>{var a=this.props,s=a.taskId,l=a.needEnroll,P=a.projectId;re.m8.push({pathname:"/training/learning/project/monitor/questionnaire",search:B.stringify({taskId:s,questionnaireId:n,from:"project",needEnroll:l,projectId:P})})},this.state={}}render(){var o=this.props,n=o.questionnaireInfo,a=o.pageSize,s=o.pageNumber,l=o.isLoading,P=o.taskId,I=o.projectId,x=(0,p.Z)((0,p.Z)({},ce.XE.INITIAL_PAGINATION),{},{defaultPageSize:a,current:s,total:n.total,onChange:this.props.pageChange,onShowSizeChange:this.props.pageSizeChange});return t().createElement("div",{className:"questionnaire-panel"},t().createElement("div",{className:"questionnaire-panel-list"},t().createElement("div",{className:"questionnaire-panel-list-table"},t().createElement(y,{isLoading:l,list:n.list,linkToDetail:this.linkToDetail,taskId:P,projectId:I})),n.total>a||!x.hideOnSinglePage?t().createElement("div",{className:"questionnaire-panel-list-pagination"},t().createElement(W.Z,x)):null))}}var b=d,U=e(18884);class Ie extends t().PureComponent{constructor(){super(...arguments);this.state={qrCodeConfig:{title:this.props.t("common.share"),isProjectShare:!1,tip:""},option:{scene:"",flag:"exam_task"},modalVisible:!1,whiteList:{examShareFlag:(0,xe.UI)("EXAM_TASK_SHARE_BUT")}},this.onHandleQrShare=o=>{var n=o.record,a=this.state.option,s=B.parse(re.m8.location.search);this.setState({option:(0,p.Z)((0,p.Z)({},a),{},{scene:"&flag=exam&planId=".concat(n.id,"&projectId=").concat(s.projectId,"&courseId=").concat(s.id,"&examShare=true")}),modalVisible:!0})},this.handleHiddenQrCode=()=>{this.setState({modalVisible:!1})},this.linkToMonitor=()=>{var o=this.props.record;this.props.linkToExamMonitor(o.id)}}render(){var o=this.props.record,n=this.state,a=n.qrCodeConfig,s=n.modalVisible,l=n.option,P=n.whiteList;return t().createElement("div",{className:"cl-table__cell-action"},t().createElement("a",{className:"cl-pointer",onClick:this.linkToMonitor},this.props.t("common.monitor")),P.examShareFlag?t().createElement("span",null,t().createElement("span",{className:"cl-pointer ",onClick:()=>{this.onHandleQrShare({record:o})}},this.props.t("common.share")),t().createElement(U.Z,(0,V.Z)({onCancel:this.handleHiddenQrCode,visible:s,option:l},a))):null)}}Ie.defaultProps={record:{},linkToExamMonitor:()=>{}};var ie=(0,Z.Z)()(Ie);class Se extends t().Component{constructor(){super(...arguments);this.linkToMarkPaper=o=>{o.pending_count!==0&&re.m8.push("/training/examination/plan/testPaper?id=".concat(o.id,"&from=projectMonitor&taskId=").concat(this.props.taskId))},this.getTableColumn=()=>{var o=[{title:this.props.t("exam.testName"),dataIndex:"title",key:"id"},{title:this.props.t("exam.examinee"),dataIndex:"exam_count",key:"exam_count",width:90},{title:this.props.t("exam.passed"),width:90,dataIndex:"qualified_count",key:"qualified_count"},{title:this.props.t("exam.failed"),width:90,dataIndex:"unqualified_count",key:"unqualified_count"},{title:this.props.t("exam.absent"),width:130,dataIndex:"unexam_count",key:"unexam_count"},{title:this.props.t("exam.toBeGraded"),width:120,dataIndex:"pending_count",key:"pending_count",render:(n,a)=>a.pending_count>0&&a.reading_operation==="has_operation"?t().createElement(ye.Z,{name:a.pending_count,onClick:()=>this.linkToMarkPaper(a)}):a.pending_count},{title:this.props.t("exam.operate"),key:"operate",width:80,fixed:"right",render:(n,a)=>t().createElement(ie,{record:a,linkToExamMonitor:this.props.linkToExamMonitor})}];return o}}render(){var o=this.props,n=o.isLoading,a=o.list,s=this.getTableColumn();return t().createElement(i.f,{style:{height:"100%",overflow:"hidden"},loading:n,dataSource:a,columns:s,rowKey:l=>l.id,pagination:!1,tableUUID:"d4105de6-6084-436f-83dd-40b3c417bb6f"})}}var he=(0,Z.Z)()(Se);class be extends t().Component{constructor(o){super(o);this.linkToExamMonitor=n=>{var a=this.props,s=a.taskId,l=a.projectId;re.m8.push({pathname:"/training/learning/project/monitor/exam",search:B.stringify({id:n,taskId:s,from:"project",taskType:"project",projectId:l})})},this.state={}}render(){var o=this.props,n=o.examsInfo,a=o.pageSize,s=o.pageNumber,l=o.isLoading,P=o.taskId,I=(0,p.Z)((0,p.Z)({},ce.XE.INITIAL_PAGINATION),{},{defaultPageSize:a,current:s,total:n.total,onChange:this.props.pageChange,onShowSizeChange:this.props.pageSizeChange});return t().createElement("div",{className:"exam-panel"},t().createElement("div",{className:"exam-panel-list"},t().createElement("div",{className:"exam-panel-list-table"},t().createElement(he,{isLoading:l,list:n.list,linkToExamMonitor:this.linkToExamMonitor,taskId:P})),n.total>a||!I.hideOnSinglePage?t().createElement("div",{className:"exam-panel-list-pagination"},t().createElement(W.Z,I)):null))}}var Ee=be,He=e(49111),Ze=e(19650),Re=e(14965),Oe=e(11448);function Ae(Q){var o=ce.ZP.StudyProjectList.getStudyProjectPaymentList(Q.projectId);return delete Q.projectId,ue.WY.get({url:o,params:Q})}function je(Q){var o=CONFIG.StudyProjectList.exportProjectPaymentList(Q.projectId);return delete Q.projectId,request.get({url:o,params:Q})}var Fe=e(97593),qe=Oe.Z.RangePicker,et=()=>{};class it extends te.Component{constructor(o){super(o);this.onDepartmentTreeSelectChange=n=>{this.setState({departmentId:n},()=>{this.getDataList()})},this.onRangePickerChange=(n,a)=>{this.setState({begin_time:a[0],end_time:a[1]},()=>{this.getDataList()})},this.onExportPaymentLists=()=>{var n=this.props.t;q.Z.confirm({title:n("common.tip"),content:n("learning.payments.studyProjectExportTips"),onOk:this.getProjectPaymentListExports})},this.getProjectPaymentListExports=()=>{var n=this.props,a=n.taskInfo,s=n.projectId,l=this.state,P=l.begin_time,I=l.end_time,x=l.departmentId,O=l.keyword,ne="?".concat(B.stringify({study_project_name:a.title,begin_time:P,end_time:I,depart_id:x,keyword:O})),X={projectId:s};(0,Fe.N)({page:"study_project_transaction_export",props:this.props,query:ne,rest:X})},this.getDataList=()=>{var n=this.props.projectId,a=this.state,s=a.begin_time,l=a.end_time,P=a.departmentId,I=a.keyword,x=a.userIds;this.setState({isLoading:!0}),Ae({projectId:n,begin_time:s,end_time:l,depart_id:P,keyword:I,userIds:x}).then(O=>{this.setState({isLoading:!1}),this.setState({list:O.data.list})}).catch(O=>{this.setState({isLoading:!1}),console.error(O)})},this.nameSearch=(n,a)=>{var s={keyword:a===""?n:"",userIds:a};this.setState(s,()=>{this.getDataList()})},this.tableColumns=[{title:this.props.t("account.tradingHour"),width:120,dataIndex:"transaction_time",ellipsis:!0},{title:this.props.t("payment.orderNumber"),dataIndex:"order_id",width:120,ellipsis:!0},{title:this.props.t("payment.thirdPayNo"),width:120,dataIndex:"third_pay_no",ellipsis:!0},{title:this.props.t("payment.goodsCount"),width:100,dataIndex:"goods_count",render:(n,a)=>{var s=a.goods_count,l=a.order_id;return s>0?t().createElement(ye.Z,{name:s,onClick:()=>this.props.showGoodsCount(l)}):0},ellipsis:!0},{title:this.props.t("payment.paymentChannel"),width:90,dataIndex:"pay_channel",ellipsis:!0},{title:this.props.t("dashboard.price"),width:90,dataIndex:"order_amount",ellipsis:!0},{title:this.props.t("study.result"),width:90,dataIndex:"order_amount",render:()=>"\u6210\u529F",ellipsis:!0}],this.exportPaymentLists=()=>{var n=this.props,a=n.taskInfo,s=n.projectId,l=n.t;q.Z.confirm({title:l("common.tip"),content:l("learning.payments.studyProjectExportTips"),onOk:()=>{var P="?".concat(B.stringify({study_project_name:a.title,begin_time:this.state.begin_time,end_time:this.state.end_time,depart_id:this.state.department.id,keyword:this.state.keyword})),I={projectId:s};(0,Fe.N)({page:"studyProjectPaymentList",props:this.props,query:P,rest:I})}})},this.state={isLoading:!1,list:[],begin_time:"",end_time:"",keyword:"",departmentId:null}}componentDidMount(){this.getDataList()}render(){var o=this.state,n=o.isLoading,a=o.list,s=this.props.t;return t().createElement("div",{className:"component-payment-list",style:{padding:"".concat(20,"px"),background:"#ffffff"}},t().createElement(se.Z,{loading:n,dataSource:a,columns:this.tableColumns,rowKey:l=>l.user_id,pagination:!0,headerTitle:[t().createElement(Ze.Z,{size:"small",wrap:!0,key:"one"},t().createElement(G.Z,{type:"primary",icon:t().createElement(me.Z,null),onClick:this.onExportPaymentLists},s("common.exportData")),t().createElement(qe,{onChange:this.onRangePickerChange}))],toolBarRender:()=>[t().createElement(Ue.Z,{treeSelect:!0,handleTreeSelectChange:this.onDepartmentTreeSelectChange,checkable:!1,key:"two"}),t().createElement(Be.Z,{placeholder:s("common.searchNamePlaceholder"),onSearch:(l,P)=>this.nameSearch(l,P),key:"three"})],tableUUID:"831178f5-024b-47a8-9641-60325342b131"}))}}var rt=(0,j.$j)(et)((0,Z.Z)()(it)),tt=e(945);function ot(Q){var o=Q.projectId,n=Q.page_number,a=Q.page_size;return ue.WY.get({url:ce.ZP.StudyProjectList.getProjectTaskCourseListUrl(o),params:{page_number:n,page_size:a}})}var at=e(60667),lt=Q=>{var o=Q.user;return{qyShield:o.qyShield}};class Je extends t().Component{constructor(o){super(o);this.initTableList=()=>{var n=this.props.projectId,a=this.state.params;this.setState({isLoading:!0}),ot({projectId:n,page_number:a.page_number,page_size:a.page_size}).then(s=>{this.setState({isLoading:!1,list:s.data.data.list,params:(0,p.Z)((0,p.Z)({},a),{},{total:s.data.data.total?Number(s.data.data.total):0})})}).catch(s=>{this.setState({isLoading:!1}),console.error(s)})},this.pageChange=(n,a)=>{this.setState({params:(0,p.Z)((0,p.Z)({},this.state.params),{},{page_number:n,page_size:a})},()=>{this.initTableList()})},this.toolBarRender=()=>{},this.headerTitle=()=>{var n=this.props,a=n.t,s=n.projectId;return t().createElement(Ze.Z,{size:"small",wrap:!0},t().createElement(G.Z,{key:"export",type:"primary",icon:t().createElement(me.Z,null),onClick:()=>{q.Z.confirm({content:a("coursePanel.exportConfirm"),onOk:()=>{(0,Fe.N)({page:"studyProjectCourseExport",rest:s,props:this.props})}})}},a("common.exportData")))},this.getTableColumns=()=>{var n=this.props.t;return[{title:n("courseManage.courseTitle"),dataIndex:"course_name",key:"course_name",width:200,ellipsis:!0},{title:n("learning.learningProjectAddCategoryed"),dataIndex:"course_classify_name",width:200,key:"course_classify_name"},{title:n("coursePanel.courseDuration"),dataIndex:"course_duration",width:200,key:"course_duration"},{title:n("component.lecturer"),dataIndex:"lecturer_name",width:200,key:"lecturer_name",render:(a,s)=>t().createElement(at.Z,{dataType:"userName",value:s.lecturer_id,name:a,type:s.lecturer_type})},{title:n("historicRecords.courseGrade"),dataIndex:"score",width:100,key:"score"},{title:n("dashboard.studyNum"),dataIndex:"study_user_count",width:100,key:"study_user_count"},{title:n("marketing.completeCount"),dataIndex:"finished_user_count",width:100,key:"finished_user_count"}]},this.getTable=()=>{var n=this.state,a=n.params,s=n.isLoading,l=n.list,P=this.getTableColumns(),I=(0,p.Z)((0,p.Z)({},ce.XE.INITIAL_PAGINATION),{},{total:Number(a.total),current:a.page_number,pageSize:a.page_size,onChange:this.pageChange});return t().createElement(i.f,{columns:P,rowKey:"id",dataSource:l,pagination:I,loading:s,scroll:{x:"max-content",y:"100%"},headerTitle:this.headerTitle(),toolBarRender:this.toolBarRender,tableUUID:"C60C7B59-60A8-9636-FE3C-CBE05739F691"})},this.state={list:[],params:{keyword:"",page_number:1,page_size:10,total:0},isLoading:!0}}componentDidMount(){this.initTableList()}render(){return t().createElement("div",null,this.getTable())}}var Ge=(0,j.$j)(lt)((0,Z.Z)()(Je)),dt=e(4408),pt=e(11449),ht=e(32657),gt=e(88096),Me=H.Z.TabPane,vt=Q=>({userLng:Q.user});class ft extends t().Component{constructor(o){super(o);this.onHiddenGoodsCount=()=>{this.setState({goodsCountConfig:{visible:!1}})},this.getMonitorInfo=()=>{var n=this.state,a=n.taskId,s=n.userMonitorPageConfig,l=ce.ZP.StudyProjectList.projectUserMonitor(a),P=s.pageNumber,I=s.pageSize,x=s.departmentId,O=s.keyword,ne=s.qualifiedStatus,X=s.taskStatus,R=s.postId,ze=s.enrollStatus,le=s.groupId,we=s.join_type,We=s.userIds,Qe={qualified_status:ne,keyword:O,study_status:X,department_id:x,post_id:R,page_number:P,page_size:I,enroll_status:ze,group_id:le,join_type:we,user_ids:We};this.setState({loadingUserMonitor:!0}),ue.WY.get({url:l,params:Qe}).then(Ye=>{var De=Ye.data,Ve=De.study_project,de=De.total_count,ct=De.finished_count,ut=De.unfinished_count,nt=De.monitor_list,mt=De.authority_range,st=De.evaluation_id;this.setState({loadingUserMonitor:!1,taskInfo:Ve,evaluationId:st,userMonitorInfo:{total:nt.total,list:nt.list},statusTypeCount:{total_count:de,finished_count:ct,unfinished_count:ut},needEnroll:Ve.need_enroll,authScope:{visible:mt==="true"}})})},this.getQuestionnaireData=()=>{var n=this.state,a=n.taskId,s=n.questionnairePageConfig,l=s.pageNumber,P=s.pageSize,I=ce.ZP.StudyProjectList.questionnaireMonitor(a),x={page_number:l,page_size:P};this.setState({loadingQuestionnaire:!0}),ue.WY.get({url:I,params:x}).then(O=>{this.setState({loadingQuestionnaire:!1,questionnaireInfo:{total:O.data.total,list:O.data.list}})})},this.getExamsData=()=>{var n=this.state,a=n.taskId,s=n.examsPageConfig,l=s.pageNumber,P=s.pageSize,I=ce.ZP.StudyProjectList.examMonitor(a),x={page_number:l,page_size:P};this.setState({loadingExam:!0}),ue.WY.get({url:I,params:x}).then(O=>{this.setState({loadingExam:!1,examsInfo:{total:O.data.total,list:O.data.list}})})},this.getWorksData=()=>{var n=this.state.projectId,a=ce.ZP.StudyTaskMonitor.getWorksData(),s={entity_type:"study_project",entity_id:n};this.setState({loadingWork:!0}),ue.WY.post({url:a,data:s}).then(l=>{this.setState({loadingWork:!1,workInfo:{list:l.data.operations}})})},this.getAttendanceData=()=>{var n=this.state,a=n.projectId,s=n.taskId,l=ce.ZP.StudyTaskMonitor.getAttendanceData(a),P={source_type:"study_project",course_id:s};this.setState({loadingAttendance:!0}),ue.WY.get({url:l,params:P}).then(I=>{var x=I.data;x.code==="200000"&&this.setState({loadingAttendance:!1,attendanceInfo:{list:x.data}})})},this.handleTabChange=n=>{this.setState({activeTabKey:n})},this.handleChangeTab=n=>{this.setState({activeKey:n});var a=this.state,s=a.questionnaireInfo,l=a.examsInfo,P=a.workInfo,I=a.attendanceInfo;switch(n){case"2":this.offlineListRef&&this.offlineListRef.refreshData();break;case"3":s.list||this.getQuestionnaireData();break;case"4":l.list||this.getExamsData();break;case"5":P.list||this.getWorksData();break;case"7":I.list||this.getAttendanceData();break;default:break}},this.userMonitorPageChange=n=>{var a=this.state.userMonitorPageConfig;a.pageNumber=n,this.setState({userMonitorPageConfig:a},()=>{this.getMonitorInfo()})},this.userMonitorPageSizeChange=(n,a)=>{var s=this.state.userMonitorPageConfig;s.pageSize=a,this.setState({userMonitorPageConfig:s},()=>{this.getMonitorInfo()})},this.handleChangeEnrollStatus=n=>{var a=this.state.userMonitorPageConfig;a.enrollStatus=n,this.setState({userMonitorPageConfig:a},()=>{this.getMonitorInfo()})},this.offlinePageChange=n=>{var a=this.state.offlinePageConfig;a.pageNumber=n,this.setState({offlinePageConfig:a},()=>{this.getOfflineData()})},this.offlinePageSizeChange=(n,a)=>{var s=this.state.offlinePageConfig;s.pageSize=a,this.setState({offlinePageConfig:s},()=>{this.getOfflineData()})},this.questionnairePageChange=n=>{var a=this.state.questionnairePageConfig;a.pageNumber=n,this.setState({questionnairePageConfig:a},()=>{this.getQuestionnaireData()})},this.questionnairePageSizeChange=(n,a)=>{var s=this.state.questionnairePageConfig;s.pageSize=a,this.setState({questionnairePageConfig:s},()=>{this.getQuestionnaireData()})},this.examPageChange=n=>{var a=this.state.examsPageConfig;a.pageNumber=n,this.setState({examsPageConfig:a},()=>{this.getExamsData()})},this.examPageSizeChange=(n,a)=>{var s=this.state.examsPageConfig;s.pageSize=a,this.setState({examsPageConfig:s},()=>{this.getExamsData()})},this.filterUserMonitor=n=>{var a=n.deptId,s=n.score,l=n.name,P=n.taskStatus,I=n.postId,x=n.groupId,O=n.join_type,ne=n.userIds,X=this.state.userMonitorPageConfig;X.pageNumber=1,X.departmentId=a!==void 0?a:X.departmentId,X.groupId=x||"",X.postId=I||"",X.qualifiedStatus=s!==void 0?s:X.qualifiedStatus,X.taskStatus=P!==void 0?P:X.taskStatus,X.keyword=l!==void 0?ne===""?l:"":X.keyword,X.join_type=O||"",X.userIds=ne,this.setState({userMonitorPageConfig:X},()=>{this.getMonitorInfo()})},this.exportUserMonitor=()=>{var n=this.state.userMonitorPageConfig;q.Z.confirm({title:this.props.t("common.tip"),content:this.props.t("study.confirmToExport"),onOk:()=>{var a=this.state.taskId,s=n.departmentId,l=n.keyword,P=n.qualifiedStatus,I=n.taskStatus,x=n.postId,O=n.enrollStatus,ne=n.groupId,X="?access_token=".concat(window.localStorage.getItem("token"),"&department_id=").concat(s,"&post_id=").concat(x)+"&keyword=".concat(l,"&study_status=").concat(I,"&qualified_status=").concat(P,"&enroll_status=").concat(O,"&group_id=").concat(ne),R={courseId:a};(0,Fe.N)({page:"studyProjectMonitorExport",props:this.props,query:X,rest:R})}})},this.showGoodsCount=n=>{this.setState({goodsCountConfig:{order_id:n,visible:!0}})},this.state={taskInfo:{},evaluationId:0,activeKey:"1",activeTabKey:"self",statusTypeCount:{totalCount:0,underwayCount:0,completeCount:0,overdueCount:0},userMonitorInfo:{},userMonitorPageConfig:{pageSize:20,pageNumber:1,departmentId:"",postId:"",keyword:"",qualifiedStatus:"",taskStatus:"",enrollStatus:"",groupId:""},loadingUserMonitor:!1,questionnaireInfo:{},questionnairePageConfig:{pageSize:20,pageNumber:1},loadingQuestionnaire:!1,examsInfo:{},examsPageConfig:{pageSize:20,pageNumber:1},loadingExam:!1,needEnroll:"false",workInfo:{},loadingWork:!1,projectId:"",authScope:{visible:!1},attendanceInfo:{},loadingAttendance:!1}}componentDidMount(){var o=B.parse(this.props.history.location.search);this.setState({taskId:o.id||"1789887398923079680",projectId:o.projectId,planStatus:o.planStatus},this.getMonitorInfo)}render(){var o=this.state,n=o.taskId,a=o.planStatus,s=o.projectId,l=o.taskInfo,P=o.evaluationId,I=o.activeKey,x=o.statusTypeCount,O=o.userMonitorInfo,ne=o.userMonitorPageConfig,X=o.questionnaireInfo,R=o.questionnairePageConfig,ze=o.examsInfo,le=o.examsPageConfig,we=o.workInfo,We=o.loadingUserMonitor,Qe=o.loadingQuestionnaire,Ye=o.loadingExam,De=o.loadingWork,Ve=o.needEnroll,de=o.authScope,ct=o.activeTabKey,ut=o.goodsCountConfig,nt=o.loadingAttendance,mt=o.attendanceInfo,st=this.props,Xe=st.userLng,Le=st.t,Et={padding:I==="6"?"0px 0px 0px 20px":"0px 20px"};return t().createElement(pt.Z,{noPadding:!0,pageContainerParams:{header:{title:l.title,subTitle:de.visible&&t().createElement("span",{className:"task-info-title-auth"},Le("common.authScopeTip"))}}},t().createElement(dt.Z,{title:Le("documentTitle.learnProjectMonitor")}),t().createElement("div",{className:"studyproject-monitor"},t().createElement("div",{className:"studyproject-monitor-container"},t().createElement("div",{className:"studyproject-monitor-info task-info"},t().createElement("div",{className:"task-info-sub"},t().createElement("span",{className:"task-info-sub-item"},t().createElement("span",{className:"task-info-sub-item-bold"},this.props.t("common.creator")),"\uFF1A",t().createElement(at.Z,{dataType:"userName",value:l.creator_sync_user_id,name:l.create_user_name,type:l.creator_sync_source_type}))),t().createElement("div",{className:"task-info-sub"},t().createElement("span",{className:"task-info-sub-item"},t().createElement("span",{className:"task-info-sub-item-bold"},this.props.t("common.passingCriteria")),"\uFF1A",l.progress>0?t().createElement("span",null,"".concat(Le("learning.employeePassingCriteriaStudy")).concat(l.progress,"%")):null,l.progress>0&&l.times>0?t().createElement("span",{className:"sub-item-divide"}):null,l.times>0?t().createElement("span",null,"".concat(Le("learning.employeePassingCriteriaExam")).concat(l.times).concat(Le("common.examUnit"))):null,l.progress>0&&l.times>0?t().createElement("span",{className:"sub-item-divide"}):null,l.operation_times>0?t().createElement("span",null,"\u5B9E\u64CD\u901A\u8FC7".concat(l.operation_times).concat(Le("common.examUnit"))):null,l.finish_evaluation==="true"&&t().createElement("span",{className:"task-info-sub-item"},Le("learning.completeJobEvaluation"))))),t().createElement(H.Z,{activeKey:ct,className:"wrap-tabs-monitor",onChange:this.handleTabChange},t().createElement(Me,{tab:Le("learning.learningProjectSelfData"),key:"self"},t().createElement("div",{className:"studyproject-monitor-list training-learning-project-monitor",style:Et},t().createElement(H.Z,{activeKey:I,onChange:this.handleChangeTab},t().createElement(Me,{tab:this.props.t("study.monitoring"),key:"1"},t().createElement(g,{lng:Xe.lng,taskId:n,projectId:s,isLoading:We,statusTypeCount:x,userMonitorInfo:O,taskType:l.type,mainTaskInfo:l,pageSize:ne.pageSize,pageNumber:ne.pageNumber,pageChange:this.userMonitorPageChange,pageSizeChange:this.userMonitorPageSizeChange,filterData:this.filterUserMonitor,exportExcel:this.exportUserMonitor,enrollStatusChange:this.handleChangeEnrollStatus,needEnroll:Ve})),t().createElement(Me,{tab:Le("coursePanel.courseStatistics"),key:"8"},t().createElement("div",{className:""},t().createElement(Ge,{projectId:s}))),t().createElement(Me,{tab:this.props.t("study.onsiteTraining"),key:"2"},t().createElement(gt.Z,{ref:Ct=>this.offlineListRef=Ct,taskId:s,sourceType:"study_project"})),Xe.qyShield==="false"&&t().createElement(Me,{tab:this.props.t("study.survey"),key:"3"},t().createElement(b,{taskId:n,isLoading:Qe,projectId:s,questionnaireInfo:X,pageNumber:R.pageNumber,pageSize:R.pageSize,pageChange:this.questionnairePageChange,pageSizeChange:this.questionnairePageSizeChange,needEnroll:Ve})),Xe.qyShield==="false"&&t().createElement(Me,{tab:this.props.t("study.examAnalysis"),key:"4"},t().createElement(Ee,{taskId:n,isLoading:Ye,examsInfo:ze,projectId:s,pageSize:le.pageSize,pageNumber:le.pageNumber,pageChange:this.examPageChange,pageSizeChange:this.examPageSizeChange})),Xe.qyShield==="false"&&t().createElement(Me,{tab:this.props.t("study.workAnalysis"),key:"5"},t().createElement("div",{className:"Work-Panel-monitor-project"},t().createElement(N.Z,{className:"Work-Panel-monitor-project",taskId:s,id:n,taskType:"study_project",isLoading:De,workInfo:we}))),Xe.JobEvaluationOpen&&P!==0&&P!=="0"&&t().createElement(Me,{tab:Le("learning.jobEvaluation"),key:"6"},t().createElement("div",{className:"Work-Panel-monitor-post"},t().createElement(ht.default,{taskId:P,headerShow:!1,noPadding:!0}))),t().createElement(Me,{tab:this.props.t("study.attendanceAnalysis"),key:"7"},t().createElement("div",{className:""},t().createElement("div",null,t().createElement(f.Z,{taskId:n,projectId:s,planStatus:a,taskType:"attendance",isLoading:nt,attendanceInfo:mt,getAttendanceData:this.getAttendanceData,type:"study_project"}))))))),Xe.qyShield==="false"&&t().createElement(Me,{tab:Le("learning.payments.title"),key:"payments"},s===""?"":t().createElement(rt,{projectId:s,taskInfo:l,showGoodsCount:this.showGoodsCount}),t().createElement(tt.Z,(0,V.Z)({},ut,{onHiddenGoodsCount:this.onHiddenGoodsCount})))))))}}var yt=(0,j.$j)(vt)((0,Z.Z)()(ft))},88096:function(Pe,J,e){"use strict";e.d(J,{Z:function(){return _}});var V=e(62029),T=e(14781),q=e(53431),A=e(88983),H=e(47933),te=e(34792),t=e(48086),j=e(57663),Z=e(71577),B=e(71194),N=e(57016),f=e(22385),w=e(31097),W=e(57361),D=e(88986),k=e(9754),p=e.n(k),z=e(12924),h=e.n(z),ee=e(28216),G=e(84391),Y=e(91768),_e=e(29208),u=e.n(_e),ge=e(76651),ve=e(27326),me=e.n(ve),re=e(61120),L=e.n(re),M=e(78138),C=e.n(M),E=e(57068),$=e(37055),F=e(97593),K=e(10237);function ae(S){var r=S.train_type,g=S.sourceId,i=S.pageNumber,c=S.pageSize,m=S.sourceType;return K.WY.get({url:$.ZP.lineClass.getOfflineListBySourceId(g),params:{source_type:m,page_number:i,page_size:c,train_type:r}})}function pe(S){var r=S.sourceId,g=S.sourceType;return K.WY.get({url:$.ZP.lineClass.getOfflineListCountBySourceId(r),params:{source_type:g}})}var fe=e(17676),Ce=e(38642),se=e(30311),Te=e(16598),ye=e(18329),xe=e(36202),$e=e(17762),ke=e(83068),ce=e(83655),Ue=e(59169),Be=e(31196),oe=e(48674),Ne=e(60667),Ke=S=>{var r=S.user;return{qyShield:r.qyShield}};class ue extends h().Component{constructor(r){var g;super(r);g=this,this.refreshData=()=>{var i=this.state.offlinePageConfig;this.setState({offlinePageConfig:(0,D.Z)((0,D.Z)({},i),{},{pageNumber:1})},()=>{this.getOfflineData()})},this.getOfflineListCountBySourceId=(0,W.Z)(p().mark(function i(){var c,m,v,y;return p().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return c=g.props,m=c.sourceType,v=c.taskId,b.next=3,pe({sourceId:v,sourceType:m});case 3:y=b.sent,y.data.code==="200000"&&g.setState({listStatusNum:y.data.data});case 5:case"end":return b.stop()}},i)})),this.getOfflineData=(0,W.Z)(p().mark(function i(){var c,m,v,y,d;return p().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return g.getOfflineListCountBySourceId(),c=g.state.offlinePageConfig,m=g.props,v=m.sourceType,y=m.taskId,g.setState({loading:!0}),U.prev=4,U.next=7,ae({sourceId:y,pageNumber:c.pageNumber,pageSize:c.pageSize,train_type:c.train_type,sourceType:v});case 7:d=U.sent,g.setState({loading:!1}),d.data.code==="200000"&&g.setState({total:d.data.data.total,list:d.data.data.list}),U.next=15;break;case 12:U.prev=12,U.t0=U.catch(4),g.setState({loading:!1});case 15:case"end":return U.stop()}},i,null,[[4,12]])})),this.handleChangeRadio=i=>{var c=i.target.value,m=this.state.offlinePageConfig;m.pageNumber=1,m.train_type=c,this.setState({offlinePageConfig:m},()=>{this.getOfflineData()})},this.offlinePageChange=(i,c)=>{var m=this.state.offlinePageConfig;m.pageNumber=i,m.pageSize=c,this.setState({offlinePageConfig:m},()=>{this.getOfflineData()})},this.handleOfflineShare=i=>{var c=this.props,m=c.taskId,v=c.t,y=i.title,d=i.lecturer_name,b=i.offline_course_id,U={title:y,site1:{label:v("component.courseTime"),value:C()(i.begin_time).format("YYYY-MM-DD HH:mm")},site2:{label:v("common.endTime"),value:C()(i.end_time).format("YYYY-MM-DD HH:mm")},from:"offline",path:(0,Ce.jr)({pc_url:"/share-transit?source=studyTask&type=offlineCourse&id=".concat(m,"&course_id=").concat(b),mobile_url:"/share-transit?source=studyTask&type=offlineCourse&id=".concat(m,"&course_id=").concat(b),pc_type:"student",mobile_type:"h5"})};d&&(U.lecture={name:d,avatar:"",id:"",source_type:""}),h().$share.show({detail:U})},this.getTableColumn=()=>{var i=this.props.t,c=E.parse(ge.m8.location.search),m=(0,Ce.UI)("PRINT_SIGNATURE"),v=[{title:i("lineClassStudy.lineClassName"),dataIndex:"title",key:"title",fixed:"left",render:y=>h().createElement(w.Z,{title:y||"--"},h().createElement("div",{className:"cl-text-ellipsis",style:{width:180}},y||"--"))},{title:i("component.lecturer"),width:120,dataIndex:"lecturer_name",key:"lecturer_name",render:(y,d)=>{var b=d.teacher_sync_type,U=d.teacher_sync_user_id,Ie=d.teacher_sync_source_type;return y&&b&&b==="inside"?h().createElement(Ne.Z,{dataType:"userName",value:U,name:y,type:Ie}):h().createElement("span",null,y||"--")}},{title:i("lineClass.offlineTrainingDuration"),dataIndex:"course_duration_str",key:"course_duration_str",width:180,render:y=>y||"--"},{title:i("historicRecords.courseGrade"),dataIndex:"course_evaluate_message",key:"course_evaluate_message",width:90,render:(y,d)=>d.course_evaluate_message?d.course_evaluate_message.evaluate_name==="0"?h().createElement("span",null,d.course_evaluate_message.evaluate_name):h().createElement(se.Z,{name:y.evaluate_name,onClick:()=>this.handleShowCourseScore(d)}):"--"},{title:i("lecturerPage.lecturerStar"),dataIndex:"lecturer_evaluate_message",key:"lecturer_evaluate_message",width:90,render:(y,d)=>d.lecturer_evaluate_message?d.lecturer_evaluate_message.evaluate_name==="0"?h().createElement("span",null,d.lecturer_evaluate_message.evaluate_name):h().createElement(se.Z,{name:y.evaluate_name,onClick:()=>this.handleShowLecturerScore(d)}):"--"},{title:i("lineClass.learningNum"),dataIndex:"accomplish_amount",key:"accomplish_amount",width:90,render:y=>y||"--"},{title:i("common.overdue"),width:90,dataIndex:"overdue_amount",key:"overdue_amount"},{title:i("common.completionRate"),width:90,dataIndex:"completion_rate",key:"completion_rate"},{title:i("lineClass.assessmentOffline"),width:700,children:[{title:i("lineClass.hasBeenRecorded"),width:180,render:(y,d)=>{var b=u()(d.offline_assessment,"have_score_amount",null);return!b||!d.is_open_offline_assessment?"--":b}},{title:i("lineClass.toBeRecorded"),width:180,render:(y,d)=>{var b=u()(d.offline_assessment,"no_score_amount",null);return!b||!d.is_open_offline_assessment?"--":b}}]},{title:i("lineClass.trainingAttachment"),width:90,render:(y,d)=>d.training_attachment?h().createElement(se.Z,{name:d.training_attachment.amount,onClick:()=>this.handleShowFile(d.training_attachment.amount,d.offline_course_id,"traning")}):"--"},{title:i("lineClass.activitiesAttachment"),width:90,render:(y,d)=>d.activity_attachment?h().createElement(se.Z,{name:d.activity_attachment.amount,onClick:()=>this.handleShowFile(d.activity_attachment.amount,d.activity_attachment.attachment_id,"activity")}):"--"},{title:i("learning.aiTrainTime"),width:180,render:(y,d)=>d.begin_time?h().createElement("span",null,C()(d.begin_time).format("YYYY-MM-DD HH:mm"),"~",C()(d.end_time).format("YYYY-MM-DD HH:mm")):"--"},{title:i("lineClass.classAddress"),dataIndex:"address",key:"address",width:120,render:y=>h().createElement(w.Z,{title:y||"--"},h().createElement("div",{className:"cl-text-ellipsis",style:{width:120}},y||"--"))},{title:i("common.operate"),width:160,fixed:"right",key:"operate",render:(y,d)=>{var b=[{visible:!0,title:i("common.data"),click:()=>this.jumpLineClassPage(d)},{visible:c.planStatus==="published",title:i("common.share"),click:()=>this.handleOfflineShare(d)},{visible:!0,disabled:d.train_status!=="finished"||d.status!=="published",title:i("lineClass.curriculumSettlement"),click:()=>this.classStatement(d)},{visible:!0,disabled:!(d.status==="published"||d.status==="settled"),title:i("lineClass.summaryOfCourse"),click:()=>this.handleApproval(d)},{visible:!0,title:i("lineClassStudy.QRCode"),click:()=>this.handleQRCode(d)}];return m&&b.splice(3,0,{visible:!0,title:i("common.printSignature"),click:()=>this.handleShowPrintSignature(d.offline_course_id)}),h().createElement(Te.Z,{buttons:b})}}];return v},this.handleQRCode=i=>{this.setState({qrCodeVisible:!0,qrCodeDetail:i})},this.handleShowFile=(i,c,m)=>{!i||this.setState({fileList:{visible:!0,type:m,id:c}})},this.handleShowCourseScore=i=>{var c=i.course_evaluate_message,m=i.lecturer_id,v=i.offline_course_id;c.evaluate_type==="star"&&c.evaluate_name==="0"||this.setState({scoreDetail:{visible:!0,evaluateType:c.evaluate_type,id:c.evaluate_id,courseId:v,lecturerId:m,type:"course"}})},this.handleShowLecturerScore=i=>{var c=i.lecturer_evaluate_message,m=i.lecturer_id,v=i.offline_course_id;c.evaluate_type==="star"&&c.evaluate_name==="0"||this.setState({scoreDetail:{visible:!0,evaluateType:c.evaluate_type,id:c.evaluate_id,courseId:v,lecturerId:m,type:"lecturer"}})},this.handleCloseDialog=()=>{this.setState({scoreDetail:{visible:!1,type:""}})},this.handleApproval=i=>{var c=this.props.taskId;ge.m8.push("/knowledgeBase/learningResources/lineClass/courseSummary?taskId=".concat(c,"&courseId=").concat(i.offline_course_id,"&fromType=task"))},this.jumpLineClassPage=i=>{var c=this.props,m=c.taskId,v=c.sourceType;if(v==="study_plan"){ge.m8.push("/training/learning/task/lineClass/monitor?taskId=".concat(m,"&courseId=").concat(i.offline_course_id,"&sourceType=").concat(v,"&signId=").concat(i.sign_id));return}ge.m8.push("/knowledgeBase/learningResources/lineClass/monitor?taskId=".concat(m,"&courseId=").concat(i.offline_course_id,"&sourceType=").concat(v,"&signId=").concat(i.sign_id))},this.classStatement=i=>{this.setState({courseStatement:{visible:!0,id:i.offline_course_id}})},this.handleCloseCourseStatement=i=>{this.setState({courseStatement:{visible:!1,id:""}}),i&&this.refreshData()},this.handleExportExcel=()=>{var i=this.state.offlinePageConfig;N.Z.confirm({title:this.props.t("common.tip"),content:this.props.t("lineClass.confirmToExport"),onOk:()=>{var c=this.props,m=c.sourceType,v=c.taskId,y="?source_type=".concat(m,"&train_type=").concat(i.train_type);(0,F.N)({page:"offlineCourseListExport",props:this.props,query:y,rest:{taskId:v}})}})},this.handleShowPrintSignature=i=>{this.setState({signatureId:i})},this.handleHidePrintSignature=()=>{this.setState({signatureId:"",printConfig:null})},this.renderProTableHeaderTitle=()=>{var i=this.props.t;return h().createElement(z.Fragment,null,h().createElement(Z.Z,{type:"primary",icon:h().createElement(G.Z,null),onClick:this.handleExportExcel}," ",i("common.exportData")," "))},this.handlePreview=(0,W.Z)(p().mark(function i(){var c,m,v,y;return p().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(b.prev=0,!g.printRef){b.next=12;break}if(c=g.printRef.current,m=c.getErrorMsg(),!m){b.next=7;break}return t.default.error(m),b.abrupt("return");case 7:return v=g.state.signatureId,y=(0,D.Z)((0,D.Z)({},c.printOptions),{},{userIds:c.selectStudents&&c.selectStudents.map(U=>U.id).join(",")}),b.next=11,(0,fe.wq)(v,y);case 11:g.setState({printConfig:(0,D.Z)((0,D.Z)({},c.printOptions),{},{selectStudents:c.selectStudents,backContent:c.backContent})});case 12:b.next=17;break;case 14:b.prev=14,b.t0=b.catch(0),t.default.error(b.t0);case 17:case"end":return b.stop()}},i,null,[[0,14]])})),this.handlePrintf=()=>{this.setState({signatureId:null});var i=this.props.t,c=this.state.printConfig.selectStudents,m=navigator.appVersion,v="DingTalk";if(m.indexOf(v.toLowerCase())>-1){t.default.warn(i("printingIsNotSupported.printingIsNotSupported"));return}try{if(c){var y=document.createElement("div"),d=document.body.innerHTML,b=document.getElementById("printContainer");c.forEach(U=>{var Ie=this.generateHtml(b,y,U),ie=document.createElement("div");ie.style.height="150px",y.appendChild(ie),y.appendChild(Ie)}),document.body.innerHTML=y.innerHTML,window.print(),document.body.innerHTML=d,window.location.reload()}}catch(U){console.error(U)}},this.generateHtml=(i,c,m)=>{var v=i.cloneNode(!0);v.id=m.id,v["data-html2canvas-ignore"]=!0;var y=this.findDomByCls(v,"studentName"),d=this.findDomByCls(v,"deptName"),b=this.findDomByCls(v,"postName");return y.forEach(U=>{U.innerHTML=m.name}),d.forEach(U=>{U.innerHTML=m.dept_name}),b.forEach(U=>{U.innerHTML=m.post_name}),c.appendChild(v),v.style.width="100%",v},this.handleDownloadSignature=()=>{var i=this.state.printConfig.selectStudents,c=new(me())("p","mm","a4");if(i){var m=document.createElement("div"),v=document.getElementById("printContainer"),y=i.map((d,b)=>{var U=this.generateHtml(v,m,d),Ie=this.findDomByCls(U,"frontContentContainer");Ie.map(Se=>{Se.style.paddingTop="200px"}),document.body.appendChild(m),m.style.width="900px";var ie=new Promise(Se=>{L()(U,{allowTaint:!0,scale:1}).then(he=>{var be=he.getContext("2d"),Ee=190,He=277,Ze=Math.floor(He*he.width/Ee),Re=0,Oe=document.createElement("canvas");Oe.width=he.width,Oe.height=Math.min(Ze,he.height-Re);var Ae=Ee*he.height/he.width,je=(297-Ae)/2;Oe.getContext("2d").putImageData(be.getImageData(0,Re,he.width,Math.min(Ze,he.height-Re)),0,0),c.addImage(Oe.toDataURL("image/jpeg",1),"JPEG",10,je,Ee,Ae),i.length-1!==b&&c.addPage(),Se(!0)})});return ie});Promise.all(y).then(()=>{var d=this.state.list.find(b=>b.offline_course_id===this.state.signatureId);c.save("".concat(d.title,".pdf")),document.body.removeChild(m)})}},this.findDomByCls=function(i,c){var m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];return i.className&&i.className.indexOf(c)>-1&&m.push(i),i.childNodes.forEach(v=>{g.findDomByCls(v,c,m)}),m},this.toolBarRender=()=>{var i=this.props,c=i.prefixCls,m=i.t,v=this.state.listStatusNum;return h().createElement("div",{className:"".concat(c,"__header")},h().createElement("div",{className:"".concat(c,"__header__tab-radio")},h().createElement(H.ZP.Group,{defaultValue:"",onChange:this.handleChangeRadio},h().createElement(H.ZP.Button,{value:""},m("common.all"),"\uFF08",v.totalCount||0,"\uFF09"),h().createElement(H.ZP.Button,{value:"unstarted"},m("common.notStarted"),"\uFF08",v.unstarted||0,"\uFF09"),h().createElement(H.ZP.Button,{value:"ongoing"},m("common.ongoing"),"\uFF08",v.onGoingCount||0,"\uFF09"),h().createElement(H.ZP.Button,{value:"finished"},m("common.ended"),"\uFF08",v.endCount||0,"\uFF09"))))},this.state={offlinePageConfig:{pageSize:20,pageNumber:1,train_type:""},listStatusNum:{totalCount:0,unstarted:0,onGoingCount:0,endCount:0},qrCodeVisible:!1,total:0,list:[],loading:!1,fileList:{visible:!1,type:"",id:""},courseStatement:{visible:!1,id:""},signatureId:"",printConfig:null,scoreDetail:{type:"",visible:!1},qrCodeDetail:{}},this.printRef=h().createRef()}componentDidMount(){this.refreshData()}renderPrintSignatureFooter(){var r=this.props.t,g=this.state.printConfig;return h().createElement("div",{className:"align-center"},g?h().createElement(h().Fragment,null,h().createElement(Z.Z,{onClick:()=>{this.setState({printConfig:null})}},r("common.cancel")),h().createElement(Z.Z,{type:"primary",onClick:this.handlePrintf},r("lineClassStudy.printAll")),h().createElement(Z.Z,{type:"primary",onClick:this.handleDownloadSignature},r("lineClassStudy.downloadAll"))):h().createElement(h().Fragment,null,h().createElement(Z.Z,{onClick:this.handleHidePrintSignature},r("common.cancel")),h().createElement(Z.Z,{type:"primary",onClick:this.handlePreview},r("lineClassStudy.printPreview"))))}render(){var r=this.state,g=r.total,i=r.offlinePageConfig,c=i.pageSize,m=i.pageNumber,v=r.loading,y=r.list,d=r.fileList,b=r.courseStatement,U=r.qrCodeVisible,Ie=r.scoreDetail,ie=r.qrCodeDetail,Se=r.signatureId,he=r.printConfig,be=this.props,Ee=be.t,He=be.taskId,Ze=be.sourceType,Re=(0,D.Z)((0,D.Z)({},$.XE.INITIAL_PAGINATION),{},{defaultPageSize:c,current:m,total:g,onChange:this.offlinePageChange,onShowSizeChange:this.props.pageSizeChange}),Oe={mask:!0,width:700,title:Ee("lineClassStudy.QRCode"),footer:null,bodyStyle:{padding:0},destroyOnClose:!0,visible:U,onCancel:()=>this.setState({qrCodeVisible:!1})},Ae=this.getTableColumn();return h().createElement("div",{className:"offline-list-panel"},h().createElement("div",{className:"offline-list-panel-list"},h().createElement("div",{className:"offline-list-panel-list-table"},h().createElement("section",{className:"offline-panel__table"},h().createElement(xe.f,{headerTitle:this.renderProTableHeaderTitle(),toolBarRender:this.toolBarRender,loading:v,dataSource:y,columns:Ae,rowKey:je=>je.userId,pagination:!1,scroll:{x:"max-content"},tableUUID:"b5fb784c-7aaa-42dc-b57f-2b2f4eecc16f"}))),g>c||!Re.hideOnSinglePage?h().createElement("div",{className:"offline-list-panel-list-pagination"},h().createElement(q.Z,Re)):null),h().createElement($e.Z,{title:d.type==="traning"?Ee("lineClass.trainingAttachment"):Ee("lineClass.activitiesAttachment"),visible:d.visible,fileId:d.id,onCancel:()=>{this.setState({fileList:{visible:!1,id:"",type:""}})}}),h().createElement(ke.Z,{id:b.id,visible:b.visible,onCancel:this.handleCloseCourseStatement}),h().createElement(ye.ZP,{visible:Se,title:Ee("common.printSignature"),width:"60%",onCancel:this.handleHidePrintSignature,footer:this.renderPrintSignatureFooter()},he?h().createElement(Ue.Z,{printConfig:he}):h().createElement(ce.Z,{sourceType:Ze,t:Ee,ref:this.printRef,signId:u()(this.state.list.find(je=>je.offline_course_id===Se),"sign_id"),courseId:Se,taskId:He})),h().createElement(oe.Z,{modalConfig:Oe,detail:(0,D.Z)((0,D.Z)({},ie),{},{id:ie.sign_id,sign_address:ie.course_sign_config&&ie.course_sign_config.address,sign_address_detail:ie.course_sign_config&&ie.course_sign_config.address_detail,sign_range:ie.course_sign_config&&ie.course_sign_config.sign_range}),can_save:!1,universal:!0}),h().createElement(Be.Z,(0,V.Z)({exportVisibleHide:!0},Ie,{onCancel:this.handleCloseDialog})))}}var _=(0,ee.$j)(Ke)((0,Y.Z)("translation",{withRef:!0})(ue))},35925:function(Pe,J,e){"use strict";e.d(J,{Z:function(){return Z}});var V=e(12924),T=e.n(V),q=e(91768),A=e(1164),H=e(36202);class te extends T().Component{constructor(){super(...arguments);this.getTableColumn=()=>{var N=[{title:this.props.t("practiceOperation.workTitle"),dataIndex:"title",key:"title"},{title:this.props.t("practiceOperation.shouldSubmit"),dataIndex:"total_count",key:"total_count",width:90},{title:this.props.t("practiceOperation.unsubmitted"),width:90,dataIndex:"not_submit_count",key:"not_submit_count"},{title:this.props.t("practiceOperation.submitted"),width:90,dataIndex:"already_submit_count",key:"already_submit_count"},{title:this.props.t("common.approved"),width:90,dataIndex:"pass_count",key:"pass_count"},{title:this.props.t("practiceOperation.fail"),width:90,dataIndex:"reject_count",key:"reject_count"},{title:this.props.t("personal.underReview"),width:90,dataIndex:"waiting_count",key:"waiting_count"},{title:this.props.t("common.operate"),width:120,fixed:"right",key:"operate",render:(f,w)=>this.renderActions({record:w})}];return N},this.renderActions=N=>{var f=N.record,w=this.props,W=w.t,D=w.taskId,k=w.taskType,p=w.id;return T().createElement("div",{className:"cl-table__cell-action"},T().createElement(A.Z,{to:"/training/learning/management/monitor/work?id=".concat(p,"&taskId=").concat(D,"&taskType=").concat(k,"&operationId=").concat(f.id,"&title=").concat(f.title)},T().createElement("span",{className:"cl-pointer"},W("common.viewDetails"))))}}render(){var N=this.props,f=N.isLoading,w=N.list,W=N.prefixCls,D=this.getTableColumn();return T().createElement("section",{className:W},T().createElement(H.f,{loading:f,dataSource:w,columns:D,rowKey:k=>k.id,pagination:!1,tableUUID:"ea45645b-4814-4bfa-a36c-b750ef32ecac"}))}}te.defaultProps={prefixCls:"offline-panel__table"};var t=(0,q.Z)()(te);class j extends T().Component{constructor(N){super(N);this.state={}}render(){var N=this.props,f=N.workInfo,w=N.isLoading,W=N.taskId,D=N.taskType,k=N.id,p=k===void 0?"":k;return T().createElement("div",{className:"offline-panel-tab"},T().createElement("div",{className:"offline-panel-tab-list"},T().createElement("div",{className:"offline-panel-tab-list-table"},T().createElement(t,{isLoading:w,list:f.list,id:p,taskId:W,taskType:D}))))}}var Z=j},32657:function(Pe,J,e){"use strict";e.r(J),e.d(J,{default:function(){return Ke}});var V=e(14781),T=e(53431),q=e(17462),A=e(1474),H=e(88986),te=e(88983),t=e(47933),j=e(57663),Z=e(71577),B=e(22385),N=e(31097),f=e(34792),w=e(48086),W=e(57361),D=e(71194),k=e(57016),p=e(47673),z=e(4107),h=e(43358),ee=e(34041),G=e(9754),Y=e.n(G),_e=e(12924),u=e.n(_e),ge=e(28216),ve=e(68628),me=e(91768),re=e(57068),L=e(76651),M=e(22614),C=e(55839);class E extends u().PureComponent{constructor(_){super(_);this.operateIconClick=(S,r)=>{var g=this.props.operateIconClick;g&&g(S,r)},this.renderOperate=()=>{var S=this.props.t,r=()=>u().createElement("span",{className:"cl-pointer",onClick:()=>{this.operateIconClick("report",this.props.record)}},S("questionn.abilityReport")),g=()=>u().createElement("a",{className:"cl-pointer",onClick:()=>{this.operateIconClick("liftingScheme",this.props.record)}},S("questionn.improvePlan")),i=()=>u().createElement("span",{className:"cl-pointer-divide"});return u().createElement("div",{className:"cl-table__cell-action"},u().createElement(r,null),u().createElement(i,null),u().createElement(g,null))},this.state={}}render(){return u().createElement("div",null,this.renderOperate())}}E.defaultProps={status:"",operateIconClick:(ue,_)=>{},record:{}};var $=(0,me.Z)()(E),F=e(41549),K=e(6793),ae=e(55285);class pe extends u().Component{constructor(_){super(_);this.onCancel=()=>{this.setState({visible:!1})},this.onEvaluationStatus=S=>{var r=re.parse(L.m8.location.search),g=r.id;(0,C.zP)(g,S.user_id).then(i=>{this.setState({visible:!0,modalDataSource:i.data})})},this.operateIconClick=(S,r)=>{this.props.onDataTableOperateIconClick(S,r)},this.state={visible:!1,modalColumns:[{title:_.t("evaluation.assessmentDimensions"),key:"type",dataIndex:"type",render:S=>{var r="";switch(S){case"self":r=_.t("personnelDevelope.self");break;case"superior":r=_.t("personnelDevelope.evaluationSuperior");break;case"subordinate":r=_.t("evaluation.subordinate");break;case"sameLevel":r=_.t("evaluation.sameLevel");break;default:break}return r}},{title:_.t("tutorial.evaluator"),key:"name",dataIndex:"name"},{title:_.t("personnelDevelope.currentStatus"),key:"status",dataIndex:"status",render:S=>S==="finish"?_.t("personnelDevelope.quantityCompleted"):_.t("common.unFinish")},{title:_.t("personnelDevelope.updateTime"),key:"update_time",dataIndex:"update_time",render:S=>S?(0,K.p6)(S):"---"}],modalDataSource:[]},this.tableColumns=[{title:_.t("evaluationManage.evaluationStatus"),dataIndex:"status",key:"status",width:80,render:(S,r)=>{var g=re.parse(L.m8.location.search),i=g.tool_type;return i==="tool"||!i?u().createElement("span",null,S===1?_.t("questionn.completed"):_.t("common.unFinish")):u().createElement("a",{onClick:()=>{this.onEvaluationStatus(r)}},S===1?_.t("questionn.completed"):_.t("common.unFinish"))}},{title:_.t("evaluationManage.evaluationTimeComplete"),dataIndex:"commit_time",key:"commit_time",width:130,render:S=>S?(0,K.p6)(S):"--"},{title:_.t("evaluationManage.upgradeStatus"),dataIndex:"process",key:"process",width:80,render:S=>S===0?_.t("common.notStarted"):S>0&&S<100?_.t("common.ongoing"):S===100?_.t("questionn.completed"):"--"},{title:_.t("evaluationManage.upgradeCompleteTime"),dataIndex:"end_time",key:"end_time",width:120,render:S=>S?(0,K.p6)(S):"--"},{title:_.t("common.operate"),width:160,key:"operate",fixed:"right",render:(S,r)=>u().createElement($,{status:r.status,record:r,operateIconClick:this.operateIconClick})}]}render(){var _=this.props,S=_.dataSource,r=_.loading,g=_.headerTitle,i=_.toolBarRender,c=_.t,m=this.state,v=m.visible,y=m.modalColumns,d=m.modalDataSource;return u().createElement(u().Fragment,null,u().createElement("section",{className:"PostTalentAssessment_table_container"},u().createElement(ae.Z,{dataSource:S,columns:this.tableColumns,rowKey:b=>b.user_id,pagination:!1,loading:r,headerTitle:g,toolBarRender:i,tableUUID:"98c9bd02-41db-4c9b-8940-b1a79b403226"})),u().createElement(F.Z,{title:c("personnelDevelope.evaluationStatus"),visible:v,onCancel:this.onCancel,modalColumns:y,modalDataSource:d}))}}pe.defaultProps={rowSelectionChange:()=>{}};var fe=ue=>({lng:ue.user.lng}),Ce=(0,ge.$j)(fe)((0,me.Z)()(pe)),se=e(37055),Te=e(4408),ye=e(84874),xe=e(38642),$e=e(61421),ke=e(56075),ce=ee.Z.Option,Ue=z.Z.Search,Be=ue=>({userLng:ue.user}),oe={page_number:1,page_size:20,keyword:"",promote_status:null,status:""};class Ne extends u().Component{constructor(_){var S;super(_);S=this,this.handleSearch=r=>{oe.page_number=1,oe.keyword=r,this.getPeopleList()},this.handleDataTableOperateIconClick=(r,g)=>{var i=this.state.evaluationTaskDetail,c=i.version_type,m=g.plan_id,v=g.user_id;this.evaluationReportOrLiftingScheme.type=r,this.evaluationReportOrLiftingScheme.planId=m,this.evaluationReportOrLiftingScheme.userId=v,i.evaluation_tool_type!=="tool"?this.viewReportOrImprovePlan():(0,C.U1)(m,v).then(y=>{var d=y.data,b=d.look;c==="platform"?b==="true"?this.setState({isLookModalVisible:!0,reportRecord:g}):this.setState({evaluationReportOrLiftingSchemeModalVisible:!0,reportRecord:g}):this.viewReportOrImprovePlan(g)})},this.getPeopleList=()=>{this.setState({peopleListInfosLoading:!0});var r=this.state.taskId;(0,C.xJ)(r,oe).then(g=>{this.setState({peopleListInfos:g.data,peopleListInfosLoading:!1})}).catch(()=>{this.setState({peopleListInfos:{list:[],total:0},peopleListInfosLoading:!1})})},this.getPostTalentAssessmentDetail=r=>{(0,C.uv)(r).then(g=>{var i=g.data;this.setState({evaluationTaskDetail:i})})},this.handleEvaluationReportOrLiftingSchemeModelCancel=()=>{this.setState({evaluationReportOrLiftingSchemeModalVisible:!1})},this.evaluationReportOrLiftingSchemeModelOk=r=>{var g=this.state.reportRecord;r>0?this.viewReportOrImprovePlan(g):this.handleOpenNow()},this.handleInputSearch=r=>{var g=r.target.value;oe.page_number=1,oe.keyword=g,this.debounceSearch()},this.debounceSearch=(0,xe.Ds)(()=>{this.getPeopleList()},500),this.peopleListPageChange=r=>{oe.page_number=r,this.getPeopleList()},this.peopleListPageSizeChange=(r,g)=>{oe.page_number=1,oe.page_size=g,this.getPeopleList()},this.handleQrcode=()=>{var r=this.state.contactServiceVisible;this.setState({contactServiceVisible:!r})},this.handleOpenNow=()=>{this.setState({contactServiceVisible:!0,evaluationReportOrLiftingSchemeModalVisible:!1})},this.renderEvaluationReportOrLiftingScheme=r=>{var g=r,i=this.props.t,c=this.state.evaluationReportOrLiftingSchemeModalVisible;return u().createElement(k.Z,{title:i("questionn.warmHint"),visible:c,closable:!1,onOk:()=>{this.evaluationReportOrLiftingSchemeModelOk(g)},onCancel:this.handleEvaluationReportOrLiftingSchemeModelCancel,cancelText:i("common.cancel"),okText:g>0?i("questionn.confirmView"):i("questionn.upgradeImmediately")},u().createElement("div",{className:"evaluationReportOrLiftingSchemeModal_content"},u().createElement("p",null,"".concat(i("questionn.evaluationModalTipCanView")," 5 ").concat(i("common.unitfeng")," ").concat(i("questionn.evaluationModalTipName"))),u().createElement("p",null,"".concat(i("questionn.evaluationModalTipRemainTimes"),": ").concat(g," ").concat(i("common.times"))),u().createElement("p",null,g>0?i("questionn.evaluationModalTipUpgrade"):i("questionn.evaluationModalTipConfirmView"))))},this.renderIsLook=()=>{var r=this.props.t,g=this.state.isLookModalVisible;return u().createElement(k.Z,{title:r("questionn.warmHint"),visible:g,closable:!1,onOk:this.handleIsLookModelOk,onCancel:this.handleIsLookModelCancel,cancelText:r("common.cancel"),okText:r("common.ok")},u().createElement("div",{className:"isLookModal_content"},u().createElement("p",null,this.evaluationReportOrLiftingScheme.type==="report"?"".concat(r("questionn.isLookTipsStart")).concat(r("questionn.abilityReport")).concat(r("questionn.isLookTipsEnd")):"".concat(r("questionn.isLookTipsStart")).concat(r("questionn.improvePlan")).concat(r("questionn.isLookTipsEnd")))))},this.getAbilityInfo=r=>{(0,C.pc)(r).then(function(){var g=(0,W.Z)(Y().mark(function i(c){var m,v,y,d,b,U;return Y().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return m=c.data,v=m.evaluation_dimension,y=[],d=S.props.t,v.forEach(Se=>{switch(Se){case"sameLevel":y.push(d("evaluation.sameLevel"));break;case"superior":y.push(d("personnelDevelope.evaluationSuperior"));break;case"subordinate":y.push(d("evaluation.subordinate"));break;case"self":y.push(d("evaluation.self"));break;default:break}}),S.setState({ability_names:m.ability_names,completed:m.evaluation_finish_info_vo.completed,total:m.evaluation_finish_info_vo.total,finish_status:m.evaluation_finish_info_vo.finish_status,evaluation_dimension:y.join("\uFF0C"),tool_type_res:m.tool_type}),ie.next=8,(0,ke.IT)();case 8:b=ie.sent,U=b.data.data,S.setState({currentUseTool:U});case 11:case"end":return ie.stop()}},i)}));return function(i){return g.apply(this,arguments)}}())},this.handleIsLookModelOk=()=>{var r=this.state.reportRecord;this.viewReportOrImprovePlan(r)},this.handleIsLookModelCancel=()=>{this.setState({isLookModalVisible:!1})},this.handleChangeStatus=r=>{oe.page_number=1,oe.status=r.target.value,this.getPeopleList()},this.handleChangePromote=r=>{oe.page_number=1,oe.promote_status=r,this.getPeopleList()},this.urgeMsg=function(){var r=(0,W.Z)(Y().mark(function g(i){var c,m,v;return Y().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(c=S.props.t,m=S.state.taskId,v="",i!=="promote"){d.next=9;break}return d.next=6,(0,C.CG)(m);case 6:v=d.sent,d.next=13;break;case 9:if(i!=="evaluation"){d.next=13;break}return d.next=12,(0,C.wf)(m);case 12:v=d.sent;case 13:v.data.code===0&&w.default.success(c("evaluation.sendSuccess"));case 14:case"end":return d.stop()}},g)}));return function(g){return r.apply(this,arguments)}}(),this.renderLeftRow=()=>{var r=this.state,g=r.evaluationTaskDetail,i=r.taskId,c=g.version_type,m=g.end_time,v=g.term_type,y=new Date().getTime(),d=this.props.t;return u().createElement("div",{className:"content_left_beta"},u().createElement(M.Z,{isBeta:c==="platform",id:i,userIds:[],multiple:!0,btnType:"primary",tool:g.evaluation_tool_type}),v==="custom"&&m<y?null:u().createElement(Z.Z,{className:"border-button",onClick:()=>this.urgeMsg("evaluation")},d("evaluation.measurementUrge"),u().createElement(N.Z,{placement:"topLeft",title:d("evaluation.urgeText")},u().createElement(ve.Z,null))),v==="custom"&&m<y?null:u().createElement(Z.Z,{className:"border-button",onClick:()=>this.urgeMsg("promote")},d("evaluation.urgedAscension"),u().createElement(N.Z,{placement:"topLeft",title:d("evaluation.urgeTextSuccess")},u().createElement(ve.Z,null))))},this.renderRightRow=()=>{var r=this.props.t,g=[{label:r("common.all"),value:""},{label:r("common.unFinish"),value:"un_complete"},{label:r("questionn.completed"),value:"complete"}];return u().createElement("div",{className:"PostTalentAssessment_left_functions"},u().createElement(t.ZP.Group,{options:g,onChange:this.handleChangeStatus,value:oe.status,optionType:"button"}),u().createElement(Ue,{className:"PostTalentAssessment-search",placeholder:r("searchInputPlaceholder.userName"),onSearch:this.handleSearch,onInput:this.handleInputSearch,allowClear:!0,style:{width:272}}))},this.state={evaluationReportOrLiftingSchemeModalVisible:!1,isLookModalVisible:!1,taskId:"",peopleListInfos:{list:[],total:0},peopleListInfosLoading:!0,evaluationTaskDetail:{total:0,completed:0,course_count:15,product_name:"\u540D\u79F0",title:"\u540D\u79F0",biz_courses:[],start_time:1593761222e3,end_time:1593761225e3,version_type:"platform",is_open:"false"},contactServiceVisible:!1,ability_names:"",evaluation_dimension:"",completed:"",total:"",finish_status:!1,reportRecord:"",tool_type_res:"",currentUseTool:""},this.getPeopleListParams={page_number:1,page_size:20,keyword:"",status:""},this.evaluationReportOrLiftingScheme={type:"",planId:"",userId:""}}componentDidMount(){var _=re.parse(L.m8.location.search),S=_.id,r=this.props.headerShow?S:this.props.taskId;this.getPostTalentAssessmentDetail(r),this.getAbilityInfo(r),this.setState({taskId:r},()=>{this.getPeopleList()})}UNSAFE_componentWillReceiveProps(_){if(_.taskId!==this.props.taskId){var S=this.props.taskId;this.getPostTalentAssessmentDetail(S),this.setState({taskId:S},()=>{this.getPeopleList()})}}componentWillUnmount(){oe={page_number:1,page_size:20,keyword:"",promote_status:null,status:""}}viewReportOrImprovePlan(_){var S=_?"&finish_status=".concat(_.status):"",r=this.evaluationReportOrLiftingScheme,g=r.type,i=r.planId,c=r.userId,m=this.state.evaluationTaskDetail,v=m.version_type,y=m.evaluation_tool_type;L.m8.push("/training/questionn/postTalentAssessment/evaluationReport?planId=".concat(i,"&type=").concat(g,"&userId=").concat(c,"&isBeta=").concat(v==="platform","&toolType=").concat(y).concat(S))}render(){var _=this.props,S=_.headerShow,r=_.t,g=_.prefixCls,i=_.noPadding,c=this.state,m=c.peopleListInfos,v=c.evaluationTaskDetail,y=c.peopleListInfosLoading,d=c.contactServiceVisible,b=c.ability_names,U=c.evaluation_dimension,Ie=c.completed,ie=c.total,Se=c.finish_status,he=re.parse(L.m8.location.search),be=he.tool_type,Ee=he.isNotifyTaskExp;Ee=this.state.tool_type_res==="tas"&&this.state.finish_status===0&&this.state.currentUseTool==="true"?"true":"false";var He=v.title,Ze=v.create_user_name,Re=v.start_time,Oe=v.end_time,Ae=v.version_type,je=v.look_count,Fe=v.is_open,qe=v.term_type,et=v.evaluation_tool_type,it=m.total,rt=m.list,tt=oe,ot=tt.page_number,at=tt.page_size,lt=(0,H.Z)((0,H.Z)({defaultPageSize:at},se.XE.INITIAL_PAGINATION),{},{current:ot,total:it,onChange:this.peopleListPageChange,onShowSizeChange:this.peopleListPageSizeChange}),Je=[{label:r("common.notStarted"),value:"un_start"},{label:r("questionn.completed"),value:"complete"},{label:r("common.ongoing"),value:"on_going"}];return u().createElement("div",{className:"".concat(g," PostTalentAssessment-monitor")},u().createElement(Te.Z,{title:r("documentTitle.evaluationTaskMonitor")}),S&&u().createElement(u().Fragment,null,u().createElement("div",{className:"PostTalentAssessment-monitor-container-header"},v&&u().createElement("div",{className:"PostTalentAssessment__header"},u().createElement("div",{className:"PostTalentAssessment-info"},u().createElement("div",{className:"PostTalentAssessment-info-title"},He),be!=="tool"&&u().createElement("div",{className:"PostTalentAssessment-info-ability"}," ","".concat(r("personnelDevelope.assessmentCapabilityItem"),"\uFF1A").concat(b)),u().createElement("div",{className:"PostTalentAssessment-info-sub"},qe==="permanent"&&u().createElement("span",{className:"PostTalentAssessment-info-sub-item"},r("exam.validityPeriod"),"\uFF1A",r("course.permanent")),qe==="custom"&&u().createElement("span",{className:"PostTalentAssessment-info-sub-item"},r("exam.validityPeriod"),"\uFF1A",(0,K.p6)(Re,"yyyy-MM-dd hh:mm")," ~"," ",(0,K.p6)(Oe,"yyyy-MM-dd hh:mm")),u().createElement("span",{className:"PostTalentAssessment-info-sub-item"},this.props.t("common.creator"),"\uFF1A",Ze),u().createElement("span",{className:"PostTalentAssessment-info-sub-item"},r("questionn.finishedCondition"),"\uFF1A",u().createElement("span",null,"".concat(r(Se===0?"common.unFinish":"questionn.completed"),"(").concat(Ie,"/").concat(ie,")"))),be!=="tool"&&u().createElement("span",null,r("evaluation.assessmentDimensions"),"\uFF1A",U)))))),u().createElement("div",{className:"PostTalentAssessment-content",style:i?{padding:0}:{}},Ee=="true"&&be==="tool"?u().createElement(A.Z,{message:"".concat(r("evaluation.notifyTaskExpEvaluation")),banner:!0,type:"warning",showIcon:!0,closable:!0}):null,u().createElement("div",{className:"content_left"},u().createElement("div",{className:"content-row"},et==="tool"&&Fe==="true"&&Ae==="platform"&&u().createElement(u().Fragment,null,u().createElement("div",{className:"beta_button",onClick:this.handleOpenNow},u().createElement(ye.Z,{iconClass:"icon-zhengshiban"}),u().createElement("span",{className:"button_text"},r("questionn.openNow")))),u().createElement(ee.Z,{options:Je,onChange:this.handleChangePromote,value:oe.promote_status,className:"PostTalentAssessment-select",allowClear:!0,placeholder:r("evaluationManage.pleaseSelectPromote")},Je&&Je.map((Ge,dt)=>u().createElement(ce,{value:Ge.value,key:dt.toString()},Ge.label)))),et==="tool"&&Fe==="true"&&Ae==="platform"&&u().createElement("div",{className:"beta_tips"},"".concat(r("questionn.detailPageRemainTimes")," : ").concat(je," ").concat(r("common.unitfeng"))),u().createElement("div",{className:"content_left_container"},u().createElement("div",{className:"table_container",ref:Ge=>this.tableRef=Ge},u().createElement(Ce,{loading:y,dataSource:rt,onDataTableOperateIconClick:this.handleDataTableOperateIconClick,headerTitle:this.renderLeftRow(),toolBarRender:this.renderRightRow})),ie>0&&u().createElement("div",{className:"pagination_container"},u().createElement(T.Z,lt))))),this.renderEvaluationReportOrLiftingScheme(je),this.renderIsLook(),u().createElement($e.Z,{visible:d,onCancel:this.handleQrcode}))}}Ne.defaultProps={prefixCls:"sticky-table"},Ne.defaultProps={headerShow:!0};var Ke=(0,ge.$j)(Be)((0,me.Z)()(Ne))}}]);
