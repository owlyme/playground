(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[4562],{4408:function(ae,L,t){"use strict";var S=t(12924),B=t.n(S),K=t(28216),o=t(17780),F=t(38642),v=E=>({userInfo:E.user}),W=E=>{var I=E.title;return(0,o.xX)()&&setTimeout(()=>{document.title=I},0),(0,S.useEffect)(()=>{if(I&&document.title!==I&&setTimeout(()=>{document.title=I},0),(0,F.UI)("SCALE")){document.querySelector("body").style.zoom="0.8";var C=document.querySelector(".zoom-report");C&&(C.style.zoom="1.2")}return()=>{localStorage.getItem("name")||(document.querySelector("body").style="")}},[I]),B().createElement(B().Fragment,null)};W.defautProps={title:""},L.Z=(0,K.$j)(v)(W)},43859:function(ae,L,t){"use strict";var S=t(62029),B=t(81211),K=t(43358),o=t(34041),F=t(12924),v=t.n(F),W=t(94184),E=t.n(W),I=t(59239),C=t(55446),u=t.n(C),y=t(6793),j=I.Z.Item,V=o.Z.Option,N=b=>function(p){var g=p.field,l=p.form,_=p.hasFeedback,d=p.label,c=p.selectOptions,A=p.submitCount,M=p.type,Z=p.displayType,T=p.labelCol,D=T===void 0?{}:T,R=p.wrapperCol,G=R===void 0?{}:R,P=p.required,Y=P===void 0?!1:P,$=p.customError,H=$===void 0?!1:$,Q=p.colon,se=Q===void 0?!0:Q,oe=p.formItemClassName,k=(0,B.Z)(p,["field","form","hasFeedback","label","selectOptions","submitCount","type","displayType","labelCol","wrapperCol","required","customError","colon","formItemClassName"]),w=l.touched[g.name],J=A>0,X=l.errors[g.name],q=X&&J,ee=X&&w,te=n=>{var e=n!=null&&n.target?n.target.value:n;l.setFieldValue(g.name,e),l.touched[g.name]||setTimeout(()=>{l.setFieldTouched(g.name,!0)},0)},ne=n=>{var e={},s={},i=n;if(n===void 0&&(i=""),l.setFieldValue(g.name,i),g.name==="courseList"&&n&&Object.prototype.toString.apply(n).slice(8,-1)==="Array"&&n.length>0){e.startTime=n[0].beginTime,s.startTime=Number((0,y.jZ)(n[0].beginTime))+864e5;var r=[];n.forEach(f=>{f.endTime!==""&&r.push(f)}),r.length>0&&l.values.dateRange.endTime?(0,y.jZ)(l.values.dateRange.endTime)>r[r.length-1].endTime?(e.endTime=l.values.dateRange.endTime,s.endTime=Number((0,y.jZ)(l.values.dateRange.endTime))-864e5):r.length>0&&l.values.dateRange.endTime&&(0,y.jZ)(l.values.dateRange.endTime)<=r[r.length-1].endTime&&(e.endTime=r[r.length-1].endTime,s.endTime=Number((0,y.jZ)(r[r.length-1].endTime))-864e5):r.length>0&&!l.values.dateRange.endTime&&(e.endTime=r[r.length-1].endTime,s.endTime=Number((0,y.jZ)(r[r.length-1].endTime))-864e5),r.length>0&&l.setFieldValue("dateRange",e),l.setFieldValue("dateRangeLimit",s)}if(g.name==="stages"&&n&&Object.prototype.toString.apply(n).slice(8,-1)==="Array"&&n.length>0){var m=[];n.forEach(f=>{f.list&&f.list.forEach(h=>{h.componentName==="OfflineTrain"&&m.push(h.data)})}),m.length>0&&(e.startTime=m[0].beginTimeStr,e.endTime=m[m.length-1].endTimeStr,e.startTime=Number((0,y.jZ)(m[0].beginTimeStr))+864e5,e.endTime=Number((0,y.jZ)(m[m.length-1].endTimeStr))-864e5,l.setFieldValue("dateRangeLimit",e))}l.touched[g.name]||setTimeout(()=>{l.setFieldTouched(g.name,!0)},0)},O=()=>l.setFieldTouched(g.name,!0),a=E()(["cl-form__field"]);return v().createElement("div",{className:a},v().createElement(j,{label:d,className:"$$CL-FORM-ERROR__".concat(g.name," antd-field-item ").concat(oe),hasFeedback:!!(_&&J||_&&w),help:(q||ee)&&!H?X:!1,validateStatus:(q||ee)&&!H?"error":"success",labelCol:D,wrapperCol:G,required:Y,colon:se},Z==="Custom"?v().createElement(b,(0,S.Z)({},g,k,{displayType:Z,onBlur:O,onFieldChange:ne})):v().createElement(b,(0,S.Z)({},g,k,{displayType:Z,onBlur:O,onChange:M?te:ne,form:l}),c&&c.map(n=>v().createElement(V,{key:n},n)))))};L.Z=N},50603:function(ae,L,t){"use strict";t.d(L,{Z:function(){return ne}});var S=t(57663),B=t(71577),K=t(12924),o=t.n(K),F=t(91768),v=t(80991),W=t(88983),E=t(47933),I=t(47673),C=t(4107),u=t(88986);class y extends o().Component{constructor(){super(...arguments);this.handleRadioChange=a=>{var n=this.props,e=n.formik,s=n.name,i=a.target,r=i.isOtherOption,m=r===void 0?!1:r,f=i.value;e.setFieldValue(s,(0,u.Z)((0,u.Z)({},e.values[s]),{},{solution:(0,u.Z)((0,u.Z)({},e.values[s].solution),{},{hasOtherOption:m,options:f})}))},this.handleInputChange=a=>{var n=this.props,e=n.formik,s=n.name;e.setFieldValue(s,(0,u.Z)((0,u.Z)({},e.values[s]),{},{solution:(0,u.Z)((0,u.Z)({},e.values[s].solution),{},{otherAnswer:a.target.value})}))}}render(){var a=this.props.defaultFieldList,n=a.options,e=a.solution;return o().createElement(E.ZP.Group,{onChange:this.handleRadioChange,value:e.options},n.map(s=>{var i=s.id,r=s.title,m=s.other;return m?o().createElement(E.ZP,{key:i,value:i,isOtherOption:!0},r,o().createElement(C.Z,{style:{marginLeft:10,width:210},value:e.otherAnswer,onChange:this.handleInputChange})):o().createElement(E.ZP,{key:i,value:i},r)}))}}var j=(0,v.$j)(y);class V extends o().Component{constructor(){super(...arguments);this.handleChange=a=>{var n=this.props,e=n.formik,s=n.name;e.setFieldValue(s,(0,u.Z)((0,u.Z)({},e.values[s]),{},{solution:(0,u.Z)((0,u.Z)({},e.values[s].solution),{},{options:a.target.value})}))}}render(){var a=this.props.defaultFieldList.solution;return o().createElement(C.Z,{value:a.options,onChange:this.handleChange})}}var N=(0,v.$j)(V);class b extends o().Component{constructor(){super(...arguments);this.handleChange=a=>{var n=this.props,e=n.formik,s=n.name;e.setFieldValue(s,(0,u.Z)((0,u.Z)({},e.values[s]),{},{solution:(0,u.Z)((0,u.Z)({},e.values[s].solution),{},{options:a.target.value})}))}}render(){var a=this.props.defaultFieldList.solution;return o().createElement(C.Z.TextArea,{value:a.options,onChange:this.handleChange})}}var z=(0,v.$j)(b),p=t(96433),g=t(33304),l=t(22385),_=t(31097),d=t(17264),c=t.n(d),A=C.Z.TextArea;class M extends o().Component{constructor(){super(...arguments);this.handleChange=(a,n)=>{var e=this.props,s=e.formik,i=e.name;s.setFieldValue(i,(0,u.Z)((0,u.Z)({},s.values[i]),{},{solution:(0,u.Z)((0,u.Z)({},s.values[i].solution),{},{[n]:a})}))}}render(){var a=this.props.defaultFieldList,n=a.solution,e=a.options,s=n.options?parseInt(n.options):0,i=this.props,r=i.question,m=r.instruction,f=r.instruction_must,h=r.must,x=i.t;return o().createElement("div",null,o().createElement("div",{className:c()["score-box"]},o().createElement(_.Z,{title:e[0].title},o().createElement("div",{className:c()["score-title"]},e[0].title)),o().createElement("div",{className:c()["score-rate"]},o().createElement(g.Z,{value:s,count:e.length,onChange:U=>{this.handleChange(U,"options")},tooltips:e.map(U=>U.title)})),o().createElement(_.Z,{title:e[e.length-1].title},o().createElement("div",{className:c()["score-title"]},e[e.length-1].title))),m&&o().createElement(A,{rows:5,maxLength:300,onChange:U=>{this.handleChange(U.target.value,"instruction_content")},placeholder:"".concat(x("learning.scoringExplanation")).concat(h&&f?"\uFF08".concat(x("learning.required"),"\uFF09"):"")}))}}var Z=(0,F.Z)()((0,v.$j)(M)),T=t(63185),D=t(9676);class R extends o().Component{constructor(){super(...arguments);this.handleCheckboxChange=a=>{var n=this.props,e=n.formik,s=n.name,i=e.values[s].options.find(m=>m.other),r=i?i.id:"";e.setFieldValue(s,(0,u.Z)((0,u.Z)({},e.values[s]),{},{solution:(0,u.Z)((0,u.Z)({},e.values[s].solution),{},{hasOtherOption:a.indexOf(r)>-1,options:a.join(",")})}))},this.handleInputChange=a=>{var n=this.props,e=n.formik,s=n.name;e.setFieldValue(s,(0,u.Z)((0,u.Z)({},e.values[s]),{},{solution:(0,u.Z)((0,u.Z)({},e.values[s].solution),{},{otherAnswer:a.target.value})}))}}render(){var a=this.props.defaultFieldList,n=a.options,e=a.solution,s=[];return n.map(i=>{var r=i.id,m=i.title,f=i.other,h=f===void 0?!1:f,x=h?o().createElement(o().Fragment,null,m,o().createElement(C.Z,{style:{marginLeft:10,width:210},value:e.otherAnswer,onChange:this.handleInputChange})):m;s.push({label:x,value:r,other:h})}),o().createElement(D.Z.Group,{options:s,value:e.options.split(","),onChange:this.handleCheckboxChange})}}var G=(0,v.$j)(R),P=t(43859),Y=(0,P.Z)(j),$=(0,P.Z)(N),H=(0,P.Z)(z),Q=(0,P.Z)(Z),se=(0,P.Z)(G),oe=t(3407),k=t(6793),w=(0,k.me)(),J=oe.Z[w].learning.validation,X=O=>{var a,n=O.solution,e=O.isRequired,s=O.instruction,i=O.instruction_must,r=O.type,m=n.hasOtherOption,f=n.options,h=n.otherAnswer,x=n.instruction_content;return e&&((!f.toString().length||m&&!h)&&(a=J.participateInInvestigate),r==="score"&&s&&i&&!x&&(a=J.participateInInvestigate)),a},q=t(19256),ee=t.n(q);class te extends o().Component{constructor(){super(...arguments);this.handlePropsSubmit=()=>{var a=this.props.handleSubmit;a()},this.renderFooter=()=>{var a=this.props,n=a.isSubmitting,e=n===void 0?!1:n,s=a.onCancel,i=a.t;return o().createElement("footer",{className:"cl-form-fixed-footer"},o().createElement("div",{className:"cl-form-fixed-footer__container"},o().createElement(B.Z,{onClick:s},i("common.cancel")),o().createElement(B.Z,{type:"primary",loading:e,onClick:this.handlePropsSubmit},i("common.submit"))))},this.renderContent=()=>{var a=this.props,n=a.questions,e=a.title,s=a.description;return o().createElement(v.l0,{className:"cl-form"},o().createElement("h1",{className:"cl-form-htitle"},e),o().createElement("h4",{className:ee().investigatesDesc},s),n.map(i=>this.renderField(i)))},this.renderField=a=>{var n=this.props,e=n.values,s=n.t,i="".concat(a.type,"_").concat(a.id),r=e[i],m=r.type,f=r.isRequired,h;switch(m){case"single":h=Y;break;case"multiple":h=se;break;case"input":h=$;break;case"textarea":h=H;break;case"score":h=Q;break;default:h=null;break}if(!h)return null;var x=a.type==="single"?"\u3010".concat(s("learning.questionnaireAddToolSingle"),"\u3011"):a.type==="multiple"?"\u3010".concat(s("learning.questionnaireAddToolMul"),"\u3011"):"",U="".concat(x).concat(a.title);return o().createElement(v.gN,{key:i,component:h,label:U,required:f,displayType:"Custom",name:i,defaultFieldList:r,validate:X,question:a})}}render(){var a=this.props.showFooter;return o().createElement(o().Fragment,null,a?this.renderFooter():null,this.renderContent())}}te.defaultProps={showFooter:!0};var ne=(0,F.Z)()(te)},72132:function(ae,L,t){"use strict";t.r(L);var S=t(62029),B=t(20228),K=t(11382),o=t(34792),F=t(48086),v=t(81211),W=t(12924),E=t.n(W),I=t(91768),C=t(76651),u=t(57068),y=t(80991),j=t(50603),V=t(4408),N=t(10237),b=t(37055),z={paperResult:b.ZP.LearningParticipateInInvestigate.paperResult,submit:b.ZP.LearningParticipateInInvestigate.submit};class p extends E().Component{constructor(){super(...arguments);this.state={infos:{},questions:[],initialParams:{},isLoading:!0},this.initData=()=>{var l=u.parse(this.props.location.search),_=l.planId,d=l.investigateId,c=l.studyType,A=c===void 0?"":c,M={study_type:A};N.WY.get({url:z.paperResult({planId:_,investigateId:d}),params:M}).then(Z=>{var T=Z.data,D=T.questions,R=(0,v.Z)(T,["questions"]);this.setState({questions:D,infos:R,initialParams:this.initFormParams(D),isLoading:!1})})},this.initFormParams=function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],_={};return l.forEach(d=>{var c=d.type==="input"&&d.multiple_rows?"textarea":d.type;_["".concat(d.type,"_").concat(d.id)]={id:d.id,solution:{hasOtherOption:!1,options:"",otherAnswer:""},options:d.options,type:c,isRequired:d.is_must==="true",instruction:d.instruction,instruction_must:d.instruction_must}}),_},this.handleSubmit=(l,_)=>{var d=u.parse(this.props.location.search),c=d.planId,A=d.investigateId,M=d.studyType,Z=M===void 0?"":M,T=[];Object.keys(l).forEach(D=>{var R=l[D],G=R.id,P=R.solution,Y=R.type,$={};$.options=P.options,Y==="score"&&($.instruction_content=P.instruction_content),P.hasOtherOption&&($.other_answer=P.otherAnswer),T.push({id:G,solution:$})}),N.WY.post({url:z.submit({planId:c,investigateId:A}),params:{study_type:Z},data:{questions:T}}).then(D=>{D.data.operate_result==="success"&&(F.default.success(this.props.t("common.submitSuccess")),C.m8.goBack()),setTimeout(()=>{_.setSubmitting(!1)},500)}).catch(()=>{F.default.error(this.props.t("common.submitFailure")),setTimeout(()=>{_.setSubmitting(!1),C.m8.goBack()},500)})},this.handleCancel=()=>{C.m8.goBack()}}componentDidMount(){this.initData()}render(){var l=this.props,_=l.prefixCls,d=l.t,c=this.state,A=c.initialParams,M=c.isLoading,Z=c.questions,T=c.infos;return M?E().createElement(K.Z,{size:"large"}):E().createElement("div",{className:_},E().createElement(V.Z,{title:d("documentTitle.participateInResearch")}),E().createElement("div",{className:"".concat(_,"__content")},E().createElement(y.J9,{initialValues:A,onSubmit:this.handleSubmit,render:D=>E().createElement(j.Z,(0,S.Z)({},D,{questions:Z,title:T.title,description:T.description,onCancel:this.handleCancel}))})))}}p.defaultProps={prefixCls:"participate-in-investigate"},L.default=(0,I.Z)()(p)}}]);
