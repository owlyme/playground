(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[3346],{10513:function(Le,ce,t){"use strict";var Se=t(88983),F=t(47933),R=t(22385),Ee=t(31097),he=t(47673),x=t(4107),W=t(62029),me=t(57663),Y=t(71577),r=t(34792),X=t(48086),N=t(12924),v=t.n(N),pe=t(28216),h=t(91768),f=t(76651),ee=t(59239),ve=t(68628),G=t(20560),fe=t(18329),V=t(88311),J=t(37055),q=t(10237),te=t(55446),se=t.n(te),ae=t(84874),Q=t(60667),oe=t(26885),z={labelCol:{xs:{span:4},sm:{span:4}},wrapperCol:{xs:{span:16},sm:{span:16}}};class I extends v().Component{constructor(l){var o;super(l);o=this,this.onCancel=()=>{this.props.onCancel()},this.onOk=()=>{this.save(this.props.saveAndToAdd)},this.onClassifyChange=(a,i)=>{var m=this.state.formError;m.classify=!1,this.setState({classify:a,classifyName:i.name,formError:m})},this.onShowOrgDialog=()=>{var a=this.state.orgDialogConfig;if(!a.visible){var i=localStorage.getItem("authorityType"),m=this.props.user,p=m.appType,C=m.loginMode;p==="wx_app"&&C==="WE_COM"&&i==="1"?this.handleSelectWx():(a.visible=!0,this.setState({orgDialogConfig:a}))}},this.handleSelectWx=()=>{var a=this.props.user,i=this.state.dept.map(p=>p.unionid),m=this.state.user.map(p=>p.unionid||p.userId||p.user_id||p.openUserId);(0,oe.Sk)({userIds:m,deptIds:i}).then(p=>{(0,oe.$f)({result:p,user:a,rangeType:"onlyDeptUser"}).then(C=>{var y=C.qyWeChatVo,u=C.rangeList;this.setState({qyWeChatVo:y},()=>{this.addUserCbk(u)})})}).catch(()=>{this.cancelOrgDialog()})},this.getQuestionBankInfo=()=>{var a=this.props.editQuestionBankId,i=J.ZP.AddQuestionBank.getQuestionBankInfo(),m={id:a};q.WY.get({url:i,params:m}).then(p=>{this.initEditInfo(p.data.data)})},this.initEditInfo=a=>{this.setState({classify:a.courseClassify,classifyName:a.classifyName,name:a.name,scope:a.isAll,dept:a.departmentList.map(i=>({id:i.id,name:i.name,user_count:i.userCount,sourceType:i.sourceType})),user:a.userList.map(i=>({id:i.id,name:i.name,userId:i.userId,sourceType:i.sourceType}))})},this.save=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(o.validate()){var i=o.state,m=i.classify,p=i.scope,C=i.dept,y=i.user,u=i.isClick,M=i.qyWeChatVo,U=o.initRef.state.value,j=o.props,K=j.isEdit,b=j.editQuestionBankId,ue=j.t,ie=K?J.ZP.AddQuestionBank.editQuestionBank():J.ZP.AddQuestionBank.add(),ne={access_token:window.localStorage.getItem("token"),courseClassify:m,name:U,isAll:p,departmentIds:C.map(H=>H.id).join(","),userIds:y.map(H=>H.id).join(","),saveAndToAdd:a},ge=localStorage.getItem("authorityType"),de=o.props.user.appType;de==="wx_app"&&ge==="1"&&(ne.qy_we_chat_vo=M),K&&(ne.id=b),u&&(o.setState({isClick:!1}),q.qg.post({url:ie,data:ne}).then(H=>{H.data.code===0&&(X.default.success(ue(K?"component.editQuestionBankSuccess":"component.addQuestionBankSuccess")),o.props.onOk({id:H.data.data}),a&&f.m8.push("/training/examination/questionBank?id=".concat(H.data.data,"&name=").concat(U)))}).finally(()=>{setTimeout(()=>{o.setState({isClick:!0})},100)}))}},this.validate=()=>{var a=this.state,i=a.classify,m=a.scope,p=a.dept,C=a.user,y=a.formError,u=this.initRef.state.value,M=!0;return i.length===0&&(y.classify=!0,M=!1),u.length===0?(y.nameError=this.props.t("component.pleaseInputBankName"),M=!1):y.nameError="",m===2&&p.length===0&&C.length===0&&(y.scope=!0,M=!1),this.setState({formError:y}),M},this.handleScopeChange=a=>{var i=a.target.value,m=this.state.formError;m.scope=!1,this.setState({scope:i,dept:[],user:[],formError:m})},this.cancelOrgDialog=()=>{var a=this.state.orgDialogConfig;a.visible=!1,this.setState({orgDialogConfig:a,qyWeChatVo:""})},this.addUserCbk=a=>{var i=this.state.orgDialogConfig;i.visible=!1,this.setState({orgDialogConfig:i,dept:a.dept,user:a.user})},this.removeDept=a=>{var i=this.state.dept;i.splice(a,1),this.setState({dept:i})},this.removeUser=a=>{var i=this.state,m=i.user,p=i.qyWeChatVo,C=localStorage.getItem("authorityType"),y=this.props.user.appType;if(m.splice(a,1),y==="wx_app"&&C==="1"){var u=JSON.parse(p);u.userList.splice(a,1),u.selectedUserCount-=1,this.setState({user:m,qyWeChatVo:JSON.stringify(u)})}else this.setState({user:m})},this.getSetting=()=>{q.WY.get({url:J.ZP.advancedSetting.getSettingStatusByType("jurisdiction_setting"),params:{}}).then(a=>{this.setState({resourceViewRange:JSON.parse(a.data.actions)[1].param.checked==="true"})})},this.inputRef=a=>{this.initRef=a},this.state={classify:"",classifyName:"",name:"",scope:1,orgDialogConfig:{title:l.t("component.chooseVisibleScope"),visible:!1,onOk:this.addUserCbk,displayType:["dept"],onCancel:this.cancelOrgDialog},dept:[],user:[],formError:{},resourceViewRange:!1,isClick:!0,qyWeChatVo:""}}componentDidUpdate(l){var o=this.props,a=o.visible,i=o.isEdit;l.visible!==a&&a&&this.setState({classify:"",classifyName:"",name:"",scope:1,dept:[],user:[],formError:{},qyWeChatVo:""},()=>{this.getSetting(),i&&this.getQuestionBankInfo()})}render(){var l=this.state,o=l.name,a=l.scope,i=l.classify,m=l.classifyName,p=l.orgDialogConfig,C=l.dept,y=l.user,u=l.formError,M=l.resourceViewRange,U=this.props,j=U.isEdit,K=U.saveAndToAdd,b=U.t,ue=localStorage.getItem("authorityType"),ie=this.props.user,ne=ie.appType,ge=ie.loginMode,de={okText:b("common.ok"),cancelText:b("common.cancel"),size:"medium",destroyOnClose:!0,bodyStyle:{padding:"0"},maskClosable:!1},H=v().createElement("div",null,v().createElement(Y.Z,{type:"primary",onClick:()=>this.save(!1)},b("common.save")),v().createElement(Y.Z,{type:"primary",onClick:this.onOk},b("component.saveAndAddQuestion")));return K?de.footer=H:de.footer&&delete de.footer,v().createElement(fe.ZP,(0,W.Z)({title:b(j?"component.editQuestionBank":"component.addQuestionBank")},de,{visible:this.props.visible,bodyMask:p.visible,onCancel:this.onCancel,onOk:this.onOk}),v().createElement("div",{className:"add-question-bank"},v().createElement(ee.Z,{className:"add-question-bank-form"},v().createElement(ee.Z.Item,(0,W.Z)({label:b("component.questionBankClassify"),required:!0,validateStatus:u.classify?"error":"",help:u.classify?b("component.pleaseChooseClassify"):""},z),v().createElement(G.Z,{classifyName:m,value:i,onFieldChange:this.onClassifyChange})),v().createElement(ee.Z.Item,(0,W.Z)({label:b("component.questionBankName"),required:!0,validateStatus:u.nameError?"error":"",help:u.nameError},z),v().createElement(x.Z,{className:"add-question-bank-name",ref:this.inputRef,placeholder:b("component.pleaseInputBankName"),defaultValue:o,maxLength:225})),v().createElement(ee.Z.Item,(0,W.Z)({label:b("common.visibleRange"),validateStatus:u.scope?"error":"",help:u.scope?b("component.setQuestionBankScopeTip"):""},z),v().createElement(F.ZP.Group,{onChange:this.handleScopeChange,value:a},v().createElement(F.ZP,{value:1},b("common.allCompany"),M&&v().createElement(Ee.Z,{title:b("setting.selectPeopleTip")},v().createElement("span",null,v().createElement(ve.Z,null)))),v().createElement(F.ZP,{value:2,onClick:this.onShowOrgDialog},b("common.deptAndStu")),v().createElement(F.ZP,{value:3},b("common.onlySeenOwn")))),a===2&&C.length>0?v().createElement("div",{className:"add-question-bank-dept"},v().createElement("div",{className:"dept-label"},b("common.selectedGroups")),v().createElement("div",{className:"dept-list"},C.map((P,Ce)=>v().createElement("div",{key:P.id,className:"dept-list-item"},v().createElement(Q.Z,{dataType:"departmentName",value:P.id,name:P.department_name||P.name,type:P.source_type||P.sourceType}),v().createElement("span",{className:"icon",onClick:()=>this.removeDept(Ce)},v().createElement(ae.Z,{iconClass:"icon-guanbi1",size:"10px"})))))):null,a===2&&y.length>0?v().createElement("div",{className:"add-question-bank-dept"},v().createElement("div",{className:"dept-label"},b("common.selectedUsers")),v().createElement("div",{className:"dept-list"},y.map((P,Ce)=>{var ye=ne==="wx_app"&&ue==="1"?P.unionId||P.userId||P.user_id||P.openUserId:P.user_id||(P==null?void 0:P.userId),re=ne==="wx_app"&&ue==="1"&&ge==="WE_COM"?"wx_sync":P.source_type||P.sourceType;return v().createElement("span",{key:P.id,className:"dept-list-item"},j?v().createElement(Q.Z,{dataType:"userName",value:ye,name:P.name,type:re}):v().createElement(Q.Z,{dataType:"userName",value:ye,name:P.user_name,type:re}),v().createElement("span",{className:"icon",onClick:()=>this.removeUser(Ce)},v().createElement(ae.Z,{iconClass:"icon-guanbi1",size:"10px"})))}))):null),v().createElement(V.Z,(0,W.Z)({},p,{initData:{dept:C,user:y}}))))}}var _=E=>{var l=E.user;return{user:l}};ce.Z=(0,pe.$j)(_)((0,h.Z)()(I))},40238:function(Le,ce,t){"use strict";var Se=t(66456),F=t(55313),R=t(43185),Ee=t(53251),he=t(88983),x=t(47933),W=t(62029),me=t(57663),Y=t(71577),r=t(88986),X=t(34792),N=t(48086),v=t(43358),pe=t(34041),h=t(12924),f=t.n(h),ee=t(91768),ve=t(59239),G=t(55446),fe=t.n(G),V=t(84874),J=t(10237),q=t(37055),te=t(18329),se=t(10513),ae={size:"large",destroyOnClose:!0,bodyStyle:{padding:"0"},maskClosable:!1},Q=ve.Z.Item,oe=pe.Z.Option,z={labelCol:{xs:{span:2},sm:{span:2}},wrapperCol:{xs:{span:16},sm:{span:16}}};class I extends f().Component{constructor(E){var l;super(E);l=this,this.onSearch=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";l.getQuestionLib(o)},this.onCancel=()=>{this.props.onCancel()},this.onOk=()=>{var o=this.state,a=o.selectedLib,i=o.importedList,m=o.fileType,p=this.props,C=p.t,y=p.withAddQuestionBank,u=p.questionBankId,M=p.isMultiple;if(y&&!a){this.setState({showLibErrorTip:!0});return}if(i.length===0){N.default.error(C("component.noImportQuestionTip"));return}var U=q.ZP.ImportQuestion.commit(),j={access_token:window.localStorage.getItem("token"),questionBankId:a||u,newfileName:i.map(K=>K.newfileName).join(","),fileType:m,isMultiple:M};J.qg.post({url:U,data:j}).then(K=>{N.default.success(C("component.successImportQuestionTip")),this.props.onOk(K.data.data)})},this.onDownloadTemplate=()=>{var o=this.state.fileType,a=this.props.isMultiple,i=a===void 0?!1:a;window.location.href="".concat(q.ZP.ImportQuestion.downloadTemplate(),"?access_token=").concat(window.localStorage.getItem("token"),"&fileType=").concat(o,"&isMultiple=").concat(i)},this.onSelectQuestionLib=o=>{this.setState({selectedLib:o,showLibErrorTip:!1})},this.onShowAddQuestionBank=()=>{var o=this.state.addQuestionBankConfig;o.visible=!0,this.setState({addQuestionBankConfig:o})},this.getQuestionLib=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",a=l.props.withAddQuestionBank;if(a){var i=q.ZP.QuestionSelector.getQuestionLib(),m={pageSize:100,pageNumber:1,keyword:o};J.WY.get({url:i,params:m}).then(p=>{l.setState({questionLibList:p.data.data.list})})}},this.beforeUpload=o=>{var a=this.props.t,i=o.size/1024/1024<2;return i||N.default.error(a("component.templateImportLimitTip")),i},this.fileUpload=o=>{o.file&&o.file.response&&o.file.response.code===0?this.setState({importedList:[o.file.response.data],uploadErrMsg:[]}):o.file&&o.file.response&&o.file.response.code===101?this.setState({uploadErrMsg:[o.file.response.data]}):o.file&&o.file.response&&o.file.response.data.errorMessages&&this.setState({uploadErrMsg:o.file.response.data.errorMessages})},this.cancelAddQuestionBank=()=>{var o=this.state.addQuestionBankConfig;o.visible=!1,this.setState({addQuestionBankConfig:o})},this.addQuestionBankCbk=o=>{var a=o.id,i=this.state.addQuestionBankConfig;i.visible=!1,this.setState({selectedLib:a,addQuestionBankConfig:i}),this.getQuestionLib()},this.handleChangeFileType=o=>{var a=this.props.isMultiple,i="".concat(q.ZP.ImportQuestion.import(),"?fileType=").concat(o.target.value,"&isMultiple=").concat(a);this.setState(m=>({fileType:o.target.value,uploadConfig:(0,r.Z)((0,r.Z)({},m.uploadConfig),{},{action:i})}))},this.renderAddQuestionBank=()=>{var o=this.props,a=o.t,i=o.withAddQuestionBank,m=this.state,p=m.showLibErrorTip,C=m.questionLibList,y=m.addQuestionBankConfig,u=m.selectedLib;return i&&f().createElement(f().Fragment,null,f().createElement("div",{className:"import-question-lib"},f().createElement(Q,(0,W.Z)({required:!0,label:a("component.choosedQuestionLib"),validateStatus:p?"error":"",help:p?a("component.chooseQuestionLibTip"):""},z),f().createElement(pe.Z,{placeholder:a("component.pleaseChoose"),showSearch:!0,allowClear:!0,value:u,onSearch:this.onSearch,className:"import-question-lib-select",onChange:this.onSelectQuestionLib,filterOption:(M,U)=>U.props.children.toLowerCase().indexOf(M.toLowerCase())>=0},C.map(M=>f().createElement(oe,{key:M.id,value:M.id},M.name))),f().createElement(Y.Z,{className:"import-question-lib-add",onClick:this.onShowAddQuestionBank},f().createElement(V.Z,{iconClass:"icon-icon_addx"}),a("component.addQuestionBank")))),f().createElement(se.Z,y))},this.state={selectedLib:"",showLibErrorTip:!1,questionLibList:[],importedList:[],uploadConfig:{name:"file",action:"".concat(q.ZP.ImportQuestion.import(),"?fileType=excel&isMultiple=").concat(this.props.isMultiple),showUploadList:!1,data:{access_token:window.localStorage.getItem("token")},beforeUpload:this.beforeUpload,onChange:this.fileUpload},uploadErrMsg:[],addQuestionBankConfig:{visible:!1,onCancel:this.cancelAddQuestionBank,onOk:this.addQuestionBankCbk},fileType:"excel"},this.questionTableColumn=[{title:E.t("component.fileName"),dataIndex:"fileName",key:"newfileName"},{title:E.t("component.successLabel"),dataIndex:"rightCount"},{title:E.t("component.failedLabel"),dataIndex:"errorCount"}]}componentDidUpdate(E){var l=this.props.visible;E.visible!==l&&l&&this.setState({selectedLib:"",questionLibList:[],importedList:[],showLibErrorTip:!1,uploadErrMsg:[]},()=>{this.getQuestionLib()})}render(){var E=this.props.t,l=this.state,o=l.importedList,a=l.uploadConfig,i=l.uploadErrMsg,m=l.addQuestionBankConfig,p=l.fileType;return f().createElement(te.ZP,(0,W.Z)({},ae,{title:E("component.importQuestionLabel"),visible:this.props.visible,bodyMask:m.visible,onCancel:this.onCancel,onOk:this.onOk}),f().createElement("div",{className:"import-question"},this.renderAddQuestionBank(),f().createElement(Q,(0,W.Z)({},z,{required:!0,label:E("component.fileType")}),f().createElement(x.ZP.Group,{className:"import-question-filetype",onChange:this.handleChangeFileType,value:p},f().createElement(x.ZP,{value:"excel"},"Excel"),f().createElement(x.ZP,{value:"word"},"Word"))),f().createElement("div",{className:"import-question-import"},f().createElement(Y.Z,{className:"import-question-import-btn",onClick:this.onDownloadTemplate},f().createElement(V.Z,{iconClass:"icon-icon_donwloadx1"}),E("component.downloadTem")),f().createElement("span",{className:"import-question-import-tip"},E("component.templateImportTip")),f().createElement(Ee.Z,(0,W.Z)({className:"import-question-import-btn right"},a),f().createElement(Y.Z,{type:"primary"},f().createElement(V.Z,{iconClass:"icon-import"}),o.length===0?E("component.importLabel"):E("employeeSummary.reImport")))),f().createElement("div",{className:"import-question-table"},f().createElement(F.Z,{dataSource:o,columns:this.questionTableColumn,bordered:!0,rowKey:C=>C.newfileName,size:"middle",pagination:!1})),i.length>0?f().createElement("div",{className:"import-question-tip"},f().createElement("p",null,f().createElement(V.Z,{iconClass:"icon-tishi"}),E("component.errorTips"),":"),i.map((C,y)=>f().createElement("p",{key:y},C))):null))}}I.defaultProps={visible:!1,questionBankId:"",onCancel:()=>{},onOk:()=>{},withAddQuestionBank:!1,isMultiple:!1},ce.Z=(0,ee.Z)()(I)},73273:function(Le,ce,t){"use strict";var Se=t(62029),F=t(14781),R=t(53431),Ee=t(63185),he=t(9676),x=t(20228),W=t(11382),me=t(57663),Y=t(71577),r=t(34792),X=t(48086),N=t(43358),v=t(34041),pe=t(12924),h=t.n(pe),f=t(91768),ee=t(246),ve=t.n(ee),G=t(18329),fe=t(6793),V=t(87312),J=t(84874),q=t(10237),te=t(37055),se=t(48479),ae=v.Z.Option,Q={size:"large",destroyOnClose:!0,bodyStyle:{padding:"0"},maskClosable:!1};class oe extends h().Component{constructor(I){var _;super(I);_=this,this.onCancel=()=>{var l=this.props.onCancel;l&&this.props.onCancel()},this.onOk=()=>{if(this.state.checkedList.length>this.props.maxNum&&this.props.maxNum>0){X.default.info((0,fe.ZT)(this.props.t("course.insertQuestionMax"),this.props.maxNum));return}if(this.props.onOk){var l=this.state.checkedList.map(o=>({id:o.id,name:o.name,componentName:"QuestionSelector",data:o.data,icon:"",type:"question"}));this.props.onOk(l)}},this.onCheckAll=()=>{var l=this.state,o=l.questionList,a=l.checkedList,i=o.findIndex(m=>!m.isChecked)===-1;o.forEach(m=>{m.isChecked=!i;var p=a.findIndex(C=>m.id===C.id);if(p===-1&&m.isChecked){a.push(m);return}p!==-1&&!m.isChecked&&a.splice(p,1)}),this.setState({questionList:o,checkedList:a})},this.onChangePage=l=>{var o=this.state,a=o.page,i=o.selectQuestionLibKey;a.pageNumber=l,this.setState({page:a},()=>{this.getQuestionList(i)})},this.onSearchLib=l=>{var o=this.state.page;o.pageNumber=1,this.setState({questionLibKeyword:l,questionLibList:[],isSearchLib:l.length>0,page:o},()=>{this.getQuestionLib()})},this.onSearchQuestion=l=>{var o=this.state,a=o.page,i=o.selectQuestionLibKey;a.pageNumber=1,this.setState({questionKeyword:l,page:a},()=>{this.getQuestionList(i)})},this.handleQuestionLibSelect=l=>{var o=this.state.page;o.pageNumber=1,this.setState({selectQuestionLibKey:l,page:o}),this.getQuestionList(l)},this.checkOne=(l,o)=>{var a=[...this.state.checkedList],i=[...this.state.questionList];if(l.isChecked){var m=a.findIndex(p=>p.id===l.id);a.splice(m,1),i[o].isChecked=!1}else i[o].isChecked=!0,a.push(l);this.setState({checkedList:a,questionList:i})},this.compileData=l=>{var o=this.state.checkedList,a=l.map(i=>({id:i.id,name:i.title,typeName:i.typeName,isChecked:o.findIndex(m=>m.id===i.id)!==-1,data:i}));return a},this.getQuestionLib=function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,o=te.ZP.QuestionSelector.getQuestionLib(),a=_.state,i=a.questionLibKeyword,m=a.questionLibList,p=a.selectQuestionLibKey,C=a.isSearchLib,y={keyword:i,pageNumber:l,pageSize:15};_.setState({isLoadingLib:!0}),q.WY.get({url:o,params:y}).then(u=>{_.setState({isLoadingLib:!1,hasMoreLib:u.data.data.hasNextPage,questionLibList:m.concat(u.data.data.list),selectQuestionLibKey:l===1?"":p}),l===1&&!C&&_.getQuestionList("")})},this.getQuestionList=l=>{var o=this.state,a=o.page,i=o.questionKeyword,m=o.filterQuestionLevel,p=o.filterQuestionType,C=te.ZP.QuestionSelector.getQuestionList(),y={questionBankId:l,keyword:i,pageNumber:a.pageNumber,pageSize:a.pageSize,difficulty:m,type:p};this.setState({isLoadingQuestion:!0}),q.WY.get({url:C,params:y}).then(u=>{this.setState({isLoadingQuestion:!1,questionList:this.compileData(u.data.list),paginationData:{total:u.data.total,pages:u.data.pages}})})},this.handleQuestionTypeChange=l=>{var o=this.state,a=o.page,i=o.selectQuestionLibKey;a.pageNumber=1,this.setState({filterQuestionType:l,page:a},()=>{this.getQuestionList(i)})},this.handleQuestionLevelChange=l=>{var o=this.state,a=o.page,i=o.selectQuestionLibKey;a.pageNumber=1,this.setState({filterQuestionLevel:l,page:a},()=>{this.getQuestionList(i)})},this.renderFooter=()=>{var l=this.props.t,o=this.state.checkedList;return h().createElement(h().Fragment,null,h().createElement(Y.Z,{type:"default",onClick:this.onCancel},l("common.cancel")),h().createElement(Y.Z,{type:"primary",onClick:this.onOk},"".concat(l("common.ok")," (").concat(o.length,")")))};var E=I.t;this.state={title:E("component.addQuestionTitle"),questionKeyword:"",questionLibKeyword:"",checkedList:[],questionLibList:[],questionList:[],filterQuestionType:"",filterQuestionLevel:"",paginationData:{},selectQuestionLibKey:"",page:{pageNumber:1,pageSize:10},isLoadingLib:!1,isLoadingQuestion:!1,hasMoreLib:!0,isSearchLib:!1},this.QuestionTypeOptions=[{value:"",label:E("common.all")},{value:1,label:E("component.singleSample")},{value:2,label:E("component.multipleSample")},{value:3,label:E("component.tofSample")},{value:4,label:E("component.blankSample")},{value:5,label:E("component.describeSample")}],this.QuestionLevelOptions=[{value:"",label:E("common.all")},{value:1,label:E("component.questionSimple")},{value:2,label:E("component.questionGeneral")},{value:3,label:E("component.questionDifficult")},{value:4,label:E("component.questionHard")}]}componentDidUpdate(I){var _=this.props,E=_.visible,l=_.defaultChecked,o=_.questionTypeOptions;if(o.length>0){var a=this.QuestionTypeOptions.filter(m=>o.indexOf(m.value)>-1);this.QuestionTypeOptions=[].concat(a)}if(I.visible!==E&&E){var i=[...l];this.setState({checkedList:i,questionKeyword:"",questionLibKeyword:"",filterQuestionType:this.QuestionTypeOptions[0].value,filterQuestionLevel:"",page:{pageNumber:1,pageSize:12},questionLibList:[]},()=>{this.getQuestionLib()})}}render(){var I=this.props.t,_=this.state,E=_.questionLibList,l=_.questionList,o=_.paginationData,a=_.selectQuestionLibKey,i=_.isLoadingQuestion,m=_.isLoadingLib,p=_.hasMoreLib,C=_.isSearchLib,y=_.filterQuestionType;return h().createElement(G.ZP,(0,Se.Z)({},Q,{onCancel:this.onCancel,visible:this.props.visible,title:this.state.title,footer:this.renderFooter()}),h().createElement("div",{className:"question-selector"},h().createElement("div",{className:"question-selector-list"},h().createElement("div",{className:"question-selector-lib"},h().createElement("div",{className:"question-selector-lib-top"},h().createElement(se.Z,{prefixCls:"question-selector-lib-top-search",onSearch:this.onSearchLib,placeholder:I("searchInputPlaceholder.questionBank")})),h().createElement("div",{className:"question-selector-lib-list"},C?null:h().createElement("div",{className:"question-selector-lib-all ".concat(a===""?"active":""),onClick:()=>this.handleQuestionLibSelect("")},I("common.all")),h().createElement(ve(),{pageStart:1,initialLoad:!1,loadMore:this.getQuestionLib,hasMore:!m&&p,useWindow:!1,loader:m?h().createElement("div",{className:"question-selector-loading"},h().createElement(W.Z,null)):null},h().createElement("div",null,E.map(u=>h().createElement("div",{key:u.id,className:a===u.id?"question-selector-lib-list-item active":"question-selector-lib-list-item",onClick:()=>this.handleQuestionLibSelect(u.id)},h().createElement("span",{className:"question-selector-lib-list-icon"},h().createElement(J.Z,{iconClass:"icon-wenjianjia"})),h().createElement("span",{className:"question-selector-lib-list-name"},u.name))))))),h().createElement("div",{className:"question-selector-question"},h().createElement("div",{className:"question-selector-question-top"},h().createElement(v.Z,{defaultValue:y,placeholder:I("component.chooseQuestionType"),className:"question-selector-question-top-type",onChange:this.handleQuestionTypeChange},this.QuestionTypeOptions.map(u=>h().createElement(ae,{key:u.value,value:u.value},u.label))),h().createElement(v.Z,{placeholder:I("component.chooseDifficulty"),className:"question-selector-question-top-level",onChange:this.handleQuestionLevelChange},this.QuestionLevelOptions.map(u=>h().createElement(ae,{key:u.value,value:u.value},u.label))),h().createElement(se.Z,{prefixCls:"question-selector-question-top-search",onSearch:this.onSearchQuestion,placeholder:I("searchInputPlaceholder.question")})),h().createElement("div",{className:"question-selector-question-list"},h().createElement(he.Z,{onClick:this.onCheckAll,checked:l.length>0&&l.findIndex(u=>!u.isChecked)===-1,className:"question-selector-question-item"},h().createElement("span",{className:"question-selector-question-item-title"},I("component.selectPage"))),i?h().createElement("div",{className:"question-selector-loading"},h().createElement(W.Z,null)):null,l.map((u,M)=>{var U=u.id,j=u.isChecked,K=u.data,b=u.name;return h().createElement(he.Z,{value:U,key:U,onClick:()=>this.checkOne(u,M),checked:j,className:"question-selector-question-item"},h().createElement("span",{className:"question-selector-question-item-title"},"\u3010",K.typeName,"\u3011",b))}),l.length===0?h().createElement(V.Z,{className:"no-result"}):null),h().createElement("div",{className:"question-selector-pagination"},h().createElement("span",null,I("component.totalLabel"),h().createElement("b",null,o.pages),I("component.pageLabel"),"\uFF0C",h().createElement("b",null,o.total),I("component.dataItems")),h().createElement(R.Z,{size:"small",pageSize:12,total:o.total,onChange:this.onChangePage,showSizeChanger:!1}))))))}}oe.defaultProps={visible:!1,defaultChecked:[],questionTypeOptions:[],maxNum:-1,onCancel:()=>{},onOk:z=>z},ce.Z=(0,f.Z)()(oe)},39409:function(Le,ce,t){"use strict";t.r(ce),t.d(ce,{default:function(){return Oe}});var Se=t(57663),F=t(71577),R=t(62029),Ee=t(20228),he=t(11382),x=t(88986),W=t(34792),me=t(48086),Y=t(12924),r=t.n(Y),X=t(91768),N=t(80991),v=t(57068),pe=t(66456),h=t(55313),f=t(62350),ee=t(75443),ve=t(77883),G=t(21888),fe=t(43358),V=t(34041),J=t(36546),q=t(44289),te=t(43859),se=t(84874),ae=t(86458),Q=t(6793),oe=ae.Z.DragTableRow,z=V.Z.Option;class I extends r().Component{constructor(){super(...arguments);this.getTableColumn=()=>{var c=this.props.t,s=[{title:c("exam.paperAddthNumber"),dataIndex:"id",key:"id",width:50,render:(e,n,d)=>d+1},{title:c("exam.paperAddthName"),dataIndex:"title"},{title:c("exam.paperAddthType"),dataIndex:"typeName",width:100},{title:c("exam.paperAddthScore"),dataIndex:"score",width:70,render:(e,n)=>{var d;return typeof e=="undefined"?d="/":n.keyNum&&n.scoreType===1?d=(0,Q.Yz)(e*n.keyNum):d=e,d}},{title:c("exam.paperAddthScoreSetting"),width:160,render:(e,n,d)=>{var L=n.type,S=n.scoreType,A=n.score,Z=n.keyNum,O=L===4,k=L===5;return r().createElement("div",{className:"set-score"},O||k?r().createElement(r().Fragment,null,r().createElement(V.Z,{value:S,className:"set-score-select",onChange:T=>this.changeSelcet(T,d)},O?r().createElement(z,{value:1},c("exam.paperAddSecItemDescBlank")):r().createElement(z,{value:1},c("exam.paperAddSecItemDescDesc")),r().createElement(z,{value:2},c("exam.topic"))),r().createElement(G.Z,{precision:1,value:A,min:0,max:99999,className:"set-score-input-short",onChange:T=>this.setQuestionScore(T,d)})):r().createElement(G.Z,{precision:1,value:A,min:0,max:99999,className:"set-score-input",onChange:T=>this.setQuestionScore(T,d)}),O&&S===1?r().createElement("span",null,"*",Z,c("exam.paperAddSecItemDescBlank")):null,k&&S===1?r().createElement("span",null,"*",Z,c("exam.paperAddSecItemDescDesc")):null)}},{title:"".concat(c("exam.missedScoreSetting")),width:160,dataIndex:"multipleMissed",render:(e,n,d)=>{var L=n.type,S=n.missedScore,A=L===2;return A?r().createElement(G.Z,{precision:1,value:S||0,min:0,className:"set-score-input",onChange:Z=>this.setMissedScore(Z,d)}):"/"}},{title:c("exam.paperAddthOperate"),width:70,render:(e,n,d)=>r().createElement(ee.Z,{placement:"top",title:c("common.confirmDeleteTitle"),onConfirm:()=>this.removeQuestion(d)},r().createElement("span",{className:"remove-question-item"},r().createElement(se.Z,{iconClass:"icon-icon_delex"})))}];return s},this.setQuestionScore=(c,s)=>{var e=this.props.value;e[s].score=+c,this.props.onFieldChange(e)},this.setMissedScore=(c,s)=>{var e=this.props.value;e[s].missedScore=+c,this.props.onFieldChange(e)},this.changeSelcet=(c,s)=>{var e=this.props.value;e[s].scoreType=c,this.props.onFieldChange(e)},this.removeQuestion=c=>{var s=this.props,e=s.value,n=s.removeCallBack;e.splice(c,1),this.props.onFieldChange([...e]),n(e)},this.moveRow=(c,s)=>{var e=this.props.value,n=e[c];e.splice(c,1),e.splice(s,0,n),this.props.onFieldChange([...e])}}render(){var c=this.props.value,s=this.getTableColumn();return r().createElement(h.Z,{className:"select-question-table",dataSource:c,columns:s,bordered:!0,rowKey:e=>e.id,size:"small",pagination:!1,onRow:(e,n)=>({index:n,record:e,moveRow:this.moveRow,onMouseEnter:()=>{},onMouseLeave:()=>{}}),components:{body:{row:oe}}})}}var _=(0,te.Z)((0,J.Z5)(q.ZP)((0,X.Z)()(I)));class E extends r().Component{constructor(c){super(c);this.getTotalScore=()=>{var s=this.props,e=s.form,n=s.t,d=e.values.questions,L=0;return d.forEach(S=>{switch(S.type){case 1:case 2:case 3:L+=S.score||0;break;case 4:case 5:S.scoreType===1?L+=(S.score||0)*S.keyNum:L+=S.score||0;break;default:break}}),L?Number(L).toFixed(1):n("exam.paperAddSecItemTotalEmpty")},this.state={}}render(){var c=this.getTotalScore();return r().createElement("span",{className:"total-score-label"},c)}}var l=(0,te.Z)((0,X.Z)()(E));class o extends r().Component{constructor(){super(...arguments);this.getTotalScore=()=>{var c=this.props.form,s=c.values.questions,e=0;return s.forEach(n=>{switch(n.type){case 1:case 2:case 3:e+=n.score;break;case 4:case 5:n.scoreType===1?e+=n.score*n.keyNum:e+=n.score;break;default:break}}),e}}render(){var c=this.props,s=c.value,e=c.onChange,n=c.t,d=this.getTotalScore();return r().createElement("div",{className:"pass-line"},r().createElement(G.Z,{min:10,max:100,value:s,precision:0,onChange:e,className:"pass-line-input"}),"%",r().createElement("span",{className:"pass-line-tip"},(0,Q.ZT)("".concat(n("exam.paperAddSecItemPasslineEg")),d*s?Number(d*s*.01).toFixed(1):0,d?d.toFixed(1):0,s||"")))}}var a=(0,te.Z)((0,X.Z)()(o)),i=t(3407),m=(0,Q.me)(),p=i.Z[m].exam.validation,C={classify:$=>{var c;return $||(c=p.itemPaperClassify),c},questions:$=>{var c=$.filter(e=>e.type===2);if(!$||$.length===0)return p.itemPaperQus;if($.findIndex(e=>typeof e.score=="undefined"||e.score===0)!==-1)return p.itemPaperScore;if(c.length>0){var s=c.find(e=>e.missedScore>e.score);if(s)return p.missedScoreTip}},passLine:$=>{var c;return $||(c=p.itemPaperPassLine),c}},y=t(18329),u=V.Z.Option;class M extends r().Component{constructor(c){super(c);this.onCancel=()=>{this.props.onCancel()},this.onOk=()=>{var s=this.state.questionTypeList;this.props.onOk({singleScore:s[0].score,multipleScore:s[1].score,missedScore:s[1].missedScore,tofScore:s[2].score,blankScore:s[3].score,describeScore:s[4].score,blankType:s[3].scoreType,describeType:s[4].scoreType})},this.computeCount=()=>{var s=this.props.questions,e=0,n=0,d=0,L=0,S=0,A=0,Z=0;return s.forEach(O=>{switch(O.type){case 1:e+=1;break;case 2:n+=1;break;case 3:d+=1;break;case 4:L+=1,A+=O.keyNum;break;case 5:S+=1,Z+=O.keyNum;break;default:break}}),{singleCount:e,multipleCount:n,tofCount:d,blankCount:L,describeCount:S,blankInputCount:A,describeWordCount:Z}},this.setScore=(s,e)=>{var n=this.state.questionTypeList;n[e].score=s,this.setState({questionTypeList:n})},this.setmissedScore=(s,e)=>{var n=this.state.questionTypeList;n[e].missedScore=s,this.setState({questionTypeList:n})},this.changeSelcet=(s,e)=>{var n=this.state.questionTypeList;n[e].scoreType=s,this.setState({questionTypeList:n})},this.state={questionTypeList:[{type:1,label:c.t("examing.single"),scoreUnit:c.t("exam.paperAddSecItemSingleUnit"),count:0,score:0},{type:2,label:c.t("examing.multiple"),scoreUnit:c.t("exam.paperAddSecItemSingleUnit"),count:0,score:0},{type:3,label:c.t("examing.tof"),scoreUnit:c.t("exam.paperAddSecItemSingleUnit"),count:0,score:0},{type:4,label:c.t("examing.blank"),scoreUnit:c.t("exam.paperAddSecItemBlankUnit"),count:0,keyNum:0,score:0,isBlank:!0,scoreType:1},{type:5,label:c.t("examing.describe"),scoreUnit:c.t("exam.paperAddSecItemDescUnit"),count:0,keyNum:0,score:0,isDescribe:!0,scoreType:1}]},this.modalConfig={title:c.t("exam.paperAddthScoreSetting"),size:"medium",destroyOnClose:!0,bodyStyle:{padding:"0"},maskClosable:!1}}componentDidUpdate(c){if(c.visible!==this.props.visible&&this.props.visible){var s=this.computeCount(),e=s.singleCount,n=s.multipleCount,d=s.tofCount,L=s.blankCount,S=s.describeCount,A=s.describeWordCount,Z=s.blankInputCount,O=this.props,k=O.singleScore,T=O.multipleScore,w=O.tofScore,g=O.blankScore,D=O.describeScore,B=this.state.questionTypeList;B[0].count=e,B[0].score=k,B[1].count=n,B[1].score=T,B[2].count=d,B[2].score=w,B[3].count=L,B[3].keyNum=Z,B[3].score=g,B[4].count=S,B[4].keyNum=A,B[4].score=D,this.setState({questionTypeList:B})}}render(){var c=this.props.t,s=this.state.questionTypeList;return r().createElement(y.ZP,(0,R.Z)({},this.modalConfig,{visible:this.props.visible,onCancel:this.onCancel,onOk:this.onOk}),r().createElement("div",{className:"set-question-score"},s.map((e,n)=>r().createElement("div",{className:"set-question-score-item",key:n},r().createElement("span",{className:"set-question-score-item-type"},"\u3010",e.label,"\u3011"),r().createElement("span",{className:"set-question-score-item-count"},c("exam.paperAddSecItemDescCount"),"\uFF1A",e.count),r().createElement("span",{className:"set-question-score-item-score"},e.isBlank||e.isDescribe?r().createElement("span",{className:"set-question-score-item-score__unit"},r().createElement(V.Z,{value:e.scoreType,className:"set-score-select",onChange:d=>this.changeSelcet(d,n)},r().createElement(u,{value:1},e.scoreUnit),r().createElement(u,{value:2},c("exam.paperAddSecItemSingleUnit")))):r().createElement("span",{className:"set-question-score-item-score__unit"},e.scoreUnit,"\uFF1A"),r().createElement(G.Z,{value:e.score,max:999999,min:0,formatter:d=>d===0?0:d,className:"set-question-score-item-score-input",precision:1,onChange:d=>this.setScore(d,n)})),r().createElement("div",{className:"set-question-multiple-missed-score-container"},e.type===2?r().createElement(r().Fragment,null,r().createElement("span",{className:"set-question-score-item-score__unit"},c("exam.missedScoreLabel"),":"),r().createElement(G.Z,{value:e.missedScore||0,max:e.score,min:0,formatter:d=>d===0?0:d,className:"set-question-multiple-missed-score-input",precision:1,onChange:d=>this.setmissedScore(d,n)})):r().createElement("div",{className:"set-question-multiple-missed-score-container"},"/")),r().createElement("span",{className:"set-question-score-item-total"},(0,Q.ZT)("".concat(c("exam.paperAddSecItemDescTotal")),e.keyNum&&e.scoreType===1?Number(e.keyNum*e.score).toFixed(1):Number(e.count*e.score).toFixed(1))))),r().createElement("div",{className:"black_tips"},c("exam.blackTip"))))}}M.defaultProps={visible:!1,questions:[],singleScore:0,multipleScore:0,tofScore:0,blankScore:0,describeScore:0,onCancel:()=>{},onOk:()=>{}};var U=(0,X.Z)()(M),j=t(10237),K=t(37055),b=t(73273),ue=t(40238),ie=t(62615),ne=t(52670),ge=t(86726),de=t(4408),H=t(7584),P=t(70075),Ce=t(2396),ye=t(28531),re={labelCol:{xs:{span:3},sm:{span:3}},wrapperCol:{xs:{span:16},sm:{span:16}}},be={labelCol:{xs:{span:0},sm:{span:0}},wrapperCol:{xs:{span:24},sm:{span:24}}},le=!1,_e=["\u5355\u9009","\u591A\u9009","\u5224\u65AD","\u586B\u7A7A","\u7B80\u7B54"];class Te extends r().Component{constructor(c){super(c);this.onShowQuestionSelector=()=>{var s=this.state.questionSelectorConfig;s.visible=!0,this.setState({questionSelectorConfig:s})},this.onCancelQuestionSelector=()=>{var s=this.state.questionSelectorConfig;s.visible=!1,this.setState({questionSelectorConfig:s})},this.onShowImportQuestion=()=>{var s=this.state.importQuestionConfig;s.visible=!0,this.setState({importQuestionConfig:s})},this.onCancelImportQuestion=()=>{var s=this.state.importQuestionConfig;s.visible=!1,this.setState({importQuestionConfig:s})},this.onShowSetQuestionScore=()=>{var s=this.state,e=s.setQuestionScoreConfig,n=s.questionList;if(n.length===0){me.default.warning(this.props.t("exam.paperSettingQusScoreEmptyMessage"));return}this.setState({setQuestionScoreConfig:(0,x.Z)((0,x.Z)({},e),{},{visible:!0})})},this.onSubmit=(s,e)=>{e.setSubmitting(!0),this.setState({disabled:!0});var n=this.getTotalScore(s.questions),d=s.employeeRange,L=d.rangeType,S=d.rangeList,A=d.qyWeChatVo,Z=le?K.ZP.AddPaper.editSubmit():K.ZP.AddPaper.addSubmit(),O={access_token:window.localStorage.getItem("token"),title:(0,Q.fy)(s.title),summary:s.summary,totalScore:n,passingScore:(0,Q.Yz)(Number(n*s.passLine*.01)),passLine:s.passLine,courseClassify:s.classify,questionVoInfo:JSON.stringify(s.questions.map(g=>{var D=g.score;return(g.type===4||g.type===5)&&g.scoreType===1&&(D=(0,Q.Yz)(g.keyNum*g.score)),g.type===2?{questionId:g.id,score:D,missedScore:g.missedScore||0,scoreType:g.scoreType}:{questionId:g.id,score:D,scoreType:g.scoreType}})),visibleRange:L===1?"all":L===2?"part":"myself",departmentIds:S.dept.map(g=>g.id).join(","),postIds:S.post.map(g=>g.id).join(","),groupIds:S.group.map(g=>g.id).join(","),userIds:S.user.map(g=>g.id).join(","),qy_we_chat_vo:A},k=s.tagGroup?s.tagGroup.tagsNameList?s.tagGroup.tagsNameList:[]:[],T=v.parse(this.props.history.location.search),w=T.paperId;le&&(O.id=this.state.paperId),j.qg.post({url:Z,data:O}).then(g=>{if(g.data.code===2&&me.default.error(g.data.msg),e.setSubmitting(!1),this.setState({disabled:!1}),g.data.code===0){if(me.default.success(le?this.props.t("common.saveSuccess"):this.props.t("common.releaseSuccess")),w){var D={tags:k,resourceId:w,resourceType:"paper"};(0,ye.tB)(D)}else if(k&&k.length){var B={tags:k,resourceId:g.data.data,resourceType:"paper"};(0,ye.tB)(B)}this.linkToList()}}).catch(()=>{e.setSubmitting(!1),this.setState({disabled:!1}),me.default.error(le?this.props.t("common.saveFailure"):this.props.t("common.releaseFailure"))})},this.onCancelEdit=()=>{this.linkToList()},this.addQuestionFromImport=s=>{s.forEach(d=>{d.typeName=_e[d.type-1],(d.type===4||d.type===5)&&(d.scoreType=1)});var e=this.state.importQuestionConfig,n=this.formRef.getFormikBag().values.questions;n=n.concat(s),this.formRef.setFieldValue("questions",n),this.setState({questionList:n,importQuestionConfig:(0,x.Z)((0,x.Z)({},e),{},{visible:!1})})},this.compileQuestion=()=>{var s=this.state.questionList,e=s.map(n=>({id:n.id,name:n.title,componentName:"QuestionSelector",data:n,icon:"",type:"question"}));return e},this.getPaperInfo=s=>{var e=K.ZP.AddPaper.getPaperInfo();j.WY.get({url:e,params:s}).then(n=>{var d=n.data,L=d.title,S=d.summary,A=d.courseClassify,Z=d.courseClassifyName,O=d.totalScore,k=d.passLine,T=d.questionInfo,w=d.visibleRange,g=d.scopes;T.map(D=>(D.typeName=_e[D.type-1],+D.scoreType==2?D.score=(0,Q.Yz)(D.score):D.score=(0,Q.Yz)(D.score/D.keyNum),D.scoreType=+D.scoreType||1,D)),this.setState({initialValues:{title:L,summary:S,classify:A,classifyName:Z,totalScore:O,passLine:k,questions:T,employeeRange:{rangeType:w==="all"?1:w==="part"?2:3,rangeList:{dept:g.departmentList,post:g.postList,group:g.groupList,user:g.userList}}},questionList:T,paperId:s.id,isLoading:!1})})},this.initRef=s=>{this.formRef=s},this.addQuestionFromSelector=s=>{var e=this.state.questionSelectorConfig,n=s.map(d=>d.data.type===4||d.data.type===5?(0,x.Z)((0,x.Z)({},d.data),{},{scoreType:1}):(0,x.Z)({},d.data));this.formRef.setFieldValue("questions",n),this.setState({questionList:n,questionSelectorConfig:(0,x.Z)((0,x.Z)({},e),{},{visible:!1})})},this.removeQuestionFromSelector=s=>{this.setState({questionList:s})},this.cancelSetQuestionScore=()=>{var s=this.state.setQuestionScoreConfig;s.visible=!1,this.setState({setQuestionScoreConfig:s})},this.sureSetQuestionScore=s=>{var e=s.singleScore,n=s.multipleScore,d=s.tofScore,L=s.blankScore,S=s.describeScore,A=s.blankType,Z=s.describeType,O=s.missedScore,k=this.state,T=k.setQuestionScoreConfig,w=k.questionList;T.visible=!1,T.singleScore=e,T.multipleScore=n,T.tofScore=d,T.blankScore=L,T.describeScore=S,T.missedScore=O,w.forEach(g=>{switch(g.type){case 1:g.score=e;break;case 2:g.score=n,g.missedScore=O;break;case 3:g.score=d;break;case 4:g.score=L,g.scoreType=A;break;case 5:g.score=S,g.scoreType=Z;break;default:break}}),this.setState({setQuestionScoreConfig:T,questionList:w}),this.formRef.setFieldValue("questions",w)},this.getTotalScore=s=>{var e=0;return s.forEach(n=>{switch(n.type){case 1:case 2:case 3:e+=n.score;break;case 4:case 5:n.scoreType===1?e+=n.score*n.keyNum:e+=n.score;break;default:break}}),this.formatFloat(e,10)},this.formatFloat=(s,e)=>{var n=Math.pow(10,e);return Math.round(s*n)/n},this.cancelEdit=()=>{this.linkToList()},this.linkToList=()=>{this.props.history.push("/knowledgeBase/examResources/paper")},this.state={allowActions:(0,ge.V9)("classify",JSON.parse(localStorage.getItem("modules"))),paperId:"",questionList:[],disabled:!1,questionSelectorConfig:{visible:!1,onCancel:this.onCancelQuestionSelector,onOk:this.addQuestionFromSelector},importQuestionConfig:{visible:!1,onCancel:this.onCancelImportQuestion,onOk:this.addQuestionFromImport},setQuestionScoreConfig:{visible:!1,singleScore:0,multipleScore:0,tofScore:0,blankScore:0,describeScore:0,onCancel:this.cancelSetQuestionScore,onOk:this.sureSetQuestionScore},isLoading:!0,initialValues:{title:"",classify:"",classifyName:"",summary:"",questions:[],totalScore:0,passLine:"",employeeRange:{rangeType:1,rangeList:{dept:[],post:[],group:[],user:[]}}}}}componentDidMount(){var c=v.parse(this.props.history.location.search),s=c.paperId;if(s){var e={id:s};le=!0,this.getPaperInfo(e)}else this.setState({isLoading:!1})}componentWillUnmount(){le=!1}render(){var c=v.parse(this.props.history.location.search),s=c.paperId,e=this.props.t,n=this.state,d=n.questionList,L=n.questionSelectorConfig,S=n.importQuestionConfig,A=n.setQuestionScoreConfig,Z=n.initialValues,O=n.isLoading,k=n.disabled,T=n.allowActions;if(O)return r().createElement(he.Z,{size:"large"});var w={resourceType:"paper",resourceId:s},g=e(le?"documentTitle.editPaper":"documentTitle.addPaper");return r().createElement("div",{className:"paper-edit"},r().createElement(de.Z,{title:g}),r().createElement("div",{className:"paper-edit-container"},r().createElement("div",{className:"form-page-container"},r().createElement("h1",{className:"form-page-container-title"},le?"".concat(e("common.edit")).concat(e("exam.paperAddTitle")):"".concat(e("common.add")).concat(e("exam.paperAddTitle"))),r().createElement(N.J9,{ref:this.initRef,initialValues:Z,onSubmit:this.onSubmit,render:D=>r().createElement(N.l0,{className:"cl-form"},r().createElement("div",{className:"cl-form__sectitle"},e("exam.basicInformation")),r().createElement(N.gN,(0,R.Z)({name:"title",label:e("exam.paperAddItemName"),required:!0,type:"text",validate:B=>(0,Ce.QK)(B,e("exam.paperAddItemNamePlaceholder")),component:H.Z,maxLength:225,placeholder:e("exam.paperAddItemNamePlaceholder")},re)),r().createElement(N.gN,(0,R.Z)({name:"classify",label:e("exam.paperAddItemClassify"),classifyName:D.values.classifyName,required:!0,displayType:"Custom",validate:ne.ZE,component:ie.O,showAdd:(0,ge.H3)("add",T)},re)),r().createElement(N.gN,(0,R.Z)({name:"summary",maxLength:150,label:e("exam.paperAddItemDesc"),rows:4,placeholder:e("exam.paperAddItemDescPlaceholder"),component:P.Z,type:"text"},re)),r().createElement(N.gN,(0,R.Z)({component:ie.QS,displayType:"Custom",name:"tagGroup",label:e("common.detailTag"),defaultFieldList:w},re)),r().createElement("p",{className:"cl-form__divide padding"}),r().createElement("div",{className:"cl-form__sectitle"},e("exam.paperAddQus"),r().createElement("div",{className:"form-page-container-title-right"},r().createElement(F.Z,{className:"btn-one",onClick:this.onShowQuestionSelector},r().createElement(se.Z,{iconClass:"icon-icon_addx"}),e("exam.paperSelectQus")),r().createElement(F.Z,{className:"btn-one",onClick:this.onShowImportQuestion},r().createElement(se.Z,{iconClass:"icon-icon_donwloadx1"}),e("exam.paperImportQus")),r().createElement(F.Z,{className:"btn-one",onClick:this.onShowSetQuestionScore},r().createElement(se.Z,{iconClass:"icon-icon_editx2"}),e("exam.paperSettingQusScore")))),r().createElement(N.gN,(0,R.Z)({name:"questions",label:"",required:!0,displayType:"Custom",validate:C.questions,component:_,removeCallBack:this.removeQuestionFromSelector},be)),r().createElement("p",{className:"cl-form__divide padding"}),r().createElement("div",{className:"cl-form__sectitle"},e("exam.paperAddSecTotalScore")),r().createElement(N.gN,(0,R.Z)({name:"totalScore",label:e("exam.paperAddSecItemTotal"),component:l},re)),r().createElement(N.gN,(0,R.Z)({name:"passLine",label:e("exam.paperAddSecItemPassline"),required:!0,validate:C.passLine,component:a},re)),r().createElement("div",{className:"form-page-container-tip"},e("exam.paperAddSecItemPasslineNextTip")),r().createElement(N.gN,{component:ie.ww,displayType:"Custom",rangeAuth:!0,name:"employeeRange",defaultFieldList:D.values.employeeRange,secTitle:e("authentication.abilityDetailSecAssignTitle"),validate:ne.FI,mode:["all","part","private"],orgProps:{title:e("component.chooseVisibleScope")},qwTicketShow:!0,onlyChooseDept:!0}),r().createElement(ie.I,null),r().createElement("div",{className:"cl-form-fixed-footer"},r().createElement("div",{className:"cl-form-fixed-footer__container"},r().createElement(F.Z,{className:"form-page-container-bottom-btn",loading:D.isSubmitting,disabled:k,type:"primary",htmlType:"submit"},e(le?"common.save":"common.release")),r().createElement(F.Z,{className:"form-page-container-bottom-btn",disabled:k,onClick:this.onCancelEdit},e("common.cancel")))))}))),r().createElement(b.Z,(0,R.Z)({},L,{defaultChecked:this.compileQuestion()})),r().createElement(ue.Z,(0,R.Z)({},S,{withAddQuestionBank:!0})),r().createElement(U,(0,R.Z)({},A,{questions:d})))}}var Oe=(0,X.Z)()(Te)}}]);
