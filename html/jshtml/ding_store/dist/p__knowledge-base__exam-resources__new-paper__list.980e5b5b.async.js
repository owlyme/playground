(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[4840],{28220:function(ue,F,e){"use strict";e.d(F,{Z:function(){return E}});var D=e(62029),X=e(20228),g=e(11382),C=e(12924),P=e.n(C),j=e(91768),c=e(80991),u={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},G=e(18329),W=e(34773),q=e(52670),J=e(62615);class y extends P().Component{constructor(){super(...arguments);this.initRefFormik=s=>{this.refFormik=s},this.handleBeforeCreate=()=>{var s=this.refFormik;s.submitForm(),s.runValidations().then(O=>{if(!Object.keys(O).length){var h=s.state.values.employeeRange,M=(0,W.N)(h.rangeList),d={qyWeChatVo:h.qyWeChatVo,id:this.props.actionId,isAll:h.rangeType,groupIds:h.rangeType===2?M.groupIds:[],departmentIds:h.rangeType===2?M.deptIds:[],userIds:h.rangeType===2?M.userIds:[],postIds:h.rangeType===2?M.postIds:[],clusterIds:h.rangeType===2?M.clusterIds:[]};this.props.onCreate(d)}})},this.handleBeforeCancel=()=>{var s=this.props.onCancel;s()}}render(){var s=this.props,O=s.visible,h=s.initialParams,M=s.isLoading,d=s.tipInfo,L=s.mode,x=s.onlyChooseDept,A=s.reserveUser,N=A===void 0?[]:A,l=s.t,w=s.title,Q=s.orgProps,z=s.rangeAuth,v=s.projectId,_=s.onCancel,p=s.onlyCreateUser,m=s.size,R=s.okText;return M?P().createElement(g.Z,{size:"large"}):P().createElement(G.ZP,{wrapClassName:"cl-employee-selector-modal",visible:O,title:w||l("examination.visibleRange"),okText:l("common.ok"),cancelText:l("common.cancel"),size:m,onCancel:this.handleBeforeCancel,onOk:this.handleBeforeCreate},M?P().createElement(g.Z,{size:"large"}):P().createElement(c.J9,{ref:this.initRefFormik,initialValues:h,render:f=>P().createElement(c.l0,{className:"cl-form"},P().createElement(c.gN,(0,D.Z)({component:J.Wc,displayType:"Custom",showSectitle:!1,name:"employeeRange",title:w||l("examination.visibleRange"),okText:R||l("common.ok"),label:w||l("examination.visibleRange"),defaultFieldList:f.values.employeeRange,validate:q.WW,mode:L,rangeAuth:z,onlyChooseDept:x,onlyCreateUser:p,orgProps:Q,reserveUser:N,projectId:v,onCancel:_},u)))}),d&&P().createElement("p",{style:{padding:"0 24px",wordBreak:"break-all",whiteSpace:"normal"}},d))}}y.defaultProps={visible:!1,initialParams:{employeeRange:{rangeType:1,rangeList:{departments:[],posts:[],groups:[],users:[],roles:[]}}},tipInfo:"",isLoading:!1,mode:["all","part"],onlyChooseDept:!1,onlyCreateUser:!1,orgProps:{},onCancel:()=>{},onCreate:()=>{},size:"middle"};var E=(0,j.Z)()(y)},11449:function(ue,F,e){"use strict";e.d(F,{Z:function(){return z}});var D=e(88986),X=e(33565),g=e(12924),C=e.n(g),P=e(3115),j=e(49111),c=e(19650),u=e(62029),G=e(57663),W=e(71577),q=e(91768),J=e(28216),y=e(37055),E=e(10237);function r(v){var _=y.ZP.getHelpContentByMenuKey(),p={key:v};return E.WY.get({url:_,params:p})}var s=e(74228),O=e.n(s),h=e(1164),M=e(76466),d=e(38642);class L extends C().Component{constructor(_){var p;super(_);p=this,this.getHelpContentByMenuKey=()=>{var m=this.props.defaultMenuKey;r(m).then(R=>{var f=R.data,U=f.help_url,V=f.video_url;this.setState({videoUrl:V,helpUrl:U})})},this.handleOpenHelpUrl=m=>{if((0,d.ve)()){window.open(m,"_blank");return}h.Z.targetTo({path:m,isExternalLink:!0})},this.handleOpenVideo=function(m){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:p.props.t("helpCenter.video");p.setState(f=>({resourcePlayInfo:(0,D.Z)((0,D.Z)({},f.resourcePlayInfo),{},{resourceInfo:{originUrl:m,source:{FD:m,OD:m},contentType:"mp4"}}),previewInfo:(0,D.Z)((0,D.Z)({},f.previewInfo),{},{title:R,visible:!0,onCancel:p.handleCancelPreview})}))},this.handleCancelPreview=()=>{var m=this.state.previewInfo;this.setState({resourcePlayInfo:{mode:"preview",watchType:"video",resourceInfo:{}},previewInfo:(0,D.Z)((0,D.Z)({},m),{},{visible:!1})})},this.state={helpUrl:"",videoUrl:"",resourcePlayInfo:{autoPlay:!0,draggable:!0,mode:"preview",resourceInfo:{},watchType:"video"},previewInfo:{visible:!1,destroyOnClose:!0,title:_.t("helpCenter.video")||"\u89C6\u9891\u6307\u5BFC",onCancel:()=>{}}}}componentDidMount(){this.getHelpContentByMenuKey()}render(){var _=this.state,p=_.helpUrl,m=_.resourcePlayInfo,R=_.previewInfo,f=_.videoUrl,U=this.props.t;return C().createElement("div",{className:O().helpCenter},f&&C().createElement(W.Z,{type:"link",className:O()["video-btn"],style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenVideo(f)},U("helpCenter.video")),p&&C().createElement(W.Z,{type:"link",style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenHelpUrl(p)},U("helpCenter.tutorial")),C().createElement(M.Z,(0,u.Z)({},m,{previewInfo:R})))}}var x=v=>({defaultMenuKey:v.currentRoute.menuKey});L.defaultProps={defaultMenuKey:""};var A=(0,J.$j)(x)((0,q.Z)()(L));function N(v){var _=v.extra,p=localStorage.getItem("dingPersonnel"),m=sessionStorage.getItem("dingPersonnel");return C().createElement(c.Z,null,_,p!=="dingPersonnel"&&m!=="dingPersonnel"&&(0,d.eY)("COMMONEXTRA_HELP_CENTER")&&C().createElement(A,null))}var l=N,w=e(4408);function Q(v){var _=(0,g.useState)({helpCenter:(0,d.eY)("HEAD_HELP_CENTER_BUT")}),p=(0,X.Z)(_,1),m=p[0],R=v.pageContainerParams,f=R===void 0?{}:R,U=v.noPadding,V=U===void 0?!1:U,k=v.isPersonal,b=k===void 0?!1:k,a=v.pageTitle,T=v.className,S=T===void 0?"":T,$={extra:m.helpCenter?C().createElement(l,{extra:f.extra}):f.extra},ee=(0,D.Z)((0,D.Z)({},f),$);return C().createElement("div",{className:"page-container-content ".concat(V?"page-container-noPadding":""," ").concat(b?"page-container-content_personal_background":""," ").concat(S)},a&&C().createElement(w.Z,{title:a}),b?C().createElement(P.Z,null,v.children):C().createElement(P.Z,ee,v.children))}var z=Q},95535:function(ue,F,e){"use strict";var D=e(57663),X=e(71577),g=e(88986),C=e(22385),P=e(31097),j=e(33565),c=e(12924),u=e.n(c),G=e(91768),W=e(6793),q=e(84874),J=e(18329),y=e(5259),E=e(1164),r=e(99367),s=(0,c.forwardRef)((O,h)=>{var M=O.visible,d=O.resourceId,L=O.operation,x=O.NavLink,A=O.onReferenceList,N=O.onConfirm,l=O.t,w=(0,c.useRef)(),Q=(0,c.useState)(""),z=(0,j.Z)(Q,2),v=z[0],_=z[1],p=(0,c.useState)(""),m=(0,j.Z)(p,2),R=m[0],f=m[1],U=(0,c.useState)([]),V=(0,j.Z)(U,2),k=V[0],b=V[1],a=(0,c.useState)({loading:!0,title:"",tableTotal:0}),T=(0,j.Z)(a,2),S=T[0],$=T[1],ee={pageSize:"page_size",pageIndex:"page_number",pageSizeNum:10,pageIndexNum:1},ae={size:"small",showSizeChanger:!1,showTotal:o=>"".concat(l("historicRecords.altogether")).concat(Math.ceil(o/10)).concat(l("component.pageLabel"),"\uFF0C").concat(o).concat(l("component.dataItems"))},oe={query:o=>ne(o),columns:[{title:l("exam.testName"),dataIndex:"exam_title",render:o=>u().createElement(P.Z,{placement:"topLeft",title:o},u().createElement("div",{className:"cl-text-ellipsis",style:{width:220}},o))},{title:l("exam.attachingTask"),dataIndex:"plan_title",render:o=>u().createElement(P.Z,{placement:"topLeft",title:o},u().createElement("div",{className:"cl-text-ellipsis",style:{width:220}},o))},{title:l("personal.taskType"),dataIndex:"biz_type_name",width:120}]};(0,c.useEffect)(()=>{var o=(0,W.ZT)("".concat(l("component.contentReminder")),l(L==="delete"?"common.delete":L==="update"?"component.update":"common.edit"));_(o);var Z=L==="delete"?l("exam.delReminderTip"):L==="update"?l("exam.editReminderTip"):(0,W.ZT)("".concat(l("component.editReminderTip")),l("exam.paperAddTitle"));f(Z)},[L,l]),(0,c.useImperativeHandle)(h,()=>({initTableList:o=>ve(o)}));var ie=()=>{A&&A(),$((0,g.Z)((0,g.Z)({},S),{},{tableTotal:0})),b([])},de=()=>{N&&(N(k),x&&E.Z.targetTo({path:x}),$((0,g.Z)((0,g.Z)({},S),{},{tableTotal:0})),b([]))},ne=o=>{var Z=(0,g.Z)({},o);return(0,y.fZ)(d,Z)},ve=o=>{$((0,g.Z)((0,g.Z)({},S),{},{loading:!0,tableTotal:0}));var Z={page_number:1,page_size:10};return(0,y.fZ)(o||d,Z).then(H=>{var I=H.data.data;return I.list&&I.list.length===0?!0:($((0,g.Z)((0,g.Z)({},S),{},{loading:!1,tableTotal:I.total})),!1)})};function _e(o,Z){var H=[...k],I=k.findIndex(B=>o.id===B);I===-1&&Z&&H.push(o.id),!Z&&I!==-1&&H.splice(I,1),b(H)}function me(o,Z,H){var I=[...k];o?Z.forEach(B=>{if(B){var Y=I.findIndex(re=>B.id===re);Y===-1&&o&&I.push(B.id)}}):H.forEach(B=>{if(B){var Y=I.findIndex(re=>B.id===re);Y!==-1&&I.splice(Y,1)}}),b(I)}var se=()=>u().createElement("div",null,u().createElement(X.Z,{type:"primary",onClick:ie},l("common.cancel")),u().createElement(X.Z,{type:"primary",onClick:de},l("common.ok"))),pe=S.loading,Ee=S.tableTotal;return u().createElement("div",null,Ee>0?u().createElement(J.ZP,{visible:M,title:v,onCancel:ie,footer:se()},u().createElement("div",{className:"referenceWithOther"},u().createElement("div",{className:"referenceWithOther__tip"},u().createElement("div",{className:"left"},u().createElement(q.Z,{iconClass:"icon-xunwentishi",size:"22px"})),u().createElement("div",{className:"right"},u().createElement("div",{className:"title"},R),u().createElement("div",{className:"desc"},l("exam.upDataReminderTip")))),u().createElement(r.Z,{ref:w,size:"small",uuid:"27259772-ac05-4966-bb75-a4f4e253d072",queryParams:oe,rowSelection:L==="update"?{selectedRowKeys:k,onSelect:_e,onSelectAll:me}:!1,pagerConfig:ee,pagination:ae,options:!1,scroll:{y:400},tableAlertRender:()=>!1,rowClassName:"question-table-row",loading:pe}))):null)});F.Z=(0,G.Z)("translation",{withRef:!0})(s)},50515:function(ue,F,e){"use strict";e.r(F);var D=e(62029),X=e(63185),g=e(9676),C=e(57663),P=e(71577),j=e(34792),c=e(48086),u=e(71194),G=e(57016),W=e(88986),q=e(54029),J=e(62529),y=e(33565),E=e(12924),r=e.n(E),s=e(91768),O=e(28216),h=e(57068),M=e(88560),d=e.n(M),L=e(6793),x=e(5259),A=e(86726),N=e(1164),l=e(99367),w=e(11449),Q=e(48479),z=e(66361),v=e(28220),_=e(95535),p=e(84874),m=e(74689),R=e(54092),f=e(97413),U=e(9925),V=b=>{var a=b.t,T=(0,E.useRef)(),S=(0,E.useRef)(),$=(0,E.useState)([]),ee=(0,y.Z)($,2),ae=ee[0],oe=ee[1],ie=(0,E.useState)(""),de=(0,y.Z)(ie,2),ne=de[0],ve=de[1],_e=(0,E.useState)([""]),me=(0,y.Z)(_e,2),se=me[0],pe=me[1],Ee=(0,E.useState)(!1),o=(0,y.Z)(Ee,2),Z=o[0],H=o[1],I=(0,E.useState)(!1),B=(0,y.Z)(I,2),Y=B[0],re=B[1],Re=(0,E.useState)(a("common.all")),Oe=(0,y.Z)(Re,2),Le=Oe[0],Se=Oe[1],fe=(0,A.V9)("newPaper",b.modules),Ze=(0,E.useState)({visible:!1,NavLink:"",operation:"",resourceId:""}),Te=(0,y.Z)(Ze,2),ge=Te[0],Ae=Te[1],be=(0,E.useState)({visible:!1,paperIds:"",initialParams:{employeeRange:{rangeType:1,rangeList:{departments:[],posts:[],groups:[],users:[]}}}}),Ie=(0,y.Z)(be,2),ce=Ie[0],he=Ie[1],We={query:t=>Ue(t),columns:[{title:a("exam.paperAddItemName"),key:"title",width:300,fixed:"left",render:(t,n)=>{var i=n.title,K=n.id;return(0,A.H3)("preview",fe)?r().createElement(N.Z,{to:"/knowledgeBase/examResources/newPaper/preview?paperId=".concat(K)},r().createElement(m.Z,{overlayClassName:d()["cl-question__tooltips"],placement:"topLeft",width:290,title:i})):r().createElement("span",null,i)}},{title:a("study.type"),key:"type",width:140,filters:[{text:a("myExamTask.all"),value:"all"},{text:a("exam.fixed"),value:"fixed"},{text:a("exam.random"),value:"random"}],filterMultiple:!1,render:(t,n)=>{var i=n.type;return a(i==="fixed"?"exam.fixed":"exam.random")}},{title:a("exam.paperTestNumber"),key:"question_nums",width:110},{title:a("common.creator"),width:106,key:"create_user_name",render:(t,n)=>r().createElement(U.Z,{userId:n.create_user,userName:n.create_user_name})},{title:a("common.createTime"),key:"create_time",width:164,render:(t,n)=>{var i=n.create_time;return(0,L.p6)(Number(i),"yyyy-MM-dd hh:mm")}},{title:a("common.usableRange"),key:"visible_range_type",width:120,render:(t,n)=>{var i=n.visible_range_type;return a(i==="all"?"common.allCompany":"setting.partlyVisible")}},{title:a("common.status"),width:106,key:"status",filters:[{text:a("common.all"),value:"all"},{text:a("common.activatedStr"),value:"enable"},{text:a("common.deactivatedStr"),value:"disable"}],filterMultiple:!1,render:(t,n)=>{var i=n.status;return r().createElement("div",null,r().createElement(J.Z,{color:i==="enable"?"#87d068":"#f50",text:a(i==="enable"?"common.activatedStr":"common.deactivatedStr")}))}},{title:a("common.operate"),key:"operate",width:190,fixed:"right",visibleNum:2,buttons:[{name:a("common.edit"),checkAuth:!0,key:"edit",handleClick:t=>ke(t)},{name:a("common.usableRange"),checkAuth:!0,key:"view",handleClick:t=>Ne(t)},{name:a("common.copy"),checkAuth:!0,key:"copy",handleClick:t=>He(t)},{name:a("common.activatedStr"),key:"on_off",checkAuth:!0,handleClick:t=>Me(t,"enable"),visible:t=>t.status==="disable"},{name:a("common.deactivatedStr"),key:"on_off",checkAuth:!0,handleClick:t=>Me(t,"disable"),visible:t=>t.status==="enable"},{name:a("common.delete"),checkAuth:!0,key:"delete",handleClick:t=>we(t)}]}]};(0,E.useEffect)(()=>{T.current&&T.current.load()},[ne,se,Z]);var Ue=t=>{Be(t);var n=(0,W.Z)({page_number:1,page_size:20,type:"",status:"",keyword:ne,visible_range:Z?"onlyMe":"all",classify_id:se[0]},t);return(0,x.NZ)(n)},Be=t=>{for(var n in t)n==="type"&&t[n]&&(t.type=t[n]==="all"?"":t[n])},Ke=t=>{oe(t)},Ne=t=>{(0,x.C0)(t.id).then(n=>{var i=n.data.data.visible_range_vo,K=i.visible_range_type,le=i.departments_list,Pe=i.posts_list,ye=i.groups_list,te=i.users_list;he({visible:!0,paperIds:[t.id],initialParams:{employeeRange:{rangeType:K==="all"?1:K==="part"?2:3,rangeList:{departments:le,posts:Pe,groups:ye,users:te}}}})})},De=t=>S&&S.current?S.current.initTableList(t):new Promise.resolve,Ce=t=>{Ae((0,W.Z)((0,W.Z)({},ge),{},{visible:!ge.visible,NavLink:"/knowledgeBase/examResources/newPaper/edit?".concat(h.stringify({paperId:t,edit:!0})),resourceId:t||""}))},ke=t=>{var n=t.id;De(n).then(i=>{i?N.Z.targetTo({path:"/knowledgeBase/examResources/newPaper/edit?".concat(h.stringify({paperId:t.id,edit:!0}))}):Ce(n)})},we=t=>{var n=t.id;De(n).then(i=>{var K=a("examination.paper.deleteQuoteTips");i&&(K=a("exam.paperDeleteTip")),G.Z.confirm({title:a("common.tip"),content:K,okText:a("common.ok"),cancelText:a("common.cancel"),onOk:()=>{(0,x.uG)(t.id).then(le=>{le.data.code==="200000"&&c.default.success(a("common.deleteSuccess")),T.current.load()})},onCancel(){}})})},Me=(t,n)=>{G.Z.confirm({title:a("common.tip"),content:a(n==="enable"?"exam.activatedStatus":"exam.deactivatedStatus"),okText:a("common.ok"),cancelText:a("common.cancel"),onOk:()=>{var i=R.b?x.tT:x.Ww;i({paperId:t.id,status:n}).then(K=>{K.data.code==="200000"&&(n==="enable"?c.default.success(a("common.activatedSuccessful")):n==="disable"&&c.default.success(a("common.disabledSuccessful"))),T.current.load()})},onCancel(){}})},He=t=>{(0,x.vV)({paperId:t.id}).then(n=>{n.data.code==="200000"&&c.default.success(a("exam.copySucceed")),T.current.load()})},Fe=t=>{pe([t.id]),Se(t.name)},je=t=>{ne===t?T.current&&T.current.load():ve(t)},ze=()=>{he({visible:!0,paperIds:ae.map(t=>t.replace(/normal|disabled|draft/,"")),initialParams:{employeeRange:{rangeType:1,rangeList:{departments:[],posts:[],groups:[],users:[]}}}})},xe=()=>{he({visible:!1,initialParams:{employeeRange:{rangeType:1,rangeList:{departments:[],posts:[],groups:[],users:[]}}}})},Ve=t=>{var n=ce.paperIds,i=t.isAll,K=t.departmentIds,le=t.groupIds,Pe=t.postIds,ye=t.userIds,te="";switch(i){case 1:te="all";break;case 2:te="part";break;default:te="onlyMe";break}var qe={paper_ids:n,visible_range_vo:{visible_range_type:te,departments_list:K||[],groups_list:le||[],posts_list:Pe||[],users_list:ye||[]}};$e(qe)},$e=t=>{(0,x.qp)(t).then(n=>{n.data.code==="200000"&&(c.default.success(a("examination.batchSetRangeSuccess")),oe([]),xe(),T.current.load())}).catch(n=>{c.default.success("".concat(a("setting.setUpFailure"),": ").concat(n.message))})},Ye=t=>{T.current.load(),N.Z.targetTo({path:"/knowledgeBase/examResources/newPaper/edit?paperId=".concat(t,"&edit=false")})},Ge=t=>{var n=t.target.checked;H(n)},Je=()=>r().createElement("div",{className:d()["top-operate-left"]},(0,A.H3)("add",fe)&&r().createElement(f.E1,{className:d()["btn-opt-item"],onOk:Ye}),(0,A.H3)("view",fe)?r().createElement(P.Z,{disabled:ae.length===0,className:d()["btn-opt-item"],onClick:ze},a("common.usableRange")):null,r().createElement(g.Z,{onChange:Ge,style:{marginLeft:16}},a("common.myCreated"))),Qe=()=>r().createElement("div",null,r().createElement(Q.Z,{onSearch:je,placeholder:a("searchInputPlaceholder.paper"),width:272,LimitLength:15})),Xe=()=>{re(!Y)};return r().createElement(w.Z,{pageContainerParams:{header:{title:a("examination.examPaperManagement")}},pageTitle:a("examination.examPaperManagement")},r().createElement("div",{className:d()["paper-manager"]},r().createElement("div",{className:Y?d()["left-hide"]:d()["paper-manager-left"]},r().createElement(z.Z,{showSearch:!0,isRoot:!0,selectedKeys:se,stickySearch:!0,placeholder:a("common.searchPlaceholder"),onSelect:t=>{Fe(t)},type:"tree"})),r().createElement("div",{className:d()["paper-manager-right"]},r().createElement("div",null,r().createElement("div",{className:Y?d().collapse:d().expand,onClick:Xe},r().createElement(p.Z,{iconClass:"icon-icon_sx1"})),r().createElement("h3",{className:d().classifyName},Le)),r().createElement(l.Z,{uniKey:"newPaper",uuid:"27259772-ac05-4966-bb75-a4f4e253d0e2",ref:T,queryParams:We,rowSelection:{selectedRowKeys:ae,onChange:Ke},pagination:!0,headerTitle:Je(),toolBarRender:Qe})),ce.visible&&r().createElement(v.Z,(0,D.Z)({},ce,{mode:["all","part","private"],orgProps:{title:a("component.chooseVisibleScope")},rangeAuth:!0,isLoading:!ce.visible,onCancel:xe,onCreate:Ve})),r().createElement(_.Z,(0,D.Z)({},ge,{onReferenceList:Ce,onConfirm:Ce,ref:S}))))},k=b=>{var a=b.user;return{modules:a.modules}};F.default=(0,O.$j)(k)((0,s.Z)()(V))}}]);
