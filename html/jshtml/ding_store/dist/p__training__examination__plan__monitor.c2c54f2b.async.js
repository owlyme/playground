(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[8185],{30311:function(xe,te,e){"use strict";var me=e(22385),Z=e(31097),X=e(12924),a=e.n(X),I=e(8812),o=e(28216),O=b=>{var v=(0,o.v9)(B=>{var Q=B.advancedSetting;return{themeColor:Q.themeColor}}),C=v.themeColor;return a().createElement(Z.Z,{placement:"top",title:b.name},a().createElement("span",{className:"cl-table__cell-arrow",onClick:b.onClick},a().createElement("span",{style:{color:C}},b.name),a().createElement("span",{className:"cl-table__cell-arrow-icon"},a().createElement(I.Z,null))))};te.Z=O},30389:function(xe,te,e){"use strict";e.d(te,{Z:function(){return i}});var me=e(62029),Z=e(20228),X=e(11382),a=e(12924),I=e.n(a),o=e(91768),O=e(80991),b={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},v=e(62615),C=e(52670);class B extends I().Component{render(){var d=this.props,M=d.values,T=d.mode,U=d.onlyChooseDept,y=d.reserveUser,re=d.t,se=d.orgProps,K=d.rangeAuth,p=d.projectId,L=d.onCancel,E=d.onlyCreateUser;return I().createElement(O.l0,{className:"cl-form"},I().createElement(O.gN,(0,me.Z)({component:v.ww,displayType:"Custom",showSectitle:!1,name:"employeeRange",label:re("common.visibleRange"),defaultFieldList:M.employeeRange,validate:C.FI,mode:T,rangeAuth:K,onlyChooseDept:U,onlyCreateUser:E,orgProps:se,reserveUser:y,projectId:p,onCancel:L,qwTicketShow:!0},b)))}}var Q=(0,o.Z)()(B),W=e(18329),F=e(34773);class f extends I().Component{constructor(){super(...arguments);this.initRefFormik=d=>{this.refFormik=d},this.handleBeforeCreate=()=>{var d=this.refFormik;d.submitForm(),d.runValidations().then(M=>{if(!Object.keys(M).length){var T=d.state.values.employeeRange,U=(0,F.b)(T.rangeList),y={qyWeChatVo:T.qyWeChatVo,id:this.props.actionId,isAll:T.rangeType,groupIds:T.rangeType===2?U.groupIds.join(","):"",departmentIds:T.rangeType===2?U.deptIds.join(","):"",userIds:T.rangeType===2?U.userIds.join(","):"",postIds:T.rangeType===2?U.postIds.join(","):"",clusterIds:T.rangeType===2?U.clusterIds.join(","):"",qy_we_chat_vo:T.qyWeChatVo};this.props.onCreate(y)}})},this.handleBeforeCancel=()=>{var d=this.props.onCancel;d()}}render(){var d=this.props,M=d.visible,T=d.initialParams,U=d.isLoading,y=d.tipInfo,re=d.mode,se=d.onlyChooseDept,K=d.reserveUser,p=K===void 0?[]:K,L=d.t,E=d.title,g=d.orgProps,S=d.rangeAuth,P=d.projectId,R=d.onCancel,w=d.onlyCreateUser,j=d.size;return U?I().createElement(X.Z,{size:"large"}):I().createElement(W.ZP,{wrapClassName:"cl-employee-selector-modal",visible:M,title:E||L("component.changeUser"),okText:L("common.ok"),cancelText:L("common.cancel"),size:j,onCancel:this.handleBeforeCancel,onOk:this.handleBeforeCreate},U?I().createElement(X.Z,{size:"large"}):I().createElement(O.J9,{ref:this.initRefFormik,initialValues:T,render:ae=>I().createElement(Q,(0,me.Z)({},ae,{mode:re,rangeAuth:S,orgProps:g,onlyChooseDept:se,onlyCreateUser:w,reserveUser:p,projectId:P,onCancel:R}))}),y&&I().createElement("p",{style:{padding:"0 24px",wordBreak:"break-all",whiteSpace:"normal"}},y))}}f.defaultProps={visible:!1,initialParams:{employeeRange:{rangeType:1,rangeList:{dept:[],post:[],group:[],user:[],cluster:[]}}},tipInfo:"",isLoading:!1,mode:["all","part"],onlyChooseDept:!1,onlyCreateUser:!1,orgProps:{},onCancel:()=>{},onCreate:()=>{},size:"middle"};var i=(0,o.Z)()(f)},64549:function(xe,te,e){"use strict";var me=e(12924),Z=e.n(me),X=e(28216),a=e(84874),I=O=>({guideStatus:O.advancedSetting.guideStatus,isNewUser:O.advancedSetting.isNewUser});class o extends Z().Component{constructor(){super(...arguments);this.state={guideIndex:0,showGuide:this.props.renderGuide},this.onNextStep=()=>{var b=this.state.guideIndex,v=this.props.guidePageProps;if(b>=v.length-1){this.onCloseGuide();return}this.setState({guideIndex:b+1})},this.onCloseGuide=()=>{this.setState({showGuide:!1},()=>{this.props.closeGuide&&this.props.closeGuide()}),this.props.isNewUser==="true"&&this.props.dispatch({type:"shouldRenderHeaderGuide",payload:{headerGuideStatus:!0}}),this.updateAllStatus()},this.updateAllStatus=()=>{localStorage.setItem("guideStatus","false"),this.props.dispatch({type:"updateGuideStatus",payload:{guideStatus:"false"}})},this.renderRightItem=b=>Z().createElement(Z().Fragment,null,Z().createElement("div",{className:"clguide-popover__content"},Z().createElement("span",{onClick:this.onCloseGuide},Z().createElement(a.Z,{iconClass:"icon-f-close",size:"12px",color:"#fff"})),Z().createElement("div",{className:"clguide-popover__content__text"},b.contentText),Z().createElement("div",{className:"clguide-popover__content__button",onClick:this.onNextStep},b.buttonText)),Z().createElement("div",{className:"clguide-popover__righttriangle"}),b.typeText&&Z().createElement("div",{className:" clguide-popover__circle"},b.typeText)),this.renderLeftItem=b=>Z().createElement(Z().Fragment,null,Z().createElement("div",{className:" clguide-popover__circle"},b.typeText),Z().createElement("div",{className:"clguide-popover__lefttriangle"}),Z().createElement("div",{className:"clguide-popover__content"},Z().createElement("span",{onClick:this.onCloseGuide},Z().createElement(a.Z,{iconClass:"icon-f-close",size:"12px",color:"#fff"})),Z().createElement("div",{className:"clguide-popover__content__text"},b.contentText),Z().createElement("div",{className:"clguide-popover__content__button",onClick:this.onNextStep},b.buttonText)))}render(){var b=this.state,v=b.guideIndex,C=b.showGuide,B=this.props,Q=B.className,W=B.guideStatus,F=B.guidePageProps,f=F===void 0?[]:F,i=B.direction,pe=i===void 0?"right":i,d=B.showDownloadBtn;return!C&&!W?null:Z().createElement("div",{className:"clguide-popover-container"},C&&W==="true"&&Z().createElement("div",{className:"clguide-popover-mask"}),C&&W==="true"&&v===0&&f.length?Z().createElement("div",{className:"".concat(Q,"_next clguide-popover ").concat(d?"":"right")},pe==="left"?this.renderLeftItem(f[0]):this.renderRightItem(f[0])):null,C&&W==="true"&&v===1&&f.length?Z().createElement("div",{className:"".concat(Q,"_know clguide-popover")},pe==="left"?this.renderLeftItem(f[1]):this.renderRightItem(f[1])):null)}}te.Z=(0,X.$j)(I)(o)},63848:function(xe,te,e){"use strict";var me=e(36877),Z=e(32969),X=e(12924),a=e.n(X),I=e(91768),o=e(56130);class O extends a().PureComponent{constructor(){super(...arguments);this.onChange=(v,C)=>{this.props.onChange(v,C)}}render(){var v=this.props,C=v.value,B=v.classify,Q=v.showLabel,W=v.className,F=v.t,f=v.style;return a().createElement("div",{className:"classify-cascader ".concat(W)},Q?a().createElement("span",{className:"classify-cascader-label"},F("component.selectClassifyLabel")):null,a().createElement(Z.Z,{changeOnSelect:this.props.changeOnSelect,className:"classify-cascader-select ".concat(W),options:B,onChange:this.onChange,placeholder:F("component.selectClassifyLabel"),value:C,style:f,loadData:this.props.loadData}))}}O.defaultProps={showLabel:!0,changeOnSelect:!0,onChange:()=>{}},te.Z=(0,o.Z)((0,I.Z)()(O))},64630:function(xe,te,e){"use strict";var me=e(62029),Z=e(62999),X=e(85733),a=e(12924),I=e.n(a),o=e(91768),O=e(10237),b=e(37055),v=e(25547),C=X.Z.TreeNode;class B extends I().Component{constructor(W){super(W);this.getPostTree=()=>{var F=b.ZP.OrgTree.getPostTree();O.WY.get({url:F}).then(f=>{var i=(0,v.NP)(f.data.posts,{id:"value",post_name:"postName"});this.setState({treeData:i})})},this.handleChange=(F,f,i)=>{this.props.onChange(typeof F=="undefined"?"":F,f,i)},this.renderTreeNodes=F=>F.map(f=>{var i=!0;return this.props.noChildSelect&&(i=f.post_type==="post"),f.children?I().createElement(C,{selectable:!this.props.noChildSelect,title:f.postName,key:f.id,value:f.id,isLeaf:!1,dataRef:f},this.renderTreeNodes(f.children)):I().createElement(C,{selectable:i,title:f.postName,dataRef:f,value:f.id,key:f.id,isLeaf:!0})}),this.renderTreeSelect=()=>{var F=this.props,f=F.t,i=F.defaultValue,pe=i===void 0?[]:i,d=F.multiple,M=d===void 0?!1:d,T=F.width,U=T===void 0?180:T,y={showSearch:!1,style:{width:U},defaultValue:pe,multiple:M,dropdownStyle:{maxHeight:300,overflow:"auto"},placeholder:f("component.choosePostTip"),allowClear:!0,disabled:this.props.disabled};return this.state.treeData.length>0?I().createElement(X.Z,(0,me.Z)({},y,{onChange:this.handleChange,className:this.props.className}),this.renderTreeNodes(this.state.treeData)):I().createElement("div",{style:{textAlign:"center"}})},this.state={treeData:[]}}componentDidMount(){this.getPostTree()}render(){return I().createElement("div",{className:"org-tree-container ".concat(this.props.className)},this.renderTreeSelect())}}B.defaultProps={disabled:!1,onChange:()=>{}},te.Z=(0,o.Z)()(B)},54792:function(xe,te,e){"use strict";var me=e(62029),Z=e(63185),X=e(9676),a=e(47673),I=e(4107),o=e(88986),O=e(12924),b=e.n(O),v=e(91768),C=e(59239),B=e(55446),Q=e.n(B),W=e(18329),F=e(2396);class f extends b().Component{constructor(){super(...arguments);this.state={isChecked:!1},this.handleBeforeCreate=()=>{var d=this.props,M=d.form,T=d.id,U=d.onCreate,y=this.state.isChecked;M.validateFields((re,se)=>{if(!re){var K=(0,o.Z)({},se);y||(K.value=0);var p=(0,o.Z)((0,o.Z)({},K),{},{id:T});U(p),setTimeout(()=>{M.resetFields()},100)}})},this.handleBeforeCancel=()=>{var d=this.props,M=d.form,T=d.onCancel;T(),setTimeout(()=>{M.resetFields()},100)},this.checkScore=(d,M,T)=>{var U=this.props.t,y=this.state.isChecked;if(y&&(0,F.kh)(M)){T(U("component.setScoreRuleTip"));return}T()},this.handleCheckChange=d=>{this.setState({isChecked:d.target.checked})},this.renderItem=()=>{var d=this.props,M=d.form,T=d.initialValue,U=d.labelTxt,y=this.state.isChecked,re=M.getFieldDecorator,se={labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:18}}},K=y?re("value",{initialValue:T,rules:[{validator:this.checkScore}]})(b().createElement(I.Z,{maxLength:30,placeholder:""})):null,p=b().createElement(b().Fragment,null,b().createElement(X.Z,{checked:y,onChange:this.handleCheckChange},U));return b().createElement(C.Z.Item,(0,me.Z)({label:p},se),K)}}componentDidUpdate(d){this.props.visible&&this.props.visible!==d.visible&&this.setState({isChecked:!!this.props.initialValue})}render(){var d=this.props,M=d.visible,T=d.title,U=d.prefixCls;return b().createElement(W.ZP,{size:"small",visible:M,title:T,onCancel:this.handleBeforeCancel,onOk:this.handleBeforeCreate},b().createElement(C.Z,{className:"".concat(U),layout:"horizontal",colon:!1},this.renderItem(),b().createElement("div",{className:"".concat(U,"__children")},this.props.children)))}}f.defaultProps={prefixCls:"cl-setscore",id:"",visible:!1,title:"SetScore",labelTxt:"",initialValue:"",onCancel:()=>{},onCreate:()=>{}};var i=C.Z.create({name:"ClSetupBoxInModal"})(f);te.Z=(0,v.Z)()(i)},47745:function(xe,te,e){"use strict";e.d(te,{Z:function(){return p}});var me=e(34792),Z=e(48086),X=e(88986),a=e(57663),I=e(71577),o=e(71153),O=e(60331),b=e(12924),v=e.n(b),C=e(91768),B=e(76651),Q=e(87722);class W extends v().Component{constructor(){super(...arguments);this.handleTimeRange=E=>{var g=E.startTime,S=E.endTime,P=E.dateStrings;if(!P.filter(w=>w).length){this.props.handleChangeDataRange({startTime:"",endTime:""});return}var R={startTime:g,endTime:S};this.props.handleChangeDataRange(R)}}render(){return v().createElement("div",{className:"exam-grades__query"},v().createElement(Q.Z,{timestamp:!0,showTime:!0,format:"YYYY-MM-DD HH:mm",onCustomChange:this.handleTimeRange}))}}var F=(0,C.Z)()(W),f=e(84391),i=L=>{var E=L.t,g=L.shouldRenderExport;return v().createElement("div",{className:"exam-grades__query"},g&&v().createElement(I.Z,{type:"primary",onClick:L.handleExport},v().createElement(f.Z,null),E("common.exportData")))},pe=(0,C.Z)()(i),d=e(38642),M=e(10237),T=e(37055),U=e(6793),y=e(18329),re=e(95664),se=e(36202);class K extends v().Component{constructor(E){super(E);this.getTableColumns=()=>{var g=[{title:this.props.t("personal.submitTime"),dataIndex:"planId",key:"planId",width:160,render:(w,j)=>v().createElement("span",{className:"exam-grades__table__cell"},(0,U.p6)(j.commit_time,"yyyy-MM-dd hh:mm:ss"),j.score_rule===1?v().createElement(O.Z,{color:"#CF3C3C"},this.props.t("myExamTask.highest")):null,j.score_rule===2?v().createElement(O.Z,{color:"#FFA000"},this.props.t("myExamTask.newest")):null)},{title:this.props.t("examing.examTotalScore"),dataIndex:"total_score",key:"total_score",width:100},{title:this.props.t("myExamTask.score"),dataIndex:"score",key:"score",width:100,render:(w,j)=>j.status===5?"--":w},{title:this.props.t("exam.examTime"),dataIndex:"duration",key:"duration",width:100,render:w=>(0,U.xj)(w)},{title:this.props.t("exam.examResult"),dataIndex:"result",key:"result",width:120},{title:this.props.t("common.operate"),width:100,key:"operate",render:w=>this.props.type==="user"?this.userOperation(w):this.adminOperation(w)}],S={title:this.props.t("exam.marker"),width:100,dataIndex:"marker_name",key:"marker_name"},P=this.props.type,R=P===void 0?"admin":P;return R==="admin"&&g.splice(4,0,S),g},this.userOperation=g=>v().createElement(b.Fragment,null,g.view_rule===0&&v().createElement(I.Z,{type:"link",size:"small",disabled:!0},this.props.t("common.viewDetails")),g.view_rule===1&&v().createElement(I.Z,{type:"link",size:"small",onClick:()=>this.viewDetails(g)},this.props.t("myExamTask.answerAnalytics")),g.view_rule===2&&v().createElement(I.Z,{type:"link",size:"small",onClick:()=>this.viewDetails(g)},this.props.t("exam.viewRightAndWrong"))),this.adminOperation=g=>v().createElement(b.Fragment,null,g.status===5?v().createElement("div",{className:"cl-table__cell-action"},v().createElement("span",{className:"cl-pointer cl-disabled"}," ",this.props.t("common.viewDetails"))):v().createElement("div",{className:"cl-table__cell-action",onClick:()=>this.viewDetails(g)},v().createElement("span",{className:"cl-pointer"}," ",this.props.t("common.viewDetails")))),this.viewDetails=g=>{var S=g.user_id,P=g.plan_id,R=g.makeup_count,w=this.props,j=w.pageFrom,ae=w.taskId,le=w.type,oe=le===void 0?"admin":le,ie="";oe==="admin"?ie="/training/examination/result?pageFrom=examMonitor&id=".concat(P,"&userId=").concat(S,"&makeupCount=").concat(R):j==="myObligatoryTask"?ie="/training/examination/result/personal?fromPage=myObligatoryTask&id=".concat(P,"&userId=").concat(S,"&taskId=").concat(ae,"&makeupCount=").concat(R):j==="myExamTask"?ie="/training/examination/result/personal?pageFrom=myExamTask&id=".concat(P,"&userId=").concat(S,"&makeupCount=").concat(R):ie="/training/examination/result/personal?id=".concat(P,"&userId=").concat(S,"&makeupCount=").concat(R),oe==="admin"?B.m8.push(ie):(0,d.eJ)({url:ie})},this.initTableList=()=>{var g=this.props.planId;M.WY.get({url:T.ZP.ExaminationPlanMonitor.getExamAllGrades(g),params:(0,X.Z)({},this.state.params)}).then(S=>{setTimeout(()=>{this.setState({showList:!0,loading:!1,tableList:S.data.list,tableTotal:Number(S.data.total),tableTotalPages:S.data.pages})},300)}).catch(()=>{this.setState({showList:!1,loading:!1}),this.props.hideEveryExamGrade()})},this.handleTableChange=g=>{var S=this.state.params;S.page_number=g,this.setState({params:S},()=>{this.initTableList()})},this.handleChangeDataRange=g=>{this.setState(S=>({params:(0,X.Z)((0,X.Z)({},S.params),{},{commit_time_start:g.startTime,commit_time_end:g.endTime})}),()=>{this.initTableList()})},this.handleExport=()=>{var g=this.props,S=g.t,P=g.planId,R=T.ZP.ExaminationPlanMonitor.exportExamAllGrades(P),w=this.state.params,j=w.commit_time_start,ae=w.commit_time_end,le=w.user_id;R+="?access_token=".concat(window.localStorage.getItem("token"),"&commit_time_start=").concat(j,"&commit_time_end=").concat(ae)+"&user_id=".concat(le),window.location.href=R,Z.default.success(S("study.exportSucceed"))},this.onCancel=()=>{this.props.hideEveryExamGrade()},this.renderFooter=()=>{var g=this.props.t;return v().createElement(I.Z,{type:"primary",onClick:this.onCancel},g("common.cancel"))},this.renderLeftRow=()=>v().createElement(F,{handleChangeDataRange:this.handleChangeDataRange}),this.renderRightRow=()=>{var g=this.props.type,S=g===void 0?"admin":g;return v().createElement(pe,{shouldRenderExport:S==="admin",handleExport:this.handleExport})},this.state={loading:!0,params:{commit_time_start:"",commit_time_end:"",user_id:"",page_number:1,page_size:10},tableList:[],tableTotal:0,tableTotalPages:0,showList:!1}}componentDidUpdate(E){this.props.visible&&this.props.visible!==E.visible&&this.props.userId&&this.setState({params:{commit_time_start:"",commit_time_end:"",user_id:this.props.userId,page_number:1,page_size:10,task_id:this.props.taskId},tableList:[],tableTotal:0,tableTotalPages:0},()=>{this.initTableList()})}render(){var E=this.props,g=E.visible,S=E.t,P=E.planTitle,R=this.state,w=R.showList,j=R.loading,ae=R.params,le=R.tableList,oe=R.tableTotal,ie=R.tableTotalPages;return v().createElement("div",null,g&&w?v().createElement(y.ZP,{size:"large",visible:g,title:S("exam.examDetails"),onCancel:this.onCancel,onOk:this.onCancel,footer:this.renderFooter()},v().createElement("div",{className:"exam-grades"},v().createElement("div",{className:"exam-grades__title"},P),v().createElement(se.f,{bordered:!0,columns:this.getTableColumns(),rowKey:"makeup_count",dataSource:le,pagination:!1,loading:j,headerTitle:this.renderLeftRow(),toolBarRender:this.renderRightRow,tableUUID:"a7d5cb8a-163d-4795-953e-ae47d83ee50d"}),v().createElement(re.Z,{defaultPageSize:10,totalNum:oe,totalPage:ie,current:ae.page_number,showRenderRefresh:!1,onChange:this.handleTableChange}))):null)}}var p=(0,C.Z)()(K)},27550:function(xe,te,e){"use strict";var me=e(57663),Z=e(71577),X=e(63185),a=e(9676),I=e(43358),o=e(34041),O=e(88983),b=e(47933),v=e(12924),C=e.n(v),B=e(28216),Q=e(91768),W=e(49101),F=e(84391),f=e(1164),i=e(48479),pe=e(2971),d=e(45601),M=e(7249),T=e(64549),U=e(31945),y=se=>{var K=se.user,p=se.currentRoute,L=se.advancedSetting;return{currentPath:p.path,allAuthRoutes:p.allAuthRoutes,userLng:K.lng,themeColor:L.themeColor}};class re extends C().Component{constructor(K){super(K);this.setPlaceholder=()=>{var p=this.props,L=p.currentPath,E=p.allAuthRoutes,g=p.userLng,S=this.state.language,P=E[L];if(!!P){var R=S[g].searchInputPlaceholder,w="";P.menuKey==="studyTemplate"||P.menuKey==="examTemplate"?w=R.template:P.menuKey==="management"||P.menuKey==="employee"||P.menuKey==="obligatory"||P.menuKey==="elective"||P.menuKey==="plan"||P.menuKey==="evaluation"||P.menuKey==="myEvaluationPlan"?w=R.task:w=R[P.menuKey],this.setState({currentPlaceholder:w})}},this.handleRadiosChange=p=>{this.props.onRadiosChange(p.target.value)},this.handleSelectChange=p=>{this.props.onSelectChange(p)},this.handleSearch=p=>{this.props.onSearch(p)},this.handleChange=p=>{this.props.onCheckboxChange(p.target.checked)},this.handleDownload=()=>{this.props.onDownload()},this.renderRadios=()=>{var p=this.props,L=p.prefixCls,E=p.radioList,g=p.defaultRadioValue,S=p.radioValue;if(!E.length)return null;var P=g||E[0].value,R="".concat(L,"__radios");return C().createElement("div",{className:R},typeof S!="undefined"?C().createElement(b.ZP.Group,{defaultValue:P,value:S,onChange:this.handleRadiosChange},E.map(w=>C().createElement(b.ZP.Button,{key:w.value,value:w.value},w.name))):C().createElement(b.ZP.Group,{defaultValue:P,onChange:this.handleRadiosChange},E.map(w=>C().createElement(b.ZP.Button,{key:w.value,value:w.value},w.name))))},this.renderSelect=()=>{var p=this.props,L=p.prefixCls,E=p.selectList,g=p.defaultSelectValue;if(!E.length)return null;var S=g||E[0].value,P="".concat(L,"__select");return C().createElement("div",{className:P},C().createElement(o.Z,{defaultValue:S,onChange:this.handleSelectChange,getPopupContainer:()=>document.getElementsByClassName("cl-listQueryRow__select")[0],style:{minWidth:100}},E.map(R=>C().createElement(o.Z.Option,{key:R.value,value:R.value},R.name))))},this.renderOther=()=>{var p=this.props,L=p.prefixCls,E=p.renderOther,g=p.showOther,S="".concat(L,"__other");if(g&&E&&typeof E=="function")return C().createElement("div",{className:S},E())},this.renderCheckbox=()=>{var p=this.props,L=p.prefixCls,E=p.t,g=p.label,S=p.showCheckbox,P=p.renderActionSelect,R="".concat(L,"__checkbox");return!S&&P&&typeof P=="function"?C().createElement("div",{className:R},P()):S?C().createElement("div",{className:R},C().createElement(a.Z,{onChange:this.handleChange},g||E("common.myCreated"))):null},this.renderSearch=()=>{var p=this.props,L=p.prefixCls,E=p.showSearch,g=p.inputPlaceholder,S=p.maxLength,P=S===void 0?400:S,R="".concat(L,"__search");if(!E)return null;var w=this.state.currentPlaceholder;return g?C().createElement("div",{className:R},C().createElement(i.Z,{onSearch:this.handleSearch,placeholder:g,width:272,maxLength:P})):C().createElement("div",{className:R},C().createElement(i.Z,{onSearch:this.handleSearch,placeholder:w,width:272,maxLength:P}))},this.renderActionBtn=()=>{var p=this.props,L=p.prefixCls,E=p.actionText,g=p.t,S=p.tabLink,P=p.showBtn,R=p.renderActionBtn,w=p.popOverProps,j=w===void 0?[]:w,ae=p.renderGuide,le=ae===void 0?!1:ae,oe=p.showDownloadBtn,ie=oe===void 0?!1:oe,Ee=p.guideClassName,Ze=Ee===void 0?"guide-popover":Ee,fe=p.themeColor,m="".concat(L,"__action");return!P&&R&&typeof R=="function"?C().createElement("div",{className:m},R()):!P||!E?null:C().createElement("div",{className:m},C().createElement(f.Z,{to:S},C().createElement(Z.Z,{type:"primary",icon:C().createElement(W.Z,null)},E)),C().createElement(T.Z,{className:Ze,renderGuide:le,guidePageProps:j,direction:"left",showDownloadBtn:ie}),ie&&C().createElement(Z.Z,{style:{marginLeft:"8px",color:fe,border:"1px solid ".concat(fe)},icon:C().createElement(F.Z,null),onClick:this.handleDownload},g("common.exportData")))},this.renderQueryRow=()=>{var p=this.props,L=p.queryRowParams,E=p.queryRowList,g=p.queryRowSelectedCourseIds,S=p.queryRowSelectedProjectIds,P=p.queryRowOnForceRender,R=p.queryRowOnClassifyChange,w=p.queryRowOnTypeChange,j=p.queryRowOnCourseTypeChange,ae=p.queryRowAllowActions;return C().createElement(U.Z,{params:L,list:E,selectedCourseIds:g,selectedProjectIds:S,onForceRender:P,onClassifyChange:R,onTypeChange:w,onCourseTypeChange:j,allowActions:ae,showRenderCondition:!1})},this.rendeExtraBtn=()=>{var p=this.props,L=p.t,E=p.extraBtnSelectedRowKeys,g=p.extraBtnHandleMultiVisibleRange;return C().createElement(Z.Z,{disabled:E.length===0,onClick:g},L("courseManage.setTheVisibility"))},this.state={language:{zh_cn:d.Z,en_us:pe.Z,zh_hk:M.Z},currentPlaceholder:""}}componentDidMount(){this.setPlaceholder()}componentDidUpdate(K){K.userLng!==this.props.userLng&&this.setPlaceholder()}render(){var K=this.props,p=K.prefixCls,L=K.wrapCls,E=K.showRenderRadios,g=E===void 0?!0:E,S=K.showRenderQueryRow,P=K.showRendeExtraBtn,R=K.showRenderSelect;return C().createElement(C().Fragment,null,C().createElement("div",{className:"render_other"},this.renderOther(),C().createElement("header",{className:"".concat(p," ").concat(L)},C().createElement("section",{className:"".concat(p,"__radiocol")},this.renderActionBtn(),S&&this.renderQueryRow(),P&&this.rendeExtraBtn()),C().createElement("section",{className:"".concat(p,"__searchcol")},this.renderCheckbox(),g&&this.renderRadios(),R&&this.renderSelect(),this.renderSearch()))))}}re.defaultProps={prefixCls:"cl-listQueryRow",wrapCls:"",label:"",actionText:"add",showRadioList:!0,showCheckbox:!0,showSearch:!0,showBtn:!0,inputPlaceholder:"",defaultRadioValue:"",radioList:[],searchStylesProps:{},showRenderSelect:!1,selectList:[],renderActionBtn:()=>null,onRadiosChange:()=>{},onSearch:()=>{},onCheckboxChange:()=>{}},te.Z=(0,B.$j)(y)((0,Q.Z)()(re))},83431:function(xe,te,e){"use strict";var me=e(30887),Z=e(99210),X=e(22385),a=e(31097),I=e(12924),o=e.n(I),O=e(91768),b=e(57119),v=e(28216),C=Q=>{var W=Q.user;return{loginMode:W.loginMode}};function B(Q){var W=Q.onUrge,F=Q.onDing,f=Q.t,i=localStorage,pe=i.appType,d=f(pe==="wx_app"?"component.ordinaryUrgingWxTips":pe==="fs_app"?"component.ordinaryUrgingFsTips":"component.ordinaryUrgingTips");return o().createElement(Z.Z,null,o().createElement(Z.Z.Item,{key:"1"},o().createElement(a.Z,{title:d},o().createElement("div",{className:"urge-menu-item",onClick:W},o().createElement("span",{className:"urge-menu-item__text"},f("component.ordinaryUrging")),o().createElement(b.Z,null)))),pe==="e_app"?o().createElement(Z.Z.Item,{key:"2"},o().createElement(a.Z,{title:f("component.dingStudentsTips")},dd.version?o().createElement("div",{className:"urge-menu-item",onClick:F},o().createElement("span",{className:"urge-menu-item__text"},f("component.dingStudents")),o().createElement(b.Z,null)):o().createElement("div",{className:"urge-menu-item__forbidden"},o().createElement("span",{className:"urge-menu-item__text"},f("component.dingStudents")),o().createElement(b.Z,null)))):null)}te.Z=(0,v.$j)(C)((0,O.Z)()(B))},50997:function(xe,te,e){"use strict";e.d(te,{Z:function(){return at}});var me=e(81211),Z=e(57663),X=e(71577),a=e(88986),I=e(12924),o=e.n(I),O=e(91768),b=e(18329),v=e(51975),C="WORKFLOW_STATUS_CHOOSE",B="WORKFLOW_STATUS_ORIGINAL",Q="WORKFLOW_STATUS_CUSTOM",W="WORKFLOW_STATUS_CUSTOM_CONFIRM",F="ACTION_TYPE_ORIGINAL",f="ACTION_TYPE _CUSTOM",i="CUSTOM_QUERY_FLUNK",pe="CUSTOM_QUERY_MISS",d={footer:null,workflowStatus:C,actionType:F,refOriginal:null,refCustom:null,customSelectedRows:[],customDateRange:{startTime:"",endTime:""},changeworkflowStatus:()=>{},changeActionType:()=>{},initRefOriginal:()=>{},initRefCustom:()=>{},changeSelectedRows:()=>{},changeCustomDateRange:()=>{}},M=o().createContext(d),T=e(80991),U=e(62029),y=e(88983),re=e(47933),se=e(43859);class K extends o().Component{constructor(){super(...arguments);this.handleChange=n=>{var l=n.target.value;this.context.changeActionType(l),this.props.formik.setFieldValue("actionType",l)}}render(){var n=this.props,l=n.defaultFieldList,u=n.t;return o().createElement(re.ZP.Group,{value:l,onChange:this.handleChange},o().createElement(re.ZP,{value:F},u("exam.supplementActionOriginal")),o().createElement(re.ZP,{value:f},u("exam.supplementActionCustom")))}}K.contextType=M;var p=(0,v.l)(M,K),L=(0,O.Z)()((0,se.Z)((0,T.$j)(p))),E={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}};class g extends o().Component{render(){var n=this.props,l=n.values,u=n.t;return o().createElement(T.l0,{className:"cl-form"},o().createElement(T.gN,(0,U.Z)({component:L,displayType:"Custom",name:"actionType",label:u("exam.makeupUsers"),required:!0,defaultFieldList:l.actionType},E)))}}var S=(0,O.Z)()(g);class P extends o().Component{constructor(n){super(n);this.state={initialParams:{actionType:n.contextData.actionType}}}render(){var n=this.props.prefixCls,l=this.context.initChooseFormik,u=this.state.initialParams;return o().createElement("div",{className:n},o().createElement(T.J9,{ref:l,initialValues:u,render:A=>o().createElement(S,A)}))}}P.contextType=M,P.defaultProps={prefixCls:"cl-supplement-workflow__choose"};var R=(0,O.Z)()(P),w=e(62615),j=e(52670),ae=e(63185),le=e(9676);class oe extends o().Component{constructor(){super(...arguments);this.handleChange=n=>{this.props.formik.setFieldValue("person",n)}}render(){var n=this.props.t,l=[{label:n("exam.unqualified"),value:1},{label:n("exam.missTest"),value:2}];return o().createElement(le.Z.Group,{options:l,defaultValue:this.props.defaultFieldList,onChange:this.handleChange})}}var ie=(0,O.Z)()((0,se.Z)((0,T.$j)(oe))),Ee=e(3407),Ze=e(6793),fe=(0,Ze.me)(),m=Ee.Z[fe].exam.validation,N=ue=>{var n;return ue.length||(n=m.checkSupplementPerson),n},D={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}};class H extends o().Component{render(){var n=this.props,l=n.values,u=n.t;return o().createElement(T.l0,{className:"cl-form"},o().createElement(T.gN,(0,U.Z)({component:ie,displayType:"Custom",name:"person",label:u("exam.makeupUsers"),required:!0,defaultFieldList:l.person,validate:N},D)),o().createElement(T.gN,(0,U.Z)({component:w.C0,displayType:"Custom",name:"dateRange",label:u("exam.makeupTime"),required:!0,defaultFieldList:l.dateRange,validate:j.V5},D)))}}var J=(0,O.Z)()(H),k={person:[1],dateRange:{startTime:"",endTime:""}};class V extends o().Component{constructor(){super(...arguments);this.initRefFormik=n=>{this.context.initRefOriginal(n)}}render(){var n=this.props.cellType,l=n===void 0?"unqualifiedNum":n,u=(0,a.Z)((0,a.Z)({},k),{},{person:l==="unqualifiedNum"?[1]:[2]});return o().createElement(T.J9,{ref:this.initRefFormik,initialValues:u,render:A=>o().createElement(J,A)})}}V.contextType=M;var q=(0,O.Z)()(V),ce=e(10237),de=e(37055),ve=e(27550),Te=e(66456),Pe=e(55313),Me=e(22385),De=e(31097),_e=e(95664),we=e(60667),Re=e(80430);class Ue extends o().Component{constructor(){super(...arguments);this.columns=[{title:this.props.t("exam.thNumber"),dataIndex:"userId",width:30,render:(n,l,u)=>u+1},{title:this.props.t("exam.thUserName"),dataIndex:"name",className:"".concat(this.props.prefixCls,"__namecell"),style:{whiteSpace:"normal"},render:(n,l)=>o().createElement(we.Z,{dataType:"userName",value:l.user_info.userId||l.user_info.user_id,name:n,type:l.user_info.sourceType||l.user_info.source_type})},{title:this.props.t("exam.thSubordinate"),dataIndex:"departmentName",width:this.props.showScoreColumns?300:500,render:(n,l)=>{var u=this.props.showScoreColumns,A=u?"314px":"480px";return o().createElement(De.Z,{title:o().createElement(Re.Z,{list:l.user_info.department_info,displayAll:!0})},o().createElement("div",{className:"cl-text-ellipsis",style:{width:A}},o().createElement(Re.Z,{list:l.user_info.department_info,displayAll:!0})))}}],this.columnsWithScore=[{title:this.props.t("exam.thExamTimes"),width:60,dataIndex:"makeUpCount"},{title:this.props.t("exam.thExamScore"),dataIndex:"score"}],this.handleTableChange=n=>{this.props.onTableChange(n)},this.handleSelectChange=(n,l)=>{var u=this.context,A=u.customSelectedRows,z=u.changeSelectedRows,G=[...A];l?G.push(n):G.splice(G.findIndex(ne=>ne.userId===n.userId),1),z(G)},this.handleSelectAllChange=(n,l)=>{var u=this.context,A=u.customSelectedRows,z=u.changeSelectedRows,G=[...A],ne=[];if(n)ne=[...(0,Ze.Cj)(G.concat(l),"userId")];else{var Ie=l.map(Se=>Se.userId);G.forEach(Se=>{Ie.includes(Se.userId)&&ne.push(Se)})}z(ne)}}render(){var n=this.props,l=n.prefixCls,u=n.list,A=u===void 0?[]:u,z=n.loading,G=n.paginationParams,ne=G===void 0?{}:G,Ie=n.showScoreColumns,Se=this.context.customSelectedRows,Qe={selectedRowKeys:Se.map(st=>st.userId),onSelect:this.handleSelectChange,onSelectAll:this.handleSelectAllChange};return o().createElement("section",{className:l},o().createElement(Pe.Z,{bordered:!0,size:"middle",columns:Ie?this.columns.concat(this.columnsWithScore):this.columns,rowKey:"userId",rowSelection:Qe,dataSource:A,pagination:!1,loading:z}),o().createElement(_e.Z,{showRenderRefresh:!1,totalNum:ne.total,totalPage:ne.totalPage,current:ne.current,defaultPageSize:ne.pageSize,onChange:this.handleTableChange}))}}Ue.defaultProps={prefixCls:"cl-supplement-workflow__customtable__content__table"},Ue.contextType=M;var Ye=(0,v.l)(M,Ue),Ae=(0,O.Z)()(Ye),rt={getTableList:de.ZP.ExaminationPlanList.getPlanExamInfoByPlanId};class Oe extends o().Component{constructor(n){super(n);this.initTableList=()=>{this.setState({tableLoading:!0}),ce.WY.get({url:rt.getTableList(),params:this.state.params}).then(l=>{var u=l.data.data.pageInfo;setTimeout(()=>{this.setState({tableLoading:!1,tableList:u.list,tableTotal:u.total,tablePageTotal:u.pages})},300)})},this.handleQueryRowRadiosChange=l=>{this.resetPagination().then(()=>{this.setState(u=>({params:(0,a.Z)((0,a.Z)({},u.params),{},{type:l})}),()=>{this.initTableList()})})},this.handleQueryRowSearch=l=>{this.resetPagination().then(()=>{this.setState(u=>({params:(0,a.Z)((0,a.Z)({},u.params),{},{keyword:l})}),()=>{this.initTableList()})})},this.handleChangePagination=l=>{this.setState(u=>({params:(0,a.Z)((0,a.Z)({},u.params),{},{pageNumber:l})}),()=>{this.initTableList()})},this.resetPagination=()=>new Promise(l=>{this.setState(u=>({params:(0,a.Z)((0,a.Z)({},u.params),{},{pageNumber:1,pageSize:5})}),()=>{l()})}),this.state={params:{planId:this.props.actionId,keyword:"",type:1,pageNumber:1,pageSize:5},radioList:[{name:this.props.t("exam.failed"),value:1},{name:this.props.t("exam.absent"),value:2}],tableLoading:!0,tableList:[],tableTotal:0,tablePageTotal:0}}componentDidMount(){this.initTableList()}render(){var n=this.props.prefixCls,l=this.state,u=l.radioList,A=l.tableTotal,z=l.tablePageTotal,G=l.tableList,ne=l.tableLoading,Ie=l.params,Se={total:A,totalPage:z,current:Ie.pageNumber,pageSize:Ie.pageSize};return o().createElement("div",{className:n},o().createElement(ve.Z,{showCheckbox:!1,showBtn:!1,radioList:u,defaultRadioValue:0,searchStylesProps:{width:238},onRadiosChange:this.handleQueryRowRadiosChange,onSearch:this.handleQueryRowSearch}),o().createElement("div",{className:"".concat(n,"__content")},o().createElement(Ae,{showScoreColumns:Ie.type===1,loading:ne,paginationParams:Se,list:G,onTableChange:this.handleChangePagination})))}}Oe.contextType=M,Oe.defaultProps={prefixCls:"cl-supplement-workflow__customtable"};var He=(0,O.Z)()(Oe),Je=e(84874);class ke extends o().Component{constructor(){var n;super(...arguments);n=this,this.handleChange=l=>{this.props.formik.setFieldValue("person",l)},this.renderFlunkPerson=()=>{var l=this.props.defaultFieldList.filter(u=>u.type===1);return this.renderPersonWrapper(l)},this.renderMissPerson=()=>{var l=this.props.defaultFieldList.filter(u=>u.type===2);return this.renderPersonWrapper(l,"miss")},this.renderPersonWrapper=function(l){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"flunk";if(!l.length)return null;var A=n.props,z=A.prefixCls,G=A.t,ne="".concat(z,"__person");return o().createElement("section",{className:ne},o().createElement("header",{className:"".concat(ne,"__header")},G(u==="flunk"?"exam.unqualified":"exam.missTest")),n.renderPersonList(l))},this.renderPersonList=l=>{var u=this.props.prefixCls,A="".concat(u,"__gallery cl-clearfix");return o().createElement("div",{className:A},l.map(z=>this.renderGalleryItem(z)))},this.handleDeleteItem=l=>{var u=this.props,A=u.formik,z=u.defaultFieldList,G=[...z],ne=G.findIndex(Ie=>Ie.userId===l);G.splice(ne,1),this.context.changeSelectedRows(G),A.setFieldValue("person",G)},this.renderGalleryItem=l=>{var u=this.props.prefixCls,A="".concat(u,"__gallery__item"),z=l.user_info;return o().createElement("span",{className:A,key:l.userId},o().createElement(we.Z,{dataType:"userName",value:z.userId,name:z.name,type:z.sourceType}),o().createElement("span",{onClick:()=>this.handleDeleteItem(l.userId)},o().createElement(Je.Z,{iconClass:"icon-guanbi",size:"12px"})))}}render(){var n=this.props.prefixCls;return o().createElement("div",{className:n},this.renderFlunkPerson(),this.renderMissPerson())}}ke.contextType=M,ke.defaultProps={prefixCls:"cl-supplement-workflow__customform"};var $e=(0,v.l)(M,ke),Be=(0,O.Z)()((0,se.Z)((0,T.$j)($e))),We=(0,Ze.me)(),Le=Ee.Z[We].exam.validation,Xe=ue=>{var n;return ue.length||(n=Le.checkSupplementPerson),n};class qe extends o().Component{render(){var n=this.props,l=n.values,u=n.onAfterChangeDate,A=n.t;return o().createElement(T.l0,{className:"cl-form"},o().createElement(T.gN,{component:Be,displayType:"Custom",name:"person",label:A("exam.makeupUsers"),required:!0,defaultFieldList:l.person,validate:Xe}),o().createElement(T.gN,{component:w.C0,displayType:"Custom",name:"dateRange",label:A("exam.makeupTime"),required:!0,defaultFieldList:l.dateRange,validate:j.V5,onAfterChange:u}))}}var Fe=(0,O.Z)()(qe),et={person:[],dateRange:{startTime:"",endTime:""}};class Ke extends o().Component{constructor(){super(...arguments);this.initRefFormik=n=>{this.context.initRefCustom(n)},this.handleChangeDateRange=n=>{var l=n.startTime,u=n.endTime;this.context.changeCustomDateRange({startTime:l,endTime:u})}}render(){var n=this.context,l=n.customSelectedRows,u=n.customDateRange,A=(0,a.Z)((0,a.Z)({},et),{},{person:l,dateRange:u});return o().createElement(T.J9,{ref:this.initRefFormik,initialValues:A,render:z=>o().createElement(Fe,(0,U.Z)({},z,{onAfterChangeDate:this.handleChangeDateRange}))})}}Ke.contextType=M;var je=(0,O.Z)()(Ke);class Ge extends o().Component{constructor(){super(...arguments);this.state={contextData:(0,a.Z)({},d)},this.initRefOriginal=n=>{this.setState(l=>({contextData:(0,a.Z)((0,a.Z)({},l.contextData),{},{refOriginal:n})}))},this.initRefCustom=n=>{this.setState(l=>({contextData:(0,a.Z)((0,a.Z)({},l.contextData),{},{refCustom:n})}))},this.handleChangeworkflowStatus=n=>{this.setState(l=>({contextData:(0,a.Z)((0,a.Z)({},l.contextData),{},{workflowStatus:n})}))},this.handleChangeActionType=n=>{this.setState(l=>({contextData:(0,a.Z)((0,a.Z)({},l.contextData),{},{actionType:n})}))},this.handleChangeSelectedRows=n=>{this.setState(l=>({contextData:(0,a.Z)((0,a.Z)({},l.contextData),{},{customSelectedRows:n})}))},this.handleChangeCustomDateRange=n=>{this.setState(l=>({contextData:(0,a.Z)((0,a.Z)({},l.contextData),{},{customDateRange:n})}))},this.handleOk=()=>{var n=this.state.contextData,l=n.workflowStatus,u=n.actionType;l===C?this.handleChangeworkflowStatus(u===F?B:Q):l===B?this.handleValidateOriginal():this.handleValidateCustom()},this.handleValidateOriginal=()=>{var n=this.state.contextData.refOriginal;n.submitForm(),n.runValidations().then(l=>{if(!Object.keys(l).length){var u=n.state.values,A=u.dateRange,z=u.person,G={id:this.props.actionId,dateRange:A,type:z.length===2?3:z[0],makeupUserIds:""};this.props.onCreate(G)}})},this.handleValidateCustom=()=>{var n=this.state.contextData.refCustom;n.submitForm(),n.runValidations().then(l=>{if(!Object.keys(l).length){var u=n.state.values,A=u.dateRange,z=u.person,G={id:this.props.actionId,dateRange:A,type:4,makeupUserIds:z.map(ne=>ne.userId).join(",")};this.props.onCreate(G)}})},this.renderFooter=()=>{var n=this.state.contextData,l=n.workflowStatus,u=null;switch(l){case C:case B:case W:u=this.renderCombinatorialFooter();break;case Q:u=this.renderDismissedFooter();break;default:break}return u},this.handleCancel=()=>{var n=this.state.contextData.workflowStatus;n===C?this.props.onCancel():n===B||n===Q?(this.handleChangeworkflowStatus(C),this.handleChangeSelectedRows([])):n===W&&this.handleChangeworkflowStatus(Q)},this.renderCombinatorialFooter=()=>{var n=this.props.t,l=this.state.contextData,u=l.workflowStatus,A=l.customSelectedRows,z=u===W?"(".concat(A.length,")\u4EBA"):null;return o().createElement(o().Fragment,null,o().createElement(X.Z,{key:"dismiss",onClick:this.handleCancel},n("common.cancel")),o().createElement(X.Z,{key:"confirm",type:"primary",onClick:this.handleOk},n(u===C?"common.nextStep":"common.ok"),z))},this.renderDismissedFooter=()=>{var n=this.props.t;return o().createElement(o().Fragment,null,o().createElement(X.Z,{key:"dismiss",onClick:this.handleCancel},n("common.cancel")),o().createElement(X.Z,{key:"confirm",type:"primary",onClick:()=>this.handleChangeworkflowStatus(W)},n("common.nextStep")))},this.renderTitle=()=>{var n=this.props.t,l=this.state.contextData.workflowStatus,u="";return l===Q?u=n("exam.supplementCustomizer"):u=n("exam.supplement"),o().createElement(o().Fragment,null,u)}}componentDidUpdate(n){n.visible!==this.props.visible&&this.props.visible&&this.setState({contextData:(0,a.Z)((0,a.Z)({},d),{},{changeworkflowStatus:this.handleChangeworkflowStatus,changeActionType:this.handleChangeActionType,initRefOriginal:this.initRefOriginal,initRefCustom:this.initRefCustom,changeSelectedRows:this.handleChangeSelectedRows,changeCustomDateRange:this.handleChangeCustomDateRange})})}render(){var n=this.props,l=n.visible,u=n.isLoading,A=(0,me.Z)(n,["visible","isLoading"]),z=this.state.contextData,G=z.workflowStatus;return u?null:o().createElement(b.ZP,{visible:l,title:this.renderTitle(),footer:this.renderFooter(),onCancel:this.handleCancel},o().createElement(M.Provider,{value:z},G===C&&o().createElement(Ve,null),G===B&&o().createElement(ze,A),G===Q&&o().createElement(Ne,A),G===W&&o().createElement(tt,A)))}}var Ve=(0,v.l)(M,R),ze=(0,v.l)(M,q),Ne=(0,v.l)(M,He),tt=(0,v.l)(M,je),at=(0,O.Z)()(Ge)},1465:function(xe,te,e){"use strict";e.r(te),e.d(te,{default:function(){return ot}});var me=e(18106),Z=e(88108),X=e(12924),a=e.n(X),I=e(91768),o=e(57068),O=e(76651),b=e(4408),v=e(62029),C=e(22385),B=e(31097),Q=e(59250),W=e(13013),F=e(57663),f=e(71577),i=e(88986),pe=e(34792),d=e(48086),M=e(71194),T=e(57016),U=e(45697),y=e.n(U),re=e(57254),se=e(50997);class K extends a().Component{constructor(){super(...arguments);this.renderSubTitles=()=>{var s=this.props,t=s.prefixCls,r=s.subTitles,c="".concat(t,"__main__subs");return r.length?a().createElement("div",{className:c},r.filter(h=>h).map((h,x)=>this.renderSubItem(h,x))):null},this.renderSubItem=(s,t)=>{var r=this.props.prefixCls,c="".concat(r,"__main__subs__item");return a().createElement("span",{className:c,key:t},s)}}render(){var s=this.props,t=s.prefixCls,r=s.title,c=s.authScope,h=c===void 0?{}:c,x=s.t,_=s.summary,$=h.visible,ee=$===void 0?!1:$;return a().createElement("div",{className:"".concat(t)},a().createElement("section",null,a().createElement("div",{className:"".concat(t,"__main")},a().createElement("h1",{className:"".concat(t,"__main__title")},r,ee&&a().createElement("span",{className:"".concat(t,"__main__title__auth")},x("common.authScopeTip"))),this.renderSubTitles()),a().createElement("div",{className:"".concat(t,"__children")},this.props.children)),_?a().createElement("div",{className:"".concat(t,"__summary")},x("learning.taskSummary"),"\uFF1A",_):null)}}K.defaultProps={prefixCls:"cl-monitor-title",title:"",subTitles:[],authScope:{visible:!1},summary:""},K.propsTypes={prefixCls:y().string,title:y().string.isRequired,subTitles:y().array.isRequired,authScope:y().object,summary:y().string};var p=(0,I.Z)()(K),L=e(10237),E=e(37055),g=e(54531),S=e(6793),P=e(83431),R=e(60667),w={getExamResult:E.ZP.ExaminationPlanMonitor.getExamResult,urgeExam:E.ZP.ExaminationPlanList.urgeExam,supplementExam:E.ZP.ExaminationPlanList.supplementExam};class j extends a().Component{constructor(){super(...arguments);this.state={planExam:{},status:"",title:"",subTitles:[],supplementProps:{visible:!1,actionId:""},dingUserIds:[]},this.appId=sessionStorage.getItem("CL_E_APP_ID"),this.miniAppId=sessionStorage.getItem("CL_MINI_APP_ID"),this.onHandleUrge=()=>{var s=this.props,t=s.actionId,r=s.t;T.Z.confirm({title:r("exam.urge"),content:r("exam.urgeTip"),onOk(){L.qg.get({url:w.urgeExam(),params:{planId:t,noticeType:3}}).then(c=>{var h=c.data,x=h.code,_=h.msg;x!==1&&d.default["".concat(x===0?"success":"warning")](_)})}})},this.onHandleDing=()=>{var s=this.state,t=s.dingUserIds,r=s.title,c=encodeURIComponent("/pages/messageRedirect/messageRedirect?flag=exam&planId=".concat(this.props.actionId)),h="dingtalk://dingtalkclient/action/open_micro_app?&appId=".concat(this.appId,"&miniAppId=").concat(this.miniAppId,"&page=").concat(c,"&corpId=$CORPID$"),x={users:t,attachmentTitle:r,text:(0,S.ZT)(this.props.t("exam.dingTips"),r),mobileUrl:h};(0,g.nb)(x)},this.getInfo=()=>{L.WY.get({url:w.getExamResult(),params:{planId:this.props.actionId,tabId:0,status:"",departmentId:"",keyword:"",pageNumber:1,pageSize:20}}).then(s=>{var t=this.props.t,r=s.data.data,c=r.status,h=r.planExam,x=h===void 0?{}:h,_=r.dingUserIds,$=_===void 0?[]:_,ee=Y=>a().createElement("span",null,t("common.creator"),"\uFF1A",a().createElement(R.Z,{dataType:"userName",value:Y.creator_sync_user_id,name:Y.creatorName,type:Y.creator_source_type}));this.setState({planExam:x,status:c,dingUserIds:$,title:x.title,subTitles:[ee(x),"".concat(t("common.passingLine"),"\uFF1A ").concat(x.passLine,"%")]})})},this.handleSupplement=()=>{this.setState(s=>({supplementProps:(0,i.Z)((0,i.Z)({},s.supplementProps),{},{visible:!0,actionId:this.props.actionId})}))},this.handleSupplementOk=s=>{var t=s.id,r=s.type,c=s.dateRange,h=s.makeupUserIds;L.qg.post({url:w.supplementExam(),data:{examPlanId:t,startTime:c.startTime,endTime:c.endTime,type:r,makeupUserIds:h}}).then(x=>{var _=x.data,$=_.code,ee=_.msg;if(d.default[$===0?"success":"warning"](ee),$===0){var Y=this.props.onOk;this.handleSupplementCancel(),Y&&Y()}})},this.handleSupplementCancel=()=>{this.setState(s=>({supplementProps:(0,i.Z)((0,i.Z)({},s.supplementProps),{},{visible:!1,actionId:""})}))},this.urgeButton=()=>{var s=this.props.t,t=this.state.planExam,r=t.publishStatus==="unpublished";return r?a().createElement(B.Z,{title:s("study.cantPushMsg")},a().createElement(f.Z,{type:"primary",disabled:!0},s("exam.urge")," ",a().createElement(re.Z,null))):a().createElement(W.Z,{overlay:a().createElement(P.Z,{onUrge:this.onHandleUrge,onDing:this.onHandleDing})},a().createElement(f.Z,null,s("exam.urge")," ",a().createElement(re.Z,null)))},this.renderBtns=()=>{var s=this.state,t=s.status,r=s.planExam,c=this.props.t,h=r.publishStatus==="unpublished",x=o.parse(O.m8.location.search),_=x.taskType;return a().createElement(a().Fragment,null,t==="end"&&a().createElement(B.Z,{title:c(h?"study.cantPushMsg":"exam.supplementTip"),placement:"topRight"},a().createElement(f.Z,{disabled:h,onClick:this.handleSupplement},c("exam.supplement"))),t==="on_going"&&_!=="employee"&&_!=="project"&&this.urgeButton())}}componentDidMount(){this.getInfo(),(0,g.TN)()}render(){var s=this.state,t=s.title,r=s.subTitles,c=s.supplementProps,h=this.props.authScope;return a().createElement("div",null,a().createElement(p,{title:t,subTitles:r,authScope:h},this.renderBtns()),a().createElement(se.Z,(0,v.Z)({},c,{isLoading:!c.visible,onCancel:this.handleSupplementCancel,onCreate:this.handleSupplementOk})))}}j.defaultProps={authScope:{visible:!1}},j.propsTypes={authScope:y().object};var ae=(0,I.Z)()(j),le=e(30887),oe=e(99210),ie=e(28216),Ee=e(84391),Ze=e(47745),fe=e(55285),m=e(30311),N={WAIT:5};class D extends a().Component{constructor(){super(...arguments);this.state={getExamAllGradesProps:{visible:!1,planId:"",userId:"",planTitle:""}},this.columns=[{title:this.props.t("exam.examResult"),width:120,dataIndex:"statusName",key:"statusName",onCell:()=>({style:{minWidth:80}})},{title:this.props.t("exam.examItems"),width:120,dataIndex:"makeupCount",key:"makeupCount",render:(s,t)=>t.makeupCount>1?a().createElement(m.Z,{name:t.makeupCount,onClick:()=>this.showEveryExamGrade(t.planId,t.userId)}):t.makeupCount,onCell:()=>({style:{minWidth:80}})},{title:this.props.t("examing.examTotalScore"),width:100,key:"examTotalScore",render:(s,t)=>t.questionMode===2&&!t.totalScore?"--":"".concat(t.totalScore),onCell:()=>({style:{minWidth:80}})},{title:this.props.t("exam.examScore"),width:100,key:"examScore",render:(s,t)=>t.status!==N.WAIT?"".concat(t.score):"--",onCell:()=>({style:{minWidth:80}})},{title:this.props.t("exam.marker"),width:100,dataIndex:"markerName",key:"markerName",render:(s,t)=>a().createElement(R.Z,{dataType:"userName",value:t.marker_sync_user_id,name:s,type:t.marker_source_type})},{title:this.props.t("exam.examTime"),dataIndex:"examDuration",key:"examDuration",width:100,onCell:()=>({style:{minWidth:80}})},{title:this.props.t("common.operate"),width:100,key:"operate",fixed:"right",render:s=>this.renderActions({record:s})}],this.showEveryExamGrade=(s,t)=>{var r=this.props.planTitle;this.setState(c=>({getExamAllGradesProps:(0,i.Z)((0,i.Z)({},c.getExamAllGradesProps),{},{visible:!0,planId:s,userId:t,planTitle:r})}))},this.hideEveryExamGrade=()=>{this.setState(s=>({getExamAllGradesProps:(0,i.Z)((0,i.Z)({},s.getExamAllGradesProps),{},{visible:!1,planId:"",userId:"",planTitle:""})}))},this.handleTableChange=s=>{this.props.onTableChange(s)},this.handleGotoExam=s=>{var t=s.record;O.m8.push({pathname:"/training/examination/result",search:o.stringify({pageFrom:"examMonitor",userId:t.userId,id:t.planId,repeatMarking:!0})})},this.renderActions=s=>{var t=s.record,r=t.makeupCount,c=t.status;return r&&c!==N.WAIT?a().createElement("div",{className:"cl-table__cell-action"},a().createElement("span",{className:"cl-pointer",onClick:()=>this.handleGotoExam({record:t})},this.props.t("common.viewDetails"))):a().createElement("div",{className:"cl-table__cell-action"},a().createElement("span",{className:"cl-pointer cl-disabled"}," ",this.props.t("common.viewDetails")))}}render(){var s=this.props,t=s.prefixCls,r=s.list,c=r===void 0?[]:r,h=s.loading,x=s.paginationParams,_=x===void 0?{}:x,$=s.toolBarRender,ee=s.headerTitle,Y=(0,i.Z)((0,i.Z)({},E.XE.INITIAL_PAGINATION),_),he=this.state.getExamAllGradesProps;return a().createElement("section",{className:t},a().createElement(fe.Z,{withLoginPhoneNumber:!0,columns:this.columns,rowKey:"id",dataSource:c,pagination:Y,loading:h,onChange:this.handleTableChange,toolBarRender:$,headerTitle:ee,tableUUID:"33cbc5d8-ba9b-4933-832c-dd5568bfcb3b"}),a().createElement(Ze.Z,(0,v.Z)({},he,{hideEveryExamGrade:this.hideEveryExamGrade})))}}D.defaultProps={prefixCls:"plan-monitor__persontab__table"};var H=(0,I.Z)()(D),J=e(64262),k=e(64630),V=e(48479),q=e(27550),ce=e(97593),de={getExamResult:E.ZP.ExaminationPlanMonitor.getExamResult,exportExamResult:E.ZP.ExaminationPlanMonitor.exportExamResult,exportAnswerList:E.ZP.ExaminationPlanMonitor.exportAnswerList,exportAnswerDetails:E.ZP.ExaminationPlanMonitor.exportAnswerDetails};class ve extends a().Component{constructor(){super(...arguments);this.state={params:{planId:"",tabId:0,status:"",departmentId:"",postId:"",keyword:"",pageNumber:1,pageSize:20},planTitle:"",radioList:[],tableLoading:!1,tableList:[],tableTotal:0},this.initTableList=()=>{var s=this.props.t;this.setState({tableLoading:!0}),L.WY.get({url:de.getExamResult(),params:(0,i.Z)((0,i.Z)({},this.state.params),{},{planId:this.props.actionId})}).then(t=>{setTimeout(()=>{this.setState({planTitle:t.data.data.planExam.title,tableLoading:!1,tableList:t.data.data.planUser.list,tableTotal:t.data.data.planUser.total,radioList:[{name:"".concat(s("exam.all"),"(").concat(t.data.data.tabId0count,")"),value:0},{name:"".concat(s("exam.qualified"),"(").concat(t.data.data.tabId2count,")"),value:2},{name:"".concat(s("exam.unqualified"),"(").concat(t.data.data.tabId1count,")"),value:1},{name:"".concat(s("exam.notTest"),"(").concat(t.data.data.tabId3count,")"),value:3}]});var r=this.props.changeAuthScope;r&&r(t.data.data.planExam.authorityRange==="true")},300)})},this.handleQueryRowRadiosChange=s=>{this.resetPagination().then(()=>{this.setState(t=>({params:(0,i.Z)((0,i.Z)({},t.params),{},{pageNumber:1,tabId:s})}),()=>{this.initTableList()})})},this.handleQueryRowSearch=s=>{this.resetPagination().then(()=>{this.setState(t=>({params:(0,i.Z)((0,i.Z)({},t.params),{},{pageNumber:1,keyword:s})}),()=>{this.initTableList()})})},this.handleChangePagination=s=>{var t=s.current,r=s.pageSize;this.setState(c=>({params:(0,i.Z)((0,i.Z)({},c.params),{},{pageNumber:t,pageSize:r})}),()=>{this.initTableList()})},this.resetPagination=()=>new Promise(s=>{this.setState(t=>({params:(0,i.Z)((0,i.Z)({},t.params),{},{pageNumber:1,pageSize:20})}),()=>{s()})}),this.handleTreeSelectChange=s=>{this.setState(t=>({params:(0,i.Z)((0,i.Z)({},t.params),{},{pageNumber:1,departmentId:s})}),()=>{this.initTableList()})},this.handlePostSelectChange=s=>{this.setState(t=>({params:(0,i.Z)((0,i.Z)({},t.params),{},{pageNumber:1,postId:s})}),()=>{this.initTableList()})},this.handleSearch=(s,t)=>{this.setState(r=>({params:(0,i.Z)((0,i.Z)({},r.params),{},{pageNumber:1,keyword:t===""?s:"",userIds:t})}),()=>{this.initTableList()})},this.handleMenuClick=s=>{var t=s.key,r=this.state.params,c=r.keyword,h=r.departmentId,x=r.tabId,_=r.postId,$=o.parse(O.m8.location.search),ee=$.taskType,Y=$.taskId,he=$.projectId,ge="export_type_01",ye=Y;switch(ee){case"project":ge="export_type_02",ye=he;break;case"task":case"employee":ge="export_type_01";break;case"exam":ge="export_type_03",ye="";break;default:}var be="";switch(t){case"exportExamResult":be="&planId=".concat(this.props.actionId,"&keyword=").concat(c,"&departmentId=").concat(h,"&tabId=").concat(x,"&postId=").concat(_,"&exportExamType=").concat(ge,"&sourceId=").concat(ye),(0,ce.N)({page:"exportExamResult",props:this.props,query:be});break;case"exportAnswerList":be="&keyword=".concat(c,"&departmentId=").concat(h,"&tabId=").concat(x,"&postId=").concat(_,"&exportExamType=").concat(ge,"&sourceId=").concat(ye),(0,ce.N)({page:"exportAnswerList",props:this.props,query:be,rest:{examId:this.props.actionId}});break;case"exportAnswerDetails":if(x===3){d.default.warning("\u672A\u8003\u5B66\u5458\u8BD5\u9898\u4F5C\u7B54\u660E\u7EC6\u4E0D\u652F\u6301\u5BFC\u51FA\u3002");return}be="&keyword=".concat(c,"&departmentId=").concat(h,"&tabId=").concat(x,"&postId=").concat(_,"&exportExamType=").concat(ge,"&sourceId=").concat(ye),(0,ce.N)({page:"exportAnswerDetails",props:this.props,query:be,rest:{examId:this.props.actionId}});break;default:break}},this.renderSearchRow=()=>{var s=this.props,t=s.prefixCls,r=s.t,c=a().createElement(oe.Z,{onClick:this.handleMenuClick},a().createElement(oe.Z.Item,{key:"exportExamResult"},r("exam.userExamResult")),a().createElement(oe.Z.Item,{key:"exportAnswerList"},r("exam.userAnswerDetails")),a().createElement(oe.Z.Item,{key:"exportAnswerDetails"},r("exam.questionAnswerDetails")));return a().createElement("div",{className:"".concat(t,"__searchrow")},a().createElement(W.Z,{overlay:c},a().createElement(f.Z,{type:"primary"},a().createElement(Ee.Z,null)," ",r("common.exportData"))))},this.renderRightRow=()=>{var s=this.props,t=s.prefixCls,r=s.t,c=this.state.radioList;return a().createElement("div",{className:"".concat(t,"__header-container__between")},a().createElement(q.Z,{showCheckbox:!1,showSearch:!1,showBtn:!1,radioList:c,defaultRadioValue:0,onRadiosChange:this.handleQueryRowRadiosChange}),a().createElement(V.Z,{onSearch:this.handleSearch,width:"272px",placeholder:r("searchInputPlaceholder.userName")}))}}componentDidMount(){this.initTableList()}render(){var s=this.props.prefixCls,t=this.state,r=t.tableTotal,c=t.tableList,h=t.tableLoading,x=t.params,_=t.planTitle,$={total:r,current:x.pageNumber,pageSize:x.pageSize};return a().createElement("div",{className:s},a().createElement("div",{className:"".concat(s,"__header")},a().createElement("div",{className:"".concat(s,"__header-flex")},a().createElement(J.Z,{parentId:"",checkable:!1,asyncLoad:!0,treeSelect:!0,className:"".concat(s,"__header__selectrow cl-search-normal-width"),onTreeSelectChange:this.handleTreeSelectChange}),a().createElement(k.Z,{className:"".concat(s,"__header__selectrow cl-search-normal-width"),onChange:this.handlePostSelectChange}))),a().createElement(H,{loading:h,paginationParams:$,list:c,planTitle:_,onTableChange:this.handleChangePagination,headerTitle:this.renderSearchRow(),toolBarRender:this.renderRightRow}))}}ve.defaultProps={prefixCls:"plan-monitor__persontab"};var Te=(0,ie.$j)()((0,I.Z)()(ve)),Pe=e(43358),Me=e(34041),De=e(36202),_e=e(95664);class we extends a().Component{constructor(){super(...arguments);this.columns=[{title:this.props.t("common.number"),width:55,dataIndex:"id",key:"id",fixed:"left",render:(s,t,r)=>r+1}],this.handleTableChange=s=>{this.props.onTableChange(s)}}render(){var s=this.props,t=s.list,r=t===void 0?[]:t,c=s.loading,h=s.paginationParams,x=h===void 0?{}:h,_=s.toolBarRender,$=s.headerTitle,ee=x.total,Y=x.totalPage,he=x.current;return a().createElement("section",{className:"employee-people__content__table"},a().createElement(fe.Z,{withLoginPhoneNumber:!0,bordered:!0,headExtra:this.columns,rowKey:"userId",dataSource:r,pagination:!1,loading:c,headerTitle:$,toolBarRender:_,tableUUID:"2dd174cb-9e6d-4032-90bc-e5a9a9acf4f4"}),a().createElement(_e.Z,{totalNum:ee,totalPage:Y,current:he,defaultPageSize:10,showRenderRefresh:!1,onChange:this.handleTableChange}))}}var Re=(0,I.Z)()(we),Ue=e(47673),Ye=e(4107),Ae=e(59239),rt=e(55446),Oe=e(18329),He=Ae.Z.Item;class Je extends a().Component{constructor(){super(...arguments);this.state={visible:!1,days:""},this.onSearch=(s,t)=>{this.props.onSearch(s,t)},this.onUrgeUserStudy=()=>{var s=this.props.t;T.Z.confirm({title:s("study.remind"),content:s("study.urgeTip"),zIndex:99999,onOk:()=>{var t=E.ZP.EmployeeTrain.urgeUsers(),r={planId:this.props.planId};L.WY.get({url:t,params:r}).then(c=>{c.data.code===0&&d.default.success(c.data.msg)})}})},this.handleShowDelay=()=>{this.setState({visible:!this.state.visible})},this.handleSubmit=s=>{s.preventDefault(),this.props.form.validateFields((t,r)=>{t||(this.props.handleDelay(r),this.handleShowDelay())})},this.renderOngoingBtn=()=>a().createElement("div",{className:"employee-people__queryrow__action"},a().createElement(W.Z,{overlay:a().createElement(P.Z,{onUrge:this.onUrgeUserStudy,onDing:this.props.onDing})},a().createElement(f.Z,{type:"primary"},this.props.t("study.remind")," ",a().createElement(re.Z,null)))),this.renderOverdueBtn=()=>{var s=this.props.selectedRowKeys,t=s.length;return a().createElement("div",{className:"employee-people__queryrow__action"},a().createElement(f.Z,{type:"primary",className:"ongoing-user-top-btn",onClick:this.handleShowDelay,disabled:t<=0},this.props.t("common.postpone")))},this.renderActionBtn=()=>{var s=this.props.status;return s==="3"?a().createElement("div",null,this.renderOverdueBtn()):s==="1"?a().createElement("div",null,this.renderOngoingBtn()):null}}render(){var s=this.props.t,t={okText:s("common.ok"),cancelText:s("common.cancel"),size:"small",destroyOnClose:!0,bodyStyle:{padding:"20px"},maskClosable:!1},r={labelCol:{span:5},wrapperCol:{span:15}},c=this.props.form.getFieldDecorator,h=this.state,x=h.visible,_=h.days;return a().createElement("header",{className:"employee-people__queryrow"},a().createElement("section",null,a().createElement(V.Z,{onSearch:this.onSearch,width:"260px",placeholder:s("searchInputPlaceholder.userName")}),this.renderActionBtn()),a().createElement(Oe.ZP,(0,v.Z)({},t,{visible:x,title:s("common.postpone"),onCancel:this.handleShowDelay,onOk:this.handleSubmit}),a().createElement("div",{className:"employee-delay"},a().createElement(Ae.Z,{layout:"vertical"},a().createElement(He,(0,v.Z)({},r,{label:s("common.postpone")}),c("delayDay",{rules:[{validator:this.checkPostponeDays}],initialValue:_})(a().createElement("span",null,a().createElement(Ye.Z,{placeholder:"\u9650\u523630",style:{width:200}}),s("common.day"))))))))}}var ke=(0,I.Z)()(Ae.Z.create()(Je)),$e,Be,We,Le,Xe=($e=(0,ie.$j)(Ce=>{var s=Ce.user;return{enterpriseName:s.enterpriseName}}),Be=Reflect.metadata("design:type",Function),We=Reflect.metadata("design:paramtypes",[void 0]),$e(Le=Be(Le=We(Le=class extends a().Component{constructor(s){super(s);this.onCancel=()=>{this.props.onCancel()},this.handleChangPagination=t=>{this.setState(r=>({params:(0,i.Z)((0,i.Z)({},r.params),{},{page_number:t})}),()=>{this.initTableList()})},this.resetPagination=()=>new Promise(t=>{this.setState(r=>({params:(0,i.Z)((0,i.Z)({},r.params),{},{pageNumber:1,pageSize:20})}),()=>{t()})}),this.handleSearch=(t,r)=>{this.resetPagination().then(()=>{this.setState(c=>({params:(0,i.Z)((0,i.Z)({},c.params),{},{keyword:t,userIds:r})}),()=>{this.initTableList()})})},this.initTableList=()=>{this.setState({tableLoading:!0});var t=this.state.params,r=t.userIds,c=t.keyword;L.WY.get({url:E.ZP.ExaminationPlanMonitor.getRateUer(),params:(0,i.Z)((0,i.Z)({},this.state.params),{},{keyword:r?"":c})}).then(h=>{setTimeout(()=>{this.setState({tableLoading:!1,tableList:h.data.data.list,tableTotal:h.data.data.total,tableTotalPages:h.data.data.pages})},300)})},this.renderRightRow=()=>a().createElement(ke,{onSearch:this.handleSearch}),this.handleExport=()=>{var t=this.state.params,r=t.plan_id,c=t.question_id,h=t.rate_type,x=t.keyword,_="?".concat(o.stringify({plan_id:r,question_id:c,rate_type:h,keyword:x}));(0,ce.N)({page:"learningRateUser",props:this.props,query:_})},this.renderLeftRow=()=>{var t=this.props.t;return a().createElement(f.Z,{type:"primary",onClick:this.handleExport},a().createElement(Ee.Z,null)," ",t("common.exportData"))},this.state={params:{plan_id:s.planId,question_id:s.questionId,rate_type:s.rateType,keyword:"",page_number:1,page_size:10,userIds:""},tableLoading:!0,tableList:[],tableTotal:0,tableTotalPages:0}}componentDidMount(){this.initTableList()}componentDidUpdate(s){if(this.props.visible&&this.props.visible!==s.visible&&this.props.planId){var t=this.props,r=t.planId,c=t.questionId,h=t.rateType;this.setState({params:{plan_id:r,question_id:c,rate_type:h,keyword:"",page_number:1,page_size:10},tableList:[],tableTotal:0},()=>{this.initTableList()})}}render(){var s=this.props,t=s.visible,r=s.t,c=s.rateType,h=s.questionType,x=this.state,_=x.tableTotal,$=x.tableList,ee=x.tableLoading,Y=x.tableTotalPages,he=x.params,ge={total:_,current:he.page_number,totalPage:Y},ye;h===1?ye=r("common.single"):h===2?ye=r("common.multiple"):ye=r("common.tof");var be="".concat(ye).concat(r(c?"libraryPractice.accuracy":"libraryPractice.errorRate")).concat(r("examing.analyzeDetails"));return a().createElement(Oe.ZP,{visible:t,title:be,onCancel:this.onCancel,onOk:this.onCancel,size:"middle"},t?a().createElement("div",{className:"employee-people"},a().createElement("div",{className:"employee-people__content"},a().createElement(Re,{loading:ee,paginationParams:ge,list:$,onTableChange:this.handleChangPagination,headerTitle:this.renderLeftRow(),toolBarRender:this.renderRightRow}))):null)}})||Le)||Le)||Le),qe=(0,I.Z)()(Xe);class Fe extends a().Component{constructor(s){super(s);this.onCloseUserInfo=()=>{this.setState({resultUserProps:{visible:!1,planId:"",questionId:"",rateType:!1,questionType:0}})},this.showUserInfo=(t,r)=>{this.setState({resultUserProps:{visible:!0,planId:this.props.planId,questionId:t.id,rateType:r==="accuracy",questionType:t.type}})},this.handleTableChange=t=>{this.props.onTableChange(t)},this.state={resultUserProps:{visible:!1,planId:"",questionId:"",rateType:""}},this.columns=[{title:this.props.t("common.number"),width:80,dataIndex:"orderId",key:"orderId"},{title:this.props.t("exam.paperAddthType"),width:120,dataIndex:"typeName",key:"typeName"},{title:this.props.t("exam.paperBank"),width:120,dataIndex:"questionBankName",key:"questionBankName",render:(t,r)=>{var c=r.questionBankName;return c||"--"}},{title:this.props.t("exam.paperAddthName"),dataIndex:"title",key:"title"},{title:this.props.t("exam.knowledgePoint"),dataIndex:"knowledgePoint",key:"knowledgePoint",width:200,render:(t,r)=>{var c=r.knowledgePoint;return c?c.map(h=>a().createElement("div",{className:"question-knowledge-point",key:h.knowledgeId,title:h.title},h.title)):""}},{title:this.props.t("learning.questionAddOptionSubName"),width:120,dataIndex:"answer",key:"answer"},{title:this.props.t("libraryPractice.accuracy"),width:120,dataIndex:"accuracy",key:"accuracy",render:(t,r)=>a().createElement(m.Z,{name:r.accuracy,onClick:()=>this.showUserInfo(r,"accuracy")})},{title:this.props.t("libraryPractice.errorRate"),width:120,dataIndex:"errorRate",key:"errorRate",render:(t,r)=>a().createElement(m.Z,{name:r.errorRate,onClick:()=>this.showUserInfo(r,"errorRate")})}]}render(){var s=this.props,t=s.prefixCls,r=s.list,c=r===void 0?[]:r,h=s.loading,x=s.paginationParams,_=x===void 0?{}:x,$=s.toolBarRender,ee=s.headerTitle,Y=this.state.resultUserProps,he=Y.visible,ge=(0,i.Z)((0,i.Z)({},E.XE.INITIAL_PAGINATION),_);return a().createElement("section",{className:t},a().createElement(De.f,{scroll:{y:"100%"},columns:this.columns,rowKey:"id",dataSource:c,pagination:ge,loading:h,onChange:this.handleTableChange,toolBarRender:$,headerTitle:ee,tableUUID:"e6af70c4-6816-4b03-b4cb-9ba19f061975"}),he&&a().createElement(qe,(0,v.Z)({},Y,{onCancel:this.onCloseUserInfo})))}}Fe.defaultProps={prefixCls:"plan-monitor__analysistab__table"};var et=(0,I.Z)()(Fe),Ke=e(38642),je,Ge,Ve,ze,Ne=Me.Z.Option,tt={getAnalysisList:E.ZP.ExaminationPlanMonitor.getAnalysisList,exportQuestionAnalysis:E.ZP.ExaminationPlanMonitor.exportQuestionAnalysis},at=(je=(0,ie.$j)(Ce=>{var s=Ce.user;return{enterpriseName:s.enterpriseName}}),je(Ge=(ze=Ve=class extends a().Component{constructor(){super(...arguments);this.state={params:{planId:"",type:"",keyword:"",pageNumber:1,pageSize:20},tableLoading:!1,tableList:[],tableTotal:0},this.initTableList=()=>{this.setState({tableLoading:!0}),L.WY.get({url:tt.getAnalysisList(),params:(0,i.Z)((0,i.Z)({},this.state.params),{},{planId:this.props.actionId})}).then(s=>{setTimeout(()=>{this.setState({tableLoading:!1,tableList:s.data.data.list,tableTotal:s.data.data.total})},300)})},this.handleChangePagination=s=>{var t=s.current,r=s.pageSize;this.setState(c=>({params:(0,i.Z)((0,i.Z)({},c.params),{},{pageNumber:t,pageSize:r})}),()=>{this.initTableList()})},this.resetPagination=()=>new Promise(s=>{this.setState(t=>({params:(0,i.Z)((0,i.Z)({},t.params),{},{pageNumber:1,pageSize:20})}),()=>{s()})}),this.handleSearch=s=>{this.setState(t=>({params:(0,i.Z)((0,i.Z)({},t.params),{},{keyword:s})}),()=>{this.initTableList()})},this.handleSelectChange=s=>{this.setState(t=>({params:(0,i.Z)((0,i.Z)({},t.params),{},{type:s})}),()=>{this.initTableList()})},this.handleExport=()=>{var s=o.parse(O.m8.location.search),t=s.taskType,r=s.taskId,c=s.projectId,h="export_type_01",x=r;switch(t){case"project":h="export_type_02",x=c;break;case"task":case"employee":h="export_type_01";break;case"exam":h="export_type_03",x="";break;default:}var _="";(0,Ke.UI)("EXAM_BANK_CONFIG")&&(_=2e4);var $="&planId=".concat(this.props.actionId,"&type=").concat(this.state.params.type,"&keyword=").concat(this.state.params.keyword,"&exportExamType=").concat(h,"&sourceId=").concat(x,"&exportCount=").concat(_);(0,ce.N)({page:"exportQuestionAnalysis",props:this.props,query:$})},this.renderSearchRow=()=>{var s=this.props.t;return a().createElement(f.Z,{type:"primary",onClick:this.handleExport},a().createElement(Ee.Z,null)," ",s("common.exportData"))},this.renderRight=()=>{var s=this.props.t;return a().createElement(V.Z,{onSearch:this.handleSearch,width:"282px",placeholder:s("searchInputPlaceholder.question")})},this.renderSelectRow=()=>{var s=this.props,t=s.prefixCls,r=s.t;return a().createElement("div",{className:"".concat(t,"__selectrow"),style:{marginBottom:"24px"}},a().createElement(Me.Z,{defaultValue:"",className:"cl-search-normal-width",onChange:this.handleSelectChange},a().createElement(Ne,{value:""},r("courseManage.allType")),a().createElement(Ne,{value:"1"},r("common.single")),a().createElement(Ne,{value:"2"},r("common.multiple")),a().createElement(Ne,{value:"3"},r("common.tof"))))}}componentDidMount(){this.initTableList()}render(){var s=this.props,t=s.prefixCls,r=s.actionId,c=this.state,h=c.tableTotal,x=c.tableList,_=c.tableLoading,$=c.params,ee={total:h,current:$.pageNumber,pageSize:$.pageSize};return a().createElement("div",{className:t},this.renderSelectRow(),a().createElement(et,{loading:_,planId:r,paginationParams:ee,list:x,onTableChange:this.handleChangePagination,headerTitle:this.renderSearchRow(),toolBarRender:this.renderRight}))}},Ve.defaultProps={prefixCls:"plan-monitor__analysistab"},ze))||Ge),ue=(0,ie.$j)()((0,I.Z)()(at)),n=e(9715),l=e(86585),u=e(14965),A=e(11448),z=e(78138),G=e.n(z);class ne extends a().Component{constructor(){super(...arguments);this.columns=[{title:this.props.t("exam.makeupDuration"),width:250,dataIndex:"makeupExamRangeTime",key:"makeupExamRangeTime"},{title:this.props.t("exam.examResult"),width:120,dataIndex:"statusName",key:"statusName",onCell:()=>({style:{minWidth:80}})},{title:this.props.t("exam.examItems"),width:120,dataIndex:"makeupCount",key:"makeupCount",onCell:()=>({style:{minWidth:80}})},{title:this.props.t("exam.examScore"),width:120,dataIndex:"score",key:"score",onCell:()=>({style:{minWidth:80}})},{title:this.props.t("exam.marker"),width:100,dataIndex:"markerName",key:"markerName",render:(s,t)=>a().createElement(R.Z,{dataType:"userName",value:t.marker_sync_user_id,name:s,type:t.marker_source_type})},{title:this.props.t("exam.examTime"),dataIndex:"examDuration",key:"examDuration",width:100,onCell:()=>({style:{minWidth:80}})},{title:this.props.t("common.operate"),width:100,key:"operate",fixed:"right",render:s=>this.renderActions({record:s})}],this.handleTableChange=s=>{this.props.onTableChange(s)},this.handleGotoExam=s=>{var t=s.record;O.m8.push({pathname:"/training/examination/result",search:o.stringify({pageFrom:"examMonitor",userId:t.userId,id:t.planId})})},this.renderActions=s=>{var t=s.record,r=t.makeupCount;return r?a().createElement("div",{className:"cl-table__cell-action"},a().createElement("span",{className:"cl-pointer",onClick:()=>this.handleGotoExam({record:t})},this.props.t("common.viewDetails"))):a().createElement("div",{className:"cl-table__cell-action"},a().createElement("span",{className:"cl-pointer cl-disabled"},this.props.t("common.viewDetails")))}}render(){var s=this.props,t=s.selectedRowKeys,r=s.prefixCls,c=s.list,h=c===void 0?[]:c,x=s.loading,_=s.paginationParams,$=_===void 0?{}:_,ee=s.toolBarRender,Y=s.headerTitle,he=(0,i.Z)((0,i.Z)({},E.XE.INITIAL_PAGINATION),$),ge={selectedRowKeys:t,onChange:(ye,be)=>{this.props.selectTableData(ye,be)}};return a().createElement("section",{className:r},a().createElement(fe.Z,{withLoginPhoneNumber:!0,columns:this.columns,rowKey:"id",dataSource:h,pagination:he,loading:x,onChange:this.handleTableChange,rowSelection:(0,i.Z)({},ge),toolBarRender:ee,headerTitle:Y,tableUUID:"cf3a3b69-e7ac-48f9-b570-043bae605d6f"}))}}ne.defaultProps={prefixCls:"plan-monitor__persontab__table"};var Ie=(0,I.Z)()(ne),Se={getMakeupExamMonitors:E.ZP.ExaminationPlanMonitor.getMakeupExamMonitors,exportMakeupExamMonitors:E.ZP.ExaminationPlanMonitor.exportMakeupExamMonitors,setExamDelay:E.ZP.QuestionManager.setExamDelay};class Qe extends a().Component{constructor(s){super(s);this.initTableList=()=>{this.setState({tableLoading:!0}),L.WY.get({url:Se.getMakeupExamMonitors({examId:this.props.actionId}),params:(0,i.Z)((0,i.Z)({},this.state.params),{},{planId:this.props.actionId})}).then(t=>{var r=this.props.t;setTimeout(()=>{this.setState({tableLoading:!1,tableList:t.data.data.planUser.list,tableTotal:t.data.data.planUser.total,radioList:[{name:"".concat(r("exam.all"),"(").concat(t.data.data.tabId0count,")"),value:0},{name:"".concat(r("exam.qualified"),"(").concat(t.data.data.tabId2count,")"),value:2},{name:"".concat(r("exam.unqualified"),"(").concat(t.data.data.tabId1count,")"),value:1},{name:"".concat(r("exam.notTest"),"(").concat(t.data.data.tabId3count,")"),value:3}]})},300)})},this.handleQueryRowRadiosChange=t=>{this.resetPagination().then(()=>{this.setState(r=>({params:(0,i.Z)((0,i.Z)({},r.params),{},{tabId:t})}),()=>{this.initTableList()})})},this.handleQueryRowSearch=t=>{this.resetPagination().then(()=>{this.setState(r=>({params:(0,i.Z)((0,i.Z)({},r.params),{},{keyword:t})}),()=>{this.initTableList()})})},this.handleChangePagination=t=>{var r=t.current,c=t.pageSize;this.setState(h=>({params:(0,i.Z)((0,i.Z)({},h.params),{},{pageNumber:r,pageSize:c})}),()=>{this.initTableList()})},this.selectTableData=(t,r)=>{var c=r.map(h=>h.userId);this.setState({userIds:c,selectedRowKeys:t}),r&&r.length>0?this.setState({isDisabled:!1}):this.setState({isDisabled:!0})},this.resetPagination=()=>new Promise(t=>{this.setState(r=>({params:(0,i.Z)((0,i.Z)({},r.params),{},{pageNumber:1,pageSize:20})}),()=>{t()})}),this.handleTreeSelectChange=t=>{this.setState(r=>({params:(0,i.Z)((0,i.Z)({},r.params),{},{departmentId:t})}),()=>{this.initTableList()})},this.handlePostSelectChange=t=>{this.setState(r=>({params:(0,i.Z)((0,i.Z)({},r.params),{},{postId:t})}),()=>{this.initTableList()})},this.handleSearch=(t,r)=>{var c={keyword:r===""?t:"",userIds:r};this.setState(h=>({params:(0,i.Z)((0,i.Z)({},h.params),c)}),()=>{this.initTableList()})},this.handleExport=()=>{var t=this.state.params,r=t.keyword,c=t.departmentId,h=t.tabId,x=t.postId,_=o.parse(O.m8.location.search),$=_.taskType,ee=_.taskId,Y=_.projectId,he="export_type_01",ge=ee;switch($){case"project":he="export_type_02",ge=Y;break;case"task":case"employee":he="export_type_01";break;case"exam":he="export_type_03",ge="";break;default:}var ye="&keyword=".concat(r,"&departmentId=").concat(c,"&tabId=").concat(h,"&postId=").concat(x,"&exportExamType=").concat(he,"&sourceId=").concat(ge);(0,ce.N)({page:"exportMakeupExamMonitors",props:this.props,query:ye,rest:{examId:this.props.actionId}})},this.renderSearchRow=()=>{var t=this.props,r=t.prefixCls,c=t.t,h=this.state.isDisabled;return a().createElement("div",{className:"".concat(r,"__searchrow")},a().createElement(f.Z,{type:"primary",onClick:this.handleExport},a().createElement(Ee.Z,null),c("common.exportData")),a().createElement(f.Z,{disabled:h,style:{marginLeft:8},onClick:()=>{this.batchDelay(!0)}},this.props.t("exam.batchDelay")))},this.cancelDelay=()=>{this.batchDelay(!1)},this.okDelay=()=>{var t=this.props.t,r=this.state,c=r.userIds,h=r.delayTimeVal;this.form&&this.form.current&&this.form.current.validateFields().then(()=>{L.WY.post({url:Se.setExamDelay({examId:this.props.actionId}),data:{makeupExamEndTime:h,userIds:c}}).then(()=>{d.default.success(t("myExamTask.postponeSuccess")),this.setState({selectedRowKeys:[]}),this.initTableList(),this.batchDelay(!1)})}).catch(()=>{})},this.batchDelay=t=>{this.form&&this.form.current&&this.form.current.resetFields(),this.setState({showBatchDelay:t})},this.disabledDate=t=>t&&t<G()(new Date).add(-1,"days"),this.handleChange=(t,r)=>{this.setState({delayTimeVal:G()(r).valueOf()})},this.renderRightRow=()=>{var t=this.props,r=t.prefixCls,c=t.t,h=this.state.radioList;return a().createElement("div",{className:"".concat(r,"__header-container__between")},a().createElement(q.Z,{showCheckbox:!1,showSearch:!1,showBtn:!1,radioList:h,defaultRadioValue:0,onRadiosChange:this.handleQueryRowRadiosChange}),a().createElement(V.Z,{onSearch:this.handleSearch,width:"272px",placeholder:c("searchInputPlaceholder.userName")}))},this.renderModalFooter=()=>a().createElement("div",{style:{textAlign:"center"}},a().createElement(f.Z,{key:"back",onClick:()=>this.cancelDelay(),style:{width:136}},this.props.t("common.cancel")),a().createElement(f.Z,{key:"submit",type:"primary",onClick:()=>this.okDelay(),style:{width:136}},this.props.t("common.ok"))),this.form=a().createRef(),this.state={params:{planId:"",tabId:0,status:"",departmentId:"",postId:"",keyword:"",pageNumber:1,pageSize:20},radioList:[],tableLoading:!1,tableList:[],tableTotal:0,isDisabled:!0,showBatchDelay:!1,delayTimeVal:null,userIds:[],selectedRowKeys:[]}}componentDidMount(){this.initTableList()}render(){var s=this.props,t=s.prefixCls,r=s.t,c=this.state,h=c.tableTotal,x=c.tableList,_=c.tableLoading,$=c.params,ee=c.showBatchDelay,Y=c.selectedRowKeys,he={total:h,current:$.pageNumber,pageSize:$.pageSize};return a().createElement("div",{className:t},a().createElement(T.Z,{title:this.props.t("common.postpone"),centered:!0,visible:ee,onCancel:()=>this.cancelDelay(),footer:this.renderModalFooter()},a().createElement(l.Z,{name:"time_related_controls",ref:this.form,layout:"vertical"},a().createElement(l.Z.Item,{label:this.props.t("common.endTime"),name:"end_time",rules:[{required:!0,message:r("common.messagePlaceholder")}]},a().createElement(A.Z,{style:{width:"100%"},format:"YYYY-MM-DD HH:mm",disabledDate:this.disabledDate,onChange:this.handleChange,showTime:!0})))),a().createElement("div",{className:"".concat(t,"__header")},a().createElement("div",{className:"".concat(t,"__header-flex")},a().createElement(J.Z,{parentId:"",checkable:!1,asyncLoad:!0,treeSelect:!0,className:"".concat(t,"__header__selectrow cl-search-normal-width"),onTreeSelectChange:this.handleTreeSelectChange}),a().createElement(k.Z,{className:"".concat(t,"__header__selectrow cl-search-normal-width"),onChange:this.handlePostSelectChange}))),a().createElement(Ie,{loading:_,paginationParams:he,list:x,selectedRowKeys:Y,onTableChange:this.handleChangePagination,selectTableData:this.selectTableData,headerTitle:this.renderSearchRow(),toolBarRender:this.renderRightRow}))}}Qe.defaultProps={prefixCls:"plan-monitor__detailtab"};var st=(0,ie.$j)()((0,I.Z)()(Qe));class nt extends a().Component{constructor(){super(...arguments);this.state={activeTabKey:"0",authScope:{visible:!1}},this.handleChangeTab=s=>{this.setState({activeTabKey:s})},this.changeAuthScope=s=>{this.setState({authScope:{visible:s}})}}render(){var s=this.props,t=s.prefixCls,r=s.showDetail,c=r===void 0?!0:r,h=s.t,x=this.state,_=x.activeTabKey,$=x.authScope,ee=o.parse(O.m8.location.search),Y=ee.id;return Y?a().createElement("div",{className:t},a().createElement(b.Z,{title:h("documentTitle.employeeMonitoring")}),a().createElement(ae,{actionId:Y,authScope:$}),a().createElement("div",{className:"".concat(t,"__content")},a().createElement(Z.Z,{activeKey:_,animated:!1,onChange:this.handleChangeTab},a().createElement(Z.Z.TabPane,{tab:h("study.monitoring"),key:"0"},a().createElement("div",{className:"".concat(t,"__content-tab_container")},a().createElement("div",null,a().createElement(Te,{actionId:Y,changeAuthScope:this.changeAuthScope})))),a().createElement(Z.Z.TabPane,{tab:h("study.questionAnalysis"),key:"1"},a().createElement("div",{className:"".concat(t,"__content-tab_container")},a().createElement("div",null,a().createElement(ue,{actionId:Y})))),c?a().createElement(Z.Z.TabPane,{tab:h("study.reTestDetails"),key:"2"},a().createElement("div",{className:"".concat(t,"__content-tab_container")},a().createElement("div",null,a().createElement(st,{actionId:Y})))):null))):null}}nt.defaultProps={prefixCls:"plan-monitor"};var ot=(0,I.Z)()(nt)},31945:function(xe,te,e){"use strict";e.d(te,{Z:function(){return Ze}});var me=e(88983),Z=e(47933),X=e(20228),a=e(11382),I=e(62029),o=e(30887),O=e(99210),b=e(59250),v=e(13013),C=e(57663),B=e(71577),Q=e(63185),W=e(9676),F=e(71194),f=e(57016),i=e(88986),pe=e(34792),d=e(48086),M=e(43358),T=e(34041),U=e(12924),y=e.n(U),re=e(28216),se=e(91768),K=e(57254),p=e(18329);class L extends y().Component{constructor(){super(...arguments);this.onCancel=()=>{this.props.showReferenceCourseList()}}render(){var m=this.props,N=m.visible,D=m.courseList,H=m.t;return y().createElement(p.ZP,{visible:N,title:H("common.tip"),onCancel:this.onCancel,onOk:this.onCancel},y().createElement("div",{className:"referenceWithOtherCourses"},y().createElement("div",{className:"referenceWithOtherCourses__tip"},H("course.deleteCourseTip")),D.map((J,k)=>y().createElement("div",{className:"referenceWithOtherCourses__item",key:k},D.length>1?"".concat(k+1,"\u3001"):null," ",J))))}}var E=(0,se.Z)()(L),g=e(10237),S=e(63848),P=e(58546),R=e(30389),w=e(54792),j=e(86726),ae=e(37055),le=T.Z.Option,oe={setClassify:ae.ZP.CourseManageList.setClassify,setScore:ae.ZP.CourseManageList.setScore,setBatchEmployee:ae.ZP.CourseManageList.setBatchEmployee,deleteCourse:ae.ZP.CourseManageList.deleteCourse,exportCourseView:ae.ZP.CourseManageList.exportCourseView,syncCourse:ae.ZP.CourseManageList.syncCourse},ie=fe=>({qyShield:fe.user.qyShield});class Ee extends y().Component{constructor(){super(...arguments);this.state={classifyProps:{visible:!1},scoreProps:{title:this.props.t("course.setCredits"),labelTxt:this.props.t("course.credit"),initialValue:"",visible:!1},employeeProps:{visible:!1,initialParams:{employeeRange:{rangeType:3,rangeList:{dept:[],post:[],group:[],user:[]}}}},asyncProps:{value:0,visible:!1},showReferenceCourseListProps:{visible:!1,courseList:[],onOk:this.showReferenceCourseList,onCancel:this.showReferenceCourseList}},this.handleChangeClassify=m=>{this.props.onClassifyChange(m)},this.handleChangeType=m=>{this.props.onTypeChange(m)},this.handleChangeCourseType=m=>{this.props.onCourseTypeChange(m)},this.actionChangeClassify=()=>{this.setState({classifyProps:{visible:!0}})},this.handleCategoryCancel=()=>{this.setState({classifyProps:{visible:!1}})},this.handleCategoryOk=m=>{var N=m.node,D=this.props,H=D.selectedCourseIds,J=D.selectedProjectIds,k=D.onForceRender,V=D.t,q=N.id;q&&g.qg.post({url:oe.setClassify(),data:{course_ids:H.join(","),project_ids:J.join(","),classify_id:q}}).then(()=>{d.default.success(V("course.setCourseClassifySuccess")),k()}),this.handleCategoryCancel()},this.actionSetScore=()=>{this.setState(m=>({scoreProps:(0,i.Z)((0,i.Z)({},m.scoreProps),{},{initialValue:"",visible:!0})}))},this.handleScoreCancel=()=>{this.setState(m=>({scoreProps:(0,i.Z)((0,i.Z)({},m.scoreProps),{},{visible:!1})}))},this.handleScoreOk=m=>{var N=m.value;if(N===0){this.handleScoreCancel();return}var D=this.props,H=D.selectedCourseIds,J=D.selectedProjectIds,k=D.onForceRender,V=D.t;g.qg.post({url:oe.setScore(),data:{course_ids:H.join(","),project_ids:J.join(","),credit:N}}).then(()=>{d.default.success(V("course.setCourseScoreSuccess")),k()}),this.handleScoreCancel()},this.actionSetEmployeeRange=()=>{this.setState(m=>({employeeProps:(0,i.Z)((0,i.Z)({},m.employeeProps),{},{visible:!0})}))},this.handleEmployeeCancel=()=>{this.setState({employeeProps:{visible:!1,initialParams:{employeeRange:{rangeType:3,rangeList:{dept:[],post:[],group:[],user:[]}}}}})},this.handleEmployeeOk=m=>{var N=this.props,D=N.selectedCourseIds,H=N.selectedProjectIds,J=N.onForceRender,k=N.t,V=m.isAll,q=m.departmentIds,ce=m.groupIds,de=m.postIds,ve=m.userIds,Te=m.qy_we_chat_vo;g.WY.post({url:oe.setBatchEmployee(),data:{course_ids:D.join(","),project_ids:H.join(","),department_ids:q,group_ids:ce,is_all:V,post_ids:de,user_ids:ve,qy_we_chat_vo:Te}}).then(()=>{d.default.success(k("personal.batchSetRangeSuccess")),J()}),this.handleEmployeeCancel()},this.showReferenceCourseList=m=>{this.setState(N=>({showReferenceCourseListProps:(0,i.Z)((0,i.Z)({},N.showReferenceCourseListProps),{},{visible:!N.showReferenceCourseListProps.visible,courseList:m||[]})}))},this.actionDelete=()=>{var m=this.props,N=m.selectedCourseIds,D=m.selectedProjectIds,H=m.list,J=m.onForceRender,k=m.t,V=0,q=0,ce=[];if(H.forEach(de=>{N.includes(de.course_id)&&(de.reference_plan_count>0&&(q+=1),de.reference_plan_count>0&&ce.push(de.title),de.can_delete==="true"&&(V+=1))}),q>0)this.showReferenceCourseList(ce);else if(V!==N.length)d.default.warning(k("personal.deletePlatformCourseTip"));else{if(D.length>0){d.default.warning(k("personal.deleteProjectCourseTip"));return}f.Z.confirm({title:k("common.tip"),content:k("common.confirmDeleteTitle"),onOk(){g.qg.post({url:oe.deleteCourse(),data:{enterpriseId:ae.ZP.enterpriseId,ids:N.join(","),project_ids:D.join(",")}}).then(de=>{var ve=de.data,Te=ve.code,Pe=ve.msg;d.default["".concat(Te===0?"success":"warning")](Pe),Te===0&&J()})}})}},this.actionSyncSetting=()=>{this.setState(m=>({asyncProps:(0,i.Z)((0,i.Z)({},m.asyncProps),{},{visible:!0})}))},this.onAsyncChange=m=>{this.setState(N=>({asyncProps:(0,i.Z)((0,i.Z)({},N.asyncProps),{},{value:m.target.value})}))},this.handleSyncCancel=()=>{this.setState({asyncProps:{visible:!1,value:0}})},this.handleSyncOk=()=>{var m=this.props,N=m.selectedCourseIds,D=m.selectedProjectIds,H=m.onForceRender,J=m.t,k=this.state.asyncProps;g.qg.post({url:oe.syncCourse(),data:{course_ids:N.join(","),project_ids:D.join(","),syncProgress:k.value}}).then(V=>{var q=V.data,ce=q.code,de=q.msg;ce===0?(d.default.success(J("setting.setUpSucceed")),H()):d.default.warning(de)}),this.handleSyncCancel()},this.actionImportDetail=()=>{var m=this.props,N=m.selectedCourseIds,D=m.selectedProjectIds,H=m.onForceRender,J=m.t;if(N.concat(D).length>20){d.default.warning(J("courseManage.exportMoreTip"));return}var k=oe.exportCourseView(),V={course_Ids:N.join(","),project_Ids:D.join(",")};g.WY.get({url:k,params:V}).then(q=>{q.data.code===200&&d.default.success("\u6587\u4EF6\u751F\u6210\u4E2D\uFF0C\u8BF7\u7A0D\u540E\u5728\u6587\u4EF6\u4E0B\u8F7D\u4E2D\u4E0B\u8F7D"),H(),this.getDownloadingNumber()})},this.getDownloadingNumber=()=>{var m=ae.ZP.downLoadCenter.getDownLoadingCount();g.WY.get({url:m,params:{}}).then(N=>{sessionStorage.setItem("downloadingCount",N.data.data),this.props.dispatch({type:"download/updateDownloadingNumber",downloadingNumber:N.data.data})}).catch(()=>{sessionStorage.setItem("downloadingCount",0),this.props.dispatch({type:"download/updateDownloadingNumber",downloadingNumber:0})})},this.handleChangeCheckBox=m=>{this.props.onCheckboxChange(m.target.checked)},this.handleSharingQueryRowCheckboxChange=m=>{this.props.onSharingCheckboxChange(m.target.checked)},this.renderCondition=()=>{var m=this.props,N=m.prefixCls,D=m.params,H=m.qyShield,J=m.t,k=D.classify_id?D.classify_id.split(","):[];return y().createElement("div",{className:"".concat(N,"__condition")},this.props.extraDom&&this.props.extraDom(),y().createElement(S.Z,{onChange:this.handleChangeClassify,className:"cl-search-normal-width",value:k,showLabel:!1,placeholder:"Please select",queryType:"course_manage",unclassified:"true"}),y().createElement(T.Z,{value:D.type,className:"cl-search-normal-width",onChange:this.handleChangeType},y().createElement(le,{value:""},this.props.t("courseManage.allOrigin")),y().createElement(le,{value:"original"},this.props.t("courseManage.originalCourse")),y().createElement(le,{value:"notOriginal"},this.props.t("courseManage.nonOriginalCourse")),y().createElement(le,{value:"platform"},this.props.t("courseManage.platformProcurement"))),this.props.courseType&&this.props.courseType=="graphic"?null:y().createElement(T.Z,{value:D.course_type,className:"cl-search-normal-width",onChange:this.handleChangeCourseType},y().createElement(le,{value:"all"},this.props.t("courseManage.allType")),y().createElement(le,{value:"course"},this.props.t("common.courseLabel")),y().createElement(le,{value:"microCourse"},this.props.t("common.microCourse")),y().createElement(le,{value:"project"},this.props.t("leftMenuLists.studyProject"))),y().createElement(W.Z,{onChange:this.handleChangeCheckBox,style:{marginRight:16}},J("common.myCreated")),this.props.courseType&&this.props.courseType==="graphic"&&H==="false"?y().createElement(W.Z,{onChange:this.handleSharingQueryRowCheckboxChange},J("common.sharing")):null)},this.renderActions=()=>{var m=this.props,N=m.prefixCls,D=m.selectedCourseIds,H=m.selectedProjectIds,J=m.showNum,k=J===void 0?1:J,V=this.props.allowActions,q=(0,j.H3)("delete",V),ce=(0,j.H3)("adjustment_classification",V),de=(0,j.H3)("set_visible",V),ve=(0,j.H3)("export",V),Te=(0,j.H3)("set_score",V),Pe=(0,j.H3)("progressSync",V),Me=[{name:this.props.t("courseManage.adjustClassification"),type:"actionChangeClassify",isShow:ce},{name:this.props.t("courseManage.exportViewDetail"),type:"actionImportDetail",isShow:ve},{name:this.props.t("courseManage.setCredits"),type:"actionSetScore",isShow:Te},{name:this.props.t("courseManage.setTheVisibilityed"),type:"actionSetEmployeeRange",isShow:de},{name:this.props.t("common.delete"),type:"actionDelete",isShow:q},{name:this.props.t("common.scheduleSyncSetting"),type:"actionSyncSetting",isShow:Pe}],De=Me.filter(Re=>Re.isShow),_e=[],we=[];if(De.length)k?(_e=[...De.slice(0,k)],we=[...De.slice(k)]):we=[...De];else return null;return y().createElement("div",{className:"".concat(N,"__action")},_e.map(Re=>y().createElement(B.Z,{style:{marginRight:"8px"},key:Re.type,disabled:!(D.length+H.length),onClick:this[Re.type]},Re.name)),we.length?y().createElement(v.Z,{disabled:!(D.length+H.length),overlay:this.renderMoreButton({buttons:we})},y().createElement(B.Z,{className:"cl-pointer"},"".concat(this.props.t("common.more"))," ",y().createElement(K.Z,null))):"")}}renderMoreButton(m){var N=m.buttons,D=this.props,H=D.selectedCourseIds,J=D.selectedProjectIds;return y().createElement(O.Z,{onClick:k=>{var V=k.key;this[V]()}},N.map(k=>k.isShow?y().createElement(O.Z.Item,{key:k.type,disabled:!(H.length+J.length)},y().createElement("span",{className:"cl-pointer"},k.name)):null))}render(){var m=this.props,N=m.prefixCls,D=m.t,H=m.showRenderCondition,J=H===void 0?!0:H,k=m.showRenderActions,V=k===void 0?!0:k,q=this.state,ce=q.classifyProps,de=q.scoreProps,ve=q.employeeProps,Te=q.showReferenceCourseListProps,Pe=q.asyncProps;return y().createElement("div",{className:N},J&&this.renderCondition(),V&&this.renderActions(),y().createElement(P.Z,(0,I.Z)({},ce,{title:D("personal.chooseClassify"),onCancel:this.handleCategoryCancel,onOk:this.handleCategoryOk})),y().createElement(w.Z,(0,I.Z)({},de,{onCancel:this.handleScoreCancel,onCreate:this.handleScoreOk})),ve.visible&&y().createElement(R.Z,(0,I.Z)({},ve,{title:D("courseManage.setTheVisibility"),mode:["all","part","private"],orgProps:{title:D("component.chooseVisibleScope")},isLoading:!ve.visible,onCancel:this.handleEmployeeCancel,onCreate:this.handleEmployeeOk})),Pe.visible&&y().createElement(p.ZP,{wrapClassName:"cl-async-selector-modal",visible:Pe.visible,title:D("common.scheduleSyncSetting"),okText:D("common.ok"),cancelText:D("common.cancel"),onCancel:this.handleSyncCancel,onOk:this.handleSyncOk},Pe.visible?y().createElement("div",{className:"".concat(N,"__async")},y().createElement("p",null," ",D("common.scheduleSyncSettingTip")),y().createElement(Z.ZP.Group,{onChange:this.onAsyncChange,value:Pe.value},y().createElement(Z.ZP,{value:0},D("common.outSync")),y().createElement(Z.ZP,{value:1},D("common.synchronization")))):y().createElement(a.Z,{size:"large"})),y().createElement(E,(0,I.Z)({},Te,{showReferenceCourseList:this.showReferenceCourseList})))}}Ee.defaultProps={prefixCls:"resource-course-list-page__release__content__queryrow",rangeType:""};var Ze=(0,se.Z)()((0,re.$j)(ie)(Ee))}}]);
