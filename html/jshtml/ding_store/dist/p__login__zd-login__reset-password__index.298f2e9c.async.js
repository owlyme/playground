(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[2032],{63443:function(P,p,o){"use strict";o.r(p),o.d(p,{default:function(){return V}});var N=o(57663),T=o(71577),u=o(47673),g=o(4107),C=o(34792),D=o(48086),i=o(71194),a=o(57016),e=o(88986),f=o(12924),t=o.n(f),w=o(28216),c=o(76651),h=o(49147),y=o(5430),v=o(28049),L=o(37055),F=o(10237),b=d=>{var r=CONFIG.Login.amendPassword();return request.post({url:r,data:d})},x=(d,r)=>{var s=L.ZP.Login.resetPassword();return F.WY.post({url:s,params:d,data:r})},M=(d,r)=>{var s=L.ZP.Login.resetVerification();return F.WY.post({url:s,params:d,data:r})};function k(d){var r=CONFIG.Login.login();return formDataRequest.post({url:r,data:_objectSpread(_objectSpread({},d),{},{domain:1})})}var Z=o(84874),I=o(91768);class S extends f.Component{constructor(){super(...arguments);this.state={resetData:{corp_id:"",mobile:"",new_password:"",new_password_flag:!0,affirm_Password:"",affirm_Password_flag:!0,verification_code:"",get_verification:"",verifyFlag:!1,verifyTime:60,loading:!1,passwordType1:"text",passwordType2:"text",passwordDisabled1:!0,passwordDisabled2:!0},VerificationTime:null},this.handleInputName=r=>{if(!(r.target.value&&!/^[0-9-]+$/.test(r.target.value))){var s=r.target.value;(this.state.resetData.mobile.length<16||s.length<16)&&this.setState({resetData:(0,e.Z)((0,e.Z)({},this.state.resetData),{},{mobile:s})})}},this.clearName=()=>{this.setState({resetData:(0,e.Z)((0,e.Z)({},this.state.resetData),{},{mobile:""})})},this.handleInputVerify=r=>{this.setState({resetData:(0,e.Z)((0,e.Z)({},this.state.resetData),{},{verification_code:r.target.value.trim()})})},this.handleInputNewPass=r=>{if(r.target.value.length===0){this.setState({resetData:(0,e.Z)((0,e.Z)({},this.state.resetData),{},{new_password:r.target.value,passwordType1:"text",passwordDisabled1:!0})});return}this.setState({resetData:(0,e.Z)((0,e.Z)({},this.state.resetData),{},{new_password:r.target.value.trim()})},()=>{this.setState({resetData:(0,e.Z)((0,e.Z)({},this.state.resetData),{},{passwordType1:"password"})})})},this.passwordDisabled1=()=>{this.setState({resetData:(0,e.Z)((0,e.Z)({},this.state.resetData),{},{passwordDisabled1:!1})})},this.passwordType1=()=>{this.setState({resetData:(0,e.Z)((0,e.Z)({},this.state.resetData),{},{passwordType1:this.state.resetData.passwordType1==="password"?"text":"password"})})},this.handleInputAffirmPass=r=>{if(r.target.value.length===0){this.setState({resetData:(0,e.Z)((0,e.Z)({},this.state.resetData),{},{affirm_Password:r.target.value,passwordType2:"text",passwordDisabled2:!0})});return}this.setState({resetData:(0,e.Z)((0,e.Z)({},this.state.resetData),{},{affirm_Password:r.target.value.trim()})},()=>{this.setState({resetData:(0,e.Z)((0,e.Z)({},this.state.resetData),{},{passwordType2:"password"})})})},this.passwordType2=()=>{this.setState({resetData:(0,e.Z)((0,e.Z)({},this.state.resetData),{},{passwordType2:this.state.resetData.passwordType2==="password"?"text":"password"})})},this.passwordDisabled2=()=>{this.setState({resetData:(0,e.Z)((0,e.Z)({},this.state.resetData),{},{passwordDisabled2:!1})})},this.getResetVerification=()=>{var r=(0,v.gG)(this.state.resetData.mobile),s=this.props.t;if(r)return a.Z.warning({title:s("registerLogin.resetFailed"),content:r,centered:!0,okText:s("common.ok")}),!1;if(this.state.resetData.verifyFlag)return D.default.warning(s("registerLogin.doNotSubmitRepeatedly")),!1;M({corp_id:y.ZP.corpId},{mobile:this.state.resetData.mobile}).then(()=>{this.setState({resetData:(0,e.Z)((0,e.Z)({},this.state.resetData),{},{verifyFlag:!0})}),this.startVerificationTime()}).catch(n=>{a.Z.warning({title:s("registerLogin.sendFailed"),content:h.Z[n.response.data.code].content,centered:!0,okText:s("common.ok")})})},this.startVerificationTime=()=>{var r=null;r=setInterval(()=>{var s=this.state.resetData.verifyTime-1;if(s===0){clearInterval(this.state.VerificationTime),this.setState({resetData:(0,e.Z)((0,e.Z)({},this.state.resetData),{},{verifyFlag:!1,verifyTime:60})});return}this.setState({resetData:(0,e.Z)((0,e.Z)({},this.state.resetData),{},{verifyTime:s})})},1e3),this.setState({VerificationTime:r})},this.resetSubmit=()=>{var r=(0,v.gG)(this.state.resetData.mobile),s=this.props.t;if(r)return a.Z.warning({title:s("registerLogin.resetFailed"),content:r,centered:!0,okText:s("common.ok")}),!1;var n=(0,v.pF)(this.state.resetData.verification_code);if(n)return a.Z.warning({title:s("registerLogin.resetFailed"),content:n,centered:!0,okText:s("common.ok")}),!1;var l=(0,v.ZX)(s("registerLogin.new"),this.state.resetData.new_password);if(l)return a.Z.warning({title:s("registerLogin.resetFailed"),content:l,centered:!0,okText:s("common.ok")}),!1;var m=(0,v.ZX)(s("localStorage.onSure"),this.state.resetData.affirm_Password);if(m)return a.Z.warning({title:s("registerLogin.resetFailed"),content:m,centered:!0,okText:s("common.ok")}),!1;if(this.state.resetData.new_password!==this.state.resetData.affirm_Password)return a.Z.warning({title:s("registerLogin.resetFailed"),content:s("registerLogin.passwordsInconsistent"),centered:!0,okText:s("common.ok")}),!1;this.setState({resetData:(0,e.Z)((0,e.Z)({},this.state.resetData),{},{loading:!0})}),x({corp_id:y.ZP.corpId},{mobile:this.state.resetData.mobile,verification_code:this.state.resetData.verification_code,new_password:this.state.resetData.new_password}).then(E=>{this.setState({resetData:(0,e.Z)((0,e.Z)({},this.state.resetData),{},{loading:!1})}),E.data.result&&(D.default.success(s("registerLogin.passwordResetTips")),setTimeout(()=>{c.m8.goBack()},2e3))}).catch(E=>{this.setState({resetData:(0,e.Z)((0,e.Z)({},this.state.resetData),{},{loading:!1})}),a.Z.warning({title:s("registerLogin.resetFailed"),content:h.Z[E.response.data.code].content?h.Z[E.response.data.code].content:s("registerLogin.networkAnomaly"),centered:!0,okText:s("common.ok")})})},this.loginReturn=()=>{c.m8.go(-1)}}render(){var r=this.props,s=r.prefixCls,n=r.t,l=this.state.resetData;return t().createElement("div",{className:s},t().createElement("div",{className:"reset-content"},t().createElement("div",{className:"reset-return",onClick:()=>this.loginReturn()},t().createElement(Z.Z,{iconClass:"icon-f-close",color:"#D0D4E3"})),t().createElement("div",{className:"reset-ontent-title"},n("account.resetPasswords")),t().createElement("div",{className:"reset-form"},t().createElement("div",{className:"reset-form-item"},t().createElement("p",{className:"reset-form-item-name"},n("marketing.telPhone")),t().createElement("div",{className:"reset-item-verify"},t().createElement(g.Z,{type:"text",placeholder:n("marketing.phoneError"),value:l.mobile,onInput:m=>this.handleInputName(m)}),l.mobile!==""&&t().createElement("div",{onClick:()=>this.clearName(),className:"reset-form-clear"},t().createElement(Z.Z,{iconClass:"icon-qingchu",color:"#D0D4E3"})))),t().createElement("div",{className:"reset-form-item"},t().createElement("p",{className:"reset-form-item-name"},n("registerLogin.verificationCode")),t().createElement("div",{className:"reset-item-verify"},t().createElement(g.Z,{placeholder:n("registerLogin.inputVerificationCode"),value:l.verification_code,onInput:m=>this.handleInputVerify(m),maxLength:"6"}),t().createElement("div",{onClick:()=>this.getResetVerification(),className:"reset-item-verify-box"},l.verifyFlag?t().createElement("p",{className:"reset-item-verify-num"},l.verifyTime,"s"):t().createElement("p",{className:"reset-item-verify-tips"},n("registerLogin.getVerificationCode"))))),t().createElement("div",{className:"reset-form-item"},t().createElement("p",{className:"reset-form-item-name"},n("registerLogin.newPassword")),t().createElement("div",{className:"reset-item-verify"},t().createElement(g.Z,{type:l.passwordType1,placeholder:n("registerLogin.newPasswordTips"),value:l.new_password,onChange:m=>this.handleInputNewPass(m),maxLength:"20",onClick:()=>this.passwordDisabled1()}),l.new_password!==""&&t().createElement("div",{onClick:()=>this.passwordType1(),className:"reset-form-clear"},t().createElement(Z.Z,{iconClass:"icon-FView",color:"#D0D4E3"})))),t().createElement("div",{className:"reset-form-item"},t().createElement("p",{className:"reset-form-item-name"},n("registerLogin.confirmPassword")),t().createElement("div",{className:"reset-item-verify"},t().createElement(g.Z,{type:l.passwordType2,placeholder:n("registerLogin.againEnterPassword"),value:l.affirm_Password,onChange:m=>this.handleInputAffirmPass(m),maxLength:"20",onClick:()=>this.passwordDisabled2()}),l.affirm_Password!==""&&t().createElement("div",{onClick:()=>this.passwordType2(),className:"reset-form-clear"},t().createElement(Z.Z,{iconClass:"icon-FView",color:"#D0D4E3"}))))),t().createElement("div",{className:"reset-form-btn",onClick:()=>this.resetSubmit()},t().createElement(T.Z,{type:"primary",loading:l.loading},n("localStorage.onSure")))))}}S.defaultProps={prefixCls:"zd-reset-login-container"};var V=(0,w.$j)(d=>({user:d.user}))((0,I.Z)()(S))},28049:function(P,p,o){"use strict";o.d(p,{gG:function(){return g},ZX:function(){return C},pF:function(){return D}});var N=o(24663),T={isNotEmpty(i,a){if(i==="")return a},minLength(i,a,e){if(i.length<a)return e},maxLength(i,a,e){if(i.length>a)return e},fixationLength(i,a,e){if(i.length!=Number(a))return e},mobileFormat(i,a){if(!/^[0-9-]+$/.test(i))return a},passwordFormat(i,a){if(!/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]*$/.test(i))return a},verificationFormat(i,a){if(!/^\d{6}$/.test(i))return a},passwordImprove:N.r},u=function(){this.cache=[]};u.prototype.add=function(i,a){for(var e=this,f=0,t;t=a[f++];)(function(w){var c=w.strategy.split(":"),h=w.errorMsg;e.cache.push(function(){var y=c.shift();return c.unshift(i),c.push(h),T[y].apply(i,c)})})(t)},u.prototype.start=function(){for(var i=0,a;a=this.cache[i++];){var e=a();if(e)return e}};var g=i=>{var a=new u;a.add(i,[{strategy:"isNotEmpty",errorMsg:"\u624B\u673A\u53F7\u7801\u4E0D\u80FD\u4E3A\u7A7A"},{strategy:"maxLength:16",errorMsg:"\u624B\u673A\u53F7\u7801\u6700\u957F\u4E3A16\u4F4D"},{strategy:"mobileFormat",errorMsg:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7\u7801"}]);var e=a.start();return e},C=(i,a)=>{var e=new u;e.add(a,[{strategy:"isNotEmpty",errorMsg:"".concat(i,"\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A")},{strategy:"minLength:6",errorMsg:"".concat(i,"\u5BC6\u7801\u957F\u5EA6\u4E0D\u80FD\u5C0F\u4E8E6\u4F4D")},{strategy:"maxLength:20",errorMsg:"".concat(i,"\u5BC6\u7801\u957F\u5EA6\u4E0D\u80FD\u5927\u4E8E20\u4F4D")},{strategy:"passwordImprove",errorMsg:"".concat(i,"\u5BC6\u7801\u5FC5\u987B\u5305\u542B\u6570\u5B57\u548C\u5927\u5C0F\u5199\u5B57\u6BCD\u7EC4\u6210")}]);var f=e.start();return f},D=i=>{var a=new u;a.add(i,[{strategy:"isNotEmpty",errorMsg:"\u9A8C\u8BC1\u7801\u4E0D\u80FD\u4E3A\u7A7A"},{strategy:"verificationFormat",errorMsg:"\u9A8C\u8BC1\u7801\u4E3A6\u4F4D\u6570\u5B57\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165"}]);var e=a.start();return e}}}]);
