(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[3970],{54624:function(se,j,e){"use strict";e.d(j,{Z:function(){return pe}});var _=e(47673),D=e(4107),Y=e(12924),i=e.n(Y),V=e(91768),h=e(80991),H=e(54549),E=e(49101),k=e(62029),c=e(59250),B=e(13013),N=e(30887),P=e(99210),R=e(43185),x=e(53251),G=e(57663),K=e(71577),b=e(88986),u=e(57361),L=e(34792),n=e(48086),s=e(9754),p=e.n(s),f=e(28216),A=e(73566),F=e(49146),v=e(74262),a=e(40938),r=e(6793),l=e(54531),T=e(10237),M=e(84874),z=e(1164),y=e(37055),O=e(10780),$=e(43967),ae=e(76466),J=5,q=X=>({uploaderList:X.uploader.list,uploadSucceedItem:X.uploader.uploadSucceedItem,uploadComponentType:X.uploader.uploadComponentType,appType:X.user.appType,dingUserId:X.user.account,corpId:X.user.corpId}),ie=X=>{if(X.icon)return X.icon;var m=X.name.split(".").pop(),g=y.e1[m];return g||"iconf-matter-picture"};class re extends i().Component{constructor(m){var g;super(m);g=this,this.handleBeforeUpload=t=>{var o=this.props,d=o.t,C=o.value;if(t.type.indexOf("image")<0)return n.default.warning(d("component.stageAddFileFormatTip")),!1;this.props.onChange(C.concat(t))},this.handleOnChange=t=>{var o=t.file,d=this.props,C=d.value,S=d.t;o.status==="done"?this.props.onChange(C.filter(I=>I.id!==o.id).concat(o.response.data)):o.status==="error"&&(n.default.error("".concat(o.name," ").concat(S("course.courseDetailCoverFailure"))),this.props.onChange(C.filter(I=>I.id!==o.id)))},this.handleRemove=t=>{var o=this.props.value;this.props.onChange(o.filter(d=>d.id!==t.id))},this.handleUploadFile=()=>{this.setState({showFileSelector:!0})},this.handleSelectedCancel=()=>{this.setState({showFileSelector:!1})},this.handleSelectedAttachment=t=>{var o=this.props,d=o.t,C=o.value,S=C.map(U=>U.id),I=t.filter(U=>!S.includes(U.id)),W=C.length;if(I.length>J-W){n.default.warning((0,r.ZT)(d("component.stageAddFileTip"),5));return}this.handleSelectedCancel(),I=I.map(U=>(U.size=U.data.size,U)),this.props.onChange(C.concat(I))},this.handleChooseFiles=t=>{var o=this.props,d=o.t,C=o.value,S=o.uploaderList,I=o.uploadComponentId,W=o.notLibrary,U=o.hasZip,Z=U===void 0?"":U,te=(0,$.Y5)(S);if(t.target.files.length+te.length+C.length>5){n.default.warning((0,r.ZT)(d("component.stageAddFileTip"),5));return}this.props.dispatch({type:"uploader/chooseFiles",payload:{choosedFiles:t.target.files,dispatch:this.props.dispatch,uploadComponentType:I,notLibrary:W,hasZip:Z==="true"}}),t.target.value=null,t.target.files=null},this.handlePreview=t=>{var o=this.props.t;if(!dd.version&&t.biz_type===3){n.default.info(o("practiceOperation.dingFileTip"));return}if(t.biz_type!==3){this.handlePreviewSystemFile(t);return}var d=y.ZP.DingSpaceId.getSpaceId(),C={corpId:this.props.corpId,userId:this.props.account,fileids:t.url,timeStamp:Date.parse(new Date)};T.WY.get({url:d,params:C}).then(S=>{S.data.code===0?this.ddSpacePreview(t):n.default.info(S.data.msg)}).catch(S=>{n.default.error(S.data)})},this.handlePreviewDingFile=(0,u.Z)(p().mark(function t(){var o,d,C,S,I,W,U,Z;return p().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return o=g.props,d=o.corpId,C=o.dingUserId,S=o.value,I=o.t,Q.next=3,(0,l.Cz)({corpId:d,userId:C});case 3:W=Q.sent,U=w=>{(0,F.jz)(w,3).then(ee=>{if(ee.data.code===0){var ne=(0,F.GY)(ee.data,g.props);ne&&ne.length>0&&g.props.onChange(S.concat(ne))}}).catch(ee=>console.error(ee))},Z=w=>{n.default.warn("".concat(I("learning.dingSelectError"),": ").concat(JSON.parse(w)))},(0,l.yZ)({space:{spaceId:W,corpId:d,max:5},types:["space"],onSuccess:U,onFail:Z});case 7:case"end":return Q.stop()}},t)})),this.dealWatchType=t=>{var o=y.Yq.findIndex(te=>t.type.toLowerCase().includes(te))>-1,d=t.content_type.indexOf("video")>-1,C=y.Ss.indexOf(t.content_type)>-1,S=t.type.indexOf("image")>-1||t.type.indexOf("picture")>-1||t.content_type.indexOf("image")>-1||t.content_type.indexOf("picture")>-1,I=t.content_type.indexOf("html")>-1,W=t.content_type.indexOf("scorm")>-1,U=t.content_type.indexOf("h5")>-1,Z="";return U?Z="article":o?Z="doc":d||C?Z="video":S?Z="image":I?Z="html":W&&(Z="scorm"),Z},this.handlePreviewSystemFile=t=>{var o=this.state.previewInfo,d=this.dealWatchType(t),C=y.Ss.indexOf(t.content_type)>-1;if(d==="scorm"){var S=t.url.split("//"),I=S[1].split("/"),W=[S[0],I[0]].join("//"),U="".concat(W,"/unzip_file/coolcollege-scorm/prod/preview.html?scormUrl=").concat(encodeURIComponent(t.url));z.Z.targetTo({path:U,isExternalLink:!0});return}if(d==="article"){var Z=t.content_type,te=t.url,Q=Z==="h5/link";Q?z.Z.targetTo({path:te,isExternalLink:!0}):z.Z.targetTo({path:"/training/resourceManage/library/articlePreview?id=".concat(t.id)});return}var w={mode:"preview",watchType:d};d==="doc"?Object.assign(w,{resourceInfo:{type:"",docType:t.type,aliUrl:t.path,url:t.url,docTitle:t.name,playId:t.videoId||t.video_id,storageType:t.storage_type}}):d==="image"?Object.assign(w,{resourceInfo:{url:t.url,playId:t.videoId||t.video_id,storageType:t.storage_type}}):d==="html"?Object.assign(w,{resourceInfo:{url:t.url}}):Object.assign(w,{resourceInfo:{source:{FD:t.url,OD:t.path},originUrl:t.url,contentType:C?"mp3":t.type,playId:t.videoId||t.video_id,storageType:t.storage_type},autoPlay:!0,draggable:!0}),this.setState({resourcePlayInfo:w,previewInfo:(0,b.Z)((0,b.Z)({},o),{},{title:t.name,visible:!0,onCancel:this.cancelPreview})})},this.cancelPreview=()=>{var t=this.state.previewInfo;this.setState({resourcePlayInfo:{mode:"preview",watchType:"",resourceInfo:{}},previewInfo:(0,b.Z)((0,b.Z)({},t),{},{visible:!1})})},this.ddSpacePreview=t=>{var o={spaceId:t.path,fileId:t.url,fileName:t.name,fileSize:t.size,fileType:t.type};(0,l.DR)(o)},this.renderFileListItem=(t,o,d)=>i().createElement("div",{className:"file-list-item-coach",key:t.id||t.uid},i().createElement("span",{className:"file-list-item-coach__index"},d+1),i().createElement(M.Z,{iconClass:ie(t),size:"16px"}),i().createElement("div",{className:"file-list-item-coach__info"},i().createElement("span",{className:"name"},t.name),t.id&&i().createElement("span",{className:"size"},t.size/1e3,"KB"),!t.id&&i().createElement("span",{className:"size"},"\u4E0A\u4F20\u4E2D")),o?i().createElement(K.Z,{type:"link",className:"file-list-item-coach__remove-btn",onClick:()=>{this.handleRemove(t)}},i().createElement(M.Z,{iconClass:"icon-icon_close",size:"12px"})):i().createElement("div",{style:{width:12}})),this.handleCancelUpload=()=>{this.setState({uploadVisible:!1})},this.uploadSuccess=t=>{var o=this.props,d=o.t,C=o.value;if(t.length+C.length>5){n.default.warning((0,r.ZT)(d("component.stageAddFileTip"),5));return}var S=t.map(I=>{var W=y.Ss.indexOf(I.originalType)>-1;return{id:I.id,name:I.name,duration:I.duration,type:I.type,originalType:I.type,icon:y.e1[W?"mp3":I.type],status:I.status,size:I.size}});this.props.onChange(this.props.value.concat(S)),this.setState({uploadVisible:!1})},this.state={showFileSelector:!1,UploadConfig:{data:{access_token:localStorage.token},action:y.ZP.PostAbility.operateAttachmentUpload(),beforeUpload:this.handleBeforeUpload,accept:".jpg,.jpeg,.png,.gif",showUploadList:!1,onChange:this.handleOnChange},uploadVisible:!1,resourcePlayInfo:{mode:"preview",watchType:"",resourceInfo:{},autoPlay:!0,draggable:!0},isDingDiskChoose:!1,previewInfo:{visible:!1,destroyOnClose:!0,title:this.props.t("resourceLibrary.previewCourseware"),onCancel:()=>{}}}}componentDidMount(){var m=this;return(0,u.Z)(p().mark(function g(){var t;return p().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return(0,l.TN)(),d.next=3,(0,F.uj)("operation");case 3:t=d.sent,m.setState({isDingDiskChoose:t});case 5:case"end":return d.stop()}},g)}))()}UNSAFE_componentWillReceiveProps(m){if((0,$.Of)(m,this.props)){var g=m.uploadSucceedItem,t=g.id,o=g.name,d=g.contentType,C=g.type,S=g.duration,I=g.status,W=g.size;if(m.uploadComponentType!==m.uploadComponentId)return;var U=y.Ss.indexOf(d)>-1,Z={id:t,name:o,duration:S,type:C,originalType:C,icon:y.e1[U?"mp3":C],status:I,size:W};this.props.onChange(this.props.value.concat([Z]))}}render(){var m=this.props,g=m.t,t=m.value,o=m.removeable,d=m.preview,C=m.resourceTip,S=m.canSelectCourse,I=m.notLibrary,W=m.hasZip,U=W===void 0?"":W,Z=this.state,te=Z.UploadConfig,Q=Z.showFileSelector,w=Z.uploadVisible,ee=Z.isDingDiskChoose,ne=Z.resourcePlayInfo,ve=Z.previewInfo,me=i().createElement(P.Z,null,i().createElement(P.Z.Item,null,i().createElement(x.Z,te,g("component.practiceUploadPicBtnText"))),i().createElement(P.Z.Item,null,I?i().createElement("div",{className:"practice-attachment__upload__button"},g("component.practiceUploadFileBtnText"),i().createElement("input",{className:"file-input",multiple:!0,type:"file",onChange:this.handleChooseFiles})):i().createElement("div",{className:"practice-attachment__upload__button",onClick:()=>this.setState({uploadVisible:!0})},g("component.practiceUploadFileBtnText"))));return i().createElement("div",{className:"practice-attachment"},!d&&i().createElement("div",null,i().createElement(O.Z,{visible:Q,defaultChecked:t,onCancel:this.handleSelectedCancel,onOk:this.handleSelectedAttachment,excludeType:"h5",showPrivate:!1}),i().createElement("div",{className:"practice-attachment-row"},i().createElement("span",null,g("component.practiceAttachment"),":"),i().createElement("div",null,i().createElement("div",null,i().createElement(B.Z,{overlay:me,disabled:t.length===5},i().createElement(K.Z,{disabled:t.length===5,icon:i().createElement(E.Z,null)},g("component.localUpload"))),S?i().createElement(K.Z,{className:"practice-attachment__choose-courseware",icon:i().createElement(E.Z,null),disabled:t.length===5,onClick:this.handleUploadFile},g("component.coursewareLibSelect")):null,dd&&dd.version&&ee?i().createElement(K.Z,{className:"practice-attachment__ding-upload-button",icon:i().createElement(A.Z,null),disabled:t.length===5,onClick:this.handlePreviewDingFile},g("learning.dingSelect")):null),i().createElement("div",{className:"tip"},C||g(U==="true"?"component.practiceUploadTipZip":"component.practiceUploadTipRange"))))),i().createElement("div",{className:"file-list"},t.map((oe,he)=>this.renderFileListItem(oe,o,he))),I?i().createElement(a.Z,{params:{classifyId:0,bizType:1},hasZip:U}):i().createElement(v.Z,{visible:w,title:this.props.t("common.storage"),onCancel:this.handleCancelUpload,onSuccess:oe=>this.uploadSuccess(oe),params:{classifyId:0,bizType:0},notLibrary:I,hasZip:U}),i().createElement(ae.Z,(0,k.Z)({},ne,{previewInfo:ve})))}}re.defaultProps={removeable:!1,attachment:[],preview:!1,resourceTip:"",canSelectCourse:!0,notLibrary:!1};var ce=(0,f.$j)(q)((0,V.Z)()(re)),de=e(43859),ue=D.Z.TextArea;class le extends i().Component{constructor(){super(...arguments);this.handleChange=m=>{var g=m.target.value;this.props.onFieldChange(g)},this.changContent=(m,g)=>{var t=m.target.value,o=[...this.props.value];o[g].content=t,this.props.onFieldChange(o)},this.changeFile=(m,g)=>{for(var t=[...this.props.value],o=0,d=t;o<d.length;o++){var C=d[o];if(g===C.id){C.resources=m;break}}this.props.onFieldChange(t)},this.addStep=()=>{var m=this.props.value;this.props.onFieldChange(m.concat([{content:"",resources:[],id:new Date().getTime()}]))},this.delItem=m=>{var g=[...this.props.value];g.splice(m,1),this.props.onFieldChange(g)}}render(){var m=this.props,g=m.value,t=m.t,o=m.formik,d=m.canEdit,C=m.maxLength,S=m.areaPlaceHolder,I=m.resourceTip,W=m.canSelectCourse,U=m.notLibrary,Z=m.hasZip,te=Z===void 0?"":Z,Q=o.errors;return i().createElement("div",{className:"radio-mentor-form"},g.map((w,ee)=>i().createElement("div",{key:w.id,className:"step-item"},i().createElement("div",{className:"step-title"},i().createElement("p",{className:"step-content"},(0,r.ZT)("".concat(t("practiceOperation.stepByStep")),ee+1)),g.length>1&&i().createElement(H.Z,{onClick:()=>this.delItem(ee)})),i().createElement(ue,{maxLength:C,disabled:!d,rows:4,placeholder:S||t("tutorial.textDesc"),value:w.content,onChange:ne=>this.changContent(ne,ee)}),i().createElement(ce,{notLibrary:U,canSelectCourse:W,resourceTip:I,uploadComponentId:w.id,removeable:d,hasZip:te,preview:!d,onChange:ne=>this.changeFile(ne,w.id),value:w.resources}),Q&&Q.stepList&&Q.stepList[ee]&&i().createElement("p",{className:"step-content-error"},t("tutorial.textDescRequire")))),d?i().createElement("div",{className:"step-add-btn",onClick:this.addStep},i().createElement(E.Z,null),i().createElement("span",null,t("tutorial.addSteps"))):null)}}le.defaultProps={maxLength:800,areaPlaceHolder:"",resourceTip:"",canSelectCourse:!0,notLibrary:!1};var pe=(0,de.Z)((0,h.$j)((0,V.Z)()(le)))},4751:function(se,j,e){"use strict";e.d(j,{Z:function(){return A}});var _=e(62029),D=e(57663),Y=e(71577),i=e(88986),V=e(34792),h=e(48086),H=e(12924),E=e.n(H),k=e(91768),c=e(55446),B=e(28216),N=e(93485),P=e(33565),R=e(80991),x=e(6793),G=e(54624),K={wrapperCol:{xs:{span:24,offset:0},sm:{span:24,offset:0}}};class b extends E().Component{constructor(){super(...arguments);this.initRef=v=>{this.formRef=v},this.validate=v=>{var a={},r=(0,N.Z)(v.entries()),l;try{for(r.s();!(l=r.n()).done;){var T=l.value,M=(0,P.Z)(T,2),z=M[0],y=M[1];(!y.content||(0,x.fy)(y.content).length===0)&&(y.resources&&y.resources.filter(O=>O.id).length===0||!y.resources)&&(a[z]=!0)}}catch(O){r.e(O)}finally{r.f()}return Object.keys(a).length?a:""}}componentDidMount(){this.props.onFormMounted(this.formRef)}render(){var v=this.props,a=v.initData,r=v.t,l=v.canEdit;return E().createElement("div",{className:"coach-task-form"},E().createElement("div",{className:"step-title-content"},E().createElement("p",{className:"step-title"},a.title),E().createElement("div",{className:"step-content-text"},E().createElement("p",{className:"task-desc"},r("tutorial.require"),"\uFF1A"),E().createElement("p",{className:"more-text"},a.content))),E().createElement(R.J9,{ref:this.initRef,initialValues:a,onSubmit:this.props.onSubmit,render:T=>E().createElement(R.l0,null,E().createElement(R.gN,(0,_.Z)({name:"stepList",label:"",required:!0,defaultValue:T.values.stepList,validate:this.validate,component:G.Z,displayType:"Custom",canEdit:l,customError:!0},K)))}))}}b.defaultProps={initData:{},onFormMounted:()=>{},canEdit:!0};var u=(0,B.$j)()((0,k.Z)()(b)),L=e(37055),n=e(18329),s=e(10237);class p extends E().Component{constructor(v){super(v);this.getInitData=a=>{var r=this.props.userInfo;if(a.baseData&&a.baseData.userList&&a.baseData.userList.length>0){var l=L.ZP.tutor.getCoachDetail({tutorialsId:a.baseData.tutorialsId,tutorUserId:r.id,userId:a.baseData.userList[0]});s.WY.get({url:l,params:{status:"single"}}).then(T=>{T.data.code===0?a.baseData.userList.length>1?this.setState({initData:{title:T.data.data.title,content:T.data.data.content,stepList:[{content:"",resources:[],id:new Date().getTime()}]},showForm:!0}):this.setState({initData:{title:T.data.data.title,content:T.data.data.content,stepList:T.data.data.steps&&T.data.data.steps.length>0?T.data.data.steps:[{content:"",resources:[],id:new Date().getTime()}]},showForm:!0}):h.default.error(T.data.msg)})}},this.onCancel=()=>{this.setState({showForm:!1}),this.props.onCancel&&this.props.onCancel()},this.onOk=a=>{var r=this.props.canEdit;if(!r){this.setState({showForm:!1}),this.props.onOk&&this.props.onOk();return}this.setState({commitStatus:a},()=>{this.AddFormInstance.submitForm()})},this.onFormMounted=a=>{this.AddFormInstance=a},this.submit=a=>{var r=this.props,l=r.baseData,T=r.userInfo,M=r.t,z=this.state,y=z.isLoading,O=z.commitStatus;if(!y){var $={user_ids:l.userList,status:O==="save"?"0":"1",steps:a.stepList.map((J,q)=>({content:J.content?(0,x.fy)(J.content):J.content,step:q+1,resources:J.resources.map((ie,re)=>({resource_id:ie.id,sort:re+1}))}))},ae=L.ZP.tutor.commitCoach({userId:T.id,tutorialsId:l.tutorialsId});this.setState({isLoading:!0}),s.WY.post({url:ae,data:(0,i.Z)({},$)}).then(J=>{this.setState({isLoading:!1}),J.data.code===0&&(h.default.success(M(O==="save"?"common.saveSuccess":"common.submitSuccess")),this.setState({showForm:!1}),this.props.onOk&&this.props.onOk(O!=="save"))}).catch(()=>{this.setState({isLoading:!1})})}},this.renderModalFooter=()=>{var a=this.props,r=a.t,l=a.onlyCommit,T=this.props.canEdit;return E().createElement("div",{className:"coach-task-modal-footer"},E().createElement(Y.Z,{onClick:this.onCancel},r("common.cancel")),T?E().createElement(E().Fragment,null,l?null:E().createElement(Y.Z,{type:"primary",onClick:()=>this.onOk("save")},r("common.save")),E().createElement(Y.Z,{type:"primary",onClick:()=>this.onOk("submit")},r("common.submit"))):null)},this.state={showForm:!1,initData:{stepList:[{content:"",resources:[],id:new Date().getTime()}]},isLoading:!1,commitStatus:"save"},this.formRef=null}UNSAFE_componentWillReceiveProps(v){v.visible!==this.props.visible&&v.visible&&this.getInitData(v)}render(){var v=this.props,a=v.t,r=v.visible,l=v.canEdit,T=v.title,M={title:T||a("tutorial.submitCounselingContent"),okText:a("common.ok"),cancelText:a("common.cancel"),size:"medium",destroyOnClose:!0,maskClosable:!1,footerType:"custom"};return E().createElement(n.ZP,(0,_.Z)({},M,{visible:r,onCancel:this.onCancel,onOk:this.onOk,renderCustomFooter:this.renderModalFooter}),E().createElement("div",{className:"add-task-coaching"},this.state.showForm?E().createElement(u,{onFormMounted:this.onFormMounted,onSubmit:this.submit,initData:this.state.initData,canEdit:l}):null))}}var f=F=>({userInfo:F.user}),A=(0,B.$j)(f)((0,k.Z)()(p))},2323:function(se,j,e){"use strict";var _=e(22385),D=e(31097),Y=e(12924),i=e.n(Y),V=e(91768),h=e(90631),H=e(65202),E=e(2287);function k(c){var B=(0,H.p)(),N=c.item,P=c.t;return i().createElement(D.Z,{title:P("course.courseDetailDownload")},i().createElement(h.Z,{onClick:R=>(0,E.F)(R,N,c),style:{color:B,fontSize:"16px"}}))}j.Z=(0,V.Z)()(k)},46971:function(se,j,e){"use strict";var _=e(13254),D=e(14277),Y=e(48736),i=e(27049),V=e(12924),h=e.n(V),H=e(91768),E=e(28216),k=e(2323),c=e(2287),B=e(6793),N=e(37055),P=e(84874),R=u=>{var L=N.Ss.indexOf(u.content_type)>-1,n=u.type;u.content_type==="scorm"&&(n="scorm"),L&&(n="mp3");var s=N.e1[n];return s||"iconf-matter-picture"},x=u=>({enterpriseId:u.user.enterpriseId}),G=(u,L)=>h().createElement("div",{className:"file-list-item",key:u.id||u.uid,onClick:()=>{L.onPreview(u)}},h().createElement(P.Z,{iconClass:R(u),size:"22px"}),h().createElement("div",{className:"info"},h().createElement("span",{className:"name"},u.name),h().createElement("div",{className:"size-and-download"},u.id&&h().createElement("span",{className:"size"},u.size/1024>1024?"".concat((u.size/1024/1024).toFixed(1),"MB"):"".concat((u.size/1024).toFixed(1),"KB")),(0,c.a)(u)&&h().createElement("span",{className:"download-text"},h().createElement(k.Z,{item:u}))))),K=(u,L)=>{var n=L.enterpriseId,s=L.noUseEnterprise,p=!!u.resources.length,f=localStorage,A=f.appType;return h().createElement("div",{className:"item",key:u.id},h().createElement("div",{className:"index"},!s&&n==="1074539867477774379"?"\u95EE\u9898".concat(u.step):(0,B.ZT)("".concat(L.t("practiceOperation.stepByStep")),u.step)),h().createElement("div",{className:"content operation-pre-text"},u.content),p&&h().createElement("div",{className:"qualified-standard"},h().createElement("div",{className:"qualified-standard-title"},h().createElement("span",{className:"qualified-standard-title-bold"},"".concat(L.t("practiceOperation.annex"),"(").concat(u.resources.length).concat(L.t("practiceOperation.items"),")")),!dd.version&&A==="e_app"&&h().createElement("span",null," \uFF08",L.t("practiceOperation.dingFileTip"),"\uFF09")),h().createElement("div",{className:"qualified-standard-item"},h().createElement("div",{className:"file-list"},u.resources.map(F=>G(F,L))))),h().createElement(i.Z,null))},b=u=>{var L=u.steps,n=L===void 0?[]:L,s=u.status;return s===0?h().createElement("div",{className:"operation-content"},h().createElement(D.Z,{description:u.t("practiceOperation.noSubmitted")})):h().createElement("div",{className:"operation-content"},n.map(p=>K(p,u)))};j.Z=(0,E.$j)(x)((0,H.Z)()(b))},2287:function(se,j,e){"use strict";e.d(j,{a:function(){return E},F:function(){return k}});var _=e(34792),D=e(48086),Y=e(57361),i=e(9754),V=e.n(i),h=e(37055),H=e(67230),E=c=>{var B=h.Yq.indexOf(c.type.toLowerCase())>-1,N=h.iH.indexOf(c.type.toLowerCase())>-1,P=h.Iq.indexOf(c.type.toLowerCase())>-1,R=c.type.indexOf("image")>-1||c.type.indexOf("picture")>-1||c.content_type.indexOf("image")>-1||c.content_type.indexOf("picture")>-1,x=c.biz_type!==3;return(B||N||R||P)&&x},k=function(){var c=(0,Y.Z)(V().mark(function B(N,P,R){var x,G,K,b,u,L,n,s,p,f,A,F,v;return V().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(N.stopPropagation(),x=R.t,G=P.url,K=P.type,b=P.status,u=P.storage_type,L=P.video_id,n=P.id,s="",p=P.type.indexOf("image")>-1||P.type.indexOf("picture")>-1||P.content_type.indexOf("image")>-1||P.content_type.indexOf("picture")>-1,b!==3){r.next=32;break}if(u!=="ALIBABA_PRIVATE"){r.next=19;break}if(K!=="mp4"){r.next=13;break}return r.next=10,(0,H.y5)(L);case 10:s=r.sent,r.next=16;break;case 13:return r.next=15,(0,H.J7)(L);case 15:s=r.sent;case 16:s?(s.indexOf("http://")>-1&&(s=s.replace("http://","https://")),window.location.href=s):D.default.info(x("personal.fileNoDown")),r.next=30;break;case 19:if(K!=="mp4"){r.next=29;break}return r.next=22,(0,H.km)(n);case 22:f=r.sent,A=f.success,F=f.data,A==="true"&&(s=F),s?(s.indexOf("http://")>-1&&(s=s.replace("http://","https://")),window.location.href=s):D.default.info(x("personal.fileNoDown")),r.next=30;break;case 29:p?(v=new XMLHttpRequest,v.open("GET",P.url,!0),v.responseType="blob",v.onload=l=>{l.stopPropagation();var T=window.URL.createObjectURL(v.response),M=document.createElement("a");M.href=T,M.download=P.name,M.click()},v.send()):window.location.href=G;case 30:r.next=33;break;case 32:D.default.info(x("course.transcodingTips"));case 33:case"end":return r.stop()}},B)}));return function(N,P,R){return c.apply(this,arguments)}}()},33696:function(se,j,e){"use strict";e.r(j);var _=e(62029),D=e(57663),Y=e(71577),i=e(20228),V=e(11382),h=e(88986),H=e(34792),E=e(48086),k=e(12924),c=e.n(k),B=e(28216),N=e(76651),P=e(91768),R=e(57068),x=e(54531),G=e(1164),K=e(76466),b=e(4408),u=e(37055),L=e(10237),n=e(4751),s=e(37781),p=e(6793),f=e(46971);class A extends c().Component{constructor(){super(...arguments);this.state={coachTaskDialogVisible:!1,detailData:{title:"",content:"",evaluation_status:"unevaluated",apprentice_user_name:"",evaluation:"",score:1,mode:"evaluation",steps:[]},loading:!1,chooseUserIdList:[],tutorialsId:"",resourcePlayInfo:{mode:"preview",watchType:"",resourceInfo:{},autoPlay:!0,draggable:!0},previewInfo:{visible:!1,destroyOnClose:!0,title:this.props.t("resourceLibrary.previewCourseware"),onCancel:()=>{}}},this.getDetailResult=()=>{var a=R.parse(N.m8.location.search),r=a.tutorialsId,l=a.userId,T={tutorialsId:r,tutorUserId:this.props.userId,userId:l};this.setState({loading:!0}),(0,s.Q_)(T).then(M=>{this.setState({loading:!1}),M.data.code===0&&this.setState({detailData:M.data.data||{}})})},this.editCoachTask=()=>{var a=R.parse(N.m8.location.search),r=a.tutorialsId,l=a.userId;this.setState({coachTaskDialogVisible:!0,chooseUserIdList:[l],tutorialsId:r})},this.addCoachTaskStatus=()=>{this.setState({coachTaskDialogVisible:!1}),this.getDetailResult()},this.handlePreview=a=>{var r=this.props,l=r.appType,T=r.t;if(l==="wx_app"&&a.biz_type===3){E.default.info("\u8BE5\u9644\u4EF6\u7531\u9489\u76D8\u4E0A\u4F20\uFF0C\u65E0\u6CD5\u9884\u89C8\uFF0C\u8BF7\u5728\u9489\u9489\u5BA2\u6237\u7AEF\u6253\u5F00\u9884\u89C8");return}if(a.status!==3){E.default.info(T("resourceLibrary.transcodingPlayerTip"));return}if(!dd.version&&a.biz_type===3){E.default.info(T("practiceOperation.dingFileTip"));return}if(a.biz_type!==3){this.handlePreviewSystemFile(a);return}var M=u.ZP.DingSpaceId.getSpaceId(),z={corpId:this.props.corpId,userId:this.props.account,fileids:a.url,timeStamp:Date.parse(new Date)};L.WY.get({url:M,params:z}).then(y=>{y.data.code===0?this.ddSpacePreview(a):E.default.info(y.data.msg)}).catch(y=>{E.default.error(y.data)})},this.ddSpacePreview=a=>{var r={spaceId:a.path,fileId:a.url,fileName:a.name,fileSize:a.size,fileType:a.type};(0,x.DR)(r)},this.dealWatchType=a=>{var r=u.Yq.findIndex(ae=>a.type.toLowerCase().includes(ae))>-1,l=a.content_type.indexOf("video")>-1,T=u.Ss.indexOf(a.content_type)>-1,M=a.type.indexOf("image")>-1||a.type.indexOf("picture")>-1||a.content_type.indexOf("image")>-1||a.content_type.indexOf("picture")>-1,z=a.content_type.indexOf("h5")>-1,y=a.content_type.indexOf("html")>-1,O=a.content_type.indexOf("scorm")>-1,$="";return z?$="article":r?$="doc":l||T?$="video":M?$="image":y?$="html":O&&($="scorm"),$},this.handlePreviewSystemFile=a=>{var r=this.state.previewInfo,l=this.dealWatchType(a),T=u.Ss.indexOf(a.content_type)>-1;if(l==="article"){var M=a.content_type,z=a.url,y=M==="h5/link";y?G.Z.targetTo({path:z,isExternalLink:!0}):G.Z.targetTo({path:"/training/resourceManage/library/articlePreview?id=".concat(a.id)});return}if(l==="scorm"){var O=a.url.split("//"),$=O[1].split("/"),ae=[O[0],$[0]].join("//"),J="".concat(ae,"/unzip_file/coolcollege-scorm/prod/preview.html?scormUrl=").concat(encodeURIComponent(a.url));G.Z.targetTo({path:J,isExternalLink:!0});return}var q={mode:"preview",watchType:l};l==="doc"?Object.assign(q,{resourceInfo:{type:"",docType:a.type,aliUrl:a.path,url:a.url,docTitle:a.name,playId:a.videoId||a.video_id,storageType:a.storage_type}}):l==="image"?Object.assign(q,{resourceInfo:{url:a.url,playId:a.videoId||a.video_id,storageType:a.storage_type}}):l==="html"?Object.assign(q,{resourceInfo:{url:a.url}}):Object.assign(q,{resourceInfo:{source:{FD:a.url,OD:a.path},originUrl:a.url,contentType:T?"mp3":a.type,playId:a.videoId||a.video_id,storageType:a.storage_type},autoPlay:!0,draggable:!0}),this.setState({resourcePlayInfo:q,previewInfo:(0,h.Z)((0,h.Z)({},r),{},{visible:!0,title:a.name,onCancel:this.cancelPreview})})},this.cancelPreview=()=>{var a=this.state.previewInfo;this.setState({resourcePlayInfo:{mode:"preview",watchType:"",resourceInfo:{}},previewInfo:(0,h.Z)((0,h.Z)({},a),{},{visible:!1})})}}componentDidMount(){this.getDetailResult(),(0,x.TN)()}render(){var a=this.props,r=a.prefixCls,l=a.t,T=a.location,M=T.query.tag,z=M===void 0?"":M,y=this.state,O=y.detailData,$=y.resourcePlayInfo,ae=y.previewInfo,J=y.coachTaskDialogVisible,q=y.loading,ie=y.chooseUserIdList,re=y.tutorialsId;return q?c().createElement("div",{className:"coach-task-result-empty"},c().createElement(V.Z,null,c().createElement("div",{className:"coach-task-result-empty__content"}))):c().createElement("div",{className:r},c().createElement(b.Z,{title:l("documentTitle.coachTaskDetailResult")}),c().createElement("div",{className:"".concat(r,"__content")},c().createElement("span",{className:"".concat(r,"__content__title")},O.title),O.evaluation_status==="unevaluated"?c().createElement("span",{className:"".concat(r,"__content__no-unevaluated")},l("tutorial.waitingStudentEvaluation")):c().createElement("span",null,l("learning.questionnaireAddToolScore"),"\uFF1A",c().createElement("span",{className:"".concat(r,"__content__score")},O.score),c().createElement("span",{className:"".concat(r,"__content__score-util")},l("common.examScoreUnit"))),c().createElement("span",null,l("tutorial.evaluator"),"\uFF1A",O.apprentice_user_name),O.evaluation_status==="unevaluated"?null:c().createElement("span",null,l("tutorial.evaluateTime"),"\uFF1A",(0,p.p6)(O.apprentice_create_time)," "),O.evaluation_status==="unevaluated"?null:c().createElement("span",null,l("examing.comments"),"\uFF1A",O.evaluation," "),c().createElement("div",{className:"".concat(r,"__content__hr")}),c().createElement("span",null,l("tutorial.tutorRecord")," "),c().createElement("span",null,l("tutorial.require"),"\uFF1A",O.content),O.tutor_name?c().createElement("span",null,l("tutorial.tutor"),"\uFF1A",O.tutor_name):null,O.tutor_commit_time?c().createElement("span",null,l("personal.submitTime"),"\uFF1A",(0,p.p6)(O.tutor_commit_time)):null,O.mode==="resource_evaluation"?c().createElement("span",null,l("tutorial.tutorsNotTutorials")):c().createElement(f.Z,{noUseEnterprise:!0,steps:O.steps,onPreview:this.handlePreview})),z!=="coach-analysis-detail"&&c().createElement("div",{className:"".concat(r,"__fix__footer")},c().createElement("div",null,c().createElement(Y.Z,{onClick:this.editCoachTask,type:"primary"},l("learning.reSubmit")))),c().createElement(n.Z,{title:l("learning.reSubmit")+l("tutorial.tutorShip"),visible:J,onCancel:()=>this.setState({coachTaskDialogVisible:!1}),onOk:this.addCoachTaskStatus,baseData:{tutorialsId:re,userList:ie},canEdit:!0,onlyCommit:!0}),c().createElement(K.Z,(0,_.Z)({},$,{previewInfo:ae})))}}A.defaultProps={prefixCls:"coach-task-result"};var F=v=>({corpId:v.user.corpId,account:v.user.account,enterpriseId:v.user.enterpriseId,appType:v.user.appType,userId:v.user.id});j.default=(0,B.$j)(F)((0,P.Z)()(A))},37781:function(se,j,e){"use strict";e.d(j,{Q_:function(){return Y},O$:function(){return i},PQ:function(){return V},zv:function(){return h},Vu:function(){return H},Qd:function(){return E},t3:function(){return k},Tw:function(){return c},kV:function(){return B},W5:function(){return N},MA:function(){return P},Mm:function(){return R},pF:function(){return x},ZK:function(){return G},iT:function(){return K},Nf:function(){return b},hB:function(){return u},GK:function(){return L}});var _=e(37055),D=e(10237);function Y(n){var s=n.tutorialsId,p=n.tutorUserId,f=n.userId,A=_.ZP.tutor.getCoachDetail({tutorialsId:s,tutorUserId:p,userId:f});return D.WY.get({url:A,params:{status:"single"}})}function i(n){var s=n.tutorialsId,p=n.status,f=n.keyword,A=_.ZP.tutor.getUserListByCoach(s);return D.WY.get({url:A,params:{status:p,keyword:f}})}function V(n){var s=_.ZP.tutor.queryTutor(n);return D.WY.get({url:s})}function h(n){var s=n.tutorId,p=n.user_id,f=n.gender,A=n.level_id,F=n.department_id,v=n.description,a=n.avatar,r=_.ZP.tutor.editTutor(s);return D.WY.post({url:r,data:{user_id:p,gender:f,level_id:A,description:v,department_id:F,avatar:a}})}function H(n){var s=n.user_id,p=n.gender,f=n.level_id,A=n.description,F=n.avatar,v=n.department_id,a=_.ZP.tutor.addTutor();return D.WY.post({url:a,data:{user_id:s,gender:p,level_id:f,description:A,department_id:v,avatar:F}})}function E(n){var s=n.keyword,p=s===void 0?"":s,f=_.ZP.tutor.levelList();return D.WY.get({url:f,params:{keyword:p}})}function k(n){var s=n.name,p=n.standard,f=_.ZP.tutor.addLevel();return D.WY.post({url:f,data:{name:s,standard:p}})}function c(n){var s=n.id,p=n.name,f=n.standard,A=_.ZP.tutor.editLevel(s);return D.WY.post({url:A,data:{id:s,name:p,standard:f}})}function B(n){var s=n.resourceId,p=n.type,f=_.ZP.tagsInformation.resourceQueryTags();return D.WY.get({url:f,params:{type:p,resourceId:s,isNewTag:!0}})}function N(n){var s=n.tutorId,p=n.keyword,f=n.page_size,A=n.page_number,F=_.ZP.tutor.apprenticeList(s);return D.WY.get({url:F,params:{keyword:p,page_size:f,page_number:A}})}function P(n){var s=_.ZP.tutor.deleteApprentice(n);return D.WY.post({url:s})}function R(n){var s=n.tutorId,p=n.user_ids,f=_.ZP.tutor.addApprentice(s);return D.WY.post({url:f,data:{user_ids:p}})}function x(n){var s=_.ZP.tutor.deleteLevel(n);return D.WY.post({url:s})}function G(n){var s=n.source_id,p=n.destination_id,f=_.ZP.tutor.sortLevel(s);return D.WY.post({url:f,data:{source_id:s,destination_id:p}})}function K(n){var s=n.tutorId,p=n.status,f=_.ZP.tutor.updateStatusTutor(s);return D.WY.post({url:f,data:{status:p}})}function b(n){var s=n.keyword,p=n.status,f=n.department_id,A=n.page_number,F=n.page_size,v=_.ZP.tutor.listTutor();return D.WY.get({url:v,params:{keyword:s,status:p,department_id:f,page_number:A,page_size:F}})}function u(n){var s=n.source_id,p=n.destination_id,f=_.ZP.tutor.updateSortTutor(s);return D.WY.post({url:f,data:{source_id:s,destination_id:p}})}function L(n){var s=_.ZP.tutor.deleteTutor(n);return D.WY.post({url:s})}}}]);
