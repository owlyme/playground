(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[1794],{93117:function(ce,Q,a){"use strict";a.d(Q,{Z:function(){return T}});var w=a(88986),I=a(12924),E=a.n(I),V=a(91768),A=a(57663),N=a(71577),L=a(28216),C=a(49101),b=a(29182),R=a(1164),r=a(48479),x=a(45395),k=Y=>({userInfo:Y.user});class O extends E().Component{constructor(){super(...arguments);this.handleSearch=U=>{this.props.onSearch(U)},this.renderSearch=()=>{var U=this.props,X=U.prefixCls,se=U.t,ee="".concat(X,"__search");return E().createElement("div",{className:ee},E().createElement(r.Z,{onSearch:this.handleSearch,placeholder:se("searchInputPlaceholder.certificate"),width:"238px"}))},this.renderAddBtn=()=>{var U=this.props,X=U.prefixCls,se=U.t,ee="".concat(X,"__add"),ae=(0,x.F3)("/knowledgeBase/certificateResources/certificate",b.Cv);return ae?E().createElement("div",{className:ee},E().createElement(R.Z,{to:"/training/authentication/certificate/layout"},E().createElement(N.Z,{type:"primary",icon:E().createElement(C.Z,null)},se("authentication.newCertificate")))):null}}render(){var U=this.props.prefixCls;return E().createElement("header",{className:U},this.renderSearch(),this.renderAddBtn())}}O.defaultProps={prefixCls:"cl-certificate-selector__queryrow"};var t=(0,L.$j)(k)((0,V.Z)()(O)),l=a(66456),W=a(55313),j=a(95664),Z=a(6793);class y extends E().Component{constructor(){super(...arguments);this.columns=[{title:this.props.t("component.certificateName"),dataIndex:"name"},{title:this.props.t("shareInfo.shareTitle"),dataIndex:"title"},{title:this.props.t("personnelDevelope.text"),dataIndex:"summary"},{title:this.props.t("common.createTime"),dataIndex:"createTime",render:U=>(0,Z.p6)(U)}],this.handleTableChange=U=>{this.props.onTableChange(U)},this.handleRefresh=()=>{this.props.onRefresh()},this.handleSelectChange=(U,X)=>{this.props.onSelectChange({selectedRowKeys:U,selectedRows:X})}}render(){var U=this.props,X=U.prefixCls,se=U.list,ee=se===void 0?[]:se,ae=U.loading,le=U.paginationParams,pe=le===void 0?{}:le,ne=U.selectedRowKeys,ye=ne===void 0?[]:ne,Ce=U.selectType,be={type:Ce||"radio",selectedRowKeys:ye,onChange:this.handleSelectChange};return E().createElement("section",{className:X},E().createElement(W.Z,{bordered:!0,size:"middle",columns:this.columns,rowKey:"id",rowSelection:be,dataSource:ee,pagination:!1,loading:ae}),E().createElement(j.Z,{totalNum:pe.total,totalPage:pe.totalPage,defaultPageSize:pe.pageSize,current:pe.current,onChange:this.handleTableChange,onRefresh:this.handleRefresh}))}}y.defaultProps={prefixCls:"cl-certificate-selector__querycontent"};var z=(0,V.Z)()(y),B=a(18329),_=a(10237),S=a(37055),F={getList:S.ZP.SelectCertificate.getList};class M extends E().Component{constructor(){super(...arguments);this.state={params:{keyword:"",status:"1",pageNumber:1,pageSize:5},tableLoading:!0,tableList:[],tableTotal:0,tablePageTotal:0,defaultChecked:[]},this.onInitTableList=()=>{this.setState({tableLoading:!0}),_.WY.get({url:F.getList(),params:(0,w.Z)({},this.state.params)}).then(U=>{setTimeout(()=>{this.setState({tableLoading:!1,tableList:U.data.list,tableTotal:U.data.total,tablePageTotal:U.data.pages})},300)})},this.handleChangePagination=U=>{this.setState(X=>({params:(0,w.Z)((0,w.Z)({},X.params),{},{pageNumber:U})}),()=>{this.onInitTableList()})},this.handleQueryRowSearch=U=>{this.resetPagination().then(()=>{this.setState(X=>({params:(0,w.Z)((0,w.Z)({},X.params),{},{keyword:U})}),()=>{this.onInitTableList()})})},this.resetPagination=()=>new Promise(U=>{this.setState(X=>({params:(0,w.Z)((0,w.Z)({},X.params),{},{pageNumber:1,pageSize:5})}),()=>{U()})}),this.handleOk=()=>{this.props.onOk(this.state.defaultChecked)},this.handleSelectChange=U=>{var X=U.selectedRows,se=[];X.forEach(ee=>{se.push({componentName:"ClCertificateSelector",id:ee.id,name:ee.name,previewUrl:ee.previewUrl,description:ee.summary,title:ee.title})}),this.setState({defaultChecked:se})}}componentDidUpdate(U){this.props.visible&&this.props.visible!==U.visible&&this.setState({params:{keyword:"",status:"1",pageNumber:1,pageSize:5},defaultChecked:this.props.defaultChecked},()=>{this.onInitTableList()})}render(){var U=this.props,X=U.prefixCls,se=U.visible,ee=U.onCancel,ae=U.t,le=U.selectType,pe=U.title,ne=this.state,ye=ne.tableTotal,Ce=ne.tablePageTotal,be=ne.tableList,fe=ne.tableLoading,Ee=ne.params,Pe=ne.defaultChecked,ve={total:ye,totalPage:Ce,current:Ee.pageNumber,pageSize:Ee.pageSize},_e=Pe.map(Ie=>Ie.id);return E().createElement(B.ZP,{visible:se,title:pe||ae("component.certificateSelect"),onCancel:ee,okText:ae("common.ok"),cancelText:ae("common.cancel"),onOk:this.handleOk},E().createElement("div",{className:X},se?E().createElement(E().Fragment,null,E().createElement(t,{onSearch:this.handleQueryRowSearch}),E().createElement(z,{loading:fe,paginationParams:ve,list:be,selectedRowKeys:_e,onSelectChange:this.handleSelectChange,onTableChange:this.handleChangePagination,onRefresh:this.onInitTableList,selectType:le})):null))}}M.defaultProps={prefixCls:"cl-certificate-selector",visible:!1,defaultChecked:[],onCancel:()=>{},onOk:()=>{},selectType:"radio",title:""};var T=(0,V.Z)()(M)},95664:function(ce,Q,a){"use strict";var w=a(14781),I=a(53431),E=a(12924),V=a.n(E),A=a(91768),N=a(84874);class L extends V().Component{render(){var b=this.props,R=b.prefixCls,r=b.showRenderRefresh,x=b.totalNum,k=b.totalPage,O=b.onRefresh,t=b.onChange,l=b.defaultPageSize,W=b.current,j=b.t,Z=b.onShowSizeChange,y=Z===void 0?()=>{}:Z;return V().createElement("div",{className:R},V().createElement("span",{className:"".concat(R,"__info")},r&&V().createElement("span",{className:"".concat(R,"__info__refresh"),onClick:O},V().createElement(N.Z,{iconClass:"iconf-switch",color:"#535B6E",size:"14px"})),j("component.totalLabel"),V().createElement("b",null,k),j("component.pageLabel"),"\uFF0C",V().createElement("b",null,x),j("component.dataItems")),x?V().createElement(I.Z,{size:"small",total:x,onChange:t,current:W,defaultPageSize:l,showSizeChanger:!1,onShowSizeChange:y}):null)}}L.defaultProps={prefixCls:"cl-modal-pagination",showRenderRefresh:!0,totalNum:0,totalPage:0,defaultPageSize:12,current:1,onRefresh:()=>{},onChange:()=>{}},Q.Z=(0,A.Z)()(L)},4408:function(ce,Q,a){"use strict";var w=a(12924),I=a.n(w),E=a(28216),V=a(17780),A=a(38642),N=C=>({userInfo:C.user}),L=C=>{var b=C.title;return(0,V.xX)()&&setTimeout(()=>{document.title=b},0),(0,w.useEffect)(()=>{if(b&&document.title!==b&&setTimeout(()=>{document.title=b},0),(0,A.UI)("SCALE")){document.querySelector("body").style.zoom="0.8";var R=document.querySelector(".zoom-report");R&&(R.style.zoom="1.2")}return()=>{localStorage.getItem("name")||(document.querySelector("body").style="")}},[b]),I().createElement(I().Fragment,null)};L.defautProps={title:""},Q.Z=(0,E.$j)(N)(L)},1164:function(ce,Q,a){"use strict";var w=a(12924),I=a.n(w),E=a(76651),V=a(38642),A=a(91302),N=L=>{var C=navigator.userAgent.toLocaleLowerCase(),b=localStorage.getItem("enterpriseId"),R=(0,V.lz)(b,L.projectType),r=localStorage.getItem("dingPersonnel"),x=A.bl.includes(r),k=L.target;function O(t){if(k==="self"&&(t.preventDefault(),E.m8.push(L.to)),x){if(L.projectType==="student"){window.location.href="".concat(R,"/").concat(L.to);return}E.m8.push(L.to);return}if(dd.version){t.preventDefault();var l="";L.to.includes("?")?l="".concat(R).concat(L.to,"&ddtab=true"):l="".concat(R).concat(L.to,"?ddtab=true"),dd.biz.util.openLink({url:l})}else C.indexOf("lark")!==-1&&(window.location.href="".concat(R).concat(L.to))}return I().createElement("a",{rel:"noreferrer",href:"".concat(L.projectType==="student"?"".concat(R).concat(L.to):"#".concat(L.to)),className:"".concat(L.wrapCls," cl-pointer"),target:C.indexOf("lark")!==-1||x?"_self":L.target||"_blank",onClick:O},L.children)};N.defaultProps={to:"/",wrapCls:"",target:"",projectType:"manage"},N.targetTo=L=>{var C=L.path,b=L.from,R=L.isExternalLink,r=R===void 0?!1:R,x=L.isAsync,k=x===void 0?!1:x,O=L.openName,t=O===void 0?"_blank":O,l=L.projectType,W=l===void 0?"manage":l,j=L.ddTab,Z=j===void 0?!0:j,y,z=localStorage.getItem("dingPersonnel"),B=A.bl.includes(z),_=navigator.userAgent.toLocaleLowerCase(),S=localStorage.getItem("enterpriseId"),F=(0,V.lz)(S,W),M=localStorage.getItem("appType"),T=navigator.userAgent.toLowerCase().indexOf("wxwork")>-1;if(dd.version){var Y="";if(y=r?"":F,B&&!r){if(W==="student"){window.location.href="".concat(F).concat(C);return}E.m8.push(C);return}C.includes("?")?Y="".concat(y).concat(C,"&ddtab=").concat(Z):Y="".concat(y).concat(C,"?ddtab=").concat(Z),dd.biz.util.openLink({url:Y})}else if(_.indexOf("lark")!==-1)y=r?"":F,window.location.href="".concat(y).concat(C);else if(M==="wx_app"&&T&&r&&b==="imgText")y=r?"":W==="student"?"".concat(F):"#",window.wx.invoke("openDefaultBrowser",{url:"".concat(y).concat(C)});else if(y=r?"":W==="student"?"".concat(F):"#",k){var U=window.open("","_blank");setTimeout(()=>{U.location="".concat(y).concat(C)},100)}else window.open("".concat(y).concat(C),t)},Q.Z=N},87312:function(ce,Q,a){"use strict";var w=a(12924),I=a.n(w),E=a(91768),V=A=>{var N=A.t;return I().createElement("div",{className:A.className?"".concat(A.className," no-result"):"no-result"},I().createElement("img",{src:"".concat("https://oss.coolcollege.cn","/1789886702513426432.png"),className:"no-data-img",alt:""}),I().createElement("p",{className:"no-data-tip"},A.tipText||N("common.empty")))};Q.Z=(0,E.Z)()(V)},88311:function(ce,Q,a){"use strict";a.d(Q,{Z:function(){return v}});var w=a(62029),I=a(47673),E=a(4107),V=a(33565),A=a(57361),N=a(34792),L=a(48086),C=a(88986),b=a(43358),R=a(34041),r=a(18106),x=a(88108),k=a(9754),O=a.n(k),t=a(12924),l=a.n(t),W=a(91768),j=a(77043),Z=a.n(j),y=a(20228),z=a(11382),B=a(18721),_=a.n(B),S=a(51975),F=a(37055),M={breadNav:[{value:"",label:""}],checkOne:()=>{},checkAll:()=>{},nextLevel:()=>{},changeLevel:()=>{}},T=l().createContext(M),Y={searchResult:[],deptList:[],groupList:[],postList:[],deptUser:[],groupUser:[],postUser:[],clusterList:[],classList:[],checkedDept:[],checkedGroup:[],checkedPost:[],checkedUser:[],checkedCluster:[],checkedClass:[],initTypeList:()=>{},initTypeUser:()=>{},toggleDisplayItem:()=>{},toggleDisplayList:()=>{},checkListOne:()=>{},checkUserOne:()=>{},removeCheckedUser:()=>{},changeLevel:()=>{},hidePosts:!1,initHidePostsStatus:()=>{},clearSelectedAll:()=>{}},U=l().createContext(Y),X=a(36017),se=a(35247),ee=a(60667);class ae extends l().Component{constructor(){super(...arguments);this.changeLevel=(c,d,e,n)=>{c.preventDefault(),this.props.contextData.changeLevel(d,e,n)}}render(){var c=this.props.contextData.breadNav.map((d,e)=>l().createElement(se.Z.Item,{key:d.value},l().createElement("span",{className:"bread-nav-item",onClick:n=>this.changeLevel(n,d.value,e,!(_()(d,"authorized")&&d.authorized==="true"))},l().createElement(ee.Z,{dataType:"departmentName",value:d.value,name:d.label,type:d.sourceType}))));return l().createElement("div",{className:"bread-nav"},l().createElement(se.Z,null,c))}}ae.defaultProps={contextData:{breadNav:[]},changeLevel:()=>{}};var le=ae,pe=a(63185),ne=a(9676),ye=a(88983),Ce=a(47933),be=a(22385),fe=a(31097),Ee=a(57119),Pe=a(84874),ve=a(20136),_e=a(55241),Ie=a(13062),Le=a(71230),Se=a(89032),de=a(15746),ue=a(28216),xe=a(80430),me=a(10237);function oe(){var m=CONFIG.Role.getUserManageRange();return request.get({url:m})}function De(m){var c=F.ZP.OrgDialog.getDeptInfoUrl({departmentId:m.departmentId});return delete m.departmentId,me.WY.get({url:c,params:m})}function Te(m){var c=F.ZP.OrgDialog.getDeptUsersUrl({departmentId:m.departmentId});return delete m.departmentId,me.WY.get({url:c,params:m})}function Re(m){var c=F.ZP.OrgDialog.getUserDetailUrl();return me.WY.get({url:c,params:m})}function ke(m){var c=F.ZP.OrgDialog.getScopeUsersAndDeptsUrl({departmentId:m.departmentId});return delete m.departmentId,me.WY.get({url:c,params:m})}function Qe(m){var c=F.ZP.OrgDialog.postDeleteCacheUrl({cacheId:m.cacheId});return delete m.cacheId,me.WY.post({url:c,params:m})}var Fe,Ye,He=(Fe=(0,ue.$j)(m=>{var c=m.user;return{enterpriseName:c.enterpriseName}}),Fe(Ye=class extends l().Component{constructor(){super(...arguments);this.state={loading:!0,cardInfoFinal:this.props.cardInfo},this.renderTitle=()=>{var c=this.props,d=c.cardInfo,e=c.prefixCls,n=c.enterpriseName,h=d.source_type,p=d.user_id,s=d.name;return l().createElement("div",{className:"".concat(e,"__header")},l().createElement("div",{className:"".concat(e,"__header-name")},l().createElement(ee.Z,{type:h,value:p,name:s,dataType:"userName"})),l().createElement("div",{className:"".concat(e,"__header-corp")},n||"/"))},this.renderContent=()=>{var c=this.props,d=c.prefixCls,e=c.t,n=this.state.cardInfoFinal,h=n.user_id,p=n.job_number,s=n.post_names,g=s===void 0?[]:s,P=n.department_infos,D=P===void 0?[]:P,K=()=>!(D instanceof Array)||D.length===0?"/":l().createElement(xe.Z,{list:D,displayAll:!0,isBlock:!0}),$=()=>!(g instanceof Array)||g.length===0?"/":g.map(H=>l().createElement("div",{key:H},H)),G=[{lable:"ID",value:h},{lable:e("personal.jobNumber"),value:p||"/"},{lable:e("setting.postLabel"),value:$()},{lable:e("learnRecord.department"),value:K()}];return l().createElement("div",{className:"".concat(d,"__body")},G.map(H=>l().createElement(Le.Z,{className:"".concat(d,"__body-item"),key:H.value},l().createElement(de.Z,{className:"".concat(d,"__body-item-lable")},H.lable),l().createElement(de.Z,{className:"".concat(d,"__body-item-value")},H.value||"/"))))}}render(){var c=this.props,d=c.children,e=c.prefixCls,n=this.state,h=n.loading,p=n.cardInfoFinal;return l().createElement(_e.Z,{overlayClassName:e,placement:"rightTop",title:this.renderTitle,content:h?l().createElement("div",{className:"".concat(e,"__body")},l().createElement(z.Z,null)):this.renderContent,onVisibleChange:s=>{s&&(p.detailInfo===!1?Re({user_id:p.id}).then(g=>{this.setState({loading:!1,cardInfoFinal:(0,C.Z)((0,C.Z)((0,C.Z)({},p),g.data),{},{detailInfo:!0})})}).catch(g=>{console.error(g)}):this.setState({loading:!1}))},mouseEnterDelay:.5},d)}})||Ye);He.defaultProps={prefixCls:"user-card-popover",cardInfo:{}};var Oe=(0,W.Z)()(He),ut=["cluster","class"];class Je extends l().Component{constructor(){super(...arguments);this.checkOne=c=>{c.preventDefault(),this.props.contextData.checkOne(this.props.itemId,this.props.hasNext?"list":"user",!this.props.isChecked)},this.nextLevel=c=>{c.preventDefault(),!this.props.isChecked&&this.props.contextData.nextLevel(this.props.cardInfo,this.props.title,this.props.hasNextPost)},this.renderToolTips=()=>{var c=this.props,d=c.cardInfo,e=c.type,n=c.t;return d.authorized==="false"&&e==="dept"?l().createElement(fe.Z,{title:n("orgDialog.scopedAuthorize")},l().createElement(Ee.Z,{style:{marginLeft:"4px"}})):null}}render(){var c=this.props,d=c.t,e=c.cardInfo,n=e===void 0?{}:e,h=c.hidePosts,p=c.type,s=c.userCount,g=null;return this.props.hasNext?(g=l().createElement("div",{className:"next-level"},!(h&&p==="post")&&s>-1?l().createElement("span",{className:"next-level-count"},"(",s,")"):null,ut.includes(p)?l().createElement("span",null):l().createElement("span",{className:this.props.isChecked?"next-level-label disabled":"next-level-label",onClick:this.nextLevel},l().createElement(Pe.Z,{iconClass:"icon-xiaji1"}),d("component.nextLevel"))),this.props.single?l().createElement("div",{className:"org-tree-item"},l().createElement("span",{checked:this.props.isChecked,disabled:!this.props.checkable,className:"org-tree-item-name"},this.props.title),this.renderToolTips(),g):(!this.props.disableHidden||this.props.disableHidden&&this.props.checkable)&&l().createElement("div",{className:"org-tree-item"},l().createElement(ne.Z,{checked:this.props.isChecked,disabled:!this.props.checkable,onClick:this.checkOne,className:"org-tree-item-name"},this.props.title),this.renderToolTips(),g)):l().createElement("div",{className:"org-tree-item"},this.props.single?l().createElement(Ce.ZP,{checked:this.props.isChecked,disabled:!this.props.checkable,onClick:this.checkOne,className:"org-tree-item-name"},l().createElement(Oe,{cardInfo:n},this.props.title)):l().createElement(Oe,{cardInfo:n},l().createElement(ne.Z,{checked:this.props.isChecked,disabled:!this.props.checkable,onClick:this.checkOne,className:"org-tree-item-name"},this.props.title)))}}Je.defaultProps={hasNext:!1,isChecked:!1,itemId:"",title:"",hasNextPost:!1,userCount:0,checkable:!0,hidePosts:!1,disableHidden:!1};var Xe=(0,W.Z)()(Je),qe=["cluster","class"];class et extends l().Component{constructor(){super(...arguments);this.checkOne=c=>{c.preventDefault(),this.props.contextData.checkOne(this.props.itemId,this.props.hasNext?"list":"user",!this.props.isChecked)},this.nextLevel=c=>{c.preventDefault(),!this.props.isChecked&&this.props.contextData.nextLevel(this.props.cardInfo,this.props.title,this.props.hasNextPost)},this.renderToolTips=()=>{var c=this.props,d=c.cardInfo,e=c.type,n=c.t;return d.authorized==="false"&&e==="dept"?l().createElement(fe.Z,{title:n("orgDialog.scopedAuthorize")},l().createElement(Ee.Z,{style:{marginLeft:"4px"}})):null}}render(){var c=this.props,d=c.t,e=c.cardInfo,n=e===void 0?{}:e,h=c.hidePosts,p=c.type,s=c.userCount,g=null;return this.props.hasNext?(g=l().createElement("div",{className:"next-level"},l().createElement("span",{className:"next-level-belle"},!(h&&p==="post")&&s>-1?l().createElement("span",{className:"next-level-count"},"(",s,")"):null,qe.includes(p)?l().createElement("span",null):l().createElement("span",{className:this.props.isChecked?"next-level-label disabled":"next-level-label",onClick:this.nextLevel},l().createElement(Pe.Z,{iconClass:"icon-xiaji1"}),d("component.nextLevel")))),this.props.single?l().createElement("div",{className:"org-tree-item"},l().createElement("span",{checked:this.props.isChecked,disabled:!this.props.checkable,className:"org-tree-item-name"},l().createElement("span",{className:"org-tree-item-title"},this.props.title)),this.renderToolTips(),g):(!this.props.disableHidden||this.props.disableHidden&&this.props.checkable)&&l().createElement("div",{className:"org-tree-item"},l().createElement(ne.Z,{checked:this.props.isChecked,disabled:!this.props.checkable,onClick:this.checkOne,className:"org-tree-item-name"},l().createElement("span",{className:"org-tree-item-title"},this.props.title)),this.renderToolTips(),g)):l().createElement("div",{className:"org-tree-item"},this.props.single?l().createElement(Ce.ZP,{checked:this.props.isChecked,disabled:!this.props.checkable,onClick:this.checkOne,className:"org-tree-item-name"},l().createElement(Oe,{cardInfo:n},l().createElement("span",{className:"org-tree-item-title"},this.props.title))):l().createElement(Oe,{cardInfo:n},l().createElement(ne.Z,{checked:this.props.isChecked,disabled:!this.props.checkable,onClick:this.checkOne,className:"org-tree-item-name"},l().createElement("span",{className:"org-tree-item-title"},this.props.title))))}}et.defaultProps={hasNext:!1,isChecked:!1,itemId:"",title:"",hasNextPost:!1,userCount:0,checkable:!0,hidePosts:!1,disableHidden:!1};var tt=(0,W.Z)()(et),Ke=a(38642),$e=["cluster","class"];class we extends l().Component{constructor(c){super(c);this.checkAll=(d,e)=>{d.preventDefault(),this.props.contextData.checkAll(e)},this.getIsCheckAll=()=>{var d=[].concat(this.context["".concat(this.props.dataTypeKey,"List")],$e.includes(this.props.dataTypeKey)?[]:this.context["".concat(this.props.dataTypeKey,"User")]);if(d.length===0)return!1;var e=d.findIndex(n=>!n.isChecked);return e===-1},this.renderDeptName=(d,e)=>e==="dept"?l().createElement(ee.Z,{type:d.source_type,value:d.id,name:d.name,dataType:"departmentName"}):d.name,this.renderName=d=>l().createElement(ee.Z,{type:d.source_type,value:d.user_id,name:d.name,dataType:"userName"}),this.state={isShowCheckAllEle:!0,whiteList:{belleFlag:(0,Ke.UI)("BELLE_CUSTOMER_WHITE")}}}render(){var c=this.state,d=c.isShowCheckAllEle,e=c.whiteList,n=this.props,h=n.t,p=n.dataTypeKey,s=n.disableHidden,g=n.scrollFlag,P=this.context,D=P.maxDeptUserCount,K=P.hidePosts,$=P.onlyPost,G=P.onlyUser,H=P.single,J=[],q=this.context["".concat(this.props.dataTypeKey,"List")].map(te=>(J.push(l().createElement("div",{className:"title-item",key:te.id},this.renderDeptName(te,p))),e.belleFlag&&g?l().createElement(tt,{type:p,key:te.id,cardInfo:te,hasNext:!0,checkable:D&&(te==null?void 0:te.userCount)>D?!1:!($&&te.post_type==="post_group"||G),single:H,userCount:te.userCount,isChecked:!!te.isChecked,itemId:te.id,title:this.renderDeptName(te,p),contextData:this.props.contextData,hasNextPost:this.props.dataTypeKey==="post"&&!!te.children,hidePosts:K,disableHidden:s}):l().createElement(Xe,{type:p,key:te.id,cardInfo:te,hasNext:!0,checkable:D&&(te==null?void 0:te.userCount)>D?!1:!($&&te.post_type==="post_group"||G),single:H,userCount:te.userCount,isChecked:!!te.isChecked,itemId:te.id,title:this.renderDeptName(te,p),contextData:this.props.contextData,hasNextPost:this.props.dataTypeKey==="post"&&!!te.children,hidePosts:K,disableHidden:s}))),ie=[],ge=$e.includes(this.props.dataTypeKey)?[]:this.context["".concat(this.props.dataTypeKey,"User")].map(te=>(ie.push(l().createElement("div",{className:"title-item",key:te.id},this.renderName(te,p))),e.belleFlag&&g?l().createElement(tt,{key:te.id,hasNext:!1,title:this.renderName(te),isChecked:!!te.isChecked,itemId:te.id,cardInfo:te,checkable:!(te.reserve||this.context.onlyDept),single:this.context.single,contextData:this.props.contextData,type:this.props.dataTypeKey,disableHidden:s}):l().createElement(Xe,{key:te.id,hasNext:!1,title:this.renderName(te),isChecked:!!te.isChecked,itemId:te.id,cardInfo:te,checkable:!(te.reserve||this.context.onlyDept),single:this.context.single,contextData:this.props.contextData,type:this.props.dataTypeKey,disableHidden:s}))),Ue=this.getIsCheckAll(),Ze=l().createElement("div",{className:"org-tree-item"},l().createElement(ne.Z,{checked:Ue,defaultChecked:!0,onClick:te=>this.checkAll(te,!Ue)},h("common.all")));return l().createElement("div",{className:"".concat(this.context.oneDisplayType?"org-tree more-height":"org-tree"," ").concat(e.belleFlag&&g?"org-tree-belle":"")},!this.context.single&&this.context.onlyUser&&!this.context.onlyDept&&!this.context.onlyPost&&q.length===0&&ge.length>0&&d||!this.context.single&&!this.context.onlyUser&&!this.context.onlyDept&&!this.context.onlyPost&&(q.length>0||ge.length>0)&&d?Ze:null,e.belleFlag&&g&&l().createElement("div",{className:"belle-title-scroll"},J,ie),q,ge)}}we.contextType=U,we.defaultProps={dataTypeKey:"dept",contextData:{},disableHidden:!1,scrollFlag:!1};var Me=(0,W.Z)()(we),at=a(25547),je="999",st=1,nt=["clusterList","classList"];class ze extends l().Component{constructor(c,d){var e;super(c);e=this,this.getClusterList=()=>{var n=F.ZP.OrgDialog.getClusterList(),h={keyword:""};me.WY.get({url:n,params:h}).then(p=>{this.context.initTypeList("clusterList","checkedCluster",p.data.data.map(s=>({name:s.name,userCount:s.user_count,id:s.id,parentId:[""]})))})},this.getClassList=()=>{this.context.initTypeList("classList","checkedClass",[{name:"\u6D4B\u8BD52",userCount:2,id:"2",parentId:[""]},{name:"\u6D4B\u8BD54",userCount:1,id:"41",parentId:[""]}])},this.flatTreeData=(n,h)=>(n.children.forEach(p=>{p.children&&(h[p.id]=p.children,this.flatTreeData(p,h))}),h),this.getDeptList=function(n){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return new Promise((p,s)=>{var g=e.state.cacheId;De({departmentId:n,cache_id:g,filter_auth:h&&!e.props.filterAuthOpen}).then(P=>{var D=P.data.children||[];D.forEach($=>{$.parentId=P.data.id,$.userCount=$.user_count,$.name=$.department_name,$.all_name=l().createElement("span",null,e.state.contextData.breadNav.map(G=>l().createElement("span",{key:G.value},G.label,"/")),$.department_name)});var K=[];e.context.asyncDeptTree?K=D:K=e.flatTreeData(P.data,{[P.data.id]:D}),e.setState({deptList:K}),e.context.initTypeList("deptList","checkedDept",D),p(P.data)}).catch(P=>{console.error(P),s(P)})})},this.getDeptUserList=function(n){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,p=e.state.cacheId;Te({departmentId:n,cache_id:p,filter_auth:h&&!e.props.filterAuthOpen}).then(s=>{s.data&&s.data.forEach(g=>{g.name=g.user_name,g.detailInfo=!1}),e.context.initTypeUser("deptUser",s.data)}).catch(s=>{console.error(s)})},this.getGroupList=()=>{var n=F.ZP.Organization.getGroupList(),h={filter_auth:!this.props.filterAuthOpen,user_type:this.context.userType};me.WY.get({url:n,params:h}).then(p=>{p.data.groups=p.data.groups||[],p.data.groups.forEach(s=>{s.parentId=this.state.contextData.breadNav.map(g=>g.value),s.userCount=s.user_count,s.name=s.group_name}),this.setState({groupList:p.data.groups}),this.context.initTypeList("groupList","checkedGroup",p.data.groups)})},this.getGroupUserList=n=>{var h=F.ZP.Organization.getGroupUserList({groupId:n}),p={filter_auth:!this.props.filterAuthOpen,user_type:this.context.userType};me.WY.get({url:h,params:p}).then(s=>{s.data.users&&s.data.users.forEach(g=>{g.name=g.user_name,g.parentId=this.state.contextData.breadNav.map(P=>P.value)}),this.context.initTypeUser("groupUser",s.data.users)})},this.getPostList=n=>{var h=F.ZP.Organization.getPostTree(),p={filter_auth:!this.props.filterAuthOpen,post_id:n,user_type:this.context.userType};me.WY.get({url:h,params:p}).then(s=>{s.data.posts=s.data.posts||[],s.data.posts.forEach(g=>{g.parentId=this.state.contextData.breadNav.map(P=>P.value),g.userCount=g.user_count,g.name=g.post_name}),this.setState({postList:s.data.posts}),this.context.initTypeList("postList","checkedPost",s.data.posts),this.context.initHidePostsStatus(s.data.hide_posts==="true")})},this.getPostUserList=n=>{var h=F.ZP.Organization.getPostUserList({postId:n}),p={filter_auth:!this.props.filterAuthOpen,user_type:this.context.userType};me.WY.get({url:h,params:p}).then(s=>{s.data.users&&s.data.users.forEach(g=>{g.name=g.user_name,g.parentId=this.state.contextData.breadNav.map(P=>P.value)}),this.context.initTypeUser("postUser",s.data.users)})},this.getUserList=function(n){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.props.type==="dept"?e.getDeptUserList(n,h):e.props.type==="group"?e.getGroupUserList(n):e.getPostUserList(n)},this.checkOne=(n,h,p)=>{var s=this.state.checkedCount;if(h==="list"){var g=this.context[this.state.listType].find(D=>D.id===n);g.isChecked=p,g.all_name&&typeof g.all_name=="object"&&delete g.all_name,s=p?s+1:s-1,this.context.checkListOne(g,this.state.checkedListType,this.state.listType)}else if(h==="user"){var P=this.context[this.state.checkedUserType].find(D=>D.id===n);P.isChecked=p,s=p?s+1:s-1,this.context.checkUserOne(P,this.state.checkedUserType)}this.updateCheckedCount(s)},this.updateCheckedCount=n=>{this.setState({checkedCount:n})},this.checkAll=function(){var n=(0,A.Z)(O().mark(function h(p){var s,g,P,D,K,$,G,H,J,q,ie,ge,Ue,Ze,te;return O().wrap(function(We){for(;;)switch(We.prev=We.next){case 0:if(s=e.state,g=s.contextData,P=s.cacheId,D=[...g.breadNav].reverse(),K=(0,V.Z)(D,1),$=K[0],G=$.value,H=[...e.context[e.state.checkedListType]],J=$.authorized==="false",q={departments:[],users:[]},!J){We.next=12;break}return We.next=9,ke({departmentId:G,cache_id:P});case 9:ie=We.sent,ge=ie.data,q={departments:ge.departments.map(re=>(re.isChecked=p,re.name=re.department_name,re.parentId=re.parent_ids.split("/"),re.parentAuthorize=!1,re.userCount=re.user_count,re)),users:ge.users.map(re=>(re.isChecked=p,re.name=re.user_name,re.parentAuthorize=!1,re))};case 12:Ue=e.context[e.state.listType].map(re=>{re.isChecked=p,e.props.type!=="dept"&&H.forEach(Be=>{Be.parentId.indexOf("".concat(re.id))!==-1&&(Be.isChecked=!1)});var Ae=H.findIndex(Be=>Be.id===re.id);return Ae!==-1?H[Ae].isChecked=p:H.push(re),re}),Ze=[],e.context.checkedUser.forEach(re=>{if(e.props.type!=="dept"){if(typeof re.parentId!="undefined"&&re.parentId.indexOf("".concat(G))!==-1&&re.parentId[re.parentId.length-1]!==G)return}else{var Ae=typeof re.parentId!="undefined"?re.parentId:re.department_ids||[];if(Ae.indexOf(G)!==-1)return}Ze.push(re)}),te=nt.includes(e.state.listType)?[]:e.context[e.state.checkedUserType].map(re=>{re.isChecked=p;var Ae=Ze.findIndex(Be=>Be.id===re.id);return Ae!==-1?Ze[Ae].isChecked=p:Ze.push(re),re}),e.context.toggleDisplayList(e.state.checkedListType,Z()(q.departments,H,"id"),e.state.listType,Ue,e.state.checkedUserType,te,Z()(q.users,Ze,"id")),e.setState({checkedCount:p?(nt.includes(e.state.listType)?0:e.context[e.state.checkedUserType].length)+e.context[e.state.listType].length:0});case 18:case"end":return We.stop()}},h)}));return function(h){return n.apply(this,arguments)}}(),this.nextLevel=(n,h,p)=>{this.context.clearTabPanelList(this.state.listType,this.state.checkedUserType);var s=[...this.state.contextData.breadNav,{value:n.id,label:h,authorized:n.authorized}];this.setState({contextData:(0,C.Z)((0,C.Z)({},this.state.contextData),{},{breadNav:s})},()=>{this.props.type==="post"?this.nextPostLevel(n.id,p):this.props.type==="dept"?this.nextDeptLevel(n.id,!(_()(n,"authorized")&&n.authorized==="true")):this.context.initTypeList("groupList","checkedGroup",[]),this.getUserList(n.id===je?st:n.id,!(_()(n,"authorized")&&n.authorized==="true"))})},this.nextDeptLevel=(n,h)=>{if(this.context.asyncDeptTree)this.getDeptList(n,h);else{var p=this.state.deptList[n];typeof p!="undefined"&&p.forEach(s=>{s.parentId=this.state.contextData.breadNav.map(g=>g.value),s.userCount=s.user_count,s.name=s.department_name}),this.context.initTypeList("deptList","checkedDept",p||[])}},this.nextPostLevel=(n,h)=>{if(h){var p=(0,at.lK)(this.state.postList,n),s=p.children.map(g=>(g.name=g.post_name,g.parentId=this.state.contextData.breadNav.concat([n]).map(P=>P.value),g.userCount=g.user_count,g));this.context.initTypeList("postList","checkedPost",s)}},this.changeLevel=(n,h,p)=>{this.context.clearTabPanelList(this.state.listType,this.state.checkedUserType);var s=this.props.type==="group"?[this.state.contextData.breadNav[0]]:this.state.contextData.breadNav.slice(0,h+1);this.setState({contextData:(0,C.Z)((0,C.Z)({},this.state.contextData),{},{breadNav:s}),isSearch:!1},()=>{this.props.type==="dept"?this.changeDeptLevel(n,p):this.props.type==="group"?this.changeGroupLevel(n):this.props.type==="cluster"?this.getClusterList():this.props.type==="class"?this.getClassList():this.changePostLevel(n)})},this.changeDeptLevel=function(n){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(e.context.asyncDeptTree)e.getDeptList(n,h);else{var p=e.state.deptList[n];p.forEach(s=>{s.parentId=e.state.contextData.breadNav.map(g=>g.value),s.userCount=s.user_count,s.name=s.department_name}),e.context.initTypeList("deptList","checkedDept",p)}e.getDeptUserList(n===je?st:n,h)},this.changePostLevel=n=>{var h=n==="1"?this.state.postList:(0,at.lK)(this.state.postList,n).children,p=h.map(s=>(s.name=s.post_name,s.parentId=this.state.contextData.breadNav.concat([n]).map(g=>g.value),s.userCount=s.user_count,s));this.context.initTypeList("postList","checkedPost",p),n!=="1"&&this.getPostUserList(n===je?st:n)},this.changeGroupLevel=n=>{n||(this.context.initTypeUser("groupUser",[]),this.context.initTypeList("groupList","checkedGroup",this.state.groupList))},this.state={postList:[],deptList:[],groupList:[],clusterList:[],classList:[],contextData:{breadNav:[this.props.defaultBreadNav],checkOne:this.checkOne,checkAll:this.checkAll,nextLevel:this.nextLevel,changeLevel:this.changeLevel},checkedCount:0,listType:"".concat(this.props.type,"List"),checkedListType:"checked".concat(this.props.type.charAt(0).toUpperCase()).concat(this.props.type.substr(1)),checkedUserType:"".concat(this.props.type,"User"),isSearch:!1,searchResult:[],loadDept:!1,loadUser:!1,cacheId:d.cacheId}}componentDidMount(){this.props.type!=="group"?this.props.type==="dept"?this.getDeptList("1").then(c=>{this.setState({contextData:(0,C.Z)((0,C.Z)({},this.state.contextData),{},{breadNav:[{value:c.id,label:c.department_name,sourceType:c.source_type,authorized:c.authorized}]})}),this.getDeptUserList("1")}):this.getPostList("1"):this.getGroupList(1),this.props.type==="cluster"&&this.getClusterList(),this.props.type==="class"&&this.getClassList()}render(){return l().createElement(T.Provider,{value:this.state.contextData},l().createElement("div",{className:"org-display-container org-display-dept"},l().createElement(pt,null),this.props.type==="dept"&&(this.state.loadDept||this.state.loadUser)?l().createElement("div",{className:"dept-loading"},l().createElement(z.Z,null)):null,l().createElement(ht,{dataTypeKey:this.props.type,disableHidden:this.props.disableHidden,scrollFlag:this.props.scrollFlag})))}}ze.contextType=U;var pt=(0,S.l)(T,le),ht=(0,S.l)(T,Me);ze.defaultProps={defaultBreadNav:{value:"",label:"\u9177\u6E32\u79D1\u6280"},queryType:1,type:"dept",filterAuthOpen:!1,disableHidden:!1,scrollFlag:!1};var it=ze,Et=a(57663),rt=a(71577),mt=a(54549);class lt extends l().Component{constructor(){super(...arguments);this.removeItem=(c,d,e,n)=>{c.preventDefault(),d.isChecked=!1,n==="user"?this.context.removeCheckedUser(d):this.context.checkListOne(d,e,"".concat(n,"List"))},this.displayName=(c,d)=>{var e={user:"userName",dept:"departmentName"}[c]||"",n={user:d.unionid||d.user_id||d.userId,dept:d.id}[c]||d.id;return l().createElement(ee.Z,{value:n,name:d.name,type:d.source_type||d.sourceType,dataType:e})},this.displayItem=c=>{var d=this.context,e=d.hidePosts,n=d.showUserCount,h="checked".concat(c.charAt(0).toUpperCase()).concat(c.substr(1)),p=this.context[h].map(s=>s.isChecked&&s.authorized!=="false"?l().createElement(fe.Z,{key:s.id,placement:"top",title:s.all_name||"",getPopupContainer:()=>document.querySelector(".checked-display-container")},l().createElement("div",{className:"display-item",key:s.id},this.displayName(c,s),c==="user"||e&&c==="post"?"":n&&s.userCount>-1?"(".concat(s.userCount,")"):"",s.reserve?null:l().createElement("span",{className:"display-item-close",onClick:g=>this.removeItem(g,s,h,c)},l().createElement(mt.Z,{style:{fontSize:"8px",color:"#afb5d2"}})))):null);return p},this.handleClearSelected=()=>{this.context.clearSelectedAll()}}render(){var c=this.props.t,d=["dept","group","post","user","cluster","class"].map(e=>this.displayItem(e));return l().createElement("div",{className:"checked-display-container"},l().createElement("div",{className:"checked-display-container-header"},l().createElement("span",null,c("orgDialog.selected"),":"),l().createElement(rt.Z,{type:"link",onClick:this.handleClearSelected},c("orgDialog.clearAll"))),d)}}lt.contextType=U;var ft=(0,W.Z)()(lt),Ge=a(67222),ot=a(6793),vt=E.Z.Search;class gt extends l().Component{constructor(c){var d;super(c);d=this,this.onChange=e=>{var n=this.props.appType,h=localStorage.getItem("qyWechatBook");if(e.preventDefault(),this.setState({value:e.target.value}),!(!e.target.value&&!this.props.showCancel)&&!this.props.disableChange){var p=n==="wx_app"&&h==="true";!(0,Ke.eY)("ORG_DIALOG_SEARCH")||p||(0,ot.Ds)(this.debounceChange,500)()}},this.handleSearch=(e,n)=>{n.preventDefault(),!(!e&&!this.props.showCancel)&&this.extendReturn(e)},this.debounceChange=()=>{this.extendReturn(this.state.value)},this.extendReturn=function(){var e=(0,A.Z)(O().mark(function n(h){var p,s,g,P,D,K,$,G,H;return O().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:if(p=d.props,s=p.appType,g=p.selectType,P=p.appId,D=localStorage.getItem("qyWechatBook"),K="",$=s==="wx_app"&&D==="true"&&P==="9005",!(h&&g==="user"&&$)){q.next=17;break}return q.prev=5,q.next=8,(0,Ge.F_)(h);case 8:G=q.sent,H=G.data,H.success&&(K=H.data),q.next=17;break;case 13:q.prev=13,q.t0=q.catch(5),console.error(q.t0),K="";case 17:d.props.onSearch(h,K);case 18:case"end":return q.stop()}},n,null,[[5,13]])}));return function(n){return e.apply(this,arguments)}}(),this.state={value:""}}render(){var c=this.props,d=c.t,e=c.selectType;return l().createElement("div",{className:"top-search"},l().createElement(vt,{placeholder:d(e==="user"?"component.searchStudent":e==="dept"?"component.searchDepartment":e==="post"?"component.searchPost":e==="cluster"?"component.searchCluster":e==="class"?"component.searchClass":"setting.searchGroup"),value:this.state.value,onSearch:this.handleSearch,allowClear:!0,onChange:this.onChange}))}}var ct=(0,ue.$j)(m=>({appType:m.user.appType,appId:m.user.appId}))((0,W.Z)()(gt)),dt=a(87312);class Ve extends t.Component{constructor(){super(...arguments);this.checkedAll=(c,d)=>{this.props.checkedAll(d)},this.getIsCheckedAll=()=>{var c=this.props.list,d=[].concat(c);if(d.length===0)return!1;var e=d.findIndex(n=>!n.isChecked);return e===-1},this.checkUser=(c,d)=>{d.isChecked=!d.isChecked,this.context.checkUserOne(d,"checkedUser")},this.checkSingleUser=(c,d)=>{d.isChecked=!0,this.context.checkUserOne(d,"checkedUser")},this.checkDept=(c,d)=>{d.isChecked=!d.isChecked,this.context.checkListOne(d,"checkedDept","deptList")},this.checkPost=(c,d)=>{d.isChecked=!d.isChecked,this.context.checkListOne(d,"checkedPost","postList")},this.checkGroup=(c,d)=>{d.isChecked=!d.isChecked,this.context.checkListOne(d,"checkedGroup","groupList")},this.checkedCluster=(c,d)=>{d.isChecked=!d.isChecked,this.context.checkListOne(d,"checkedCluster","clusterList")}}renderList(){var c=this.props,d=c.userListType,e=c.list,n=c.t,h=c.isSingle,p=c.hidePosts;return d==="user"&&!h?e.map(s=>l().createElement("div",{className:"search-result-item",key:s.id,onClick:g=>{this.checkUser(g,s)}},l().createElement(ne.Z,{checked:s.isChecked},l().createElement(Oe,{cardInfo:s},l().createElement("span",{className:"user-names"},l().createElement(ee.Z,{dataType:"userName",value:s.user_id,name:s.user_name,type:s.source_type}))),s.department_names&&s.department_names.length>0?l().createElement("span",{className:"user-dept"},l().createElement(xe.Z,{sourceType:s.source_type,list:s.leaf_department_ids,nameList:s.department_names})):null))):d==="user"&&h?e.map(s=>l().createElement("div",{className:"search-result-item",key:s.id,onClick:g=>{this.checkSingleUser(g,s)}},l().createElement("div",{className:"user-name"},l().createElement(Oe,{cardInfo:s},l().createElement(ee.Z,{dataType:"userName",value:s.user_id,name:s.user_name,type:s.source_type}))),s.department_names&&s.department_names.length>0?l().createElement("span",{className:"user-name-dept"},l().createElement(xe.Z,{sourceType:s.source_type,list:s.leaf_department_ids,nameList:s.department_names})):null)):d==="dept"?e.map(s=>l().createElement("div",{className:"search-result-dept-item",key:s.id,onClick:g=>{this.checkDept(g,s)}},l().createElement(ne.Z,{checked:s.isChecked,className:"department-left"},l().createElement("div",{className:"department-left-department"},l().createElement("div",{className:"user-name"},l().createElement(ee.Z,{dataType:"departmentName",value:s.id,name:s.department_name,type:s.source_type})),s.path&&s.path.length>0?l().createElement(fe.Z,{title:s.path.join(">"),mouseEnterDelay:.8},l().createElement("span",{className:"user-name-dept"},l().createElement(xe.Z,{list:s.department_infos||[],displayAll:!0}))):null)),l().createElement("div",{className:"department-right"},"(",s.userCount,n("common.userUnit"),")"))):d==="post"?e.map(s=>l().createElement("div",{className:"search-result-dept-item",key:s.id,onClick:g=>{this.checkPost(g,s)}},l().createElement(ne.Z,{checked:s.isChecked,className:"department-left"},l().createElement("div",{className:"department-left-department"},l().createElement("div",{className:"user-name"},s.name),s.path&&s.path.length>0?l().createElement(fe.Z,{title:s.path.join(">"),mouseEnterDelay:.8},l().createElement("span",{className:"user-name-dept"},l().createElement("span",null,s.path.join(">")))):null)),!p&&l().createElement("div",{className:"department-right"},"(",s.userCount,n("common.userUnit"),")"))):d==="group"?e.map(s=>l().createElement("div",{className:"search-result-dept-item",key:s.id,onClick:g=>{this.checkGroup(g,s)}},l().createElement(ne.Z,{checked:s.isChecked,className:"department-left"},l().createElement("div",{className:"department-left-department"},l().createElement("div",{className:"user-name"},s.name),s.path&&s.path.length>0?l().createElement(fe.Z,{title:s.path.join(">"),mouseEnterDelay:.8},l().createElement("span",{className:"user-name-dept"},l().createElement("span",null,s.path.join(">")))):null)),l().createElement("div",{className:"department-right"},"(",s.userCount,n("common.userUnit"),")"))):d==="cluster"?e.map(s=>l().createElement("div",{className:"search-result-dept-item",key:s.id,onClick:g=>{this.checkedCluster(g,s)}},l().createElement(ne.Z,{checked:s.isChecked,className:"department-left"},l().createElement("span",{className:"user-name"},s.name)),l().createElement("div",{className:"department-right"},"(",s.userCount,n("common.userUnit"),")"))):null}render(){var c=this.props,d=c.t,e=c.isSingle,n=this.getIsCheckedAll(),h=l().createElement("div",{className:"search-result-all"},l().createElement(ne.Z,{checked:n,onClick:p=>this.checkedAll(p,!n)},d("common.all")));return l().createElement("div",{className:"search-result-container more-height"},this.props.list.length>0?l().createElement(l().Fragment,null,!e&&h,this.renderList()):l().createElement(dt.Z,{tipText:d("component.searchUserEmpty")}))}}Ve.contextType=U,Ve.defaultProps={list:[]};var Ne=(0,W.Z)()(Ve),Ct=a(18329),yt=a(65202),he=a(91648),f=x.Z.TabPane,i=R.Z.Option,o={size:"large",destroyOnClose:!0,bodyStyle:{padding:"0 20px"},maskClosable:!1};class u extends l().Component{constructor(c){var d;super(c);d=this,this.onCancel=()=>{var e=this.props.onCancel;this.setState({showCancel:!1}),e&&this.props.onCancel()},this.onOk=()=>{var e=this.props.onOk,n=this.state.contextData;this.setState({showCancel:!1});var h=0;if(e){var p=[];n.checkedDept.map($=>(h+=$.isChecked?$.user_count:0,$.isChecked&&$.authorized!=="false"?p.push((0,C.Z)((0,C.Z)({},$),{},{renderType:"dept"})):null));var s=[];n.checkedPost.map($=>(h+=$.isChecked?$.user_count:0,$.isChecked?s.push((0,C.Z)((0,C.Z)({},$),{},{renderType:"post"})):null));var g=[];n.checkedGroup.map($=>(h+=$.isChecked?$.user_count:0,$.isChecked?g.push((0,C.Z)((0,C.Z)({},$),{},{renderType:"group"})):null));var P=[];n.checkedUser.map($=>{if(!$.reserve)return h+=$.isChecked?1:0,$.isChecked?P.push((0,C.Z)((0,C.Z)({},$),{},{renderType:"user"})):null});var D=[];n.checkedCluster.map($=>{if(!$.reserve)return h+=$.isChecked?1:0,$.isChecked?D.push((0,C.Z)((0,C.Z)({},$),{},{renderType:"cluster"})):null});var K=[];if(n.checkedClass.map($=>{if(!$.reserve)return h+=$.isChecked?1:0,$.isChecked?K.push((0,C.Z)((0,C.Z)({},$),{},{renderType:"class"})):null}),h>this.props.maxUserCount){L.default.warn(this.props.beyondLimitTip);return}e({dept:p,post:s,group:g,user:P,cluster:D,classes:K})}},this.getListParentId=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:[],g=arguments.length>5&&arguments[5]!==void 0?arguments[5]:[];n.forEach(G=>{G.isChecked=!0,G.parentId=[""],G.userCount=G.userCount||G.user_count||0});var P=e.map(G=>G.id),D=p.map(G=>G.id);if(P||D){var K=F.ZP.OrgDialog.getDeptParent(),$={query_type:1,dept_ids:P,user_ids:D};me.WY.post({url:K,data:(0,C.Z)({},$)}).then(G=>{var H=G.data.data;e.forEach(J=>{J.isChecked=!0;var q=H.find(ie=>ie.id===J.id)||{path:[]};J.parentId=q.path[0]?q.path[0].split("/").slice(1):[],J.userCount=q.user_count||J.userCount||J.user_count||0}),h.forEach(J=>{J.isChecked=!0;var q=H.find(ie=>ie.id===J.id)||{path:[]};J.parentId=q.path[0]?q.path[0].split("/").slice(1):[],J.userCount=J.userCount||J.user_count||0}),p.forEach(J=>{J.isChecked=!0;var q=[];H.forEach(ie=>{ie.id===J.id&&ie.path.map(ge=>{q.push(...ge.split("/").slice(1))})}),J.parentId=Array.from(new Set(q))}),s.forEach(J=>{J.isChecked=!0;var q=H.find(ie=>ie.id===J.id)||{path:[]};J.parentId=q.path[0]?q.path[0].split("/").slice(1):[],J.userCount=J.userCount||J.user_count||0}),g.forEach(J=>{J.isChecked=!0;var q=H.find(ie=>ie.id===J.id)||{path:[]};J.parentId=q.path[0]?q.path[0].split("/").slice(1):[],J.userCount=J.userCount||J.user_count||0}),d.setState({contextData:(0,C.Z)((0,C.Z)({},d.state.contextData),{},{checkedDept:e,checkedGroup:n,checkedPost:h,checkedUser:p,checkedCluster:s,checkedClass:g})})})}else n.length>0?d.setState({contextData:(0,C.Z)((0,C.Z)({},d.state.contextData),{},{checkedGroup:n})}):d.setState({contextData:(0,C.Z)((0,C.Z)({},d.state.contextData),{},{checkedDept:[],checkedGroup:[],checkedPost:[],checkedUser:[],checkedCluster:[],checkedClass:[],searchResult:[]})})},this.initHidePostsStatus=e=>{var n=this.state.contextData;this.setState({contextData:(0,C.Z)((0,C.Z)({},n),{},{hidePosts:e})})},this.initTypeList=(e,n,h)=>{h.forEach(p=>{var s=this.findItemIndex(p.id,n);s===-1?p.isChecked=!1:p.isChecked=this.state.contextData[n][s].isChecked}),this.setState({contextData:(0,C.Z)((0,C.Z)({},this.state.contextData),{},{[e]:h})})},this.initTypeUser=(e,n)=>{var h=n||[...this.state.contextData[e]],p=this.props.reserveUser;h.forEach(s=>{var g=this.findItemIndex(s.id,"checkedUser");p.findIndex(P=>P.id===s.id)!==-1&&(s.reserve=!0),g===-1?s.isChecked=!1:s.isChecked=this.state.contextData.checkedUser[g].isChecked}),this.setState({contextData:(0,C.Z)((0,C.Z)({},this.state.contextData),{},{[e]:h})})},this.toggleDisplayItem=(e,n)=>{var h=this.findItemIndex(e.id,n);return h===-1?n.match(/checkedPost|checkedDept|checkedGroup|checkedCluster|checkedClass/)?{[n]:this.checkListParentId(n,e),checkedUser:e.isChecked?this.checkParentId(this.state.contextData.checkedUser,e.id):this.state.contextData.checkedUser}:{[n]:[...this.state.contextData[n],e]}:n.match(/checkedPost|checkedDept|checkedGroup|checkedCluster|checkedClass/)?{[n]:this.checkListParentId(n,e),checkedUser:e.isChecked?this.checkParentId(this.state.contextData.checkedUser,e.id):this.state.contextData.checkedUser}:{checkedUser:this.getNewList(e,"checkedUser",!0),[n]:this.getNewList(e,n)}},this.toggleDisplayList=(e,n,h,p,s,g,P)=>{this.deleteAllName(n),this.deleteAllName(p),this.setState({contextData:(0,C.Z)((0,C.Z)({},this.state.contextData),{},{[e]:n,[h]:p,[s]:g,checkedUser:P})})},this.deleteAllName=e=>{e.map(n=>(n.all_name&&typeof n.all_name=="object"&&delete n.all_name,n))},this.checkUserOne=(e,n)=>{this.props.single?this.setState({contextData:(0,C.Z)((0,C.Z)({},this.state.contextData),{},{checkedUser:[e],[n]:n==="checkedUser"?[e]:this.getSingleUserList(e,n)})}):this.setState({contextData:(0,C.Z)((0,C.Z)({},this.state.contextData),this.toggleDisplayItem(e,n))})},this.dealAuthorizedFalseChecked=function(){var e=(0,A.Z)(O().mark(function n(h){var p,s,g,P,D,K,$,G,H;return O().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return p=d.state.contextData,s=p.cacheId,g=p.checkedDept,P=p.checkedUser,D={checkedDept:[],checkedUser:[]},q.prev=2,q.next=5,ke({departmentId:h.id,cache_id:s});case 5:K=q.sent,$=K.data,G=$.departments,H=$.users,G.push(h),G.map(ie=>(ie.isChecked=!0,ie.name=ie.department_name,ie.parentId=ie.parent_ids.split("/"),ie.parentAuthorize=!1,ie.userCount=ie.user_count,ie)),H.map(ie=>(ie.isChecked=!0,ie.name=ie.user_name,ie.parentAuthorize=!1,d.toggleDisplayItem(ie,"deptUser"),ie)),D=(0,C.Z)((0,C.Z)({},D),{},{checkedUser:Z()(H,P,"id"),checkedDept:Z()(G,g,"id")}),q.next=16;break;case 13:q.prev=13,q.t0=q.catch(2),console.error("\u83B7\u53D6\u90E8\u95E8\u7BA1\u8F96\u8303\u56F4\u51FA\u9519",q.t0);case 16:return q.abrupt("return",D);case 17:case"end":return q.stop()}},n,null,[[2,13]])}));return function(n){return e.apply(this,arguments)}}(),this.dealAuthorizedFalseUnChecked=e=>{var n=this.state.contextData,h=n.checkedDept,p=n.checkedUser,s=n.deptUser,g=[],P=h.filter(K=>K.parent_ids.split("/").indexOf(e.id)===-1),D=p.filter(K=>{var $=K.department_ids.indexOf(e.id)===-1;return $||g.push(K.id),$});return{checkedDept:P,checkedUser:D,deptUser:g.length>0?s.map(K=>(g.indexOf(K.id)>-1&&(K.isChecked=!1),K)):s}},this.checkListOne=function(){var e=(0,A.Z)(O().mark(function n(h,p,s){var g;return O().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(g={checkedDept:[],checkedUser:[]},!(h.authorized==="false"&&p==="checkedDept")){D.next=12;break}if(!h.isChecked){D.next=8;break}return D.next=5,d.dealAuthorizedFalseChecked(h);case 5:D.t0=D.sent,D.next=9;break;case 8:D.t0=d.dealAuthorizedFalseUnChecked(h);case 9:g=D.t0,D.next=14;break;case 12:h.parentAuthorize===!1&&h.isChecked===!1&&d.unCheckedParentDept(h,p),g=(0,C.Z)({[s]:d.getNewList(h,s,!1)},d.toggleDisplayItem(h,p));case 14:d.setState({contextData:(0,C.Z)((0,C.Z)({},d.state.contextData),g)});case 15:case"end":return D.stop()}},n)}));return function(n,h,p){return e.apply(this,arguments)}}(),this.removeCheckedUser=e=>{this.setState({contextData:(0,C.Z)((0,C.Z)({},this.state.contextData),{},{checkedUser:this.getNewList(e,"checkedUser"),deptUser:this.getNewList(e,"deptUser"),postUser:this.getNewList(e,"postUser"),groupUser:this.getNewList(e,"groupUser"),searchResult:this.getNewList(e,"searchResult")})})},this.unCheckedParentDept=(e,n)=>{var h=this.state.contextData.checkedDept,p=h.filter(P=>P.authorized==="false"&&n==="checkedUser"?e.department_ids.indexOf(P.id)>-1:n==="checkedDept"?e.parentId.indexOf(P.id)>-1:!1),s=(0,V.Z)(p,1),g=s[0];g&&(g.isChecked=!1,this.toggleDisplayItem(g,"checkedDept"),this.setState({contextData:(0,C.Z)((0,C.Z)({},this.state.contextData),{},{checkedDept:p})}))},this.checkListParentId=(e,n)=>{var h=[...this.state.contextData[e]],p=this.findItemIndex(n.id,e);return h.forEach(s=>{s.id!==n.id&&s.parentId.indexOf("".concat(n.id))!==-1?s.isChecked=!1:s.id===n.id&&(s.isChecked=n.isChecked)}),p===-1&&h.push(n),h},this.checkParentId=(e,n)=>{var h=[];return e.forEach(p=>{var s=typeof p.parentId!="undefined"?p.parentId:p.department_ids||[];s.indexOf(n)===-1&&h.push(p)}),h},this.getNewList=(e,n,h)=>{var p=[...this.state.contextData[n]],s=this.findItemIndex(e.id,n);return s===-1?h&&p.push(e):p[s].isChecked=e.isChecked,p},this.getSingleUserList=(e,n)=>{var h=[...this.state.contextData[n]];return h.forEach(p=>{p.id===e.id?p.isChecked=e.isChecked:p.isChecked=!1}),h},this.findItemIndex=(e,n)=>this.state.contextData[n].findIndex(h=>h.id===e),this.clearTabPanelList=(e,n)=>{this.setState({contextData:(0,C.Z)((0,C.Z)({},this.state.contextData),{},{[e]:[],[n]:[]})})},this.getTabs=()=>{var e=[],n,h,p=this.props,s=p.t,g=p.filterAuthOpen,P=p.disableHidden,D=p.scrollFlag,K=this.state.contextData,$=K.canUseGroups,G=K.canUseClass;return this.state.displayType.forEach(H=>{switch(H){case"dept":e.push({label:s("component.orgDialogDeptLabel"),key:"dept",defaultBreadNav:{value:"",label:"",sourceType:""},queryType:1});break;case"group":e.push({label:s("component.orgDialogGroupLabel"),key:"group",queryType:2,defaultBreadNav:{value:"",label:s("component.userGroup")}});break;case"post":e.push({label:s("component.orgDialogPostLabel"),key:"post",defaultBreadNav:{value:"1",label:s("common.post")},queryType:3});break;case"cluster":$&&e.push({label:s("component.orgDialogClusterLabel"),key:"cluster",defaultBreadNav:{value:"",label:""},queryType:4});break;case"class":G&&e.push({label:s("component.orgDialogClassLabel"),key:"class",defaultBreadNav:{value:"",label:""},queryType:5});break}}),e.length===1?h=l().createElement(it,{defaultBreadNav:e[0].defaultBreadNav,queryType:e[0].queryType,type:e[0].key,filterAuthOpen:g,disableHidden:P,scrollFlag:D}):(n=e.map(H=>l().createElement(f,{tab:H.label,key:H.key},l().createElement(it,{defaultBreadNav:H.defaultBreadNav,queryType:H.queryType,type:H.key,filterAuthOpen:g,disableHidden:P,scrollFlag:D}))),h=l().createElement(x.Z,null,n)),h},this.handleSearch=(e,n)=>{var h=this.state.selectType;h==="user"?this.getUserList(e,n):h==="dept"?this.getDeptList(e):h==="post"?this.getPostList(e):h==="cluster"?this.getClusterResult(e):h==="class"?this.getClassResult(e):this.getGroupList(e)},this.getClusterResult=e=>{var n=F.ZP.OrgDialog.getClusterList(),h={keyword:e};me.WY.get({url:n,params:h}).then(p=>{this.setState({showCancel:!0}),this.initTypeList("searchResult","checkedCluster",p.data.data.map(s=>({name:s.name,userCount:s.user_count,id:s.id,parentId:[""]})))})},this.getUserList=(e,n)=>{var h=F.ZP.OrgDialog.getUserByName(),p={user_name:n===""?e:"",filter_auth:!this.props.filterAuthOpen,user_type:this.props.userType,userIds:n};me.WY.get({url:h,params:p}).then(s=>{s.data.users&&s.data.users.forEach(g=>{g.name=g.user_name}),this.setState({showCancel:!0}),this.initTypeUser("searchResult",s.data.users||[])})},this.getDeptList=e=>{var n=F.ZP.Organization.queryDept(),h={department_name:e,filter_auth:!this.props.filterAuthOpen,user_type:this.props.userType};me.WY.get({url:n,params:h}).then(p=>{p.data.departments&&p.data.departments.forEach(s=>{s.name=s.department_name,s.parentId=s.parent_ids?s.parent_ids.split("/"):[],s.userCount=s.user_count}),this.setState({showCancel:!0}),this.initTypeList("searchResult","checkedDept",p.data.departments||[])})},this.getPostList=e=>{var n=F.ZP.Organization.addPost(),h={post_name:e,filter_auth:!this.props.filterAuthOpen,user_type:this.props.userType};me.WY.get({url:n,params:h}).then(p=>{p.data.posts&&p.data.posts.forEach(s=>{s.name=s.post_name,s.parentId=s.parent_id?s.parent_id.split("/"):[],s.userCount=s.user_count}),this.setState({hidePosts:p.data.hide_posts,showCancel:!0}),this.initTypeList("searchResult","checkedPost",p.data.posts||[])})},this.getGroupList=e=>{var n=F.ZP.Organization.getGroupList(),h={group_name:e,filter_auth:!this.props.filterAuthOpen,user_type:this.props.userType};me.WY.get({url:n,params:h}).then(p=>{p.data.groups&&p.data.groups.forEach(s=>{s.name=s.group_name,s.parentId=s.parent_id?s.parent_id.split("/"):[],s.userCount=s.user_count}),this.setState({showCancel:!0}),this.initTypeList("searchResult","checkedGroup",p.data.groups||[])})},this.checkAllResult=e=>{var n=this.state,h=n.selectType,p=n.contextData,s="checked".concat(h.charAt(0).toUpperCase()).concat(h.substr(1)),g=[...p[s]],P=p.searchResult.map(K=>{K.isChecked=e;var $=g.findIndex(G=>G.id===K.id);return $!==-1?g[$].isChecked=e:g.push(K),K}),D=g;this.setState({contextData:(0,C.Z)((0,C.Z)({},this.state.contextData),{},{[s]:D,searchResult:P})})},this.clearSelectedAll=()=>{var e=this.state.contextData,n=e.checkedDept,h=e.checkedGroup,p=e.checkedPost,s=e.checkedUser,g=e.checkedCluster,P=e.checkedClass,D=e.deptList,K=e.groupList,$=e.postList,G=e.clusterList,H=e.classList,J=e.deptUser,q=e.groupUser,ie=e.postUser,ge=Ue=>(Ue.forEach(Ze=>{Ze.isChecked=!1}),Ue);this.setState({contextData:(0,C.Z)((0,C.Z)({},this.state.contextData),{},{checkedDept:[],checkedGroup:[],checkedPost:[],checkedUser:[],checkedCluster:[],checkedClass:[],deptList:n.length>0?ge(D):D,groupList:h.length>0?ge(K):K,postList:p.length>0?ge($):$,clusterList:g.length>0?ge(G):G,classList:P.length>0?ge(H):H,deptUser:s.length>0?ge(J):J,groupUser:s.length>0?ge(q):q,postUser:s.length>0?ge(ie):ie})})},this.handleCancel=()=>{this.setState({showCancel:!1})},this.handleSelectChange=e=>{this.setState({selectType:e,contextData:(0,C.Z)((0,C.Z)({},this.state.contextData),{},{searchResult:[]})})},this.state={title:c.title||c.t("component.chooseAssignScope"),displayType:c.displayType?c.displayType:["dept"],selectType:"user",showCancel:!1,hidePosts:!1,contextData:{showUserCount:c.showUserCount,deptList:[],groupList:[],postList:[],clusterList:[],classList:[],deptUser:[],groupUser:[],postUser:[],checkedDept:[],checkedGroup:[],checkedPost:[],checkedUser:[],checkedCluster:[],checkedClass:[],searchResult:[],onlyUser:c.onlyUser,onlyDept:c.onlyDept,onlyPost:c.onlyPost,canUseGroups:c.useGroups,canUseClass:c.useClass,single:c.single,asyncDeptTree:this.props.asyncDeptTree,oneDisplayType:this.props.displayType?this.props.displayType.length<=1:!0,userType:this.props.userType,initTypeList:this.initTypeList,initTypeUser:this.initTypeUser,toggleDisplayItem:this.toggleDisplayItem,toggleDisplayList:this.toggleDisplayList,checkListOne:this.checkListOne,checkUserOne:this.checkUserOne,removeCheckedUser:this.removeCheckedUser,clearTabPanelList:this.clearTabPanelList,maxDeptUserCount:c.maxDeptUserCount,hidePosts:!1,initHidePostsStatus:this.initHidePostsStatus,cacheId:(0,he.Z)(),clearSelectedAll:this.clearSelectedAll}}}componentDidUpdate(c){if(c.visible!==this.props.visible&&this.props.visible){var d=this.props.initData,e=d.dept,n=d.group,h=d.post,p=d.user,s=d.cluster,g=d.classes;console.warn(p,"user");var P=this.props,D=P.reserveUser,K=P.t,$=P.onlyDept,G=P.onlyPost;D.forEach(H=>{H.reserve=!0}),this.setState({title:this.props.title||K("component.chooseAssignScope"),displayType:this.props.displayType?this.props.displayType:["dept"],selectType:G?"post":$?"dept":"user",contextData:(0,C.Z)((0,C.Z)({},this.state.contextData),{},{deptList:[],groupList:[],postList:[],deptUser:[],clusterList:[],classList:[],groupUser:[],postUser:[],searchResult:[],onlyUser:this.props.onlyUser,onlyDept:this.props.onlyDept,canUseGroups:this.props.useGroups,canUseClass:this.props.useClass,onlyPost:this.props.onlyPost,asyncDeptTree:this.props.asyncDeptTree,oneDisplayType:this.props.displayType?this.props.displayType.length<=1:!0,cacheId:(0,he.Z)()})},()=>{this.getListParentId(e,n,h,p.concat(D),s,g)})}}componentWillUnmount(){Qe({cacheId:this.state.contextData.cacheId}).then(()=>{console.warn("\u6E05\u9664\u7F13\u5B58\u6210\u529F")}).catch(c=>{console.error("\u6E05\u9664\u7F13\u5B58\u5931\u8D25",c)})}render(){var c=this.getTabs(),d=this.props,e=d.t,n=d.onlyUser,h=d.onlyDept,p=d.onlyPost,s=d.displayType,g=d.useGroups,P=d.useClass,D=d.onlyChoosePost,K=(0,yt.p)(),$=this.state,G=$.showCancel,H=$.selectType,J=$.hidePosts;return o.okText=this.props.okText||e("common.ok"),l().createElement(Ct.ZP,(0,w.Z)({},o,this.props.modalConfig,{visible:this.props.visible,title:this.state.title,wrapClassName:[this.props.className,"cl-org-modal"],onCancel:this.onCancel,onOk:this.onOk}),l().createElement(U.Provider,{value:this.state.contextData},l().createElement("div",{className:"cl-org"},l().createElement("div",{className:"cl-org-left"},this.props.visible?l().createElement("div",{className:"cl-org-left__top"},l().createElement(E.Z.Group,{compact:!0},l().createElement(R.Z,{className:"cl-org-left__top__select",value:H,style:{width:80},onChange:this.handleSelectChange},l().createElement(i,{value:"user",disabled:h||p||D},e("authGroup.userLabel")),l().createElement(i,{value:"dept",disabled:n||D},e("setting.deptLabel")),l().createElement(i,{value:"post",disabled:!p&&(h||n)||s.length===1},e("common.post")),l().createElement(i,{value:"group",disabled:h||n||s.length===1||D},e("component.userGroup")),g?l().createElement(i,{value:"cluster"},e("component.useCluster")):null,P?l().createElement(i,{value:"class"},e("component.useClass")):null),l().createElement(ct,{selectType:H,onSearch:this.handleSearch,showCancel:G,disableChange:this.props.disableChange})),G?l().createElement("div",{className:"cl-org-left__top__cancel",onClick:this.handleCancel,style:{color:K}},e("common.cancel")):null):null,G?l().createElement(Ne,{isSingle:this.props.single,list:this.state.contextData.searchResult,userListType:H,checkedAll:this.checkAllResult,hidePosts:J}):c),l().createElement("div",{className:"cl-org-right"},l().createElement(ft,null)))))}}u.defaultProps={visible:!0,showUserCount:!0,displayType:["dept","group","post","cluster","class"],initData:{dept:[],post:[],group:[],user:[],cluster:[],classes:[]},reserveUser:[],onlyUser:!1,onlyDept:!1,onlyPost:!1,useGroups:!1,useClass:!1,asyncDeptTree:!0,userType:"active",single:!1,maxUserCount:Infinity,filterAuthOpen:!1,disableHidden:!1,beyondLimitTip:"",onOk:()=>{},modalConfig:{},maxDeptUserCount:0,onlyChoosePost:!1,scrollFlag:!1};var v=(0,W.Z)()(u)},36202:function(ce,Q,a){"use strict";a.d(Q,{f:function(){return j}});var w=a(62029),I=a(57361),E=a(33565),V=a(9754),A=a.n(V),N=a(12924),L=a.n(N),C=a(28175),b=a(41647),R=a(93485);function r(Z){var y={};if(Z.length===0)return y;var z=(0,R.Z)(Z),B;try{for(z.s();!(B=z.n()).done;){var _=B.value,S=_,F=S.field,M=S.fixed,T=S.order,Y=S.show;Y?Y==="true"||Y===!0?y[F]={fixed:M,order:T,show:!0}:y[F]={fixed:M,order:T,show:!1}:y[F]={fixed:M,order:T,show:!0}}}catch(U){z.e(U)}finally{z.f()}return y}function x(Z){var y=[],z=Object.entries(Z);if(z.length===0)return y;for(var B=0,_=z;B<_.length;B++){var S=_[B],F=(0,E.Z)(S,2),M=F[0],T=F[1],Y=T.fixed,U=T.order,X=T.show;y.push({field:M,show:X,fixed:Y,order:U})}return y}var k=a(38642),O=(Z,y)=>{var z=(0,N.useState)(Z),B=(0,E.Z)(z,2),_=B[0],S=B[1];return(0,N.useEffect)(()=>{var F=setTimeout(()=>{S(Z)},y);return()=>{clearTimeout(F)}},[Z,y]),_},t=O;function l(Z,y){var z=useRef(y);useEffect(()=>{z.current=y},[y]),useEffect(()=>{var B=_=>{var S,F;console.warn(Z.current,"node.current",_.target),!((S=(F=Z.current)===null||F===void 0?void 0:F.contains(_.target))!==null&&S!==void 0?S:!1)&&z.current&&z.current()};return document.addEventListener("mousedown",B),()=>{document.removeEventListener("mousedown",B)}},[Z])}var W=!1;function j(Z){var y=(0,N.useState)({}),z=(0,E.Z)(y,2),B=z[0],_=z[1],S=Z.prefixCls,F=Z.rowKey,M=Z.columnEmptyText,T=Z.pagination,Y=Z.headerTitle,U=Z.toolBarRender,X=Z.size,se=Z.loading,ee=se===void 0?!1:se,ae=Z.tableUUID;ae||console.error("tableUUID is required!!!"),(0,N.useEffect)(()=>{function ne(Ce){return ye.apply(this,arguments)}function ye(){return ye=(0,I.Z)(A().mark(function Ce(be){var fe,Ee,Pe,ve,_e,Ie,Le,Se;return A().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:return ue.next=2,(0,k.Kb)((0,b.U)(be));case 2:if(fe=ue.sent,Ee=(0,E.Z)(fe,2),Pe=Ee[0],ve=Ee[1],!Pe){ue.next=8;break}return ue.abrupt("return");case 8:_e=ve.data,Ie=_e.data,Le=Ie.fields,Se=r(Le)||{},Se&&(W=!1,_(Se));case 13:case"end":return ue.stop()}},Ce)})),ye.apply(this,arguments)}return ae&&ne(ae),()=>{W=!1}},[ae]);var le=t(B,1e3);(0,N.useEffect)(()=>{!W||(0,b.I)(ae,x(B))},[le]);function pe(ne){W=!0,_(ne)}return L().createElement("div",{className:"SampleProTable_container ".concat(Z.className)},L().createElement(C.ZP,(0,w.Z)({size:X||"middle",rowKey:F||"id",columnEmptyText:M||!1,pagination:T||!1,options:{density:!1,fullScreen:!1,reload:!1,setting:!0},search:!1,loading:ee,headerTitle:Y||"",toolBarRender:U||null,columnsStateMap:B,onColumnsStateChange:pe},Z,{className:"".concat(S,"-table")})))}},41647:function(ce,Q,a){"use strict";a.d(Q,{I:function(){return E},U:function(){return V}});var w=a(37055),I=a(10237);function E(A){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],L=w.ZP.tableHeader.save(),C={fields:N,key:A};return I.WY.post({url:L,data:C})}function V(A){var N=w.ZP.tableHeader.get(A);return I.WY.get({url:N})}},80430:function(ce,Q,a){"use strict";var w=a(12924),I=a.n(w),E=a(60667),V=A=>{var N=function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{department_ids:[],department_names:[]},k=x.department_ids.split("/"),O=x.department_names.split("/"),t=k.map((l,W)=>I().createElement(E.Z,{key:l,dataType:"departmentName",value:l,name:O[W],type:x.source_type}));return I().createElement(I().Fragment,null,t.map((l,W)=>I().createElement("span",{key:l},l,W===O.length-1?"":"/")))},L=r=>I().createElement(E.Z,{dataType:"departmentName",value:r.department_id,name:r.department_name,type:r.source_type}),C=()=>{var r=A.list,x=r===void 0?[]:r,k=A.isBlock;if(!x.length)return null;var O=x.map(t=>N(t));return O.length&&O.length>1?I().createElement(I().Fragment,null,O.map((t,l)=>k?I().createElement("div",{key:t},t):I().createElement("span",{key:t},t,l===O.length-1?"":"\uFF0C"))):I().createElement(I().Fragment,null,O[0]||"")},b=()=>{var r=A.list,x=A.nameList,k=A.sourceType,O=A.isBlock,t=r.map((l,W)=>L({department_id:l,department_name:x[W],source_type:k}));return I().createElement(I().Fragment,null,t.map((l,W)=>O?I().createElement("div",{key:l},l):I().createElement("span",{key:l},l,W===t.length-1?"":"\uFF0C")))},R=()=>A.displayAll?C():b();return R()};V.defaultProps={list:[],nameList:[],sourceType:"",displayAll:!1,isBlock:!1},Q.Z=V},60667:function(ce,Q,a){"use strict";a.d(Q,{Z:function(){return C}});var w=a(33565),I=a(12924),E=a.n(I),V=a(28216);function A(b){var R=b.type,r=b.openid,x=b.from,k=(0,I.useRef)(null);return(0,I.useLayoutEffect)(()=>{x==="vue"?window.parent.WWOpenData.bind(k.current):WWOpenData.bind(k.current)}),E().createElement("ww-open-data",{ref:k,type:R,openid:r})}var N=b=>{var R=b.wxWorkApiFlag,r=b.appType,x=b.from,k=(0,I.useState)(!1),O=(0,w.Z)(k,2),t=O[0],l=O[1];(0,I.useEffect)(()=>{var Z=localStorage.getItem("qyWechatBook");(r!=="wx_app"||R||Z==="false"||x==="vue"||x==="taro")&&l(!0)},[R,r,x]);var W=(0,I.useCallback)(()=>{var Z=b.type,y=b.value,z=b.name,B=z===void 0?"":z;switch(console.warn(b,"props"),Z){case"wx_sync":{var _=b.dataType;return y?E().createElement(A,{from:x,type:_,openid:y}):B}default:return B}},[b]),j=()=>{var Z=b.name,y=b.dataType,z=localStorage.getItem("qyWechatBook");if(y===""||z==="false")return Z;if(x==="vue"||x==="taro")return W();switch(b.appType){case"wx_app":return W();default:return Z}};return t?j():b.name};N.defaultProps={value:"",name:"",type:"",dataType:"",from:""};var L=b=>({appType:b.user.appType,wxWorkApiFlag:b.user.wxWorkApiFlag}),C=(0,V.$j)(L)(N)},70075:function(ce,Q,a){"use strict";a.d(Q,{a:function(){return O}});var w=a(62029),I=a(33565),E=a(81211),V=a(47673),A=a(4107),N=a(12924),L=a.n(N),C=a(47444),b=a(60006),R=a.n(b),r=a(43859),x=A.Z.TextArea;function k(t){var l=t.char,W=t.displayType,j=t.LimitLength,Z=t.value,y=t.valueSlice,z=t.showCount,B=t.onChange,_=t.disabledInput,S=(0,E.Z)(t,["char","displayType","LimitLength","value","valueSlice","showCount","onChange","disabledInput"]),F=(0,N.useState)(()=>y?(0,C.B)({value:Z,LimitLength:j,char:l}):t.defaultValue||""),M=(0,I.Z)(F,2),T=M[0],Y=M[1],U=(0,N.useRef)({evtName:""});(0,N.useEffect)(()=>{Y(y?(0,C.B)({value:Z,LimitLength:j,char:l,disabledInput:_}):Z)},[Z,j,l,y,_]),(0,N.useEffect)(()=>{if(U.current.evtName==="input"){W==="Custom"?t.onFieldChange(T):B(T),t.onInput&&t.onInput(T),U.current.evtName="";return}y&&(W==="Custom"?t.onFieldChange(T):B(T),t.onInput&&t.onInput(T))},[T,W,y]);var X=le=>{U.current.evtName="input";var pe=le.target,ne=pe.value,ye=(0,C.B)({value:ne,LimitLength:j,char:l,disabledInput:_});Y(ye)},se=(0,N.useMemo)(()=>(0,C.S)({inputValue:T,LimitLength:j,char:l,showCount:z,disabledInput:_}),[T,j,l,z,_]),ee=se.dataCount,ae=se.usedLength;return L().createElement("div",{className:"".concat(R()["textarea-wrap"]," ").concat(ae&&j&&ae>j?R()["textarea-wrap-error"]:""),"data-count":ee},W==="Custom"?L().createElement(x,(0,w.Z)({},S,{value:T,onInput:X})):L().createElement(x,(0,w.Z)({},S,{value:T,onInput:X})))}k.defaultProps={valueSlice:!1,disabledInput:!0,onChange:()=>{},onInput:()=>{},char:!1,autoSize:{minRows:4,maxRows:10},displayType:""};var O=k;Q.Z=(0,r.Z)(k)},7584:function(ce,Q,a){"use strict";a.d(Q,{t:function(){return O}});var w=a(47673),I=a(4107),E=a(62029),V=a(33565),A=a(81211),N=a(12924),L=a.n(N),C=a(80991),b=a(47444),R=a(60006),r=a.n(R),x=a(43859);function k(t){var l=t.isPreview,W=t.char,j=t.displayType,Z=t.width,y=t.LimitLength,z=t.showCount,B=t.value,_=t.valueSlice,S=t.onChange,F=t.disabledInput,M=(0,A.Z)(t,["isPreview","char","displayType","width","LimitLength","showCount","value","valueSlice","onChange","disabledInput"]),T=(0,N.useState)(()=>_?(0,b.B)({value:B,LimitLength:y,char:W}):t.defaultValue||""),Y=(0,V.Z)(T,2),U=Y[0],X=Y[1],se=(0,N.useRef)({evtName:""});(0,N.useEffect)(()=>{X(_?(0,b.B)({value:B,LimitLength:y,char:W,disabledInput:F}):B)},[B,y,W,_,F]),(0,N.useEffect)(()=>{if(se.current.evtName==="input"){j==="Custom"?t.onFieldChange(U):S(U),t.onInput&&t.onInput(U),se.current.evtName="";return}_&&(j==="Custom"?t.onFieldChange(U):S(U),t.onInput&&t.onInput(U))},[U,j,_]);var ee=ye=>{se.current.evtName="input";var Ce=ye.target,be=Ce.value,fe=(0,b.B)({value:be,LimitLength:y,char:W,disabledInput:F});X(fe)},ae=(0,N.useMemo)(()=>(0,b.S)({inputValue:U,LimitLength:y,char:W,showCount:z,disabledInput:F}),[U,y,W,z,F]),le=ae.dataCount,pe=ae.usedLength,ne=(0,N.useRef)(null);return(0,N.useEffect)(()=>{ne&&ne.current&&(t.autoFocus==="true"?ne.current.focus():ne.current.blur())},[t.autoFocus]),L().createElement("div",{className:"".concat(r()["input-wrap"]," ").concat(pe&&y&&pe>y?r()["input-wrap-error"]:""),"data-count":le,style:{width:Z||void 0}},j==="Custom"?L().createElement(I.Z,(0,E.Z)({},M,{value:U,disabled:l,onInput:ee})):L().createElement(I.Z,(0,E.Z)({},M,{value:U,ref:ne,disabled:l,onInput:ee})))}k.defaultProps={valueSlice:!1,disabledInput:!0,onChange:()=>{},onInput:()=>{},char:!1,LimitLength:void 0,showCount:!1,displayType:"",width:void 0};var O=k;Q.Z=(0,x.Z)((0,C.$j)(k))},47444:function(ce,Q,a){"use strict";a.d(Q,{B:function(){return I},S:function(){return E}});var w=a(2396);function I(V){var A=V.value,N=V.LimitLength,L=V.char,C=V.disabledInput,b=A&&typeof A=="string"?A:"",R=b;return C&&L&&N&&(0,w.$s)(R)>N&&(R=b.substring(0,(0,w.rw)(b,N))),R}function E(V){var A=V.inputValue,N=V.LimitLength,L=V.char,C=V.showCount,b="",R=A&&typeof A=="string"?A:"",r=L?Math.ceil((0,w.$s)(R)):R.length;return C&&N&&(b="".concat(r,"/").concat(N)),{dataCount:b,usedLength:r}}},48479:function(ce,Q,a){"use strict";var w=a(62029),I=a(57361),E=a(47673),V=a(4107),A=a(9754),N=a.n(A),L=a(12924),C=a.n(L),b=a(91768),R=a(94184),r=a.n(R),x=a(28216),k=a(84874),O=a(67222),t=a(2396),l=V.Z.Search;class W extends C().Component{constructor(Z){var y;super(Z);y=this,this.clear=()=>{this.setState({searchValue:""})},this.renderEnterButton=()=>C().createElement(k.Z,{iconClass:"icon-icon_serarchx1"}),this.handleSearch=function(){var z=(0,I.Z)(N().mark(function B(_){var S,F,M,T,Y,U,X,se,ee;return N().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:if(S=y.props,F=S.appType,M=S.exChange,T=S.appId,Y=localStorage.getItem("qyWechatBook"),U="",X=F==="wx_app"&&Y==="true"&&M&&T==="9005",!(_&&X)){le.next=17;break}return le.prev=5,le.next=8,(0,O.F_)(_);case 8:se=le.sent,ee=se.data,ee.success?U=ee.data:U="",le.next=17;break;case 13:le.prev=13,le.t0=le.catch(5),console.error(le.t0),U="";case 17:y.props.onSearch(_,U);case 18:case"end":return le.stop()}},B,null,[[5,13]])}));return function(B){return z.apply(this,arguments)}}(),this.handleChange=z=>{var B=z.target.value,_=z.type,S=B;this.props.LimitLength&&(0,t.$s)(B)>this.props.LimitLength&&(S=B.substring(0,(0,t.rw)(B,this.props.LimitLength))),this.setState({searchValue:S});var F=!1;this.props.onSearch&&(_==="click"&&(F=!0),this.props.immediate&&_==="change"&&(F=!0)),F&&this.handleSearch(B)},this.state={searchValue:""}}componentDidMount(){this.props.onRef&&this.props.onRef(this)}componentWillReceiveProps(Z){Z.onRef&&Z.onRef(this)}render(){var Z=this.state.searchValue,y=this.props,z=y.prefixCls,B=y.placeholder,_=y.width,S=y.maxLength,F=S===void 0?400:S,M=y.height,T=y.immediate,Y=y.value,U=r()(["".concat(z)]),X={width:_,height:M},se={};return Y&&(se.value=Y),C().createElement(l,(0,w.Z)({className:U,style:X,value:Z,placeholder:B,onSearch:this.handleSearch,onChange:this.handleChange,maxLength:F,allowClear:!0,defaultValue:Y,immediate:T.toString()},se))}}W.defaultProps={prefixCls:"cl-search-input",placeholder:"Search",value:null,onSearch:()=>{},onChange:()=>{},immediate:!1,onRef:()=>{}},Q.Z=(0,x.$j)(j=>({appType:j.user.appType,appId:j.user.appId}))((0,b.Z)()(W))},19864:function(ce,Q,a){"use strict";var w=a(62999),I=a(85733),E=a(12924),V=a.n(E),A=a(80991),N=I.Z.TreeNode;class L extends V().Component{constructor(b){super(b);this.onChange=R=>{var r=this.state.levelArr,x=this.props,k=x.formik,O=x.addClassify;if(O){var t=!0;r.forEach(l=>{l.id===R.toString()&&(t=!1)}),t?this.props.onModalChange(!1):this.props.onModalChange(!0)}k.setFieldValue("classify_id",R)},this.renderTreeNodes=R=>{var r=this.state.levelArr;return R.map(x=>x.childes.length!==0?V().createElement(N,{title:x.name,key:x.id,value:x.id,isLeaf:!1,dataRef:x},this.renderTreeNodes(x.childes)):(x.level===3&&r.push({level:x.level,id:x.id}),V().createElement(N,{title:x.name,dataRef:x,value:x.id,key:x.id,isLeaf:!0})))},this.state={levelArr:[]}}render(){var b=this.props,R=b.placeholder,r=b.style,x=b.classifyData,k=b.defaultValue,O=b.isView;return V().createElement(I.Z,{style:r,onChange:this.onChange,placeholder:R,value:k,disabled:O},this.renderTreeNodes(x))}}Q.Z=(0,A.$j)(L)},24881:function(ce,Q,a){"use strict";var w=a(66456),I=a(55313),E=a(62029),V=a(88983),A=a(47933),N=a(12924),L=a.n(N),C=a(91768),b=a(48479),R=A.ZP.Group;class r extends L().Component{constructor(){super(...arguments);this.state={radioValueVal:1},this.onRadioSearchChange=k=>{var O=k.target.value||0;this.setState({radioValueVal:O});var t=this.props.radioSearch;t.onRadioSearchChange&&t.onRadioSearchChange(O)},this.onSearch=k=>{var O=this.props.radioSearch;O.onSearchChange&&O.onSearchChange(k)},this.onPaginationChange=(k,O)=>{var t=this.props.tableConfig;t.onPaginationChange&&t.onPaginationChange(k,O)},this.onSelectChange=(k,O)=>{var t=this.props.tableConfig;t.setSelResourceId&&t.setSelResourceId(k,O)}}render(){var k=this.props,O=k.radioSearch,t=k.resourceType,l=k.tableConfig,W=l.columns,j=W===void 0?[]:W,Z=l.rowKey,y=l.rowSelection,z=y===void 0?{selectedRowKeys:[],type:"radio",onSelectChange:this.onSelectChange}:y,B=l.dataSource,_=B===void 0?[]:B,S=l.loading,F=S===void 0?!1:S,M=l.total,T=M===void 0?0:M,Y=l.current,U=Y===void 0?0:Y,X=l.pageSize,se=X===void 0?10:X,ee=this.state.radioValueVal;return L().createElement("div",{className:"relation-source-common"},L().createElement("div",{className:"radio-group-search"},O&&O.radioList&&O.radioList.length&&L().createElement(R,(0,E.Z)({onChange:this.onRadioSearchChange,value:ee},O,{optionType:"button"}),O.radioList&&O.radioList.map(ae=>L().createElement(A.ZP.Button,{key:ae.id,value:ae.id},ae.type)))||null,L().createElement("span",{className:"right-input"},L().createElement(b.Z,{width:256,onSearch:this.onSearch,prefixCls:"".concat(t,"-input-search"),placeholder:O.placeholder}))),L().createElement("div",{className:"resource-table"},L().createElement(I.Z,{bordered:!0,size:"middle",columns:j,rowKey:ae=>ae[Z],rowSelection:z,dataSource:_,pagination:{total:T,onChange:this.onPaginationChange,current:U,pageSize:se},loading:F,scroll:{y:350,x:"max-content"}})))}}r.defaultProps={radioSearch:{},resourceType:"course",tableConfig:{}},r.defaultProps={radioSearch:{},resourceType:"course",tableConfig:{},defaultChecked:[]},Q.Z=(0,C.Z)()(r)},89810:function(ce,Q,a){"use strict";var w=a(62029),I=a(20228),E=a(11382),V=a(54029),A=a(62529),N=a(18106),L=a(88108),C=a(12924),b=a.n(C),R=a(91768),r=a(77016),x=a(18329),k=L.Z.TabPane;class O extends b().Component{constructor(){super(...arguments);this.state={loading:!1,selSourceType:"course",selResourceId:"",selSourceTitle:"",selResourceItem:"",componentsList:[],currentChecked:[]},this.onCancel=()=>{var l=this.props.onCancel;l&&this.props.onCancel()},this.onChangeTab=l=>{this.setState({activeKey:l})},this.onOk=()=>{var l=this.props.onOk;if(l){var W=this.state,j=W.selSourceType,Z=W.selResourceId,y=W.selSourceTitle,z=W.selResourceItem,B=z&&z.length>0&&z[0].biz_type===0&&j==="image_text"?"course":j;this.props.onOk({selSourceType:B,selResourceId:Z,selSourceTitle:y,selResourceItem:z})}},this.setCourseSelType=l=>{var W=this.state.componentsList;W[0].selType=l,this.setState({componentsList:W})},this.initData=()=>{var l=this.props.defaultChecked;l&&this.setState({activeKey:(0,r.rw)(l.type),selSourceType:l.type,selResourceId:l.resource_id,selSourceTitle:l.title})},this.setSelSourceType=(l,W)=>{var j=this.state.componentsList,Z;switch(l){case"course":Z=j[0].selType,W===0&&Z==="image_text"&&(Z="course");break;case"studyProject":Z="project";break;case"studyTask":Z="task";break;case"examination":case"examinationNew":{Z="exam";break}case"investigate":Z="investigates";break;case"authentication":Z="qualifications";break;case"postMaps":Z="post_maps";break;case"evaluationSource":Z="evaluation";break;case"pkGame":Z="pk";break;case"practiceSource":Z="practice";break;default:Z="course";break}this.setState({selSourceType:Z})},this.setSelResourceId=(l,W)=>{var j=this.state.activeKey;this.setSelSourceType(j,W.biz_type),l.length&&W.length&&this.setState({selResourceId:l[0],selSourceTitle:W[0][(0,r.US)(j)]||"",currentChecked:l,selResourceItem:W})},this.getActiveConfig=l=>{var W=this.state.componentsList;return l&&W.filter(j=>j.key===l)}}componentDidMount(){var l=this.props.componentsList;this.setState({componentsList:l})}UNSAFE_componentWillReceiveProps(l){var W=l.defaultChecked;this.setState({currentChecked:W&&[W.resource_id]||[],componentsList:l.componentsList})}componentDidUpdate(l){l.visible!==this.props.visible&&this.props.visible&&this.initData()}render(){var l=this.props,W=l.t,j=l.wrapClassName,Z=this.state,y=Z.loading,z=Z.activeKey,B=Z.componentsList,_=Z.currentChecked,S={okText:W("common.ok"),cancelText:W("common.cancel"),size:"large",destroyOnClose:!0,bodyStyle:{padding:"0"},maskClosable:!1};return j&&(S.wrapClassName=j),b().createElement(x.ZP,(0,w.Z)({title:W("setting.relatedSourced")},S,{visible:this.props.visible,onCancel:this.onCancel,onOk:this.onOk}),b().createElement("div",{className:"relation-source-modal"},b().createElement(E.Z,{spinning:y},b().createElement(L.Z,{activeKey:z,onChange:this.onChangeTab},B.map(F=>b().createElement(k,{tab:F.key==="examinationNew"?b().createElement(A.Z,{color:"#ff4d4f",offset:[13,0],count:b().createElement("span",{className:"badge-new-tag"},"new")},F.tab):F.tab,key:F.key},b().createElement(F.component,{setCourseSelType:this.setCourseSelType,setSelResourceId:this.setSelResourceId,activeKey:z,defaultChecked:_,currentItem:F})))))))}}O.defaultProps={visible:!1,onCancel:()=>{},onOk:()=>{},defaultChecked:{},componentsList:[]},Q.Z=(0,R.Z)()(O)},77016:function(ce,Q,a){"use strict";a.d(Q,{Ru:function(){return A},US:function(){return N},rw:function(){return L}});var w=a(3407),I=a(6793),E=(0,I.me)(),V=w.Z[E],A=C=>{switch(C){case"platform":return V.common.platformCourse;case"notOriginal":return V.common.noOriginalCourse;case"original":return V.common.originalCourse;default:return""}},N=C=>{switch(C){case"course":case"image_text":case"project":case"task":case"exam":case"investigates":case"qualifications":case"evaluation":case"practice":case"authentication":case"pk":return"title";case"postMaps":return"name";default:return"title"}},L=C=>{switch(C){case"course":case"image_text":return"course";case"project":return"studyProject";case"task":return"studyTask";case"investigates":return"investigate";case"evaluation":return"evaluationSource";case"qualifications":return"authentication";case"post_maps":return"postMaps";case"pk":return"pkGame";case"practice":return"practiceSource";default:return"course"}}},51975:function(ce,Q,a){"use strict";a.d(Q,{l:function(){return V}});var w=a(62029),I=a(12924),E=a.n(I),V=(A,N)=>function(C){return E().createElement(A.Consumer,null,b=>E().createElement(N,(0,w.Z)({},C,{contextData:b})))}},43859:function(ce,Q,a){"use strict";var w=a(62029),I=a(81211),E=a(43358),V=a(34041),A=a(12924),N=a.n(A),L=a(94184),C=a.n(L),b=a(59239),R=a(55446),r=a.n(R),x=a(6793),k=b.Z.Item,O=V.Z.Option,t=l=>function(j){var Z=j.field,y=j.form,z=j.hasFeedback,B=j.label,_=j.selectOptions,S=j.submitCount,F=j.type,M=j.displayType,T=j.labelCol,Y=T===void 0?{}:T,U=j.wrapperCol,X=U===void 0?{}:U,se=j.required,ee=se===void 0?!1:se,ae=j.customError,le=ae===void 0?!1:ae,pe=j.colon,ne=pe===void 0?!0:pe,ye=j.formItemClassName,Ce=(0,I.Z)(j,["field","form","hasFeedback","label","selectOptions","submitCount","type","displayType","labelCol","wrapperCol","required","customError","colon","formItemClassName"]),be=y.touched[Z.name],fe=S>0,Ee=y.errors[Z.name],Pe=Ee&&fe,ve=Ee&&be,_e=de=>{var ue=de!=null&&de.target?de.target.value:de;y.setFieldValue(Z.name,ue),y.touched[Z.name]||setTimeout(()=>{y.setFieldTouched(Z.name,!0)},0)},Ie=de=>{var ue={},xe={},me=de;if(de===void 0&&(me=""),y.setFieldValue(Z.name,me),Z.name==="courseList"&&de&&Object.prototype.toString.apply(de).slice(8,-1)==="Array"&&de.length>0){ue.startTime=de[0].beginTime,xe.startTime=Number((0,x.jZ)(de[0].beginTime))+864e5;var oe=[];de.forEach(Te=>{Te.endTime!==""&&oe.push(Te)}),oe.length>0&&y.values.dateRange.endTime?(0,x.jZ)(y.values.dateRange.endTime)>oe[oe.length-1].endTime?(ue.endTime=y.values.dateRange.endTime,xe.endTime=Number((0,x.jZ)(y.values.dateRange.endTime))-864e5):oe.length>0&&y.values.dateRange.endTime&&(0,x.jZ)(y.values.dateRange.endTime)<=oe[oe.length-1].endTime&&(ue.endTime=oe[oe.length-1].endTime,xe.endTime=Number((0,x.jZ)(oe[oe.length-1].endTime))-864e5):oe.length>0&&!y.values.dateRange.endTime&&(ue.endTime=oe[oe.length-1].endTime,xe.endTime=Number((0,x.jZ)(oe[oe.length-1].endTime))-864e5),oe.length>0&&y.setFieldValue("dateRange",ue),y.setFieldValue("dateRangeLimit",xe)}if(Z.name==="stages"&&de&&Object.prototype.toString.apply(de).slice(8,-1)==="Array"&&de.length>0){var De=[];de.forEach(Te=>{Te.list&&Te.list.forEach(Re=>{Re.componentName==="OfflineTrain"&&De.push(Re.data)})}),De.length>0&&(ue.startTime=De[0].beginTimeStr,ue.endTime=De[De.length-1].endTimeStr,ue.startTime=Number((0,x.jZ)(De[0].beginTimeStr))+864e5,ue.endTime=Number((0,x.jZ)(De[De.length-1].endTimeStr))-864e5,y.setFieldValue("dateRangeLimit",ue))}y.touched[Z.name]||setTimeout(()=>{y.setFieldTouched(Z.name,!0)},0)},Le=()=>y.setFieldTouched(Z.name,!0),Se=C()(["cl-form__field"]);return N().createElement("div",{className:Se},N().createElement(k,{label:B,className:"$$CL-FORM-ERROR__".concat(Z.name," antd-field-item ").concat(ye),hasFeedback:!!(z&&fe||z&&be),help:(Pe||ve)&&!le?Ee:!1,validateStatus:(Pe||ve)&&!le?"error":"success",labelCol:Y,wrapperCol:X,required:ee,colon:ne},M==="Custom"?N().createElement(l,(0,w.Z)({},Z,Ce,{displayType:M,onBlur:Le,onFieldChange:Ie})):N().createElement(l,(0,w.Z)({},Z,Ce,{displayType:M,onBlur:Le,onChange:F?_e:Ie,form:y}),_&&_.map(de=>N().createElement(O,{key:de},de)))))};Q.Z=t},73548:function(ce,Q,a){"use strict";a.d(Q,{P:function(){return r},z:function(){return R}});var w=a(47673),I=a(4107),E=a(12924),V=a.n(E),A=a(80991);class N extends V().Component{render(){var k=this.props.value;return V().createElement(V().Fragment,null,V().createElement("span",null,k),V().createElement(I.Z,{type:"hidden",value:k}))}}var L=(0,A.$j)(N),C=a(43859),b=a(19864),R=(0,C.Z)(L),r=(0,C.Z)(b.Z)},11236:function(ce,Q,a){"use strict";var w=a(43358),I=a(34041),E=a(12924),V=a.n(E),A=a(80991),N=a(43859),L=I.Z.Option;class C extends V().Component{constructor(){super(...arguments);this.onChange=R=>{this.props.onChange(R)}}render(){var R=this.props,r=R.placeholder,x=R.style,k=R.data,O=R.value,t=R.isView;return V().createElement(V().Fragment,null,V().createElement(I.Z,{disabled:t,defaultValue:O,placeholder:r,style:x,onChange:this.onChange},k?k.map(l=>V().createElement(L,{key:l.id,value:l.id},l.value_name)):""))}}Q.Z=(0,N.Z)((0,A.$j)(C))},78657:function(ce,Q,a){"use strict";a.d(Q,{Z:function(){return Z}});var w=a(62029),I=a(12924),E=a.n(I),V=a(91768),A=a(80991),N=a(6793),L=a(7584),C=a(70075),b=a(73548),R=a(77883),r=a(21888),x=(y,z)=>{z.onChange&&z.onChange(y===null?typeof z.min!="undefined"?z.min:"":y)},k=y=>E().createElement(r.Z,(0,w.Z)({},y,{onChange:z=>x(z,y)})),O=k,t=a(18329),l=a(43859),W=(0,l.Z)(O);class j extends E().Component{constructor(z){super(z);this.onModalChange=B=>{this.setState({disabled:B}),this.props.onModalChange(B)},this.onOk=()=>{var B=this.props.configModal,_=this.state.disabled;B.renderType==="text"?this.props.onConfirm():_||this.initRef.current.submitForm()},this.onCancel=()=>{this.props.onCancel()},this.onSubmit=B=>{var _={};for(var S in B)typeof B[S]=="string"?_[S]=(0,N.fy)(B[S]):_[S]=B[S];this.props.onConfirm(_)},this.chooseComponent=B=>{switch(B){case"input":return L.Z;case"textarea":return C.Z;case"ClassifySelect":return b.P;case"inputNumer":return W;default:return null}},this.formValidate=B=>{switch(B){case"noEmpty":return this.noEmpty;case"limitNumberRange":return this.limitNumberRange;case"isSameName":return this.isSameName;default:return null}},this.isSameName=B=>{var _,S=this.props,F=S.data,M=S.configComponents,T=S.configModal,Y=S.t,U=M[0].name,X=T.tag,se=[],ee=(0,N.fy)(B);if(_=this.noEmpty(ee),!_){for(var ae=0;ae<F.length;ae++)X===ae&&(ae+=1),F[ae]&&F[ae][U]===ee&&se.push(F[ae][U]);se.length&&(_=Y("personnelDevelope.validation.nameExists"))}return _},this.limitNumberRange=B=>{var _=this.props.t,S;return S=this.noEmpty(B),S||(B<1||B>999)&&(S=_("personnelDevelope.validation.wrongNumber")),S},this.noEmpty=B=>{var _=this.props.t,S;return(0,N.fy)(B)||(S=_("personnelDevelope.validation.requiredNotBlank")),S},this.renderForm=B=>{var _=this.props,S=_.configComponents,F=_.classifyData,M=_.addClassify;return E().createElement(A.l0,{className:"post-info-form post-common-modal"},S.map((T,Y)=>{var U={name:T.name,component:this.chooseComponent(T.componentsType),label:T.nameLabel,style:T.style||{width:"428px"},attr:T.attr?T.attr:"",placeholder:T.placeholder,key:Y,validate:this.formValidate(T.validateType),maxLength:T.maxLength,defaultValue:B.values[T.name]||T.defaultValue,labelCol:T.labelCol?T.labelCol:{},wrapperCol:T.wrapperCol?T.wrapperCol:{},required:!T.isNoRequired,isPreview:T.disabled,onModalChange:this.onModalChange,addClassify:M};return F&&(U.classifyData=F),T.inputType!=="number"&&(U.type="text"),E().createElement(A.gN,(0,w.Z)({key:Y.toString()},U))}))},this.initRef=E().createRef(),this.state={disabled:""}}render(){var z=this.props,B=z.t,_=z.configModal,S=z.initialValues,F={okText:B("common.ok"),cancelText:B("common.cancel"),size:"medium",destroyOnClose:!0,bodyStyle:{padding:"20"},maskClosable:!1,width:"560"};return _.isOptionButton&&(F.footer=null),E().createElement(t.ZP,(0,w.Z)({title:_.title},F,{visible:_.visible,onCancel:this.onCancel,onOk:this.onOk,destroyOnClose:!0,wrapClassName:"post-modal-alert"}),_.renderType==="text"?E().createElement("div",{className:"post-modal-content"},_.content):E().createElement(A.J9,{ref:this.initRef,initialValues:S,render:this.renderForm,onSubmit:this.onSubmit}),this.props.children)}}var Z=(0,V.Z)()(j)},1624:function(ce,Q,a){"use strict";a.r(Q),a.d(Q,{default:function(){return yt}});var w=a(62029),I=a(57663),E=a(71577),V=a(22385),A=a(31097),N=a(88983),L=a(47933),C=a(34792),b=a(48086),R=a(57361),r=a(88986),x=a(9754),k=a.n(x),O=a(12924),t=a.n(O),l=a(28216),W=a(76651),j=a(91768),Z=a(57068),y=a(80991),z=a(78657),B=a(43859);class _ extends t().Component{constructor(){super(...arguments);this.onChange=f=>{var i=f.target.value;this.props.onChange(i),this.props.onRadioChange(i)}}render(){var f=this.props,i=f.value,o=f.isView,u=f.t;return t().createElement(L.ZP.Group,{onChange:this.onChange,size:"small",value:i},t().createElement(L.ZP,{value:1,disabled:o},u("common.yes")),t().createElement(L.ZP,{value:0,disabled:o},u("common.no")))}}var S=(0,j.Z)()((0,B.Z)((0,y.$j)(_))),F=a(24881),M=a(85853);class T extends t().Component{constructor(f){super(f);this.onSearchChange=i=>{var o=this.state.tableConfig;this.setState({keyword:i,tableConfig:(0,r.Z)((0,r.Z)({},o),{},{current:1})},()=>{this.getProjectList()})},this.onPaginationChange=(i,o)=>{var u=this.state.tableConfig;u.current=i,u.pageSize=o,this.setState({tableConfig:u},()=>{this.getProjectList()})},this.studyProjectInit=()=>{this.getProjectList()},this.projectListSuccess=i=>{if(i.data){var o=this.state.tableConfig;o.dataSource=i.data.data.list||[],o.total=i.data.data.total||0,o.loading=!1,this.setState({tableConfig:o})}},this.qualificationInit=()=>{this.getProjectList()},this.getProjectList=()=>{var i=this.state,o=i.tableConfig,u=i.keyword;o.loading=!0,this.setState({tableConfig:o});var v={name:u,page_number:o.current,page_size:10,status:"normal",classify_id:"",sort:"desc",enterprise_id:window.localStorage.getItem("enterpriseId")};(0,M.cc)(v).then(m=>{m.data&&m.data.data.list&&this.projectListSuccess(m)})},this.state={keyword:"",radioSearchConfig:{placeholder:f.t("searchInputPlaceholder.name"),onSearchChange:this.onSearchChange},tableConfig:{columns:[{title:f.t("personnelDevelope.qualifications"),dataIndex:"name",key:"name",className:"study_project_width",textWrap:"word-break",ellipsis:!0,fixed:this.props.appType==="wx_app"?!1:"left",render:(i,o)=>t().createElement(A.Z,{placement:"top",title:o.name},t().createElement("div",{className:"select-qualification-name"},i))},{title:f.t("setting.classifyLabel"),dataIndex:"classify_name",key:"classify_name",textWrap:"word-break",ellipsis:!0,render:(i,o)=>t().createElement(A.Z,{placement:"top",title:o.classify_name},t().createElement("div",{className:"select-qualification-classify-name"},o.classify_name?o.classify_name:"---"))}],rowSelection:{type:"radio",onChange:f.setSelResourceId,selectedRowKeys:f.defaultChecked},rowKey:"id",dataSource:[],loading:!1,total:0,current:1,onPaginationChange:this.onPaginationChange}}}componentDidMount(){this.getProjectList()}UNSAFE_componentWillReceiveProps(f){var i=this.state.tableConfig;i.rowSelection.selectedRowKeys=f.defaultChecked,this.setState({tableConfig:i})}componentDidUpdate(f){var i=this.props,o=i.activeKey,u=i.currentItem;f.activeKey!==o&&o===u.key&&this.studyProjectInit()}render(){var f=this.state,i=f.radioSearchConfig,o=f.tableConfig;return t().createElement("div",{className:"study-task-source"},t().createElement(F.Z,{radioSearch:i,resourceType:"qualification",tableConfig:o}))}}var Y=(0,j.Z)()(T),U=a(47673),X=a(4107),se=a(43358),ee=a(34041),ae=a(48736),le=a(27049),pe=a(36202),ne=a(6793);class ye extends t().Component{constructor(){super(...arguments);this.onChooseAbility=f=>{this.props.addOption(f)},this.onGetIndex=(0,ne.E5)(f=>{this.props.getIndex&&this.props.getIndex(f)},200)}render(){var f=this.props,i=f.columns,o=f.data,u=f.prefixCls,v=f.isView,m=f.renderType,c=f.deletePanel,d=f.t;return t().createElement(t().Fragment,null,o.map((e,n)=>m==="taskPanel"&&n>0?null:t().createElement("div",{key:n.toString(),className:"".concat(u),onMouseOver:this.onGetIndex.bind(this,n)},m!=="taskPanel"?t().createElement("div",{className:"".concat(u,"-panel")},t().createElement("span",null,e.name),t().createElement("div",null,v?"":t().createElement(E.Z,{type:"link",onClick:()=>{this.onChooseAbility(e.name)}},t().createElement("a",null,d("common.edit"))),t().createElement(le.Z,{type:"vertical"}),v?"":t().createElement(E.Z,{type:"link"},t().createElement("a",{onClick:()=>{c()}},d("common.delete"))))):"",t().createElement(pe.f,{columns:i,rowKey:n.toString(),dataSource:e.post_qualifications_ability||o,tableUUID:"c72389fa-1a9e-4995-b5b0-ffb1a1809527"}))))}}var Ce=(0,j.Z)()(ye),be=a(63185),fe=a(9676),Ee=a(57254),Pe=a(8812),ve=a(17883),_e=ee.Z.Option,Ie=X.Z.Search;class Le extends t().Component{constructor(f){super(f);this.onChangeBox=i=>{var o=this.state,u=o.data,v=o.chooseData,m=v,c=this.props.formik,d=i.index,e;if(u[d].is_check==="true"){m.forEach((p,s)=>{p.index===d&&(e=s)}),m.splice(e,1);var n=i.ability_levels.map(p=>(0,r.Z)((0,r.Z)({},p),{},{is_check:"false",is_inverse:"false"})),h=u.map(p=>p.index===i.index?(p.ability_levels=n,(0,r.Z)((0,r.Z)({},p),{},{is_check:"false"})):p);this.setState({data:h,chooseData:m},()=>{c.setFieldValue("capability",this.state.chooseData)})}},this.onInputChange=i=>{var o=this.state,u=o.data,v=o.chooseData,m=this.props,c=m.panelIndex,d=m.formik,e=i.index,n=v,h=!0,p=(0,r.Z)((0,r.Z)({},i),{},{primary_id:i.ability_id,ability_level:i.default_score,panelIndex:c,source:u[e].source,ability_levels:u[e].ability_levels,isEdit:!1,level_name:i.name});v.length===0?n=v.concat(p):(n=v.map(K=>K.ability_id===p.ability_id?(h=!1,(0,r.Z)((0,r.Z)({},K),p)):K),h&&(n=this.state.chooseData.concat(p)));var s,g=u[e].ability_levels.map(K=>K.key!==i.key?(0,r.Z)((0,r.Z)({},K),{},{is_check:"false",is_inverse:"false"}):i.is_inverse==="true"?(n.forEach(($,G)=>{$.ability_id===i.ability_id&&(s=G)}),n.splice(s,1),(0,r.Z)((0,r.Z)({},K),{},{is_check:"false",is_inverse:"false"})):(0,r.Z)((0,r.Z)({},K),{},{is_check:"true",is_inverse:"true"})),P=g.filter(K=>K.is_check==="true"),D=u.map(K=>(K.index===e&&(P.length?K.is_check="true":K.is_check="false",K.ability_levels=g),K));this.setState({data:D,chooseData:n},()=>{d.setFieldValue("capability",this.state.chooseData)})},this.onPaginationChange=(i,o)=>{var u=this.state.pagination;this.setState({pagination:(0,r.Z)((0,r.Z)({},u),{},{pageSize:o,current:i})},()=>{this.getAbilityData()})},this.onAbilitySearch=i=>{var o=this.state.pagination;this.setState({searchValue:i,pagination:(0,r.Z)((0,r.Z)({},o),{},{current:1})},()=>{this.getAbilityData()})},this.onSelectChange=i=>{this.setState({ability_type:i},()=>{this.getAbilityData()})},this.onSelectChangeOrigin=i=>{this.setState({source:i},()=>{this.getAbilityData()})},this.getAbilityData=()=>{var i=this.props.formik,o=this.state,u=o.pagination,v=o.searchValue,m=o.ability_type,c=o.source,d={page_number:u.current,page_size:u.pageSize,name:v,ability_type:m,source:c};this.setState({loading:!0}),(0,ve.V2)(d).then(e=>{var n=e.data.list.map((p,s)=>(0,r.Z)((0,r.Z)({},p),{},{index:s,ability_levels:p.ability_levels.map((g,P)=>(0,r.Z)((0,r.Z)({},g),{},{index:s,key:"".concat(s).concat(P)}))})),h=this.contrastData(n);this.setState({data:h||n,loading:!1,pagination:(0,r.Z)((0,r.Z)({},u),{},{total:e.data.total})},()=>{i.setFieldValue("capability",this.state.chooseData)})}).catch(()=>{this.setState({loading:!1})})},this.contrastData=i=>{var o=this.state.chooseData,u=this.props.panelIndex;if(o.length===0)return!1;var v=o.map(m=>i.map(c=>{if(m.panelIndex===u){if(m.ability_id===c.id){var d=m.ability_level-1;c.ability_levels[d].is_check="true",c.ability_levels[d].is_inverse="true",c.is_check="true"}}else m.ability_id===c.id&&(c.disabled="true",c.ability_levels.forEach(e=>{e.disabled="true",e.is_inverse="false",e.is_check="false"}));return c}));return v[0]},this.state={pagination:{total:0,current:1,pageSize:10,onChange:this.onPaginationChange},chooseData:[],columns:[{title:f.t("common.select"),dataIndex:"choose",key:"choose",width:50,render:(i,o)=>t().createElement(fe.Z,{type:"checkbox",disabled:o.disabled==="true",checked:o.is_check==="true",onChange:()=>{this.onChangeBox(o)}})},{title:f.t("evaluation.powerName"),dataIndex:"ability_name",key:"ability_name",width:150,textWrap:"word-break",ellipsis:!0,render:(i,o)=>t().createElement(A.Z,{placement:"top",title:o.ability_name},t().createElement("div",{className:"ability_name_content"},i))},{title:f.t("personnelDevelope.origin"),dataIndex:"source",key:"source",width:100,render:(i,o)=>o.source==="tool"?f.t("evaluation.cloudOrigin"):f.t("evaluation.selfOrigin")},{title:f.t("personnelDevelope.classify"),dataIndex:"ability_type",key:"ability_type",width:150,render:(i,o)=>o.ability_type==="common"?f.t("evaluation.generalAbility"):f.t("evaluation.professional")},{title:f.t("evaluation.powerDesc"),dataIndex:"description",key:"description",width:500,textWrap:"word-break",ellipsis:!0,render:(i,o)=>t().createElement(A.Z,{placement:"top",title:o.description},t().createElement("div",{className:"ability_description"},i))}],data:[],loading:!1,searchValue:"",ability_type:"",source:""}}componentDidMount(){var f=this.props,i=f.itemArr,o=f.abilityRef,u=this.state.chooseData;o&&this.props.abilityRef(this),this.setState({chooseData:i.length===0?u:i},()=>{this.getAbilityData()})}render(){var f=this.state,i=f.columns,o=f.loading,u=f.pagination,v=f.data,m=this.props.t;return t().createElement(t().Fragment,null,t().createElement("div",{className:"select-ability-filter"},t().createElement(ee.Z,{style:{width:"160px",marginRight:"16px"},placeholder:m("validation.checkClassify"),optionFilterProp:"children",onChange:this.onSelectChange},t().createElement(_e,{value:"special"},m("evaluation.professional")),t().createElement(_e,{value:"common"},m("evaluation.generalAbility"))),t().createElement(ee.Z,{style:{width:"160px",marginRight:"16px"},placeholder:m("validation.checkOrigin"),optionFilterProp:"children",onChange:this.onSelectChangeOrigin},t().createElement(_e,{value:""},m("evaluation.allOrigin")),t().createElement(_e,{value:"self"},m("evaluation.selfOrigin")),t().createElement(_e,{value:"tool"},m("evaluation.cloudOrigin"))),t().createElement(Ie,{placeholder:m("personnelDevelope.capabilityNameSearch"),style:{width:"272px"},allowClear:!0,onSearch:this.onAbilitySearch})),t().createElement(pe.f,{columns:i,className:"select-ability-modal",loading:o,pagination:u,expandable:{expandRowByClick:!0,expandedRowRender:(c,d)=>c.ability_levels.map(e=>t().createElement("div",{className:"select-ability-expanded",key:"".concat(e.ability_id).concat(e.default_score)},t().createElement(fe.Z,{disabled:e.disabled==="true",className:"select-ability-checkbox",checked:e.is_check==="true",type:"checkbox",name:"index-".concat(d),onChange:()=>{this.onInputChange(e)}}),t().createElement("span",{className:"select-ability-level"},e.name),t().createElement("div",{className:"select-ability-name"},t().createElement(A.Z,{placement:"top",title:e.description},t().createElement("span",null,m("evaluation.levelDesc"),"\uFF1A",e.description)),t().createElement(A.Z,{placement:"top",title:e.behavior_desc},t().createElement("span",null,m("evaluation.behaviorDesc"),"\uFF1A",e.behavior_desc))))),expandIcon:c=>{var d=c.expanded,e=c.onExpand,n=c.record;return d?t().createElement("div",null,t().createElement(Ee.Z,{onClick:h=>e(n,h)})):t().createElement("div",null,t().createElement(Pe.Z,{onClick:h=>e(n,h)}))}},dataSource:v,tableUUID:"4539cf28-efed-467f-bd23-c077e41e2580"}))}}var Se=(0,j.Z)()((0,B.Z)((0,y.$j)(Le))),de=a(7584),ue=a(18329);class xe extends t().Component{constructor(){super(...arguments);this.onOk=()=>{var f=this.initRef.getFormikContext().values,i={},o=f.capability.reduce((u,v)=>(i[v.ability_name]||(i[v.ability_name]=u.push(v)),u),[]);if(o.length<f.capability.length)return this.tipsName(),this.props.visible=!0,!1;this.initRef.submitForm()},this.onCancel=()=>{this.props.onCancel()},this.onSubmit=f=>{var i={};for(var o in f)typeof f[o]=="string"?i[o]=(0,ne.fy)(f[o]):i[o]=f[o];this.props.onConfirm(i)},this.tipsName=()=>{var f=this.props.t;b.default.error(f("evaluation.sameAbilityName"))},this.noEmpty=(f,i)=>{var o=i.panelIndex,u=i.desc,v;typeof f=="object"?v=f.filter(c=>c.panelIndex===o):v=(0,ne.fy)(f);var m;return v.length===0&&(m=u),m},this.isSameName=(f,i)=>{var o=i.desc,u,v=this.props,m=v.data,c=v.t,d=v.panelIndex,e=[],n=(0,ne.fy)(f);if(u=this.noEmpty(n,{desc:o}),!u){for(var h=0;h<m.length;h++)d!==-1&&d===h&&(h+=1),m[h]&&m[h].name===n&&e.push(m[h].name);e.length&&(u=c("personnelDevelope.validation.nameExists"))}return u}}render(){var f=this.props,i=f.t,o=f.visible,u=f.itemArr,v=f.panelIndex,m=f.initialValues,c={okText:i("personnelDevelope.applicationAbility"),cancelText:i("common.cancel"),size:"medium",destroyOnClose:!1,bodyStyle:{padding:"20"},maskClosable:!1,width:"960px"};return t().createElement(ue.ZP,(0,w.Z)({title:i("personnelDevelope.chooseAbility")},c,{visible:o,onCancel:this.onCancel,onOk:this.onOk,wrapClassName:"select-ability-modal-content"}),t().createElement(y.J9,{initialValues:m,ref:d=>{this.initRef=d},onSubmit:this.onSubmit,render:d=>t().createElement(y.l0,null,t().createElement(y.gN,{name:"labelName",component:de.Z,label:i("personnelDevelope.labelName"),required:!0,defaultValue:d.values.labelName,placeholder:i("personnelDevelope.placeholder.name"),style:{width:"320px"},validate:e=>this.isSameName(e,{desc:i("personnelDevelope.labelNameNotNull")}),maxLength:20,type:"text"}),t().createElement(y.gN,{name:"capability",component:Se,validate:e=>this.noEmpty(e,{panelIndex:v,desc:i("personnelDevelope.abilityItemNotNull")}),itemArr:u,panelIndex:v}))}))}}var me=(0,j.Z)()((0,y.$j)(xe)),oe=a(84874),De,Te,Re,ke,Qe,Fe,Ye=ee.Z.Option,He=(De=(0,l.$j)(he=>{var f=he.personnelDevelope;return{qualificationId:f.qualificationId}}),Te=Reflect.metadata("design:type",Function),Re=Reflect.metadata("design:paramtypes",[void 0]),De(ke=Te(ke=Re(ke=(Fe=Qe=class extends t().Component{constructor(f){super(f);this.onCancel=()=>{this.setState({configModal:(0,r.Z)((0,r.Z)({},this.state.configModal),{},{visible:!1}),isRename:!1})},this.onConfirm=i=>{var o=this.state,u=o.isRename,v=o.data,m=o.dataIndex,c=this.props.formik,d={data:v.concat({name:i.name,post_qualifications_ability:[]}),configModal:(0,r.Z)((0,r.Z)({},this.state.configModal),{},{visible:!1}),panelVisible:!0};if(u){var e=v.map((n,h)=>h===m?(0,r.Z)((0,r.Z)({},n),{},{name:i.name}):n);d.data=e}c.setFieldValue("post_qualifications_ability_classify",d.data),this.setState(d)},this.onCreateLabel=()=>{var i=this.props.t;this.setState({configModal:(0,r.Z)((0,r.Z)({},this.state.configModal),{},{visible:!0,tag:-1,title:i("personnelDevelope.createAbilityLabel")}),isRename:!1,initialValues:{name:""}})},this.onChangeInput=(i,o)=>{this.commonChangePanelData({source:i.source,inputType:"input",behavior_desc:o.target.value,ability_level:i.ability_level},i.rowIndex)},this.onDeleteItem=i=>{var o=this.state,u=o.data,v=o.dataIndex,m=this.props.formik,c=u[v].post_qualifications_ability.filter(e=>i!==e.rowIndex);c=c.map((e,n)=>(0,r.Z)((0,r.Z)({},e),{},{rowIndex:n}));var d=u.map((e,n)=>v===n?(0,r.Z)((0,r.Z)({},e),{},{post_qualifications_ability:c}):e);this.setState({data:d},()=>{m.setFieldValue("post_qualifications_ability_classify",d)})},this.onEditInput=(i,o)=>{this.commonChangePanelData({isEdit:!0},i),document.addEventListener("click",this.hideEdit),o.nativeEvent.stopImmediatePropagation()},this.onSelectCancel=()=>{this.setState({abilityModalVisible:!1})},this.onSelectConfirm=i=>{var o=i.capability,u=i.labelName,v=i.optionType,m=this.state,c=m.dataIndex,d=m.data,e=this.props,n=e.formik,h=e.t,p=o.filter(P=>P.panelIndex===c),s=p.map((P,D)=>(0,r.Z)((0,r.Z)({},P),{},{rowIndex:D}));if(s.length>20)return b.default.error(h("personnelDevelope.validation.competencyItemsLimit")),!1;if(v==="add")this.setState({data:d.concat({name:u,post_qualifications_ability:s}),panelVisible:!0},()=>{n.setFieldValue("post_qualifications_ability_classify",this.state.data),this.onSelectCancel()});else{var g=d.map((P,D)=>c===D?(0,r.Z)((0,r.Z)({},P),{},{post_qualifications_ability:s,name:u}):P);this.setState({data:g,panelVisible:!0},()=>{n.setFieldValue("post_qualifications_ability_classify",g),this.onSelectCancel()})}return!0},this.onLevelChange=(i,o)=>{var u=i.ability_level-1,v={ability_level:i.ability_level,behavior_desc:i.levels[u].behavior_desc};this.commonChangePanelData(v,o)},this.commonChangePanelData=(i,o)=>{var u=this.state,v=u.data,m=u.dataIndex,c=this.props.formik,d=i.ability_level-1,e=v[m].post_qualifications_ability.map((h,p)=>o===p?(0,r.Z)((0,r.Z)((0,r.Z)({},h),i),{},{ability_levels:i.inputType!==void 0?h.ability_levels.map((s,g)=>g===d?(0,r.Z)((0,r.Z)({},s),{},{behavior_desc:i.behavior_desc}):s):h.ability_levels}):h),n=v.map((h,p)=>p===m?(0,r.Z)((0,r.Z)({},h),{},{post_qualifications_ability:e}):h);this.setState({data:n},()=>{c.setFieldValue("post_qualifications_ability_classify",n)})},this.hideEdit=()=>{var i=this.state.data,o=this.props.formik,u=i.map(v=>(0,r.Z)((0,r.Z)({},v),{},{post_qualifications_ability:v.post_qualifications_ability.map(m=>(0,r.Z)((0,r.Z)({},m),{},{isEdit:!1}))}));this.setState({data:u},()=>{o.setFieldValue("post_qualifications_ability_classify",u)})},this.renamePanel=()=>{var i=this.props.t,o=this.state,u=o.data,v=o.dataIndex,m={name:u[v].name};this.setState({initialValues:m,configModal:(0,r.Z)((0,r.Z)({},this.state.configModal),{},{visible:!0,tag:v,title:i("personnelDevelope.editAbilityLabel")}),isRename:!0})},this.renderIcon=()=>t().createElement(oe.Z,{iconClass:"iconf-add",size:"12px",color:"rgba(7, 7, 7, 0.45)"}),this.deletePanel=()=>{var i=this.state,o=i.data,u=i.dataIndex,v=this.props.formik,m=o.slice();m.splice(u,1);var c;u!==o.length-1&&(c=m.map(d=>(0,r.Z)((0,r.Z)({},d),{},{post_qualifications_ability:d.post_qualifications_ability.map(e=>(0,r.Z)((0,r.Z)({},e),{},{panelIndex:e.panelIndex-1!=-1?e.panelIndex-1:e.panelIndex}))}))),this.setState({data:c||m},()=>{this.state.data.length===0?v.setFieldValue("post_qualifications_ability_classify",[]):v.setFieldValue("post_qualifications_ability_classify",m)})},this.addOption=i=>{var o=this.state,u=o.data,v=o.selectAbilityValues,m=[],c={abilityModalVisible:!0,selectAbilityValues:(0,r.Z)((0,r.Z)({},v),{},{labelName:i})};i!==""?c.selectAbilityValues.optionType="edit":(c.selectAbilityValues.optionType="add",c.dataIndex=-1),u.forEach((d,e)=>{d.post_qualifications_ability.forEach(n=>{n.panelIndex=e,m.push(n)})}),c.itemArr=m,this.setState(c)},this.getIndex=i=>{this.setState({dataIndex:i})},this.state={data:[],dataIndex:-1,panelVisible:!1,footerOptionName:this.props.t("personnelDevelope.chooseAbility"),configModal:{visible:!1},configComponents:[{name:"name",nameLabel:this.props.t("personnelDevelope.labelName"),componentsType:"input",inputType:"text",maxLength:20,placeholder:this.props.t("personnelDevelope.placeholder.labelNamePlaceholder"),validateType:"isSameName"}],initialValues:{name:""},isRename:!1,abilityModalVisible:!1,itemArr:[],labelTitle:"",selectAbilityValues:{labelName:"",optionType:"add",tag:"-1"}}}componentDidMount(){document.removeEventListener("click",this.hideEdit);var f=this.props.abilityClassifyData,i;f.length!==0&&(i=f.map((o,u)=>(0,r.Z)((0,r.Z)({},o),{},{index:u,post_qualifications_ability:o.post_qualifications_ability.map((v,m)=>(0,r.Z)((0,r.Z)({},v),{},{rowIndex:m,index:u}))})),this.setState({data:i,panelVisible:!0}))}render(){var f=this.props,i=f.prefixCls,o=f.isView,u=f.t,v=this.state,m=v.data,c=v.dataIndex,d=v.configModal,e=v.panelVisible,n=v.configComponents,h=v.footerOptionName,p=v.initialValues,s=v.abilityModalVisible,g=v.itemArr,P=v.labelTitle,D=v.selectAbilityValues,K=[{title:u("evaluation.powerName"),dataIndex:"ability_name",key:"ability_name",width:120,textWrap:"word-break",ellipsis:!0},{title:u("evaluation.powerLevel"),dataIndex:"name",key:"name",width:100,render:($,G)=>t().createElement(ee.Z,{disabled:o,value:G.ability_level,onChange:H=>{this.onLevelChange({levels:G.ability_levels,source:G.source,ability_level:H},G.rowIndex)},defaultValue:G.level_name||G.name,style:{width:"74px"}},G.ability_levels.map((H,J)=>t().createElement(Ye,{key:J.toString(),value:H.default_score},H.name||H.level_name)))},{title:u("evaluation.behaviorDesc"),dataIndex:"behavior_desc",key:"behavior_desc",render:($,G)=>{var H;return o?H=t().createElement("div",{className:"post-label-edit-input"},t().createElement(X.Z,{value:G.behavior_desc,disabled:o})):H=t().createElement("div",{className:"post-label-edit-input",onClick:this.onEditInput.bind(this,G.rowIndex)},G.isEdit?t().createElement(X.Z,{maxLength:500,onChange:J=>{this.onChangeInput(G,J)},value:G.behavior_desc}):t().createElement("div",{className:"".concat(i,"-behavior-describe-content")},t().createElement("span",{className:"".concat(i,"-behavior-describe")},G.behavior_desc),t().createElement("div",{className:"".concat(i,"-edit-icon")},t().createElement(oe.Z,{iconClass:"icon-f-edit",size:"16",color:"#00000026"})))),H}},{title:u("personnelDevelope.operate"),dataIndex:"operate",key:"operate",width:50,render:($,G)=>!o&&t().createElement("a",{onClick:()=>{this.onDeleteItem(G.rowIndex)}},u("common.delete"))}];return t().createElement(t().Fragment,null,m.length<3&&!o&&t().createElement(E.Z,{className:"personnel-ability-label-btn",block:!0,type:"dashed",icon:this.renderIcon(),onClick:()=>{this.addOption("")}},u("personnelDevelope.createAbilityLabel")),e?t().createElement(Ce,{prefixCls:"personnel-ability-label",columns:K,data:m,footerOptionName:h,renamePanel:this.renamePanel,deletePanel:this.deletePanel,addOption:this.addOption,getIndex:this.getIndex,renderType:"labelPanel",isView:o}):"",d.visible?t().createElement(z.Z,{configModal:d,configComponents:n,onCancel:this.onCancel,onConfirm:this.onConfirm,initialValues:p,data:m}):"",s?t().createElement(me,{visible:s,onCancel:this.onSelectCancel,onConfirm:this.onSelectConfirm,data:m,panelIndex:c,itemArr:g,labelTitle:P,initialValues:D}):"")}},Qe.defaultProps={prefixCls:"personnel-ability-label"},Fe))||ke)||ke)||ke),Oe=(0,j.Z)()((0,B.Z)((0,y.$j)(He)));class ut extends t().Component{constructor(f){super(f);this.onCreateTask=i=>{var o=this.props.t,u={configModal:(0,r.Z)((0,r.Z)({},this.state.configModal),{},{visible:!0,tag:-1,title:o("personnelDevelope.addCriticalTasks")}),initialValues:{name:"",description:""},isRename:!1};i&&i.item&&(u.initialValues=i.item,u.isRename=i.isRename,u.renameIndex=i.index,u.configModal.tag=i.index,u.configModal.title=o("personnelDevelope.editCriticalTasks")),this.setState(u)},this.onConfirm=i=>{var o=this.state,u=o.isRename,v=o.data,m=o.renameIndex,c=this.props.formik,d=(0,r.Z)((0,r.Z)({},i),{},{sort:v.length}),e={data:v.concat(d),configModal:(0,r.Z)((0,r.Z)({},this.state.configModal),{},{visible:!1}),panelVisible:!0};if(u){var n=v.map((h,p)=>p===m?(0,r.Z)((0,r.Z)({},h),{},{name:i.name,description:i.description}):h);e.data=n}this.setState((0,r.Z)({},e),()=>{c.setFieldValue("post_emphasis_task",e.data)})},this.onCancel=()=>{this.setState({configModal:(0,r.Z)((0,r.Z)({},this.state.configModal),{},{visible:!1}),isRename:!1})},this.deletePanel=()=>{var i=this.props.formik;this.setState({data:[]},()=>{i.setFieldValue("post_emphasis_task",[])})},this.renderIcon=()=>t().createElement(oe.Z,{iconClass:"iconf-add",size:"12px",color:"rgba(7, 7, 7, 0.45)"}),this.deleteItem=i=>{var o=this.props.formik,u=this.state.data;u.splice(i,1);var v=u.map((m,c)=>(m.sort=c,m.id=c,m));this.setState({data:v},()=>{o.setFieldValue("post_emphasis_task",v)})},this.edit=i=>{var o=this.state.data;this.onCreateTask({item:o[i],index:i,isRename:!0})},this.addOption=()=>{var i=this.props.t;this.setState({configModal:(0,r.Z)((0,r.Z)({},this.state.configModal),{},{visible:!0,title:i("personnelDevelope.addCriticalTasks")}),isRename:!1,initialValues:{name:"",description:""}})},this.state={data:[],panelTitle:f.t("personnelDevelope.keyTask"),panelVisible:!1,footerOptionName:f.t("personnelDevelope.addCriticalTasks"),configModal:{visible:!1},configComponents:[{name:"name",nameLabel:f.t("exam.taskName"),componentsType:"input",maxLength:50,placeholder:f.t("personnelDevelope.placeholder.checkTitleNull"),validateType:"isSameName"},{name:"description",nameLabel:f.t("personnelDevelope.taskDescription"),componentsType:"textarea",maxLength:500,placeholder:f.t("personnelDevelope.placeholder.taskDescription"),validateType:"noEmpty"}],initialValues:{name:"",description:""},isRename:!1,renameIndex:0}}componentDidMount(){var f=this.props.data;f.length!==""&&this.setState({panelVisible:!0,data:f.map((i,o)=>(0,r.Z)((0,r.Z)({},i),{},{id:o}))})}render(){var f=this.state,i=f.configModal,o=f.panelVisible,u=f.configComponents,v=f.panelTitle,m=f.footerOptionName,c=f.initialValues,d=f.data,e=this.props,n=e.isView,h=e.t,p=[{title:h("exam.taskName"),dataIndex:"name",key:"name",width:100,render:s=>t().createElement("span",null,s)},{title:h("personnelDevelope.taskDescription"),dataIndex:"description",key:"description",render:s=>t().createElement("span",null,s)},{title:h("personnelDevelope.operate"),dataIndex:"operate",key:"operate",width:100,render:(s,g)=>n?"":t().createElement(t().Fragment,null,t().createElement("a",{onClick:()=>{this.edit(g.id||g.sort)}},h("common.edit")),t().createElement(le.Z,{type:"vertical"}),t().createElement("a",{onClick:()=>{this.deleteItem(g.id||g.sort)}},h("common.delete")))}];return t().createElement(t().Fragment,null,d.length<20&&!n&&t().createElement(E.Z,{block:!0,type:"dashed",icon:this.renderIcon(),onClick:this.onCreateTask},h("personnelDevelope.addCriticalTasks")),o?t().createElement(Ce,{prefixCls:"personnel-task-label",columns:p,data:d,panelTitle:v,footerOptionName:m,deletePanel:this.deletePanel,onlyShowDel:!0,addOption:this.addOption,renderType:"taskPanel",isView:n}):"",i.visible?t().createElement(z.Z,{configModal:i,configComponents:u,onCancel:this.onCancel,onConfirm:this.onConfirm,initialValues:c,data:d}):"")}}var Je=(0,j.Z)()((0,B.Z)((0,y.$j)(ut))),Xe=a(93117);class qe extends t().Component{constructor(f){super(f);this.onShowCreateTask=i=>{var o=this.props.t,u={configModal:(0,r.Z)((0,r.Z)({},this.state.configModal),{},{visible:!0,tag:-1,title:o("personnelDevelope.addCertificate")}),isRename:!1,initialValues:{name:"",description:""}};i&&i.item&&(u.initialValues=i.item,u.isRename=i.isRename,u.renameIndex=i.index,u.configModal.tag=i.index,u.configModal.title=o("personnelDevelope.editCertificate")),this.setState(u)},this.onCancel=()=>{this.setState({configModal:(0,r.Z)((0,r.Z)({},this.state.configModal),{},{visible:!1}),initialValues:{name:"",description:""}})},this.onConfirm=i=>{var o=this.state,u=o.isRename,v=o.certificateList,m=o.renameIndex,c=this.props.formik,d={certificateList:v.concat((0,r.Z)((0,r.Z)({},i),{},{sort:v.length})),configModal:(0,r.Z)((0,r.Z)({},this.state.configModal),{},{visible:!1})};if(u){var e=v.map((n,h)=>h===m?(0,r.Z)((0,r.Z)({},n),{},{name:i.name,description:i.description}):n);d.certificateList=e}this.setState(d,()=>{c.setFieldValue("post_emphasis_certificate",d.certificateList),this.onCancel()})},this.onShowCertificateDetail=(i,o)=>{var u=this.state,v=u.certificateList,m=u.viewCertificateModal,c=u.chooseCertificate,d;i==="selfCertificate"?d=v:d=c,this.setState({viewCertificateModal:(0,r.Z)((0,r.Z)({},m),{},{visible:!0,title:d[o].name,content:d[o].description})})},this.onViewCertificateCancel=()=>{var i=this.state.viewCertificateModal;this.setState({viewCertificateModal:(0,r.Z)((0,r.Z)({},i),{},{visible:!1})})},this.onChooseCertificate=()=>{this.setState({certificateVisible:!0})},this.renamePanel=i=>{var o=this.state.certificateList;this.onShowCreateTask({item:o[i],index:i,isRename:!0})},this.deletePanel=i=>{var o=this.state.certificateList,u=this.props.formik;o.splice(i,1);var v=o.map((m,c)=>(m.sort=c,m));this.setState({certificateList:v},()=>{u.setFieldValue("post_emphasis_certificate",this.state.certificateList)})},this.deleteChoosePanel=i=>{var o=this.state.chooseCertificate,u=this.props.formik;o.splice(i,1);var v=o.map((m,c)=>(m.sort=c,m));this.setState({chooseCertificate:v},()=>{u.setFieldValue("certificate_ids",this.state.chooseCertificate.map(m=>m.id)),u.setFieldValue("platform_certificate_list",v)})},this.renderIcon=()=>t().createElement(oe.Z,{iconClass:"iconf-add",size:"12px",color:"rgba(7, 7, 7, 0.45)"}),this.handleOk=i=>{var o=this.props,u=o.t,v=o.formik,m=this.state,c=m.chooseCertificate,d=m.certificateList,e=i.filter(p=>c.every(s=>p.id!==s.id)),n=c.concat(e),h=n.concat(d);if(h.length>20){b.default.error(u("personnelDevelope.certificateLimitTip"));return}this.setState({certificateVisible:!1,chooseCertificate:n.map((p,s)=>(0,r.Z)((0,r.Z)({},p),{},{sort:s}))},()=>{v.setFieldValue("certificate_ids",this.state.chooseCertificate.map(p=>p.id)),v.setFieldValue("platform_certificate_list",this.state.chooseCertificate)})},this.handleCancel=()=>{this.setState({certificateVisible:!1})},this.renderTitle=()=>{var i=this.props.t;return t().createElement("div",{className:"create-certificate-title"},t().createElement("span",null,i("component.certificateSelect")),t().createElement(A.Z,{placement:"top",title:i("personnelDevelope.certificateChooseTip")},t().createElement("span",null,t().createElement(oe.Z,{iconClass:"iconf-help"}))))},this.handleBeforeCreateTask=i=>{i==="platCertificate"?this.onChooseCertificate():this.onShowCreateTask()},this.renderCertificate=i=>{var o=i.type,u=i.list,v=this.props,m=v.isView,c=v.t,d=v.prefixCls,e=this.state,n=e.chooseCertificate,h=e.certificateList,p=n.concat(h),s=[];return o==="platCertificate"?s=[{title:c("common.name"),dataIndex:"name",width:100,render:(g,P)=>t().createElement(A.Z,{placement:"top",title:P.name},t().createElement("div",{className:"post-certificate-name common-ellipsis"},P.name))},{title:c("shareInfo.shareTitle"),dataIndex:"title",render:(g,P)=>P.title||"---"},{title:c("personnelDevelope.text"),dataIndex:"description"},{title:c("common.operate"),width:100,render:(g,P)=>m?"":t().createElement(t().Fragment,null,t().createElement(E.Z,{type:"link"},t().createElement("a",{onClick:()=>{this.deleteChoosePanel(P.sort)}},c("common.delete"))))}]:s=[{title:c("common.name"),dataIndex:"name",width:100,render:(g,P)=>t().createElement(A.Z,{placement:"top",title:P.name},t().createElement("div",{className:"post-certificate-name common-ellipsis"},P.name))},{title:c("visitorPage.desc"),dataIndex:"description"},{title:c("common.operate"),width:100,render:(g,P)=>m?"":t().createElement(t().Fragment,null,t().createElement(E.Z,{type:"link"},t().createElement("a",{onClick:()=>{this.renamePanel(P.sort)}},c("common.edit"))),t().createElement(le.Z,{type:"vertical"}),t().createElement(E.Z,{type:"link"},t().createElement("a",{onClick:()=>{this.deletePanel(P.sort)}},c("common.delete"))))}],t().createElement(t().Fragment,null,p.length<20&&!m&&t().createElement(E.Z,{block:!0,className:"".concat(d,"-addCertificate-btn"),type:"dashed",icon:this.renderIcon(),onClick:()=>{this.handleBeforeCreateTask(o)}},c(o==="platCertificate"?"personnelDevelope.chooseCertificateButton":"personnelDevelope.addCertificate")),u.length!==0?t().createElement("div",{className:"create-certificate-table"},t().createElement(pe.f,{columns:s,dataSource:u,tableUUID:"c72389fa-1a9e-4995-b5b0-ffc2a2809527"})):"")},this.state={certificateList:[],configModal:{visible:!1},viewCertificateModal:{visible:!1,renderType:"text",isOptionButton:!0},configComponents:[{name:"name",nameLabel:f.t("authentication.certificateDetailName"),componentsType:"input",maxLength:50,placeholder:f.t("personnelDevelope.placeholder.certificateDetailName"),validateType:"isSameName"},{name:"description",nameLabel:f.t("personnelDevelope.certificateDesc"),componentsType:"textarea",maxLength:500,placeholder:f.t("personnelDevelope.placeholder.certificateDesc"),validateType:"noEmpty"}],initialValues:{name:"",description:""},isRename:!1,renameIndex:0,certificateVisible:!1,chooseCertificate:[]}}componentDidMount(){var f=this.props,i=f.data,o=f.chooseCertificateData;this.props.getCertificateData&&this.props.getCertificateData(this),(i.length!==0||o.length!==0)&&this.setState({certificateList:i,chooseCertificate:o.map(u=>(0,r.Z)((0,r.Z)({},u),{},{description:u.summary}))},()=>{this.props.formik.setFieldValue("certificate_ids",this.state.chooseCertificate.map(u=>u.id))})}render(){var f=this.state,i=f.configModal,o=f.configComponents,u=f.initialValues,v=f.viewCertificateModal,m=f.certificateVisible,c=f.certificateList,d=f.chooseCertificate;return t().createElement(t().Fragment,null,this.renderCertificate({type:"selfCertificate",list:c}),this.renderCertificate({type:"platCertificate",list:d}),i.visible?t().createElement(z.Z,{configModal:i,configComponents:o,onCancel:this.onCancel,onConfirm:this.onConfirm,initialValues:u,data:c}):"",v.visible?t().createElement("div",null,t().createElement(z.Z,{configModal:v,onCancel:this.onViewCertificateCancel})):"",t().createElement(Xe.Z,{visible:m,onCancel:this.handleCancel,onOk:this.handleOk,selectType:"checkbox",title:this.renderTitle()}))}}qe.defaultProps={prefixCls:"personnel-certificate-content"};var et=(0,j.Z)()((0,y.$j)((0,B.Z)(qe))),tt=a(19864),Ke,$e,we,Me,at=(Ke=(0,l.$j)(he=>{var f=he.user;return{enterprise_id:f.enterpriseId}}),$e=Reflect.metadata("design:type",Function),we=Reflect.metadata("design:paramtypes",[void 0]),Ke(Me=$e(Me=we(Me=class extends t().Component{constructor(f){var i;super(f);i=this,this.onAddClassTag=()=>{this.setState({configModal:(0,r.Z)((0,r.Z)({},this.state.configModal),{},{visible:!0}),addClassify:!0})},this.onConfirm=function(){var o=(0,R.Z)(k().mark(function u(v){var m,c,d;return k().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return m=v.classify_id?v.classify_id:0,c=i.props.enterprise_id,n.next=4,(0,ve.Cr)(c,m,v.name);case 4:d=n.sent,d.data.code===0&&i.props.getClassifyData(d.data.data,i.props.formik.values),i.onCancel();case 7:case"end":return n.stop()}},u)}));return function(u){return o.apply(this,arguments)}}(),this.onCancel=()=>{this.setState({configModal:(0,r.Z)((0,r.Z)({},this.state.configModal),{},{visible:!1}),addClassify:!1},()=>{this.onModalChange()})},this.onModalChange=o=>{o?this.changeComponentsData(!0):this.changeComponentsData(!1)},this.changeComponentsData=o=>{var u=this.state.configComponents.slice();u.forEach((v,m)=>{m===1&&(v.disabled=o,o?v.validateType="":v.validateType="noEmpty")}),this.setState({configComponents:u})},this.state={initialValues:{classify_id:"",name:""},configModal:{visible:!1,title:f.t("exam.paperAddItemAddClassify")},configComponents:[{name:"classify_id",nameLabel:f.t("component.questionBankClassify"),componentsType:"ClassifySelect",placeholder:f.t("component.pleaseChoose"),maxLength:200,validateType:"null",isNoRequired:!0,labelCol:{span:4},wrapperCol:{span:8},defaultValue:f.t("personnelDevelope.fullCertification")},{name:"name",nameLabel:f.t("component.classifyName"),componentsType:"input",maxLength:20,placeholder:f.t("component.inputClassifyTip"),validateType:"noEmpty",labelCol:{span:4},wrapperCol:{span:8},disabled:!1,addClassify:!1}]}}render(){var f=this.state,i=f.configModal,o=f.configComponents,u=f.initialValues,v=f.addClassify,m=this.props,c=m.showAdd,d=m.value,e=m.placeholder,n=m.style,h=m.classifyData,p=m.t,s=m.isView;return t().createElement(t().Fragment,null,t().createElement(tt.Z,{defaultValue:d,placeholder:e,style:n,classifyData:h,isView:s}),c&&!s&&t().createElement(E.Z,{type:"link",onClick:this.onAddClassTag},t().createElement(oe.Z,{iconClass:"icon-icon_addx"}),p("component.newClassify")),i.visible?t().createElement(z.Z,{configModal:i,configComponents:o,onCancel:this.onCancel,onConfirm:this.onConfirm,initialValues:u,classifyData:h,onModalChange:this.onModalChange,addClassify:v},o[1].disabled?t().createElement("div",{className:"post-qualification-classify-tip"},p("personnelDevelope.createClassifyTip")):""):"")}})||Me)||Me)||Me),je=(0,j.Z)()((0,B.Z)((0,y.$j)(at))),st=a(71194),nt=a(57016),ze=a(57119),pt=a(49101),ht=a(88311);class it extends t().Component{constructor(f){super(f);this.onOrgDialogOk=i=>{var o=Z.parse(W.m8.location.search),u=o.id,v=o.copy,m=this.state,c=m.configModal,d=m.allPost,e=i.post;if(e.length===0){this.onOrgDialogCancel();return}var n=e.map((s,g)=>({post_id:s.id,post_name:s.name,showClose:!0,index:g,isCheck:!1})),h=d.concat(n).map(s=>s.post_id),p={post_id_list:[...new Set(h)]};u&&!v&&(p.qualification_id=u),(0,M.Qs)(p).then(s=>{var g=s.data.data;if(s.data.code===0){var P=g.noRepeatPost.map((K,$)=>({showClose:!0,post_id:K.id,post_name:K.name,index:$})),D=(0,ne.Cj)(d.concat(n,P),"post_id");g.result.length!==0?this.setState({configModal:(0,r.Z)((0,r.Z)({},c),{},{visible:!0,content:this.renderTip(g.result.join("\uFF0C"))}),result:D}):this.setState({allPost:D},()=>{this.onOrgDialogCancel()})}})},this.onOrgDialogCancel=()=>{var i=this.state.orgModalConfig,o=this.props.formik;this.setState({orgModalConfig:(0,r.Z)((0,r.Z)({},i),{},{visible:!1})},()=>{o.setFieldValue("post_id_list",this.state.allPost.map(u=>u.post_id)),o.setFieldValue("post_name_list",this.state.allPost.map(u=>({post_id:u.post_id,post_name:u.post_name})))})},this.onShowOrgDialog=()=>{var i=this.state.orgModalConfig;this.setState({orgModalConfig:(0,r.Z)((0,r.Z)({},i),{},{visible:!0})})},this.onDelPost=(i,o)=>{var u=Z.parse(W.m8.location.search),v=u.id,m=u.copy,c=this.props.t;v&&m!=="true"&&o.isCheck!==!1?(0,M.Ej)(o.post_id).then(d=>{d.data.data===0?nt.Z.confirm({title:c("common.tip"),icon:t().createElement(ze.Z,null),content:c("personnelDevelope.delPostCheck"),okText:c("common.ok"),cancelText:c("common.cancel"),onOk:()=>{this.unbindPost(o.post_id,i)}}):this.unbindPost(o.post_id,i)}):this.setPost(i)},this.onTipCancel=()=>{var i=this.state.configModal;this.setState({configModal:(0,r.Z)((0,r.Z)({},i),{},{visible:!1})})},this.onTipConfirm=()=>{var i=this.props.formik,o=this.state,u=o.orgModalConfig,v=o.configModal,m=o.result;this.setState({configModal:(0,r.Z)((0,r.Z)({},v),{},{visible:!1}),orgModalConfig:(0,r.Z)((0,r.Z)({},u),{},{visible:!1}),allPost:m},()=>{i.setFieldValue("post_id_list",this.state.allPost.map(c=>c.post_id)),i.setFieldValue("post_name_list",this.state.allPost.map(c=>({post_id:c.post_id,post_name:c.post_name})))})},this.unbindPost=(i,o)=>{var u=this.props.t;(0,M.Yn)(i).then(v=>{v.data.result==="true"?(b.default.success(u("personnelDevelope.unbindSucceeded")),this.setPost(o)):b.default.success(u("personnelDevelope.unbindFail"))})},this.renderTip=i=>{var o=this.props.t;return t().createElement(t().Fragment,null,t().createElement("p",null,o("personnelDevelope.selecPostTip")),t().createElement("p",null,i))},this.setPost=i=>{var o=this.props.formik,u=this.state.allPost;u.splice(i,1),this.setState({allPost:u},()=>{o.setFieldValue("post_id_list",this.state.allPost.map(v=>v.post_id)),o.setFieldValue("post_name_list",this.state.allPost.map(v=>({post_id:v.post_id,post_name:v.post_name})))})},this.state={orgModalConfig:{visible:!1,title:f.t("course.jobs"),onlyDept:!0,onlyChoosePost:!0,onlyPost:!0,displayType:["post",""],onOk:this.onOrgDialogOk,onCancel:this.onOrgDialogCancel},allPost:[],configModal:{visible:!1,title:f.t("localStorage.tip"),renderType:"text"},result:[]}}componentDidMount(){var f=this.props,i=f.value,o=f.formik;if(i.length!==0){var u=i.map(v=>({post_id:v.post_id,post_name:v.post_name,showClose:!0}));this.setState({allPost:u},()=>{o.setFieldValue("post_id_list",this.state.allPost.map(v=>v.post_id)),o.setFieldValue("post_name_list",this.state.allPost.map(v=>({post_id:v.post_id,post_name:v.post_name})))})}}render(){var f=this.props,i=f.t,o=f.isView,u=f.formik.initialValues.post_status,v=this.state,m=v.allPost,c=v.orgModalConfig,d=v.configModal,e=Z.parse(W.m8.location.search),n=e.copy,h;return n==="true"?h=!1:h=o||u!==1,t().createElement(t().Fragment,null,t().createElement("div",{className:"post-promotion"},m.map((p,s)=>t().createElement(E.Z,{disabled:o,className:"post-promotion-button",key:s.toString()},p.post_name,t().createElement("a",{onClick:()=>{this.onDelPost(s,p)}},t().createElement(oe.Z,{iconClass:"icon-guanbi",size:"12px"}))))),t().createElement(E.Z,{disabled:h,onClick:this.onShowOrgDialog},t().createElement(pt.Z,null),t().createElement("span",{className:"label"},i("personnelDevelope.RelatedJobs"))),t().createElement(ht.Z,c),d.visible?t().createElement(z.Z,{configModal:d,onCancel:this.onTipCancel,onConfirm:this.onTipConfirm}):"")}}var Et=(0,j.Z)()((0,y.$j)((0,B.Z)(it)));class rt extends t().Component{constructor(f){super(f);this.onConfirm=i=>{var o=this.props.formik,u=this.state,v=u.list,m=u.rename,c=u.renameIndex;this.setState({list:m?v.map((d,e)=>c===e?(0,r.Z)((0,r.Z)({},d),i):d):v.concat((0,r.Z)((0,r.Z)({},i),{},{sort:v.length}))},()=>{this.onCancel(),o.setFieldValue("post_emphasis_contribute",this.state.list)})},this.onCancel=()=>{var i=this.state.configModal;this.setState({configModal:(0,r.Z)((0,r.Z)({},i),{},{visible:!1})})},this.showOrganizeContribute=()=>{var i=this.state.configModal;this.setState({configModal:(0,r.Z)((0,r.Z)({},i),{},{visible:!0,tag:-1}),initialValues:{name:"",description:""},rename:!1})},this.renamePanel=i=>{var o=this.state,u=o.list,v=o.configModal;this.setState({initialValues:u[i],configModal:(0,r.Z)((0,r.Z)({},v),{},{visible:!0,tag:i}),rename:!0,renameIndex:i})},this.renderIcon=()=>t().createElement(oe.Z,{iconClass:"iconf-add",size:"12px",color:"rgba(7, 7, 7, 0.45)"}),this.deletePanel=i=>{var o=this.state.list;o.splice(i,1);var u=o.map((v,m)=>(0,r.Z)((0,r.Z)({},v),{},{sort:m}));this.setState({list:u},()=>{this.props.formik.setFieldValue("post_emphasis_contribute",u)})},this.state={configModal:{visible:!1,title:f.t("personnelDevelope.organizeContribute")},configComponents:[{name:"name",nameLabel:f.t("personnelDevelope.contributionName"),componentsType:"input",maxLength:50,placeholder:f.t("personnelDevelope.placeholder.organizeContributeName"),validateType:"isSameName"},{name:"description",nameLabel:f.t("personnelDevelope.contributionDesc"),componentsType:"textarea",maxLength:500,placeholder:f.t("personnelDevelope.placeholder.organizeContributeDesc"),validateType:"noEmpty"}],initialValues:{name:"",description:""},renameIndex:-1,list:[],rename:!1}}componentDidMount(){var f=this.props,i=f.data,o=f.formik;this.setState({list:i.map((u,v)=>(0,r.Z)((0,r.Z)({},u),{},{sort:v}),()=>{o.setFieldValue("post_emphasis_contribute",this.state.list)})})}render(){var f=this.props,i=f.isView,o=f.t,u=f.prefixCls,v=this.state,m=v.list,c=v.configComponents,d=v.initialValues,e=v.configModal,n=[{title:o("personnelDevelope.contributionName"),dataIndex:"name",width:125},{title:o("personnelDevelope.contributionDesc"),dataIndex:"description"},{title:o("common.operate"),width:100,render:(h,p)=>i?"":t().createElement(t().Fragment,null,t().createElement(E.Z,{type:"link"},t().createElement("a",{onClick:()=>{this.renamePanel(p.sort)}},o("common.edit"))),t().createElement(le.Z,{type:"vertical"}),t().createElement(E.Z,{type:"link"},t().createElement("a",{onClick:()=>{this.deletePanel(p.sort)}},o("common.delete"))))}];return t().createElement(t().Fragment,null,m.length<20&&!i&&t().createElement(E.Z,{block:!0,className:"".concat(u,"-create-organize-contribute-btn"),type:"dashed",icon:this.renderIcon(),onClick:()=>{this.showOrganizeContribute()}},o("personnelDevelope.addOrganizeContribute")),m.length!==0?t().createElement("div",{className:"create-certificate-table"},t().createElement(pe.f,{columns:n,dataSource:m,tableUUID:"c72389fa-1a9e-4995-b5b0-ffc4gj909527"})):"",e.visible?t().createElement(z.Z,{configModal:e,configComponents:c,onCancel:this.onCancel,onConfirm:this.onConfirm,initialValues:d,data:m}):"")}}rt.defaultProps={prefixCls:"personnel-certificate-content"};var mt=(0,j.Z)()((0,B.Z)((0,y.$j)(rt)));class lt extends t().Component{constructor(){super(...arguments);this.onChoose=()=>{var f=this.props.isClick;f&&this.props.onSelect()},this.showCopy=()=>{this.props.onSelect()}}render(){var f=this.props,i=f.style,o=f.isClick,u=f.t,v=f.maxLength,m=f.placeholder,c=f.value,d=f.isView;return t().createElement(t().Fragment,null,t().createElement(X.Z,{style:i,onChange:this.props.onChange,maxLength:v,placeholder:m,value:c.slice(0,v),disabled:d}),d?"":t().createElement(E.Z,{type:"link",onClick:this.onChoose,disabled:!o},t().createElement("span",null,u("personnelDevelope.selectTemplateCopy")),t().createElement(A.Z,{placement:"top",title:u("personnelDevelope.copyBtn")},t().createElement("span",null,t().createElement(oe.Z,{iconClass:"iconf-help"})))))}}var ft=(0,j.Z)()((0,B.Z)((0,y.$j)(lt))),Ge=a(48206),ot=a(11236),vt=a(89810),gt=a(4408),ct,dt,Ve,Ne,Ct=(ct=(0,l.$j)(he=>{var f=he.user,i=he.personnelDevelope;return{enterprise_id:f.enterpriseId,currentStep:i.currentStep,maxStep:i.maxStep,superiorPostName:i.superiorPostName,projectList:i.projectList,qualificationDescription:i.qualificationDescription,postDescription:i.postDescription,postCourseId:i.postCourseId,functionId:i.functionId,qualificationId:i.qualificationId,postId:i.postId,qualification_need:i.qualification_need}}),dt=Reflect.metadata("design:type",Function),Ve=Reflect.metadata("design:paramtypes",[void 0]),ct(Ne=dt(Ne=Ve(Ne=class extends t().Component{constructor(f){var i;super(f);i=this,this.onPropsSubmit=()=>{this.initRef.current.submitForm()},this.onBack=()=>{this.initRef&&this.initRef.current&&this.initRef.current.resetForm(),W.m8.push("/talentedDevelopment/postTrainPlan/postQualifications")},this.onSubmit=o=>{this.setState({isLoading:!0});var u=this.props,v=u.enterprise_id,m=u.qualificationId,c=u.postCourseId,d=u.setLoading;if(d&&d(!0),o.qualification_need===0){this.props.dispatch({type:"personnelDevelope/update",payload:{qualificationId:0}});var e={enterprise_id:v,id:c,qualification_need:o.qualification_need,type:"put"};this.bindQualifications(e,this.props.addStep);return}var n=Z.parse(W.m8.location.search),h=n.id,p=n.copy,s=this.state.pageSource,g={},P=JSON.parse(JSON.stringify({copyAbility:o.post_qualifications_ability_classify})),D=P.copyAbility.map((G,H)=>(0,r.Z)((0,r.Z)({},G),{},{sort:H,post_qualifications_ability:G.post_qualifications_ability.map(J=>({ability_id:J.ability_id,ability_name:J.ability_name,ability_level:J.ability_level,behavior_desc:J.behavior_desc,source:J.source}))}));for(var K in o)o[K].length&&(typeof o[K]=="string"?g[K]=(0,ne.fy)(o[K]):g[K]=o[K]);g.post_qualifications_ability_classify=D;var $=(0,r.Z)((0,r.Z)({},g),{},{enterprise_id:v});this.setState({submitData:$}),h&&s&&($.id=h,$.type="put"),m&&!s&&($.id=this.props.qualificationId,$.type="put"),p==="true"&&($.type="post"),m&&s===""?this.contrastChange($):this.addBindQualifications($)},this.onSelect=()=>{this.setState({sourceVisible:!0})},this.onOk=o=>{var u=o.selResourceItem;if(u===""){this.setState({sourceVisible:!1});return}var v=this.state.pageSource,m=Z.parse(W.m8.location.search),c=m.id;this.setState({sourceVisible:!1,requested:!1},()=>{v?this.setState({isHideSelectPost:!0},()=>{this.getQualificationData(o.selResourceItem[0].id,1,c,"copy")}):this.getQualificationData(o.selResourceItem[0].id,1,c,""),this.props.dispatch({type:"personnelDevelope/update",payload:{qualificationId:o.selResourceItem[0].id}})})},this.onSourceCancel=()=>{this.setState({sourceVisible:!1})},this.onRadioChange=o=>{var u={},v;o===0?(u.isSetQualification=!1,u.isClick=!1,v=0):(u.isSetQualification=!0,u.isClick=!0,v=1),this.props.dispatch({type:"personnelDevelope/update",payload:{qualification_need:v}}),this.setState(u)},this.onTipCancel=()=>{var o=this.props.setLoading,u=this.state.configModal;this.setState({configModal:(0,r.Z)((0,r.Z)({},u),{},{visible:!1})}),o&&o(!1)},this.onTipConfirm=(0,R.Z)(k().mark(function o(){var u,v,m,c;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u=i.state,v=u.tipValue,m=u.submitData,c=m,v==="rewrite"?c.type="put":c.type="post",e.next=5,i.addBindQualifications(c);case 5:i.onTipCancel();case 6:case"end":return e.stop()}},o)})),this.onTipChange=o=>{this.setState({tipValue:o.target.value})},this.resetPageInfo=()=>{this.initRef&&this.initRef.current&&this.initRef.current.resetForm(),this.setState({initialValues:{qualification_need:1,name:"",level:"",classify_id:"",educational_background:"",experience:"",post_emphasis_task:[],post_emphasis_certificate:[],post_qualifications_ability_classify:[],post_id_list:[],post_name_list:[],post_status:1,platform_certificate_list:[],post_emphasis_contribute:[]}})},this.addBindQualifications=function(){var o=(0,R.Z)(k().mark(function u(v){var m,c,d,e,n,h,p,s,g;return k().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return m=i.props,c=m.t,d=m.enterprise_id,e=m.postId,n=m.postCourseId,h=m.setLoading,D.prev=1,p=i.state.pageSource,D.next=5,(0,ve.W7)(v);case 5:if(s=D.sent,s.data.code!==0){D.next=15;break}if(!p){D.next=12;break}b.default.success(c("common.releaseSuccess")),W.m8.push("/talentedDevelopment/postTrainPlan/postQualifications"),D.next=15;break;case 12:return g={enterprise_id:d,id:n,post_id:e,qualification_id:s.data.data,type:"put",qualification_need:i.props.qualification_need},D.next=15,i.bindQualifications(g,i.props.addStep);case 15:return D.prev=15,h&&h(!1),i.setState({isLoading:!1}),D.finish(15);case 19:case"end":return D.stop()}},u,null,[[1,,15,19]])}));return function(u){return o.apply(this,arguments)}}(),this.bindQualifications=function(){var o=(0,R.Z)(k().mark(function u(v,m){var c,d,e,n,h;return k().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return c=i.props,d=c.changeStep,e=c.itemStepInfo,n=c.setLoading,s.prev=1,s.next=4,(0,ve.DI)(v);case 4:h=s.sent,h.data.code===0&&(i.props.qualification_need&&i.props.dispatch({type:"personnelDevelope/update",payload:{qualificationId:v.qualification_id}}),e?d():m());case 6:return s.prev=6,n&&n(!1),i.setState({isLoading:!1}),s.finish(6);case 10:case"end":return s.stop()}},u,null,[[1,,6,10]])}));return function(u,v){return o.apply(this,arguments)}}(),this.getQualificationData=(o,u,v,m)=>{var c=this.state,d=c.initialValues,e=c.isHideSelectPost,n=Z.parse(W.m8.location.search),h=n.copy,p=W.m8.location.pathname.indexOf("postQualifications/add");(0,ve.XK)(o).then(s=>{var g=[],P=s.data.data;(p&&v||!u)&&(g=P.post_name_list),p&&e&&!v&&(g=[]),p&&e&&v&&(g=this.state.post_name_list),h==="true"&&(g=[]);var D=(0,r.Z)((0,r.Z)({},d),{},{name:m==="copy"||h==="true"?"copy-".concat(P.name):P.name,level:P.level,classify_id:P.classify_id,experience:P.experience?P.experience.toString():"",post_emphasis_task:P.emphasis_task_list,post_emphasis_certificate:P.emphasis_certificate_list.map(($,G)=>(0,r.Z)((0,r.Z)({},$),{},{sort:G})),post_qualifications_ability_classify:P.ability_classify_list,educational_background:P.educational_background?P.educational_background.toString():"",post_name_list:g,post_status:P.status,platform_certificate_list:P.platform_certificate_list.map(($,G)=>(0,r.Z)((0,r.Z)({},$),{},{sort:G}))||[],post_emphasis_contribute:P.emphasis_contribute_list});u&&(D.qualification_need=u);var K={initialValues:D,requested:!0,validateLabel:P.ability_classify_list.length!==0};p&&o&&!u&&!v&&(K.post_name_list=P.post_name_list),this.setState(K)})},this.getQualificationsInfo=o=>(0,ve.F6)(o),this.getClassifyData=(o,u)=>{var v=this.state.initialValues,m=this.props.enterprise_id;(0,ve.zX)(m).then(c=>{var d={classifyInfo:c.data.data.childes};o&&(d=(0,r.Z)((0,r.Z)({},d),{},{initialValues:(0,r.Z)((0,r.Z)((0,r.Z)({},v),u),{},{classify_id:o}),requested:!0})),this.setState(d)})},this.getClassifyInfo=(o,u)=>{o?this.setState({requested:!1},()=>{this.getClassifyData(o,u)}):this.getClassifyData()},this.contrastChange=function(){var o=(0,R.Z)(k().mark(function u(v){var m,c,d,e,n,h,p,s,g;return k().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return m=i.state.configModal,c=i.props,d=c.postId,e=c.qualificationId,n=c.qualification_need,h=c.postCourseId,D.next=4,(0,ve.lc)(v);case 4:if(p=D.sent,!p.data.data.identical){D.next=11;break}return s={enterprise_id:v.enterprise_id,id:h,post_id:d,qualification_id:e,type:"put",qualification_need:n},D.next=9,i.bindQualifications(s,i.props.addStep);case 9:D.next=15;break;case 11:return D.next=13,i.getQualificationsToPost();case 13:g=D.sent,i.setState({configModal:(0,r.Z)((0,r.Z)({},m),{},{visible:!0,content:i.renderTip(g.join(","))})});case 15:case"end":return D.stop()}},u)}));return function(u){return o.apply(this,arguments)}}(),this.getQualificationsToPost=(0,R.Z)(k().mark(function o(){var u,v,m,c,d;return k().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u=i.props,v=u.qualificationId,m=u.postId,c={qualification_id:v,post_id:m},n.next=4,(0,ve.Sw)(c);case 4:if(d=n.sent,!(d&&d.data.code===0)){n.next=7;break}return n.abrupt("return",d.data.data);case 7:return n.abrupt("return",[]);case 8:case"end":return n.stop()}},o)})),this.renderTitleButton=()=>t().createElement(oe.Z,{iconClass:"iconf-help",size:"12px",color:"#fff"}),this.renderTip=o=>{var u=this.props.t;return t().createElement("div",{className:"qualification-tip"},t().createElement("p",null,u("personnelDevelope.qualificationContrastTitle")),o?t().createElement("p",null,u("personnelDevelope.qualificationContrastDesc")):"",t().createElement("p",null,o),t().createElement(L.ZP.Group,{onChange:this.onTipChange,size:"small",defaultValue:"add"},t().createElement(L.ZP,{value:"add"},u("personnelDevelope.addQualification")),t().createElement(L.ZP,{value:"rewrite"},u("personnelDevelope.editQualification"))))},this.renderFieldName=o=>{var u=o.name,v=o.text;return t().createElement("div",{style:{display:"inline-block"}},t().createElement("span",null,u),t().createElement(A.Z,{placement:"top",title:v},t().createElement("span",null,t().createElement(oe.Z,{iconClass:"iconf-help"}))))},this.renderFooter=()=>{var o=this.props.t,u=this.state,v=u.isView,m=u.isLoading;return t().createElement("footer",{className:"cl-form-fixed-footer"},t().createElement("div",{className:"cl-form-fixed-footer__container"},t().createElement(E.Z,{onClick:this.onBack},o("common.cancel")),v?"":t().createElement(E.Z,{loading:m,type:"primary",onClick:this.onPropsSubmit},o("common.save"))))},this.renderName=()=>{var o=this.props.t;return t().createElement(E.Z,{type:"link",onClick:this.onAddClassTag},t().createElement(oe.Z,{iconClass:"icon-icon_addx"}),o("component.newClassify"))},this.initRef=t().createRef(),this.state={formLayout:{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:18}}},educationInfo:[],experienceInfo:[],classifyInfo:[],pageSource:"",initialValues:{qualification_need:this.props.qualification_need,name:"",level:"",classify_id:"",educational_background:"",experience:"",post_emphasis_task:[],post_emphasis_certificate:[],post_qualifications_ability_classify:[],post_id_list:[],post_name_list:[],post_status:1,platform_certificate_list:[],post_emphasis_contribute:[]},requested:!1,isView:!1,sourceVisible:!1,componentsList:[{key:"qualification",component:Y,tab:f.t("personnelDevelope.chooseQualification"),props:{},init:"qualificationInit"}],activeKey:"qualification",isSetQualification:this.props.qualification_need===1,isClick:this.props.qualification_need===1,tipValue:"add",configModal:{visible:!1,title:f.t("localStorage.tip"),renderType:"text"},submitData:"",isLoading:!1,isHideSelectPost:!1,post_name_list:[]}}componentDidMount(){this.props.getFormRef&&this.props.getFormRef(this.initRef);var f=Z.parse(W.m8.location.search),i=f.id,o=f.view,u=this.props.qualificationId;o&&this.setState({isView:!0}),W.m8.location.pathname.indexOf("postQualifications/add")!==-1?(this.setState({pageSource:"qualifications",isSetQualification:!0,isClick:!0}),i?this.getQualificationData(i):(this.resetPageInfo(),this.setState({requested:!0}))):u?this.getQualificationData(u):this.setState({requested:!0}),this.getClassifyInfo(),Promise.all([this.getQualificationsInfo("education"),this.getQualificationsInfo("experience")]).then(v=>{this.setState({educationInfo:v[0].data.sys_dicts,experienceInfo:v[1].data.sys_dicts})})}render(){var f=this.state,i=f.pageSource,o=f.initialValues,u=f.formLayout,v=f.educationInfo,m=f.experienceInfo,c=f.classifyInfo,d=f.requested,e=f.isView,n=f.sourceVisible,h=f.componentsList,p=f.activeKey,s=f.isSetQualification,g=f.isClick,P=f.configModal,D=this.props.t;return t().createElement("div",{className:i?"panel-form-qualifications":"panel-second"},i?t().createElement(gt.Z,{title:D("personnelDevelope.addQualification")}):"",t().createElement("div",{className:i?"panel-form qualifications":"panel-form"},d?t().createElement(y.J9,{ref:this.initRef,initialValues:o,onSubmit:this.onSubmit,render:K=>t().createElement(y.l0,{className:"post-info-form"},t().createElement("div",null,t().createElement("div",{className:"post-qualification-baseInfo-content"},t().createElement("div",{className:"post-qualification-baseInfo"},D("exam.basicInformation")),t().createElement("div",{className:"post-field-content"},i?"":t().createElement(y.gN,(0,w.Z)({name:"qualification_need",component:S,label:this.renderFieldName({name:D("personnelDevelope.isSetQualification"),text:D("personnelDevelope.isSetQualificationInfo")}),required:!0,defaultValue:K.values.qualification_need,onRadioChange:this.onRadioChange,isView:e},u)),s?t().createElement(t().Fragment,null,t().createElement(y.gN,(0,w.Z)({name:"name",component:ft,label:D("personnelDevelope.qualifications"),required:!0,defaultValue:K.values.name,placeholder:D("personnelDevelope.placeholder.qualifications"),style:{width:"320px"},validate:Ge.Z.noEmpty,maxLength:50},u,{type:"text",isView:e,isClick:g,onSelect:this.onSelect})),t().createElement(y.gN,(0,w.Z)({name:"classify_id",component:je,label:D("personnelDevelope.selectCategory"),required:!0,value:K.values.classify_id,displayType:"Custom",validate:Ge.Z.noEmpty,placeholder:D("validation.checkClassify"),style:{width:"320px"},showAdd:!0,classifyData:c,getClassifyData:this.getClassifyInfo},u,{isView:e})),t().createElement(y.gN,(0,w.Z)({name:"level",label:D("personnelDevelope.level"),component:de.Z,placeholder:D("personnelDevelope.placeholder.level"),style:{width:"320px"},defaultValue:K.values.level},u,{maxLength:50,isPreview:e,type:"text"})),i?t().createElement(y.gN,(0,w.Z)({name:"post_name_list",component:Et,label:this.renderFieldName({name:D("course.jobs"),text:D("personnelDevelope.postNameListTip")}),value:K.values.post_name_list},u,{isView:e})):""):"")),s?t().createElement("div",{className:"post-qualification-prerequisite-content"},t().createElement("div",{className:"post-qualification-prerequisite"},D("personnelDevelope.jobRequirements")),t().createElement("div",{className:"post-field-content"},t().createElement(y.gN,(0,w.Z)({name:"educational_background",label:D("personnelDevelope.educationalBackground"),component:ot.Z,placeholder:D("personnelDevelope.placeholder.educationalBackground"),style:{width:"160px"}},u,{defaultValue:K.values.educational_background,data:v,isView:e})),t().createElement(y.gN,(0,w.Z)({name:"experience",label:D("personnelDevelope.experience"),component:ot.Z,placeholder:D("personnelDevelope.placeholder.experience"),style:{width:"160px"}},u,{defaultValue:K.values.experience,data:m,isView:e})),t().createElement(y.gN,(0,w.Z)({name:"post_qualifications_ability_classify",label:this.renderFieldName({name:D("personnelDevelope.abilityClassify"),text:D("personnelDevelope.abilityClassifyInfo")}),component:Oe,displayType:"Custom",validate:Ge.Z.validateLabel,abilityClassifyData:K.values.post_qualifications_ability_classify},u,{isView:e})),t().createElement(y.gN,(0,w.Z)({name:"post_emphasis_task",label:D("personnelDevelope.keyTask"),component:Je,displayType:"Custom",data:K.values.post_emphasis_task},u,{isView:e})),t().createElement(y.gN,(0,w.Z)({name:"post_emphasis_certificate",label:D("personnelDevelope.requiredCertificates"),component:et,displayType:"Custom",data:K.values.post_emphasis_certificate},u,{chooseCertificateData:K.values.platform_certificate_list,isView:e})),t().createElement(y.gN,(0,w.Z)({name:"post_emphasis_contribute",label:this.renderFieldName({name:D("personnelDevelope.organizeContribute"),text:D("personnelDevelope.organizeContributeTip")}),component:mt,displayType:"Custom",data:K.values.post_emphasis_contribute},u,{isView:e})))):""))}):"",i?this.renderFooter():"",n?t().createElement(vt.Z,{visible:!0,componentsList:h,activeKey:p,onOk:this.onOk,onCancel:this.onSourceCancel,wrapClassName:"post-qualification-source-modal"}):"",P.visible?t().createElement(z.Z,{configModal:P,onCancel:this.onTipCancel,onConfirm:this.onTipConfirm}):""))}})||Ne)||Ne)||Ne),yt=(0,j.Z)()((0,y.$j)(Ct))},17883:function(ce,Q,a){"use strict";a.d(Q,{F6:function(){return V},zX:function(){return A},Cr:function(){return N},V2:function(){return L},W7:function(){return C},XK:function(){return b},ph:function(){return R},NU:function(){return r},sy:function(){return x},tC:function(){return k},e0:function(){return O},vq:function(){return t},iZ:function(){return l},cb:function(){return W},DI:function(){return j},lc:function(){return y},Sw:function(){return z},cw:function(){return B},TR:function(){return _}});var w=a(88986),I=a(37055),E=a(10237);function V(M){var T=I.ZP.personnelDevelope.getQualificationsInfo(),Y={key:M};return E.WY.get({url:T,params:Y})}function A(M){var T=I.ZP.personnelDevelope.getQualificationsClassifyInfo(),Y={enterprise_id:M};return E.WY.post({url:T,data:Y})}function N(M,T,Y){var U=I.ZP.personnelDevelope.addQualificationsClassify(),X={enterprise_id:M,parent_id:T,name:Y};return E.WY.post({url:U,data:X})}function L(M){var T=M.page_number,Y=M.page_size,U=M.name,X=M.ability_type,se=M.source,ee=I.ZP.PostTalentEvaluation.getEvaluateList(),ae={page_number:T,page_size:Y,need_levels:!0,name:U,ability_type:X,source:se};return E.WY.get({url:ee,params:ae})}function C(M){var T=I.ZP.personnelDevelope.addQualifications(),Y=(0,w.Z)({},M);return Y.type==="put"?E.WY.put({url:T,data:Y}):E.WY.post({url:T,data:Y})}function b(M){var T=I.ZP.personnelDevelope.getQualificationData(M);return E.WY.get({url:T})}function R(M){var T=I.ZP.personnelDevelope.getProjectList();return E.WY.get({url:T,params:(0,w.Z)({},M)})}function r(M){var T=I.ZP.personnelDevelope.getProjectInfo(M);return E.WY.get({url:T})}function x(M){var T=I.ZP.personnelDevelope.getPostInfo(M);return E.WY.get({url:T})}function k(M){var T=I.ZP.personnelDevelope.getPostCourseInfo(M);return E.WY.get({url:T})}function O(M){var T=I.ZP.personnelDevelope.addPostInfo(),Y=M;return Y.type==="put"?E.WY.put({url:T,data:Y}):E.WY.post({url:T,data:Y})}function t(M){var T=I.ZP.personnelDevelope.addPostInfos(M);return E.WY.get({url:T})}function l(M){var T=I.ZP.personnelDevelope.qualifications(M);return E.WY.get({url:T})}function W(M){var T=I.ZP.personnelDevelope.bindProject();return E.WY.put({url:T,data:M})}function j(M){var T=I.ZP.personnelDevelope.bindQualification();return E.WY.put({url:T,data:M})}function Z(M){var T=CONFIG.personnelDevelope.issueCourse(M);return request.put({url:T})}function y(M){var T=I.ZP.personnelDevelope.comparison();return E.WY.put({url:T,data:M})}function z(M){var T=I.ZP.personnelDevelope.getQualificationsToPost(M.qualification_id);return E.WY.get({url:T,params:{post_id:M.post_id}})}function B(M){var T=M.id,Y=M.type,U=I.ZP.personnelDevelope.getStudyProject(),X={id:T};return Y&&(X.type=Y),E.WY.get({url:U,params:X})}function _(M){var T=I.ZP.StudyProjectList.getProjectInfo(M);return E.WY.get({url:T})}function S(M){var T=CONFIG.CertificateDetail.getInfo();return request.get({url:T,params:{id:M}})}function F(M){var T=CONFIG.personnelDevelope.postDeleteStudyInfo(M);return request.delete({url:T})}},48206:function(ce,Q,a){"use strict";var w=a(93485),I=a(3407),E=a(6793),V=(0,E.me)(),A=I.Z[V].personnelDevelope.validation.requiredNotBlank;Q.Z={noEmpty:N=>{var L;return(0,E.fy)(N)||(L=A),L},validateLabel:N=>{if(!N)return!0;var L,C=(0,w.Z)(N),b;try{for(C.s();!(b=C.n()).done;){var R=b.value;if(R.post_qualifications_ability.length===0){L=A;break}}}catch(r){C.e(r)}finally{C.f()}return L}}},85853:function(ce,Q,a){"use strict";a.d(Q,{lC:function(){return A},cc:function(){return L},ww:function(){return x},zZ:function(){return k},EW:function(){return O},NV:function(){return t},HY:function(){return l},Qs:function(){return W},wW:function(){return j},Ek:function(){return Z},Yn:function(){return y},MM:function(){return z},Ej:function(){return B}});var w=a(37055),I=a(10237);function E(_){var S=CONFIG.submitReport.reportManageList();return request.get({url:S,params:_})}function V(_){var S=CONFIG.personnelDevelope.qualification_id();return request.delete({url:S,params:_})}function A(_){var S=w.ZP.personnelDevelope.qualificationsDisable(_.id);return I.WY.get({url:S,params:_})}function N(_){var S=CONFIG.personnelDevelope.qualificationsDelete(_.id);return request.delete({url:S,params:_})}function L(_){var S=w.ZP.personnelDevelope.qualificationsList();return I.WY.post({url:S,data:_})}function C(_){var S=CONFIG.personnelDevelope.postRanks();return request.post({url:S,params:_})}function b(_){var S=CONFIG.personnelDevelope.postRanks();return request.put({url:S,params:_})}function R(_){var S=CONFIG.personnelDevelope.postRanksDelete();return request.put({url:S,params:_})}function r(_){var S=CONFIG.personnelDevelope.find_structure();return request.get({url:S,params:_})}function x(){var _=w.ZP.personnelDevelope.getUserPosts();return I.WY.get({url:_})}function k(_){var S=_.post_id,F=_.post_name,M=w.ZP.personnelDevelope.getUserPostsChannel(S);return I.WY.get({url:M,params:{post_name:F}})}function O(_){var S=_.qualification_id,F=_.type,M=w.ZP.personnelDevelope.certTaskInfo(S);return I.WY.get({url:M,params:{type:F}})}function t(){var _=w.ZP.personnelDevelope.configList();return I.WY.get({url:_,params:{enterprise_id:window.localStorage.getItem("enterpriseId")}})}function l(_){var S=_.qualification_id,F=_.page_size,M=_.page_number,T=w.ZP.personnelDevelope.qualificationPostList();return I.WY.get({url:T,params:{qualification_id:S,page_size:F,page_number:M}})}function W(_){var S=_.qualification_id,F=_.post_id_list,M=w.ZP.personnelDevelope.checkPostAbilityModel();return I.WY.post({url:M,data:{qualification_id:S,post_id_list:F,enterprise_id:w.ZP.enterpriseId}})}function j(_){var S=_.qualification_id,F=_.post_id_list,M=w.ZP.personnelDevelope.submitPostAbilityModel();return I.WY.post({url:M,data:{qualification_id:S,post_id_list:F,enterprise_id:w.ZP.enterpriseId}})}function Z(_){var S=w.ZP.personnelDevelope.deleteQualification(_);return I.WY.delete({url:S})}function y(_){var S=w.ZP.personnelDevelope.unbindPost(_);return I.WY.delete({url:S})}function z(_){var S=_.qualification_id,F=_.type,M=w.ZP.personnelDevelope.showInfoDetail(S,F);return I.WY.get({url:M})}function B(_){var S=w.ZP.personnelDevelope.deletePostCheck(_);return I.WY.get({url:S})}},91648:function(ce,Q,a){"use strict";a.d(Q,{Z:function(){return w}});function w(I,E){var V,A,N,L,V;if(A="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),V=[],N=void 0,E=E||A.length,I)for(N=0;N<I;)V[N]=A[0|Math.random()*E],N++;else for(L=void 0,V[8]=V[13]=V[18]=V[23]="-",V[14]="4",N=0;N<36;)V[N]||(L=0|Math.random()*16,V[N]=A[N===19?L&3|8:L]),N++;return V.join("")}},65202:function(ce,Q,a){"use strict";a.d(Q,{p:function(){return w}});function w(){return localStorage.getItem("themeColor")||"#516AE6"}},25547:function(ce,Q,a){"use strict";a.d(Q,{Yd:function(){return E},VX:function(){return A},lK:function(){return N},NP:function(){return L}});var w=a(88986),I=a(93485);function E(C,b,R){var r=0;function x(k,O){for(var t=0;t<k.length;t++){var l=k[t];if(l[C]===b){r=O;break}else l.children instanceof Array&&l.children.length&&x(l.children,O+1)}}return x(R,1),r}function V(C){var b=1;function R(r,x){r.forEach(k=>{x>b&&(b=x),k.children&&k.children.length>0&&R(k.children,x+1)})}return R(C,1),b}function A(C,b,R){C.forEach((r,x,k)=>{if(r.id===b)return R(r,x,k);if(r.children)return A(r.children,b,R)})}function N(C,b){var R;function r(x){var k=(0,I.Z)(x),O;try{for(k.s();!(O=k.n()).done;){var t=O.value;if(t.id==b){R={id:t.id,name:t.name,children:t.children,parentId:t.parentId};break}t.children&&t.children instanceof Array&&t.children.length>0&&r(t.children)}}catch(l){k.e(l)}finally{k.f()}}return r(C),R?(0,w.Z)((0,w.Z)({},R),{},{children:R.children instanceof Array?R.children:[]}):{children:[],id:"",name:""}}var L=function(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"children",x=[...b];function k(O){Object.keys(R).forEach(t=>{var l=t,W=R[t];O[W]=O[l],O[r]=O[r]&&O[r]instanceof Array?[...O[r]]:[],O[r].length?O[r].forEach(j=>{k(j)}):delete O[r]})}return x.forEach(O=>k(O)),x}},2396:function(ce,Q,a){"use strict";a.d(Q,{fA:function(){return E},kh:function(){return V},kR:function(){return A},rw:function(){return L},$s:function(){return C},q_:function(){return b},QK:function(){return R}});var w=a(6793),I={limitWords(r,x){return{rules:[{max:r,message:"\u6700\u591A\u8F93\u5165".concat(r,"\u4E2A\u5B57")},{required:!0,message:x||"\u8BF7\u8F93\u5165\u9700\u8981\u7684\u5185\u5BB9!",whitespace:!0}]}},limitTagsLength(r){return{rules:[{max:r,message:"\u6700\u591A\u8F93\u5165".concat(r,"\u4E2A\u6807\u7B7E")}]}},required(r){return{rules:[{required:!0,message:r||"\u8BF7\u8F93\u5165\u9700\u8981\u7684\u5185\u5BB9!",whitespace:!0}]}},requiredWithValidator(r,x){return{rules:[{required:!0,message:r||"\u8BF7\u8F93\u5165\u9700\u8981\u7684\u5185\u5BB9!",whitespace:!0,validator:x}]}}},E={score:/^\+?[0-9]*$/,positiveInteger:/^[1-9]\d*$/,examScore:/^[0-9]+([.]\d{1})?$/,url:/^(https?:\/\/)([0-9a-z.]+)(:[0-9]+)?([/0-9a-z.]+)?(\?[0-9a-z&=]+)?(#[0-9-a-z]+)?/,httpsUrl:/(^https):\/\/([\w.]+\/?)\S*/,tagName:/^[\s　]|[ ]$/gi},V=r=>isNaN(r)||!r||!(r>=0&&r<1e3)||!E.score.test(r),A=r=>isNaN(r)||!r||!(r>-1e3&&r<1e3),N=r=>isNaN(r)||!r||!(r>=0&&r<1e3)||!E.examScore.test(r),L=(r,x)=>{for(var k=0,O=0;O<r.length;O++){var t=r.charAt(O);if(t.match(/[^\x00-\xff]/ig)!=null?k+=1:k+=.5,k>x)return O}return 0},C=r=>{for(var x=0,k=0;k<r.length;k++){var O=r.charAt(k);O.match(/[^\x00-\xff]/ig)!=null?x+=1:x+=.5}return x},b=(r,x)=>{var k=r.target.value,O=r.target.dataset.originLength;if(r.target.dataset.originLength||(O=x,r.target.dataset.originLength=O),!!O){var t=C(k);t*1<x*1?r.target.setAttribute("maxLength",x*2):r.target.setAttribute("maxLength",x)}},R=(r,x)=>{var k="";return(!r||!(0,w.fy)(r))&&(k=x),k}}}]);
