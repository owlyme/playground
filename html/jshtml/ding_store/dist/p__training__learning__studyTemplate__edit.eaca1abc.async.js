(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[5895],{53009:function(fe,se,s){"use strict";s.d(se,{TD:function(){return S},$S:function(){return R},aI:function(){return de},Bg:function(){return L},tT:function(){return ae},XN:function(){return M},YK:function(){return W},$x:function(){return Y}});var U=s(81211),a=s(88986),J=s(78138),h=s.n(J),le=s(78001),O=s(76651),re=s(38642),b=s(6793),c=s(37055),u=s(75205);function p(i){return i.map(_=>({name:_.name,id:_.id,proportion:0,disabled:_.totalCount===0||_.total_count===0}))}function P(i,_){return _.map((k,v)=>(0,a.Z)((0,a.Z)({},i[v]),{},{disabled:k.total_count===0}))}var A=i=>{var _=0,k=i.checkedValue,v=i.fillBlank,d=i.shortAnswer;return k===2?v.checked&&!d.checked?_=3:!v.checked&&d.checked?_=4:_=2:_=1,_},f=i=>{for(var _ in i)i[(0,re.FI)(_)]=i[_];return i},S=(i,_,k,v,d,n)=>{var e=i.map((t,E)=>{var T=t.list.map((r,o)=>{var m,l=r.data,B={};switch(r.componentName){case"CoursewareSelector":B={courseId:r.id,courseSort:o,courseType:3,flag:1,mappingId:r.mappingId?r.mappingId:""};break;case"CourseSelector":B={courseId:r.id,courseSort:o,courseType:1,flag:1,mappingId:r.mappingId?r.mappingId:""};break;case"AddExam":B={courseSort:o,title:l.title,type:"ex",cheatFlag:l.cheatFlag.isChecked?1:0,faceRecognition:l.cheatFlag.faceRecognition,examDuration:l.examDuration,summary:l.summary,flag:2,mappingId:r.mappingId?r.mappingId:"",courseId:r.id,markType:A(l.markType),paperId:l.questionsMode===1?l.fixedQuestion.id:"",paperTitle:l.questionsMode===1?l.fixedQuestion.name:"",passLine:l.passLine,questionBankList:l.questionsMode===1?"":l.randomQuestion.bankQuesitonVoList.map(ie=>ie.id).join(","),questionMode:l.questionsMode,showKnowledge:l.knowledgePoints===1?"show":"hide",repeatExam:l.reExam.isChecked,multipleCount:l.questionsMode===1?"":l.randomQuestion.bankQuesitonInfo.multipleCount,multipleUnitScore:l.questionsMode===1?"":l.randomQuestion.bankQuesitonInfo.multipleScore,fillBlankCount:l.questionsMode===1?"":l.randomQuestion.bankQuesitonInfo.fillBlankCount,fillBlankUnitScore:l.questionsMode===1?"":l.randomQuestion.bankQuesitonInfo.fillBlankScore,fillBlankType:l.questionsMode===1?1:l.randomQuestion.bankQuesitonInfo.fillBlankType,shortAnswerCount:l.questionsMode===1?"":l.randomQuestion.bankQuesitonInfo.shortAnswerCount,shortAnswerUnitScore:l.questionsMode===1?"":l.randomQuestion.bankQuesitonInfo.shortAnswerScore,shortAnswerType:l.questionsMode===1?1:l.randomQuestion.bankQuesitonInfo.shortAnswerType,singleCount:l.questionsMode===1?"":l.randomQuestion.bankQuesitonInfo.singleCount,singleUnitScore:l.questionsMode===1?"":l.randomQuestion.bankQuesitonInfo.singleScore,trueOrFalseCount:l.questionsMode===1?"":l.randomQuestion.bankQuesitonInfo.trueOrFalseCount,trueOrFalseUnitScore:l.questionsMode===1?"":l.randomQuestion.bankQuesitonInfo.trueOrFalseScore,multipleMissedScore:l.questionsMode===1?"":l.randomQuestion.bankQuesitonInfo.multipleMissedScore,totalScore:l.questionsMode===1?l.fixedQuestion.tableList.totalScore:"",answerParsing:l.reExam.isChecked?l.reExam.allowed.end:l.reExam.notAllowed.end,passingScore:l.questionsMode===1?Number(l.fixedQuestion.tableList.totalScore*l.passLine/100).toFixed(1):60,cutScreenCount:l.cheatFlag.switchNum!==null?l.cheatFlag.switchNum:-1,reExamRule:l.reExam.allowed.reRule,reExamNumber:l.reExam.allowed.reRule===2?l.reExam.allowed.reNum:0,scoreRule:l.reExam.allowed.record,viewRule:l.reExam.allowed.viewRule,proportional:l.questionsMode===2&&l.isOpenDrawQuestions?l.proportional:[],anonymousMarking:"".concat(l.markType.anonymousMarking),show_result:l.reExam.show_result};break;case"AddNewExam":var H=r.data,j=H.paperInfo,Q=H.exam_times,_e=H.cut_screen_times,ce=H.random_order,te=H.mark_setting,pe=H.result_visible,ye=H.face_recognition,Ce=(0,U.Z)(H,["paperInfo","exam_times","cut_screen_times","random_order","mark_setting","result_visible","face_recognition"]);B={courseSort:o,flag:15,courseType:15,type:"ex",courseId:r.id,mappingId:r.mappingId?r.mappingId:"",new_exam:(0,a.Z)((0,a.Z)((0,a.Z)({},Ce),(0,u.jJ)(ye)),{},{paper_id:j.id,answer_rule:Q.answer_rule,exam_count:Q.exam_count||1,cut_screen_rule:_e.cut_screen_rule,cut_screen_count:_e.cut_screen_count||1,cut_screen_interval:_e.cut_screen_interval||0,random_question:ce.random_question,random_options:ce.random_options,mark_type:te.mark_type,mark_question_type:{fill_blank:te.mark_type===u.lt.MANUAL?te.fill_blank:!1,short_answer:te.mark_type===u.lt.MANUAL?te.short_answer:!1},anonymous_marking:te.anonymous_marking,exam_certificate_id:"",supervisor_list:[],marker_list:[...te.marker_list.map(ie=>typeof ie=="string"?ie:ie.id)],result_view_rule:pe.result_view_rule,answer_parsing:pe.answer_parsing,ranking_list_view_rule:pe.ranking_list_view_rule,show_result:pe.show_result,reward_rule:null,authority_range:null,supervisor_mark:null})};break;case"OfflineTrain":B={courseSort:o,flag:3,id:_&&!d?r.id:"",type:"xx",mappingId:r.mappingId?r.mappingId:"",title:l.title,begin_time:h()(l.dateRange.startTime).valueOf(),end_time:h()(l.dateRange.endTime).valueOf(),attachment:l.attachment.map(ie=>ie.id),course_duration:l.course_duration||"",lecturer_id:l.teacher.id,is_lecturer_confirm:!!l.teacher.is_lecturer_confirm,is_lecturer_subsidy:!!l.teacher.is_lecturer_subsidy,address:l.address,introduction:l.introduction,is_open_offline_assessment:l.assess.is_open_offline_assessment,is_open_upload:l.other.is_open_upload,is_open_schedule:!1,remind_type:l.remind.remind_type,advance_minute:l.remind.advance_minute?Number(l.remind.advance_minute):0,is_lecturer_remind:l.remind.is_lecturer_remind,is_student_remind:l.remind.is_student_remind,is_lecturer_student_evaluate:l.evaluate.is_lecturer_student_evaluate,is_student_lecturer_evaluate:l.evaluate.is_student_lecturer_evaluate,is_student_course_evaluate:l.evaluate.is_student_course_evaluate,lecturer_student_evaluate_content:l.evaluate.lecturer_student_evaluate_content,student_lecturer_evaluate_content:l.evaluate.student_lecturer_evaluate_content,student_course_evaluate_content:l.evaluate.student_course_evaluate_content,assessment_total_score:l.assess.assessment_total_score,assessment_pass_score:l.assess.assessment_pass_score};break;case"AddInvestigate":k==="study"?B={courseSort:o,courseType:9,flag:4,id:r.id,questionnaireId:r.questionnaire.id,title:r.name,type:"questionnaire",mappingId:r.mappingId?r.mappingId:""}:B={courseId:r.id,courseType:9,flag:9,courseSort:o,investigate:{id:r.id,title:r.name,questionnaire_id:r.questionnaire.id}};break;case"AddPracticeTest":B={courseType:10,courseSort:o,flag:k==="study"?5:4,type:"sc",id:r.id,title:r.data.title,content:r.data.content||r.data.address,resources:r.data.attachment.map(ie=>({resourceId:ie.id})),scoreSetting:{scoreSwitch:r.data.mark.isFull?"on":"off",score:r.data.mark.value},workflowJson:r.data.workFlowTemplateId?{}:F(r.data.supervisor),mappingId:r.mappingId?r.mappingId:"",job_type:r.data.job_type,workFlowTemplateId:r.data.workFlowTemplateId};break;case"AddJobEvaluation":B={courseSort:o,flag:6,title:r.data.title,productId:r.data.evaluationTools.product_id,modelId:r.data.evaluationTools.model_id,id:r.id||"",mappingId:r.mappingId?r.mappingId:""};break;case"Attendance":B={courseSort:o,flag:13,id:_&&!d?r.id:"",type:"attendance",mappingId:r.mappingId?r.mappingId:"",title:l.title,directors:l.directors.map(ie=>typeof ie=="object"&&(ie.id||ie.user_id)?ie.id||ie.user_id:ie),name:l.name,qrcode_type:l.qrcode_type||"statics",sign_in_begin_time:l.sign_in_begin_time?h()(l.sign_in_begin_time).valueOf():"",sign_in_end_time:l.sign_in_end_time?h()(l.sign_in_end_time).valueOf():"",sign_out_begin_time:l.sign_out_begin_time?h()(l.sign_out_begin_time).valueOf():"",sign_out_end_time:l.sign_out_end_time?h()(l.sign_out_end_time).valueOf():"",relate_course:l.relate_course,relate_course_list:((m=l.relate_course_list)===null||m===void 0?void 0:m.length)>0?l.relate_course_list:[],remind_directors:l.remind_directors,advance_minute:l.advance_minute||0,qy_we_chat_vo:l.qy_we_chat_vo,address:l.address,longitude:l.longitude,latitude:l.latitude,address_detail:l.address_detail,sign_range:l.sign_range};break;case"AddAssessment":B=(0,a.Z)((0,a.Z)({},f(r.data)),{},{tutorId:n,courseSort:o,courseType:14,flag:14});break;default:break}return v==="unlock_mode"&&l.unlockingTime&&(B.unlockingTime=h()(l.unlockingTime).valueOf()),B.resource_lock=r.resource_lock||!1,B});return{content:t.desc,stageName:t.name,isOrder:t.inOrder,stageSort:E+1,stageId:_?t.stageId:"",startTime:v==="unlock_mode"&&t.studyTime?h()(t.studyTime[0]).valueOf():null,endTime:v==="unlock_mode"&&t.studyTime?h()(t.studyTime[1]).valueOf():null,course:T}});return e},R=i=>{var _=i.map((k,v)=>({content:k.desc,stage_name:k.name,is_order:k.inOrder,stage_sort:v+1,stage_id:k.stageId,resources:k.list.map((d,n)=>{var e=d.data;switch(d.componentName){case"CoursewareSelector":return{course_id:d.id,course_sort:n,course_type:3,flag:1,mappingId:d.mappingId};case"AddMentorCoaching":return{course_id:d.id,tutorials:{id:d.id,title:e.title,content:e.content,model:e.model,tutor_model:e.tutor_model,evaluation_type:e.evaluation_type,user_id:e.user_id||"",user_name:e.user_name||""},course_sort:n,course_type:12,flag:7,mappingId:d.mappingId};case"CourseSelector":return{course_id:d.id,course_sort:n,course_type:1,flag:1,mappingId:d.mappingId};case"AddExam":return{exam:{id:d.id,title:e.title,cheat_flag:e.cheatFlag.isChecked?1:0,exam_duration:e.examDuration,face_recognition:e.cheatFlag.faceRecognition,summary:e.summary,mark_type:A(e.markType),paper_id:e.questionsMode===1?e.fixedQuestion.id:"",paper_name:e.questionsMode===1?e.fixedQuestion.name:"",pass_line:e.passLine,question_banks:e.questionsMode===1?"":e.randomQuestion.bankQuesitonVoList.map(j=>j.id),question_mode:e.questionsMode,show_knowledge:e.knowledgePoints===1?"show":"hide",repeat_exam:e.reExam.isChecked,multiple_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.multipleCount,multiple_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.multipleScore,fill_blank_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.fillBlankCount,fill_blank_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.fillBlankScore,fill_blank_type:e.questionsMode===1?1:e.randomQuestion.bankQuesitonInfo.fillBlankType,short_answer_type:e.questionsMode===1?1:e.randomQuestion.bankQuesitonInfo.shortAnswerType,short_answer_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.shortAnswerCount,short_answer_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.shortAnswerScore,single_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.singleCount,single_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.singleScore,multiple_missed_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.multipleMissedScore,true_or_false_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.trueOrFalseCount,true_or_false_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.trueOrFalseScore,total_score:e.questionsMode===1?e.fixedQuestion.tableList.totalScore:"",answer_parsing:e.reExam.isChecked?e.reExam.allowed.end:e.reExam.notAllowed.end,passing_score:e.questionsMode===1?Number(e.fixedQuestion.tableList.totalScore*e.passLine/100).toFixed(1):60,cut_screen_count:e.cheatFlag.switchNum!==null?e.cheatFlag.switchNum:-1,re_exam_rule:e.reExam.allowed.reRule,re_exam_number:e.reExam.allowed.reRule===2?e.reExam.allowed.reNum:0,score_rule:e.reExam.allowed.record,view_rule:e.reExam.allowed.viewRule,proportional:e.questionsMode===2&&e.isOpenDrawQuestions?e.proportional:[],anonymous_marking:"".concat(e.markType.anonymousMarking),show_result:e.reExam.show_result},flag:2,course_sort:n,course_id:d.id,course_type:6,mappingId:d.mappingId};case"AddNewExam":var t=d.data,E=t.paperInfo,T=t.exam_times,r=t.cut_screen_times,o=t.random_order,m=t.mark_setting,l=t.result_visible,B=t.face_recognition,H=(0,U.Z)(t,["paperInfo","exam_times","cut_screen_times","random_order","mark_setting","result_visible","face_recognition"]);return{course_sort:n,flag:15,type:"ex",course_id:d.id,course_type:15,mappingId:d.mappingId?d.mappingId:"",new_exam:(0,a.Z)((0,a.Z)((0,a.Z)({},H),(0,u.jJ)(B)),{},{paper_id:E.id,answer_rule:T.answer_rule,exam_count:T.exam_count||1,cut_screen_rule:r.cut_screen_rule,cut_screen_count:r.cut_screen_count||1,cut_screen_interval:r.cut_screen_interval||0,random_question:o.random_question,random_options:o.random_options,mark_type:m.mark_type,mark_question_type:{fill_blank:m.mark_type===u.lt.MANUAL?m.fill_blank:!1,short_answer:m.mark_type===u.lt.MANUAL?m.short_answer:!1},anonymous_marking:m.anonymous_marking,exam_certificate_id:"",supervisor_list:[],marker_list:[...m.marker_list.map(j=>typeof j=="string"?j:j.id)],result_view_rule:l.result_view_rule,answer_parsing:l.answer_parsing,ranking_list_view_rule:l.ranking_list_view_rule,show_result:l.show_result,reward_rule:null,authority_range:null,supervisor_mark:null})};case"AddPracticeTest":return{operation:{id:d.id,title:d.data.title,content:d.data.content||d.data.address,type:"sc",resources:d.data.attachment.map(j=>({resourceId:j.id})),score_setting:{scoreSwitch:d.data.mark.isFull?"on":"off",score:d.data.mark.value},workflow_json:F(d.data.supervisor),sort:n,job_type:d.data.job_type},course_type:10,course_sort:n,flag:5,mappingId:d.mappingId};case"AddInvestigate":return{course_id:d.id,course_type:9,flag:4,course_sort:n,investigate:{id:d.id,title:d.name,questionnaire_id:d.questionnaire.id}};default:return null}})}));return _};function F(i){var _=[];if(i.type==="multilevel"){var k=i.multilevel;k.forEach(v=>{var d=[];v.forEach(n=>{d.push(n.id)}),_.push(d.join(","))})}else i.type==="or"?(i.or.forEach(v=>{_.push(v.id)}),_=[_.join(",")]):_=[];return{type:i.type,userIds:_}}var de=i=>{function _(n){if(n.questionMode===1){if(n.paperVo.fillBlankCount>0||n.paperVo.shortAnswerCount>0)return!0}else if(n.fillBlankCount>0||n.shortAnswerCount>0)return!0;return!1}function k(n){if(n.questionMode===1){if(n.paperVo.fillBlankCount>0)return!0}else if(n.fillBlankCount>0)return!0;return!1}function v(n){if(n.questionMode===1){if(n.paperVo.shortAnswerCount>0)return!0}else if(n.shortAnswerCount>0)return!0;return!1}var d=i.map((n,e)=>({key:"".concat(new Date().getTime()).concat(e),desc:n.content,name:n.stageName,inOrder:n.isOrder,stageId:n.id,studyTime:n.startTime?[h()(n.startTime),h()(n.endTime)]:["",""],list:n.courseMappingList.map(t=>{var E,T,r=t.planExamVos,o={},m,l;switch(t.flag){case 1:t.contentType==="audio/mp3"||t.contentType==="audio/mpeg"||t.contentType==="audio"?(l="mp3",m="mp3"):(l=t.type,m=t.type==="imageText"?"h5":t.type),o={id:t.courseId,name:t.name,type:t.courseType===1?"course":"courseware",icon:c.e1[m],originalType:l,componentName:t.courseType===1?"CourseSelector":"CoursewareSelector",status:t.courseType===1?"0":t.status,duration:t.duration,data:t,mappingId:t.mappingId};break;case 2:o={id:t.id,name:t.name,type:"ex",icon:c.e1.ex,componentName:"AddExam",duration:r.examDuration*60,data:{title:r.title,examDuration:r.examDuration,summary:r.summary,isOpenDrawQuestions:r.proportionalExamVos&&r.proportionalExamVos.length>0,proportional:r.proportionalExamVos&&(r.proportionalExamVos.length>0?P(r.proportionalExamVos,r.bankQuesitonVoList):r.questionMode===2?p(r.bankQuesitonVoList):[])||[],cheatFlag:{isChecked:!!r.cheatFlag,switchNum:r.cutScreenCount===-1?null:r.cutScreenCount,faceRecognition:r.faceRecognition},reExam:{show_result:r.show_result,isChecked:r.repeatExam,userJoin:r.user_join==="true",notAllowed:{end:r.answerParsing},allowed:{reRule:r.reExamRule,record:r.scoreRule,end:r.answerParsing,reNum:r.reExamRule===2?r.reExamNumber:1,viewRule:r.viewRule}},markType:{checkedValue:r.markType===1?1:2,artificialDisabled:r.markType===1&&!_(r),fillBlank:{checked:(r.markType===2||r.markType===3)&&k(r),disabled:!k(r)},shortAnswer:{checked:(r.markType===2||r.markType===4)&&v(r),disabled:!v(r)},anonymousMarking:r.anonymous_marking==="true"},questionsMode:r.questionMode,knowledgePoints:r.showKnowledge==="show"?1:2,passLine:r.passLine,fixedQuestion:r.questionMode===1?{id:r.paperVo.id,name:r.paperVo.title,tableList:{fillBlankCount:r.paperVo.fillBlankCount,fillBlankScore:r.paperVo.fillBlankScore,multipleCount:r.paperVo.multipleCount,multipleScore:r.paperVo.multipleScore,shortAnswerCount:r.paperVo.shortAnswerCount,shortAnswerScore:r.paperVo.shortAnswerScore,singleCount:r.paperVo.singleCount,singleScore:r.paperVo.singleScore,totalCount:r.paperVo.totalCount,totalScore:r.paperVo.totalScore,trueOrFalseCount:r.paperVo.trueOrFalseCount,trueOrFalseScore:r.paperVo.trueOrFalseScore}}:{id:"",name:"",tableList:{fillBlankCount:0,fillBlankScore:0,multipleCount:0,multipleScore:0,shortAnswerCount:0,shortAnswerScore:0,singleCount:0,singleScore:0,totalCount:0,totalScore:0,trueOrFalseCount:0,trueOrFalseScore:0}},randomQuestion:r.questionMode===2?{bankQuesitonVoList:r.bankQuesitonVoList.map(te=>({id:te.id,name:te.name,data:te})),bankQuesitonInfo:{fillBlankCount:r.fillBlankCount,fillBlankScore:r.fillBlankUnitScore,fillBlankType:+r.fillBlankType||1,multipleCount:r.multipleCount,multipleScore:r.multipleUnitScore,shortAnswerCount:r.shortAnswerCount,shortAnswerScore:r.shortAnswerUnitScore,shortAnswerType:+r.shortAnswerType||1,singleCount:r.singleCount,singleScore:r.singleUnitScore,trueOrFalseCount:r.trueOrFalseCount,trueOrFalseScore:r.trueOrFalseUnitScore,multipleMissedScore:r.multipleMissedScore}}:{bankQuesitonVoList:[],bankQuesitonInfo:{fillBlankCount:0,fillBlankScore:0,fillBlankType:1,multipleCount:0,multipleScore:0,shortAnswerCount:0,shortAnswerScore:0,shortAnswerType:1,singleCount:0,singleScore:0,trueOrFalseCount:0,trueOrFalseScore:0,multipleMissedScore:0}}},mappingId:t.mappingId,isExamEdit:t.isExamEdit};break;case 3:var B=t.offline_course_vo;o={id:t.id,name:t.name,type:"xx",componentName:"OfflineTrain",icon:c.e1.xx,data:(0,a.Z)({},me(B)),mappingId:t.mappingId};break;case 4:case 5:if(t.type==="sc"||t.type==="operation"){o={id:t.id,name:t.title,type:"sc",icon:c.e1.sc,componentName:"AddPracticeTest",data:(0,re.UI)("PRIVACY_HLS_APPROVAL_MANAGE")?N(t):D(t),mappingId:t.mappingId};break}o={id:t.courseId,name:t.title||t.name,type:"investigate",icon:c.e1.questionnaire,componentName:"AddInvestigate",data:t,mappingId:t.mappingId,questionnaire:{id:t.questionnaireId,name:t.name}};break;case 6:o={id:t.evaluation.id,name:t.evaluation.title,productId:t.evaluation.product_id,modelId:t.evaluation.model_id,type:"jobEvaluation",icon:c.e1.jobEvaluation,componentName:"AddJobEvaluation",data:{title:t.evaluation.title,evaluationTools:{product_id:t.evaluation.product_id,model_id:t.evaluation.model_id}},mappingId:t.mappingId};break;case 7:o={id:t.id,name:t.tutorials.title,type:"tutor",icon:c.e1.tutor,componentName:"AddMentorCoaching",data:(0,a.Z)((0,a.Z)({},t.tutorials),{},{tutor_model:t.tutorials.tutorModel,evaluation_type:t.tutorials.evaluationType,user_id:t.tutorials.userId,user_name:t.tutorials.userName}),mappingId:t.mappingId};break;case 9:o={id:t.courseId,name:t.title,type:"investigate",icon:c.e1.questionnaire,componentName:"AddInvestigate",data:t,questionnaire:{id:t.questionnaireId,name:t.name}};break;case 13:var H=t.course_sign_vo;o={id:t.id,name:t.name,type:"attendance",componentName:"Attendance",icon:c.e1.attendance,data:(0,a.Z)({},ue(H)),mappingId:t.mappingId};break;case 14:o={id:(t==null||(E=t.evaluate)===null||E===void 0?void 0:E.id)||"",name:(t==null||(T=t.evaluate)===null||T===void 0?void 0:T.name)||"",type:"assess",componentName:"AddAssessment",icon:c.e1.assess,data:(0,a.Z)({},ee(t.evaluate)),resource_lock:t.resource_lock};break;case 15:{var j=(0,O.Qm)()._store,Q=j.getState(),_e=Q.user,ce=(0,u.AC)({data:t.exam_plan_detail_v1,user:{id:_e.id,name:_e.name,creator:!0}});o={id:t.exam_plan_detail_v1.id,name:t.exam_plan_detail_v1.title,type:"ex",icon:c.e1.ex,componentName:"AddNewExam",duration:t.exam_plan_detail_v1.exam_duration*60,data:ce,mappingId:t.mappingId,isExamEdit:t.isExamEdit}}default:break}return o.data&&(o.data.unlockingTime=t.unlockingTime?h()(t.unlockingTime):""),o.resource_lock=t.resource_lock,o})}));return d};function N(i){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"resources";return i.supervisor={lead:"",multilevel:[],or:[],type:"or"},i.mark={isFull:i.scoreSetting.score_switch==="on",value:i.scoreSetting.score_switch==="on"?i.scoreSetting.score:100},i.attachment=i[_],i}function D(i){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"resources",k=[],v=[];return i.workflowJson.type==="or"?i.workflowJson.nodeList[0].forEach(d=>{k.push({type:2,id:d.id,name:d.name,show:!0,unionid:d.unionid,user_id:d.sync_user_id,source_type:d.source_type||d.sourceType})}):i.workflowJson.type==="multilevel"&&i.workflowJson.nodeList.forEach(d=>{d.forEach(n=>{n.user_id=n.sync_user_id}),v.push(d)}),i.supervisor={or:k,multilevel:v,lead:"",type:i.workflowJson.type},i.mark={isFull:i.scoreSetting.score_switch==="on",value:i.scoreSetting.score_switch==="on"?i.scoreSetting.score:100},i.attachment=i[_],i}var L=(i,_)=>{var k=i.map((v,d)=>({id:v.id?v.id:"",content:v.desc,stage_name:v.name,is_order:_==="free_mode"?!1:v.inOrder,sort:d+1,progress:v.Standard.progressCheck?v.Standard.progress:"",exam_times:v.Standard.examCheck?v.Standard.examNum:"",practice_times:v.Standard.bankCheck?v.Standard.bankNum:"",operation_times:v.Standard.practiceCheck?v.Standard.practiceNum:"",finish_evaluation:v.Standard.jobEvaluationCheck?"true":"false",is_get_score:v.reward.getScoreChecked?v.reward.getScore:"",certificate_id:v.reward.certificateChecked?v.reward.certificateId:"",resources:v.list.map((n,e)=>{var t=n.data;switch(n.componentName){case"CoursewareSelector":return{course_id:n.id,replaced_old_id:n.replaced_old_id===n.id?"":n.replaced_old_id,sort:e,type:3,lab_resource_id:n.lab_resource_id,lab_resource_name:n.lab_resource_name,resource_lock:n.resource_lock||!1,unlocking_time:_==="unlock_mode"?null:h()(n.unlocking_time).valueOf()};case"ClNewUpload":case"CourseSelector":return{course_id:n.id,replaced_old_id:n.replaced_old_id||"",sort:e,type:1,lab_resource_id:n.lab_resource_id,lab_resource_name:n.lab_resource_name,resource_lock:n.resource_lock||!1,unlocking_time:_==="unlock_mode"?null:h()(n.unlocking_time).valueOf()};case"LiveClass":return{course_id:n.id,replaced_old_id:n.replaced_old_id||"",sort:e,type:16,lab_resource_id:n.lab_resource_id,lab_resource_name:n.lab_resource_name,resource_lock:n.resource_lock||!1,unlocking_time:_==="unlock_mode"?null:h()(n.unlocking_time).valueOf()};case"AddExam":return{type:6,sort:e,course_id:n.id,exam:{title:t.title,cheat_flag:t.cheatFlag.isChecked?1:0,exam_duration:t.examDuration,face_recognition:t.cheatFlag.faceRecognition,summary:t.summary,mark_type:A(t.markType),paper_id:t.questionsMode===1?t.fixedQuestion.id:"",pass_line:t.passLine,question_banks:t.questionsMode===1?[]:t.randomQuestion.bankQuesitonVoList.map(Q=>Q.id),question_mode:t.questionsMode,show_knowledge:t.knowledgePoints===1?"show":"hide",repeat_exam:t.reExam.isChecked,multiple_count:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.multipleCount,multiple_unit_score:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.multipleScore,fill_blank_count:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.fillBlankCount,fill_blank_unit_score:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.fillBlankScore,fill_blank_type:t.questionsMode===1?1:t.randomQuestion.bankQuesitonInfo.fillBlankType,short_answer_count:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.shortAnswerCount,short_answer_unit_score:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.shortAnswerScore,short_answer_type:t.questionsMode===1?1:t.randomQuestion.bankQuesitonInfo.shortAnswerType,single_count:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.singleCount,single_unit_score:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.singleScore,true_or_false_count:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.trueOrFalseCount,true_or_false_unit_score:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.trueOrFalseScore,multiple_missed_score:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.multipleMissedScore,total_score:t.questionsMode===1?t.fixedQuestion.tableList.totalScore:"",answer_parsing:t.reExam.isChecked?t.reExam.allowed.end:t.reExam.notAllowed.end,passing_score:t.questionsMode===1?Number(t.fixedQuestion.tableList.totalScore*t.passLine/100).toFixed(1):60,cut_screen_count:t.cheatFlag.switchNum!==null?t.cheatFlag.switchNum:-1,re_exam_rule:t.reExam.allowed.reRule,re_exam_number:t.reExam.allowed.reRule===2?t.reExam.allowed.reNum:0,score_rule:t.reExam.allowed.record,view_rule:t.reExam.allowed.viewRule,proportional:t.questionsMode===2&&t.isOpenDrawQuestions?t.proportional:[],anonymous_marking:"".concat(t.markType.anonymousMarking),show_result:t.reExam.show_result},resource_lock:n.resource_lock||!1,unlocking_time:_==="unlock_mode"?null:h()(n.unlocking_time).valueOf()};case"AddNewExam":var E=n.data,T=E.paperInfo,r=E.exam_times,o=E.cut_screen_times,m=E.random_order,l=E.mark_setting,B=E.result_visible,H=E.face_recognition,j=(0,U.Z)(E,["paperInfo","exam_times","cut_screen_times","random_order","mark_setting","result_visible","face_recognition"]);return{type:15,sort:e,course_id:n.id,new_exam:(0,a.Z)((0,a.Z)((0,a.Z)({},j),(0,u.jJ)(H)),{},{paper_id:T.id,answer_rule:r.answer_rule,exam_count:r.exam_count||1,cut_screen_rule:o.cut_screen_rule,cut_screen_count:o.cut_screen_count||1,cut_screen_interval:o.cut_screen_interval||0,random_question:m.random_question,random_options:m.random_options,mark_type:l.mark_type,mark_question_type:{fill_blank:l.mark_type===u.lt.MANUAL?l.fill_blank:!1,short_answer:l.mark_type===u.lt.MANUAL?l.short_answer:!1},anonymous_marking:l.anonymous_marking,exam_certificate_id:"",supervisor_list:[],marker_list:[...l.marker_list.map(Q=>typeof Q=="string"?Q:Q.id)],result_view_rule:B.result_view_rule,answer_parsing:B.answer_parsing,ranking_list_view_rule:B.ranking_list_view_rule,show_result:B.show_result,reward_rule:null,authority_range:null,supervisor_mark:null}),resource_lock:n.resource_lock||!1,unlocking_time:_==="unlock_mode"?null:h()(n.unlocking_time).valueOf()};case"OfflineTrain":return{sort:e,type:7,course_id:n.id,offline_course:{id:t.id,title:t.title,begin_time:h()(t.dateRange.startTime).valueOf(),end_time:h()(t.dateRange.endTime).valueOf(),attachment:t.attachment.map(Q=>Q.id),course_duration:t.course_duration||"",lecturer_id:t.teacher.id,is_lecturer_confirm:!!t.teacher.is_lecturer_confirm,is_lecturer_subsidy:!!t.teacher.is_lecturer_subsidy,address:t.address,introduction:t.introduction,is_open_offline_assessment:t.assess.is_open_offline_assessment,is_open_upload:t.other.is_open_upload,is_open_schedule:!1,remind_type:t.remind.remind_type,advance_minute:t.remind.advance_minute?Number(t.remind.advance_minute):0,is_lecturer_remind:t.remind.is_lecturer_remind,is_student_remind:t.remind.is_student_remind,is_director_remind:t.remind.is_director_remind,is_lecturer_student_evaluate:t.evaluate.is_lecturer_student_evaluate,is_student_lecturer_evaluate:t.evaluate.is_student_lecturer_evaluate,is_student_course_evaluate:t.evaluate.is_student_course_evaluate,lecturer_student_evaluate_content:t.evaluate.lecturer_student_evaluate_content,student_lecturer_evaluate_content:t.evaluate.student_lecturer_evaluate_content,student_course_evaluate_content:t.evaluate.student_course_evaluate_content,assessment_total_score:t.assess.assessment_total_score,assessment_pass_score:t.assess.assessment_pass_score},resource_lock:n.resource_lock||!1,unlocking_time:_==="unlock_mode"?null:h()(n.unlocking_time).valueOf()};case"AddInvestigate":return{sort:e,type:9,course_id:n.id||"",questionnaire_id:n.questionnaire.id,resource_lock:n.resource_lock||!1,title:n.name,unlocking_time:_==="unlock_mode"?null:h()(n.unlocking_time).valueOf()};case"AddPracticeTest":return{type:10,courseSort:e,sort:e,flag:4,course_id:n.id,title:n.data.title,content:n.data.content||n.data.address,resources:n.data.attachment.map(Q=>({resourceId:Q.id})),scoreSetting:{scoreSwitch:n.data.mark.isFull?"on":"off",score:n.data.mark.value},workflowJson:F(n.data.supervisor),job_type:n.data.job_type,resource_lock:n.resource_lock||!1,unlocking_time:_==="unlock_mode"?null:h()(n.unlocking_time).valueOf()};case"AddJobEvaluation":return{sort:e,flag:6,type:11,evaluation:{id:n.id||"",title:n.data.title,product_id:n.data.evaluationTools.product_id,model_id:n.data.evaluationTools.model_id},resource_lock:n.resource_lock||!1,unlocking_time:_==="unlock_mode"?null:h()(n.unlocking_time).valueOf()};case"Attendance":return{sort:e,type:13,course_id:n.id,sign:{id:t.id,type:13,title:t.title,directors:t.directors.map(Q=>typeof Q=="object"&&(Q.id||Q.user_id)?Q.id||Q.user_id:Q),name:t.name||"--",qrcode_type:t.qrcode_type,sign_in_begin_time:t.sign_in_begin_time,sign_in_end_time:t.sign_in_end_time,sign_out_begin_time:t.sign_out_begin_time,sign_out_end_time:t.sign_out_end_time,relate_course:t.relate_course,relate_course_list:t.relate_course_list,remind_directors:t.remind_directors,advance_minute:t.advance_minute,qy_we_chat_vo:t.qy_we_chat_vo,address:t.address,longitude:t.longitude,latitude:t.latitude,address_detail:t.address_detail,sign_range:t.sign_range},resource_lock:n.resource_lock||!1,unlocking_time:_==="unlock_mode"?null:h()(n.unlocking_time).valueOf()};case"AddAssessment":return{sort:e,type:14,course_id:n.id,resource_lock:n.resource_lock||!1,unlocking_time:_==="unlock_mode"?null:h()(n.unlocking_time).valueOf(),evaluateVo:{id:t.id,name:t.name,requirement:t.requirement,resource_id:t.resource_id,is_lock:t.is_lock,begin_time_unlock:t.begin_time_unlock,end_time_unlock:t.end_time_unlock,is_self_evaluate:t.is_self_evaluate,questionnaire_id:t.questionnaire_id,evaluate_form_title:t.evaluate_form_title,before_start_day:t.before_start_day,before_start_repeat:t.before_start_repeat,before_start_un_remind:t.before_start_un_remind,before_end_day:t.before_end_day,before_end_repeat:t.before_end_repeat,before_end_un_remind:t.before_end_un_remind,after_end_day:t.after_end_day,after_end_repeat:t.after_end_repeat,after_end_un_remind:t.after_end_un_remind,is_passed_standards:t.is_passed_standards,is_passed_option_three:t.is_passed_option_three,pass_standard_conditions:t.pass_standard_conditions,pass_standards_number:t.pass_standards_number,creator_user:t.creator_user}};case"AddPracticeBank":return{sort:e,type:17,course_id:n.id,resource_name:n.title,resource_lock:n.resource_lock||!1,unlocking_time:_==="unlock_mode"?null:h()(n.unlocking_time).valueOf(),practice:{title:n.data.title,question_bank_list:n.data.randomQuestion.bankQuesitonVoList.map(Q=>Q.id),pass_line:Number(n.data.stand)}};default:return null}})}));return k},ae=function(_,k){var v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;function d(e){return e.fill_blank_count>0||e.short_answer_count>0}var n=_.map((e,t)=>{var E=e.resources.filter(o=>o.type==6||o.type==15).length,T=e.resources.filter(o=>o.type==17).length,r=e.resources.filter(o=>o.type==10).length;return{id:e.id,key:"".concat(new Date().getTime()).concat(t),desc:e.content,name:e.stage_name,inOrder:e.is_order,Standard:{progressCheck:e.progress>0,progress:e.progress||100,examCheck:e.exam_times>0,examNum:e.exam_times||E,bankCheck:e.practice_times>0,bankNum:e.practice_times||T,practiceCheck:e.operation_times>0,practiceNum:e.operation_times||r,jobEvaluationCheck:e.finish_evaluation==="true"},reward:{getScore:e.is_get_score?e.is_get_score:"",getScoreChecked:e.is_get_score>0,certificateId:e.certificate_id||"",certificateChecked:e.certificate_id!==0,certificateName:e.certificate_name,certificateImage:e.preview_url},hourClassId:e.id,hourClassStartTime:e.start_time,hourClassEndTime:e.end_time,list:e.resources.map(o=>{var m=o.exam;switch(o.type){case 1:return{id:o.course_id,name:o.resource_name,type:v&&o.biz_type==="imageText"?"twCourse":"course",icon:o.biz_type==="imageText"?c.e1.h5:c.e1.crs,componentName:"CourseSelector",duration:o.duration,data:o,unlocking_time:o.unlocking_time,lab_resource_id:o.lab_resource_id,lab_resource_name:o.lab_resource_name,lab_selected_id:o.lab_resource_id,resource_lock:o.resource_lock};case 3:{var l;return o.content_type==="article"||o.content_type==="link"?l=c.e1.h5:l=c.e1[o.contentType]||c.e1[o.content_type],{id:o.course_id,name:o.resource_name,type:"courseware",icon:l,componentName:"CoursewareSelector",duration:o.duration,status:o.resource_status,originalType:o.content_type==="article"||o.content_type==="link"?"h5":o.content_type||o.contentType,data:o,unlocking_time:o.unlocking_time,lab_resource_id:o.lab_resource_id,lab_resource_name:o.lab_resource_name,lab_selected_id:o.lab_resource_id,resource_lock:o.resource_lock}}case 6:return{id:o.course_id,name:m.title,type:"ex",icon:c.e1.ex,componentName:"AddExam",duration:m.exam_duration*60,data:{id:m.id,title:m.title,examDuration:m.exam_duration,summary:m.summary,isOpenDrawQuestions:m.proportionalExamVos&&m.proportionalExamVos.length>0,proportional:m.proportionalExamVos&&(m.proportionalExamVos.length>0?P(m.proportionalExamVos,m.question_bank_vos):m.question_mode===2?p(m.question_bank_vos):[])||[],cheatFlag:{isChecked:!!m.cheat_flag,switchNum:m.cut_screen_count===-1?null:m.cut_screen_count,faceRecognition:m.face_recognition},reExam:{show_result:m.show_result,isChecked:m.repeat_exam,userJoin:k?!1:m.user_join==="true",notAllowed:{end:m.answer_parsing},allowed:{reRule:m.re_exam_rule,record:m.score_rule,end:m.answer_parsing,reNum:m.re_exam_rule===2?m.re_exam_number:1,viewRule:m.view_rule}},markType:{checkedValue:m.mark_type===1?1:2,artificialDisabled:m.mark_type===1&&!d(m),fillBlank:{checked:(m.mark_type===2||m.mark_type===3)&&m.fill_blank_count,disabled:!m.fill_blank_count},shortAnswer:{checked:(m.mark_type===2||m.mark_type===4)&&m.short_answer_count,disabled:!m.short_answer_count},anonymousMarking:m.anonymous_marking==="true"},questionsMode:m.question_mode,knowledgePoints:m.show_knowledge==="show"?1:2,passLine:m.pass_line,fixedQuestion:m.question_mode===1?{id:m.paper_id,name:m.paper_name,tableList:{fillBlankCount:m.fill_blank_count,fillBlankScore:m.fill_blank_unit_score,multipleCount:m.multiple_count,multipleScore:m.multiple_unit_score,shortAnswerCount:m.short_answer_count,shortAnswerScore:m.short_answer_unit_score,singleCount:m.single_count,singleScore:m.single_unit_score,totalCount:m.total_count,totalScore:m.total_score,trueOrFalseCount:m.true_or_false_count,trueOrFalseScore:m.true_or_false_unit_score}}:{id:"",name:"",tableList:{fillBlankCount:0,fillBlankScore:0,multipleCount:0,multipleScore:0,shortAnswerCount:0,shortAnswerScore:0,singleCount:0,singleScore:0,totalCount:0,totalScore:0,trueOrFalseCount:0,trueOrFalseScore:0}},randomQuestion:m.question_mode===2?{bankQuesitonVoList:m.question_bank_vos.map(ce=>{var te=ce.fill_blank_count,pe=ce.multiple_count,ye=ce.short_answer_count,Ce=ce.single_count,ie=ce.total_count,Te=ce.true_or_false_count,De={fillBlankCount:te,shortAnswerCount:ye,multipleCount:pe,singleCount:Ce,totalCount:ie,trueOrFalseCount:Te};return{id:ce.id,name:ce.name,data:Object.assign(ce,De),fillBlankCount:te,shortAnswerCount:ye,multipleCount:pe,singleCount:Ce,totalCount:ie,trueOrFalseCount:Te}}),bankQuesitonInfo:{fillBlankCount:m.fill_blank_count,fillBlankScore:m.fill_blank_unit_score,fillBlankType:+m.fillBlankType,multipleCount:m.multiple_count,multipleScore:m.multiple_unit_score,shortAnswerCount:m.short_answer_count,shortAnswerScore:m.short_answer_unit_score,shortAnswerType:+m.shortAnswerType,singleCount:m.single_count,singleScore:m.single_unit_score,trueOrFalseCount:m.true_or_false_count,trueOrFalseScore:m.true_or_false_unit_score,multipleMissedScore:m.multiple_missed_score}}:{bankQuesitonVoList:[],bankQuesitonInfo:{fillBlankCount:0,fillBlankScore:0,fillBlankType:1,multipleCount:0,multipleScore:0,shortAnswerCount:0,shortAnswerScore:0,shortAnswerType:1,singleCount:0,singleScore:0,trueOrFalseCount:0,trueOrFalseScore:0,multipleMissedScore:0}}},unlocking_time:o.unlocking_time,resource_lock:o.resource_lock};case 7:return{id:k?"":o.offlineCourseEditVo.id,name:o.offlineCourseEditVo.title,key:o.offlineCourseEditVo.id,type:"xx",componentName:"OfflineTrain",icon:c.e1.xx,data:(0,a.Z)({},me(o.offlineCourseEditVo,k)),unlocking_time:o.unlocking_time,resource_lock:o.resource_lock};case 9:return{id:o.course_id,name:o.title||o.resource_name,type:"investigate",icon:c.e1.questionnaire,componentName:"AddInvestigate",data:o,questionnaire:{id:o.questionnaire_id,name:o.resource_name},unlocking_time:o.unlocking_time,resource_lock:o.resource_lock};case 10:return{id:o.course_id,name:o.title,type:"sc",icon:c.e1.sc,componentName:"AddPracticeTest",data:D(o,"operationResources"),unlocking_time:o.unlocking_time,resource_lock:o.resource_lock};case 11:return{id:o.evaluation.id,name:o.evaluation.title,productId:o.evaluation.product_id,modelId:o.evaluation.model_id,type:"jobEvaluation",icon:c.e1.jobEvaluation,componentName:"AddJobEvaluation",data:{title:o.evaluation.title,evaluationTools:{product_id:o.evaluation.product_id,model_id:o.evaluation.model_id}},unlocking_time:o.unlocking_time,resource_lock:o.resource_lock};case 13:return{id:o.course_sign_vo.id,name:o.course_sign_vo.name,type:"attendance",componentName:"Attendance",icon:c.e1.attendance,data:(0,a.Z)({},ue(o.course_sign_vo,k)),unlocking_time:o.unlocking_time,resource_lock:o.resource_lock};case 14:return{id:o.evaluate?o.evaluate.id:"",name:o.evaluate?o.evaluate.name:"",type:"assess",componentName:"AddAssessment",icon:c.e1.assess,data:(0,a.Z)({},ee(o.evaluate)),resource_lock:o.resource_lock,unlocking_time:o.unlocking_time};case 15:{var B=(0,O.Qm)()._store,H=B.getState(),j=H.user,Q=(0,u.AC)({data:o.exam_plan_detail_v1,user:{id:j.id,name:j.name,creator:!0}});return{id:o.exam_plan_detail_v1.id,name:o.exam_plan_detail_v1.title,type:"ex",icon:c.e1.ex,componentName:"AddNewExam",unlocking_time:o.unlocking_time,resource_lock:o.resource_lock,duration:o.exam_plan_detail_v1.exam_duration*60,data:Q}}case 16:return{id:k?"":o.course_id,name:o.title,key:o.course_id,type:"liveClass",componentName:"LiveClass",icon:c.e1.liveClass,data:(0,a.Z)({},z(o)),unlocking_time:o.unlocking_time,resource_lock:o.resource_lock};case 17:var _e=(0,u.S8)(o.practice);return{id:o.course_id,name:o.resource_name,type:"practice",componentName:"AddPracticeBank",unlocking_time:o.unlocking_time,resource_lock:o.resource_lock,data:_e};default:return null}})}});return n},M=i=>{var _=i.map((k,v)=>({content:k.desc,stage_name:k.name,order:"".concat(k.inOrder),sort:v+1,course:k.list.map((d,n)=>{var e=d.data;switch(d.componentName){case"CoursewareSelector":return{course_id:d.id,course_sort:n,course_type:3,flag:1};case"CourseSelector":return{course_id:d.id,course_sort:n,course_type:1,flag:1};case"AddExam":return{flag:2,type:"ex",course_sort:n,course_id:d.id,title:e.title,cheat_flag:e.cheatFlag.isChecked?1:0,exam_duration:e.examDuration,face_recognition:e.cheatFlag.faceRecognition,summary:e.summary,mark_type:A(e.markType),paper_id:e.questionsMode===1?e.fixedQuestion.id:"",paper_title:e.questionsMode===1?e.fixedQuestion.name:"",pass_line:e.passLine,question_bank_list:e.questionsMode===1?"":e.randomQuestion.bankQuesitonVoList.map(j=>j.id).join(","),question_mode:e.questionsMode,show_knowledge:e.knowledgePoints===1?"show":"hide",s_repeat_exam:"".concat(e.reExam.isChecked),multiple_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.multipleCount,multiple_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.multipleScore,fill_blank_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.fillBlankCount,fill_blank_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.fillBlankScore,fill_blank_type:e.questionsMode===1?1:e.randomQuestion.bankQuesitonInfo.fillBlankType,short_answer_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.shortAnswerCount,short_answer_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.shortAnswerScore,short_answer_type:e.questionsMode===1?1:e.randomQuestion.bankQuesitonInfo.shortAnswerType,single_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.singleCount,single_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.singleScore,true_or_false_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.trueOrFalseCount,true_or_false_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.trueOrFalseScore,multiple_missed_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.multipleMissedScore,total_score:e.questionsMode===1?e.fixedQuestion.tableList.totalScore:"",answer_parsing:e.reExam.isChecked?e.reExam.allowed.end:e.reExam.notAllowed.end,passing_score:e.questionsMode===1?Number(e.fixedQuestion.tableList.totalScore*e.passLine/100).toFixed(1):60,cut_screen_count:e.cheatFlag.switchNum!==null?e.cheatFlag.switchNum:-1,re_exam_rule:e.reExam.allowed.reRule,re_exam_number:e.reExam.allowed.reRule===2?e.reExam.allowed.reNum:0,score_rule:e.reExam.allowed.record,view_rule:e.reExam.allowed.viewRule,proportional:e.questionsMode===2&&e.isOpenDrawQuestions?e.proportional:[],anonymous_marking:"".concat(e.markType.anonymousMarking),show_result:e.reExam.show_result};case"AddNewExam":var t=d.data,E=t.paperInfo,T=t.exam_times,r=t.cut_screen_times,o=t.random_order,m=t.mark_setting,l=t.result_visible,B=t.face_recognition,H=(0,U.Z)(t,["paperInfo","exam_times","cut_screen_times","random_order","mark_setting","result_visible","face_recognition"]);return{course_type:15,flag:15,type:"ex",course_sort:n,course_id:d.id,new_exam:(0,a.Z)((0,a.Z)((0,a.Z)({},H),(0,u.jJ)(B)),{},{paper_id:E.id,answer_rule:T.answer_rule,exam_count:T.exam_count||1,cut_screen_rule:r.cut_screen_rule,cut_screen_count:r.cut_screen_count||1,cut_screen_interval:r.cut_screen_interval||0,random_question:o.random_question,random_options:o.random_options,mark_type:m.mark_type,mark_question_type:{fill_blank:m.mark_type===u.lt.MANUAL?m.fill_blank:!1,short_answer:m.mark_type===u.lt.MANUAL?m.short_answer:!1},anonymous_marking:m.anonymous_marking,exam_certificate_id:"",supervisor_list:[],marker_list:[...m.marker_list.map(j=>typeof j=="string"?j:j.id)],result_view_rule:l.result_view_rule,answer_parsing:l.answer_parsing,ranking_list_view_rule:l.ranking_list_view_rule,show_result:l.show_result,reward_rule:null,authority_range:null,supervisor_mark:null})};case"AddInvestigate":return{course_id:d.id,course_type:9,flag:9,course_sort:n,investigate:{id:d.id,title:d.name,questionnaire_id:d.questionnaire.id}};default:return null}})}));return _},W=i=>{function _(v){return v.fill_blank_count>0||v.short_answer_count>0}var k=i.map((v,d)=>({key:"".concat(new Date().getTime()).concat(d),desc:v.content,name:v.stage_name,inOrder:v.is_order,list:v.course_mapping_list.map(n=>{var e=n;switch(n.flag){case 1:return{id:n.course_id,name:n.name,type:n.course_type===1?"course":"courseware",icon:c.e1[n.type==="imageText"?"h5":n.contentType==="audio/mp3"?"mp3":n.type],originalType:n.type,componentName:n.course_type===1?"CourseSelector":"CoursewareSelector",status:n.course_type===1?"":n.status,duration:n.duration,data:n};case 2:return{id:n.course_id,name:e.title,type:"ex",icon:c.e1.ex,componentName:"AddExam",duration:e.exam_duration*60,data:{title:e.title,examDuration:e.exam_duration,summary:e.summary,isOpenDrawQuestions:e.proportionalExamVos&&e.proportionalExamVos.length>0,proportional:e.proportionalExamVos&&(e.proportionalExamVos.length>0?P(e.proportionalExamVos,e.bank_quesiton_list):e.question_mode===2?p(e.bank_quesiton_list):[])||[],cheatFlag:{isChecked:!!e.cheat_flag,switchNum:e.cut_screen_count===-1?null:e.cut_screen_count,faceRecognition:e.face_recognition},reExam:{show_result:e.show_result,isChecked:e.s_repeat_exam==="true",notAllowed:{end:e.answer_parsing},allowed:{reRule:e.re_exam_rule,record:e.score_rule,end:e.answer_parsing,reNum:e.re_exam_rule===2?e.re_exam_number:1,viewRule:e.view_rule}},markType:{checkedValue:e.mark_type===1?1:2,artificialDisabled:e.mark_type===1&&!_(e),fillBlank:{checked:(e.mark_type===2||e.mark_type===3)&&e.fill_blank_count,disabled:!e.fill_blank_count},shortAnswer:{checked:(e.mark_type===2||e.mark_type===4)&&e.short_answer_count,disabled:!e.short_answer_count},anonymousMarking:e.anonymous_marking==="true"},questionsMode:e.question_mode,knowledgePoints:e.show_knowledge==="show"?1:2,passLine:e.pass_line,fixedQuestion:e.question_mode===1?{id:e.paper_id,name:e.paper_title,tableList:{fillBlankCount:e.fill_blank_count,fillBlankScore:e.fill_blank_unit_score,multipleCount:e.multiple_count,multipleScore:e.multiple_unit_score,shortAnswerCount:e.short_answer_count,shortAnswerScore:e.short_answer_unit_score,singleCount:e.single_count,singleScore:e.single_unit_score,totalCount:e.paper_question_numbers,totalScore:e.total_score,trueOrFalseCount:e.true_or_false_count,trueOrFalseScore:e.true_or_false_unit_score}}:{id:"",name:"",tableList:{fillBlankCount:0,fillBlankScore:0,multipleCount:0,multipleScore:0,shortAnswerCount:0,shortAnswerScore:0,singleCount:0,singleScore:0,totalCount:0,totalScore:0,trueOrFalseCount:0,trueOrFalseScore:0}},randomQuestion:e.question_mode===2?{bankQuesitonVoList:e.bank_quesiton_list.map(o=>{var m=o.fill_blank_count,l=o.multiple_count,B=o.short_answer_count,H=o.single_count,j=o.total_count,Q=o.true_or_false_count,_e={fillBlankCount:m,shortAnswerCount:B,multipleCount:l,singleCount:H,totalCount:j,trueOrFalseCount:Q};return{id:o.id,name:o.name,data:Object.assign(o,_e),fillBlankCount:m,shortAnswerCount:B,multipleCount:l,singleCount:H,totalCount:j,trueOrFalseCount:Q}}),bankQuesitonInfo:{fillBlankCount:e.fill_blank_count,fillBlankScore:e.fill_blank_unit_score,fillBlankType:+e.fill_blank_type||1,multipleCount:e.multiple_count,multipleScore:e.multiple_unit_score,shortAnswerCount:e.short_answer_count,shortAnswerScore:e.short_answer_unit_score,shortAnswerType:+e.short_answer_type||1,singleCount:e.single_count,singleScore:e.single_unit_score,trueOrFalseCount:e.true_or_false_count,trueOrFalseScore:e.true_or_false_unit_score,multipleMissedScore:e.multiple_missed_score}}:{bankQuesitonVoList:[],bankQuesitonInfo:{fillBlankCount:0,fillBlankScore:0,multipleCount:0,multipleScore:0,shortAnswerCount:0,shortAnswerScore:0,singleCount:0,singleScore:0,trueOrFalseCount:0,trueOrFalseScore:0,multipleMissedScore:0}}}};case 9:return{id:n.course_id,name:n.title,type:"investigate",icon:c.e1.questionnaire,componentName:"AddInvestigate",data:n,questionnaire:{id:n.questionnaire_id,name:n.name}};case 15:{var t=(0,O.Qm)()._store,E=t.getState(),T=E.user,r=(0,u.AC)({data:n.exam_plan_detail_v1,user:{id:T.id,name:T.name,creator:!0}});return{id:n.exam_plan_detail_v1.id,name:n.exam_plan_detail_v1.title,type:"ex",icon:c.e1.ex,componentName:"AddNewExam",duration:n.exam_plan_detail_v1.exam_duration*60,data:r}}default:return null}})}));return k},Y=function(_){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return _.map((v,d)=>{var n=k.find(e=>e.stage_index-1===d);return v.list.map((e,t)=>{var E;n&&(E=n.resource_error_vos.find(r=>r.resource_index===t));var T=e.type;if(e.resource_type)switch(e.resource_type){case 1:T="course";break;case 2:case 3:T="courseware";break;case 6:case 15:T="ex";break;case 7:T="xx";break;case 9:T="questionnaire";break;case 13:T="attendance";break;case 14:T="assess";break;default:break}if(e.componentName)switch(e.componentName){case"CourseSelector":T="course";break;case"CoursewareSelector":T="courseware";break;case"AddNewExam":case"AddExam":T="ex";break;case"OfflineTrain":T="xx";break;case"Attendance":T="attendance";break;case"QuestionnaireSelector":case"AddInvestigate":T="questionnaire";break;case"AddPracticeTest":T="practicalIndustry";break;case"AddAssessment":T="assess";break;default:break}switch(T){case"course":e.resourceErrTip=E?E.resource_status==="deleted"?"\u5F15\u7528\u7684\u8BFE\u7A0B\u88AB\u5220\u9664":E.resource_status==="un_released"?"\u5F15\u7528\u7684\u8BFE\u7A0B\u300A".concat(E.resource_name,"\u300B\u672A\u53D1\u5E03\uFF0C\u8BF7\u542F\u7528\u540E\u518D\u7F16\u8F91"):"":"";break;case"courseware":e.resourceErrTip=E&&E.resource_status==="deleted"?"\u5F15\u7528\u7684\u8BFE\u4EF6\u88AB\u5220\u9664":"";break;case"ex":e.resourceErrTip=E?E.resource_status==="bank_deleted"?"\u5F15\u7528\u7684\u9898\u5E93\u88AB\u5220\u9664":E.resource_status==="paper_deleted"?"\u5F15\u7528\u7684\u8BD5\u5377\u88AB\u5220\u9664":E.resource_status==="bank_missing"?"\u5F15\u7528\u7684\u9898\u5E93\u8BD5\u9898\u4E0D\u8DB3":"":"";break;case"xx":e.resourceErrTip=E&&E.resource_status==="time_expired"?"\u7EBF\u4E0B\u8BFE\u5DF2\u8FC7\u671F":"";break;case"questionnaire":e.resourceErrTip=E?E.resource_status==="deleted"?"\u5F15\u7528\u7684\u95EE\u5377\u88AB\u5220\u9664":E.resource_status==="un_released"?"\u5F15\u7528\u7684\u95EE\u5377\u672A\u53D1\u5E03":"":"";break;case"practicalIndustry":e.resourceErrTip=E&&E.resource_status==="operation_resource_deleted"?le.Z.t("component.practicalDeleteTip"):"";break;default:break}return null}),null}),_},me=(i,_)=>({id:_?"":i.id,title:i.title,edit_status:i.edit_status,status:i.status,department_id:i.department_id||"",dateRange:{startTime:i.begin_time,endTime:i.end_time},address:i.address,course_duration:i.course_duration,has_lecturer_student_data:_?!1:i.has_lecturer_student_data,has_student_lecturer_data:_?!1:i.has_student_lecturer_data,has_student_course_data:_?!1:i.has_student_course_data,has_lecturer_assess_student_data:_?!1:i.has_lecturer_assess_student_data,teacher:{id:i.lecturer_id,name:i.lecturer_name,is_lecturer_confirm:i.is_lecturer_confirm,is_lecturer_subsidy:i.is_lecturer_subsidy,teacher_sync_user_id:i.teacher_sync_user_id,lecturer_name:i.lecturer_name,teacher_sync_source_type:i.teacher_sync_source_type,type:i.teacher_sync_type,teacher_sync_type:i.teacher_sync_type},introduction:i.introduction,attachment:i.attachment||[],other:{is_open_schedule:i.is_open_schedule,is_open_upload:i.is_open_upload},remind:{remind_type:i.remind_type||"offline_course",advance_minute:i.advance_minute,is_lecturer_remind:i.is_lecturer_remind,is_student_remind:i.is_student_remind,is_director_remind:i.is_director_remind},evaluate:{is_lecturer_student_evaluate:i.is_lecturer_student_evaluate,is_student_lecturer_evaluate:i.is_student_lecturer_evaluate,is_student_course_evaluate:i.is_student_course_evaluate,lecturer_student_evaluate_content:i.lecturer_student_evaluate_content?(0,a.Z)((0,a.Z)({},i.lecturer_student_evaluate_content),{},{passing_score:Number(i.lecturer_student_evaluate_content.passing_score),total_score:Number(i.lecturer_student_evaluate_content.total_score)}):{evaluate_type:"score",questionnaire_id:"",questionnaire_name:"",total_score:"",passing_score:""},student_lecturer_evaluate_content:i.student_lecturer_evaluate_content||{evaluate_type:"star",questionnaire_id:"",questionnaire_name:"",total_score:"",passing_score:""},student_course_evaluate_content:i.student_course_evaluate_content||{evaluate_type:"star",questionnaire_id:"",questionnaire_name:"",total_score:"",passing_score:""}},assess:{is_open_offline_assessment:i.is_open_offline_assessment,assessment_total_score:i.assessment_total_score,assessment_pass_score:i.assessment_pass_score},user_has_attendanted:_?!1:i.user_has_attendanted}),ue=(i,_)=>{var k=[];return _?i.attendance_course_vo.forEach(v=>{k.push((0,a.Z)((0,a.Z)({},v),{},{course_id:"",course_key:v.course_id}))}):k=i.attendance_course_vo,{courseId:i.courseId,directors:i.director?i.director.map(v=>v):i.directors,id:_?"":i.id,name:i.name,qrcode_type:i.qrcode_type,relate_course_list:k,sign_in_begin_time:i.sign_in_begin_time?(0,b.p6)(i.sign_in_begin_time,"yyyy-MM-dd hh:mm:ss"):"",sign_in_end_time:i.sign_in_end_time?(0,b.p6)(i.sign_in_end_time,"yyyy-MM-dd hh:mm:ss"):"",sign_out_begin_time:i.sign_out_begin_time?(0,b.p6)(i.sign_out_begin_time,"yyyy-MM-dd hh:mm:ss"):"",sign_out_end_time:i.sign_out_end_time?(0,b.p6)(i.sign_out_end_time,"yyyy-MM-dd hh:mm:ss"):"",source_type:i.source_type,remind_directors:i.remind_directors,advance_minute:i.advance_minute,user_has_attendanted:_?!1:i.user_has_attendanted,relate_course:i.relate_course,address:i.address,longitude:i.longitude,latitude:i.latitude,address_detail:i.address_detail,sign_range:i.sign_range}};function G(i){return Object.prototype.toString.call(i)==="[object Object]"}function $(i){return i.replace(/[A-Z]/g,_=>"_".concat(_.toLowerCase()))}function K(i){if(!G(i))return i;for(var _={},k=Object.keys(i),v=0,d=k;v<d.length;v++){var n=d[v],e=i[n];n=$(n),_[n]=G(e)?K(e):e}return _}var ee=i=>{var _=K(i),k=_.id,v=_.name,d=_.requirement,n=_.resource_id,e=_.is_self_evaluate,t=_.is_lock,E=_.begin_time_unlock,T=_.end_time_unlock,r=_.questionnaire_id,o=_.evaluate_form_title,m=_.before_start_day,l=_.before_start_repeat,B=_.before_start_un_remind,H=_.before_end_day,j=_.before_end_repeat,Q=_.before_end_un_remind,_e=_.after_end_day,ce=_.after_end_repeat,te=_.after_end_un_remind,pe=_.is_passed_standards,ye=_.is_passed_option_three,Ce=_.pass_standard_conditions,ie=_.pass_standards_number,Te=_.creator_user;return{id:k,name:v,requirement:d,resource_id:n,is_lock:t,begin_time_unlock:E,end_time_unlock:T,is_self_evaluate:e,questionnaire_id:r,evaluate_form_title:o,before_start_day:m,before_start_repeat:l,before_start_un_remind:B,before_end_day:H,before_end_repeat:j,before_end_un_remind:Q,after_end_day:_e,after_end_repeat:ce,after_end_un_remind:te,is_passed_standards:pe,is_passed_option_three:ye,pass_standard_conditions:Ce,pass_standards_number:ie,creator_user:Te}},z=i=>({courseId:i.course_id,duration:i.duration,teacherName:i.live_lesson.teacher_name,startTime:i.live_lesson.live_start_time,endTime:i.live_lesson.live_end_time})},11449:function(fe,se,s){"use strict";s.d(se,{Z:function(){return G}});var U=s(88986),a=s(33565),J=s(12924),h=s.n(J),le=s(3115),O=s(49111),re=s(19650),b=s(62029),c=s(57663),u=s(71577),p=s(91768),P=s(28216),A=s(37055),f=s(10237);function S($){var K=A.ZP.getHelpContentByMenuKey(),ee={key:$};return f.WY.get({url:K,params:ee})}var R=s(74228),F=s.n(R),de=s(1164),N=s(76466),D=s(38642);class L extends h().Component{constructor(K){var ee;super(K);ee=this,this.getHelpContentByMenuKey=()=>{var z=this.props.defaultMenuKey;S(z).then(i=>{var _=i.data,k=_.help_url,v=_.video_url;this.setState({videoUrl:v,helpUrl:k})})},this.handleOpenHelpUrl=z=>{if((0,D.ve)()){window.open(z,"_blank");return}de.Z.targetTo({path:z,isExternalLink:!0})},this.handleOpenVideo=function(z){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ee.props.t("helpCenter.video");ee.setState(_=>({resourcePlayInfo:(0,U.Z)((0,U.Z)({},_.resourcePlayInfo),{},{resourceInfo:{originUrl:z,source:{FD:z,OD:z},contentType:"mp4"}}),previewInfo:(0,U.Z)((0,U.Z)({},_.previewInfo),{},{title:i,visible:!0,onCancel:ee.handleCancelPreview})}))},this.handleCancelPreview=()=>{var z=this.state.previewInfo;this.setState({resourcePlayInfo:{mode:"preview",watchType:"video",resourceInfo:{}},previewInfo:(0,U.Z)((0,U.Z)({},z),{},{visible:!1})})},this.state={helpUrl:"",videoUrl:"",resourcePlayInfo:{autoPlay:!0,draggable:!0,mode:"preview",resourceInfo:{},watchType:"video"},previewInfo:{visible:!1,destroyOnClose:!0,title:K.t("helpCenter.video")||"\u89C6\u9891\u6307\u5BFC",onCancel:()=>{}}}}componentDidMount(){this.getHelpContentByMenuKey()}render(){var K=this.state,ee=K.helpUrl,z=K.resourcePlayInfo,i=K.previewInfo,_=K.videoUrl,k=this.props.t;return h().createElement("div",{className:F().helpCenter},_&&h().createElement(u.Z,{type:"link",className:F()["video-btn"],style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenVideo(_)},k("helpCenter.video")),ee&&h().createElement(u.Z,{type:"link",style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenHelpUrl(ee)},k("helpCenter.tutorial")),h().createElement(N.Z,(0,b.Z)({},z,{previewInfo:i})))}}var ae=$=>({defaultMenuKey:$.currentRoute.menuKey});L.defaultProps={defaultMenuKey:""};var M=(0,P.$j)(ae)((0,p.Z)()(L));function W($){var K=$.extra,ee=localStorage.getItem("dingPersonnel"),z=sessionStorage.getItem("dingPersonnel");return h().createElement(re.Z,null,K,ee!=="dingPersonnel"&&z!=="dingPersonnel"&&(0,D.eY)("COMMONEXTRA_HELP_CENTER")&&h().createElement(M,null))}var Y=W,me=s(4408);function ue($){var K=(0,J.useState)({helpCenter:(0,D.eY)("HEAD_HELP_CENTER_BUT")}),ee=(0,a.Z)(K,1),z=ee[0],i=$.pageContainerParams,_=i===void 0?{}:i,k=$.noPadding,v=k===void 0?!1:k,d=$.isPersonal,n=d===void 0?!1:d,e=$.pageTitle,t=$.className,E=t===void 0?"":t,T={extra:z.helpCenter?h().createElement(Y,{extra:_.extra}):_.extra},r=(0,U.Z)((0,U.Z)({},_),T);return h().createElement("div",{className:"page-container-content ".concat(v?"page-container-noPadding":""," ").concat(n?"page-container-content_personal_background":""," ").concat(E)},e&&h().createElement(me.Z,{title:e}),n?h().createElement(le.Z,null,$.children):h().createElement(le.Z,r,$.children))}var G=ue},21063:function(fe,se,s){"use strict";var U=s(62029),a=s(63185),J=s(9676),h=s(57663),le=s(71577),O=s(49111),re=s(19650),b=s(22385),c=s(31097),u=s(88983),p=s(47933),P=s(88986),A=s(12924),f=s.n(A),S=s(91768),R=s(28216),F=s(96486),de=s.n(F),N=s(80991),D=s(68628),L=s(49101),ae=s(57119),M=s(43859),W=s(37055),Y=s(10237),me=s(84874),ue=s(88311),G=s(8908),$=s(60667),K=s(26885),ee=_=>{var k=_.advancedSetting,v=_.user;return{user:v,themeColor:k.themeColor}},z=()=>{};class i extends f().Component{constructor(k){var v;super(k);v=this,this.getUserManageRange=()=>{var d=W.ZP.Role.getUserManageRange();Y.WY.get({url:d}).then(function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=n.data,t=e===void 0?{}:e,E=t.range_type;v.setState({userManageType:E})})},this.handleChange=d=>{var n=d.target.value;this.setState({rangeType:n}),this.triggerChange({rangeType:n,rangeList:this.state.rangeList})},this.triggerChange=d=>{var n=d.rangeType,e=d.rangeList,t=this.props,E=t.isPkGroupSetting,T=t.onPkGroupOk;if(E){T({rangeType:n,rangeList:e});return}var r=this.props.from,o={rangeType:n,rangeList:e},m=localStorage.getItem("authorityType"),l=this.props.user.loginMode;r!=="employees"&&l==="WE_COM"&&m==="1"&&(o.qyWeChatVo=this.state.qyWeChatVo),r!=="employees"&&l==="WE_COM"&&m==="0"&&(o.qyWeChatVo=JSON.stringify({userList:e.user,departmentList:e.dept})),this.props.formik.setFieldValue("employeeRange",o)},this.handleOk=d=>{this.setRangeList(d)},this.setRangeList=d=>{var n=d.dept,e=d.group,t=d.post,E=d.user,T={dept:n,post:t,group:e,user:E};this.setState({rangeList:T,visible:!1}),this.triggerChange({rangeType:this.state.rangeType,rangeList:T})},this.importModalVisibility=function(d){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:z;v.setState({importVisible:d,rangeType:2},()=>{n()})},this.handleImportOk=d=>{var n=this.state.rangeList,e=n.user,t=e===void 0?[]:e,E=[...d,...t],T=(0,F.uniqBy)(E,"id");this.setState({rangeList:(0,P.Z)((0,P.Z)({},n),{},{user:T})},()=>{this.triggerChange({rangeType:this.state.rangeType,rangeList:this.state.rangeList}),this.importModalVisibility(!1)})},this.handleImportCancel=()=>{this.importModalVisibility(!1)},this.handleCancel=()=>{this.setOrgModalVisibility(!1)},this.handleDeleteItem=d=>{var n=(0,P.Z)({},this.state.rangeList),e,t;for(var E in n)if(e=n[E].findIndex(r=>r.id===d),e>-1){t=E;break}var T=[...n[t]];T.splice(e,1),n[t]=T,this.setState({rangeList:n}),this.triggerChange({rangeType:this.state.rangeType,rangeList:n})},this.handleSelectWx=()=>{var d=this.props.user,n=this.state.rangeList.user.map(e=>e.unionid||e.user_id||e.userId);(0,K.Sk)({userIds:n}).then(e=>{(0,K.$f)({result:e,user:d}).then(t=>{var E=t.qyWeChatVo,T=t.rangeList;this.setState({qyWeChatVo:E},()=>{this.handleOk(T)})})}).catch(()=>{this.handleCancel()})},this.setOrgModalVisibility=function(d){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:z,e=localStorage.getItem("authorityType"),t=v.props.user.loginMode,E=v.props.from;E!=="employees"&&d&&v.props.qwTicketShow&&t==="WE_COM"&&e==="1"?(v.handleSelectWx(),v.setState({rangeType:2})):v.setState({visible:d,rangeType:2},()=>{n()})},this.renderRadioGroup=()=>{var d=this.props,n=d.prefixCls,e=d.t,t=d.showSectitle,E=d.secTitle,T=E===void 0?e("common.assignRange"):E,r=d.secTitleInfoTip,o=r===void 0?"":r;return t?f().createElement("div",{className:"".concat(n,"__radios")},f().createElement("div",{className:"cl-form__sectitle"},T,o&&f().createElement("span",{className:"cl-form__sectitle__infotip"},o),this.renderRadios())):this.renderRadios()},this.handleVisibleType=d=>{var n=this.state.rangeType,e=d.target.value;this.setState({visibleType:e,rangeType:e==="follow"?0:n||3},()=>{this.triggerChange({rangeType:e==="follow"?0:n||3,rangeList:this.state.rangeList})})},this.renderRadios=()=>{var d=this.props,n=d.mode,e=d.t,t=d.prefixCls,E=d.rangeAuth,T=d.disabledAdd,r=d.themeColor,o=d.onlyDept,m=d.rangeType,l=d.handleStudentList,B=d.isShowPkStudentList,H=this.props.partLabel,j=H===void 0?e("common.deptAndStu"):H,Q=this.state,_e=Q.resourceViewRange,ce=Q.visibleType,te=Q.userManageType,pe=!!(m&&m!==2);return T?null:f().createElement("div",{className:"visible-range-setting"},n.includes("follow")&&f().createElement(p.ZP.Group,{name:"visibleType",value:ce,onChange:this.handleVisibleType},f().createElement(p.ZP,{value:"follow"},e("course.followClassify")),f().createElement(p.ZP,{value:"define"},e("course.customRange"))),(this.state.rangeType>0||n.length===1||!n.includes("follow"))&&f().createElement("div",{className:"custom-range-setting"},f().createElement(p.ZP.Group,{name:"rangeGroup",value:this.state.rangeType,disabled:this.props.disabled,onChange:this.handleChange},n.includes("all")&&f().createElement(p.ZP,{value:1,disabled:te!=="all"},e("common.allCompany"),E&&_e&&f().createElement(c.Z,{title:e("setting.selectPeopleTip")},f().createElement("span",null,f().createElement(D.Z,null)))),n.includes("under")&&f().createElement(p.ZP,{value:4},f().createElement(re.Z,null,e("setting.jurisdictionAndSubordinate"),f().createElement(c.Z,{title:e("setting.underTip")},f().createElement("span",null,f().createElement(D.Z,null))))),n.includes("private")&&f().createElement(p.ZP,{value:3},e("common.onlySelf")),n.includes("part")&&n.length>1&&f().createElement(p.ZP,{value:2},j),f().createElement(re.Z,null,!o&&f().createElement(le.Z,{className:"qa-assign-employee-selector",style:pe?{}:{color:r,border:"1px solid ".concat(r)},icon:f().createElement(L.Z,null),disabled:pe,onClick:()=>this.importModalVisibility(!0)},e("component.importPerson")),f().createElement(le.Z,{style:pe?{}:{color:r,border:"1px solid ".concat(r)},className:"".concat(t,"__addbtn qa-assign-employee-selector"),icon:f().createElement(L.Z,null),disabled:pe,onClick:()=>this.setOrgModalVisibility(!0)},e("common.select")),B?f().createElement(le.Z,{style:pe?{}:{color:r,border:"1px solid ".concat(r)},onClick:l,disabled:pe},e("pk.viewStudents")):""))))},this.renderGallery=()=>{var d=this.props.prefixCls,n=this.state.rangeType;return n!==2?null:f().createElement("div",{className:"".concat(d,"__gallery")},this.renderGropuGallery(),this.renderUserGallery())},this.renderGropuGallery=()=>{var d=this.props,n=d.prefixCls,e=d.t,t=this.state.rangeList,E=t.dept,T=t.group,r=t.post,o=[...E,...T,...r];return o.length?f().createElement("div",{className:"".concat(n,"__gallery__row cl-clearfix")},f().createElement("span",{className:"".concat(n,"__gallery__row__title")},e("common.selectedGroups"),"\uFF1A"),f().createElement("div",{className:"".concat(n,"__gallery__row__container cl-clearfix")},o.map(m=>this.renderGalleryItem(m,"dept")))):null},this.renderUserGallery=()=>{var d=this.props,n=d.prefixCls,e=d.t,t=this.state.rangeList.user,E=[...t];return E.length?f().createElement("div",{className:"".concat(n,"__gallery__row cl-clearfix")},f().createElement("span",{className:"".concat(n,"__gallery__row__title")},e("common.selectedUsers"),"\uFF1A"),f().createElement("div",{className:"".concat(n,"__gallery__row__container cl-clearfix")},E.map(T=>this.renderGalleryItem(T,"user")))):null},this.renderGalleryItem=(d,n)=>{var e=this.props,t=e.prefixCls,E=e.disabled,T=e.qwTicketShow,r=e.from,o="".concat(t,"__gallery__row__item"),m=this.props.user.loginMode,l=localStorage.getItem("authorityType"),B=r!=="employees"&&T&&l==="1"?d.unionid||d.userId||d.user_id||d.id:d.unionid||d.user_id,H=d.source_type||d.sourceType,j={user:"userName",dept:"departmentName"}[n]||"",Q={user:B,dept:d.id}[n]||d.id;return f().createElement("span",{className:o,key:d.id},f().createElement($.Z,{dataType:j,value:Q,name:d.name,type:H}),E||r!=="employees"&&l==="1"&&T&&m==="WE_COM"?null:f().createElement("span",{className:"item-icon",onClick:()=>this.handleDeleteItem(d.id)},f().createElement(me.Z,{iconClass:"icon-guanbi",size:"12px"})))},this.state={rangeType:k.defaultFieldList.rangeType,rangeList:k.defaultFieldList.rangeList||{},visible:!1,visibleType:k.defaultFieldList.rangeType===0?"follow":"define",userManageType:"all",importVisible:!1,qyWeChatVo:""}}componentDidMount(){this.getUserManageRange()}renderTransfer(){var k=E=>{this.props.formik.setFieldValue("open_transfer_student",E.target.checked)},v=this.props,d=v.prefixCls,n=v.t,e=v.formik.values.open_transfer_student,t=e===void 0?!1:e;return f().createElement("div",{className:"".concat(d,"__transfer")},f().createElement(J.Z,{onChange:k,checked:t},n("course.transferJoin")),f().createElement(c.Z,{title:n("course.transferJoin")},f().createElement(ae.Z,null)))}render(){var k=this.props,v=k.prefixCls,d=k.orgProps,n=k.onlyDept,e=n===void 0?!1:n,t=k.onlyPost,E=t===void 0?!1:t,T=k.onlyChooseDept,r=T===void 0?!1:T,o=k.t,m=k.isAssignRange,l=k.noBorder,B=k.transferVisible,H=B===void 0?!1:B,j=this.state,Q=j.rangeList,_e=j.visible,ce=j.importVisible;return f().createElement("div",{className:l?"":"visible-range-out"},l?null:f().createElement("div",{className:"visible-range-out-title"},o(m?"common.assignRange":"learning.learnUpgrade.visibleRange")),f().createElement("div",{className:"visible-range-out-inner".concat(l?"-no":"")},f().createElement("section",{className:"".concat(v)},this.renderRadioGroup(),this.renderGallery(),f().createElement(ue.Z,(0,U.Z)({},d,{visible:_e,initData:Q,displayType:r?["dept"]:e&&E?["dept","post"]:["dept","group","post"],onlyDept:e,onlyPost:E,onOk:this.handleOk,onCancel:this.handleCancel})),f().createElement(G.Z,{visible:ce,onOk:this.handleImportOk,onCancel:this.handleImportCancel})),H&&f().createElement("section",{className:"".concat(v)},this.renderTransfer())))}}i.defaultProps={prefixCls:"cl-employee-selector",showSectitle:!0,mode:["all","part"],orgProps:{},resourceViewRange:!1},se.Z=(0,R.$j)(ee)((0,N.$j)((0,M.Z)((0,S.Z)()(i))))},16084:function(fe,se,s){"use strict";var U=s(77883),a=s(21888),J=s(63185),h=s(9676),le=s(12924),O=s.n(le),re=s(91768),b=s(28216),c=s(80991),u=s(38642),p=s(43859);class P extends O().Component{constructor(){super(...arguments);this.state={blackList:{JobEvaluationBut:(0,u.eY)("MANAGEMENT_JOBEVALUATION_BUT")}},this.checkProgress=S=>{var R=S.target.checked,F=this.props.value;F.progress.isChecked=R,this.props.onFieldChange(F)},this.inputProgress=S=>{var R=this.props.value;R.progress.progress=S,this.props.onFieldChange(R)},this.checkExam=S=>{var R=S.target.checked,F=this.props.value;F.exam.isChecked=R,this.props.onFieldChange(F)},this.inputTimes=S=>{var R=this.props.value;R.exam.times=S,this.props.onFieldChange(R)},this.checkOperation=S=>{var R=S.target.checked,F=this.props.value;F.operation.isChecked=R,this.props.onFieldChange(F)},this.inputOperationTimes=S=>{var R=this.props.value;R.operation.times=S,this.props.onFieldChange(R)},this.checkJobEvaluation=S=>{var R=S.target.checked,F=this.props.value;F.jobEvaluation.isChecked=R,this.props.onFieldChange(F)}}UNSAFE_componentWillReceiveProps(S){if(this.props.jobEvaluationCount!==S.jobEvaluationCount&&S.jobEvaluationCount>0){var R=S.value;R.jobEvaluation.isChecked=!0,S.onFieldChange(R)}}render(){var S=this.props,R=S.value,F=S.examCount,de=S.courseCount,N=S.operationCount,D=S.isPreview,L=S.t,ae=S.shouldRenderedOperationCount,M=S.jobEvaluationCount,W=S.completeJobEvaluation,Y=S.qyShield,me=R.progress,ue=R.exam,G=R.operation,$=R.jobEvaluation,K=this.state.blackList;return O().createElement("div",{className:"qualified-standard"},O().createElement("div",{className:"qualified-standard-title"},L("learning.learningAddSecPassTitle"),O().createElement("span",{className:"qualified-standard-sub"},L("learning.learningAddSecPassTitleTip"))),O().createElement("div",{className:"qualified-standard-item"},O().createElement(h.Z,{disabled:de<1||D,className:"qualified-standard-checkbox",checked:de<1?!1:me.isChecked,onChange:this.checkProgress},L("learning.learningAddProgressRequire")),O().createElement(a.Z,{value:me.progress,disabled:!me.isChecked||de<1||D,onChange:this.inputProgress,className:"qualified-standard-number",min:1,max:100,precision:0}),O().createElement("span",{className:"qualified-standard-tip"},L("learning.learningAddProgressRequireTip"))),O().createElement("div",{className:"qualified-standard-item"},O().createElement(h.Z,{className:"qualified-standard-checkbox",disabled:F<1||D,checked:F<1?!1:ue.isChecked,onChange:this.checkExam},L("learning.learningAddPassRequire")),O().createElement(a.Z,{value:ue.times,disabled:!ue.isChecked||F<1||D,className:"qualified-standard-number",onChange:this.inputTimes,min:1,max:F>0?F:999,precision:0}),O().createElement("span",{className:"qualified-standard-tip"},L("learning.learningAddPassRequireTip"))),ae&&O().createElement("div",{className:"qualified-standard-item"},O().createElement(h.Z,{className:"qualified-standard-checkbox",disabled:N<1||D,checked:N<1?!1:G.isChecked,onChange:this.checkOperation},L("learning.learningAddOperationRequire")),O().createElement(a.Z,{value:G.times,disabled:!G.isChecked||N<1||D,className:"qualified-standard-number",onChange:this.inputOperationTimes,min:1,max:N>0?N:999,precision:0}),O().createElement("span",{className:"qualified-standard-tip"},L("learning.learningAddOperationRequireTip"))),K.JobEvaluationBut&&W&&Y==="false"&&O().createElement("div",{className:"qualified-standard-item"},O().createElement(h.Z,{className:"qualified-standard-checkbox",disabled:M<1||D,checked:M>0?$.isChecked:!1,onChange:this.checkJobEvaluation},L("learning.completeJobEvaluation"))))}}var A=f=>{var S=f.user;return{user:S,qyShield:S.qyShield}};se.Z=(0,b.$j)(A)((0,p.Z)((0,c.$j)((0,re.Z)()(P))))},69069:function(fe,se,s){"use strict";var U=s(77883),a=s(21888),J=s(57663),h=s(71577),le=s(47673),O=s(4107),re=s(63185),b=s(9676),c=s(12924),u=s.n(c),p=s(91768),P=s(28216),A=s(80991),f=s(49101),S=s(43859),R=s(93117),F=s(10237),de=s(37055),N=L=>({qyShield:L.user.qyShield});class D extends u().Component{constructor(ae){super(ae);this.getScoreRule=()=>{var M=de.ZP.EditStudyTask.getScoreRule(),W=this.props.value;F.WY.get({url:M}).then(Y=>{if(Y.data.data.hasRule){var me=Y.data.data.studyScore,ue=me[0],G=ue.finishScore,$=ue.unFinishScore;W.score.reward=G,W.score.deduction=$,this.props.onFieldChange(W)}})},this.handleSelectCertificate=()=>{var M=this.state.certificateConfig,W=this.props.value;M.visible=!0,M.defaultChecked=[{id:W.certificate.id,name:W.certificate.name}],this.setState({certificateConfig:M})},this.cancelSelectCertificate=()=>{var M=this.state.certificateConfig;M.visible=!1,this.setState({certificateConfig:M})},this.sureSelectCertificate=M=>{this.cancelSelectCertificate();var W=this.props.value;W.certificate.id=M[0].id,W.certificate.name=M[0].name,this.props.onFieldChange(W)},this.checkScoreReward=M=>{var W=M.target.checked,Y=this.props.value;Y.score.isCheckedReward=W,this.props.onFieldChange(Y)},this.checkScoreDeduction=M=>{var W=M.target.checked,Y=this.props.value;Y.score.isCheckedDeduction=W,this.props.onFieldChange(Y)},this.checkCerti=M=>{var W=M.target.checked,Y=this.props.value;Y.certificate.isChecked=W,this.props.onFieldChange(Y)},this.inputReward=M=>{var W=this.props.value;W.score.reward=M,this.props.onFieldChange(W)},this.inputDeduction=M=>{var W=this.props.value;W.score.deduction=M,this.props.onFieldChange(W)},this.state={certificateConfig:{visible:!1,defaultChecked:[],onCancel:this.cancelSelectCertificate,onOk:this.sureSelectCertificate}}}componentDidMount(){var ae=this.props.value;!ae.score.isCheckedReward&&!ae.score.isCheckedDeduction&&this.getScoreRule()}render(){var ae=this.state.certificateConfig,M=this.props,W=M.value,Y=M.isPreview,me=M.tipType,ue=me===void 0?"":me,G=M.t,$=M.formik,K=$.errors,ee=$.touched,z=W.certificate,i=W.score;return u().createElement("div",{className:"study-reward task"},u().createElement("div",{className:"study-reward-title"},G("learning.learningAddSecRewardTitle"),u().createElement("span",{className:"study-reward-sub"},G("learning.learningAddSecRewardTitleTip"))),u().createElement("div",{className:"study-reward-item"},u().createElement(b.Z,{className:"study-reward-checkbox",disabled:Y,checked:z.isChecked,onChange:this.checkCerti},G("learning.learningAddRewardCert")),u().createElement(O.Z,{value:z.name,disabled:!0,className:ee.reward&&K.reward&&K.reward.certificateChecked?"status-error study-reward-number":"study-reward-number"}),u().createElement(h.Z,{type:"link",icon:u().createElement(f.Z,null),disabled:!z.isChecked||Y,onClick:this.handleSelectCertificate},G("learning.learningAddRewardCertSelect"))),u().createElement("div",{className:"study-reward-item"},u().createElement(b.Z,{className:"study-reward-checkbox",checked:i.isCheckedReward,disabled:Y,onChange:this.checkScoreReward},G("learning.learningAddRewardPassScore")),u().createElement(a.Z,{value:i.reward,disabled:!i.isCheckedReward||Y,onChange:this.inputReward,min:0,max:999,precision:0,className:ee.reward&&K.reward&&K.reward.scoreRewardChecked?"status-error":""}),u().createElement("span",{className:"study-reward-tip"},G(ue==="project"?"learning.learningAddRewardPassScoreProjectTip":"learning.learningAddRewardPassScoreTip"))),u().createElement("div",{className:"study-reward-item"},u().createElement(b.Z,{className:"study-reward-checkbox",disabled:Y,checked:i.isCheckedDeduction,onChange:this.checkScoreDeduction},G("learning.learningAddRewardunPassScore")),u().createElement(a.Z,{value:i.deduction,disabled:!i.isCheckedDeduction||Y,onChange:this.inputDeduction,min:0,max:999,precision:0,className:ee.reward&&K.reward&&K.reward.scoreDeductionChecked?"status-error":""}),u().createElement("span",{className:"study-reward-tip"},G(ue==="project"?"learning.learningAddRewardunPassScoreProjectTip":"learning.learningAddRewardunPassScoreTip"))),ee.reward&&K.reward&&u().createElement("span",{style:{paddingLeft:"16px"},className:"tip_error_msg"},K.reward.msg),u().createElement(R.Z,ae))}}se.Z=(0,S.Z)((0,A.$j)((0,P.$j)(N)((0,p.Z)()(D))))},44659:function(fe,se,s){"use strict";var U=s(77576),a=s(59314),J=s(22385),h=s(31097),le=s(77883),O=s(21888),re=s(63185),b=s(9676),c=s(12924),u=s.n(c),p=s(28216),P=s(91768),A=s(17780),f=s(43859),S=s(16239),R=s(84874),F=s(38642);class de extends u().Component{constructor(){super(...arguments);this.state={blackList:{jobEvaluationSwitch:(0,F.eY)("STUDYTIME_JOBEVALUATION_SWITCH"),faceKnowTipFlag:(0,F.eY)("STUDYTIMELIMT_EXAM_FACE_KNOW")},whiteList:{faceVideoSourceFlag:(0,F.UI)("STUDYTIMELIMT_VIDEO_FACE_KNOW")}},this.renderText=()=>{var D=this.props.t;return u().createElement("div",null,u().createElement("p",{className:"title"},D("course.documentStudyLimitTip1")),u().createElement("p",{className:"title"},D("course.documentStudyLimitTip2")))},this.handleCheck=D=>{var L=D.target.checked,ae=this.props.value;ae.isChecked=L,this.props.onFieldChange(ae)},this.handleInput=D=>{var L=this.props.value;L.limit=D,this.props.onFieldChange(L)},this.handleSwitch=D=>{var L=this.props.value;L.faceRecognition=D,this.props.onFieldChange(L)},this.handleMediaSwitch=D=>{var L=this.props.value;L.videoFaceRecognition=D,this.props.onFieldChange(L)},this.handleJobSwitch=D=>{var L=this.props.value;L.jobEvaluationResults=D,this.props.onFieldChange(L)}}render(){var D=this.props,L=D.value,ae=D.isPreview,M=D.t,W=D.appType,Y=D.isShowJobInput,me=D.jobEvaluationCount,ue=D.componentType,G=D.isEdit,$=D.qyShield,K=this.state,ee=K.blackList,z=K.whiteList;return u().createElement("div",{className:"study-time-limit"},u().createElement("div",{className:"study-time-limit-title"},M("learning.learningAddSecSetTitle"),u().createElement("span",{className:"study-time-limit-sub"},M("learning.learningAddSecSetTitleTip"))),u().createElement("div",{className:"study-time-limit-input"},u().createElement(b.Z,{checked:L.isChecked,onChange:this.handleCheck,disabled:ae||G,className:L.isChecked?"study-time-limit-checked":""},M("learning.learningAddSecSetTitleInfo")),u().createElement(O.Z,{size:"middle",value:L.limit,disabled:!L.isChecked||ae,onChange:this.handleInput,className:"study-time-limit-number",min:1,max:9999,precision:0}),u().createElement("span",{className:"study-time-limit-standard"}),M("course.secByPage"),u().createElement(h.Z,{placement:"top",title:this.renderText},u().createElement("span",null,u().createElement(R.Z,{iconClass:"icon-f-tipe"}))),L.isChecked?null:u().createElement("span",{className:"study-time-limit-tip"},M("course.documentStudyLimitTip"))),ee.jobEvaluationSwitch&&Y&&$==="false"&&u().createElement("div",{className:"study-time-limit-jobInput"},me<1?u().createElement(a.Z,{defaultChecked:!1,checked:!1,disabled:!0,id:1}):u().createElement(a.Z,{checked:L.jobEvaluationResults,onChange:this.handleJobSwitch,disabled:ae,id:2}),u().createElement("span",{className:"item-margin"}," ",M("learning.openJobEvaluationResults")," "),u().createElement("span",{className:"study-time-limit-tip"},M("learning.jobEvaluationResultsTip"))),(0,A.xX)()||W==="wx_app"||W==="fs_app"||!S.Z[(0,S.c)()].showCl||ue==="authentication"||!ee.faceKnowTipFlag?null:u().createElement("div",{className:"study-time-limit-input"},u().createElement(a.Z,{defaultChecked:L.faceRecognition,onChange:this.handleSwitch,disabled:ae}),u().createElement("span",{className:"item-margin"}," ",M("exam.faceKnow")," "),u().createElement("span",{className:"study-time-limit-tip"},M("exam.faceKnowTip"))),z.faceVideoSourceFlag?u().createElement("div",{className:"study-time-limit-input"},u().createElement(a.Z,{defaultChecked:L.videoFaceRecognition,onChange:this.handleMediaSwitch,disabled:ae}),u().createElement("span",{className:"item-margin"}," ",M("exam.faceVideoSource")," "),u().createElement("span",{className:"study-time-limit-tip"},M("exam.faceVideoSourceTip"))):null)}}se.Z=(0,p.$j)(N=>({appType:N.user.appType,themeColor:N.advancedSetting.themeColor,qyShield:N.user.qyShield}))((0,f.Z)((0,P.Z)()(de)))},6998:function(fe,se,s){"use strict";var U=s(47673),a=s(4107),J=s(12924),h=s.n(J),le=s(43859),O=s(80991),re=s(10237),b=s(37055);class c extends h().Component{constructor(){var p;super(...arguments);p=this,this.handleChange=P=>{var A=P.target.value;this.props.onChange(A)},this.handleBlur=()=>{var P=this.props.formType;switch(P){case"task":this.checkTaskName();break;case"project":this.checkProjectName();break;case"employee":this.checkTaskName(2);break;default:break}},this.checkTaskName=function(){var P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,A=b.ZP.EditStudyTask.checkTaskTitle(),f=p.props,S=f.value,R=f.formik,F=f.t,de={edit:P,trainName:S};re.WY.get({url:A,params:de}).then(N=>{N.data.code!==0&&(R.setFieldError("title",F("learning.learningAddTitleRepeatTip")),R.setFieldTouched("title",!0,!1))})},this.checkProjectName=()=>{var P=b.ZP.EditStudyProject.checkProjectName(),A=this.props,f=A.value,S=A.formik,R=A.t,F={title:f};re.WY.post({url:P,data:F}).then(de=>{de.data.checked!=="true"&&(S.setFieldError("title",R("learning.learningAddTitleRepeatTip")),S.setFieldTouched("title",!0,!1))}).catch(de=>{de.response.data.code==="enterpriseapi.542001"&&(S.setFieldError("title",R("learning.learningAddTitleRepeatTip")),S.setFieldTouched("title",!0,!1))})}}render(){var p=this.props,P=p.value,A=p.isPreview,f=p.placeholder;return h().createElement(a.Z,{style:{width:"350px"},value:P,disabled:A,placeholder:f,onChange:this.handleChange})}}se.Z=(0,le.Z)((0,O.$j)(c))},25501:function(fe,se,s){"use strict";var U=s(12924),a=s.n(U),J=s(91768),h=s(24144),le=s(84874),O=s(43859);class re extends a().Component{constructor(){super(...arguments);this.onChange=c=>{var u=c.fileList;this.props.onChange(u)}}render(){var c=this.props,u=c.value,p=c.isPreview,P=c.t;return a().createElement("div",{className:"ding_QR_code_upload_image_field"},a().createElement("div",{className:"ding_QR_code_upload_container"},a().createElement(h.ZM,{fileList:u,uploadConfig:{maxCount:1,fileList:u,disabled:p},size:{value:2,unit:"MB"},onUploadedListChange:this.onChange,render:A=>(0,h.iM)(A)})),a().createElement("div",{className:"ding_QR_code_upload_image_field_tip"},a().createElement(le.Z,{iconClass:"icon-icon_attentionx1",size:"14px"}),P("learning.learningAddACTip")))}}se.Z=(0,O.Z)((0,J.Z)()(re))},40767:function(fe,se,s){"use strict";s.d(se,{g:function(){return U},c:function(){return a}});var U={labelCol:{xs:{span:24},sm:{span:3}},wrapperCol:{xs:{span:24},sm:{span:21}}},a={labelCol:{xs:{span:24},sm:{span:3}},wrapperCol:{xs:{span:24},sm:{span:20}}}},89135:function(fe,se,s){"use strict";var U=s(88986),a=s(78138),J=s.n(a),h=s(6793),le=s(2396),O=s(3407),re=(0,h.me)(),b=O.Z[re].learning.validation;se.Z={multiText:c=>{var u;return(0,le.$s)((0,h.fy)(c))>256&&(u=b.multiTextTip),u},title:c=>((0,h.fy)(c)?"":b.learningAddItemTitleNull)||((0,h.fy)(c).length>60?b.learningAddItemTitleLimit:""),dateRange:(c,u,p)=>{var P;if((!c.startTime||!c.endTime)&&(P=b.learningAddItemDateRangeNull),!p){var A="YYYY-MM-DD HH:mm";u.forEach(f=>{(J()(J()(f.data.dateRange.startTime).format(A)).valueOf()<(0,h.jZ)(J()(c.startTime).format(A))||J()(J()(f.data.dateRange.startTime).format("YYYY-MM-DD HH:mm")).valueOf()>(0,h.jZ)(J()(c.endTime).format(A))||J()(J()(f.data.dateRange.endTime).format(A)).valueOf()<=(0,h.jZ)(J()(c.startTime).format(A))||J()(J()(f.data.dateRange.endTime).format(A)).valueOf()>(0,h.jZ)(J()(c.endTime).format(A)))&&(P=b.learningAddItemDateRangeOnsite)})}return P},qualifiedStandardExceptWork:(c,u,p)=>{var P;return c&&(p===0&&u===0||!c.progress.isChecked&&!c.exam.isChecked||p===0&&!c.exam.isChecked)&&(P=b.learningAddItemPass),P},qualifiedStandardInOperation:(c,u,p,P,A)=>{var f;return c&&(p===0&&u===0&&P===0&&A===0||!c.progress.isChecked&&!c.exam.isChecked&&!c.operation.isChecked&&c.jobEvaluation&&!c.jobEvaluation.isChecked)&&(f=b.learningAddItemPass),f},checkStandardInOperation:(c,u,p,P)=>{var A;return c&&(p===0&&u===0&&P===0||!c.progress.isChecked&&!c.exam.isChecked&&!c.operation.isChecked||c.progress.isChecked&&!c.progress.progress||u!==0&&c.exam.isChecked&&!c.exam.times||P!==0&&c.operation.isChecked&&!c.operation.times)&&(A=b.learningAddItemPass),A},qualifiedStandard:(c,u,p,P,A)=>{var f;return c&&(p===0&&u===0&&P===0&&A===0||!c.progress.isChecked&&!c.exam.isChecked&&!c.operation.isChecked&&!c.jobEvaluation.isChecked||c.progress.isChecked&&!c.progress.progress||u!==0&&!c.exam.isChecked||u!==0&&c.exam.isChecked&&!c.exam.times||P!==0&&!c.operation.isChecked||P!==0&&c.operation.isChecked&&!c.operation.times)&&(f=b.learningAddItemPass),f},reward:c=>{var u={};return(!c||c.certificate.isChecked&&!c.certificate.id)&&(u=(0,U.Z)((0,U.Z)({},u),{},{certificateChecked:!0,msg:b.learningAddItemRewardCert})),c.score.isCheckedDeduction&&!c.score.deduction&&(u=(0,U.Z)((0,U.Z)({},u),{},{scoreDeductionChecked:!0,msg:b.learningAddItemRewardunPass})),c.score.isCheckedReward&&!c.score.reward&&(u=(0,U.Z)((0,U.Z)({},u),{},{scoreRewardChecked:!0,msg:b.learningAddItemRewardPass})),Object.keys(u).length?u:""},checkTerm:c=>{var u=c.number,p;return(!le.fA.positiveInteger.test(u)||u<1||u>100)&&(p=b.learningAddItemTerm),p},studyLimit:c=>{var u;return c.isChecked&&!c.limit?u=b.learningTimeTip:c.limit>9999&&(u=b.learningTimeBeyondTip),u},originPrice:c=>{var u;return parseFloat(c)===0?u=b.originalPriceTip:parseFloat(c)>99999&&(u=b.maxOriginPriceTip),u},discountPrice:(c,u)=>{var p;return c===""||parseFloat(c)===0?p=b.discountPriceTip:parseFloat(c)>99999?p=b.maxDiscountPriceTip:parseFloat(u)<=parseFloat(c)&&(p=b.diffPriceTip),p},registerRange:c=>{var u;return(!c.startTime||!c.endTime)&&(u=b.learningAddItemDateRangeNull),(0,h.jZ)(c.startTime)>=(0,h.jZ)(c.endTime)&&(u=b.learningAddItemDateRangeLimit),u},dateValidateCourse:(c,u)=>{var p;return(!c.startTime||!c.endTime)&&(p=b.learningAddItemDateRangeNull),(0,h.jZ)(c.startTime)>=(0,h.jZ)(c.endTime)&&(p=b.learningAddItemDateRangeLimit),(0,h.jZ)(c.startTime)<(0,h.jZ)(u.endTime)&&(p=b.learningCourseTime),p},inputValidateNumber:(c,u)=>{var p="";return(0,h.fy)(c)?(u&&Number(c)>=Number(u)&&(p=O.Z[re].learning.validation.priceLimit),Number(c)>99999&&(p=O.Z[re].validation.maxNum99999),Number(c)<.01&&(p=O.Z[re].validation.minNum),p):(p=O.Z[re].validation.pleaseEnter,p)},applyTip:c=>{var u;return c.isNeedApply==="need"&&c.enrollAudit==="automatic_audit"&&c.enrollLimit&&c.limitCount===""&&(u=b.applyPeopleTip),u},taskPrice:c=>{var u=c.price,p=c.isPaid,P;return p&&(u===""||parseFloat(u)===0?P=b.taskPriceTip:parseFloat(u)>99999&&(P=b.maxPriceTip)),P}}},2132:function(fe,se,s){"use strict";s.r(se),s.d(se,{default:function(){return ut}});var U=s(12924),a=s.n(U),J=s(13062),h=s(71230),le=s(18106),O=s(88108),re=s(20136),b=s(55241),c=s(62029),u=s(89032),p=s(15746),P=s(57663),A=s(71577),f=s(34792),S=s(48086),R=s(91768),F=s(76651),de=s(28216),N=s(80991),D=s(57068),L=s(40847),ae=s(21063),M=s(16084),W=s(69069),Y=s(44659),me=s(6998),ue=s(25501),G=s(40767),$=s(41222),K=s(89135);class ee extends a().Component{componentDidUpdate(Z){var y=Z.formik,w=y.isSubmitting,I=y.isValidating,g=y.errors,C=Object.keys(g);C.length>0&&w&&!I&&(Z.showError(g),z(C[0]))}render(){return null}}var z=ne=>{var Z='[class*="$$CL-FORM-ERROR__'.concat(ne,'"]'),y=document.querySelector(Z);y&&y.scrollIntoView()},i=(0,N.$j)(ee);i.scrollTo=z;var _=i,k=s(77883),v=s(21888),d=s(43859);class n extends a().Component{constructor(){super(...arguments);this.handleChange=Z=>{this.props.onChange(Z)}}render(){return a().createElement(v.Z,{precision:0,min:0,max:99999,value:this.props.defaultFieldList,onChange:this.handleChange})}}var e=(0,d.Z)((0,N.$j)(n)),t=s(14965),E=s(11448),T=s(37055),r=s(6793);class o extends a().Component{constructor(){super(...arguments);this.handleChange=Z=>{this.props.onChange(Z)}}render(){return a().createElement(E.Z,{showTime:!0,value:(0,r.k7)(this.props.defaultFieldList||new Date().getTime()),format:T.XE.INITIAL_DATE_FMT.VIEW,disabledDate:r.Kq,onChange:this.handleChange,showNow:!1,renderExtraFoote:null})}}var m=(0,d.Z)((0,N.$j)(o));class l extends a().Component{constructor(){super(...arguments);this.handleChange=Z=>{this.props.onChange(Z)}}render(){return a().createElement(v.Z,{precision:0,min:0,max:99999,value:this.props.defaultFieldList,onChange:this.handleChange})}}var B=(0,d.Z)((0,N.$j)(l)),H=s(88983),j=s(47933);class Q extends a().Component{constructor(){super(...arguments);this.handleChange=Z=>{this.props.onChange(Z.target.value)}}render(){return a().createElement(j.ZP.Group,{value:this.props.defaultFieldList,onChange:this.handleChange},a().createElement(j.ZP,{value:1},this.props.t("exam.once")),a().createElement(j.ZP,{value:2},this.props.t("exam.loop")))}}var _e=(0,d.Z)((0,N.$j)((0,R.Z)()(Q))),ce=s(71153),te=s(60331),pe=s(17780),ye=s(84874),Ce=s(56130),ie=ne=>({opearateStage:ne.studyTemplate.opearateStage});class Te extends a().Component{constructor(Z){super(Z);this.digui=y=>{for(var w=0;w<y.length;w++){if(y[w].id===this.props.previewInfo.classify){this.classifyName=y[w].label;return}y[w].children&&this.digui(y[w].children)}},this.renderPreview=()=>{var y=localStorage,w=y.appType,I=this.props,g=I.opearateStage,C=I.t,x=I.previewInfo;if(g==="1"){var ge;return x.term.type==="D"?ge=C("common.day"):x.term.type==="H"?ge=C("common.hour"):ge=C("common.minute"),a().createElement("div",{className:"stage-preview-content"},a().createElement("div",{className:"stage-preview-content-top"},C("learning.learnUpgrade.bascInfo")),a().createElement(h.Z,{className:"stage-preview-content-row"},a().createElement(p.Z,{className:"stage-preview-content-row-label"},C("learning.learningProjectTplName"),"\uFF1A"),a().createElement(p.Z,{className:"stage-preview-content-row-con"},x.title)),a().createElement(h.Z,{className:"stage-preview-content-row"},a().createElement(p.Z,{className:"stage-preview-content-row-label"},C("learning.learningProjectTplTerm"),"\uFF1A"),a().createElement(p.Z,{className:"stage-preview-content-row-con"},x.term.number," ",ge)),a().createElement(h.Z,{className:"stage-preview-content-row"},a().createElement(p.Z,{className:"stage-preview-content-row-label"},C("learning.learningProjectAddCategory"),"\uFF1A"),a().createElement(p.Z,{className:"stage-preview-content-row-con"},this.classifyName)),a().createElement(h.Z,{className:"stage-preview-content-row"},a().createElement(p.Z,{className:"stage-preview-content-row-label"},C("learning.taskSummary"),"\uFF1A"),a().createElement(p.Z,{className:"stage-preview-content-row-con"},x.summary)),w==="e_app"?a().createElement(h.Z,{className:"stage-preview-content-row"},a().createElement(p.Z,{className:"stage-preview-content-row-label"},C("learning.learningProjectTplAC"),"\uFF1A"),a().createElement(p.Z,{className:"stage-preview-content-row-con"},x.qrcode.length?x.qrcode.map((X,oe)=>a().createElement("img",{key:oe,src:X.url,alt:"cover",className:"stage-preview-content-row-con-img"})):C("common.none"))):null)}if(g==="2")return a().createElement("div",{className:"stage-preview-content"},a().createElement("div",{className:"stage-preview-content-top"},C("learning.learnUpgrade.studyContent")),x.stages.map((X,oe)=>a().createElement("div",{className:"stage-preview-content-steps",key:X.key},a().createElement("div",{className:"stage-preview-content-steps-head"},C("formItem.stageTaskPanelTitle"),oe+1,"\uFF1A ",X.name),a().createElement("div",{className:"stage-preview-content-steps-body"},a().createElement("div",{className:"stage-preview-content-steps-body-title"},C("learning.learnUpgrade.studyContent")),a().createElement("div",{className:"stage-preview-content-steps-body-inner"},X.list.map(q=>a().createElement(h.Z,{align:"top",key:q.id,className:"stage-preview-content-steps-body-resource"},a().createElement(p.Z,{className:"stage-preview-content-steps-body-resource-icon"},a().createElement(ye.Z,{iconClass:q.icon})),a().createElement(p.Z,{flex:"1",className:"stage-preview-content-steps-body-resource-info"},q.name))))))));if(g==="3")return a().createElement("div",{className:"stage-preview-content"},a().createElement("div",{className:"stage-preview-content-top"},C("learning.learnUpgrade.setUp")),a().createElement(h.Z,{className:"stage-preview-content-row"},a().createElement(p.Z,{className:"stage-preview-content-row-label stage-preview-content-row-large"},C("course.documentLearningTime"),"\uFF1A"),a().createElement(p.Z,{className:"stage-preview-content-row-con"},x.studyLimit.isChecked?x.studyLimit.limit+C("course.secByPage"):C("common.none"))),!(0,pe.xX)()&&a().createElement(h.Z,{className:"stage-preview-content-row"},a().createElement(p.Z,{className:"stage-preview-content-row-label stage-preview-content-row-large"},C("exam.faceKnow"),"\uFF1A"),a().createElement(p.Z,{className:"stage-preview-content-row-con"},x.studyLimit.faceRecognition?C("learning.learnUpgrade.open"):C("learning.learnUpgrade.close"))),a().createElement(h.Z,{className:"stage-preview-content-row"},a().createElement(p.Z,{className:"stage-preview-content-row-label stage-preview-content-row-large"},C("learning.learningAddProgressRequire"),"\uFF1A"),a().createElement(p.Z,{className:"stage-preview-content-row-con"},x.qualifiedStandard.progress.isChecked?"".concat(x.qualifiedStandard.progress.progress,"%"):C("common.none"))),a().createElement(h.Z,{className:"stage-preview-content-row"},a().createElement(p.Z,{className:"stage-preview-content-row-label stage-preview-content-row-large"},C("learning.learningAddPassRequire"),"\uFF1A"),a().createElement(p.Z,{className:"stage-preview-content-row-con"},x.qualifiedStandard.exam.isChecked?x.qualifiedStandard.exam.times:C("common.none"))),a().createElement(h.Z,{className:"stage-preview-content-row"},a().createElement(p.Z,{className:"stage-preview-content-row-label stage-preview-content-row-large"},C("learning.learningAddRewardCert"),"\uFF1A"),a().createElement(p.Z,{className:"stage-preview-content-row-con"},x.reward.certificate.isChecked?x.reward.certificate.name:C("common.none"))),a().createElement(h.Z,{className:"stage-preview-content-row"},a().createElement(p.Z,{className:"stage-preview-content-row-label stage-preview-content-row-large"},C("learning.learningAddRewardPassScore"),"\uFF1A"),a().createElement(p.Z,{className:"stage-preview-content-row-con"},x.reward.score.isCheckedReward?x.reward.score.reward:C("common.none"))),a().createElement(h.Z,{className:"stage-preview-content-row"},a().createElement(p.Z,{className:"stage-preview-content-row-label stage-preview-content-row-large"},C("learning.learningAddRewardunPassScore"),"\uFF1A"),a().createElement(p.Z,{className:"stage-preview-content-row-con"},x.reward.score.isCheckedDeduction?x.reward.score.deduction:C("common.none"))),a().createElement(h.Z,{className:"stage-preview-content-row"},a().createElement(p.Z,{className:"stage-preview-content-row-label stage-preview-content-row-large"},C("learning.setInterval"),"\uFF1A"),a().createElement(p.Z,{className:"stage-preview-content-row-con"},x.timerType===2?a().createElement(te.Z,null," ",C("exam.loop")," "):a().createElement(te.Z,null,"  ",C("exam.once")," "),x.timerType===2?a().createElement(te.Z,null,C("learning.interval")," ",x.timerInterval," ",C("common.day")):"",x.timerType===2?a().createElement(te.Z,null,C("common.release")," ",x.timerTimes," ",C("common.times")):"",x.timerType===2?a().createElement(te.Z,null,C("exam.nextExecutionTime")," : ",(0,r.p6)(x.timerStartTime,"yyyy-MM-dd hh:mm")):a().createElement(te.Z,null,C("exam.executionTime")," : ",(0,r.p6)(x.timerStartTime,"yyyy-MM-dd hh:mm")))),a().createElement(h.Z,{className:"stage-preview-content-row"},a().createElement(p.Z,{className:"stage-preview-content-row-label stage-preview-content-row-large"},C("common.assignRange"),"\uFF1A"),a().createElement(p.Z,{className:"stage-preview-content-row-con"},this.renderRange(x.employeeRange))),a().createElement(h.Z,{className:"stage-preview-content-row"},a().createElement(p.Z,{className:"stage-preview-content-row-label stage-preview-content-row-large"},C("learning.learnUpgrade.coordinator"),"\uFF1A"),a().createElement(p.Z,{className:"stage-preview-content-row-con"},x.supervisor.supervisorUserList.map((X,oe)=>a().createElement(te.Z,{key:"supervisorUserList".concat(oe)},X.name)))))},this.renderRange=y=>{var w=this.props.t,I=y.rangeType,g=y.rangeList;if(I===1)return w("common.allCompany");if(I===3)return w("common.onlySelf");if(I===2){var C=[...g.dept,...g.group,...g.post],x=g.user;return a().createElement(U.Fragment,null,a().createElement("div",{className:"stage-preview-content-row-con-tags"},a().createElement("sapn",null,w("common.selectedGroups")," : "),C.length?C.map((ge,X)=>a().createElement(te.Z,{key:"tag".concat(X)},ge.name)):w("common.none")),a().createElement("div",{className:"stage-preview-content-row-con-tags"},a().createElement("span",null,w("common.selectedUsers")," : "),x.length?x.map((ge,X)=>a().createElement(te.Z,{key:"tag".concat(X)},ge.name)):w("common.none")))}},this.classifyName=""}componentDidMount(){var Z=this.props.dispatch;Z({type:"studyTemplate/updateOpearateStage",opearateStage:"1"}),this.digui(this.props.classify)}render(){var Z=this.props.t;return a().createElement("div",{className:"stage-preview"},a().createElement("div",{className:"stage-preview-title"},Z("component.preview")),this.renderPreview())}}var De=(0,de.$j)(ie)((0,Ce.Z)((0,R.Z)()(Te))),Pe={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:20}}},He=s(78138),Ye=s.n(He),je=s(2396),ze=s(3407),Xe=(0,r.me)(),Me=ze.Z[Xe].validation,et=(ne,Z)=>{var y;return Z.timerType===2&&!je.fA.positiveInteger.test(ne)&&(y=Me.checkIntegerGreaterThan0),y},tt=(ne,Z)=>{var y;return Z.timerType===2&&!je.fA.positiveInteger.test(ne)&&(y=Me.checkIntegerGreaterThan0),y},at=ne=>{var Z,y=Ye()().add("year",1).valueOf();return ne<new Date().getTime()&&(Z=Me.checkTimeAfterNow),ne>y&&(Z=Me.checkTimeMoreThan1Year),Z},nt=s(38642),We=s(86726),st=s(17994),Ke=s(10237),rt=s(11449),it=s(4408),Le=s(52670),Re=s(53009),ke=s(62615),ot=s(70075),lt=ne=>({documentStudyLimit:ne.advancedSetting.documentStudyLimit,opearateStage:ne.studyTemplate.opearateStage,settingStep:ne.studyTemplate.settingStep,templateId:ne.studyTemplate.templateId,nowStage:ne.studyTemplate.nowStage,preview:ne.studyTemplate.preview});class Ve extends a().Component{constructor(Z){super(Z);this.getTemplateInfo=()=>{var y=this.state.editTemplateId,w=T.ZP.EditStudyTemplate.getTemplateInfo(y);Ke.WY.get({url:w}).then(I=>{var g=I.data,C=g.supervisor_id?g.supervisor_id.split(","):[],x=g.supervisor_user_name.split(",");C=C.map((X,oe)=>({type:2,id:X,name:x[oe],show:!0}));var ge={base_info:"1",stage_content_draft:"2",stage_content:"2",settings:"3",settings_draft:"3"}[g.saveStep]||"1";this.changeStage("1"),this.changeNowStage(ge),this.initialValues={title:g.title,createUserId:g.create_user,qrcode:g.ding_img_url?[{uid:new Date().getTime(),url:g.ding_img_url,name:"",status:"done"}]:[],summary:g.summary,classify:g.classify_id,classifyName:g.classify_name,syncProgress:g.sync_progress,stages:(0,Re.YK)(g.stage_json),studyLimit:{isChecked:g.study_time_limit!==0,limit:g.study_time_limit!==0?g.study_time_limit:1,faceRecognition:g.face_recognition==="on"},employeeRange:{rangeType:g.is_all_in===!0?1:2,rangeList:{dept:g.department_list||[],post:g.post_list||[],group:g.group_list||[],user:g.user_list||[]}},qualifiedStandard:{progress:{isChecked:g.progress!==0,progress:g.progress!==0?g.progress:100},exam:{isChecked:g.times!==0,times:g.times!==0?g.times:1}},reward:{certificate:{isChecked:"".concat(g.plan_certificate_id)!=="0",id:"".concat(g.plan_certificate_id)!=="0"?g.plan_certificate_id:"",name:"".concat(g.plan_certificate_id)!=="0"?g.plan_certificate_name:""},score:{isCheckedReward:!!(g.get_score_info&&g.get_score_info.finish_score),reward:g.get_score_info&&g.get_score_info.finish_score?g.get_score_info.finish_score:0,isCheckedDeduction:!!(g.get_score_info&&g.get_score_info.unfinish_score),deduction:g.get_score_info&&g.get_score_info.unfinish_score?g.get_score_info.unfinish_score:0}},supervisor:{supervisorUserList:C,isChecked:g.supervisor_paper===null?!0:g.supervisor_paper,visibleAuthScope:!0,authScopeIsChecked:g.authority_range==="true"},term:{number:g.plan_term,type:g.term_type},timerType:g.scheduler_json&&g.scheduler_json.type==="once"?1:2,timerInterval:g.scheduler_json?g.scheduler_json.interval:0,timerTimes:g.scheduler_json?g.scheduler_json.remain_times:0,timerStartTime:g.scheduler_json?g.scheduler_json.next_time?Date.parse(new Date(g.scheduler_json.next_time)):"":Date.parse(new Date),scheduleId:g.schedule_id,stagePass:g.stage_pass==="true"},this.setState({requested:!0,settings:g.saveStep==="settings"})})},this.initRef=y=>{this.formRef=y},this.saveData=(y,w)=>{var I=y.values,g=y.actions,C=y.save_step,x=this.props,ge=x.t,X=x.opearateStage,oe=x.nowStage,q=x.preview,Ie=this.state,Ee=Ie.editTemplateId,Ze=Ie.addTemplateId,we=I.title,Oe=I.term,Fe=I.summary,Be=I.scheduleId,V=I.employeeRange,ve=I.qrcode,Ae=I.stages,Ue=I.studyLimit,xe=I.qualifiedStandard,Se=I.reward,Qe=I.supervisor,qe=I.stagePass,mt=I.timerType,_t=I.timerInterval,pt=I.timerTimes,$e=I.timerStartTime,gt=I.classify,ht=I.syncProgress,vt=(0,$.Qz)(Ae);C=q==="true"?"settings":C;var Ne={operation:Ee?"edit_study_template":"create_study_template",template_id:Ee||Ze,save_step:C};X==="1"&&q==="false"&&(Ne.base_info={title:we,summary:Fe,classify_id:gt,plan_term:Oe.number,term_type:Oe.type,ding_img_url:ve[0]?ve[0].url:""}),X==="2"&&q==="false"&&(Ne.stage_content={stage_json:(0,Re.XN)(Ae),stage_pass:qe?"true":"false",sync_progress:ht}),(X==="3"||q==="true")&&(Ne.settings={get_score:!0,plan_certificate_id:Se.certificate.isChecked?Se.certificate.id:"",progress:vt>0&&xe.progress.isChecked?xe.progress.progress:0,get_score_info:{finish_score:Se.score.isCheckedReward?Se.score.reward:0,unfinish_score:Se.score.isCheckedDeduction?Se.score.deduction:0},is_all_in:V.rangeType===1,user_ids:V.rangeList.user.map(he=>he.id).join(","),department_ids:V.rangeList.dept.map(he=>he.id).join(","),group_ids:V.rangeList.group.map(he=>he.id).join(","),post_ids:V.rangeList.post.map(he=>he.id).join(","),scheduler_json:{interval:_t,next_time:(0,r.p6)($e),start_time:(0,r.p6)($e),times:pt,type:mt===1?"once":"period",scheduler_id:Be,status:"on"},study_time_limit:Ue.isChecked?Ue.limit:0,face_recognition:Ue.faceRecognition===!0?"on":"off",supervisor_id:Qe.supervisorUserList.map(he=>he.id).join(","),supervisor_paper:Qe.isChecked,authority_range:Qe.authScopeIsChecked,times:xe.exam.isChecked?xe.exam.times:"",stage_json:(0,Re.XN)(Ae),stage_pass:qe?"true":"false"});var ft=T.ZP.EditStudyTemplate.addOrUpdate();Ke.WY.post({url:ft,data:Ne}).then(he=>{var be=he.data;if(g&&g.setSubmitting(!1),be.data.id){if(w)return;X==="1"&&q==="false"&&(this.setState({addTemplateId:be.data.id}),this.changeStage("2"),(!Ee||Number(X)+1>oe)&&oe<=2&&this.changeNowStage("2")),X==="2"&&q==="false"&&(this.changeStage("3"),(!Ee||Number(X)+1>oe)&&this.changeNowStage("3")),(X==="3"||C==="settings")&&(S.default.success(ge(C==="settings"?"common.releaseSuccess":"common.saveSuccess")),this.linkToList())}else S.default.error(be.data.msg)}).catch(he=>{var be=he.response.data,Et=be.code,yt=be.message;if(Et==="enterpriseapi.542003"){var Je=JSON.parse(yt).stageError[0],Ge=Je.stageIndex,Ct=Je.resourceIndexs;(0,st.R)({name:"stages",errMsg:"".concat(this.props.t("formItem.stageTaskPanelTitle")).concat(Ge,": ").concat(Ae[Ge-1].list[Ct[0]].name," ").concat(this.props.t("common.rsNonExistent")),actions:g})}g.setSubmitting(!1)})},this.submit=(y,w)=>{var I=this.props.opearateStage,g=this.state.settings;w.setSubmitting(!0),I==="1"?this.saveData({values:y,actions:w,save_step:"base_info"}):I==="2"?this.saveData({values:y,actions:w,save_step:g?"stage_content":"stage_content_draft"}):this.saveData({values:y,actions:w,save_step:"settings"})},this.handleCancelEdit=()=>{var y=this.props.opearateStage,w=this.formRef.state.values,I=this.formRef,g=this.state.settings;y==="3"&&!g?this.saveData({values:w,actions:I,save_step:"settings_draft"}):this.linkToList()},this.linkToList=()=>{F.m8.push("/training/learning/task/studyTemplate")},this.leftClick=y=>{var w=this.props,I=w.opearateStage,g=w.preview;g==="true"?this.changeStage(y):y<I?this.changeStage(y):this.leftValidateForm(y)},this.leftValidateForm=y=>{var w=this.props.opearateStage,I=this.state.settings;this.formRef.validateForm().then(g=>{if(Object.keys(g).length===0){var C;w==="1"?C="base_info":I?C=w==="2"?"stage_content":"settings":C=w==="2"?"stage_content_draft":"settings_draft",this.saveData({values:this.formRef.state.values,clickStep:y,save_step:C},!0),this.changeStage(y)}else this.dealNormalError(g)})},this.dealNormalError=y=>{for(var w in y)if(y[w]){this.formRef.setFieldTouched(w,!0);return}},this.changeStage=y=>{var w=this.props.dispatch;w({type:"studyTemplate/updateOpearateStage",opearateStage:y})},this.handleChangeStep=y=>{var w=this.props.dispatch;w({type:"studyTemplate/updateSettingStep",settingStep:y})},this.handleLike=(0,r.E5)((y,w)=>{this.submit(y,w)},500),this.changeNowStage=y=>{var w=this.props.dispatch;w({type:"studyTemplate/updateNowStage",nowStage:y})},this.changePreview=y=>{var w=this.props.dispatch;w({type:"studyTemplate/updatePreview",preview:y})},this.handlePreview=()=>{this.formRef.validateForm().then(y=>{Object.keys(y).length===0?this.setState({previewInfo:this.formRef.state.values},()=>this.changePreview("true")):this.dealError(y)})},this.dealError=y=>{var w=this.state.position;for(var I in y)if(y[I]){this.handleChangeStep(w[I]||"1"),this.formRef.setFieldTouched(I,!0);return}},this.renderButton=y=>{var w=this.props,I=w.isPreview,g=w.t,C=w.opearateStage,x=w.preview;return a().createElement("div",{className:"cl-form-footer-button"},I?null:a().createElement(A.Z,{className:"form-page-container-bottom-btn",loading:y.isSubmitting,type:"primary",htmlType:"submit"},g(C==="3"||x==="true"?"common.release":"learning.learnUpgrade.saveAndNext")),x==="true"?a().createElement(U.Fragment,null,a().createElement(A.Z,{className:"form-page-container-bottom-btn",onClick:()=>{this.changePreview("false"),this.changeStage("3")}},g("common.return"))):a().createElement(U.Fragment,null,C==="3"&&a().createElement(A.Z,{className:"form-page-container-bottom-btn",onClick:this.handlePreview},g("component.preview")),a().createElement(A.Z,{className:"form-page-container-bottom-btn",onClick:this.handleCancelEdit},g("common.cancel"))))},this.getTotalHour=y=>{var w=0,I="--";return y&&y.forEach(g=>{g.list.forEach(C=>{C.duration&&(C.type==="course"||(C.originalType==="mp4"||C.originalType==="mp3")&&C.status===3||C.type==="ex")&&(w+=Number(C.duration))})}),w<60&&w>0?I="".concat(w,"\u79D2"):w>60&&(I="".concat(Math.ceil(w/60),"\u5206\u949F")),I},this.tip=()=>a().createElement("div",null,a().createElement("p",null,this.props.t("courseManage.criterionHours")),a().createElement("p",null,this.props.t("courseManage.criterionHours1")),a().createElement("p",null,this.props.t("courseManage.criterionHours2")),a().createElement("p",null,this.props.t("courseManage.criterionHours3")),a().createElement("p",null,this.props.t("courseManage.criterionHours4"))),this.state={allowActions:(0,We.V9)("classify",JSON.parse(localStorage.getItem("modules"))),editTemplateId:"",requested:!1,operateStageList:[{key:"1",name:Z.t("learning.learnUpgrade.bascInfo")},{key:"2",name:Z.t("learning.learnUpgrade.studyContent")},{key:"3",name:Z.t("learning.learnUpgrade.setUp")}],position:{studyLimit:"1",qualifiedStandard:"1",reward:"1",timerType:"2",timerInterval:"2",timerTimes:"2",timerStartTime:"2",employeeRange:"3",supervisor:"4"},previewInfo:{},appType:localStorage.appType,blackList:{learningProjectTplAC:(0,nt.eY)("LEARNING_PROJEC_TPLAC")}},this.initialValues={title:"",term:{number:0,type:"D"},createUserId:"",summary:"",classify:"",syncProgress:"false",timerType:2,timerInterval:0,timerTimes:0,timerStartTime:Date.parse(new Date),scheduleId:"",qrcode:[],stages:[{key:"".concat(new Date().getTime()),name:"".concat(this.props.t("formItem.stageTaskPanelTitle"),"1"),desc:"",list:[],inOrder:!1}],employeeRange:{rangeType:"",rangeList:{dept:[],post:[],group:[],user:[]}},studyLimit:{isChecked:this.props.documentStudyLimit!=="0",limit:this.props.documentStudyLimit==="0"?1:this.props.documentStudyLimit,faceRecognition:!!this.props.faceRecognition},qualifiedStandard:{progress:{isChecked:!0,progress:100},exam:{isChecked:!1,times:1}},reward:{certificate:{isChecked:!1,id:"",name:""},score:{isCheckedReward:!1,isCheckedDeduction:!1,reward:0,deduction:0}},supervisor:{supervisorUserList:[],isChecked:!0,visibleAuthScope:!0,authScopeIsChecked:!1},stagePass:!1}}componentDidMount(){this.clearSession().then(()=>{var Z=D.parse(F.m8.location.search),y=Z.id;y?this.setState({editTemplateId:y},this.getTemplateInfo):this.setState({requested:!0})})}clearSession(){var Z=this.props.dispatch;return Z({type:"studyTemplate/resetSettings"})}render(){var Z=this.state,y=Z.requested,w=Z.editTemplateId,I=Z.operateStageList,g=Z.previewInfo,C=Z.appType,x=Z.allowActions,ge=Z.blackList,X=this.props,oe=X.isPreview,q=X.t,Ie=X.nowStage,Ee=X.opearateStage,Ze=X.settingStep,we=X.preview,Oe=D.parse(F.m8.location.search),Fe=Oe.id,Be=q(Fe?"documentTitle.editTasks":"documentTitle.newTimingTask");return a().createElement(rt.Z,{pageContainerParams:{header:{title:q("leftMenuLists.timedReleaseTask")}}},a().createElement(it.Z,{title:Be}),a().createElement("div",{className:"studytemplate-edit"},a().createElement("div",{className:"form-page-container"},a().createElement(h.Z,{className:"form-page-container-row",justify:"space-between"},a().createElement(p.Z,{className:"form-page-aside form-page-left"},a().createElement("h1",{className:"form-page-left-title"},q(w?"learning.editTemplate":"learning.createTemplate")),a().createElement("div",{className:"form-page-left-step"},I.map(V=>a().createElement("div",{onClick:()=>{V.key<=Ie&&V.key!==Ee&&this.leftClick(V.key)},key:V.key,className:Ee===V.key?"form-page-left-step-item form-page-left-step-active":V.key<=Ie?"form-page-left-step-item form-page-left-step-success":"form-page-left-step-item form-page-left-step-noallow"},a().createElement("div",{className:"form-page-left-step-item-number"},V.key),a().createElement("div",{className:"form-page-left-step-item-name"},V.name))))),a().createElement(p.Z,{className:"form-page-aside form-page-right"},y?a().createElement(N.J9,{ref:this.initRef,initialValues:this.initialValues,onSubmit:this.handleLike,render:V=>a().createElement(N.l0,{className:"cl-form"},Ee==="1"&&we==="false"&&a().createElement(U.Fragment,null,a().createElement("div",{className:"cl-form__sectitle"},q("learning.basicInformation")),a().createElement("div",{className:"form-page-bg"},a().createElement(N.gN,(0,c.Z)({name:"title",label:q("learning.learningProjectTplName"),required:!0,defaultValue:V.values.title,validate:ve=>K.Z.title(ve),component:me.Z,isPreview:oe,formType:"project",placeholder:q("learning.learningProjectTplNamePlaceholder")},G.c)),a().createElement(N.gN,(0,c.Z)({component:ke.en,displayType:"Custom",name:"term",label:q("learning.learningProjectTplTerm"),required:!0,defaultFieldList:V.values.term,validate:Le.EU,disabled:oe},G.c)),a().createElement(N.gN,(0,c.Z)({name:"classify",label:q("learning.learningProjectAddCategoryer"),displayType:"Custom",defaultValue:V.values.classify,classifyName:V.values.classifyName,component:ke.O,unclassified:!0,showAdd:(0,We.H3)("add",x)},G.c)),a().createElement(N.gN,(0,c.Z)({name:"summary",label:q("learning.taskSummary"),component:ot.Z,rows:5,type:"text",maxLength:150,placeholder:q("learning.validation.taskSummaryTip"),style:{width:"550px"}},G.c)),ge.learningProjectTplAC&&C==="e_app"?a().createElement(N.gN,(0,c.Z)({name:"qrcode",className:"cl-form-Tip",label:q("learning.learningProjectTplAC"),component:ue.Z},G.c,{isPreview:oe})):null)),Ee==="2"&&we==="false"&&a().createElement(U.Fragment,null,a().createElement("div",{className:"cl-form__sectitle"},q("learning.learnUpgrade.studyContent")),a().createElement("div",{className:"form-page-bg"},a().createElement(N.gN,{component:ke.Vi,displayType:"Custom",name:"stages",required:!0,validate:Le.NW,isPreview:oe,resourceType:["courseware","course","exam","imageTextCourse","investigate"],defaultFieldList:V.values.stages,anonymousMarking:!0,multipleMissedScore:!0}),a().createElement(N.gN,{component:ke._e,name:"stagePass",isPreview:oe}),a().createElement(N.gN,{component:ke.Pk,name:"syncProgress",isPreview:oe}),a().createElement("div",{className:"estimated-hour"},this.props.t("courseManage.estimatedHours"),"\uFF1A",this.getTotalHour(V.values.stages),a().createElement(b.Z,{placement:"top",content:()=>this.tip()},a().createElement(L.Z,{className:"estimated-icon"}))))),Ee==="3"&&we==="false"&&a().createElement(U.Fragment,null,a().createElement(O.Z,{activeKey:Ze,onChange:this.handleChangeStep,className:"cl-form-tabs"},a().createElement(O.Z.TabPane,{tab:q("learning.learnUpgrade.learningSetting"),key:"1"},a().createElement(N.gN,{component:Y.Z,displayType:"Custom",name:"studyLimit",isPreview:oe,validate:ve=>K.Z.studyLimit(ve)}),a().createElement(N.gN,{component:M.Z,displayType:"Custom",examCount:(0,$.z2)(V.values.stages),courseCount:(0,$.Qz)(V.values.stages),name:"qualifiedStandard",shouldRenderedOperationCount:!1,isPreview:oe,validate:ve=>K.Z.qualifiedStandardExceptWork(ve,(0,$.z2)(V.values.stages),(0,$.Qz)(V.values.stages))}),a().createElement(N.gN,{component:W.Z,displayType:"Custom",name:"reward",validate:K.Z.reward,isPreview:oe,customError:!0})),a().createElement(O.Z.TabPane,{tab:q("learning.setInterval"),key:"2",forceRender:!0},a().createElement(N.gN,(0,c.Z)({component:_e,required:!0,name:"timerType",label:q("exam.releaseType"),defaultFieldList:V.values.timerType},Pe)),V.values.timerType===1?null:a().createElement(N.gN,(0,c.Z)({component:e,name:"timerInterval",required:!0,label:q("exam.releaseInterval"),defaultFieldList:V.values.timerInterval,validate:ve=>et(ve,V.values)},Pe)),V.values.timerType===1?null:a().createElement(N.gN,(0,c.Z)({component:B,required:!0,name:"timerTimes",label:q("exam.releaseTimes"),defaultFieldList:V.values.timerTimes,validate:ve=>tt(ve,V.values)},Pe)),a().createElement(N.gN,(0,c.Z)({component:m,name:"timerStartTime",required:!0,label:V.values.timerType===1?q("exam.executionTime"):q("exam.nextExecutionTime"),defaultFieldList:V.values.timerStartTime,validate:at},Pe))),a().createElement(O.Z.TabPane,{tab:q("common.assignRange"),key:"3",forceRender:!0},a().createElement(N.gN,{component:ae.Z,displayType:"Custom",name:"employeeRange",mode:["part"],label:"",showSectitle:!1,defaultFieldList:V.values.employeeRange,validate:Le.FI,disabled:oe,isAssignRange:!0})),a().createElement(O.Z.TabPane,{tab:q("learning.learnUpgrade.collaborate"),key:"4",forceRender:!0},a().createElement(N.gN,{component:ke.i0,displayType:"Custom",name:"supervisor",disabled:oe,defaultFieldList:V.values.supervisor,createUserId:V.values.createUserId})))),a().createElement(ke.I,null),we==="true"&&a().createElement(De,{previewInfo:g}),a().createElement(_,{showError:this.dealError}),this.renderButton(V))}):null)))))}}Ve.defaultProps={isPreview:!1};var dt=(0,de.$j)(lt)((0,R.Z)()(Ve));class ct extends a().Component{render(){return a().createElement(dt,{isPreview:!1})}}var ut=ct},17994:function(fe,se,s){"use strict";s.d(se,{R:function(){return a}});var U=s(62615),a=J=>{var h=J.name,le=J.errMsg,O=J.actions;O.setFieldError(h,le),O.setSubmitting(!1),U.I.scrollTo(h)}}}]);
