(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[459],{4408:function(Ee,ne,a){"use strict";var A=a(12924),S=a.n(A),X=a(28216),R=a(17780),z=a(38642),Z=g=>({userInfo:g.user}),Q=g=>{var U=g.title;return(0,R.xX)()&&setTimeout(()=>{document.title=U},0),(0,A.useEffect)(()=>{if(U&&document.title!==U&&setTimeout(()=>{document.title=U},0),(0,z.UI)("SCALE")){document.querySelector("body").style.zoom="0.8";var u=document.querySelector(".zoom-report");u&&(u.style.zoom="1.2")}return()=>{localStorage.getItem("name")||(document.querySelector("body").style="")}},[U]),S().createElement(S().Fragment,null)};Q.defautProps={title:""},ne.Z=(0,X.$j)(Z)(Q)},1164:function(Ee,ne,a){"use strict";var A=a(12924),S=a.n(A),X=a(76651),R=a(38642),z=a(91302),Z=Q=>{var g=navigator.userAgent.toLocaleLowerCase(),U=localStorage.getItem("enterpriseId"),u=(0,R.lz)(U,Q.projectType),D=localStorage.getItem("dingPersonnel"),k=z.bl.includes(D),I=Q.target;function T(c){if(I==="self"&&(c.preventDefault(),X.m8.push(Q.to)),k){if(Q.projectType==="student"){window.location.href="".concat(u,"/").concat(Q.to);return}X.m8.push(Q.to);return}if(dd.version){c.preventDefault();var o="";Q.to.includes("?")?o="".concat(u).concat(Q.to,"&ddtab=true"):o="".concat(u).concat(Q.to,"?ddtab=true"),dd.biz.util.openLink({url:o})}else g.indexOf("lark")!==-1&&(window.location.href="".concat(u).concat(Q.to))}return S().createElement("a",{rel:"noreferrer",href:"".concat(Q.projectType==="student"?"".concat(u).concat(Q.to):"#".concat(Q.to)),className:"".concat(Q.wrapCls," cl-pointer"),target:g.indexOf("lark")!==-1||k?"_self":Q.target||"_blank",onClick:T},Q.children)};Z.defaultProps={to:"/",wrapCls:"",target:"",projectType:"manage"},Z.targetTo=Q=>{var g=Q.path,U=Q.from,u=Q.isExternalLink,D=u===void 0?!1:u,k=Q.isAsync,I=k===void 0?!1:k,T=Q.openName,c=T===void 0?"_blank":T,o=Q.projectType,Y=o===void 0?"manage":o,$=Q.ddTab,H=$===void 0?!0:$,j,B=localStorage.getItem("dingPersonnel"),ee=z.bl.includes(B),L=navigator.userAgent.toLocaleLowerCase(),V=localStorage.getItem("enterpriseId"),M=(0,R.lz)(V,Y),F=localStorage.getItem("appType"),J=navigator.userAgent.toLowerCase().indexOf("wxwork")>-1;if(dd.version){var ce="";if(j=D?"":M,ee&&!D){if(Y==="student"){window.location.href="".concat(M).concat(g);return}X.m8.push(g);return}g.includes("?")?ce="".concat(j).concat(g,"&ddtab=").concat(H):ce="".concat(j).concat(g,"?ddtab=").concat(H),dd.biz.util.openLink({url:ce})}else if(L.indexOf("lark")!==-1)j=D?"":M,window.location.href="".concat(j).concat(g);else if(F==="wx_app"&&J&&D&&U==="imgText")j=D?"":Y==="student"?"".concat(M):"#",window.wx.invoke("openDefaultBrowser",{url:"".concat(j).concat(g)});else if(j=D?"":Y==="student"?"".concat(M):"#",I){var de=window.open("","_blank");setTimeout(()=>{de.location="".concat(j).concat(g)},100)}else window.open("".concat(j).concat(g),c)},ne.Z=Z},87312:function(Ee,ne,a){"use strict";var A=a(12924),S=a.n(A),X=a(91768),R=z=>{var Z=z.t;return S().createElement("div",{className:z.className?"".concat(z.className," no-result"):"no-result"},S().createElement("img",{src:"".concat("https://oss.coolcollege.cn","/1789886702513426432.png"),className:"no-data-img",alt:""}),S().createElement("p",{className:"no-data-tip"},z.tipText||Z("common.empty")))};ne.Z=(0,X.Z)()(R)},88311:function(Ee,ne,a){"use strict";a.d(ne,{Z:function(){return ye}});var A=a(62029),S=a(47673),X=a(4107),R=a(33565),z=a(57361),Z=a(34792),Q=a(48086),g=a(88986),U=a(43358),u=a(34041),D=a(18106),k=a(88108),I=a(9754),T=a.n(I),c=a(12924),o=a.n(c),Y=a(91768),$=a(77043),H=a.n($),j=a(20228),B=a(11382),ee=a(18721),L=a.n(ee),V=a(51975),M=a(37055),F={breadNav:[{value:"",label:""}],checkOne:()=>{},checkAll:()=>{},nextLevel:()=>{},changeLevel:()=>{}},J=o().createContext(F),ce={searchResult:[],deptList:[],groupList:[],postList:[],deptUser:[],groupUser:[],postUser:[],clusterList:[],classList:[],checkedDept:[],checkedGroup:[],checkedPost:[],checkedUser:[],checkedCluster:[],checkedClass:[],initTypeList:()=>{},initTypeUser:()=>{},toggleDisplayItem:()=>{},toggleDisplayList:()=>{},checkListOne:()=>{},checkUserOne:()=>{},removeCheckedUser:()=>{},changeLevel:()=>{},hidePosts:!1,initHidePostsStatus:()=>{},clearSelectedAll:()=>{}},de=o().createContext(ce),Ce=a(36017),ve=a(35247),ue=a(60667);class De extends o().Component{constructor(){super(...arguments);this.changeLevel=(C,f,i,l)=>{C.preventDefault(),this.props.contextData.changeLevel(f,i,l)}}render(){var C=this.props.contextData.breadNav.map((f,i)=>o().createElement(ve.Z.Item,{key:f.value},o().createElement("span",{className:"bread-nav-item",onClick:l=>this.changeLevel(l,f.value,i,!(L()(f,"authorized")&&f.authorized==="true"))},o().createElement(ue.Z,{dataType:"departmentName",value:f.value,name:f.label,type:f.sourceType}))));return o().createElement("div",{className:"bread-nav"},o().createElement(ve.Z,null,C))}}De.defaultProps={contextData:{breadNav:[]},changeLevel:()=>{}};var ge=De,ke=a(63185),Pe=a(9676),xe=a(88983),Oe=a(47933),we=a(22385),Se=a(31097),Ae=a(57119),Le=a(84874),Re=a(20136),Ve=a(55241),_e=a(13062),Me=a(71230),Fe=a(89032),ze=a(15746),be=a(28216),We=a(80430),Ie=a(10237);function Pt(){var w=CONFIG.Role.getUserManageRange();return request.get({url:w})}function lt(w){var C=M.ZP.OrgDialog.getDeptInfoUrl({departmentId:w.departmentId});return delete w.departmentId,Ie.WY.get({url:C,params:w})}function yt(w){var C=M.ZP.OrgDialog.getDeptUsersUrl({departmentId:w.departmentId});return delete w.departmentId,Ie.WY.get({url:C,params:w})}function qe(w){var C=M.ZP.OrgDialog.getUserDetailUrl();return Ie.WY.get({url:C,params:w})}function ct(w){var C=M.ZP.OrgDialog.getScopeUsersAndDeptsUrl({departmentId:w.departmentId});return delete w.departmentId,Ie.WY.get({url:C,params:w})}function dt(w){var C=M.ZP.OrgDialog.postDeleteCacheUrl({cacheId:w.cacheId});return delete w.cacheId,Ie.WY.post({url:C,params:w})}var pt,Ge,et=(pt=(0,be.$j)(w=>{var C=w.user;return{enterpriseName:C.enterpriseName}}),pt(Ge=class extends o().Component{constructor(){super(...arguments);this.state={loading:!0,cardInfoFinal:this.props.cardInfo},this.renderTitle=()=>{var C=this.props,f=C.cardInfo,i=C.prefixCls,l=C.enterpriseName,h=f.source_type,v=f.user_id,r=f.name;return o().createElement("div",{className:"".concat(i,"__header")},o().createElement("div",{className:"".concat(i,"__header-name")},o().createElement(ue.Z,{type:h,value:v,name:r,dataType:"userName"})),o().createElement("div",{className:"".concat(i,"__header-corp")},l||"/"))},this.renderContent=()=>{var C=this.props,f=C.prefixCls,i=C.t,l=this.state.cardInfoFinal,h=l.user_id,v=l.job_number,r=l.post_names,E=r===void 0?[]:r,_=l.department_infos,G=_===void 0?[]:_,se=()=>!(G instanceof Array)||G.length===0?"/":o().createElement(We.Z,{list:G,displayAll:!0,isBlock:!0}),K=()=>!(E instanceof Array)||E.length===0?"/":E.map(re=>o().createElement("div",{key:re},re)),ie=[{lable:"ID",value:h},{lable:i("personal.jobNumber"),value:v||"/"},{lable:i("setting.postLabel"),value:K()},{lable:i("learnRecord.department"),value:se()}];return o().createElement("div",{className:"".concat(f,"__body")},ie.map(re=>o().createElement(Me.Z,{className:"".concat(f,"__body-item"),key:re.value},o().createElement(ze.Z,{className:"".concat(f,"__body-item-lable")},re.lable),o().createElement(ze.Z,{className:"".concat(f,"__body-item-value")},re.value||"/"))))}}render(){var C=this.props,f=C.children,i=C.prefixCls,l=this.state,h=l.loading,v=l.cardInfoFinal;return o().createElement(Ve.Z,{overlayClassName:i,placement:"rightTop",title:this.renderTitle,content:h?o().createElement("div",{className:"".concat(i,"__body")},o().createElement(B.Z,null)):this.renderContent,onVisibleChange:r=>{r&&(v.detailInfo===!1?qe({user_id:v.id}).then(E=>{this.setState({loading:!1,cardInfoFinal:(0,g.Z)((0,g.Z)((0,g.Z)({},v),E.data),{},{detailInfo:!0})})}).catch(E=>{console.error(E)}):this.setState({loading:!1}))},mouseEnterDelay:.5},f)}})||Ge);et.defaultProps={prefixCls:"user-card-popover",cardInfo:{}};var Be=(0,Y.Z)()(et),Ct=["cluster","class"];class tt extends o().Component{constructor(){super(...arguments);this.checkOne=C=>{C.preventDefault(),this.props.contextData.checkOne(this.props.itemId,this.props.hasNext?"list":"user",!this.props.isChecked)},this.nextLevel=C=>{C.preventDefault(),!this.props.isChecked&&this.props.contextData.nextLevel(this.props.cardInfo,this.props.title,this.props.hasNextPost)},this.renderToolTips=()=>{var C=this.props,f=C.cardInfo,i=C.type,l=C.t;return f.authorized==="false"&&i==="dept"?o().createElement(Se.Z,{title:l("orgDialog.scopedAuthorize")},o().createElement(Ae.Z,{style:{marginLeft:"4px"}})):null}}render(){var C=this.props,f=C.t,i=C.cardInfo,l=i===void 0?{}:i,h=C.hidePosts,v=C.type,r=C.userCount,E=null;return this.props.hasNext?(E=o().createElement("div",{className:"next-level"},!(h&&v==="post")&&r>-1?o().createElement("span",{className:"next-level-count"},"(",r,")"):null,Ct.includes(v)?o().createElement("span",null):o().createElement("span",{className:this.props.isChecked?"next-level-label disabled":"next-level-label",onClick:this.nextLevel},o().createElement(Le.Z,{iconClass:"icon-xiaji1"}),f("component.nextLevel"))),this.props.single?o().createElement("div",{className:"org-tree-item"},o().createElement("span",{checked:this.props.isChecked,disabled:!this.props.checkable,className:"org-tree-item-name"},this.props.title),this.renderToolTips(),E):(!this.props.disableHidden||this.props.disableHidden&&this.props.checkable)&&o().createElement("div",{className:"org-tree-item"},o().createElement(Pe.Z,{checked:this.props.isChecked,disabled:!this.props.checkable,onClick:this.checkOne,className:"org-tree-item-name"},this.props.title),this.renderToolTips(),E)):o().createElement("div",{className:"org-tree-item"},this.props.single?o().createElement(Oe.ZP,{checked:this.props.isChecked,disabled:!this.props.checkable,onClick:this.checkOne,className:"org-tree-item-name"},o().createElement(Be,{cardInfo:l},this.props.title)):o().createElement(Be,{cardInfo:l},o().createElement(Pe.Z,{checked:this.props.isChecked,disabled:!this.props.checkable,onClick:this.checkOne,className:"org-tree-item-name"},this.props.title)))}}tt.defaultProps={hasNext:!1,isChecked:!1,itemId:"",title:"",hasNextPost:!1,userCount:0,checkable:!0,hidePosts:!1,disableHidden:!1};var ut=(0,Y.Z)()(tt),ht=["cluster","class"];class Ne extends o().Component{constructor(){super(...arguments);this.checkOne=C=>{C.preventDefault(),this.props.contextData.checkOne(this.props.itemId,this.props.hasNext?"list":"user",!this.props.isChecked)},this.nextLevel=C=>{C.preventDefault(),!this.props.isChecked&&this.props.contextData.nextLevel(this.props.cardInfo,this.props.title,this.props.hasNextPost)},this.renderToolTips=()=>{var C=this.props,f=C.cardInfo,i=C.type,l=C.t;return f.authorized==="false"&&i==="dept"?o().createElement(Se.Z,{title:l("orgDialog.scopedAuthorize")},o().createElement(Ae.Z,{style:{marginLeft:"4px"}})):null}}render(){var C=this.props,f=C.t,i=C.cardInfo,l=i===void 0?{}:i,h=C.hidePosts,v=C.type,r=C.userCount,E=null;return this.props.hasNext?(E=o().createElement("div",{className:"next-level"},o().createElement("span",{className:"next-level-belle"},!(h&&v==="post")&&r>-1?o().createElement("span",{className:"next-level-count"},"(",r,")"):null,ht.includes(v)?o().createElement("span",null):o().createElement("span",{className:this.props.isChecked?"next-level-label disabled":"next-level-label",onClick:this.nextLevel},o().createElement(Le.Z,{iconClass:"icon-xiaji1"}),f("component.nextLevel")))),this.props.single?o().createElement("div",{className:"org-tree-item"},o().createElement("span",{checked:this.props.isChecked,disabled:!this.props.checkable,className:"org-tree-item-name"},o().createElement("span",{className:"org-tree-item-title"},this.props.title)),this.renderToolTips(),E):(!this.props.disableHidden||this.props.disableHidden&&this.props.checkable)&&o().createElement("div",{className:"org-tree-item"},o().createElement(Pe.Z,{checked:this.props.isChecked,disabled:!this.props.checkable,onClick:this.checkOne,className:"org-tree-item-name"},o().createElement("span",{className:"org-tree-item-title"},this.props.title)),this.renderToolTips(),E)):o().createElement("div",{className:"org-tree-item"},this.props.single?o().createElement(Oe.ZP,{checked:this.props.isChecked,disabled:!this.props.checkable,onClick:this.checkOne,className:"org-tree-item-name"},o().createElement(Be,{cardInfo:l},o().createElement("span",{className:"org-tree-item-title"},this.props.title))):o().createElement(Be,{cardInfo:l},o().createElement(Pe.Z,{checked:this.props.isChecked,disabled:!this.props.checkable,onClick:this.checkOne,className:"org-tree-item-name"},o().createElement("span",{className:"org-tree-item-title"},this.props.title))))}}Ne.defaultProps={hasNext:!1,isChecked:!1,itemId:"",title:"",hasNextPost:!1,userCount:0,checkable:!0,hidePosts:!1,disableHidden:!1};var $e=(0,Y.Z)()(Ne),Ke=a(38642),at=["cluster","class"];class He extends o().Component{constructor(C){super(C);this.checkAll=(f,i)=>{f.preventDefault(),this.props.contextData.checkAll(i)},this.getIsCheckAll=()=>{var f=[].concat(this.context["".concat(this.props.dataTypeKey,"List")],at.includes(this.props.dataTypeKey)?[]:this.context["".concat(this.props.dataTypeKey,"User")]);if(f.length===0)return!1;var i=f.findIndex(l=>!l.isChecked);return i===-1},this.renderDeptName=(f,i)=>i==="dept"?o().createElement(ue.Z,{type:f.source_type,value:f.id,name:f.name,dataType:"departmentName"}):f.name,this.renderName=f=>o().createElement(ue.Z,{type:f.source_type,value:f.user_id,name:f.name,dataType:"userName"}),this.state={isShowCheckAllEle:!0,whiteList:{belleFlag:(0,Ke.UI)("BELLE_CUSTOMER_WHITE")}}}render(){var C=this.state,f=C.isShowCheckAllEle,i=C.whiteList,l=this.props,h=l.t,v=l.dataTypeKey,r=l.disableHidden,E=l.scrollFlag,_=this.context,G=_.maxDeptUserCount,se=_.hidePosts,K=_.onlyPost,ie=_.onlyUser,re=_.single,oe=[],te=this.context["".concat(this.props.dataTypeKey,"List")].map(ae=>(oe.push(o().createElement("div",{className:"title-item",key:ae.id},this.renderDeptName(ae,v))),i.belleFlag&&E?o().createElement($e,{type:v,key:ae.id,cardInfo:ae,hasNext:!0,checkable:G&&(ae==null?void 0:ae.userCount)>G?!1:!(K&&ae.post_type==="post_group"||ie),single:re,userCount:ae.userCount,isChecked:!!ae.isChecked,itemId:ae.id,title:this.renderDeptName(ae,v),contextData:this.props.contextData,hasNextPost:this.props.dataTypeKey==="post"&&!!ae.children,hidePosts:se,disableHidden:r}):o().createElement(ut,{type:v,key:ae.id,cardInfo:ae,hasNext:!0,checkable:G&&(ae==null?void 0:ae.userCount)>G?!1:!(K&&ae.post_type==="post_group"||ie),single:re,userCount:ae.userCount,isChecked:!!ae.isChecked,itemId:ae.id,title:this.renderDeptName(ae,v),contextData:this.props.contextData,hasNextPost:this.props.dataTypeKey==="post"&&!!ae.children,hidePosts:se,disableHidden:r}))),he=[],Te=at.includes(this.props.dataTypeKey)?[]:this.context["".concat(this.props.dataTypeKey,"User")].map(ae=>(he.push(o().createElement("div",{className:"title-item",key:ae.id},this.renderName(ae,v))),i.belleFlag&&E?o().createElement($e,{key:ae.id,hasNext:!1,title:this.renderName(ae),isChecked:!!ae.isChecked,itemId:ae.id,cardInfo:ae,checkable:!(ae.reserve||this.context.onlyDept),single:this.context.single,contextData:this.props.contextData,type:this.props.dataTypeKey,disableHidden:r}):o().createElement(ut,{key:ae.id,hasNext:!1,title:this.renderName(ae),isChecked:!!ae.isChecked,itemId:ae.id,cardInfo:ae,checkable:!(ae.reserve||this.context.onlyDept),single:this.context.single,contextData:this.props.contextData,type:this.props.dataTypeKey,disableHidden:r}))),Ze=this.getIsCheckAll(),Ue=o().createElement("div",{className:"org-tree-item"},o().createElement(Pe.Z,{checked:Ze,defaultChecked:!0,onClick:ae=>this.checkAll(ae,!Ze)},h("common.all")));return o().createElement("div",{className:"".concat(this.context.oneDisplayType?"org-tree more-height":"org-tree"," ").concat(i.belleFlag&&E?"org-tree-belle":"")},!this.context.single&&this.context.onlyUser&&!this.context.onlyDept&&!this.context.onlyPost&&te.length===0&&Te.length>0&&f||!this.context.single&&!this.context.onlyUser&&!this.context.onlyDept&&!this.context.onlyPost&&(te.length>0||Te.length>0)&&f?Ue:null,i.belleFlag&&E&&o().createElement("div",{className:"belle-title-scroll"},oe,he),te,Te)}}He.contextType=de,He.defaultProps={dataTypeKey:"dept",contextData:{},disableHidden:!1,scrollFlag:!1};var mt=(0,Y.Z)()(He),st=a(25547),Ye="999",Qe=1,rt=["clusterList","classList"];class Je extends o().Component{constructor(C,f){var i;super(C);i=this,this.getClusterList=()=>{var l=M.ZP.OrgDialog.getClusterList(),h={keyword:""};Ie.WY.get({url:l,params:h}).then(v=>{this.context.initTypeList("clusterList","checkedCluster",v.data.data.map(r=>({name:r.name,userCount:r.user_count,id:r.id,parentId:[""]})))})},this.getClassList=()=>{this.context.initTypeList("classList","checkedClass",[{name:"\u6D4B\u8BD52",userCount:2,id:"2",parentId:[""]},{name:"\u6D4B\u8BD54",userCount:1,id:"41",parentId:[""]}])},this.flatTreeData=(l,h)=>(l.children.forEach(v=>{v.children&&(h[v.id]=v.children,this.flatTreeData(v,h))}),h),this.getDeptList=function(l){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return new Promise((v,r)=>{var E=i.state.cacheId;lt({departmentId:l,cache_id:E,filter_auth:h&&!i.props.filterAuthOpen}).then(_=>{var G=_.data.children||[];G.forEach(K=>{K.parentId=_.data.id,K.userCount=K.user_count,K.name=K.department_name,K.all_name=o().createElement("span",null,i.state.contextData.breadNav.map(ie=>o().createElement("span",{key:ie.value},ie.label,"/")),K.department_name)});var se=[];i.context.asyncDeptTree?se=G:se=i.flatTreeData(_.data,{[_.data.id]:G}),i.setState({deptList:se}),i.context.initTypeList("deptList","checkedDept",G),v(_.data)}).catch(_=>{console.error(_),r(_)})})},this.getDeptUserList=function(l){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,v=i.state.cacheId;yt({departmentId:l,cache_id:v,filter_auth:h&&!i.props.filterAuthOpen}).then(r=>{r.data&&r.data.forEach(E=>{E.name=E.user_name,E.detailInfo=!1}),i.context.initTypeUser("deptUser",r.data)}).catch(r=>{console.error(r)})},this.getGroupList=()=>{var l=M.ZP.Organization.getGroupList(),h={filter_auth:!this.props.filterAuthOpen,user_type:this.context.userType};Ie.WY.get({url:l,params:h}).then(v=>{v.data.groups=v.data.groups||[],v.data.groups.forEach(r=>{r.parentId=this.state.contextData.breadNav.map(E=>E.value),r.userCount=r.user_count,r.name=r.group_name}),this.setState({groupList:v.data.groups}),this.context.initTypeList("groupList","checkedGroup",v.data.groups)})},this.getGroupUserList=l=>{var h=M.ZP.Organization.getGroupUserList({groupId:l}),v={filter_auth:!this.props.filterAuthOpen,user_type:this.context.userType};Ie.WY.get({url:h,params:v}).then(r=>{r.data.users&&r.data.users.forEach(E=>{E.name=E.user_name,E.parentId=this.state.contextData.breadNav.map(_=>_.value)}),this.context.initTypeUser("groupUser",r.data.users)})},this.getPostList=l=>{var h=M.ZP.Organization.getPostTree(),v={filter_auth:!this.props.filterAuthOpen,post_id:l,user_type:this.context.userType};Ie.WY.get({url:h,params:v}).then(r=>{r.data.posts=r.data.posts||[],r.data.posts.forEach(E=>{E.parentId=this.state.contextData.breadNav.map(_=>_.value),E.userCount=E.user_count,E.name=E.post_name}),this.setState({postList:r.data.posts}),this.context.initTypeList("postList","checkedPost",r.data.posts),this.context.initHidePostsStatus(r.data.hide_posts==="true")})},this.getPostUserList=l=>{var h=M.ZP.Organization.getPostUserList({postId:l}),v={filter_auth:!this.props.filterAuthOpen,user_type:this.context.userType};Ie.WY.get({url:h,params:v}).then(r=>{r.data.users&&r.data.users.forEach(E=>{E.name=E.user_name,E.parentId=this.state.contextData.breadNav.map(_=>_.value)}),this.context.initTypeUser("postUser",r.data.users)})},this.getUserList=function(l){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;i.props.type==="dept"?i.getDeptUserList(l,h):i.props.type==="group"?i.getGroupUserList(l):i.getPostUserList(l)},this.checkOne=(l,h,v)=>{var r=this.state.checkedCount;if(h==="list"){var E=this.context[this.state.listType].find(G=>G.id===l);E.isChecked=v,E.all_name&&typeof E.all_name=="object"&&delete E.all_name,r=v?r+1:r-1,this.context.checkListOne(E,this.state.checkedListType,this.state.listType)}else if(h==="user"){var _=this.context[this.state.checkedUserType].find(G=>G.id===l);_.isChecked=v,r=v?r+1:r-1,this.context.checkUserOne(_,this.state.checkedUserType)}this.updateCheckedCount(r)},this.updateCheckedCount=l=>{this.setState({checkedCount:l})},this.checkAll=function(){var l=(0,z.Z)(T().mark(function h(v){var r,E,_,G,se,K,ie,re,oe,te,he,Te,Ze,Ue,ae;return T().wrap(function(it){for(;;)switch(it.prev=it.next){case 0:if(r=i.state,E=r.contextData,_=r.cacheId,G=[...E.breadNav].reverse(),se=(0,R.Z)(G,1),K=se[0],ie=K.value,re=[...i.context[i.state.checkedListType]],oe=K.authorized==="false",te={departments:[],users:[]},!oe){it.next=12;break}return it.next=9,ct({departmentId:ie,cache_id:_});case 9:he=it.sent,Te=he.data,te={departments:Te.departments.map(fe=>(fe.isChecked=v,fe.name=fe.department_name,fe.parentId=fe.parent_ids.split("/"),fe.parentAuthorize=!1,fe.userCount=fe.user_count,fe)),users:Te.users.map(fe=>(fe.isChecked=v,fe.name=fe.user_name,fe.parentAuthorize=!1,fe))};case 12:Ze=i.context[i.state.listType].map(fe=>{fe.isChecked=v,i.props.type!=="dept"&&re.forEach(ot=>{ot.parentId.indexOf("".concat(fe.id))!==-1&&(ot.isChecked=!1)});var Xe=re.findIndex(ot=>ot.id===fe.id);return Xe!==-1?re[Xe].isChecked=v:re.push(fe),fe}),Ue=[],i.context.checkedUser.forEach(fe=>{if(i.props.type!=="dept"){if(typeof fe.parentId!="undefined"&&fe.parentId.indexOf("".concat(ie))!==-1&&fe.parentId[fe.parentId.length-1]!==ie)return}else{var Xe=typeof fe.parentId!="undefined"?fe.parentId:fe.department_ids||[];if(Xe.indexOf(ie)!==-1)return}Ue.push(fe)}),ae=rt.includes(i.state.listType)?[]:i.context[i.state.checkedUserType].map(fe=>{fe.isChecked=v;var Xe=Ue.findIndex(ot=>ot.id===fe.id);return Xe!==-1?Ue[Xe].isChecked=v:Ue.push(fe),fe}),i.context.toggleDisplayList(i.state.checkedListType,H()(te.departments,re,"id"),i.state.listType,Ze,i.state.checkedUserType,ae,H()(te.users,Ue,"id")),i.setState({checkedCount:v?(rt.includes(i.state.listType)?0:i.context[i.state.checkedUserType].length)+i.context[i.state.listType].length:0});case 18:case"end":return it.stop()}},h)}));return function(h){return l.apply(this,arguments)}}(),this.nextLevel=(l,h,v)=>{this.context.clearTabPanelList(this.state.listType,this.state.checkedUserType);var r=[...this.state.contextData.breadNav,{value:l.id,label:h,authorized:l.authorized}];this.setState({contextData:(0,g.Z)((0,g.Z)({},this.state.contextData),{},{breadNav:r})},()=>{this.props.type==="post"?this.nextPostLevel(l.id,v):this.props.type==="dept"?this.nextDeptLevel(l.id,!(L()(l,"authorized")&&l.authorized==="true")):this.context.initTypeList("groupList","checkedGroup",[]),this.getUserList(l.id===Ye?Qe:l.id,!(L()(l,"authorized")&&l.authorized==="true"))})},this.nextDeptLevel=(l,h)=>{if(this.context.asyncDeptTree)this.getDeptList(l,h);else{var v=this.state.deptList[l];typeof v!="undefined"&&v.forEach(r=>{r.parentId=this.state.contextData.breadNav.map(E=>E.value),r.userCount=r.user_count,r.name=r.department_name}),this.context.initTypeList("deptList","checkedDept",v||[])}},this.nextPostLevel=(l,h)=>{if(h){var v=(0,st.lK)(this.state.postList,l),r=v.children.map(E=>(E.name=E.post_name,E.parentId=this.state.contextData.breadNav.concat([l]).map(_=>_.value),E.userCount=E.user_count,E));this.context.initTypeList("postList","checkedPost",r)}},this.changeLevel=(l,h,v)=>{this.context.clearTabPanelList(this.state.listType,this.state.checkedUserType);var r=this.props.type==="group"?[this.state.contextData.breadNav[0]]:this.state.contextData.breadNav.slice(0,h+1);this.setState({contextData:(0,g.Z)((0,g.Z)({},this.state.contextData),{},{breadNav:r}),isSearch:!1},()=>{this.props.type==="dept"?this.changeDeptLevel(l,v):this.props.type==="group"?this.changeGroupLevel(l):this.props.type==="cluster"?this.getClusterList():this.props.type==="class"?this.getClassList():this.changePostLevel(l)})},this.changeDeptLevel=function(l){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(i.context.asyncDeptTree)i.getDeptList(l,h);else{var v=i.state.deptList[l];v.forEach(r=>{r.parentId=i.state.contextData.breadNav.map(E=>E.value),r.userCount=r.user_count,r.name=r.department_name}),i.context.initTypeList("deptList","checkedDept",v)}i.getDeptUserList(l===Ye?Qe:l,h)},this.changePostLevel=l=>{var h=l==="1"?this.state.postList:(0,st.lK)(this.state.postList,l).children,v=h.map(r=>(r.name=r.post_name,r.parentId=this.state.contextData.breadNav.concat([l]).map(E=>E.value),r.userCount=r.user_count,r));this.context.initTypeList("postList","checkedPost",v),l!=="1"&&this.getPostUserList(l===Ye?Qe:l)},this.changeGroupLevel=l=>{l||(this.context.initTypeUser("groupUser",[]),this.context.initTypeList("groupList","checkedGroup",this.state.groupList))},this.state={postList:[],deptList:[],groupList:[],clusterList:[],classList:[],contextData:{breadNav:[this.props.defaultBreadNav],checkOne:this.checkOne,checkAll:this.checkAll,nextLevel:this.nextLevel,changeLevel:this.changeLevel},checkedCount:0,listType:"".concat(this.props.type,"List"),checkedListType:"checked".concat(this.props.type.charAt(0).toUpperCase()).concat(this.props.type.substr(1)),checkedUserType:"".concat(this.props.type,"User"),isSearch:!1,searchResult:[],loadDept:!1,loadUser:!1,cacheId:f.cacheId}}componentDidMount(){this.props.type!=="group"?this.props.type==="dept"?this.getDeptList("1").then(C=>{this.setState({contextData:(0,g.Z)((0,g.Z)({},this.state.contextData),{},{breadNav:[{value:C.id,label:C.department_name,sourceType:C.source_type,authorized:C.authorized}]})}),this.getDeptUserList("1")}):this.getPostList("1"):this.getGroupList(1),this.props.type==="cluster"&&this.getClusterList(),this.props.type==="class"&&this.getClassList()}render(){return o().createElement(J.Provider,{value:this.state.contextData},o().createElement("div",{className:"org-display-container org-display-dept"},o().createElement(je,null),this.props.type==="dept"&&(this.state.loadDept||this.state.loadUser)?o().createElement("div",{className:"dept-loading"},o().createElement(B.Z,null)):null,o().createElement(vt,{dataTypeKey:this.props.type,disableHidden:this.props.disableHidden,scrollFlag:this.props.scrollFlag})))}}Je.contextType=de;var je=(0,V.l)(J,ge),vt=(0,V.l)(J,mt);Je.defaultProps={defaultBreadNav:{value:"",label:"\u9177\u6E32\u79D1\u6280"},queryType:1,type:"dept",filterAuthOpen:!1,disableHidden:!1,scrollFlag:!1};var nt=Je,ft=a(57663),gt=a(71577),pe=a(54549);class m extends o().Component{constructor(){super(...arguments);this.removeItem=(C,f,i,l)=>{C.preventDefault(),f.isChecked=!1,l==="user"?this.context.removeCheckedUser(f):this.context.checkListOne(f,i,"".concat(l,"List"))},this.displayName=(C,f)=>{var i={user:"userName",dept:"departmentName"}[C]||"",l={user:f.unionid||f.user_id||f.userId,dept:f.id}[C]||f.id;return o().createElement(ue.Z,{value:l,name:f.name,type:f.source_type||f.sourceType,dataType:i})},this.displayItem=C=>{var f=this.context,i=f.hidePosts,l=f.showUserCount,h="checked".concat(C.charAt(0).toUpperCase()).concat(C.substr(1)),v=this.context[h].map(r=>r.isChecked&&r.authorized!=="false"?o().createElement(Se.Z,{key:r.id,placement:"top",title:r.all_name||"",getPopupContainer:()=>document.querySelector(".checked-display-container")},o().createElement("div",{className:"display-item",key:r.id},this.displayName(C,r),C==="user"||i&&C==="post"?"":l&&r.userCount>-1?"(".concat(r.userCount,")"):"",r.reserve?null:o().createElement("span",{className:"display-item-close",onClick:E=>this.removeItem(E,r,h,C)},o().createElement(pe.Z,{style:{fontSize:"8px",color:"#afb5d2"}})))):null);return v},this.handleClearSelected=()=>{this.context.clearSelectedAll()}}render(){var C=this.props.t,f=["dept","group","post","user","cluster","class"].map(i=>this.displayItem(i));return o().createElement("div",{className:"checked-display-container"},o().createElement("div",{className:"checked-display-container-header"},o().createElement("span",null,C("orgDialog.selected"),":"),o().createElement(gt.Z,{type:"link",onClick:this.handleClearSelected},C("orgDialog.clearAll"))),f)}}m.contextType=de;var p=(0,Y.Z)()(m),n=a(67222),e=a(6793),t=X.Z.Search;class s extends o().Component{constructor(C){var f;super(C);f=this,this.onChange=i=>{var l=this.props.appType,h=localStorage.getItem("qyWechatBook");if(i.preventDefault(),this.setState({value:i.target.value}),!(!i.target.value&&!this.props.showCancel)&&!this.props.disableChange){var v=l==="wx_app"&&h==="true";!(0,Ke.eY)("ORG_DIALOG_SEARCH")||v||(0,e.Ds)(this.debounceChange,500)()}},this.handleSearch=(i,l)=>{l.preventDefault(),!(!i&&!this.props.showCancel)&&this.extendReturn(i)},this.debounceChange=()=>{this.extendReturn(this.state.value)},this.extendReturn=function(){var i=(0,z.Z)(T().mark(function l(h){var v,r,E,_,G,se,K,ie,re;return T().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:if(v=f.props,r=v.appType,E=v.selectType,_=v.appId,G=localStorage.getItem("qyWechatBook"),se="",K=r==="wx_app"&&G==="true"&&_==="9005",!(h&&E==="user"&&K)){te.next=17;break}return te.prev=5,te.next=8,(0,n.F_)(h);case 8:ie=te.sent,re=ie.data,re.success&&(se=re.data),te.next=17;break;case 13:te.prev=13,te.t0=te.catch(5),console.error(te.t0),se="";case 17:f.props.onSearch(h,se);case 18:case"end":return te.stop()}},l,null,[[5,13]])}));return function(l){return i.apply(this,arguments)}}(),this.state={value:""}}render(){var C=this.props,f=C.t,i=C.selectType;return o().createElement("div",{className:"top-search"},o().createElement(t,{placeholder:f(i==="user"?"component.searchStudent":i==="dept"?"component.searchDepartment":i==="post"?"component.searchPost":i==="cluster"?"component.searchCluster":i==="class"?"component.searchClass":"setting.searchGroup"),value:this.state.value,onSearch:this.handleSearch,allowClear:!0,onChange:this.onChange}))}}var d=(0,be.$j)(w=>({appType:w.user.appType,appId:w.user.appId}))((0,Y.Z)()(s)),y=a(87312);class P extends c.Component{constructor(){super(...arguments);this.checkedAll=(C,f)=>{this.props.checkedAll(f)},this.getIsCheckedAll=()=>{var C=this.props.list,f=[].concat(C);if(f.length===0)return!1;var i=f.findIndex(l=>!l.isChecked);return i===-1},this.checkUser=(C,f)=>{f.isChecked=!f.isChecked,this.context.checkUserOne(f,"checkedUser")},this.checkSingleUser=(C,f)=>{f.isChecked=!0,this.context.checkUserOne(f,"checkedUser")},this.checkDept=(C,f)=>{f.isChecked=!f.isChecked,this.context.checkListOne(f,"checkedDept","deptList")},this.checkPost=(C,f)=>{f.isChecked=!f.isChecked,this.context.checkListOne(f,"checkedPost","postList")},this.checkGroup=(C,f)=>{f.isChecked=!f.isChecked,this.context.checkListOne(f,"checkedGroup","groupList")},this.checkedCluster=(C,f)=>{f.isChecked=!f.isChecked,this.context.checkListOne(f,"checkedCluster","clusterList")}}renderList(){var C=this.props,f=C.userListType,i=C.list,l=C.t,h=C.isSingle,v=C.hidePosts;return f==="user"&&!h?i.map(r=>o().createElement("div",{className:"search-result-item",key:r.id,onClick:E=>{this.checkUser(E,r)}},o().createElement(Pe.Z,{checked:r.isChecked},o().createElement(Be,{cardInfo:r},o().createElement("span",{className:"user-names"},o().createElement(ue.Z,{dataType:"userName",value:r.user_id,name:r.user_name,type:r.source_type}))),r.department_names&&r.department_names.length>0?o().createElement("span",{className:"user-dept"},o().createElement(We.Z,{sourceType:r.source_type,list:r.leaf_department_ids,nameList:r.department_names})):null))):f==="user"&&h?i.map(r=>o().createElement("div",{className:"search-result-item",key:r.id,onClick:E=>{this.checkSingleUser(E,r)}},o().createElement("div",{className:"user-name"},o().createElement(Be,{cardInfo:r},o().createElement(ue.Z,{dataType:"userName",value:r.user_id,name:r.user_name,type:r.source_type}))),r.department_names&&r.department_names.length>0?o().createElement("span",{className:"user-name-dept"},o().createElement(We.Z,{sourceType:r.source_type,list:r.leaf_department_ids,nameList:r.department_names})):null)):f==="dept"?i.map(r=>o().createElement("div",{className:"search-result-dept-item",key:r.id,onClick:E=>{this.checkDept(E,r)}},o().createElement(Pe.Z,{checked:r.isChecked,className:"department-left"},o().createElement("div",{className:"department-left-department"},o().createElement("div",{className:"user-name"},o().createElement(ue.Z,{dataType:"departmentName",value:r.id,name:r.department_name,type:r.source_type})),r.path&&r.path.length>0?o().createElement(Se.Z,{title:r.path.join(">"),mouseEnterDelay:.8},o().createElement("span",{className:"user-name-dept"},o().createElement(We.Z,{list:r.department_infos||[],displayAll:!0}))):null)),o().createElement("div",{className:"department-right"},"(",r.userCount,l("common.userUnit"),")"))):f==="post"?i.map(r=>o().createElement("div",{className:"search-result-dept-item",key:r.id,onClick:E=>{this.checkPost(E,r)}},o().createElement(Pe.Z,{checked:r.isChecked,className:"department-left"},o().createElement("div",{className:"department-left-department"},o().createElement("div",{className:"user-name"},r.name),r.path&&r.path.length>0?o().createElement(Se.Z,{title:r.path.join(">"),mouseEnterDelay:.8},o().createElement("span",{className:"user-name-dept"},o().createElement("span",null,r.path.join(">")))):null)),!v&&o().createElement("div",{className:"department-right"},"(",r.userCount,l("common.userUnit"),")"))):f==="group"?i.map(r=>o().createElement("div",{className:"search-result-dept-item",key:r.id,onClick:E=>{this.checkGroup(E,r)}},o().createElement(Pe.Z,{checked:r.isChecked,className:"department-left"},o().createElement("div",{className:"department-left-department"},o().createElement("div",{className:"user-name"},r.name),r.path&&r.path.length>0?o().createElement(Se.Z,{title:r.path.join(">"),mouseEnterDelay:.8},o().createElement("span",{className:"user-name-dept"},o().createElement("span",null,r.path.join(">")))):null)),o().createElement("div",{className:"department-right"},"(",r.userCount,l("common.userUnit"),")"))):f==="cluster"?i.map(r=>o().createElement("div",{className:"search-result-dept-item",key:r.id,onClick:E=>{this.checkedCluster(E,r)}},o().createElement(Pe.Z,{checked:r.isChecked,className:"department-left"},o().createElement("span",{className:"user-name"},r.name)),o().createElement("div",{className:"department-right"},"(",r.userCount,l("common.userUnit"),")"))):null}render(){var C=this.props,f=C.t,i=C.isSingle,l=this.getIsCheckedAll(),h=o().createElement("div",{className:"search-result-all"},o().createElement(Pe.Z,{checked:l,onClick:v=>this.checkedAll(v,!l)},f("common.all")));return o().createElement("div",{className:"search-result-container more-height"},this.props.list.length>0?o().createElement(o().Fragment,null,!i&&h,this.renderList()):o().createElement(y.Z,{tipText:f("component.searchUserEmpty")}))}}P.contextType=de,P.defaultProps={list:[]};var N=(0,Y.Z)()(P),b=a(18329),W=a(65202),x=a(91648),O=k.Z.TabPane,q=u.Z.Option,le={size:"large",destroyOnClose:!0,bodyStyle:{padding:"0 20px"},maskClosable:!1};class me extends o().Component{constructor(C){var f;super(C);f=this,this.onCancel=()=>{var i=this.props.onCancel;this.setState({showCancel:!1}),i&&this.props.onCancel()},this.onOk=()=>{var i=this.props.onOk,l=this.state.contextData;this.setState({showCancel:!1});var h=0;if(i){var v=[];l.checkedDept.map(K=>(h+=K.isChecked?K.user_count:0,K.isChecked&&K.authorized!=="false"?v.push((0,g.Z)((0,g.Z)({},K),{},{renderType:"dept"})):null));var r=[];l.checkedPost.map(K=>(h+=K.isChecked?K.user_count:0,K.isChecked?r.push((0,g.Z)((0,g.Z)({},K),{},{renderType:"post"})):null));var E=[];l.checkedGroup.map(K=>(h+=K.isChecked?K.user_count:0,K.isChecked?E.push((0,g.Z)((0,g.Z)({},K),{},{renderType:"group"})):null));var _=[];l.checkedUser.map(K=>{if(!K.reserve)return h+=K.isChecked?1:0,K.isChecked?_.push((0,g.Z)((0,g.Z)({},K),{},{renderType:"user"})):null});var G=[];l.checkedCluster.map(K=>{if(!K.reserve)return h+=K.isChecked?1:0,K.isChecked?G.push((0,g.Z)((0,g.Z)({},K),{},{renderType:"cluster"})):null});var se=[];if(l.checkedClass.map(K=>{if(!K.reserve)return h+=K.isChecked?1:0,K.isChecked?se.push((0,g.Z)((0,g.Z)({},K),{},{renderType:"class"})):null}),h>this.props.maxUserCount){Q.default.warn(this.props.beyondLimitTip);return}i({dept:v,post:r,group:E,user:_,cluster:G,classes:se})}},this.getListParentId=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],v=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:[],E=arguments.length>5&&arguments[5]!==void 0?arguments[5]:[];l.forEach(ie=>{ie.isChecked=!0,ie.parentId=[""],ie.userCount=ie.userCount||ie.user_count||0});var _=i.map(ie=>ie.id),G=v.map(ie=>ie.id);if(_||G){var se=M.ZP.OrgDialog.getDeptParent(),K={query_type:1,dept_ids:_,user_ids:G};Ie.WY.post({url:se,data:(0,g.Z)({},K)}).then(ie=>{var re=ie.data.data;i.forEach(oe=>{oe.isChecked=!0;var te=re.find(he=>he.id===oe.id)||{path:[]};oe.parentId=te.path[0]?te.path[0].split("/").slice(1):[],oe.userCount=te.user_count||oe.userCount||oe.user_count||0}),h.forEach(oe=>{oe.isChecked=!0;var te=re.find(he=>he.id===oe.id)||{path:[]};oe.parentId=te.path[0]?te.path[0].split("/").slice(1):[],oe.userCount=oe.userCount||oe.user_count||0}),v.forEach(oe=>{oe.isChecked=!0;var te=[];re.forEach(he=>{he.id===oe.id&&he.path.map(Te=>{te.push(...Te.split("/").slice(1))})}),oe.parentId=Array.from(new Set(te))}),r.forEach(oe=>{oe.isChecked=!0;var te=re.find(he=>he.id===oe.id)||{path:[]};oe.parentId=te.path[0]?te.path[0].split("/").slice(1):[],oe.userCount=oe.userCount||oe.user_count||0}),E.forEach(oe=>{oe.isChecked=!0;var te=re.find(he=>he.id===oe.id)||{path:[]};oe.parentId=te.path[0]?te.path[0].split("/").slice(1):[],oe.userCount=oe.userCount||oe.user_count||0}),f.setState({contextData:(0,g.Z)((0,g.Z)({},f.state.contextData),{},{checkedDept:i,checkedGroup:l,checkedPost:h,checkedUser:v,checkedCluster:r,checkedClass:E})})})}else l.length>0?f.setState({contextData:(0,g.Z)((0,g.Z)({},f.state.contextData),{},{checkedGroup:l})}):f.setState({contextData:(0,g.Z)((0,g.Z)({},f.state.contextData),{},{checkedDept:[],checkedGroup:[],checkedPost:[],checkedUser:[],checkedCluster:[],checkedClass:[],searchResult:[]})})},this.initHidePostsStatus=i=>{var l=this.state.contextData;this.setState({contextData:(0,g.Z)((0,g.Z)({},l),{},{hidePosts:i})})},this.initTypeList=(i,l,h)=>{h.forEach(v=>{var r=this.findItemIndex(v.id,l);r===-1?v.isChecked=!1:v.isChecked=this.state.contextData[l][r].isChecked}),this.setState({contextData:(0,g.Z)((0,g.Z)({},this.state.contextData),{},{[i]:h})})},this.initTypeUser=(i,l)=>{var h=l||[...this.state.contextData[i]],v=this.props.reserveUser;h.forEach(r=>{var E=this.findItemIndex(r.id,"checkedUser");v.findIndex(_=>_.id===r.id)!==-1&&(r.reserve=!0),E===-1?r.isChecked=!1:r.isChecked=this.state.contextData.checkedUser[E].isChecked}),this.setState({contextData:(0,g.Z)((0,g.Z)({},this.state.contextData),{},{[i]:h})})},this.toggleDisplayItem=(i,l)=>{var h=this.findItemIndex(i.id,l);return h===-1?l.match(/checkedPost|checkedDept|checkedGroup|checkedCluster|checkedClass/)?{[l]:this.checkListParentId(l,i),checkedUser:i.isChecked?this.checkParentId(this.state.contextData.checkedUser,i.id):this.state.contextData.checkedUser}:{[l]:[...this.state.contextData[l],i]}:l.match(/checkedPost|checkedDept|checkedGroup|checkedCluster|checkedClass/)?{[l]:this.checkListParentId(l,i),checkedUser:i.isChecked?this.checkParentId(this.state.contextData.checkedUser,i.id):this.state.contextData.checkedUser}:{checkedUser:this.getNewList(i,"checkedUser",!0),[l]:this.getNewList(i,l)}},this.toggleDisplayList=(i,l,h,v,r,E,_)=>{this.deleteAllName(l),this.deleteAllName(v),this.setState({contextData:(0,g.Z)((0,g.Z)({},this.state.contextData),{},{[i]:l,[h]:v,[r]:E,checkedUser:_})})},this.deleteAllName=i=>{i.map(l=>(l.all_name&&typeof l.all_name=="object"&&delete l.all_name,l))},this.checkUserOne=(i,l)=>{this.props.single?this.setState({contextData:(0,g.Z)((0,g.Z)({},this.state.contextData),{},{checkedUser:[i],[l]:l==="checkedUser"?[i]:this.getSingleUserList(i,l)})}):this.setState({contextData:(0,g.Z)((0,g.Z)({},this.state.contextData),this.toggleDisplayItem(i,l))})},this.dealAuthorizedFalseChecked=function(){var i=(0,z.Z)(T().mark(function l(h){var v,r,E,_,G,se,K,ie,re;return T().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return v=f.state.contextData,r=v.cacheId,E=v.checkedDept,_=v.checkedUser,G={checkedDept:[],checkedUser:[]},te.prev=2,te.next=5,ct({departmentId:h.id,cache_id:r});case 5:se=te.sent,K=se.data,ie=K.departments,re=K.users,ie.push(h),ie.map(he=>(he.isChecked=!0,he.name=he.department_name,he.parentId=he.parent_ids.split("/"),he.parentAuthorize=!1,he.userCount=he.user_count,he)),re.map(he=>(he.isChecked=!0,he.name=he.user_name,he.parentAuthorize=!1,f.toggleDisplayItem(he,"deptUser"),he)),G=(0,g.Z)((0,g.Z)({},G),{},{checkedUser:H()(re,_,"id"),checkedDept:H()(ie,E,"id")}),te.next=16;break;case 13:te.prev=13,te.t0=te.catch(2),console.error("\u83B7\u53D6\u90E8\u95E8\u7BA1\u8F96\u8303\u56F4\u51FA\u9519",te.t0);case 16:return te.abrupt("return",G);case 17:case"end":return te.stop()}},l,null,[[2,13]])}));return function(l){return i.apply(this,arguments)}}(),this.dealAuthorizedFalseUnChecked=i=>{var l=this.state.contextData,h=l.checkedDept,v=l.checkedUser,r=l.deptUser,E=[],_=h.filter(se=>se.parent_ids.split("/").indexOf(i.id)===-1),G=v.filter(se=>{var K=se.department_ids.indexOf(i.id)===-1;return K||E.push(se.id),K});return{checkedDept:_,checkedUser:G,deptUser:E.length>0?r.map(se=>(E.indexOf(se.id)>-1&&(se.isChecked=!1),se)):r}},this.checkListOne=function(){var i=(0,z.Z)(T().mark(function l(h,v,r){var E;return T().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:if(E={checkedDept:[],checkedUser:[]},!(h.authorized==="false"&&v==="checkedDept")){G.next=12;break}if(!h.isChecked){G.next=8;break}return G.next=5,f.dealAuthorizedFalseChecked(h);case 5:G.t0=G.sent,G.next=9;break;case 8:G.t0=f.dealAuthorizedFalseUnChecked(h);case 9:E=G.t0,G.next=14;break;case 12:h.parentAuthorize===!1&&h.isChecked===!1&&f.unCheckedParentDept(h,v),E=(0,g.Z)({[r]:f.getNewList(h,r,!1)},f.toggleDisplayItem(h,v));case 14:f.setState({contextData:(0,g.Z)((0,g.Z)({},f.state.contextData),E)});case 15:case"end":return G.stop()}},l)}));return function(l,h,v){return i.apply(this,arguments)}}(),this.removeCheckedUser=i=>{this.setState({contextData:(0,g.Z)((0,g.Z)({},this.state.contextData),{},{checkedUser:this.getNewList(i,"checkedUser"),deptUser:this.getNewList(i,"deptUser"),postUser:this.getNewList(i,"postUser"),groupUser:this.getNewList(i,"groupUser"),searchResult:this.getNewList(i,"searchResult")})})},this.unCheckedParentDept=(i,l)=>{var h=this.state.contextData.checkedDept,v=h.filter(_=>_.authorized==="false"&&l==="checkedUser"?i.department_ids.indexOf(_.id)>-1:l==="checkedDept"?i.parentId.indexOf(_.id)>-1:!1),r=(0,R.Z)(v,1),E=r[0];E&&(E.isChecked=!1,this.toggleDisplayItem(E,"checkedDept"),this.setState({contextData:(0,g.Z)((0,g.Z)({},this.state.contextData),{},{checkedDept:v})}))},this.checkListParentId=(i,l)=>{var h=[...this.state.contextData[i]],v=this.findItemIndex(l.id,i);return h.forEach(r=>{r.id!==l.id&&r.parentId.indexOf("".concat(l.id))!==-1?r.isChecked=!1:r.id===l.id&&(r.isChecked=l.isChecked)}),v===-1&&h.push(l),h},this.checkParentId=(i,l)=>{var h=[];return i.forEach(v=>{var r=typeof v.parentId!="undefined"?v.parentId:v.department_ids||[];r.indexOf(l)===-1&&h.push(v)}),h},this.getNewList=(i,l,h)=>{var v=[...this.state.contextData[l]],r=this.findItemIndex(i.id,l);return r===-1?h&&v.push(i):v[r].isChecked=i.isChecked,v},this.getSingleUserList=(i,l)=>{var h=[...this.state.contextData[l]];return h.forEach(v=>{v.id===i.id?v.isChecked=i.isChecked:v.isChecked=!1}),h},this.findItemIndex=(i,l)=>this.state.contextData[l].findIndex(h=>h.id===i),this.clearTabPanelList=(i,l)=>{this.setState({contextData:(0,g.Z)((0,g.Z)({},this.state.contextData),{},{[i]:[],[l]:[]})})},this.getTabs=()=>{var i=[],l,h,v=this.props,r=v.t,E=v.filterAuthOpen,_=v.disableHidden,G=v.scrollFlag,se=this.state.contextData,K=se.canUseGroups,ie=se.canUseClass;return this.state.displayType.forEach(re=>{switch(re){case"dept":i.push({label:r("component.orgDialogDeptLabel"),key:"dept",defaultBreadNav:{value:"",label:"",sourceType:""},queryType:1});break;case"group":i.push({label:r("component.orgDialogGroupLabel"),key:"group",queryType:2,defaultBreadNav:{value:"",label:r("component.userGroup")}});break;case"post":i.push({label:r("component.orgDialogPostLabel"),key:"post",defaultBreadNav:{value:"1",label:r("common.post")},queryType:3});break;case"cluster":K&&i.push({label:r("component.orgDialogClusterLabel"),key:"cluster",defaultBreadNav:{value:"",label:""},queryType:4});break;case"class":ie&&i.push({label:r("component.orgDialogClassLabel"),key:"class",defaultBreadNav:{value:"",label:""},queryType:5});break}}),i.length===1?h=o().createElement(nt,{defaultBreadNav:i[0].defaultBreadNav,queryType:i[0].queryType,type:i[0].key,filterAuthOpen:E,disableHidden:_,scrollFlag:G}):(l=i.map(re=>o().createElement(O,{tab:re.label,key:re.key},o().createElement(nt,{defaultBreadNav:re.defaultBreadNav,queryType:re.queryType,type:re.key,filterAuthOpen:E,disableHidden:_,scrollFlag:G}))),h=o().createElement(k.Z,null,l)),h},this.handleSearch=(i,l)=>{var h=this.state.selectType;h==="user"?this.getUserList(i,l):h==="dept"?this.getDeptList(i):h==="post"?this.getPostList(i):h==="cluster"?this.getClusterResult(i):h==="class"?this.getClassResult(i):this.getGroupList(i)},this.getClusterResult=i=>{var l=M.ZP.OrgDialog.getClusterList(),h={keyword:i};Ie.WY.get({url:l,params:h}).then(v=>{this.setState({showCancel:!0}),this.initTypeList("searchResult","checkedCluster",v.data.data.map(r=>({name:r.name,userCount:r.user_count,id:r.id,parentId:[""]})))})},this.getUserList=(i,l)=>{var h=M.ZP.OrgDialog.getUserByName(),v={user_name:l===""?i:"",filter_auth:!this.props.filterAuthOpen,user_type:this.props.userType,userIds:l};Ie.WY.get({url:h,params:v}).then(r=>{r.data.users&&r.data.users.forEach(E=>{E.name=E.user_name}),this.setState({showCancel:!0}),this.initTypeUser("searchResult",r.data.users||[])})},this.getDeptList=i=>{var l=M.ZP.Organization.queryDept(),h={department_name:i,filter_auth:!this.props.filterAuthOpen,user_type:this.props.userType};Ie.WY.get({url:l,params:h}).then(v=>{v.data.departments&&v.data.departments.forEach(r=>{r.name=r.department_name,r.parentId=r.parent_ids?r.parent_ids.split("/"):[],r.userCount=r.user_count}),this.setState({showCancel:!0}),this.initTypeList("searchResult","checkedDept",v.data.departments||[])})},this.getPostList=i=>{var l=M.ZP.Organization.addPost(),h={post_name:i,filter_auth:!this.props.filterAuthOpen,user_type:this.props.userType};Ie.WY.get({url:l,params:h}).then(v=>{v.data.posts&&v.data.posts.forEach(r=>{r.name=r.post_name,r.parentId=r.parent_id?r.parent_id.split("/"):[],r.userCount=r.user_count}),this.setState({hidePosts:v.data.hide_posts,showCancel:!0}),this.initTypeList("searchResult","checkedPost",v.data.posts||[])})},this.getGroupList=i=>{var l=M.ZP.Organization.getGroupList(),h={group_name:i,filter_auth:!this.props.filterAuthOpen,user_type:this.props.userType};Ie.WY.get({url:l,params:h}).then(v=>{v.data.groups&&v.data.groups.forEach(r=>{r.name=r.group_name,r.parentId=r.parent_id?r.parent_id.split("/"):[],r.userCount=r.user_count}),this.setState({showCancel:!0}),this.initTypeList("searchResult","checkedGroup",v.data.groups||[])})},this.checkAllResult=i=>{var l=this.state,h=l.selectType,v=l.contextData,r="checked".concat(h.charAt(0).toUpperCase()).concat(h.substr(1)),E=[...v[r]],_=v.searchResult.map(se=>{se.isChecked=i;var K=E.findIndex(ie=>ie.id===se.id);return K!==-1?E[K].isChecked=i:E.push(se),se}),G=E;this.setState({contextData:(0,g.Z)((0,g.Z)({},this.state.contextData),{},{[r]:G,searchResult:_})})},this.clearSelectedAll=()=>{var i=this.state.contextData,l=i.checkedDept,h=i.checkedGroup,v=i.checkedPost,r=i.checkedUser,E=i.checkedCluster,_=i.checkedClass,G=i.deptList,se=i.groupList,K=i.postList,ie=i.clusterList,re=i.classList,oe=i.deptUser,te=i.groupUser,he=i.postUser,Te=Ze=>(Ze.forEach(Ue=>{Ue.isChecked=!1}),Ze);this.setState({contextData:(0,g.Z)((0,g.Z)({},this.state.contextData),{},{checkedDept:[],checkedGroup:[],checkedPost:[],checkedUser:[],checkedCluster:[],checkedClass:[],deptList:l.length>0?Te(G):G,groupList:h.length>0?Te(se):se,postList:v.length>0?Te(K):K,clusterList:E.length>0?Te(ie):ie,classList:_.length>0?Te(re):re,deptUser:r.length>0?Te(oe):oe,groupUser:r.length>0?Te(te):te,postUser:r.length>0?Te(he):he})})},this.handleCancel=()=>{this.setState({showCancel:!1})},this.handleSelectChange=i=>{this.setState({selectType:i,contextData:(0,g.Z)((0,g.Z)({},this.state.contextData),{},{searchResult:[]})})},this.state={title:C.title||C.t("component.chooseAssignScope"),displayType:C.displayType?C.displayType:["dept"],selectType:"user",showCancel:!1,hidePosts:!1,contextData:{showUserCount:C.showUserCount,deptList:[],groupList:[],postList:[],clusterList:[],classList:[],deptUser:[],groupUser:[],postUser:[],checkedDept:[],checkedGroup:[],checkedPost:[],checkedUser:[],checkedCluster:[],checkedClass:[],searchResult:[],onlyUser:C.onlyUser,onlyDept:C.onlyDept,onlyPost:C.onlyPost,canUseGroups:C.useGroups,canUseClass:C.useClass,single:C.single,asyncDeptTree:this.props.asyncDeptTree,oneDisplayType:this.props.displayType?this.props.displayType.length<=1:!0,userType:this.props.userType,initTypeList:this.initTypeList,initTypeUser:this.initTypeUser,toggleDisplayItem:this.toggleDisplayItem,toggleDisplayList:this.toggleDisplayList,checkListOne:this.checkListOne,checkUserOne:this.checkUserOne,removeCheckedUser:this.removeCheckedUser,clearTabPanelList:this.clearTabPanelList,maxDeptUserCount:C.maxDeptUserCount,hidePosts:!1,initHidePostsStatus:this.initHidePostsStatus,cacheId:(0,x.Z)(),clearSelectedAll:this.clearSelectedAll}}}componentDidUpdate(C){if(C.visible!==this.props.visible&&this.props.visible){var f=this.props.initData,i=f.dept,l=f.group,h=f.post,v=f.user,r=f.cluster,E=f.classes;console.warn(v,"user");var _=this.props,G=_.reserveUser,se=_.t,K=_.onlyDept,ie=_.onlyPost;G.forEach(re=>{re.reserve=!0}),this.setState({title:this.props.title||se("component.chooseAssignScope"),displayType:this.props.displayType?this.props.displayType:["dept"],selectType:ie?"post":K?"dept":"user",contextData:(0,g.Z)((0,g.Z)({},this.state.contextData),{},{deptList:[],groupList:[],postList:[],deptUser:[],clusterList:[],classList:[],groupUser:[],postUser:[],searchResult:[],onlyUser:this.props.onlyUser,onlyDept:this.props.onlyDept,canUseGroups:this.props.useGroups,canUseClass:this.props.useClass,onlyPost:this.props.onlyPost,asyncDeptTree:this.props.asyncDeptTree,oneDisplayType:this.props.displayType?this.props.displayType.length<=1:!0,cacheId:(0,x.Z)()})},()=>{this.getListParentId(i,l,h,v.concat(G),r,E)})}}componentWillUnmount(){dt({cacheId:this.state.contextData.cacheId}).then(()=>{console.warn("\u6E05\u9664\u7F13\u5B58\u6210\u529F")}).catch(C=>{console.error("\u6E05\u9664\u7F13\u5B58\u5931\u8D25",C)})}render(){var C=this.getTabs(),f=this.props,i=f.t,l=f.onlyUser,h=f.onlyDept,v=f.onlyPost,r=f.displayType,E=f.useGroups,_=f.useClass,G=f.onlyChoosePost,se=(0,W.p)(),K=this.state,ie=K.showCancel,re=K.selectType,oe=K.hidePosts;return le.okText=this.props.okText||i("common.ok"),o().createElement(b.ZP,(0,A.Z)({},le,this.props.modalConfig,{visible:this.props.visible,title:this.state.title,wrapClassName:[this.props.className,"cl-org-modal"],onCancel:this.onCancel,onOk:this.onOk}),o().createElement(de.Provider,{value:this.state.contextData},o().createElement("div",{className:"cl-org"},o().createElement("div",{className:"cl-org-left"},this.props.visible?o().createElement("div",{className:"cl-org-left__top"},o().createElement(X.Z.Group,{compact:!0},o().createElement(u.Z,{className:"cl-org-left__top__select",value:re,style:{width:80},onChange:this.handleSelectChange},o().createElement(q,{value:"user",disabled:h||v||G},i("authGroup.userLabel")),o().createElement(q,{value:"dept",disabled:l||G},i("setting.deptLabel")),o().createElement(q,{value:"post",disabled:!v&&(h||l)||r.length===1},i("common.post")),o().createElement(q,{value:"group",disabled:h||l||r.length===1||G},i("component.userGroup")),E?o().createElement(q,{value:"cluster"},i("component.useCluster")):null,_?o().createElement(q,{value:"class"},i("component.useClass")):null),o().createElement(d,{selectType:re,onSearch:this.handleSearch,showCancel:ie,disableChange:this.props.disableChange})),ie?o().createElement("div",{className:"cl-org-left__top__cancel",onClick:this.handleCancel,style:{color:se}},i("common.cancel")):null):null,ie?o().createElement(N,{isSingle:this.props.single,list:this.state.contextData.searchResult,userListType:re,checkedAll:this.checkAllResult,hidePosts:oe}):C),o().createElement("div",{className:"cl-org-right"},o().createElement(p,null)))))}}me.defaultProps={visible:!0,showUserCount:!0,displayType:["dept","group","post","cluster","class"],initData:{dept:[],post:[],group:[],user:[],cluster:[],classes:[]},reserveUser:[],onlyUser:!1,onlyDept:!1,onlyPost:!1,useGroups:!1,useClass:!1,asyncDeptTree:!0,userType:"active",single:!1,maxUserCount:Infinity,filterAuthOpen:!1,disableHidden:!1,beyondLimitTip:"",onOk:()=>{},modalConfig:{},maxDeptUserCount:0,onlyChoosePost:!1,scrollFlag:!1};var ye=(0,Y.Z)()(me)},36202:function(Ee,ne,a){"use strict";a.d(ne,{f:function(){return $}});var A=a(62029),S=a(57361),X=a(33565),R=a(9754),z=a.n(R),Z=a(12924),Q=a.n(Z),g=a(28175),U=a(41647),u=a(93485);function D(H){var j={};if(H.length===0)return j;var B=(0,u.Z)(H),ee;try{for(B.s();!(ee=B.n()).done;){var L=ee.value,V=L,M=V.field,F=V.fixed,J=V.order,ce=V.show;ce?ce==="true"||ce===!0?j[M]={fixed:F,order:J,show:!0}:j[M]={fixed:F,order:J,show:!1}:j[M]={fixed:F,order:J,show:!0}}}catch(de){B.e(de)}finally{B.f()}return j}function k(H){var j=[],B=Object.entries(H);if(B.length===0)return j;for(var ee=0,L=B;ee<L.length;ee++){var V=L[ee],M=(0,X.Z)(V,2),F=M[0],J=M[1],ce=J.fixed,de=J.order,Ce=J.show;j.push({field:F,show:Ce,fixed:ce,order:de})}return j}var I=a(38642),T=(H,j)=>{var B=(0,Z.useState)(H),ee=(0,X.Z)(B,2),L=ee[0],V=ee[1];return(0,Z.useEffect)(()=>{var M=setTimeout(()=>{V(H)},j);return()=>{clearTimeout(M)}},[H,j]),L},c=T;function o(H,j){var B=useRef(j);useEffect(()=>{B.current=j},[j]),useEffect(()=>{var ee=L=>{var V,M;console.warn(H.current,"node.current",L.target),!((V=(M=H.current)===null||M===void 0?void 0:M.contains(L.target))!==null&&V!==void 0?V:!1)&&B.current&&B.current()};return document.addEventListener("mousedown",ee),()=>{document.removeEventListener("mousedown",ee)}},[H])}var Y=!1;function $(H){var j=(0,Z.useState)({}),B=(0,X.Z)(j,2),ee=B[0],L=B[1],V=H.prefixCls,M=H.rowKey,F=H.columnEmptyText,J=H.pagination,ce=H.headerTitle,de=H.toolBarRender,Ce=H.size,ve=H.loading,ue=ve===void 0?!1:ve,De=H.tableUUID;De||console.error("tableUUID is required!!!"),(0,Z.useEffect)(()=>{function Pe(Oe){return xe.apply(this,arguments)}function xe(){return xe=(0,S.Z)(z().mark(function Oe(we){var Se,Ae,Le,Re,Ve,_e,Me,Fe;return z().wrap(function(be){for(;;)switch(be.prev=be.next){case 0:return be.next=2,(0,I.Kb)((0,U.U)(we));case 2:if(Se=be.sent,Ae=(0,X.Z)(Se,2),Le=Ae[0],Re=Ae[1],!Le){be.next=8;break}return be.abrupt("return");case 8:Ve=Re.data,_e=Ve.data,Me=_e.fields,Fe=D(Me)||{},Fe&&(Y=!1,L(Fe));case 13:case"end":return be.stop()}},Oe)})),xe.apply(this,arguments)}return De&&Pe(De),()=>{Y=!1}},[De]);var ge=c(ee,1e3);(0,Z.useEffect)(()=>{!Y||(0,U.I)(De,k(ee))},[ge]);function ke(Pe){Y=!0,L(Pe)}return Q().createElement("div",{className:"SampleProTable_container ".concat(H.className)},Q().createElement(g.ZP,(0,A.Z)({size:Ce||"middle",rowKey:M||"id",columnEmptyText:F||!1,pagination:J||!1,options:{density:!1,fullScreen:!1,reload:!1,setting:!0},search:!1,loading:ue,headerTitle:ce||"",toolBarRender:de||null,columnsStateMap:ee,onColumnsStateChange:ke},H,{className:"".concat(V,"-table")})))}},41647:function(Ee,ne,a){"use strict";a.d(ne,{I:function(){return X},U:function(){return R}});var A=a(37055),S=a(10237);function X(z){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],Q=A.ZP.tableHeader.save(),g={fields:Z,key:z};return S.WY.post({url:Q,data:g})}function R(z){var Z=A.ZP.tableHeader.get(z);return S.WY.get({url:Z})}},99891:function(Ee,ne,a){"use strict";var A=a(12924),S=a.n(A),X=a(28216),R=a(91768),z=a(37055),Z=a(10237),Q=a(60667);class g extends S().PureComponent{constructor(D){super(D);this.getWaterMarkText=k=>{var I=this.props.userInfo,T=I.jobNumber,c=localStorage.getItem("waterMarkPostName"),o=[],Y=k.find(H=>H.type==="content_setting"),$=k.find(H=>H.type==="content_custom");return Y.param.comment.indexOf("name")!==-1&&this.setState({isUserName:!0}),$.param.checked==="true"&&$.param.comment[0]!==""&&this.setState({commentText:$.param.comment[0]}),Y.param.comment.indexOf("position")!==-1&&c&&c!==""&&o.push("".concat(c)),Y.param.comment.indexOf("jobnumber")!==-1&&T&&T!==""&&o.push("".concat(T)),o.join("-")},this.getWaterMarkApplication=k=>{var I=this.props.scenes,T=k.find(c=>c.type==="application_scenario");T.param.comment.indexOf(I)!==-1&&this.setState({showWaterMark:!0})},this.getWaterIsDispersive=k=>{var I=k.find(T=>T.type==="dispersive");this.setState({isDispersive:I.param.checked==="true"})},this.getDynamicSet=()=>{var k=z.ZP.advancedSetting.dynamicWaterMarkNew(),I={access_token:window.localStorage.getItem("token")};Z.WY.get({url:k,params:I}).then(T=>{var c=JSON.parse(T.data.actions);this.setState({waterMarkText:this.getWaterMarkText(c),actions:c}),this.getWaterMarkApplication(c),this.getWaterIsDispersive(c)})},this.state={showWaterMark:!1,waterMarkText:"",waterMarkCount:50,isUserName:!1,isDispersive:!1,actions:{},commentText:""}}componentDidMount(){var D=localStorage.getItem("waterMarkPostName");D===""||D===null?this.getPostName():this.getDynamicSet()}getPostName(){var D=z.ZP.advancedSetting.getPostName();Z.WY.get({url:D}).then(k=>{localStorage.setItem("waterMarkPostName",k.data.post_names[0]||""),this.getDynamicSet()})}render(){var D=this.state,k=D.showWaterMark,I=D.waterMarkCount,T=D.isUserName,c=D.isDispersive,o=D.waterMarkText,Y=D.actions,$=D.commentText,H=this.props.userInfo,j=H.name,B=H.unionid,ee=H.sourceType;return S().createElement("div",{className:"common-watermark"},k&&new Array(I).fill(0).map((L,V)=>S().createElement("div",{key:V,className:"common-watermark-item ".concat(c?"isDispersive":"")},S().createElement("span",{className:"common-watermark-item-content"},$!==""&&S().createElement("span",{className:"item-part"},$),T&&S().createElement("span",null,$!==""&&S().createElement("span",null,"-"),S().createElement(Q.Z,{dataType:"userName",value:B,name:j,type:ee})),S().createElement("span",{className:"item-part"},(T||$!=="")&&o!==""&&S().createElement("span",null,"-"),o)))))}}var U=u=>({userInfo:u.user});ne.Z=(0,X.$j)(U)((0,R.Z)()(g))},80430:function(Ee,ne,a){"use strict";var A=a(12924),S=a.n(A),X=a(60667),R=z=>{var Z=function(){var k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{department_ids:[],department_names:[]},I=k.department_ids.split("/"),T=k.department_names.split("/"),c=I.map((o,Y)=>S().createElement(X.Z,{key:o,dataType:"departmentName",value:o,name:T[Y],type:k.source_type}));return S().createElement(S().Fragment,null,c.map((o,Y)=>S().createElement("span",{key:o},o,Y===T.length-1?"":"/")))},Q=D=>S().createElement(X.Z,{dataType:"departmentName",value:D.department_id,name:D.department_name,type:D.source_type}),g=()=>{var D=z.list,k=D===void 0?[]:D,I=z.isBlock;if(!k.length)return null;var T=k.map(c=>Z(c));return T.length&&T.length>1?S().createElement(S().Fragment,null,T.map((c,o)=>I?S().createElement("div",{key:c},c):S().createElement("span",{key:c},c,o===T.length-1?"":"\uFF0C"))):S().createElement(S().Fragment,null,T[0]||"")},U=()=>{var D=z.list,k=z.nameList,I=z.sourceType,T=z.isBlock,c=D.map((o,Y)=>Q({department_id:o,department_name:k[Y],source_type:I}));return S().createElement(S().Fragment,null,c.map((o,Y)=>T?S().createElement("div",{key:o},o):S().createElement("span",{key:o},o,Y===c.length-1?"":"\uFF0C")))},u=()=>z.displayAll?g():U();return u()};R.defaultProps={list:[],nameList:[],sourceType:"",displayAll:!1,isBlock:!1},ne.Z=R},60667:function(Ee,ne,a){"use strict";a.d(ne,{Z:function(){return g}});var A=a(33565),S=a(12924),X=a.n(S),R=a(28216);function z(U){var u=U.type,D=U.openid,k=U.from,I=(0,S.useRef)(null);return(0,S.useLayoutEffect)(()=>{k==="vue"?window.parent.WWOpenData.bind(I.current):WWOpenData.bind(I.current)}),X().createElement("ww-open-data",{ref:I,type:u,openid:D})}var Z=U=>{var u=U.wxWorkApiFlag,D=U.appType,k=U.from,I=(0,S.useState)(!1),T=(0,A.Z)(I,2),c=T[0],o=T[1];(0,S.useEffect)(()=>{var H=localStorage.getItem("qyWechatBook");(D!=="wx_app"||u||H==="false"||k==="vue"||k==="taro")&&o(!0)},[u,D,k]);var Y=(0,S.useCallback)(()=>{var H=U.type,j=U.value,B=U.name,ee=B===void 0?"":B;switch(console.warn(U,"props"),H){case"wx_sync":{var L=U.dataType;return j?X().createElement(z,{from:k,type:L,openid:j}):ee}default:return ee}},[U]),$=()=>{var H=U.name,j=U.dataType,B=localStorage.getItem("qyWechatBook");if(j===""||B==="false")return H;if(k==="vue"||k==="taro")return Y();switch(U.appType){case"wx_app":return Y();default:return H}};return c?$():U.name};Z.defaultProps={value:"",name:"",type:"",dataType:"",from:""};var Q=U=>({appType:U.user.appType,wxWorkApiFlag:U.user.wxWorkApiFlag}),g=(0,R.$j)(Q)(Z)},48479:function(Ee,ne,a){"use strict";var A=a(62029),S=a(57361),X=a(47673),R=a(4107),z=a(9754),Z=a.n(z),Q=a(12924),g=a.n(Q),U=a(91768),u=a(94184),D=a.n(u),k=a(28216),I=a(84874),T=a(67222),c=a(2396),o=R.Z.Search;class Y extends g().Component{constructor(H){var j;super(H);j=this,this.clear=()=>{this.setState({searchValue:""})},this.renderEnterButton=()=>g().createElement(I.Z,{iconClass:"icon-icon_serarchx1"}),this.handleSearch=function(){var B=(0,S.Z)(Z().mark(function ee(L){var V,M,F,J,ce,de,Ce,ve,ue;return Z().wrap(function(ge){for(;;)switch(ge.prev=ge.next){case 0:if(V=j.props,M=V.appType,F=V.exChange,J=V.appId,ce=localStorage.getItem("qyWechatBook"),de="",Ce=M==="wx_app"&&ce==="true"&&F&&J==="9005",!(L&&Ce)){ge.next=17;break}return ge.prev=5,ge.next=8,(0,T.F_)(L);case 8:ve=ge.sent,ue=ve.data,ue.success?de=ue.data:de="",ge.next=17;break;case 13:ge.prev=13,ge.t0=ge.catch(5),console.error(ge.t0),de="";case 17:j.props.onSearch(L,de);case 18:case"end":return ge.stop()}},ee,null,[[5,13]])}));return function(ee){return B.apply(this,arguments)}}(),this.handleChange=B=>{var ee=B.target.value,L=B.type,V=ee;this.props.LimitLength&&(0,c.$s)(ee)>this.props.LimitLength&&(V=ee.substring(0,(0,c.rw)(ee,this.props.LimitLength))),this.setState({searchValue:V});var M=!1;this.props.onSearch&&(L==="click"&&(M=!0),this.props.immediate&&L==="change"&&(M=!0)),M&&this.handleSearch(ee)},this.state={searchValue:""}}componentDidMount(){this.props.onRef&&this.props.onRef(this)}componentWillReceiveProps(H){H.onRef&&H.onRef(this)}render(){var H=this.state.searchValue,j=this.props,B=j.prefixCls,ee=j.placeholder,L=j.width,V=j.maxLength,M=V===void 0?400:V,F=j.height,J=j.immediate,ce=j.value,de=D()(["".concat(B)]),Ce={width:L,height:F},ve={};return ce&&(ve.value=ce),g().createElement(o,(0,A.Z)({className:de,style:Ce,value:H,placeholder:ee,onSearch:this.handleSearch,onChange:this.handleChange,maxLength:M,allowClear:!0,defaultValue:ce,immediate:J.toString()},ve))}}Y.defaultProps={prefixCls:"cl-search-input",placeholder:"Search",value:null,onSearch:()=>{},onChange:()=>{},immediate:!1,onRef:()=>{}},ne.Z=(0,k.$j)($=>({appType:$.user.appType,appId:$.user.appId}))((0,U.Z)()(Y))},71068:function(Ee,ne,a){"use strict";var A=a(66456),S=a(55313),X=a(12924),R=a.n(X),z=a(57119),Z=a(91768),Q=a(18329);class g extends R().Component{constructor(u){super(u);this.onOk=()=>{this.props.delete(),this.props.cancel()},this.onCancel=()=>{this.props.cancel()},this.state={}}render(){var u=this.props,D=u.record,k=u.columns,I=u.title,T=u.desc,c=u.visible,o=u.t;return R().createElement(Q.ZP,{title:I,visible:c,pagination:!1,onOk:this.onOk,onCancel:this.onCancel},R().createElement("div",{className:"delete-list-tip"},R().createElement("div",{className:"icon-left"},R().createElement(z.Z,{style:{fontSize:"40px",color:"#faad14"}})),R().createElement("div",{className:"title-info"},R().createElement("span",null,o("personnelDevelope.deleteTitleInfo")),R().createElement("span",null,T))),R().createElement(S.Z,{columns:k,dataSource:D,pagination:!1}))}}ne.Z=(0,Z.Z)()(g)},76466:function(Ee,ne,a){"use strict";a.d(ne,{Z:function(){return gt}});var A=a(20228),S=a(11382),X=a(57663),R=a(71577),z=a(62029),Z=a(57361),Q=a(9754),g=a.n(Q),U=a(12924),u=a.n(U),D=a(91512),k=a(68654),I=a(91768),T=a(4412),c=a.n(T);class o extends u().Component{render(){var m=this.props.t;return u().createElement("div",{className:"net-preview"},u().createElement("div",{className:"net-preview-center"},u().createElement("img",{src:c(),alt:"picture"}),u().createElement("h2",null,m("localStorage.tip")),u().createElement("p",null,m("localStorage.banPreview"))))}}var Y=(0,I.Z)()(o),$=a(88986),H=a(34792),j=a(48086),B=a(28216),ee=a(21594),L=a(41225),V=a(10237),M=(pe,m)=>(0,$.Z)({id:pe||"J_prismPlayer",width:"100%",controlBarVisibility:"hover",showBuffer:!0,preload:!0,source:"",definition:"FD,OD",defaultDefinition:"OD",autoplay:!1,skinLayout:[{name:"bigPlayButton",align:"blabs",x:30,y:80},{name:"H5Loading",align:"cc"},{name:"errorDisplay",align:"tlabs",x:0,y:0},{name:"controlBar",align:"blabs",x:0,y:0,children:[{name:"progress",align:"tlabs",x:0,y:0},{name:"playButton",align:"tl",x:15,y:13},{name:"timeDisplay",align:"tl",x:10,y:6},{name:"volume",align:"tr",x:20,y:11}]}]},m),F=M;class J extends U.Component{constructor(){super(...arguments);this.setupPlayer=m=>{var p=this.props,n=p.onVideoReady,e=n===void 0?()=>{}:n,t=p.playerConfig,s=p.contentType;m&&m==="resetPlayer"&&this.dispose(),this.player=new window.CoolPlayer((0,$.Z)((0,$.Z)({},t),{},{contentType:s==="mp3"?"audio":"video",audioPoster:"".concat("https://oss.coolcollege.cn","/1814929291192963072.png"),source:t.source,autoplay:t.autoplay,width:t.width,id:t.id,height:"100%",platform:"pc",controlBarVisibility:"hover",enableCustomController:!1,core:"aliplayer",init:d=>{d.on("sourceloaded",y=>{var P=y.paramData,N=P.desc,b=P.definition;d.getComponent("VideoQuality")&&d.getComponent("VideoQuality").setCurrentQuality(N,b,t.id)}),d.on("ready",()=>{e()}),this.playerInstance=d,this.setPlayerConfig()}}))}}componentDidUpdate(m){m.playerConfig.source!==this.props.playerConfig.source&&this.props.playerConfig.source!==""&&(this.playingVideo={},this.setupPlayer())}dispose(){this.player&&this.player.dispose()}seek(m){this.player&&this.player.seek(m)}exitFull(){this.player&&this.player.exitFull()}play(){this.player.play()}pause(){this.player.pause()}getCurrentTime(){return this.player.getCurrentTime()}getDuration(){return this.player.getDuration()}setSpeed(m){this.player.setSpeed(m)}getStatus(){return this.player.playStatus}replay(){this.player.replay()}setPlayerConfig(){var m=this.props,p=m.onPlay,n=p===void 0?()=>{}:p,e=m.onTimeUpDate,t=e===void 0?()=>{}:e,s=m.onEnd,d=s===void 0?()=>{}:s,y=m.onPause,P=y===void 0?()=>{}:y,N=m.onError,b=N===void 0?()=>{}:N,W=this.playerInstance;W.on("play",()=>{n()}),W.on("pause",()=>{P()}),W.on("timeupdate",x=>{t(x)}),W.on("ended",()=>{d()}),W.on("error",(0,Z.Z)(g().mark(function x(){return g().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:b();case 1:case"end":return q.stop()}},x)})))}render(){var m=this.props.playerConfig;return u().createElement("div",{className:"common-video-player-container"},u().createElement("div",{id:m.id}))}}J.playerInstance=null,J.defaultProps={playerConfig:F(),autoPlay:!1,contentType:"mp4",playingVideo:{recentStart:0,progress:0,duration:0,auditionType:0,auditionLength:0}};var ce=J,de=(pe,m)=>(0,$.Z)({id:pe||"J_prismPlayer",width:"100%",controlBarVisibility:"hover",showBuffer:!0,preload:!0,source:"",definition:"FD,OD",defaultDefinition:"OD",autoplay:!1,skinLayout:[{name:"bigPlayButton",align:"blabs",x:30,y:80},{name:"H5Loading",align:"cc"},{name:"errorDisplay",align:"tlabs",x:0,y:0},{name:"controlBar",align:"blabs",x:0,y:0,children:[{name:"progress",align:"tlabs",x:0,y:0},{name:"playButton",align:"tl",x:15,y:13},{name:"timeDisplay",align:"tl",x:10,y:6},{name:"volume",align:"tr",x:20,y:11}]}]},m),Ce=de;class ve extends U.Component{constructor(){super(...arguments);this.setupPlayer=m=>{m&&m==="resetPlayer"&&this.player.dispose();var p=this.props,n=p.playerConfig,e=p.onVideoReady,t=e===void 0?()=>{}:e;this.player=new Aliplayer(n,s=>{s.on("sourceloaded",d=>{var y=d.paramData,P=y.desc,N=y.definition;s.getComponent("VideoQuality")&&s.getComponent("VideoQuality").setCurrentQuality(P,N,n.id)})}),this.player.on("ready",()=>{t()})},this.setPlayerConfig=()=>{var m=this.props,p=m.onPlay,n=p===void 0?()=>{}:p,e=m.onTimeUpDate,t=e===void 0?()=>{}:e,s=m.onEnd,d=s===void 0?()=>{}:s,y=m.onPause,P=y===void 0?()=>{}:y,N=m.onError,b=N===void 0?()=>{}:N;this.player.on("play",()=>{n()}),this.player.on("pause",()=>{P()}),this.player.on("timeupdate",W=>{t(W)}),this.player.on("ended",()=>{d()}),this.player.on("error",(0,Z.Z)(g().mark(function W(){return g().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:b();case 1:case"end":return O.stop()}},W)})))},this.getPlayerContent=m=>{this.playerContainer=m}}componentDidMount(){this.player&&this.dispose(),this.setupPlayer(),this.playingVideo={}}componentDidUpdate(m){m.playerConfig.source!==this.props.playerConfig.source&&this.props.playerConfig.source!==""&&(this.playingVideo={},this.player&&this.player._el.id===this.props.playerConfig.id&&this.dispose(),this.setupPlayer())}dispose(){this.player.dispose()}seek(m){this.player.seek(m)}exitFull(){var m=this.player.fullscreenService;m&&m.isFullScreen&&m.cancelFullScreen()}play(){this.player.play()}pause(){this.player.pause()}getCurrentTime(){return this.player.getCurrentTime()}getDuration(){return this.player.getDuration()}setSpeed(){this.player.setSpeed()}getStatus(){return this.player.getStatus()}render(){var m=this.props.playerConfig;return u().createElement("div",{className:"common-video-player-container"},u().createElement("div",{id:m.id,ref:this.getPlayerContent,style:{width:"100%",height:"100%"}}))}}ve.defaultProps={source:{FD:"",OD:""},autoPlay:!1,contentType:"mp4",playingVideo:{recentStart:0,progress:0,duration:0,auditionType:0,auditionLength:0},speedSwitch:!1,playerId:"J_prismPlayer",playerConfig:Ce()};var ue=ve;class De{constructor(m){this.hasCreated=!1,this.definition="",this.getQuality=m}createEl(m,p){var n=p._options&&p._options.language,e=p._el.id;this.isEn=n&&n==="en-us";var t=(0,ee.O8)(`<div class="quality-components">
      <div class="current-quality" data-ref="">`.concat(this.isEn?"Resolution":"\u6E05\u6670\u5EA6",`</div>
      <ul class="quality-list" ></ul>
    </div>`)),s=(0,ee.O8)('<div class="quality-modal"><span class="switchimg">'.concat(this.isEn?"Switching to you for":"\u6B63\u5728\u4E3A\u60A8\u5207\u6362\u5230",'</span><span class="current-quality-tag"></span> ,<span class="wait">').concat(this.isEn?"Please wait...":"\u8BF7\u7A0D\u540E...","</span></div>")),d=document.querySelector("#".concat(e," .prism-controlbar"));d.appendChild(t),m.appendChild(s)}setCurrentQuality(m,p,n){var e=document.querySelector("#".concat(n," .current-quality"));e.innerText=m,e.dataset.def=p,this.definition=p;var t=document.querySelector("#".concat(n," .quality-list")),s=t.querySelector(".current");s&&(s.className="");var d=t.querySelector('li[data-def="'.concat(p,'"]'));d&&(d.className="current")}created(m){this._urls=m._urls;var p=m._el.id,n=document.querySelector("#".concat(p," .current-quality")),e=document.querySelector("#".concat(p," .quality-list")),t=document.querySelector("#".concat(p," .quality-modal")),s=this._urls.map(P=>'<li data-def="'.concat(P.definition,'">').concat(P.desc,"</li>"));if(e.innerHTML=s.join(""),this.hasCreated==!1&&this.definition){var d=e.querySelector('li[data-def="'.concat(this.definition,'"]'));d.className="current"}this.hasCreated=!0;var y=null;n.onclick=()=>{e.style.display="block"},n.onmouseleave=()=>{y=setTimeout(()=>{e.style.display="none"},100)},e.onmouseenter=()=>{clearTimeout(y)},e.onmouseleave=()=>{e.style.display="none"},e.onclick=P=>{var N=P.target,b=N.dataset.def,W=N.innerText;if(b&&N.className!=="current"){var x=this._urls.find(O=>O.definition===b);m.loadByUrl(x.Url,m.getCurrentTime(),!0,!0),this.setCurrentQuality(x.desc,x.definition,p),t.style.display="block",t.querySelector("span.current-quality-tag").innerText=x.desc}this.getQuality(b,W)}}ready(m){var p=m._el.id,n=document.querySelector("#".concat(p," .quality-modal"));n.style.display="none";var e=document.querySelector("#".concat(p," .prism-setting-item.prism-setting-quality"));e&&e.classList.add("player-hidden")}}class ge{createEl(m,p){var n=p._el.id,e=(0,ee.O8)(`<div class="rate-components">
      <div class="current-rate">1.0x</div>
      <ul class="rate-list"><li data-rate="2.0">2.0x</li><li data-rate="1.5">1.5x</li><li data-rate="1.25">1.25x</li><li data-rate="1.0" class="current">1.0x</li><li data-rate="0.5">0.5x</li></ul>
    </div>`),t=document.querySelector("#".concat(n," .prism-controlbar"));t.appendChild(e)}ready(m){var p=m._el.id,n=document.querySelector("#".concat(p," .current-rate")),e=document.querySelector("#".concat(p," .rate-list")),t=null,s=document.querySelector("#".concat(p," .prism-setting-item.prism-setting-speed"));s&&s.classList.add("player-hidden"),n.onclick=()=>{e.style.display="block"},n.onmouseleave=()=>{t=setTimeout(()=>{e.style.display="none"},100)},e.onmouseenter=()=>{clearTimeout(t)},e.onmouseleave=()=>{e.style.display="none"},e.onclick=d=>{var y=d.target,P=y.dataset.rate;if(P){if(m.setSpeed(P),y.className!=="current"){var N=e.querySelector(".current");N&&(N.className=""),y.className="current"}e.style.display="none",n.innerText="".concat(P,"x")}}}}var ke=a(69164),Pe=a(37055);function xe(pe){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},p=Pe.ZP.local.getLocalUrl(pe);return V.WY.get({url:p,params:m})}var Oe=a(91648),we=a(18329),Se=a(38642),Ae=a(9849),Le=a(99891);class Re extends U.Component{constructor(m){super();this.WaterMarkText=m,this.html=document.getElementsByClassName("common-watermark")}createEl(m){setTimeout(()=>{m.appendChild(this.html[0]?this.html[0]:null)},2e3)}}var Ve=Re,_e=pe=>({userInfo:pe.user});class Me extends U.Component{constructor(m){var p;super(m);p=this,this.onVideoReady=n=>{var e=this.props,t=e.resourceInfo,s=e.mode,d=e.autoPlay,y=e.t,P=t.storageType;n==="resetPlayer"?(this.play.play(),this.play.seek(this.playingVideo.recentStart),this.playingVideo.readyCount===0?this.play.setPlayerConfig():this.updateSource(n),this.playingVideo.readyCount=1):(this.playingVideo.readyCount===0?(s==="learn"&&this.readyPlayerTips(),this.play.setPlayerConfig(),s==="preview"&&d&&this.play.play()):P==="ALIBABA_PRIVATE"||P==="LOCAL"?this.updateSource("resetPlayer"):(V.WY.logger({keyword:"video",moduleName:"video-play",msg:y("component.videoResourceErrorTips"),data:{playingVideo:this.playingVideo,props:this.props,state:this.state}}),this.play.pause()),this.playingVideo.readyCount=1)},this.onTimeUpDate=()=>{var n=this.props,e=n.draggable,t=n.mode,s=n.t,d=n.studyInfo,y=n.needCurrentTime,P=n.onCurrentTime,N=P===void 0?()=>{}:P,b=d.studyType,W=d.studyId,x=d.resourceId,O=this.state,q=O.showPreventHang,le=O.dragSwitch,me=O.showRandomAlert,ye=O.randomAlertDialogVisible,w=this.playingVideo,C=w.oneTime,f=w.popupWindowCount,i=w.maxPlayTime,l=w.progress,h=w.auditionLength,v=w.auditionType,r=w.duration,E=w.recentStart,_=this.play.getCurrentTime(),G=(q==="OPEN"||me==="OPEN")&&f>0;if(y&&N(_),h>0&&v===2&&_>h&&(this.play.seek(h),j.default.warning(s("component.haveALookOverTip")),this.play.pause()),t==="learn"&&G){var se=r-C*f;if(f>0&&_>se)if(this.play.pause(),me==="OPEN"){if(!ye){var K=(0,Oe.Z)();this.setState({randomAlertDialogVisible:!0,randomAlertUUID:K},()=>{(0,L.qp)({popupId:K,planId:W,resourceId:x,type:"popup_start"})}),this.play.exitFull()}}else q==="OPEN"&&(this.setState({dialogVisible:!0}),this.play.exitFull())}if((e||l===100)&&(_>0&&(this.playingVideo.recentStart=_),!((b==="enterprise"||b==="studyProject")&&le==="OPEN")))return!1;_>i?_-E>2?(this.playingVideo.recentStart=i,this.play.seek(i),j.default.warning(s("component.preventFastWatchTip"))):(this.playingVideo.recentStart=_,this.playingVideo.maxPlayTime=_):_>0&&_>this.playingVideo.recentStart&&(this.playingVideo.recentStart=_)},this.onPlay=()=>{var n=this.props,e=n.mode,t=n.onPlay,s=t===void 0?()=>{}:t;s();var d=this;e==="learn"&&!d.timer&&(d.timer=setTimeout(function y(){d.saveProgress(),clearTimeout(d.timer),d.timer=setTimeout(y,2e4)},2e4))},this.onPause=()=>{var n=this.props,e=n.studyInfo,t=n.mode,s=e.studyType;clearTimeout(this.timer),this.timer=null,t==="learn"&&(s==="platform"||s==="enterprise"||s==="studyTask")&&this.saveProgress()},this.onEnd=()=>{var n=this.props.mode;n==="learn"&&this.saveProgress()},this.onError=n=>{var e=this.props.resourceInfo,t=e.storageType;(t==="ALIBABA_PRIVATE"||t==="LOCAL")&&this.updateSource("resetPlayer")},this.initInfo=()=>{var n=this.props.mode;this.initPlayVideo(),n==="learn"&&this.saveProgress(),this.dealAudioPoster(),this.getInfoFromSettings()},this.handleCancel=()=>{this.setState({dialogVisible:!1})},this.handleRandomCancel=()=>{this.setState({randomAlertDialogVisible:!1,randomAlertUUID:""})},this.playingVideo={},this.readyPlayerTips=()=>{var n=this.state,e=n.showPreventHang,t=n.showRandomAlert,s=this.props,d=s.t,y=s.playingVideo,P=s.studyInfo,N=s.autoPlay,b=y.recentStart,W=y.duration,x=y.progress,O=P.studyType,q=(e==="OPEN"||t==="OPEN")&&(O==="studyTask"||O==="enterprise"||O==="studyProject")&&x<100;q?(t==="OPEN"?this.setState({promptMessage:d("component.preventAlertTip"),dialogVisible:!0}):e==="OPEN"&&this.setState({promptMessage:d("component.preventHangUpTip"),dialogVisible:!0}),this.playerShowPreventHang()):N&&(this.play.play(),Math.ceil(b)<parseInt(W)&&this.play.seek(b))},this.playerShowPreventHang=()=>{var n=this.playingVideo,e=n.duration,t=n.recentStart,s=0;e>0&&e<180?(s=e/2,this.playingVideo.oneTime=s,t>=s?this.playingVideo.popupWindowCount=0:this.playingVideo.popupWindowCount=1):e>=180&&e<600?(s=e/3,this.playingVideo.oneTime=s,t>=2*s?this.playingVideo.popupWindowCount=0:t>=s?this.playingVideo.popupWindowCount=1:this.playingVideo.popupWindowCount=2):(s=e/4,this.playingVideo.oneTime=s,t>=3*s?this.playingVideo.popupWindowCount=0:t>=2*s?this.playingVideo.popupWindowCount=1:t>=s?this.playingVideo.popupWindowCount=2:this.playingVideo.popupWindowCount=3)},this.initPlayVideo=()=>{var n=this.props,e=n.playingVideo,t=n.mode;if(t==="learn"){this.playingVideo=(0,$.Z)({},e);var s=e.duration,d=e.progress;this.playingVideo.hasFinished=parseInt(d)===100,this.playingVideo.maxPlayTime=parseInt(s)*parseInt(d)/100}this.playingVideo.readyCount=0},this.dealVideoConfig=(0,Z.Z)(g().mark(function n(){var e,t,s,d,y,P,N,b,W,x,O,q,le,me,ye,w,C,f,i,l,h,v,r,E;return g().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:if(e=p.state,t=e.speedSwitch,s=e.dragSwitch,d=e.whiteList,y=p.props,P=y.resourceInfo,N=y.showQuality,b=P.contentType,W=P.storageType,x=P.source,O=P.playId,q=P.playerId,le=P.showFullScreen,me=le===void 0?!0:le,ye=Ce(q),ye.components=[],w=typeof x=="object"&&x.hasOwnProperty("FD")&&x.FD.indexOf("m3u8")===-1,N&&w&&b!=="mp3"&&(W&&W==="PUBLIC_CLOUD"||!W)&&ye.components.push({name:"VideoQuality",type:De,args:[()=>{p.play.pause(),p.playingVideo.readyCount=0}]}),t==="OPEN"&&ye.components.push({name:"VideoRate",type:ge}),me&&(C=ye.skinLayout.find(se=>se.name==="controlBar"),C&&C.children.splice(C.children.length-2,0,{name:"fullScreenButton",align:"tr",x:20,y:13})),ye.components.push({name:"VideoWaterMark",type:Ve}),f=x.FD,i=x.OD,f.indexOf("http://")>-1&&(f=f.replace("http://","https://")),i.indexOf("http://")>-1&&(i=i.replace("http://","https://")),l=d.baiYingVideoHostFlag?"video.baiying.com.cn":"video.coolcollege.cn",x.OD=i&&i.indexOf(l)>-1&&i.indexOf(".mp4")>-1?i:f,x.FD=f,h=typeof x!="string"?JSON.stringify(x):x,ye.source=h,s==="OPEN"&&(ye.disableSeek=!0),W!=="ALIBABA_PRIVATE"){G.next=32;break}return G.next=22,(0,L.BR)(O);case 22:if(v=G.sent,!v){G.next=28;break}ye.source=v,ye.vodRetry=1,G.next=30;break;case 28:return p.setState({showPrivateVodError:!0}),G.abrupt("return");case 30:G.next=38;break;case 32:if(W!=="LOCAL"){G.next=38;break}return G.next=35,xe(O);case 35:r=G.sent,E=r.data,E.code===0&&(ye.source="".concat(x.FD,"?auth_key=").concat(E.data.auth_key),ye.vodRetry=1);case 38:p.setState({playerConfig:ye});case 39:case"end":return G.stop()}},n)})),this.updateSource=function(){var n=(0,Z.Z)(g().mark(function e(t){var s,d,y,P,N,b,W,x;return g().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:if(s=p.state.playerConfig,d=p.props.resourceInfo,y=d.storageType,P=d.source,N=d.playId,p.playingVideo.readyCount=0,y!=="ALIBABA_PRIVATE"){q.next=16;break}return q.next=7,(0,L.BR)(N);case 7:if(b=q.sent,!b){q.next=12;break}Object.assign(s,{source:b,vodRetry:1}),q.next=14;break;case 12:return p.setState({showPrivateVodError:!0}),q.abrupt("return");case 14:q.next=22;break;case 16:if(y!=="LOCAL"){q.next=22;break}return q.next=19,xe(N);case 19:W=q.sent,x=W.data,x.code===0&&Object.assign(s,{source:"".concat(P.FD,"?auth_key=").concat(x.data.auth_key),vodRetry:1});case 22:p.setState({playerConfig:s},()=>{p.play.setupPlayer(t)});case 23:case"end":return q.stop()}},e)}));return function(e){return n.apply(this,arguments)}}(),this.saveProgress=()=>{var n=this.props,e=n.studyInfo,t=n.userInfo,s=t.isLogin,d=t.enterpriseId,y=t.id,P=this.playingVideo,N=P.recentStart,b=P.duration,W=P.hasFinished,x=Math.ceil(+N);x>Number(b)&&(x=Number(b));var O=Math.ceil(x/+b*100);if((O>100||W)&&(O=100),s){var q=this.playingVideo,le=q.auditionType,me=q.auditionLength;if(me>0&&le===2){var ye=Math.ceil(me/b*100);ye<=O&&(O=ye,x=me)}(0,L.sH)({studyInfo:e,progress:O,recent_start:x,enterpriseId:d,userId:y}).then(w=>{w&&w.data&&(0,ke.Z)(w.data.integral_info||"")})}},this.getInfoFromSettings=(0,Z.Z)(g().mark(function n(){var e,t,s,d,y,P,N,b,W;return g().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return e=p.props.studyInfo,t=e.studyType,s=e.projectId,O.next=4,(0,L.Gw)();case 4:if(d=O.sent,y=[{type:"prevent_cut_screen",name:"showPreventHang"},{type:"document_duration_limit",name:"showRandomAlert"},{type:"dynamic_watermark",name:"videoWatermarkSettings",resourceType:"video"},{type:"audio_video_drag",name:"dragSwitch"},{type:"speed_play_switch",name:"speedSwitch"},{type:"vod_encrypted_switch",name:"encryptedSwitch"}],P=(0,ee.RG)(d,y),t!=="studyProject"){O.next=14;break}return O.next=10,(0,Ae.NU)({id:s});case 10:N=O.sent,b=N.status,W=N.data,b===200&&(P.showPreventHang=W.prevent_cut_screen?"OPEN":"CLOSED",P.speedSwitch=W.speed_play?"OPEN":"CLOSED",P.dragSwitch=W.prevent_drag?"OPEN":"CLOSED");case 14:p.setState(P,()=>{p.dealVideoConfig()});case 15:case"end":return O.stop()}},n)})),this.dealAudioPoster=()=>{var n=this.props.resourceInfo.contentType,e=n===void 0?"":n;this.setState({showAudioPoster:e==="mp3"},()=>{this.renderAudioPoster()})},this.renderAudioPoster=()=>{var n=this.state.showAudioPoster,e=this.play.playerContainer;n&&e&&(e.style.background="url('".concat("https://oss.coolcollege.cn","/1814929291192963072.png') center no-repeat"),e.style.backgroundSize="cover")},this.getPlayInstance=n=>{this.play=n},this.handleOk=()=>{this.setState({dialogVisible:!1});var n=this.state.btnType,e=this.playingVideo.recentStart,t=this.props.t;n==="know"?(this.play.play(),this.play.seek(e),setTimeout(()=>{this.setState({btnType:"continue",promptMessage:t("component.hangUpTriggerTip")})},500)):(this.playingVideo.popupWindowCount-=1,this.play.play())},this.handleRandomOk=(0,Z.Z)(g().mark(function n(){var e,t,s,d;return g().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:e=p.props.studyInfo,t=e.studyId,s=e.resourceId,d=p.state.randomAlertUUID,(0,L.qp)({popupId:d,planId:t,resourceId:s,type:"popup_end"}).then(()=>{p.setState({randomAlertUUID:"",randomAlertDialogVisible:!1})}),p.playingVideo.popupWindowCount-=1,p.play.play();case 6:case"end":return P.stop()}},n)})),this.renderFooter=()=>{var n=this.state.btnType,e=this.props.t;return u().createElement(R.Z,{key:"submit",type:"primary",onClick:()=>this.handleOk(n)},e(n==="know"?"component.iKnow":"component.continuePlaying"))},this.renderRandomFooter=()=>{var n=this.props.t;return u().createElement(R.Z,{key:"submit",type:"primary",onClick:this.handleRandomOk},n("common.ok"))},this.state={playerConfig:Ce(),showRandomAlert:"",showPreventHang:"",videoWatermarkSettings:[],dragSwitch:"",speedSwitch:"",encryptedSwitch:"",showAudioPoster:!1,showPrivateVodError:!1,dialogVisible:!1,dialogModal:{title:m.t("common.tip"),mask:!0,size:"small",closable:!1,onCancel:this.handleCancel},promptMessage:m.t("component.preventHangUpTip"),btnType:"know",randomAlertDialogVisible:!1,randomAlertUUID:"",randomAlertTip:m.t("component.randomAlertTip"),randomAlertModal:{title:m.t("common.tip"),mask:!0,size:"small",closable:!1,onCancel:this.handleRandomCancel},whiteList:{baiYingVideoHostFlag:(0,Se.UI)("CL_VIDEO_BAIYING_COM_CN")}},m.onGetVideoBusiness(this)}componentDidMount(){this.initInfo()}componentDidUpdate(m){var p=typeof m.resourceInfo.source!="string"?JSON.stringify(m.resourceInfo.source):m.resourceInfo.source,n=typeof this.props.resourceInfo.source!="string"?JSON.stringify(this.props.resourceInfo.source):this.props.resourceInfo.source;p!==n&&n!==""&&this.initInfo()}componentWillUnmount(){var m=this.props.mode;m==="learn"&&this.saveProgress(),this.play&&this.play.dispose(),clearTimeout(this.timer),this.playingVideo={}}render(){var m=this.state,p=m.playerConfig,n=m.showPrivateVodError,e=m.dialogVisible,t=m.dialogModal,s=m.promptMessage,d=m.randomAlertDialogVisible,y=m.randomAlertModal,P=m.randomAlertTip,N=m.encryptedSwitch,b=this.props,W=b.resourceInfo,x=b.t,O=N==="OPEN"?ce:ue;return u().createElement(U.Fragment,null,u().createElement(O,(0,z.Z)({ref:this.getPlayInstance},W,{playingVideo:this.playingVideo,onPlay:this.onPlay,onPause:this.onPause,playerConfig:p,onVideoReady:this.onVideoReady,onTimeUpDate:this.onTimeUpDate,onError:this.onError,onEnd:this.onEnd})),u().createElement(we.ZP,(0,z.Z)({visible:e},t,{footer:this.renderFooter()}),u().createElement("div",{className:"video-business-prompt"},s)),u().createElement(we.ZP,(0,z.Z)({visible:d},y,{footer:this.renderRandomFooter()}),u().createElement("div",{className:"video-player-container__prompt"},P)),n&&u().createElement("div",{className:"video-business-vod-error"},x("privateCloud.docReadError")),u().createElement(Le.Z,{scenes:"video"}))}}var Fe=(0,B.$j)(_e,null,null,{forwardRef:!0})((0,I.Z)("translation",{withRef:!0})(Me)),ze=a(94184),be=a.n(ze),We=a(84874),Ie=pe=>({userInfo:pe.user}),Pt={getPravateDocUrl:Pe.ZP.localStorage.getPravateDocUrl};function lt(pe){return JSON.stringify(pe,(m,p)=>(typeof p=="function"&&(p=p.toString()),p))}function yt(pe){var m=parseInt(parseInt(pe,10)/60,10),p=parseInt(parseInt(pe,10)%60,10);return m<10&&(m="0".concat(m)),p<10&&(p="0".concat(p)),"".concat(m,":").concat(p)}class qe extends U.Component{constructor(m){var p;super(m);p=this,this.messageFun=n=>{var e=this.props,t=e.docType,s=e.progress,d=e.studyTimeLimit,y=e.studyTime,P=this.state,N=P.jumpPageTag,b=P.totalTime,W=P.timeRemaining,x=this.state.previewDocData,O={};try{O=JSON.parse(n.data)}catch(q){return}switch(O.action){case"preview.ready":this.initDocData();break;case"preview.meta":x.totalPage=O.data.pc||1,x.currentPage=1,this.setState({previewDocData:x},()=>{this.reportStatusInterval()}),d>0?(this.saveProgress(s,y||"1",O.data.pc||1),this.setState({showCountDownContainer:!0})):t==="xlsx"||t==="xls"||x.totalPage===1?this.saveProgress(100,1,1):this.saveProgress(s,y||"1",O.data.pc||1),d>0&&s<100?(this.setState({showCountDown:!0}),t==="xlsx"||t==="xls"?b=d:b=d*O.data.pc,W=parseInt(b*(1-s/100),10),this.setState({timeRemaining:W,totalTime:b},()=>{this.docCountDown()})):this.setState({showCountDown:!1});break;case"page.readPage":if(N){N=!1,this.setState({jumpPageTag:N});return}x.currentPage=O.data.pageIndex+1,this.setState({previewDocData:x}),d||this.saveProgress(Math.ceil(x.currentPage/x.totalPage*100),x.currentPage,x.totalPage);break;case"page.initViewDone":this.redirectPage();break;case"message.error":j.default.error(O.data.result);break;default:break}},this.initDocData=(0,Z.Z)(g().mark(function n(){var e,t,s,d,y,P,N,b,W,x,O,q,le,me;return g().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(p.setState({isShowPrivateError:!1}),e=p.props,t=e.docType,s=e.userInfo,d=e.documentWatermarkSettings,y=e.storageType,P=e.privateDocId,N=s.name,b=s.jobNumber,W=s.position,x="",O={},y!=="ALIBABA_PRIVATE"){w.next=18;break}return w.prev=6,q=Pt.getPravateDocUrl(P),w.next=10,V.WY.get({url:q});case 10:le=w.sent,me=le.data,me.code===0?O=me.data||{}:p.setState({isShowPrivateError:!0}),w.next=18;break;case 15:w.prev=15,w.t0=w.catch(6),p.setState({isShowPrivateError:!0});case 18:if(d.indexOf("name")>-1&&(x="".concat(x+N," ")),d.indexOf("position")>-1&&(x="".concat(x+W," ")),d.indexOf("jobnumber")>-1&&(x+=b),x.length>0?window.sendMessage("preview.init",(0,$.Z)({wmType:1,wmValue:x,wmColor:"rgba(192, 192, 192, 0.4)"},O)):window.sendMessage("preview.init",(0,$.Z)({},O)),t!=="xlsx"&&t!=="ppt"&&t!=="pptx"&&t!=="xls"?p.setState({pageOperateContainerVisible:!0}):p.setState({pageOperateContainerVisible:!1}),!(t==="ppt"||t==="pptx")){w.next=29;break}w.t1=window,w.t2={powerpointCustomStyle(){return{containerMarginTop:0,containerMarginBottom:0}}},w.t1.sendMessage.call(w.t1,"setConfig",w.t2),w.next=32;break;case 29:w.t3=window,w.t4={writerCustomStyle(){return{containerMarginTop:0,containerMarginBottom:0,paginationDisplay:!0,scale:{bottom:"60px",right:"20px"}}}},w.t3.sendMessage.call(w.t3,"setConfig",w.t4);case 32:case"end":return w.stop()}},n,null,[[6,15]])})),this.handleJumpPage=n=>{var e=this.state.previewDocData;e.currentPage=n,this.setState({jumpPageTag:!0,previewDocData:e});var t=n/e.totalPage*100;this.props.studyTimeLimit||this.saveProgress(Math.ceil(t),n,e.totalPage),window.sendMessage("logic.toPage",{pageIndex:n-1})},this.redirectPage=()=>{var n=this.props,e=n.studyTimeLimit,t=n.studyTime,s=0;e===0&&(s=t-1>0?t-1:0),window.sendMessage("logic.toPage",{pageIndex:s})},this.docCountDown=()=>{var n=this.state.timeRemaining,e=this.state,t=e.totalTime,s=e.previewDocData;this.docCountDownTimer&&window.clearInterval(this.docCountDownTimer),this.docCountDownTimer=setInterval(()=>{n-=1,this.setState({timeRemaining:n}),n<1&&(this.saveProgress(100,0,s.totalPage),this.setState({showCountDown:!1}),window.clearInterval(this.docCountDownTimer),window.clearInterval(this.intervalSaveProgressTimer))},1e3),this.intervalSaveProgressTimer&&window.clearInterval(this.intervalSaveProgressTimer),this.intervalSaveProgressTimer=setInterval(()=>{var d=(t-n)/t*100;n<1?(this.setState({showCountDown:!1}),window.clearInterval(this.docCountDownTimer),window.clearInterval(this.intervalSaveProgressTimer)):this.saveProgress(Math.ceil(d),n,s.totalPage)},2e4)},this.saveProgress=(n,e,t)=>{var s=this.props.onSaveProgress;s&&s(n,e,t)},this.reportStatusInterval=()=>{var n=this.props.onReportStatusInterval;this.reportStatusTimer=setInterval(()=>{var e=this.state.previewDocData.currentPage;n&&n({currentPage:e})},2e4)},this.hidePageOperateContainer=()=>{this.setState({showPageOperateContainer:!1})},this.handleShowPageOperateContainer=()=>{this.setState({showPageOperateContainer:!0})},this.dealPreviewRef=n=>{this.docReader=n},this.state={previewDocData:{totalPage:1,currentPage:1},pageOperateContainerVisible:!1,showPageOperateContainer:!0,showCountDown:!1,showCountDownContainer:!1,timeRemaining:0,totalTime:0,jumpPageTag:!1,isShowPrivateError:!1}}componentDidMount(){window.sendMessage=(m,p)=>{var n=this.docReader.contentWindow;n.postMessage(lt({action:m,data:p}),"*")},window.addEventListener("message",this.messageFun,!1)}componentWillUnmount(){window.removeEventListener("message",this.messageFun,!1),window.clearInterval(this.docCountDownTimer),window.clearInterval(this.intervalSaveProgressTimer),window.clearInterval(this.reportStatusTimer)}render(){var m=this.props,p=m.t,n=m.storageType,e=m.privateDocId,t=this.props.aliUrl,s=this.state,d=s.previewDocData,y=s.pageOperateContainerVisible,P=s.timeRemaining,N=s.showCountDown,b=s.showCountDownContainer,W=s.showPageOperateContainer,x=s.isShowPrivateError;return n==="ALIBABA_PRIVATE"&&(t="https://preview.imm.aliyuncs.com/index.html?docId=".concat(e)),u().createElement("div",{className:"doc-reader-container"},u().createElement("div",{className:"ali-doc-container",style:{paddingBottom:y?"56px":"0"}},u().createElement("iframe",{allowFullScreen:!0,frameBorder:"0",style:{width:"100%",height:"100%"},src:t,id:"aliyunPreview",ref:this.dealPreviewRef}),b?u().createElement("div",{className:"ali-doc-container__countdown"},N?u().createElement("div",null,u().createElement(We.Z,{iconClass:"iconf-tipe",size:"16px"}),p("component.docStillStudy"),u().createElement("span",{className:"ali-doc-container__countdown__fomate-remaining"}," ",yt(P)," "),p("component.canDone")):u().createElement("div",null,u().createElement(We.Z,{iconClass:"iconf-tipe",size:"16px"}),p("component.docHasFinish"))):null,y?u().createElement("div",{className:"ali-doc__operate"},u().createElement("div",{className:be()(["ali-doc__operate__content",W?"":"ali-doc__operate__hide-content"])},u().createElement("div",{className:"ali-doc__operate__pagination"},u().createElement("div",{className:"ali-doc__operate__pagination__pages"},d.currentPage," / ",d.totalPage),u().createElement("div",{className:"ali-doc__operate__pagination__toggle"},u().createElement("div",{className:"ali-doc__operate__pagination__choose"},u().createElement("span",null,p("component.choosePage"),u().createElement(We.Z,{iconClass:"iconf-arrow-under",size:"14px"})),u().createElement("div",{className:"ali-doc__operate__page-list-container"},u().createElement("div",{className:"ali-doc__operate__choose-page"},p("component.fastChoosePage")),u().createElement("ul",{className:"ali-doc__operate__page-list"},Object.keys(Array.from({length:d.totalPage})).map((O,q)=>u().createElement("li",{key:O,onClick:()=>this.handleJumpPage(q+1)},q+1))))),u().createElement("div",{className:"ali-doc__operate__pagination__fold",onClick:this.hidePageOperateContainer},p("common.collapse"))))),u().createElement("div",{className:be()("ali-doc__operate__unfold",W?"ali-doc__operate__unfold-hide":""),onClick:this.handleShowPageOperateContainer},p("common.expand"))):null,x&&u().createElement("div",{className:"ali-doc__error"},p("privateCloud.docReadError"))),u().createElement(Le.Z,{scenes:"document"}))}}qe.defaultProps={aliUrl:"",docType:"",progress:0,studyTime:0,studyTimeLimit:0,documentWatermarkSettings:[]};var ct=(0,B.$j)(Ie)((0,I.Z)()(qe)),dt=pe=>({userInfo:pe.user}),pt="".concat("https://app123492.eapps.dingtalkcloud.com","/enterprise-api"),Ge="".concat("https://doc.coolcollege.cn");class et extends u().Component{constructor(m){var p;super(m);p=this,this.onSaveProgress=(n,e,t)=>{var s=this.props,d=s.mode,y=s.studyInfo,P=s.userInfo,N=P.enterpriseId,b=P.id;d==="learn"&&(0,L.sH)({studyInfo:y,progress:n,page_count:t,recent_start:e,enterpriseId:N,userId:b}).then(W=>{W&&W.data&&(0,ke.Z)(W.data.integral_info||"")})},this.messageFun=function(){var n=(0,Z.Z)(g().mark(function e(t){var s,d,y,P,N,b;return g().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(t.data!=="local-resource"){x.next=9;break}if(s=p.props.resourceInfo,d=s.storageType,y=s.playId,!(d&&d==="LOCAL")){x.next=9;break}return x.next=6,xe(y);case 6:P=x.sent,N=P.data,N.code===0&&(b=document.getElementById("local-resource-box"),b.contentWindow.postMessage({msg:"local-auth-key",authKey:N.data.auth_key},"*"));case 9:case"end":return x.stop()}},e)}));return function(e){return n.apply(this,arguments)}}(),this.getInfoFromSettings=(0,Z.Z)(g().mark(function n(){var e,t,s;return g().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,(0,L.Gw)();case 2:e=y.sent,t=[{type:"dynamic_watermark",name:"documentWatermarkSettings",resourceType:"document"},{type:"document_player",name:"documentPlayerMode"}],s=(0,ee.RG)(e,t),p.setState(s,()=>{p.initDocPage(p.props)});case 6:case"end":return y.stop()}},n)})),this.initDocPage=(0,Z.Z)(g().mark(function n(){var e,t,s,d,y,P,N,b,W,x,O,q,le,me,ye,w,C,f,i,l,h,v,r,E,_,G,se,K,ie,re,oe,te,he,Te,Ze=arguments;return g().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:if(e=Ze.length>0&&Ze[0]!==void 0?Ze[0]:{},t=e.resourceInfo,s=e.mode,d=e.studyInfo,y=e.userInfo,P=p.state.documentPlayerMode,N=t.docType,b=t.docTitle,W=t.url,x=t.studyTimeLimit,O=t.studyTime,q=t.aliUrl,le=t.progress,me=t.storageType,ye=t.playId,w=d.studyType,C=d.courseId,f=d.studyId,i=d.resourceId,l=y.enterpriseId,h=y.id,v=y.isLogin,r=y.token,E=P==="compat"&&q.indexOf("preview.imm.aliyun")>-1||me==="ALIBABA_PRIVATE",!E){ae.next=11;break}p.setState({showAliReader:!0}),ae.next=31;break;case 11:if(_=(0,L.sH)({enterpriseId:l,userId:h,token:r,studyInfo:d},!0),G=w==="studyTask"?2:1,se=Pe.ZP.SaveProgress.reportStatusInterval(d),K={isSaveProgress:v&&s==="learn"&&_,isSaveRecord:!1,access_token:r,userId:h,hostUrl:pt,courseId:C,resourceId:i,courseType:1,planId:f,studyTimeLimit:x,studyTime:O,saveProgressUrl:_,type:"eapp",progress:le,saveRecordProgressUrl:se,actionType:G},!(me&&me==="LOCAL")){ae.next=26;break}return ae.next=18,xe(ye);case 18:if(ie=ae.sent,re=ie.data,re.code!==0){ae.next=25;break}K.auth_key=re.data.auth_key,K.url=W,ae.next=26;break;case 25:return ae.abrupt("return");case 26:oe=JSON.stringify(K),te="".concat(b,".").concat(N).replace(/[\|\~\`\(\)\@\#\$\%\^\&\*\{\}\"\L\<\>\?]/g,""),he="".concat(Ge,"/?i=13399&ssl=1&iparms=").concat(encodeURIComponent(oe),"&furl=").concat(W,"?attname=").concat(te),me&&me==="LOCAL"&&(Te="".concat("https://dd.coolcollege.cn/ac/eapp/localDocReader/index.html").replace(/^\"|\"$/g,"").replace(/^\'|\'$/g,""),he="".concat(Te,"?i=13399&ssl=1&iparms=").concat(encodeURIComponent(oe),"&furl=").concat(W,"?attname=").concat(te)),p.setState({encodeUrl:he});case 31:case"end":return ae.stop()}},n)})),this.handleReportStatusInterval=n=>{var e=n.currentPage,t=this.props,s=t.resourceInfo,d=t.mode,y=t.studyInfo,P=t.userInfo,N=s.type,b=y.courseId,W=y.studyId,x=y.resourceId,O=P.enterpriseId,q=P.id,le=P.isLogin,me="",ye="",w=0,C=!1;switch(N){case"enterprise":w=1,C=!0;break;case"study":me=W,w=2,C=!0;break;case"project":ye=W,w=1,C=!0;break;default:break}if(!(!C||!le)){var f={plan_id:me,enterprise_id:O,user_id:q,course_id:b,project_course_id:ye,resource_id:x,current_page:e,action_type:w,send_time:Date.parse(new Date)};d==="learn"&&(0,L.Xc)(y,f)}},this.state={encodeUrl:"",showAliReader:!1,documentWatermarkSettings:[],documentPlayerMode:"projection"}}componentDidMount(){this.getInfoFromSettings(),window.addEventListener("message",this.messageFun,!1)}UNSAFE_componentWillReceiveProps(m){this.initDocPage(m)}render(){var m=this.props.resourceInfo,p=this.state,n=p.encodeUrl,e=p.documentWatermarkSettings,t=p.showAliReader,s=m.docType,d=m.type,y=m.studyTimeLimit,P=m.studyTime,N=m.aliUrl,b=m.progress,W=m.storageType,x=m.playId;return t?u().createElement(ct,{privateDocId:x,storageType:W,aliUrl:N,docType:s,progress:b,studyTime:P,studyTimeLimit:y,documentWatermarkSettings:e,onSaveProgress:this.onSaveProgress,onReportStatusInterval:this.handleReportStatusInterval,type:d}):u().createElement("div",{className:"doc-reader-container"},u().createElement("iframe",{id:"local-resource-box",style:{width:"100%",height:"100%"},src:n,frameBorder:"0",allowFullScreen:!0}),u().createElement(Le.Z,{scenes:"document"}))}}var Be=(0,B.$j)(dt)(et),Ct=a(38979),tt=a(90706),ut=a(12968),ht=a(44208),Ne=a(60667),$e=pe=>({userInfo:pe.user});class Ke extends u().Component{constructor(){var m;super(...arguments);m=this,this.state={imageWatermark:[],watermark:"",imageUrl:[]},this.onImageLoad=()=>{var p=this.props,n=p.studyInfo,e=p.mode,t=p.userInfo,s=t.enterpriseId,d=t.id;e==="learn"&&(0,ee.Gp)({studyInfo:n,enterpriseId:s,userId:d})},this.getInfoFromSettings=(0,Z.Z)(g().mark(function p(){var n,e,t;return g().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,(0,L.Gw)();case 2:n=d.sent,e=[{type:"dynamic_watermark",name:"imageWatermark",resourceType:"image"}],t=(0,ee.RG)(n,e),m.setState(t,()=>{m.renderWatermark()});case 6:case"end":return d.stop()}},p)})),this.renderWatermark=()=>{var p=this.props.userInfo,n=this.state.imageWatermark,e=p.name,t=p.unionid,s=p.sourceType,d=p.jobNumber,y=p.position,P=[];n.indexOf("name")>-1&&P.push(u().createElement(Ne.Z,{dataType:"userName",value:t,name:e,type:s})),n.indexOf("position")>-1&&P.push(u().createElement("span",null,y)),n.indexOf("jobnumber")>-1&&P.push(u().createElement("span",null,d)),n.length>0&&this.setState({watermark:P.map((N,b)=>u().createElement("span",{key:b},N))})},this.handleError=p=>{var n=this.props.onError;n&&n(p)},this.getImageUrl=(0,Z.Z)(g().mark(function p(){var n,e,t,s,d,y,P,N,b,W;return g().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(n=m.props,e=n.resourceInfo,t=n.t,s=e.playId,d=e.url,y=e.storageType,P=d,!y){O.next=21;break}if(y!=="ALIBABA_PRIVATE"){O.next=15;break}return O.next=7,(0,L.J7)(s);case 7:if(N=O.sent,!N){O.next=12;break}P=N,O.next=13;break;case 12:return O.abrupt("return",j.default.info(t("privateCloud.docReadError")));case 13:O.next=21;break;case 15:if(y!=="LOCAL"){O.next=21;break}return O.next=18,xe(s);case 18:b=O.sent,W=b.data,W.code===0&&(P="".concat(d,"?auth_key=").concat(W.data.auth_key));case 21:m.setState({imageUrl:[P]},()=>{var q=m.state.imageUrl,le="image-business",me=document.querySelectorAll(".".concat(le,"-image img"));me.forEach((ye,w)=>{ye.onerror=()=>{m.handleError(q[w])}})});case 22:case"end":return O.stop()}},p)}))}componentDidMount(){this.getImageUrl(),this.getInfoFromSettings(),new Swiper(".swiper-container",{loop:!1,pagination:".swiper-pagination",paginationClickable:!0,prevButton:".swiper-button-prev",nextButton:".swiper-button-next"})}render(){var m="image-business",p=this.props.resourceInfo,n=p.preview,e=n===void 0?!1:n,t=this.state,s=t.watermark,d=t.imageUrl;return u().createElement("div",{className:m},u().createElement(Le.Z,{scenes:"image"}),u().createElement(tt.Z,{className:"".concat(m,"-carousel")},d.map((y,P)=>u().createElement("div",{className:"".concat(m,"-image"),key:P.toString()},u().createElement(ht.Z,{src:y,onLoad:this.onImageLoad,ref:this.getImageInstance,preview:e})))))}}Ke.defaultProps={prefixCls:"watch-image-page"};var at=(0,B.$j)($e)((0,I.Z)()(Ke)),He=pe=>({userInfo:pe.user});class mt extends u().Component{constructor(){var m;super(...arguments);m=this,this.state={htmlWatermark:[],watermark:""},this.getInfoFromSettings=(0,Z.Z)(g().mark(function p(){var n,e,t;return g().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,(0,L.Gw)();case 2:n=d.sent,e=[{type:"dynamic_watermark",name:"htmlWatermark",resourceType:"html"}],t=(0,ee.RG)(n,e),m.setState(t,()=>{m.renderWatermark()});case 6:case"end":return d.stop()}},p)})),this.renderWatermark=()=>{var p=this.props.userInfo,n=this.state.htmlWatermark,e=p.name,t=p.unionid,s=p.sourceType,d=p.jobNumber,y=p.position,P=[];n.indexOf("name")>-1&&P.push(u().createElement(Ne.Z,{dataType:"userName",value:t,name:e,type:s})),n.indexOf("position")>-1&&P.push(u().createElement("span",null,y)),n.indexOf("jobnumber")>-1&&P.push(u().createElement("span",null,d)),n.length>0&&this.setState({watermark:P.map((N,b)=>u().createElement("span",{key:b},N))})},this.saveProgress=()=>{var p=this.props,n=p.studyInfo,e=p.mode,t=p.userInfo,s=t.enterpriseId,d=t.id;e==="learn"&&(0,ee.Gp)({studyInfo:n,enterpriseId:s,userId:d})}}componentDidMount(){this.getInfoFromSettings(),this.saveProgress()}render(){var m="html-business",p=this.props.resourceInfo,n=p.url,e=this.state.watermark;return u().createElement("div",{className:m},u().createElement("div",{className:"".concat(m,"__html-watermark")},e),u().createElement("iframe",{title:"html",className:"".concat(m,"_iframe"),src:n}))}}var st=(0,B.$j)(He)((0,I.Z)()(mt)),Ye=a(57068),Qe=a(1164),rt=pe=>({userInfo:pe.user});class Je extends u().PureComponent{constructor(){super(...arguments);this.getHost=m=>{var p=m.split("//"),n=p[1].split("/");return[p[0],n[0]].join("//")},this.getScormUrl=()=>{var m=this.props,p=m.studyInfo,n=m.mode,e=m.userInfo,t=m.resourceInfo,s=m.from,d=e.enterpriseId,y=e.id,P=t.url,N=this.getHost(P);if(n==="learn"){var b=(0,$.Z)({userId:y,enterpriseId:d,access_token:localStorage.token,from:s,scormUrl:encodeURIComponent(P),platform:"pc",enterpriseApi:"".concat("https://app123492.eapps.dingtalkcloud.com")},p);return"".concat(N).concat("/unzip_file/coolcollege-scorm/prod/scorm.html","?").concat(Ye.stringify(b))}return"".concat(N,"/unzip_file/coolcollege-scorm/prod/preview.html?scormUrl=").concat(encodeURIComponent(P))},this.handleOpenScormLink=m=>{Qe.Z.targetTo({path:m,isExternalLink:!0})}}render(){var m=this.props.t,p="scorm-business",n=this.getScormUrl(),e=(0,Se.UI)("SCORM_EXTERNAL_WATCH");return u().createElement("div",{className:p},e?u().createElement("div",{className:"".concat(p,"_scorm")},u().createElement("img",{className:"".concat(p,"_scorm_img"),src:"".concat("https://oss.coolcollege.cn","/1794254238973562880.png"),alt:""}),u().createElement("h5",null,m("resourcePlay.scormTip")),u().createElement(R.Z,{type:"primary",onClick:()=>this.handleOpenScormLink(n)},m("resourceLibrary.h5LinkPlayButton"))):u().createElement("iframe",{title:"scorm",className:"".concat(p,"_iframe"),src:n}))}}var je=(0,B.$j)(rt)((0,I.Z)()(Je));class vt extends u().Component{render(){var m=this.props,p=m.visible,n=m.title,e=m.onCancel,t=m.t,s=u().createElement("span",null,n);return u().createElement(we.ZP,{visible:p,title:s,onCancel:e,footer:null},u().createElement("div",{className:"ban-preview"},u().createElement("div",{className:"ban-preview-center"},u().createElement("img",{src:c(),alt:"picture"}),u().createElement("h2",null,t("localStorage.tip")),u().createElement("p",null,t("localStorage.banPreview"))),u().createElement("hr",null),u().createElement(R.Z,{type:"primary",className:"know",onClick:e},t("localStorage.onKnow"))))}}var nt=(0,I.Z)()(vt);class ft extends U.Component{constructor(){var m;super(...arguments);m=this,this.state={showBan:"",fullScreen:!1},this.onCancel=()=>{this.setState({showBan:"",fullScreen:!1})},this.onCancelModel=p=>{var n=this.props.previewInfo,e=n.onCancel;this.onCancel(),e(p)},this.onGetVideoBusiness=p=>{var n=this.props.onRef,e=n===void 0?()=>{}:n;this.videoBusiness=p,e(p)},this.onFullScreen=()=>{var p=this.state.fullScreen;this.setState({fullScreen:!p})},this.handleJudgeNetwork=(0,Z.Z)(g().mark(function p(){var n,e,t,s,d,y,P,N,b,W,x,O=arguments;return g().wrap(function(le){for(;;)switch(le.prev=le.next){case 0:if(n=O.length>0&&O[0]!==void 0?O[0]:null,e=m.props,t=e.resourceInfo,s=e.watchType,d=t.storageType,y=t.playId,P=t.originUrl,N=s==="image"||s==="video"||s==="doc",b=null,n?b=n:P?b=P:b=t.url,!(N&&b&&y&&d&&d==="LOCAL")){le.next=22;break}return le.prev=7,le.next=10,(0,L.NY)(y);case 10:return W=le.sent,le.next=13,(0,L.Hy)(b,W);case 13:x=le.sent,x?m.setState({showBan:"no"}):m.setState({showBan:"yes"}),le.next=20;break;case 17:le.prev=17,le.t0=le.catch(7),m.setState({showBan:"yes"});case 20:le.next=23;break;case 22:m.setState({showBan:"no"});case 23:case"end":return le.stop()}},p,null,[[7,17]])})),this.renderOuter=()=>{var p=this.props,n=p.prefixCls,e=p.watchType,t=p.onCurrentTime,s=t===void 0?()=>{}:t;return u().createElement("div",{className:"".concat(n,"-outer")},e==="video"&&u().createElement(Fe,(0,z.Z)({onCurrentTime:s,onGetVideoBusiness:this.onGetVideoBusiness},this.props)),e==="doc"&&u().createElement(Be,this.props),e==="image"&&u().createElement(at,(0,z.Z)({onError:this.handleJudgeNetwork},this.props)),e==="html"&&u().createElement(st,this.props),e==="scorm"&&u().createElement(je,this.props))},this.renderFooter=()=>{var p=this.props,n=p.resourceInfo.storageType,e=p.t,t=this.state.showBan,s=t!==""&&t==="yes";return n&&n!=="PUBLIC_CLOUD"&&s?u().createElement(R.Z,{type:"primary",className:"know",onClick:this.onCancelModel},e("localStorage.onKnow")):null}}componentDidMount(){var m=this.props.mode;m==="learn"?this.handleJudgeNetwork():this.setState({showBan:"no"})}componentDidUpdate(m){m.previewInfo.visible!==this.props.previewInfo.visible&&this.props.previewInfo.visible&&this.handleJudgeNetwork()}render(){var m=this.state,p=m.showBan,n=m.fullScreen,e=this.props,t=e.mode,s=e.previewWay,d=e.previewInfo,y=e.prefixCls,P=e.t,N=e.showEnlarge,b=e.footer,W=b===void 0?null:b,x=d.visible,O=d.destroyOnClose,q=d.title,le=p!==""&&p==="yes",me=p!==""&&p==="no";return u().createElement(U.Fragment,null,t==="preview"&&s==="popups"&&u().createElement(we.ZP,{destroyOnClose:O,visible:x,title:q,onCancel:this.onCancelModel,footer:W||this.renderFooter(),wrapClassName:"".concat(y,"-resource ").concat(n?"".concat(y,"-full"):"")},N&&u().createElement("div",{className:"".concat(y,"-resource-out-icon"),onClick:this.onFullScreen},n?u().createElement(D.Z,{className:"".concat(y,"-resource-icon")}):u().createElement(k.Z,{className:"".concat(y,"-resource-icon")})),u().createElement("div",{className:"".concat(y,"-inner")},!x&&u().createElement(S.Z,{size:"large"}),x&&me&&this.renderOuter(),le&&u().createElement(Y,null))),(t==="learn"||s==="page")&&me&&this.renderOuter(),(t==="learn"||s==="page")&&u().createElement(nt,{visible:le,title:q||P("questionn.warmHint"),onCancel:this.onCancel}))}}ft.defaultProps={prefixCls:"cl-resource-play",from:"",mode:"learn",previewWay:"popups",previewInfo:{visible:!1,destroyOnClose:!0,title:"",onCancel:()=>{}},watchType:"h5",studyInfo:{courseId:"",studyId:"",resourceId:"",studyType:""},resourceInfo:{},autoPlay:!0,draggable:!0,needCurrentTime:!1,showQuality:!0,showEnlarge:!0};var gt=(0,I.Z)("translation",{withRef:!0})(ft)},41225:function(Ee,ne,a){"use strict";a.d(ne,{Hy:function(){return Z},NY:function(){return Q},Gw:function(){return g},sH:function(){return D},BR:function(){return U},qp:function(){return k},Xc:function(){return I},J7:function(){return u}});var A=a(57361),S=a(9754),X=a.n(S),R=a(10237),z=a(37055),Z=function(){var T=(0,A.Z)(X().mark(function c(){var o,Y,$,H,j,B,ee,L=arguments;return X().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return o=L.length>0&&L[0]!==void 0?L[0]:"",Y=L.length>1&&L[1]!==void 0?L[1]:"",$="",o.startsWith("http")?(H=o.split("//")[1].trim(),j=H.split("/")[0],$="https://".concat(j,"/cms/ticket")):(B=o.split("/")[0],$="https://".concat(B,"/cms/ticket")),M.prev=4,M.next=7,R.ZQ.get({url:$,params:{ticket:Y}});case 7:if(ee=M.sent,!(ee.status===200||ee.status===403)){M.next=10;break}return M.abrupt("return",Promise.resolve(!0));case 10:return M.abrupt("return",Promise.resolve(!1));case 13:return M.prev=13,M.t0=M.catch(4),M.abrupt("return",Promise.reject(new Error("false")));case 16:case"end":return M.stop()}},c,null,[[4,13]])}));return function(){return T.apply(this,arguments)}}(),Q=function(){var T=(0,A.Z)(X().mark(function c(o){var Y,$;return X().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,R.ZQ.get({url:z.ZP.local.getTicket(o)});case 2:if(Y=j.sent,$=Y.data,$.code!==0){j.next=6;break}return j.abrupt("return",Promise.resolve($.data.ticket));case 6:return j.abrupt("return",Promise.resolve(""));case 7:case"end":return j.stop()}},c)}));return function(o){return T.apply(this,arguments)}}(),g=function(){var T=(0,A.Z)(X().mark(function c(){var o;return X().wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.next=2,R.WY.get({url:z.ZP.advancedSetting.getSetting(),params:{page_size:9999,page_number:1}});case 2:return o=$.sent,$.abrupt("return",o.data.list);case 4:case"end":return $.stop()}},c)}));return function(){return T.apply(this,arguments)}}(),U=function(){var T=(0,A.Z)(X().mark(function c(o){var Y,$,H;return X().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.next=2,R.WY.get({url:z.ZP.localStorage.getPravateVideoUrl(o)});case 2:if(Y=B.sent,Y.data.code!==0){B.next=6;break}return $=Y.data.data.videoPlayInfo,H=$===void 0?"":$,B.abrupt("return",H);case 6:return B.abrupt("return","");case 7:case"end":return B.stop()}},c)}));return function(o){return T.apply(this,arguments)}}(),u=function(){var T=(0,A.Z)(X().mark(function c(o){var Y,$,H;return X().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return Y=z.ZP.localStorage.getPravateDocUrl(o),B.prev=1,B.next=4,R.WY.get({url:Y});case 4:if($=B.sent,H=$.data,!(H.code===0&&H.data)){B.next=8;break}return B.abrupt("return",H.data.docResourceDownloadUrl||"");case 8:return B.abrupt("return","");case 11:return B.prev=11,B.t0=B.catch(1),B.abrupt("return","");case 14:case"end":return B.stop()}},c,null,[[1,11]])}));return function(o){return T.apply(this,arguments)}}(),D=function(c){var o=c.studyInfo,Y=c.progress,$=c.recent_start,H=c.page_count,j=c.enterpriseId,B=c.userId,ee=c.token,L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,V,M=o.studyType;if(M==="studyTask"&&(V=z.ZP.SaveProgress.studySaveProgress(o)),(M==="course"||M==="enterprise")&&(V=z.ZP.SaveProgress.enterpriseCourseSaveProgress(o)),M==="studyProject"&&(V=z.ZP.SaveProgress.projectSaveProgress(o)),M==="platform"&&(V="".concat(z.ZP.SaveProgress.platformCourseSaveProgress(o))),(L||M==="platform")&&(V+="?enterprise_id=".concat(j,"&user_id=").concat(B)),L)return V+="&access_token=".concat(ee||localStorage.getItem("token")),V;var F={progress:Y,recent_start:$,tempTime:Date.parse(new Date)};return H&&(F.page_count=H),o.evaluationId&&(F.evaluation_id=o.evaluationId),R.WY.post({url:V,data:F})},k=T=>{var c=T.popupId,o=T.planId,Y=T.resourceId,$=T.type;return R.WY.post({url:z.ZP.TaskStudyRecord.setRandomPopupRecord(o),data:{course_id:Y,terminal_type:"PC",popup_id:c,type:$}})},I=(T,c)=>{var o=z.ZP.SaveProgress.reportStatusInterval(T);return R.WY.post({url:o,data:c})}},21594:function(Ee,ne,a){"use strict";a.d(ne,{pu:function(){return z},RG:function(){return Z},Gp:function(){return Q},O8:function(){return g}});var A=a(88986),S=a(69164),X=a(38642),R=a(41225),z=U=>{var u="";switch(U){case"myObligatoryTask":case"myElectiveTask":case"myTestTask":u="studyTask";break;case"enterprise":u="enterprise";break;case"courseProject":u="studyProject";break;case"platform":case"purchased":u="platform";break;default:break}return u},Z=(U,u)=>{var D={};return u.forEach(k=>{var I=U.find($=>$.type===k.type);if(I)if(k.type==="document_duration_limit"){var T=I.action_list,c=T.find($=>$.type==="random_popup_verification");!(0,X.UI)("RANDOM_POPUP_VERIFY")||!c?D[k.name]="CLOSE":D[k.name]=c.param.checked==="true"?"OPEN":"CLOSE"}else if(k.type==="document_player"){var o=JSON.parse(I.actions);o.forEach($=>{$.param.checked==="true"&&(D[k.name]=$.type)})}else if(k.type==="dynamic_watermark"){var Y=I.action_list;Y.forEach($=>{$.type===k.resourceType&&$.param.checked==="true"&&(D[k.name]=$.param.comment)})}else D[k.name]=I.switch_status}),D},Q=U=>{(0,R.sH)((0,A.Z)({progress:100,recent_start:1},U)).then(u=>{u&&u.data&&(0,S.Z)(u.data.integral_info||"")})},g=U=>{var u=document.createElement("div");return u.innerHTML=U,u.childNodes[0]}},51975:function(Ee,ne,a){"use strict";a.d(ne,{l:function(){return R}});var A=a(62029),S=a(12924),X=a.n(S),R=(z,Z)=>function(g){return X().createElement(z.Consumer,null,U=>X().createElement(Z,(0,A.Z)({},g,{contextData:U})))}},11449:function(Ee,ne,a){"use strict";a.d(ne,{Z:function(){return ce}});var A=a(88986),S=a(33565),X=a(12924),R=a.n(X),z=a(3115),Z=a(49111),Q=a(19650),g=a(62029),U=a(57663),u=a(71577),D=a(91768),k=a(28216),I=a(37055),T=a(10237);function c(de){var Ce=I.ZP.getHelpContentByMenuKey(),ve={key:de};return T.WY.get({url:Ce,params:ve})}var o=a(74228),Y=a.n(o),$=a(1164),H=a(76466),j=a(38642);class B extends R().Component{constructor(Ce){var ve;super(Ce);ve=this,this.getHelpContentByMenuKey=()=>{var ue=this.props.defaultMenuKey;c(ue).then(De=>{var ge=De.data,ke=ge.help_url,Pe=ge.video_url;this.setState({videoUrl:Pe,helpUrl:ke})})},this.handleOpenHelpUrl=ue=>{if((0,j.ve)()){window.open(ue,"_blank");return}$.Z.targetTo({path:ue,isExternalLink:!0})},this.handleOpenVideo=function(ue){var De=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ve.props.t("helpCenter.video");ve.setState(ge=>({resourcePlayInfo:(0,A.Z)((0,A.Z)({},ge.resourcePlayInfo),{},{resourceInfo:{originUrl:ue,source:{FD:ue,OD:ue},contentType:"mp4"}}),previewInfo:(0,A.Z)((0,A.Z)({},ge.previewInfo),{},{title:De,visible:!0,onCancel:ve.handleCancelPreview})}))},this.handleCancelPreview=()=>{var ue=this.state.previewInfo;this.setState({resourcePlayInfo:{mode:"preview",watchType:"video",resourceInfo:{}},previewInfo:(0,A.Z)((0,A.Z)({},ue),{},{visible:!1})})},this.state={helpUrl:"",videoUrl:"",resourcePlayInfo:{autoPlay:!0,draggable:!0,mode:"preview",resourceInfo:{},watchType:"video"},previewInfo:{visible:!1,destroyOnClose:!0,title:Ce.t("helpCenter.video")||"\u89C6\u9891\u6307\u5BFC",onCancel:()=>{}}}}componentDidMount(){this.getHelpContentByMenuKey()}render(){var Ce=this.state,ve=Ce.helpUrl,ue=Ce.resourcePlayInfo,De=Ce.previewInfo,ge=Ce.videoUrl,ke=this.props.t;return R().createElement("div",{className:Y().helpCenter},ge&&R().createElement(u.Z,{type:"link",className:Y()["video-btn"],style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenVideo(ge)},ke("helpCenter.video")),ve&&R().createElement(u.Z,{type:"link",style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenHelpUrl(ve)},ke("helpCenter.tutorial")),R().createElement(H.Z,(0,g.Z)({},ue,{previewInfo:De})))}}var ee=de=>({defaultMenuKey:de.currentRoute.menuKey});B.defaultProps={defaultMenuKey:""};var L=(0,k.$j)(ee)((0,D.Z)()(B));function V(de){var Ce=de.extra,ve=localStorage.getItem("dingPersonnel"),ue=sessionStorage.getItem("dingPersonnel");return R().createElement(Q.Z,null,Ce,ve!=="dingPersonnel"&&ue!=="dingPersonnel"&&(0,j.eY)("COMMONEXTRA_HELP_CENTER")&&R().createElement(L,null))}var M=V,F=a(4408);function J(de){var Ce=(0,X.useState)({helpCenter:(0,j.eY)("HEAD_HELP_CENTER_BUT")}),ve=(0,S.Z)(Ce,1),ue=ve[0],De=de.pageContainerParams,ge=De===void 0?{}:De,ke=de.noPadding,Pe=ke===void 0?!1:ke,xe=de.isPersonal,Oe=xe===void 0?!1:xe,we=de.pageTitle,Se=de.className,Ae=Se===void 0?"":Se,Le={extra:ue.helpCenter?R().createElement(M,{extra:ge.extra}):ge.extra},Re=(0,A.Z)((0,A.Z)({},ge),Le);return R().createElement("div",{className:"page-container-content ".concat(Pe?"page-container-noPadding":""," ").concat(Oe?"page-container-content_personal_background":""," ").concat(Ae)},we&&R().createElement(F.Z,{title:we}),Oe?R().createElement(z.Z,null,de.children):R().createElement(z.Z,Re,de.children))}var ce=J},491:function(Ee,ne,a){"use strict";a.r(ne),a.d(ne,{default:function(){return m}});var A=a(22385),S=a(31097),X=a(71194),R=a(57016),z=a(34792),Z=a(48086),Q=a(49111),g=a(19650),U=a(88983),u=a(47933),D=a(57663),k=a(71577),I=a(88986),T=a(12924),c=a.n(T),o=a(28216),Y=a(91768),$=a(76651),H=a(57068),j=a(49101),B=a(85853),ee=a(47673),L=a(4107),V=a(13254),M=a(14277),F=a(62029),J=a(32157),ce=a(75869),de=a(73218),Ce=a(76570),ve=a(37055),ue=a(10237);function De(p){var n=ve.ZP.personnelDevelope.findStructure();return ue.WY.post({url:n,data:p})}function ge(p){var n=ve.ZP.personnelDevelope.findSelective();return ue.WY.post({url:n,data:p})}function ke(p,n){var e=ve.ZP.personnelDevelope.postQualificationsClassify(),t;switch(n){case"add":t=ue.WY.post({url:e,data:p});break;case"edit":t=ue.WY.put({url:e,data:p});break;case"delete":t=ue.WY.delete({url:e,data:p});break;default:break}return t}var Pe=a(59239),xe=a(55446),Oe=a(18329);class we extends c().Component{constructor(n){super(n);this.cancelAddPostGroup=()=>{this.props.onAddCbk("cancel")},this.handleSaveAddPostGroup=()=>{var t=this.props,s=t.t,d=t.form,y=t.type,P=t.postId,N=y==="add";d.validateFields((b,W)=>{if(!b){var x=W.postName,O=this.state.superiorPostId;if(N){var q={name:x,parent_id:O,enterprise_id:window.localStorage.getItem("enterpriseId")};ke(q,"add").then(me=>{me.data.code===0?Z.default.success(s(N?"common.addSuccess":"common.editSuccess")):Z.default.info(s("common.addFailure")),this.props.onAddCbk("add")}).catch(()=>{})}else{var le={name:x,parent_id:O,id:P,enterprise_id:window.localStorage.getItem("enterpriseId")};ke(le,"edit").then(me=>{me.data.code===0?Z.default.success(s(N?"common.addSuccess":"common.editSuccess")):Z.default.info(s("common.addFailure")),this.props.onAddCbk("edit")}).catch(()=>{})}}})},this.checkPostName=(t,s,d)=>{var y=this.props.t;if(s){d();return}d(y("personnelDevelope.classifyNamePlaceholder"))};var e=c().createElement(k.Z,{key:"submit",type:"primary",onClick:this.handleSaveAddPostGroup},n.t("common.ok"));this.state={postName:this.props.initValue,superiorPostId:this.props.superiorPostId==="1"?void 0:this.props.superiorPostId,addPostGroupModal:{mask:!0,size:"small",footer:e,onCancel:this.cancelAddPostGroup}}}componentDidMount(){}render(){var n=this.props,e=n.t,t=n.form,s=t.getFieldDecorator,d=this.state.postName;return c().createElement(Oe.ZP,(0,F.Z)({},this.state.addPostGroupModal,{visible:this.props.visible,title:this.props.type==="add"?e("personnelDevelope.addedSubCategory"):e("personnelDevelope.classifyEdit")}),c().createElement("div",{className:"add-post-group-body"},c().createElement(Pe.Z,null,c().createElement(Pe.Z.Item,{label:e("personnelDevelope.classifyName"),required:!0,className:"add-post-group-label"},s("postName",{initialValue:d,rules:[{validator:this.checkPostName}]})(c().createElement(L.Z,{placeholder:e("personnelDevelope.classifyNamePlaceholder"),className:"add-post-group-input",maxLength:20}))))))}}we.defaultProps={type:"add",initValue:"",visible:!1,postId:"",onAddCbk:()=>{}};var Se=Pe.Z.create({name:"addPostGroup"})((0,Y.Z)()(we)),Ae=a(20136),Le=a(55241),Re=a(84874);class Ve extends T.Component{constructor(n){var e;super(n);e=this,this.onShowDeletePostTip=t=>{this.beforeDeleteTip(t,"post").then(()=>{this.sureDeletePost()})},this.onShowDeletePostGroupTip=t=>{this.beforeDeleteTip(t,"postGroup").then(()=>{this.sureDeletePostGroup()})},this.beforeDeleteTip=function(t){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"post";return t.stopPropagation(),new Promise(d=>{e.setState({popoverVisible:!1},()=>{var y=s==="post"?e.state.deletePostConfirmConfig:e.state.deletePostGroupConfirmConfig,P=y.title,N=y.content;R.Z.confirm({title:P,content:N,onOk:()=>{d()}})})})},this.handlePopoverVisible=t=>{this.setState({popoverVisible:t})},this.handleAddPostGroup=t=>{t.stopPropagation(),this.setState({popoverVisible:!1},()=>{this.props.addPostGroup(this.props.postId,"add")})},this.handleEditPostGroup=t=>{var s=this.props,d=s.postId,y=s.dataRef;t.stopPropagation(),this.setState({popoverVisible:!1},()=>{this.props.updatePostGroupName(d,y)})},this.handleAddPost=t=>{t.stopPropagation(),this.setState({popoverVisible:!1},()=>{this.props.addPost(this.props.postId,"add",this.props.postId)})},this.sureDeletePostGroup=()=>{var t=this.props,s=t.t,d=t.postId,y={id:d,enterprise_id:window.localStorage.getItem("enterpriseId")};ke(y,"delete").then(P=>{P.data.code===0?(Z.default.success(s("announcement.deleteSucceed")),this.props.deletePostCbk()):Z.default.info(s("announcement.deleteFailed"))}).catch(()=>{})},this.handleEditPost=t=>{var s=this.props,d=s.postId,y=s.superiorPostId;t.stopPropagation(),this.setState({popoverVisible:!1},()=>{this.props.addPost(d,"edit",y)})},this.sureDeletePost=()=>{var t=this.props,s=t.t,d=t.postId,y=ve.ZP.Organization.deletePost({id:d});ue.WY.delete({url:y}).then(()=>{Z.default.success(s("announcement.deleteSucceed")),this.props.deletePostCbk("success")})},this.state={deletePostConfirmConfig:{title:n.t("common.delete"),content:n.t("setting.deletePostTip")},deletePostGroupConfirmConfig:{title:n.t("common.delete"),content:n.t("personnelDevelope.deleteQualificationsGroup")},popoverVisible:!1}}render(){var n=this.props,e=n.t,t=n.dataRef,s=n.post_group_level,d=this.props.userCount,y=c().createElement("div",{className:"tree-node-operate-menu"},c().createElement("div",{onClick:this.onShowDeletePostTip},e("common.delete"))),P;return s===0?P=c().createElement("div",{className:"tree-node-operate-menu"},c().createElement("div",{onClick:this.handleAddPostGroup},e("personnelDevelope.addedSubCategory"))):P=c().createElement("div",{className:"tree-node-operate-menu"},c().createElement("div",{onClick:this.handleEditPostGroup},e("common.edit")),c().createElement("div",{onClick:this.onShowDeletePostGroupTip},e("common.delete")),t.post_group_level&&t.post_group_level<3?c().createElement("div",{onClick:this.handleAddPostGroup},e("personnelDevelope.addedSubCategory")):null),c().createElement("div",{className:"tree-node-title"},c().createElement(S.Z,{title:this.props.title},c().createElement("span",{className:"tooltip-span"},this.props.title)),this.props.type==="create"?c().createElement(Le.Z,{className:"ddd",placement:"bottom",title:"",visible:this.state.popoverVisible,onVisibleChange:this.handlePopoverVisible,content:P,trigger:"hover"},c().createElement(k.Z,{className:"tree-node-operate"},c().createElement(Re.Z,{iconClass:"icon-icon_morex"}))):null,d===0&&this.props.type!=="create"?c().createElement(Le.Z,{placement:"bottom",title:"",content:y,trigger:"hover"},c().createElement(k.Z,{className:"tree-node-operate"},c().createElement(Re.Z,{iconClass:"icon-icon_morex"}))):null)}}var _e=(0,Y.Z)()(Ve),Me=ce.Z.TreeNode,Fe=p=>({treeData:p.organization.postData,activePostId:p.organization.activePostId});class ze extends T.Component{constructor(n){var e;super(n);e=this,this.onSearch=()=>{ge({enterprise_id:window.localStorage.getItem("enterpriseId"),name:this.state.searchText}).then(t=>{var s=t.data.data;this.rest(s),this.setState({searchPostResult:s,isSearch:!0})}).catch(()=>{})},this.onAddPostGroupCbk=()=>{this.setState({showAddPostGroup:!1,editPostGroupName:"",currentOperatePost:""}),this.initTableList()},this.onTreeNodeClick=(t,s)=>{var d=s.node.props.dataRef.id;this.props.onSelectNode(d)},this.onExpand=t=>{this.setState({expandedKeys:t})},this.onInputSearchText=t=>{var s=t.target.value;this.setState({searchText:s})},this.onClearSearch=()=>{this.setState({searchText:"",isSearch:!1}),this.props.onClearSearch()},this.rest=t=>{t.forEach(s=>{s.post_name=s.name,s.parent_id=s.parentId,s.type="create",s.post_type="post_group",s.post_group_level=s.level,s.key=s.id,s.childes&&s.childes.length>0&&(s.children=s.childes,this.rest(s.children))})},this.initTableList=()=>{De({enterprise_id:window.localStorage.getItem("enterpriseId"),name:this.state.post_name}).then(t=>{var s=[t.data.data];s[0].id==="0"&&(s[0].name=this.props.t("personnelDevelope.fullCertification")),this.rest(s),this.setState({postTreeData:s}),this.state.startKey===""&&s.length>0&&this.setState({startKey:s[0].key,expandedKeys:[s[0].key]})}).catch(()=>{})},this.searchResultClick=(t,s)=>{if(this.props.onSelectNode){if(t===this.props.activePostId)return;this.props.dispatch({type:"organization/setActivePost",payload:{postId:t,postType:s}}),this.props.onSelectNode(t)}},this.addPostGroup=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0;e.setState({showAddPostGroup:!0,currentOperatePostGroup:t})},this.deletePostCbk=()=>{this.setState({params:(0,I.Z)((0,I.Z)({},this.state.params),{classify_id:this.state.startKey})},()=>{this.initTableList()})},this.updatePostGroupName=(t,s)=>{this.setState({showAddPostGroup:!0,editPostGroupName:s.post_name,currentOperatePost:t,currentOperatePostGroup:s.parent_id})},this.addPost=(t,s,d)=>{this.setState({currentOperatePost:t,currentOperatePostGroup:d})},this.addPostCbk=()=>{this.setState({currentOperatePost:""})},this.renderTreeNodes=t=>t.map(s=>{var d={postId:s.id,title:"".concat(s.post_name),isPostGroup:!!s.post_group_level,post_group_level:s.post_group_level,superiorPostId:s.parent_id,deletePostCbk:this.deletePostCbk,updatePostGroupName:this.updatePostGroupName,addPost:this.addPost,addPostGroup:this.addPostGroup,type:s.type,dataRef:(0,I.Z)({},s)};return s.children?c().createElement(Me,{className:s.children?"parent-node":"",title:c().createElement(_e,d),key:s.id,isLeaf:!1,dataRef:s},this.renderTreeNodes(s.children)):c().createElement(Me,(0,F.Z)({},s,{className:this.props.activePostId===s.id?"active-node":s.children?"parent-node":"",dataRef:s,key:s.id,isLeaf:!0,title:c().createElement(_e,d)}))}),this.renderSearchResult=()=>{var t=this.props.tabStatus,s=t===void 0?"":t,d=this.state.searchPostResult.map(y=>c().createElement("div",{className:this.props.activePostId===y.id?"org-tree-result org-tree-search-one active":"org-tree-search-one org-tree-result",key:y.id,onClick:()=>this.searchResultClick(y.id,y.type)},y.post_name));return c().createElement("div",{className:"org-tree-search-result",style:s?{height:"calc(100vh - 379px )"}:{}},this.state.searchPostResult.length>0?d:c().createElement(M.Z,{image:M.Z.PRESENTED_IMAGE_SIMPLE}))},this.state={startKey:"",searchPostResult:[],isSearch:!1,searchText:"",showAddPostGroup:!1,editPostGroupName:"",currentOperatePostGroup:void 0,expandedKeys:[],postTreeData:[]}}componentDidMount(){this.initTableList()}render(){var n=this.props,e=n.t,t=n.tabStatus,s=t===void 0?"":t,d=this.state.expandedKeys,y=this.state.searchText.length>0?c().createElement(de.Z,{onClick:this.onClearSearch}):c().createElement(Ce.Z,{onClick:this.onSearch});return c().createElement("div",{className:"org-tree-container post post-qualifications"},c().createElement("div",{style:{padding:"0 16px"}},c().createElement(L.Z,{className:"org-tree-search",value:this.state.searchText,placeholder:e("personnelDevelope.searchPlaceholder"),onInput:this.onInputSearchText,onPressEnter:this.onSearch,suffix:y})),this.state.showAddPostGroup?c().createElement(Se,{visible:this.state.showAddPostGroup,initValue:this.state.editPostGroupName,postId:this.state.currentOperatePost,superiorPostId:this.state.currentOperatePostGroup,type:this.state.editPostGroupName.length>0?"edit":"add",onAddCbk:this.onAddPostGroupCbk}):null,this.state.isSearch?this.renderSearchResult():c().createElement("div",{className:"post-group-padding-tree qualification-tree",style:s?{height:"calc(100vh - 230px )"}:{}},c().createElement(ce.Z,{showLine:{showLeafIcon:!1},defaultSelectedKeys:["0"],expandedKeys:d,onExpand:this.onExpand,onSelect:this.onTreeNodeClick},this.renderTreeNodes(this.state.postTreeData))))}}var be=(0,o.$j)(Fe)((0,Y.Z)()(ze)),We=a(14781),Ie=a(53431),Pt=a(59250),lt=a(13013),yt=a(48736),qe=a(27049),ct=a(77576),dt=a(59314),pt=a(30887),Ge=a(99210),et=a(57254),Be=a(66456),Ct=a(55313),tt=a(78001);class ut extends c().Component{constructor(n){super(n);this.onCancel=()=>{this.props.onCancel()},this.renderFooter=()=>{var e=this.props.t;return c().createElement(k.Z,{type:"primary",onClick:this.onCancel},e("common.ok"))},this.renderTotalNum=e=>{var t=this.props.data,s=0;return e==="ability"?t.forEach(d=>{s+=d.post_qualifications_ability.length}):s=t[0].length,tt.Z.t("personnelDevelope.totalNum",{num:s})},this.initRef=c().createRef()}render(){var n=this.props,e=n.data,t=n.baseInfo,s=n.columns;return c().createElement(Oe.ZP,{title:t.title,visible:t.visible,onCancel:this.onCancel,size:"medium",destroyOnClose:!0,maskClosable:!1,width:"560",footer:this.renderFooter(),wrapClassName:"qualification-list-modal"},e.length!==0&&e.map((d,y)=>c().createElement(c().Fragment,{key:y.toString()},t.type==="ability"?c().createElement("span",{className:"qualification-ability-title"},"".concat(d.abilityName,"\uFF08").concat(d.abilityNum,"\uFF09")):"",c().createElement(Ct.Z,{dataSource:t.type==="ability"?d.post_qualifications_ability:e[0],columns:s,pagination:!1}),t.type!=="ability"?c().createElement("span",{className:"qualification-total-num"},this.renderTotalNum(t.type)):"")),t.type==="ability"?c().createElement("span",{className:"qualification-total-num"},this.renderTotalNum(t.type)):"")}}var ht=(0,Y.Z)()(ut),Ne=a(1164),$e=a(36202),Ke=a(6793),at=a(71068);class He extends c().Component{constructor(n){super(n);this.onStatusChange=(e,t)=>{this.props.postDisable(e,t)},this.deleteQualification=e=>{var t=this.props.t;(0,B.Ek)(e).then(s=>{s.data.code===0&&s.data.data?Z.default.success(t("common.deleteSuccess")):Z.default.error(t("common.deleteFailure")),this.props.initList()})},this.moreOperate=e=>{var t=this.props.t;return c().createElement(Ge.Z,null,c().createElement(Ge.Z.Item,null,c().createElement(Ne.Z,{to:"/talentedDevelopment/postTrainPlan/postQualifications/add?id=".concat(e.id,"&copy=true")},c().createElement("p",{className:"cl-dropdown-menuitem"},t("common.copy")))),c().createElement(Ge.Z.Item,null,c().createElement(S.Z,{title:e.status===1||e.post_num!==0?t("personnelDevelope.delQualificationStatusTip"):""},c().createElement("p",{onClick:()=>{this.beforeDeleteQualification(e)},className:e.status===1||e.post_num!==0?"cl-dropdown-menuitem cl-disabled":"cl-dropdown-menuitem"},t("community.deleteQuestion")))))},this.beforeDeleteQualification=e=>{if(!(e.status===1||e.post_num!==0)){var t=this.props.t;this.setState({currentQualificationId:e.id},()=>{var s={title:t("common.tip"),desc:t("personnelDevelope.delQualificationDescTip"),record:e};this.renderDeleteTip(s)})}},this.renderDeleteTip=e=>{var t=e.title,s=e.desc,d=e.record;this.setState({deleteListTipInfo:{title:t,desc:s,record:d,visible:!0}})},this.handleTableChange=(e,t)=>{this.props.onTableChange({current:e,pageSize:t})},this.showInfoDetail=(e,t)=>{var s=this.state.baseInfo,d=this.props.t;(0,B.MM)({qualification_id:e.id,type:t}).then(y=>{var P="",N="";switch(t==="ability"&&y.data.data.forEach(b=>{b.abilityName=b.name,b.abilityNum=b.post_qualifications_ability.length}),t){case"ability":P=[{title:d("evaluation.powerName"),dataIndex:"ability_name",textWrap:"word-break",ellipsis:!0,render:b=>{var W="/talentedDevelopment/abilityAble/evaluationAbility?abilityName=".concat(b);return c().createElement(Ne.Z,{to:W},b)}},{title:d("evaluation.abilityLevel"),dataIndex:"ability_level",textWrap:"word-break",ellipsis:!0,render:(b,W)=>{var x;return W.ability_levels.forEach(O=>{O.default_score===b&&(x=O.level_name)}),x||"---"}},{title:d("evaluation.behaviorDesc"),dataIndex:"behavior_desc",textWrap:"word-break",ellipsis:!0,render:b=>b||"---"}],N=d("evaluationManage.abilityOption");break;case"task":P=[{title:d("exam.taskName"),dataIndex:"name",textWrap:"word-break",ellipsis:!0},{title:d("personnelDevelope.taskDescription"),dataIndex:"description",textWrap:"word-break",ellipsis:!0,render:b=>b||"---"}],N=d("personnelDevelope.keyTask");break;case"certificate":P=[{title:d("component.certificateName"),dataIndex:"name",textWrap:"word-break",ellipsis:!0},{title:d("navigatorSetting.type"),dataIndex:"type",render:b=>{var W="";return b==="external"?W=d("personnelDevelope.external"):W=d("personnelDevelope.platformCertificate"),W}},{title:d("personnelDevelope.text"),dataIndex:"text",textWrap:"word-break",ellipsis:!0,render:b=>b||"---"},{title:d("personnelDevelope.certificateDesc"),dataIndex:"description",textWrap:"word-break",ellipsis:!0,render:b=>b||"---"}],N=d("personnelDevelope.requiredCertificates");break;case"contribute":P=[{title:d("personnelDevelope.contributionName"),dataIndex:"name",textWrap:"word-break",ellipsis:!0},{title:d("personnelDevelope.contributionDesc"),dataIndex:"description",textWrap:"word-break",ellipsis:!0}],N=d("personnelDevelope.organizeContribute");break;default:break}y.data.code===0&&this.setState({baseInfo:(0,I.Z)((0,I.Z)({},s),{},{title:N,type:t,visible:!0}),tableSourceData:t==="ability"?y.data.data:[y.data.data],tableSourceColumns:P})})},this.onCancel=()=>{var e=this.state.baseInfo;this.setState({baseInfo:(0,I.Z)((0,I.Z)({},e),{},{visible:!1})})},this.deleteList=()=>{this.deleteQualification(this.state.currentQualificationId)},this.cancelList=()=>{this.setState({deleteListTipInfo:(0,I.Z)((0,I.Z)({},this.state.deleteListTipInfo),{},{visible:!1})})},this.state={currentQualificationId:"",baseInfo:{visible:!1},tableSourceData:[],deleteListTipInfo:{visible:!1}}}status(){return{title:this.props.t("personnelDevelope.state"),dataIndex:"status",key:"status",width:100,render:(n,e,t)=>c().createElement(dt.Z,{checkedChildren:this.props.t("common.activated"),unCheckedChildren:this.props.t("common.unactivated"),onClick:()=>{this.onStatusChange(e,t)},checked:n===1})}}operate(){return{title:this.props.t("personnelDevelope.operate"),width:180,key:"operate",fixed:"right",render:(n,e)=>c().createElement(c().Fragment,null,c().createElement("span",{className:"personnel-develope__content__table-pointer post-qualification-edit"},c().createElement(Ne.Z,{to:"/talentedDevelopment/postTrainPlan/postQualifications/add?id=".concat(e.id)},this.props.t("common.edit"))),c().createElement(c().Fragment,null,c().createElement(qe.Z,{type:"vertical"}),c().createElement(lt.Z,{overlay:this.moreOperate(e)},c().createElement("a",null,this.props.t("common.more")," ",c().createElement(et.Z,null)))))}}render(){var n=this.state,e=n.baseInfo,t=n.tableSourceData,s=n.tableSourceColumns,d=n.deleteListTipInfo,y=this.props,P=y.list,N=P===void 0?[]:P,b=y.loading,W=y.paginationParams,x=W===void 0?{}:W,O=y.headerTitle,q=y.toolBarRender,le=y.actionEdit,me=y.actionChange,ye=y.handleRelatedPosts,w=y.t,C=(0,I.Z)((0,I.Z)({},ve.XE.INITIAL_PAGINATION),x),f=[{title:w("personnelDevelope.qualifications"),dataIndex:"name",key:"name",width:220,fixed:"left",textWrap:"word-break",ellipsis:!0,render:(l,h)=>c().createElement(S.Z,{placement:"top",title:h.name},c().createElement("div",{className:"qualification-lists-name"},c().createElement(Ne.Z,{to:"/talentedDevelopment/postTrainPlan/postQualifications/add?id=".concat(h.id,"&view=true")},h.name)))},{title:w("personnelDevelope.classify"),dataIndex:"classify_name",key:"classify_name",width:140,render:l=>l||"--"},{title:w("personnelDevelope.RelatedJobs"),dataIndex:"post_num",key:"post_num",width:120,render:(l,h)=>c().createElement("div",{onClick:()=>{ye(h)},className:"cl-pointer"},h.post_num)},{title:()=>c().createElement(S.Z,{title:w("personnelDevelope.powerDetail")},c().createElement("span",null,w("evaluationManage.abilityOption"))),dataIndex:"ability_num",key:"ability_num",width:120,render:(l,h)=>h.ability_num!==0?c().createElement("a",{onClick:()=>{this.showInfoDetail(h,"ability")}},l):c().createElement("span",null,l)},{title:w("personnelDevelope.keyTask"),dataIndex:"emphasis_task_num",key:"emphasis_task_num",width:140,render:(l,h)=>h.emphasis_task_num!==0?c().createElement("a",{onClick:()=>{this.showInfoDetail(h,"task")}},l):c().createElement("span",null,l)},{title:w("personnelDevelope.requiredCertificates"),dataIndex:"emphasis_certificate_num",key:"emphasis_certificate_num",width:140,render:(l,h)=>h.emphasis_certificate_num!==0?c().createElement("a",{onClick:()=>{this.showInfoDetail(h,"certificate")}},l):c().createElement("span",null,l)},{title:w("personnelDevelope.organizeContribute"),dataIndex:"emphasis_contribute_num",key:"emphasis_contribute_num",width:140,render:(l,h)=>h.emphasis_contribute_num!==0?c().createElement("a",{onClick:()=>{this.showInfoDetail(h,"contribute")}},l):c().createElement("span",null,l)},{title:w("personnelDevelope.updateTime"),dataIndex:"update_time",key:"update_time",width:150,render:l=>(0,Ke.p6)(Number(l),"yyyy-MM-dd hh:mm")},{title:w("personnelDevelope.operator"),dataIndex:"update_user_name",key:"update_user_name",width:120,render:l=>l||"--"}];me&&f.push(this.status()),le&&f.push(this.operate());var i=[{title:w("common.name"),dataIndex:"name",textWrap:"word-break",ellipsis:!0,render:l=>c().createElement(S.Z,{placement:"top",title:l},c().createElement("div",{className:"post-qualification-name"},l))},{title:w("personnelDevelope.RelatedJobs"),dataIndex:"post_num"},{title:w("evaluationManage.abilityOption"),dataIndex:"ability_num"},{title:w("personnelDevelope.keyTask"),dataIndex:"emphasis_task_num"},{title:w("personnelDevelope.requiredCertificates"),dataIndex:"emphasis_certificate_num"}];return c().createElement("section",{className:"personnel-develope__content__table"},c().createElement("div",null,c().createElement($e.f,{headExtra:this.headExtra,columns:f,rowKey:l=>l.id,dataSource:N,loading:b,headerTitle:O(),toolBarRender:q,pagination:!1,tableUUID:"c8dd8260-6ac7-48fd-bc91-c6aa1edbf6dc",scroll:{x:"max-content",y:"100%"}})),c().createElement("div",{className:"personnel-develope-pagination-wrapper"},c().createElement(Ie.Z,(0,F.Z)({},C,{onChange:this.handleTableChange,className:"personnel-develope-pagination"}))),c().createElement(ht,{baseInfo:e,data:t,columns:s,type:e.type,onCancel:this.onCancel}),c().createElement(at.Z,{title:d.title,visible:d.visible,record:[d.record],columns:i,desc:d.desc,delete:this.deleteList,cancel:this.cancelList}))}}var mt=(0,Y.Z)()(He),st=a(57119);class Ye extends c().Component{constructor(n){super(n);this.handleTableChange=(e,t)=>{this.props.onTableChange({current:e,pageSize:t})},this.selectChange=e=>{this.props.oneHeaderTitleChange(e)},this.deletePostCheck=e=>{var t=this.props.t;(0,B.Ej)(e).then(s=>{s.data.data===0?R.Z.confirm({title:t("common.tip"),icon:c().createElement(st.Z,null),content:t("personnelDevelope.delPostCheck"),okText:t("common.ok"),cancelText:t("common.cancel"),onOk:()=>{this.unbindPost(e)}}):this.unbindPost(e)})},this.unbindPost=e=>{var t=this.props.t;(0,B.Yn)(e).then(()=>{this.props.getInitList(!0),Z.default.success(t("personnelDevelope.unbindSucceeded"))})},this.state={typeList:[{name:"".concat(n.t("common.all")),value:2},{name:"".concat(n.t("personnelDevelope.notConfiguration")),value:-1},{name:"".concat(n.t("personal.draft")),value:0},{name:"".concat(n.t("personal.published")),value:1}]}}render(){var n=this.props,e=n.list,t=e===void 0?[]:e,s=n.loading,d=n.paginationParams,y=d===void 0?{}:d,P=n.toolBarRender,N=n.t,b=this.state.typeList,W=(0,I.Z)((0,I.Z)((0,I.Z)({},ve.XE.INITIAL_PAGINATION),y),{},{pageSizeOptions:["5","20","30","40","50"]}),x=[{title:this.props.t("personnelDevelope.postName"),dataIndex:"post_name",key:"post_name",width:140,render:O=>{var q="/talentedDevelopment/postTrainPlan/postCollocation?post_name=".concat(O);return c().createElement(S.Z,{title:O},c().createElement(Ne.Z,{to:q},c().createElement("div",{className:"related-posts-container-ellipsis related-posts-container-max-width"},O)))}},{title:this.props.t("personnelDevelope.learningPlan"),dataIndex:"status",key:"status",width:140,render:O=>b.reduce((q,le)=>O===le.value?le.name+q:q,"")},{title:this.props.t("personnelDevelope.updateTime"),dataIndex:"update_time",key:"update_time",width:140,render:O=>(0,Ke.p6)(Number(O),"yyyy-MM-dd hh:mm")},{title:N("common.operate"),width:140,render:(O,q)=>c().createElement("a",{onClick:()=>{this.deletePostCheck(q.post_id)}},N("personnelDevelope.unbind"))}];return c().createElement("section",null,c().createElement("div",null,c().createElement($e.f,{columns:x,dataSource:t,loading:s,toolBarRender:P,tableUUID:"cf93bc8d-85cf-4019-3458-be03838aa220",scroll:{x:"max-content",y:"100%"}})),c().createElement("div",{className:"personnel-develope-pagination-wrapper"},c().createElement(Ie.Z,(0,F.Z)({},W,{onChange:this.handleTableChange,className:"personnel-develope-pagination"}))))}}var Qe=(0,Y.Z)()(Ye);class rt extends c().Component{constructor(n){super(n);this.onCancel=()=>{this.props.setRelatedPostsVisible(this.state.isUnBind)},this.onTableChange=e=>{this.setState({params:(0,I.Z)((0,I.Z)({},this.state.params),{},{page_size:e.pageSize,page_number:e.current})},()=>{this.getInitList()})},this.getInitList=e=>{var t=this.state,s=t.qualification_id,d=t.params;(0,B.HY)((0,I.Z)((0,I.Z)({},d),{},{qualification_id:s})).then(y=>{var P=y.data.data,N=P.list,b=P.total;this.setState({tableLoading:!1,tableList:N,tableTotal:b,isUnBind:e})}).catch(()=>{})},this.state={params:{page_number:1,page_size:5},qualification_id:n.relatedPostsQualificationObj.id,tableTotal:0,tableList:[],tableLoading:!1,isUnBind:!1}}componentDidMount(){this.getInitList()}render(){var n=this.props,e=n.visible,t=n.setOrgDialogVisible,s=n.relatedPostsQualificationObj.status,d=this.state,y=d.tableTotal,P=d.tableList,N=d.tableLoading,b=d.params,W={total:Number(y),current:b.page_number,pageSize:b.page_size};return c().createElement(Oe.ZP,{title:this.props.t("personnelDevelope.RelatedJobs"),visible:e,onCancel:this.onCancel,footer:null},c().createElement("div",{className:"related-posts-container"},c().createElement("div",{className:"related-posts-container-button"},c().createElement(k.Z,{onClick:t,disabled:s!==1,type:"primary"},this.props.t("personnelDevelope.RelatedJobs"))),c().createElement(Qe,{loading:N,paginationParams:W,toolBarRender:!1,list:P,scroll:{y:"100%",x:"max-content"},handleRelatedPosts:this.relatedPosts,onTableChange:this.onTableChange,getInitList:this.getInitList})))}}var Je=(0,Y.Z)()(rt),je=a(86726),vt=a(11449),nt=a(4408),ft=a(48479),gt=a(88311);class pe extends c().Component{constructor(n){super(n);this.onClearSearch=()=>{this.setState({params:(0,I.Z)((0,I.Z)({},this.state.params),{classify_id:"0"})},()=>{this.initTableList()})},this.initTableList=()=>{this.setState({tableLoading:!0});var e=this.state.params;e.classify_id==="0"&&(e.classify_id=""),(0,B.cc)(e).then(t=>{this.setState({tableLoading:!1,tableList:t.data.data.list,tableTotal:t.data.data.total,radioList:[{name:"".concat(this.props.t("common.all")),value:"all"},{name:"".concat(this.props.t("common.activateder")),value:"normal"},{name:"".concat(this.props.t("personnelDevelope.deactivateder")),value:"prohibit"}]})}).catch(()=>{this.setState({tableLoading:!1})})},this.renderProTableHeaderTitle=()=>{var e=this.state.actions,t=this.props.t;return c().createElement("div",{className:"header-title"},(0,je.H3)("add",e)&&c().createElement(Ne.Z,{to:"/talentedDevelopment/postTrainPlan/postQualifications/add"},c().createElement(k.Z,{type:"primary",icon:c().createElement(j.Z,null)}," ",t("common.add"))))},this.renderProTableToolBarRender=()=>{var e=this.state.params,t=this.props.t,s=H.parse($.m8.location.search),d=s.qualification,y=d||"";return c().createElement("div",{className:"search-box"},c().createElement(g.Z,null,c().createElement(u.ZP.Group,{size:"default",defaultValue:e.status,onChange:this.handleStatusChange},this.state.radioList.map(P=>c().createElement(u.ZP.Button,{key:P.value,value:P.value},P.name))),c().createElement(ft.Z,{value:y,onSearch:this.handleSearch,width:"272px",placeholder:t("personnelDevelope.searchPlaceholderAbility"),maxLength:50})))},this.handleStatusChange=e=>{this.setState({params:(0,I.Z)((0,I.Z)({},this.state.params),{status:e.target.value,page_number:1})},()=>{this.initTableList()})},this.handleSearch=e=>{this.setState({params:(0,I.Z)((0,I.Z)({},this.state.params),{name:e,page_number:1})},()=>{this.initTableList()})},this.handleChangePagination=e=>{this.setState({params:(0,I.Z)((0,I.Z)({},this.state.params),{page_number:e.current,page_size:e.pageSize})},()=>{this.initTableList()})},this.postDisable=(e,t)=>{(0,B.lC)({id:e.id}).then(s=>{if(s.data.code===0){var d=[...this.state.tableList],y=this.state.tableList[t].status;d[t].status=y===0?1:0,this.setState({tableList:d})}else Z.default.info(s.data.msg)}).catch(()=>{})},this.handlePostNode=e=>{var t=this.state.params;this.setState({params:(0,I.Z)((0,I.Z)({},t),{classify_id:e})},()=>{this.initTableList()})},this.relatedPosts=e=>{this.setState({relatedPostsQualificationObj:e,relatedPostsVisible:!0})},this.setRelatedPostsVisible=e=>{this.setState({relatedPostsVisible:!1}),e&&this.initTableList()},this.setOrgDialogVisible=()=>{this.setState({orgModalConfig:(0,I.Z)((0,I.Z)({},this.state.orgModalConfig),{},{visible:!0})})},this.orgDialogCancel=()=>{this.setState({orgModalConfig:(0,I.Z)((0,I.Z)({},this.state.orgModalConfig),{},{visible:!1})})},this.orgDialogOk=e=>{this.setState({orgPostList:e.post},()=>{var t=this.state.relatedPostsQualificationObj.id,s=e.post.map(d=>d.id);(0,B.Qs)({qualification_id:t,post_id_list:s}).then(d=>{this.setState({checkPostList:d.data.data.result},()=>{s.length!==0&&(d.data.data.result.length>0?this.orgDialogOkInfo():this.submitPostAbilityModel())})}).catch(()=>{})})},this.submitPostAbilityModel=()=>{var e=this.state.relatedPostsQualificationObj.id,t=this.state.orgPostList.map(s=>s.id);(0,B.wW)({qualification_id:e,post_id_list:t}).then(s=>{s.data.result==="true"&&this.orgDialogOkInfoSuccess()}).catch(()=>{})},this.orgDialogOkInfoSuccess=()=>{this.setState({relatedPostsVisible:!1,orgModalConfig:(0,I.Z)((0,I.Z)({},this.state.orgModalConfig),{},{visible:!1})},()=>{this.initTableList()}),Z.default.success(this.props.t("personnelDevelope.RelatedJobsSuccess"))},this.state={actions:(0,je.V9)("postQualifications",n.modules),tabStatus:!0,organizationType:"ding",params:{name:"",page_number:1,page_size:20,status:"all",classify_id:"",sort:"desc",enterprise_id:window.localStorage.getItem("enterpriseId")},tableLoading:!1,tableList:[],tableTotal:0,radioList:[],relatedPostsQualificationObj:{},relatedPostsVisible:!1,orgModalConfig:{visible:!1,title:n.t("course.jobs"),onlyDept:!0,onlyChoosePost:!0,onlyPost:!0,displayType:["post",""],onOk:this.orgDialogOk,onCancel:this.orgDialogCancel},orgPostList:[],checkPostList:[]}}componentDidMount(){var n=H.parse($.m8.location.search),e=n.qualification;e?this.handleSearch(e):this.initTableList()}orgDialogOkInfo(){var n=this.state.checkPostList,e=this.submitPostAbilityModel;R.Z.confirm({title:this.props.t("common.tip"),content:c().createElement("div",null,c().createElement("p",null,this.props.t("personnelDevelope.orgDialogOkInfo")),c().createElement(S.Z,{title:n.join(",")},c().createElement("p",{className:"with-class-org-dialog-ok-info"},n.join(",")))),onOk(){e()}})}render(){var n=this.props,e=n.prefixCls,t=n.t,s=this.state,d=s.tableTotal,y=s.params,P=s.tabStatus,N=s.organizationType,b=s.tableLoading,W=s.tableList,x=s.relatedPostsVisible,O=s.relatedPostsQualificationObj,q=s.orgModalConfig,le={total:d,current:y.page_number,pageSize:y.page_size};return c().createElement(vt.Z,{pageContainerParams:{header:{title:t("personnelDevelope.qualificationTitle")}}},c().createElement(nt.Z,{title:t("personnelDevelope.qualificationTitle")}),c().createElement("div",{className:e},c().createElement("div",{className:"".concat(e,"__content ")},c().createElement("div",{className:"with-class-left"},c().createElement(be,{onClearSearch:this.onClearSearch,onSelectNode:this.handlePostNode,tabStatus:P,organizationType:N})),c().createElement("div",{className:"with-class-right"},c().createElement(mt,{headerTitle:this.renderProTableHeaderTitle,toolBarRender:this.renderProTableToolBarRender,loading:b,paginationParams:le,list:W,onTableChange:this.handleChangePagination,scroll:{y:"100%",x:"max-content"},postDisable:this.postDisable,handleRelatedPosts:this.relatedPosts,actionEdit:(0,je.H3)("add",this.state.actions),actionChange:(0,je.H3)("enable/disabled",this.state.actions),initList:this.initTableList})))),x&&c().createElement(Je,{setOrgDialogVisible:this.setOrgDialogVisible,setRelatedPostsVisible:this.setRelatedPostsVisible,visible:x,relatedPostsQualificationObj:O}),c().createElement(gt.Z,q))}}pe.defaultProps={prefixCls:"with-class"};var m=(0,o.$j)(p=>({modules:p.user.modules}))((0,Y.Z)()(pe))},85853:function(Ee,ne,a){"use strict";a.d(ne,{lC:function(){return z},cc:function(){return Q},ww:function(){return k},zZ:function(){return I},EW:function(){return T},NV:function(){return c},HY:function(){return o},Qs:function(){return Y},wW:function(){return $},Ek:function(){return H},Yn:function(){return j},MM:function(){return B},Ej:function(){return ee}});var A=a(37055),S=a(10237);function X(L){var V=CONFIG.submitReport.reportManageList();return request.get({url:V,params:L})}function R(L){var V=CONFIG.personnelDevelope.qualification_id();return request.delete({url:V,params:L})}function z(L){var V=A.ZP.personnelDevelope.qualificationsDisable(L.id);return S.WY.get({url:V,params:L})}function Z(L){var V=CONFIG.personnelDevelope.qualificationsDelete(L.id);return request.delete({url:V,params:L})}function Q(L){var V=A.ZP.personnelDevelope.qualificationsList();return S.WY.post({url:V,data:L})}function g(L){var V=CONFIG.personnelDevelope.postRanks();return request.post({url:V,params:L})}function U(L){var V=CONFIG.personnelDevelope.postRanks();return request.put({url:V,params:L})}function u(L){var V=CONFIG.personnelDevelope.postRanksDelete();return request.put({url:V,params:L})}function D(L){var V=CONFIG.personnelDevelope.find_structure();return request.get({url:V,params:L})}function k(){var L=A.ZP.personnelDevelope.getUserPosts();return S.WY.get({url:L})}function I(L){var V=L.post_id,M=L.post_name,F=A.ZP.personnelDevelope.getUserPostsChannel(V);return S.WY.get({url:F,params:{post_name:M}})}function T(L){var V=L.qualification_id,M=L.type,F=A.ZP.personnelDevelope.certTaskInfo(V);return S.WY.get({url:F,params:{type:M}})}function c(){var L=A.ZP.personnelDevelope.configList();return S.WY.get({url:L,params:{enterprise_id:window.localStorage.getItem("enterpriseId")}})}function o(L){var V=L.qualification_id,M=L.page_size,F=L.page_number,J=A.ZP.personnelDevelope.qualificationPostList();return S.WY.get({url:J,params:{qualification_id:V,page_size:M,page_number:F}})}function Y(L){var V=L.qualification_id,M=L.post_id_list,F=A.ZP.personnelDevelope.checkPostAbilityModel();return S.WY.post({url:F,data:{qualification_id:V,post_id_list:M,enterprise_id:A.ZP.enterpriseId}})}function $(L){var V=L.qualification_id,M=L.post_id_list,F=A.ZP.personnelDevelope.submitPostAbilityModel();return S.WY.post({url:F,data:{qualification_id:V,post_id_list:M,enterprise_id:A.ZP.enterpriseId}})}function H(L){var V=A.ZP.personnelDevelope.deleteQualification(L);return S.WY.delete({url:V})}function j(L){var V=A.ZP.personnelDevelope.unbindPost(L);return S.WY.delete({url:V})}function B(L){var V=L.qualification_id,M=L.type,F=A.ZP.personnelDevelope.showInfoDetail(V,M);return S.WY.get({url:F})}function ee(L){var V=A.ZP.personnelDevelope.deletePostCheck(L);return S.WY.get({url:V})}},9849:function(Ee,ne,a){"use strict";a.d(ne,{Ej:function(){return z},kL:function(){return Z},T:function(){return Q},NU:function(){return g},FL:function(){return U},fn:function(){return u},bm:function(){return D},jY:function(){return k},Vs:function(){return I},li:function(){return T},Nl:function(){return c},YF:function(){return o},Q6:function(){return Y},zW:function(){return $},Zv:function(){return H},Qg:function(){return j},qc:function(){return B},Ve:function(){return L},rS:function(){return V},Rh:function(){return M}});var A=a(10237),S=a(37055),X=a(38642),R={zaraFlag:(0,X.UI)("ZARA_H5")};function z(F,J){var ce=S.ZP.StudyProjectList.startStudy(F);return A.WY.post({url:ce,data:J})}function Z(F){var J=S.ZP.Common.enroll(F);return A.WY.post({url:J})}function Q(F,J){var ce=F.courseId,de=S.ZP.StudyProjectList.studyProject(ce);return A.WY.get({url:de,params:J})}function g(F){var J=F.id,ce=R.zaraFlag?S.m1.getAssessmentProjectInfo(J):S.m1.getProjectInfo(J);return A.WY.get({url:ce})}function U(F){var J=F.courseId,ce=S.ZP.EnterpriseCourse.addScanCount(J);return A.WY.post({url:ce})}function u(){var F=S.ZP.StudyProjectList.getAccountInfo();return A.WY.get({url:F})}function D(F){var J=S.ZP.StudyProjectList.projectCertiUrl(F);return A.WY.get({url:J})}function k(F){var J=F.courseId,ce=S.ZP.Courses.like(J);return A.WY.post({url:ce})}function I(F){var J=S.ZP.EnterpriseCourse.addCommentAndScore();return A.qg.post({url:J,data:F})}function T(F){var J=S.ZP.EnterpriseCourse.getCourseComments();return A.WY.get({url:J,params:F})}function c(F){var J=S.ZP.EnterpriseCourse.addCommentAndScore();return A.qg.post({url:J,data:F})}function o(F){var J=S.ZP.EnterpriseCourse.deleteComment();return A.qg.post({url:J,data:F})}function Y(F,J){var ce=S.ZP.StudyProjectList.projectStudyRecord(F);return A.WY.get({url:ce,params:J})}function $(F){var J=S.ZP.DingSpaceId.getSpaceId();return A.WY.get({url:J,params:F})}function H(F,J){var ce=S.ZP.PlatformCourse.learningUrl(F);return A.WY.get({url:ce,params:J})}function j(F){var J=S.ZP.MyExamTask.examIntro({examId:F});return A.WY.get({url:J})}function B(F){var J=S.ZP.MyExamTask.examCheckStatus({examId:F});return A.WY.get({url:J})}function ee(F,J){var ce=CONFIG.Common.getOperateLog(F);return formDataRequest.get({url:ce,params:J})}function L(F,J){var ce=R.zaraFlag?S.ZP.StudyProjectList.changeCustomStatus(F):S.ZP.StudyProjectList.changeStatus(F);return A.WY.post({url:ce,data:J})}function V(F){var J=S.ZP.StudyProjectList.getProjectReward(F);return A.WY.get({url:J})}function M(F){var J=S.ZP.subsidyGz.subsidyCourseSetting(F);return A.WY.get({url:J})}},91648:function(Ee,ne,a){"use strict";a.d(ne,{Z:function(){return A}});function A(S,X){var R,z,Z,Q,R;if(z="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),R=[],Z=void 0,X=X||z.length,S)for(Z=0;Z<S;)R[Z]=z[0|Math.random()*X],Z++;else for(Q=void 0,R[8]=R[13]=R[18]=R[23]="-",R[14]="4",Z=0;Z<36;)R[Z]||(Q=0|Math.random()*16,R[Z]=z[Z===19?Q&3|8:Q]),Z++;return R.join("")}},86726:function(Ee,ne,a){"use strict";a.d(ne,{V9:function(){return S},H3:function(){return X},e:function(){return R},F:function(){return z}});var A=a(93485);function S(Z){var Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],g=[];function U(u,D){var k=(0,A.Z)(D),I;try{for(k.s();!(I=k.n()).done;){var T=I.value;if(T.key===u){g=T.actions;break}T.children instanceof Array&&T.children.length&&U(Z,T.children)}}catch(c){k.e(c)}finally{k.f()}}return U(Z,Q),g}function X(Z){var Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],g=Q.find(U=>U.key===Z)||{};return g.checked||!1}function R(Z){var Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],g=!1;function U(u,D){var k=(0,A.Z)(D),I;try{for(k.s();!(I=k.n()).done;){var T=I.value;if(T.key===u){g=T.checked;break}T.children instanceof Array&&T.children.length&&U(Z,T.children)}}catch(c){k.e(c)}finally{k.f()}}return U(Z,Q),g}function z(Z){var Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],g="";function U(u,D){var k=(0,A.Z)(D),I;try{for(k.s();!(I=k.n()).done;){var T=I.value;if(T.key===u){g=T.id;break}T.children instanceof Array&&T.children.length&&U(Z,T.children)}}catch(c){k.e(c)}finally{k.f()}}return U(Z,Q),g}},69164:function(Ee,ne,a){"use strict";var A=a(34792),S=a(48086);function X(R){R&&R.length>0&&S.default.success(R)}ne.Z=X},65202:function(Ee,ne,a){"use strict";a.d(ne,{p:function(){return A}});function A(){return localStorage.getItem("themeColor")||"#516AE6"}},25547:function(Ee,ne,a){"use strict";a.d(ne,{Yd:function(){return X},VX:function(){return z},lK:function(){return Z},NP:function(){return Q}});var A=a(88986),S=a(93485);function X(g,U,u){var D=0;function k(I,T){for(var c=0;c<I.length;c++){var o=I[c];if(o[g]===U){D=T;break}else o.children instanceof Array&&o.children.length&&k(o.children,T+1)}}return k(u,1),D}function R(g){var U=1;function u(D,k){D.forEach(I=>{k>U&&(U=k),I.children&&I.children.length>0&&u(I.children,k+1)})}return u(g,1),U}function z(g,U,u){g.forEach((D,k,I)=>{if(D.id===U)return u(D,k,I);if(D.children)return z(D.children,U,u)})}function Z(g,U){var u;function D(k){var I=(0,S.Z)(k),T;try{for(I.s();!(T=I.n()).done;){var c=T.value;if(c.id==U){u={id:c.id,name:c.name,children:c.children,parentId:c.parentId};break}c.children&&c.children instanceof Array&&c.children.length>0&&D(c.children)}}catch(o){I.e(o)}finally{I.f()}}return D(g),u?(0,A.Z)((0,A.Z)({},u),{},{children:u.children instanceof Array?u.children:[]}):{children:[],id:"",name:""}}var Q=function(){var U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"children",k=[...U];function I(T){Object.keys(u).forEach(c=>{var o=c,Y=u[c];T[Y]=T[o],T[D]=T[D]&&T[D]instanceof Array?[...T[D]]:[],T[D].length?T[D].forEach($=>{I($)}):delete T[D]})}return k.forEach(T=>I(T)),k}},2396:function(Ee,ne,a){"use strict";a.d(ne,{fA:function(){return X},kh:function(){return R},kR:function(){return z},rw:function(){return Q},$s:function(){return g},q_:function(){return U},QK:function(){return u}});var A=a(6793),S={limitWords(D,k){return{rules:[{max:D,message:"\u6700\u591A\u8F93\u5165".concat(D,"\u4E2A\u5B57")},{required:!0,message:k||"\u8BF7\u8F93\u5165\u9700\u8981\u7684\u5185\u5BB9!",whitespace:!0}]}},limitTagsLength(D){return{rules:[{max:D,message:"\u6700\u591A\u8F93\u5165".concat(D,"\u4E2A\u6807\u7B7E")}]}},required(D){return{rules:[{required:!0,message:D||"\u8BF7\u8F93\u5165\u9700\u8981\u7684\u5185\u5BB9!",whitespace:!0}]}},requiredWithValidator(D,k){return{rules:[{required:!0,message:D||"\u8BF7\u8F93\u5165\u9700\u8981\u7684\u5185\u5BB9!",whitespace:!0,validator:k}]}}},X={score:/^\+?[0-9]*$/,positiveInteger:/^[1-9]\d*$/,examScore:/^[0-9]+([.]\d{1})?$/,url:/^(https?:\/\/)([0-9a-z.]+)(:[0-9]+)?([/0-9a-z.]+)?(\?[0-9a-z&=]+)?(#[0-9-a-z]+)?/,httpsUrl:/(^https):\/\/([\w.]+\/?)\S*/,tagName:/^[\s]|[ ]$/gi},R=D=>isNaN(D)||!D||!(D>=0&&D<1e3)||!X.score.test(D),z=D=>isNaN(D)||!D||!(D>-1e3&&D<1e3),Z=D=>isNaN(D)||!D||!(D>=0&&D<1e3)||!X.examScore.test(D),Q=(D,k)=>{for(var I=0,T=0;T<D.length;T++){var c=D.charAt(T);if(c.match(/[^\x00-\xff]/ig)!=null?I+=1:I+=.5,I>k)return T}return 0},g=D=>{for(var k=0,I=0;I<D.length;I++){var T=D.charAt(I);T.match(/[^\x00-\xff]/ig)!=null?k+=1:k+=.5}return k},U=(D,k)=>{var I=D.target.value,T=D.target.dataset.originLength;if(D.target.dataset.originLength||(T=k,D.target.dataset.originLength=T),!!T){var c=g(I);c*1<k*1?D.target.setAttribute("maxLength",k*2):D.target.setAttribute("maxLength",k)}},u=(D,k)=>{var I="";return(!D||!(0,A.fy)(D))&&(I=k),I}},4412:function(Ee){Ee.exports="data:image/png;base64,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"}}]);
