(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[3048],{30311:function(ht,he,t){"use strict";var r=t(22385),F=t(31097),v=t(12924),le=t.n(v),q=t(8812),p=t(28216),e=K=>{var N=(0,p.v9)(S=>{var U=S.advancedSetting;return{themeColor:U.themeColor}}),oe=N.themeColor;return le().createElement(F.Z,{placement:"top",title:K.name},le().createElement("span",{className:"cl-table__cell-arrow",onClick:K.onClick},le().createElement("span",{style:{color:oe}},K.name),le().createElement("span",{className:"cl-table__cell-arrow-icon"},le().createElement(q.Z,null))))};he.Z=e},64630:function(ht,he,t){"use strict";var r=t(62029),F=t(62999),v=t(85733),le=t(12924),q=t.n(le),p=t(91768),e=t(10237),K=t(37055),N=t(25547),oe=v.Z.TreeNode;class S extends q().Component{constructor(c){super(c);this.getPostTree=()=>{var E=K.ZP.OrgTree.getPostTree();e.WY.get({url:E}).then(R=>{var H=(0,N.NP)(R.data.posts,{id:"value",post_name:"postName"});this.setState({treeData:H})})},this.handleChange=(E,R,H)=>{this.props.onChange(typeof E=="undefined"?"":E,R,H)},this.renderTreeNodes=E=>E.map(R=>{var H=!0;return this.props.noChildSelect&&(H=R.post_type==="post"),R.children?q().createElement(oe,{selectable:!this.props.noChildSelect,title:R.postName,key:R.id,value:R.id,isLeaf:!1,dataRef:R},this.renderTreeNodes(R.children)):q().createElement(oe,{selectable:H,title:R.postName,dataRef:R,value:R.id,key:R.id,isLeaf:!0})}),this.renderTreeSelect=()=>{var E=this.props,R=E.t,H=E.defaultValue,Pe=H===void 0?[]:H,We=E.multiple,O=We===void 0?!1:We,Le=E.width,d=Le===void 0?180:Le,C={showSearch:!1,style:{width:d},defaultValue:Pe,multiple:O,dropdownStyle:{maxHeight:300,overflow:"auto"},placeholder:R("component.choosePostTip"),allowClear:!0,disabled:this.props.disabled};return this.state.treeData.length>0?q().createElement(v.Z,(0,r.Z)({},C,{onChange:this.handleChange,className:this.props.className}),this.renderTreeNodes(this.state.treeData)):q().createElement("div",{style:{textAlign:"center"}})},this.state={treeData:[]}}componentDidMount(){this.getPostTree()}render(){return q().createElement("div",{className:"org-tree-container ".concat(this.props.className)},this.renderTreeSelect())}}S.defaultProps={disabled:!1,onChange:()=>{}},he.Z=(0,p.Z)()(S)},410:function(ht,he,t){"use strict";t.d(he,{Z:function(){return zt}});var r=t(62029),F=t(22385),v=t(31097),le=t(54029),q=t(62529),p=t(57663),e=t(71577),K=t(88986),N=t(33565),oe=t(18106),S=t(88108),U=t(12924),c=t.n(U),E=t(91768),R=t(54549),H=t(78138),Pe=t.n(H),We=t(28216),O=t(57068),Le=t(70018),d=t(20228),C=t(11382),Z=t(76586),$=t.n(Z),Q=t(6793),ue=window.Plots.Line,je=w=>{var k=w.params,I=w.height,te=w.t,Y=(0,U.useRef)(),ke=(0,U.useState)(null),ee=(0,N.Z)(ke,2),ve=ee[0],ae=ee[1],Ye=(0,U.useState)(!0),h=(0,N.Z)(Ye,2),ye=h[0],Be=h[1];(0,U.useEffect)(()=>{(0,Le.yZ)((0,K.Z)((0,K.Z)({},k),{},{page_number:1,page_size:30})).then(fe=>{if(fe.data.code&&fe.data.code==="200000"){var Re=(fe.data.data.list||[]).reverse(),Te=Re.map(Ke=>{var ne=Ke.total_score;return ne}),pe={height:220,data:Re,xField:"submit_time",yField:"score",point:{size:4,shape:"circle",color:"#516AE6"},yAxis:{tickCount:5,min:0,max:Math.max(...Te)},xAxis:{tickCount:Re.length<=7?Re.length:7,label:{formatter:Ke=>(0,Q.p6)(+Ke,new Date(+Ke).getFullYear()===new Date().getFullYear()?"MM/dd":"yyyy/MM/dd")}},tooltip:{customContent:(Ke,ne)=>{var G=ne.length>0&&"<div class=".concat($()["custom-content-container"],`>
                  <div class=`).concat($().top,`>
                    <span class=`).concat($().score,">").concat(ne[0].data.score," ").concat(te("common.examScoreUnit"),`</span>
                    `).concat(ne[0].data.score_record_type==="latest"||ne[0].data.score_record_type==="highest"?"<span class=".concat($()["custom-content-flag"],">").concat(ne[0].data.score_record_type==="latest"?te("myExamTask.newest"):te("myExamTask.highest"),"</span>"):"",`
                  </div>
                  <div class=`).concat($().bottom,">").concat((0,Q.p6)(+ne[0].data.submit_time,new Date(+ne[0].data.submit_time).getFullYear()===new Date().getFullYear()?"MM/dd hh:mm":"yyyy/MM/dd hh:mm"),`</div>
                </div>`);return G}},smooth:!0};ae(pe)}}).finally(()=>{Be(!1)})},[k,te]);var tt=()=>{var fe=Y.current.chart.filteredData,Re=fe.find(ne=>{var G=ne.score_record_type;if(G==="latest"||G==="highest")return ne});if(Re){var Te=Y.current.chart.getXY(Re),pe=Te.x,Ke=Te.y;Y.current.chart.showTooltip({x:pe,y:Ke})}};return c().createElement(C.Z,{spinning:ye},c().createElement("div",{className:$()["record-chart-container"],style:{maxHeight:"".concat(I,"px")}},ve&&!ye&&c().createElement(ue,(0,r.Z)({},ve,{height:I-32,onReady:fe=>{Y.current=fe,tt(),fe.on("mouseout",()=>{tt()})}}))))},Ce=(0,E.Z)()(je),j=t(9121),vt=t.n(j),Ie=t(99367),Nt=t(38642),Ve=t(67479),it=t(1164),Ze=t(97593),ft=t(57338),lt=t(83107),Lt=t(8965),St=t.n(Lt),pt=t(12968),_t=t(44208),Pt=t(44963),ot=t.n(Pt);function Bt(w){var k=w.t,I=w.examId,te=w.submitId,Y=w.userId,ke=(0,U.useRef)(),ee=(0,We.I0)(),ve=(0,U.useState)({status:"",examId:I,userId:Y,submitId:te}),ae=(0,N.Z)(ve,1),Ye=ae[0],h=(0,U.useState)({total_count:0,success_count:0,fail_count:0}),ye=(0,N.Z)(h,2),Be=ye[0],tt=ye[1];(0,U.useEffect)(()=>{(0,Le.wg)({examId:I,submitId:te,userId:Y}).then(G=>{var at=G.data,Qe=at.code,mt=at.data;if(Qe==="200000"){var nt=mt.fail_count,Ot=nt===void 0?0:nt,gt=mt.success_count,bt=gt===void 0?0:gt,Ct=mt.total_count,Wt=Ct===void 0?0:Ct;tt({total_count:Wt,success_count:bt,fail_count:Ot})}})},[I,te,Y]);function fe(G){var at=(0,K.Z)({},G);return(0,Le.G2)(at)}var Re=()=>c().createElement(e.Z,{type:"primary",onClick:pe},k("common.exportData")),Te=()=>{var G=w.t,at=[{key:"total",name:G("examination.faceRecognitionInExam.verifyCount"),num:Be.total_count,color:"rgb(0, 0, 0, 0.45)",backgroundColor:"#F8F9FB"},{key:"passed",name:G("examination.faceRecognitionInExam.verifySuccess"),num:Be.success_count,color:"rgb(139, 191, 100)",backgroundColor:"rgb(139, 191, 100,0.2)"},{key:"failed",name:G("examination.faceRecognitionInExam.verifyFailed"),num:Be.fail_count,color:"rgb(207, 60, 60)",backgroundColor:"rgb(207, 60, 60,0.2)"}];return at.map(Qe=>{var mt=Qe.name,nt=Qe.num,Ot=Qe.color,gt=Qe.backgroundColor,bt=Qe.key;return c().createElement("span",{className:ot()["type-item"],style:{backgroundColor:gt,color:Ot},key:bt},"".concat(mt," : ").concat(nt))})};function pe(){(0,Ze.N)({page:"exportFaceRecognitionRecord",props:{dispatch:ee,t:k},rest:{userId:Y,examId:I,submitId:te},query:"?".concat(O.stringify(Ye)),sendType:"get"})}var Ke=(0,U.useMemo)(()=>({success:{text:k("examination.faceRecognitionInExam.verifySuccess"),color:"#52C41A"},failed:{text:k("examination.faceRecognitionInExam.verifyFailed"),color:"#F5222D"}}),[k]),ne=[{title:k("examination.faceRecognitionInExam.verifyTime"),key:"check_time",render:G=>(0,Q.p6)(+G,"yyyy-MM-dd hh:mm")},{title:k("examination.faceRecognitionInExam.verifyImg"),key:"snapshot_url",render:G=>c().createElement(_t.Z,{className:ot()["snapshot-container"],width:28,height:28,src:G})},{title:k("examination.faceRecognitionInExam.verifyResult"),key:"result",render:G=>c().createElement("div",{className:ot()["status-container"]},c().createElement("span",{className:ot().status,style:{backgroundColor:Ke[G].color}}),Ke[G].text)}];return c().createElement("div",{className:ot()["face-recognition-record-container"],style:w.style},c().createElement(Ie.Z,{ref:ke,uuid:"22A4178B-6803-9BC5-DFDB-F6CD6A90C4C8",queryParams:{columns:ne,query:fe},queryParam:Ye,pagination:!0,options:!1,scroll:{x:"max-content",y:"calc(100vh - 300px)"},tableAlertRender:()=>!1,headerTitle:Te(),toolBarRender:Re}))}var Rt=(0,E.Z)()(Bt);function yt(w){var k=w.t,I=w.drawerTitle,te=w.onCloseDrawer,Y=w.examId,ke=w.submitId,ee=w.userId,ve=()=>c().createElement("div",{className:St()["footer-container"]},c().createElement(e.Z,{type:"primary",onClick:te},k("common.close")));return c().createElement(lt.Z,(0,r.Z)({title:I,placement:"right",width:716,bodyStyle:{padding:"0 24px 16px 24px"},onClose:te,footer:ve()},w),c().createElement("div",null,w.visible&&c().createElement(Rt,{examId:Y,submitId:ke,userId:ee})))}var xt=(0,E.Z)()(yt),Ut=S.Z.TabPane;function Fe(w){var k=w.t,I=w.examId,te=w.taskId,Y=w.userId,ke=w.from,ee=ke===void 0?"user":ke,ve=w.taskType,ae=ve===void 0?"all":ve,Ye=w.renderExamRecordTabBarExtraContent,h=w.examRecordTabTitle,ye=w.onCancel,Be=localStorage.getItem("themeColor")||"#465dcd",tt=(0,U.useRef)(),fe=(0,We.I0)(),Re=(0,U.useState)({task_type:ae,scene:ee,examId:I,task_id:te,userId:Y}),Te=(0,N.Z)(Re,1),pe=Te[0],Ke=(0,U.useState)("examRecord"),ne=(0,N.Z)(Ke,2),G=ne[0],at=ne[1],Qe=(0,U.useState)(0),mt=(0,N.Z)(Qe,2),nt=mt[0],Ot=mt[1],gt=(0,U.useState)({examId:I,userId:Y,submitId:"",visible:!1}),bt=(0,N.Z)(gt,2),Ct=bt[0],Wt=bt[1],Ft=(0,U.useState)(!1),Gt=(0,N.Z)(Ft,2),Xe=Gt[0],wt=Gt[1];(0,U.useEffect)(()=>{(0,Le.et)({examId:I}).then(L=>{var A=L.data,Je=A.data,De=A.code;De==="200000"&&wt(Je==="true")})},[I]);var He={pending:{text:k("myExamTask.marking"),color:"#FFB56F"},passed:{text:k("myExamTask.qualified"),color:"#52C41A"},failed:{text:k("myExamTask.unqualified"),color:"#F5222D"},full:{text:k("examination.resultStatus.full"),color:"#417DC2"}};function At(L){var A=(0,K.Z)({},L);return(0,Le.yZ)(A)}var rt=()=>c().createElement(e.Z,{type:"primary",onClick:ta},k("common.exportData"));function ta(){(0,Ze.N)({page:"exportSubmitList",props:{dispatch:fe,t:k},rest:{planId:I,userId:Y},query:"?".concat(O.stringify(pe)),sendType:"get"})}function aa(L){var A=L.exam_result,Je=L.show_record,De=L.task_id,It=L.submit_id;Je==="true"&&A!=="pending"&&it.Z.targetTo({path:Ve.W.parse({exam_id:I,user_id:ee==="manage"?Y:"",task_id:De,submit_id:It,scene:"manage"}),projectType:"student"})}var Vt={size:"small",showSizeChanger:!1,showTotal:L=>k("examination.allTotal",{total:L})},Kt=[{title:k("examing.handoverTime"),width:"240px",key:"submit_time",render:(L,A)=>c().createElement(c().Fragment,null,c().createElement("span",null,Pe()(L*1).format(k("examination.dateFormate"))),(A.score_record_type==="latest"||A.score_record_type==="highest")&&c().createElement("span",{className:vt()["latest-flag"]},A.score_record_type==="latest"?k("myExamTask.newest"):k("myExamTask.highest")))},{title:k("exam.examTime"),width:"100px",key:"answer_duration",render:L=>c().createElement("span",null,L?(0,Nt.xj)(L):"")},{title:k("examination.scoreAll"),width:"100px",key:"total_score",render:(L,A)=>c().createElement("span",null,A.total_score,"/",A.score)},{title:k("examination.scoringRate"),key:"score_rate",width:"80px",render:(L,A)=>c().createElement("span",null,A.score_rate)},{title:k("exam.examResult"),key:"exam_result",width:"100px",render:(L,A)=>{var Je=L;return A.total_score===A.score&&(Je="full"),c().createElement("div",null,c().createElement(q.Z,{color:He[Je].color,text:He[Je].text}))}}];ee==="manage"&&Kt.splice(4,0,{title:k("common.marker"),width:"100px",key:"mark_name",render:L=>{var A=L;return L==="\u7CFB\u7EDF"&&(A=k("personal.system")),c().createElement(v.Z,{title:A},c().createElement("div",{className:"cl-text-ellipsis",style:{width:100}},A||"--"))}}),Kt.push({title:k("common.operate"),width:80,fixed:"right",key:"submit_id",render:(L,A)=>{var Je=[{style:{color:A.show_record==="true"&&A.exam_result!=="pending"?Be:"#ccc",cursor:A.show_record==="true"&&A.exam_result!=="pending"?"pointer":"not-allowed"},visible:!0,label:k("examination.viewAnswerDetail"),onClick:De=>{aa(De)}},{label:k("examination.face_recognition"),style:{color:Xe?Be:"#c0c4cc",cursor:Xe?"pointer":"not-allowed"},visible:!0,onClick:(De,It)=>{var ze=De.submit_id;It||Wt(Mt=>(0,K.Z)((0,K.Z)({},Mt),{},{submitId:ze,visible:!0}))},disabled:!Xe,disabledTip:k("examination.recordCharts.notFaceRecognitionTip")}];return c().createElement("div",{className:vt()["exam-record-operate"]},Je.map(De=>{var It=De.visible,ze=De.label,Mt=De.style,Zt=De.disabledTip,Xt=De.disabled,Jt=De.onClick;if(It)return c().createElement(v.Z,{title:Xt?Zt:""},c().createElement("span",{className:"".concat(Mt.btns),style:Mt,onClick:()=>{Jt(A,Xt)}},ze))}))}});var na=()=>{Wt(L=>(0,K.Z)((0,K.Z)({},L),{},{visible:!1}))},Oe=L=>{var A=L.data.total*1;Ot(A)},Qt=(0,U.useMemo)(()=>c().createElement(Ce,{className:vt()["record-chart-container"],params:pe,height:450}),[pe]),ra=L=>{at(L)},sa=()=>{if(ee!=="manage"&&G==="examRecord")return Ye&&Ye();if(ee==="manage")return c().createElement("span",{onClick:ye,style:{cursor:"pointer"}},c().createElement(R.Z,null))};return c().createElement("div",null,c().createElement(S.Z,{onChange:ra,activeKey:G,tabBarExtraContent:sa()},c().createElement(Ut,{tab:h||k("common.examRecord"),key:"examRecord"},G==="examRecord"&&c().createElement("div",{className:vt()["exam-record-wrap"]},c().createElement(Ie.Z,{ref:tt,uuid:"0bbb3a01-9767-491d-8948-f9befe6f81ce",queryParams:{columns:Kt,query:At},queryParam:pe,pagination:Vt,options:!1,tableAlertRender:()=>!1,scroll:{x:"max-content",y:"330px"},loadComplete:Oe,toolBarRender:ee==="manage"?rt:null}))),nt>=3&&c().createElement(Ut,{tab:k("examination.recordCharts.title"),key:"recordChart"},G==="recordChart"&&Qt)),c().createElement(xt,(0,r.Z)({drawerTitle:k("exam.faceKnow")},Ct,{onCloseDrawer:na})))}var zt=(0,E.Z)()(Fe)},70018:function(ht,he,t){"use strict";t.d(he,{TM:function(){return le},Ty:function(){return q},me:function(){return p},vU:function(){return e},NZ:function(){return K},C0:function(){return N},r7:function(){return oe},lc:function(){return S},lq:function(){return U},P8:function(){return c},yZ:function(){return E},rh:function(){return R},li:function(){return H},i3:function(){return Pe},G2:function(){return We},wg:function(){return O},et:function(){return Le}});var r=t(81211),F=t(10237),v=t(5430);function le(d,C){var Z=v.OB.examing.load(d,C);return F.WY.post({url:Z})}function q(d,C){var Z=v.OB.examing.save(d);return F.WY.post({url:Z,data:C})}function p(d,C){var Z=v.OB.examing.submit(d);return F.WY.post({url:Z,data:C})}function e(d,C){var Z=v.OB.examing.saveCut(d);return F.WY.post({url:Z,data:C})}function K(d,C){var Z=d.examId,$=d.submitId,Q=d.userId,ue=v.OB.parse.list({examId:Z,submitId:$,userId:Q});return F.WY.get({url:ue,params:C})}function N(d,C){var Z=d.examId,$=d.userId,Q=v.OB.parse.info({examId:Z,userId:$},C);return F.WY.get({url:Q,params:C})}function oe(d){var C=d.key,Z=C===void 0?"":C,$=d.msg,Q=$===void 0?"":$,ue=d.data,je=ue===void 0?{}:ue;F.WY.logger({keyword:Z,moduleName:"".concat(Z,"-examing"),msg:Q,data:je})}function S(d){var C=d.examId,Z=d.page_size,$=d.page_number,Q=d.type,ue=v.OB.examData.rankingList(C);return F.WY.get({url:ue,params:{page_size:Z,page_number:$,type:Q}})}function U(d){var C=d.examId,Z=d.task_id,$=d.submit_id,Q=$===void 0?"":$,ue=v.OB.examData.examsResult(C);return F.WY.get({url:ue,params:{task_id:Z,submit_id:Q}})}function c(d){var C=v.OB.examData.certificateImage(d);return F.WY.get({url:C})}function E(d){var C=d.task_type,Z=d.task_id,$=d.page_number,Q=d.page_size,ue=d.examId,je=d.userId,Ce=d.scene,j=v.OB.examData.getRecordInfo(ue,je);return F.WY.get({url:j,params:{task_type:C,task_id:Z,page_number:$,page_size:Q,scene:Ce}})}function R(d){var C=d.status,Z=d.scene,$=d.page_number,Q=d.page_size,ue=d.examId,je=v.OB.examMarking.getMarkUser(ue);return F.WY.get({url:je,params:{status:C,scene:Z,page_number:$,page_size:Q}})}function H(d,C){var Z=v.OB.examMarking.submitMarking(d);return F.WY.post({url:Z,data:C})}function Pe(d,C,Z){var $=v.lk.getExamFromProject(d,C);return F.WY.get({url:$,params:Z})}function We(d){var C=d.examId,Z=d.submitId,$=d.userId,Q=(0,r.Z)(d,["examId","submitId","userId"]),ue=v.OB.examData.faceRecognitionRecord({examId:C,submitId:Z,userId:$});return F.WY.get({url:ue,params:Q})}function O(d){var C=d.examId,Z=d.submitId,$=d.userId,Q=v.OB.examData.faceRecognitionRecordStatistics({examId:C,submitId:Z,userId:$});return F.WY.get({url:Q})}function Le(d){var C=d.examId,Z=v.OB.examData.hasFaceSnapshot({examId:C});return F.WY.get({url:Z})}},38610:function(ht,he,t){"use strict";t.d(he,{sX:function(){return F},KN:function(){return v},vE:function(){return le},q8:function(){return q},h2:function(){return p},rb:function(){return e},o9:function(){return K},ZJ:function(){return N},ez:function(){return oe},HD:function(){return S},fr:function(){return U},$c:function(){return c},CU:function(){return E},Pw:function(){return R}});var r=t(78001),F=[{name:r.Z.t("courseManage.published"),color:"#52C41A",key:"published"},{name:r.Z.t("examination.draft"),color:"#A6A6A6",key:"draft"},{name:r.Z.t("examination.expired"),color:"#F5222D",key:"expired"},{name:r.Z.t("examination.noStart"),color:"#69A4E7",key:"noStart"}],v=[{name:r.Z.t("examination.passed"),color:"#52C41A",key:"passed"},{name:r.Z.t("examination.absence"),color:"#A6A6A6",key:"absence"},{name:r.Z.t("examination.failed"),color:"#F5222D",key:"failed"},{name:r.Z.t("examination.pending"),color:"#69A4E7",key:"pending"},{name:r.Z.t("examination.waiting"),color:"#A6A6A6",key:"waiting"},{name:r.Z.t("examination.inProgress"),color:"#69A4E7",key:"inProgress"}],le={exam:{name:r.Z.t("common.examManage"),path:"/training/examination/newPlan"},learning:{name:r.Z.t("common.studyTask"),path:"/training/learning/task/management"},employee:{name:r.Z.t("common.newEmployeeTask"),path:"/training/learning/task/employee"},learningResource:{name:r.Z.t("learning.learningProjectAddTitle"),path:"/knowledgeBase/learningResources/studyProject"},trainingProject:{name:r.Z.t("trainingProject.trainProject"),path:"/knowledgeBase/learningResources/studyProject"},project:{name:r.Z.t("trainingProject.trainProject"),path:"/knowledgeBase/learningResources/studyProject"}},q={draft:{reverse:"published",text:r.Z.t("common.releaseSuccess"),btnText:r.Z.t("examination.release"),content:r.Z.t("examination.releaseConfirm")},published:{reverse:"draft",text:r.Z.t("examination.revokeSuccess"),btnText:r.Z.t("examination.withdraw"),content:r.Z.t("examination.revokeConfirm")}},p={latest:r.Z.t("myExamTask.newest"),highest:r.Z.t("myExamTask.highest")},e={disable:r.Z.t("examination.notAllow"),unlimited:r.Z.t("examination.unlimited"),custom:r.Z.t("integralMall.selfDefined")},K={afterCommit:r.Z.t("examination.afterCommit"),afterExamPassed:r.Z.t("exam.retakeSettingTrueRow3Checkbox3"),afterExamEnd:r.Z.t("examination.examEnd"),disableViewing:r.Z.t("examination.notShow")},N={afterCommit:r.Z.t("exam.retakeSettingFalseRow1Checkbox1"),afterExamPassed:r.Z.t("exam.retakeSettingTrueRow3Checkbox3"),afterExamEnd:r.Z.t("examination.examEnd"),disableViewing:r.Z.t("examination.notShow")},oe={disableViewing:r.Z.t("examination.notShow"),justRightWrong:r.Z.t("examination.justRightWrong"),answerAnalysis:r.Z.t("exam.retakeSettingTrueRow4Checkbox1"),onlyError:r.Z.t("examination.onlyWrong")},S={fixed:r.Z.t("exam.fixed"),random:r.Z.t("exam.random")},U={manual:r.Z.t("exam.manualScoring"),system:r.Z.t("exam.systemScoring")},c={score:r.Z.t("examination.score"),subsection:r.Z.t("examination.subsection"),noCredit:r.Z.t("examination.noScore")},E={unlimited:r.Z.t("examination.unlimited"),stopWhenPassed:r.Z.t("examination.terminationAfterPassing")},R={unlimited:r.Z.t("examination.pureUnlimited"),pc:r.Z.t("examination.onlyPC"),mobile:r.Z.t("examination.onlyMobile")}},79117:function(ht,he,t){"use strict";t.r(he),t.d(he,{default:function(){return Fa}});var r=t(88986),F=t(57361),v=t(33565),le=t(9754),q=t.n(le),p=t(12924),e=t.n(p),K=t(91768),N=t(28216),oe=t(76651),S=t(35085),U=t(36017),c=t(35247),E=t(38610),R=t(48113),H=t.n(R),Pe=t(84874),We=x=>{var n=x.t,D=x.origin,W=D===void 0?"exam":D,s="",a="";return E.vE[W]&&(s=E.vE[W].name,a=E.vE[W].path),e().createElement("div",{className:H()["header-crumb"]},e().createElement(c.Z,null,e().createElement("span",{className:H()["back-router"],onClick:()=>{oe.m8.go(-1)}},e().createElement(Pe.Z,{iconClass:"icon-fanhui",size:"14px"})),s&&e().createElement(c.Z.Item,null,e().createElement("span",{className:H()["breadcrumb-item"],onClick:()=>{oe.m8.push(a)}},s)),W!=="exam"&&s&&e().createElement(c.Z.Item,null,e().createElement("span",{className:H()["breadcrumb-item"],onClick:()=>{oe.m8.go(-1)}},n("common.data"))),e().createElement(c.Z.Item,null,e().createElement("span",{className:H()["breadcrumb-item-current"]}," ",n("exam.examDetails")," "))))},O=()=>({}),Le=(0,N.$j)(O)((0,K.Z)()(We)),d=t(58866),C=t(13062),Z=t(71230),$=t(89032),Q=t(15746),ue=t(12968),je=t(44208),Ce=t(22385),j=t(31097),vt=t(58491),Ie=t(57254),Nt=t(72391),Ve=t.n(Nt),it=t(6793),Ze=t(22444),ft=t(1164),lt=t(86726),Lt=t(9925),St="yyyy-MM-dd hh:mm",pt=x=>{var n=x.modules,D=x.colSpan,W=x.source,s=W===void 0?{}:W,a=x.t,_=x.origin,M=(0,p.useState)(!1),re=(0,v.Z)(M,2),B=re[0],xe=re[1],me=(0,lt.V9)("newPaper",n),g=[{key:"baseInfo",title:"",list:[{label:a("common.creator"),visible:_==="project"||_==="learning"||_==="employee"?"hide":"show",key:"create_user_name",render:()=>{var i=s.create_user,o=s.create_user_name;return i&&o?e().createElement(Lt.Z,{userId:i,userName:o}):"--"}},{label:a("common.createTime"),visible:_==="project"||_==="learning"||_==="employee"?"hide":"show",key:"create_time",render:()=>{var i=s.create_time;return i?(0,it.p6)(Number(i),St):"--"}},{label:a("examination.paperInfoType"),key:"exam_paper_info",render:()=>{var i=s.exam_paper_info;return i&&i.type?E.HD[i.type]:"--"}},{label:a("examination.testCondition"),visible:_==="project"||_==="learning"||_==="employee"?"hide":"show",key:"status",render:()=>{var i=s.status,o=E.sX.find(u=>u.key===i);return o?e().createElement("span",{style:{color:o.color}},o.name):"--"}},{label:a("examination.referencePapers"),key:"paper_name",ellipsis:!0,render:()=>{var i=s.exam_paper_info,o=s.paper_id,u=i&&i.paper_name,y="/knowledgeBase/examResources/newPaper/preview?paperId=".concat(o);return(0,lt.H3)("preview",me)?e().createElement(ft.Z,{to:y},e().createElement(j.Z,{title:u||""},e().createElement("span",null,u||"--"," "))):e().createElement(j.Z,{title:u||""},e().createElement("span",null,u||"--"," "))}},{label:a("examination.answerLength"),key:"exam_duration",render:()=>{var i=s.exam_duration;return i?"".concat(i).concat(a("common.minutes")):"--"}},{label:a("examination.totalAndPassPoints"),key:"pass_line",render:()=>{var i=s.pass_line,o=s.exam_paper_info;return e().createElement("div",null,e().createElement("span",null,o?"".concat(o.total_score,"/").concat(o.pass_score).concat(a("common.examScoreUnit")):"--"),e().createElement("span",null,i?"(".concat(i,"%)"):"--"))},visible:s.exam_paper_info&&s.exam_paper_info.type==="random"?"hide":"show"},{label:a("examination.examDesc"),key:"description",ellipsis:!0},{label:a("examination.category"),visible:_==="project"||_==="learning"||_==="employee"?"hide":"show",key:"classify_name",ellipsis:!0},{label:a("examination.detailTag"),visible:_==="project"||_==="learning"||_==="employee"?"hide":"show",key:"task_tags",render:()=>{var i=s.task_tags,o=i===void 0?[]:i;return o.length?e().createElement("div",{className:"task-tags"},o.map((u,y)=>e().createElement(j.Z,{title:u.tag_name,key:y.toString()},e().createElement("span",{className:"task-tags-item"},u.tag_name)))):"--"}}]},{key:"examSetting",title:a("examination.examSetting"),list:[{label:a("examination.examItems"),key:"exam_count",render:()=>{var i=s.exam_count,o=s.answer_rule;return o==="custom"?e().createElement("span",null,i,a("common.times")):E.CU[o]}},{label:a("examination.examRecord"),key:"score_record_type",render:()=>{var i=s.score_record_type;return E.h2[i]||"--"}},{label:a("examination.always_extract_paper"),key:"always_extract_paper",render:()=>{var i=s.always_extract_paper;return a(i==="true"?"examination.setVolume":"examination.notSetVolume")}},{label:a("examination.cutSetting"),key:"cut_screen_rule",render:()=>{var i=s.cut_screen_rule,o=s.cut_screen_count,u=s.cut_screen_interval,y=u===void 0?0:u,T=E.rb[i]||"--";return e().createElement(e().Fragment,null,i==="custom"?e().createElement("span",null,T," ",o," ",a("common.times")):T,i!=="unlimited"&&"  ".concat(a("examination.cutOut")," ").concat(y," ").concat(a("examination.addCutCount")))}},{label:a("examination.testOrder"),key:"random_question",render:()=>{var i=s.random_question,o=s.random_options,u=i==="true",y=o==="true";return!u&&!y?"--":e().createElement("div",null,e().createElement("span",null,u?a("examination.tryOrder"):""),e().createElement("span",null,y?a("examination.answerOrder"):""))}},{label:a("examination.answerDevice"),key:"answer_device",visible:_==="exam"||_==="project"?!0:"hide",render:()=>{var i=s.answer_device,o=i||"unlimited";return E.Pw[o]||"--"}},{label:a("exam.faceKnow"),key:"face_recognition",render:()=>{var i=s.face_recognition,o=s.face_snapshot_rule,u=o||{},y=u.face_process_switch,T=u.face_process_type,X=u.face_process_value;if(i!=="true"&&(!y||y&&y!=="true"))return a("customFields.close");var se={[Ze.tT.FREQUENCY]:(0,it.ZT)(a("examination.randomDisplay"),X),[Ze.tT.INTERVAL]:(0,it.ZT)(a("examination.intervalDisplay"),X)};return e().createElement(e().Fragment,null,e().createElement("div",null," ",i==="true"&&a("examination.faceRecognitionDisplay")),e().createElement("div",null,y==="true"&&se[T]))}},{label:a("exam.knowledgePoint"),key:"show_tag",render:()=>{var i=s.show_tag;return a(i==="true"?"domainSettings.show":"domainSettings.noShow")}}]},{key:"showSetting",title:a("advancedSetting.displaySetup"),list:[{label:a("examination.answerDetail"),key:"allow_view_score",render:()=>{var i=s.result_view_rule,o=s.show_result,u=o==="true";return u?E.o9[i]:a("examination.notShow")}},{label:a("examination.viewContent"),key:"answer_parsing",render:()=>{var i=s.answer_parsing,o=s.show_result,u=s.result_view_rule,y=o==="true"&&u!=="disableViewing";return y?E.ez[i]:a("examination.notShow")}},{label:a("examination.rankingTop"),key:"",render:()=>{var i=s.ranking_list_view_rule,o=s.show_result,u=o==="true";return u?E.ZJ[i]:a("examination.notShow")}}]},{key:"rewardSetting",visible:_==="project"||_==="learning"||_==="employee"?"hide":"show",title:a("examination.rewordSetting"),list:[{label:a("examination.toCredit"),key:"toCredit",render:()=>{var i=s.reward_rule;if(!!i){var o=i.absence,u=i.passed,y=i.failed,T=i.type,X=se=>se>0?" ".concat(a("scoreRankingList.add")).concat(se).concat(a("common.examScoreUnit")," "):" ".concat(a("scoreRankingList.minus")).concat(Math.abs(se)).concat(a("common.examScoreUnit")," ");return e().createElement("div",null,e().createElement("div",null,T==="noCredit"?E.$c[T]:""),T!=="noCredit"&&e().createElement("div",null,u.checked==="true"&&e().createElement("span",null,a("examination.passed"),"-",X(u.score)),y.checked==="true"&&e().createElement("span",null,a("examination.failed"),"-",X(y.score)),o.checked==="true"&&e().createElement("span",null,a("myExamTask.absent"),"-",X(o.score))))}}},{label:a("exam.issuingCertificate"),key:"issuingCertificate",render:()=>{var i=s.exam_certificate_url;return e().createElement("div",{className:"certificate-image",style:{cursor:"pointer"}},i?e().createElement(je.Z,{width:61,height:88,src:i}):"--")}}]},{key:"markingSetting",title:a("examination.markingSetting"),list:[{label:a("examination.markingType"),key:"mark_type",render:()=>{var i=s.mark_type,o=s.anonymous_marking,u=s.mark_question_type,y=u||{},T=y.fill_blank,X=y.short_answer,se=T==="true",Ae=X==="true";return e().createElement("div",{className:"mark-type"},e().createElement("div",null,E.fr[i]),i==="manual"&&e().createElement(e().Fragment,null,e().createElement("div",null,"(",a("examination.readingTopic"),": ",se?a("component.blankSample"):""," ",Ae&&se?" | ":"",Ae?a("component.describeSample"):"",")"),e().createElement("div",null,a("exam.anonymousMarking"),": ",a(o==="true"?"customFields.open":"customFields.close"))))}},{label:a("common.marker"),key:"marker",render:()=>{var i=s.marker_list,o=i===void 0?[]:i;return o.length?o.map((u,y)=>e().createElement("span",{key:u.id},u.name," ",y===o.length-1?"":" | ")):"--"},visible:s.mark_type==="manual"?"show":"hide"}]},{key:"supervisorSetting",visible:_==="project"||_==="learning"||_==="employee"?"hide":"show",title:a("examination.supervisorSetting"),list:[{label:a("formItem.supervisor"),key:"supervisor",render:()=>{var i=s.supervisor_list,o=i===void 0?[]:i;return o.length?o.map((u,y)=>e().createElement("span",{key:u.id},u.name," ",y===o.length-1?"":" | ")):"--"}}]}],de=(0,p.useState)(g),we=(0,v.Z)(de,2),ge=we[0],f=we[1];return(0,p.useEffect)(()=>{f(g)},[s]),e().createElement("div",{className:Ve()["information-content"]},(B?ge:ge.slice(0,1)).map(i=>i.visible==="hide"?null:e().createElement("div",{key:i.key,className:Ve().card},e().createElement("div",{className:Ve()["card-title"]},i.title),e().createElement(Z.Z,{className:Ve()["card-content"]},i.key==="baseInfo"&&e().createElement("div",{className:"expand",onClick:()=>xe(!B)},B?e().createElement("span",null,a("common.collapse")," ",e().createElement(vt.Z,null)):e().createElement("span",null,a("common.expand")," ",e().createElement(Ie.Z,null))),i.list.map((o,u)=>{var y=s[o.key];return o.visible==="hide"?null:e().createElement(Q.Z,{span:D,key:u.toString(),className:Ve()["content-col"]},o.label&&e().createElement("span",{className:Ve()["item-label"]},o.label,"\uFF1A"),e().createElement(j.Z,{title:o.ellipsis?y:""},e().createElement("div",{className:"item-name item-name-".concat(o.key," ").concat(!B&&o.ellipsis?"item-ellipsis":"item-flex")},o.render?o.render():y||"--")))})))))},_t=x=>{var n=x.user;return{modules:n.modules}};pt.defaultProps={colSpan:6,data:null};var Pt=(0,N.$j)(_t)((0,K.Z)()(pt)),ot=x=>{var n=x.t,D=x.info,W=x.initData,s=x.origin;return D?e().createElement("div",{className:Ve()["information-display"]},e().createElement(d.Z,{t:n,data:D,refresh:W,origin:s}),e().createElement(Pt,{t:n,source:D,origin:s})):null},Bt=ot,Rt=t(18106),yt=t(88108),xt=t(62029),Ut=t(88983),Fe=t(47933),zt=t(59250),w=t(13013),k=t(30887),I=t(99210),te=t(34792),Y=t(48086),ke=t(71194),ee=t(57016),ve=t(57663),ae=t(71577),Ye=t(7145),h=t.n(Ye),ye=t(84391),Be=t(57119),tt=t(96486),fe=t.n(tt),Re=t(78138),Te=t.n(Re),pe=t(57068),Ke=t(9715),ne=t(86585),G=t(54531),at=x=>{var n=x.visible,D=x.handleCancel,W=x.t,s=x.examInfo,a=s===void 0?{title:"",id:"",exam_status:"",user_type:"all",user_task_type:"normal",end_time:""}:s;(0,G.TN)();var _=ne.Z.useForm(),M=(0,v.Z)(_,1),re=M[0],B=(0,p.useState)({user_type:"all",user_task_type:"normal",message_type:"normal"}),xe=(0,v.Z)(B,2),me=xe[0],g=xe[1],de=()=>{re.validateFields().then(()=>{if(me.message_type==="ding"){we(),D();return}(0,S.kh)((0,r.Z)({planId:a.id},me)).then(f=>{f.data.code==="200000"&&(Y.default.success(W("examination.urgeSuccess")),D())}).catch(f=>{console.error(f)}).finally(()=>{D()})})};(0,p.useEffect)(()=>{a&&g((0,r.Z)((0,r.Z)({},me),{},{user_type:a.user_type,user_task_type:a.user_task_type}))},[a]);var we=function(){var f=(0,F.Z)(q().mark(function i(){var o,u,y,T,X,se,Ae,Ue,b;return q().wrap(function(Se){for(;;)switch(Se.prev=Se.next){case 0:return o=a.title,u=a.id,Se.next=3,(0,S.GI)(u);case 3:y=Se.sent,T=[],y.data.code==="200000"&&(T=y.data.data.user_ding_Ids),X=sessionStorage.getItem("CL_E_APP_ID"),se=sessionStorage.getItem("CL_MINI_APP_ID"),Ae=encodeURIComponent("/pages/messageRedirect/messageRedirect?flag=examList"),Ue="dingtalk://dingtalkclient/action/open_micro_app?&appId=".concat(X,"&miniAppId=").concat(se,"&page=").concat(Ae,"&corpId=$CORPID$"),b={users:T,attachmentTitle:o,text:(0,it.ZT)(W("exam.dingTips"),o),mobileUrl:Ue},(0,G.nb)(b);case 12:case"end":return Se.stop()}},i)}));return function(){return f.apply(this,arguments)}}(),ge=f=>{g((0,r.Z)((0,r.Z)({},me),{},{message_type:f.target.value}))};return e().createElement(ee.Z,{title:W("exam.urge"),visible:n,onOk:de,onCancel:D},e().createElement(ne.Z,{form:re,layout:"horizontal",name:"examDelayForm"},e().createElement(ne.Z.Item,{name:"noticeType",label:W("examination.notifyType")},e().createElement(Fe.ZP.Group,{onChange:ge,defaultValue:me.message_type,optionType:"button",buttonStyle:"solid"},e().createElement(Fe.ZP.Button,{value:"normal",key:"normal"},W("component.ordinaryUrging")),e().createElement(j.Z,{title:W("component.dingStudentsTips"),overlayStyle:{fontSize:12}},e().createElement(Fe.ZP.Button,{value:"ding",key:"ding",disabled:!dd.version},W("component.dingStudents"))))),e().createElement(ne.Z.Item,{name:"text",label:""},e().createElement("span",null,W("exam.urgeTip")))))},Qe=(0,K.Z)()(at),mt=t(77883),nt=t(21888),Ot=t(14965),gt=t(11448),bt=t(63185),Ct=t(9676),Wt=t(43358),Ft=t(34041),Gt=t(52910),Xe=t.n(Gt),wt=Ft.Z.Option,He={END_TIME:"unified",AUTO_DELAY:"automatic"},At={TOTAL:"total",ADD:"add"},rt={BATCH:"batch",ALL:"all",SINGLE:"single"},ta=x=>{var n=x.origin,D=x.visible,W=x.handleCancel,s=W===void 0?()=>{}:W,a=x.refreshList,_=a===void 0?()=>{}:a,M=x.t,re=x.examInfo,B=re===void 0?{id:"",type:"",user_list:[],can_delay_time:!1,end_time:"",can_change_count:!1,exam_count:""}:re,xe=(0,p.useState)({user_list:B.user_list,max_begin_time:B.max_begin_time,time_type:He.END_TIME,end_time:B.end_time?Te()(+B.end_time):void 0,delay_day_count:void 0,exam_count_type:At.TOTAL,exam_count:B.exam_count||void 0}),me=(0,v.Z)(xe,2),g=me[0],de=me[1],we=(0,p.useState)(B.can_delay_time),ge=(0,v.Z)(we,2),f=ge[0],i=ge[1],o=(0,p.useState)(B.can_change_count),u=(0,v.Z)(o,2),y=u[0],T=u[1],X=(0,p.useState)(!1),se=(0,v.Z)(X,2),Ae=se[0],Ue=se[1],b=()=>{var J={planId:B.id,user_list:g.user_list,time_type:f?g.time_type:void 0,end_time:f&&g.time_type===He.END_TIME&&g.end_time?g.end_time.startOf("minute").unix()*1e3:void 0,delay_day_count:f&&g.time_type===He.AUTO_DELAY?g.delay_day_count:void 0,exam_count_type:y?g.exam_count_type:void 0,exam_count:y?g.exam_count:void 0};if(!f&&!y||f&&g.time_type===He.AUTO_DELAY&&!J.delay_day_count||f&&g.time_type===He.END_TIME&&!J.end_time||y&&!J.exam_count){Y.default.error(M("examination.improveSettingItem"));return}Ue(!0),(0,S.Xv)(J).then(_e=>{_e.data.code==="200000"&&(Ue(!1),Y.default.success(M("examination.settingSuccess")),_(),s()),Ue(!1)}).catch(_e=>{console.error(_e),Ue(!1)})},ie=J=>J&&J<Te()().subtract(1,"days").endOf("day")||B.max_begin_time&&J<Te()(+B.max_begin_time).subtract(1,"days").endOf("day"),Se=()=>e().createElement(e().Fragment,null,e().createElement(Ct.Z,{checked:f,disabled:!y,onChange:J=>{i(J.target.checked)}},M("examination.testPeriod"),":"),e().createElement(Ft.Z,{defaultValue:He.END_TIME,style:{width:120},onChange:J=>{de((0,r.Z)((0,r.Z)({},g),{},{time_type:J}))},disabled:!f},e().createElement(wt,{value:He.END_TIME},M("examination.delayEndTimeLabel")),e().createElement(wt,{value:He.AUTO_DELAY},M("examination.autoDelayLabel"))),g.time_type===He.END_TIME?e().createElement(gt.Z,{showTime:{format:"HH:mm"},format:"YYYY-MM-DD HH:mm",disabled:!f,disabledDate:ie,onChange:J=>{de((0,r.Z)((0,r.Z)({},g),{},{end_time:J}))},placeholder:B.unified_time?M("integralMall.pleaseInputDate"):M("examination.delayDatePlaceholder"),defaultValue:g.end_time}):e().createElement(e().Fragment,null,e().createElement(nt.Z,{min:1,max:999,disabled:!f,onChange:J=>{de((0,r.Z)((0,r.Z)({},g),{},{delay_day_count:J}))},placeholder:M("examination.inputPlaceholder")}),e().createElement("span",{className:Xe().unit},M("common.day")))),Me=()=>{var J={min:1,max:99,disabled:!y,placeholder:M("examination.inputPlaceholder")};return e().createElement(e().Fragment,null,e().createElement(Ct.Z,{checked:y,disabled:!f,onChange:_e=>{T(_e.target.checked)}},M("examination.examItems"),":"),e().createElement(Ft.Z,{defaultValue:At.TOTAL,style:{width:120},onChange:_e=>{de((0,r.Z)((0,r.Z)({},g),{},{exam_count_type:_e}))},disabled:!y},e().createElement(wt,{value:At.TOTAL},M("examination.addTimeLabel")),e().createElement(wt,{value:At.ADD},M("examination.totalTimeLabel"))),e().createElement(e().Fragment,null,B.exam_count?e().createElement(nt.Z,(0,xt.Z)({},J,{defaultValue:B.exam_count,onChange:_e=>{de((0,r.Z)((0,r.Z)({},g),{},{exam_count:_e}))}})):e().createElement(nt.Z,(0,xt.Z)({},J,{onChange:_e=>{de((0,r.Z)((0,r.Z)({},g),{},{exam_count:_e}))}})),e().createElement("span",{className:Xe().unit},M("common.times"))))};return e().createElement(ee.Z,{title:M("examination.examSetting"),width:628,visible:D,okButtonProps:{disabled:!f&&!y,loading:Ae},onOk:b,onCancel:s},e().createElement("div",{className:Xe()["content-container"]},n==="trainingProject"?e().createElement("div",{className:Xe().tip},M("trainingProject.allDelayTipAuto")):null,B.type===rt.ALL?e().createElement("span",{className:Xe().tip},M("examination.allDelayTip")):null,e().createElement("div",null,B.can_delay_time&&e().createElement("div",{className:Xe().row},Se()),B.can_change_count&&e().createElement("div",{className:Xe().row},Me()))))},aa=(0,K.Z)()(ta),Vt=(0,p.createContext)({}),Kt=()=>(0,p.useContext)(Vt),na=t(19130),Oe=t.n(na),Qt=t(18329),ra=t(64262),sa=t(64630),L=t(48479),A=t(99367),Je=t(410),De=t(30311),It=t(67479),ze=t(97593),Mt=t(43720),Zt=t(38642),Xt=t(5430),Jt="YYYY-MM-DD HH:mm",kt={fontSize:"12px"},Ea=x=>{var n=x.t,D=x.origin,W=Kt(),s=W.info,a=oe.m8.location.query.id,_=(0,N.I0)(),M=(0,N.v9)(l=>{var m=l.user;return{modules:m.modules,userId:m.id}}),re=M.modules,B=M.userId,xe=(0,lt.V9)("newPlan",re),me=(0,lt.H3)("exam_set",xe),g=s.create_user===B,de=g||me,we=(0,p.useState)([]),ge=(0,v.Z)(we,2),f=ge[0],i=ge[1],o=(0,p.useRef)(),u=(0,p.useRef)({taskIds:[]}),y=(0,p.useState)({visible:!1,planId:a}),T=(0,v.Z)(y,2),X=T[0],se=T[1],Ae=(0,p.useState)({answerDetailBatchPDFExport:(0,Zt.UI)("ANSWER_DETAIL_BATCH_PDF_EXPORT")}),Ue=(0,v.Z)(Ae,1),b=Ue[0],ie=s.unlimited==="true"||s.unlimited===!0,Se=s.answer_rule==="custom",Me=D==="employee"?!1:ie&&!Se||s.status!=="published",J=(0,p.useState)({department_id:"",post_id:"",keywords:"",task_type:"normal",exam_result:"all"}),_e=(0,v.Z)(J,2),V=_e[0],st=_e[1],qt=(0,p.useState)({visible:!1,examId:"",taskId:"",userId:""}),$t=(0,v.Z)(qt,2),dt=$t[0],Tt=$t[1],Dt=(0,p.useState)({user_type:V.exam_result,user_task_type:"normal",title:s.title,exam_status:s.status,end_time:s.end_time,id:a}),ia=(0,v.Z)(Dt,2),Ne=ia[0],jt=ia[1],Ka=(0,p.useState)({begin_time:s.begin_time,end_time:s.end_time,exam_status:s.status,id:a,user_list:[],visible:!1,can_delay_time:!0,can_change_count:!0}),ca=(0,v.Z)(Ka,2),Yt=ca[0],la=ca[1],$a=[{title:n("examination.testPeriod"),key:"task_begin_time",width:250,render:(l,m)=>{var z=m.task_begin_time,be=m.task_end_time;return ie||z==="0"?n("examination.timeUnlimited"):"".concat(Te()(Number(z)).format(Jt),"~").concat(Te()(Number(be)).format(Jt))}},{title:n("common.examRecord"),key:"answer_count",width:100,render:(l,m)=>l>0?e().createElement(De.Z,{onClick:()=>qa(m),name:l}):l},{title:n("exam.examScore"),key:"score",width:100},{title:n("examination.scoreRate"),key:"score_rate",width:120,render:l=>e().createElement("span",null,l||"--")},{title:n("exam.examTime"),key:"answer_duration",width:100,render:l=>e().createElement("span",null,l||"--")},{title:n("common.marker"),key:"marker",width:120,render:l=>l==="\u7CFB\u7EDF"?n("personal.system"):e().createElement("span",null,l||"--")},{title:n("exam.examResult"),key:"exam_result",width:120,render:l=>{var m=E.KN.find(z=>z.key===l)||{};return m?e().createElement("span",{className:"exam_status__".concat(l," exam_status")},m.name):"--"}},{title:n("common.operate"),key:"operate",width:D!=="project"&&D!=="learning"&&D!=="employee"?190:150,fixed:"right",visibleNum:2,buttons:[{key:"viewDetails",name:n("common.viewDetails"),render:l=>{var m=["absence","pending","waiting","inProgress"];return e().createElement("span",{className:"".concat(m.includes(l.exam_result)?"cl-disabled":"cl-pointer"," cl-table_cell-list"),style:{marginRight:"8px"},onClick:()=>{m.includes(l.exam_result)||ft.Z.targetTo({path:It.W.parse({exam_id:l.exam_id,task_id:l.task_id,submit_id:l.id,user_id:l.user_id,scene:"manage"}),projectType:"student"})}},n("common.viewDetails"))}},{key:"setting",name:n("examination.settingExam"),render:l=>de?Me?e().createElement(j.Z,{title:s.status!=="published"?n("examination.settingDisabledTip"):n("examination.dataSettingDisabledTip"),overlayStyle:kt},e().createElement("span",{className:"cl-disabled cl-table_cell-list",style:{marginRight:"8px"}},n("examination.settingExam"))):e().createElement("span",{className:"cl-pointer cl-table_cell-list",style:{marginRight:"8px"},onClick:()=>{ma(Me,{user_list:[l.user_id]},rt.SINGLE)}},n("examination.settingExam")):null},{key:"remove",name:n("common.remove"),render:l=>D!=="project"&&D!=="learning"&&D!=="employee"&&e().createElement("span",{className:"cl-pointer cl-table_cell-list",onClick:()=>{xa([l.user_id],[l.task_id],rt.SINGLE)}},n("common.remove"))}]}],ja=(0,p.useState)([{title:n("common.all"),key:"all",count:0},{title:n("exam.passed"),key:"passed",count:0},{title:n("exam.failed"),key:"failed",count:0},{title:n("exam.absent"),key:"absence",count:-1},{title:n("examination.pending"),key:"pending",count:-1}]),ua=(0,v.Z)(ja,2),Ya=ua[0],Ha=ua[1],va=l=>{st(m=>h()(m,{post_id:{$set:l}}))},pa=l=>{st(m=>h()(m,{department_id:{$set:l}}))},ya=l=>{V.keywords===l?o.current.load(V):st(m=>h()(m,{keywords:{$set:l}}))},za=l=>{st(m=>h()(m,{exam_result:{$set:l.target.value}}))};(0,p.useEffect)(()=>{va(""),pa(""),ya(""),o.current.clear()},[]),(0,p.useEffect)(()=>{la(l=>h()(l,{begin_time:{$set:s.begin_time},end_time:{$set:s.end_time},exam_status:{$set:s.status}})),jt(l=>h()(l,{title:{$set:s.title},end_time:{$set:s.end_time},exam_status:{$set:s.status}}))},[s]);var Ga=l=>(0,S.Eh)({planId:a,params:(0,r.Z)((0,r.Z)({},V),l)}),oa=()=>{(0,S.Uq)({planId:a,params:{department_id:V.department_id,post_id:V.post_id,task_type:V.task_type,keywords:V.keywords}}).then(l=>{if(l.data.code==="200000"){var m=l.data.data,z=m.all_count,be=z===void 0?0:z,Ee=m.failed_count,P=Ee===void 0?0:Ee,ce=m.passed_count,$e=ce===void 0?0:ce,Ge=m.absence_count,Et=Ge===void 0?0:Ge,qe=m.pending_count,et=qe===void 0?0:qe;Ha(ct=>h()(ct,{0:{count:{$set:be}},1:{count:{$set:$e}},2:{count:{$set:P}},3:{count:{$set:Et}},4:{count:{$set:et}}}))}})};(0,p.useEffect)(()=>{o.current.load(V)},[V]),(0,p.useEffect)(()=>{oa()},[V.task_type,V.keywords,V.department_id,V.post_id]);var ma=(l,m,z)=>{l||(0,S.TM)({planId:Yt.id,user_list:m.user_list}).then(be=>{var Ee=be.data,P=Ee.code,ce=Ee.data,$e=ce.delay_time,Ge=ce.change_count,Et=ce.end_time,qe=ce.unified_time,et=ce.unified_count,ct=ce.exam_count,ut=ce.max_begin_time;if(P==="200000"){var Ht=et===!0||et==="true",ea=qe===!0||qe==="true";la((0,r.Z)((0,r.Z)((0,r.Z)({},Yt),m),{},{type:z,visible:!0,can_delay_time:$e==="true"||$e===!0,unified_count:Ht,exam_count:Ht?+ct:void 0,unified_time:ea,end_time:ea?+Et:void 0,can_change_count:Ge==="true"||Ge===!0,max_begin_time:ut}))}})},Va=()=>{var l=[{key:"clear",label:n("component.cancelSelect"),icon:null,type:"default",style:{marginRight:"16px"},visible:!0,onClick:()=>{i([])}}];return e().createElement(e().Fragment,null,l.map(m=>{var z=m.key,be=m.visible,Ee=m.disabled,P=m.tooltip,ce=m.label,$e=m.style,Ge=m.onClick;return be?e().createElement(j.Z,{key:z,overlayStyle:P&&P.overlayStyle,title:P&&P.title},e().createElement(ae.Z,{disabled:Ee,style:$e,onClick:Ge},ce)):null}))},Qa=()=>e().createElement("div",{className:"left-row"},e().createElement(ra.Z,{parentId:"",checkable:!1,asyncLoad:!0,treeSelect:!0,className:"department-tree cl-search-normal-width",onTreeSelectChange:pa}),e().createElement(sa.Z,{className:"post-tree cl-search-normal-width",onChange:va}),e().createElement(L.Z,{placeholder:n("examination.searchByUser"),onSearch:ya})),xa=function(){var l=(0,F.Z)(q().mark(function m(z,be){var Ee,P,ce,$e,Ge,Et,qe,et=arguments;return q().wrap(function(ut){for(;;)switch(ut.prev=ut.next){case 0:return Ee=et.length>2&&et[2]!==void 0?et[2]:rt.BATCH,P=!1,ut.next=4,(0,S.ZN)({planId:a,data:{task_ids:be}});case 4:ce=ut.sent,$e=ce.data,Ge=$e.code,Et=$e.data,Ge==="200000"&&(qe=Et.has_exam_data,P=qe==="true"||qe===!0),ee.Z.confirm({title:"".concat(n("common.tip"),"\uFF01"),content:P?e().createElement("div",{className:Oe()["custom-delete-content"]},e().createElement("span",{className:Oe()["delete-confirm-tip"]},Ee===rt.SINGLE?n("examination.singlePeopleDeleteConfirm"):n("examination.batchPeopleDeleteConfirm")),e().createElement("span",{className:Oe()["delete-tip"]},n("examination.peopleDeleteTip"))):n("examination.removeUser"),okText:n("common.ok"),cancelText:n("common.cancel"),onOk:()=>{Xa(z)}});case 9:case"end":return ut.stop()}},m)}));return function(z,be){return l.apply(this,arguments)}}(),Xa=l=>{(0,S.Ll)({planId:a,data:{user_list:l,operation_type:"delete"}}).then(m=>{m.data.code==="200000"&&(Y.default.success(n("exam.removeSuccessful")),u.current.taskIds=[],i([]),oa(),o.current.load(V))}).catch(m=>{Y.default.error(m.data.message)})},Ja=l=>{l||jt(m=>h()(m,{visible:{$set:!0}}))},qa=l=>{Tt(m=>h()(m,{userId:{$set:l.user_id},examId:{$set:l.exam_id},taskId:{$set:l.task_id},visible:{$set:!0}}))},en=(l,m)=>{var z=u.current.taskIds;if(m)i(P=>h()(P,{$push:[l.user_id]})),u.current.taskIds=h()(z,{$push:[l.task_id]});else{var be=f.findIndex(P=>P===l.user_id),Ee=z.findIndex(P=>P===l.user_id);i(P=>h()(P,{$splice:[[be,1]]})),u.current.taskIds=h()(z,{$splice:[[Ee,1]]})}},tn=(l,m,z)=>{if(l)z.forEach(P=>{f.includes(P.user_id)||i(ce=>h()(ce,{$push:[P.user_id]})),u.current.taskIds.includes(P.task_id)||(u.current.taskIds=h()(u.current.taskIds,{$push:[P.task_id]}))});else{var be=z.map(P=>P.user_id),Ee=z.map(P=>P.task_id);i(P=>h()(P,{$set:fe().xor(P,be)})),u.current.taskIds=h()(u.current.taskIds,{$set:fe().xor(u.current.taskIds,Ee)})}},an=l=>{var m=l.key;switch(m){case"exportNewExamResult":{(0,ze.N)({page:"exportNewExamResult",props:{dispatch:_,t:n},rest:{planId:a},query:"?".concat(pe.stringify(V)),sendType:"get"});break}case"exportNewExamAnswerList":{(0,ze.N)({page:"exportNewExamAnswerList",props:{dispatch:_,t:n},rest:{planId:a},query:"?".concat(pe.stringify(V)),sendType:"get"});break}case"exportNewExamAnswerListPDF":{(0,ze.N)({page:"exportNewExamAnswerListPDF",props:{dispatch:_,t:n},rest:{planId:a},query:"?".concat(pe.stringify((0,r.Z)((0,r.Z)({},V),{},{title:s.title}))),sendType:"get"});break}case"exportQuestionAnswerDetails":{(0,ze.N)({page:"exportQuestionAnswerDetails",props:{dispatch:_,t:n},rest:{planId:a},query:"?".concat(pe.stringify(V)),sendType:"get"});break}case"exportNewExamAnswerList":{(0,ze.N)({page:"exportNewExamAnswerList",props:{dispatch:_,t:n},rest:{planId:a},query:"?".concat(pe.stringify(V)),sendType:"get"});break}case"exportQuestionAnswerDetails":{(0,ze.N)({page:"exportQuestionAnswerDetails",props:{dispatch:_,t:n},rest:{planId:a},query:"?".concat(pe.stringify(V)),sendType:"get"});break}default:}},nn=()=>{var l=e().createElement(I.Z,{onClick:an},e().createElement(I.Z.Item,{key:"exportNewExamResult"},n("exam.userExamResult")),b.answerDetailBatchPDFExport?e().createElement(e().Fragment,null,e().createElement(I.Z.Item,{key:"exportNewExamAnswerList"},"".concat(n("exam.userAnswerDetails")," xlsx")),e().createElement(I.Z.Item,{key:"exportNewExamAnswerListPDF"}," ","".concat(n("exam.userAnswerDetails")," pdf"))):e().createElement(I.Z.Item,{key:"exportNewExamAnswerList"},"".concat(n("exam.userAnswerDetails"))),e().createElement(I.Z.Item,{key:"exportQuestionAnswerDetails"},n("exam.questionAnswerDetails")));return e().createElement(w.Z,{overlay:l},e().createElement(ae.Z,{type:"primary",style:{margin:"0 16px"}},e().createElement(ye.Z,null)," ",n("common.exportData")))},da=l=>{var m=l.key;switch(m){case"addUser":{se(z=>(0,r.Z)((0,r.Z)({},z),{},{visible:!0}));break}case"settingExamAll":{ma(Me,{user_list:void 0},rt.ALL);break}case"settingExamBatch":{ma(Me,{user_list:f},rt.BATCH);break}case"urge":{Ja(s.status!=="published");break}}},rn=()=>{var l=[{key:"removeBatch",label:n("examination.removeBatch"),icon:null,type:"default",style:{marginRight:"16px"},disabled:f.length<=0,tooltip:{overlayStyle:kt,title:f.length<=0&&n("examination.removeBatchTip")},onClick:()=>{xa(f,u.current.taskIds,rt.BATCH)},visible:D!=="project"&&D!=="learning"&&D!=="employee"},{key:"addUser",label:n("examination.addUser"),icon:null,type:"primary",style:{marginRight:"16px"},disabled:s.status!=="published",tooltip:{overlayStyle:kt,title:s.status!=="published"&&n("examination.addUserDisabledTip")},onClick:()=>{da({key:"addUser"})},visible:(g||(0,lt.H3)("add_user",xe))&&D!=="project"&&D!=="learning"&&D!=="employee"},{key:"settingExam",label:n("examination.settingExam"),icon:null,type:"dropdown",style:{marginRight:"16px"},children:[{key:"settingExamBatch",label:n("examination.settingExamBatch"),icon:null,visible:!0,disabled:Me||f.length<=0,tooltip:{overlayStyle:kt,title:s.status!=="published"?n("examination.settingDisabledTip"):n("examination.settingExamBatchTip")}},{key:"settingExamAll",label:n("examination.settingExamAll"),icon:null,visible:!0,disabled:Me,tooltip:{overlayStyle:kt,title:Me?s.status!=="published"?n("examination.settingDisabledTip"):n("examination.dataSettingDisabledTip"):""}}],style:{marginRight:"16px"},visible:de,disabled:Me,tooltip:{overlayStyle:kt,placement:"left",title:s.status!=="published"?n("examination.settingDisabledTip"):""},onClick:da},{key:"urge",label:n("examination.urge"),icon:null,type:"primary",style:{marginRight:"16px"},visible:!0,disabled:s.status!=="published",tooltip:{overlayStyle:kt,placement:"left",title:s.status!=="published"&&n("examination.urgeDisabledTip")},onClick:()=>{da({key:"urge"})}},{type:"export",key:"export",visible:!0,renderContent:nn}].filter(m=>m.visible);return e().createElement("div",{className:Oe()["exam-filter"]},e().createElement(Fe.ZP.Group,{onChange:za,value:V.exam_result,style:{marginBottom:8}},Ya.map(m=>{var z="".concat(m.title).concat(m.count>=0?"(".concat(m.count,")"):"");return e().createElement(Fe.ZP.Button,{value:m.key,key:m.key},z)})),e().createElement("div",{className:Oe()["filter-extra"]},l.map(m=>{var z=m.key,be=m.renderContent,Ee=m.disabled,P=m.tooltip,ce=m.label,$e=m.style,Ge=m.type,Et=m.children,qe=m.visible,et=m.onClick;return be?be():Ge==="dropdown"&&qe&&!Ee?e().createElement(w.Z,{overlay:()=>e().createElement(I.Z,{onClick:et},Et.map(ct=>{var ut=ct.disabled,Ht=ct.tooltip,ea=ct.label,ga=ct.key;return e().createElement(I.Z.Item,{key:ga,disabled:ut,style:{display:"flex",alignItems:"center"}},e().createElement(j.Z,{overlayStyle:Ht.overlayStyle,title:Ht.title,placement:"left"},e().createElement("span",{style:{marginRight:"8px"}},ea),ga==="settingExamBatch"&&e().createElement(Be.Z,null)))}))},e().createElement(j.Z,{overlayStyle:P.overlayStyle,title:P.title},e().createElement(ae.Z,{style:$e,disabled:Ee},ce," ",e().createElement(Ie.Z,null)))):e().createElement(j.Z,{key:z,overlayStyle:P.overlayStyle,title:P.title},e().createElement(ae.Z,{disabled:Ee,style:$e,onClick:et},ce))})))},sn=()=>e().createElement("div",{className:Oe()["exam-table"]},e().createElement(A.Z,{withLoginPhoneNumber:!0,ref:o,uniKey:"newPlan",queryParams:{columns:$a,query:l=>Ga(l)},showUserInfo:!0,rowKey:"user_id",tableAlertRender:()=>!1,rowSelection:{selectedRowKeys:f,onSelect:en,onSelectAll:tn},footerRightRender:Va,pagination:!0,headerTitle:Qa(),uuid:"f9029e0f-2924-4298-bc61-c7d71a8f4ab4"}));return e().createElement("div",{className:Oe()["exam-data"]},rn(),sn(),e().createElement(Mt.Z,(0,xt.Z)({},X,{onOperateSuccessCallback:()=>{o.current.load(V),oa(),Y.default.success(n("setting.addSucceed"))},apiUrl:Xt.OB.examTask.singleTaskAssign({planId:X.planId}),onCancel:()=>{se(l=>(0,r.Z)((0,r.Z)({},l),{},{visible:!1}))}})),Yt.visible&&e().createElement(aa,{origin:D,visible:Yt.visible,handleCancel:()=>{la(l=>h()(l,{visible:{$set:!1}}))},examInfo:Yt,refreshList:()=>{o.current.load(V)}}),Ne.visible&&e().createElement(Qe,{visible:Ne.visible,handleCancel:()=>{jt(l=>h()(l,{visible:{$set:!1}}))},examInfo:Ne}),dt.visible&&e().createElement(Qt.ZP,{width:860,footer:null,closable:!1,visible:dt.visible,bodyStyle:{padding:"0 16px 16px 16px"},onOk:()=>{Tt(l=>h()(l,{visible:{$set:!1}}))}},e().createElement(Je.Z,{from:"manage",taskType:"normal",taskId:dt.taskId,examId:dt.examId,userId:dt.userId,onCancel:()=>{Tt(l=>h()(l,{visible:{$set:!1}}))}})))},ha=Ea,ln=t(54029),fa=t(62529),_a=t(77138),ba=t.n(_a),Ca=x=>{var n=x.visible,D=x.title,W=x.record,s=x.onClose,a=x.t,_=(0,p.useRef)(),M=(0,N.I0)(),re={okText:"",cancelText:a("common.close"),size:"large",destroyOnClose:!0,bodyStyle:{padding:"24px 32px"},maskClosable:!1,footerType:"custom",renderCustomFooter:()=>e().createElement("div",{className:"close-modal",style:{paddingRight:16,textAlign:"right"}},e().createElement(ae.Z,{type:"primary",onClick:s},a("common.close")))},B=[{title:a("common.all"),key:""},{title:a("examing.correctAnswer"),key:"true"},{title:a("examing.errorAnswer"),key:"false"}],xe=(0,p.useState)({keywords:"",result:"",planId:W.planId,id:W.id}),me=(0,v.Z)(xe,2),g=me[0],de=me[1];(0,p.useEffect)(()=>{_.current.load(g)},[g]);var we=T=>{de(X=>h()(X,{keywords:{$set:T}}))},ge=T=>{de(X=>h()(X,{result:{$set:T.target.value}}))},f=T=>(0,S.f5)({planId:T.planId,questionId:T.id,params:(0,r.Z)((0,r.Z)({},g),T)}),i=()=>e().createElement("div",{className:"left-row"},e().createElement(Fe.ZP.Group,{onChange:ge,value:g.result},B.map(T=>e().createElement(Fe.ZP.Button,{value:T.key,key:T.key},T.title)))),o=()=>{(0,ze.N)({page:"exportQuestionDetails",props:{dispatch:M,t:a},rest:{planId:g.planId,questionId:g.id},query:"?".concat(pe.stringify(g)),sendType:"get"})},u=()=>e().createElement("div",{className:"right-row"},e().createElement(L.Z,{placeholder:a("examination.searchByUser"),onSearch:we,width:"200px"}),e().createElement(ae.Z,{type:"ghost",icon:e().createElement(ye.Z,null),style:{marginLeft:"16px"},onClick:o},a("common.exportData"))),y=[{title:a("study.result"),key:"answer_result",width:150,render:T=>e().createElement(fa.Z,{color:T==="true"?"#87d068":"#f50",text:a(T==="true"?"examination.correct":"examination.error")})}];return e().createElement(Qt.ZP,(0,xt.Z)({title:D},re,{visible:n,onCancel:()=>s(),onOk:()=>s()}),e().createElement("div",{className:ba()["answer-data"]},e().createElement(A.Z,{withLoginPhoneNumber:!0,ref:_,uniKey:"plan",uuid:"4a803c7f-1f5f-4236-a588-346e75ae4905",queryParams:{columns:y,query:f},pagerConfig:{pageSize:"page_size",pageIndex:"page_number",pageSizeNum:10,pageIndexNum:1},loadingHttp:!0,showUserInfo:!0,toolBarRender:u,tableAlertRender:()=>!1,pagination:!0,headerTitle:i()})))},Ia=()=>({}),Za=(0,N.$j)(Ia)((0,K.Z)()(Ca)),ka=x=>{var n=x.t,D=(0,p.useRef)(),W=(0,N.I0)(),s=oe.m8.location.query.id,a=(0,p.useState)(!1),_=(0,v.Z)(a,2),M=_[0],re=_[1],B=(0,p.useState)({}),xe=(0,v.Z)(B,2),me=xe[0],g=xe[1],de=[{title:n("examination.allQuestions"),key:"all"},{title:n("common.single"),key:"single"},{title:n("common.multiple"),key:"multiple"},{title:n("common.tof"),key:"trueOrFalse"}],we=(0,p.useState)({keywords:"",type:"all"}),ge=(0,v.Z)(we,2),f=ge[0],i=ge[1],o=()=>e().createElement("div",{className:"left-row"},e().createElement(L.Z,{placeholder:n("examination.searchByTopic"),onSearch:u}));(0,p.useEffect)(()=>{D.current.load(f)},[f]);var u=b=>{f.keywords===b?D.current.load(f):i(ie=>h()(ie,{keywords:{$set:b}}))},y=[{title:n("common.number"),dataIndex:"index",key:"index",width:80,render:(b,ie,Se)=>e().createElement("span",null,Se+1)},{title:n("exam.paperAddthName"),dataIndex:"title",key:"title",width:150,render:(b,ie)=>e().createElement(j.Z,{title:b},e().createElement("div",{className:"cl-text-ellipsis cl-pointer",style:{width:140},onClick:()=>Ae(ie)},b||"--"))},{title:n("examination.questionBankName"),dataIndex:"question_bank_name",key:"question_bank_name",width:120,render:b=>b||"--"},{title:n("exam.paperAddthType"),dataIndex:"type_name",key:"type_name",width:120,render:b=>b||"--"},{title:n("exam.knowledgePoint"),dataIndex:"tags",key:"tags",width:150,render:b=>{var ie=b?b.join(","):"";return e().createElement(j.Z,{title:b},e().createElement("div",{className:"cl-text-ellipsis",style:{width:140}},ie||"--"))}},{title:n("learning.questionAddOptionSubName"),dataIndex:"correct_answer",key:"correct_answer",width:120,render:b=>b||"--"},{title:n("libraryPractice.accuracy"),dataIndex:"correct_rate",key:"correct_rate",width:120,render:b=>b||"--"},{title:n("common.operate"),key:"operate",width:100,fixed:"right",visibleNum:1,buttons:[{key:"data",name:n("common.data")}]}],T=b=>{i(ie=>h()(ie,{type:{$set:b.target.value}}))},X=b=>(0,S.mM)({planId:s,params:(0,r.Z)((0,r.Z)({},f),b)}),se=b=>{var ie=b.type,Se=b.disable,Me=b.record;if(!Se)switch(ie){case"data":Ae(Me);break;default:break}},Ae=b=>{re(!0),g({planId:s,id:b.id})},Ue=()=>{(0,ze.N)({page:"exportAnswerDataList",props:{dispatch:W,t:n},rest:{planId:s},query:"?".concat(pe.stringify(f)),sendType:"get"})};return e().createElement("div",{className:Oe()["exam-data"]},e().createElement("div",{className:Oe()["exam-filter"]},e().createElement(Fe.ZP.Group,{onChange:T,value:f.type,style:{marginBottom:8}},de.map(b=>e().createElement(Fe.ZP.Button,{value:b.key,key:b.key},b.title))),e().createElement("div",{className:Oe()["filter-extra"]},e().createElement(ae.Z,{type:"primary",icon:e().createElement(ye.Z,null),onClick:Ue},n("common.exportData")))),e().createElement("div",{className:Oe()["exam-table"]},e().createElement(A.Z,{ref:D,uniKey:"newPlan",rowKey:"id",queryParams:{columns:y,query:b=>X(b),operateHandles:se},loadingHttp:!0,tableAlertRender:()=>!1,pagination:!0,headerTitle:o(),uuid:"a8cadf9b-d89a-4701-b7f4-84b45974536e"})),M&&e().createElement(Za,{visible:M,title:n("examination.answerData"),t:n,record:me,onClose:()=>re(!1)}))},Ta=ka,Da=yt.Z.TabPane,Sa=x=>{var n=x.t,D=x.info,W=x.origin,s=x.guideSHow,a=x.closeGuide,_=(0,p.useState)("normal"),M=(0,v.Z)(_,2),re=M[0],B=M[1],xe=[{key:"normal",title:n("examination.studentData"),components:ha},{key:"answer",title:n("examination.answerData"),components:Ta}],me={activeKey:re,info:D};return e().createElement("div",{className:Oe()["data-summary"]},e().createElement(Vt.Provider,{value:me},e().createElement(yt.Z,{tabBarStyle:{padding:"0 32px"},onChange:g=>{B(g)}},xe.map(g=>e().createElement(Da,{tab:g.title,key:g.key},e().createElement("div",{className:Oe()["summary-content"]},re===g.key&&e().createElement(g.components,{key:re,t:n,origin:W,guideSHow:s,closeGuide:a})))))))},Pa=()=>({}),Ra=(0,N.$j)(Pa)((0,K.Z)()(Sa)),Oa=t(34942),wa=t.n(Oa),Aa=t(31916),Ma=t(4408),Na=t(10237),La=t(37055),Ba={resourceQueryTags:La.ZP.tagsInformation.resourceQueryTags},Ua=x=>{var n=x.t,D=x.userId,W=(0,p.useState)({title:"",exam_status:"",begin_time:"",end_time:"",unlimited:"",status:"published"}),s=(0,v.Z)(W,2),a=s[0],_=s[1],M=(0,p.useState)(0),re=(0,v.Z)(M,2),B=re[0],xe=re[1],me=(0,p.useState)(!1),g=(0,v.Z)(me,2),de=g[0],we=g[1],ge=oe.m8.location.query,f=ge.id,i=ge.origin;(0,p.useEffect)(()=>{o(!0)},[f]);var o=function(){var X=(0,F.Z)(q().mark(function se(Ae){var Ue,b,ie,Se,Me,J,_e,V,st,qt,$t,dt,Tt,Dt;return q().wrap(function(Ne){for(;;)switch(Ne.prev=Ne.next){case 0:return Ne.next=2,(0,Zt.Kb)((0,S.Wl)({planId:f}));case 2:return Ue=Ne.sent,b=(0,v.Z)(Ue,2),ie=b[1],Ne.next=7,(0,Zt.Kb)(y({type:"examTask",resourceId:f,isNewTag:!0}));case 7:return Se=Ne.sent,Me=(0,v.Z)(Se,2),J=Me[1],Ne.next=12,(0,Zt.Kb)((0,S.I$)({planId:f}));case 12:return _e=Ne.sent,V=(0,v.Z)(_e,2),st=V[1],Ne.next=17,(0,Zt.Kb)((0,Aa.YQ)({userId:D,type:7}));case 17:qt=Ne.sent,$t=(0,v.Z)(qt,2),dt=$t[1],dt&&we(dt),Tt={},st&&st.data.code==="200000"&&ie&&(Tt=ie.data.data),Dt={},ie&&ie.data.code==="200000"&&st&&(Dt=st.data.data),J&&J.data.data&&(Dt=(0,r.Z)((0,r.Z)({},Dt),{},{task_tags:J.data.data})),_((0,r.Z)((0,r.Z)({},Dt),Tt)),Ae||xe(jt=>jt+1);case 28:case"end":return Ne.stop()}},se)}));return function(Ae){return X.apply(this,arguments)}}(),u=()=>{we(!1)},y=X=>Na.WY.get({url:Ba.resourceQueryTags(),params:X}),T=oe.m8.location.query.title;return T||(T=a.title||n("exam.examDetails")),e().createElement("div",{className:wa()["examination-detail"]},T&&e().createElement(Ma.Z,{title:T}),e().createElement(Le,{t:n,origin:i}),e().createElement(Bt,{t:n,info:a,initData:o,origin:i}),e().createElement(Ra,{t:n,info:a,key:B,origin:i,guideSHow:de,closeGuide:u}))},Wa=x=>({userId:x.user.id||window.localStorage.getItem("uid")}),Fa=(0,N.$j)(Wa)((0,K.Z)()(Ua))},58866:function(ht,he,t){"use strict";t.d(he,{K:function(){return je}});var r=t(22385),F=t(31097),v=t(57663),le=t(71577),q=t(34792),p=t(48086),e=t(71194),K=t(57016),N=t(57361),oe=t(9754),S=t.n(oe),U=t(12924),c=t.n(U),E=t(57068),R=t(8212),H=t(76651),Pe=t(28216),We=t(91768),O=t(38610),Le=t(72391),d=t.n(Le),C=t(35085),Z=t(86726),$=t(38642),Q=Ce=>{var j=Ce.data,vt=Ce.refresh,Ie=Ce.t,Nt=Ce.modules,Ve=Ce.userId,it=Ce.origin,Ze=it===void 0?"exam":it,ft=H.m8.location.query.id,lt=j.status,Lt=j.title,St=j.period_assign,pt=O.q8[lt],_t=pt.reverse,Pt=pt.text,ot=pt.btnText,Bt=pt.content,Rt=(0,Z.V9)("newPlan",Nt),yt=j.create_user===Ve,xt=function(){var I=(0,N.Z)(S().mark(function te(){var Y,ke,ee,ve,ae;return S().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(Y=ye=>{var Be=ye.content,tt=ye.id,fe=ye.reverse,Re=ye.text;return K.Z.confirm({title:Ie("common.tip"),content:Be,okText:Ie("common.ok"),cancelText:Ie("common.cancel"),onOk:()=>{(0,C.oj)({planId:tt,data:{status:fe}}).then(Te=>{Te.data.code==="200000"&&(p.default.success(Re),vt())})}})},_t!=="draft"){h.next=11;break}if(!(St==="true"||St===!0)){h.next=11;break}return h.next=5,(0,C.ry)(j.id);case 5:if(ke=h.sent,ee=ke.data,ve=ee.code,ae=ee.data.has_end,ve!=="200000"){h.next=11;break}if(!(ae==="false"||ae===!1)){h.next=11;break}return h.abrupt("return",Y({content:c().createElement(je,{t:Ie}),id:ft,reverse:_t,text:Pt}));case 11:return h.abrupt("return",Y({content:Bt,id:ft,reverse:_t,text:Pt}));case 12:case"end":return h.stop()}},te)}));return function(){return I.apply(this,arguments)}}(),Ut=()=>{var I="/training/examination/newPlan/edit?planId=".concat(ft);H.m8.push(I)},Fe=yt||(0,Z.H3)("publish_rollback",Rt),zt=()=>{var I=j.id,te=j.title,Y=j.exam_duration,ke=H.m8.location.query.taskId,ee={project:"studyProject",learning:"studyTask",employee:"newEmployeeTask",exam:"exam"},ve=E.stringify({source:ee[Ze]||"exam",type:"exam",id:!Ze||Ze&&Ze==="exam"?I:ke,course_id:I}),ae={title:te,site1:{label:Ie("exam.examTime"),value:"".concat(Y).concat(Ie("pk.min"))},from:"exam",path:(0,$.jr)({pc_url:"/share-transit?".concat(ve),mobile_url:"/share-transit?".concat(ve),pc_type:"student",mobile_type:"h5"})};c().$share.show({detail:ae})},w=yt||(0,Z.H3)("edit",Rt),k=[{label:Ie("common.share"),key:"share",icon:null,type:"primary",style:{margin:"0 16px"},disabled:j.status==="draft",disabledTip:Ie("examination.publishOperateTip"),onClick:zt,visible:yt||(0,Z.H3)("share",Rt)},{label:Ie("common.edit"),key:"edit",icon:c().createElement(R.Z,null),type:"primary",style:{margin:"0 16px"},disabled:j.status==="published",disabledTip:Ie("examination.revertOperateTip"),onClick:Ut,visible:w&&Ze!=="project"&&Ze!=="learning"&&Ze!=="employee"},{label:ot,key:j.status,icon:null,type:"primary",style:{margin:"0 16px"},disabled:!1,onClick:xt,visible:Fe&&Ze!=="project"&&Ze!=="learning"&&Ze!=="employee"}];return c().createElement("div",{className:d()["information-title"]},c().createElement("div",{className:d().title},Lt),c().createElement("div",{className:d()["button-group"]},k.map(I=>{var te=I.key,Y=I.type,ke=I.style,ee=I.icon,ve=I.disabled,ae=I.disabledTip,Ye=ae===void 0?"":ae,h=I.label,ye=I.visible,Be=I.onClick;return ye&&c().createElement(F.Z,{key:te,placement:"top",title:ve&&Ye},c().createElement(le.Z,{type:Y,style:ke,icon:ee,disabled:ve,onClick:Be},h))})))};Q.defaultProps={data:{},refresh:()=>{}};var ue=Ce=>({modules:Ce.user.modules,userId:Ce.user.id});he.Z=(0,Pe.$j)(ue)((0,We.Z)()(Q));var je=Ce=>{var j=Ce.t;return c().createElement("div",{className:d()["confirm-content"]},c().createElement("div",{className:d()["content-top"]},c().createElement("span",{className:d()["top-tip"]},j("examination.revertModalContent"),"\uFF1F")),c().createElement("span",{className:d()["bottom-tip"]},j("examination.revertModalContentTip")))}},67479:function(ht,he,t){"use strict";t.d(he,{D:function(){return K},W:function(){return oe}});var r=t(57361),F=t(9754),v=t.n(F),le=t(57068),q=t(31916),p=t(38642),e=t(5430);function K(S){return N.apply(this,arguments)}function N(){return N=(0,r.Z)(v().mark(function S(U){var c,E,R,H,Pe;return v().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.prev=0,O.next=3,(0,q.uH)();case 3:if(c=O.sent,c!=="old"){O.next=6;break}return O.abrupt("return",!1);case 6:return O.next=8,(0,q.fP)(U);case 8:if(E=O.sent,R=E.data,H=R.code,Pe=R.data,H!=="200000"){O.next=14;break}return O.abrupt("return",Pe.exam_type==="new");case 14:O.next=20;break;case 16:return O.prev=16,O.t0=O.catch(0),console.error("\u65B0\u65E7\u8003\u8BD5\u5224\u65AD",O.t0),O.abrupt("return",!1);case 20:case"end":return O.stop()}},S,null,[[0,16]])})),N.apply(this,arguments)}var oe={examing:function(){var S=(0,r.Z)(v().mark(function c(E){var R,H,Pe;return v().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return R="",H=E.pageFrom==="ding_myExamTask"?(0,p.lz)(e.ZP.enterpriseId,"student"):"",O.next=4,K(E.exam_id);case 4:return Pe=O.sent,Pe?R="".concat(H,"/training/examination/new-exam/examing?").concat(le.stringify(E)):R="".concat(H,"/training/examination/exam/personal?").concat(le.stringify(E)),O.abrupt("return",R);case 7:case"end":return O.stop()}},c)}));function U(c){return S.apply(this,arguments)}return U}(),parse:S=>"/training/examination/new-exam/parse?".concat(le.stringify(S)),examData:S=>"/training/examination/exam-data?exam_id=".concat(S.exam_id,"&task_id=").concat(S.task_id),marking:S=>"/training/examination/new-exam/marking?".concat(le.stringify(S))}}}]);
