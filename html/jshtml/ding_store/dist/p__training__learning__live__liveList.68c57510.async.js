(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[5495],{26096:function(de,J,a){"use strict";var K=a(30887),Q=a(99210),U=a(62029),t=a(22385),M=a(31097),j=a(12924),C=a.n(j),$=a(71967),x=a.n($),W=a(1164),H=b=>b.type==="more"?b.disabled?C().createElement(Q.Z.Item,(0,U.Z)({},b,{key:b.key,disabled:!0}),b.tooltip?C().createElement(M.Z,{title:b.tooltip},C().createElement("p",{className:"cl-dropdown-menuitem"},b.title)):C().createElement("p",{className:"cl-dropdown-menuitem"},b.title)):b.link?C().createElement(Q.Z.Item,(0,U.Z)({},b,{key:b.key}),C().createElement(W.Z,{to:b.link},C().createElement("p",{className:"cl-dropdown-menuitem"},b.title))):C().createElement(Q.Z.Item,(0,U.Z)({},b,{key:b.key}),C().createElement("p",{className:"cl-dropdown-menuitem",onClick:b.click},b.title)):b.disabled?b.tooltip?C().createElement(C().Fragment,{key:b.key},C().createElement(M.Z,{title:b.tooltip},C().createElement("span",{className:"".concat(x().pointer," ").concat(x().disabled)},b.title))):C().createElement(C().Fragment,{key:b.key},C().createElement("span",{className:"".concat(x().pointer," ").concat(x().disabled)},b.title)):b.link?C().createElement(C().Fragment,{key:b.key},C().createElement(W.Z,{to:b.link},C().createElement("span",{className:"cl-pointer ".concat(x().pointer)},b.title))):C().createElement(C().Fragment,{key:b.key},C().createElement("span",{className:"cl-pointer ".concat(x().pointer),onClick:b.click},b.title));J.Z=H},30389:function(de,J,a){"use strict";a.d(J,{Z:function(){return c}});var K=a(62029),Q=a(20228),U=a(11382),t=a(12924),M=a.n(t),j=a(91768),C=a(80991),$={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},x=a(62615),W=a(52670);class H extends M().Component{render(){var m=this.props,I=m.values,T=m.mode,f=m.onlyChooseDept,h=m.reserveUser,S=m.t,_=m.orgProps,g=m.rangeAuth,E=m.projectId,L=m.onCancel,w=m.onlyCreateUser;return M().createElement(C.l0,{className:"cl-form"},M().createElement(C.gN,(0,K.Z)({component:x.ww,displayType:"Custom",showSectitle:!1,name:"employeeRange",label:S("common.visibleRange"),defaultFieldList:I.employeeRange,validate:W.FI,mode:T,rangeAuth:g,onlyChooseDept:f,onlyCreateUser:w,orgProps:_,reserveUser:h,projectId:E,onCancel:L,qwTicketShow:!0},$)))}}var b=(0,j.Z)()(H),ee=a(18329),V=a(34773);class ae extends M().Component{constructor(){super(...arguments);this.initRefFormik=m=>{this.refFormik=m},this.handleBeforeCreate=()=>{var m=this.refFormik;m.submitForm(),m.runValidations().then(I=>{if(!Object.keys(I).length){var T=m.state.values.employeeRange,f=(0,V.b)(T.rangeList),h={qyWeChatVo:T.qyWeChatVo,id:this.props.actionId,isAll:T.rangeType,groupIds:T.rangeType===2?f.groupIds.join(","):"",departmentIds:T.rangeType===2?f.deptIds.join(","):"",userIds:T.rangeType===2?f.userIds.join(","):"",postIds:T.rangeType===2?f.postIds.join(","):"",clusterIds:T.rangeType===2?f.clusterIds.join(","):"",qy_we_chat_vo:T.qyWeChatVo};this.props.onCreate(h)}})},this.handleBeforeCancel=()=>{var m=this.props.onCancel;m()}}render(){var m=this.props,I=m.visible,T=m.initialParams,f=m.isLoading,h=m.tipInfo,S=m.mode,_=m.onlyChooseDept,g=m.reserveUser,E=g===void 0?[]:g,L=m.t,w=m.title,p=m.orgProps,D=m.rangeAuth,Z=m.projectId,R=m.onCancel,F=m.onlyCreateUser,A=m.size;return f?M().createElement(U.Z,{size:"large"}):M().createElement(ee.ZP,{wrapClassName:"cl-employee-selector-modal",visible:I,title:w||L("component.changeUser"),okText:L("common.ok"),cancelText:L("common.cancel"),size:A,onCancel:this.handleBeforeCancel,onOk:this.handleBeforeCreate},f?M().createElement(U.Z,{size:"large"}):M().createElement(C.J9,{ref:this.initRefFormik,initialValues:T,render:z=>M().createElement(b,(0,K.Z)({},z,{mode:S,rangeAuth:D,orgProps:p,onlyChooseDept:_,onlyCreateUser:F,reserveUser:E,projectId:Z,onCancel:R}))}),h&&M().createElement("p",{style:{padding:"0 24px",wordBreak:"break-all",whiteSpace:"normal"}},h))}}ae.defaultProps={visible:!1,initialParams:{employeeRange:{rangeType:1,rangeList:{dept:[],post:[],group:[],user:[],cluster:[]}}},tipInfo:"",isLoading:!1,mode:["all","part"],onlyChooseDept:!1,onlyCreateUser:!1,orgProps:{},onCancel:()=>{},onCreate:()=>{},size:"middle"};var c=(0,j.Z)()(ae)},74525:function(de,J,a){"use strict";var K=a(57361),Q=a(34792),U=a(48086),t=a(9754),M=a.n(t),j=a(12924),C=a.n(j),$=a(91768),x=a(28216),W=a(92592),H=a(5430),b=a(10237),ee=a(84874),V=a(16239),ae=a(38642),c=a(28963);class N extends C().Component{constructor(I){var T;super(I);T=this,this.appId=sessionStorage.getItem("CL_E_APP_ID"),this.miniAppId=sessionStorage.getItem("CL_MINI_APP_ID"),this.initCode=()=>{var f=this.props,h=f.type,S=f.isProjectShare,_=f.isCommodityExchange,g=f.userInfo;["wx","weixin"].includes(h)?h==="weixin"&&g.appId==="9005"?this.initOtherCode():this.initWXCode():S&&h==="ding"?this.getProjectShareUrl():_&&h==="ding"?this.getCommodityExchangeUrl():h==="fullWebLink"?this.initOtherCode(this.props.option.scene):this.initOtherCode()},this.getCommodityExchangeUrl=()=>{var f=this.props,h=f.t,S=f.appType,_=f.orderId,g=this.props.option.scene,E=localStorage.getItem("uid");if(!V.Z[(0,V.c)()].showCl||S!=="e_app"){var L={deliverUserId:E,orderId:_,flag:"exchange"};W.toDataURL(JSON.stringify(L),{width:500}).then(Z=>{this.setState({img:Z})}).catch(()=>{U.default.error(h("integralMall.qrCodeFailed"))})}else{var w="/pages/messageRedirect/messageRedirect?".concat(g),p=encodeURIComponent(w),D="dingtalk://dingtalkclient/action/open_micro_app/=questionMark=/appId=".concat(this.appId,"&pVersion=1&miniAppId=").concat(this.miniAppId,"&packageType=1&page=").concat(p,"&corpId=").concat(this.props.userInfo.corpId);this.getShortLink(D).then(Z=>{W.toDataURL(Z.data.short_link,{width:500}).then(R=>{this.setState({img:R})}).catch(()=>{U.default.error(h("integralMall.qrCodeFailed"))})})}},this.getProjectShareUrl=()=>{var f=this.props.option.scene,h=encodeURIComponent("/pages/messageRedirect/messageRedirect?".concat(f)),S="dingtalk://dingtalkclient/action/open_micro_app/=questionMark=/corpId=".concat(this.props.userInfo.corpId,"&appId=").concat(this.appId,"&miniAppId=").concat(this.miniAppId,"&page=").concat(h);this.getShortLink(S).then(_=>{this.initOtherCode(_.data.short_link)})},this.getShortLink=f=>b.WY.post({url:H.ZP.Common.getQrUrl(),data:{link:f}}),this.initWXCode=(0,K.Z)(M().mark(function f(){var h,S,_,g;return M().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return h=T.props.option,S=h.scene,_=h.flag,L.next=3,b.WY.post({url:H.ZP.createWxCode(),data:{flag:_,scene:"".concat(S,"&enterpriseId=").concat(H.ZP.enterpriseId),enterprise_id:H.ZP.enterpriseId}});case 3:g=L.sent,T.setState({img:g.data.wx_code,linkUrl:"data:image/png;base64,".concat(g.data.wx_code)});case 5:case"end":return L.stop()}},f)})),this.initOtherCode=function(){var f=(0,K.Z)(M().mark(function h(S){var _,g,E,L;return M().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(_=T.props,g=_.type,E=_.fsUrl,p.t0=S,p.t0){p.next=6;break}return p.next=5,T.handleScanCode();case 5:p.t0=p.sent;case 6:L=p.t0,g==="fs"&&E&&(L=E),T.setState({linkUrl:L}),W.toDataURL(L,{width:500}).then(D=>{T.setState({img:D})}).catch(()=>{U.default.error(T.props.t("personal.failedGenerateCode"))});case 10:case"end":return p.stop()}},h)}));return function(h){return f.apply(this,arguments)}}(),this.handleScanCode=(0,K.Z)(M().mark(function f(){var h,S,_,g,E,L,w,p,D,Z,R,F,A,z,Y,se,P,ce;return M().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:if(h=T.props,S=h.type,_=h.userInfo,g=h.universalFn,E=T.state.wxH5Url,L=T.props.option,w=L.scene,p=L.pc_url,D=p===void 0?"":p,Z=L.mobile_url,R=Z===void 0?"":Z,F=L.pc_type,A=F===void 0?"":F,z=L.mobile_type,Y=z===void 0?"":z,se=encodeURIComponent("/pages/messageRedirect/messageRedirect?"),P=encodeURIComponent(w),!g){B.next=12;break}return B.next=8,T.getShortLink((0,ae.jr)({pc_url:D,mobile_url:R,pc_type:A,mobile_type:Y}));case 8:return ce=B.sent,B.abrupt("return",(0,c.fZ)(ce.data.short_link));case 12:B.t0=S,B.next=B.t0==="app"?15:B.t0==="ding"?16:B.t0==="fs"?17:B.t0==="weixin"?18:19;break;case 15:return B.abrupt("return","".concat(w,"&fromApp=true"));case 16:return B.abrupt("return","dingtalk://dingtalkclient/action/open_micro_app?corpId=".concat(_.corpId,"&appId=").concat(T.appId,"&miniAppId=").concat(T.miniAppId,"&packageType=1&pVersion=1&page=").concat(se+P));case 17:return B.abrupt("return","https://applink.feishu.cn/client/web_app/open?appId=".concat("cli_a0aa5e0fe5f8500d","&path=").concat(encodeURIComponent("/index.html"),"&").concat(w,"&appType=lark"));case 18:return B.abrupt("return","".concat(E,"/#/pages/login/login-we-com/index?appType=weCom&corp=").concat(_.corpId,"&").concat(w));case 19:return B.abrupt("return","");case 20:case"end":return B.stop()}},f)})),this.saveQrcode=()=>{var f=this.state.img,h=this.props,S=h.type,_=h.t,g=h.userInfo,E=document.createElement("a");E.download=_("setting.Qrcode")+new Date().getTime(),E.href=S==="wx"||S==="weixin"&&g.appId!=="9005"?"data:image/png;base64,".concat(f):f,document.body.appendChild(E),E.click(),document.body.removeChild(E)},this.generatePoster=f=>{var h=f.linkUrl,S=f.type,_=f.activeKey,g=f.option,E=this.props.universalFn;typeof E=="function"&&E({linkUrl:h,type:S,activeKey:_,option:g})},this.state={img:"",linkUrl:"",wxH5Url:"https://mobile.coolcollege.cn"}}componentDidMount(){this.initCode()}componentDidUpdate(I){I.option.scene!==this.props.option.scene&&this.initCode()}render(){var I=this.props,T=I.type,f=I.tip,h=I.extraTip,S=I.t,_=I.canSave,g=I.refreshQrCode,E=I.label,L=I.saveText,w=L===void 0?"":L,p=I.downloadAsBtn,D=I.userInfo,Z=I.universalFn,R=I.activeKey,F=I.option,A=this.state,z=A.img,Y=A.linkUrl,se=localStorage.getItem("themeColor")||"#465dcd";return z?C().createElement("div",{className:"qr-code-content"},E?C().createElement("div",{className:"label-text"},E,":"):null,C().createElement("div",{className:"qr-code-div ".concat(E?"left":"")},T==="wx"||T==="weixin"&&D.appId!=="9005"?C().createElement("img",{src:"data:image/png;base64,".concat(z),alt:""}):C().createElement("img",{src:z,alt:""}),f?C().createElement("div",{className:"tip-text"},f):null,h?C().createElement("div",{className:"tip-text"},h):null,_?C().createElement("div",{className:"save_qrcode ".concat(p?"save-btn":""),style:{color:se},onClick:()=>this.saveQrcode()},p?null:C().createElement(ee.Z,{iconClass:"icon-f-download",size:"14px"}),w||S("personal.saveCode")):null,Z&&!g?C().createElement("div",{className:"save_qrcode",style:{color:se},onClick:()=>this.generatePoster({linkUrl:Y,type:T,activeKey:R,option:F})},S("personal.saveCodePoster")):null,g?C().createElement("div",{className:"save_qrcode",style:{color:se},onClick:()=>g()},C().createElement(ee.Z,{iconClass:"iconf-switch",size:"14px"}),S("personal.refreshCodeTip")):null)):C().createElement("div",{className:"qr-code-placeholder"})}}J.Z=(0,x.$j)(m=>{var I=m.user;return{userInfo:I,appType:I.appType,corpId:I.corpId}})((0,$.Z)()(N))},66708:function(de,J,a){"use strict";var K=a(93485),Q=a(33565),U=a(57361),t=a(18106),M=a(88108),j=a(9754),C=a.n(j),$=a(12924),x=a.n($),W=a(91768),H=a(28216),b=a(89366),ee=a(48194),V=a(74525),ae=a(77779),c=a.n(ae),N=a(6793),m=M.Z.TabPane;class I extends x().Component{constructor(h){var S;super(h);S=this,this.initAppTypeScan=(0,U.Z)(C().mark(function g(){var E,L,w,p,D,Z,R,F,A,z,Y;return C().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,Promise.all([(0,ee.q)(),(0,ee.$)()]);case 2:E=P.sent,L=(0,Q.Z)(E,2),w=L[0],p=L[1],D=w.data.sync_organizes,Z=p.data.list,R=!1,F=(0,K.Z)(Z),P.prev=10,F.s();case 12:if((A=F.n()).done){P.next=19;break}if(z=A.value,z.type!=="wechat_applet_setting"){P.next=17;break}return R=z.switch_status==="OPEN",P.abrupt("break",19);case 17:P.next=12;break;case 19:P.next=24;break;case 21:P.prev=21,P.t0=P.catch(10),F.e(P.t0);case 24:return P.prev=24,F.f(),P.finish(24);case 27:Y=S.props.universalFn?S.filterOrganizes(D):S.filterCode(D),R&&Y.push("wx"),S.setState({scanTypes:Y});case 30:case"end":return P.stop()}},g,null,[[10,21,24,27]])})),this.filterCode=g=>{var E=[...g],L=this.props.option;return E=E.map(w=>["third_oa_app","seeyon_app"].includes(w)?"ding":w),L&&L.flag==="exam_task"?[...new Set([...E])].filter(w=>w==="fs"):[...new Set([...E,"app"])]},this.filterOrganizes=g=>{var E=[...g],L=this.props.option;E=E.map(p=>["third_oa_app","seeyon_app"].includes(p)?"ding":p);var w=new Set([...E]);return w.size===1&&w.has("app")?L&&L.flag==="exam_task"?[...w].filter(p=>p==="fs"):[...w]:(w.delete("app"),L&&L.flag==="exam_task"?[...w].filter(p=>p==="fs"):[...w])};var _=h.t;this.state={scanTypes:[],commonTitle:{ding:_("common.sanCodeCommon"),fs:_("common.sanCodeCommon"),weixin:_("common.sanCodeCommon"),app:_("common.sanCodeCommon"),wx:_("common.weChatApplets")},tabTitle:{ding:_("common.dingDingSanCode"),fs:_("common.fsScanCode"),weixin:_("common.WeComSanCode"),app:_("common.appScanCode"),wx:_("common.wxScanCode")}}}componentDidMount(){this.initAppTypeScan()}UNSAFE_componentWillReceiveProps(){this.initAppTypeScan()}render(){var h=this.state,S=h.tabTitle,_=h.commonTitle,g=h.scanTypes,E=this.props,L=E.option,w=E.tip,p=E.t,D=E.extraTip,Z=E.canSave,R=E.refreshQrCode,F=E.isCommodityExchange,A=E.type,z=E.center,Y=z===void 0?!0:z,se=E.label,P=se===void 0?"":se,ce=E.saveText,oe=E.downloadAsBtn,B=oe===void 0?!1:oe,ye=E.transfer,ne=ye===void 0?!1:ye,Ce=E.source_type,te=E.universalFn,ie=E.activeKey;return x().createElement("div",{className:"".concat(c()["scan-code-box"]," ").concat(A==="card"?c()["card-tabs"]:"")},g.length===1?x().createElement(V.Z,{universalFn:te,activeKey:ie,type:g[0],option:L,tip:(0,N.ZT)(p(w),te?_[g[0]]:S[g[0]]),extraTip:D,canSave:Z,fsUrl:L.fsUrl,refreshQrCode:R,isCommodityExchange:F,label:P,saveText:ce,downloadAsBtn:B}):x().createElement(M.Z,{defaultActiveKey:"1",centered:Y,type:A},g.map((ue,Te)=>{var Ie=Te+1;return x().createElement(m,{tab:te?_[ue]:S[ue],key:Ie},ne&&x().createElement("div",{className:c()["scan-code-transfer"]},x().createElement(b.Z,null),x().createElement("span",null,p("course.onlyScope",{source_type:p(Ce==="study_project"?"lineClass.project":"lineClass.task")}))),x().createElement(V.Z,{universalFn:te,activeKey:ie,type:ue,option:L,tip:(0,N.ZT)(p(w),te?_[ue]:S[ue]),extraTip:D,canSave:Z,fsUrl:L.fsUrl,refreshQrCode:R,isCommodityExchange:F,label:P,saveText:ce,downloadAsBtn:B}))})))}}I.defaultProps={option:{flag:"",scene:""},tip:"",extraTip:"",canSave:!0,refreshQrCode:null};var T=f=>({appType:f.user.appType});J.Z=(0,H.$j)(T)((0,W.Z)()(I))},63848:function(de,J,a){"use strict";var K=a(36877),Q=a(32969),U=a(12924),t=a.n(U),M=a(91768),j=a(56130);class C extends t().PureComponent{constructor(){super(...arguments);this.onChange=(x,W)=>{this.props.onChange(x,W)}}render(){var x=this.props,W=x.value,H=x.classify,b=x.showLabel,ee=x.className,V=x.t,ae=x.style;return t().createElement("div",{className:"classify-cascader ".concat(ee)},b?t().createElement("span",{className:"classify-cascader-label"},V("component.selectClassifyLabel")):null,t().createElement(Q.Z,{changeOnSelect:this.props.changeOnSelect,className:"classify-cascader-select ".concat(ee),options:H,onChange:this.onChange,placeholder:V("component.selectClassifyLabel"),value:W,style:ae,loadData:this.props.loadData}))}}C.defaultProps={showLabel:!0,changeOnSelect:!0,onChange:()=>{}},J.Z=(0,j.Z)((0,M.Z)()(C))},54792:function(de,J,a){"use strict";var K=a(62029),Q=a(63185),U=a(9676),t=a(47673),M=a(4107),j=a(88986),C=a(12924),$=a.n(C),x=a(91768),W=a(59239),H=a(55446),b=a.n(H),ee=a(18329),V=a(2396);class ae extends $().Component{constructor(){super(...arguments);this.state={isChecked:!1},this.handleBeforeCreate=()=>{var m=this.props,I=m.form,T=m.id,f=m.onCreate,h=this.state.isChecked;I.validateFields((S,_)=>{if(!S){var g=(0,j.Z)({},_);h||(g.value=0);var E=(0,j.Z)((0,j.Z)({},g),{},{id:T});f(E),setTimeout(()=>{I.resetFields()},100)}})},this.handleBeforeCancel=()=>{var m=this.props,I=m.form,T=m.onCancel;T(),setTimeout(()=>{I.resetFields()},100)},this.checkScore=(m,I,T)=>{var f=this.props.t,h=this.state.isChecked;if(h&&(0,V.kh)(I)){T(f("component.setScoreRuleTip"));return}T()},this.handleCheckChange=m=>{this.setState({isChecked:m.target.checked})},this.renderItem=()=>{var m=this.props,I=m.form,T=m.initialValue,f=m.labelTxt,h=this.state.isChecked,S=I.getFieldDecorator,_={labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:18}}},g=h?S("value",{initialValue:T,rules:[{validator:this.checkScore}]})($().createElement(M.Z,{maxLength:30,placeholder:""})):null,E=$().createElement($().Fragment,null,$().createElement(U.Z,{checked:h,onChange:this.handleCheckChange},f));return $().createElement(W.Z.Item,(0,K.Z)({label:E},_),g)}}componentDidUpdate(m){this.props.visible&&this.props.visible!==m.visible&&this.setState({isChecked:!!this.props.initialValue})}render(){var m=this.props,I=m.visible,T=m.title,f=m.prefixCls;return $().createElement(ee.ZP,{size:"small",visible:I,title:T,onCancel:this.handleBeforeCancel,onOk:this.handleBeforeCreate},$().createElement(W.Z,{className:"".concat(f),layout:"horizontal",colon:!1},this.renderItem(),$().createElement("div",{className:"".concat(f,"__children")},this.props.children)))}}ae.defaultProps={prefixCls:"cl-setscore",id:"",visible:!1,title:"SetScore",labelTxt:"",initialValue:"",onCancel:()=>{},onCreate:()=>{}};var c=W.Z.create({name:"ClSetupBoxInModal"})(ae);J.Z=(0,x.Z)()(c)},11449:function(de,J,a){"use strict";a.d(J,{Z:function(){return w}});var K=a(88986),Q=a(33565),U=a(12924),t=a.n(U),M=a(3115),j=a(49111),C=a(19650),$=a(62029),x=a(57663),W=a(71577),H=a(91768),b=a(28216),ee=a(37055),V=a(10237);function ae(p){var D=ee.ZP.getHelpContentByMenuKey(),Z={key:p};return V.WY.get({url:D,params:Z})}var c=a(74228),N=a.n(c),m=a(1164),I=a(76466),T=a(38642);class f extends t().Component{constructor(D){var Z;super(D);Z=this,this.getHelpContentByMenuKey=()=>{var R=this.props.defaultMenuKey;ae(R).then(F=>{var A=F.data,z=A.help_url,Y=A.video_url;this.setState({videoUrl:Y,helpUrl:z})})},this.handleOpenHelpUrl=R=>{if((0,T.ve)()){window.open(R,"_blank");return}m.Z.targetTo({path:R,isExternalLink:!0})},this.handleOpenVideo=function(R){var F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Z.props.t("helpCenter.video");Z.setState(A=>({resourcePlayInfo:(0,K.Z)((0,K.Z)({},A.resourcePlayInfo),{},{resourceInfo:{originUrl:R,source:{FD:R,OD:R},contentType:"mp4"}}),previewInfo:(0,K.Z)((0,K.Z)({},A.previewInfo),{},{title:F,visible:!0,onCancel:Z.handleCancelPreview})}))},this.handleCancelPreview=()=>{var R=this.state.previewInfo;this.setState({resourcePlayInfo:{mode:"preview",watchType:"video",resourceInfo:{}},previewInfo:(0,K.Z)((0,K.Z)({},R),{},{visible:!1})})},this.state={helpUrl:"",videoUrl:"",resourcePlayInfo:{autoPlay:!0,draggable:!0,mode:"preview",resourceInfo:{},watchType:"video"},previewInfo:{visible:!1,destroyOnClose:!0,title:D.t("helpCenter.video")||"\u89C6\u9891\u6307\u5BFC",onCancel:()=>{}}}}componentDidMount(){this.getHelpContentByMenuKey()}render(){var D=this.state,Z=D.helpUrl,R=D.resourcePlayInfo,F=D.previewInfo,A=D.videoUrl,z=this.props.t;return t().createElement("div",{className:N().helpCenter},A&&t().createElement(W.Z,{type:"link",className:N()["video-btn"],style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenVideo(A)},z("helpCenter.video")),Z&&t().createElement(W.Z,{type:"link",style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenHelpUrl(Z)},z("helpCenter.tutorial")),t().createElement(I.Z,(0,$.Z)({},R,{previewInfo:F})))}}var h=p=>({defaultMenuKey:p.currentRoute.menuKey});f.defaultProps={defaultMenuKey:""};var S=(0,b.$j)(h)((0,H.Z)()(f));function _(p){var D=p.extra,Z=localStorage.getItem("dingPersonnel"),R=sessionStorage.getItem("dingPersonnel");return t().createElement(C.Z,null,D,Z!=="dingPersonnel"&&R!=="dingPersonnel"&&(0,T.eY)("COMMONEXTRA_HELP_CENTER")&&t().createElement(S,null))}var g=_,E=a(4408);function L(p){var D=(0,U.useState)({helpCenter:(0,T.eY)("HEAD_HELP_CENTER_BUT")}),Z=(0,Q.Z)(D,1),R=Z[0],F=p.pageContainerParams,A=F===void 0?{}:F,z=p.noPadding,Y=z===void 0?!1:z,se=p.isPersonal,P=se===void 0?!1:se,ce=p.pageTitle,oe=p.className,B=oe===void 0?"":oe,ye={extra:R.helpCenter?t().createElement(g,{extra:A.extra}):A.extra},ne=(0,K.Z)((0,K.Z)({},A),ye);return t().createElement("div",{className:"page-container-content ".concat(Y?"page-container-noPadding":""," ").concat(P?"page-container-content_personal_background":""," ").concat(B)},ce&&t().createElement(E.Z,{title:ce}),P?t().createElement(M.Z,null,p.children):t().createElement(M.Z,ne,p.children))}var w=L},78140:function(de,J,a){"use strict";a.d(J,{SP:function(){return M},zv:function(){return j},mc:function(){return C},O7:function(){return $},Ib:function(){return x},ZT:function(){return W},z2:function(){return H},xu:function(){return b},$2:function(){return ee},iy:function(){return V},wL:function(){return ae}});var K=a(88986),Q=a(78138),U=a.n(Q),t=a(2019);function M(c){var N=c.classify,m=c.covers,I=c.employeeRange,T=c.title,f=c.liveType,h=c.splashImg,S=c.scene,_=c.memberCardType,g=I.rangeList,E=g.dept,L=g.group,w=g.post,p=g.user,D=(0,K.Z)((0,K.Z)({title:T,bizType:f,liveType:f,memberCardType:_,splashImg:h},m),{},{courseClassify:N,startTime:c.datePicker instanceof Object?c.datePicker.valueOf():Date.parse(c.datePicker.replace(/\-/g,"/")),remindStatus:c.remindTime.open?"true":"false",minute:c.remindTime.time,chatStatus:c.ddGroup.switchValue?"create":"not",dingGroupName:c.ddGroup.groupName,teacherId:c.teacher.id,makePublic:"".concat(c.makePublic),introduction:c.introduction,picIntroductionUrl:c.picIntroductionUrl,studyType:c.studyType,tags:"",studyTimeLimit:c.studyLimit.checked?c.studyLimit.score:0,credit:c.credit.checked?c.credit.score:0,isAll:I.rangeType,departmentIds:E.map(Z=>Z.id).join(","),postIds:w.map(Z=>Z.id).join(","),groupIds:L.map(Z=>Z.id).join(","),userIds:p.map(Z=>Z.id).join(","),syncProgress:c.syncProgress===0||c.syncProgress===!1?"false":"true",download:c.download===0||c.download===!1?"false":"true",commentSwitch:c.commentSwitch?1:0});return c.tagGroup&&Array.isArray(c.tagGroup.tagsNameList)&&(D.tags=c.tagGroup.tagsNameList.map(Z=>Z.tag_name).join(",")),f==="poly_wei"&&(D.scene=S),D}function j(c){var N={title:c.title,covers:{coverType:c.coverType,cover:c.cover,baseCover:c.baseCover},bizType:c.liveType,liveType:c.liveType,datePicker:U()(parseInt(c.startTime)).format("YYYY-MM-DD HH:mm:ss"),classify:c.courseClassify,classifyName:c.classifyName,classify_name:c.classifyName,teacher:{name:c.teacherName||"",id:c.teacherId},makePublic:c.makePublic==="true",introduction:c.introduction,picIntroductionUrl:c.picIntroductionUrl,employeeRange:{rangeType:c.isAll,rangeList:{dept:c.departmentList||[],post:c.postList||[],group:c.groupList||[],user:c.userList||[]}},remindTime:{open:c.remindStatus==="true",time:"".concat(c.minute)},ddGroup:{switchValue:c.chatStatus==="create",groupName:c.dingGroupName},splashImg:c.splashImg,credit:{checked:c.credit!==0,score:c.credit===0?1:c.credit},studyLimit:{checked:c.studyTimeLimit!==0,score:c.studyTimeLimit===0?90:c.studyTimeLimit},complete:c.credit!==0&&c.studyTimeLimit!==0,studyType:c.studyType,syncProgress:c.syncProgress==="false"?0:1,download:c.download==="false"?0:1,commentSwitch:c.commentSwitch?1:0,memberCardType:c.memberCardType};return c.liveType==="poly_wei"&&(N.scene=c.scene||V[0].value),N}function C(c){var N={endTime:Number(c.endTime),startTime:Number(c.startTime),updateTime:Number(c.updateTime)};return Object.assign(c,N)}var $=[{value:"",label:"live.allLiveChannel"},{value:"live_course",label:"live.liveCourse"},{value:"poly_wei",label:"live.polyWei"}],x=()=>[{value:"",label:"live.allLiveChannel",show:!0},{value:"live_course",label:"live.liveCourse",show:(0,t.Dp)()},{value:"poly_wei",label:"live.polyWei",show:!0}].filter(c=>c.show),W=c=>(0,t.Dp)()&&!c?[{value:"poly_wei",label:"live.polyWei"},{value:"live_course",label:"live.liveCourse"}]:c?[{value:"live_course",label:"live.liveCourse"}]:[{value:"poly_wei",label:"live.polyWei"}],H=[{key:1,title:"live.innerLive",describe:"live.innerDescribe",active:!1},{key:2,title:"live.publicLive",describe:"live.publicDescribe",active:!1},{key:3,title:"live.normalMeeting",describe:"live.normalMeetingDescribe",active:!1}],b=[{value:"all",iconColor:"",label:"live.allLiveStatus"},{value:"prepartion",iconColor:"#0040FF",label:"common.notStarted"},{value:"live",iconColor:"#01DF3A",label:"live.liveing"},{value:"meeting",iconColor:"#01DF3A",label:"live.meeting"},{value:"expired",iconColor:"#BDBDBD",label:"ddLive.expired"}],ee=[{value:"0",label:"live.remindA"},{value:"5",label:"live.remindB"},{value:"15",label:"live.remindC"},{value:"30",label:"live.remindD"},{value:"60",label:"live.remindE"},{value:"120",label:"live.remindF"},{value:"240",label:"live.remindG"}],V=[{value:"ppt",label:"course.documentAndVideo"},{value:"alone",label:"course.pureVideo"}],ae=[{value:"99",label:"live.allPublishStatus"},{value:"1",iconColor:"#0040FF",label:"courseManage.published"},{value:"0",iconColor:"#BDBDBD",label:"courseManage.unPublished"}]},55676:function(de,J,a){"use strict";a.r(J),a.d(J,{default:function(){return ft}});var K=a(18106),Q=a(88108),U=a(12924),t=a.n(U),M=a(91768),j=a(28216),C=a(76651),$=a(57068),x=a(2019),W=a(71194),H=a(57016),b=a(62029),ee=a(14781),V=a(53431),ae=a(30887),c=a(99210),N=a(59250),m=a(13013),I=a(20136),T=a(55241),f=a(57663),h=a(71577),S=a(54029),_=a(62529),g=a(88986),E=a(77576),L=a(59314),w=a(34792),p=a(48086),D=a(57361),Z=a(14965),R=a(11448),F=a(47673),A=a(4107),z=a(43358),Y=a(34041),se=a(9754),P=a.n(se),ce=a(49101),oe=a(57254),B=a(96486),ye=a(78138),ne=a.n(ye),Ce=a(57119),te=a(78140),ie=a(6793),ue=a(36202);class Te extends t().Component{constructor(u){super(u);this.deleteTip=()=>{var n=this.props,o=n.tableList,v=n.t,e=n.prefixCls,s=n.type,i="",r=0;return o.forEach(l=>{l.liveStatus==="live"&&(r+=1)}),this.getRealTableList().length<o.length?i="".concat(v("live.liveDeleteTipDetailOne")).concat(o.length).concat(v("live.liveDeleteTipDetailTwo")).concat(r).concat(v("live.liveDeleteTipDetailTheree")):i=v(s==="playback"?"live.livePlayDeleteTipInfo":"live.liveDeleteTipInfo"),t().createElement(t().Fragment,null,t().createElement("div",{className:"tipTitle"},t().createElement(Ce.Z,{className:"".concat(e,"__icon")}),t().createElement("span",{className:"".concat(e,"__tip")},v(s==="playback"?"live.deletePlaybackMakeSure":"live.deleteMakeSure"))),t().createElement("div",{className:"".concat(e,"__content")},i))},this.getRealTableList=()=>{var n=this.props.tableList;return n.filter(o=>o.liveStatus!=="live")},this.getTableColumn=()=>{var n=this.props,o=n.t,v=n.appType,e=[{title:o("live.liveCourseName"),dataIndex:"title",className:"study_project_width",fixed:v==="wx_app"?!1:"left",width:120},{title:o("live.liveStatus"),dataIndex:"liveStatus",width:80,render:(s,i)=>{var r=i.courseBizType=="9"&&s==="live"?"meeting":s,l=te.xu.find(d=>d.value===r);return l&&l.hasOwnProperty("iconColor")&&l.hasOwnProperty("label")?t().createElement("div",null,t().createElement("span",{className:"icon",style:{borderColor:l.iconColor}}),t().createElement("span",null,o(l.label))):""}},{title:o("live.liveTime"),dataIndex:"startTime",render:s=>(0,ie.p6)(Number(s)),width:150},{title:o("component.lecturer"),dataIndex:"teacherName",width:80,render:s=>s||"--"}];return e},this.getPlaybackTableColumn=()=>{var n=this.props,o=n.t,v=n.appType,e=[{title:o("live.liveCourseName"),dataIndex:"title",className:"study_project_width",fixed:v==="wx_app"?!1:"left",width:120},{title:o("live.publishStatus"),dataIndex:"courseStatus",width:80,render:s=>{var i=te.wL.find(r=>r.value===s);return t().createElement("div",null,t().createElement("span",{className:"icon",style:{borderColor:i?i.iconColor:""}}),t().createElement("span",null,i?o(i.label):""))}},{title:o("live.liveTime"),dataIndex:"startTime",render:s=>(0,ie.p6)(Number(s)),width:150},{title:o("component.lecturer"),dataIndex:"teacherName",width:80,render:s=>s||"--"},{title:o("course.viewers"),dataIndex:"uv",width:80},{title:o("ddLive.watchTimes"),dataIndex:"pv",width:80}];return e},this.state={}}render(){var u=this.props,n=u.prefixCls,o=u.type;return t().createElement(t().Fragment,null,this.deleteTip(),t().createElement(ue.f,{className:"".concat(n,"__table"),scroll:{x:"max-content",y:"100%"},columns:o==="playback"?this.getPlaybackTableColumn():this.getTableColumn(),dataSource:this.getRealTableList(),pagination:!1,options:!1,tableUUID:"bfe03735-1f30-4866-8bf6-5e10c20bd431"}),t().createElement("div",{className:"".concat(n,"__total")},t().createElement("span",null,this.props.t("live.deleteTotal"),":"),t().createElement("span",null,this.getRealTableList().length)))}}Te.defaultProps={prefixCls:"delete-live-room"};var Ie=(0,j.$j)()((0,M.Z)()(Te)),Et=a(57338),Me=a(83107),Tt=a(9715),Ze=a(86585),It=a(88983),he=a(47933),Ye=a(89726),fe=a.n(Ye),xe=a(66708),be=a(74525),pe=a(38642),Pe=Q.Z.TabPane;class Ge extends t().Component{constructor(u){super(u);this.onCancel=()=>{this.setState({qrCodeOption:{scene:""}}),this.props.onClose()},this.onChangeTabs=n=>{this.setState({activeTab:n})},this.onCopy=n=>{var o=document.createElement("input");o.value=n,document.body.appendChild(o),o.select(),document.execCommand("Copy"),o.style.display="none",p.default.success(this.props.t("live.copySuccess"))},this.getPlayData=n=>{if(n.liveType==="live_course")this.setState({qrCodeOption:{flag:"",scene:n.jumpUrl},shareLink:n.jumpUrl});else if(n.liveType==="poly_wei"){var o=localStorage.getItem("enterpriseId");this.setState({qrCodeOption:{flag:"live_poly_wei",scene:"flag=live_poly_wei&msgType=student&courseId=".concat(n.courseId)},shareLink:"".concat((0,pe.UE)(),"#/live-view-link?courseId=").concat(n.courseId,"&password=").concat(n.password,"&enterpriseId=").concat(o,"&withoutToken=true")})}},this.getPlaybackData=n=>{n.liveType==="live_course"?this.setState({qrCodeOption:{flag:"",scene:n.jumpUrl}}):n.liveType==="poly_wei"&&this.setState({qrCodeOption:{flag:"course_study",scene:"flag=course_study&courseId=".concat(n.courseId)}})},this.state={activeTab:"internal",qrCodeOption:{flag:"",scene:""},shareLink:""}}componentDidUpdate(){var u=this.props,n=u.visible,o=u.record,v=u.shareType;n&&!this.state.qrCodeOption.scene&&(this.setState({activeTab:"internal"}),v==="playAbout"&&this.getPlayData(o),v==="playback"&&this.getPlaybackData(o))}render(){var u=this.props,n=u.t,o=u.visible,v=u.record,e=u.shareType,s=this.state,i=s.activeTab,r=s.qrCodeOption,l=s.shareLink;return t().createElement(t().Fragment,null,t().createElement(Me.Z,{className:fe().shareDrawer,title:n("common.share"),placement:"right",onClose:this.onCancel,visible:o,width:560,bodyStyle:{paddingTop:0},destroyOnClose:!0},o&&r.scene&&t().createElement(t().Fragment,null,e==="playAbout"&&t().createElement(Q.Z,{activeKey:i,onChange:this.onChangeTabs},t().createElement(Pe,{tab:n("live.shareInternal"),key:"internal"},t().createElement("div",{className:fe().shareTip},t().createElement(Ce.Z,{style:{marginRight:"10px"}}),n("live.internalTip")),r.flag==="live_poly_wei"?t().createElement(xe.Z,{type:"card",option:r,saveText:n("shareInfo.downloadCode"),downloadAsBtn:!0}):t().createElement(t().Fragment,null,t().createElement("div",{className:fe().dingTitle},t().createElement(he.ZP.Group,{value:"1",style:{marginBottom:16},buttonStyle:"solid",size:"large"},t().createElement(he.ZP.Button,{value:"1"},n("common.dingDingSanCode")))),t().createElement(be.Z,{type:"fullWebLink",option:r,saveText:n("shareInfo.downloadCode"),downloadAsBtn:!0}))),v.makePublic==="true"&&t().createElement(Pe,{tab:n("live.shareExternal"),key:"external"},t().createElement("div",{className:fe().shareTip},t().createElement(Ce.Z,{style:{marginRight:"10px"}}),n("live.externalTip")),r.scene&&(v.liveType==="live_course"?t().createElement(be.Z,{type:"fullWebLink",option:{scene:l},fsUrl:l,saveText:n("shareInfo.downloadCode"),downloadAsBtn:!0}):t().createElement(be.Z,{type:"fullWebLink",option:{flag:"live_poly_wei",scene:l},saveText:n("shareInfo.downloadCode"),downloadAsBtn:!0})),t().createElement(Ze.Z,{labelCol:{span:3},wrapperCol:{span:21},style:{marginTop:"20px"}},t().createElement(Ze.Z.Item,{name:"jumpUrl",label:n("live.liveAddress")},t().createElement(A.Z,{style:{width:"100%"},addonAfter:t().createElement("a",{className:"copy-form",onClick:()=>this.onCopy(l)},n("registerLogin.copyLink")),placeholder:l,readOnly:!0}))))),e==="playback"&&t().createElement(Q.Z,{activeKey:i,onChange:this.onChangeTabs},t().createElement(Pe,{tab:n("tutorial.student"),key:"internal"},t().createElement("div",{className:fe().shareTip},t().createElement(Ce.Z,{style:{marginRight:"10px"}}),n("live.internalTip")),r.flag==="course_study"?t().createElement(xe.Z,{type:"card",option:r,saveText:n("shareInfo.downloadCode"),downloadAsBtn:!0}):t().createElement(t().Fragment,null,t().createElement("div",{className:fe().dingTitle},t().createElement(he.ZP.Group,{value:"1",style:{marginBottom:16},buttonStyle:"solid",size:"large"},t().createElement(he.ZP.Button,{value:"1"},n("common.dingDingSanCode")))),t().createElement(be.Z,{type:"fullWebLink",option:r,saveText:n("shareInfo.downloadCode"),downloadAsBtn:!0})))))))}}var we=(0,M.Z)()(Ge),Qe=a(33565),Xe=a(68099),Ee=a.n(Xe),Re=G=>{var u=G.t,n=G.visible,o=G.record,v=G.onClose,e=(0,U.useState)(""),s=(0,Qe.Z)(e,2),i=s[0],r=s[1];(0,U.useEffect)(()=>{r(o.url)},[o.url]);var l=()=>{var d=document.createElement("input");d.setAttribute("value",i),document.body.appendChild(d),d.select(),document.execCommand("Copy"),p.default.success(u("exam.copySucceed")),document.body.removeChild(d)};return t().createElement(t().Fragment,null,t().createElement(Me.Z,{className:Ee()["streaming-address"],title:u("course.streamingAddress"),placement:"right",onClose:v,visible:n,width:560,bodyStyle:{paddingTop:0},destroyOnClose:!0},n&&t().createElement(t().Fragment,null,t().createElement("div",{className:Ee()["title-con"]},t().createElement("span",{className:Ee().title},u("course.streamingAddress"),"\uFF1A"),t().createElement("p",{className:Ee().info},i)),t().createElement("div",{className:Ee()["action-btn"]},t().createElement(h.Z,{type:"primary",onClick:l},u("registerLogin.copyLink"))))))};Re.defaultProps={visible:!1,record:{},onClose:()=>{}};var Je=(0,M.Z)()(Re),q=a(60333),k=a(86726),qe=a(98078),le=a(26096);class et extends t().PureComponent{constructor(u){super(u);this.moreOperate=(n,o)=>{var v=this.props,e=v.record,s=v.t,i=n.map(r=>{switch(r.type){case"start_live":return t().createElement(le.Z,{type:o,key:"start_live",click:this.props.startLive,title:s("live.startLive")});case"start_meeting":return t().createElement(le.Z,{type:o,key:"start_meeting",click:this.props.startMeeting,title:s("live.startMeeting")});case"set_visible":return t().createElement(le.Z,{type:o,key:"set_visible",click:this.props.clickVisibleRange,title:s("common.visibleRange")});case"copy_start_live_link":return t().createElement(le.Z,{type:o,key:"copy_start_live_link",click:this.props.copyLink,title:s("live.copyLink")});case"edit_live":return t().createElement(le.Z,{type:o,key:"edit_live",click:this.props.editDdLive,title:s("common.edit")});case"delete_live":return t().createElement(le.Z,{type:o,key:"delete_live",disabled:e.liveStatus==="live",click:this.props.liveDelete,title:s("common.delete")});case"share_live":return t().createElement(le.Z,{type:o,key:"share_live",click:this.props.shareLive,title:s("common.share")});case"streaming_address":return t().createElement(le.Z,{type:o,key:"streaming_address",click:this.props.streamingAddress,title:s("course.streamingAddress")});default:return null}});return o==="more"?t().createElement(c.Z,null,i):i},this.state={actions:u.actions}}render(){var u=this.state.actions,n=this.props.record,o=[{type:"start_live",visible:(0,k.H3)("start_live",u)&&n.liveStatus==="prepartion"&&n.courseBizType=="8"},{type:"start_meeting",visible:(0,k.H3)("start_live",u)&&n.liveStatus==="prepartion"&&n.courseBizType=="9"},{type:"share_live",visible:(0,k.H3)("share_live",u)&&n.liveStatus!=="expired"&&n.courseBizType=="8"},{type:"streaming_address",visible:(0,qe.WC)()&&n.liveType==="poly_wei"&&n.scene==="alone"&&n.liveStatus!=="expired"&&n.courseBizType=="8"},{type:"copy_start_live_link",visible:(0,k.H3)("copy_start_live_link",u)&&n.liveStatus!=="expired"&&n.liveType==="poly_wei"&&n.courseBizType=="8"},{type:"set_visible",visible:(0,k.H3)("set_visible",u)&&n.liveStatus!=="expired"},{type:"edit_live",visible:(0,k.H3)("edit_live",u)&&n.liveStatus!=="expired"},{type:"delete_live",visible:(0,k.H3)("delete_live",u)}],v=o.filter(e=>e.visible);return t().createElement("div",{className:"cl-table__cell-action"},this.moreOperate(v.slice(0,1)),v.length>1&&t().createElement(t().Fragment,null,t().createElement("span",{className:"cl-pointer-divide"}),t().createElement(m.Z,{overlay:this.moreOperate(v.slice(1),"more")},t().createElement("span",{className:"cl-pointer"},this.props.t("common.more")," ",t().createElement(oe.Z,null)))))}}var tt=(0,M.Z)()(et),ke=a(37055),Se=a(5430),Ae=a(60667),De=a(64462),Ue=a(63848),Ne=a(30389),Be=a(58546),at=a(84874),ve=Y.Z.Option,st=A.Z.Search,lt=R.Z.RangePicker;class Ke extends t().Component{constructor(u){var n;super(u);n=this,this.onSearch=e=>{this.setState({current:1,keyword:e},()=>{this.getTableList()})},this.onShareLive=e=>{this.handleSingleLive(e);var s=this.props,i=s.t,r=s.userInfo,l=e.liveType==="poly_wei"?"live_poly_wei":"dingTalk",d={title:e.title,site1:{label:i("ddLive.liveTime"),value:ne()(parseInt(e.startTime)).format("YYYY-MM-DD HH:mm")},lecture:{name:e.anchorName,avatar:e.avatar,id:e.anchorId,source_type:e.sourceType},from:"live_course",path:(()=>{if(l=="live_poly_wei")return(0,pe.jr)({pc_url:"/live-view-link?withoutToken=false&enterpriseId=".concat(Se.ZP.enterpriseId,"&courseId=").concat(e.courseId,"&password=").concat(e.password),pc_type:"student",mobile_url:"/pages/messageRedirect/messageRedirect?corpId=".concat(r.corpId,"&appId=").concat(sessionStorage.getItem("CL_E_APP_ID"),"&miniAppId=").concat(sessionStorage.getItem("CL_MINI_APP_ID"),"&packageType=1&pVersion=1&flag=").concat(l,"&msgType=student&courseId=").concat(e.courseId),mobile_type:"cross"});var X="courseId=".concat(encodeURIComponent(e.courseId));return(0,pe.jr)({pc_url:"/live-view-ding-link?courseId=".concat(e.courseId),mobile_url:"/business-transit?params=".concat(encodeURIComponent(X),"&businessType=dingLive"),pc_type:"student",mobile_type:"h5"})})()},y={};l=="live_poly_wei"?y={path:"",external_link:"".concat((0,pe.UE)(),"#/live-view-link?withoutToken=true&enterpriseId=").concat(Se.ZP.enterpriseId,"&courseId=").concat(e.courseId,"&password=").concat(e.password),template:[1,2,3,4],tip:""}:y={path:"",external_link:"".concat((0,pe.UE)("student"),"#/live-view-ding-linkout?courseId=").concat(e.courseId,"&enterpriseId=").concat(Se.ZP.enterpriseId),template:[1,2,3,4],tip:""};var O=e.makePublic==="true"?["insider",{value:"visitor",label:i("course.externalSharing")}]:["insider"];t().$share.show({detail:d,tabs:O,visitor:y})},this.onCloseShare=()=>{this.setState({shareVisible:!1})},this.onStreamingAddress=e=>{this.handleSingleLive(e),this.setState({pushFlowVisible:!0})},this.onCloseStreamingAddress=()=>{this.setState({pushFlowVisible:!1})},this.onSelectChange=(e,s)=>{var i=[];s.forEach(r=>{i.push(r.courseId)}),this.setState({selectedCourseIds:i,selectedRowKeys:e,selectedList:s})},this.getTableList=(0,D.Z)(P().mark(function e(){var s,i,r,l,d,y,O,X,re,ge,Le,me;return P().wrap(function(Oe){for(;;)switch(Oe.prev=Oe.next){case 0:s=n.state,i=s.classify,r=s.pageSize,l=s.current,d=s.keyword,y=s.liveStatus,O=s.liveType,X=s.timeType,re=s.startTime,ge=s.endTime,Le=s.type,me={pageSize:r,pageNum:l,liveClassify:"live",listType:Le.value,timeType:X.value,startTime:re?(0,ie.jZ)(re):null,endTime:ge?(0,ie.jZ)(ge):null},d&&(me.keyword=d),(0,B.isEmpty)(i)||(me.classifyId=i[i.length-1]),y.value!=="all"&&(me.liveStatus=y.value),O.value!=="all"&&(me.liveType=O.value),n.setState({isLoading:!0}),(0,q.k3)(me).then(Ve=>{var He=Ve.data.data;n.onSelectChange([],[]),Ve.status===200&&(n.setState({pageTotal:He.total,tableList:He.list,isLoading:!1}),n.isMultiple&&n.setState({selectedRowKeys:[]}))});case 8:case"end":return Oe.stop()}},e)})),this.turnPlayLive=e=>{(0,q.IR)({courseId:e.courseId}).then(s=>{(0,B.get)(s,"data.data.isCourseAnchor")?(0,De.Vo)(e.courseId):p.default.info(this.props.t("ddLive.anchorInfo"))})},this.copyLink=e=>{var s=this.props.t,i=this.getTurnLink(e,"external"),r=document.createElement("input");r.setAttribute("value",i),document.body.appendChild(r),r.select(),document.execCommand("Copy"),p.default.success(s("live.copySucceed")),document.body.removeChild(r)},this.turnPlayLiveDD=function(){var e=(0,D.Z)(P().mark(function s(i){var r,l;return P().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:r=n.props.t,l=navigator.userAgent,l.includes("DingTalk")?(0,q.IR)({courseId:i.courseId}).then(O=>{(0,B.get)(O,"data.data.isCourseAnchor")?dd.biz.util.openLink({url:i.liveUrl}):p.default.info(r("ddLive.anchorInfo"))}):p.default.info(r("ddLive.ddInfo"));case 3:case"end":return y.stop()}},s)}));return function(s){return e.apply(this,arguments)}}(),this.turnPlayMeeting=function(){var e=(0,D.Z)(P().mark(function s(i){var r,l;return P().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:r=n.props.t,l=navigator.userAgent,l.includes("DingTalk")?(0,q.kG)({courseId:i.courseId}).then(O=>{O.code=="200000"&&O.data=="true"?(0,q.K6)(i.courseId).then(()=>{}):p.default.info(r("ddLive.anchorInfoMeeting"))}):p.default.info(r("ddLive.ddmeetingInfo"));case 3:case"end":return y.stop()}},s)}));return function(s){return e.apply(this,arguments)}}(),this.handleSingleLive=e=>{e&&e.courseId&&this.onSelectChange([],[]),this.setState({selectedCourseIds:e&&e.courseId?[e.courseId]:this.state.selectedCourseIds,selectedList:e&&e.courseId?[e]:this.state.selectedList})},this.openDeleteModal=e=>{this.handleSingleLive(e),this.setState({deleteModal:{visible:!0}})},this.handleCloseDeleteModal=()=>{this.setState({deleteModal:{visible:!1}})},this.getTableColumn=()=>{var e=this.props,s=e.t,i=e.appType,r=[{title:s("common.name"),dataIndex:"title",className:"study_project_width",fixed:i==="wx_app"?!1:"left",width:120},{title:s("live.liveChannel"),dataIndex:"liveType",width:80,render:(l,d)=>{var y=te.O7.find(O=>O.value===l);return l&&y&&y.hasOwnProperty("label")?s(y.label):d.courseBizType=="9"?s("live.liveCourse"):""}},{title:s("live.liveStatus"),dataIndex:"liveStatus",width:80,render:(l,d)=>{var y=d.courseBizType=="9"&&l==="live"?"meeting":l,O=te.xu.find(re=>re.value===y);if(O&&O.hasOwnProperty("iconColor")&&O.hasOwnProperty("label")){var X=O.iconColor;return t().createElement("div",null,t().createElement("span",{className:"icon",style:{borderColor:X,background:X}}),t().createElement("span",null,s(O.label)))}else return""}},{title:s("live.type"),dataIndex:"courseBizType",render:l=>l=="8"?s("ddLive.liveAbout"):l=="9"?s("live.conference"):"",width:150},{title:s("live.liveTime"),dataIndex:"startTime",render:l=>(0,ie.p6)(Number(l)),width:150},{title:s("component.lecturer"),dataIndex:"teacherName",width:80,render:(l,d)=>{var y=d.teacherSourceType,O=d.teacherSyncUserId,X=d.teacherType;return X==="inside"&&l?t().createElement(Ae.Z,{dataType:"userName",value:O,name:l,type:y}):l||"--"}},{title:s("learning.learningProjectAddCategory"),dataIndex:"classifyName",width:80,render:l=>t().createElement("div",null,l||s("course.courseCreatePanelFTCategoryNull"))},{title:s("common.visibleRange"),dataIndex:"isAll",width:80,render:l=>s(l===1?"common.allCompany":"setting.partlyVisible")},{title:s("common.creator"),dataIndex:"createUserName",width:150,render:l=>l||"--"},{title:s("live.updateTime"),dataIndex:"updateTime",render:l=>(0,ie.p6)(Number(l)),width:150},{title:s("courseManage.topping"),dataIndex:"isTop",key:"isTop",width:80,render:(l,d)=>t().createElement(L.Z,{checked:l==="true",onChange:y=>this.handleSetTop({isChecked:y,record:d})})},{title:this.props.t("common.operate"),fixed:"right",render:(l,d)=>t().createElement(tt,{actions:this.state.actions,record:d,clickVisibleRange:()=>this.clickVisibleRange(d),editDdLive:()=>this.editDdLive(d),startLive:(0,pe.Ds)(()=>d.liveType==="poly_wei"?this.turnPlayLive(d):this.turnPlayLiveDD(d),500),startMeeting:()=>this.turnPlayMeeting(d),copyLink:()=>this.copyLink(d),liveDelete:()=>this.openDeleteModal(d),shareLive:()=>this.onShareLive(d),streamingAddress:()=>this.onStreamingAddress(d)}),onCell:()=>({style:{minWidth:120}})}];return r},this.handleLiveDelete=()=>{var e=this.props.t,s=this.state.selectedCourseIds;this.handleCloseDeleteModal(),(0,q.wY)(s).then(i=>{i.code==2e5?(p.default.success(e("common.deleteSuccess")),this.getTableList()):p.default.error(e("common.deleteFailure"))})},this.handleSetTop=e=>{var s=e.isChecked,i=e.record;(0,q.wE)(s,{id:i.courseId}).then(r=>{var l=r.data,d=l.code,y=l.msg;d===0?(p.default.success(this.props.t("study.updateSuccess")),this.getTableList()):p.default.warning(y)})},this.editDdLive=e=>{e.courseBizType==9?C.m8.push({pathname:"/training/learning/task/liveRoom/editMeeting",query:{courseId:e.courseId,bizType:e.courseBizType}}):C.m8.push({pathname:"/training/learning/task/liveRoom/editLive",query:{courseId:e.courseId}})},this.handleAddLive=()=>{C.m8.push({pathname:"/training/learning/task/liveRoom/editLive"})},this.clickVisibleRange=function(){var e=(0,D.Z)(P().mark(function s(i){return P().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:n.handleSingleLive(i),i&&i.courseId?(n.isMultiple=!1,(0,q.jG)({courseId:i.courseId,appId:"cool",bizType:i.courseBizType}).then(d=>{var y=d.data.data;n.setState({employeeProps:{visible:!0,initialParams:{employeeRange:{rangeType:y.isAll,rangeList:{dept:y.departmentList||[],post:y.postList||[],group:y.groupList||[],user:y.userList||[]}}}}})})):(n.isMultiple=!0,n.setState(d=>({employeeProps:(0,g.Z)((0,g.Z)({},d.employeeProps),{},{visible:!0})})));case 2:case"end":return l.stop()}},s)}));return function(s){return e.apply(this,arguments)}}(),this.handleEmployeeCancel=()=>{this.setState({employeeProps:{visible:!1,initialParams:{employeeRange:{rangeType:3,rangeList:{dept:[],post:[],group:[],user:[]}}}}})},this.handleEmployeeOk=e=>{var s=this.props.t,i=this.state.selectedCourseIds,r=e.isAll,l=e.departmentIds,d=e.groupIds,y=e.postIds,O=e.userIds;(0,q.Ff)({course_ids:i.join(","),department_ids:l,group_ids:d,is_all:r,post_ids:y,user_ids:O}).then(X=>{X.data.code===0&&(p.default.success(s("personal.batchSetRangeSuccess")),this.getTableList())}),this.handleEmployeeCancel()},this.handleClassifyChange=e=>{this.setState({current:1,classify:e},()=>{this.getTableList()})},this.pageChange=e=>{this.setState({current:e},()=>{this.getTableList()})},this.pageSizeChange=function(){var e=(0,D.Z)(P().mark(function s(i,r){return P().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:n.setState({current:1,pageSize:r},()=>{n.getTableList()});case 1:case"end":return d.stop()}},s)}));return function(s,i){return e.apply(this,arguments)}}(),this.statusChange=function(){var e=(0,D.Z)(P().mark(function s(i){return P().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:n.setState({current:1,liveStatus:i},()=>{n.getTableList()});case 1:case"end":return l.stop()}},s)}));return function(s){return e.apply(this,arguments)}}(),this.channelChange=function(){var e=(0,D.Z)(P().mark(function s(i){return P().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:n.setState({current:1,liveType:i},()=>{n.getTableList()});case 1:case"end":return l.stop()}},s)}));return function(s){return e.apply(this,arguments)}}(),this.typeChange=e=>{this.setState({current:1,type:e},()=>{this.getTableList()})},this.handleDateTypeChange=e=>{this.setState({timeType:e},()=>{this.getTableList()})},this.handleDateRangeChange=(e,s)=>{s[1]&&s[0]?this.setState({current:1,startTime:s[0],endTime:s[1]},()=>{this.getTableList()}):this.setState({current:1,startTime:null,endTime:null},()=>{this.getTableList()})},this.actionChangeClassify=e=>{this.handleSingleLive(e),this.isMultiple=!0,this.setState({classifyProps:{visible:!0}})},this.handleCategoryCancel=()=>{this.setState({classifyProps:{visible:!1}})},this.handleCategoryOk=e=>{var s=e.node,i=this.props.t,r=this.state.selectedCourseIds,l=s.id;l&&r.length>0&&(0,q.$e)({course_ids:r.join(","),classify_id:l}).then(d=>{d.data.code===0&&(p.default.success(i("course.setCourseClassifySuccess")),this.getTableList())}),this.handleCategoryCancel()},this.handleMenuClick=e=>{this[e.key]()},this.getAddContent=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=n.props,i=s.prefixCls,r=s.t;return t().createElement("div",{className:"".concat(i,"__detail"),style:e},n.typeList.map(l=>l.show&&t().createElement("div",{key:l.type,className:"".concat(i,"__addBox__item"),onClick:()=>n.linkToPage(l)},l.badge?t().createElement(_.Z,{offset:[0,0],count:n.state.showNewBadge?r("course.update"):null},t().createElement("div",{className:"".concat(i,"__addBox__item__left"),style:{backgroundImage:"url(".concat(l.imageUrl,")")}}," ")):t().createElement("div",{className:"".concat(i,"__addBox__item__left"),style:{backgroundImage:"url(".concat(l.imageUrl,")")}}," "),t().createElement("div",{className:"".concat(i,"__addBox__item__right")},t().createElement("div",{className:"".concat(i,"__addBox__item__right__title")},l.name,t().createElement(at.Z,{iconClass:"icon-Line_right",size:"8px"})),t().createElement("div",{className:"".concat(i,"__addBox__item__right__describe")},l.describe)))))},this.linkToPage=e=>{var s=e.linkUrl;C.m8.push({pathname:s})},this.headerTitle=()=>{var e=this.props.t,s=this.state,i=s.actions,r=s.selectedRowKeys,l=(0,k.H3)("add_live",i),d=(0,k.H3)("adjustment_classification",i),y=(0,k.H3)("set_visible",i),O=(0,k.H3)("delete_live",i);return t().createElement(t().Fragment,null,l&&t().createElement(T.Z,{title:null,placement:"bottomLeft",content:this.getAddContent,trigger:"hover"},t().createElement(h.Z,{type:"primary",icon:t().createElement(ce.Z,null),style:{marginRight:10}},e("live.addLiveOrConference"))),(y||d||O)&&t().createElement(m.Z,{disabled:r.length===0,overlay:this.renderMenu},t().createElement(h.Z,null,e("ddLive.moreOperate")," ",t().createElement(oe.Z,null))))},this.renderMenu=()=>{var e=this.props.t,s=this.state.actions,i=(0,k.H3)("adjustment_classification",s),r=(0,k.H3)("set_visible",s),l=(0,k.H3)("delete_live",s);return t().createElement(c.Z,{onClick:this.handleMenuClick},r&&t().createElement(c.Z.Item,{key:"clickVisibleRange"},e("common.visibleRange")),i&&t().createElement(c.Z.Item,{key:"actionChangeClassify"},e("ddLive.adjustClassfiy")),l&&t().createElement(c.Z.Item,{key:"openDeleteModal"},e("common.delete")))},this.handleMenuClick=e=>{this[e.key]()},this.toolBarRender=()=>{var e=this.props.t;return t().createElement(st,{style:{float:"right"},className:"user-panel-monitor-filter-search",placeholder:e("live.searchPlaceHolder"),onSearch:this.onSearch,allowClear:!0,maxLength:500})},this.handleSearch=()=>{var e=this.props.t,s=this.state,i=s.classify,r=s.liveType,l=s.liveStatus,d=s.type,y=s.timeType;return t().createElement("div",{className:"set-padding"},t().createElement("input",{id:"copyInput",style:{visibility:"hidden",position:"absolute"}}),t().createElement(Ue.Z,{onChange:this.handleClassifyChange,queryType:"course_manage",unclassified:"true",value:i,showLabel:!1,className:"cl-search-normal-width"}),t().createElement(Y.Z,{className:"cl-search-normal-width",placeholder:e("live.selectLiveStatus"),onChange:this.statusChange,labelInValue:!0,value:l,style:{marginLeft:15}},te.xu.filter(O=>O.value!=="meeting").map(O=>t().createElement(ve,{key:O.value,value:O.value},e(O.label)))),t().createElement(Y.Z,{className:"cl-search-normal-width",placeholder:e("live.selectChannel"),onChange:this.channelChange,labelInValue:!0,value:r,style:{marginLeft:15}},(0,te.Ib)().map(O=>t().createElement(ve,{key:O.value,value:O.value},e(O.label)))),t().createElement(Y.Z,{className:"cl-search-normal-width",placeholder:e("live.type"),onChange:this.typeChange,labelInValue:!0,value:d,style:{marginLeft:15}},t().createElement(ve,{value:"all"},e("live.allType")),t().createElement(ve,{value:"live"},e("ddLive.liveAbout")),t().createElement(ve,{value:"conference"},e("live.conference"))),t().createElement(A.Z.Group,{compact:!0,style:{marginLeft:15}},t().createElement(Y.Z,{value:y,style:{width:120},labelInValue:!0,onChange:this.handleDateTypeChange},t().createElement(ve,{value:"start"},e("live.liveTime")),t().createElement(ve,{value:"update"},e("common.updateTime"))),t().createElement(lt,{showTime:!0,disabled:[!1,!1],defaultValue:[null,null],format:"YYYY-MM-DD HH:mm",onChange:this.handleDateRangeChange,ranges:{["".concat(e("component.lastWeek"))]:[ne()().subtract(7,"day"),ne()()],["".concat(e("component.lastMonth"))]:[ne()().subtract(30,"day"),ne()()],["".concat(e("component.lastThreeMonth"))]:[ne()().subtract(3,"month"),ne()()]}})))};var o=u.t,v=u.modules;this.state={classifyProps:{visible:!1},shareVisible:!1,pushFlowVisible:!1,classify:[],isLoading:!1,pageSize:20,current:1,keyword:"",tableList:[],pageTotal:0,liveStatus:{value:"all",label:o("live.allLiveStatus")},liveType:{value:"",label:o("live.allLiveChannel")},type:{value:"all",label:o("live.allType")},timeType:{value:"start",label:o("live.liveTime")},startTime:null,endTime:null,selectedRowKeys:[],selectedCourseIds:[],selectedList:[],deleteModal:{visible:!1},employeeProps:{visible:!1,initialParams:{employeeRange:{rangeType:3,rangeList:{dept:[],post:[],group:[],user:[]}}}},actions:(0,k.V9)("liveRoom",v),showNewBadge:!0},this.typeList=[{name:this.props.t("ddLive.liveAbout"),type:"course_ztk",describe:this.props.t("live.liveAboutDescribe"),imageUrl:"".concat("https://oss.coolcollege.cn","/1826430592074518528.png"),linkUrl:"/training/learning/task/liveRoom/editLive",show:!0},{name:this.props.t("live.conference"),type:"course_ai",describe:this.props.t("live.conferenceDescribe"),imageUrl:"".concat("https://oss.coolcollege.cn","/1826430592070324224.png"),linkUrl:"/training/learning/task/liveRoom/editMeeting",badge:this.state.showNewBadge,show:(0,x.Dp)()}]}componentDidMount(){this.getTableList()}componentWillUnmount(){t().$share&&t().$share.destroy()}getTurnLink(u,n){var o=localStorage.getItem("enterpriseId"),v="".concat((0,pe.lz)(o),"/live-broadcast-link?courseId=").concat(u.courseId,"&password=").concat(u.password,"&enterpriseId=").concat(o,"&playFlag=").concat(n);return v}render(){var u=this.props.t,n=this.state,o=n.pageTotal,v=n.classifyProps,e=n.current,s=n.tableList,i=n.employeeProps,r=n.selectedRowKeys,l=n.isLoading,d=n.shareVisible,y=n.pushFlowVisible,O=n.deleteModal,X=n.selectedList,re=(0,g.Z)((0,g.Z)({},ke.XE.INITIAL_PAGINATION),{},{current:e,total:o,onChange:this.pageChange,onShowSizeChange:this.pageSizeChange}),ge=this.getTableColumn(),Le={selectedRowKeys:r,onChange:this.onSelectChange};return t().createElement("div",{className:"live-table-normal"},this.handleSearch(),t().createElement("div",{className:"table-part"},t().createElement(ue.f,{style:{width:"100%",height:"100%",overflow:"hidden"},scroll:{x:"max-content",y:"100%"},headerTitle:this.headerTitle(),toolBarRender:this.toolBarRender,columns:ge,rowKey:me=>me.courseId,dataSource:s,pagination:!1,loading:l,rowSelection:Le,tableUUID:"73ad7db9-6cb2-43d2-86b0-768567051bbc"})),t().createElement("div",{className:"pagination-wrap"},t().createElement(V.Z,re)),t().createElement(Ne.Z,(0,b.Z)({},i,{title:u("courseManage.setTheVisibility"),mode:["all","part","private"],orgProps:{title:u("component.chooseVisibleScope")},isLoading:!i.visible,onCancel:this.handleEmployeeCancel,onCreate:this.handleEmployeeOk})),t().createElement(Be.Z,(0,b.Z)({},v,{title:u("personal.chooseClassify"),onCancel:this.handleCategoryCancel,onOk:this.handleCategoryOk})),t().createElement(we,{visible:d,shareType:"playAbout",record:X[0],onClose:this.onCloseShare}),t().createElement(Je,{visible:y,record:X[0],onClose:this.onCloseStreamingAddress}),t().createElement(H.Z,{visible:O.visible,width:800,centered:!0,onOk:this.handleLiveDelete,onCancel:this.handleCloseDeleteModal},t().createElement(Ie,{tableList:X,liveStatusOptions:te.xu,liveChannelOptions:te.O7})))}}Ke.defaultProps={prefixCls:"live-table"};var nt=(0,j.$j)(G=>({userInfo:G.user,appType:G.user.appType,modules:G.user.modules}))((0,M.Z)()(Ke)),it=a(84391),bt=a(20228),rt=a(11382),ot=a(18329),ct=a(54792);class $e extends t().Component{constructor(u){var n;super(u);n=this,this.onAsyncChange=o=>{this.setState(v=>({asyncProps:(0,g.Z)((0,g.Z)({},v.asyncProps),{},{value:o.target.value})}))},this.changeCourseStatus=(o,v)=>{this.props.onSingleLive(o);var e=this.props.t,s={courseId:o.courseId,action:v==="publish"?"release":"cancel"};(0,q.NH)(s).then(i=>{i.data.code===0&&(p.default.success(e(v==="publish"?"personal.publishSuccess":"personal.cancelPublishSuccess")),this.props.getTableList())}).catch(()=>{p.default.error(e("historicRecords.fail"))})},this.handleEmployeeOk=o=>{var v=this.props,e=v.t,s=v.selectedCourseIds,i=o.isAll,r=o.departmentIds,l=o.groupIds,d=o.postIds,y=o.userIds;(0,q.Ff)({course_ids:s.join(","),department_ids:r,group_ids:l,is_all:i,post_ids:d,user_ids:y}).then(O=>{O.data.code===0&&(p.default.success(e("personal.batchSetRangeSuccess")),this.props.getTableList())}),this.handleEmployeeCancel()},this.actionChangeClassify=()=>{this.isMultiple=!0,this.setState({classifyProps:{visible:!0}})},this.handleCategoryCancel=()=>{this.setState({classifyProps:{visible:!1}})},this.clickVisibleRange=function(){var o=(0,D.Z)(P().mark(function v(e){return P().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:n.props.onSingleLive(e),e&&e.courseId?(n.isMultiple=!1,(0,q.jG)({courseId:e.courseId,appId:"cool",bizType:e.courseBizType}).then(r=>{var l=r.data.data;l?n.setState({employeeProps:{visible:!0,initialParams:{employeeRange:{rangeType:l.isAll,rangeList:{dept:l.departmentList||[],post:l.postList||[],group:l.groupList||[],user:l.userList||[]}}}}}):r.data.message&&p.default.warning(r.data.message)}).catch(r=>{console.warn(r)})):(n.isMultiple=!0,n.setState(r=>({employeeProps:(0,g.Z)((0,g.Z)({},r.employeeProps),{},{visible:!0})})));case 2:case"end":return i.stop()}},v)}));return function(v){return o.apply(this,arguments)}}(),this.handleEmployeeCancel=()=>{this.setState({employeeProps:{visible:!1,initialParams:{employeeRange:{rangeType:3,rangeList:{dept:[],post:[],group:[],user:[]}}}}})},this.handleCategoryOk=o=>{var v=o.node,e=this.props.t,s=this.props.selectedCourseIds,i=v.id;i&&s.length>0&&(0,q.$e)({course_ids:s.join(","),classify_id:i}).then(r=>{r.data.code===0&&(p.default.success(e("course.setCourseClassifySuccess")),this.props.getTableList())}),this.handleCategoryCancel()},this.actionSyncSetting=()=>{this.setState(o=>({asyncProps:(0,g.Z)((0,g.Z)({},o.asyncProps),{},{visible:!0})}))},this.handleSyncCancel=()=>{this.setState({asyncProps:{visible:!1,value:0}})},this.handleSyncOk=()=>{var o=this.props,v=o.selectedCourseIds,e=o.t,s=this.state.asyncProps,i={course_ids:v.join(","),syncProgress:s.value};(0,q.nv)(i).then(r=>{var l=r.data,d=l.code,y=l.msg;d===0?(p.default.success(e("setting.setUpSucceed")),this.props.getTableList()):p.default.warning(y)}),this.handleSyncCancel()},this.showSetScore=()=>{this.setState(o=>({setScoreConfig:(0,g.Z)((0,g.Z)({},o.setScoreConfig),{},{visible:!0})}))},this.handleScoreCancel=()=>{this.setState(o=>({setScoreConfig:(0,g.Z)((0,g.Z)({},o.setScoreConfig),{},{visible:!1})}))},this.handleScoreOk=o=>{var v=o.value,e=this.props,s=e.t,i=e.selectedCourseIds,r={course_ids:i.join(","),credit:v};(0,q.ts)(r).then(()=>{p.default.success(s("personal.setCourseScoreSuccess")),this.props.getTableList()}),this.handleScoreCancel()},this.state={classifyProps:{visible:!1},employeeProps:{visible:!1,initialParams:{employeeRange:{rangeType:3,rangeList:{dept:[],post:[],group:[],user:[]}}}},setScoreConfig:{title:u.t("courseManage.setCredits"),labelTxt:u.t("common.credit"),initialValue:"",visible:!1},asyncProps:{value:0,visible:!1}}}componentDidMount(){this.props.onRef&&this.props.onRef(this)}render(){var u=this.state,n=u.classifyProps,o=u.employeeProps,v=u.setScoreConfig,e=u.asyncProps,s=this.props,i=s.t,r=s.prefixCls;return t().createElement(t().Fragment,null,t().createElement(Ne.Z,(0,b.Z)({},o,{title:i("courseManage.setTheVisibility"),mode:["all","part","private"],orgProps:{title:i("component.chooseVisibleScope")},isLoading:!o.visible,onCancel:this.handleEmployeeCancel,onCreate:this.handleEmployeeOk})),t().createElement(Be.Z,(0,b.Z)({},n,{title:i("personal.chooseClassify"),onCancel:this.handleCategoryCancel,onOk:this.handleCategoryOk})),t().createElement(ct.Z,(0,b.Z)({},v,{onCancel:this.handleScoreCancel,onCreate:this.handleScoreOk})),t().createElement(ot.ZP,{wrapClassName:"cl-async-selector-modal",visible:e.visible,title:i("common.scheduleSyncSetting"),okText:i("common.ok"),cancelText:i("common.cancel"),onCancel:this.handleSyncCancel,onOk:this.handleSyncOk},e.visible?t().createElement("div",{className:"".concat(r,"__async")},t().createElement("p",null," ",i("common.scheduleSyncSettingTip")),t().createElement(he.ZP.Group,{onChange:this.onAsyncChange,value:e.value},t().createElement(he.ZP,{value:0},i("common.outSync")),t().createElement(he.ZP,{value:1},i("common.synchronization")))):t().createElement(rt.Z,{size:"large"})))}}$e.defaultProps={prefixCls:"about-course-live-room"};var dt=(0,j.$j)()((0,M.Z)()($e));class ut extends t().PureComponent{constructor(u){super(u);this.moreOperate=(n,o)=>{var v=this.props.t,e=n.map(s=>{switch(s.type){case"data":return t().createElement(le.Z,{type:o,key:"data",click:this.props.lookDetail,title:v("common.data")});case"set_visible":return t().createElement(le.Z,{type:o,key:"set_visible",click:this.props.clickVisibleRange,title:v("common.visibleRange")});case"publish_course":return t().createElement(le.Z,{type:o,key:"publish_record_live",click:this.props.publishCourse,title:v("common.release")});case"un_publish_course":return t().createElement(le.Z,{type:o,key:"un_publish_record_live",click:this.props.unPublishCourse,title:v("course.cancelRelease")});case"share_live":return t().createElement(le.Z,{type:o,key:"share_record_live",click:this.props.shareLive,title:v("common.share")});case"edit_live":return t().createElement(le.Z,{type:o,key:"edit_live",click:this.props.editCourse,title:v("common.edit")});case"delete_live":return t().createElement(le.Z,{type:o,key:"delete_live",click:this.props.liveDelete,title:v("common.delete")});default:return null}});return o==="more"?t().createElement(c.Z,null,e):e},this.state={actions:u.actions}}render(){var u=this.state.actions,n=this.props.record,o=[{type:"data",visible:(0,k.H3)("data",u)},{type:"set_visible",visible:(0,k.H3)("set_visible",u)&&n.courseStatus==="1"},{type:"edit_live",visible:(0,k.H3)("edit_live",u)},{type:"publish_course",visible:(0,k.H3)("release_or_cancelled",u)&&n.courseStatus==="0"},{type:"un_publish_course",visible:(0,k.H3)("release_or_cancelled",u)&&n.courseStatus==="1"},{type:"share_live",visible:(0,k.H3)("share_live",u)&&n.courseStatus==="1"&&n.courseBizType=="8"},{type:"delete_live",visible:(0,k.H3)("delete_live",u)}],v=o.filter(e=>e.visible);return t().createElement("div",{className:"cl-table__cell-action"},this.moreOperate(v.slice(0,1)),v.length>1&&t().createElement(t().Fragment,null,t().createElement("span",{className:"cl-pointer-divide"}),t().createElement(m.Z,{overlay:this.moreOperate(v.slice(1),"more")},t().createElement("span",{className:"cl-pointer"},this.props.t("common.more")," ",t().createElement(oe.Z,null)))))}}var pt=(0,M.Z)()(ut),mt=a(87722),We=a(1164),_e=Y.Z.Option,ht=A.Z.Search;class je extends t().Component{constructor(u){var n;super(u);n=this,this.onRef=e=>{this.aboutCourse=e,this.setState({aboutCourse:e})},this.onSearch=e=>{this.setState({current:1,keyword:e},()=>{this.getTableList()})},this.onSelectChange=(e,s)=>{var i=[];s.forEach(r=>{i.push(r.courseId)}),this.setState({selectedCourseIds:i,selectedRowKeys:e,selectedList:s})},this.onShareLive=e=>{this.onSingleLive(e);var s=this.props,i=s.t,r=s.userInfo,l=e.liveType==="poly_wei"?"live_poly_wei":"dingTalk",d={title:e.title,site1:{label:i("ddLive.liveTime"),value:ne()(parseInt(e.startTime)).format("YYYY-MM-DD HH:mm")},site2:{label:i("common.endTime"),value:ne()(e.end_time).format("YYYY-MM-DD HH:mm")},lecture:{name:e.anchorName,avatar:e.avatar,id:e.anchorId,source_type:e.sourceType},from:"live_course",path:(()=>{if(l=="live_poly_wei")return(0,pe.jr)({pc_url:"course/enterpriseCourse?courseId=".concat(e.courseId),pc_type:"student",mobile_url:"/pages/messageRedirect/messageRedirect?corpId=".concat(r.corpId,"&appId=").concat(sessionStorage.getItem("CL_E_APP_ID"),"&miniAppId=").concat(sessionStorage.getItem("CL_MINI_APP_ID"),"&packageType=1&pVersion=1&flag=").concat(l,"&msgType=student&courseId=").concat(e.courseId),mobile_type:"cross"});var y="courseId=".concat(encodeURIComponent(e.courseId));return(0,pe.jr)({pc_url:"/live-view-ding-link?courseId=".concat(e.courseId),mobile_url:"/business-transit?params=".concat(encodeURIComponent(y),"&businessType=dingLive"),pc_type:"student",mobile_type:"h5"})})()};t().$share.show({detail:d})},this.onCloseShare=()=>{this.setState({shareVisible:!1})},this.onSingleLive=e=>{e&&e.courseId&&this.onSelectChange([],[]),this.setState({selectedCourseIds:e&&e.courseId?[e.courseId]:this.state.selectedCourseIds,selectedList:e&&e.courseId?[e]:this.state.selectedList})},this.getTableList=(0,D.Z)(P().mark(function e(){return P().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:n.setState({isLoading:!0}),(0,q.k3)(n.getParams()).then(r=>{var l=r.data.data;n.onSelectChange([],[]),n.setState({pageTotal:l.total,tableList:l.list,isLoading:!1}),n.isMultiple&&n.setState({selectedRowKeys:[]})});case 2:case"end":return i.stop()}},e)})),this.openDeleteModal=e=>{this.onSingleLive(e),this.setState({deleteModal:{visible:!0}})},this.handleCloseDeleteModal=()=>{this.setState({deleteModal:{visible:!1}})},this.turnPlayLiveDD=function(){var e=(0,D.Z)(P().mark(function s(i){var r,l;return P().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:r=n.props.t,l=navigator.userAgent,l.includes("DingTalk")?dd.biz.util.openLink({url:i.jumpUrl}):p.default.info(r("ddLive.ddInfo"));case 3:case"end":return y.stop()}},s)}));return function(s){return e.apply(this,arguments)}}(),this.getTableColumn=()=>{var e=this.props.t,s=this.state.aboutCourse,i=localStorage.getItem("themeColor")||"#465dcd",r=[{title:e("common.name"),dataIndex:"title",className:"study_project_width",fixed:this.props.appType==="wx_app"?!1:"left",width:120,render:(l,d)=>d.courseBizType=="9"?t().createElement("div",{style:{cursor:"pointer",color:i},onClick:()=>(0,De.K7)(d.courseId,"end")},l):t().createElement("div",{style:{cursor:"pointer",color:i},onClick:()=>d.liveType==="poly_wei"?(0,De.K7)(d.courseId,"end"):this.turnPlayLiveDD(d)},l)},{title:e("live.liveChannel"),dataIndex:"liveType",width:80,render:(l,d)=>{var y=te.O7.find(O=>O.value===l);return y&&y.hasOwnProperty("label")?e(y.label):d.courseBizType=="9"?e("live.liveCourse"):""}},{title:e("live.publishStatus"),dataIndex:"courseStatus",width:80,render:l=>{var d=te.wL.find(y=>y.value===l);return t().createElement("div",null,t().createElement("span",{className:"icon",style:{borderColor:d?d.iconColor:""}}),t().createElement("span",null,e(d?d.label:"")))}},{title:e("live.liveTime"),dataIndex:"startTime",render:l=>(0,ie.p6)(Number(l)),width:150},{title:e("component.lecturer"),dataIndex:"teacherName",width:80,render:(l,d)=>{var y=d.teacherSourceType,O=d.teacherSyncUserId,X=d.teacherType;return X==="inside"&&l?t().createElement(Ae.Z,{dataType:"userName",value:O,name:l,type:y}):l||"--"}},{title:e("course.viewers"),dataIndex:"uv",width:80},{title:e("ddLive.watchTimes"),dataIndex:"pv",width:80},{title:e("learning.learningProjectAddCategory"),dataIndex:"classifyName",width:80,render:l=>t().createElement("div",null,l||this.props.t("course.courseCreatePanelFTCategoryNull"))},{title:e("common.visibleRange"),dataIndex:"isAll",width:80,render:l=>e(l===1?"common.allCompany":"setting.partlyVisible")},{title:e("courseManage.rewardCredits"),dataIndex:"credit",width:80,render:l=>"+".concat(l||0)},{title:e("common.creator"),dataIndex:"createUserName",width:150,render:l=>l||"--"},{title:e("live.updateTime"),dataIndex:"updateTime",render:l=>(0,ie.p6)(Number(l)),width:150},{title:e("courseManage.topping"),dataIndex:"isTop",key:"isTop",width:80,render:(l,d)=>t().createElement(L.Z,{checked:l==="true",onChange:y=>this.handleSetTop({isChecked:y,record:d})})},{title:this.props.t("common.operate"),width:140,fixed:"right",render:(l,d)=>t().createElement(pt,{actions:this.state.actions,record:d,lookDetail:()=>this.lookDetail(d),clickVisibleRange:()=>s.clickVisibleRange(d),editCourse:()=>this.editCourse(d),liveDelete:()=>this.openDeleteModal(d),publishCourse:()=>s.changeCourseStatus(d,"publish"),unPublishCourse:()=>s.changeCourseStatus(d,"unPublish"),shareLive:()=>this.onShareLive(d)}),onCell:()=>({style:{minWidth:120}})}];return r},this.handleSetTop=e=>{var s=e.isChecked,i=e.record;(0,q.wE)(s,{id:i.courseId}).then(r=>{var l=r.data,d=l.code,y=l.msg;d===0?(p.default.success(this.props.t("study.updateSuccess")),this.getTableList()):p.default.warning(y)})},this.lookDetail=e=>{e.courseBizType=="9"?C.m8.push({pathname:"/training/learning/task/live/liveDetailMeeting",query:{courseId:e.courseId,bizType:e.courseBizType}}):C.m8.push({pathname:"/training/learning/task/live/liveDetail",query:{courseId:e.courseId}})},this.editCourse=e=>{e.courseBizType=="9"?We.Z.targetTo({path:"/training/learning/task/liveRoom/editPlaybackMeeting?courseId=".concat(e.courseId,"&bizType=").concat(e.courseBizType)}):We.Z.targetTo({path:"/training/learning/task/liveRoom/editPlayback?courseId=".concat(e.courseId)})},this.exportLiveCourse=()=>{(0,q.Eq)(this.getParams()).then(e=>{e.data.code===2e5&&p.default.info(this.props.t("study.compoundSucceed"))})},this.pageChange=e=>{this.setState({current:e},()=>{this.getTableList()})},this.pageSizeChange=function(){var e=(0,D.Z)(P().mark(function s(i,r){return P().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:n.setState({current:1,pageSize:r},()=>{n.getTableList()});case 1:case"end":return d.stop()}},s)}));return function(s,i){return e.apply(this,arguments)}}(),this.statusChange=function(){var e=(0,D.Z)(P().mark(function s(i){return P().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:n.setState({current:1,courseStatus:i},()=>{n.getTableList()});case 1:case"end":return l.stop()}},s)}));return function(s){return e.apply(this,arguments)}}(),this.handleChangeDateRange=e=>{var s=e.dateStrings;this.setState({startTime:s[0]===""?"":(0,ie.jZ)(s[0]),endTime:s[1]===""?"":(0,ie.jZ)(s[1]),current:1},()=>{this.getTableList()})},this.hiddenQrCode=()=>{var e=this.state.qrCodeConfig;e.visible=!1,this.setState({qrCodeConfig:e})},this.handleClassifyChange=e=>{this.setState({current:1,classify:e},()=>{this.getTableList()})},this.handleMenuClick=e=>{e.key==="openDeleteModal"?this[e.key]():this.state.aboutCourse[e.key]()},this.typeChange=e=>{this.setState({type:e},()=>{this.getTableList()})},this.renderLeftQuery=()=>{var e=this.state,s=e.classify,i=e.courseStatus,r=this.props.t;return t().createElement("div",{className:"set-padding"},t().createElement("input",{id:"copyInput",style:{visibility:"hidden",position:"absolute"}}),t().createElement(Ue.Z,{onChange:this.handleClassifyChange,queryType:"course_manage",unclassified:"true",value:s,showLabel:!1,className:"cl-search-normal-width"}),t().createElement(Y.Z,{className:"cl-search-normal-width",placeholder:r("course.chooseStatus"),onChange:this.statusChange,labelInValue:!0,value:i,style:{marginLeft:15}},te.wL.map(l=>t().createElement(_e,{key:l.value,value:l.value},r(l.label)))),t().createElement(Y.Z,{className:"cl-search-normal-width",placeholder:r("live.type"),onChange:this.typeChange,labelInValue:!0,value:this.state.type,style:{marginLeft:15}},t().createElement(_e,{value:"all"},r("live.allType")),t().createElement(_e,{value:"live"},r("ddLive.liveAbout")),t().createElement(_e,{value:"conference"},r("live.conference"))),t().createElement(mt.Z,{showTime:!0,style:{marginLeft:15},disabledDate:!1,placeholder:[r("live.startLiveTime"),r("live.endLiveTime")],onCustomChange:this.handleChangeDateRange}))},this.renderMenu=()=>{var e=this.props.t,s=this.state.actions,i=(0,k.H3)("set_score",s),r=(0,k.H3)("progress_sync",s),l=(0,k.H3)("delete_live",s);return t().createElement(c.Z,{onClick:this.handleMenuClick},r&&t().createElement(c.Z.Item,{key:"actionSyncSetting"},e("common.scheduleSync")),i&&t().createElement(c.Z.Item,{key:"showSetScore"},e("course.setCredits")),l&&t().createElement(c.Z.Item,{key:"openDeleteModal"},e("common.delete")))},this.headerTitle=()=>{var e=this.props.t,s=this.state,i=s.actions,r=s.selectedRowKeys,l=s.aboutCourse,d=(0,k.H3)("adjustment_classification",i),y=(0,k.H3)("set_visible",i),O=(0,k.H3)("export",i),X=(0,k.H3)("set_score",i),re=(0,k.H3)("progress_sync",i),ge=(0,k.H3)("delete_live",i);return t().createElement(t().Fragment,null,O&&t().createElement(h.Z,{onClick:this.exportLiveCourse,type:"primary",icon:t().createElement(it.Z,null),style:{marginRight:10}},e("live.exportData")),y&&t().createElement(h.Z,{onClick:l.clickVisibleRange,disabled:r.length===0,style:{marginRight:10}},e("common.visibleRange")),d&&t().createElement(h.Z,{onClick:l.actionChangeClassify,disabled:r.length===0,style:{marginRight:10}},e("ddLive.adjustClassfiy")),(X||re||ge)&&t().createElement(m.Z,{disabled:r.length===0,overlay:this.renderMenu},t().createElement(h.Z,null,e("ddLive.moreOperate")," ",t().createElement(oe.Z,null))))},this.handleLiveDelete=()=>{var e=this.props.t,s=this.state.selectedCourseIds;this.handleCloseDeleteModal(),(0,q.wY)(s).then(i=>{i.code==2e5?(p.default.success(e("common.deleteSuccess")),this.getTableList()):p.default.error(e("common.deleteFailure"))})},this.toolBarRender=()=>{var e=this.props.t;return t().createElement(ht,{style:{float:"right"},className:"user-panel-monitor-filter-search",placeholder:e("live.searchPlaceHolder"),onSearch:this.onSearch,allowClear:!0,maxLength:400})};var o=u.t,v=u.modules;this.state={shareVisible:!1,classify:[],isLoading:!1,tableList:[],pageTotal:200,pageSize:20,current:1,startTime:"",endTime:"",courseStatus:{value:99,label:o("live.allPublishStatus")},keyword:"",deleteModal:{visible:!1},type:{value:"all",label:o("live.allType")},qrCodeConfig:{visible:!1,title:this.props.t("common.share"),isProjectShare:!0,onCancel:this.hiddenQrCode,tip:"",option:{scene:"",flag:"study_project"}},selectedRowKeys:[],selectedCourseIds:[],selectedList:[],aboutCourse:{},actions:(0,k.V9)(u.menuKey,v)}}componentDidMount(){this.getTableList()}componentWillUnmount(){t().$share&&t().$share.destroy()}getParams(){var u=this.state,n=u.classify,o=u.pageSize,v=u.current,e=u.keyword,s=u.courseStatus,i=u.startTime,r=u.endTime,l=u.type,d={pageSize:o,pageNum:v,liveClassify:"replay",startTime:i,endTime:r,listType:l.value,timeType:"start"};return e&&(d.keyword=e),(0,B.isEmpty)(n)||(d.classifyId=n[n.length-1]),s.value!==99&&(d.courseStatus=s.value),d}render(){var u=this.state,n=u.pageTotal,o=u.current,v=u.tableList,e=u.selectedRowKeys,s=u.isLoading,i=u.deleteModal,r=u.selectedList,l=u.shareVisible,d=u.selectedCourseIds,y=(0,g.Z)((0,g.Z)({},ke.XE.INITIAL_PAGINATION),{},{current:o,total:n,onChange:this.pageChange,onShowSizeChange:this.pageSizeChange}),O=this.getTableColumn(),X={selectedRowKeys:e,onChange:this.onSelectChange,getCheckboxProps:re=>({disabled:re.liveStatus==="live"})};return t().createElement("div",{className:"dd-live-table"},this.renderLeftQuery(),t().createElement("div",{className:"table-part"},t().createElement(ue.f,{style:{width:"100%",height:"100%",overflow:"hidden"},scroll:{x:"max-content",y:"100%"},headerTitle:this.headerTitle(),toolBarRender:this.toolBarRender,columns:O,rowKey:re=>re.courseId,dataSource:v,pagination:!1,loading:s,rowSelection:X,tableUUID:"73ad7db9-6cb2-43d2-86b0-768567051bbc"})),t().createElement("div",{className:"pagination-wrap"},t().createElement(V.Z,y)),t().createElement(H.Z,{visible:i.visible,width:800,centered:!0,onOk:this.handleLiveDelete,onCancel:this.handleCloseDeleteModal},t().createElement(Ie,{type:"playback",tableList:r,liveStatusOptions:te.xu,liveChannelOptions:te.O7})),t().createElement(we,{visible:l,shareType:"playback",record:r[0],onClose:this.onCloseShare}),t().createElement(dt,{onRef:this.onRef,onSingleLive:this.onSingleLive,selectedCourseIds:d,getTableList:this.getTableList}))}}je.defaultProps={prefixCls:"live-playback"};var vt=(0,j.$j)(G=>({userInfo:G.user,appType:G.user.appType,modules:G.user.modules}))((0,M.Z)()(je)),gt=a(4408),yt=a(11449),Fe=Q.Z.TabPane,Ct=G=>({userInfo:G.user});class ze extends t().Component{constructor(u){super(u);this.onChangeTab=n=>{this.setState({activeKey:n}),C.m8.push("/knowledgeBase/learningResources/liveRoom?activeKey=".concat(n))},this.state={activeKey:""}}componentDidMount(){var u=$.parse(C.m8.location.search),n=u.activeKey;this.onChangeTab(n||"liveAbout")}render(){var u=this.props,n=u.prefixCls,o=u.t,v=this.state.activeKey,e="".concat((0,x.eD)()).concat(o(v==="liveAbout"?"live.appointment":"live.playback"));return t().createElement(yt.Z,{className:n,pageContainerParams:{header:{title:(0,x.eD)()}}},t().createElement(gt.Z,{title:e}),t().createElement(Q.Z,{className:"".concat(n,"_tabs"),activeKey:v,defaultValue:"liveAbout",onChange:s=>this.onChangeTab(s)},t().createElement(Fe,{tab:o("live.appointment"),key:"liveAbout"},t().createElement(nt,{menuKey:"liveRoom"})),t().createElement(Fe,{tab:o("live.playback"),key:"livePlayback"},t().createElement(vt,{menuKey:"liveRoom"}))))}}ze.defaultProps={prefixCls:"live-room"};var ft=(0,j.$j)(Ct)((0,M.Z)()(ze))},64462:function(de,J,a){"use strict";a.d(J,{K7:function(){return H},Vo:function(){return b},It:function(){return ee}});var K=a(57361),Q=a(34792),U=a(48086),t=a(9754),M=a.n(t),j=a(37055),C=a(10237),$=a(60333),x=a(1164),W=a(38642);function H(N,m){(m==="end"||m==="remarking")&&(0,W.eJ)({url:"/course/enterpriseCourse?courseId=".concat(N)}),C.WY.get({url:j.ZP.EnterpriseCourse.getEnterpriseCourse(),params:{id:N}}).then(I=>{var T=I.data.live_status;T==="end"||T==="remarking"?(0,W.eJ)({url:"/course/enterpriseCourse?courseId=".concat(N)}):(0,$.uA)(N).then(f=>{var h=f.data;h.code===2e5?x.Z.targetTo({path:h.data.link,isExternalLink:!0}):U.default.error(h.message)}).catch(f=>{console.log(f)})}).catch(I=>{console.log(I)})}function b(N){(0,$.u0)(N).then(m=>{var I=m.data;I.code===2e5?window.open(I.data.link,"_blank"):U.default.error(I.message)}).catch(m=>{console.log(m)})}function ee(N,m){return V.apply(this,arguments)}function V(){return V=(0,K.Z)(M().mark(function N(m,I){var T;return M().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:T=window.navigator.userAgent,T.includes("DingTalk")?C.WY.get({url:j.ZP.DdLive.getLiveDetail(),params:{courseId:m,appId:"cool"}}).then(S=>{var _=S.data;dd.biz.util.openLink({url:_.data.jumpUrl})}).catch(S=>{console.log(S)}):U.default.info(I("ddLive.ddInfo"));case 2:case"end":return h.stop()}},N)})),V.apply(this,arguments)}function ae(){}function c(){}}}]);
