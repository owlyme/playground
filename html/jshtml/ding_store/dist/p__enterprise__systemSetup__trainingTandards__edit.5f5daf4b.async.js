(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[8879],{7584:function(ce,W,n){"use strict";n.d(W,{t:function(){return D}});var M=n(47673),P=n(4107),x=n(62029),p=n(33565),V=n(81211),C=n(12924),A=n.n(C),g=n(80991),_=n(47444),c=n(60006),S=n.n(c),a=n(43859);function y(v){var B=v.isPreview,k=v.char,L=v.displayType,T=v.width,m=v.LimitLength,J=v.showCount,X=v.value,$=v.valueSlice,K=v.onChange,Q=v.disabledInput,q=(0,V.Z)(v,["isPreview","char","displayType","width","LimitLength","showCount","value","valueSlice","onChange","disabledInput"]),H=(0,C.useState)(()=>$?(0,_.B)({value:X,LimitLength:m,char:k}):v.defaultValue||""),ne=(0,p.Z)(H,2),h=ne[0],I=ne[1],O=(0,C.useRef)({evtName:""});(0,C.useEffect)(()=>{I($?(0,_.B)({value:X,LimitLength:m,char:k,disabledInput:Q}):X)},[X,m,k,$,Q]),(0,C.useEffect)(()=>{if(O.current.evtName==="input"){L==="Custom"?v.onFieldChange(h):K(h),v.onInput&&v.onInput(h),O.current.evtName="";return}$&&(L==="Custom"?v.onFieldChange(h):K(h),v.onInput&&v.onInput(h))},[h,L,$]);var N=w=>{O.current.evtName="input";var Y=w.target,se=Y.value,ee=(0,_.B)({value:se,LimitLength:m,char:k,disabledInput:Q});I(ee)},U=(0,C.useMemo)(()=>(0,_.S)({inputValue:h,LimitLength:m,char:k,showCount:J,disabledInput:Q}),[h,m,k,J,Q]),z=U.dataCount,R=U.usedLength,G=(0,C.useRef)(null);return(0,C.useEffect)(()=>{G&&G.current&&(v.autoFocus==="true"?G.current.focus():G.current.blur())},[v.autoFocus]),A().createElement("div",{className:"".concat(S()["input-wrap"]," ").concat(R&&m&&R>m?S()["input-wrap-error"]:""),"data-count":z,style:{width:T||void 0}},L==="Custom"?A().createElement(P.Z,(0,x.Z)({},q,{value:h,disabled:B,onInput:N})):A().createElement(P.Z,(0,x.Z)({},q,{value:h,ref:G,disabled:B,onInput:N})))}y.defaultProps={valueSlice:!1,disabledInput:!0,onChange:()=>{},onInput:()=>{},char:!1,LimitLength:void 0,showCount:!1,displayType:"",width:void 0};var D=y;W.Z=(0,a.Z)((0,g.$j)(y))},47444:function(ce,W,n){"use strict";n.d(W,{B:function(){return P},S:function(){return x}});var M=n(2396);function P(p){var V=p.value,C=p.LimitLength,A=p.char,g=p.disabledInput,_=V&&typeof V=="string"?V:"",c=_;return g&&A&&C&&(0,M.$s)(c)>C&&(c=_.substring(0,(0,M.rw)(_,C))),c}function x(p){var V=p.inputValue,C=p.LimitLength,A=p.char,g=p.showCount,_="",c=V&&typeof V=="string"?V:"",S=A?Math.ceil((0,M.$s)(c)):c.length;return g&&C&&(_="".concat(S,"/").concat(C)),{dataCount:_,usedLength:S}}},43859:function(ce,W,n){"use strict";var M=n(62029),P=n(81211),x=n(43358),p=n(34041),V=n(12924),C=n.n(V),A=n(94184),g=n.n(A),_=n(59239),c=n(55446),S=n.n(c),a=n(6793),y=_.Z.Item,D=p.Z.Option,v=B=>function(L){var T=L.field,m=L.form,J=L.hasFeedback,X=L.label,$=L.selectOptions,K=L.submitCount,Q=L.type,q=L.displayType,H=L.labelCol,ne=H===void 0?{}:H,h=L.wrapperCol,I=h===void 0?{}:h,O=L.required,N=O===void 0?!1:O,U=L.customError,z=U===void 0?!1:U,R=L.colon,G=R===void 0?!0:R,w=L.formItemClassName,Y=(0,P.Z)(L,["field","form","hasFeedback","label","selectOptions","submitCount","type","displayType","labelCol","wrapperCol","required","customError","colon","formItemClassName"]),se=m.touched[T.name],ee=K>0,re=m.errors[T.name],ue=re&&ee,le=re&&se,pe=Z=>{var j=Z!=null&&Z.target?Z.target.value:Z;m.setFieldValue(T.name,j),m.touched[T.name]||setTimeout(()=>{m.setFieldTouched(T.name,!0)},0)},ge=Z=>{var j={},oe={},ve=Z;if(Z===void 0&&(ve=""),m.setFieldValue(T.name,ve),T.name==="courseList"&&Z&&Object.prototype.toString.apply(Z).slice(8,-1)==="Array"&&Z.length>0){j.startTime=Z[0].beginTime,oe.startTime=Number((0,a.jZ)(Z[0].beginTime))+864e5;var b=[];Z.forEach(ie=>{ie.endTime!==""&&b.push(ie)}),b.length>0&&m.values.dateRange.endTime?(0,a.jZ)(m.values.dateRange.endTime)>b[b.length-1].endTime?(j.endTime=m.values.dateRange.endTime,oe.endTime=Number((0,a.jZ)(m.values.dateRange.endTime))-864e5):b.length>0&&m.values.dateRange.endTime&&(0,a.jZ)(m.values.dateRange.endTime)<=b[b.length-1].endTime&&(j.endTime=b[b.length-1].endTime,oe.endTime=Number((0,a.jZ)(b[b.length-1].endTime))-864e5):b.length>0&&!m.values.dateRange.endTime&&(j.endTime=b[b.length-1].endTime,oe.endTime=Number((0,a.jZ)(b[b.length-1].endTime))-864e5),b.length>0&&m.setFieldValue("dateRange",j),m.setFieldValue("dateRangeLimit",oe)}if(T.name==="stages"&&Z&&Object.prototype.toString.apply(Z).slice(8,-1)==="Array"&&Z.length>0){var te=[];Z.forEach(ie=>{ie.list&&ie.list.forEach(me=>{me.componentName==="OfflineTrain"&&te.push(me.data)})}),te.length>0&&(j.startTime=te[0].beginTimeStr,j.endTime=te[te.length-1].endTimeStr,j.startTime=Number((0,a.jZ)(te[0].beginTimeStr))+864e5,j.endTime=Number((0,a.jZ)(te[te.length-1].endTimeStr))-864e5,m.setFieldValue("dateRangeLimit",j))}m.touched[T.name]||setTimeout(()=>{m.setFieldTouched(T.name,!0)},0)},he=()=>m.setFieldTouched(T.name,!0),fe=g()(["cl-form__field"]);return C().createElement("div",{className:fe},C().createElement(y,{label:X,className:"$$CL-FORM-ERROR__".concat(T.name," antd-field-item ").concat(w),hasFeedback:!!(J&&ee||J&&se),help:(ue||le)&&!z?re:!1,validateStatus:(ue||le)&&!z?"error":"success",labelCol:ne,wrapperCol:I,required:N,colon:G},q==="Custom"?C().createElement(B,(0,M.Z)({},T,Y,{displayType:q,onBlur:he,onFieldChange:ge})):C().createElement(B,(0,M.Z)({},T,Y,{displayType:q,onBlur:he,onChange:Q?pe:ge,form:m}),$&&$.map(Z=>C().createElement(D,{key:Z},Z)))))};W.Z=v},11449:function(ce,W,n){"use strict";n.d(W,{Z:function(){return ne}});var M=n(88986),P=n(33565),x=n(12924),p=n.n(x),V=n(3115),C=n(49111),A=n(19650),g=n(62029),_=n(57663),c=n(71577),S=n(91768),a=n(28216),y=n(37055),D=n(10237);function v(h){var I=y.ZP.getHelpContentByMenuKey(),O={key:h};return D.WY.get({url:I,params:O})}var B=n(74228),k=n.n(B),L=n(1164),T=n(76466),m=n(38642);class J extends p().Component{constructor(I){var O;super(I);O=this,this.getHelpContentByMenuKey=()=>{var N=this.props.defaultMenuKey;v(N).then(U=>{var z=U.data,R=z.help_url,G=z.video_url;this.setState({videoUrl:G,helpUrl:R})})},this.handleOpenHelpUrl=N=>{if((0,m.ve)()){window.open(N,"_blank");return}L.Z.targetTo({path:N,isExternalLink:!0})},this.handleOpenVideo=function(N){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:O.props.t("helpCenter.video");O.setState(z=>({resourcePlayInfo:(0,M.Z)((0,M.Z)({},z.resourcePlayInfo),{},{resourceInfo:{originUrl:N,source:{FD:N,OD:N},contentType:"mp4"}}),previewInfo:(0,M.Z)((0,M.Z)({},z.previewInfo),{},{title:U,visible:!0,onCancel:O.handleCancelPreview})}))},this.handleCancelPreview=()=>{var N=this.state.previewInfo;this.setState({resourcePlayInfo:{mode:"preview",watchType:"video",resourceInfo:{}},previewInfo:(0,M.Z)((0,M.Z)({},N),{},{visible:!1})})},this.state={helpUrl:"",videoUrl:"",resourcePlayInfo:{autoPlay:!0,draggable:!0,mode:"preview",resourceInfo:{},watchType:"video"},previewInfo:{visible:!1,destroyOnClose:!0,title:I.t("helpCenter.video")||"\u89C6\u9891\u6307\u5BFC",onCancel:()=>{}}}}componentDidMount(){this.getHelpContentByMenuKey()}render(){var I=this.state,O=I.helpUrl,N=I.resourcePlayInfo,U=I.previewInfo,z=I.videoUrl,R=this.props.t;return p().createElement("div",{className:k().helpCenter},z&&p().createElement(c.Z,{type:"link",className:k()["video-btn"],style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenVideo(z)},R("helpCenter.video")),O&&p().createElement(c.Z,{type:"link",style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenHelpUrl(O)},R("helpCenter.tutorial")),p().createElement(T.Z,(0,g.Z)({},N,{previewInfo:U})))}}var X=h=>({defaultMenuKey:h.currentRoute.menuKey});J.defaultProps={defaultMenuKey:""};var $=(0,a.$j)(X)((0,S.Z)()(J));function K(h){var I=h.extra,O=localStorage.getItem("dingPersonnel"),N=sessionStorage.getItem("dingPersonnel");return p().createElement(A.Z,null,I,O!=="dingPersonnel"&&N!=="dingPersonnel"&&(0,m.eY)("COMMONEXTRA_HELP_CENTER")&&p().createElement($,null))}var Q=K,q=n(4408);function H(h){var I=(0,x.useState)({helpCenter:(0,m.eY)("HEAD_HELP_CENTER_BUT")}),O=(0,P.Z)(I,1),N=O[0],U=h.pageContainerParams,z=U===void 0?{}:U,R=h.noPadding,G=R===void 0?!1:R,w=h.isPersonal,Y=w===void 0?!1:w,se=h.pageTitle,ee=h.className,re=ee===void 0?"":ee,ue={extra:N.helpCenter?p().createElement(Q,{extra:z.extra}):z.extra},le=(0,M.Z)((0,M.Z)({},z),ue);return p().createElement("div",{className:"page-container-content ".concat(G?"page-container-noPadding":""," ").concat(Y?"page-container-content_personal_background":""," ").concat(re)},se&&p().createElement(q.Z,{title:se}),Y?p().createElement(V.Z,null,h.children):p().createElement(V.Z,le,h.children))}var ne=H},8929:function(ce,W,n){"use strict";n.r(W),n.d(W,{default:function(){return be}});var M=n(57663),P=n(71577),x=n(34792),p=n(48086),V=n(22385),C=n(31097),A=n(57361),g=n(88986),_=n(9754),c=n.n(_),S=n(12924),a=n.n(S),y=n(80991),D=n(91768),v=n(57068),B=n(76651),k=n(49101),L=n(78138),T=n.n(L),m=n(6793),J=n(3407),X=(0,m.me)(),$=J.Z[X].trainingTandards.validation,K={taskName:f=>((0,m.fy)(f)?"":$.nameNull)||((0,m.fy)(f).length>120?$.nameLimit:""),dateRange:f=>{var r;return(!f||!f[0]||!f[1])&&(r=$.rangeNull),r},allStandard:f=>{var r="";return f.taskCredits||f.targetPoints||f.taskLearningtimes||f.taskCretificates||f.selfCretificates||(r=$.allStandardNull),r},checkEmployeeRange:f=>{var r="",t=f.dept,e=f.group,s=f.post,i=f.user,l=f.cluster,o=l===void 0?[]:l,u=f.classes,d=u===void 0?[]:u,E=[...t,...e,...s,...i,...o,...d];return E.length||(r=$.employeeNull),r}},Q=n(63185),q=n(9676),H=n(43859);class ne extends a().Component{constructor(){super(...arguments);this.onConversionChange=r=>{var t=this.props,e=t.onConversionChange,s=t.formik;s.setFieldValue("conversionStandard",r&&r.target.checked),e&&e(r)}}render(){var r=this.props,t=r.conversionStandard,e=r.t;return a().createElement(q.Z,{checked:t,onChange:this.onConversionChange},e("trainingTandards.conversionStandardMsg"))}}var h=(0,D.Z)()((0,H.Z)((0,y.$j)(ne))),I=n(88983),O=n(47933);class N extends a().Component{constructor(){super(...arguments);this.handleChange=r=>{var t=r.target.value,e=this.props,s=e.onStandardTypeChange,i=e.formik;i.setFieldValue("standardType",t),s&&s(t)}}render(){var r=this.props,t=r.standardType,e=r.isPreview,s=e===void 0?!1:e,i=r.radioList;return a().createElement(O.ZP.Group,{onChange:this.handleChange,disabled:s,value:t},i.map(l=>a().createElement(O.ZP,{key:l.value,value:l.value},l.name)))}}var U=(0,D.Z)()((0,H.Z)((0,y.$j)(N))),z=n(49111),R=n(19650),G=n(77883),w=n(21888),Y=n(84874);class se extends a().Component{constructor(){super(...arguments);this.taskCertificateTip=()=>{var r=this.props.t,t=a().createElement("span",{className:"tip-content"},a().createElement(C.Z,{title:r("trainingTandards.taskCertificateTip")},a().createElement("span",{style:{color:"#d9dbe4"}},a().createElement(Y.Z,{iconClass:"icon-icon_attentionx1",size:"14px"}))));return t},this.selfCertificateTip=()=>{var r=this.props.t,t=a().createElement("span",{className:"tip-content"},a().createElement(C.Z,{title:r("trainingTandards.selfCertificateTip")},a().createElement("span",{style:{color:"#d9dbe4"}},a().createElement(Y.Z,{iconClass:"icon-icon_attentionx1",size:"14px"}))));return t},this.handleChangeValue=(r,t)=>{var e=this.props,s=e.onNumberChange,i=e.formik;i.setFieldValue("allStandardVal",(0,g.Z)((0,g.Z)({},i.values.allStandardVal),{},{[t]:r})),s&&s(r,t)}}render(){var r=this.props,t=r.allValues,e=r.t,s=r.spaceSize,i=s===void 0?{}:s;return a().createElement("div",{className:"time-period-standard"},a().createElement(R.Z,{size:i.size3},a().createElement("span",null,a().createElement("span",{className:"period-title ml24 mr0"},e("trainingTandards.targetCredits"),"\uFF1A"),a().createElement(w.Z,{className:"item-gap",min:1,max:99999,step:1,value:t.taskCredits,onChange:l=>this.handleChangeValue(l,"taskCredits")}),a().createElement("span",null,e("common.score"))),a().createElement("span",null,a().createElement("span",{className:"period-title ml17"},e("trainingTandards.targetClassHours"),"\uFF1A"),a().createElement(w.Z,{className:"item-gap",min:1,max:99999,step:1,value:t.taskLearningtimes,onChange:l=>this.handleChangeValue(l,"taskLearningtimes")}),a().createElement("span",null,e("common.minutes")))),a().createElement("br",null),a().createElement(R.Z,{size:i.size3},a().createElement("span",null,a().createElement("span",{className:"period-title ml6"},this.taskCertificateTip(),e("trainingTandards.taskCertificate"),"\uFF1A"),a().createElement(w.Z,{className:"item-gap",min:1,max:99999,step:1,value:t.taskCretificates,onChange:l=>this.handleChangeValue(l,"taskCretificates")}),a().createElement("span",null,e("trainingTandards.cards"))),a().createElement("span",null,a().createElement("span",{className:"period-title"},this.selfCertificateTip(),e("trainingTandards.selfCertificate"),"\uFF1A"),a().createElement(w.Z,{className:"item-gap",min:1,max:99999,step:1,value:t.selfCretificates,onChange:l=>this.handleChangeValue(l,"selfCretificates")}),a().createElement("span",null,e("trainingTandards.cards")))),a().createElement("br",null),a().createElement(R.Z,{size:i.size4},a().createElement("span",null,a().createElement("span",{className:"period-title ml24 mr0"},e("trainingTandards.targetIntegral"),"\uFF1A"),a().createElement(w.Z,{className:"item-gap",min:1,max:99999,step:1,value:t.targetPoints,onChange:l=>this.handleChangeValue(l,"targetPoints")}),a().createElement("span",null,e("common.score")))))}}var ee=(0,D.Z)()((0,H.Z)((0,y.$j)(se))),re=n(96486),ue=n(71194),le=n(57016);class pe extends a().PureComponent{constructor(r){super(r);this.onRemoveClick=()=>{var t=this.props,e=t.customize,s=t.t;le.Z.confirm({title:s("trainingTandards.deleteTitle"),content:s("trainingTandards.deleteContent"),okText:s("common.ok"),cancelText:s("common.cancel"),onOk:()=>{this.props.onCustomizeRemove(e)}})},this.onEditClick=()=>{var t=this.props.customize;this.props.onCustomizeEdit(t)},this.state={}}render(){var r=this.props.t;return a().createElement("div",{className:"cl-table__cell-action"},a().createElement("span",{className:"cl-pointer",onClick:this.onEditClick},r("common.edit")),a().createElement("span",{className:"cl-pointer",onClick:this.onRemoveClick},r("common.delete")))}}pe.defaultProps={customize:{}};var ge=(0,D.Z)()(pe),he=n(36202);class fe extends a().Component{constructor(){super(...arguments);this.getTableColumn=()=>{var r=[{title:this.props.t("trainingTandards.customizeName"),dataIndex:"customizeName",key:"customizeName",width:150,render:(t,e)=>{var s=e.customizeName;return a().createElement("div",{className:"cl-text-ellipsis",style:{width:150}},a().createElement(C.Z,{placement:"top",title:s||"--"},s||"--"))}},{title:this.props.t("trainingTandards.targetCredits"),dataIndex:"taskCredits",key:"taskCredits",width:90,render:(t,e)=>{var s=e.taskCredits;return s||"--"}},{title:this.props.t("trainingTandards.targetClassHours"),dataIndex:"taskLearningtimes",key:"taskLearningtimes",width:90,render:(t,e)=>{var s=e.taskLearningtimes;return s||"--"}},{title:this.props.t("trainingTandards.taskCertificate"),dataIndex:"taskCretificates",key:"taskCretificates",width:90,render:(t,e)=>{var s=e.taskCretificates;return s||"--"}},{title:this.props.t("trainingTandards.selfCertificate"),dataIndex:"selfCretificates",key:"selfCretificates",width:90,render:(t,e)=>{var s=e.selfCretificates;return s||"--"}},{title:this.props.t("trainee.points"),dataIndex:"targetPoints",key:"targetPoints",width:90,render:(t,e)=>{var s=e.targetPoints;return s||"--"}},{title:this.props.t("common.operate"),key:"operate",width:130,render:(t,e)=>a().createElement(ge,{customize:e,onCustomizeRemove:this.props.onCustomizeRemove,onCustomizeEdit:this.props.onCustomizeEdit})}];return r}}render(){var r=this.props,t=r.isLoading,e=r.taskList,s=this.getTableColumn();return a().createElement(he.f,{loading:t,dataSource:(0,re.cloneDeep)(e),columns:s,rowKey:i=>i.id,pagination:!0,tableUUID:"fc93d836-485c-4c26-b05d-0bea2b6abfc5"})}}var Z=(0,D.Z)()(fe),j=n(62029),oe=n(28216),ve=n(88311),b=n(8908),te=f=>{var r=f.advancedSetting;return{themeColor:r.themeColor}},ie=()=>{};class me extends a().Component{constructor(){var r;super(...arguments);r=this,this.state={orgProps:{},orgVisible:!1,importVisible:!1},this.handleImportOk=t=>{var e=this.props.rangeList,s=e.user,i=s===void 0?[]:s,l=[...t,...i],o=(0,re.uniqBy)(l,"id"),u=this.props.formik;u.setFieldValue("rangeListField",(0,g.Z)((0,g.Z)({},u.values.rangeListField),{},{user:o})),this.importModalVisibility(!1)},this.handleImportCancel=()=>{this.importModalVisibility(!1)},this.handleOrgOk=t=>{this.setRangeList(t)},this.setRangeList=t=>{var e=t.dept,s=t.group,i=t.post,l=t.user,o=t.classes,u=t.cluster,d=this.props.formik;d.setFieldValue("rangeListField",(0,g.Z)((0,g.Z)({},d.values.rangeListField),{},{dept:e,post:i,group:s,user:l,classes:o,cluster:u})),this.setState({orgVisible:!1})},this.importModalVisibility=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ie;r.setState({importVisible:t},()=>{e()})},this.setOrgModalVisibility=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ie;r.setState({orgVisible:t},()=>{e()})},this.handleOrgCancel=()=>{this.setOrgModalVisibility(!1)},this.handleChangeEmployeeRange=()=>{},this.handleDeleteItem=t=>{var e=(0,g.Z)({},this.props.rangeList),s,i;for(var l in e)if(s=e[l].findIndex(d=>d.id===t),s>-1){i=l;break}var o=[...e[i]];o.splice(s,1),e[i]=o;var u=this.props.formik;u.setFieldValue("rangeListField",e)},this.renderGallery=()=>{var t=this.props.prefixCls;return a().createElement("div",{className:"".concat(t,"__gallery")},this.renderGropuGallery(),this.renderUserGallery())},this.renderGropuGallery=()=>{var t=this.props,e=t.prefixCls,s=t.t,i=this.props.rangeList,l=i.dept,o=i.group,u=i.post,d=i.cluster,E=d===void 0?[]:d,F=i.classes,ae=F===void 0?[]:F,de=[...l,...o,...u,...ae,...E];return de.length?a().createElement(a().Fragment,null,a().createElement("div",{className:"".concat(e,"__gallery__row cl-clearfix content-wrapper")},a().createElement("span",{className:"".concat(e,"__gallery__row__title")},s("common.selectedGroups"),"\uFF1A"),a().createElement("div",{className:"".concat(e,"__gallery__row__container cl-clearfix scroll-style")},de.map(Ee=>this.renderGalleryItem(Ee))))):null},this.renderUserGallery=()=>{var t=this.props,e=t.prefixCls,s=t.t,i=this.props.rangeList.user,l=[...i];return l.length?a().createElement("div",{className:"".concat(e,"__gallery__row cl-clearfix content-wrapper")},a().createElement("span",{className:"".concat(e,"__gallery__row__title")},s("common.selectedClients"),"\uFF1A"),a().createElement("div",{className:"".concat(e,"__gallery__row__container cl-clearfix scroll-style")},l.map(o=>this.renderGalleryItem(o)))):null},this.renderGalleryItem=t=>{var e=this.props,s=e.prefixCls,i=e.disabled,l="".concat(s,"__gallery__row__item");return a().createElement("span",{className:l,key:t.id},a().createElement("div",{style:{display:"inline-block"}},t.name),i?null:a().createElement("span",{onClick:()=>this.handleDeleteItem(t.id)},a().createElement(Y.Z,{iconClass:"icon-guanbi",size:"12px"})))}}render(){var r=this.props,t=r.t,e=r.onlyDept,s=e===void 0?!1:e,i=r.onlyPost,l=i===void 0?!1:i,o=r.themeColor,u=r.rangeList,d=this.state,E=d.orgProps,F=d.orgVisible,ae=d.importVisible;return a().createElement("div",null,a().createElement("div",{className:"add-staff-select"},a().createElement(R.Z,null,a().createElement(P.Z,{className:"qa-assign-employee-selector",style:{color:o,border:"1px solid ".concat(o)},icon:a().createElement(k.Z,null),onClick:()=>this.importModalVisibility(!0)},t("component.importPerson")),a().createElement(P.Z,{style:{color:o,border:"1px solid ".concat(o)},className:"qa-assign-employee-selector",icon:a().createElement(k.Z,null),onClick:()=>this.setOrgModalVisibility(!0)},t("common.select"))),this.renderGallery()),a().createElement(ve.Z,(0,j.Z)({},E,{visible:F,initData:u,displayType:["dept","group","post"],filterAuthOpen:!0,onlyDept:s,onlyPost:l,onOk:this.handleOrgOk,onCancel:this.handleOrgCancel})),a().createElement(b.Z,{visible:ae,onOk:this.handleImportOk,onCancel:this.handleImportCancel}))}}me.defaultProps={prefixCls:"customize-opt-modal"};var ye=(0,oe.$j)(te)((0,D.Z)()((0,H.Z)((0,y.$j)(me))));class Pe extends a().Component{constructor(){super(...arguments);this.state={customizeModalValues:{customizeValues:{rangeListField:{user:[],dept:[],post:[],group:[],classes:[],cluster:[]},allStandardVal:{taskCredits:"",selfCredits:"",targetPoints:"",taskLearningtimes:"",selfLearningtimes:"",taskCretificates:"",selfCretificates:""}}}},this.onModalCancelClick=()=>{var r=this.props.onCustomCancelClick;r&&r()},this.onCustomSubmit=r=>{var t=this.props.onCustomOkClick,e=this.state.customizeModalValues;t&&t((0,g.Z)((0,g.Z)({},e),{},{customizeValues:(0,g.Z)({},r)}))},this.onModalOkClick=()=>{this.initRef.submitForm()},this.getTitle=()=>{var r=this.props,t=r.t,e=r.optFlag;return t(e==="edit"?"trainingTandards.editCustomizeTitle":"trainingTandards.addStandardBtn")}}componentDidMount(){}componentDidUpdate(r){var t=this.props.customizeModalValues;if(t!==r.customizeModalValues){var e=t.customizeName,s=t.orderNum,i=t.selfCredits,l=t.selfCretificates,o=t.selfLearningtimes,u=t.targetPoints,d=t.taskCredits,E=t.taskCretificates,F=t.taskLearningtimes,ae=t.customizeValues,de=ae.allStandardVal,Ee=ae.rangeListField,_e={customizeValues:{allStandardVal:(0,g.Z)({},de),rangeListField:(0,g.Z)({},Ee)},customizeName:e,orderNum:s,selfCredits:i,selfCretificates:l,selfLearningtimes:o,targetPoints:u,taskCredits:d,taskCretificates:E,taskLearningtimes:F};this.setState({customizeModalValues:(0,g.Z)({},_e)})}}render(){var r=this.props,t=r.t,e=r.visible,s=this.state.customizeModalValues;return a().createElement("div",{className:"customize-opt-main"},a().createElement(le.Z,{destroyOnClose:!0,title:this.getTitle(),visible:e,className:"customize-opt-modal",width:760,onOk:this.onModalOkClick,onCancel:this.onModalCancelClick},a().createElement(y.J9,{ref:i=>{this.initRef=i},initialValues:s.customizeValues,onSubmit:this.onCustomSubmit,render:i=>a().createElement(y.l0,{className:"cl-form"},a().createElement("div",{className:"add-staff-title"},t("trainingTandards.addStaffTitle")),a().createElement(y.gN,{name:"rangeListField",component:ye,required:!0,displayType:"Custom",label:t("authScope.chooseUser"),rangeList:i.values.rangeListField,validate:K.checkEmployeeRange}),a().createElement("div",{className:"all-standard"},a().createElement("div",{className:"all-standard-title"}," ",t("trainingTandards.timePeriodTile")),a().createElement(y.gN,{name:"allStandardVal",label:"",component:ee,spaceSize:{size1:196,size2:200,size3:214,size4:214},allValues:i.values.allStandardVal,validate:l=>K.allStandard(l)})))})))}}var Le=(0,D.Z)()(Pe),ke=n(14965),Se=n(11448),Oe=Se.Z.RangePicker;class Ne extends a().Component{constructor(){super(...arguments);this.state={},this.onPickerChange=(r,t)=>{var e=this.props,s=e.formik,i=e.onMonthPickerChange;s.setFieldValue("dateRange",[T()(t[0]),T()(t[1])]),i(r,t)},this.disabledCurrentDay=r=>r&&r<=T()().subtract(1,"month").valueOf()}componentDidMount(){}componentDidUpdate(){}render(){var r=this.props.date,t=[T()(r[0]).isValid()?r[0]:null,T()(r[1]).isValid()?r[1]:null];return a().createElement(Oe,{picker:"month",value:t,defaultValue:[null,null],disabledDate:this.disabledCurrentDay,onChange:this.onPickerChange})}}var Ze=(0,D.Z)()((0,H.Z)((0,y.$j)(Ne))),Ce=n(29879),Me=n(7584),Ie=n(11449),Te=n(37055);class De extends a().Component{constructor(){var r;super(...arguments);r=this,this.state={editId:"",isSubmitting:!1,dataList:[],customListLoading:!1,customizeOptVisible:!1,optFlag:"add",customizeModalValues:{customizeValues:{rangeListField:{user:[],dept:[],post:[],group:[],classes:[],cluster:[]},allStandardVal:{taskCredits:"",selfCredits:"",targetPoints:"",taskLearningtimes:"",selfLearningtimes:"",taskCretificates:"",selfCretificates:""}}},initialValues:{title:"",dateRange:[null,null],conversionStandard:!1,standardType:"allstandard",radioList:[{name:this.props.t("trainingTandards.forAllStaff"),value:"allstandard"},{name:this.props.t("trainingTandards.customizeStaff"),value:"customize"}],allStandardVal:{taskCredits:"",selfCredits:"",taskLearningtimes:"",selfLearningtimes:"",taskCretificates:"",selfCretificates:"",targetPoints:""},coverNewStaff:!0}},this.onPublishClick=()=>{this.initRef.submitForm()},this.onCustomOkClick=t=>{var e=t.customizeValues,s=this.state.optFlag,i=t.id,l=t.orderNum;if(s==="edit"||i||l)this.editTableList(e,i,l);else{var o=this.state.dataList;o.unshift(this.resetCustomToTableList(e,o.length+1)),o.map((u,d)=>(u.orderNum=d+1,u)),this.setState({dataList:o},()=>{})}this.optCustomModal(!1)},this.onCustomCancelClick=()=>{this.optCustomModal(!1)},this.onCustomizeEdit=t=>{this.setState({customizeModalValues:(0,g.Z)({},t)}),this.optCustomModal(!0,"edit")},this.onCustomizeRemove=t=>{var e=this.state.dataList;e.splice(t.orderNum-1,1),e.map((s,i)=>(s.orderNum=i+1,s)),this.setState({dataList:e},()=>{})},this.onAddCustomizeClick=()=>{this.cleanCustomModal(()=>{this.optCustomModal(!0,"add")})},this.onTaskNameChange=()=>{},this.onDateRangeChange=()=>{},this.onConversionChange=()=>{},this.onStandardTypeChange=()=>{},this.onNewStaffChange=()=>{},this.onAllNumberChange=()=>{},this.clearDateRange=()=>{},this.stringSplitToArray=(t,e)=>{for(var s=t&&t.split(",")||[],i=e&&e.split(",")||[],l=[],o=0;o<s.length;o++)l.push({id:s[o],name:i[o]});return l},this.dataListInitMapping=t=>t&&t.length?t.map(e=>{var s=e.user_names,i=e.department_names,l=e.post_names,o=e.user_group_names,u=[];return s&&u.push(s),i&&u.push(i),l&&u.push(l),o&&u.push(o),e.customizeValues={rangeListField:{user:e.user||this.stringSplitToArray(e.user_ids,s),dept:e.dept||this.stringSplitToArray(e.department_ids,i),post:e.post||this.stringSplitToArray(e.post_ids,l),group:e.group||this.stringSplitToArray(e.user_group_ids,o)},allStandardVal:{taskCredits:e.task_credits||"",selfCredits:e.self_credits||"",targetPoints:e.target_points||"",taskLearningtimes:e.task_learningtimes||"",selfLearningtimes:e.self_learningtimes||"",taskCretificates:e.task_cretificates||"",selfCretificates:e.self_cretificates||""}},e.customizeName=u.length?u.join(","):"",e.orderNum=e.order_num,e.taskCredits=e.task_credits,e.selfCredits=e.self_credits,e.targetPoints=e.target_points,e.taskLearningtimes=e.task_learningtimes,e.selfLearningtimes=e.self_learningtimes,e.taskCretificates=e.task_cretificates,e.selfCretificates=e.self_cretificates,e}):[],this.setEditData=t=>{var e=t.name,s=t.effect_date,i=t.lapse_date,l=t.list,o=t.is_all_standards,u=t.contain_new_staff,d=t.is_convert,E=o==="allstandard"&&l.length?{id:l[0].id||"",taskCredits:l[0].task_credits||"",selfCredits:l[0].self_credits||"",taskLearningtimes:l[0].task_learningtimes||"",selfLearningtimes:l[0].self_learningtimes||"",taskCretificates:l[0].task_cretificates||"",selfCretificates:l[0].self_cretificates||"",targetPoints:l[0].target_points||""}:{id:"",taskCredits:"",selfCredits:"",taskLearningtimes:"",selfLearningtimes:"",taskCretificates:"",selfCretificates:"",targetPoints:""},F=o==="allstandard"?[]:this.dataListInitMapping(l),ae={title:e,dateRange:[T()(s),T()(i)],conversionStandard:Boolean(d==="convert"),standardType:o,radioList:[{name:this.props.t("trainingTandards.forAllStaff"),value:"allstandard"},{name:this.props.t("trainingTandards.customizeStaff"),value:"customize"}],allStandardVal:E,coverNewStaff:Boolean(u==="contain")};this.setState({dataList:F,customizeOptVisible:!1,optFlag:"edit",customizeModalValues:{customizeValues:{rangeListField:{user:[],dept:[],post:[],group:[],classes:[],cluster:[]},allStandardVal:{taskCredits:"",selfCredits:"",targetPoints:"",taskLearningtimes:"",selfLearningtimes:"",taskCretificates:"",selfCretificates:""}}}}),this.initRef.setValues(ae)},this.getStandardsData=(0,A.Z)(c().mark(function t(){var e,s,i;return c().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(e=r.state.editId,!e){o.next=7;break}return o.next=4,(0,Ce.pT)(e);case 4:s=o.sent,i=s.data,i&&r.setEditData(i);case 7:case"end":return o.stop()}},t)})),this.initData=()=>{var t=v.parse(B.m8.location.search),e=t.id;this.setState({editId:e},()=>{this.getStandardsData()})},this.getStandardsTitle=()=>{var t=this.state.editId,e=this.props.t,s="";return t?s=e("trainingTandards.editStandardsTitle"):s=e("trainingTandards.addStandardsTitle"),s},this.cleanCustomModal=t=>{this.setState({customizeModalValues:{customizeValues:{rangeListField:{user:[],dept:[],post:[],group:[],classes:[],cluster:[]},allStandardVal:{taskCredits:"",selfCredits:"",targetPoints:"",taskLearningtimes:"",selfLearningtimes:"",taskCretificates:"",selfCretificates:""}}}},()=>{t()})},this.optCustomModal=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"add";r.setState({customizeOptVisible:t,optFlag:e})},this.getElementOrgName=t=>{var e=t.dept,s=t.group,i=t.post,l=t.user,o=t.cluster,u=o===void 0?[]:o,d=t.classes,E=d===void 0?[]:d,F=[...e,...s,...i,...l,...u,...E],ae=F.map(de=>de.name);return ae},this.resetCustomToTableList=(t,e)=>(0,g.Z)((0,g.Z)({customizeName:this.getElementOrgName(t.rangeListField).join(",")},t.allStandardVal),{},{orderNum:e,customizeValues:t}),this.editTableList=(t,e,s)=>{var i=t.rangeListField,l=this.state.dataList;if(s){var o=s-1;l.splice(o,1,(0,g.Z)((0,g.Z)((0,g.Z)({},l[o]),{},{customizeName:this.getElementOrgName(i).join(",")},t.allStandardVal),{},{orderNum:s,customizeValues:t}))}else if(e){for(var u=0,d={},E=0;E<l.length;E++){var F=l[E];F.id===e&&(u=E,d=F)}l.splice(u,1,(0,g.Z)((0,g.Z)((0,g.Z)({},d),{},{customizeName:this.getElementOrgName(i).join(",")},t.allStandardVal),{},{orderNum:s,customizeValues:t}))}this.setState({dataList:l},()=>{})},this.getLabelRender=(t,e)=>{var s=a().createElement("span",null,t,a().createElement(C.Z,{title:e},a().createElement("span",{style:{color:"#d9dbe4"}},a().createElement(Y.Z,{iconClass:"icon-icon_attentionx1",size:"14px"}))));return s},this.getSubmitDataList=()=>{var t=this.state.dataList;return t.length?t.map(e=>{var s=e.customizeValues.rangeListField,i=s.dept,l=s.group,o=s.post,u=s.user;return e.id=e.id||"",e.user=u,e.group=l,e.post=o,e.dept=i,e.user_names=u.map(d=>d.name).join(","),e.department_names=i.map(d=>d.name).join(","),e.post_names=o.map(d=>d.name).join(","),e.user_group_names=l.map(d=>d.name).join(","),e.user_ids=u.map(d=>d.id).join(","),e.department_ids=i.map(d=>d.id).join(","),e.post_ids=o.map(d=>d.id).join(","),e.user_group_ids=l.map(d=>d.id).join(","),e.order_num=e.orderNum,e.task_credits=e.taskCredits,e.self_credits=e.selfCredits,e.target_points=e.targetPoints,e.task_learningtimes=e.taskLearningtimes,e.self_learningtimes=e.selfLearningtimes,e.task_cretificates=e.taskCretificates,e.self_cretificates=e.selfCretificates,e}):[]},this.resetList=(t,e)=>t==="customize"?this.getSubmitDataList():[{id:e.id||"",order_num:e.orderNum,task_credits:e.taskCredits,self_credits:e.selfCredits,target_points:e.targetPoints,task_learningtimes:e.taskLearningtimes,self_learningtimes:e.selfLearningtimes,task_cretificates:e.taskCretificates,self_cretificates:e.selfCretificates}],this.submitParamMapping=t=>{var e=this.state.editId,s=t.title,i=t.dateRange,l=t.conversionStandard,o=t.standardType,u=t.allStandardVal,d=this.resetList(o,u),E={id:e,name:s,effect_date:i.length?T()(i[0]).format(Te.XE.INITIAL_DATE_FMT.MONTH):"",lapse_date:i.length?T()(i[1]).format(Te.XE.INITIAL_DATE_FMT.MONTH):"",contain_new_staff:"contain",is_convert:l?"convert":"notconvert",is_all_standards:o,list:d};return E},this.goListPage=()=>{B.m8.push("/enterprise/trainingSettings/trainingTandards")},this.optServiceAfter=t=>{var e=this.state.editId,s=this.props.t;t.data.code===200||t.data.code===0?(p.default.success(s(e?"common.editSuccess":"common.addSuccess")),this.goListPage()):Number(t.data.code)===9&&p.default.error(s("trainingTandards.validation.nameIsEqual")),this.setState({isSubmitting:!1})},this.optStandardService=t=>{var e=this.state.editId,s=this.props.t,i=this.submitParamMapping(t);if(i.is_all_standards==="customize"&&(!i.list||!i.list.length)){p.default.error(s("trainingTandards.validation.allStandardNull"));return}this.setState({isSubmitting:!0}),e?(0,Ce.Je)(e,i).then(l=>{this.optServiceAfter(l)}).catch(()=>{p.default.error(s("common.saveFailure")),this.setState({isSubmitting:!1})}):(0,Ce.Cs)(i).then(l=>{this.optServiceAfter(l)}).catch(()=>{p.default.error(s("common.editFailure")),this.setState({isSubmitting:!1})})},this.handleFormikSubmit=t=>{this.optStandardService(t)},this.handleCancelEdit=(0,A.Z)(c().mark(function t(){return c().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:r.goListPage();case 1:case"end":return s.stop()}},t)}))}componentDidMount(){this.initData()}render(){var r=this.state,t=r.isSubmitting,e=r.initialValues,s=r.dataList,i=r.customListLoading,l=r.customizeModalValues,o=r.customizeOptVisible,u=r.optFlag,d=this.props.t;return a().createElement(Ie.Z,{pageContainerParams:{header:{title:this.getStandardsTitle()}}},a().createElement("div",{className:"training-opt-main"},a().createElement("div",{className:"training-opt-main__content"},a().createElement(y.J9,{ref:E=>{this.initRef=E},initialValues:e,onSubmit:this.handleFormikSubmit,render:E=>a().createElement("div",{className:"cl-form"},a().createElement("div",{className:"cl-form__sectitle"},d("learning.basicInformation")),a().createElement(y.gN,{name:"title",label:d("trainingTandards.taskNameTitle"),component:Me.Z,required:!0,defaultValue:E.values.title,style:{width:"530px"},maxLength:120,validate:K.taskName,placeholder:d("trainingTandards.taskNameHolder"),type:"text"}),a().createElement(y.gN,{name:"dateRange",label:d("certificateManage.effect"),component:Ze,required:!0,date:E.values.dateRange,validate:F=>K.dateRange(F),onMonthPickerChange:this.onDateRangeChange,clearDateRange:this.clearDateRange}),a().createElement("div",{className:"cl-form__sectitle"},d("trainingTandards.standardSettings")),a().createElement(y.gN,{name:"conversionStandard",label:this.getLabelRender(d("trainingTandards.conversionStandard"),d("trainingTandards.conversionStandardTitle")),component:h,conversionStandard:E.values.conversionStandard,onConversionChange:this.onConversionChange}),a().createElement("div",{className:"standard-type"},a().createElement(y.gN,{name:"standardType",label:this.getLabelRender(d("trainingTandards.standardType"),d("trainingTandards.standardTypeMsg")),style:{marginLeft:"10px"},component:U,radioList:E.values.radioList,standardType:E.values.standardType,onStandardTypeChange:this.onStandardTypeChange})),E.values.standardType==="allstandard"&&a().createElement("div",{className:"all-standard"},a().createElement("div",{className:"all-standard-title"}," ",d("trainingTandards.timePeriodTile")),a().createElement(y.gN,{name:"allStandardVal",label:"",component:ee,spaceSize:{size1:196,size2:200,size3:214,size4:214},allValues:E.values.allStandardVal,validate:F=>K.allStandard(F),onNumberChange:this.onAllNumberChange})),E.values.standardType==="customize"&&a().createElement("div",{className:"customize-standard"},a().createElement(P.Z,{icon:a().createElement(k.Z,null),onClick:this.onAddCustomizeClick},d("trainingTandards.addStandardBtn")),a().createElement("div",{className:"customize-msg"},d("trainingTandards.customizeTableMsg")),a().createElement(Z,{taskList:s,isLoading:i,onCustomizeRemove:this.onCustomizeRemove,onCustomizeEdit:this.onCustomizeEdit}),a().createElement(Le,{visible:o,customizeModalValues:l,optFlag:u,onCustomCancelClick:this.onCustomCancelClick,onCustomOkClick:this.onCustomOkClick})),a().createElement("div",{className:"cl-form-footer"},a().createElement("div",{className:"cl-form-footer__container"},a().createElement(P.Z,{className:"form-page-container-bottom-btn cancel-btn",onClick:this.handleCancelEdit},d("common.cancel")),a().createElement(P.Z,{className:"form-page-container-bottom-btn",loading:t,onClick:this.onPublishClick,type:"primary"},d("common.release")))))}))))}}var be=(0,D.Z)()(De)},29879:function(ce,W,n){"use strict";n.d(W,{vP:function(){return p},Gg:function(){return V},de:function(){return C},Cs:function(){return A},Je:function(){return g},pT:function(){return _}});var M=n(88986),P=n(37055),x=n(10237);function p(c){var S=c.effectDate,a=c.lapseDate,y=c.pageSize,D=c.pageNumber,v=c.onlySeeMe,B=P.ZP.trainingTandards.getTrainingTandardsList(),k={enterpriseId:P.ZP.enterpriseId,effectDate:S,lapseDate:a,pageSize:y,pageNumber:D,onlySeeMe:v};return x.WY.get({url:B,params:k})}function V(c){var S=P.ZP.trainingTandards.removeTrainingTandards(c);return x.WY.get({url:S})}function C(c){var S=c.id,a=c.keyword,y=c.pageSize,D=c.pageNumber,v=c.queryRow,B=P.ZP.trainingTandards.getTrainingTandardsDetail(S),k=(0,M.Z)((0,M.Z)({enterpriseId:P.ZP.enterpriseId,objectiveId:S,keyword:a},v),{},{pageSize:y,pageNumber:D});return x.WY.get({url:B,params:k})}function A(c){var S=P.ZP.trainingTandards.addTrainingTandards();return x.WY.post({url:S,data:c})}function g(c,S){var a=P.ZP.trainingTandards.editTrainingTandards(c);return x.WY.post({url:a,data:S})}function _(c){var S=P.ZP.trainingTandards.getTrainingTandards(c),a={enterpriseId:P.ZP.enterpriseId,objectiveId:c};return x.WY.get({url:S,params:a})}}}]);
