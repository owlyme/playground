(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[4282],{53009:function(se,X,u){"use strict";u.d(X,{TD:function(){return J},$S:function(){return W},aI:function(){return y},Bg:function(){return E},tT:function(){return k},XN:function(){return w},YK:function(){return M},$x:function(){return A}});var U=u(81211),d=u(88986),K=u(78138),f=u.n(K),F=u(78001),j=u(76651),T=u(38642),H=u(6793),v=u(37055),O=u(75205);function Z(i){return i.map(l=>({name:l.name,id:l.id,proportion:0,disabled:l.totalCount===0||l.total_count===0}))}function Y(i,l){return l.map((p,c)=>(0,d.Z)((0,d.Z)({},i[c]),{},{disabled:p.total_count===0}))}var D=i=>{var l=0,p=i.checkedValue,c=i.fillBlank,_=i.shortAnswer;return p===2?c.checked&&!_.checked?l=3:!c.checked&&_.checked?l=4:l=2:l=1,l},x=i=>{for(var l in i)i[(0,T.FI)(l)]=i[l];return i},J=(i,l,p,c,_,o)=>{var e=i.map((t,g)=>{var h=t.list.map((n,a)=>{var r,s=n.data,m={};switch(n.componentName){case"CoursewareSelector":m={courseId:n.id,courseSort:a,courseType:3,flag:1,mappingId:n.mappingId?n.mappingId:""};break;case"CourseSelector":m={courseId:n.id,courseSort:a,courseType:1,flag:1,mappingId:n.mappingId?n.mappingId:""};break;case"AddExam":m={courseSort:a,title:s.title,type:"ex",cheatFlag:s.cheatFlag.isChecked?1:0,faceRecognition:s.cheatFlag.faceRecognition,examDuration:s.examDuration,summary:s.summary,flag:2,mappingId:n.mappingId?n.mappingId:"",courseId:n.id,markType:D(s.markType),paperId:s.questionsMode===1?s.fixedQuestion.id:"",paperTitle:s.questionsMode===1?s.fixedQuestion.name:"",passLine:s.passLine,questionBankList:s.questionsMode===1?"":s.randomQuestion.bankQuesitonVoList.map(B=>B.id).join(","),questionMode:s.questionsMode,showKnowledge:s.knowledgePoints===1?"show":"hide",repeatExam:s.reExam.isChecked,multipleCount:s.questionsMode===1?"":s.randomQuestion.bankQuesitonInfo.multipleCount,multipleUnitScore:s.questionsMode===1?"":s.randomQuestion.bankQuesitonInfo.multipleScore,fillBlankCount:s.questionsMode===1?"":s.randomQuestion.bankQuesitonInfo.fillBlankCount,fillBlankUnitScore:s.questionsMode===1?"":s.randomQuestion.bankQuesitonInfo.fillBlankScore,fillBlankType:s.questionsMode===1?1:s.randomQuestion.bankQuesitonInfo.fillBlankType,shortAnswerCount:s.questionsMode===1?"":s.randomQuestion.bankQuesitonInfo.shortAnswerCount,shortAnswerUnitScore:s.questionsMode===1?"":s.randomQuestion.bankQuesitonInfo.shortAnswerScore,shortAnswerType:s.questionsMode===1?1:s.randomQuestion.bankQuesitonInfo.shortAnswerType,singleCount:s.questionsMode===1?"":s.randomQuestion.bankQuesitonInfo.singleCount,singleUnitScore:s.questionsMode===1?"":s.randomQuestion.bankQuesitonInfo.singleScore,trueOrFalseCount:s.questionsMode===1?"":s.randomQuestion.bankQuesitonInfo.trueOrFalseCount,trueOrFalseUnitScore:s.questionsMode===1?"":s.randomQuestion.bankQuesitonInfo.trueOrFalseScore,multipleMissedScore:s.questionsMode===1?"":s.randomQuestion.bankQuesitonInfo.multipleMissedScore,totalScore:s.questionsMode===1?s.fixedQuestion.tableList.totalScore:"",answerParsing:s.reExam.isChecked?s.reExam.allowed.end:s.reExam.notAllowed.end,passingScore:s.questionsMode===1?Number(s.fixedQuestion.tableList.totalScore*s.passLine/100).toFixed(1):60,cutScreenCount:s.cheatFlag.switchNum!==null?s.cheatFlag.switchNum:-1,reExamRule:s.reExam.allowed.reRule,reExamNumber:s.reExam.allowed.reRule===2?s.reExam.allowed.reNum:0,scoreRule:s.reExam.allowed.record,viewRule:s.reExam.allowed.viewRule,proportional:s.questionsMode===2&&s.isOpenDrawQuestions?s.proportional:[],anonymousMarking:"".concat(s.markType.anonymousMarking),show_result:s.reExam.show_result};break;case"AddNewExam":var b=n.data,C=b.paperInfo,I=b.exam_times,$=b.cut_screen_times,q=b.random_order,Q=b.mark_setting,G=b.result_visible,ne=b.face_recognition,ae=(0,U.Z)(b,["paperInfo","exam_times","cut_screen_times","random_order","mark_setting","result_visible","face_recognition"]);m={courseSort:a,flag:15,courseType:15,type:"ex",courseId:n.id,mappingId:n.mappingId?n.mappingId:"",new_exam:(0,d.Z)((0,d.Z)((0,d.Z)({},ae),(0,O.jJ)(ne)),{},{paper_id:C.id,answer_rule:I.answer_rule,exam_count:I.exam_count||1,cut_screen_rule:$.cut_screen_rule,cut_screen_count:$.cut_screen_count||1,cut_screen_interval:$.cut_screen_interval||0,random_question:q.random_question,random_options:q.random_options,mark_type:Q.mark_type,mark_question_type:{fill_blank:Q.mark_type===O.lt.MANUAL?Q.fill_blank:!1,short_answer:Q.mark_type===O.lt.MANUAL?Q.short_answer:!1},anonymous_marking:Q.anonymous_marking,exam_certificate_id:"",supervisor_list:[],marker_list:[...Q.marker_list.map(B=>typeof B=="string"?B:B.id)],result_view_rule:G.result_view_rule,answer_parsing:G.answer_parsing,ranking_list_view_rule:G.ranking_list_view_rule,show_result:G.show_result,reward_rule:null,authority_range:null,supervisor_mark:null})};break;case"OfflineTrain":m={courseSort:a,flag:3,id:l&&!_?n.id:"",type:"xx",mappingId:n.mappingId?n.mappingId:"",title:s.title,begin_time:f()(s.dateRange.startTime).valueOf(),end_time:f()(s.dateRange.endTime).valueOf(),attachment:s.attachment.map(B=>B.id),course_duration:s.course_duration||"",lecturer_id:s.teacher.id,is_lecturer_confirm:!!s.teacher.is_lecturer_confirm,is_lecturer_subsidy:!!s.teacher.is_lecturer_subsidy,address:s.address,introduction:s.introduction,is_open_offline_assessment:s.assess.is_open_offline_assessment,is_open_upload:s.other.is_open_upload,is_open_schedule:!1,remind_type:s.remind.remind_type,advance_minute:s.remind.advance_minute?Number(s.remind.advance_minute):0,is_lecturer_remind:s.remind.is_lecturer_remind,is_student_remind:s.remind.is_student_remind,is_lecturer_student_evaluate:s.evaluate.is_lecturer_student_evaluate,is_student_lecturer_evaluate:s.evaluate.is_student_lecturer_evaluate,is_student_course_evaluate:s.evaluate.is_student_course_evaluate,lecturer_student_evaluate_content:s.evaluate.lecturer_student_evaluate_content,student_lecturer_evaluate_content:s.evaluate.student_lecturer_evaluate_content,student_course_evaluate_content:s.evaluate.student_course_evaluate_content,assessment_total_score:s.assess.assessment_total_score,assessment_pass_score:s.assess.assessment_pass_score};break;case"AddInvestigate":p==="study"?m={courseSort:a,courseType:9,flag:4,id:n.id,questionnaireId:n.questionnaire.id,title:n.name,type:"questionnaire",mappingId:n.mappingId?n.mappingId:""}:m={courseId:n.id,courseType:9,flag:9,courseSort:a,investigate:{id:n.id,title:n.name,questionnaire_id:n.questionnaire.id}};break;case"AddPracticeTest":m={courseType:10,courseSort:a,flag:p==="study"?5:4,type:"sc",id:n.id,title:n.data.title,content:n.data.content||n.data.address,resources:n.data.attachment.map(B=>({resourceId:B.id})),scoreSetting:{scoreSwitch:n.data.mark.isFull?"on":"off",score:n.data.mark.value},workflowJson:n.data.workFlowTemplateId?{}:V(n.data.supervisor),mappingId:n.mappingId?n.mappingId:"",job_type:n.data.job_type,workFlowTemplateId:n.data.workFlowTemplateId};break;case"AddJobEvaluation":m={courseSort:a,flag:6,title:n.data.title,productId:n.data.evaluationTools.product_id,modelId:n.data.evaluationTools.model_id,id:n.id||"",mappingId:n.mappingId?n.mappingId:""};break;case"Attendance":m={courseSort:a,flag:13,id:l&&!_?n.id:"",type:"attendance",mappingId:n.mappingId?n.mappingId:"",title:s.title,directors:s.directors.map(B=>typeof B=="object"&&(B.id||B.user_id)?B.id||B.user_id:B),name:s.name,qrcode_type:s.qrcode_type||"statics",sign_in_begin_time:s.sign_in_begin_time?f()(s.sign_in_begin_time).valueOf():"",sign_in_end_time:s.sign_in_end_time?f()(s.sign_in_end_time).valueOf():"",sign_out_begin_time:s.sign_out_begin_time?f()(s.sign_out_begin_time).valueOf():"",sign_out_end_time:s.sign_out_end_time?f()(s.sign_out_end_time).valueOf():"",relate_course:s.relate_course,relate_course_list:((r=s.relate_course_list)===null||r===void 0?void 0:r.length)>0?s.relate_course_list:[],remind_directors:s.remind_directors,advance_minute:s.advance_minute||0,qy_we_chat_vo:s.qy_we_chat_vo,address:s.address,longitude:s.longitude,latitude:s.latitude,address_detail:s.address_detail,sign_range:s.sign_range};break;case"AddAssessment":m=(0,d.Z)((0,d.Z)({},x(n.data)),{},{tutorId:o,courseSort:a,courseType:14,flag:14});break;default:break}return c==="unlock_mode"&&s.unlockingTime&&(m.unlockingTime=f()(s.unlockingTime).valueOf()),m.resource_lock=n.resource_lock||!1,m});return{content:t.desc,stageName:t.name,isOrder:t.inOrder,stageSort:g+1,stageId:l?t.stageId:"",startTime:c==="unlock_mode"&&t.studyTime?f()(t.studyTime[0]).valueOf():null,endTime:c==="unlock_mode"&&t.studyTime?f()(t.studyTime[1]).valueOf():null,course:h}});return e},W=i=>{var l=i.map((p,c)=>({content:p.desc,stage_name:p.name,is_order:p.inOrder,stage_sort:c+1,stage_id:p.stageId,resources:p.list.map((_,o)=>{var e=_.data;switch(_.componentName){case"CoursewareSelector":return{course_id:_.id,course_sort:o,course_type:3,flag:1,mappingId:_.mappingId};case"AddMentorCoaching":return{course_id:_.id,tutorials:{id:_.id,title:e.title,content:e.content,model:e.model,tutor_model:e.tutor_model,evaluation_type:e.evaluation_type,user_id:e.user_id||"",user_name:e.user_name||""},course_sort:o,course_type:12,flag:7,mappingId:_.mappingId};case"CourseSelector":return{course_id:_.id,course_sort:o,course_type:1,flag:1,mappingId:_.mappingId};case"AddExam":return{exam:{id:_.id,title:e.title,cheat_flag:e.cheatFlag.isChecked?1:0,exam_duration:e.examDuration,face_recognition:e.cheatFlag.faceRecognition,summary:e.summary,mark_type:D(e.markType),paper_id:e.questionsMode===1?e.fixedQuestion.id:"",paper_name:e.questionsMode===1?e.fixedQuestion.name:"",pass_line:e.passLine,question_banks:e.questionsMode===1?"":e.randomQuestion.bankQuesitonVoList.map(C=>C.id),question_mode:e.questionsMode,show_knowledge:e.knowledgePoints===1?"show":"hide",repeat_exam:e.reExam.isChecked,multiple_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.multipleCount,multiple_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.multipleScore,fill_blank_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.fillBlankCount,fill_blank_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.fillBlankScore,fill_blank_type:e.questionsMode===1?1:e.randomQuestion.bankQuesitonInfo.fillBlankType,short_answer_type:e.questionsMode===1?1:e.randomQuestion.bankQuesitonInfo.shortAnswerType,short_answer_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.shortAnswerCount,short_answer_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.shortAnswerScore,single_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.singleCount,single_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.singleScore,multiple_missed_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.multipleMissedScore,true_or_false_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.trueOrFalseCount,true_or_false_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.trueOrFalseScore,total_score:e.questionsMode===1?e.fixedQuestion.tableList.totalScore:"",answer_parsing:e.reExam.isChecked?e.reExam.allowed.end:e.reExam.notAllowed.end,passing_score:e.questionsMode===1?Number(e.fixedQuestion.tableList.totalScore*e.passLine/100).toFixed(1):60,cut_screen_count:e.cheatFlag.switchNum!==null?e.cheatFlag.switchNum:-1,re_exam_rule:e.reExam.allowed.reRule,re_exam_number:e.reExam.allowed.reRule===2?e.reExam.allowed.reNum:0,score_rule:e.reExam.allowed.record,view_rule:e.reExam.allowed.viewRule,proportional:e.questionsMode===2&&e.isOpenDrawQuestions?e.proportional:[],anonymous_marking:"".concat(e.markType.anonymousMarking),show_result:e.reExam.show_result},flag:2,course_sort:o,course_id:_.id,course_type:6,mappingId:_.mappingId};case"AddNewExam":var t=_.data,g=t.paperInfo,h=t.exam_times,n=t.cut_screen_times,a=t.random_order,r=t.mark_setting,s=t.result_visible,m=t.face_recognition,b=(0,U.Z)(t,["paperInfo","exam_times","cut_screen_times","random_order","mark_setting","result_visible","face_recognition"]);return{course_sort:o,flag:15,type:"ex",course_id:_.id,course_type:15,mappingId:_.mappingId?_.mappingId:"",new_exam:(0,d.Z)((0,d.Z)((0,d.Z)({},b),(0,O.jJ)(m)),{},{paper_id:g.id,answer_rule:h.answer_rule,exam_count:h.exam_count||1,cut_screen_rule:n.cut_screen_rule,cut_screen_count:n.cut_screen_count||1,cut_screen_interval:n.cut_screen_interval||0,random_question:a.random_question,random_options:a.random_options,mark_type:r.mark_type,mark_question_type:{fill_blank:r.mark_type===O.lt.MANUAL?r.fill_blank:!1,short_answer:r.mark_type===O.lt.MANUAL?r.short_answer:!1},anonymous_marking:r.anonymous_marking,exam_certificate_id:"",supervisor_list:[],marker_list:[...r.marker_list.map(C=>typeof C=="string"?C:C.id)],result_view_rule:s.result_view_rule,answer_parsing:s.answer_parsing,ranking_list_view_rule:s.ranking_list_view_rule,show_result:s.show_result,reward_rule:null,authority_range:null,supervisor_mark:null})};case"AddPracticeTest":return{operation:{id:_.id,title:_.data.title,content:_.data.content||_.data.address,type:"sc",resources:_.data.attachment.map(C=>({resourceId:C.id})),score_setting:{scoreSwitch:_.data.mark.isFull?"on":"off",score:_.data.mark.value},workflow_json:V(_.data.supervisor),sort:o,job_type:_.data.job_type},course_type:10,course_sort:o,flag:5,mappingId:_.mappingId};case"AddInvestigate":return{course_id:_.id,course_type:9,flag:4,course_sort:o,investigate:{id:_.id,title:_.name,questionnaire_id:_.questionnaire.id}};default:return null}})}));return l};function V(i){var l=[];if(i.type==="multilevel"){var p=i.multilevel;p.forEach(c=>{var _=[];c.forEach(o=>{_.push(o.id)}),l.push(_.join(","))})}else i.type==="or"?(i.or.forEach(c=>{l.push(c.id)}),l=[l.join(",")]):l=[];return{type:i.type,userIds:l}}var y=i=>{function l(o){if(o.questionMode===1){if(o.paperVo.fillBlankCount>0||o.paperVo.shortAnswerCount>0)return!0}else if(o.fillBlankCount>0||o.shortAnswerCount>0)return!0;return!1}function p(o){if(o.questionMode===1){if(o.paperVo.fillBlankCount>0)return!0}else if(o.fillBlankCount>0)return!0;return!1}function c(o){if(o.questionMode===1){if(o.paperVo.shortAnswerCount>0)return!0}else if(o.shortAnswerCount>0)return!0;return!1}var _=i.map((o,e)=>({key:"".concat(new Date().getTime()).concat(e),desc:o.content,name:o.stageName,inOrder:o.isOrder,stageId:o.id,studyTime:o.startTime?[f()(o.startTime),f()(o.endTime)]:["",""],list:o.courseMappingList.map(t=>{var g,h,n=t.planExamVos,a={},r,s;switch(t.flag){case 1:t.contentType==="audio/mp3"||t.contentType==="audio/mpeg"||t.contentType==="audio"?(s="mp3",r="mp3"):(s=t.type,r=t.type==="imageText"?"h5":t.type),a={id:t.courseId,name:t.name,type:t.courseType===1?"course":"courseware",icon:v.e1[r],originalType:s,componentName:t.courseType===1?"CourseSelector":"CoursewareSelector",status:t.courseType===1?"0":t.status,duration:t.duration,data:t,mappingId:t.mappingId};break;case 2:a={id:t.id,name:t.name,type:"ex",icon:v.e1.ex,componentName:"AddExam",duration:n.examDuration*60,data:{title:n.title,examDuration:n.examDuration,summary:n.summary,isOpenDrawQuestions:n.proportionalExamVos&&n.proportionalExamVos.length>0,proportional:n.proportionalExamVos&&(n.proportionalExamVos.length>0?Y(n.proportionalExamVos,n.bankQuesitonVoList):n.questionMode===2?Z(n.bankQuesitonVoList):[])||[],cheatFlag:{isChecked:!!n.cheatFlag,switchNum:n.cutScreenCount===-1?null:n.cutScreenCount,faceRecognition:n.faceRecognition},reExam:{show_result:n.show_result,isChecked:n.repeatExam,userJoin:n.user_join==="true",notAllowed:{end:n.answerParsing},allowed:{reRule:n.reExamRule,record:n.scoreRule,end:n.answerParsing,reNum:n.reExamRule===2?n.reExamNumber:1,viewRule:n.viewRule}},markType:{checkedValue:n.markType===1?1:2,artificialDisabled:n.markType===1&&!l(n),fillBlank:{checked:(n.markType===2||n.markType===3)&&p(n),disabled:!p(n)},shortAnswer:{checked:(n.markType===2||n.markType===4)&&c(n),disabled:!c(n)},anonymousMarking:n.anonymous_marking==="true"},questionsMode:n.questionMode,knowledgePoints:n.showKnowledge==="show"?1:2,passLine:n.passLine,fixedQuestion:n.questionMode===1?{id:n.paperVo.id,name:n.paperVo.title,tableList:{fillBlankCount:n.paperVo.fillBlankCount,fillBlankScore:n.paperVo.fillBlankScore,multipleCount:n.paperVo.multipleCount,multipleScore:n.paperVo.multipleScore,shortAnswerCount:n.paperVo.shortAnswerCount,shortAnswerScore:n.paperVo.shortAnswerScore,singleCount:n.paperVo.singleCount,singleScore:n.paperVo.singleScore,totalCount:n.paperVo.totalCount,totalScore:n.paperVo.totalScore,trueOrFalseCount:n.paperVo.trueOrFalseCount,trueOrFalseScore:n.paperVo.trueOrFalseScore}}:{id:"",name:"",tableList:{fillBlankCount:0,fillBlankScore:0,multipleCount:0,multipleScore:0,shortAnswerCount:0,shortAnswerScore:0,singleCount:0,singleScore:0,totalCount:0,totalScore:0,trueOrFalseCount:0,trueOrFalseScore:0}},randomQuestion:n.questionMode===2?{bankQuesitonVoList:n.bankQuesitonVoList.map(Q=>({id:Q.id,name:Q.name,data:Q})),bankQuesitonInfo:{fillBlankCount:n.fillBlankCount,fillBlankScore:n.fillBlankUnitScore,fillBlankType:+n.fillBlankType||1,multipleCount:n.multipleCount,multipleScore:n.multipleUnitScore,shortAnswerCount:n.shortAnswerCount,shortAnswerScore:n.shortAnswerUnitScore,shortAnswerType:+n.shortAnswerType||1,singleCount:n.singleCount,singleScore:n.singleUnitScore,trueOrFalseCount:n.trueOrFalseCount,trueOrFalseScore:n.trueOrFalseUnitScore,multipleMissedScore:n.multipleMissedScore}}:{bankQuesitonVoList:[],bankQuesitonInfo:{fillBlankCount:0,fillBlankScore:0,fillBlankType:1,multipleCount:0,multipleScore:0,shortAnswerCount:0,shortAnswerScore:0,shortAnswerType:1,singleCount:0,singleScore:0,trueOrFalseCount:0,trueOrFalseScore:0,multipleMissedScore:0}}},mappingId:t.mappingId,isExamEdit:t.isExamEdit};break;case 3:var m=t.offline_course_vo;a={id:t.id,name:t.name,type:"xx",componentName:"OfflineTrain",icon:v.e1.xx,data:(0,d.Z)({},N(m)),mappingId:t.mappingId};break;case 4:case 5:if(t.type==="sc"||t.type==="operation"){a={id:t.id,name:t.title,type:"sc",icon:v.e1.sc,componentName:"AddPracticeTest",data:(0,T.UI)("PRIVACY_HLS_APPROVAL_MANAGE")?L(t):S(t),mappingId:t.mappingId};break}a={id:t.courseId,name:t.title||t.name,type:"investigate",icon:v.e1.questionnaire,componentName:"AddInvestigate",data:t,mappingId:t.mappingId,questionnaire:{id:t.questionnaireId,name:t.name}};break;case 6:a={id:t.evaluation.id,name:t.evaluation.title,productId:t.evaluation.product_id,modelId:t.evaluation.model_id,type:"jobEvaluation",icon:v.e1.jobEvaluation,componentName:"AddJobEvaluation",data:{title:t.evaluation.title,evaluationTools:{product_id:t.evaluation.product_id,model_id:t.evaluation.model_id}},mappingId:t.mappingId};break;case 7:a={id:t.id,name:t.tutorials.title,type:"tutor",icon:v.e1.tutor,componentName:"AddMentorCoaching",data:(0,d.Z)((0,d.Z)({},t.tutorials),{},{tutor_model:t.tutorials.tutorModel,evaluation_type:t.tutorials.evaluationType,user_id:t.tutorials.userId,user_name:t.tutorials.userName}),mappingId:t.mappingId};break;case 9:a={id:t.courseId,name:t.title,type:"investigate",icon:v.e1.questionnaire,componentName:"AddInvestigate",data:t,questionnaire:{id:t.questionnaireId,name:t.name}};break;case 13:var b=t.course_sign_vo;a={id:t.id,name:t.name,type:"attendance",componentName:"Attendance",icon:v.e1.attendance,data:(0,d.Z)({},P(b)),mappingId:t.mappingId};break;case 14:a={id:(t==null||(g=t.evaluate)===null||g===void 0?void 0:g.id)||"",name:(t==null||(h=t.evaluate)===null||h===void 0?void 0:h.name)||"",type:"assess",componentName:"AddAssessment",icon:v.e1.assess,data:(0,d.Z)({},z(t.evaluate)),resource_lock:t.resource_lock};break;case 15:{var C=(0,j.Qm)()._store,I=C.getState(),$=I.user,q=(0,O.AC)({data:t.exam_plan_detail_v1,user:{id:$.id,name:$.name,creator:!0}});a={id:t.exam_plan_detail_v1.id,name:t.exam_plan_detail_v1.title,type:"ex",icon:v.e1.ex,componentName:"AddNewExam",duration:t.exam_plan_detail_v1.exam_duration*60,data:q,mappingId:t.mappingId,isExamEdit:t.isExamEdit}}default:break}return a.data&&(a.data.unlockingTime=t.unlockingTime?f()(t.unlockingTime):""),a.resource_lock=t.resource_lock,a})}));return _};function L(i){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"resources";return i.supervisor={lead:"",multilevel:[],or:[],type:"or"},i.mark={isFull:i.scoreSetting.score_switch==="on",value:i.scoreSetting.score_switch==="on"?i.scoreSetting.score:100},i.attachment=i[l],i}function S(i){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"resources",p=[],c=[];return i.workflowJson.type==="or"?i.workflowJson.nodeList[0].forEach(_=>{p.push({type:2,id:_.id,name:_.name,show:!0,unionid:_.unionid,user_id:_.sync_user_id,source_type:_.source_type||_.sourceType})}):i.workflowJson.type==="multilevel"&&i.workflowJson.nodeList.forEach(_=>{_.forEach(o=>{o.user_id=o.sync_user_id}),c.push(_)}),i.supervisor={or:p,multilevel:c,lead:"",type:i.workflowJson.type},i.mark={isFull:i.scoreSetting.score_switch==="on",value:i.scoreSetting.score_switch==="on"?i.scoreSetting.score:100},i.attachment=i[l],i}var E=(i,l)=>{var p=i.map((c,_)=>({id:c.id?c.id:"",content:c.desc,stage_name:c.name,is_order:l==="free_mode"?!1:c.inOrder,sort:_+1,progress:c.Standard.progressCheck?c.Standard.progress:"",exam_times:c.Standard.examCheck?c.Standard.examNum:"",practice_times:c.Standard.bankCheck?c.Standard.bankNum:"",operation_times:c.Standard.practiceCheck?c.Standard.practiceNum:"",finish_evaluation:c.Standard.jobEvaluationCheck?"true":"false",is_get_score:c.reward.getScoreChecked?c.reward.getScore:"",certificate_id:c.reward.certificateChecked?c.reward.certificateId:"",resources:c.list.map((o,e)=>{var t=o.data;switch(o.componentName){case"CoursewareSelector":return{course_id:o.id,replaced_old_id:o.replaced_old_id===o.id?"":o.replaced_old_id,sort:e,type:3,lab_resource_id:o.lab_resource_id,lab_resource_name:o.lab_resource_name,resource_lock:o.resource_lock||!1,unlocking_time:l==="unlock_mode"?null:f()(o.unlocking_time).valueOf()};case"ClNewUpload":case"CourseSelector":return{course_id:o.id,replaced_old_id:o.replaced_old_id||"",sort:e,type:1,lab_resource_id:o.lab_resource_id,lab_resource_name:o.lab_resource_name,resource_lock:o.resource_lock||!1,unlocking_time:l==="unlock_mode"?null:f()(o.unlocking_time).valueOf()};case"LiveClass":return{course_id:o.id,replaced_old_id:o.replaced_old_id||"",sort:e,type:16,lab_resource_id:o.lab_resource_id,lab_resource_name:o.lab_resource_name,resource_lock:o.resource_lock||!1,unlocking_time:l==="unlock_mode"?null:f()(o.unlocking_time).valueOf()};case"AddExam":return{type:6,sort:e,course_id:o.id,exam:{title:t.title,cheat_flag:t.cheatFlag.isChecked?1:0,exam_duration:t.examDuration,face_recognition:t.cheatFlag.faceRecognition,summary:t.summary,mark_type:D(t.markType),paper_id:t.questionsMode===1?t.fixedQuestion.id:"",pass_line:t.passLine,question_banks:t.questionsMode===1?[]:t.randomQuestion.bankQuesitonVoList.map(I=>I.id),question_mode:t.questionsMode,show_knowledge:t.knowledgePoints===1?"show":"hide",repeat_exam:t.reExam.isChecked,multiple_count:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.multipleCount,multiple_unit_score:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.multipleScore,fill_blank_count:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.fillBlankCount,fill_blank_unit_score:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.fillBlankScore,fill_blank_type:t.questionsMode===1?1:t.randomQuestion.bankQuesitonInfo.fillBlankType,short_answer_count:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.shortAnswerCount,short_answer_unit_score:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.shortAnswerScore,short_answer_type:t.questionsMode===1?1:t.randomQuestion.bankQuesitonInfo.shortAnswerType,single_count:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.singleCount,single_unit_score:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.singleScore,true_or_false_count:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.trueOrFalseCount,true_or_false_unit_score:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.trueOrFalseScore,multiple_missed_score:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.multipleMissedScore,total_score:t.questionsMode===1?t.fixedQuestion.tableList.totalScore:"",answer_parsing:t.reExam.isChecked?t.reExam.allowed.end:t.reExam.notAllowed.end,passing_score:t.questionsMode===1?Number(t.fixedQuestion.tableList.totalScore*t.passLine/100).toFixed(1):60,cut_screen_count:t.cheatFlag.switchNum!==null?t.cheatFlag.switchNum:-1,re_exam_rule:t.reExam.allowed.reRule,re_exam_number:t.reExam.allowed.reRule===2?t.reExam.allowed.reNum:0,score_rule:t.reExam.allowed.record,view_rule:t.reExam.allowed.viewRule,proportional:t.questionsMode===2&&t.isOpenDrawQuestions?t.proportional:[],anonymous_marking:"".concat(t.markType.anonymousMarking),show_result:t.reExam.show_result},resource_lock:o.resource_lock||!1,unlocking_time:l==="unlock_mode"?null:f()(o.unlocking_time).valueOf()};case"AddNewExam":var g=o.data,h=g.paperInfo,n=g.exam_times,a=g.cut_screen_times,r=g.random_order,s=g.mark_setting,m=g.result_visible,b=g.face_recognition,C=(0,U.Z)(g,["paperInfo","exam_times","cut_screen_times","random_order","mark_setting","result_visible","face_recognition"]);return{type:15,sort:e,course_id:o.id,new_exam:(0,d.Z)((0,d.Z)((0,d.Z)({},C),(0,O.jJ)(b)),{},{paper_id:h.id,answer_rule:n.answer_rule,exam_count:n.exam_count||1,cut_screen_rule:a.cut_screen_rule,cut_screen_count:a.cut_screen_count||1,cut_screen_interval:a.cut_screen_interval||0,random_question:r.random_question,random_options:r.random_options,mark_type:s.mark_type,mark_question_type:{fill_blank:s.mark_type===O.lt.MANUAL?s.fill_blank:!1,short_answer:s.mark_type===O.lt.MANUAL?s.short_answer:!1},anonymous_marking:s.anonymous_marking,exam_certificate_id:"",supervisor_list:[],marker_list:[...s.marker_list.map(I=>typeof I=="string"?I:I.id)],result_view_rule:m.result_view_rule,answer_parsing:m.answer_parsing,ranking_list_view_rule:m.ranking_list_view_rule,show_result:m.show_result,reward_rule:null,authority_range:null,supervisor_mark:null}),resource_lock:o.resource_lock||!1,unlocking_time:l==="unlock_mode"?null:f()(o.unlocking_time).valueOf()};case"OfflineTrain":return{sort:e,type:7,course_id:o.id,offline_course:{id:t.id,title:t.title,begin_time:f()(t.dateRange.startTime).valueOf(),end_time:f()(t.dateRange.endTime).valueOf(),attachment:t.attachment.map(I=>I.id),course_duration:t.course_duration||"",lecturer_id:t.teacher.id,is_lecturer_confirm:!!t.teacher.is_lecturer_confirm,is_lecturer_subsidy:!!t.teacher.is_lecturer_subsidy,address:t.address,introduction:t.introduction,is_open_offline_assessment:t.assess.is_open_offline_assessment,is_open_upload:t.other.is_open_upload,is_open_schedule:!1,remind_type:t.remind.remind_type,advance_minute:t.remind.advance_minute?Number(t.remind.advance_minute):0,is_lecturer_remind:t.remind.is_lecturer_remind,is_student_remind:t.remind.is_student_remind,is_director_remind:t.remind.is_director_remind,is_lecturer_student_evaluate:t.evaluate.is_lecturer_student_evaluate,is_student_lecturer_evaluate:t.evaluate.is_student_lecturer_evaluate,is_student_course_evaluate:t.evaluate.is_student_course_evaluate,lecturer_student_evaluate_content:t.evaluate.lecturer_student_evaluate_content,student_lecturer_evaluate_content:t.evaluate.student_lecturer_evaluate_content,student_course_evaluate_content:t.evaluate.student_course_evaluate_content,assessment_total_score:t.assess.assessment_total_score,assessment_pass_score:t.assess.assessment_pass_score},resource_lock:o.resource_lock||!1,unlocking_time:l==="unlock_mode"?null:f()(o.unlocking_time).valueOf()};case"AddInvestigate":return{sort:e,type:9,course_id:o.id||"",questionnaire_id:o.questionnaire.id,resource_lock:o.resource_lock||!1,title:o.name,unlocking_time:l==="unlock_mode"?null:f()(o.unlocking_time).valueOf()};case"AddPracticeTest":return{type:10,courseSort:e,sort:e,flag:4,course_id:o.id,title:o.data.title,content:o.data.content||o.data.address,resources:o.data.attachment.map(I=>({resourceId:I.id})),scoreSetting:{scoreSwitch:o.data.mark.isFull?"on":"off",score:o.data.mark.value},workflowJson:V(o.data.supervisor),job_type:o.data.job_type,resource_lock:o.resource_lock||!1,unlocking_time:l==="unlock_mode"?null:f()(o.unlocking_time).valueOf()};case"AddJobEvaluation":return{sort:e,flag:6,type:11,evaluation:{id:o.id||"",title:o.data.title,product_id:o.data.evaluationTools.product_id,model_id:o.data.evaluationTools.model_id},resource_lock:o.resource_lock||!1,unlocking_time:l==="unlock_mode"?null:f()(o.unlocking_time).valueOf()};case"Attendance":return{sort:e,type:13,course_id:o.id,sign:{id:t.id,type:13,title:t.title,directors:t.directors.map(I=>typeof I=="object"&&(I.id||I.user_id)?I.id||I.user_id:I),name:t.name||"--",qrcode_type:t.qrcode_type,sign_in_begin_time:t.sign_in_begin_time,sign_in_end_time:t.sign_in_end_time,sign_out_begin_time:t.sign_out_begin_time,sign_out_end_time:t.sign_out_end_time,relate_course:t.relate_course,relate_course_list:t.relate_course_list,remind_directors:t.remind_directors,advance_minute:t.advance_minute,qy_we_chat_vo:t.qy_we_chat_vo,address:t.address,longitude:t.longitude,latitude:t.latitude,address_detail:t.address_detail,sign_range:t.sign_range},resource_lock:o.resource_lock||!1,unlocking_time:l==="unlock_mode"?null:f()(o.unlocking_time).valueOf()};case"AddAssessment":return{sort:e,type:14,course_id:o.id,resource_lock:o.resource_lock||!1,unlocking_time:l==="unlock_mode"?null:f()(o.unlocking_time).valueOf(),evaluateVo:{id:t.id,name:t.name,requirement:t.requirement,resource_id:t.resource_id,is_lock:t.is_lock,begin_time_unlock:t.begin_time_unlock,end_time_unlock:t.end_time_unlock,is_self_evaluate:t.is_self_evaluate,questionnaire_id:t.questionnaire_id,evaluate_form_title:t.evaluate_form_title,before_start_day:t.before_start_day,before_start_repeat:t.before_start_repeat,before_start_un_remind:t.before_start_un_remind,before_end_day:t.before_end_day,before_end_repeat:t.before_end_repeat,before_end_un_remind:t.before_end_un_remind,after_end_day:t.after_end_day,after_end_repeat:t.after_end_repeat,after_end_un_remind:t.after_end_un_remind,is_passed_standards:t.is_passed_standards,is_passed_option_three:t.is_passed_option_three,pass_standard_conditions:t.pass_standard_conditions,pass_standards_number:t.pass_standards_number,creator_user:t.creator_user}};case"AddPracticeBank":return{sort:e,type:17,course_id:o.id,resource_name:o.title,resource_lock:o.resource_lock||!1,unlocking_time:l==="unlock_mode"?null:f()(o.unlocking_time).valueOf(),practice:{title:o.data.title,question_bank_list:o.data.randomQuestion.bankQuesitonVoList.map(I=>I.id),pass_line:Number(o.data.stand)}};default:return null}})}));return p},k=function(l,p){var c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;function _(e){return e.fill_blank_count>0||e.short_answer_count>0}var o=l.map((e,t)=>{var g=e.resources.filter(a=>a.type==6||a.type==15).length,h=e.resources.filter(a=>a.type==17).length,n=e.resources.filter(a=>a.type==10).length;return{id:e.id,key:"".concat(new Date().getTime()).concat(t),desc:e.content,name:e.stage_name,inOrder:e.is_order,Standard:{progressCheck:e.progress>0,progress:e.progress||100,examCheck:e.exam_times>0,examNum:e.exam_times||g,bankCheck:e.practice_times>0,bankNum:e.practice_times||h,practiceCheck:e.operation_times>0,practiceNum:e.operation_times||n,jobEvaluationCheck:e.finish_evaluation==="true"},reward:{getScore:e.is_get_score?e.is_get_score:"",getScoreChecked:e.is_get_score>0,certificateId:e.certificate_id||"",certificateChecked:e.certificate_id!==0,certificateName:e.certificate_name,certificateImage:e.preview_url},hourClassId:e.id,hourClassStartTime:e.start_time,hourClassEndTime:e.end_time,list:e.resources.map(a=>{var r=a.exam;switch(a.type){case 1:return{id:a.course_id,name:a.resource_name,type:c&&a.biz_type==="imageText"?"twCourse":"course",icon:a.biz_type==="imageText"?v.e1.h5:v.e1.crs,componentName:"CourseSelector",duration:a.duration,data:a,unlocking_time:a.unlocking_time,lab_resource_id:a.lab_resource_id,lab_resource_name:a.lab_resource_name,lab_selected_id:a.lab_resource_id,resource_lock:a.resource_lock};case 3:{var s;return a.content_type==="article"||a.content_type==="link"?s=v.e1.h5:s=v.e1[a.contentType]||v.e1[a.content_type],{id:a.course_id,name:a.resource_name,type:"courseware",icon:s,componentName:"CoursewareSelector",duration:a.duration,status:a.resource_status,originalType:a.content_type==="article"||a.content_type==="link"?"h5":a.content_type||a.contentType,data:a,unlocking_time:a.unlocking_time,lab_resource_id:a.lab_resource_id,lab_resource_name:a.lab_resource_name,lab_selected_id:a.lab_resource_id,resource_lock:a.resource_lock}}case 6:return{id:a.course_id,name:r.title,type:"ex",icon:v.e1.ex,componentName:"AddExam",duration:r.exam_duration*60,data:{id:r.id,title:r.title,examDuration:r.exam_duration,summary:r.summary,isOpenDrawQuestions:r.proportionalExamVos&&r.proportionalExamVos.length>0,proportional:r.proportionalExamVos&&(r.proportionalExamVos.length>0?Y(r.proportionalExamVos,r.question_bank_vos):r.question_mode===2?Z(r.question_bank_vos):[])||[],cheatFlag:{isChecked:!!r.cheat_flag,switchNum:r.cut_screen_count===-1?null:r.cut_screen_count,faceRecognition:r.face_recognition},reExam:{show_result:r.show_result,isChecked:r.repeat_exam,userJoin:p?!1:r.user_join==="true",notAllowed:{end:r.answer_parsing},allowed:{reRule:r.re_exam_rule,record:r.score_rule,end:r.answer_parsing,reNum:r.re_exam_rule===2?r.re_exam_number:1,viewRule:r.view_rule}},markType:{checkedValue:r.mark_type===1?1:2,artificialDisabled:r.mark_type===1&&!_(r),fillBlank:{checked:(r.mark_type===2||r.mark_type===3)&&r.fill_blank_count,disabled:!r.fill_blank_count},shortAnswer:{checked:(r.mark_type===2||r.mark_type===4)&&r.short_answer_count,disabled:!r.short_answer_count},anonymousMarking:r.anonymous_marking==="true"},questionsMode:r.question_mode,knowledgePoints:r.show_knowledge==="show"?1:2,passLine:r.pass_line,fixedQuestion:r.question_mode===1?{id:r.paper_id,name:r.paper_name,tableList:{fillBlankCount:r.fill_blank_count,fillBlankScore:r.fill_blank_unit_score,multipleCount:r.multiple_count,multipleScore:r.multiple_unit_score,shortAnswerCount:r.short_answer_count,shortAnswerScore:r.short_answer_unit_score,singleCount:r.single_count,singleScore:r.single_unit_score,totalCount:r.total_count,totalScore:r.total_score,trueOrFalseCount:r.true_or_false_count,trueOrFalseScore:r.true_or_false_unit_score}}:{id:"",name:"",tableList:{fillBlankCount:0,fillBlankScore:0,multipleCount:0,multipleScore:0,shortAnswerCount:0,shortAnswerScore:0,singleCount:0,singleScore:0,totalCount:0,totalScore:0,trueOrFalseCount:0,trueOrFalseScore:0}},randomQuestion:r.question_mode===2?{bankQuesitonVoList:r.question_bank_vos.map(q=>{var Q=q.fill_blank_count,G=q.multiple_count,ne=q.short_answer_count,ae=q.single_count,B=q.total_count,oe=q.true_or_false_count,re={fillBlankCount:Q,shortAnswerCount:ne,multipleCount:G,singleCount:ae,totalCount:B,trueOrFalseCount:oe};return{id:q.id,name:q.name,data:Object.assign(q,re),fillBlankCount:Q,shortAnswerCount:ne,multipleCount:G,singleCount:ae,totalCount:B,trueOrFalseCount:oe}}),bankQuesitonInfo:{fillBlankCount:r.fill_blank_count,fillBlankScore:r.fill_blank_unit_score,fillBlankType:+r.fillBlankType,multipleCount:r.multiple_count,multipleScore:r.multiple_unit_score,shortAnswerCount:r.short_answer_count,shortAnswerScore:r.short_answer_unit_score,shortAnswerType:+r.shortAnswerType,singleCount:r.single_count,singleScore:r.single_unit_score,trueOrFalseCount:r.true_or_false_count,trueOrFalseScore:r.true_or_false_unit_score,multipleMissedScore:r.multiple_missed_score}}:{bankQuesitonVoList:[],bankQuesitonInfo:{fillBlankCount:0,fillBlankScore:0,fillBlankType:1,multipleCount:0,multipleScore:0,shortAnswerCount:0,shortAnswerScore:0,shortAnswerType:1,singleCount:0,singleScore:0,trueOrFalseCount:0,trueOrFalseScore:0,multipleMissedScore:0}}},unlocking_time:a.unlocking_time,resource_lock:a.resource_lock};case 7:return{id:p?"":a.offlineCourseEditVo.id,name:a.offlineCourseEditVo.title,key:a.offlineCourseEditVo.id,type:"xx",componentName:"OfflineTrain",icon:v.e1.xx,data:(0,d.Z)({},N(a.offlineCourseEditVo,p)),unlocking_time:a.unlocking_time,resource_lock:a.resource_lock};case 9:return{id:a.course_id,name:a.title||a.resource_name,type:"investigate",icon:v.e1.questionnaire,componentName:"AddInvestigate",data:a,questionnaire:{id:a.questionnaire_id,name:a.resource_name},unlocking_time:a.unlocking_time,resource_lock:a.resource_lock};case 10:return{id:a.course_id,name:a.title,type:"sc",icon:v.e1.sc,componentName:"AddPracticeTest",data:S(a,"operationResources"),unlocking_time:a.unlocking_time,resource_lock:a.resource_lock};case 11:return{id:a.evaluation.id,name:a.evaluation.title,productId:a.evaluation.product_id,modelId:a.evaluation.model_id,type:"jobEvaluation",icon:v.e1.jobEvaluation,componentName:"AddJobEvaluation",data:{title:a.evaluation.title,evaluationTools:{product_id:a.evaluation.product_id,model_id:a.evaluation.model_id}},unlocking_time:a.unlocking_time,resource_lock:a.resource_lock};case 13:return{id:a.course_sign_vo.id,name:a.course_sign_vo.name,type:"attendance",componentName:"Attendance",icon:v.e1.attendance,data:(0,d.Z)({},P(a.course_sign_vo,p)),unlocking_time:a.unlocking_time,resource_lock:a.resource_lock};case 14:return{id:a.evaluate?a.evaluate.id:"",name:a.evaluate?a.evaluate.name:"",type:"assess",componentName:"AddAssessment",icon:v.e1.assess,data:(0,d.Z)({},z(a.evaluate)),resource_lock:a.resource_lock,unlocking_time:a.unlocking_time};case 15:{var m=(0,j.Qm)()._store,b=m.getState(),C=b.user,I=(0,O.AC)({data:a.exam_plan_detail_v1,user:{id:C.id,name:C.name,creator:!0}});return{id:a.exam_plan_detail_v1.id,name:a.exam_plan_detail_v1.title,type:"ex",icon:v.e1.ex,componentName:"AddNewExam",unlocking_time:a.unlocking_time,resource_lock:a.resource_lock,duration:a.exam_plan_detail_v1.exam_duration*60,data:I}}case 16:return{id:p?"":a.course_id,name:a.title,key:a.course_id,type:"liveClass",componentName:"LiveClass",icon:v.e1.liveClass,data:(0,d.Z)({},ie(a)),unlocking_time:a.unlocking_time,resource_lock:a.resource_lock};case 17:var $=(0,O.S8)(a.practice);return{id:a.course_id,name:a.resource_name,type:"practice",componentName:"AddPracticeBank",unlocking_time:a.unlocking_time,resource_lock:a.resource_lock,data:$};default:return null}})}});return o},w=i=>{var l=i.map((p,c)=>({content:p.desc,stage_name:p.name,order:"".concat(p.inOrder),sort:c+1,course:p.list.map((_,o)=>{var e=_.data;switch(_.componentName){case"CoursewareSelector":return{course_id:_.id,course_sort:o,course_type:3,flag:1};case"CourseSelector":return{course_id:_.id,course_sort:o,course_type:1,flag:1};case"AddExam":return{flag:2,type:"ex",course_sort:o,course_id:_.id,title:e.title,cheat_flag:e.cheatFlag.isChecked?1:0,exam_duration:e.examDuration,face_recognition:e.cheatFlag.faceRecognition,summary:e.summary,mark_type:D(e.markType),paper_id:e.questionsMode===1?e.fixedQuestion.id:"",paper_title:e.questionsMode===1?e.fixedQuestion.name:"",pass_line:e.passLine,question_bank_list:e.questionsMode===1?"":e.randomQuestion.bankQuesitonVoList.map(C=>C.id).join(","),question_mode:e.questionsMode,show_knowledge:e.knowledgePoints===1?"show":"hide",s_repeat_exam:"".concat(e.reExam.isChecked),multiple_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.multipleCount,multiple_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.multipleScore,fill_blank_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.fillBlankCount,fill_blank_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.fillBlankScore,fill_blank_type:e.questionsMode===1?1:e.randomQuestion.bankQuesitonInfo.fillBlankType,short_answer_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.shortAnswerCount,short_answer_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.shortAnswerScore,short_answer_type:e.questionsMode===1?1:e.randomQuestion.bankQuesitonInfo.shortAnswerType,single_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.singleCount,single_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.singleScore,true_or_false_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.trueOrFalseCount,true_or_false_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.trueOrFalseScore,multiple_missed_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.multipleMissedScore,total_score:e.questionsMode===1?e.fixedQuestion.tableList.totalScore:"",answer_parsing:e.reExam.isChecked?e.reExam.allowed.end:e.reExam.notAllowed.end,passing_score:e.questionsMode===1?Number(e.fixedQuestion.tableList.totalScore*e.passLine/100).toFixed(1):60,cut_screen_count:e.cheatFlag.switchNum!==null?e.cheatFlag.switchNum:-1,re_exam_rule:e.reExam.allowed.reRule,re_exam_number:e.reExam.allowed.reRule===2?e.reExam.allowed.reNum:0,score_rule:e.reExam.allowed.record,view_rule:e.reExam.allowed.viewRule,proportional:e.questionsMode===2&&e.isOpenDrawQuestions?e.proportional:[],anonymous_marking:"".concat(e.markType.anonymousMarking),show_result:e.reExam.show_result};case"AddNewExam":var t=_.data,g=t.paperInfo,h=t.exam_times,n=t.cut_screen_times,a=t.random_order,r=t.mark_setting,s=t.result_visible,m=t.face_recognition,b=(0,U.Z)(t,["paperInfo","exam_times","cut_screen_times","random_order","mark_setting","result_visible","face_recognition"]);return{course_type:15,flag:15,type:"ex",course_sort:o,course_id:_.id,new_exam:(0,d.Z)((0,d.Z)((0,d.Z)({},b),(0,O.jJ)(m)),{},{paper_id:g.id,answer_rule:h.answer_rule,exam_count:h.exam_count||1,cut_screen_rule:n.cut_screen_rule,cut_screen_count:n.cut_screen_count||1,cut_screen_interval:n.cut_screen_interval||0,random_question:a.random_question,random_options:a.random_options,mark_type:r.mark_type,mark_question_type:{fill_blank:r.mark_type===O.lt.MANUAL?r.fill_blank:!1,short_answer:r.mark_type===O.lt.MANUAL?r.short_answer:!1},anonymous_marking:r.anonymous_marking,exam_certificate_id:"",supervisor_list:[],marker_list:[...r.marker_list.map(C=>typeof C=="string"?C:C.id)],result_view_rule:s.result_view_rule,answer_parsing:s.answer_parsing,ranking_list_view_rule:s.ranking_list_view_rule,show_result:s.show_result,reward_rule:null,authority_range:null,supervisor_mark:null})};case"AddInvestigate":return{course_id:_.id,course_type:9,flag:9,course_sort:o,investigate:{id:_.id,title:_.name,questionnaire_id:_.questionnaire.id}};default:return null}})}));return l},M=i=>{function l(c){return c.fill_blank_count>0||c.short_answer_count>0}var p=i.map((c,_)=>({key:"".concat(new Date().getTime()).concat(_),desc:c.content,name:c.stage_name,inOrder:c.is_order,list:c.course_mapping_list.map(o=>{var e=o;switch(o.flag){case 1:return{id:o.course_id,name:o.name,type:o.course_type===1?"course":"courseware",icon:v.e1[o.type==="imageText"?"h5":o.contentType==="audio/mp3"?"mp3":o.type],originalType:o.type,componentName:o.course_type===1?"CourseSelector":"CoursewareSelector",status:o.course_type===1?"":o.status,duration:o.duration,data:o};case 2:return{id:o.course_id,name:e.title,type:"ex",icon:v.e1.ex,componentName:"AddExam",duration:e.exam_duration*60,data:{title:e.title,examDuration:e.exam_duration,summary:e.summary,isOpenDrawQuestions:e.proportionalExamVos&&e.proportionalExamVos.length>0,proportional:e.proportionalExamVos&&(e.proportionalExamVos.length>0?Y(e.proportionalExamVos,e.bank_quesiton_list):e.question_mode===2?Z(e.bank_quesiton_list):[])||[],cheatFlag:{isChecked:!!e.cheat_flag,switchNum:e.cut_screen_count===-1?null:e.cut_screen_count,faceRecognition:e.face_recognition},reExam:{show_result:e.show_result,isChecked:e.s_repeat_exam==="true",notAllowed:{end:e.answer_parsing},allowed:{reRule:e.re_exam_rule,record:e.score_rule,end:e.answer_parsing,reNum:e.re_exam_rule===2?e.re_exam_number:1,viewRule:e.view_rule}},markType:{checkedValue:e.mark_type===1?1:2,artificialDisabled:e.mark_type===1&&!l(e),fillBlank:{checked:(e.mark_type===2||e.mark_type===3)&&e.fill_blank_count,disabled:!e.fill_blank_count},shortAnswer:{checked:(e.mark_type===2||e.mark_type===4)&&e.short_answer_count,disabled:!e.short_answer_count},anonymousMarking:e.anonymous_marking==="true"},questionsMode:e.question_mode,knowledgePoints:e.show_knowledge==="show"?1:2,passLine:e.pass_line,fixedQuestion:e.question_mode===1?{id:e.paper_id,name:e.paper_title,tableList:{fillBlankCount:e.fill_blank_count,fillBlankScore:e.fill_blank_unit_score,multipleCount:e.multiple_count,multipleScore:e.multiple_unit_score,shortAnswerCount:e.short_answer_count,shortAnswerScore:e.short_answer_unit_score,singleCount:e.single_count,singleScore:e.single_unit_score,totalCount:e.paper_question_numbers,totalScore:e.total_score,trueOrFalseCount:e.true_or_false_count,trueOrFalseScore:e.true_or_false_unit_score}}:{id:"",name:"",tableList:{fillBlankCount:0,fillBlankScore:0,multipleCount:0,multipleScore:0,shortAnswerCount:0,shortAnswerScore:0,singleCount:0,singleScore:0,totalCount:0,totalScore:0,trueOrFalseCount:0,trueOrFalseScore:0}},randomQuestion:e.question_mode===2?{bankQuesitonVoList:e.bank_quesiton_list.map(a=>{var r=a.fill_blank_count,s=a.multiple_count,m=a.short_answer_count,b=a.single_count,C=a.total_count,I=a.true_or_false_count,$={fillBlankCount:r,shortAnswerCount:m,multipleCount:s,singleCount:b,totalCount:C,trueOrFalseCount:I};return{id:a.id,name:a.name,data:Object.assign(a,$),fillBlankCount:r,shortAnswerCount:m,multipleCount:s,singleCount:b,totalCount:C,trueOrFalseCount:I}}),bankQuesitonInfo:{fillBlankCount:e.fill_blank_count,fillBlankScore:e.fill_blank_unit_score,fillBlankType:+e.fill_blank_type||1,multipleCount:e.multiple_count,multipleScore:e.multiple_unit_score,shortAnswerCount:e.short_answer_count,shortAnswerScore:e.short_answer_unit_score,shortAnswerType:+e.short_answer_type||1,singleCount:e.single_count,singleScore:e.single_unit_score,trueOrFalseCount:e.true_or_false_count,trueOrFalseScore:e.true_or_false_unit_score,multipleMissedScore:e.multiple_missed_score}}:{bankQuesitonVoList:[],bankQuesitonInfo:{fillBlankCount:0,fillBlankScore:0,multipleCount:0,multipleScore:0,shortAnswerCount:0,shortAnswerScore:0,singleCount:0,singleScore:0,trueOrFalseCount:0,trueOrFalseScore:0,multipleMissedScore:0}}}};case 9:return{id:o.course_id,name:o.title,type:"investigate",icon:v.e1.questionnaire,componentName:"AddInvestigate",data:o,questionnaire:{id:o.questionnaire_id,name:o.name}};case 15:{var t=(0,j.Qm)()._store,g=t.getState(),h=g.user,n=(0,O.AC)({data:o.exam_plan_detail_v1,user:{id:h.id,name:h.name,creator:!0}});return{id:o.exam_plan_detail_v1.id,name:o.exam_plan_detail_v1.title,type:"ex",icon:v.e1.ex,componentName:"AddNewExam",duration:o.exam_plan_detail_v1.exam_duration*60,data:n}}default:return null}})}));return p},A=function(l){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return l.map((c,_)=>{var o=p.find(e=>e.stage_index-1===_);return c.list.map((e,t)=>{var g;o&&(g=o.resource_error_vos.find(n=>n.resource_index===t));var h=e.type;if(e.resource_type)switch(e.resource_type){case 1:h="course";break;case 2:case 3:h="courseware";break;case 6:case 15:h="ex";break;case 7:h="xx";break;case 9:h="questionnaire";break;case 13:h="attendance";break;case 14:h="assess";break;default:break}if(e.componentName)switch(e.componentName){case"CourseSelector":h="course";break;case"CoursewareSelector":h="courseware";break;case"AddNewExam":case"AddExam":h="ex";break;case"OfflineTrain":h="xx";break;case"Attendance":h="attendance";break;case"QuestionnaireSelector":case"AddInvestigate":h="questionnaire";break;case"AddPracticeTest":h="practicalIndustry";break;case"AddAssessment":h="assess";break;default:break}switch(h){case"course":e.resourceErrTip=g?g.resource_status==="deleted"?"\u5F15\u7528\u7684\u8BFE\u7A0B\u88AB\u5220\u9664":g.resource_status==="un_released"?"\u5F15\u7528\u7684\u8BFE\u7A0B\u300A".concat(g.resource_name,"\u300B\u672A\u53D1\u5E03\uFF0C\u8BF7\u542F\u7528\u540E\u518D\u7F16\u8F91"):"":"";break;case"courseware":e.resourceErrTip=g&&g.resource_status==="deleted"?"\u5F15\u7528\u7684\u8BFE\u4EF6\u88AB\u5220\u9664":"";break;case"ex":e.resourceErrTip=g?g.resource_status==="bank_deleted"?"\u5F15\u7528\u7684\u9898\u5E93\u88AB\u5220\u9664":g.resource_status==="paper_deleted"?"\u5F15\u7528\u7684\u8BD5\u5377\u88AB\u5220\u9664":g.resource_status==="bank_missing"?"\u5F15\u7528\u7684\u9898\u5E93\u8BD5\u9898\u4E0D\u8DB3":"":"";break;case"xx":e.resourceErrTip=g&&g.resource_status==="time_expired"?"\u7EBF\u4E0B\u8BFE\u5DF2\u8FC7\u671F":"";break;case"questionnaire":e.resourceErrTip=g?g.resource_status==="deleted"?"\u5F15\u7528\u7684\u95EE\u5377\u88AB\u5220\u9664":g.resource_status==="un_released"?"\u5F15\u7528\u7684\u95EE\u5377\u672A\u53D1\u5E03":"":"";break;case"practicalIndustry":e.resourceErrTip=g&&g.resource_status==="operation_resource_deleted"?F.Z.t("component.practicalDeleteTip"):"";break;default:break}return null}),null}),l},N=(i,l)=>({id:l?"":i.id,title:i.title,edit_status:i.edit_status,status:i.status,department_id:i.department_id||"",dateRange:{startTime:i.begin_time,endTime:i.end_time},address:i.address,course_duration:i.course_duration,has_lecturer_student_data:l?!1:i.has_lecturer_student_data,has_student_lecturer_data:l?!1:i.has_student_lecturer_data,has_student_course_data:l?!1:i.has_student_course_data,has_lecturer_assess_student_data:l?!1:i.has_lecturer_assess_student_data,teacher:{id:i.lecturer_id,name:i.lecturer_name,is_lecturer_confirm:i.is_lecturer_confirm,is_lecturer_subsidy:i.is_lecturer_subsidy,teacher_sync_user_id:i.teacher_sync_user_id,lecturer_name:i.lecturer_name,teacher_sync_source_type:i.teacher_sync_source_type,type:i.teacher_sync_type,teacher_sync_type:i.teacher_sync_type},introduction:i.introduction,attachment:i.attachment||[],other:{is_open_schedule:i.is_open_schedule,is_open_upload:i.is_open_upload},remind:{remind_type:i.remind_type||"offline_course",advance_minute:i.advance_minute,is_lecturer_remind:i.is_lecturer_remind,is_student_remind:i.is_student_remind,is_director_remind:i.is_director_remind},evaluate:{is_lecturer_student_evaluate:i.is_lecturer_student_evaluate,is_student_lecturer_evaluate:i.is_student_lecturer_evaluate,is_student_course_evaluate:i.is_student_course_evaluate,lecturer_student_evaluate_content:i.lecturer_student_evaluate_content?(0,d.Z)((0,d.Z)({},i.lecturer_student_evaluate_content),{},{passing_score:Number(i.lecturer_student_evaluate_content.passing_score),total_score:Number(i.lecturer_student_evaluate_content.total_score)}):{evaluate_type:"score",questionnaire_id:"",questionnaire_name:"",total_score:"",passing_score:""},student_lecturer_evaluate_content:i.student_lecturer_evaluate_content||{evaluate_type:"star",questionnaire_id:"",questionnaire_name:"",total_score:"",passing_score:""},student_course_evaluate_content:i.student_course_evaluate_content||{evaluate_type:"star",questionnaire_id:"",questionnaire_name:"",total_score:"",passing_score:""}},assess:{is_open_offline_assessment:i.is_open_offline_assessment,assessment_total_score:i.assessment_total_score,assessment_pass_score:i.assessment_pass_score},user_has_attendanted:l?!1:i.user_has_attendanted}),P=(i,l)=>{var p=[];return l?i.attendance_course_vo.forEach(c=>{p.push((0,d.Z)((0,d.Z)({},c),{},{course_id:"",course_key:c.course_id}))}):p=i.attendance_course_vo,{courseId:i.courseId,directors:i.director?i.director.map(c=>c):i.directors,id:l?"":i.id,name:i.name,qrcode_type:i.qrcode_type,relate_course_list:p,sign_in_begin_time:i.sign_in_begin_time?(0,H.p6)(i.sign_in_begin_time,"yyyy-MM-dd hh:mm:ss"):"",sign_in_end_time:i.sign_in_end_time?(0,H.p6)(i.sign_in_end_time,"yyyy-MM-dd hh:mm:ss"):"",sign_out_begin_time:i.sign_out_begin_time?(0,H.p6)(i.sign_out_begin_time,"yyyy-MM-dd hh:mm:ss"):"",sign_out_end_time:i.sign_out_end_time?(0,H.p6)(i.sign_out_end_time,"yyyy-MM-dd hh:mm:ss"):"",source_type:i.source_type,remind_directors:i.remind_directors,advance_minute:i.advance_minute,user_has_attendanted:l?!1:i.user_has_attendanted,relate_course:i.relate_course,address:i.address,longitude:i.longitude,latitude:i.latitude,address_detail:i.address_detail,sign_range:i.sign_range}};function R(i){return Object.prototype.toString.call(i)==="[object Object]"}function ee(i){return i.replace(/[A-Z]/g,l=>"_".concat(l.toLowerCase()))}function te(i){if(!R(i))return i;for(var l={},p=Object.keys(i),c=0,_=p;c<_.length;c++){var o=_[c],e=i[o];o=ee(o),l[o]=R(e)?te(e):e}return l}var z=i=>{var l=te(i),p=l.id,c=l.name,_=l.requirement,o=l.resource_id,e=l.is_self_evaluate,t=l.is_lock,g=l.begin_time_unlock,h=l.end_time_unlock,n=l.questionnaire_id,a=l.evaluate_form_title,r=l.before_start_day,s=l.before_start_repeat,m=l.before_start_un_remind,b=l.before_end_day,C=l.before_end_repeat,I=l.before_end_un_remind,$=l.after_end_day,q=l.after_end_repeat,Q=l.after_end_un_remind,G=l.is_passed_standards,ne=l.is_passed_option_three,ae=l.pass_standard_conditions,B=l.pass_standards_number,oe=l.creator_user;return{id:p,name:c,requirement:_,resource_id:o,is_lock:t,begin_time_unlock:g,end_time_unlock:h,is_self_evaluate:e,questionnaire_id:n,evaluate_form_title:a,before_start_day:r,before_start_repeat:s,before_start_un_remind:m,before_end_day:b,before_end_repeat:C,before_end_un_remind:I,after_end_day:$,after_end_repeat:q,after_end_un_remind:Q,is_passed_standards:G,is_passed_option_three:ne,pass_standard_conditions:ae,pass_standards_number:B,creator_user:oe}},ie=i=>({courseId:i.course_id,duration:i.duration,teacherName:i.live_lesson.teacher_name,startTime:i.live_lesson.live_start_time,endTime:i.live_lesson.live_end_time})},85424:function(se,X,u){"use strict";var U=u(57361),d=u(14965),K=u(11448),f=u(9754),F=u.n(f),j=u(12924),T=u.n(j),H=u(91768),v=u(80991),O=u(84874),Z=u(37055),Y=u(10237),D=u(78138),x=u.n(D),J=u(53009),W=K.Z.RangePicker;class V extends T().Component{constructor(L){var S;super(L);S=this,this.getHourClass=function(){var E=(0,U.Z)(F().mark(function k(w){var M,A,N,P,R,ee;return F().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if(!(S.props.formik.values.stages&&S.props.formik.values.stages.length>0)){z.next=3;break}return S.setState({stages:S.props.formik.values.stages}),z.abrupt("return");case 3:if(w){z.next=5;break}return z.abrupt("return");case 5:return M=Z.ZP.EditStudyProject.getProjectInfo(w),z.next=8,Y.WY.get({url:M});case 8:A=z.sent,N=A.data,P=N.stages,R=N.stage_error_list,P=(0,J.$x)((0,J.tT)(P),R.length>0?R:[]),ee=S.handleStages(P),S.props.formik.setFieldValue("stages",ee,!1),S.setState({stages:ee});case 14:case"end":return z.stop()}},k)}));return function(k){return E.apply(this,arguments)}}(),this.handleStages=E=>{var k=E.map(w=>({id:w.hourClassId,stage_name:w.name,studyTime:[w.hourClassStartTime?x()(w.hourClassStartTime):null,w.hourClassEndTime?x()(w.hourClassEndTime):null],resources:w.list.map(M=>({course_id:M.id,resource_name:M.name,content_type:M.icon,unlockTime:M.unlocking_time?x()(M.unlocking_time):null,type:M.type}))}));return k},this.changeTime=(E,k,w)=>{this.state.stages.length!==0&&(this.state.stages[w].studyTime=E||["",""],this.setState({stages:this.state.stages},()=>{this.props.formik.setFieldValue("stages",this.state.stages),this.props.formik.setFieldTouched("stages",!0)}))},this.changeDate=(E,k,w,M)=>{this.state.stages.length!==0&&(this.state.stages[w].resources[M].unlockTime=E||"",this.setState({stages:this.state.stages},()=>{this.props.formik.setFieldValue("stages",this.state.stages),this.props.formik.setFieldTouched("stages",!0)}))},this.disabledDateStage=E=>{var k=this.props.formik.values.dateRange,w=k.startTime,M=k.endTime;return E&&E<x()(x()(w).format("YYYY-MM-DD 00:00:00"))||E<x()().subtract("day",1)||E>x()(x()(M).format("YYYY-MM-DD 23:59:59"))},this.disabledDateResource=(E,k)=>{var w=k[0],M=k[1];return E&&E<x()(x()(w).format("YYYY-MM-DD 00:00:00"))||E<x()().subtract("day",1)||E>x()(x()(M).format("YYYY-MM-DD 23:59:59"))},this.state={stages:[]}}componentDidMount(){this.getHourClass(this.props.Id)}render(){var L=this.props,S=L.formik,E=S.errors,k=S.touched,w=L.t,M=this.state.stages;return T().createElement("div",{style:{marginBottom:"10px"}},M.map((A,N)=>!A.resources.every(P=>P.type==="xx"||P.type==="jobEvaluation")&&T().createElement("div",{className:"hour",key:A.id},T().createElement("div",{className:"hour-title"},T().createElement("span",null,A.stage_name,"\uFF1A"),T().createElement("div",{className:"".concat(k.stages&&E.stages&&E.stages[A.id]?"StageHourClassError":"")},T().createElement("span",null,w("assgin.learnTime"),"\uFF1A"),T().createElement(W,{className:"stage_hour",format:"YYYY-MM-DD HH:mm",disabledDate:this.disabledDateStage,disabled:this.props.disabled,value:A.studyTime,onChange:(P,R)=>this.changeTime(P,R,N),showTime:!0,style:{width:"350px"}}))),T().createElement("div",{className:"table"},T().createElement("p",{className:"table-title"},w("learning.learningElectiveAddContent")),T().createElement("div",{className:"table-content"},A.resources&&A.resources.map((P,R)=>P.type!=="xx"&&P.type!=="jobEvaluation"&&T().createElement("div",{key:P.course_id,className:"table-row ".concat(k.stages&&E.stages&&E.stages[P.course_id]?"HourClassError":""),style:R===A.resources.length-1?{}:{borderBottom:"1px solid #EBECF3"}},T().createElement("div",{className:"table-label"},T().createElement("span",{className:"courseware__right__list__icon"},T().createElement(O.Z,{iconClass:P.content_type})),P.resource_name),T().createElement(K.Z,{className:"unlock_Hour",showTime:!0,disabledDate:ee=>this.disabledDateResource(ee,A.studyTime),size:"small",showNow:!1,value:P.unlockTime,disabled:this.props.disabled,format:"YYYY-MM-DD HH:mm",placeholder:w("assgin.unLockTimeLabel"),onChange:(ee,te)=>this.changeDate(ee,te,N,R),style:{width:"224px"}}))))),k.stages&&E.stages&&E.stages[N]&&T().createElement("p",{className:"error_tips_red"},E.stages[N]))))}}X.Z=(0,v.$j)((0,H.Z)()(V))},3652:function(se,X,u){"use strict";var U=u(22385),d=u(31097),K=u(88983),f=u(47933),F=u(12924),j=u.n(F),T=u(43859),H=u(80991),v=u(91768),O=u(68628),Z=u(3407),Y=u(6793);class D extends j().Component{constructor(){super(...arguments);this.onChange=J=>{this.props.onChange(J.target.value)}}render(){var J=this.props,W=J.value,V=J.t,y=(0,Y.me)();return j().createElement(f.ZP.Group,{onChange:this.onChange,value:W},j().createElement(f.ZP,{value:"free_mode"},Z.Z[y].assgin.freeSchema),j().createElement(f.ZP,{value:"unlock_mode"},Z.Z[y].assgin.UnlockPattern,j().createElement(d.Z,{title:V("assgin.noSupport")},j().createElement(O.Z,{style:{marginLeft:10}}))),j().createElement("span",{style:{color:"#AFB5D2"}},V("assgin.tipOfflineTraining")))}}X.Z=(0,T.Z)((0,H.$j)((0,v.Z)()(D)))},62821:function(se,X,u){"use strict";u.d(X,{C:function(){return H}});var U=u(93485),d=u(33565),K=u(78138),f=u.n(K),F=u(3407),j=u(6793),T=(0,j.me)(),H=(O,Z,Y)=>{var D={},x=Z.dateRange,J=x.startTime,W=x.endTime,V=(0,U.Z)(Z.stages.entries()),y;try{for(V.s();!(y=V.n()).done;){var L=y.value,S=(0,d.Z)(L,2),E=S[0],k=S[1];if(!k.resources.every(N=>N.type==="xx"||N.type==="jobEvaluation")){if(!k.studyTime[0]||!k.studyTime[1]){D[E]=F.Z[T].assgin.selectStudyTime,D[k.id]=!0;continue}if(k.studyTime[0].valueOf()==k.studyTime[1].valueOf()){D[E]=F.Z[T].assgin.startEquality,D[k.id]=!0;continue}if((J||W)&&(k.studyTime[0]&&k.studyTime[0]<f()(v(J,"start"))||k.studyTime[1]>f()(v(W,"end")))){D[E]=Y=="study"?F.Z[T].assgin.studyTimeRangeStudy:F.Z[T].assgin.selectStudyTimeRange,D[k.id]=!0;continue}var w=(0,U.Z)(k.resources),M;try{for(w.s();!(M=w.n()).done;){var A=M.value;if(!(A.type==="xx"||A.type==="jobEvaluation")){if(!A.unlockTime){D[E]=F.Z[T].assgin.unLockTime,D[A.course_id]=!0;continue}if(A.unlockTime<f()(v(k.studyTime[0],"start"))||A.unlockTime>f()(v(k.studyTime[1],"end"))){D[E]=F.Z[T].assgin.unLockRange,D[A.course_id]=!0;continue}}}}catch(N){w.e(N)}finally{w.f()}}}}catch(N){V.e(N)}finally{V.f()}return Object.keys(D).length?D:""},v=(O,Z)=>f()(O).format("YYYY-MM-DD HH:mm:".concat(Z==="start"?"00":"59"))},70033:function(se,X,u){"use strict";u.r(X),u.d(X,{default:function(){return g}});var U=u(12924),d=u.n(U),K=u(57663),f=u(71577),F=u(62029),j=u(34792),T=u(48086),H=u(57361),v=u(9754),O=u.n(v),Z=u(91768),Y=u(76651),D=u(28216),x=u(80991),J=u(78138),W=u.n(J),V=u(57068),y=u(7584),L=u(62615),S=u(52670),E=u(4408),k=u(3407),w=u(34773),M=u(6793),A=u(2396),N=u(85424),P=u(62821),R=u(3652),ee=u(92333),te=u(88986),z=u(43859),ie=u(7653);class i extends d().Component{constructor(n){super(n);this.userChange=a=>{this.setState({userList:a}),this.props.onFieldChange((0,te.Z)((0,te.Z)({},this.props.defaultFieldList),{},{supervisorUserList:a}))},this.state={userList:[]}}render(){var n=this.props,a=n.defaultFieldList,r=n.disabled,s=r===void 0?!1:r,m=n.createUserId,b=m===void 0?"":m,C=n.t;return d().createElement("div",{className:"add-supervision"},d().createElement("div",{className:"add-supervision-list"},d().createElement(ie.Z,{onChange:this.userChange,createUserId:b,defaultChecked:a.supervisorUserList,disabled:s,addBtnText:C("assgin.addSynergy")})))}}var l=(0,z.Z)((0,Z.Z)()(i)),p=h=>{var n=h.user;return{user:n}},c={labelCol:{xs:{span:24},sm:{span:3}},wrapperCol:{xs:{span:24},sm:{span:21}}},_={labelCol:{xs:{span:24},sm:{span:0}},wrapperCol:{xs:{span:24},sm:{span:24}}};class o extends d().Component{constructor(n){var a;super(n);a=this,this.onSubmit=function(){var r=(0,H.Z)(O().mark(function s(m,b){var C,I;return O().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:C=(0,w.b)(m.employeeRange.rangeList),b.setSubmitting(!0),I={plan_title:(0,M.fy)(m.plan_title),plan_begin_time:W()(m.dateRange.startTime).valueOf(),plan_end_time:W()(m.dateRange.endTime).valueOf(),department_ids:C.deptIds,user_ids:C.userIds,post_ids:C.postIds,group_ids:C.groupIds,ding_group_ids:C.clusterIds,is_notice_all:!1,supervisor_ids:m.supervisor.supervisorUserList.map(Q=>Q.id),schedule_setting:m.schedule_setting,stages:m.schedule_setting==="free_mode"?[]:m.stages.map(Q=>({id:Q.id,start_time:W()(Q.studyTime[0]).valueOf(),end_time:W()(Q.studyTime[1]).valueOf(),resources:Q.resources.map(G=>({course_id:G.course_id,unlocking_time:W()(G.unlockTime).valueOf()}))}))},(0,ee.WZ)(I,a.state.projectId).then(Q=>{b&&b.setSubmitting(!1),Q.data.id&&Y.m8.push("/knowledgeBase/learningResources/studyProject")}).catch(Q=>{var G=Q.response.data,ne=G.code,ae=G.message;ne==="enterpriseapi.542003"&&T.default.error(ae),b&&b.setSubmitting(!1)});case 4:case"end":return q.stop()}},s)}));return function(s,m){return r.apply(this,arguments)}}(),this.inputValidate=r=>{var s=(0,M.me)(),m=k.Z[s].validation.pleaseEnter,b=k.Z[s].validation.limitedSixty;return(0,M.fy)(r)?(0,M.fy)(r).length>60?b:"":m},this.dateValidate=r=>{var s=(0,M.me)(),m=k.Z[s].validation.dateRange,b=k.Z[s].assgin.startEquality;return!r.startTime||!r.endTime?m:W()(r.startTime).valueOf()==W()(r.endTime).valueOf()?b:""},this.cancelEdit=()=>{Y.m8.push("/knowledgeBase/learningResources/studyProject")},this.state={projectId:""},this.assignFormRef=d().createRef(),this.initialValues={plan_title:"",dateRange:{startTime:"",endTime:""},stages:[],schedule_setting:"free_mode",employeeRange:{rangeType:"",rangeList:{dept:[],post:[],group:[],user:[],cluster:[],classes:[]}},supervisor:{supervisorUserList:[],isChecked:!1}}}componentDidMount(){var n=V.parse(Y.m8.location.search),a=n.id,r=a===void 0?"":a;this.setState({projectId:r})}render(){var n=this.props.t;return d().createElement("div",{className:"assgin-edit test-form"},d().createElement(E.Z,{title:n("documentTitle.projectsAssigned")}),d().createElement("div",{className:"form-page-container"},d().createElement("p",{className:"form-text"},n("assgin.assginSetting")),d().createElement("div",{className:"form-content"},d().createElement(x.J9,{ref:this.assignFormRef,initialValues:this.initialValues,onSubmit:this.onSubmit,render:a=>d().createElement(x.l0,null,d().createElement("div",{className:"cl-form__sectitle in_margin"},n("exam.basicInformation")),d().createElement(x.gN,(0,F.Z)({},c,{required:!1,name:"plan_title",validate:r=>(0,A.QK)(r,n("validation.pleaseEnter")),label:n("exam.taskName"),component:y.Z,type:"text",maxLength:60,placeholder:n("validation.pleaseEnter")})),d().createElement(x.gN,(0,F.Z)({},c,{required:!1,displayType:"Custom",name:"dateRange",className:"dateRange",validate:r=>this.dateValidate(r),label:n("assgin.learnTime"),component:L.C0,defaultFieldList:a.values.dateRange})),d().createElement("div",{className:"cl-form__sectitle in_margin",style:{marginTop:"44px"}},n("assgin.curriculumSetting")),d().createElement(x.gN,(0,F.Z)({},c,{required:!1,name:"schedule_setting",label:"",component:R.Z,defaultFieldList:a.values.dateRange})),a.values.schedule_setting==="free_mode"?d().createElement("div",null):d().createElement(x.gN,(0,F.Z)({},_,{required:!1,name:"stages",label:"",displayType:"Custom",Id:this.state.projectId,component:N.Z,validate:r=>(0,P.C)(r,a.values,"study")})),d().createElement(x.gN,(0,F.Z)({label:n("assgin.assignRange"),component:L.ww,className:"assign-project",showSectitle:!1,validate:S.FI,displayType:"Custom",name:"employeeRange",defaultFieldList:a.values.employeeRange,mode:["part"],orgProps:{useGroups:!0}},c)),d().createElement(x.gN,(0,F.Z)({className:"synergy",component:l,displayType:"Custom",name:"supervisor",label:n("assgin.collaborativePeople"),createUserId:this.props.user.id,defaultFieldList:a.values.supervisor},c)),d().createElement("div",{className:"cl-form-fixed-footer"},d().createElement("div",{className:"cl-form-fixed-footer__container"},d().createElement(f.Z,{className:"form-page-container-bottom-btn",loading:a.isSubmitting,type:"primary",htmlType:"submit"},n("common.save")),d().createElement(f.Z,{className:"form-page-container-bottom-btn",onClick:this.cancelEdit},n("common.cancel")))))}))))}}var e=(0,D.$j)(p)((0,Z.Z)()(o));class t extends d().Component{render(){return d().createElement(e,null)}}var g=t},92333:function(se,X,u){"use strict";u.d(X,{WZ:function(){return T},tx:function(){return H},en:function(){return v},wv:function(){return O},a1:function(){return Z},eP:function(){return Y},IO:function(){return D}});var U=u(88986),d=u(37055),K=u(10237),f=u(38642),F={zaraFlag:(0,f.UI)("ZARA_H5")};function j(y){var L=y.sign,S=L===void 0?!1:L,E=y.id,k=y.save_step,w=y.base_info,M=y.stages,A=y.stage_content,N=y.settings,P=S?CONFIG.EditStudyProject.editProjectUpgrade(S):CONFIG.EditStudyProject.addProjectUpgrade();F.zaraFlag&&(P=S?CONFIG.StudyProjectWithAssessment.editProject(S):CONFIG.StudyProjectWithAssessment.addProject());var R={save_step:k};return E&&(R.id=E),w&&(R.base_info=w),A&&(R.stage_content=A),M&&(R.stages=M),N&&(R.settings=N),request.post({url:P,data:R})}function T(y,L){var S=d.ZP.StudyProjectList.assignProject(L);return K.WY.post({url:S,data:y})}function H(y,L,S){return K.WY.get({url:d.ZP.aiTrain.camp_periods(),params:(0,U.Z)((0,U.Z)({project_id:y},L),S)})}function v(y){return K.WY.post({url:d.ZP.aiTrain.delete(y)})}function O(y,L){return K.WY.post({url:d.ZP.aiTrain.change_status(y),data:{status:L}})}function Z(y,L){return K.WY.post({url:d.ZP.aiTrain.save(),data:(0,U.Z)({project_id:y},L)})}function Y(y,L,S){return K.WY.post({url:d.ZP.aiTrain.edit(L),data:(0,U.Z)({project_id:y},S)})}function D(y){return K.WY.get({url:d.ZP.aiTrain.query(y)})}function x(y){return request.post({url:CONFIG.aiTrain.apply(y)})}function J(){return request.get({url:CONFIG.ahLaboratory.getLaboratoryList()})}function W(y){return request.post({url:CONFIG.ahLaboratory.addLabSelectList(),data:{project_lab_mapping_list:y}})}function V(y){var L=y.project_id;return request.get({url:CONFIG.ahLaboratory.getLabSelectList(),params:{project_id:L}})}}}]);
