(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[3034],{67620:function(Ce,k,t){"use strict";var V=t(34792),G=t(48086),ee=t(12924),$=t.n(ee),I=t(19222),J=t.n(I),Y=t(32407),F=t(37055),te=F.ZP.Common.editorUpload(),N="cl_editor_toolbar_default",g="cl_editor_content_default";class D extends ee.Component{constructor(s){super(s);this.initEditor=()=>{this.editor=new(J())(".".concat(this.props.toolbarCls),".".concat(this.props.contentCls)),this.editor.config.zIndex=10,this.editor.config.onfocus=()=>{var e=document.querySelector(".".concat(this.props.contentCls));e&&(e.style.minHeight=this.props.contentHeight,e.style.height="auto")},this.editor.config.onblur=()=>{var e=document.querySelector(".".concat(this.props.contentCls));e&&(e.style.height=this.props.contentHeight)},this.editor.config.menus=this.props.controls,this.editor.config.placeholder=this.props.placeholderContent||Y.Z.t("component.pleaseEnterText"),this.editor.config.onchange=e=>{this.props.onChange&&this.props.onChange(e)},this.editor.config.onchangeTimeout=300,this.editor.config.uploadImgServer=te,this.editor.config.uploadImgMaxLength=5,this.editor.config.uploadImgParams={access_token:window.localStorage.getItem("token")},this.editor.config.uploadFileName="files",this.editor.config.uploadImgHooks={customInsert(e,A){var T=A.data;T.forEach(z=>{e(z)})}},this.editor.config.pasteTextHandle=function(e){return~e.indexOf("<!--[if gte mso 9]><xml>")||~e.indexOf("<spanyes")?"\u7C98\u8D34\u5185\u5BB9\u6709\u4E71\u7801\uFF0C\u8BF7\u4F7F\u7528ctrl+shift+v\u6765\u7C98\u8D34\u5185\u5BB9(mac\u8BF7\u4F7F\u7528command+shift+v)":e},this.editor.config.focus=!1,this.editor.config.uploadImgMaxSize=3*1024*1024,this.editor.config.uploadImgAccept=["jpg","jpeg","png","gif","bmp"],this.editor.config.showLinkImg=!1,this.editor.config.customAlert=function(e,A){switch(A){case"success":G.default.success(e);break;case"info":G.default.info(e);break;case"warning":G.default.warning(e);break;case"error":G.default.error(e);break;default:G.default.info(e);break}},this.editor.create(),this.editor.txt.html("".concat(this.props.placeholder))},this.getHtml=()=>this.editor.txt.html(),this.getText=()=>this.editor.txt.text(),this.setHtml=e=>this.editor.txt.html(e),this.editor=null}componentDidMount(){this.initEditor()}render(){var s=this.props.toolbarCls?"".concat(this.props.toolbarCls," cl_editor_toolbar"):"".concat(N," cl_editor_toolbar"),e=this.props.contentCls?"".concat(this.props.contentCls," cl_editor_content"):"".concat(g," cl_editor_content");return $().createElement($().Fragment,null,$().createElement("div",{className:s}),$().createElement("div",{className:e,style:{height:this.props.contentHeight,minHeight:this.props.contentHeight}}))}}D.defaultProps={controls:["head","bold","fontSize","fontName","italic","underline","strikeThrough","foreColor","backColor","link","list","justify","quote","emoticon","image","table","video","code","undo","redo"],placeholder:"\u5185\u5BB9\u7F16\u8F91\u533A\u57DF",toolbarCls:N,contentCls:g,contentHeight:"300px",placeholderContent:""},k.Z=D},26697:function(Ce,k,t){"use strict";var V=t(71194),G=t(57016),ee=t(57663),$=t(71577),I=t(34792),J=t(48086),Y=t(57361),F=t(9754),te=t.n(F),N=t(12924),g=t.n(N),D=t(91768),Q=t(10237),s=t(28216),e=t(37055);class A extends g().Component{constructor(z){var X;super(z);X=this,this.dealData=()=>{this.setState({recordList:this.props.record})},this.getPostTree=(0,Y.Z)(te().mark(function y(){var U;return te().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.next=2,Q.WY.get({url:e.ZP.LibraryList.listByLevel(),params:{level:2,is_layered:"true"}});case 2:U=B.sent,U&&X.setState({treeData:U.data});case 4:case"end":return B.stop()}},y)})),this.AIsure=function(){var y=(0,Y.Z)(te().mark(function U(M){var B,ce;return te().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return B=[],X.state.recordList.forEach(E=>{E.ai_resources.forEach(de=>{(de.ai_upgrade_status==="not"||de.ai_upgrade_status==="ai_failed")&&B.push({classify_id:M?de.categoryId:"",resourceId:de.resource_id,course_id:E.course_id})})}),_.next=4,Q.WY.post({url:e.ZP.LibraryList.batchSubmit(),data:{resourceClassifyVoList:B}});case 4:ce=_.sent,ce&&(J.default.success(X.props.t("study.operateSuccess")),X.props.onCancel(!M));case 6:case"end":return _.stop()}},U)}));return function(U){return y.apply(this,arguments)}}(),this.handleChange=(y,U)=>{var M=[];M=this.state.recordList.map(B=>{var ce=B;return ce.ai_resources.map(re=>{var _=re;return re.resource_id===U.resource_id&&(_.categoryId=_.categoryId==y.id?"":y.id),_}),ce}),this.setState({recordList:M})},this.state={recordList:[],treeData:[]},this.operateResourceItem=""}componentDidMount(){this.dealData(),this.getPostTree()}render(){var z=localStorage.getItem("themeColor")||"#465dcd";return g().createElement(G.Z,{title:"".concat(this.props.t("course.chooseAICategory")),visible:this.props.visible,onCancel:()=>this.props.onCancel(),className:"AIAllCourseModal",width:900,footer:null},this.props.visible&&g().createElement("div",{className:"AI-course-modal"},g().createElement("p",null,this.props.t("course.AIValue")),g().createElement("p",null,this.props.t("course.AITip")),g().createElement("div",{className:"AICategory-main"},this.state.recordList.map(X=>g().createElement("ul",{className:"AI-course-list"},X.ai_resources.map(y=>g().createElement("li",null,g().createElement("div",{className:"course-list-name"},y.name),this.state.treeData.map(U=>U.children.length?g().createElement("div",{className:"tabs-box"},g().createElement("p",null,U.name,"\uFF1A"),g().createElement("ul",{className:"tabs"},U.children.map(M=>g().createElement("li",{onClick:()=>this.handleChange(M,y),className:y.categoryId===M.id?"active":"",style:y.categoryId===M.id?{backgroundColor:z}:{}},M.name)))):null)))))),g().createElement("div",{className:"cl-form-fixed-footer__container"},g().createElement($.Z,{className:"form-page-container-bottom-btn",onClick:()=>this.props.onCancel()},this.props.t("common.cancel")),g().createElement($.Z,{type:"primary",onClick:()=>this.AIsure(!0)},this.props.t("course.AICut")),g().createElement($.Z,{type:"primary",onClick:()=>this.AIsure()},this.props.t("course.ManualCut")))))}}k.Z=(0,s.$j)()((0,D.Z)()(A))},29284:function(Ce,k,t){"use strict";t.d(k,{lL:function(){return w},kI:function(){return ge},yX:function(){return se},UW:function(){return ne},Rv:function(){return ae},gg:function(){return P},_z:function(){return v},mh:function(){return H},RQ:function(){return ze},J$:function(){return x},_D:function(){return R}});var V=t(62029),G=t(62350),ee=t(75443),$=t(22385),I=t(31097),J=t(57663),Y=t(71577),F=t(88986),te=t(57361),N=t(34792),g=t(48086),D=t(9754),Q=t.n(D),s=t(12924),e=t.n(s),A=t(91768),T=t(94184),z=t.n(T),X=t(28216),y=t(76651),U=t(57068),M=t(80991),B=t(36546),ce=t(44289),re=t(1164),_=t(76466),E=t(84874),de=t(86458),oe=t(37055),q=t(74262),Se=t(10780),L=t(6793),b=t(86726),he=f=>({userInfo:f.user,documentStudyLimit:f.advancedSetting.documentStudyLimit});class ve extends e().Component{constructor(d){var c;super(d);c=this,this.handleSelectCourseware=()=>{this.props.defaultFieldList.length>=50?g.default.warning(this.props.t("course.courseDetailResourceLimit")):this.setState({visible:!0})},this.handleUploadFileSuccess=a=>{var u=this.state,p=u.uploadShow,m=u.list,O=this.props.defaultFieldList,C=[...m,...a];if(O.length+a.length>50){g.default.warning(this.props.t("course.courseDetailResourceLimit"));return}Object.assign(p,{visible:!1}),this.setState({uploadShow:p,list:C},()=>{this.triggerChange(C)})},this.handleUploadClose=()=>{var a=this.state.uploadShow;Object.assign(a,{visible:!1}),this.setState({uploadShow:a})},this.handleChooseFiles=(0,te.Z)(Q().mark(function a(){var u,p,m;return Q().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return u=c.props.t,C.next=3,(0,L.x8)("quota_source_book",u("course.sourceValidateLimit",{courseType:u("documentTitle.matter")}));case 3:if(p=C.sent,!p){C.next=6;break}return C.abrupt("return");case 6:m=c.state.uploadShow,Object.assign(m,{visible:!0}),c.setState({uploadShow:m});case 9:case"end":return C.stop()}},a)})),this.handleOk=a=>{var u=[...this.state.list].concat(a),p=(0,L.Cj)(u);if(p.length>50){g.default.warning(this.props.t("course.courseDetailResourceLimit"));return}this.setState({list:p,visible:!1},()=>{this.triggerChange(p)})},this.handleCancel=()=>{this.setState({visible:!1})},this.handleAddArticle=()=>{re.Z.targetTo({path:"/training/resourceManage/library/articleDetail?classifyId=0"})},this.triggerChange=a=>{this.props.formik.setFieldValue("resource",a);var u=0;u+=a.filter(p=>["h5","txt","doc","docx","xls","xlsx","pdf","ppt","pptx"].indexOf(p.type)>0).length,this.props.formik.setFieldValue("studyLimit",(0,F.Z)((0,F.Z)({},this.props.formik.values.studyLimit),{},{checked:this.props.documentStudyLimit!==0&&u>0}))},this.dealWatchType=a=>{var u=oe.Yq.findIndex(ie=>a.type.toLowerCase().includes(ie))>-1,p=oe.WB.indexOf(a.type.toLowerCase())>-1,m=oe.SR.indexOf(a.type.toLowerCase())>-1||a.contentType.indexOf("html")>-1,O=a.contentType.indexOf("scorm")>-1,C=a.contentType.indexOf("video")>-1,K=oe.Ss.indexOf(a.contentType)>-1,Z=a.contentType.indexOf("h5")>-1,j="";return Z?j="article":u?j="doc":C||K?j="video":p?j="image":m?j="html":O&&(j="scorm"),j},this.handlePreview=a=>{var u=a.item,p=this.state.previewInfo,m=u.data||u,O=m.status===1||m.status===2;if(O){g.default.warning(this.props.t("resourceLibrary.transcodingPlayerTip"));return}var C=this.dealWatchType(m),K=oe.Ss.indexOf(m.contentType)>-1;if(m.type==="mp4"&&m.aiUpgradeStatus==="finish"){y.m8.push({pathname:"/training/resourceManage/library/videoPreview",search:U.stringify({id:m.id})});return}if(C==="article"){var Z=m.contentType,j=m.url,ie=Z==="h5/link";ie?re.Z.targetTo({path:j,isExternalLink:!0}):re.Z.targetTo({path:"/training/resourceManage/library/articlePreview?id=".concat(m.id)});return}var le={mode:"preview",watchType:C};C==="doc"?Object.assign(le,{resourceInfo:{type:"",docType:m.type,aliUrl:m.path,url:m.url,docTitle:m.name,playId:m.videoId||m.video_id,storageType:m.storage_type}}):C==="image"?Object.assign(le,{resourceInfo:{url:m.url,playId:m.videoId||m.video_id,storageType:m.storage_type}}):C==="html"?Object.assign(le,{resourceInfo:{url:m.url}}):Object.assign(le,{resourceInfo:{source:{FD:m.url,OD:m.path},originUrl:m.url,contentType:K?"mp3":m.type,playId:m.videoId||m.video_id,storageType:m.storage_type},autoPlay:!0,draggable:!0}),this.setState({resourcePlayInfo:le,previewInfo:(0,F.Z)((0,F.Z)({},p),{},{title:m.name,visible:!0,onCancel:this.cancelPreview})})},this.cancelPreview=()=>{var a=this.state.previewInfo;this.setState({resourcePlayInfo:{mode:"preview",watchType:"",resourceInfo:{}},previewInfo:(0,F.Z)((0,F.Z)({},a),{},{visible:!1})})},this.handleDelete=a=>{var u=[...this.state.list],p=u.findIndex(m=>m.id===a);p>-1&&u.splice(p,1),this.setState({list:u}),this.triggerChange(u)},this.handleDND=(a,u)=>{var p=this.state.list,m=p[a];p.splice(a,1),p.splice(u,0,m),this.setState({list:p})},this.generateCourseSelecorList=a=>{var u=[];return a.forEach(p=>{p.componentName==="CoursewareSelector"&&u.push({id:p.id,name:p.name,componentName:"CoursewareSelector",data:p.data,icon:oe.e1[p.type],type:p.type,duration:p.data.duration})}),u},this.renderTitle=()=>{var a=(0,b.V9)("courseManage",this.props.userInfo.modules),u=(0,b.H3)("make_interactive_video",a),p=this.props,m=p.prefixCls,O=p.formik,C=p.t,K=p.userInfo,Z=this.state.list,j=K.appType,ie=O.values.relationPlan,le=localStorage.getItem("themeColor")||"#465dcd",xe=0;return Z.forEach(Te=>{var ye=Te.data?Te.data:Te;ye.contentType.includes("video")&&ye.status&&ye.status===3&&ye.privatization==="public"&&(xe+=1)}),e().createElement("h1",{className:"".concat(m,"__title")},C("course.courseDetailResource"),ie?null:this.renderHeaderAction(),xe>0&&u&&j!=="wx_app"&&e().createElement(I.Z,{placement:"top",title:C("course.interactiveVideoEdit")},e().createElement(Y.Z,{className:"text-btn interactiveInter",style:{color:le},onClick:()=>this.props.handleSubmit("")},C("course.createInteractiveVideo"))))},this.renderHeaderAction=()=>{var a=this.props.t;return e().createElement("div",{className:"action-container"},e().createElement(Y.Z,{type:"primary",className:"qa-course-library-selection-button",onClick:this.handleSelectCourseware},e().createElement(E.Z,{iconClass:"iconf-course-library",color:"#fff",size:"14px"}),a("course.courseDetailResourceCS")),e().createElement(Y.Z,{type:"primary",className:"qa-local-upload-button",onClick:this.handleChooseFiles},e().createElement(E.Z,{iconClass:"iconf-folder",color:"#fff",size:"14px"}),a("course.courseDetailResourceUP")))},this.renderContent=()=>{var a=this.props.prefixCls,u=this.state.list;return e().createElement("ul",{className:"".concat(a,"__content")},u.map((p,m)=>this.renderItem(p,m)))},this.renderTooltip=a=>{var u=this.props.t;return a.status===3&&(a.type==="mp4"||a.type==="mp3")?e().createElement("span",{className:"item__duration"},(0,L.xj)(a.duration)):a.status&&a.status!==3?e().createElement("span",{className:"resource-item-duration"},"--:--:--",e().createElement(I.Z,{placement:"top",title:u("course.transcodingStudyLimit")},e().createElement("span",null,e().createElement(E.Z,{iconClass:"icon-f-tipe",color:"#9C9C9F"})))):e().createElement("span",{className:"item__duration"},"--:--:--",e().createElement(I.Z,{placement:"top",title:this.getTitle(a)},e().createElement("span",null,e().createElement(E.Z,{iconClass:"icon-f-tipe",color:"#9C9C9F"}))))},this.getTitleTip=a=>{var u=this.props.t,p=a.data?a.data.privatization:a.privatization;return p!=="public"?u("course.interactiveVideoDisabledC"):a.status!==3?u("course.interactiveVideoDisabledB"):""},this.renderInteractiveVideo=a=>{var u=(0,b.V9)("courseManage",this.props.userInfo.modules),p=(0,b.H3)("make_interactive_video",u),m=this.props.t,O=a.data?a.data.contentType:a.contentType,C=a.data?a.data.privatization:a.privatization,K=a.data?a.data.isInteract:a.isInteract;return O.includes("video")&&a.status&&a.status===3&&C==="public"&&p?e().createElement(I.Z,{placement:"top",title:m("course.interactiveVideoEdit")},e().createElement("span",{className:"interactiveInter interactiveSuccess",onClick:()=>this.props.handleSubmit(a.id)},e().createElement(E.Z,{color:"#4D67E9",iconClass:K?"icon-yikanshipin1":"icon-hudongshipin",size:"16px"}))):O.includes("video")&&p&&(a.status&&a.status===3||C!=="public")?e().createElement(I.Z,{placement:"top",title:this.getTitleTip(a)},e().createElement("span",{className:"interactiveInter interactiveFail"},e().createElement(E.Z,{color:"#E1E0E5",iconClass:"icon-hudongshipin",size:"16px"}))):""},this.getTitle=a=>{var u=this.props.t;return a.type==="h5"?u("course.ArticleStudyLimit"):a.type==="html"||a.type==="jpg"||a.type==="jpeg"||a.type==="png"||a.type==="scorm"?u("common.notSupportSetTime"):u("course.documentStudyLimitTip3")},this.renderItem=(a,u)=>{var p=this.props,m=p.prefixCls,O=p.formik,C=p.t,K=p.userInfo,Z=O.values.relationPlan,j=K.appType,ie=z()(["".concat(m,"__content__list item ").concat(Z?"item-disabled":"")]);return a.type=oe.Ss.indexOf(a.contentType)>-1?"mp3":a.type,e().createElement(de.Z,{id:a.id,key:a.id,title:a.title,content:a.content,index:u,disabled:Z,onDND:this.handleDND},e().createElement("li",{className:ie,key:a.id},e().createElement(E.Z,{iconClass:oe.e1[a.type],size:"16px"}),e().createElement("span",{className:"item__title",onClick:()=>this.handlePreview({item:a})},a.name),this.renderTooltip(a),Z?e().createElement("span",{className:"item__action"},j!=="wx_app"&&this.renderInteractiveVideo(a)):e().createElement("span",{className:"item__action"},j!=="wx_app"&&this.renderInteractiveVideo(a),e().createElement(ee.Z,{title:C("common.confirmDeleteTitle"),onConfirm:()=>this.handleDelete(a.id)},e().createElement("span",{className:"item__action__delete"},e().createElement(E.Z,{iconClass:"iconf-clear",size:"16px"}))),e().createElement("span",{className:"item__action__drag"},localStorage.getItem("dingPersonnel")!=="dingPersonnel"&&e().createElement(E.Z,{iconClass:"iconf-move",size:"19px"})))))},this.state={list:d.defaultFieldList,visible:!1,uploadShow:{visible:!1,title:this.props.t("common.storage"),onSuccess:a=>this.handleUploadFileSuccess(a),onCancel:()=>this.handleUploadClose()},resourcePlayInfo:{mode:"preview",watchType:"",resourceInfo:{},autoPlay:!0,draggable:!0},previewInfo:{visible:!1,destroyOnClose:!0,title:this.props.t("resourceLibrary.previewCourseware"),onCancel:()=>{}}}}render(){var d=this.props.prefixCls,c=this.state,a=c.visible,u=c.list,p=c.uploadShow,m=c.resourcePlayInfo,O=c.previewInfo;return e().createElement("section",{className:"".concat(d)},this.renderTitle(),this.renderContent(),e().createElement(q.Z,(0,V.Z)({isAllowLocal:!0,params:{classifyId:0,bizType:0}},p)),e().createElement(Se.Z,{visible:a,defaultChecked:this.generateCourseSelecorList(u),onOk:this.handleOk,onCancel:this.handleCancel,excludeType:"h5"}),e().createElement(_.Z,(0,V.Z)({},m,{previewInfo:O})))}}ve.defaultProps={prefixCls:"resource"};var Oe=(0,X.$j)(he)((0,B.Z5)(ce.ZP)((0,M.$j)((0,A.Z)()(ve)))),ue=t(31151),Ne=t(60667);class Ee extends e().Component{constructor(){super(...arguments);this.state={visible:!1},this.handleSelectTeacher=()=>{this.setState({visible:!0})},this.handleCancel=()=>{this.setState({visible:!1})},this.handleOk=d=>{var c=d.id,a=d.name,u=d.data;this.props.formik.setFieldValue("teacher",{id:c,name:a,lecturer_sync_user_id:u.lecturer_sync_user_id,lecturer_source_type:u.lecturer_source_type,type:u.type}),this.handleCancel()},this.handleDelete=()=>{this.props.formik.setFieldValue("teacher",{id:0,name:""})}}render(){var d=this.props,c=d.prefixCls,a=d.defaultFieldList,u=a.id,p=a.name,m=a.lecturer_sync_user_id,O=a.lecturer_source_type,C=a.type,K={id:u,name:p,data:{}},Z=localStorage.getItem("themeColor")||"#516AE6";return e().createElement("div",{className:c},p?e().createElement("span",{className:"".concat(c,"__name")},C==="inside"?e().createElement(Ne.Z,{dataType:"userName",value:m,name:p,type:O}):p,e().createElement("span",{className:"".concat(c,"__name__delete"),onClick:this.handleDelete},e().createElement(E.Z,{iconClass:"icon-guanbi1"}))):null,e().createElement("span",{className:"".concat(c,"__add"),style:{borderColor:Z,color:Z},onClick:this.handleSelectTeacher},e().createElement(E.Z,{iconClass:"iconf-add-man"})),e().createElement(ue.Z,{visible:this.state.visible,selected:K,onOk:this.handleOk,onCancel:this.handleCancel}))}}Ee.defaultProps={prefixCls:"teacher"};var fe=(0,M.$j)(Ee),Ke=t(88983),S=t(47933),pe=t(81211);class Ae extends e().Component{render(){var d=this.props,c=d.t,a=(0,pe.Z)(d,["t"]);return e().createElement(S.ZP.Group,(0,V.Z)({name:"originalGroup"},a),e().createElement(S.ZP,{value:1},c("course.courseDetailOriginalTrue"),e().createElement(I.Z,{title:c("course.courseDetailOriginalTrueTip")},e().createElement("span",{style:{marginLeft:"5px"}},e().createElement(E.Z,{iconClass:"iconf-tipe",color:"#D5D8DE",size:"14px"})))),e().createElement(S.ZP,{value:0},c("course.courseDetailOriginalFalse"),e().createElement(I.Z,{title:c("course.courseDetailOriginalFalseTip")},e().createElement("span",{style:{marginLeft:"5px"}},e().createElement(E.Z,{iconClass:"iconf-tipe",color:"#D5D8DE",size:"14px"})))))}}var Me=(0,A.Z)()(Ae),be=t(67620);class me extends e().Component{constructor(d){super(d);this.handleChange=c=>{var a=c;this.setState({introduction:a}),this.triggerChange(a)},this.triggerChange=c=>{this.props.formik.setFieldValue("introduction",{desc:c})},this.getHtml=()=>{var c=this.editorInstance.getHtml();return c},this.state={introduction:d.defaultFieldList.desc}}render(){return e().createElement(be.Z,{ref:d=>this.editorInstance=d,toolbarCls:this.props.toolbarCls,contentCls:this.props.contentCls,placeholder:this.state.introduction,onChange:this.handleChange,controls:["head","bold","fontSize","fontName","italic","underline","strikeThrough","image","undo","redo"]})}}var Fe=(0,M.$j)(me),Ge=t(63185),Ie=t(9676),ke=t(77883),Ze=t(21888);class Re extends e().Component{constructor(){super(...arguments);this.renderText=()=>{var d=this.props.t;return e().createElement("div",null,e().createElement("p",{className:"title"},d("course.documentStudyLimitTip1")),e().createElement("p",{className:"title"},d("course.documentStudyLimitTip2")))},this.handleChangeCheckbox=d=>{var c=d.target.checked;this.props.formik.setFieldValue("studyLimit",{checked:c,limit:this.props.defaultFieldList.limit})},this.handleChangeInput=d=>{this.props.formik.setFieldValue("studyLimit",{checked:this.props.defaultFieldList.checked,limit:d})},this.renderInput=()=>{var d=this.props,c=d.defaultFieldList,a=d.t;return e().createElement("span",null,e().createElement(Ze.Z,{precision:0,min:1,max:9999,value:c.limit,disabled:!c.checked,onChange:this.handleChangeInput}),e().createElement("span",{style:{margin:"0 8px"}},a("course.secByPage"),e().createElement(I.Z,{placement:"top",title:this.renderText},e().createElement("span",null,e().createElement(E.Z,{iconClass:"icon-f-tipe"}))),c.checked?null:e().createElement("span",{style:{marginLeft:"8px"}},a("course.documentStudyLimitTip"))))}}render(){var d=this.props,c=d.defaultFieldList,a=d.shouldSetStudyLimit,u=d.t;return e().createElement(e().Fragment,null,e().createElement(Ie.Z,{onChange:this.handleChangeCheckbox,checked:c.checked,disabled:!a},u("course.documentLearningTime")),this.renderInput())}}var De=(0,M.$j)((0,A.Z)()(Re));class we extends e().Component{constructor(){super(...arguments);this.handleChangeChecbox=d=>{var c=d.target.checked;this.props.formik.setFieldValue("credit",{checked:c,score:this.props.defaultFieldList.score})},this.handleChangeInput=d=>{this.props.formik.setFieldValue("credit",{checked:this.props.defaultFieldList.checked,score:d})},this.renderInput=()=>{var d=this.props.defaultFieldList;return e().createElement("span",null,e().createElement(Ze.Z,{precision:0,min:0,max:999,value:d.score,disabled:!d.checked,onChange:this.handleChangeInput}),this.props.t("course.courseDetailRewardUnit"))}}render(){var d=this.props.defaultFieldList;return e().createElement(e().Fragment,null,e().createElement(Ie.Z,{onChange:this.handleChangeChecbox,checked:d.checked},this.props.t("common.credit")),this.renderInput())}}var Ue=(0,M.$j)((0,A.Z)()(we));class Le extends e().Component{render(){var d=this.props,c=d.t,a=(0,pe.Z)(d,["t"]);return e().createElement(S.ZP.Group,(0,V.Z)({name:"downloadGroup"},a),e().createElement(S.ZP,{value:0},c("course.courseDetailDownloadForbidden")),e().createElement(S.ZP,{value:1},c("course.courseDetailDownloadAllow")))}}var je=(0,A.Z)()(Le);class Ve extends e().Component{render(){var d=this.props,c=d.t,a=(0,pe.Z)(d,["t"]),u=y.m8.location.query.courseId;return e().createElement(e().Fragment,null,e().createElement(S.ZP.Group,(0,V.Z)({name:"completeCourseGroup"},a,{disabled:u}),e().createElement(S.ZP,{value:"all"},c("course.courseDetailCompleteAll")),e().createElement(S.ZP,{value:"onlyOne"},c("course.courseDetailCompleteAny")),e().createElement(I.Z,{title:c("course.courseDetailTip")},e().createElement("span",{className:"stydyTypeTip"},e().createElement(E.Z,{iconClass:"iconf-tipe",color:"#D5D8DE",size:"14px"})))),e().createElement("span",null,c("course.courseDetailInfo")))}}var $e=(0,A.Z)()(Ve);class W extends e().Component{render(){var d=this.props,c=d.t,a=(0,pe.Z)(d,["t"]);return e().createElement(S.ZP.Group,(0,V.Z)({name:"studyType"},a),e().createElement(S.ZP,{value:""},c("course.courseStudyTypeDefault"),e().createElement(I.Z,{title:c("course.courseStudyTypeDefaultTip")},e().createElement("span",{className:"stydyTypeTip"},e().createElement(E.Z,{iconClass:"iconf-tipe",color:"#D5D8DE",size:"14px"})))),e().createElement(S.ZP,{value:"requiredCourse"},c("course.courseStudyTypeTrue"),e().createElement(I.Z,{title:c("course.courseStudyTypeTrueTip")},e().createElement("span",{className:"stydyTypeTip"},e().createElement(E.Z,{iconClass:"iconf-tipe",color:"#D5D8DE",size:"14px"})))),e().createElement(S.ZP,{value:"notRequiredCourse"},c("course.courseStudyTypeFalse"),e().createElement(I.Z,{title:c("course.courseStudyTypeFalseTip")},e().createElement("span",{className:"stydyTypeTip"},e().createElement(E.Z,{iconClass:"iconf-tipe",color:"#D5D8DE",size:"14px"})))))}}var r=(0,A.Z)()(W);class o extends e().Component{render(){var d=this.props,c=d.t,a=(0,pe.Z)(d,["t"]);return e().createElement(S.ZP.Group,(0,V.Z)({name:"downloadGroup"},a),e().createElement(S.ZP,{value:0},c("common.outSync")),e().createElement(S.ZP,{value:1},c("common.synchronization")),e().createElement(I.Z,{title:c("common.scheduleSyncTip")},e().createElement("span",{className:"stydyTypeTip"},e().createElement(E.Z,{iconClass:"iconf-tipe",color:"#D5D8DE",size:"14px"}))))}}var n=(0,A.Z)()(o);class l extends e().Component{render(){var d=this.props,c=d.t,a=(0,pe.Z)(d,["t"]);return e().createElement(S.ZP.Group,(0,V.Z)({name:"commentSwitch"},a),e().createElement(S.ZP,{value:0},c("common.unactivated")),e().createElement(S.ZP,{value:1},c("common.open")))}}var h=(0,A.Z)()(l),i=t(43859),v=(0,i.Z)(Oe),x=(0,i.Z)(fe),P=(0,i.Z)(Me),R=(0,i.Z)(r),ae=(0,i.Z)(Fe),H=(0,i.Z)(De),se=(0,i.Z)(Ue),ne=(0,i.Z)(je),ge=(0,i.Z)($e),ze=(0,i.Z)(n),w=(0,i.Z)(h)},28217:function(Ce,k,t){"use strict";t.r(k),t.d(k,{default:function(){return $e}});var V=t(71194),G=t(57016),ee=t(20228),$=t(11382),I=t(57663),J=t(71577),Y=t(57361),F=t(88986),te=t(34792),N=t(48086),g=t(9754),D=t.n(g),Q=t(12924),s=t.n(Q),e=t(91768),A=t(28216),T=t(80991),z=t(76651),X=t(57068),y=t(62029),U=t(81211),M=t(13062),B=t(71230),ce=t(89032),re=t(15746),_=t(22385),E=t(31097),de=t(94184),oe=t.n(de),q=t(29284),Se=t(19858),L=t(72538),b=t(84874),he=t(37055),ve=t(62615),Oe=t(52670),ue=t(6793),Ne=t(7584),Ee=t(2396),fe=t(86726),Ke=W=>({userInfo:W.user,documentStudyLimit:W.advancedSetting.documentStudyLimit,themeColor:W.advancedSetting.themeColor});class S extends s().Component{constructor(){super(...arguments);this.handleDelete=()=>{var r=this.props,o=r.item,n=r.onDelete;n(o.id)},this.handleToggle=()=>{var r=this.props,o=r.item,n=r.onToggle;n(o.id)},this.getTitleTip=r=>{var o=this.props.t,n=r.data?r.data.privatization:r.privatization;return n!=="public"?o("course.interactiveVideoDisabledC"):r.status!==3?o("course.interactiveVideoDisabledB"):""},this.renderHeader=()=>{var r=this.props,o=r.prefixCls,n=r.values,l=r.isOpened,h=r.t,i=r.themeColor,v="".concat(o,"__header");return s().createElement("header",{className:v},s().createElement(T.gN,(0,y.Z)({component:Ne.Z,name:"title",label:h("course.courseDetailName"),required:!0,type:"text",defaultValue:n.title,style:{width:"745px"},placeholder:h("course.courseDetailNamePlaceholder"),validate:x=>(0,Ee.QK)(x,h("course.courseDetailNamePlaceholder"))},L.I4)),s().createElement("div",{className:"".concat(v,"__action")},s().createElement("span",{className:"".concat(v,"__action__del"),style:{color:i},onClick:this.handleDelete},s().createElement(b.Z,{iconClass:"iconf-delete",color:i,size:"14px"})),s().createElement("span",{className:"".concat(v,"__action__toggle"),style:{color:i},onClick:this.handleToggle},h(l?"common.collapse":"common.expand"),s().createElement(b.Z,{iconClass:"iconf-arrow-up",color:i,size:"14px"}))))},this.renderFooter=()=>{var r=this.props,o=r.prefixCls,n=r.values,l=r.item,h=r.isOpened,i=r.t;if(h)return null;var v="".concat(o,"__footer"),x=n.covers,P=n.employeeRange,R=n.original,ae=n.teacher,H=n.courseClassify;return s().createElement("footer",{className:v},s().createElement("p",{className:"".concat(v,"__courseware")},s().createElement(b.Z,{iconClass:he.e1[l.type],size:"16px"}),l.name,l.status===3&&(l.type==="mp4"||l.type==="mp3")?s().createElement("span",{className:"duration"},(0,ue.xj)(l.duration)):l.status&&l.status!==3?s().createElement("span",{className:"resource-item-duration"},"--:--:--",s().createElement(E.Z,{placement:"top",title:i("course.transcodingStudyLimit")},s().createElement("span",null,s().createElement(b.Z,{iconClass:"icon-f-tipe",color:"#9C9C9F"})))):s().createElement("span",{className:"duration"},"--:--:--",s().createElement(E.Z,{placement:"top",title:"".concat(l.type==="h5"?i("course.ArticleStudyLimit"):i("course.documentStudyLimitTip3"))},s().createElement("span",null,s().createElement(b.Z,{iconClass:"icon-f-tipe",color:"#9C9C9F"}))))),s().createElement("ul",null,s().createElement("li",{className:"cover-span"},i("course.courseCreatePanelFTCover"),":"," ",x.coverType===0?i("course.courseCreatePanelFTCoverCus"):i("course.courseCreatePanelFTCoverSys")),s().createElement("li",{className:"range-span"},i("course.courseCreatePanelFTRange"),":"," ",[i("course.courseCreatePanelFTRangeAll"),i("course.courseCreatePanelFTRangePart"),i("course.courseCreatePanelFTRangeOwn")][P.rangeType-1]),s().createElement("li",{className:"original-span"},i("course.courseDetailOriginal"),":"," ",i(R===0?"course.courseDetailOriginalFalse":"course.courseDetailOriginalTrue")),s().createElement("li",{className:"teacher-span"},i("course.courseDetailLecture"),": ",ae.name||i("common.none")),s().createElement("li",{className:"classify-span"},i("course.courseCreatePanelFTCategory"),":"," ",H.name||i("course.courseCreatePanelFTCategoryNull"))))},this.handleInteractiveVideo=r=>{this.props.onSubmit("draft",!1,r)},this.renderContent=r=>{var o=this.props.t;return r.status===3&&(r.type==="mp4"||r.type==="mp3")?s().createElement("span",{className:"duration"},(0,ue.xj)(r.duration)):r.status&&r.status!==3?s().createElement("span",{className:"resource-item-duration"},"--:--:--",s().createElement(E.Z,{placement:"top",title:o("course.transcodingStudyLimit")},s().createElement("span",null,s().createElement(b.Z,{iconClass:"icon-f-tipe",color:"#9C9C9F"})))):s().createElement("span",{className:"duration"},"--:--:--",s().createElement(E.Z,{placement:"top",title:this.renderTooltipTip(r)},s().createElement("span",null,s().createElement(b.Z,{iconClass:"icon-f-tipe",color:"#9C9C9F"}))))},this.renderInteractiveVideo=(r,o)=>{var n=(0,fe.V9)("courseManage",this.props.userInfo.modules),l=(0,fe.H3)("make_interactive_video",n),h=r.data?r.data:r,i=h.contentType,v=h.is_interact,x=h.privatization;return i.includes("video")&&r.status&&r.status===3&&x==="public"&&l?s().createElement(E.Z,{placement:"top",title:this.props.t("course.interactiveVideoEdit")},s().createElement("span",{className:"interactiveInter-upload",onClick:()=>this.handleInteractiveVideo(o)},s().createElement(b.Z,{color:"#4D67E9",iconClass:v?"icon-yikanshipin1":"icon-hudongshipin",size:"16px"}))):i.includes("video")&&l&&(r.status&&r.status===3||x!=="public")?s().createElement(E.Z,{placement:"top",title:this.getTitleTip(r)},s().createElement("span",{className:"interactiveInter-upload"},s().createElement(b.Z,{color:"#E1E0E5",iconClass:"icon-hudongshipin",size:"16px"}))):""},this.renderTooltipTip=r=>{var o=this.props.t,n="";return he.WB.includes(r.type)||r.type==="html"||r.type==="scorm"?n=o("common.notSupportSetTime"):r.type==="h5"?n=o("course.ArticleStudyLimit"):n=o("course.documentStudyLimitTip3"),n}}componentDidMount(){setTimeout(()=>{var r=this.props.item,o=["pdf","doc","docx","xls","xlsx","txt","ppt","pptx"];this.props.setFieldValue("studyLimit",(0,F.Z)((0,F.Z)({},this.props.values.studyLimit),{},{checked:this.props.documentStudyLimit!==0&&o.includes(r.type)}))},100)}render(){var r=this.props,o=r.prefixCls,n=r.values,l=r.item,h=r.panelIdx,i=r.isOpened,v=r.t,x=r.userInfo,P={resourceType:"course",tagHandleType:"create",resourceId:""},R=x.appType,ae=oe()(["".concat(o),i?"":"".concat(o,"-collapsed")]),H=["pdf","doc","docx","xls","xlsx","txt","ppt","pptx"];return s().createElement("div",{className:ae},s().createElement(T.l0,{className:"cl-form"},this.renderHeader(),s().createElement("div",{className:"".concat(o,"__content")},s().createElement("p",{className:"".concat(o,"__content__courseware")},s().createElement(B.Z,null,s().createElement(re.Z,{span:3}),s().createElement(re.Z,{span:21},s().createElement("div",{className:"".concat(o,"__content__courseware__item")},s().createElement(b.Z,{iconClass:he.e1[l.type],size:"16px"}),s().createElement("span",{className:"fileName"},l.name),this.renderContent(l),R!=="wx_app"&&this.renderInteractiveVideo(l,h))))),s().createElement(T.gN,(0,y.Z)({component:ve.Y9,displayType:"Custom",name:"covers",label:v("course.courseDetailCover"),required:!0,needRefresh:!0,ifRefresh:i},L.I4)),s().createElement(T.gN,(0,y.Z)({component:ve.O,displayType:"Custom",name:"courseClassify",label:v("course.courseDetailCategory"),isObj:!0,required:!0,validate:se=>(0,Ee.QK)(se.id,v("course.courseDetailCategoryPlaceholder")),defaultValue:n.courseClassify},L.I4)),s().createElement(T.gN,(0,y.Z)({component:q.J$,name:"teacher",label:v("course.courseDetailLecture"),displayType:"Custom",defaultFieldList:n.teacher},L.I4)),s().createElement(T.gN,(0,y.Z)({component:q.gg,name:"original",label:v("course.courseDetailOriginal"),type:"text",defaultValue:n.original},L.I4)),s().createElement(T.gN,(0,y.Z)({component:q._D,name:"studyType",label:v("course.courseStudyType"),type:"text",defaultValue:n.studyType},L.I4)),s().createElement(T.gN,(0,y.Z)({component:ve.QS,displayType:"Custom",name:"tagGroup",label:v("common.detailTag"),defaultFieldList:P},L.I4)),s().createElement(T.gN,(0,y.Z)({component:q.Rv,displayType:"Custom",name:"introduction",label:v("course.courseDetailIntro"),defaultFieldList:n.introduction,toolbarCls:"cl_editor_toolbar_coursedetail_".concat(l.id),contentCls:"cl_editor_content_coursedetail_".concat(l.id)},L.I4)),s().createElement(T.gN,(0,y.Z)({component:q.mh,label:v("course.selfStudyRequirements"),displayType:"Custom",name:"studyLimit",shouldSetStudyLimit:H.includes(l.type),defaultFieldList:n.studyLimit,validate:Se.T9},L.I4)),s().createElement(T.gN,(0,y.Z)({component:q.yX,label:v("course.courseDetailRewardScore"),displayType:"Custom",name:"credit",defaultFieldList:n.credit,validate:Se.H4},L.I4)),s().createElement(T.gN,(0,y.Z)({component:q.UW,name:"download",label:v("course.courseDetailDownload"),type:"text",defaultValue:n.download},L.I4)),s().createElement(T.gN,(0,y.Z)({type:"text",component:q.lL,defaultValue:n.commentSwitch,label:v("course.courseCommentTitle"),name:"commentSwitch"},L.I4)),s().createElement(T.gN,(0,y.Z)({component:q.kI,name:"finishStandardStr",label:v("course.courseDetailComplete"),type:"text",defaultValue:n.finishStandardStr},L.I4)),s().createElement(T.gN,(0,y.Z)({component:q.RQ,name:"syncProgress",label:v("common.scheduleSync"),type:"text",defaultValue:n.syncProgress},L.I4)),s().createElement(T.gN,(0,y.Z)({component:ve.ww,displayType:"Custom",name:"employeeRange",mode:["all","part","private"],showSectitle:!1,qwTicketShow:!0,label:v("common.visibleRange"),defaultFieldList:n.employeeRange,validate:Oe.FI},L.I4))),this.renderFooter()))}}S.defaultProps={prefixCls:"form-panel"};var pe=(0,A.$j)(Ke)((0,e.Z)()(S));class Ae extends s().Component{constructor(){super(...arguments);this.state={initialParams:{title:this.props.item.name,resourceId:this.props.item.id,covers:{coverType:1,cover:"",baseCover:""},courseClassify:{id:void 0,name:void 0},teacher:{id:"",name:""},original:1,studyType:"",introduction:{desc:""},download:0,commentSwitch:1,finishStandardStr:"all",studyLimit:{checked:!1,limit:this.props.documentStudyLimit},credit:{checked:!1,score:this.props.systemScore},syncProgress:0,employeeRange:{rangeType:3,qyWeChatVo:"",rangeList:{dept:[],post:[],group:[],user:[]}}}},this.initRef=r=>{this._ref=r}}render(){var r=this.props,o=r.onDelete,n=r.item,l=(0,U.Z)(r,["onDelete","item"]),h=this.state.initialParams;return s().createElement(T.J9,{ref:this.initRef,initialValues:h,onSubmit:()=>{},render:i=>s().createElement(pe,(0,y.Z)({},i,{item:n,onDelete:o},l))})}}var Me=Ae,be=t(1164),me=t(38642),Fe=t(10780),Ge=t(28531),Ie=t(74262),ke=t(43967),Ze=t(26697),Re=t(34773),De=t(10237),we=t(4408),Ue=t(73704),Le={getScoreRule:he.ZP.CourseManagement.getScoreRule,addBatchCourse:he.ZP.CourseManagement.addBatchCourse},je=W=>({uploaderList:W.uploader.list,uploadSucceedItem:W.uploader.uploadSucceedItem,documentStudyLimit:W.advancedSetting.documentStudyLimit,userInfo:W.user,themeColor:W.advancedSetting.themeColor});class Ve extends s().Component{constructor(){var r;super(...arguments);r=this,this.state={visible:!1,list:[],isSubmitting:!1,isLoading:!0,systemScore:0,AIModalFlag:!1,createList:[],allowActions:(0,fe.V9)("library",this.props.userInfo.modules),uploadShow:!1,renderShow:!0,saveData:{data:[],msg:"",tagsNameListPost:[],jump:!0,jumpIndex:0},approvalModal:{isShowApprovalModal:!1,content:{},defaultTemplate:{}}},this._refs={},this.initPanelRefs=o=>{o&&o.props.item instanceof Object&&o.props.item.id&&(this._refs[o.props.item.id]=o)},this.getScoreRule=()=>{De.WY.get({url:Le.getScoreRule()}).then(o=>{this.setState({systemScore:o.data.data.courseScoreList?o.data.data.courseScoreList[0].score:0,isLoading:!1})})},this.handleSelectCourseware=()=>{this.setState({visible:!0})},this.handleOk=o=>{var n=[...this.state.list],l=(0,ke.Y5)(this.props.uploaderList),h;if(n=n.concat(o),h=(0,ue.Cj)(n),h.length+l.length>5){N.default.warning(this.props.t("course.courseCreateLimitTip"));return}var i=h.findIndex(v=>v.isOpened)>-1;!i&&h.length&&(h[0].isOpened=!0),this.setState({list:h,visible:!1,renderShow:!1})},this.handleCancel=()=>{this.setState({visible:!1})},this.handleDelete=o=>{this.setState(n=>{var l=[...n.list],h=l.findIndex(v=>v.id===o);l.splice(h,1),delete this._refs[o];var i=l.findIndex(v=>v.isOpened)>-1;return!i&&l.length&&(l[0].isOpened=!0),{list:l}})},this.handleToggle=o=>{for(var n=[...this.state.list],l=0,h=n;l<h.length;l++){var i=h[l];i.id===o?i.isOpened=!i.isOpened:i.isOpened=!1}this.setState({list:n})},this.handleSubmit=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"release",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2?arguments[2]:void 0;if(!r.state.isSubmitting){var h=r._refs,i=[],v=function(R){if(h.hasOwnProperty(R)){var ae=h[R],H=ae._ref;H.submitForm(),H.runValidations().then(se=>{i.push(r.getSyncFormItem({id:R,values:H.state.values,errors:se}))})}};for(var x in h)v(x);setTimeout(()=>{Promise.all(i).then(P=>{var R=P.findIndex(w=>w.errorsLength>0);if(R>-1){var ae=P[R].id,H=[...r.state.list];H.forEach(w=>{w.id===ae?w.isOpened=!0:w.isOpened=!1}),r.setState({list:H})}else{r.setState({isSubmitting:!0});var se=JSON.parse(localStorage.getItem("uploadCourseArr"))||[],ne=[],ge=[];P.forEach(w=>{var f=w.values,d=f.courseClassify,c=f.covers,a=f.credit,u=f.download,p=f.finishStandardStr,m=f.studyLimit,O=f.introduction,C=f.original,K=f.tagGroup,Z=f.employeeRange,j=f.resourceId,ie=f.teacher,le=f.title,xe=f.studyType,Te=f.syncProgress,ye=f.commentSwitch,Pe=(0,Re.b)(Z.rangeList),Be=se.find(He=>He.resourceId===w.id),We=K?K.tagsNameList:[];ne.push({id:Be&&Be.courseId?Be.courseId:"",title:(0,ue.fy)(le),introduction:O.desc,coverType:c.coverType,cover:c.cover,baseCover:c.baseCover,teacherId:ie.id,courseClassify:d.id||"999",resource:j,original:C,isAll:Z.rangeType,qy_we_chat_vo:Z.qyWeChatVo,groupIds:Z.rangeType===2?Pe.groupIds.join(","):"",departmentIds:Z.rangeType===2?Pe.deptIds.join(","):"",userIds:Z.rangeType===2?Pe.userIds.join(","):"",postIds:Z.rangeType===2?Pe.postIds.join(","):"",download:u,finishStandardStr:p,studyTimeLimit:m.checked?m.limit:0,credit:a.checked?a.score:0,init_type:o,studyType:xe,syncProgress:Te,commentSwitch:ye,tags:We.length?We.map(He=>He.tag_name).join(","):""}),ge.push(We)});var ze={batchCourse:JSON.stringify(ne)};De.qg.post({url:Le.addBatchCourse(),data:ze}).then(w=>{r.setState({saveData:(0,F.Z)((0,F.Z)({},w.data),{},{data:w.data.data.course.map(f=>f.course_id),tagsNameListPost:ge,jump:n,jumpIndex:l})},()=>{r.handleTag(),r.setState({isSubmitting:!1}),o==="release"&&w.data.data.state&&w.data.data.course.length?(N.default.success(r.props.t("common.saveSuccess")),r.setState({approvalModal:{isShowApprovalModal:!0,defaultTemplate:w.data.data.approval_template,content:{business_info_list:w.data.data.course.map(f=>({data_id:f.course_id,title:f.course_name,content:{courseId:f.course_id,classifyType:"course"}}))}}})):(N.default.success(r.state.saveData.msg),r.handleSaveSuccess())})}).catch(()=>{r.setState({isSubmitting:!1})})}})},0)}},this.queryAiResource=()=>{var o=X.parse(z.m8.location.search),n=o.from;n==="myCreate"?(0,me.eJ)({url:"/personal/profile?tab=mycreate",actionType:"replace"}):n==="courseStudent"?(0,me.eJ)({url:"/course/management",actionType:"replace"}):z.m8.replace("/knowledgeBase/learningResources/courseManage")},this.onCancel=()=>{this.setState({AIModalFlag:!1});var o=this.props.userInfo,n=o===void 0?{}:o,l=n.showUserModules,h=l===void 0?"":l;h?z.m8.push("/knowledgeBase/learningResources/courseManage"):(0,me.eJ)({url:"/personal/profile?tab=mycreate"})},this.handleCancelSubmit=()=>{this.setState({AIModalFlag:!1});var o=this.props.userInfo,n=o===void 0?{}:o,l=n.showUserModules,h=l===void 0?"":l;h?z.m8.push("/knowledgeBase/learningResources/courseManage"):(0,me.eJ)({url:"/course/management"})},this.getSyncFormItem=o=>{var n=o.id,l=o.values,h=o.errors;return new Promise(i=>{i({id:n,values:l,errors:h,errorsLength:Object.keys(h).length})})},this.renderHeader=()=>s().createElement("header",{className:"course-create__header"},this.renderHeaderTitle(),this.renderHeaderAction()),this.renderHeaderTitle=()=>{var o=this.props,n=o.t,l=o.themeColor;return s().createElement("div",{className:"course-create__header__title"},s().createElement(b.Z,{iconClass:"iconf-upload-course",color:l,size:"48px"}),s().createElement("span",null,n("course.courseCreateTitle")),s().createElement("p",null,n("course.courseCreateTip")))},this.showUpload=(0,Y.Z)(D().mark(function o(){var n,l;return D().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return n=r.props.t,i.next=3,(0,ue.x8)("quota_source_book",n("course.sourceValidateLimit",{courseType:n("documentTitle.matter")}));case 3:if(l=i.sent,!l){i.next=6;break}return i.abrupt("return");case 6:r.setState({uploadShow:!0});case 7:case"end":return i.stop()}},o)})),this.renderHeaderAction=()=>{var o=this.props,n=o.t,l=o.themeColor;return s().createElement("div",{className:"action-container"},s().createElement(J.Z,{type:"primary",ghost:!0,className:"qa-course-library-selection-button",onClick:this.handleSelectCourseware},s().createElement(b.Z,{iconClass:"iconf-course-library",color:l,size:"14px"}),n("course.courseDetailResourceCS")),s().createElement(J.Z,{type:"primary",ghost:!0,className:"qa-local-upload-button",onClick:this.showUpload},s().createElement(b.Z,{iconClass:"iconf-folder",color:l,size:"14px"}),n("course.courseDetailResourceUP")))},this.renderFooter=()=>{var o=this.props.t,n=this.state,l=n.isSubmitting,h=l===void 0?!1:l,i=n.list,v=n.isLoading,x=n.renderShow;return v?s().createElement($.Z,{size:"large"}):!i.length||x?null:s().createElement("footer",{className:"cl-form-fixed-footer"},s().createElement("div",{className:"cl-form-fixed-footer__container"},s().createElement(J.Z,{onClick:this.handleCancelSubmit},o("common.cancel")),s().createElement(J.Z,{disabled:h,loading:h,onClick:()=>this.handleSubmit("draft")},o("common.draft")),s().createElement(J.Z,{type:"primary",disabled:h,loading:h,onClick:()=>this.handleSubmit("release")},o("common.release"))))},this.uploadSuccess=o=>{var n=this.props.t,l=this.state.list;if(o.length+l.length>5){N.default.warning((0,ue.ZT)(n("component.stageAddFileTip"),5));return}var h=[...l,...o];h.forEach(i=>{i.isOpened=!1}),h[0].isOpened=!0,this.setState({list:h,renderShow:!1,uploadShow:!1})},this.cancelUpload=()=>{this.setState({uploadShow:!1})},this.handleCloseApproval=o=>{var n=this.props.t;if(!o){G.Z.confirm({title:n("course.cancelBatchApproval"),content:n("course.cancelBatchApprovalTips"),okText:n("common.ok"),cancelText:n("common.cancel"),centered:!0,onOk:()=>{this.setState({approvalModal:{isShowApprovalModal:!1,content:{},defaultTemplate:{}}}),this.handleSaveSuccess()}});return}o==="submit"&&(this.setState({approvalModal:{isShowApprovalModal:!1,content:{},defaultTemplate:{}}}),this.handleSaveSuccess())}}componentDidMount(){this.getScoreRule(),localStorage.removeItem("uploadCourseArr")}handleTag(){var r=this.state,o=r.saveData,n=r.list,l=o.tagsNameListPost,h=o.jump,i=o.data,v=[];i.forEach((x,P)=>{if(l[P]&&l[P].length){var R={tags:l[P],resourceId:x,resourceType:"course"};(0,Ge.tB)(R)}v.push({resourceId:n[P].id,courseId:x})}),h||localStorage.setItem("uploadCourseArr",JSON.stringify(v))}handleSaveSuccess(){var r=this.state.saveData,o=r.jump,n=r.jumpIndex,l=this.props.userInfo.enterpriseVersion==="comprehensive"&&(0,fe.H3)("ai_upgrade",this.state.allowActions);if(!o){be.Z.targetTo({path:"/training/learning/task/interactiveVideo?courseId=".concat(r.data[n])});return}if(l&&!z.m8.location.query.courseId)this.queryAiResource(r.data);else{var h=X.parse(z.m8.location.search),i=h.from;i==="myCreate"?(0,me.eJ)({url:"/personal/profile?tab=mycreate",actionType:"replace"}):i==="courseStudent"?(0,me.eJ)({url:"/course/management",actionType:"replace"}):z.m8.replace("/knowledgeBase/learningResources/courseManage")}}render(){var r=this.props.t,o=this.state,n=o.visible,l=o.list,h=o.systemScore,i=o.uploadShow,v=o.renderShow,x=o.commentSwitch,P=o.approvalModal,R=P.isShowApprovalModal,ae=P.content,H=P.defaultTemplate,se=!v&&l.length>0;return s().createElement("div",{className:"course-create-page"},s().createElement(we.Z,{title:r("documentTitle.newCourse")}),s().createElement("div",{className:"course-create ".concat(se?"":"course-create-empty")},s().createElement("section",{className:"main-content ".concat(se?"":"main-content-empty")},this.renderHeader(),s().createElement("div",{className:"course-create__listcontent"},se?l.map((ne,ge)=>s().createElement(Me,{ref:this.initPanelRefs,key:ne.id,item:ne,commentSwitch:x,isOpened:ne.isOpened,panelIdx:ge,maxLength:l.length,systemScore:h,documentStudyLimit:this.props.documentStudyLimit,onDelete:this.handleDelete,onToggle:this.handleToggle,onSubmit:this.handleSubmit})):null),this.renderFooter())),s().createElement(Fe.Z,{visible:n,defaultChecked:l,onOk:this.handleOk,onCancel:this.handleCancel,excludeType:"h5"}),s().createElement(Ie.Z,{params:{classifyId:0,bizType:0},visible:i,title:r("common.storage"),onSuccess:ne=>this.uploadSuccess(ne),onCancel:()=>this.cancelUpload(),from:"course",isAllowLocal:!0}),this.state.AIModalFlag&&s().createElement(Ze.Z,{visible:this.state.AIModalFlag,record:this.state.createList,onCancel:()=>this.onCancel()}),R&&s().createElement(Ue.Z,{haveContent:!1,isBatch:"true",defaultTemplate:H,show:R,setShow:()=>this.handleCloseApproval(),submitRefresh:()=>this.handleCloseApproval("submit"),bizType:"course_task",content:ae}))}}var $e=(0,A.$j)(je)((0,T.$j)((0,e.Z)()(Ve)))},72538:function(Ce,k,t){"use strict";t.d(k,{I4:function(){return V},K5:function(){return ee}});var V={labelCol:{xs:{span:24},sm:{span:3}},wrapperCol:{xs:{span:24},sm:{span:21}}},G={labelCol:{xs:{span:0},sm:{span:0}},wrapperCol:{xs:{span:24},sm:{span:24}}},ee={labelCol:{xs:{span:24},sm:{span:24}},wrapperCol:{xs:{span:24},sm:{span:24}}},$={labelCol:{xs:{span:24},sm:{span:3}},wrapperCol:{xs:{span:24},sm:{span:18,offset:3}}}},19858:function(Ce,k,t){"use strict";t.d(k,{$h:function(){return Y},H4:function(){return F},T9:function(){return te}});var V=t(6793),G=t(2396),ee=t(3407),$=(0,V.me)(),I=ee.Z[$].course.validation,J=ee.Z[$].integralMall,Y=N=>N.length?"":I.courseDetailResourceNull,F=N=>{var g,D=N.score,Q=Number.isNaN(D)||!(D>=0&&D<1e3);return N.checked&&Q&&(g=I.courseDetailRewardScore),g},te=N=>{var g,D=N.limit,Q=Number.isNaN(D)||!D||!(D>0&&D<=9999)||!G.fA.score.test(D);return N.checked&&Q&&(g=J.durationLimit),g}}}]);
