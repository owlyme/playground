(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[738],{89962:function(Ut,Se,e){"use strict";var me=e(20228),we=e(11382),nt=e(66456),z=e(55313),$e=e(49111),ze=e(19650),V=e(62029),l=e(57663),J=e(71577),te=e(34792),Ce=e(48086),m=e(88986),i=e(33565),a=e(43358),Me=e(34041),oe=e(43185),fe=e(53251),h=e(12924),B=e.n(h),Te=e(91768),pe=e(84391),be=e(59239),Ne=e(90411),de=e.n(Ne),Ee=e(84874),He=e(18329),Ue=e(51524),Ve=e(65202),q=e(10237),ae=e(5259),w=e(49147),x=be.Z.Item,U=fe.Z.Dragger,I=Me.Z.Option,j=(0,Ve.p)();function $(p){var K=p.t,ne=p.title,ue=p.visible,ge=p.actionUrl,R=p.size,ke=p.isMultiple,ft=ke===void 0?!0:ke,rt=p.loading,it=rt===void 0?!1:rt,Ae=p.withAddQuestionBank,E=p.renderTip,ye=p.renderDownLoad,pt=p.onOk,qe=p.onCancel,et={labelCol:{xs:{span:2},sm:{span:2}},wrapperCol:{xs:{span:16},sm:{span:16}}},tt={size:"large",destroyOnClose:!0,footerType:"custom",bodyStyle:{padding:"0"},maskClosable:!1},Et={name:"file",accept:".doc, .docx, .xls, .xlsx",customRequest:xt,showUploadList:!1,data:je};(0,h.useEffect)(()=>{gt(Ae?{access_token:window.localStorage.getItem("token"),question_bank_id:Je}:{access_token:window.localStorage.getItem("token")})},[Ae,Je]);var st=[{title:p.t("component.fileName"),dataIndex:"fileName",key:"fileName"},{title:p.t("component.successLabel"),dataIndex:"rightCount"},{title:p.t("component.failedLabel"),dataIndex:"errorCount"}],lt=(0,h.useState)({}),ot=(0,i.Z)(lt,2),je=ot[0],gt=ot[1],Lt=(0,h.useState)([]),ut=(0,i.Z)(Lt,2),at=ut[0],Ge=ut[1],At=(0,h.useState)([]),yt=(0,i.Z)(At,2),ht=yt[0],dt=yt[1],It=(0,h.useState)(void 0),Ye=(0,i.Z)(It,2),Je=Ye[0],Ke=Ye[1],ct=(0,h.useState)([]),_t=(0,i.Z)(ct,2),g=_t[0],y=_t[1],le=(0,h.useState)(!1),De=(0,i.Z)(le,2),Le=De[0],Ie=De[1],kt=(0,h.useState)(!1),G=(0,i.Z)(kt,2),Ct=G[0],Dt=G[1],ia=(0,h.useState)(!1),Ot=(0,i.Z)(ia,2),Kt=Ot[0],Qt=Ot[1],Ht=(0,h.useState)({visible:!1,isEdit:!1,editQuestionBankId:"",onCancel:Wt,onOk:Ft}),ee=(0,i.Z)(Ht,2),Zt=ee[0],Qe=ee[1];(0,h.useEffect)(()=>{ue&&(Ge([]),dt([]),y([]),Ke(void 0),Ie(!1)),Ae&&Oe()},[ue]);function Wt(){Qe((0,m.Z)((0,m.Z)({},Zt),{},{visible:!1}))}function xt(k){if(Qt(!0),Vt(k.file)){var re=new FormData;re.append("file",k.file),re.append("access_token",window.localStorage.getItem("token")),ft?re.append("is_multiple",!0):re.append("is_multiple",!1);var St=(0,q.NN)({headers:{"Content-Type":"multipart/form-data"}});St.post({url:ge,data:re}).then(Xe=>{jt(Xe)}).catch(Xe=>{Xe.message.indexOf("Network")!==-1&&Ce.default.error(p.t("upload.uploadFail")),Xe.response.data.code&&w.Z[Xe.response.data.code]&&w.Z[Xe.response.data.code].showErrorMessage&&Ce.default.error(w.Z[Xe.response.data.code].content),Ge([])}).finally(()=>{Qt(!1)})}}function Ft(k){var re=k.id;Qe((0,m.Z)((0,m.Z)({},Zt),{},{visible:!1})),Ke(re),Oe()}function Oe(){var k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";if(Ae){var re={page_size:100,page_number:1,keyword:k};(0,ae.bB)(re).then(St=>{y(St.data.data.list)})}}function Rt(){Qe((0,m.Z)((0,m.Z)({},Zt),{},{visible:!0}))}function wt(){var k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";Oe(k)}function We(k){Ke(k),Ie(!1)}function Vt(k){if(!R)return!0;var re=k.size/1024/1024<R;return re||Ce.default.error(K("component.importSize",{size:R})),re}function jt(k){if(k.data.code==="200000"){var re={newFileName:k.data.data.new_file_name,fileName:k.data.data.file_name,errorCount:k.data.data.error_count,rightCount:k.data.data.right_count};Ge([re]),k.data.data.error_messages?(dt(JSON.parse(k.data.data.error_messages)),Dt(!0)):(dt([]),Number(re.rightCount)===0?Dt(!0):Dt(!1))}}function Gt(){if(Ae&&!Je){Ie(!0);return}if(!at.length){Ce.default.error(p.onOkTip||K("component.noImportQuestionTip"));return}pt&&pt({importedList:at,selectedLib:Je})}function Bt(){Dt(!1),qe&&qe()}function Yt(){return Ae&&B().createElement(B().Fragment,null,B().createElement("div",{className:de()["import-file-lib"]},B().createElement(x,(0,V.Z)({required:!0,label:K("component.choosedQuestionLib"),validateStatus:Le?"error":"",help:Le?K("component.chooseQuestionLibTip"):""},et),B().createElement(Me.Z,{placeholder:K("component.pleaseChoose"),showSearch:!0,allowClear:!0,value:Je,onSearch:wt,className:de()["import-file-lib-select"],onChange:We,filterOption:(k,re)=>re.props.children.toLowerCase().indexOf(k.toLowerCase())>=0},g.map(k=>B().createElement(I,{key:k.id,value:k.id},k.title))),B().createElement(J.Z,{className:de()["import-file-lib-add"],onClick:Rt},B().createElement(Ee.Z,{iconClass:"icon-icon_addx"}),K("component.addQuestionBank")))),B().createElement(Ue.Z,Zt))}var xe=()=>B().createElement("div",{className:de()["footer-box"]},B().createElement(ze.Z,{value:8},B().createElement(J.Z,{type:"default",disabled:it,onClick:Bt},K("common.cancel")),B().createElement(J.Z,{type:"primary",disabled:Ct||Kt,loading:it,onClick:Gt},K("common.ok"))));return B().createElement(He.ZP,(0,V.Z)({},tt,{title:ne||K("exam.importTemplate"),visible:ue,renderCustomFooter:xe,onCancel:Bt}),B().createElement(we.Z,{spinning:Kt},B().createElement("div",{className:de()["import-file"]},Yt(),ye&&B().createElement("div",{className:de()["import-file-btns"]},ye()),B().createElement(U,Et,B().createElement("div",null,B().createElement(pe.Z,{style:{color:j,fontSize:"38px"}}),B().createElement("p",null,K("component.dragUpload")))),E&&B().createElement("div",{className:de()["import-file-tips"]}," ",E()," "),B().createElement("div",{className:de()["import-file-table"]},at.length>0&&B().createElement(z.Z,{dataSource:at,columns:st,bordered:!0,rowKey:k=>k.newfileName,size:"middle",pagination:!1})),ht.length>0?B().createElement("div",{className:de()["import-file-tip"]},B().createElement("p",null,B().createElement(Ee.Z,{iconClass:"icon-tishi"}),K("component.errorTips"),":"),ht.map((k,re)=>B().createElement("p",{key:re},k))):null)))}Se.Z=(0,Te.Z)()($)},11449:function(Ut,Se,e){"use strict";e.d(Se,{Z:function(){return Ve}});var me=e(88986),we=e(33565),nt=e(12924),z=e.n(nt),$e=e(3115),ze=e(49111),V=e(19650),l=e(62029),J=e(57663),te=e(71577),Ce=e(91768),m=e(28216),i=e(37055),a=e(10237);function Me(q){var ae=i.ZP.getHelpContentByMenuKey(),w={key:q};return a.WY.get({url:ae,params:w})}var oe=e(74228),fe=e.n(oe),h=e(1164),B=e(76466),Te=e(38642);class pe extends z().Component{constructor(ae){var w;super(ae);w=this,this.getHelpContentByMenuKey=()=>{var x=this.props.defaultMenuKey;Me(x).then(U=>{var I=U.data,j=I.help_url,$=I.video_url;this.setState({videoUrl:$,helpUrl:j})})},this.handleOpenHelpUrl=x=>{if((0,Te.ve)()){window.open(x,"_blank");return}h.Z.targetTo({path:x,isExternalLink:!0})},this.handleOpenVideo=function(x){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:w.props.t("helpCenter.video");w.setState(I=>({resourcePlayInfo:(0,me.Z)((0,me.Z)({},I.resourcePlayInfo),{},{resourceInfo:{originUrl:x,source:{FD:x,OD:x},contentType:"mp4"}}),previewInfo:(0,me.Z)((0,me.Z)({},I.previewInfo),{},{title:U,visible:!0,onCancel:w.handleCancelPreview})}))},this.handleCancelPreview=()=>{var x=this.state.previewInfo;this.setState({resourcePlayInfo:{mode:"preview",watchType:"video",resourceInfo:{}},previewInfo:(0,me.Z)((0,me.Z)({},x),{},{visible:!1})})},this.state={helpUrl:"",videoUrl:"",resourcePlayInfo:{autoPlay:!0,draggable:!0,mode:"preview",resourceInfo:{},watchType:"video"},previewInfo:{visible:!1,destroyOnClose:!0,title:ae.t("helpCenter.video")||"\u89C6\u9891\u6307\u5BFC",onCancel:()=>{}}}}componentDidMount(){this.getHelpContentByMenuKey()}render(){var ae=this.state,w=ae.helpUrl,x=ae.resourcePlayInfo,U=ae.previewInfo,I=ae.videoUrl,j=this.props.t;return z().createElement("div",{className:fe().helpCenter},I&&z().createElement(te.Z,{type:"link",className:fe()["video-btn"],style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenVideo(I)},j("helpCenter.video")),w&&z().createElement(te.Z,{type:"link",style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenHelpUrl(w)},j("helpCenter.tutorial")),z().createElement(B.Z,(0,l.Z)({},x,{previewInfo:U})))}}var be=q=>({defaultMenuKey:q.currentRoute.menuKey});pe.defaultProps={defaultMenuKey:""};var Ne=(0,m.$j)(be)((0,Ce.Z)()(pe));function de(q){var ae=q.extra,w=localStorage.getItem("dingPersonnel"),x=sessionStorage.getItem("dingPersonnel");return z().createElement(V.Z,null,ae,w!=="dingPersonnel"&&x!=="dingPersonnel"&&(0,Te.eY)("COMMONEXTRA_HELP_CENTER")&&z().createElement(Ne,null))}var Ee=de,He=e(4408);function Ue(q){var ae=(0,nt.useState)({helpCenter:(0,Te.eY)("HEAD_HELP_CENTER_BUT")}),w=(0,we.Z)(ae,1),x=w[0],U=q.pageContainerParams,I=U===void 0?{}:U,j=q.noPadding,$=j===void 0?!1:j,p=q.isPersonal,K=p===void 0?!1:p,ne=q.pageTitle,ue=q.className,ge=ue===void 0?"":ue,R={extra:x.helpCenter?z().createElement(Ee,{extra:I.extra}):I.extra},ke=(0,me.Z)((0,me.Z)({},I),R);return z().createElement("div",{className:"page-container-content ".concat($?"page-container-noPadding":""," ").concat(K?"page-container-content_personal_background":""," ").concat(ge)},ne&&z().createElement(He.Z,{title:ne}),K?z().createElement($e.Z,null,q.children):z().createElement($e.Z,ke,q.children))}var Ve=Ue},51524:function(Ut,Se,e){"use strict";var me=e(49111),we=e(19650),nt=e(88983),z=e(47933),$e=e(22385),ze=e(31097),V=e(62029),l=e(57663),J=e(71577),te=e(34792),Ce=e(48086),m=e(57361),i=e(88986),a=e(33565),Me=e(9754),oe=e.n(Me),fe=e(12924),h=e.n(fe),B=e(91768),Te=e(59239),pe=e(55446),be=e.n(pe),Ne=e(68628),de=e(49101),Ee=e(76651),He=e(10237),Ue=e(37055),Ve=e(18329),q=e(40572),ae=e(85372),w=e(5259),x=e(7584),U=e(61066),I=e(93212),j=e(94076),$=e.n(j),p=K=>{var ne=K.isEdit,ue=K.visible,ge=K.saveAndToAdd,R=K.t,ke=K.editQuestionBankId,ft=K.onCancel,rt=K.onOk,it=(0,fe.useState)({classify_id:"",classify_name:"",title:"",scope:"all",departments_list:[],users_list:[],posts_list:[],groups_list:[],formError:{},resourceViewRange:!1}),Ae=(0,a.Z)(it,2),E=Ae[0],ye=Ae[1],pt=(0,fe.useState)({visible:!1,scopeList:["department","post","group"]}),qe=(0,a.Z)(pt,2),et=qe[0],tt=qe[1],Et=(0,fe.useState)(!1),st=(0,a.Z)(Et,2),lt=st[0],ot=st[1];(0,fe.useEffect)(()=>{at(),Je(),ne&&Lt()},[ne,ue]);var je=(g,y)=>{ye(le=>(0,i.Z)((0,i.Z)({},le),{},{classify_id:g,classify_name:y[0],formError:{classify_id:!1}}))},gt=()=>{et.visible||tt(g=>(0,i.Z)((0,i.Z)({},g),{},{visible:!0}))},Lt=function(){var g=(0,m.Z)(oe().mark(function y(){var le,De,Le,Ie;return oe().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,(0,w.s4)(ke);case 2:le=G.sent,De=le.data,Le=De.code,Ie=De.data,Le==="200000"&&ut(Ie);case 7:case"end":return G.stop()}},y)}));return function(){return g.apply(this,arguments)}}(),ut=g=>{var y=g.visible_range_vo;ye(le=>(0,i.Z)((0,i.Z)({},le),{},{classify_id:g.classify_id==="999"?"":g.classify_id,classify_name:g.classify_id==="999"?"":g.classify_name,title:g.title,scope:y.visible_range_type,departments_list:y.departments_list,users_list:y.users_list,posts_list:y.posts_list,groups_list:y.groups_list}))},at=()=>{ye({classify_id:"",title:"",scope:"all",departments_list:[],users_list:[],posts_list:[],groups_list:[],formError:{},resourceViewRange:!1})},Ge=function(){var g=(0,m.Z)(oe().mark(function y(){var le,De,Le,Ie=arguments;return oe().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:if(le=Ie.length>0&&Ie[0]!==void 0?Ie[0]:!1,!At()){G.next=18;break}if(De={classify_id:E.classify_id,classify_name:E.classify_name,title:E.title,visible_range_vo:{visible_range_type:E.scope,departments_list:(0,I.GU)(E.departments_list),posts_list:(0,I.GU)(E.posts_list),groups_list:E.groups_list.map(Ct=>({id:Ct.id})),users_list:E.users_list.map(Ct=>({id:Ct.id}))}},ot(!0),G.prev=4,!ne){G.next=11;break}return G.next=8,(0,w.gB)(ke,De);case 8:Le=G.sent,G.next=14;break;case 11:return G.next=13,(0,w.Z2)(De);case 13:Le=G.sent;case 14:Le.data.code==="200000"&&(Ce.default.success(R(ne?"component.editQuestionBankSuccess":"component.addQuestionBankSuccess")),rt({id:Le.data.data}),le&&Ee.m8.push("/knowledgeBase/examResources/newQuestion/detail?questionBankId=".concat(Le.data.data,"&questionBankName=").concat(E.title)));case 15:return G.prev=15,ot(!1),G.finish(15);case 18:case"end":return G.stop()}},y,null,[[4,,15,18]])}));return function(){return g.apply(this,arguments)}}(),At=()=>{var g=!0;return E.classify_id.length===0&&(E.formError.classify_id=!0,g=!1),E.title.length===0&&(E.formError.titleError=R("common.input",{name:R("component.questionBankName")}),g=!1),E.scope==="part"&&E.departments_list.length===0&&E.users_list.length===0&&E.groups_list.length===0&&E.posts_list.length===0&&(E.formError.scope=!0,g=!1),ye(y=>(0,i.Z)((0,i.Z)({},y),{},{formError:E.formError})),g},yt=g=>{var y=g.trim(),le=E.formError;y?le.titleError="":le.titleError=R("common.input",{name:R("component.questionBankName")}),ye(De=>(0,i.Z)((0,i.Z)({},De),{},{title:y,formError:le}))},ht=g=>{ye(y=>(0,i.Z)((0,i.Z)({},y),{},{scope:g.target.value,departments_list:[],users_list:[],posts_list:[],groups_list:[],formError:{scope:!1}}))},dt=()=>{tt(g=>(0,i.Z)((0,i.Z)({},g),{},{visible:!1}))},It=g=>{ye(y=>(0,i.Z)((0,i.Z)({},y),{},{departments_list:g.departments,users_list:g.users,groups_list:g.groups,posts_list:g.posts})),tt(y=>(0,i.Z)((0,i.Z)({},y),{},{visible:!1}))},Ye=(g,y)=>{ye(le=>(0,i.Z)((0,i.Z)({},le),{},{[y]:g}))},Je=()=>{He.WY.get({url:Ue.ZP.advancedSetting.getSettingStatusByType("jurisdiction_setting"),params:{}}).then(g=>{ye(y=>(0,i.Z)((0,i.Z)({},y),{},{resourceViewRange:JSON.parse(g.data.actions)[1].param.checked==="true"}))})},Ke={okText:R("common.ok"),cancelText:R("common.cancel"),width:600,destroyOnClose:!0,bodyStyle:{padding:"0"},maskClosable:!1,centered:!0},ct={labelCol:{xs:{span:4},sm:{span:4}},wrapperCol:{xs:{span:19},sm:{span:19}}},_t=h().createElement("div",null,h().createElement(J.Z,{onClick:()=>Ge(!1),loading:lt},R("common.ok")),h().createElement(J.Z,{type:"primary",onClick:()=>{Ge(ge)},loading:lt},R("examination.okAndAddQuestion")));return ge?Ke.footer=_t:Ke.footer&&delete Ke.footer,h().createElement(Ve.ZP,(0,V.Z)({title:R(ne?"examination.editQuestionBank":"examination.addQuestionBank")},Ke,{visible:ue,bodyMask:et.visible,onCancel:ft,centered:!0,onOk:()=>{Ge(ge)}}),h().createElement("div",{className:$()["add-question-bank"]},h().createElement(Te.Z,{className:$()["add-question-bank-form"]},h().createElement(Te.Z.Item,(0,V.Z)({label:R("component.questionBankName"),className:$()["add-question-bank-name"],required:!0,validateStatus:E.formError.titleError?"error":"",help:E.formError.titleError},ct),h().createElement(x.t,{placeholder:R("component.pleaseInputBankName"),value:E.title,onInput:g=>{yt(g)},LimitLength:30,char:!0,showCount:!0})),h().createElement(Te.Z.Item,(0,V.Z)({label:R("examination.questionBankClassify"),required:!0,validateStatus:E.formError.classify_id?"error":"",help:E.formError.classify_id?R("component.pleaseChooseClassify"):""},ct),h().createElement("div",{className:$()["classify-select-container"]},h().createElement(q.X,{value:E.classify_id,onFieldChange:je,classifyName:E.classify_name,auth_type:"edit",filter:!0}))),h().createElement(Te.Z.Item,(0,V.Z)({label:R("examination.visibleRange"),validateStatus:E.formError.scope?"error":"",help:E.formError.scope?R("component.setQuestionBankScopeTip"):""},ct),h().createElement(z.ZP.Group,{onChange:ht,value:E.scope},h().createElement(z.ZP,{value:"all"},R("common.allCompany"),E.resourceViewRange&&h().createElement(ze.Z,{title:R("setting.selectPeopleTip")},h().createElement("span",null,h().createElement(Ne.Z,null)))),h().createElement(z.ZP,{value:"onlyMe"},R("common.onlySeenOwn")),h().createElement(z.ZP,{value:"part"},R("common.deptAndStu"))),h().createElement(we.Z,null,h().createElement(J.Z,{icon:h().createElement(de.Z,null),disabled:!!(E.scope&&E.scope!=="part"),onClick:gt},R("common.select")))),h().createElement("div",{className:$().selectedTree},h().createElement(U.Z,{store:{users:E.users_list,departments:E.departments_list,groups:E.groups_list,posts:E.posts_list,setGroups:g=>{Ye(g,"groups_list")},setUsers:g=>{Ye(g,"users_list")},setDepartments:g=>{Ye(g,"departments_list")},setPosts:g=>{Ye(g,"posts_list")}}}))),h().createElement(ae.Z,(0,V.Z)({},et,{title:R("examination.visibleRange"),value:{users:E.users_list,departments:E.departments_list,groups:E.groups_list,posts:E.posts_list},onOk:It,onCancel:dt}))))};p.defaultProps={visible:!1,isEdit:!1,editQuestionBankId:"",saveAndToAdd:!1,onCancel:()=>{},onOk:()=>{}},Se.Z=(0,B.Z)()(p)},56590:function(Ut,Se,e){"use strict";var me=e(59250),we=e(13013),nt=e(57663),z=e(71577),$e=e(30887),ze=e(99210),V=e(22385),l=e(31097),J=e(88986),te=e(33565),Ce=e(12924),m=e.n(Ce),i=e(28216),a=e(91768),Me=e(13270),oe=e.n(Me),fe=e(1164),h=e(86726),B=pe=>{var be=pe.user;return{modules:be.modules}};function Te(pe){var be=pe.type,Ne=pe.modules,de=pe.cb,Ee=pe.configs,He=(0,Ce.useState)([]),Ue=(0,te.Z)(He,2),Ve=Ue[0],q=Ue[1];(0,Ce.useEffect)(()=>{var x=(0,h.V9)(be,Ne),U=Ee.map(I=>{if(I.type==="more")return I.visible=!0,I.more.forEach($=>{$.visible=$.visible||(0,h.H3)($.type,x)}),I;var j;return typeof I.visible=="function"?j=I.visible():j=I.visible||(0,h.H3)(I.type,x),(0,J.Z)((0,J.Z)({},I),{},{visible:j})});q(U)},[be,Ne,Ee]);var ae=x=>m().createElement(ze.Z,{onClick:U=>{var I=U.key;return w(I)}},x.map(U=>{var I=U.disable,j=I===void 0?!1:I,$=U.visible,p=U.name,K=U.type,ne=U.tooltip;if(ne&&$){var ue=ne.placement,ge=ne.title,R=ne.mouseEnterDelay;return m().createElement(ze.Z.Item,{key:K,disabled:j},m().createElement(l.Z,{placement:ue,title:ge,mouseEnterDelay:R},m().createElement("span",null,p)))}return!ne&&$?m().createElement(ze.Z.Item,{key:K}," ",m().createElement("span",null,p)," "):null})),w=x=>{typeof de=="function"&&de(x)};return m().createElement("div",{className:oe()["left-search"]},Ve.map(x=>{var U=x.more,I=x.name,j=x.icon,$=x.type,p=x.visible,K=x.tabLink,ne=x.disable,ue=ne===void 0?!1:ne,ge=x.style,R=ge===void 0?"":ge;return R==="dropdown"&&U&&U.length>0&&p?m().createElement(we.Z,{overlay:()=>ae(U)},m().createElement(z.Z,{className:oe()["more-opt"],type:"primary"},j,"  ",I," ")):U&&U.length>0?m().createElement(we.Z,{overlay:()=>ae(U)},m().createElement(z.Z,{className:oe()["more-opt"]},I," ",j)):!U&&p?K?m().createElement(fe.Z,{wrapCls:oe()["opt-item"],to:K.to},m().createElement(z.Z,{type:"primary",disabled:ue}," ",j,"  ",I," ")):m().createElement(z.Z,{key:$,className:oe()["opt-item"],type:$==="add"?"primary":"",onClick:()=>w($),disabled:ue},j,"  ",I):null}))}Se.Z=(0,i.$j)(B)((0,a.Z)()(Te))},38624:function(Ut,Se,e){"use strict";e.r(Se),e.d(Se,{default:function(){return Ta}});var me=e(62029),we=e(63185),nt=e(9676),z=e(71194),$e=e(57016),ze=e(34792),V=e(48086),l=e(88986),J=e(57361),te=e(33565),Ce=e(9754),m=e.n(Ce),i=e(12924),a=e.n(i),Me=e(91768),oe=e(57068),fe=e(76651),h=e(28216),B=e(56590),Te=e(57338),pe=e(83107),be=e(49111),Ne=e(19650),de=e(57663),Ee=e(71577),He=e(57119),Ue=e(15873),Ve=e(23279),q=e.n(Ve),ae=e(54029),w=e(62529),x=e(47673),U=e(4107),I=e(68855),j=a().createContext(null),$=j,p=e(99533),K=/\n\s*\n\s*/,ne=/\n\s*/,ue=/(\d\.)?\s*(【单选题】|【多选题】|【判断题】|【填空题】|【简答题】|【單選題】|【多選題】|【判斷題】|【填空題】|【簡答題】|【single】|【multiple】|【Tof】|【Blank】|【Describe】)/i,ge=/[A-Z][\.|\．|\、|\)|\）]/,R=/(填空|填空|Blank)\s*[1-9]\d*(：|:)/i,ke=/(关键词|關鍵詞|Key)\s*[1-9]\d*(：|:)/i,ft=/(正确答案|正確答案|Answer)(：|:)/i,rt=/^(正确|对|yes|Y|正確|對)$/i,it=/^(错误|错|no|N|錯誤|錯)$/i,Ae=/(答案解析|答案解析|Analysis)(：|:)/i,E=/(知识点|知識點|Knowledge points)(：|:)/i,ye=/(难易程度|難易程度|difficulty)(：|:)/i,pt=/^(简单|一般|较难|困难|簡單|一般|較難|困難|easy|normal|harder|hardest)$/i,qe=/(答案顺序匹配|答案順序匹配|Order)(：|:)/i,et=/^(开启|開啟|open|关闭|關閉|close)$/i,tt=/^(开启|開啟|open)$/i,Et=/(作答上传图片|作答上傳圖片|Upload)(：|:)/i,st=/^(暂无解析|暫無解析|No analysis yet|暂无知识点|暫無知識點|No knowledge point yet)$/i;function lt(n){var t=n.t;return[{id:p.Nb.SINGLE,value:p.Nb.SINGLE,name:t("examination.single"),reg:/单选题|單選題|single/i,sample:t("examination.visualization.singleSample")},{id:p.Nb.MULTIPLE,value:p.Nb.MULTIPLE,name:t("examination.multiple"),reg:/多选题|多選題|multiple/i,sample:t("examination.visualization.multipleSample")},{id:p.Nb.TOF,value:p.Nb.TOF,name:t("examination.tof"),reg:/判断题|判斷題|Tof/i,sample:t("examination.visualization.trueOrFalseSample")},{id:p.Nb.BLANK,value:p.Nb.BLANK,name:t("examination.blank"),reg:/填空题|填空題|Blank/i,sample:t("examination.visualization.fillBlankSample")},{id:p.Nb.DESCRIBE,value:p.Nb.DESCRIBE,name:t("examination.describe"),reg:/简答题|簡答題|Describe/i,sample:t("examination.visualization.shortAnswerSample")}]}function ot(n){var t=n.t;return[{id:p.Uh.EASY,value:p.Uh.EASY,reg:/简单|簡單|easy/i,label:t("examination.questionSimple"),text:t("examination.questionSimple")},{id:p.Uh.NORMAL,value:p.Uh.NORMAL,reg:/一般|一般|normal/i,label:t("examination.questionGeneral"),text:t("examination.questionGeneral")},{id:p.Uh.HARDER,value:p.Uh.HARDER,reg:/较难|較難|harder/i,label:t("examination.questionDifficult"),text:t("examination.questionDifficult")},{id:p.Uh.HARDEST,value:p.Uh.HARDEST,reg:/困难|困難|hardest/i,label:t("examination.questionHard"),text:t("examination.questionHard")}]}var je={audio:[],formula:[],image:[],is_answer:"false",option:"",option_detail:[],title:"",video:[]},gt={audio:[],formula:[],image:[],title:"",video:[]},Lt={audio:[],formula:[],image:[],title:"",video:[]};function ut(n){var t=n.trim();return t?t.split(K):[]}function at(n){var t="",r=[],s=[],D=[],v="",d="",O="",u="",C="",M="",o="",c="";return n.forEach(_=>{var Ze=_.search(ue),F=_.search(ge),L=_.search(R),H=_.search(ke),Pe=_.search(ft),ve=_.search(E),ie=_.search(Ae),Re=_.search(ye),he=_.search(qe),Fe=_.search(Et);Ze!==0&&F!==0&&Pe!==0&&ve!==0&&ie!==0&&Re!==0&&H!==0&&L!==0&&he!==0&&Fe!==0&&(c==="title"&&(t=t.concat(`
`.concat(_))),c==="option"&&(r[r.length-1]=r[r.length-1].concat(`
`.concat(_))),c==="keyword"&&(s[s.length-1]=s[s.length-1].concat(_)),c==="blank"&&(D[D.length-1]=D[D.length-1].concat(_)),c==="correct"&&(v=v.concat(_)),c==="tag"&&(d=d.concat(_)),c==="analysis"&&(O=O.concat(`
`.concat(_))),c==="difficult"&&(u=u.concat(_)),c==="order"&&(C=C.concat(_)),c==="upload"&&(M=M.concat(_)),c||(o=o.concat(_))),Ze===0&&!t&&(c="title",t=t.concat(_)),F===0&&(c="option",r.push(_)),H===0&&(c="keyword",s.push(_)),L===0&&(c="blank",D.push(_)),Pe===0&&!v&&(c="correct",v=v.concat(_)),ie===0&&!O&&(c="analysis",O=O.concat(_)),ve===0&&!d&&(c="tag",d=d.concat(_)),Re===0&&!u&&(c="difficult",u=u.concat(_)),he===0&&!C&&(c="order",C=C.concat(_)),Fe===0&&!M&&(c="upload",M=M.concat(_))}),{title:t.trim(),options:r,correct:v.trim(),tag:d.trim(),analysis:O.trim(),difficulty:u.trim(),blanks:D,keyWords:s,order:C.trim(),rest:o.trim(),upload:M.trim()}}function Ge(n){var t=[];return n.length>0&&n.forEach(r=>{var s=r.replace(R,"");s&&(s=s.split("/").filter(D=>D).join("/"),t.push(s))}),t}function At(n,t){for(var r=RegExp("\u3010\u3011","g"),s=null,D=[],v=n,d=0,O=Ge(t);(s=r.exec(n))!==null;)D.push(s.index);for(var u=D.length,C=0;C<u;C++){var M=D[C];if(!O[C])break;var o=O[C],c=M+d;v=v.substring(0,c+1).concat(o).concat(v.substring(c+1)),d+=o.length}return O.splice(u),{title:v,options:O}}function yt(n,t){var r=[],s="",D=t.title,v=t.options,d=t.blanks,O=t.keyWords,u=t.rest,C=D.match(ue),M=C&&C[0].trim().replace(/[\d\.【】]/g,"");s=n.filter(_=>M&&M.search(_.reg)!==-1),s=s.length>0?s[0].value:"",s||(v.length>0?s="multiple":d.length>0?s="fillBlank":(O.length>0,s="shortAnswer"));var o=D.replace(ue,"").trim();if(o||(o=u),s==="fillBlank"){var c=At(o,d);o=c.title,r=c.options}return{title:o,type:s,blankOptions:r}}function ht(n,t,r,s,D,v){var d=[];if(t.length>0&&(n==="single"||n==="multiple")&&t.forEach((u,C)=>{var M=String.fromCharCode(65+C),o=u.replace(ge,"").trim(),c=(0,l.Z)((0,l.Z)({},je),{},{title:o,is_answer:(D.indexOf(M)!==-1).toString(),option:"option".concat(C+1)});d.push(c)}),n==="trueOrFalse"&&(d=d.concat([(0,l.Z)((0,l.Z)({},je),{},{title:v("learning.questionAddOptionTofPlaceholderCorrect"),is_answer:rt.test(D).toString()}),(0,l.Z)((0,l.Z)({},je),{},{title:v("learning.questionAddOptionTofPlaceholderFalse"),is_answer:it.test(D).toString()})])),s.length>0&&n==="shortAnswer"){var O=[];s.forEach((u,C)=>{var M=u.replace(ke,"").trim();if(M){M=M.split("/").filter(c=>c),M=[...new Set(M)],O.length>0&&(M=M.filter(c=>!O.some(_=>_==c))),O=O.concat(M);var o=(0,l.Z)((0,l.Z)({},je),{},{title:M.join("/"),is_answer:"true",option:"option".concat(C+1)});d.push(o)}})}return r.length>0&&n==="fillBlank"&&r.forEach((u,C)=>{var M=(0,l.Z)((0,l.Z)({},je),{},{title:u,is_answer:"true",option:"option".concat(C+1)});d.push(M)}),d}function dt(n,t){var r=t.replace(ft,"").trim();if(!r)return"";if(n==="single"){if(!r.match(/^[A-Z]\s*$/))return"";var s=r.match(/^[A-Z]\s*$/);return s?s[0]:""}if(n==="multiple"){var D=r.match(/[A-Z]\s*/g);return D?D.join(""):""}return n==="trueOrFalse"&&(rt.test(r)||it.test(r))?r:""}function It(n){var t=n.replace(Ae,"").trim();return st.test(t.trim())&&(t=""),(0,l.Z)((0,l.Z)({},gt),{},{title:t})}function Ye(n){if(!n)return[];var t=[...new Set(n.replace(E,"").split(/\||\｜/))].filter(r=>r&&r.trim());return t.length===1&&st.test(t[0].trim())&&(t=[]),t}function Je(n,t){var r=n.replace(ye,"").trim();if(r.search(pt)!==-1){var s=t.filter(D=>r&&r.search(D.reg)!==-1);return s.length>0?s[0].value:"easy"}return"easy"}function Ke(n){var t=n.replace(qe,"").trim();return t.search(et)!==-1?tt.test(t)===!0?"true":"false":"true"}function ct(n){var t=n.replace(Et,"").trim();return t.search(et)!==-1&&tt.test(t)===!0?"true":"false"}function _t(n,t){var r=[],s=ot({t}),D=lt({t});return n.forEach((v,d)=>{var O=v.split(ne),u=at(O);if(u){var C=yt(D,u),M=C.title,o=C.type,c=C.blankOptions,_=dt(o,u.correct),Ze=ht(o,u.options,c,u.keyWords,_,t),F=It(u.analysis),L=Ye(u.tag),H=Je(u.difficulty,s),Pe=Ke(u.order),ve=ct(u.upload),ie={id:d+1+"",title:M,type:o,options:Ze,tags:L,analysis:F,difficulty:H,summary:Lt,is_order_match:Pe,is_answer_upload_image:ve};o!=="fillBlank"&&delete ie.is_order_match,o!=="fillBlank"&&o!=="shortAnswer"&&delete ie.is_answer_upload_image,r.push(ie)}}),r}var g=e(58849),y=e.n(g),le=e(10237),De=U.Z.TextArea,Le=(n,t)=>{var r=n.t,s=(0,i.useContext)($),D=s.state,v=s.dispatch,d=(0,i.useState)(""),O=(0,te.Z)(d,2),u=O[0],C=O[1];(0,i.useEffect)(()=>{C(D.questions)},[D.questions]);var M=(0,i.useMemo)(()=>lt({t:r}),[r]),o=(0,i.useMemo)(()=>r("examination.visualization.ruleTip").split(/\n/),[r]),c=function(){var H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,Pe=ut(u),ve;try{ve=_t(Pe,r)}catch(Re){V.default.warning(r("examination.visualization.hasError"));return}var ie=ve.length;if(ie>1e3){V.default.warning(r("examination.visualization.maxLimit"));return}if(H){if(ie===0){V.default.warning(r("examination.visualization.identifyFail"));return}v({type:"updateList",payload:{questionList:ve,currentCom:"batchAdd",questions:u}}),le.WY.logger({keyword:"visual",moduleName:"visual-import-new",msg:"visual import data",data:{resultData:ve,originData:u}})}};(0,i.useImperativeHandle)(t,()=>({identify:()=>{c(!0)}}));var _=L=>{C(L);var H=ut(L);v({type:"updateCount",payload:H.length})},Ze=L=>{var H=document.getElementById("editor-question-quickly"),Pe=H.value.concat(L);_(Pe)},F=L=>{_(L.target.value),v({type:"updateMax",payload:L.target.value.length>524288})};return a().createElement("div",{className:y().identify},a().createElement("div",{className:y().top},a().createElement("div",{className:y().types},a().createElement("span",null,r("examination.visualization.setTip")),M.map(L=>a().createElement("span",{className:y().option,key:L.id,title:r("examination.visualization.insertTip"),onClick:()=>{Ze(L.sample)}},"\u3010",L.name,"\u3011"))),a().createElement("div",{className:y().difficulty},a().createElement(I.Z,{style:{color:"#FF8803"}}),r("examination.visualization.everyTip"))),a().createElement("div",{className:y().content},a().createElement("div",{className:y().editor},a().createElement(De,{id:"editor-question-quickly",className:y()["editor-section"],placeholder:r("examination.visualization.copyPlaceHolder"),value:u,onChange:F})),a().createElement("div",{className:y().tip},a().createElement("div",{className:y().title},r("examination.visualization.forRules")),a().createElement("div",{className:y().rule},o.map((L,H)=>a().createElement("div",{className:y().item,key:H},a().createElement(w.Z,{color:"#a4a4a4"}),a().createElement("span",{className:y()["rule-item"]},L)))),a().createElement("div",{className:y().dash}),a().createElement("div",{className:y().samples},a().createElement("div",{className:y().title},r("examination.visualization.forExample")),M.map(L=>a().createElement("pre",{key:L.id},L.sample))))))},Ie=(0,Me.Z)("translation",{withRef:!0})((0,i.forwardRef)(Le)),kt=e(20228),G=e(11382),Ct=e(62350),Dt=e(75443),ia=e(22385),Ot=e(31097),Kt=e(80991),Qt=e(5072),Ht=e(24040),ee=e.n(Ht),Zt=e(61834),Qe=e(56089),Wt=e(61698),xt=e(26922),Ft=e(84874),Oe=e(5259),Rt=e(38642),wt=e(6793),We=e(60828),Vt=(n,t)=>{var r=n.t,s=n.question_bank_id,D=n.onClose,v=n.statistic,d=v.error,O=(0,i.useContext)($),u=O.state,C=O.dispatch,M=u.questionList,o=u.verifiedQuestionList,c=u.addLoading,_=(0,i.useState)(""),Ze=(0,te.Z)(_,2),F=Ze[0],L=Ze[1],H=(0,i.useRef)();(0,i.useEffect)(()=>{if(Array.isArray(M)&&M.length>0){var A=ve(M,s),S=A.find(Z=>{var Q=Z.verifyFlag;return!Q})||A[0];S&&L(S.id),setTimeout(()=>{Pt(S)},0),C({type:"updateVerifiedList",payload:A})}},[M,s,C]),(0,i.useImperativeHandle)(t,()=>({batchAdd:Pe}));var Pe=function(){var A=(0,J.Z)(m().mark(function S(){var Z,Q,_e,mt,vt,Be;return m().wrap(function(se){for(;;)switch(se.prev=se.next){case 0:if(Z=Array.isArray(o),Z){se.next=4;break}return V.default.error(r("examination.visualization.noneSuccess")),se.abrupt("return");case 4:if(o.filter(zt=>{var qt=zt.verifyFlag;return qt}).length===o.length){se.next=7;break}return V.default.error(r("examination.visualization.hasError")),se.abrupt("return");case 7:return C({type:"updateAddLoading",payload:!0}),se.prev=8,se.next=11,(0,Rt.Kb)((0,Oe.P2)({question_bank_id:s,content:o}));case 11:if(Q=se.sent,_e=(0,te.Z)(Q,2),mt=_e[0],vt=_e[1],!vt){se.next=20;break}if(Be=vt.data,!(Be&&Be.code==="200000")){se.next=19;break}return se.abrupt("return",!0);case 19:return se.abrupt("return",!1);case 20:if(mt.response.data.code){se.next=23;break}return V.default.error(r("examination.visualization.addFail")),se.abrupt("return",!1);case 23:return se.abrupt("return",!1);case 24:return se.prev=24,C({type:"updateAddLoading",payload:!1}),se.finish(24);case 27:case"end":return se.stop()}},S,null,[[8,,24,27]])}));return function(){return A.apply(this,arguments)}}(),ve=(A,S)=>Array.isArray(A)?A.map(Z=>Z.type===We.Nb.BLANK?(0,l.Z)((0,l.Z)({},Z),{},{question_bank_id:S,options:(0,We.iq)(Z),verifyFlag:xt.Z.verifyQuestion(Z)}):(0,l.Z)((0,l.Z)({},Z),{},{question_bank_id:S,verifyFlag:xt.Z.verifyQuestion(Z)})):[],ie=(0,i.useCallback)(A=>{var S=Array.isArray(o)?o.map(Z=>{if(Z.id===F){var Q=(0,Wt.Uh)(A);return(0,l.Z)((0,l.Z)({},Q),{},{verifyFlag:xt.Z.verifyQuestion(Q)})}return Z}):[];C({type:"updateVerifiedList",payload:S})},[F,C,o]),Re=(0,i.useCallback)((A,S)=>{var Z=o.filter(_e=>_e.id!==A);if(Z.length===0){D();return}if(A===F){var Q=S+1===o.length?Z[S-1]:Z[S];Q&&L(Q.id)}C({type:"updateVerifiedList",payload:Z})},[F,C,o,D]),he=A=>{L(A.id)},Fe=(0,i.useCallback)(A=>{he(A),setTimeout(()=>{Pt(A)},0)},[]),Pt=A=>{var S=document.querySelector("#question-".concat(A.id));S&&S.scrollIntoView({behavior:"smooth"})},Mt=(0,i.useCallback)((A,S)=>{var Z=A.id;return a().createElement("div",{className:ee()["title-operate"]},a().createElement(Dt.Z,{title:r("exam.confirmDeleteTest"),onConfirm:Q=>{Q.stopPropagation(),Re(Z,S)},okText:r("common.ok"),cancelText:r("common.cancel")},a().createElement(Ot.Z,{title:r("common.delete")},a().createElement("span",{className:"".concat(ee()["delete-icon-container"]),onClick:Q=>{Q.stopPropagation()}},a().createElement(Ft.Z,{iconClass:"icon-piliangshanchu",size:"14px"})))))},[r,Re]),bt=(0,i.useCallback)(()=>!Array.isArray(o)||o.length<=0?null:o.map((A,S)=>{var Z=A.id;return a().createElement(Zt.Z,{previewType:Qe.wD.BATCH_ADD,index:S+1,className:"".concat(ee()["question-container"],`
            `).concat(A.verifyFlag?ee()["question-success"]:ee()["question-error"],`
            `).concat(Z===F?ee()["question-active"]:""),key:Z,domId:"question-".concat(Z),questionInfo:A,renderTitleRight:Mt,onQuestionItemClick:he})}),[Mt,o,F]),Tt=(0,i.useCallback)(()=>d<=0||!Array.isArray(o)||o.length<=0?null:o.map((A,S)=>{var Z=A.id,Q=A.verifyFlag;if(Q)return null;var _e=(S+1).toString().length;return a().createElement("div",{key:Z,className:"".concat(ee().index,`
            `).concat(A.verifyFlag?ee()["index-success"]:ee()["index-error"],`
            `).concat(Z===F?A.verifyFlag?ee()["index-success-active"]:ee()["index-error-active"]:""),onClick:()=>{Fe(A)},style:{width:"".concat(_e>2?(_e-2)*4+20:20,"px")}},S+1)}),[Fe,d,o,F]),Nt=(0,i.useCallback)(()=>{if(o.length>0&&F){var A=o.find(Z=>Z.id===F);if(A){var S=(0,Wt.oo)({t:r,data:A,type:Qe.wD.BATCH_ADD});return a().createElement("div",{className:ee()["batch-add-form-container"]},a().createElement(Kt.J9,{key:F,ref:H,initialValues:S,render:Z=>a().createElement(Qe.sc,(0,me.Z)({},Z,{formRef:H,layout:{formFieldLayout:{labelCol:{xs:{span:0},sm:{span:0}},wrapperCol:{xs:{span:24},sm:{span:24}}},formTitleLayout:{labelCol:{span:4},wrapperCol:{span:20}}},optionLayout:{label:"56px",content:15,checkbox:3,placeholder:2},disabledInput:!1,type:Qe.wD.BATCH_ADD,onFormValuesChange:ie}))}))}}return null},[ie,r,o,F]);return a().createElement("div",{className:ee().container},a().createElement(G.Z,{spinning:c}),a().createElement("div",{className:ee().content},d>0&&a().createElement("header",null,a().createElement("span",{className:ee()["icon-container"]},a().createElement(Qt.Z,{style:{color:"#FFF",fontSize:"12px"}})),a().createElement("span",{className:ee()["error-tip"]},(0,wt.ZT)(r("examination.visualization.hasErrorNumTip"),d)),Tt({list:o,id:F})),a().createElement("div",{className:ee().body},a().createElement("div",{className:ee().left},bt({list:o,id:F})),a().createElement("div",{className:ee().right},Nt({list:o,id:F})))))},jt=(0,Me.Z)("translation",{withRef:!0})((0,i.forwardRef)(Vt)),Gt=(n,t)=>{var r=t.type,s=t.payload;switch(r){case"updateList":return(0,l.Z)((0,l.Z)({},n),{},{questionList:s.questionList,currentCom:s.currentCom,questions:s.questions});case"updateVerifiedList":return(0,l.Z)((0,l.Z)({},n),{},{verifiedQuestionList:s});case"updateCurrent":return(0,l.Z)((0,l.Z)({},n),{},{currentCom:s});case"updateAddLoading":return(0,l.Z)((0,l.Z)({},n),{},{addLoading:s});case"updateCount":return(0,l.Z)((0,l.Z)({},n),{},{count:s});case"updateAddGuideModalVisible":return(0,l.Z)((0,l.Z)({},n),{},{addGuideModalVisible:s});case"clear":return(0,l.Z)({},Bt);case"updateMax":return(0,l.Z)((0,l.Z)({},n),{},{overMax:s});default:throw new Error}},Bt={questionList:[],verifiedQuestionList:[],currentCom:"identifyQuestion",questions:"",addLoading:!1,count:0,addGuideModalVisible:!1,overMax:!1},Yt=e(89445),xe=e.n(Yt);function k(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=0,r=0,s=0,D=0,v=0,d=0,O=0;return Array.isArray(n)&&n.forEach(u=>{switch(d=d+1,u.verifyFlag||(O=O+1),u.type){case"single":{t=t+1;break}case"multiple":{r=r+1;break}case"trueOrFalse":{s=s+1;break}case"fillBlank":{D=D+1;break}case"shortAnswer":{v=v+1;break}default:break}}),{total:d,single:t,multiple:r,trueOrFalse:s,fillBlank:D,shortAnswer:v,error:O}}var re=n=>{var t=n.t,r=n.visible,s=n.onClose,D=n.refreshList,v=(0,i.useReducer)(Gt,Bt),d=(0,te.Z)(v,2),O=d[0],u=d[1],C=O.currentCom,M=O.addLoading,o=O.count,c=O.verifiedQuestionList,_=O.addGuideModalVisible,Ze=O.overMax,F=(0,i.useRef)(null),L=(0,i.useRef)(null),H=function(){var Z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Q=Z.operateType;if(C===Qe.wD.BATCH_ADD&&Q){Pe({operateType:Q});return}typeof s=="function"&&(s(),_&&u({type:"updateAddGuideModalVisible",payload:!1}),u({type:"clear"}))},Pe=function(){var Z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Q=Z.operateType;if(M){V.default.warn(t("examination.visualization.disabledCloseDrawerTip"));return}if(Array.isArray(c)&&c.length>0){var _e=t(Q==="cancel"?"examination.visualization.batchAddCancelConfirmTip":"examination.visualization.batchAddCloseConfirmTip");$e.Z.confirm({title:t("integralMall.warmPrompt"),icon:a().createElement(He.Z,null),content:_e||"",okText:t("common.ok"),cancelText:t("common.cancel"),onOk:()=>{typeof s=="function"&&(s(),u({type:"clear"}))}})}},ve=()=>{F.current.identify()},ie=function(){var S=(0,J.Z)(m().mark(function Z(){var Q,_e,mt;return m().wrap(function(Be){for(;;)switch(Be.prev=Be.next){case 0:return Be.next=2,(0,Rt.Kb)(L.current.batchAdd());case 2:Q=Be.sent,_e=(0,te.Z)(Q,2),mt=_e[1],mt&&(u({type:"updateAddGuideModalVisible",payload:!0}),D());case 6:case"end":return Be.stop()}},Z)}));return function(){return S.apply(this,arguments)}}(),Re=function(Z){var Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:300;return q()(Z,Q)},he=(0,i.useMemo)(()=>k(c),[c]),Fe=he.total,Pt=he.single,Mt=he.multiple,bt=he.trueOrFalse,Tt=he.fillBlank,Nt=he.shortAnswer,A=he.error;return a().createElement(pe.Z,{title:t("examination.visualization.questionsQuickly"),onClose:()=>{H({operateType:"close"})},width:1180,visible:r,maskClosable:!1,destroyOnClose:!0,className:xe()["quickly-add-questions"],placement:"right",footer:a().createElement("div",{className:xe().footer},C==="identifyQuestion"?a().createElement("div",{className:xe().total},a().createElement("div",null,t("examination.visualization.hasInput"),a().createElement("span",{className:xe().count},o),t("examination.visualization.totalQuestions")),Ze?a().createElement("div",{className:xe().error},t("examination.visualization.maxChars")):null):a().createElement("div",{className:xe()["batch-add-footer"]},t("common.total"),"(",Fe,")\uFF1A",t("examination.single")," ",Pt," \uFF0C",t("examination.multiple")," ",Mt," \uFF0C",t("examination.tof")," ",bt," \uFF0C",t("examination.blank")," ",Tt," \uFF0C",t("examination.describe")," ",Nt," \u3002"),a().createElement(Ne.Z,null,a().createElement(Ee.Z,{onClick:()=>{H({operateType:"cancel"})},disabled:M},t("common.cancel")),C==="identifyQuestion"?a().createElement(Ee.Z,{disabled:o===0||Ze,onClick:ve,type:"primary"},t("examination.visualization.identify")):a().createElement("div",null,a().createElement(Ee.Z,{onClick:Re(ie),disabled:M,type:"primary"},t("common.ok")))))},a().createElement($.Provider,{value:{state:O,dispatch:u}},C==="identifyQuestion"?a().createElement(Ie,{ref:F}):null,C===Qe.wD.BATCH_ADD?a().createElement(a().Fragment,null,a().createElement(jt,{ref:L,question_bank_id:fe.m8.location.query.questionBankId,onClose:H,statistic:{error:A}}),a().createElement($e.Z,{className:xe()["batch-add-guide-modal"],title:a().createElement("div",{className:xe()["guide-modal-title-container"]},a().createElement(Ue.Z,{style:{fontSize:"24px",color:"#29C881"}}),a().createElement("span",{className:xe()["guide-modal-title"]}," ",t("examination.visualization.addSuccess"))),width:450,footer:null,closable:!1,visible:_},a().createElement("div",{className:xe()["guide-modal-content"]},a().createElement(Ee.Z,{type:"primary",onClick:H},t("shareInfo.returnTable")),a().createElement(Ee.Z,{type:"primary",onClick:()=>{u({type:"clear"}),u({type:"updateAddGuideModalVisible",payload:!1}),u({type:"updateCurrent",payload:"identifyQuestion"})}},t("examination.visualization.continueAdd"))))):null))},St=(0,Me.Z)("translation",{withRef:!0})(re),Xe=e(90631),fa=e(57254),sa=e(75908),la=e(86726),pa=e(9925);function Ea(n,t,r){var s=r.importVisible;return[{type:"add",style:s?"dropdown":"",name:n("examination.addQuestion"),icon:a().createElement(Ft.Z,{iconClass:"icon-icon_addx"}),more:s?[{type:"add",name:n("examination.visualization.questionsManually"),visible:!0},{type:"quicklyAdd",name:n("examination.visualization.questionsQuickly"),visible:s}]:!1},{type:"import",name:n("exam.importTemplate"),icon:a().createElement(Xe.Z,null),visible:()=>s},{type:"more",name:"".concat(n("common.more")).concat(n("common.operate")),visible:!0,icon:a().createElement(fa.Z,null),more:[{type:"export",disable:!1,name:n("exam.exportQuestion")},{type:"delete",disable:t.length===0,name:n("common.delete"),tooltip:{placement:"bottom",title:n("exam.deleteQuestionFromBankWarn"),mouseEnterDelay:.8}},{type:"move",disable:t.length===0,name:n("exam.move"),tooltip:{placement:"bottom",title:n("exam.adjustBankWarn"),mouseEnterDelay:.8}}]}]}function ga(n,t,r,s){var D=(0,la.H3)("preview",r);return{columns:[{title:n("examination.paperName"),key:"title",render:(v,d)=>{var O=d.type,u=O==="fillBlank"?d.title.replace(`
`,"").replace(`\r
`,"").replace(/\【.*?\】/g,"____"):d.title;return a().createElement("div",{className:"".concat(t.ellipsis," ").concat(t["column-title"]," ").concat(D?t.preview:""),onClick:()=>s(D,d),style:{width:"250px"}},a().createElement(Ot.Z,{placement:"topLeft",title:u},u))},fixed:"left"},{title:n("examination.knowledgePoint"),key:"tags",render:v=>a().createElement("div",{className:"".concat(t.ellipsis),style:{width:"170px"}},a().createElement(Ot.Z,{placement:"top",title:v.join("|")},typeof v=="string"?v:v.join("|")))},{title:n("examination.complexity"),key:"difficulty",width:100,filters:[{text:n("common.all"),value:"all"}].concat((0,sa.k4)({t:n})),filterMultiple:!1,render:v=>{var d=(0,We.AZ)({t:n,type:We.kh.QUESTION_DIFFICULT});return a().createElement("span",null,d[v])}},{title:n("examination.paperType"),key:"type",width:100,filters:[{text:n("common.all"),value:"all"}].concat((0,sa.OH)({t:n})),filterMultiple:!1,render:(v,d)=>{var O=(0,We.AZ)({t:n,type:We.kh.QUESTION_TYPE});return a().createElement("span",null,O[d.type])}},{title:n("common.createTime"),key:"create_time",render:v=>(0,wt.p6)(+v,"yyyy.MM.dd hh:mm")},{title:n("common.creator"),key:"create_user_name",render:(v,d)=>a().createElement(pa.Z,{userId:d.create_user,userName:d.create_user_name})},{title:n("common.operate"),key:"operate",width:190,fixed:"right",visibleNum:2,buttons:[{key:"edit",name:n("common.edit"),checkAuth:!0},{key:"delete",name:n("common.delete"),checkAuth:!0},{key:"copy",name:n("common.copy"),checkAuth:!0}]}]}}var ya=e(59777),$t=e.n(ya),ha=e(99367),_a=e(48479),Ca=e(11449),Da=e(89962),oa=e(5430),Jt=e(97413),Oa=e(31457),Xt=e(1164),Za=e(84717),Pa=n=>{var t=n.user;return{modules:t.modules}},Ma=n=>{var t=n.t,r=(0,i.useRef)(),s=(0,h.I0)(),D=oe.parse(fe.m8.location.search),v=D.questionBankId,d=D.questionBankName,O=(0,la.V9)("newQuestion",n.modules),u=()=>a().createElement("a",{onClick:Ia},t("component.downloadTem")),C=()=>a().createElement("ul",{className:$t()["download-tip"]},a().createElement("li",null,t("component.fileImportType")),a().createElement("li",null,t("component.fileImportSize")),a().createElement("li",null,t("component.fileImportTip"))),M=(0,i.useState)({keyword:"",visible_range:"all",question_bank_ids:v}),o=(0,te.Z)(M,2),c=o[0],_=o[1],Ze=(0,i.useState)(()=>({type:"",visible:!1,title:"",tip:"",tipContent:"",list:[],questionIds:[]})),F=(0,te.Z)(Ze,2),L=F[0],H=F[1],Pe=(0,i.useState)([]),ve=(0,te.Z)(Pe,2),ie=ve[0],Re=ve[1],he=(0,i.useState)({visible:!1,title:t("exam.paperImportQus"),size:2,isMultiple:!1,actionUrl:oa.OB.question.upload()}),Fe=(0,te.Z)(he,2),Pt=Fe[0],Mt=Fe[1],bt=(0,i.useState)({visible:!1}),Tt=(0,te.Z)(bt,2),Nt=Tt[0],A=Tt[1],S=(0,i.useState)({visible:!1,onCancel:()=>{na(!1)},onOk:()=>{na(!1)},questionId:""}),Z=(0,te.Z)(S,2),Q=Z[0],_e=Z[1],mt=(0,i.useState)(!1),vt=(0,te.Z)(mt,2),Be=vt[0],ua=vt[1],se=(0,i.useState)(!1),zt=(0,te.Z)(se,2),qt=zt[0],La=zt[1];(0,i.useEffect)(()=>{r.current.load(c)},[c]),(0,i.useEffect)(()=>{Aa()},[]);var Aa=function(){var f=(0,J.Z)(m().mark(function P(){var T,b,W,Y;return m().wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:return ce.next=2,(0,Rt.Kb)((0,Za.UE)());case 2:T=ce.sent,b=(0,te.Z)(T,2),W=b[1],Y=W.data,Y&&Y.code===2e5&&La(!!(Y&&Y.data&&Y.data.isFree==="false"));case 7:case"end":return ce.stop()}},P)}));return function(){return f.apply(this,arguments)}}(),Ia=()=>{window.location.href="".concat(oa.OB.question.download(),"?access_token=").concat(window.localStorage.getItem("token"),"&is_multiple=false")},ea=f=>{Mt(P=>(0,l.Z)((0,l.Z)({},P),{},{visible:f}))},xa=function(){var f=(0,J.Z)(m().mark(function P(T){var b,W,Y;return m().wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:return b=T.importedList,ce.next=3,(0,Oe.BX)({new_file_name:b[0].newFileName,question_bank_id:v});case 3:W=ce.sent,Y=W.data.code,Y==="200000"&&(V.default.success(t("examination.importSuccess")),ea(!1),r.current.load());case 6:case"end":return ce.stop()}},P)}));return function(T){return f.apply(this,arguments)}}(),Ra=f=>(c=(0,l.Z)((0,l.Z)({},c),f),(0,Oe.eb)((0,l.Z)((0,l.Z)({},c),f))),da=f=>{var P=f.type,T=f.param;_(b=>(0,l.Z)((0,l.Z)({},b),{},{[P]:T}))},Ba=f=>{Re(f)},Sa=f=>{switch(f){case"add":Xt.Z.targetTo({path:"/knowledgeBase/examResources/newQuestion/detail/add?".concat(oe.stringify({questionBankId:v,questionBankName:d}))});break;case"quicklyAdd":ca(!0);break;case"import":ea(!0);break;case"export":ba(c);break;case"delete":ma(ie);break;case"move":Ua(ie);break;default:}},ba=function(){var f=(0,J.Z)(m().mark(function P(T){var b,W;return m().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.next=2,(0,Oe.yB)(v,{question_ids:ie,type:T.type});case 2:b=N.sent,W=b.data.code,W==="200000"&&((0,Oa.Pp)({dispatch:s}),V.default.success(t("study.compoundSucceed")));case 5:case"end":return N.stop()}},P)}));return function(T){return f.apply(this,arguments)}}(),ca=f=>{ua(f)},ta=f=>{H((0,l.Z)((0,l.Z)({},L),{},{visible:f}))},aa=(f,P)=>{A(T=>(0,l.Z)((0,l.Z)({},T),{},{visible:f,ids:P}))},na=function(P){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";_e(b=>(0,l.Z)((0,l.Z)({},b),{},{visible:P,questionId:T}))},Na=()=>{L.type==="delete"?va(L.questionIds):L.type==="move"?A(f=>(0,l.Z)((0,l.Z)({},f),{},{visible:!0})):Xt.Z.targetTo({path:"/knowledgeBase/examResources/newQuestion/detail/edit?".concat(oe.stringify({questionId:L.questionIds[0],questionBankId:v,questionBankName:d}))}),ta(!1)},Ua=function(){var f=(0,J.Z)(m().mark(function P(T){var b,W,Y,N;return m().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return X.next=2,(0,Oe.Nl)({ids:T.join(",")});case 2:b=X.sent,W=b.data,Y=W.code,N=W.data,Y==="200000"&&(N.is_quote==="false"?aa(!0,T):H(ra=>(0,l.Z)((0,l.Z)({},ra),{},{visible:!0,type:"move",title:t("examination.moveTip"),tip:t("examination.moveTipByRefer"),tipContent:t("examination.moveTipMore"),questionIds:T,list:N.quote_list||[]})));case 7:case"end":return X.stop()}},P)}));return function(T){return f.apply(this,arguments)}}(),ka=function(){var f=(0,J.Z)(m().mark(function P(T){var b,W,Y,N;return m().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return b=T.id,W=T.title,X.next=3,(0,Oe.MJ)(b,{ids:ie,paper_ids:L.list.map(ra=>ra.id)});case 3:Y=X.sent,N=Y.data.code,N==="200000"&&(V.default.success(t("examination.moveToBankSuccess",{to:W})),aa(!1),Re([]),r.current.load());case 6:case"end":return X.stop()}},P)}));return function(T){return f.apply(this,arguments)}}(),ma=function(){var f=(0,J.Z)(m().mark(function P(T){var b,W,Y,N;return m().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return X.next=2,(0,Oe.Nl)({ids:T.join(",")});case 2:b=X.sent,W=b.data,Y=W.code,N=W.data,Y==="200000"&&(N.is_quote==="false"?$e.Z.confirm({title:t("common.tip"),okText:t("common.ok"),cancelText:t("common.cancel"),content:t("examination.questionDeleteConfirm"),onOk:()=>{va(T)},onCancel:()=>{}}):H((0,l.Z)((0,l.Z)({},L),{},{visible:!0,type:"delete",title:t("examination.deleteQuestionTip"),tip:t("examination.deleteTipByRefer"),tipContent:t("examination.deleteTipMore"),questionIds:T,list:N.quote_list||[]})));case 7:case"end":return X.stop()}},P)}));return function(T){return f.apply(this,arguments)}}(),va=function(){var f=(0,J.Z)(m().mark(function P(T){var b,W;return m().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.next=2,(0,Oe.Km)({ids:T,paper_ids:L.list.map(ce=>ce.id)});case 2:b=N.sent,W=b.data.code,W==="200000"&&(V.default.success(t("common.deleteSuccess")),ta(!1),Re([]),r.current.load());case 5:case"end":return N.stop()}},P)}));return function(T){return f.apply(this,arguments)}}(),Ka=function(){var f=(0,J.Z)(m().mark(function P(T){var b,W;return m().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.next=2,(0,Oe.dY)(T);case 2:b=N.sent,W=b.data.code,W==="200000"&&(V.default.success(t("exam.copySucceed")),r.current.load());case 5:case"end":return N.stop()}},P)}));return function(T){return f.apply(this,arguments)}}(),Qa=function(){var f=(0,J.Z)(m().mark(function P(T){var b,W,Y,N;return m().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return X.next=2,(0,Oe.Nl)({ids:T});case 2:b=X.sent,W=b.data,Y=W.code,N=W.data,Y==="200000"&&(N.is_quote==="false"?Xt.Z.targetTo({path:"/knowledgeBase/examResources/newQuestion/detail/edit?".concat(oe.stringify({questionId:T,questionBankId:v,questionBankName:d}))}):H((0,l.Z)((0,l.Z)({},L),{},{visible:!0,type:"edit",title:t("examination.editQuestionTip"),tip:t("examination.editTipByRefer"),tipContent:t("examination.editTipMore"),questionIds:[T],list:N.quote_list||[]})));case 7:case"end":return X.stop()}},P)}));return function(T){return f.apply(this,arguments)}}(),Wa=f=>{var P=f.type,T=f.disable,b=f.record;if(!T)switch(P){case We.oc.EDIT:Qa(b.id);break;case We.oc.DELETE:ma([b.id]);break;case"copy":Ka(b.id);break;default:break}},Fa=(f,P)=>{!f||na(!0,P.id)},wa=()=>a().createElement(B.Z,{type:"newQuestion",configs:Ea(t,ie,{importVisible:qt}),cb:Sa}),$a=()=>{var f=n.t;return a().createElement(a().Fragment,null,a().createElement(nt.Z,{className:"top-operate-checkbox",style:{marginLeft:16},onChange:P=>{da({type:"visible_range",param:P.target.checked?"onlyMe":"all"})}},f("common.myCreated")),a().createElement("div",null,a().createElement(_a.Z,{onSearch:P=>{da({type:"keyword",param:P})},placeholder:f("searchInputPlaceholder.question"),maxLength:15})))};return a().createElement(Ca.Z,{pageContainerParams:{header:{title:"\u300A".concat(d,"\u300B")}},pageTitle:t("leftMenuLists.questionBankDetails")},a().createElement("div",{className:"".concat($t()["detail-list"],"  ").concat($t().table)},a().createElement(ha.Z,{ref:r,uniKey:"newQuestion",queryParams:(0,l.Z)((0,l.Z)({},ga(t,$t(),O,Fa)),{},{query:Ra,operateHandles:Wa}),rowSelection:{selectedRowKeys:ie,onChange:Ba},pagination:!0,headerTitle:wa(),toolBarRender:$a,uuid:"3ff14031-4659-49f7-bab9-197f7a33682e"}),a().createElement(Da.Z,(0,me.Z)({},Pt,{onCancel:()=>{ea(!1)},onOk:xa,renderDownLoad:u,renderTip:C})),a().createElement(Jt.pU,(0,me.Z)({},L,{onCancel:()=>{ta(!1)},onOk:Na})),a().createElement(Jt.lg,(0,me.Z)({},Nt,{onCancel:()=>{aa(!1)},onOk:f=>{ka(f)}})),a().createElement(St,{visible:Be,onClose:()=>{ca(!1)},refreshList:()=>{r.current.load()}}),Q.visible&&a().createElement(Jt.Dc,Q)))},Ta=(0,h.$j)(Pa)((0,Me.Z)()(Ma))}}]);
