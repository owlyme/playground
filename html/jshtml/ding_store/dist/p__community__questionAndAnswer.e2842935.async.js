(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[6221],{27114:function(oe,K,e){"use strict";var J=e(62029),N=e(12924),y=e.n(N),I=e(38642),m=t=>{var E=()=>{(0,I.eJ)({url:"".concat(t.to)})};return y().createElement("a",(0,J.Z)({onClick:()=>E()},t),t.children)};K.Z=m},84493:function(oe,K,e){"use strict";e.d(K,{Z:function(){return Pe}});var J=e(57663),N=e(71577),y=e(62029),I=e(88986),m=e(12924),t=e.n(m),E=e(80991),P=e(91768),q=e(62615),ee=e(7584),te=e(2396),Q=e(3407),G=e(6793),ae=(0,G.me)(),U=Q.Z[ae].community,Y=p=>{var a=p.trim(),r;if(a.length!==0){var u=JSON.parse(a).blocks,l=u.reduce((i,g)=>i+=g.text.length,0);return l>5e3&&(r="\u9650\u5236\u8F93\u5165\u5B57\u7B265000\u5185"),r}},z=p=>{var a=p.trim(),r;if(a.length!==0){var u=JSON.parse(a).blocks,l=u.reduce((i,g)=>i+=g.text.length,0);return l>1e3&&(r=U.limit1000ErrTips),r}},ne=p=>{var a,r=p.trim();return r||(a=U.inputTitleTips),r.length>100&&(a=U.limit100ErrTips),a},R=p=>{var a;return p||(a=U.selectCircle),a},ce=p=>{var a;return a},x=e(76651),j=e(43358),D=e(34041),A=D.Z.Option;class W extends t().Component{constructor(){super(...arguments);this.onChange=a=>{var r=this.props.onHandleChange;r(a)}}render(){var a=this.props,r=a.t,u=a.options;return t().createElement(D.Z,{placeholder:r("community.selectCircle"),allowClear:!0,onChange:this.onChange},u.map(l=>t().createElement(A,{key:l.id,value:l.id},l.name)))}}var S=(0,P.Z)()(W),T=e(71194),H=e(57016),Z=e(54421),X=e(38272),re=e(47673),B=e(4107),ge=e(49111),f=e(19650),Je=e(71153),ue=e(60331),k=e(57361),He=e(34792),$=e(48086),F=e(33565),ye=e(9754),M=e.n(ye),le=e(10237),se=e(37055),Ce=e(84874),Oe=e(27114);function Te(p){var a=(0,m.useState)(!1),r=(0,F.Z)(a,2),u=r[0],l=r[1],i=(0,m.useState)([]),g=(0,F.Z)(i,2),o=g[0],V=g[1],Ae=(0,m.useState)([]),de=(0,F.Z)(Ae,2),Me=de[0],Ne=de[1],Ie=(0,m.useState)(""),ve=(0,F.Z)(Ie,2),L=ve[0],_=ve[1],Re=(0,m.useState)([]),pe=(0,F.Z)(Re,2),he=pe[0],We=pe[1],d=p.t,ie=5,Be=()=>{if(o.length>5){$.default.info(d("community.addTopicLimit"));return}l(!1)},$e=()=>{V([]),l(!1),_("")},Ee=n=>{o.splice(n,1),V([...o])},be=function(){var n=(0,k.Z)(M().mark(function s(){var C,O,h;return M().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(L!==""){v.next=2;break}return v.abrupt("return");case 2:return C=se.ZP.community.getLikeSearchTopic(L),v.next=5,le.WY.get({url:C,params:{tagName:L}});case 5:O=v.sent,h=O.data,h.code===0?We(h.data):$.default.error(h.msg||d("community.isError"));case 8:case"end":return v.stop()}},s)}));return function(){return n.apply(this,arguments)}}();(0,m.useEffect)(()=>{var n=p.onHandleChange;n(o)},[o]),(0,m.useEffect)(()=>{function n(){var s=null;return function(){s&&clearTimeout(s),s=setTimeout(be,100)}}n()()},[L]),(0,m.useEffect)(()=>{Ke()},[]);var Ke=function(){var n=(0,k.Z)(M().mark(function s(){var C,O,h;return M().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return C=se.ZP.community.getAllTopic(),v.next=3,le.WY.get({url:C});case 3:O=v.sent,h=O.data,h.code===0?Ne(h.data.slice(0,20)):$.default.error(h.msg||d("community.isError"));case 6:case"end":return v.stop()}},s)}));return function(){return n.apply(this,arguments)}}(),Ue=function(){var n=(0,k.Z)(M().mark(function s(C){var O,h,c;return M().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return O=se.ZP.community.getTopicStatus(),b.next=3,le.WY.get({url:O,params:{tagName:C}});case 3:if(h=b.sent,c=h.data,c.code!==0){b.next=7;break}return b.abrupt("return",c.data);case 7:$.default.error(d("community.isError"));case 8:case"end":return b.stop()}},s)}));return function(C){return n.apply(this,arguments)}}(),je=function(){var n=(0,k.Z)(M().mark(function s(){var C,O;return M().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(L){c.next=2;break}return c.abrupt("return",$.default.info(d("community.pleaseInputTag")));case 2:if(!(L.length>10)){c.next=4;break}return c.abrupt("return",$.default.warning(d("community.inputRules")));case 4:return c.next=6,Ue(L);case 6:if(C=c.sent,!C){c.next=10;break}return $.default.info(d("community.tagHadDisabled")),c.abrupt("return");case 10:O=Array.from(new Set([...o,L])),V(O),_("");case 13:case"end":return c.stop()}},s)}));return function(){return n.apply(this,arguments)}}(),fe=n=>{o.includes(n)||(V([...o,n]),_(""))},Ve=n=>{_(n.target.value.trim())};return t().createElement("div",{className:"topic-modal-list-container"},t().createElement(f.Z,{wrap:!0},o.map((n,s)=>t().createElement(ue.Z,{key:s,closable:!0,onClose:()=>Ee(s)},t().createElement(Oe.Z,{to:"/community"},"#",n,"#"))),t().createElement("div",{className:"topic-add-btn",onClick:()=>l(!0)},t().createElement(Ce.Z,{iconClass:"icon-icon_addx",size:"10px",color:"#465DCD"}),t().createElement("span",null,d("community.topic")))),t().createElement(H.Z,{title:d("community.addTopic"),visible:u,onOk:Be,onCancel:$e},t().createElement("header",{className:"topic-modal-header"},d("community.hadAddTopic"),"(",o.length,"/",ie,")"),t().createElement("div",{className:"topic-modal-topic"},t().createElement("span",null,o.map((n,s)=>t().createElement(ue.Z,{key:s,className:"topic-modal-tag",closable:!0,onClose:()=>Ee(s)},"#",n,"#")))),t().createElement(f.Z,null,t().createElement("span",{className:"topic-modal-name"},d("community.topicName"),":"),t().createElement(B.Z,{value:L,onChange:Ve,className:"topic-modal-create",placeholder:d("community.pleaseInput")}),t().createElement(N.Z,{type:"default",disabled:ie<=o.length,onClick:je,className:"topic-modal-button"},d("community.createTopic"))),he.length>0&&t().createElement("ul",{className:"topic-modal-ul"},he.map((n,s)=>t().createElement("li",{key:s,onClick:()=>fe(n)},n))),t().createElement("div",{className:"topic-modal-list"},t().createElement(X.ZP,{header:null,footer:null,bordered:!0,dataSource:Me,className:"topic-modal-list-body",renderItem:n=>t().createElement("div",{className:"topic-modal-list-item"},t().createElement("div",null,"#",n,"#"),t().createElement(N.Z,{disabled:ie<=o.length,className:"topic-modal-list-btn",onClick:()=>fe(n)},d("common.addSome")))}))))}var De=(0,P.Z)()(Te),me=e(43859),Se=(0,me.Z)(S),Ze=(0,me.Z)(De),w={labelCol:{xs:{span:24},sm:{span:3}},wrapperCol:{xs:{span:24},sm:{span:21}}};class Le extends m.Component{constructor(a){super(a);this.handleSure=r=>{var u=this.state.initialValues,l=this.props.handleSubject,i=(0,I.Z)((0,I.Z)({},r),{},{circle:u.circle,content:JSON.stringify({type:"pc",content:r.h5Article}),topic:u.topic});delete i.h5Article,l(i)},this.handleCancel=()=>{x.m8.goBack()},this.handleSelect=r=>{var u=this.state.initialValues,l=JSON.parse(JSON.stringify(u));l.circle=r,this.setState({initialValues:l})},this.handleCreateTopic=r=>{var u=this.state.initialValues,l=JSON.parse(JSON.stringify(u));l.topic=r,this.setState({initialValues:l})},this.state={initialValues:{title:"",h5Article:"",circle:"",topic:""}}}render(){var a=this.props,r=a.title,u=a.circleList,l=a.isArticle,i=a.t,g=this.state.initialValues;return t().createElement("div",{className:"form_common"},r&&t().createElement("h2",null,r),t().createElement("div",null,t().createElement(E.J9,{ref:o=>{this.initRef=o},initialValues:g,onSubmit:o=>this.handleSure(o),render:o=>t().createElement(E.l0,{className:"cl-form cl-notice-form"},t().createElement(E.gN,(0,y.Z)({component:ee.Z,name:"title",label:i(l?"h5Article.formRowName":"community.problem"),required:!0,type:"text",maxLength:100,placeholder:i("community.inputTitleTips"),defaultValue:g.title,validate:V=>(0,te.QK)(V,i("community.inputTitleTips"))},w)),t().createElement(E.gN,(0,y.Z)({component:Ze,name:"topic",label:i("community.addTopic"),type:"button",defaultValue:g.topic,isArticle:l,onHandleChange:this.handleCreateTopic},w)),t().createElement(E.gN,(0,y.Z)({label:i("community.addDescription"),component:q.h,displayType:"Custom",showPrivate:!1,name:"h5Article",defaultFieldList:g.h5Article,scrollDOMSelector:".h5-article-page",topHeight:128,validate:l?Y:z},w)),t().createElement(E.gN,(0,y.Z)({component:Se,name:"circle",label:i("community.selectSpace"),type:"select",defaultValue:g.circle,required:!0,onHandleChange:this.handleSelect,options:u},w)),t().createElement("div",{className:"form-common-option-btn"},t().createElement(N.Z,{htmlType:"submit",type:"primary"},i("common.release")),t().createElement(N.Z,{type:"default",onClick:this.handleCancel,style:{marginLeft:"20px"}},i("common.cancel"))))})))}}var Pe=(0,E.$j)((0,P.Z)()(Le))},70849:function(oe,K,e){"use strict";e.r(K);var J=e(88986),N=e(34792),y=e(48086),I=e(57361),m=e(9754),t=e.n(m),E=e(12924),P=e.n(E),q=e(91768),ee=e(84493),te=e(4408),Q=e(10237),G=e(37055),ae=e(69164),U=e(28216),Y,z,ne,R,ce=(Y=(0,U.$j)(x=>{var j=x.community;return{}}),z=Reflect.metadata("design:type",Function),ne=Reflect.metadata("design:paramtypes",[void 0]),Y(R=z(R=ne(R=class extends E.Component{constructor(j){var D;super(j);D=this,this.getCircleType=(0,I.Z)(t().mark(function A(){var W,S,T;return t().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return W=G.ZP.community.getGroups(0),Z.next=3,Q.WY.get({url:W});case 3:S=Z.sent,T=S.data,T.code===0?D.setState({circleList:T.data.content}):y.default.error(T.msg);case 6:case"end":return Z.stop()}},A)})),this.handleSubject=function(){var A=(0,I.Z)(t().mark(function W(S){var T,H,Z,X,re,B;return t().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(T=D.props.t,S.circle){f.next=4;break}return y.default.info(T("community.selectCircle")),f.abrupt("return");case 4:if(!(S.topic.length>5)){f.next=7;break}return y.default.info(T("community.addTopicLimit")),f.abrupt("return");case 7:return H=G.ZP.community.publishQuestion(S.circle),Z=localStorage.getItem("uid"),X=localStorage.getItem("name"),f.next=12,Q.WY.post({url:H,data:(0,J.Z)((0,J.Z)({},S),{},{userId:Z,userName:X})});case 12:re=f.sent,B=re.data,B.code===0?(D.props.dispatch({type:"community/saveCreateCenterTab",payload:{activeMyTab:"question"}}),studentRouteJump({url:"/community/questionDetail?id=".concat(B.data.id)}),(0,ae.Z)(B.data.integralInfo)):y.default.error(B.msg||T("community.isError"));case 15:case"end":return f.stop()}},W)}));return function(W){return A.apply(this,arguments)}}(),this.state={circleList:[]}}componentDidMount(){this.getCircleType()}render(){var j=this.state.circleList,D=j===void 0?[]:j,A=this.props.t;return P().createElement("div",{className:"question_container h5-article-page"},P().createElement(te.Z,{title:A("documentTitle.QAZone")}),P().createElement("div",{className:"question_content"},P().createElement(ee.Z,{title:A("community.addQuestion"),handleSubject:this.handleSubject,circleList:D})))}})||R)||R)||R);K.default=(0,q.Z)()(ce)}}]);
