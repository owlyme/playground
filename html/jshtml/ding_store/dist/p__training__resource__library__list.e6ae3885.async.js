(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[3109],{77217:function(fe,X,r){"use strict";var x=r(12924),P=r.n(x),N=W=>P().createElement("div",{className:"cl-breadcrumb-container"},W.children);X.Z=N},30389:function(fe,X,r){"use strict";r.d(X,{Z:function(){return q}});var x=r(62029),P=r(20228),N=r(11382),W=r(12924),k=r.n(W),te=r(91768),b=r(80991),m={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},R=r(62615),I=r(52670);class C extends k().Component{render(){var _=this.props,D=_.values,g=_.mode,v=_.onlyChooseDept,w=_.reserveUser,M=_.t,L=_.orgProps,u=_.rangeAuth,de=_.projectId,V=_.onCancel,z=_.onlyCreateUser;return k().createElement(b.l0,{className:"cl-form"},k().createElement(b.gN,(0,x.Z)({component:R.ww,displayType:"Custom",showSectitle:!1,name:"employeeRange",label:M("common.visibleRange"),defaultFieldList:D.employeeRange,validate:I.FI,mode:g,rangeAuth:u,onlyChooseDept:v,onlyCreateUser:z,orgProps:L,reserveUser:w,projectId:de,onCancel:V,qwTicketShow:!0},m)))}}var T=(0,te.Z)()(C),S=r(18329),B=r(34773);class E extends k().Component{constructor(){super(...arguments);this.initRefFormik=_=>{this.refFormik=_},this.handleBeforeCreate=()=>{var _=this.refFormik;_.submitForm(),_.runValidations().then(D=>{if(!Object.keys(D).length){var g=_.state.values.employeeRange,v=(0,B.b)(g.rangeList),w={qyWeChatVo:g.qyWeChatVo,id:this.props.actionId,isAll:g.rangeType,groupIds:g.rangeType===2?v.groupIds.join(","):"",departmentIds:g.rangeType===2?v.deptIds.join(","):"",userIds:g.rangeType===2?v.userIds.join(","):"",postIds:g.rangeType===2?v.postIds.join(","):"",clusterIds:g.rangeType===2?v.clusterIds.join(","):"",qy_we_chat_vo:g.qyWeChatVo};this.props.onCreate(w)}})},this.handleBeforeCancel=()=>{var _=this.props.onCancel;_()}}render(){var _=this.props,D=_.visible,g=_.initialParams,v=_.isLoading,w=_.tipInfo,M=_.mode,L=_.onlyChooseDept,u=_.reserveUser,de=u===void 0?[]:u,V=_.t,z=_.title,K=_.orgProps,$=_.rangeAuth,Q=_.projectId,H=_.onCancel,ee=_.onlyCreateUser,y=_.size;return v?k().createElement(N.Z,{size:"large"}):k().createElement(S.ZP,{wrapClassName:"cl-employee-selector-modal",visible:D,title:z||V("component.changeUser"),okText:V("common.ok"),cancelText:V("common.cancel"),size:y,onCancel:this.handleBeforeCancel,onOk:this.handleBeforeCreate},v?k().createElement(N.Z,{size:"large"}):k().createElement(b.J9,{ref:this.initRefFormik,initialValues:g,render:A=>k().createElement(T,(0,x.Z)({},A,{mode:M,rangeAuth:$,orgProps:K,onlyChooseDept:L,onlyCreateUser:ee,reserveUser:de,projectId:Q,onCancel:H}))}),w&&k().createElement("p",{style:{padding:"0 24px",wordBreak:"break-all",whiteSpace:"normal"}},w))}}E.defaultProps={visible:!1,initialParams:{employeeRange:{rangeType:1,rangeList:{dept:[],post:[],group:[],user:[],cluster:[]}}},tipInfo:"",isLoading:!1,mode:["all","part"],onlyChooseDept:!1,onlyCreateUser:!1,orgProps:{},onCancel:()=>{},onCreate:()=>{},size:"middle"};var q=(0,te.Z)()(E)},51697:function(fe,X,r){"use strict";var x=r(22385),P=r(31097),N=r(33565),W=r(12924),k=r.n(W),te=r(28216),b=r(84874),m=I=>{var C=I.title,T=I.visible,S=I.placement,B=S===void 0?"top":S,E=I.children,q=E===void 0?null:E,e=I.isNewUser,_=e===void 0?"":e,D=I.closeGuide,g=I.guideStatus,v=(0,W.useState)(!1),w=(0,N.Z)(v,2),M=w[0],L=w[1],u=z=>k().createElement("div",{className:"guide-tooltip-title"},z,k().createElement("span",{onClick:de},k().createElement(b.Z,{iconClass:"icon-f-close",size:"12px",color:"#fff"})));(0,W.useEffect)(()=>{L(T)},[T]);var de=z=>{if(z.stopPropagation(),z.preventDefault(),L(!1),D){D();return}_==="true"&&I.dispatch({type:"shouldRenderHeaderGuide",payload:{headerGuideStatus:!0}}),V()},V=()=>{localStorage.setItem("guideStatus","false"),I.dispatch({type:"updateGuideStatus",payload:{guideStatus:"false"}})};return k().createElement(P.Z,{title:u(C),placement:B,visible:M&&g==="true"&&C},q)},R=I=>({guideStatus:I.advancedSetting.guideStatus,isNewUser:I.advancedSetting.isNewUser});X.Z=(0,te.$j)(R)(m)},54650:function(fe,X,r){"use strict";var x=r(13062),P=r(71230),N=r(89032),W=r(15746),k=r(57361),te=r(9754),b=r.n(te),m=r(12924),R=r.n(m),I=r(91768),C=r(74880),T=r.n(C),S=r(18329),B=r(70517);class E extends R().Component{constructor(e){var _;super(e);_=this,this.onOk=(0,k.Z)(b().mark(function D(){var g,v,w;return b().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,(0,B.yW)();case 2:g=L.sent,v=g.data,w=g.success,w==="true"&&((0,B.$v)(),window.open(v.url,"_blank")),_.props.onClose();case 7:case"end":return L.stop()}},D)})),this.onCancel=()=>{(0,B.$v)(),this.props.onClose("noNeed")},this.state={featureList:[{title:"resourceLibrary.featureTitle1",subTitle:"resourceLibrary.featureSubTitle1",icon:"member_icon_mfzy.png"},{title:"resourceLibrary.featureTitle2",subTitle:"resourceLibrary.featureSubTitle2",icon:"member_icon_rl.png"},{title:"resourceLibrary.featureTitle3",subTitle:"resourceLibrary.featureSubTitle3",icon:"member_icon_gq.png"},{title:"resourceLibrary.featureTitle4",subTitle:"resourceLibrary.featureSubTitle4",icon:"member_icon_ai.png"},{title:"resourceLibrary.featureTitle5",subTitle:"resourceLibrary.featureSubTitle5",icon:"member_icon_ht.png"},{title:"resourceLibrary.featureTitle6",subTitle:"resourceLibrary.featureSubTitle6",icon:"member_icon_tdxz.png"}],memberList:["resourceLibrary.moreMemberTitle1","resourceLibrary.moreMemberTitle2","resourceLibrary.moreMemberTitle3","resourceLibrary.moreMemberTitle4","resourceLibrary.moreMemberTitle5"]}}render(){var e=this.state,_=e.featureList,D=e.memberList,g=this.props,v=g.t,w=g.visible;return R().createElement(S.ZP,{visible:w,width:"542",footer:null,bodyStyle:{maxHeight:"initial",width:489,height:629,padding:0},title:"",className:T().memberModal,closable:!1},R().createElement("div",{className:T().memberContent},R().createElement("img",{className:T().memberBg,src:"".concat("https://sdn.coolcollege.cn","/assets/kuxueyuan/laihua/member_bg.png")}),R().createElement("img",{className:T().memberTitle,src:"".concat("https://sdn.coolcollege.cn","/assets/kuxueyuan/laihua/member_title.png")}),R().createElement("p",{className:T().subTitle},v("resourceLibrary.freeTitle")),R().createElement("ul",{className:T().box},R().createElement("li",{className:T().itemBox},R().createElement(P.Z,null,_.map(M=>R().createElement(W.Z,{key:M.icon,span:8},R().createElement("img",{className:T().memberIcon,src:"".concat("https://sdn.coolcollege.cn","/assets/kuxueyuan/laihua/").concat(M.icon)}),R().createElement("p",{className:T().featureTitle},v(M.title)),R().createElement("p",{className:T().featureSubTitle},v(M.subTitle)))))),R().createElement("li",{className:T().itemBox},R().createElement("div",{className:T().title},R().createElement("img",{src:"".concat("https://sdn.coolcollege.cn","/assets/kuxueyuan/laihua/member_more_left.png")}),R().createElement("img",{className:T().titleCenter,src:"".concat("https://sdn.coolcollege.cn","/assets/kuxueyuan/laihua/member_more.png")}),R().createElement("img",{src:"".concat("https://sdn.coolcollege.cn","/assets/kuxueyuan/laihua/member_more_right.png")})),R().createElement("div",{className:T().content},D.map(M=>R().createElement("span",{className:T().name,key:M},v(M)))))),R().createElement("div",{className:T().okBtn,onClick:this.onOk},R().createElement("img",{className:"".concat(T().btnBg," ").concat(T().btnDefault),src:"".concat("https://sdn.coolcollege.cn","/assets/kuxueyuan/laihua/member_btn_bg.png")}),R().createElement("img",{className:"".concat(T().btnBg," ").concat(T().btnActive),src:"".concat("https://sdn.coolcollege.cn","/assets/kuxueyuan/laihua/member_btn_bg_active.png")}),v("resourceLibrary.freeMember")),R().createElement("p",{className:T().cancleBtn,onClick:this.onCancel},v("resourceLibrary.noNeed"))))}}X.Z=(0,I.Z)()(E)},11449:function(fe,X,r){"use strict";r.d(X,{Z:function(){return z}});var x=r(88986),P=r(33565),N=r(12924),W=r.n(N),k=r(3115),te=r(49111),b=r(19650),m=r(62029),R=r(57663),I=r(71577),C=r(91768),T=r(28216),S=r(37055),B=r(10237);function E(K){var $=S.ZP.getHelpContentByMenuKey(),Q={key:K};return B.WY.get({url:$,params:Q})}var q=r(74228),e=r.n(q),_=r(1164),D=r(76466),g=r(38642);class v extends W().Component{constructor($){var Q;super($);Q=this,this.getHelpContentByMenuKey=()=>{var H=this.props.defaultMenuKey;E(H).then(ee=>{var y=ee.data,A=y.help_url,O=y.video_url;this.setState({videoUrl:O,helpUrl:A})})},this.handleOpenHelpUrl=H=>{if((0,g.ve)()){window.open(H,"_blank");return}_.Z.targetTo({path:H,isExternalLink:!0})},this.handleOpenVideo=function(H){var ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Q.props.t("helpCenter.video");Q.setState(y=>({resourcePlayInfo:(0,x.Z)((0,x.Z)({},y.resourcePlayInfo),{},{resourceInfo:{originUrl:H,source:{FD:H,OD:H},contentType:"mp4"}}),previewInfo:(0,x.Z)((0,x.Z)({},y.previewInfo),{},{title:ee,visible:!0,onCancel:Q.handleCancelPreview})}))},this.handleCancelPreview=()=>{var H=this.state.previewInfo;this.setState({resourcePlayInfo:{mode:"preview",watchType:"video",resourceInfo:{}},previewInfo:(0,x.Z)((0,x.Z)({},H),{},{visible:!1})})},this.state={helpUrl:"",videoUrl:"",resourcePlayInfo:{autoPlay:!0,draggable:!0,mode:"preview",resourceInfo:{},watchType:"video"},previewInfo:{visible:!1,destroyOnClose:!0,title:$.t("helpCenter.video")||"\u89C6\u9891\u6307\u5BFC",onCancel:()=>{}}}}componentDidMount(){this.getHelpContentByMenuKey()}render(){var $=this.state,Q=$.helpUrl,H=$.resourcePlayInfo,ee=$.previewInfo,y=$.videoUrl,A=this.props.t;return W().createElement("div",{className:e().helpCenter},y&&W().createElement(I.Z,{type:"link",className:e()["video-btn"],style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenVideo(y)},A("helpCenter.video")),Q&&W().createElement(I.Z,{type:"link",style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenHelpUrl(Q)},A("helpCenter.tutorial")),W().createElement(D.Z,(0,m.Z)({},H,{previewInfo:ee})))}}var w=K=>({defaultMenuKey:K.currentRoute.menuKey});v.defaultProps={defaultMenuKey:""};var M=(0,T.$j)(w)((0,C.Z)()(v));function L(K){var $=K.extra,Q=localStorage.getItem("dingPersonnel"),H=sessionStorage.getItem("dingPersonnel");return W().createElement(b.Z,null,$,Q!=="dingPersonnel"&&H!=="dingPersonnel"&&(0,g.eY)("COMMONEXTRA_HELP_CENTER")&&W().createElement(M,null))}var u=L,de=r(4408);function V(K){var $=(0,N.useState)({helpCenter:(0,g.eY)("HEAD_HELP_CENTER_BUT")}),Q=(0,P.Z)($,1),H=Q[0],ee=K.pageContainerParams,y=ee===void 0?{}:ee,A=K.noPadding,O=A===void 0?!1:A,ue=K.isPersonal,re=ue===void 0?!1:ue,pe=K.pageTitle,G=K.className,se=G===void 0?"":G,Te={extra:H.helpCenter?W().createElement(u,{extra:y.extra}):y.extra},_e=(0,x.Z)((0,x.Z)({},y),Te);return W().createElement("div",{className:"page-container-content ".concat(O?"page-container-noPadding":""," ").concat(re?"page-container-content_personal_background":""," ").concat(se)},pe&&W().createElement(de.Z,{title:pe}),re?W().createElement(k.Z,null,K.children):W().createElement(k.Z,_e,K.children))}var z=V},85725:function(fe,X,r){"use strict";r.d(X,{Zv:function(){return N},t2:function(){return W},ew:function(){return k}});var x=r(37055),P=r(10237);function N(b,m){var R=x.ZP.PlatformCourse.learningUrl(b);return P.WY.get({url:R,params:m})}function W(b){var m=b.planId,R=x.ZP.EnterpriseCourse.playCountStatistics();P.qg.post({url:R,data:{courseId:m}})}var k=b=>{var m=x.ZP.Common.addDownloadLog(),R={param:b};return P.WY.get({url:m,params:R})},te=b=>{var m=CONFIG.visitors.shouldGoToCourseDetails(),R={setting_type:b};return request.get({url:m,params:R})}},82056:function(fe,X,r){"use strict";r.d(X,{cF:function(){return N},pN:function(){return W},rc:function(){return k},mo:function(){return te},eB:function(){return b},L_:function(){return m},Fm:function(){return R},mC:function(){return I}});var x=r(37055),P=r(10237),N=C=>{var T=x.ZP.localStorage.getStorage(C);return P.WY.get({url:T,params:C})},W=C=>{var T=x.ZP.localStorage.getStorage();return P.WY.post({url:T,data:C})},k=(C,T)=>{var S=x.ZP.localStorage.editStorage(C);return P.WY.put({url:S,data:T})},te=(C,T)=>{var S=x.ZP.localStorage.handleStatus(C,T);return P.WY.put({url:S})},b=C=>{var T=x.ZP.localStorage.editStorage(C);return P.WY.delete({url:T})},m=C=>{var T=x.ZP.localStorage.viewResourceLog();return P.WY.get({url:T,params:C})},R=C=>{var T=x.ZP.localStorage.defaultStorage(C);return P.WY.put({url:T})},I=C=>{var T=x.ZP.localStorage.checkCloud();return P.WY.post({url:T,data:C})}},28107:function(fe,X,r){"use strict";var x=r(66456),P=r(55313),N=r(22385),W=r(31097),k=r(57663),te=r(71577),b=r(71194),m=r(57016),R=r(88986),I=r(12924),C=r.n(I),T=r(91768),S=r(10237),B=r(37055),E=r(6793),q=r(18329),e=r(95664);class _ extends C().Component{constructor(g){super(g);this.onCancel=()=>{var v=this.props,w=v.handleReferenceList,M=v.onReferenceList;w?w():M&&M()},this.onContinueEdit=()=>{var v=this.props.continueEdit;v&&v()},this.initTableList=(v,w)=>{var M=this.props,L=M.type,u=M.operation,de=M.resourceId,V=M.t,z=this.state.resourceTypes,K=w||u;return this.setState({loading:!0}),S.WY.get({url:B.ZP.deleteResource.check(),params:(0,R.Z)((0,R.Z)({},this.state.params),{},{type:L,id:v||de})}).then($=>{if($.data.list&&$.data.list.length===0)return!0;if($.data.total<2&&$.data.list.length>0){var Q=$.data.list[0],H=Q.title,ee=Q.type_name,y=Q.create_user_name,A="";return K==="continueEdit"?A=(0,E.ZT)("".concat(V("component.continueEditReminderTip")),z[L],"\u300A".concat(H,"\u300B").concat(ee)):K==="forbiddenEdit"?A=(0,E.ZT)("".concat(V("component.forbiddenEditReminderTip")),z[L],"\u300A".concat(H,"\u300B").concat(ee)):A=(0,E.ZT)("".concat(V("component.deleteElseReminderTip")),z[L],"\u300A".concat(H,"\u300B(").concat(y?V("common.creator")+":"+y:"",")").concat(ee),V(K==="delete"?"common.delete":"course.cancelRelease")),K==="move"?(m.Z.confirm({title:V("common.tip"),content:(0,E.ZT)("".concat(V("component.forbiddenMoveReminderTip")),"\u300A".concat(H,"\u300B").concat(ee)),okText:V("common.ok"),onOk:()=>{this.onCancel()},onCancel:()=>{this.onCancel()}}),!1):(K==="continueEdit"?m.Z.confirm({title:V("common.tip"),content:A,okText:V("common.cancel"),cancelText:V("course.continueEdit"),onOk:()=>{this.onCancel()},onCancel:()=>{K==="continueEdit"&&this.props.continueEdit()}}):m.Z.info({title:V("common.tip"),content:A,okText:V("common.ok"),onOk:()=>{this.onCancel()}}),!1)}setTimeout(()=>{this.setState({loading:!1,tableList:$.data.list,tableTotal:$.data.total,tableTotalPages:$.data.pages})},300)})},this.handleTableChange=v=>{var w=this.state.params;w.page_number=v,this.setState({params:w},()=>{this.initTableList()})},this.renderFooter=()=>{var v=this.props,w=v.t,M=v.operation;return C().createElement("div",null,M==="continueEdit"?C().createElement(te.Z,{type:"primary",onClick:this.onContinueEdit},w("course.continueEdit")):null,C().createElement(te.Z,{type:"primary",onClick:this.onCancel},w("common.ok")))},this.state={loading:!0,params:{id:"",type:"",page_number:1,page_size:10},tableList:[],tableTotal:0,tableTotalPages:0,resourceTypes:{questionnaire:this.props.t("common.questionnaire"),classify:this.props.t("course.category"),paper:this.props.t("exam.paperAddTitle"),question:this.props.t("learning.questionAddTitle"),course:this.props.t("study.course"),resource:this.props.t("common.courseware"),lecturer:this.props.t("course.lecturer"),evaluationProduct:this.props.t("questionn.evaluationTool")}},this.columns=[{title:this.props.t("common.number"),dataIndex:"userId",width:30,render:(v,w,M)=>M+1},{title:this.props.t("common.name"),dataIndex:"title",width:420,render:v=>C().createElement(W.Z,{title:v},C().createElement("div",{className:"cl-text-ellipsis",style:{width:420}},v))},{title:this.props.t("study.type"),dataIndex:"type_name",width:120},{title:this.props.t("common.creator"),dataIndex:"create_user_name",width:30}]}componentDidMount(){var g=this.props.onRef;g&&g(this)}componentDidUpdate(g){var v=this.props.onRef;v||this.props.visible&&this.props.visible!==g.visible&&this.props.resourceId&&this.setState({params:{id:"",type:"",page_number:1,page_size:10},tableList:[],tableTotal:0,tableTotalPages:0},()=>{this.initTableList()})}render(){var g=this.props,v=g.visible,w=g.type,M=g.operation,L=g.t,u=this.state,de=u.loading,V=u.params,z=u.tableList,K=u.tableTotal,$=u.tableTotalPages,Q=u.resourceTypes;return C().createElement("div",null,K>1?C().createElement(q.ZP,{visible:v,title:M==="move"?"".concat(L("common.tip")):(0,E.ZT)("".concat(L("component.deleteReminder")),L(M==="delete"?"common.deletion":M==="cancelPublish"?"course.cancelRelease":"common.edit")),onCancel:this.onCancel,onOk:this.onCancel,footer:this.renderFooter()},C().createElement("div",{className:"referenceWithOther"},C().createElement("div",{className:"referenceWithOther__tip"},M==="continueEdit"?"".concat(L("component.this")).concat(Q[w]).concat(L("component.continueEditReminderTip2")):M==="forbiddenEdit"?"".concat(L("component.pleaseNote")).concat(Q[w]).concat(L("component.forbiddenEditReminderTip2")):M==="move"?"".concat(L("component.forbiddenMoveTip")):(0,E.ZT)("".concat(L("component.deleteReminderTip")),Q[w],L(M==="delete"?"common.delete":"course.cancelRelease"))),C().createElement(P.Z,{bordered:!0,size:"middle",columns:this.columns,rowKey:"id",dataSource:z,pagination:!1,loading:de}),C().createElement(e.Z,{defaultPageSize:10,totalNum:K,totalPage:$,current:V.page_number,showRenderRefresh:!1,onChange:this.handleTableChange}))):null)}}X.Z=(0,T.Z)()(_)},12203:function(fe,X,r){"use strict";r.r(X),r.d(X,{default:function(){return Wt}});var x=r(20228),P=r(11382),N=r(62029),W=r(36017),k=r(35247),te=r(34792),b=r(48086),m=r(88986),R=r(71194),I=r(57016),C=r(57361),T=r(18106),S=r(88108),B=r(9754),E=r.n(B),q=r(12924),e=r.n(q),_=r(91768),D=r(57068),g=r(28216),v=r(8812),w=r(85483),M=r(57663),L=r(71577),u=r(63185),de=r(9676),V=r(14781),z=r(53431),K=r(71153),$=r(60331),Q=r(22385),H=r(31097),ee=r(30887),y=r(99210),A=r(59250),O=r(13013),ue=r(9669),re=r.n(ue),pe=r(76651),G=r(57119),se=r(57254),Te=r(28107),_e=r(91805),le=r(95371),oe=r(90994),he=r(85725),Ae=r(47673),je=r(4107),De=r(59239),Je=r(55446),Le=r(18329),ge=r(6793),Ye={labelCol:{xs:{span:6},sm:{span:6}},wrapperCol:{xs:{span:16},sm:{span:16}}};class we extends e().Component{constructor(){super(...arguments);this.checkName=(p,l,a)=>{var t=this.props.t;(0,ge.fy)(l)?(0,ge.fy)(l).length>248?a(t("resourceLibrary.validationNewFolderLimit")):a():a(t("resourceLibrary.validationNewFolder"))},this.handleBeforeCreate=()=>{var p=this.props,l=p.form,a=p.id,t=p.onCreate;l.validateFields((s,n)=>{if(!s){var i=(0,m.Z)((0,m.Z)({},n),{},{value:(0,ge.fy)(n.value),id:a});t(i),setTimeout(()=>{l.resetFields()},100)}})},this.handleBeforeCancel=()=>{var p=this.props,l=p.form,a=p.onCancel;a(),setTimeout(()=>{l.resetFields()},100)},this.renderItem=()=>{var p=this.props,l=p.form,a=p.initialValue,t=p.labelTxt,s=l.getFieldDecorator,n=s("value",{initialValue:a,rules:[{validator:this.checkName}]})(e().createElement(je.Z,{placeholder:""}));return e().createElement(De.Z.Item,(0,N.Z)({label:t,required:!0},Ye),n)}}render(){var p=this.props,l=p.visible,a=p.title,t=p.prefixCls;return e().createElement(Le.ZP,{size:"small",visible:l,title:a,onCancel:this.handleBeforeCancel,onOk:this.handleBeforeCreate},e().createElement(De.Z,{className:"".concat(t),layout:"vertical"},this.renderItem(),e().createElement("div",{className:"".concat(t,"__children")},this.props.children)))}}we.defaultProps={prefixCls:"",id:"",visible:!1,title:"SetupBox",labelTxt:"",initialValue:"",onCancel:()=>{},onCreate:()=>{}};var xe=De.Z.create({name:"ClSetupBoxInModal"})(we),Ge=(0,_.Z)()(xe),ot=J=>e().createElement(Ge,J),ct=ot,U=r(37055),me=r(10237),ne=r(86726),Qe=r(67230),Se=r(70517),Me=r(38642),dt=r(36202),Fe=r(84874),Re=r(1164),Xe=r(10780),pt=r(76466),ut=r(60667),ht=r(40938),Oe={reNameClassify:U.ZP.LibraryList.reNameClassify,reNameResource:U.ZP.LibraryList.reNameResource,deleteClassify:U.ZP.LibraryList.deleteClassify,checkBeforeDeleteResource:U.ZP.LibraryList.checkBeforeDeleteResource,deleteResource:U.ZP.LibraryList.deleteResource,deleteLocalResource:U.ZP.localStorage.deleteResource,downloadResource:U.ZP.LibraryList.downloadResource,downloadUrl:U.ZP.LibraryList.downloadUrl},mt=J=>({userInfo:J.user,userId:J.user.id||window.localStorage.getItem("uid"),isAdmin:J.user.isAdmin,params:J.uploader.params,qyShield:J.user.qyShield});class qe extends e().Component{constructor(p){var l;super(p);l=this,this.onOpenReplace=(a,t)=>{a.isInteract?this.setState({interact:{visible:!0,reserve:!1,record:a,type:t}}):this.onShowReplaceConfirm(a,t)},this.onChangeInteract=a=>{this.setState({interact:(0,m.Z)((0,m.Z)({},this.state.interact),{},{reserve:a.target.checked})})},this.onCancleInteract=()=>{this.setState({interact:(0,m.Z)((0,m.Z)({},this.state.interact),{},{visible:!1})})},this.onShowReplaceConfirm=(a,t)=>{this.setState({currentRecord:a}),t==="ware"&&this.setState({visibleCourseware:!0})},this.statusMap=a=>{var t="/";if(a.type==="mp4")switch(a.aiUpgradeStatus){case"not":t=this.props.t("course.notUpdate");break;case"ai_processing":t=this.props.t("course.updating");break;case"ai_success":t=this.props.t("course.dealSuccess");break;case"ai_failed":t=this.props.t("course.updateFailed");break;case"finish":t=this.props.t("course.alreadyUpdate");break;default:t="/"}return t},this.handleDelete=a=>{var t=a.record,s=this.props.t,n=!t.type;I.Z.confirm({icon:e().createElement(G.Z,null),content:s("shareInfo.deleteTip"),cancelText:s("common.cancel"),okText:s("common.ok"),onOk:()=>{n?t.secondMenuFlag===1?b.default.warning(this.props.t("resourceLibrary.deleteFile")):this.withDeleteClassifyApi({record:t}):this.withCheckBeforeDeletResourceApi({record:t})}})},this.handleChange=a=>{this.setState(t=>({categoryId:t.categoryId===a.id?"":a.id}))},this.updateUseAI=()=>{b.default.warning(this.props.t("common.maintain"))},this.getPostTree=(0,C.Z)(E().mark(function a(){var t;return E().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,me.WY.get({url:U.ZP.LibraryList.listByLevel(),params:{level:2,is_layered:"true"}});case 2:t=n.sent,t&&l.setState({treeData:t.data});case 4:case"end":return n.stop()}},a)})),this.submit=a=>{var t={};return a&&(t.classify_id=this.state.categoryId),me.WY.post({url:U.ZP.LibraryList.submit(this.state.operate.id),data:(0,m.Z)({},t)})},this.AISubmit=(0,C.Z)(E().mark(function a(){var t;return E().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(l.state.categoryId){n.next=3;break}return b.default.error("".concat(l.props.t("validation.checkClassify"))),n.abrupt("return");case 3:return n.next=5,l.submit(!0);case 5:t=n.sent,t&&(l.modalConfirm(),l.setState({AIModalFlag:!1,categoryId:""}));case 7:case"end":return n.stop()}},a)})),this.handleCut=(0,C.Z)(E().mark(function a(){var t;return E().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,l.submit();case 2:t=n.sent,t&&l.setState({AIModalFlag:!1,failedModalFlag:!1,categoryId:""},()=>{Re.Z.targetTo({path:"/training/resourceManage/library/indicator?id=".concat(l.state.operate.id,"&courseType=single")}),l.props.onGetList()});case 4:case"end":return n.stop()}},a)})),this.modalConfirm=()=>{I.Z.confirm({title:this.props.t("common.tip"),content:this.props.t("indicatorMap.AIProgressing"),icon:e().createElement(G.Z,{style:{color:"#516AE6"}}),cancelButtonProps:{type:"primary"},cancelText:this.props.t("course.ManualCut"),okButtonProps:{type:"primary"},onCancel:()=>{this.handleCut()},okText:this.props.t("course.continueWait"),onOk:()=>{this.props.onGetList()}})},this.withDeleteClassifyApi=a=>{var t=a.record;me.qg.post({url:Oe.deleteClassify(),data:{id:t.id}}).then(s=>{var n=s.data,i=n.code,d=n.msg;b.default["".concat(i===0?"success":"warning")](d),i===0&&this.props.onTableRender()})},this.withCheckBeforeDeletResourceApi=a=>{var t=a.record;me.WY.get({url:Oe.checkBeforeDeleteResource(),params:{id:t.id}}).then(s=>{var n=s.data,i=n.code,d=n.msg;if(i===-2){this.handleReferenceList(t.id);return}i!==0?b.default.warning(d):this.withDeleteResourceApi({record:t})})},this.handleReferenceList=a=>{this.setState(t=>({referenceWithOtherConfig:(0,m.Z)((0,m.Z)({},t.referenceWithOtherConfig),{},{visible:!t.referenceWithOtherConfig.visible,resourceId:a||""})}))},this.withDeleteResourceApi=a=>{var t=a.record,s=this.props.activeTab;s.storageType==="PUBLIC_CLOUD"?this.deleteResource(t.id):this.deleteLocalResource(t.id)},this.deleteResource=a=>{me.qg.post({url:Oe.deleteResource(),data:{ids:a}}).then(t=>{var s=t.data,n=s.code,i=s.msg;b.default["".concat(n===0?"success":"warning")](i),n===0&&this.props.onTableRender()})},this.deleteLocalResource=a=>{var t=this.props.t;me.WY.delete({url:Oe.deleteLocalResource(),params:{resource_id:a}}).then(s=>{var n=s.data;n.code===0?(this.props.onTableRender(),b.default.success(t("localStorage.delResourceSuccess"))):b.default.error(n.message)})},this.handleRename=a=>{var t=a.record,s=!t.type;if(s){var n=t.id,i=t.label,d=this.props.t;this.setState({renameProps:{id:n,title:d("resourceLibrary.renameFolder"),initialValue:i,labelTxt:d("resourceLibrary.folderName"),visible:!0,isFolder:s}})}else{var o=t.id,c=t.title,f=this.props.t;this.setState({renameProps:{id:o,title:f("resourceLibrary.renameCourseware"),initialValue:c,labelTxt:f("resourceLibrary.coursewareName"),visible:!0,isFolder:s}})}},this.handleCancelRename=()=>{this.setState(a=>({renameProps:(0,m.Z)((0,m.Z)({},a.renameProps),{},{visible:!1})}))},this.handleOkRename=a=>{var t=this.state.renameProps.isFolder;t?this.withRenameClassifyApi(a):this.withRenameResourceApi(a)},this.handleEditH5=a=>{var t=a.record;Re.Z.targetTo({path:"/training/resourceManage/library/articleDetail?classifyId=".concat(t.resourceClassify,"&id=").concat(t.id)})},this.withRenameClassifyApi=a=>{me.qg.post({url:Oe.reNameClassify(),data:{name:a.value,id:a.id}}).then(t=>{var s=t.data,n=s.code,i=s.msg;b.default["".concat(n===0?"success":"warning")](i),this.handleCancelRename(),n===0&&this.props.onTableRender()})},this.withRenameResourceApi=a=>{me.qg.post({url:Oe.reNameResource(),data:{name:a.value,id:a.id,suffix:this.state.renameProps.initialValue}}).then(t=>{var s=t.data,n=s.code,i=s.msg;b.default["".concat(n===0?"success":"warning")](i),this.handleCancelRename(),n===0&&this.props.onTableRender()})},this.handleDownload=function(){var a=(0,C.Z)(E().mark(function t(s){var n,i,d,o,c,f,h,F,Z,ce,ie,ae,j;return E().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:if(n=s.record,i=l.props.t,d=n.url,o=n.path,c=n.type,f=n.storage_type,h=n.videoId,F=l.state.whiteList,Z="",n.status!==3){Y.next=42;break}if(c!=="mp4"){Y.next=27;break}if(f!=="ALIBABA_PRIVATE"){Y.next=14;break}return Y.next=10,(0,Qe.y5)(h);case 10:Z=Y.sent,Z?(Z.indexOf("http://")>-1&&(Z=Z.replace("http://","https://")),window.location.href=Z,(0,he.ew)(n.name)):b.default.info(i("personal.fileNoDown")),Y.next=25;break;case 14:return Y.next=16,(0,Qe.km)(n.id);case 16:if(ce=Y.sent,ie=ce.success,ae=ce.data,ie!=="true"){Y.next=23;break}Z=ae,Y.next=24;break;case 23:return Y.abrupt("return",b.default.info(i("personal.fileNoDown")));case 24:Z?F.lianxiangDownFlag?(j=document.createElement("a"),j.href="".concat(Z,"?type=downloadfile"),j.target="_blank",document.body.appendChild(j),setTimeout(()=>{j.click(),document.body.removeChild(j)},0)):d.toLowerCase().indexOf("resources.laihua.com")>-1?re().get(d,{responseType:"blob"}).then(Ce=>{var ye=URL.createObjectURL(Ce.data),ve=document.createElement("a");ve.setAttribute("href",ye),ve.setAttribute("download",n.name),ve.click(),URL.revokeObjectURL(ye),(0,he.ew)(n.name)}):(Z.indexOf("http://")>-1&&(Z=Z.replace("http://","https://")),window.location.href=Z,(0,he.ew)(n.name)):b.default.info(i("personal.fileNoDown"));case 25:Y.next=40;break;case 27:if(!(c==="scorm"||c==="html")){Y.next=32;break}window.location.href=o,(0,he.ew)(n.name),Y.next=40;break;case 32:if(f!=="ALIBABA_PRIVATE"){Y.next=38;break}return Y.next=35,(0,Qe.J7)(h);case 35:return Z=Y.sent,Z?(Z.indexOf("http://")>-1&&(Z=Z.replace("http://","https://")),window.location.href=Z,(0,he.ew)(n.name)):b.default.info(i("privateCloud.docNoDown")),Y.abrupt("return");case 38:window.location.href=d,(0,he.ew)(n.name);case 40:Y.next=43;break;case 42:b.default.info(i("course.transcodingTips"));case 43:case"end":return Y.stop()}},t)}));return function(t){return a.apply(this,arguments)}}(),this.handleShareReal=a=>{var t=a.record;b.default.destroy();var s=this.props.t;(0,le.lK)(t.id).then(n=>{var i=n.data;i.data&&i.data.app_id!==""?i.data.open_share==="TRUE"?(0,le.Ds)({source_knowledge_id:i.data.knowledge_id,knowledge_type:"ARTICLE"}).then(d=>{var o=d.data,c=o.code,f=o.data;c===2e5||c==="200000"?this.setState({shareUrl:"".concat(f.share_url,"&kid=").concat(t.id,"&eid=").concat(U.ZP.enterpriseId,"&aid=").concat(U.ZP.shareId),showShareWay:!0}):b.default.error(s("study.operateFailed"))}):b.default.warn(s("shareInfo.pleaseOpenShare")):b.default.warn(s("shareInfo.noShareTip"))}).catch(()=>{b.default.warn(s("shareInfo.noShareTip"))})},this.handleToClue=a=>{var t=a.record;b.default.destroy();var s=this.props.t;(0,le.lK)(t.id).then(n=>{var i=n.data;i.data&&i.data.app_id!==""?pe.m8.push("/market/market/boss_data/clue_statis?knowledgeId=".concat(i.data.knowledge_id)):b.default.warn(s("shareInfo.noShareTip"))}).catch(()=>{b.default.warn(s("shareInfo.noShareTip"))})},this.cancelTipOpenWay=a=>{var t=a.shareUrl;this.setState({h5ArticleShare:{showShareConfig:!1,id:""},shareUrl:t,showShareWay:!0})},this.cancelShareWay=()=>{this.setState({shareUrl:"",showShareWay:!1})},this.handleShare=a=>{var t=a.record;this.setState({h5ArticleShare:{showShareConfig:!0,id:t.id}})},this.handleQrCodePropsCancel=()=>{this.setState({h5ArticleShare:{showShareConfig:!1,id:""}})},this.getColumns=()=>{var a=this.props.activeTab,t=(0,ne.H3)("ai_upgrade",this.state.allowActions)&&this.props.userInfo.enterpriseVersion==="comprehensive"&&a.storageType==="PUBLIC_CLOUD",s=[...this.columns];return t&&s.splice(-1,0,{title:this.props.t("course.isAIUpdate"),dataIndex:"",key:"Update",width:130,render:(n,i)=>{var d=U.Ss.indexOf(i.contentType)>-1;return e().createElement("span",null,!d&&i.aiUpgradeStatus?this.statusMap(i):"/")}}),a&&a.storageType!=="PUBLIC_CLOUD"&&!a.status&&s.pop(),s},this.handlePreviewH5=a=>{var t=a.record,s=t.contentType,n=t.url,i=s==="h5/link";i?Re.Z.targetTo({path:n,isExternalLink:!0}):Re.Z.targetTo({path:"/training/resourceManage/library/articlePreview?id=".concat(t.id)})},this.getNetwork=(0,C.Z)(E().mark(function a(){var t,s,n,i,d,o,c,f=arguments;return E().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return t=f.length>0&&f[0]!==void 0?f[0]:"",s=f.length>1&&f[1]!==void 0?f[1]:"",n="",t.startsWith("http")?(i=t.split("//")[1].trim(),d=i.split("/")[0],n="https://".concat(d,"/cms/ticket")):(o=t.split("/")[0],n="https://".concat(o,"/cms/ticket")),F.prev=4,F.next=7,me.ZQ.get({url:n,params:{ticket:s}});case 7:if(c=F.sent,!(c.status===200||c.status===403)){F.next=10;break}return F.abrupt("return",!0);case 10:return F.abrupt("return",!1);case 13:return F.prev=13,F.t0=F.catch(4),F.abrupt("return",!1);case 16:case"end":return F.stop()}},a,null,[[4,13]])})),this.getTicket=function(){var a=(0,C.Z)(E().mark(function t(s){var n,i;return E().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,me.ZQ.get({url:U.ZP.local.getTicket(s)});case 2:if(n=o.sent,i=n.data,i.code!==0){o.next=6;break}return o.abrupt("return",i.data.ticket);case 6:return o.abrupt("return","");case 7:case"end":return o.stop()}},t)}));return function(t){return a.apply(this,arguments)}}(),this.dealWatchType=a=>{var t=U.Yq.findIndex(f=>a.type.toLowerCase().includes(f))>-1,s=U.WB.indexOf(a.type.toLowerCase())>-1,n=a.contentType.indexOf("html")>-1,i=a.contentType.indexOf("scorm")>-1,d=a.contentType.indexOf("video")>-1,o=U.Ss.indexOf(a.contentType)>-1,c="";return t?c="doc":d||o?c="video":s?c="image":n?c="html":i&&(c="scorm"),c},this.handlePreview=function(){var a=(0,C.Z)(E().mark(function t(s){var n,i,d,o,c,f,h,F,Z,ce,ie;return E().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(n=s.record,i=l.state.previewInfo,d=n.status===1||n.status===2,o=n.storage_type==="LOCAL"&&n.status===5,c=l.dealWatchType(n),!d){j.next=8;break}return b.default.warning(l.props.t("resourceLibrary.transcodingPlayerTip")),j.abrupt("return");case 8:if(!o){j.next=11;break}return b.default.warning(l.props.t("privateCloud.translateErrorView")),j.abrupt("return");case 11:if(f=U.Ss.indexOf(n.contentType)>-1,!(n.type==="mp4"&&n.aiUpgradeStatus==="finish")){j.next=15;break}return pe.m8.push({pathname:"/training/resourceManage/library/videoPreview",search:D.stringify({id:n.id})}),j.abrupt("return");case 15:if(c!=="scorm"){j.next=22;break}return h=n.url.split("//"),F=h[1].split("/"),Z=[h[0],F[0]].join("//"),ce="".concat(Z,"/unzip_file/coolcollege-scorm/prod/preview.html?scormUrl=").concat(encodeURIComponent(n.url)),Re.Z.targetTo({path:ce,isExternalLink:!0}),j.abrupt("return");case 22:ie={mode:"preview",watchType:c},c==="doc"?Object.assign(ie,{resourceInfo:{type:"",docType:n.type,aliUrl:n.path,url:n.url,docTitle:n.name,playId:n.videoId||n.video_id,storageType:n.storage_type}}):c==="image"?Object.assign(ie,{resourceInfo:{url:n.url,playId:n.videoId||n.video_id,storageType:n.storage_type}}):c==="html"?Object.assign(ie,{resourceInfo:{url:n.url}}):Object.assign(ie,{resourceInfo:{source:{FD:n.url,OD:n.path},originUrl:n.url,contentType:f?"mp3":n.type,playId:n.videoId||n.video_id,storageType:n.storage_type},autoPlay:!0,draggable:!0}),l.setState({resourcePlayInfo:ie,previewInfo:(0,m.Z)((0,m.Z)({},i),{},{title:n.name,visible:!0,onCancel:l.cancelPreview})});case 25:case"end":return j.stop()}},t)}));return function(t){return a.apply(this,arguments)}}(),this.handleTableChange=(a,t)=>{this.props.onTableChange({current:a,pageSize:t})},this.renderActions=a=>{var t=a.record,s=this.props,n=s.activeTab,i=s.qyShield,d=this.state,o=d.allowActions,c=d.showClue,f=d.showPromote,h=d.blackList,F=(0,ne.H3)("rename",o),Z=(0,ne.H3)("edit",o),ce=(0,ne.H3)("share",o),ie=(0,ne.H3)("download",o),ae=(0,ne.H3)("set_visible",o),j=(0,ne.H3)("replace",o),Ee=(0,ne.H3)("material_production",o),Y=(0,ne.H3)("ai_upgrade",o),Ce=U.Ss.indexOf(t.contentType)>-1,ye=!t.type,ve=t.type==="h5",Ue=t.parentId==="0"||t.resourceClassify==="0",Ke=U.Iq.indexOf(t.type)>-1,Ne=ae&&Ue,be=F&&!ve,$e=Z,He=ve,Ze=ie&&!ye&&!ve&&n.storageType!=="LOCAL",Ie=!ye&&ve&&f&&ce&&t.contentType==="h5/article"&&n.storageType!=="LOCAL",Ve=!ve&&!ye&&!Ke&&j,lt=!ve&&!ye&&!Ke&&Ee&&i==="false",it=Y&&this.props.userInfo.enterpriseVersion==="comprehensive"&&n.storageType==="PUBLIC_CLOUD"&&!Ce,xt=h.shareButFlag?[{type:"AIUpdate",visible:it},{type:"setVisible",visible:Ne},{type:"edit",visible:He},{type:"rename",visible:be},{type:"clue",visible:c&&Ie},{type:"share",visible:Ie},{type:"shareReal",visible:Ie},{type:"delete",visible:$e},{type:"download",visible:Ze},{type:"replace",visible:Ve},{type:"laiHua",visible:lt}]:[{type:"AIUpdate",visible:it},{type:"setVisible",visible:Ne},{type:"edit",visible:He},{type:"rename",visible:be},{type:"clue",visible:c&&Ie},{type:"delete",visible:$e},{type:"download",visible:Ze},{type:"replace",visible:Ve},{type:"laiHua",visible:lt}],Be=xt.filter(Pe=>Pe.visible),ze=[],We=[];if(Be.length>1)We=[Be[0]],ze=[...Be.slice(1)];else if(Be.length===1)We=[Be[0]];else return"/";return e().createElement("div",{className:"cl-table__cell-action"},We.some(Pe=>Pe.visible)?this.renderOperateBtn({buttons:We,record:t}):this.renderOperateBtn({buttons:ze,record:t}),We.some(Pe=>Pe.visible)&&ze.some(Pe=>Pe.visible)?e().createElement(e().Fragment,null,e().createElement("span",{className:"cl-pointer-divide"}),e().createElement(O.Z,{overlay:this.renderMoreButton({buttons:ze,record:t})},e().createElement("span",{className:"cl-pointer"},this.props.t("common.more")," ",e().createElement(se.Z,null)))):null)},this.renderLaiHuaTooltip=a=>e().createElement("div",{style:{minWidth:"234px"}},e().createElement("p",null,a("resourceLibrary.laiHuaTip1")),e().createElement("div",null,a("resourceLibrary.laiHuaTip2")),e().createElement("ul",null,e().createElement("li",null,a("resourceLibrary.laiHuaTip3")),e().createElement("li",null,a("resourceLibrary.laiHuaTip4")),e().createElement("li",null,a("resourceLibrary.laiHuaTip5")),e().createElement("li",null,a("resourceLibrary.laiHuaTip7"))),e().createElement("div",null,a("resourceLibrary.laiHuaTip8")),e().createElement("p",null,a("resourceLibrary.laiHuaTip9"))),this.renderLaiHuaReplaceTip=a=>e().createElement("div",{style:{minWidth:"234px"}},a("resourceLibrary.replaceTip")),this.renderOperateBtn=a=>{var t=a.buttons,s=a.record,n=this.props,i=n.t,d=n.activeTab,o=this.state.blackList,c=s.replaced===1,f=d.id!=="0"||c||this.acceptFileUploadLaiHua(s.type,s.size,s.duration);return t.map(h=>{switch(h.type){case"setVisible":return h.visible?e().createElement(e().Fragment,{key:h.type},e().createElement("span",{className:"cl-pointer",onClick:()=>this.props.onSetVisibleRange(s)},i("courseManage.setTheVisibility"))):null;case"rename":return h.visible?e().createElement(e().Fragment,{key:h.type},e().createElement("span",{className:"cl-pointer",onClick:()=>this.handleRename({record:s})},i("resourceLibrary.rename"))):null;case"delete":return h.visible?e().createElement(e().Fragment,{key:h.type},e().createElement("span",{className:"cl-pointer",onClick:()=>this.handleDelete({record:s})},i("common.delete"))):null;case"edit":return h.visible?e().createElement(e().Fragment,{key:h.type},e().createElement("span",{className:"cl-pointer",onClick:()=>this.handleEditH5({record:s})},i("common.edit"))):null;case"download":return h.visible?e().createElement(e().Fragment,{key:h.type},e().createElement("span",{className:"cl-pointer",onClick:()=>this.handleDownload({record:s})},i("resourceLibrary.download"))):null;case"share":return h.visible?e().createElement(e().Fragment,{key:h.type},e().createElement("span",{className:"cl-pointer",onClick:()=>this.handleShare({record:s})},i("shareInfo.singleShare"))):null;case"shareReal":return h.visible?e().createElement(e().Fragment,{key:h.type},e().createElement("span",{className:"cl-pointer",onClick:()=>this.handleShareReal({record:s})},i("shareInfo.shareReal"))):null;case"clue":return h.visible?e().createElement(e().Fragment,{key:h.type},e().createElement("span",{className:"cl-pointer",onClick:()=>this.handleToClue({record:s})},i("shareInfo.clueData"))):null;case"replace":return h.visible&&e().createElement(O.Z,{overlay:e().createElement(y.Z,null,e().createElement(y.Z.Item,{key:"".concat(h.type,"_local"),onClick:()=>!c&&this.onOpenReplace(s,"local")},e().createElement("span",{className:c?"cl-pointer cl-disabled":"cl-default-pointer cl-hover cl-change-file"},i("resourceLibrary.upload"),!c&&!s.isInteract&&this.renderReplaceInputFile(s))),e().createElement(y.Z.Item,{key:"".concat(h.type,"_ware"),onClick:()=>!c&&this.onOpenReplace(s,"ware")},e().createElement("span",{className:c?"cl-pointer cl-disabled":"cl-default-pointer cl-hover"},i("resourceLibrary.uploadCourseware")))),key:h.type},e().createElement(H.Z,{title:this.renderLaiHuaReplaceTip(i),placement:"topRight"},e().createElement("span",{className:c?"cl-pointer cl-disabled":"cl-pointer"},i("common.replace")," ",e().createElement(se.Z,null))));case"laiHua":return h.visible&&e().createElement(H.Z,{title:this.renderLaiHuaTooltip(i),placement:"topRight",key:h.type},e().createElement("span",{className:"cl-pointer ".concat(f?"cl-disabled":""),onClick:()=>!f&&this.handleFileUploadToLaiHua(s,i)},i("resourceLibrary.uploadToLaiHua")));case"AIUpdate":return h.visible?e().createElement(e().Fragment,{key:h.type},o.courseAiUpdate&&s.type==="mp4"?e().createElement("span",{className:"cl-pointer",onClick:()=>this.updateUseAI()},this.props.t("course.AIUpdate")):e().createElement("span",{className:"cl-pointer cl-disabled"},this.props.t("course.AIUpdate"))):null;default:return null}})},this.renderMoreButton=a=>{var t=a.buttons,s=a.record,n=this.props,i=n.t,d=n.activeTab,o=this.state.blackList,c=s.replaced===1,f=d.id!=="0"||c||this.acceptFileUploadLaiHua(s.type,s.size,s.duration);return e().createElement(y.Z,null,t.map(h=>{switch(h.type){case"setVisible":return h.visible?e().createElement(y.Z.Item,{key:h.type,onClick:()=>this.props.onSetVisibleRange(s)},e().createElement("span",{className:"cl-default-pointer cl-hover"},i("courseManage.setTheVisibility"))):null;case"rename":return h.visible?e().createElement(y.Z.Item,{key:h.type,onClick:()=>this.handleRename({record:s})},e().createElement("span",{className:"cl-default-pointer cl-hover"},i("resourceLibrary.rename"))):null;case"delete":return h.visible?e().createElement(y.Z.Item,{key:h.type,onClick:()=>this.handleDelete({record:s})},e().createElement("span",{className:"cl-default-pointer cl-hover"},i("common.delete"))):null;case"edit":return h.visible?e().createElement(y.Z.Item,{key:h.type,onClick:()=>this.handleEditH5({record:s})},e().createElement("span",{className:"cl-default-pointer cl-hover"},i("common.edit"))):null;case"download":return h.visible?e().createElement(y.Z.Item,{key:h.type,onClick:()=>this.handleDownload({record:s})},e().createElement("span",{className:"cl-default-pointer cl-hover"},i("resourceLibrary.download"))):null;case"share":return h.visible?e().createElement(y.Z.Item,{key:h.type,onClick:()=>this.handleShare({record:s})},e().createElement("span",{className:"cl-default-pointer cl-hover"},i("shareInfo.singleShare"))):null;case"shareReal":return h.visible?e().createElement(y.Z.Item,{key:h.type,onClick:()=>this.handleShareReal({record:s})},e().createElement("span",{className:"cl-default-pointer cl-hover"},i("shareInfo.shareReal"))):null;case"clue":return h.visible?e().createElement(y.Z.Item,{key:h.type,onClick:()=>this.handleToClue({record:s})},e().createElement("span",{className:"cl-default-pointer cl-hover"},i("shareInfo.clueData"))):null;case"replace":return h.visible&&e().createElement(y.Z.SubMenu,{key:h.type,title:e().createElement(H.Z,{title:this.renderLaiHuaReplaceTip(i),placement:"topRight"},e().createElement("span",{className:c?"cl-pointer cl-disabled":"cl-default-pointer cl-hover"},i("common.replace")))},e().createElement(y.Z.Item,{key:"".concat(h.type,"_local"),onClick:()=>this.onOpenReplace(s,"local")},e().createElement("span",{className:c?"cl-pointer cl-disabled":"cl-default-pointer cl-hover cl-change-file"},i("resourceLibrary.upload"),!c&&!s.isInteract&&this.renderReplaceInputFile(s))),e().createElement(y.Z.Item,{key:"".concat(h.type,"_ware"),onClick:()=>!c&&this.onOpenReplace(s,"ware")},e().createElement("span",{className:c?"cl-pointer cl-disabled":"cl-default-pointer cl-hover"},i("resourceLibrary.uploadCourseware"))));case"laiHua":return h.visible&&e().createElement(y.Z.Item,{key:h.type,onClick:()=>!f&&this.handleFileUploadToLaiHua(s,i)},e().createElement(H.Z,{title:this.renderLaiHuaTooltip(i),placement:"topRight"},e().createElement("span",{className:f?"cl-pointer cl-disabled":"cl-default-pointer cl-hover"},i("resourceLibrary.uploadToLaiHua"))));case"AIUpdate":return h.visible?e().createElement(y.Z.Item,{key:h.type,onClick:()=>this.updateUseAI()},e().createElement("span",{className:"cl-pointer-divide"}),o.courseAiUpdate&&e().createElement("span",{className:"cl-default-pointer cl-hover"},this.props.t("course.AIUpdate"))):null;default:return null}}))},this.acceptFileUploadLaiHua=(a,t,s)=>!(a&&(U.pD.indexOf(a.toLowerCase())>-1&&t<U.Ef||U.Sc.indexOf(a.toLowerCase())>-1&&t<U.Ej||U.GZ.indexOf(a.toLowerCase())>-1&&t<U.nN&&Number(s)<=U.Qj)),this.getAccept=a=>{var t=U.iH.indexOf(a.type.toLowerCase())>-1,s=U.WB.indexOf(a.type.toLowerCase())>-1,n=U.Yq.findIndex(f=>a.type.toLowerCase().includes(f))>-1,i=a.contentType==="html",d=a.contentType==="scorm",o=U.Iq.indexOf(a.type.toLowerCase())>-1,c="";return t&&U.iH.forEach(f=>{c+=".".concat(f,",")}),s&&U.WB.forEach(f=>{c+=".".concat(f,",")}),n&&U.Yq.forEach(f=>{c+=".".concat(f,",")}),i&&U.SR.forEach(f=>{c+=".".concat(f,",")}),d&&U.SR.forEach(f=>{c+=".".concat(f,",")}),o&&U.Iq.forEach(f=>{c+=".".concat(f,",")}),c},this.columns=[{title:this.props.t("resourceLibrary.fileName"),dataIndex:"name",key:"name",width:400,render:(a,t)=>{var s=this.props,n=s.prefixCls,i=s.onDeepIn,d=localStorage.getItem("themeColor")||"#516ae6",o=U.Iq.indexOf(t.type)>-1;if(o)return e().createElement("span",{className:"".concat(n,"__columnname")},e().createElement(Fe.Z,{iconClass:U.e1[t.type],size:"16px"}),e().createElement("span",{className:"cl-name-pointer",style:{color:d}},a));var c=!t.type;if(c)return e().createElement("span",{className:"".concat(n,"__columnname"),onClick:()=>i({record:t})},e().createElement(w.Z,{style:{color:"rgb(255, 168, 24)",fontSize:"18px"}}),e().createElement("span",{className:"cl-default-pointer cl-hover"},a));var f=t.type==="h5";if(f)return e().createElement("span",{className:"".concat(n,"__columnname"),onClick:()=>this.handlePreviewH5({record:t})},e().createElement(Fe.Z,{iconClass:U.e1[t.type],size:"16px"}),e().createElement("span",{className:"cl-default-pointer cl-hover"},a));var h=t.replaced===1,F=t.status===1||t.status===2,Z=t.storage_type==="LOCAL"&&t.status===5,ce=t.status===4,ie=t.contentType.includes("audio");return e().createElement("span",{className:"".concat(n,"__columnname"),onClick:()=>this.handlePreview({record:t})},e().createElement(Fe.Z,{iconClass:U.e1[ie?"mp3":t.type],size:"16px"}),e().createElement("span",{className:"cl-name-pointer",style:{color:d}},a),h?e().createElement($.Z,{color:"gold"},this.props.t("resourceLibrary.replacing")):null,ce?e().createElement($.Z,{color:"red"},this.props.t("resourceLibrary.contentViolation")):null,F?e().createElement($.Z,{color:"gold"},this.props.t("common.transcoding")):null,Z?e().createElement($.Z,{color:"red"},this.props.t("privateCloud.translateError")):null)}},{title:this.props.t("resourceLibrary.fileSize"),dataIndex:"size",key:"size",width:100,render:a=>a?(0,ge.sS)(a):"/"},{title:this.props.t("common.visibleRange"),dataIndex:"visibleRange",key:"visibleRange",width:this.props.lng==="en_us"?120:100,render:a=>a==="all"?this.props.t("common.allCompany"):this.props.t("setting.partlyVisible")},{title:this.props.t("common.createTime"),dataIndex:"createTime",key:"createTime",width:164,render:a=>"".concat((0,ge.p6)(a))},{title:this.props.t("common.creator"),dataIndex:"createUserName",key:"createUserName",width:106,render:(a,t)=>e().createElement(ut.Z,{dataType:"userName",value:t.creator_sync_user_id,name:t.createUserName||t.creatorName||"/",type:t.creator_source_type})},{title:this.props.t("common.operate"),width:180,key:"operate",fixed:"right",render:a=>this.renderActions({record:a})}],this.renderReplaceInputFile=a=>e().createElement("input",{multiple:!1,type:"file",accept:this.getAccept(a),onChange:this.handleChooseFiles}),this.handleChooseFiles=function(){var a=(0,C.Z)(E().mark(function t(s){var n,i,d,o,c,f,h,F,Z,ce;return E().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:if(l.onCancleInteract(),n=l.state,i=n.currentRecord,d=n.interact,o=l.props.activeTab,c=o.id,f=o.host,h=o.name,F=o.storageType,Z=[...s.target.files],ce={html:"html",scorm:"scorm"}[i.contentType]||"other",F==="LOCAL"){ae.next=12;break}return ae.next=9,l.props.dispatch({type:"uploader/initUploader",payload:{dispatch:l.props.dispatch,storageType:{type:F,id:c}}});case 9:l.props.dispatch({type:"uploader/chooseFiles",payload:{dispatch:l.props.dispatch,choosedFiles:Z,oldResourceId:i.id,isDeleteInteract:"".concat(!d.reserve),discriminate:ce}}),ae.next=15;break;case 12:return ae.next=14,l.props.dispatch({type:"localUploader/initUploader",payload:{localStorageInfo:{uploadAddress:"https://".concat(f,"/cms/upload"),privatization:c,storageName:h},params:{classifyId:i.resourceClassify},isOpenWrapper:!1}});case 14:l.props.dispatch({type:"localUploader/chooseFiles",payload:{dispatch:l.props.dispatch,choosedFiles:Z,oldResourceId:i.id}});case 15:case"end":return ae.stop()}},t)}));return function(t){return a.apply(this,arguments)}}(),this.handleFileUploadToLaiHua=function(){var a=(0,C.Z)(E().mark(function t(s,n){var i,d;return E().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,le.SI)({resourceId:s.id});case 2:i=c.sent,d=i.success,d==="true"&&b.default.success({content:e().createElement("div",{style:{display:"inline"}},n("resourceLibrary.uploadToLaiHuaTip"),e().createElement("a",{onClick:()=>(0,Se.Yv)(5)},n("resourceLibrary.h5LinkPlayButton")))});case 5:case"end":return c.stop()}},t)}));return function(t,s){return a.apply(this,arguments)}}(),this.AIModalCancel=()=>{this.setState({failedModalFlag:!1,categoryId:""},()=>{this.props.onGetList()})},this.repeatCut=()=>{this.setState({AIModalFlag:!0,categoryId:"",failedModalFlag:!1})},this.handleCoursewareSelectorOk=function(){var a=(0,C.Z)(E().mark(function t(s){var n,i,d;return E().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return n=l.state,i=n.currentRecord,d=n.interact,c.next=3,(0,le.PC)({is_delete_interact:"".concat(!d.reserve)},{oldResourceId:i.id,resourceId:s[0].id});case 3:l.props.onTableRender(),l.setState({visibleCourseware:!1}),l.onCancleInteract();case 6:case"end":return c.stop()}},t)}));return function(t){return a.apply(this,arguments)}}(),this.handleCoursewareSelectorCancel=()=>{this.setState({visibleCourseware:!1,currentRecord:{}})},this.cancelPreview=()=>{var a=this.state.previewInfo;this.setState({resourcePlayInfo:{mode:"preview",watchType:"",resourceInfo:{}},previewInfo:(0,m.Z)((0,m.Z)({},a),{},{visible:!1})})},this.state={allowActions:(0,ne.V9)("library",this.props.userInfo.modules),showClue:(0,ne.e)("clue_statis",this.props.userInfo.modules),showPromote:(0,ne.e)("market",this.props.userInfo.modules),renameProps:{id:"",title:"",initialValue:"",labelTxt:"",visible:!1,isFolder:!0},h5ArticleShare:{showShareConfig:!1,id:""},referenceWithOtherConfig:{visible:!1,type:"resource",operation:"delete",resourceId:"",onCancel:this.handleReferenceList,onOk:this.handleReferenceList},interact:{visible:!1,reserve:!1,record:{},type:""},currentRecord:{},operate:"",AIModalFlag:!1,failedModalFlag:!1,categoryId:"",treeData:[],showShareWay:!1,shareUrl:"",blackList:{courseAiUpdate:(0,Me.eY)("LISTCONTENT_COURSE_AIUPDATE"),shareButFlag:(0,Me.eY)("SHARE_AND_SHAREREAL_BTN")},whiteList:{lianxiangDownFlag:(0,Me.UI)("HANDLE_DOWNLOAD_FUN"),courseAiUpdate:(0,Me.eY)("LISTCONTENT_COURSE_AIUPDATE")},resourcePlayInfo:{mode:"preview",watchType:"",resourceInfo:{},autoPlay:!0,draggable:!0},previewInfo:{visible:!1,destroyOnClose:!0,title:this.props.t("resourceLibrary.previewCourseware"),onCancel:()=>{}},visibleCourseware:!1},this.fileInputEle=e().createRef()}componentDidMount(){this.getPostTree()}render(){var p=this.props,l=p.t,a=p.prefixCls,t=p.list,s=t===void 0?[]:t,n=p.loading,i=p.selectedRowKeys,d=p.onSelectChange,o=p.paginationParams,c=o===void 0?{}:o,f=p.toolBarRender,h=p.headerTitle,F=p.activeTab,Z=this.state,ce=Z.showShareWay,ie=Z.shareUrl,ae=Z.renameProps,j=Z.referenceWithOtherConfig,Ee=Z.AIModalFlag,Y=Z.failedModalFlag,Ce=Z.operate,ye=Z.h5ArticleShare,ve=Z.previewInfo,Ue=Z.resourcePlayInfo,Ke=Z.visibleCourseware,Ne=Z.currentRecord,be=Z.interact,$e={selectedRowKeys:i,onChange:d},He=(0,m.Z)((0,m.Z)({},U.XE.INITIAL_PAGINATION),c);return e().createElement("section",{className:a},e().createElement("div",{className:"library-content-list"},e().createElement(dt.f,{loading:n,columns:this.getColumns(),rowKey:"id",dataSource:s,pagination:!1,rowSelection:$e,toolBarRender:f,headerTitle:h,tableUUID:"d61d3082-8f7f-4d65-a6a7-1a77b10b1c55"})),e().createElement("div",{className:"library-pagination-wrapper"},e().createElement(z.Z,(0,N.Z)({},He,{onChange:this.handleTableChange,className:"library-pagination"}))),e().createElement(ct,(0,N.Z)({},ae,{onCancel:this.handleCancelRename,onCreate:this.handleOkRename})),e().createElement(Le.ZP,{size:"small",visible:be.visible,width:500,className:"interact-replace-modal",title:"".concat(this.props.t("common.replace")),onCancel:this.onCancleInteract,footer:null},e().createElement("p",null,this.props.t("course.replaceContent")),e().createElement(de.Z,{checked:be.reserve,onChange:this.onChangeInteract},this.props.t("course.replaceContentCheck")),e().createElement("div",{className:"interact-replace-btn"},e().createElement(L.Z,{onClick:()=>this.onCancleInteract()},this.props.t("common.cancel")),e().createElement(L.Z,{type:"primary",onClick:()=>this.onShowReplaceConfirm(be.record,be.type)},this.props.t("common.ok"),be.type==="local"&&this.renderReplaceInputFile(be.record)))),e().createElement(pt.Z,(0,N.Z)({},Ue,{previewInfo:ve})),e().createElement(_e.Z,(0,N.Z)({},ye,{cancelTipOpenWay:this.cancelTipOpenWay,onCancelShare:this.handleQrCodePropsCancel})),e().createElement(oe.Z,{showShareWay:ce,shareUrl:ie,closeShareWay:this.cancelShareWay}),e().createElement(Te.Z,(0,N.Z)({},j,{handleReferenceList:this.handleReferenceList})),e().createElement(Le.ZP,{title:"".concat(this.props.t("course.chooseAICategory")),visible:Ee,onCancel:()=>this.setState({AIModalFlag:!1,categoryId:""}),className:"AIModal",width:900,footer:null},Ee&&e().createElement("div",{className:"AI-course-modal-box"},e().createElement("p",null,this.props.t("course.AIValue")),e().createElement("p",null,this.props.t("course.AITip")),e().createElement("div",{className:"AICategory-main"},e().createElement("div",{className:"AI-course-list"},this.state.treeData.map(Ze=>Ze.children.length?e().createElement("ul",{className:"AI-cate-tags"},e().createElement("li",null,e().createElement("span",null,Ze.name,"\uFF1A"),e().createElement("ul",{className:"tabs"},Ze.children.map((Ie,Ve)=>e().createElement("li",{key:Ve.toString(),onClick:()=>this.handleChange(Ie),className:this.state.categoryId===Ie.id?"active":""},Ie.name))))):null))),e().createElement("div",null,e().createElement("div",{className:"cl-form-fixed-footer__container"},e().createElement(L.Z,{className:"form-page-container-bottom-btn",onClick:()=>this.setState({AIModalFlag:!1,categoryId:""})},this.props.t("common.cancel")),e().createElement(L.Z,{type:"primary",onClick:()=>this.AISubmit(!0)},this.props.t("course.AICut")),e().createElement(L.Z,{type:"primary",onClick:()=>this.handleCut()},this.props.t("course.ManualCut")))))),e().createElement(Le.ZP,{title:"".concat(this.props.t("course.chooseAICategory")),visible:Y,onCancel:()=>{this.AIModalCancel()},className:"AIModal",width:500,footer:null},Y&&e().createElement("div",{className:"AI-course-modal-box"},this.props.t("course.failedReason"),"\uFF1A",Ce.failed_reason_map,e().createElement("div",{className:"cl-form-fixed-footer__container"},e().createElement(L.Z,{className:"form-page-container-bottom-btn",onClick:()=>{this.AIModalCancel()}},this.props.t("common.cancel")),e().createElement(L.Z,{type:"primary",disabled:Ce.failed_reason!=="INTERNAL_ERROR"&&Ce.failed_reason!=="OTHER_ERR",onClick:()=>{this.repeatCut()}},this.props.t("course.repeatAICut")),e().createElement(L.Z,{type:"primary",onClick:()=>{this.handleCut()}},this.props.t("course.ManualCut"))))),e().createElement(ht.Z,{params:{classifyId:0,bizType:0}}),e().createElement(Xe.Z,{visible:Ke,title:l("resourceLibrary.choosesTheResource"),defaultChecked:[Ne],allChecked:[Ne],replaceStatus:!0,onOk:this.handleCoursewareSelectorOk,onCancel:this.handleCoursewareSelectorCancel,excludeType:"h5",onlyShowStorageTabKey:F.id==="0"?"public":F.id}))}}qe.defaultProps={prefixCls:"library-page-list__content__table"};var vt=(0,g.$j)(mt)((0,_.Z)()(qe)),Ft=r(88983),et=r(47933),ft=r(48479),yt=J=>({userInfo:J.user,uploaderList:J.uploader.list,uploadSucceedItem:J.uploader.uploadSucceedItem,tabKey:J.resourceLibrary.tabStatus.tabKey});class tt extends e().Component{constructor(){super(...arguments);this.state={radioStatus:""},this.radioList=[{value:"",label:"".concat(this.props.t("common.all"))},{value:"true",label:"".concat(this.props.t("course.alreadyUpdate"))},{value:"false",label:"".concat(this.props.t("course.notUpdate"))}],this.handleRadiosChange=p=>{this.setState({radioStatus:p.target.value},()=>{this.props.searchList(this.state.radioStatus)})},this.renderTitle=()=>{var p=this.props,l=p.prefixCls,a=p.activeTab,t="".concat(l,"__title"),s=this.props.userInfo.enterpriseVersion=="comprehensive"&&a.id==="0";return e().createElement("div",{className:t},s?e().createElement(et.ZP.Group,{onChange:this.handleRadiosChange,value:this.state.radioStatus},this.radioList.map(n=>e().createElement(et.ZP.Button,{key:n.value,value:n.value},n.label))):"")},this.renderActionBtns=()=>{var p=this.props,l=p.prefixCls,a=p.t,t="".concat(l,"__btncontainer");return e().createElement(e().Fragment,null,e().createElement("div",{className:t},e().createElement("section",null,this.renderTitle(),e().createElement(ft.Z,{onSearch:this.props.onSearch,placeholder:a("searchInputPlaceholder.byNameOrCreator"),width:"272px"}))))}}render(){var p=this.props.prefixCls;return e().createElement(e().Fragment,null,e().createElement("section",{className:p},this.renderActionBtns()))}}tt.defaultProps={prefixCls:"library-page-list__header"};var gt=(0,g.$j)(yt)((0,_.Z)()(tt)),Et=r(93485),Ct=r(49101),bt=r(63258),It=r(8212),Tt=r(17780),_t=r(79096);class at extends e().Component{constructor(){super(...arguments);this.state={selectedNode:{eventKey:0,title:"",dataRef:{}}},this.handleChangeClassify=p=>{var l=p.eventKey,a=p.title,t=p.dataRef;this.setState({selectedNode:{eventKey:l,title:a,dataRef:t}})},this.handleCancel=()=>{this.setState({selectedNode:{eventKey:0,title:"",dataRef:{}}},()=>{this.props.onCancel()})},this.handleOk=()=>{var p=this.state.selectedNode;this.props.onOk({selectedNode:(0,m.Z)({},p)})},this.createTree=p=>{this.tree=p}}componentDidUpdate(p){p.visible!==this.props.visible&&this.props.visible&&this.tree.getTree()}render(){var p=this.props,l=p.prefixCls,a=p.visible,t=p.t,s=p.privatization;return e().createElement(Le.ZP,{visible:a,size:"large",title:t("exam.move"),onCancel:this.handleCancel,onOk:this.handleOk},e().createElement("div",{className:l},a?e().createElement(Xe.Z.CoursewareTree,{ref:this.createTree,noHeader:!0,privatization:s,showTotal:!1,onChangeClassify:this.handleChangeClassify}):null))}}at.defaultProps={prefixCls:"library-page-list__modalCoursewareTree"};var Lt=(0,_.Z)()(at),Pt=r(74262),St=r(54650),Rt=r(51697),rt={addFolder:U.ZP.LibraryList.addFolder,move:U.ZP.LibraryList.move},Ot=J=>({userInfo:J.user,uploadsuccessArray:J.uploader.successItemArray,qyShield:J.user.qyShield});class st extends e().Component{constructor(){var p;super(...arguments);p=this,this.state={addFolderProps:{id:"",title:this.props.t("resourceLibrary.newFolder"),initialParams:{title:"",employeeRange:{rangeType:3,rangeList:{dept:[],post:[],group:[],user:[]}}},labelTxt:this.props.t("resourceLibrary.folderName"),visible:!1,canSetVisible:!1,parentId:this.props.classifyId},coursewareTreeProps:{visible:!1},articlePopOverProps:[{typeText:this.props.t("resourceLibrary.newArticle"),contentText:this.props.t("newUserGuidance.addArticleIntro"),buttonText:this.props.t("common.nextStep")},{typeText:this.props.t("component.localUpload"),contentText:this.props.t("newUserGuidance.localUploadIntro"),buttonText:this.props.t("lecturerPage.know")}],uploadShow:{visible:!1,title:this.props.t("common.storage"),onSuccess:()=>this.handleUploadFileSuccess(),onCancel:()=>this.handleUploadClose()},visibleMemberModal:!1},this.handleUploadFileSuccess=()=>{var l=this.state.uploadShow;Object.assign(l,{visible:!1}),this.setState({uploadShow:l},()=>{this.props.onTableRender()})},this.handleUploadClose=()=>{var l=this.state.uploadShow;Object.assign(l,{visible:!1}),this.setState({uploadShow:l})},this.handleMove=()=>{var l=this.props.selectedRowKeys;!l.length||this.setState({coursewareTreeProps:{visible:!0}})},this.handleCancelCoursewareTree=()=>{this.setState({coursewareTreeProps:{visible:!1}})},this.handleOkCoursewareTree=l=>{var a=l.selectedNode,t=a.eventKey,s=a.dataRef,n=this.props,i=n.selectedRowKeys,d=n.t,o=s.parentIds;if(t!=0){if(o&&o instanceof Array){var c=!0,f=(0,Et.Z)(o),h;try{for(f.s();!(h=f.n()).done;){var F=h.value;if(i.indexOf(F)>-1){c=!1,b.default.warning(d("resourceLibrary.moveFileTip"));break}}}catch(Z){f.e(Z)}finally{f.f()}c&&this.withMoveResourceApi({selectedNode:a})}}else this.withMoveResourceApi({selectedNode:a})},this.withMoveResourceApi=l=>{var a=l.selectedNode,t=this.props,s=t.selectedRows,n=t.t,i=a.eventKey,d=s.map(o=>({id:o.id,type:o.type?"resource":"resource_folder"}));me.WY.post({url:rt.move(),data:{classify_id:i,resource_ids:d}}).then(()=>{b.default.success(n("resourceLibrary.batchMoveSuccess")),this.setState({coursewareTreeProps:{visible:!1}},()=>{this.props.onTableRender()})})},this.handleAddArticle=()=>{Re.Z.targetTo({path:"/training/resourceManage/library/articleDetail?classifyId=".concat(this.props.classifyId)})},this.handleUpload=()=>{var l=this.props,a=l.activeTab,t=l.classifyId;if(a&&a.id!=="0"){var s=a.host,n=a.id,i=a.name,d={uploadAddress:"https://".concat(s,"/cms/upload"),privatization:n,storageName:i};this.props.dispatch({type:"localUploader/initUploader",payload:{localStorageInfo:d,params:{classifyId:t,bizType:0,resourceId:""}}})}},this.handleChooseFiles=(0,C.Z)(E().mark(function l(){var a,t,s;return E().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a=p.props.t,i.next=3,(0,ge.x8)("quota_source_book",a("course.sourceValidateLimit",{courseType:a("documentTitle.matter")}));case 3:if(t=i.sent,!t){i.next=6;break}return i.abrupt("return");case 6:s=p.state.uploadShow,Object.assign(s,{visible:!0}),p.setState({uploadShow:s});case 9:case"end":return i.stop()}},l)})),this.handleCreateCourse=function(){var l=(0,C.Z)(E().mark(function a(t){var s,n;return E().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(localStorage.getItem("openedMemberModal")!=="true"){d.next=4;break}(0,Se.Yv)(t),d.next=9;break;case 4:return d.next=6,(0,Se.v8)();case 6:s=d.sent,n=s.data,n?((0,Se.$v)(),(0,Se.Yv)(t)):p.setState({visibleMemberModal:!0,routeType:t});case 9:case"end":return d.stop()}},a)}));return function(a){return l.apply(this,arguments)}}(),this.handleCloseMemberModal=l=>{l==="noNeed"&&(0,Se.Yv)(this.state.routeType),this.setState({visibleMemberModal:!1})},this.handleAddFolder=()=>{var l=this.props.isRootDirectory,a=(0,ne.V9)("library",this.props.userInfo.modules),t=(0,ne.H3)("set_visible",a);this.setState(s=>({addFolderProps:(0,m.Z)((0,m.Z)({},s.addFolderProps),{},{initialParams:{title:"",employeeRange:{rangeType:3,rangeList:{dept:[],post:[],group:[],user:[]}}},canSetVisible:l&&t,visible:!0})}))},this.handleCancelAddFolder=()=>{this.setState(l=>({addFolderProps:(0,m.Z)((0,m.Z)({},l.addFolderProps),{},{canSetVisible:!1,visible:!1})}))},this.handleOkAddFolder=function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=p.props.activeTab;a.id!=="0"&&(l.privatization=a.id),me.qg.post({url:rt.addFolder(),data:(0,m.Z)((0,m.Z)({},l),{},{parentId:p.props.classifyId})}).then(t=>{var s=t.data,n=s.code,i=s.msg;b.default["".concat(n===0?"success":"warning")](i),n===0&&p.props.onTableRender(),p.handleCancelAddFolder()})},this.menuClick=l=>{l==="0"?this.props.onSetVisibleRange():l==="1"&&this.handleMove()},this.renderActionBtns=()=>{var l=this.props,a=l.prefixCls,t=l.selectedRowKeys,s=l.t,n=l.isRootDirectory,i=l.renderGuide,d=l.activeTab,o=l.qyShield,c=this.state.articlePopOverProps,f=(0,ne.V9)("library",this.props.userInfo.modules),h=(0,ne.H3)("move",f),F=(0,ne.H3)("upload",f),Z=(0,ne.H3)("material_production",f),ce=(0,ne.H3)("add_folder",f),ie=(0,ne.H3)("add_articles",f),ae=(0,ne.H3)("set_visible",f),j=d&&d.id!=="0"&&!d.status,Ee=d.id!=="0",Y="".concat(a,"__btncontainer"),Ce=e().createElement(y.Z,{onClick:ve=>{var Ue=ve.key;this.menuClick(Ue)}},ae&&n&&e().createElement(y.Z.Item,{key:"0",disabled:!t.length},s("courseManage.setTheVisibility")),h?e().createElement(y.Z.Item,{key:"1",disabled:!t.length},s("resourceLibrary.batchMove")):null),ye=()=>e().createElement("div",{className:"cl-uploader__tooltips__text"},e().createElement("p",{className:"title"},s("resourceLibrary.uploadFolder")));return e().createElement(e().Fragment,null,e().createElement("div",{className:Y},e().createElement("section",null,ce||ie?e().createElement(Rt.Z,{visible:i&&this.props.activeIndex===0,title:c[0].contentText,placement:"topLeft"},e().createElement(L.Z,{type:"primary",className:"dropdown-btn-left",onClick:this.handleAddFolder,disabled:j},e().createElement(Ct.Z,null),s("resourceLibrary.newFolder"),e().createElement(H.Z,{overlayClassName:"cl-uploader__tooltips",placement:"bottom",title:ye},e().createElement("span",{style:{marginLeft:"2px"}},e().createElement(Fe.Z,{iconClass:"iconf-tipe",color:"#fff",size:"14px"}))))):null,F&&e().createElement("div",{className:"upload-btn-container dropdown-btn-left"},e().createElement(L.Z,{type:"primary",ghost:!0,onClick:this.handleChooseFiles,disabled:j},e().createElement(bt.Z,null),s("resourceLibrary.upload"))),!(0,Tt.xX)()&&Z&&o==="false"&&e().createElement("div",{className:"upload-btn-container dropdown-btn-left-upload"},e().createElement(L.Z,{type:"primary",ghost:!0,onClick:()=>this.handleCreateCourse(3),disabled:Ee},e().createElement(It.Z,null),s("resourceLibrary.create"))),ae&&n&&!j||h&&!j?e().createElement(O.Z,{overlay:Ce,disabled:!t.length},e().createElement(L.Z,null,"".concat(s("common.more"),"  ").concat(s("common.operate"))," ",e().createElement(se.Z,null))):null)))},this.renderUploader=()=>{var l=this.props,a=l.breadcrumbList,t=a===void 0?[]:a,s=l.classifyId,n=s===void 0?0:s,i=l.activeTab,d=t[t.length-1],o=this.state.uploadShow;return e().createElement(Pt.Z,(0,N.Z)({params:{classifyId:n,bizType:0},defaultFolder:d,hasZip:"true",isAllowLocal:!0,activeStorageId:i.id},o))}}render(){var p=this.props,l=p.prefixCls,a=p.activeTab,t=this.state,s=t.addFolderProps,n=t.coursewareTreeProps,i=t.visibleMemberModal;return e().createElement(e().Fragment,null,e().createElement("section",{className:l},this.renderActionBtns(),this.renderUploader(),e().createElement(_t.Z,(0,N.Z)({},s,{onCancel:this.handleCancelAddFolder,onCreate:this.handleOkAddFolder})),e().createElement(Lt,(0,N.Z)({privatization:a.id==="0"?null:a.id},n,{onCancel:this.handleCancelCoursewareTree,onOk:this.handleOkCoursewareTree})),i&&e().createElement(St.Z,{visible:i,onClose:this.handleCloseMemberModal})))}}st.defaultProps={prefixCls:"library-page-list__header",activeTab:{}};var Zt=(0,g.$j)(Ot)((0,_.Z)()(st)),At=r(30389),Dt=r(11449),wt=r(77217),Mt=r(82056),Ut=r(4408),ke=r(43967),Nt=S.Z.TabPane,Bt=J=>{var p=J.user,l=J.resourceLibrary,a=J.localUploader,t=J.uploader;return{userInfo:p,resourceLibrary:l,breadcrumbLists:l.breadcrumbLists,refresh:l.refresh,tabStatus:l.tabStatus,list:t.list,uploadSucceedItem:t.uploadSucceedItem,localUploadList:a.list,localSuccessList:a.updateSucceedList||[]}};class nt extends e().Component{constructor(){var p;super(...arguments);p=this,this.state={params:{keyword:"",parent_id:0,resource_classify:0,page_number:1,page_size:20,course_flag:1,upgrade_type:"",review:"block"},tableLoading:!0,tabLoading:!1,queryTitle:this.props.t("leftMenuLists.coursewareManagement"),breadcrumbList:[],tableList:[],tableTotal:0,selectedRowKeys:[],selectedRows:[],activeKey:"0",employeeProps:{visible:!1,resourceClassifyIds:"",resourceIds:"",initialParams:{employeeRange:{rangeType:1,rangeList:{dept:[],post:[],group:[],user:[]}}}},tabs:[{id:"0",name:this.props.t("localStorage.commonStorage"),appKey:"",status:!0,storageType:"PUBLIC_CLOUD"}],transformTabs:{"0":{id:"0",name:this.props.t("localStorage.commonStorage"),appKey:"",storageType:"PUBLIC_CLOUD"}},blackList:{getLocalStorageBlack:(0,Me.eY)("PROJECT_LIBRARY_LOCAL_STORAGE")}},this.initBreadcrumbList=[{value:"0",name:this.props.t("localStorage.allFiles"),isInit:!0}],this.getLocalStorage=(0,C.Z)(E().mark(function l(){var a,t,s;return E().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,Mt.cF)();case 2:a=i.sent,t=a.data,t.code===0&&(s=window.OnlyShowLocalStorage?p.getLocalTabs(t.data):p.getTabs(t.data),p.setState({tabs:[...s]},()=>{var d=p.state.tabs,o=p.props.tabStatus,c={};d.forEach(f=>{c[f.id]=f}),p.setState({transformTabs:c,activeKey:o.tabKey||d[0].id},()=>{p.refreshPage()})}));case 5:case"end":return i.stop()}},l)})),this.getLocalTabs=l=>{var a=this.state.tabs;return Array.isArray(l)&&l.length>0?l.filter(t=>t.storageType==="LOCAL"):[...a]},this.getTabs=l=>{var a=this.state.tabs;if(Array.isArray(l)&&l.length>0){var t=l.filter(n=>n.isDefault),s=l.findIndex(n=>n.isDefault);return s>-1&&l.splice(s,1),[...t,...a,...l]}return[...a]},this.handleChangeTab=(0,ge.E5)(l=>{var a=this.props,t=a.localUploadList,s=a.list,n=a.t,i=(0,ke.Y5)(s).length>0,d=(0,ke.Y5)(t).length>0;i||d?I.Z.confirm({content:n("localStorage.stopUploadTip"),cancelText:n("common.cancel"),okText:n("localStorage.changeUploader"),onOk:()=>{this.toggleTab(l)},onCancel:()=>{}}):this.toggleTab(l)},300),this.toggleTab=l=>{var a=this.state.params,t=this.props,s=t.dispatch,n=t.history;this.setState({activeKey:l,tabLoading:!0,breadcrumbList:this.initBreadcrumbList,params:(0,m.Z)((0,m.Z)({},a),{},{parent_id:"0"})},()=>{s({type:"resourceLibrary/resetBreadcrumbLists",payload:{id:"0",breadcrumbList:this.initBreadcrumbList}}),s({type:"localUploader/destroyUploader"}),s({type:"uploader/destroyUploader"}),s({type:"resourceLibrary/saveTabSetting",payload:{tabStatus:{tabKey:l}}}),n.push({pathname:"/knowledgeBase/learningResources/library"})})},this.refreshPage=()=>{var l=this.props,a=l.history,t=l.breadcrumbLists,s=l.dispatch,n=D.parse(a.location.search),i=n.id,d=i===void 0?"0":i,o=t[d];if(d!=="0"&&o instanceof Array&&o.length){var c=o[o.length-1];s({type:"uploader/initSaveParams",payload:{params:{classifyId:c.value,bizType:0}}}),this.setState(f=>({queryTitle:c.name,params:(0,m.Z)((0,m.Z)({},f.params),{},{parent_id:c.value,resource_classify:c.value}),breadcrumbList:o}),()=>{this.handleInitData()})}else s({type:"uploader/initSaveParams",payload:{params:{classifyId:0,bizType:0}}}),this.setState(f=>({breadcrumbList:this.initBreadcrumbList,queryTitle:this.props.t("leftMenuLists.coursewareManagement"),params:(0,m.Z)((0,m.Z)({},f.params),{},{keyword:"",parent_id:0,resource_classify:0,page_number:1,page_size:20})}),()=>{this.handleInitData()})},this.handleInitData=()=>{var l=U.ZP.LibraryList.getAllResourceList(),a=this.state,t=a.params,s=a.activeKey,n=t;s&&s!=="0"&&(n=(0,m.Z)((0,m.Z)({},t),{},{privatization:s})),this.setState({tableLoading:!0,selectedRowKeys:[],selectedRows:[]}),me.WY.get({url:l,params:n}).then(i=>{this.setState({tableLoading:!1,tabLoading:!1,tableList:i.data.list.map(d=>{var o=d;switch(o.resource.failed_reason){case"PARAMETER_ERROR":o.resource.failed_reason_map="".concat(this.props.t("course.paramError"));break;case"INTERNAL_ERROR":o.resource.failed_reason_map="".concat(this.props.t("course.serverError"));break;case"VIDEO_NOT_SUPPORT":o.resource.failed_reason_map="".concat(this.props.t("course.VideoNotSplit"));break;case"ASR_NOT_SUPPORT":o.resource.failed_reason_map="".concat(this.props.t("course.VoiceTranscodeFailed"));break;case"IMAGE_ERR":o.resource.failed_reason_map="".concat(this.props.t("course.getPictureFailed"));break;case"OTHER_ERR":o.resource.failed_reason_map="".concat(this.props.t("course.otherError"));break;default:o.resource.failed_reason_map="/"}return o.resource}),tableTotal:Number(i.data.total)})})},this.handleChangePagination=l=>{var a=l.current,t=l.pageSize;this.setState(s=>({params:(0,m.Z)((0,m.Z)({},s.params),{},{page_number:a,page_size:t})}),()=>{this.handleInitData()})},this.handleSearch=(l,a)=>{this.setState(t=>({params:(0,m.Z)((0,m.Z)({},t.params),{},{page_number:1,keyword:a===""?l:"",userIds:a})}),()=>{this.handleInitData()})},this.searchList=l=>{this.setState(a=>({params:(0,m.Z)((0,m.Z)({},a.params),{},{page_number:1,upgrade_type:l})}),()=>{this.handleInitData()})},this.handleTableSelections=(l,a)=>{this.setState({selectedRowKeys:l,selectedRows:a})},this.handleDeepIn=l=>{var a=l.record,t=a.id,s=a.name,n=[...this.state.breadcrumbList];this.props.dispatch({type:"uploader/closeWrapper",payload:{dispatch:this.props.dispatch,cbk:()=>{this.props.dispatch({type:"uploader/initSaveParams",payload:{params:{classifyId:t,bizType:0}}}),this.setState(i=>({queryTitle:s,params:(0,m.Z)((0,m.Z)({},i.params),{},{keyword:"",parent_id:t,resource_classify:t,page_number:1})}),()=>{this.props.dispatch({type:"resourceLibrary/updateBreadcrumbLists",payload:{id:t,breadcrumbList:[...n,{value:t,name:s,record:(0,m.Z)({},a)}]}}),this.props.history.push({pathname:"/knowledgeBase/learningResources/library",search:D.stringify({id:t})})})}}})},this.handleClickBreadcrumb=l=>{var a=l.breadcrumbItem,t=this.props.t;this.props.dispatch({type:"uploader/closeWrapper",payload:{dispatch:this.props.dispatch,cbk:()=>{var s=a.value,n=a.name;this.props.dispatch({type:"uploader/initSaveParams",payload:{params:{classifyId:s,bizType:0}}});var i=[...this.state.breadcrumbList],d=i.findIndex(o=>o.value===s);d<0||(i.splice(d+1,i.length-d+1),this.setState(o=>({queryTitle:i.length===3?t("leftMenuLists.coursewareManagement"):n,params:(0,m.Z)((0,m.Z)({},o.params),{},{parentId:s,resource_classify:s})}),()=>{s!==0&&this.props.dispatch({type:"resourceLibrary/updateBreadcrumbLists",payload:{id:s,breadcrumbList:i}}),this.props.history.push({pathname:"/knowledgeBase/learningResources/library",search:D.stringify({id:s})})}))}}})},this.handleMultiVisibleRange=()=>{var l=this.state.selectedRows,a=[],t=[];l.map(s=>s.type?a.push(s.id):t.push(s.id)),this.setState(s=>({employeeProps:(0,m.Z)((0,m.Z)({},s.employeeProps),{},{visible:!0,resourceClassifyIds:t,resourceIds:a,initialParams:{employeeRange:{rangeType:3,rangeList:{dept:[],post:[],group:[],user:[]}}}})}))},this.handleSingleVisibleRange=l=>{var a=l.visibleRange,t=l.scopes,s=l.id,n=l.type;this.setState({employeeProps:{visible:!0,resourceClassifyIds:n?[]:[s],resourceIds:n?[s]:[],initialParams:{employeeRange:{rangeType:a==="all"?1:a==="part"?2:3,rangeList:{dept:t.departmentList,post:t.postList,group:t.groupList,user:t.userList}}}}})},this.handleEmployeeOk=l=>{var a=this.state.employeeProps,t=a.resourceClassifyIds,s=a.resourceIds,n=l.isAll,i=l.departmentIds,d=l.groupIds,o=l.postIds,c=l.userIds,f=l.qy_we_chat_vo,h={resource_classify_ids:t.join(","),resource_ids:s.join(","),visible_range:n===1?"all":n===2?"part":"myself",department_ids:i,group_ids:d,post_ids:o,user_ids:c,qy_we_chat_vo:f};this.withApiSetEmployeeOk(h)},this.withApiSetEmployeeOk=l=>{var a=this.props.t;me.WY.post({url:U.ZP.LibraryList.batchUpdateVisible(),data:(0,m.Z)({},l)}).then(t=>{t.data.result&&b.default.success(a("personal.batchSetRangeSuccess")),this.handleEmployeeCancel(),this.handleInitData()})},this.handleEmployeeCancel=()=>{this.setState(l=>({employeeProps:(0,m.Z)((0,m.Z)({},l.employeeProps),{},{visible:!1})}))},this.renderBreadcrumb=()=>{var l=this.state.breadcrumbList;return e().createElement(wt.Z,null,e().createElement(k.Z,{separator:e().createElement(v.Z,{className:"breadcrumb-right-outlined"})},l.map((a,t)=>e().createElement(e().Fragment,null,e().createElement(k.Z.Item,{key:t,className:"header-ant-breadcrumb-btn",onClick:()=>this.handleClickBreadcrumb({breadcrumbItem:a})},e().createElement(w.Z,{className:"header-ant-breadcrumb-iconfont"}),a.name)))))},this.renderLeftRow=l=>{var a=D.parse(this.props.history.location.search),t=a.renderGuide,s=t===void 0?!1:t,n=this.state,i=n.params,d=n.queryTitle,o=n.selectedRowKeys,c=n.selectedRows,f=n.breadcrumbList,h=n.transformTabs,F=n.activeKey;return e().createElement(Zt,{title:d,classifyId:i.resource_classify,selectedRowKeys:o,selectedRows:c,onTableRender:this.handleInitData,breadcrumbList:f,isRootDirectory:f.length===1,onSetVisibleRange:this.handleMultiVisibleRange,renderGuide:s,activeTab:h[F]||{},activeIndex:l})},this.renderRightRow=()=>{var l=this.state,a=l.queryTitle,t=l.transformTabs,s=l.activeKey;return e().createElement(gt,{title:a,onTableRender:this.handleInitData,searchList:this.searchList,activeTab:t[s]||{},onSearch:this.handleSearch})},this.render=()=>{var l=this.props,a=l.prefixCls,t=l.t,s=this.state,n=s.tableList,i=s.tableLoading,d=s.tableTotal,o=s.params,c=s.selectedRowKeys,f=s.employeeProps,h=s.tabs,F=s.transformTabs,Z=s.activeKey,ce=s.tabLoading,ie={total:d,current:o.page_number,pageSize:o.page_size};return e().createElement(Dt.Z,{pageContainerParams:{header:{title:e().createElement("div",{className:"page-header-title-content"},e().createElement("div",null,this.props.t("leftMenuLists.coursewareManagemented"))),className:"library-page-list-header"}}},e().createElement(Ut.Z,{title:t("documentTitle.material")}),e().createElement("div",{className:"files-storage"},e().createElement(P.Z,{spinning:i||ce},e().createElement(S.Z,{activeKey:Z,onChange:this.handleChangeTab,className:"min-width"},h.map((ae,j)=>e().createElement(Nt,{tab:ae.name,key:ae.id},e().createElement("div",{className:a},e().createElement("div",{className:"page-header-title-breadcrumb"},this.renderBreadcrumb()," "),e().createElement("div",{className:"".concat(a,"__content"),ref:Ee=>this.tableRef=Ee},e().createElement(vt,{list:n,onGetList:this.handleInitData,onTableChange:this.handleChangePagination,paginationParams:ie,selectedRowKeys:c,onSelectChange:this.handleTableSelections,onDeepIn:this.handleDeepIn,onTableRender:this.handleInitData,onSetVisibleRange:this.handleSingleVisibleRange,storageId:ae.id,activeTab:F[Z]||{},toolBarRender:this.renderRightRow,headerTitle:this.renderLeftRow(j)})),f.visible&&e().createElement(At.Z,(0,N.Z)({},f,{title:t("courseManage.setTheVisibility"),mode:["all","part","private"],orgProps:{title:t("component.chooseVisibleScope")},onlyChooseDept:!0,onlyCreateUser:!0,isLoading:!f.visible,onCancel:this.handleEmployeeCancel,onCreate:this.handleEmployeeOk})))))))))}}componentDidMount(){var p=this.state.blackList;p.getLocalStorageBlack?this.getLocalStorage():this.refreshPage()}UNSAFE_componentWillReceiveProps(p){(0,ke.Of)(p,this.props)&&this.handleInitData(),(0,ke.SH)(p,this.props)&&this.handleInitData()}componentDidUpdate(p){p.refresh!==this.props.refresh&&this.refreshPage()}componentWillUnmount(){var p=this.props.dispatch;p({type:"resourceLibrary/resetBreadcrumbLists",payload:{id:"0",breadcrumbList:this.initBreadcrumbList}}),p({type:"resourceLibrary/saveTabSetting",payload:{tabStatus:{}}})}}nt.defaultProps={prefixCls:"library-page-list sticky-table"};var Wt=(0,g.$j)(Bt)((0,_.Z)()(nt))},95371:function(fe,X,r){"use strict";r.d(X,{iv:function(){return W},lK:function(){return k},bS:function(){return te},Ds:function(){return b},TP:function(){return R},bG:function(){return I},SI:function(){return C},PC:function(){return T}});var x=r(88986),P=r(37055),N=r(10237);function W(){var S=P.ZP.shareSettings.getServiceAuthorizeList();return N.WY.get({url:S,params:{enterprise_id:P.ZP.enterpriseId,app_id:P.ZP.shareId}})}function k(S){var B=P.ZP.shareSettings.getShareConfig();return N.WY.get({url:B,params:{enterprise_id:P.ZP.enterpriseId,app_id:P.ZP.shareId,source_knowledge_id:S}})}function te(S,B){var E=B?P.ZP.shareSettings.addShareSettings():P.ZP.shareSettings.editShareSettings();return N.WY.post({url:E,data:(0,x.Z)((0,x.Z)({},S),{},{enterprise_id:P.ZP.enterpriseId,app_id:P.ZP.shareId,user_id:P.ZP.userId})})}function b(S){var B=S.source_knowledge_id,E=S.knowledge_type,q=P.ZP.shareSettings.doShare();return N.WY.post({url:q,data:{knowledge_id:B,knowledge_type:E,enterprise_id:P.ZP.enterpriseId,app_id:P.ZP.shareId,share_user:P.ZP.userId}})}function m(S){var B=CONFIG.shareSettings.getShareInfo();return request.get({url:B,params:{share_id:S,enterprise_id:CONFIG.enterpriseId}})}function R(S){var B=P.ZP.H5Article.getArticleInfo({id:S});return N.WY.get({url:B,params:{}})}function I(S,B){var E=P.ZP.shareSettings.sendMessage();return N.WY.get({url:E,params:{enterprise_id:P.ZP.enterpriseId,app_id:P.ZP.shareId,source_knowledge_id:S,share_url:B}})}function C(S){var B=S.resourceId,E=P.ZP.LibraryList.uploadThirdPart(B);return N.WY.post({url:E,data:{source:"lai_hua"}})}function T(S,B){var E=B.oldResourceId,q=B.resourceId,e=P.ZP.LibraryList.replaceResource({oldResourceId:E,resourceId:q});return N.WY.post({url:e,data:S})}},90994:function(fe,X,r){"use strict";var x=r(71194),P=r(57016),N=r(57663),W=r(71577),k=r(47673),te=r(4107),b=r(34792),m=r(48086),R=r(12924),I=r.n(R),C=r(92592),T=r(91768),S=r(28216),B=r(95371),E=r(1164),q=_=>{var D=_.user,g=_.resourceLibrary;return{userInfo:D,resourceLibrary:g}};class e extends I().Component{constructor(){super(...arguments);this.state={codeUrl:"",isModalVisible:!1},this.handleCancel=()=>{var D=this.props.closeShareWay;D&&D()},this.copy=()=>{var D=document.getElementById("link");D.select(),document.execCommand("Copy"),m.default.success(this.props.t("live.copySuccess"))},this.open=()=>{var D=this.props.shareUrl;E.Z.targetTo({path:D,isExternalLink:!0})},this.sendMessage=()=>{this.setState({isModalVisible:!0})},this.handleOk=()=>{var D=this.props,g=D.sourceKnowledgeId,v=D.shareUrl,w=D.t;(0,B.bG)(g,v).then(M=>{var L=M.data.code;L===2e5||L==="200000"?(m.default.success(w("shareInfo.sendSuccess")),this.setState({isModalVisible:!1})):m.default.error(w("shareInfo.sendFail"))})},this.handleSendCancel=()=>{this.setState({isModalVisible:!1})},this.download=()=>{var D=document.getElementById("code_canvas"),g=this.state.codeUrl,v=new Image;v.crossOrigin="anonymous",v.src=g,v.onload=()=>{var w=D.getContext("2d");w.textAlign="center",w.fillStyle="#fff",w.fillRect(0,0,750,886),w.drawImage(v,185,217,381,381),w.font="42px bold serif",w.fillStyle="#4F4F4F";var M=D.toDataURL("image/jpeg"),L=document.createElement("a");L.setAttribute("href",M),L.setAttribute("download","\u4E8C\u7EF4\u7801.jpg"),document.body.insertAdjacentElement("beforeend",L),L.click(),L.remove()}}}componentDidUpdate(D){D.showShareWay!==this.props.showShareWay&&this.props.showShareWay&&C.toDataURL(this.props.shareUrl,{width:500}).then(g=>{this.setState({codeUrl:g})}).catch(()=>{m.default.error(this.props.t("integralMall.qrCodeFailed"))})}render(){var D=this.props,g=D.prefixCls,v=D.t,w=D.showShareWay,M=D.shareUrl,L=D.courseType,u=D.shareScene,de=this.state,V=de.codeUrl,z=de.isModalVisible;return I().createElement(P.Z,{centered:!0,title:v("shareInfo.shareWay"),visible:w,footer:null,onCancel:this.handleCancel,maskClosable:!1,width:920,bodyStyle:{padding:"24px"}},I().createElement("div",{className:"".concat(g)},I().createElement("div",{className:"".concat(g,"_tip")},u!="customer_training"?v("shareInfo.shareWayTipOne"):null,u!="customer_training"?I().createElement("br",null):null,u!="customer_training"?v("shareInfo.shareWayTipTwo"):null,u==="customer_training"?v("shareInfo.shareWayTip"):null),I().createElement("div",{className:"".concat(g,"_title")},I().createElement("span",null,v("shareInfo.firstWay"))," ",v("shareInfo.firstWayDesc")),I().createElement("div",{className:"".concat(g,"_url")},I().createElement(te.Z,{className:"".concat(g,"_url_input"),readOnly:!0,value:M}),I().createElement(te.Z,{className:"".concat(g,"_url_hidden"),value:M,id:"link"}),I().createElement(W.Z,{type:"link",onClick:this.copy},v("common.copy")),I().createElement(W.Z,{type:"link",onClick:this.open},v("shareInfo.openShare"))),I().createElement("div",{className:"".concat(g,"_title")},I().createElement("span",null,v("shareInfo.secondWay"))," ",v("shareInfo.secondWayDesc")),I().createElement("div",{className:"".concat(g,"_code")},I().createElement("div",{className:"".concat(g,"_code_white")},I().createElement("img",{className:"".concat(g,"_code_white_img"),src:V,alt:""})),I().createElement("canvas",{className:"".concat(g,"_code_canvas"),id:"code_canvas",width:750,height:886}),I().createElement(W.Z,{type:"link",onClick:this.download},v("shareInfo.downloadCode"))),L==="graphicLesson"&&u==="customer_training"&&I().createElement(I().Fragment,null,I().createElement("div",{className:"".concat(g,"_wrapper")},I().createElement("div",{className:"".concat(g,"_title")},I().createElement("span",null,v("shareInfo.thirdWay"))," ",v("shareInfo.thirdWayDesc"),I().createElement("span",{className:"".concat(g,"_descDetail")},v("shareInfo.thirdWayDescDetail"))),I().createElement(W.Z,{type:"link",onClick:this.sendMessage},v("shareInfo.sendMessages"))),I().createElement(P.Z,{title:v("shareInfo.modalTitle"),visible:z,onOk:this.handleOk,onCancel:this.handleSendCancel},I().createElement("p",null,v("shareInfo.modalTipsContent"))))))}}e.defaultProps={prefixCls:"share-way"},X.Z=(0,S.$j)(q)((0,T.Z)()(e))},91805:function(fe,X,r){"use strict";var x=r(71194),P=r(57016),N=r(62029),W=r(48736),k=r(27049),te=r(47673),b=r(4107),m=r(88983),R=r(47933),I=r(43358),C=r(34041),T=r(13062),S=r(71230),B=r(89032),E=r(15746),q=r(9715),e=r(86585),_=r(77576),D=r(59314),g=r(57663),v=r(71577),w=r(34792),M=r(48086),L=r(12924),u=r.n(L),de=r(91768),V=r(28216),z=r(5430),K=r(95371),$=H=>{var ee=H.user,y=H.resourceLibrary;return{userInfo:ee,resourceLibrary:y}};class Q extends u().Component{constructor(ee){super(ee);this.formRef=u().createRef(),this.share=!1,this.getAuthorizeList=()=>{(0,K.iv)().then(y=>{var A=y.data.data.authorize_info_list;this.setState({authorize_info_list:A})})},this.getShareConfigs=()=>{var y=this.props.id;(0,K.TP)(y).then(A=>{var O=A.data,ue=O.cover,re=O.title;this.setState({defaultUrl:ue||"".concat("https://oss.coolcollege.cn","/1794891397082517504.png")}),(0,K.lK)(y).then(pe=>{if(pe.data.data&&pe.data.data.app_id!==""){var G=pe.data.data;this.formRef.current.setFieldsValue({is_share:G.open_share==="TRUE",is_card:G.open_staff_card==="TRUE",is_open:G.user_visible==="PUBLIC"?"1":"0",phone:G.user_phones===""?"":G.user_phones.join(","),officialAccountId:G.official_account_app_id,selectCount:G.official_account_app_id===z.ZP.account?"all":"select",cardTitle:G.share_title===""?re:G.share_title,cardContent:G.share_desc}),this.setState({openShare:G.open_share==="TRUE",officialAccount:G.official_account,officialAccountNew:G.official_account_app_id===z.ZP.account?z.ZP.account:"",isAdd:!1,knowledge_id:G.knowledge_id})}else this.formRef.current.setFieldsValue({cardTitle:re})})})},this.changeShareStatus=y=>{this.setState({openShare:y}),!y&&this.formRef.current&&this.formRef.current.setFields([{name:"selectCount",errors:[]},{name:"officialAccountId",errors:[]},{name:"phone",errors:[]}])},this.selectOfficialAccount=(y,A)=>{this.setState({officialAccount:A.children})},this.changePerm=y=>{y==="all"?(this.formRef.current.setFieldsValue({officialAccountId:z.ZP.account}),this.setState({officialAccount:z.ZP.accountName,officialAccountNew:z.ZP.account})):(this.formRef.current.setFieldsValue({officialAccountId:null}),this.setState({officialAccount:"",officialAccountNew:""}))},this.onFinish=y=>{var A=this.props,O=A.id,ue=A.t,re=this.state,pe=re.officialAccount,G=re.isAdd,se=re.defaultUrl,Te=re.knowledge_id,_e=re.officialAccountNew,le=y.is_share,oe=y.is_open,he=y.is_card,Ae=y.phone,je=y.officialAccountId,De=y.cardTitle,Je=y.cardContent,Le=y.selectCount,ge={source_knowledge_id:O,auth_wechat:"TRUE",official_account_app_id:Le==="all"?_e:je,official_account:pe,auth_phone:oe==="1"?"FALSE":"TRUE",open_staff_card:he?"TRUE":"FALSE",user_visible:oe==="1"?"PUBLIC":"ASSIGN_ACCOUNT",open_share:le?"TRUE":"FALSE",share_title:De,share_desc:Je,knowledge_type:"ARTICLE",share_image_url:se};oe==="0"&&(ge.user_phones=Ae.split(",")),(0,K.bS)(ge,G).then(Ye=>{var we=Ye.data,xe=we.code,Ge=we.data;xe===2e5||xe==="200000"?(M.default.success(ue("common.saveSuccess")),this.share?this.doShare(G?Ge:Te):this.handleCancelShare()):M.default.error(ue("common.saveFailure"))})},this.onFinishFailed=()=>{this.share=!1},this.doShare=y=>{var A=this.props.t;(0,K.Ds)({source_knowledge_id:y,knowledge_type:"ARTICLE"}).then(O=>{var ue=O.data,re=ue.code,pe=ue.data;if(re===2e5||re==="200000"){var G=this.props.cancelTipOpenWay;G&&G({shareUrl:"".concat(pe.share_url,"&kid=").concat(this.props.id,"&eid=").concat(z.ZP.enterpriseId,"&aid=").concat(z.ZP.shareId)})}else M.default.error(A("study.operateFailed"));this.share=!1})},this.handleCancelShare=()=>{var y=this.props.onCancelShare;this.setState({knowledge_id:""}),y&&y(),this.share=!1},this.operate=y=>{y==="save"&&this.formRef.current.submit(),y==="saveAndShare"&&(this.share=!0,this.formRef.current.submit()),y==="cancel"&&this.handleCancelShare()},this.testPhone=y=>{for(var A=y.split(","),O=0;O<A.length;O+=1)if(!/(^1[0-9]{10}$)/.test(A[O]))return!1;return!0},this.state={initValues:{is_share:!1,is_card:!1,is_open:"1",phone:"",officialAccountId:null,selectCount:"select",cardTitle:"",cardContent:"",attachment:null},defaultUrl:"",authorize_info_list:[],officialAccount:"",officialAccountNew:"",isAdd:!0,openShare:!1,knowledge_id:""}}componentDidUpdate(ee){ee.showShareConfig!==this.props.showShareConfig&&this.props.showShareConfig&&(this.getAuthorizeList(),this.getShareConfigs()),ee.showShareConfig!==this.props.showShareConfig&&!this.props.showShareConfig&&this.changeShareStatus(!1)}render(){var ee=this,y=this.props,A=y.prefixCls,O=y.t,ue=y.showShareConfig,re=this.state,pe=re.initValues,G=re.authorize_info_list,se=re.openShare,Te=re.defaultUrl,_e={labelCol:{span:4},wrapperCol:{span:20}};return u().createElement(P.Z,{centered:!0,title:O("resourceLibrary.shareSetting"),visible:ue,footer:[u().createElement(v.Z,{key:"cancel",className:"".concat(A,"_button_cancel"),onClick:()=>this.operate("cancel")},O("common.cancel")),u().createElement(v.Z,{key:"save",className:"".concat(A,"_button_save"),type:"primary",onClick:()=>this.operate("save"),htmlType:"submit"},O("common.save")),u().createElement(v.Z,{key:"saveAndShare",disabled:!se,type:"primary",onClick:()=>this.operate("saveAndShare"),htmlType:"submit"},O("shareInfo.saveAndShare"))],onCancel:this.handleCancelShare,width:920,destroyOnClose:!0,bodyStyle:{padding:"24px"},wrapClassName:"share-setting-model",maskClosable:!1},u().createElement("div",{className:A},u().createElement("div",{className:"".concat(A,"_form")},u().createElement(e.Z,(0,N.Z)({name:"share_config"},_e,{ref:this.formRef,labelAlign:"left",onFinish:this.onFinish,initialValues:pe,onFieldsChange:this.onFieldsChange,onFinishFailed:this.onFinishFailed,requiredMark:!1}),u().createElement("div",{className:"".concat(A,"_form_title")},O("shareInfo.singleShare")),u().createElement(e.Z.Item,{label:O("shareInfo.shareSwitch"),colon:!1},u().createElement(S.Z,{gutter:8,align:"middle"},u().createElement(E.Z,{span:2},u().createElement(e.Z.Item,{name:"is_share",valuePropName:"checked",noStyle:!0},u().createElement(D.Z,{onChange:this.changeShareStatus,className:"".concat(A,"_form_switch"),checkedChildren:O("common.activatedStr"),unCheckedChildren:O("common.deactivatedStr")}))),u().createElement(E.Z,{span:22,className:"".concat(A,"_form_gray")},O("shareInfo.shareSwitchTip")))),u().createElement(e.Z.Item,{label:O("shareInfo.weChatPermission"),colon:!1,className:"".concat(A,"_form_specials")},u().createElement(S.Z,{gutter:8},u().createElement(E.Z,{span:12},u().createElement(e.Z.Item,{name:"selectCount",colon:!1,rules:[{required:se,message:O("shareInfo.selectWeiInfo")}]},u().createElement(C.Z,{placeholder:O("shareInfo.selectCountWay"),allowClear:!0,width:200,onSelect:this.changePerm,disabled:!se},u().createElement(C.Z.Option,{value:"select"},O("shareInfo.selectMine")),u().createElement(C.Z.Option,{value:"all"},O("shareInfo.selectOfficial"))))),u().createElement(E.Z,{span:12},u().createElement(e.Z.Item,{noStyle:!0,shouldUpdate:(le,oe)=>le.selectCount!==oe.selectCount},le=>{var oe=le.getFieldValue;return oe("selectCount")==="select"?u().createElement(e.Z.Item,{name:"officialAccountId",colon:!1,rules:[{required:se,message:O("shareInfo.pleaseSelectService")}]},u().createElement(C.Z,{placeholder:O("shareInfo.pleaseSelectService"),allowClear:!0,width:200,onSelect:this.selectOfficialAccount,disabled:!se},G.map(he=>u().createElement(C.Z.Option,{info:he,key:he.auth_info_id,value:he.authorizer_app_id},he.name)))):null})))),u().createElement(e.Z.Item,{label:O("shareInfo.permissionSettings"),colon:!1,name:"is_open"},u().createElement(R.ZP.Group,{disabled:!se,onChange:this.changeOpen},u().createElement(R.ZP,{value:"1"},O("shareInfo.allAccess")),u().createElement(R.ZP,{value:"0"},O("shareInfo.partAccess")))),u().createElement(e.Z.Item,{noStyle:!0,shouldUpdate:(le,oe)=>le.is_open!==oe.is_open},le=>{var oe=le.getFieldValue;return oe("is_open")==="0"?u().createElement(e.Z.Item,{label:O("shareInfo.followingAccess"),name:"phone",colon:!1,rules:[{required:se,message:O("shareInfo.allPhoneTip")},()=>({validator(he,Ae){return!se||!Ae||ee.testPhone(Ae)?Promise.resolve():Promise.reject(new Error(O("shareInfo.rightPhoneTip")))}})]},u().createElement(b.Z,{disabled:!se,placeholder:O("shareInfo.allPhoneTip")})):null}),u().createElement(e.Z.Item,{label:O("shareInfo.employeeBusinessCard"),colon:!1},u().createElement(S.Z,{gutter:8},u().createElement(E.Z,{span:2},u().createElement(e.Z.Item,{name:"is_card",valuePropName:"checked",noStyle:!0},u().createElement(D.Z,{disabled:!se,className:"".concat(A,"_form_switch"),checkedChildren:O("common.activatedStr"),unCheckedChildren:O("common.deactivatedStr")}))),u().createElement(E.Z,{span:22,className:"".concat(A,"_form_gray")},O("shareInfo.userCardTip")))),u().createElement(k.Z,null),u().createElement("div",{className:"".concat(A,"_form_title")},O("shareInfo.cardShareInfo")),u().createElement(S.Z,{gutter:8},u().createElement(E.Z,{span:12},u().createElement(e.Z.Item,{label:O("shareInfo.cardTitle"),colon:!1,name:"cardTitle",rules:[{required:se,message:O("shareInfo.shareTitleTip")}]},u().createElement(b.Z,{disabled:!se,placeholder:O("shareInfo.cardTitleTip"),maxLength:40})),u().createElement(e.Z.Item,{label:O("shareInfo.cardContent"),colon:!1,name:"cardContent"},u().createElement(b.Z.TextArea,{autoSize:{minRows:3,maxRows:3},disabled:!se,placeholder:O("shareInfo.cardContentTip"),maxLength:60}))),u().createElement(E.Z,{span:12,className:"".concat(A,"_form_switch")},u().createElement("div",{className:"".concat(A,"_form_preview")},O("shareInfo.cardPreview")),u().createElement("div",{className:"".concat(A,"_form_paddingLeft")},u().createElement(e.Z.Item,{noStyle:!0,shouldUpdate:(le,oe)=>le.cardTitle!==oe.cardTitle||le.cardContent!==oe.cardContent},le=>{var oe=le.getFieldValue;return u().createElement("div",{className:"".concat(A,"_form_card")},u().createElement("div",{className:"".concat(A,"_form_card_title")},oe("cardTitle")),u().createElement("div",{className:"".concat(A,"_form_card_content")},u().createElement("div",{className:"".concat(A,"_form_card_content_left")},oe("cardContent")),u().createElement("div",{className:"".concat(A,"_form_card_content_right")},u().createElement("img",{src:Te,alt:"pictures"}))))})))),u().createElement(e.Z.Item,{className:"".concat(A,"_button"),wrapperCol:{span:20,offset:4}})))))}}Q.defaultProps={prefixCls:"share-setting-page"},X.Z=(0,V.$j)($)((0,de.Z)()(Q))},70517:function(fe,X,r){"use strict";r.d(X,{ZG:function(){return b},v8:function(){return m},Yv:function(){return R},$v:function(){return I},yW:function(){return C}});var x=r(57361),P=r(9754),N=r.n(P),W=r(91302),k=r(10237),te=r(37055),b=T=>{var S=!1;return W.ch.forEach(B=>{(T||"").indexOf(B)!==-1&&(S=!0)}),S},m=function(){var T=(0,x.Z)(N().mark(function S(){var B;return N().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return B=te.ZP.LibraryList.checkMemberUserBinding(),q.abrupt("return",k.WY.get({url:B,params:{source_type:"lai_hua"}}));case 2:case"end":return q.stop()}},S)}));return function(){return T.apply(this,arguments)}}(),R=function(){var T=(0,x.Z)(N().mark(function S(B){var E,q,e,_;return N().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return E=te.ZP.LibraryList.thirdEditorUrl(),g.next=3,k.WY.get({url:E,params:{source_type:"lai_hua",route_type:B}});case 3:q=g.sent,e=q.data,_=q.success,_==="true"&&window.open(e.url,"_blank");case 7:case"end":return g.stop()}},S)}));return function(B){return T.apply(this,arguments)}}(),I=()=>{localStorage.setItem("openedMemberModal","true")},C=T=>{var S=te.ZP.LibraryList.addTrialMemberBinding();return k.WY.get({url:S,params:{source_type:"lai_hua",route_type:T}})}}}]);
