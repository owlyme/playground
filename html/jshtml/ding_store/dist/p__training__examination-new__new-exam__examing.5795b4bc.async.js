(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[4089],{19064:function(we,ue,t){"use strict";t.r(ue),t.d(ue,{default:function(){return qe}});var fe=t(20228),he=t(11382),ve=t(34792),ee=t(48086),Y=t(57361),Ne=t(71194),Z=t(57016),V=t(88986),O=t(33565),ye=t(9754),g=t.n(ye),r=t(12924),e=t.n(r),j=t(76651),P=t(91768),re=t(57068),K=t(3230),ge=t(1096),l=t(70018),tt=t(57663),Ce=t(71577),De=t(15703),se=t.n(De),pe=t(84874),te=t(38642),Ae=(T,a)=>{var m=T.t,I=(0,r.useContext)(K.Z),w=I.state,d=I.dispatch,F=w.cutScreenInfo,_=w.params,B=w.basicInfo,i=w.remainingTime,y=F.cut_screen_count,o=F.complete_cut_screen_count,E=F.cut_screen_rule,D=_.exam_id,J=_.submit_id,Q=_.task_id,f=(0,r.useState)(!1),M=(0,O.Z)(f,2),G=M[0],X=M[1],v=(0,r.useRef)({stop:!1}),S=(0,r.useMemo)(()=>(0,te.vy)(),[]),U=(0,r.useMemo)(()=>(0,te.w8)(),[]),q=function(){var u=(0,Y.Z)(g().mark(function s(){var h,N=arguments;return g().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:h=N.length>0&&N[0]!==void 0?N[0]:!0,(0,l.vU)(D,{submit_id:J,task_id:Q}).then(k=>{var A=k.data,Ze=A.code,n=A.data;Ze==="200000"&&h&&(d({type:"updateCut",payload:{complete_cut_screen_count:n.complete_cut_screen_count}}),X(!0))}).finally(()=>{(0,l.r7)({key:"CutScreen",msg:"New Exam: Save screen",data:{exam_id:D,submit_id:J}})});case 2:case"end":return ie.stop()}},s)}));return function(){return u.apply(this,arguments)}}();(0,r.useImperativeHandle)(a,()=>({checkQuiteStatus:()=>(E!=="unlimited"&&ne(!1),!(E==="disable"||o===y)),stopScreen:()=>{v.current.stopScreen=!0}}));var ne=function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,h=v.current,N=h.cut_screen_rule,c=h.complete_cut_screen_count,ie=h.cut_screen_count;N==="disable"||c===ie?d({type:"setSubmit",payload:"screenAuto"}):q(s)},z=(0,r.useMemo)(()=>(0,te.eY)("DELETE_CUTSCREEN_COUNT"),[]),W=()=>{if(!v.current.stopScreen){var u=document[U.action];!u&&!v.current.visible&&ne()}},R=()=>{var u=S.exit;document[u]()},$=()=>{var u=S.entry;document.documentElement[u]()},le=u=>{if(!v.current.stopScreen){var s=u||window.event,h=S.action,N=document[h];!N||(s&&(s.keyCode===27||s.keyCode===122)&&(s.preventDefault(),R()),s&&(s.keyCode===27||s.ctrlKey&&s.metaKey&&s.keyCode===70)&&(s.preventDefault(),R()))}},de=()=>{var u=S.action;v.current.visible&&document[u]?X(!1):$()},x=()=>{if(!v.current.stopScreen){var u=S.action,s=document[u];s===!0?X(!1):ne()}};return(0,r.useEffect)(()=>B.remaining_time<=0?null:(z||d({type:"updateCut",payload:{cut_screen_rule:"unlimited"}}),E!=="unlimited"&&o<=y&&(X(!0),document.addEventListener("keyup",le,!1),document.addEventListener(S.event,x,!1),document.addEventListener(U.event,W,!1)),()=>{document.removeEventListener(S.event,x,!1),document.removeEventListener(U.event,W,!1),document.removeEventListener("keyup",le,!1),R()}),[]),(0,r.useEffect)(()=>{v.current.cut_screen_rule=E,v.current.cut_screen_count=y,v.current.complete_cut_screen_count=o,v.current.visible=G},[y,o,E,G]),e().createElement(e().Fragment,null,i>0?e().createElement(Z.Z,{visible:G,footer:null,closable:!1,wrapClassName:"screen-desc-modal",centered:!0},o===0&&e().createElement("p",{className:"".concat(se()["screen-info"],"  ").concat(se()["screen-content"])},e().createElement("span",null,e().createElement(pe.Z,{iconClass:"iconf-tipe",color:"#FAAD14",size:"16px"}),E==="disable"?e().createElement(e().Fragment,null," ",m("examination.openCutScreenDisable")):e().createElement(e().Fragment,null,m("examination.openCutScreen1"),e().createElement("span",{className:se()["screen-count"]},y),m("examination.openCutScreen2"))),e().createElement("span",{className:se()["screen-tip"]},m("examination.openCutScreentip"))),o>0&&o<=y&&e().createElement("p",{className:se()["screen-info"]},e().createElement("span",null,e().createElement(pe.Z,{iconClass:"iconf-tipe",color:"#FAAD14",size:"16px"}),m("examination.cutScreenLave"),e().createElement("span",{className:se()["screen-count"]},y-o),m("myExamTask.times")),e().createElement("span",{className:se()["screen-tip"]},m("examination.openCutScreentip"))),e().createElement("div",{className:se()["screen-footer"]},y>0&&e().createElement(Ce.Z,{type:"primary",onClick:de},o===0&&m("examination.startFullExam"),o>0&&m("common.close")))):null)},Fe=(0,P.Z)("translation",{withRef:!0})((0,r.forwardRef)(Ae)),Re=t(60506),ce=t.n(Re),Se=t(58935),Le=t(99891),Oe=T=>{var a=T.t,m=(0,r.useContext)(K.Z),I=m.state,w=I.basicInfo,d=I.paperList,F=w.paper_title,_=w.total_score,B=w.passing_score,i=w.paper_description;return e().createElement("div",{className:ce().content,id:"question-list"},e().createElement("div",{className:ce().top},e().createElement("h2",{className:ce().title},F),e().createElement("div",{className:ce().info},e().createElement("label",null,a("examination.totalScore"),"\uFF1A",e().createElement("span",null,_)),e().createElement("label",null,a("examination.passedScore"),"\uFF1A",e().createElement("span",null,B)),e().createElement("label",null,a("examination.paperCount"),"\uFF1A",e().createElement("span",null,d.length))),i&&e().createElement("p",{className:ce().description},a("examination.paperDescription"),"\uFF1A",i)),e().createElement("div",{className:ce().list},e().createElement(Le.Z,{scenes:"exam"}),d.map(y=>e().createElement(Se.Zr,{data:y,key:y.id}))))},Pe=(0,P.Z)("translation",{withRef:!0})(Oe),_e=t(8206),H=t.n(_e),Me=(T,a)=>{var m=T.t,I=(0,r.useState)(!1),w=(0,O.Z)(I,2),d=w[0],F=w[1],_=(0,r.useContext)(K.Z),B=_.state,i=_.dispatch,y=B.basicInfo,o=B.cutScreenInfo,E=B.remainingTime,D=o.cut_screen_rule,J=o.complete_cut_screen_count,Q=o.cut_screen_count,f=y.end_time,M=y.unlimited,G=z=>{if(z<=0)return"00:00:00";var W=Math.floor(z/3600),R=Math.floor((z-W*3600)/60),$=z-W*3600-R*60;return W<10&&(W="0".concat(W)),R<10&&(R="0".concat(R)),$<10&&($="0".concat($)),"".concat(W,":").concat(R,":").concat($)},X=(0,r.useState)(E),v=(0,O.Z)(X,2),S=v[0],U=v[1];(0,r.useImperativeHandle)(a,()=>({stopTime:()=>{F(!0)}})),(0,r.useEffect)(()=>{if(U(()=>G(E)),E<=1&&(document.onkeydown=z=>{var W=z.target;W.blur()}),!d){if(E<=0){i({type:"setSubmit",payload:"timeAuto"});return}M==="false"&&f*1<=new Date().getTime()&&i({type:"setSubmit",payload:"durationAuto"})}},[E]),(0,Se.Oc)(()=>{i({type:"updateRemainTime",payload:E-1})},d||E<=0?null:1e3);var q=()=>{i({type:"setCloseStatus",payload:"button"})},ne=()=>{if(!navigator.onLine){ee.default.warning(m("examination.networkError"));return}i({type:"setSubmit",payload:"manual"})};return e().createElement("div",{className:H().top},e().createElement("div",{className:H().left},e().createElement(Ce.Z,{type:"text",onClick:q,className:H().exit},e().createElement(pe.Z,{iconClass:"icon-tuichudenglu2",size:"16px"}),m("common.exitBack")),e().createElement("i",{className:H().septate}),e().createElement("span",{className:H().name},y.title)),e().createElement("div",{className:H().right},D!=="unlimited"?e().createElement("div",{className:H().group},e().createElement("label",{className:H().item},m("examination.cutScreenCount"),"\uFF1A",e().createElement("span",null,D!=="disable"?"".concat(J,"/").concat(Q):"".concat(m("examination.notAllowed"))))):null,e().createElement("div",{className:H().group},e().createElement("label",{className:H().item},m("examination.timer"),"\uFF1A",e().createElement("span",null,S))),e().createElement("div",{className:H().opt,onClick:ne},e().createElement(Ce.Z,{type:"primary",icon:e().createElement(pe.Z,{iconClass:"icon-f-send"})},m("examination.submitPaper")))))},We=(0,P.Z)("translation",{withRef:!0})((0,r.forwardRef)(Me)),$e=t(12478),Be=t.n($e),Ue=t(5358),ze=()=>{var T=(0,r.useContext)(K.Z),a=T.state,m=a.paperList,I=a.answerResult,w=(0,r.useState)([]),d=(0,O.Z)(w,2),F=d[0],_=d[1];return(0,r.useEffect)(()=>{var B=y=>{var o=I[y-1];return!!(o&&Object.keys(o).length>0&&(o.answer&&o.answer.length>0||o.answer_image&&o.answer_image.length>0))},i=y=>m.filter(o=>o.type===y).map(o=>(0,V.Z)((0,V.Z)({},o),{},{status:B(o.order_id)?"answered":"noAnswer"}));_([{label:"examination.single",list:i("single")},{label:"examination.multiple",list:i("multiple")},{label:"examination.tof",list:i("trueOrFalse")},{label:"examination.blank",list:i("fillBlank")},{label:"examination.describe",list:i("shortAnswer")}])},[m,I]),e().createElement("div",{className:Be().left},F.length>0&&e().createElement(Se.JQ,{types:Ue.dX,questionIndex:F}))},Ve=(0,P.Z)("translation",{withRef:!0})(ze),je=t(65432),ae=t.n(je),ke=t(40623),Ke=t(4408),Te=t(62029),He=t(94184),be=t.n(He),Ie=t(18329),Je=t(65202),Qe=t(67479),me=t(49147);function Ge(T){var a=T.t,m=T.examId,I=T.taskId,w=T.submitId,d=T.visible,F=T.onCancel,_=T.onToData,B=(0,Je.p)(),i={passed:{src:"".concat("https://oss.coolcollege.cn","/1819881979760480256.png"),val:a("examination.resultStatus.pass"),shadow:"0 0 5px rgba(66, 159, 75, 0.85)",text:a("examination.scoreWordsPassed")},failed:{src:"".concat("https://oss.coolcollege.cn","/1819882000337735680.png"),val:a("examination.resultStatus.fail"),shadow:"0 0 5px rgba(192, 39, 37, 0.85)",text:a("examination.scoreWordsFailed")},full:{src:"".concat("https://oss.coolcollege.cn","/1819882016783601664.png"),val:a("examination.resultStatus.full"),shadow:"0 0 5px #417DC2",text:a("examination.scoreWordsFull")},pending:{src:"".concat("https://oss.coolcollege.cn","/1819882024073302016.png"),val:a("examination.resultStatus.marking"),shadow:"0 0 5px #D3863D",text:a("examination.scoreWordsPending")},submit:{src:"".concat("https://oss.coolcollege.cn","/1819588124779614208.png"),text:a("examination.scoreWordsSubmit")}},y=(0,r.useState)(""),o=(0,O.Z)(y,2),E=o[0],D=o[1],J=(0,r.useState)({}),Q=(0,O.Z)(J,2),f=Q[0],M=Q[1],G=(0,r.useState)([{title:a("exam.examScore"),type:"score",icon:"icon-kaoshizongfen",val:"",units:a("common.examScoreUnit"),color:"#FF7130"},{title:a("examination.scoringRate"),type:"score_rate",icon:"icon-defenshuai",val:"",units:"",color:"#516AE6"},{title:a("examination.correctlyNumber"),type:"correct_count",icon:"icon-daduitimushu",val:"",units:a("exam.questionsUnit"),color:"#6DD400"},{title:a("examination.accuracy"),type:"correct_rate",icon:"icon-zhengqueshuai",val:"",units:"",color:"#40CBE0"},{title:a("examination.answerTime"),type:"exam_time",icon:"icon-datishichang",val:"",units:"",color:"#C08564"},{title:a("examination.obtainCertificate"),type:"certificate_vo",icon:"icon-xingzhuangjiehe",val:"",units:"",color:"#9766CD"}]),X=(0,O.Z)(G,2),v=X[0],S=X[1];(0,r.useEffect)(()=>{d&&U()},[d,I,m,w]);function U(){return q.apply(this,arguments)}function q(){return q=(0,Y.Z)(g().mark(function x(){var u,s,h,N,c;return g().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.prev=0,k.next=3,(0,l.lq)({examId:m,task_id:I,submit_id:w});case 3:if(u=k.sent,u.data.code!=="200000"){k.next=14;break}if(Z.Z.destroyAll(),s=(0,V.Z)({},u.data.data),M(s),h=[],s.status!=="pending"){k.next=12;break}return S([{title:a("examination.answerTime"),type:"exam_time",icon:"icon-datishichang",val:(0,te.xj)(s.exam_time),units:"",color:"#C08564"}]),k.abrupt("return");case 12:v.forEach(A=>{A.type==="certificate_vo"?s.certificate_vo&&s.certificate_vo.show==="true"&&(A.val=s.certificate_vo.certificate_name,h.push(A)):(A.val=s[A.type],s[A.type]!==null&&s[A.type]!==""&&(s.show_result==="true"||A.type==="exam_time")&&(A.type==="exam_time"&&(A.val=(0,te.xj)(s[A.type])),h.push(A)))}),S(h);case 14:k.next=22;break;case 16:k.prev=16,k.t0=k.catch(0),Z.Z.destroyAll(),N=k.t0.response.data.code,c=me.Z[N]?me.Z[N].content:"",c&&!me.Z[N].showErrorMessage&&Z.Z.info({title:a("common.tip"),content:e().createElement("div",null,e().createElement("p",null,c)),okText:a("common.exitBack"),onOk(){F()}});case 22:case"end":return k.stop()}},x,null,[[0,16]])})),q.apply(this,arguments)}function ne(){var x=i[f.status]?i[f.status].src:i.passed.src,u=i[f.status]?i[f.status].val:"",s=i[f.status]?i[f.status].text:"",h=i[f.status]?i[f.status].shadow:"";return f.score===f.total_score&&(x=i.full.src,u=i.full.val,s=i.full.text,h=i.full.shadow),f.show_result==="false"&&(x=i.submit.src,u="",s=i.submit.text,h=""),x=x||i.submit.src,e().createElement(e().Fragment,null,e().createElement("div",{className:"status-img"},f.status!=="pending"&&f.show_result==="true"&&e().createElement("span",{className:"scores"},f.score||0,e().createElement("span",{className:"score-point"},a("examination.point"))),f.show_result==="true"&&e().createElement("span",{className:"status-val",style:{textShadow:h}},u),e().createElement("img",{className:"img",src:x})),e().createElement("div",{className:"type-tips"},s))}function z(){_(Qe.W.examData({exam_id:m,task_id:I}),"student")}function W(){return e().createElement("div",{className:"exam-result-footer-btns"},f.show_result==="true"&&e().createElement("span",{className:"exam-data-btn",onClick:()=>z()},a("examination.testData")),e().createElement("span",{className:"close-btn",style:{backgroundColor:B},onClick:()=>F()},a("common.close")))}function R(x){return $.apply(this,arguments)}function $(){return $=(0,Y.Z)(g().mark(function x(u){var s,h;return g().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!(u.type==="certificate_vo"&&f.certificate_vo.show==="true")){c.next=15;break}return s=j.m8.location.query.exam_id,c.next=4,(0,l.P8)(s);case 4:if(h=c.sent,h.data.code!=="200000"){c.next=15;break}c.t0=h.data.data.result,c.next=c.t0==="pending"?9:c.t0==="failed"?11:c.t0==="success"?13:15;break;case 9:return ee.default.info(a("examination.certificateImagePending")),c.abrupt("break",15);case 11:return ee.default.error(a("examination.certificateImageFail")),c.abrupt("break",15);case 13:return D(h.data.data.image_url),c.abrupt("break",15);case 15:case"end":return c.stop()}},x)})),$.apply(this,arguments)}var le={size:"medium",destroyOnClose:!0,bodyStyle:{padding:"0"},maskClosable:!1,footerType:"custom"},de={title:a("common.certificate"),footer:null,size:"small",destroyOnClose:!0,maskClosable:!1,onCancel:()=>{D("")}};return e().createElement(e().Fragment,null,e().createElement(Ie.ZP,(0,Te.Z)({title:"",width:"579px"},le,{visible:d&&f.id,renderCustomFooter:W,onCancel:F}),e().createElement("div",{className:"exam-result"},e().createElement("div",null," ",ne()," "),e().createElement("div",{className:be()("exam-cards-list",v.length<3?"just-center":"")},v.map((x,u)=>e().createElement("div",{className:be()("exam-cards",u%3==2?"no-margin-right":""),key:x.type},e().createElement("div",null,e().createElement(pe.Z,{iconClass:x.icon,size:"18px",color:x.color}),e().createElement("span",{className:"title"},x.title)),e().createElement("div",{className:be()("infos","cl-text-ellipsis",x.type==="certificate_vo"?"certificate-name":""),onClick:()=>R(x)},x.val,x.units)))))),e().createElement(Ie.ZP,(0,Te.Z)({},de,{visible:E}),e().createElement("div",{className:"exam-base-info-certi"},f.certificate_vo&&e().createElement("img",{src:E,alt:""}))))}var Xe=(0,P.Z)()(Ge),Ye=T=>{var a=T.t;(0,ke.changeAntdTheme)((0,ke.generateThemeColor)(localStorage.getItem("themeColor")||"#516AE6"));var m=(0,r.useState)(!1),I=(0,O.Z)(m,2),w=I[0],d=I[1],F=(0,r.useState)(a("examination.loading")),_=(0,O.Z)(F,2),B=_[0],i=_[1],y=(0,r.useReducer)(ge.I,ge.E),o=(0,O.Z)(y,2),E=o[0],D=o[1],J=E.answerResult,Q=E.params,f=E.currentIndex,M=E.submitStatus,G=E.closeStatus,X=E.paperList,v=Q.exam_id,S=Q.task_id,U=Q.submit_id,q=Q.pageFrom,ne=(0,r.useState)(!1),z=(0,O.Z)(ne,2),W=z[0],R=z[1],$=(0,r.useRef)(null),le=(0,r.useRef)(null),de=n=>{for(var C=0;C<n.length;C++)typeof n[C]=="undefined"&&(n[C]="");return n.join("").split("").length>0?n:[]},x=n=>{if((0,te.oL)(n)==="array"){var C=n.map(p=>(0,V.Z)((0,V.Z)({},p),{},{answer_image:p.answer_image.map(oe=>oe.url)||[],answer:de(p.answer)}));return C.filter(p=>JSON.stringify(p)!=="{}")}return(0,V.Z)((0,V.Z)({},n),{},{answer_image:n.answer_image.map(p=>p.url)||[],answer:de(n.answer)})},u=()=>{window.close(),setTimeout(()=>{if(q==="myExamTask")(0,te.eJ)({url:"/personal/profile?tab=myExamTask"});else if(q==="ding_myExamTask"){var n=(void 0).props.user.enterpriseId,C=(0,te.lz)(n,"student"),p="".concat(C,"/personal/profile?tab=myExamTask");window.location.replace(p)}else j.m8.goBack()},1e3)},s=n=>{n.response.data.code&&me.Z[n.response.data.code]&&!me.Z[n.response.data.code].showErrorMessage&&(Z.Z.destroyAll(),Z.Z.warning({title:me.Z[n.response.data.code].content,className:ae()["error-confirm"],onOk:()=>{u()}}))},h=()=>{var n="";switch(M){case"screenAuto":n=a("examination.overScreenCount");break;case"timeAuto":n=a("examination.overTime");break;case"durationAuto":n=a("examination.overDuration");break;default:break}return n},N=()=>{Z.Z.warning({title:M.includes("Auto")?a("examination.AutoSaveNetworkError"):a("examination.networkError"),content:"",onOk:()=>{navigator.onLine?c():N()},okText:a("examination.reSubmitPaper"),className:ae()["error-confirm"]})},c=function(){var n=(0,Y.Z)(g().mark(function C(){var p;return g().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:window.addEventListener("offline",N),d(!0),i(a("examination.submitLoading")),p=x(J),(0,l.me)(v,{task_id:S,submit_id:U,submit_status:M.includes("Auto")?"automatic":"manual",answer_vos:p}).then(L=>{var xe=L.data.code;xe==="200000"&&(d(!1),le.current.stopTime(),$.current.stopScreen(),M.includes("Auto")?Z.Z.warning({title:a("common.tip"),content:h(),onOk:()=>{d(!0),i(a("examination.submitResultLoading")),R(!0)}}):(ee.default.success(a("examing.handUpSuccess")),d(!0),i(a("examination.submitResultLoading")),R(!0)))}).catch(L=>{d(!1),L.response&&L.response.data&&(L.response.data.code==="5001"&&(Z.Z.destroyAll(),Z.Z.warning({title:a("examination.submitPaperFail"),content:"",onOk:()=>{c()},className:ae()["error-confirm"]})),s(L))}).finally(()=>{D({type:"setSubmit",payload:""}),window.removeEventListener("offline",N),(0,l.r7)({key:"submit",msg:"New Exam: submit paper",data:{exam_id:v,task_id:S,submit_id:U,submit_status:M.includes("Auto")?"automatic":"manual",answer_vos:p}})});case 5:case"end":return b.stop()}},C)}));return function(){return n.apply(this,arguments)}}(),ie=function(){var n=(0,Y.Z)(g().mark(function C(){var p;return g().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(!M.includes("Auto")){b.next=7;break}if(Z.Z.destroyAll(),navigator.onLine){b.next=5;break}return N(),b.abrupt("return");case 5:return c(),b.abrupt("return");case 7:p=x(J).filter(L=>L.answer.length===0&&L.answer_image.length===0),p.length>0?Z.Z.confirm({title:a("examination.paperNotFinished",{count:p.length}),onOk:()=>{c()},onCancel:()=>{D({type:"setSubmit",payload:""})}}):Z.Z.confirm({title:a("examination.confirmSubmitPaper"),onOk:()=>{c()},onCancel:()=>{D({type:"setSubmit",payload:""})}});case 9:case"end":return b.stop()}},C)}));return function(){return n.apply(this,arguments)}}();(0,r.useEffect)(()=>{var n=re.parse(j.m8.location.search),C=n.exam_id,p=n.task_id,oe=n.pageFrom;D({type:"saveParams",payload:{exam_id:C,task_id:p,pageFrom:oe}})},[]),(0,r.useEffect)(()=>{M&&ie()},[M]),(0,r.useEffect)(()=>{var n=function(){var C=(0,Y.Z)(g().mark(function p(){return g().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,(0,l.Ty)(v,{task_id:S,submit_id:U,answer_vos:x(J[f])});case 2:case"end":return b.stop()}},p)}));return function(){return C.apply(this,arguments)}}();f>=0&&n()},[J,f]),(0,r.useEffect)(()=>{G&&G==="button"&&Z.Z.confirm({title:a("examination.paperConfirmExit"),content:a("examination.timeWillContinueTip"),className:ae()["error-confirm"],onOk:()=>{$.current.stopScreen(),$.current.checkQuiteStatus()&&setTimeout(()=>{u()},1e3)},onCancel:()=>{D({type:"setCloseStatus",payload:""})}})},[G]),(0,r.useEffect)(()=>{if(!(!S||!v)){var n=function(){var C=(0,Y.Z)(g().mark(function p(){return g().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:d(!0),(0,l.TM)(v,S).then(L=>{var xe=L.data,et=xe.code,Ee=xe.data;et==="200000"&&(d(!1),D({type:"initPaperInfo",payload:(0,V.Z)((0,V.Z)({},Ee),{},{remaining_time:Ee.remaining_time?Ee.remaining_time:1,exam_status:"examing"})}),D({type:"initConfig",payload:{show_tag:Ee.show_tag==="true",show_result:!1,show_upload:!0}}))}).catch(L=>{L.response&&L.response.data&&(d(!1),L.response.data.code==="5001"&&(Z.Z.destroyAll(),Z.Z.warning({title:a("examination.getPaperDataFail"),onOk:()=>{u()},className:ae()["error-confirm"]})),s(L))}).finally(()=>{(0,l.r7)({key:"load-exam-paper",msg:"New Exam: get paper info",data:{exam_id:v,task_id:S,submit_id:U}})});case 2:case"end":return b.stop()}},p)}));return function(){return C.apply(this,arguments)}}();n()}},[S,v]);function k(){R(!1),d(!1),u()}function A(n,C){try{R(!1),d(!1),C==="student"?(0,te.eJ)({url:n,actionType:"replace"}):j.m8.replace(n)}catch(p){console.error(p)}}var Ze=n=>(n.preventDefault(),!1);return e().createElement("div",{className:ae().exam,onContextMenu:Ze},e().createElement(Ke.Z,{title:a("examing.examingLabel")}),e().createElement(K.Z.Provider,{value:{state:E,dispatch:D}},X.length>0?e().createElement(e().Fragment,null,e().createElement(We,{ref:le}),e().createElement("div",{className:ae()["exam-content"]},e().createElement(Ve,null),e().createElement(Pe,null)),e().createElement(Fe,{ref:$}),e().createElement(Xe,{visible:W,examId:v,taskId:S,submitId:U,onToData:A,onCancel:k})):null),e().createElement(Z.Z,{visible:w,footer:null,wrapClassName:ae()["examing-auto-over-modal"],closable:!1,centered:!0},e().createElement(he.Z,{className:ae()["examing-auto-over-spin"]})," ",B))},qe=(0,P.Z)("translation",{withRef:!0})(Ye)},67479:function(we,ue,t){"use strict";t.d(ue,{D:function(){return V},W:function(){return ye}});var fe=t(57361),he=t(9754),ve=t.n(he),ee=t(57068),Y=t(31916),Ne=t(38642),Z=t(5430);function V(g){return O.apply(this,arguments)}function O(){return O=(0,fe.Z)(ve().mark(function g(r){var e,j,P,re,K;return ve().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.prev=0,l.next=3,(0,Y.uH)();case 3:if(e=l.sent,e!=="old"){l.next=6;break}return l.abrupt("return",!1);case 6:return l.next=8,(0,Y.fP)(r);case 8:if(j=l.sent,P=j.data,re=P.code,K=P.data,re!=="200000"){l.next=14;break}return l.abrupt("return",K.exam_type==="new");case 14:l.next=20;break;case 16:return l.prev=16,l.t0=l.catch(0),console.error("\u65B0\u65E7\u8003\u8BD5\u5224\u65AD",l.t0),l.abrupt("return",!1);case 20:case"end":return l.stop()}},g,null,[[0,16]])})),O.apply(this,arguments)}var ye={examing:function(){var g=(0,fe.Z)(ve().mark(function e(j){var P,re,K;return ve().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return P="",re=j.pageFrom==="ding_myExamTask"?(0,Ne.lz)(Z.ZP.enterpriseId,"student"):"",l.next=4,V(j.exam_id);case 4:return K=l.sent,K?P="".concat(re,"/training/examination/new-exam/examing?").concat(ee.stringify(j)):P="".concat(re,"/training/examination/exam/personal?").concat(ee.stringify(j)),l.abrupt("return",P);case 7:case"end":return l.stop()}},e)}));function r(e){return g.apply(this,arguments)}return r}(),parse:g=>"/training/examination/new-exam/parse?".concat(ee.stringify(g)),examData:g=>"/training/examination/exam-data?exam_id=".concat(g.exam_id,"&task_id=").concat(g.task_id),marking:g=>"/training/examination/new-exam/marking?".concat(ee.stringify(g))}},65202:function(we,ue,t){"use strict";t.d(ue,{p:function(){return fe}});function fe(){return localStorage.getItem("themeColor")||"#516AE6"}}}]);
