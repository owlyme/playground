(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[1086],{26096:function(ve,se,t){"use strict";var ne=t(30887),L=t(99210),ee=t(62029),y=t(22385),n=t(31097),w=t(12924),a=t.n(w),A=t(71967),M=t.n(A),R=t(1164),U=j=>j.type==="more"?j.disabled?a().createElement(L.Z.Item,(0,ee.Z)({},j,{key:j.key,disabled:!0}),j.tooltip?a().createElement(n.Z,{title:j.tooltip},a().createElement("p",{className:"cl-dropdown-menuitem"},j.title)):a().createElement("p",{className:"cl-dropdown-menuitem"},j.title)):j.link?a().createElement(L.Z.Item,(0,ee.Z)({},j,{key:j.key}),a().createElement(R.Z,{to:j.link},a().createElement("p",{className:"cl-dropdown-menuitem"},j.title))):a().createElement(L.Z.Item,(0,ee.Z)({},j,{key:j.key}),a().createElement("p",{className:"cl-dropdown-menuitem",onClick:j.click},j.title)):j.disabled?j.tooltip?a().createElement(a().Fragment,{key:j.key},a().createElement(n.Z,{title:j.tooltip},a().createElement("span",{className:"".concat(M().pointer," ").concat(M().disabled)},j.title))):a().createElement(a().Fragment,{key:j.key},a().createElement("span",{className:"".concat(M().pointer," ").concat(M().disabled)},j.title)):j.link?a().createElement(a().Fragment,{key:j.key},a().createElement(R.Z,{to:j.link},a().createElement("span",{className:"cl-pointer ".concat(M().pointer)},j.title))):a().createElement(a().Fragment,{key:j.key},a().createElement("span",{className:"cl-pointer ".concat(M().pointer),onClick:j.click},j.title));se.Z=U},30311:function(ve,se,t){"use strict";var ne=t(22385),L=t(31097),ee=t(12924),y=t.n(ee),n=t(8812),w=t(28216),a=A=>{var M=(0,w.v9)(U=>{var j=U.advancedSetting;return{themeColor:j.themeColor}}),R=M.themeColor;return y().createElement(L.Z,{placement:"top",title:A.name},y().createElement("span",{className:"cl-table__cell-arrow",onClick:A.onClick},y().createElement("span",{style:{color:R}},A.name),y().createElement("span",{className:"cl-table__cell-arrow-icon"},y().createElement(n.Z,null))))};se.Z=a},30389:function(ve,se,t){"use strict";t.d(se,{Z:function(){return $}});var ne=t(62029),L=t(20228),ee=t(11382),y=t(12924),n=t.n(y),w=t(91768),a=t(80991),A={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},M=t(62615),R=t(52670);class U extends n().Component{render(){var h=this.props,l=h.values,v=h.mode,p=h.onlyChooseDept,d=h.reserveUser,P=h.t,E=h.orgProps,O=h.rangeAuth,g=h.projectId,_=h.onCancel,V=h.onlyCreateUser;return n().createElement(a.l0,{className:"cl-form"},n().createElement(a.gN,(0,ne.Z)({component:M.ww,displayType:"Custom",showSectitle:!1,name:"employeeRange",label:P("common.visibleRange"),defaultFieldList:l.employeeRange,validate:R.FI,mode:v,rangeAuth:O,onlyChooseDept:p,onlyCreateUser:V,orgProps:E,reserveUser:d,projectId:g,onCancel:_,qwTicketShow:!0},A)))}}var j=(0,w.Z)()(U),F=t(18329),K=t(34773);class N extends n().Component{constructor(){super(...arguments);this.initRefFormik=h=>{this.refFormik=h},this.handleBeforeCreate=()=>{var h=this.refFormik;h.submitForm(),h.runValidations().then(l=>{if(!Object.keys(l).length){var v=h.state.values.employeeRange,p=(0,K.b)(v.rangeList),d={qyWeChatVo:v.qyWeChatVo,id:this.props.actionId,isAll:v.rangeType,groupIds:v.rangeType===2?p.groupIds.join(","):"",departmentIds:v.rangeType===2?p.deptIds.join(","):"",userIds:v.rangeType===2?p.userIds.join(","):"",postIds:v.rangeType===2?p.postIds.join(","):"",clusterIds:v.rangeType===2?p.clusterIds.join(","):"",qy_we_chat_vo:v.qyWeChatVo};this.props.onCreate(d)}})},this.handleBeforeCancel=()=>{var h=this.props.onCancel;h()}}render(){var h=this.props,l=h.visible,v=h.initialParams,p=h.isLoading,d=h.tipInfo,P=h.mode,E=h.onlyChooseDept,O=h.reserveUser,g=O===void 0?[]:O,_=h.t,V=h.title,S=h.orgProps,G=h.rangeAuth,Q=h.projectId,re=h.onCancel,b=h.onlyCreateUser,C=h.size;return p?n().createElement(ee.Z,{size:"large"}):n().createElement(F.ZP,{wrapClassName:"cl-employee-selector-modal",visible:l,title:V||_("component.changeUser"),okText:_("common.ok"),cancelText:_("common.cancel"),size:C,onCancel:this.handleBeforeCancel,onOk:this.handleBeforeCreate},p?n().createElement(ee.Z,{size:"large"}):n().createElement(a.J9,{ref:this.initRefFormik,initialValues:v,render:f=>n().createElement(j,(0,ne.Z)({},f,{mode:P,rangeAuth:G,orgProps:S,onlyChooseDept:E,onlyCreateUser:b,reserveUser:g,projectId:Q,onCancel:re}))}),d&&n().createElement("p",{style:{padding:"0 24px",wordBreak:"break-all",whiteSpace:"normal"}},d))}}N.defaultProps={visible:!1,initialParams:{employeeRange:{rangeType:1,rangeList:{dept:[],post:[],group:[],user:[],cluster:[]}}},tipInfo:"",isLoading:!1,mode:["all","part"],onlyChooseDept:!1,onlyCreateUser:!1,orgProps:{},onCancel:()=>{},onCreate:()=>{},size:"middle"};var $=(0,w.Z)()(N)},42837:function(ve,se,t){"use strict";var ne=t(12924),L=t.n(ne),ee=t(91768),y=t(28216),n=t(66708),w=t(18329);class a extends L().Component{render(){var M=this.props,R=M.visible,U=M.onCancel,j=M.title,F=M.t;return R?L().createElement(w.ZP,{visible:R,width:"400",footer:null,title:j||F("common.QRCodeScan"),bodyStyle:{minWidth:430},onCancel:U,destroyOnClose:!0},L().createElement(n.Z,this.props)):null}}se.Z=(0,y.$j)()((0,ee.Z)()(a))},74525:function(ve,se,t){"use strict";var ne=t(57361),L=t(34792),ee=t(48086),y=t(9754),n=t.n(y),w=t(12924),a=t.n(w),A=t(91768),M=t(28216),R=t(92592),U=t(5430),j=t(10237),F=t(84874),K=t(16239),N=t(38642),$=t(28963);class q extends a().Component{constructor(l){var v;super(l);v=this,this.appId=sessionStorage.getItem("CL_E_APP_ID"),this.miniAppId=sessionStorage.getItem("CL_MINI_APP_ID"),this.initCode=()=>{var p=this.props,d=p.type,P=p.isProjectShare,E=p.isCommodityExchange,O=p.userInfo;["wx","weixin"].includes(d)?d==="weixin"&&O.appId==="9005"?this.initOtherCode():this.initWXCode():P&&d==="ding"?this.getProjectShareUrl():E&&d==="ding"?this.getCommodityExchangeUrl():d==="fullWebLink"?this.initOtherCode(this.props.option.scene):this.initOtherCode()},this.getCommodityExchangeUrl=()=>{var p=this.props,d=p.t,P=p.appType,E=p.orderId,O=this.props.option.scene,g=localStorage.getItem("uid");if(!K.Z[(0,K.c)()].showCl||P!=="e_app"){var _={deliverUserId:g,orderId:E,flag:"exchange"};R.toDataURL(JSON.stringify(_),{width:500}).then(Q=>{this.setState({img:Q})}).catch(()=>{ee.default.error(d("integralMall.qrCodeFailed"))})}else{var V="/pages/messageRedirect/messageRedirect?".concat(O),S=encodeURIComponent(V),G="dingtalk://dingtalkclient/action/open_micro_app/=questionMark=/appId=".concat(this.appId,"&pVersion=1&miniAppId=").concat(this.miniAppId,"&packageType=1&page=").concat(S,"&corpId=").concat(this.props.userInfo.corpId);this.getShortLink(G).then(Q=>{R.toDataURL(Q.data.short_link,{width:500}).then(re=>{this.setState({img:re})}).catch(()=>{ee.default.error(d("integralMall.qrCodeFailed"))})})}},this.getProjectShareUrl=()=>{var p=this.props.option.scene,d=encodeURIComponent("/pages/messageRedirect/messageRedirect?".concat(p)),P="dingtalk://dingtalkclient/action/open_micro_app/=questionMark=/corpId=".concat(this.props.userInfo.corpId,"&appId=").concat(this.appId,"&miniAppId=").concat(this.miniAppId,"&page=").concat(d);this.getShortLink(P).then(E=>{this.initOtherCode(E.data.short_link)})},this.getShortLink=p=>j.WY.post({url:U.ZP.Common.getQrUrl(),data:{link:p}}),this.initWXCode=(0,ne.Z)(n().mark(function p(){var d,P,E,O;return n().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return d=v.props.option,P=d.scene,E=d.flag,_.next=3,j.WY.post({url:U.ZP.createWxCode(),data:{flag:E,scene:"".concat(P,"&enterpriseId=").concat(U.ZP.enterpriseId),enterprise_id:U.ZP.enterpriseId}});case 3:O=_.sent,v.setState({img:O.data.wx_code,linkUrl:"data:image/png;base64,".concat(O.data.wx_code)});case 5:case"end":return _.stop()}},p)})),this.initOtherCode=function(){var p=(0,ne.Z)(n().mark(function d(P){var E,O,g,_;return n().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(E=v.props,O=E.type,g=E.fsUrl,S.t0=P,S.t0){S.next=6;break}return S.next=5,v.handleScanCode();case 5:S.t0=S.sent;case 6:_=S.t0,O==="fs"&&g&&(_=g),v.setState({linkUrl:_}),R.toDataURL(_,{width:500}).then(G=>{v.setState({img:G})}).catch(()=>{ee.default.error(v.props.t("personal.failedGenerateCode"))});case 10:case"end":return S.stop()}},d)}));return function(d){return p.apply(this,arguments)}}(),this.handleScanCode=(0,ne.Z)(n().mark(function p(){var d,P,E,O,g,_,V,S,G,Q,re,b,C,f,x,z,W,ie;return n().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(d=v.props,P=d.type,E=d.userInfo,O=d.universalFn,g=v.state.wxH5Url,_=v.props.option,V=_.scene,S=_.pc_url,G=S===void 0?"":S,Q=_.mobile_url,re=Q===void 0?"":Q,b=_.pc_type,C=b===void 0?"":b,f=_.mobile_type,x=f===void 0?"":f,z=encodeURIComponent("/pages/messageRedirect/messageRedirect?"),W=encodeURIComponent(V),!O){H.next=12;break}return H.next=8,v.getShortLink((0,N.jr)({pc_url:G,mobile_url:re,pc_type:C,mobile_type:x}));case 8:return ie=H.sent,H.abrupt("return",(0,$.fZ)(ie.data.short_link));case 12:H.t0=P,H.next=H.t0==="app"?15:H.t0==="ding"?16:H.t0==="fs"?17:H.t0==="weixin"?18:19;break;case 15:return H.abrupt("return","".concat(V,"&fromApp=true"));case 16:return H.abrupt("return","dingtalk://dingtalkclient/action/open_micro_app?corpId=".concat(E.corpId,"&appId=").concat(v.appId,"&miniAppId=").concat(v.miniAppId,"&packageType=1&pVersion=1&page=").concat(z+W));case 17:return H.abrupt("return","https://applink.feishu.cn/client/web_app/open?appId=".concat("cli_a0aa5e0fe5f8500d","&path=").concat(encodeURIComponent("/index.html"),"&").concat(V,"&appType=lark"));case 18:return H.abrupt("return","".concat(g,"/#/pages/login/login-we-com/index?appType=weCom&corp=").concat(E.corpId,"&").concat(V));case 19:return H.abrupt("return","");case 20:case"end":return H.stop()}},p)})),this.saveQrcode=()=>{var p=this.state.img,d=this.props,P=d.type,E=d.t,O=d.userInfo,g=document.createElement("a");g.download=E("setting.Qrcode")+new Date().getTime(),g.href=P==="wx"||P==="weixin"&&O.appId!=="9005"?"data:image/png;base64,".concat(p):p,document.body.appendChild(g),g.click(),document.body.removeChild(g)},this.generatePoster=p=>{var d=p.linkUrl,P=p.type,E=p.activeKey,O=p.option,g=this.props.universalFn;typeof g=="function"&&g({linkUrl:d,type:P,activeKey:E,option:O})},this.state={img:"",linkUrl:"",wxH5Url:"https://mobile.coolcollege.cn"}}componentDidMount(){this.initCode()}componentDidUpdate(l){l.option.scene!==this.props.option.scene&&this.initCode()}render(){var l=this.props,v=l.type,p=l.tip,d=l.extraTip,P=l.t,E=l.canSave,O=l.refreshQrCode,g=l.label,_=l.saveText,V=_===void 0?"":_,S=l.downloadAsBtn,G=l.userInfo,Q=l.universalFn,re=l.activeKey,b=l.option,C=this.state,f=C.img,x=C.linkUrl,z=localStorage.getItem("themeColor")||"#465dcd";return f?a().createElement("div",{className:"qr-code-content"},g?a().createElement("div",{className:"label-text"},g,":"):null,a().createElement("div",{className:"qr-code-div ".concat(g?"left":"")},v==="wx"||v==="weixin"&&G.appId!=="9005"?a().createElement("img",{src:"data:image/png;base64,".concat(f),alt:""}):a().createElement("img",{src:f,alt:""}),p?a().createElement("div",{className:"tip-text"},p):null,d?a().createElement("div",{className:"tip-text"},d):null,E?a().createElement("div",{className:"save_qrcode ".concat(S?"save-btn":""),style:{color:z},onClick:()=>this.saveQrcode()},S?null:a().createElement(F.Z,{iconClass:"icon-f-download",size:"14px"}),V||P("personal.saveCode")):null,Q&&!O?a().createElement("div",{className:"save_qrcode",style:{color:z},onClick:()=>this.generatePoster({linkUrl:x,type:v,activeKey:re,option:b})},P("personal.saveCodePoster")):null,O?a().createElement("div",{className:"save_qrcode",style:{color:z},onClick:()=>O()},a().createElement(F.Z,{iconClass:"iconf-switch",size:"14px"}),P("personal.refreshCodeTip")):null)):a().createElement("div",{className:"qr-code-placeholder"})}}se.Z=(0,M.$j)(h=>{var l=h.user;return{userInfo:l,appType:l.appType,corpId:l.corpId}})((0,A.Z)()(q))},66708:function(ve,se,t){"use strict";var ne=t(93485),L=t(33565),ee=t(57361),y=t(18106),n=t(88108),w=t(9754),a=t.n(w),A=t(12924),M=t.n(A),R=t(91768),U=t(28216),j=t(89366),F=t(48194),K=t(74525),N=t(77779),$=t.n(N),q=t(6793),h=n.Z.TabPane;class l extends M().Component{constructor(d){var P;super(d);P=this,this.initAppTypeScan=(0,ee.Z)(a().mark(function O(){var g,_,V,S,G,Q,re,b,C,f,x;return a().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return W.next=2,Promise.all([(0,F.q)(),(0,F.$)()]);case 2:g=W.sent,_=(0,L.Z)(g,2),V=_[0],S=_[1],G=V.data.sync_organizes,Q=S.data.list,re=!1,b=(0,ne.Z)(Q),W.prev=10,b.s();case 12:if((C=b.n()).done){W.next=19;break}if(f=C.value,f.type!=="wechat_applet_setting"){W.next=17;break}return re=f.switch_status==="OPEN",W.abrupt("break",19);case 17:W.next=12;break;case 19:W.next=24;break;case 21:W.prev=21,W.t0=W.catch(10),b.e(W.t0);case 24:return W.prev=24,b.f(),W.finish(24);case 27:x=P.props.universalFn?P.filterOrganizes(G):P.filterCode(G),re&&x.push("wx"),P.setState({scanTypes:x});case 30:case"end":return W.stop()}},O,null,[[10,21,24,27]])})),this.filterCode=O=>{var g=[...O],_=this.props.option;return g=g.map(V=>["third_oa_app","seeyon_app"].includes(V)?"ding":V),_&&_.flag==="exam_task"?[...new Set([...g])].filter(V=>V==="fs"):[...new Set([...g,"app"])]},this.filterOrganizes=O=>{var g=[...O],_=this.props.option;g=g.map(S=>["third_oa_app","seeyon_app"].includes(S)?"ding":S);var V=new Set([...g]);return V.size===1&&V.has("app")?_&&_.flag==="exam_task"?[...V].filter(S=>S==="fs"):[...V]:(V.delete("app"),_&&_.flag==="exam_task"?[...V].filter(S=>S==="fs"):[...V])};var E=d.t;this.state={scanTypes:[],commonTitle:{ding:E("common.sanCodeCommon"),fs:E("common.sanCodeCommon"),weixin:E("common.sanCodeCommon"),app:E("common.sanCodeCommon"),wx:E("common.weChatApplets")},tabTitle:{ding:E("common.dingDingSanCode"),fs:E("common.fsScanCode"),weixin:E("common.WeComSanCode"),app:E("common.appScanCode"),wx:E("common.wxScanCode")}}}componentDidMount(){this.initAppTypeScan()}UNSAFE_componentWillReceiveProps(){this.initAppTypeScan()}render(){var d=this.state,P=d.tabTitle,E=d.commonTitle,O=d.scanTypes,g=this.props,_=g.option,V=g.tip,S=g.t,G=g.extraTip,Q=g.canSave,re=g.refreshQrCode,b=g.isCommodityExchange,C=g.type,f=g.center,x=f===void 0?!0:f,z=g.label,W=z===void 0?"":z,ie=g.saveText,oe=g.downloadAsBtn,H=oe===void 0?!1:oe,T=g.transfer,I=T===void 0?!1:T,u=g.source_type,k=g.universalFn,B=g.activeKey;return M().createElement("div",{className:"".concat($()["scan-code-box"]," ").concat(C==="card"?$()["card-tabs"]:"")},O.length===1?M().createElement(K.Z,{universalFn:k,activeKey:B,type:O[0],option:_,tip:(0,q.ZT)(S(V),k?E[O[0]]:P[O[0]]),extraTip:G,canSave:Q,fsUrl:_.fsUrl,refreshQrCode:re,isCommodityExchange:b,label:W,saveText:ie,downloadAsBtn:H}):M().createElement(n.Z,{defaultActiveKey:"1",centered:x,type:C},O.map((D,ae)=>{var Y=ae+1;return M().createElement(h,{tab:k?E[D]:P[D],key:Y},I&&M().createElement("div",{className:$()["scan-code-transfer"]},M().createElement(j.Z,null),M().createElement("span",null,S("course.onlyScope",{source_type:S(u==="study_project"?"lineClass.project":"lineClass.task")}))),M().createElement(K.Z,{universalFn:k,activeKey:B,type:D,option:_,tip:(0,q.ZT)(S(V),k?E[D]:P[D]),extraTip:G,canSave:Q,fsUrl:_.fsUrl,refreshQrCode:re,isCommodityExchange:b,label:W,saveText:ie,downloadAsBtn:H}))})))}}l.defaultProps={option:{flag:"",scene:""},tip:"",extraTip:"",canSave:!0,refreshQrCode:null};var v=p=>({appType:p.user.appType});se.Z=(0,U.$j)(v)((0,R.Z)()(l))},16598:function(ve,se,t){"use strict";var ne=t(59250),L=t(13013),ee=t(30887),y=t(99210),n=t(62029),w=t(12924),a=t.n(w),A=t(57254),M=t(91768),R=t(26096),U=(F,K)=>{var N=F.map($=>a().createElement(R.Z,(0,n.Z)({},$,{type:K,key:$.key||$.type})));return K==="more"?a().createElement(y.Z,null,N):N},j=F=>{var K=F.buttons,N=F.t,$=F.visibleNum,q=K.filter(p=>p.visible),h=$||1,l=[],v=[];if(q.length<=h)v=[...q];else if(q.length>h)v=[...q.slice(0,h)],l=[...q.slice(h)];else return"/";return a().createElement("div",{className:"cl-table__cell-action"},U(v),v.some(p=>p.visible)&&l.some(p=>p.visible)?a().createElement(a().Fragment,null,a().createElement("span",{className:"cl-pointer-divide"}),a().createElement(L.Z,{overlay:U(l,"more")},a().createElement("span",{className:"cl-pointer"},N("common.more")," ",a().createElement(A.Z,null)))):null)};j.defaultProps={visibleNum:1},se.Z=(0,M.Z)()(j)},26697:function(ve,se,t){"use strict";var ne=t(71194),L=t(57016),ee=t(57663),y=t(71577),n=t(34792),w=t(48086),a=t(57361),A=t(9754),M=t.n(A),R=t(12924),U=t.n(R),j=t(91768),F=t(10237),K=t(28216),N=t(37055);class $ extends U().Component{constructor(h){var l;super(h);l=this,this.dealData=()=>{this.setState({recordList:this.props.record})},this.getPostTree=(0,a.Z)(M().mark(function v(){var p;return M().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,F.WY.get({url:N.ZP.LibraryList.listByLevel(),params:{level:2,is_layered:"true"}});case 2:p=P.sent,p&&l.setState({treeData:p.data});case 4:case"end":return P.stop()}},v)})),this.AIsure=function(){var v=(0,a.Z)(M().mark(function p(d){var P,E;return M().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return P=[],l.state.recordList.forEach(_=>{_.ai_resources.forEach(V=>{(V.ai_upgrade_status==="not"||V.ai_upgrade_status==="ai_failed")&&P.push({classify_id:d?V.categoryId:"",resourceId:V.resource_id,course_id:_.course_id})})}),g.next=4,F.WY.post({url:N.ZP.LibraryList.batchSubmit(),data:{resourceClassifyVoList:P}});case 4:E=g.sent,E&&(w.default.success(l.props.t("study.operateSuccess")),l.props.onCancel(!d));case 6:case"end":return g.stop()}},p)}));return function(p){return v.apply(this,arguments)}}(),this.handleChange=(v,p)=>{var d=[];d=this.state.recordList.map(P=>{var E=P;return E.ai_resources.map(O=>{var g=O;return O.resource_id===p.resource_id&&(g.categoryId=g.categoryId==v.id?"":v.id),g}),E}),this.setState({recordList:d})},this.state={recordList:[],treeData:[]},this.operateResourceItem=""}componentDidMount(){this.dealData(),this.getPostTree()}render(){var h=localStorage.getItem("themeColor")||"#465dcd";return U().createElement(L.Z,{title:"".concat(this.props.t("course.chooseAICategory")),visible:this.props.visible,onCancel:()=>this.props.onCancel(),className:"AIAllCourseModal",width:900,footer:null},this.props.visible&&U().createElement("div",{className:"AI-course-modal"},U().createElement("p",null,this.props.t("course.AIValue")),U().createElement("p",null,this.props.t("course.AITip")),U().createElement("div",{className:"AICategory-main"},this.state.recordList.map(l=>U().createElement("ul",{className:"AI-course-list"},l.ai_resources.map(v=>U().createElement("li",null,U().createElement("div",{className:"course-list-name"},v.name),this.state.treeData.map(p=>p.children.length?U().createElement("div",{className:"tabs-box"},U().createElement("p",null,p.name,"\uFF1A"),U().createElement("ul",{className:"tabs"},p.children.map(d=>U().createElement("li",{onClick:()=>this.handleChange(d,v),className:v.categoryId===d.id?"active":"",style:v.categoryId===d.id?{backgroundColor:h}:{}},d.name)))):null)))))),U().createElement("div",{className:"cl-form-fixed-footer__container"},U().createElement(y.Z,{className:"form-page-container-bottom-btn",onClick:()=>this.props.onCancel()},this.props.t("common.cancel")),U().createElement(y.Z,{type:"primary",onClick:()=>this.AIsure(!0)},this.props.t("course.AICut")),U().createElement(y.Z,{type:"primary",onClick:()=>this.AIsure()},this.props.t("course.ManualCut")))))}}se.Z=(0,K.$j)()((0,j.Z)()($))},63848:function(ve,se,t){"use strict";var ne=t(36877),L=t(32969),ee=t(12924),y=t.n(ee),n=t(91768),w=t(56130);class a extends y().PureComponent{constructor(){super(...arguments);this.onChange=(M,R)=>{this.props.onChange(M,R)}}render(){var M=this.props,R=M.value,U=M.classify,j=M.showLabel,F=M.className,K=M.t,N=M.style;return y().createElement("div",{className:"classify-cascader ".concat(F)},j?y().createElement("span",{className:"classify-cascader-label"},K("component.selectClassifyLabel")):null,y().createElement(L.Z,{changeOnSelect:this.props.changeOnSelect,className:"classify-cascader-select ".concat(F),options:U,onChange:this.onChange,placeholder:K("component.selectClassifyLabel"),value:R,style:N,loadData:this.props.loadData}))}}a.defaultProps={showLabel:!0,changeOnSelect:!0,onChange:()=>{}},se.Z=(0,w.Z)((0,n.Z)()(a))},51697:function(ve,se,t){"use strict";var ne=t(22385),L=t(31097),ee=t(33565),y=t(12924),n=t.n(y),w=t(28216),a=t(84874),A=R=>{var U=R.title,j=R.visible,F=R.placement,K=F===void 0?"top":F,N=R.children,$=N===void 0?null:N,q=R.isNewUser,h=q===void 0?"":q,l=R.closeGuide,v=R.guideStatus,p=(0,y.useState)(!1),d=(0,ee.Z)(p,2),P=d[0],E=d[1],O=V=>n().createElement("div",{className:"guide-tooltip-title"},V,n().createElement("span",{onClick:g},n().createElement(a.Z,{iconClass:"icon-f-close",size:"12px",color:"#fff"})));(0,y.useEffect)(()=>{E(j)},[j]);var g=V=>{if(V.stopPropagation(),V.preventDefault(),E(!1),l){l();return}h==="true"&&R.dispatch({type:"shouldRenderHeaderGuide",payload:{headerGuideStatus:!0}}),_()},_=()=>{localStorage.setItem("guideStatus","false"),R.dispatch({type:"updateGuideStatus",payload:{guideStatus:"false"}})};return n().createElement(L.Z,{title:O(U),placement:K,visible:P&&v==="true"&&U},$)},M=R=>({guideStatus:R.advancedSetting.guideStatus,isNewUser:R.advancedSetting.isNewUser});se.Z=(0,w.$j)(M)(A)},59857:function(ve,se,t){"use strict";var ne=t(22385),L=t(31097),ee=t(12924),y=t.n(ee);class n extends y().Component{render(){var a=this.props,A=a.name,M=a.full_name,R=a.maxWidth;return y().createElement(L.Z,{title:M},y().createElement("span",{className:"component-resource-category",style:{maxWidth:R||"160px"}},A))}}se.Z=n},54792:function(ve,se,t){"use strict";var ne=t(62029),L=t(63185),ee=t(9676),y=t(47673),n=t(4107),w=t(88986),a=t(12924),A=t.n(a),M=t(91768),R=t(59239),U=t(55446),j=t.n(U),F=t(18329),K=t(2396);class N extends A().Component{constructor(){super(...arguments);this.state={isChecked:!1},this.handleBeforeCreate=()=>{var h=this.props,l=h.form,v=h.id,p=h.onCreate,d=this.state.isChecked;l.validateFields((P,E)=>{if(!P){var O=(0,w.Z)({},E);d||(O.value=0);var g=(0,w.Z)((0,w.Z)({},O),{},{id:v});p(g),setTimeout(()=>{l.resetFields()},100)}})},this.handleBeforeCancel=()=>{var h=this.props,l=h.form,v=h.onCancel;v(),setTimeout(()=>{l.resetFields()},100)},this.checkScore=(h,l,v)=>{var p=this.props.t,d=this.state.isChecked;if(d&&(0,K.kh)(l)){v(p("component.setScoreRuleTip"));return}v()},this.handleCheckChange=h=>{this.setState({isChecked:h.target.checked})},this.renderItem=()=>{var h=this.props,l=h.form,v=h.initialValue,p=h.labelTxt,d=this.state.isChecked,P=l.getFieldDecorator,E={labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:18}}},O=d?P("value",{initialValue:v,rules:[{validator:this.checkScore}]})(A().createElement(n.Z,{maxLength:30,placeholder:""})):null,g=A().createElement(A().Fragment,null,A().createElement(ee.Z,{checked:d,onChange:this.handleCheckChange},p));return A().createElement(R.Z.Item,(0,ne.Z)({label:g},E),O)}}componentDidUpdate(h){this.props.visible&&this.props.visible!==h.visible&&this.setState({isChecked:!!this.props.initialValue})}render(){var h=this.props,l=h.visible,v=h.title,p=h.prefixCls;return A().createElement(F.ZP,{size:"small",visible:l,title:v,onCancel:this.handleBeforeCancel,onOk:this.handleBeforeCreate},A().createElement(R.Z,{className:"".concat(p),layout:"horizontal",colon:!1},this.renderItem(),A().createElement("div",{className:"".concat(p,"__children")},this.props.children)))}}N.defaultProps={prefixCls:"cl-setscore",id:"",visible:!1,title:"SetScore",labelTxt:"",initialValue:"",onCancel:()=>{},onCreate:()=>{}};var $=R.Z.create({name:"ClSetupBoxInModal"})(N);se.Z=(0,M.Z)()($)},11449:function(ve,se,t){"use strict";t.d(se,{Z:function(){return V}});var ne=t(88986),L=t(33565),ee=t(12924),y=t.n(ee),n=t(3115),w=t(49111),a=t(19650),A=t(62029),M=t(57663),R=t(71577),U=t(91768),j=t(28216),F=t(37055),K=t(10237);function N(S){var G=F.ZP.getHelpContentByMenuKey(),Q={key:S};return K.WY.get({url:G,params:Q})}var $=t(74228),q=t.n($),h=t(1164),l=t(76466),v=t(38642);class p extends y().Component{constructor(G){var Q;super(G);Q=this,this.getHelpContentByMenuKey=()=>{var re=this.props.defaultMenuKey;N(re).then(b=>{var C=b.data,f=C.help_url,x=C.video_url;this.setState({videoUrl:x,helpUrl:f})})},this.handleOpenHelpUrl=re=>{if((0,v.ve)()){window.open(re,"_blank");return}h.Z.targetTo({path:re,isExternalLink:!0})},this.handleOpenVideo=function(re){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Q.props.t("helpCenter.video");Q.setState(C=>({resourcePlayInfo:(0,ne.Z)((0,ne.Z)({},C.resourcePlayInfo),{},{resourceInfo:{originUrl:re,source:{FD:re,OD:re},contentType:"mp4"}}),previewInfo:(0,ne.Z)((0,ne.Z)({},C.previewInfo),{},{title:b,visible:!0,onCancel:Q.handleCancelPreview})}))},this.handleCancelPreview=()=>{var re=this.state.previewInfo;this.setState({resourcePlayInfo:{mode:"preview",watchType:"video",resourceInfo:{}},previewInfo:(0,ne.Z)((0,ne.Z)({},re),{},{visible:!1})})},this.state={helpUrl:"",videoUrl:"",resourcePlayInfo:{autoPlay:!0,draggable:!0,mode:"preview",resourceInfo:{},watchType:"video"},previewInfo:{visible:!1,destroyOnClose:!0,title:G.t("helpCenter.video")||"\u89C6\u9891\u6307\u5BFC",onCancel:()=>{}}}}componentDidMount(){this.getHelpContentByMenuKey()}render(){var G=this.state,Q=G.helpUrl,re=G.resourcePlayInfo,b=G.previewInfo,C=G.videoUrl,f=this.props.t;return y().createElement("div",{className:q().helpCenter},C&&y().createElement(R.Z,{type:"link",className:q()["video-btn"],style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenVideo(C)},f("helpCenter.video")),Q&&y().createElement(R.Z,{type:"link",style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenHelpUrl(Q)},f("helpCenter.tutorial")),y().createElement(l.Z,(0,A.Z)({},re,{previewInfo:b})))}}var d=S=>({defaultMenuKey:S.currentRoute.menuKey});p.defaultProps={defaultMenuKey:""};var P=(0,j.$j)(d)((0,U.Z)()(p));function E(S){var G=S.extra,Q=localStorage.getItem("dingPersonnel"),re=sessionStorage.getItem("dingPersonnel");return y().createElement(a.Z,null,G,Q!=="dingPersonnel"&&re!=="dingPersonnel"&&(0,v.eY)("COMMONEXTRA_HELP_CENTER")&&y().createElement(P,null))}var O=E,g=t(4408);function _(S){var G=(0,ee.useState)({helpCenter:(0,v.eY)("HEAD_HELP_CENTER_BUT")}),Q=(0,L.Z)(G,1),re=Q[0],b=S.pageContainerParams,C=b===void 0?{}:b,f=S.noPadding,x=f===void 0?!1:f,z=S.isPersonal,W=z===void 0?!1:z,ie=S.pageTitle,oe=S.className,H=oe===void 0?"":oe,T={extra:re.helpCenter?y().createElement(O,{extra:C.extra}):C.extra},I=(0,ne.Z)((0,ne.Z)({},C),T);return y().createElement("div",{className:"page-container-content ".concat(x?"page-container-noPadding":""," ").concat(W?"page-container-content_personal_background":""," ").concat(H)},ie&&y().createElement(g.Z,{title:ie}),W?y().createElement(n.Z,null,S.children):y().createElement(n.Z,I,S.children))}var V=_},72456:function(ve,se,t){"use strict";var ne=t(49111),L=t(19650),ee=t(57663),y=t(71577),n=t(12924),w=t.n(n),a=t(28216),A=t(91768),M=t(84391),R=t(90631),U=t(49101),j=t(76651),F=t(31945),K=t(1164),N=t(51697),$=h=>{var l=h.user,v=h.currentRoute,p=h.advancedSetting;return{currentPath:v.path,allAuthRoutes:v.allAuthRoutes,userLng:l.lng,themeColor:p.themeColor,qyShield:l.qyShield}};class q extends w().Component{constructor(){super(...arguments);this.handleDownload=()=>{this.props.onDownload()},this.handleImport=()=>{this.props.onImport()},this.handleCreate=()=>{var l=this.props.tabLink;j.m8.push(l)},this.renderActionBtn=()=>{var l=this.props,v=l.prefixCls,p=l.actionText,d=l.t,P=l.tabLink,E=l.showBtn,O=l.renderActionBtn,g=l.newPage,_=l.popOverProps,V=_===void 0?[]:_,S=l.renderGuide,G=S===void 0?!1:S,Q=l.showDownloadBtn,re=Q===void 0?!1:Q,b=l.showImportBtn,C=b===void 0?!1:b,f=l.showCreateBtn,x=f===void 0?!0:f,z=l.rowReverse,W=z===void 0?!1:z,ie="".concat(v,"__action");if(!E&&O&&typeof O=="function")return w().createElement("div",{className:ie},O());if(!E||!p)return null;var oe=V.length?V[0].contentText:"";return w().createElement("div",{className:"".concat(ie," ").concat(W&&"row-reverse")},w().createElement(L.Z,{size:16},re&&w().createElement(y.Z,{icon:w().createElement(M.Z,null),onClick:this.handleDownload},d("common.exportData")),C&&w().createElement(y.Z,{icon:w().createElement(R.Z,null),onClick:this.handleImport},d("exam.importTemplate")),x&&g&&w().createElement(K.Z,{to:P},w().createElement(N.Z,{visible:oe&&G,placement:"topLeft",title:oe},w().createElement(y.Z,{type:"primary",id:"create-project-button",icon:w().createElement(U.Z,null)},p))),x&&!g&&w().createElement(y.Z,{type:"primary",id:"create-project-button",icon:w().createElement(U.Z,null),onClick:this.handleCreate},p)))},this.renderQueryRow=()=>{var l=this.props,v=l.queryRowParams,p=l.queryRowList,d=l.queryRowSelectedCourseIds,P=l.queryRowSelectedProjectIds,E=l.queryRowOnForceRender,O=l.queryRowOnClassifyChange,g=l.queryRowOnTypeChange,_=l.queryRowOnCourseTypeChange,V=l.queryRowAllowActions,S=l.showNum,G=S===void 0?1:S;return w().createElement(F.Z,{params:v,list:p,selectedCourseIds:d,selectedProjectIds:P,onForceRender:E,onClassifyChange:O,onTypeChange:g,onCourseTypeChange:_,allowActions:V,showNum:G,showRenderCondition:!1})},this.rendeExtraBtn=()=>{var l=this.props,v=l.t,p=l.extraBtnSelectedRowKeys,d=l.extraBtnHandleMultiVisibleRange;return w().createElement(y.Z,{disabled:p.length===0,onClick:d},v("courseManage.setTheVisibility"))}}render(){var l=this.props,v=l.prefixCls,p=l.wrapCls,d=l.showRenderQueryRow,P=l.showRendeExtraBtn;return w().createElement(w().Fragment,null,w().createElement("div",{className:"render_other"},w().createElement("header",{className:"".concat(v," ").concat(p)},w().createElement("section",{className:"".concat(v,"__radiocol")},this.renderActionBtn(),d&&this.renderQueryRow(),P&&this.rendeExtraBtn()))))}}q.defaultProps={prefixCls:"cl-listQueryRow",wrapCls:"",label:"",actionText:"add",showSearch:!0,showBtn:!0,newPage:!0,searchStylesProps:{},selectList:[],renderActionBtn:()=>null},se.Z=(0,a.$j)($)((0,A.Z)()(q))},62117:function(ve,se,t){"use strict";var ne=t(63185),L=t(9676),ee=t(43358),y=t(34041),n=t(88983),w=t(47933),a=t(12924),A=t.n(a),M=t(28216),R=t(91768),U=t(48479),j=t(2971),F=t(45601),K=t(7249),N=q=>{var h=q.user,l=q.currentRoute,v=q.advancedSetting;return{currentPath:l.path,allAuthRoutes:l.allAuthRoutes,userLng:h.lng,themeColor:v.themeColor,appType:h.appType,appId:h.appId}};class $ extends A().Component{constructor(h){super(h);this.setPlaceholder=()=>{var l=this.props,v=l.currentPath,p=l.allAuthRoutes,d=l.userLng,P=this.state.language,E=p[v],O=this.props,g=O.appType,_=O.appId,V=localStorage.getItem("qyWechatBook"),S=g==="wx_app"&&V==="true"&&_==="9005";if(!!E){var G=P[d].searchInputPlaceholder,Q="";E.menuKey==="studyTemplate"||E.menuKey==="examTemplate"?Q=G.template:E.menuKey==="employee"||E.menuKey==="obligatory"||E.menuKey==="elective"||E.menuKey==="plan"||E.menuKey==="evaluation"||E.menuKey==="myEvaluationPlan"?Q=G.task:E.menuKey==="studyProject"?Q=S?G.byProjectName:G.byProjectNameOrCreator:E.menuKey==="management"?Q=S?G.byTaskName:G.byTaskNameOrCreator:Q=G[E.menuKey],this.setState({currentPlaceholder:Q})}},this.handleRadiosChange=l=>{this.props.onRadiosChange(l.target.value)},this.handleSelectChange=l=>{this.props.onSelectChange(l)},this.handleSearch=(l,v)=>{this.props.onSearch(l,v)},this.handleChange=l=>{this.props.onCheckboxChange(l.target.checked)},this.renderRadios=()=>{var l=this.props,v=l.prefixCls,p=l.radioList,d=l.defaultRadioValue,P=l.radioValue;if(!p.length)return null;var E=d||p[0].value,O="".concat(v,"__radios");return A().createElement("div",{className:O},typeof P!="undefined"?A().createElement(w.ZP.Group,{defaultValue:E,value:P,onChange:this.handleRadiosChange},p.map(g=>A().createElement(w.ZP.Button,{key:g.value,value:g.value},g.name))):A().createElement(w.ZP.Group,{defaultValue:E,onChange:this.handleRadiosChange},p.map(g=>A().createElement(w.ZP.Button,{key:g.value,value:g.value},g.name))))},this.renderSelect=()=>{var l=this.props,v=l.prefixCls,p=l.selectList,d=l.defaultSelectValue;if(!p.length)return null;var P=d||p[0].value,E="".concat(v,"__select");return A().createElement("div",{className:E},A().createElement(y.Z,{defaultValue:P,onChange:this.handleSelectChange,style:{minWidth:100}},p.map(O=>A().createElement(y.Z.Option,{key:O.value,value:O.value},O.name))))},this.renderOther=()=>{var l=this.props,v=l.prefixCls,p=l.renderOther,d=l.showOther,P="".concat(v,"__other");if(d&&p&&typeof p=="function")return A().createElement("div",{className:P},p())},this.renderCheckbox=()=>{var l=this.props,v=l.prefixCls,p=l.t,d=l.label,P=l.showCheckbox,E=l.renderActionSelect,O="".concat(v,"__checkbox");return!P&&E&&typeof E=="function"?A().createElement("div",{className:O},E()):P?A().createElement("div",{className:O},A().createElement(L.Z,{onChange:this.handleChange},d||p("common.myCreated"))):null},this.renderSearch=()=>{var l=this.props,v=l.prefixCls,p=l.showSearch,d=l.inputPlaceholder,P=l.maxLength,E=P===void 0?400:P,O=l.value,g="".concat(v,"__search");if(!p)return null;var _=this.state.currentPlaceholder;return d?A().createElement("div",{className:g},A().createElement(U.Z,{onSearch:this.handleSearch,placeholder:d,width:272,maxLength:E})):A().createElement("div",{className:g},A().createElement(U.Z,{onSearch:this.handleSearch,placeholder:_,width:272,maxLength:E,value:O}))},this.renderSearchOther=()=>{var l=this.props.renderSearchOther;return l?l():null},this.state={language:{zh_cn:F.Z,en_us:j.Z,zh_hk:K.Z},currentPlaceholder:""}}componentDidMount(){this.setPlaceholder()}componentDidUpdate(h){h.userLng!==this.props.userLng&&this.setPlaceholder()}render(){var h=this.props,l=h.prefixCls,v=h.wrapCls,p=h.showRenderRadios,d=p===void 0?!0:p,P=h.showRenderSelect;return A().createElement(A().Fragment,null,A().createElement("div",{className:"render_other"},this.renderOther(),A().createElement("header",{className:"".concat(l," ").concat(v)},A().createElement("section",{className:"".concat(l,"__searchcol")},this.renderSearchOther(),this.renderCheckbox(),d&&this.renderRadios(),P&&this.renderSelect(),this.renderSearch()))))}}$.defaultProps={prefixCls:"cl-listQueryRow",wrapCls:"",label:"",showRadioList:!0,showCheckbox:!0,showSearch:!0,inputPlaceholder:"",defaultRadioValue:"",radioList:[],searchStylesProps:{},showRenderSelect:!1,selectList:[],renderActionBtn:()=>null,onRadiosChange:()=>{},onSearch:()=>{},onCheckboxChange:()=>{},renderSearchOther:()=>{}},se.Z=(0,M.$j)(N)((0,R.Z)()($))},28107:function(ve,se,t){"use strict";var ne=t(66456),L=t(55313),ee=t(22385),y=t(31097),n=t(57663),w=t(71577),a=t(71194),A=t(57016),M=t(88986),R=t(12924),U=t.n(R),j=t(91768),F=t(10237),K=t(37055),N=t(6793),$=t(18329),q=t(95664);class h extends U().Component{constructor(v){super(v);this.onCancel=()=>{var p=this.props,d=p.handleReferenceList,P=p.onReferenceList;d?d():P&&P()},this.onContinueEdit=()=>{var p=this.props.continueEdit;p&&p()},this.initTableList=(p,d)=>{var P=this.props,E=P.type,O=P.operation,g=P.resourceId,_=P.t,V=this.state.resourceTypes,S=d||O;return this.setState({loading:!0}),F.WY.get({url:K.ZP.deleteResource.check(),params:(0,M.Z)((0,M.Z)({},this.state.params),{},{type:E,id:p||g})}).then(G=>{if(G.data.list&&G.data.list.length===0)return!0;if(G.data.total<2&&G.data.list.length>0){var Q=G.data.list[0],re=Q.title,b=Q.type_name,C=Q.create_user_name,f="";return S==="continueEdit"?f=(0,N.ZT)("".concat(_("component.continueEditReminderTip")),V[E],"\u300A".concat(re,"\u300B").concat(b)):S==="forbiddenEdit"?f=(0,N.ZT)("".concat(_("component.forbiddenEditReminderTip")),V[E],"\u300A".concat(re,"\u300B").concat(b)):f=(0,N.ZT)("".concat(_("component.deleteElseReminderTip")),V[E],"\u300A".concat(re,"\u300B(").concat(C?_("common.creator")+":"+C:"",")").concat(b),_(S==="delete"?"common.delete":"course.cancelRelease")),S==="move"?(A.Z.confirm({title:_("common.tip"),content:(0,N.ZT)("".concat(_("component.forbiddenMoveReminderTip")),"\u300A".concat(re,"\u300B").concat(b)),okText:_("common.ok"),onOk:()=>{this.onCancel()},onCancel:()=>{this.onCancel()}}),!1):(S==="continueEdit"?A.Z.confirm({title:_("common.tip"),content:f,okText:_("common.cancel"),cancelText:_("course.continueEdit"),onOk:()=>{this.onCancel()},onCancel:()=>{S==="continueEdit"&&this.props.continueEdit()}}):A.Z.info({title:_("common.tip"),content:f,okText:_("common.ok"),onOk:()=>{this.onCancel()}}),!1)}setTimeout(()=>{this.setState({loading:!1,tableList:G.data.list,tableTotal:G.data.total,tableTotalPages:G.data.pages})},300)})},this.handleTableChange=p=>{var d=this.state.params;d.page_number=p,this.setState({params:d},()=>{this.initTableList()})},this.renderFooter=()=>{var p=this.props,d=p.t,P=p.operation;return U().createElement("div",null,P==="continueEdit"?U().createElement(w.Z,{type:"primary",onClick:this.onContinueEdit},d("course.continueEdit")):null,U().createElement(w.Z,{type:"primary",onClick:this.onCancel},d("common.ok")))},this.state={loading:!0,params:{id:"",type:"",page_number:1,page_size:10},tableList:[],tableTotal:0,tableTotalPages:0,resourceTypes:{questionnaire:this.props.t("common.questionnaire"),classify:this.props.t("course.category"),paper:this.props.t("exam.paperAddTitle"),question:this.props.t("learning.questionAddTitle"),course:this.props.t("study.course"),resource:this.props.t("common.courseware"),lecturer:this.props.t("course.lecturer"),evaluationProduct:this.props.t("questionn.evaluationTool")}},this.columns=[{title:this.props.t("common.number"),dataIndex:"userId",width:30,render:(p,d,P)=>P+1},{title:this.props.t("common.name"),dataIndex:"title",width:420,render:p=>U().createElement(y.Z,{title:p},U().createElement("div",{className:"cl-text-ellipsis",style:{width:420}},p))},{title:this.props.t("study.type"),dataIndex:"type_name",width:120},{title:this.props.t("common.creator"),dataIndex:"create_user_name",width:30}]}componentDidMount(){var v=this.props.onRef;v&&v(this)}componentDidUpdate(v){var p=this.props.onRef;p||this.props.visible&&this.props.visible!==v.visible&&this.props.resourceId&&this.setState({params:{id:"",type:"",page_number:1,page_size:10},tableList:[],tableTotal:0,tableTotalPages:0},()=>{this.initTableList()})}render(){var v=this.props,p=v.visible,d=v.type,P=v.operation,E=v.t,O=this.state,g=O.loading,_=O.params,V=O.tableList,S=O.tableTotal,G=O.tableTotalPages,Q=O.resourceTypes;return U().createElement("div",null,S>1?U().createElement($.ZP,{visible:p,title:P==="move"?"".concat(E("common.tip")):(0,N.ZT)("".concat(E("component.deleteReminder")),E(P==="delete"?"common.deletion":P==="cancelPublish"?"course.cancelRelease":"common.edit")),onCancel:this.onCancel,onOk:this.onCancel,footer:this.renderFooter()},U().createElement("div",{className:"referenceWithOther"},U().createElement("div",{className:"referenceWithOther__tip"},P==="continueEdit"?"".concat(E("component.this")).concat(Q[d]).concat(E("component.continueEditReminderTip2")):P==="forbiddenEdit"?"".concat(E("component.pleaseNote")).concat(Q[d]).concat(E("component.forbiddenEditReminderTip2")):P==="move"?"".concat(E("component.forbiddenMoveTip")):(0,N.ZT)("".concat(E("component.deleteReminderTip")),Q[d],E(P==="delete"?"common.delete":"course.cancelRelease"))),U().createElement(L.Z,{bordered:!0,size:"middle",columns:this.columns,rowKey:"id",dataSource:V,pagination:!1,loading:g}),U().createElement(q.Z,{defaultPageSize:10,totalNum:S,totalPage:G,current:_.page_number,showRenderRefresh:!1,onChange:this.handleTableChange}))):null)}}se.Z=(0,j.Z)()(h)},55722:function(ve,se,t){"use strict";t.d(se,{Z:function(){return oe}});var ne=t(14781),L=t(53431),ee=t(62029),y=t(88986);function n(H){throw new TypeError('"'+H+'" is read-only')}var w=t(71194),a=t(57016),A=t(34792),M=t(48086),R=t(57361),U=t(22385),j=t(31097),F=t(71153),K=t(60331),N=t(9754),$=t.n(N),q=t(12924),h=t.n(q),l=t(91768),v=t(28216),p=t(40847),d=t(57119),P=t(57068),E=t(76651),O=t(14409),g=t(84874),_=t(16598),V=t(38642),S=t(1164),G=t(42837),Q=t(37055),re=t(10237),b=t(26697),C=t(36202),f=t(86726),x=t(59857),z=t(60667),W={deleteCourse:Q.ZP.CourseManageList.deleteCourse,translateCourseStatus:Q.ZP.CourseManageList.translateCourseStatus,operateAiCourse:Q.ZP.CourseManageList.operateAiCourse,checkApproval:Q.ZP.CourseManagement.checkApproval};class ie extends h().Component{constructor(){var T;super(...arguments);T=this,this.state={weiProps:{visible:!1,option:{scene:"",flag:""}},AIModalFlag:!1,operateRecord:{},allowActions:(0,f.V9)("library",this.props.userInfo.modules),blackList:{releaseContentAiUpdate:(0,V.eY)("RELEASECONTENT_COURSE_AIUPDATE")}},this.tip=()=>h().createElement("div",null,h().createElement("p",null,this.props.t("courseManage.estimatedStandard")),h().createElement("p",null,this.props.t("courseManage.estimatedStandard1")),h().createElement("p",null,this.props.t("courseManage.estimatedStandard2")),h().createElement("p",null,this.props.t("courseManage.estimatedStandard3")),h().createElement("p",null,this.props.t("courseManage.estimatedStandard4"))),this.columns=[{title:this.props.t("courseManage.courseTitle"),dataIndex:"title",key:"title",width:260,fixed:"left",render:(I,u)=>{var k=localStorage.getItem("themeColor")||"#465dcd",B=u.is_microcourse==="true";return B?h().createElement("span",{className:"cl-default-pointer cl-hover",onClick:()=>this.handleViewMicroCourse({record:u})},I," ",h().createElement(K.Z,{color:k},this.props.t("common.microCourse"))):h().createElement("span",{className:"cl-default-pointer cl-hover",onClick:()=>this.handleViewCourse({record:u})},I)}},{title:this.props.t("common.status"),width:this.props.lng==="en_us"?140:96,dataIndex:"course_status",key:"course_status",render:(I,u)=>h().createElement("div",null,u.is_ai_course?(0,O.As)(u.ai_status,I):(0,O.AQ)(I))},{title:this.props.t("learning.learningProjectAddCategory"),dataIndex:"classify_name",key:"classify_name",width:150,render:(I,u)=>h().createElement(x.Z,{name:u.classify_name,full_name:u.classify_path_name})},{title:this.props.t("common.visibleRange"),dataIndex:"is_all",key:"is_all",width:this.props.lng==="en_us"?120:96,render:I=>I===1?this.props.t("common.allCompany"):this.props.t("setting.partlyVisible")},{title:()=>h().createElement("div",null,this.props.t("courseManage.estimatedHours"),"\xA0\xA0\xA0",h().createElement(j.Z,{title:()=>this.tip()},h().createElement(p.Z,{style:{cursor:"pointer"}}))),dataIndex:"duration",key:"duration",width:150,render:I=>{var u="--",k=Number(I);return k<60&&k>0?u="".concat(k,"\u79D2"):k>60&&(u="".concat(Math.ceil(k/60),"\u5206\u949F")),h().createElement("span",null,u)}},{title:this.props.t("personal.approvalComments"),dataIndex:"approve_view",key:"approve_view",render:I=>"".concat(I||"/"),onCell:()=>({style:{minWidth:155}})},{title:this.props.t("common.creator"),dataIndex:"create_user_name",key:"create_user_name",width:96,render:(I,u)=>h().createElement("div",{className:"cl-text-ellipsis",style:{width:80}},h().createElement(z.Z,{dataType:"userName",value:u.creator_sync_user_id,name:I,type:u.creator_source_type}))},{title:this.props.t("course.lecturer"),dataIndex:"teacher_name",key:"teacher_name",width:96,render:(I,u)=>h().createElement("div",{className:"cl-text-ellipsis",style:{width:80}},u.teacher_type==="inside"&&h().createElement(z.Z,{dataType:"userName",value:u.teacher_sync_user_id,name:I,type:u.teacher_source_type}),u.teacher_type==="outside"||u.teacher_type===""&&I)},{title:this.props.t("common.updateTime"),dataIndex:"update_date",key:"update_date",width:164},{title:this.props.t("common.createTime"),dataIndex:"create_date",key:"create_date",width:150},{title:this.props.t("common.operate"),width:220,fixed:"right",key:"operate",render:I=>this.renderActions({record:I})}],this.statusMap=I=>{var u;switch(I.ai_upgrade_status){case"not_processed":u=this.props.t("course.notUpdate");break;case"processing":u=this.props.t("course.updating");break;case"processed":u=this.props.t("course.dealSuccess");break;case"failed":u=this.props.t("course.updateFailed");break;default:u="/"}return u},this.getColumns=()=>{var I=this.props.userInfo.enterpriseVersion=="comprehensive"&&(0,f.H3)("ai_upgrade",this.state.allowActions),u=[...this.columns];return I&&u.splice(-2,0,{title:this.props.t("course.isAIUpdate"),dataIndex:"createUserName",key:"createUserName",width:130,render:(k,B)=>h().createElement("span",null,this.statusMap(B))}),u},this.handleTableChange=(I,u)=>{this.props.onTableChange({current:I,pageSize:u})},this.handleViewMicroCourse=function(){var I=(0,R.Z)($().mark(function u(k){var B,D;return $().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:if(B=k.record,D=B.resource_type==="video",!D){Y.next=8;break}return Y.next=5,T.props.dispatch({type:"currentRoute/updateState",payload:{shouldAddScanCount:!0}});case 5:(0,V.eJ)({url:"/miniCourse/watch?courseId=".concat(B.course_id,"&isNewVersion=").concat(B.isNewVersion,"&classifyId=").concat(B.classify_id)}),Y.next=9;break;case 8:T.setState({weiProps:{visible:!0,option:{scene:"courseId=".concat(B.course_id,"&flag=miniCourse"),flag:"miniCourse"}}});case 9:case"end":return Y.stop()}},u)}));return function(u){return I.apply(this,arguments)}}(),this.handleWeiCancel=()=>{this.setState({weiProps:{visible:!1,option:{scene:"",flag:""}}})},this.handleViewCourse=I=>{var u=I.record;this.props.courseType==="graphic"?(0,V.eJ)({url:"/course/watch?".concat(P.stringify({courseId:u.course_id,source:"enterprise",courseName:"",exitAiUpdate:!1,courseType:"imageText"}))}):S.Z.targetTo({path:"/course/enterpriseCourse?courseId=".concat(u.course_id),projectType:"student"})},this.clickDynamicVideo=I=>{S.Z.targetTo({path:"/training/learning/task/interactiveVideo?courseId=".concat(I.course_id)})},this.handleAiCourse=(I,u)=>{var k=I.record;re.WY.post({url:W.operateAiCourse(),data:{course_id:k.course_id,type:u}}).then(B=>{var D=B.success,ae=B.code;D==="true"&&M.default.success(this.props.t("course.operateSuccess"));var Y=["200000","503014","503013"];Y.indexOf(ae)>-1&&this.props.getList()})},this.handleEdit=I=>{var u=I.record,k=u.reference_plan_count,B=u.is_microcourse,D=u.course_id,ae=u.is_ai_course,Y=this.props,he=Y.t,me=Y.courseType,ce=me===void 0?"":me;if(B==="true"){M.default.warning(he("personal.editMicroTip"));return}k>0?a.Z.confirm({title:he("common.tip"),content:he("personal.courseReferedTaskTip"),okText:he("common.ok"),cancelText:he("personal.ContinueEditing"),onOk(){},onCancel(){ce=="graphic"?S.Z.targetTo({path:"/knowledgeBase/graphicLesson/detail?courseId=".concat(D,"&history=rescource")}):ae?E.m8.push("/knowledgeBase/learningResources/aiCourse/edit?courseId=".concat(D,"&history=rescource&canEdit=false")):S.Z.targetTo({path:"/course/management/detail/manage?courseId=".concat(D,"&history=rescource")})}}):ce=="graphic"?S.Z.targetTo({path:"/knowledgeBase/graphicLesson/detail?courseId=".concat(D,"&history=rescource")}):ae?E.m8.push("/knowledgeBase/learningResources/aiCourse/edit?courseId=".concat(D,"&history=rescource&canEdit=true")):S.Z.targetTo({path:"/course/management/detail/manage?courseId=".concat(D,"&history=rescource")})},this.handleDelete=I=>{var u=I.record,k=u.reference_plan_count,B=u.course_id,D=this.props.t;k>0?M.default.warning(D("course.deleteCourseTip")):re.qg.post({url:W.deleteCourse(),data:{enterpriseId:Q.ZP.enterpriseId,ids:B}}).then(ae=>{var Y=ae.data,he=Y.code,me=Y.msg;M.default["".concat(he===0?"success":"warning")](me),he===0&&this.props.onForceRender()}).catch(()=>{this.props.onForceRender()})},this.handleRelease=I=>{var u=I.record,k=u.reference_plan_count;k>0?M.default.warning(this.props.t("course.courseReferencedTask")):re.qg.get({url:W.checkApproval()}).then(B=>{var D=B.data,ae=D.data,Y=D.code;Y===0&&(ae.state===!0?this.handleEdit({record:u}):this.funToPublish(u))})},this.funToPublish=I=>{re.qg.post({url:W.translateCourseStatus({courseId:I.course_id}),data:{action:"release"}}).then(u=>{var k=u.data,B=k.code,D=k.msg;B===0&&(M.default["".concat(B===0?"success":"warning")](D),this.props.onForceRender())})},this.clickAIUpdate=()=>{M.default.warning(this.props.t("common.maintain"))},this.clickApproval=I=>{var u=I.instance_id;(0,V.eJ)({url:"/personal/approval/approved-process?instanceId=".concat(u)})},this.handleMenuClick=(I,u)=>{var k=this.props.t;I==="delete"?a.Z.confirm({icon:h().createElement(d.Z,null),content:"".concat(k("course.sureToDelete"),"?"),cancelText:k("common.cancel"),okText:k("common.ok"),onOk:()=>{this.handleDelete({record:u})}}):I==="release"?a.Z.confirm({icon:h().createElement(d.Z,null),content:"".concat(k("personal.whetherToPublish"),"?"),cancelText:k("common.cancel"),okText:k("common.ok"),onOk:()=>{this.handleRelease({record:u})}}):I==="edit"&&this.handleEdit({record:u})},this.renderActions=I=>{var u=I.record,k=this.state.blackList,B=this.props,D=B.allowActions,ae=B.courseType,Y=B.t,he=B.userInfo,me=he.appType,ce=u.show_release,fe=u.can_edit,_e=u.can_delete,De=u.is_ai_course,Te=u.ai_status,Ee=u.show_approval_process,ge=u.is_microcourse,Oe=_e==="true"&&(0,f.H3)("delete",D),je=ce==="true"&&(0,f.H3)("release_or_cancelled",D),xe=fe==="true"&&(0,f.H3)("edit",D),$e=(0,f.H3)("retry",D)&&De&&Te===4,ke=(0,f.H3)("make_interactive_video",D)&&u.biz_type!==3&&u.biz_type!==2&&u.interact_course_status==="on"&&!De,He=(0,f.H3)("ai_upgrade",this.state.allowActions)&&he.enterpriseVersion==="comprehensive",Pe=ge==="true"||De&&Te===3,ze=()=>ge==="true"?Y("personal.editMicroTip"):De&&Te===3?Y("course.generateTip"):"",Le=()=>De?!(Te===2||Te===6):!0,qe=()=>De?!(Te===2||Te===6):!0,Ze=[{type:"edit",visible:xe&&qe(),title:this.props.t("common.edit"),disabled:Pe,click:()=>this.handleEdit({record:u}),tooltip:ze()},{type:"dynamicVideo",visible:ke&&me!=="wx_app",title:this.props.t("course.createInteractiveVideo"),click:()=>this.clickDynamicVideo(u)},{type:"retry",visible:$e,title:this.props.t("common.retry"),click:()=>this.handleAiCourse({record:u},"retry")},{type:"published",visible:je,disabled:ge==="true",tooltip:Y("personal.editMicroTip"),title:this.props.t("common.release"),click:()=>this.handleRelease({record:u})},{type:"delete",visible:Oe&&Le(),title:this.props.t("common.delete"),click:()=>this.handleDelete({record:u})},{type:"AIUpdate",visible:He&&ae!=="graphic",title:this.props.t("course.AIUpdate"),disabled:!0,tooltip:this.props.t("common.maintain"),click:()=>this.clickAIUpdate(u)},{type:"aproval",visible:Ee==="true",title:this.props.t("leftMenuLists.approvalProcess"),click:()=>this.clickApproval(u)}];return k.releaseContentAiUpdate||(Ze.filter(Ge=>Ge.type!=="AIUpdate"),n("buttons")),h().createElement("div",{className:"cl-table__cell-action"},h().createElement(_.Z,{buttons:Ze}),localStorage.getItem("dingPersonnel")!=="dingPersonnel"&&h().createElement(h().Fragment,null,h().createElement("span",{className:"cl-pointer-divide",style:{marginLeft:"8px"}}),h().createElement(g.Z,{className:"move",color:"#d1d2d6",iconClass:"iconf-move"})))},this.handleCancel=I=>{this.setState({AIModalFlag:!1},()=>{I&&S.Z.targetTo({path:"/training/resourceManage/library/indicator?id=".concat(this.state.operateRecord.course_id)}),this.props.getList()})}}render(){var T=this.props,I=T.prefixCls,u=T.list,k=u===void 0?[]:u,B=T.loading,D=T.paginationParams,ae=D===void 0?{}:D,Y=T.headerTitle,he=T.toolBarRender,me=T.t,ce=this.state.weiProps,fe=(0,y.Z)((0,y.Z)({},Q.XE.INITIAL_PAGINATION),ae);return h().createElement("section",{className:I},h().createElement("div",{className:"draft-content-list"},h().createElement(C.f,{columns:this.getColumns(),rowKey:_e=>_e.course_id,dataSource:k,pagination:!1,loading:B,scroll:{x:"max-content",y:"100%"},headerTitle:Y,toolBarRender:he,tableUUID:"21df050f-1cc4-40c8-890c-976e0a047694"})),h().createElement("div",{className:"draft-pagination-wrapper"},h().createElement(L.Z,(0,ee.Z)({},fe,{onChange:this.handleTableChange,className:"draft-pagination"}))),h().createElement(G.Z,(0,ee.Z)({title:me("component.microCourseScan")},ce,{onCancel:this.handleWeiCancel,tip:"component.useCustom"})),this.state.operateRecord&&h().createElement(b.Z,{visible:this.state.AIModalFlag,record:[this.state.operateRecord],onCancel:_e=>this.handleCancel(_e)}))}}ie.defaultProps={prefixCls:"resource-course-list-page__draft__table"};var oe=(0,v.$j)(H=>({userInfo:H.user}))((0,l.Z)()(ie))},31945:function(ve,se,t){"use strict";t.d(se,{Z:function(){return oe}});var ne=t(88983),L=t(47933),ee=t(20228),y=t(11382),n=t(62029),w=t(30887),a=t(99210),A=t(59250),M=t(13013),R=t(57663),U=t(71577),j=t(63185),F=t(9676),K=t(71194),N=t(57016),$=t(88986),q=t(34792),h=t(48086),l=t(43358),v=t(34041),p=t(12924),d=t.n(p),P=t(28216),E=t(91768),O=t(57254),g=t(18329);class _ extends d().Component{constructor(){super(...arguments);this.onCancel=()=>{this.props.showReferenceCourseList()}}render(){var T=this.props,I=T.visible,u=T.courseList,k=T.t;return d().createElement(g.ZP,{visible:I,title:k("common.tip"),onCancel:this.onCancel,onOk:this.onCancel},d().createElement("div",{className:"referenceWithOtherCourses"},d().createElement("div",{className:"referenceWithOtherCourses__tip"},k("course.deleteCourseTip")),u.map((B,D)=>d().createElement("div",{className:"referenceWithOtherCourses__item",key:D},u.length>1?"".concat(D+1,"\u3001"):null," ",B))))}}var V=(0,E.Z)()(_),S=t(10237),G=t(63848),Q=t(58546),re=t(30389),b=t(54792),C=t(86726),f=t(37055),x=v.Z.Option,z={setClassify:f.ZP.CourseManageList.setClassify,setScore:f.ZP.CourseManageList.setScore,setBatchEmployee:f.ZP.CourseManageList.setBatchEmployee,deleteCourse:f.ZP.CourseManageList.deleteCourse,exportCourseView:f.ZP.CourseManageList.exportCourseView,syncCourse:f.ZP.CourseManageList.syncCourse},W=H=>({qyShield:H.user.qyShield});class ie extends d().Component{constructor(){super(...arguments);this.state={classifyProps:{visible:!1},scoreProps:{title:this.props.t("course.setCredits"),labelTxt:this.props.t("course.credit"),initialValue:"",visible:!1},employeeProps:{visible:!1,initialParams:{employeeRange:{rangeType:3,rangeList:{dept:[],post:[],group:[],user:[]}}}},asyncProps:{value:0,visible:!1},showReferenceCourseListProps:{visible:!1,courseList:[],onOk:this.showReferenceCourseList,onCancel:this.showReferenceCourseList}},this.handleChangeClassify=T=>{this.props.onClassifyChange(T)},this.handleChangeType=T=>{this.props.onTypeChange(T)},this.handleChangeCourseType=T=>{this.props.onCourseTypeChange(T)},this.actionChangeClassify=()=>{this.setState({classifyProps:{visible:!0}})},this.handleCategoryCancel=()=>{this.setState({classifyProps:{visible:!1}})},this.handleCategoryOk=T=>{var I=T.node,u=this.props,k=u.selectedCourseIds,B=u.selectedProjectIds,D=u.onForceRender,ae=u.t,Y=I.id;Y&&S.qg.post({url:z.setClassify(),data:{course_ids:k.join(","),project_ids:B.join(","),classify_id:Y}}).then(()=>{h.default.success(ae("course.setCourseClassifySuccess")),D()}),this.handleCategoryCancel()},this.actionSetScore=()=>{this.setState(T=>({scoreProps:(0,$.Z)((0,$.Z)({},T.scoreProps),{},{initialValue:"",visible:!0})}))},this.handleScoreCancel=()=>{this.setState(T=>({scoreProps:(0,$.Z)((0,$.Z)({},T.scoreProps),{},{visible:!1})}))},this.handleScoreOk=T=>{var I=T.value;if(I===0){this.handleScoreCancel();return}var u=this.props,k=u.selectedCourseIds,B=u.selectedProjectIds,D=u.onForceRender,ae=u.t;S.qg.post({url:z.setScore(),data:{course_ids:k.join(","),project_ids:B.join(","),credit:I}}).then(()=>{h.default.success(ae("course.setCourseScoreSuccess")),D()}),this.handleScoreCancel()},this.actionSetEmployeeRange=()=>{this.setState(T=>({employeeProps:(0,$.Z)((0,$.Z)({},T.employeeProps),{},{visible:!0})}))},this.handleEmployeeCancel=()=>{this.setState({employeeProps:{visible:!1,initialParams:{employeeRange:{rangeType:3,rangeList:{dept:[],post:[],group:[],user:[]}}}}})},this.handleEmployeeOk=T=>{var I=this.props,u=I.selectedCourseIds,k=I.selectedProjectIds,B=I.onForceRender,D=I.t,ae=T.isAll,Y=T.departmentIds,he=T.groupIds,me=T.postIds,ce=T.userIds,fe=T.qy_we_chat_vo;S.WY.post({url:z.setBatchEmployee(),data:{course_ids:u.join(","),project_ids:k.join(","),department_ids:Y,group_ids:he,is_all:ae,post_ids:me,user_ids:ce,qy_we_chat_vo:fe}}).then(()=>{h.default.success(D("personal.batchSetRangeSuccess")),B()}),this.handleEmployeeCancel()},this.showReferenceCourseList=T=>{this.setState(I=>({showReferenceCourseListProps:(0,$.Z)((0,$.Z)({},I.showReferenceCourseListProps),{},{visible:!I.showReferenceCourseListProps.visible,courseList:T||[]})}))},this.actionDelete=()=>{var T=this.props,I=T.selectedCourseIds,u=T.selectedProjectIds,k=T.list,B=T.onForceRender,D=T.t,ae=0,Y=0,he=[];if(k.forEach(me=>{I.includes(me.course_id)&&(me.reference_plan_count>0&&(Y+=1),me.reference_plan_count>0&&he.push(me.title),me.can_delete==="true"&&(ae+=1))}),Y>0)this.showReferenceCourseList(he);else if(ae!==I.length)h.default.warning(D("personal.deletePlatformCourseTip"));else{if(u.length>0){h.default.warning(D("personal.deleteProjectCourseTip"));return}N.Z.confirm({title:D("common.tip"),content:D("common.confirmDeleteTitle"),onOk(){S.qg.post({url:z.deleteCourse(),data:{enterpriseId:f.ZP.enterpriseId,ids:I.join(","),project_ids:u.join(",")}}).then(me=>{var ce=me.data,fe=ce.code,_e=ce.msg;h.default["".concat(fe===0?"success":"warning")](_e),fe===0&&B()})}})}},this.actionSyncSetting=()=>{this.setState(T=>({asyncProps:(0,$.Z)((0,$.Z)({},T.asyncProps),{},{visible:!0})}))},this.onAsyncChange=T=>{this.setState(I=>({asyncProps:(0,$.Z)((0,$.Z)({},I.asyncProps),{},{value:T.target.value})}))},this.handleSyncCancel=()=>{this.setState({asyncProps:{visible:!1,value:0}})},this.handleSyncOk=()=>{var T=this.props,I=T.selectedCourseIds,u=T.selectedProjectIds,k=T.onForceRender,B=T.t,D=this.state.asyncProps;S.qg.post({url:z.syncCourse(),data:{course_ids:I.join(","),project_ids:u.join(","),syncProgress:D.value}}).then(ae=>{var Y=ae.data,he=Y.code,me=Y.msg;he===0?(h.default.success(B("setting.setUpSucceed")),k()):h.default.warning(me)}),this.handleSyncCancel()},this.actionImportDetail=()=>{var T=this.props,I=T.selectedCourseIds,u=T.selectedProjectIds,k=T.onForceRender,B=T.t;if(I.concat(u).length>20){h.default.warning(B("courseManage.exportMoreTip"));return}var D=z.exportCourseView(),ae={course_Ids:I.join(","),project_Ids:u.join(",")};S.WY.get({url:D,params:ae}).then(Y=>{Y.data.code===200&&h.default.success("\u6587\u4EF6\u751F\u6210\u4E2D\uFF0C\u8BF7\u7A0D\u540E\u5728\u6587\u4EF6\u4E0B\u8F7D\u4E2D\u4E0B\u8F7D"),k(),this.getDownloadingNumber()})},this.getDownloadingNumber=()=>{var T=f.ZP.downLoadCenter.getDownLoadingCount();S.WY.get({url:T,params:{}}).then(I=>{sessionStorage.setItem("downloadingCount",I.data.data),this.props.dispatch({type:"download/updateDownloadingNumber",downloadingNumber:I.data.data})}).catch(()=>{sessionStorage.setItem("downloadingCount",0),this.props.dispatch({type:"download/updateDownloadingNumber",downloadingNumber:0})})},this.handleChangeCheckBox=T=>{this.props.onCheckboxChange(T.target.checked)},this.handleSharingQueryRowCheckboxChange=T=>{this.props.onSharingCheckboxChange(T.target.checked)},this.renderCondition=()=>{var T=this.props,I=T.prefixCls,u=T.params,k=T.qyShield,B=T.t,D=u.classify_id?u.classify_id.split(","):[];return d().createElement("div",{className:"".concat(I,"__condition")},this.props.extraDom&&this.props.extraDom(),d().createElement(G.Z,{onChange:this.handleChangeClassify,className:"cl-search-normal-width",value:D,showLabel:!1,placeholder:"Please select",queryType:"course_manage",unclassified:"true"}),d().createElement(v.Z,{value:u.type,className:"cl-search-normal-width",onChange:this.handleChangeType},d().createElement(x,{value:""},this.props.t("courseManage.allOrigin")),d().createElement(x,{value:"original"},this.props.t("courseManage.originalCourse")),d().createElement(x,{value:"notOriginal"},this.props.t("courseManage.nonOriginalCourse")),d().createElement(x,{value:"platform"},this.props.t("courseManage.platformProcurement"))),this.props.courseType&&this.props.courseType=="graphic"?null:d().createElement(v.Z,{value:u.course_type,className:"cl-search-normal-width",onChange:this.handleChangeCourseType},d().createElement(x,{value:"all"},this.props.t("courseManage.allType")),d().createElement(x,{value:"course"},this.props.t("common.courseLabel")),d().createElement(x,{value:"microCourse"},this.props.t("common.microCourse")),d().createElement(x,{value:"project"},this.props.t("leftMenuLists.studyProject"))),d().createElement(F.Z,{onChange:this.handleChangeCheckBox,style:{marginRight:16}},B("common.myCreated")),this.props.courseType&&this.props.courseType==="graphic"&&k==="false"?d().createElement(F.Z,{onChange:this.handleSharingQueryRowCheckboxChange},B("common.sharing")):null)},this.renderActions=()=>{var T=this.props,I=T.prefixCls,u=T.selectedCourseIds,k=T.selectedProjectIds,B=T.showNum,D=B===void 0?1:B,ae=this.props.allowActions,Y=(0,C.H3)("delete",ae),he=(0,C.H3)("adjustment_classification",ae),me=(0,C.H3)("set_visible",ae),ce=(0,C.H3)("export",ae),fe=(0,C.H3)("set_score",ae),_e=(0,C.H3)("progressSync",ae),De=[{name:this.props.t("courseManage.adjustClassification"),type:"actionChangeClassify",isShow:he},{name:this.props.t("courseManage.exportViewDetail"),type:"actionImportDetail",isShow:ce},{name:this.props.t("courseManage.setCredits"),type:"actionSetScore",isShow:fe},{name:this.props.t("courseManage.setTheVisibilityed"),type:"actionSetEmployeeRange",isShow:me},{name:this.props.t("common.delete"),type:"actionDelete",isShow:Y},{name:this.props.t("common.scheduleSyncSetting"),type:"actionSyncSetting",isShow:_e}],Te=De.filter(Oe=>Oe.isShow),Ee=[],ge=[];if(Te.length)D?(Ee=[...Te.slice(0,D)],ge=[...Te.slice(D)]):ge=[...Te];else return null;return d().createElement("div",{className:"".concat(I,"__action")},Ee.map(Oe=>d().createElement(U.Z,{style:{marginRight:"8px"},key:Oe.type,disabled:!(u.length+k.length),onClick:this[Oe.type]},Oe.name)),ge.length?d().createElement(M.Z,{disabled:!(u.length+k.length),overlay:this.renderMoreButton({buttons:ge})},d().createElement(U.Z,{className:"cl-pointer"},"".concat(this.props.t("common.more"))," ",d().createElement(O.Z,null))):"")}}renderMoreButton(T){var I=T.buttons,u=this.props,k=u.selectedCourseIds,B=u.selectedProjectIds;return d().createElement(a.Z,{onClick:D=>{var ae=D.key;this[ae]()}},I.map(D=>D.isShow?d().createElement(a.Z.Item,{key:D.type,disabled:!(k.length+B.length)},d().createElement("span",{className:"cl-pointer"},D.name)):null))}render(){var T=this.props,I=T.prefixCls,u=T.t,k=T.showRenderCondition,B=k===void 0?!0:k,D=T.showRenderActions,ae=D===void 0?!0:D,Y=this.state,he=Y.classifyProps,me=Y.scoreProps,ce=Y.employeeProps,fe=Y.showReferenceCourseListProps,_e=Y.asyncProps;return d().createElement("div",{className:I},B&&this.renderCondition(),ae&&this.renderActions(),d().createElement(Q.Z,(0,n.Z)({},he,{title:u("personal.chooseClassify"),onCancel:this.handleCategoryCancel,onOk:this.handleCategoryOk})),d().createElement(b.Z,(0,n.Z)({},me,{onCancel:this.handleScoreCancel,onCreate:this.handleScoreOk})),ce.visible&&d().createElement(re.Z,(0,n.Z)({},ce,{title:u("courseManage.setTheVisibility"),mode:["all","part","private"],orgProps:{title:u("component.chooseVisibleScope")},isLoading:!ce.visible,onCancel:this.handleEmployeeCancel,onCreate:this.handleEmployeeOk})),_e.visible&&d().createElement(g.ZP,{wrapClassName:"cl-async-selector-modal",visible:_e.visible,title:u("common.scheduleSyncSetting"),okText:u("common.ok"),cancelText:u("common.cancel"),onCancel:this.handleSyncCancel,onOk:this.handleSyncOk},_e.visible?d().createElement("div",{className:"".concat(I,"__async")},d().createElement("p",null," ",u("common.scheduleSyncSettingTip")),d().createElement(L.ZP.Group,{onChange:this.onAsyncChange,value:_e.value},d().createElement(L.ZP,{value:0},u("common.outSync")),d().createElement(L.ZP,{value:1},u("common.synchronization")))):d().createElement(y.Z,{size:"large"})),d().createElement(V,(0,n.Z)({},fe,{showReferenceCourseList:this.showReferenceCourseList})))}}ie.defaultProps={prefixCls:"resource-course-list-page__release__content__queryrow",rangeType:""};var oe=(0,E.Z)()((0,P.$j)(W)(ie))},74457:function(ve,se,t){"use strict";t.d(se,{Z:function(){return E}});var ne=t(62029),L=t(88986),ee=t(12924),y=t.n(ee),n=t(91768),w=t(57663),a=t(71577),A=t(84391),M=t(28216),R=t(48479),U=O=>({qyShield:O.user.qyShield});class j extends y().Component{constructor(){super(...arguments);this.handleSearch=(g,_)=>{this.props.handleSearch(g,_)},this.handleExport=()=>{this.props.handleExport()},this.renderActionBtn=()=>y().createElement("div",{className:"view-detail__queryrow__action"},y().createElement(a.Z,{type:"primary",onClick:this.handleExport},y().createElement(A.Z,null)," ",this.props.t("common.exportData")))}render(){return y().createElement("header",{className:"view-detail__queryrow"},y().createElement("section",null),y().createElement("section",null,y().createElement(R.Z,{onSearch:this.handleSearch,width:"260px",placeholder:this.props.t("common.searchPlaceholder")}),this.renderActionBtn()))}}var F=(0,M.$j)(U)((0,n.Z)()(j)),K=t(34669),N=t(82833),$=t(55285),q=t(37055),h=t(6793);class l extends y().Component{constructor(){super(...arguments);this.columns=[{title:this.props.t("courseManage.viewTime"),dataIndex:"update_time",key:"update_time",width:163,render:g=>(0,h.p6)(g)},{title:this.props.t("common.studyDuration"),dataIndex:"study_duration",key:"study_duration",width:110,render:g=>g?(0,h.xj)(g):"--"},{title:this.props.t("courseManage.viewProgress"),dataIndex:"progress",key:"progress",width:200,fixed:"right",render:g=>y().createElement("span",null,y().createElement(N.Z,{percent:g}))}],this.handleTableChange=g=>{this.props.onTableChange(g)}}render(){var g=this.props,_=g.list,V=_===void 0?[]:_,S=g.loading,G=g.paginationParams,Q=G===void 0?{}:G,re=g.toolBarRender,b=(0,L.Z)((0,L.Z)({},q.XE.INITIAL_PAGINATION),Q);return y().createElement("section",{className:"view-detail__content__table"},y().createElement($.Z,{bordered:!0,headExtra:[{title:this.props.t("common.number"),width:65,key:"number",fixed:"left",dataIndex:"sort"}],columns:this.columns,rowKey:"userId",dataSource:V,pagination:b,loading:S,onChange:this.handleTableChange,toolBarRender:re,tableUUID:"817408dd-59e3-40d0-b44b-8a9f10f4de77"}))}}var v=(0,n.Z)()(l),p=t(10237),d=t(18329);class P extends y().Component{constructor(){super(...arguments);this.state={params:{keyword:"",page_number:1,page_size:20},tableLoading:!0,tableList:[],tableTotal:0},this.initTableList=()=>{var g=this.props.courseId;this.setState({tableLoading:!0}),p.WY.get({url:q.ZP.Courses.getViewRecord({courseId:g}),params:this.state.params}).then(_=>{setTimeout(()=>{this.setState({tableLoading:!1,tableList:_.data.list,tableTotal:_.data.total})},300)})},this.handleChangPagination=g=>{var _=g.current,V=g.pageSize;this.setState(S=>({params:(0,L.Z)((0,L.Z)({},S.params),{},{page_number:_,page_size:V})}),()=>{this.initTableList()})},this.resetPagination=()=>new Promise(g=>{this.setState(_=>({params:(0,L.Z)((0,L.Z)({},_.params),{},{page_number:1,page_size:20})}),()=>{g()})}),this.handleSearch=(g,_)=>{var V={keyword:_===""?g:"",userIds:_};this.resetPagination().then(()=>{this.setState(S=>({params:(0,L.Z)((0,L.Z)({},S.params),V)}),()=>{this.initTableList()})})},this.export=()=>{var g="",_=this.state.params;Object.keys(_).forEach(S=>{g+="".concat(S,"=").concat(_[S],"&")});var V=this.props.courseId;window.location.href="".concat(q.ZP.Courses.exportViewRecord({courseId:V}),"?").concat(g,"access_token=").concat(window.localStorage.getItem("token"))},this.onCancel=()=>{this.props.onCancel()},this.renderRightRow=()=>y().createElement(F,{handleSearch:this.handleSearch,handleExport:this.export})}componentDidUpdate(g){this.props.visible&&this.props.visible!==g.visible&&this.props.courseId&&this.setState({params:{keyword:"",page_number:1,page_size:20},tableList:[],tableTotal:0},()=>{this.initTableList()})}render(){var g=this.props,_=g.visible,V=g.t,S=this.state,G=S.tableTotal,Q=S.tableList,re=S.tableLoading,b=S.params,C={total:G,current:b.page_number,pageSize:b.page_size},f={title:V("courseManage.viewDetail"),size:"large",footer:null,destroyOnClose:!0};return y().createElement(d.ZP,(0,ne.Z)({},f,{visible:_,onCancel:this.onCancel}),y().createElement("div",{className:"view-detail"},y().createElement("div",{className:"view-detail__content"},y().createElement(v,{loading:re,paginationParams:C,list:Q,onTableChange:this.handleChangPagination,toolBarRender:this.renderRightRow}))))}}var E=(0,n.Z)()(P)},42086:function(ve,se,t){"use strict";t.d(se,{zf:function(){return w},qE:function(){return a},Sp:function(){return A},gg:function(){return M},PX:function(){return R},p1:function(){return U},dA:function(){return j}});var ne=t(57361),L=t(9754),ee=t.n(L),y=t(37055),n=t(10237),w=function(){var F=(0,ne.Z)(ee().mark(function K(N){var $;return ee().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return $=y.ZP.CourseManagement.getCourseInfo(N),h.abrupt("return",n.WY.get({url:$}));case 2:case"end":return h.stop()}},K)}));return function(N){return F.apply(this,arguments)}}(),a=function(){var F=(0,ne.Z)(ee().mark(function K(N){var $;return ee().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return $=y.ZP.EnterpriseCourse.getCourseRecordNum(N),h.abrupt("return",n.WY.get({url:$}));case 2:case"end":return h.stop()}},K)}));return function(N){return F.apply(this,arguments)}}(),A=(F,K)=>{var N=y.ZP.EnterpriseCourse.getCourseRecordList(K);return n.WY.get({url:N,params:F})},M=F=>{var K=y.ZP.EnterpriseCourse.getCourseRecordNodeList(F);return n.WY.get({url:K})},R=(F,K,N)=>{var $=y.ZP.EnterpriseCourse.getCourseRecordNodeListDetail(F,K);return n.WY.get({url:$,params:N})},U=(F,K)=>{var N=y.ZP.EnterpriseCourse.courseRecordExport(K);return n.WY.get({url:N,params:F})},j=F=>{var K=F.courseId,N=y.ZP.CourseManageList.getCourseVisible(K);return n.WY.get({url:N})}},14409:function(ve,se,t){"use strict";t.d(se,{AQ:function(){return n},As:function(){return w},Ru:function(){return a}});var ne=t(3407),L=t(6793),ee=(0,L.me)(),y=ne.Z[ee],n=A=>{var M="";switch(A){case"draft":M=y.course.draft;break;case"approving":M=y.course.underReview;break;case"reject":M=y.course.reject;break;case"released":M=y.course.published;break;case"releasing":M=y.personal.publishing;break;case"release_failed":M=y.personal.publishingFailed;break;default:break}return M},w=(A,M)=>{var R="";switch(A){case 0:R=y.course.draft;break;case 1:R=y.course.published;break;case 2:R=y.course.queue;break;case 3:R=y.course.generated;break;case 4:R=y.course.generateFail;break;case 8:R=y.course.underReview;break;case 9:R=y.course.reject;break;default:R=n(M);break}return R},a=A=>{switch(A){case"platform":return y.common.platformCourse;case"notOriginal":return y.common.noOriginalCourse;case"original":return y.common.originalCourse}}},60947:function(ve,se,t){"use strict";t.r(se),t.d(se,{default:function(){return Ra}});var ne=t(63185),L=t(9676),ee=t(57663),y=t(71577),n=t(88986),w=t(12924),a=t.n(w),A=t(28216),M=t(91768),R=t(49101),U=t(76651),j=t(81211),F=t(14781),K=t(53431),N=t(62029),$=t(30887),q=t(99210),h=t(33565),l=t(57361),v=t(71194),p=t(57016),d=t(77576),P=t(59314),E=t(22385),O=t(31097),g=t(34792),_=t(48086),V=t(9754),S=t.n(V),G=t(9669),Q=t.n(G),re=t(98005),b=t.n(re),C=t(40847),f=t(36546),x=t(44289),z=t(57068),W=t(38642),ie=t(36202),oe=t(30389),H=t(1164),T=t(86458),I=t(84874),u=t(30311),k=t(10237),B=t(37055),D=t(86726),ae=t(26697),Y=t(16598),he=t(57338),me=t(83107),ce=t(5430),fe=t(95371),_e=t(47673),De=t(4107),Te=t(13062),Ee=t(71230),ge=t(89032),Oe=t(15746),je=t(43358),xe=t(34041),$e=t(77883),ke=t(21888),He=t(9715),Pe=t(86585),ze=t(88983),Le=t(47933),qe=t(18106),Ze=t(88108),Ge=t(80991),st=t(68628),et=t(20228),tt=t(11382),Qe=t(51975),Ye={breadNav:[{value:"",label:""}],checkOne:()=>{},checkAll:()=>{},nextLevel:()=>{},changeLevel:()=>{}},Ne=a().createContext(Ye),at={deptList:[],deptUser:[],checkedDept:[],checkedUser:[],initTypeList:()=>{},initTypeUser:()=>{},toggleDisplayItem:()=>{},toggleDisplayList:()=>{},checkListOne:()=>{},checkUserOne:()=>{},removeCheckedUser:()=>{},changeLevel:()=>{}},Ue=a().createContext(at),rt=t(36017),Xe=t(35247);class nt extends a().Component{constructor(){super(...arguments);this.changeLevel=(i,s,e)=>{i.preventDefault(),this.props.contextData.changeLevel(s,e)}}render(){var i=this.props.contextData.breadNav.map((s,e)=>a().createElement(Xe.Z.Item,{key:s.value},a().createElement("span",{className:"bread-nav-item",onClick:r=>this.changeLevel(r,s.value,e)},s.label)));return a().createElement("div",{className:"bread-nav"},a().createElement(Xe.Z,null,i))}}nt.defaultProps={contextData:{breadNav:[]},changeLevel:()=>{}};var it=nt,jt=["cluster","class"];class pt extends a().Component{constructor(){super(...arguments);this.checkOne=i=>{i.preventDefault(),this.props.contextData.checkOne(this.props.itemId,this.props.hasNext?"list":"user",!this.props.isChecked)},this.nextLevel=i=>{i.preventDefault(),!this.props.isChecked&&this.props.contextData.nextLevel(this.props.itemId,this.props.title,this.props.hasNextPost)}}render(){var i=this.props.t,s=null;return this.props.hasNext?(s=a().createElement("div",{className:"next-level"},a().createElement("span",{className:"next-level-count"},"(",this.props.userCount,")"),jt.includes(this.props.type)?a().createElement("span",null):a().createElement("span",{className:this.props.isChecked?"next-level-label disabled":"next-level-label",onClick:this.nextLevel},a().createElement(I.Z,{iconClass:"icon-xiaji1"}),i("component.nextLevel"))),this.props.single?a().createElement("div",{className:"org-tree-item"},a().createElement("span",{checked:this.props.isChecked,disabled:!this.props.checkable,className:"org-tree-item-name"},this.props.title),s):a().createElement("div",{className:"org-tree-item"},a().createElement(L.Z,{checked:this.props.isChecked,disabled:!this.props.checkable,onClick:this.checkOne,className:"org-tree-item-name"},this.props.title),s)):a().createElement("div",{className:"org-tree-item"},this.props.single?a().createElement(Le.ZP,{checked:this.props.isChecked,disabled:!this.props.checkable,onClick:this.checkOne,className:"org-tree-item-name"},this.props.title):a().createElement(L.Z,{checked:this.props.isChecked,disabled:!this.props.checkable,onClick:this.checkOne,className:"org-tree-item-name"},this.props.title))}}pt.defaultProps={hasNext:!1,isChecked:!1,itemId:"",title:"",hasNextPost:!1,userCount:0,checkable:!0};var ut=(0,M.Z)()(pt),mt=["cluster","class"];class ot extends a().Component{constructor(){super(...arguments);this.checkAll=(i,s)=>{i.preventDefault(),this.props.contextData.checkAll(s)},this.getIsCheckAll=()=>{var i=[].concat(this.context["".concat(this.props.dataTypeKey,"List")],mt.includes(this.props.dataTypeKey)?[]:this.context["".concat(this.props.dataTypeKey,"User")]);if(i.length===0)return!1;var s=i.findIndex(e=>!e.isChecked);return s===-1}}render(){var i=this.props.t,s=this.context.maxDeptUserCount,e=this.context["".concat(this.props.dataTypeKey,"List")].map(c=>a().createElement(ut,{type:this.props.dataTypeKey,key:c.id,hasNext:!0,checkable:s&&(c==null?void 0:c.userCount)>s?!1:!(this.context.onlyPost?this.props.dataTypeKey==="post"&&!!c.children:this.context.onlyUser),single:this.context.single,userCount:c.userCount,isChecked:!!c.isChecked,itemId:c.id,title:c.name,contextData:this.props.contextData,hasNextPost:this.props.dataTypeKey==="post"&&!!c.children})),r=mt.includes(this.props.dataTypeKey)?[]:this.context["".concat(this.props.dataTypeKey,"User")].map(c=>a().createElement(ut,{key:c.id,hasNext:!1,title:c.name,isChecked:!!c.isChecked,itemId:c.id,checkable:!(c.reserve||this.context.onlyDept),single:this.context.single,cardInfo:c,contextData:this.props.contextData,type:this.props.dataTypeKey})),o=this.getIsCheckAll(),m=a().createElement("div",{className:"org-tree-item"},a().createElement(L.Z,{checked:o,defaultChecked:!0,onClick:c=>this.checkAll(c,!o)},i("common.all")));return a().createElement("div",{className:this.context.oneDisplayType?"org-tree more-height":"org-tree"},!this.context.single&&this.context.onlyUser&&!this.context.onlyDept&&!this.context.onlyPost&&e.length===0&&r.length>0||!this.context.single&&!this.context.onlyUser&&!this.context.onlyDept&&!this.context.onlyPost&&(e.length>0||r.length>0)?m:null,e,r)}}ot.contextType=Ue,ot.defaultProps={dataTypeKey:"dept",contextData:{}};var $t=(0,M.Z)()(ot),vt="999",gt=1,Ct=["clusterList","classList"],Ja=null;class lt extends a().Component{constructor(i){super(i);this.flatTreeData=(s,e)=>(s.children.forEach(r=>{r.children&&(e[r.id]=r.children,this.flatTreeData(r,e))}),e),this.getDeptList=s=>{var e=B.ZP.market.getConcatTree(),r={parent_id:s==="root"?"":s,search_key:""};this.setState({loadDept:!0}),k.WY.get({url:e,params:r}).then(o=>{this.setState({loadDept:!1}),o.data.data=o.data.data||[],o.data.data.forEach(m=>{m.parentId=this.state.contextData.breadNav.map(c=>c.value),m.userCount=m.user_count,m.name=m.group_name,m.all_name="".concat(this.state.contextData.breadNav.map(c=>c.label).join("/"),"/").concat(m.name)}),this.context.asyncDeptTree?this.setState({deptList:o.data.data}):this.setState({deptList:this.flatTreeData(o.data,{[o.data.id]:o.data.data})}),this.context.initTypeList("deptList","checkedDept",o.data.data)})},this.getDeptUserList=s=>{var e=B.ZP.market.getListConcatPersonInfo({deptId:s}),r={search_key:"",status:""};this.setState({loadUser:!0}),k.WY.get({url:e,params:r}).then(o=>{this.setState({loadUser:!1}),this.context.initTypeUser("deptUser",o.data.data.list)})},this.getUserList=s=>{this.getDeptUserList(s)},this.checkOne=(s,e,r)=>{var o=this.state.checkedCount;if(e==="list"){var m=this.context[this.state.listType].find(Z=>Z.id===s);m.isChecked=r,o=r?o+1:o-1,this.context.checkListOne(m,this.state.checkedListType,this.state.listType)}else if(e==="user"){var c=this.context[this.state.checkedUserType].find(Z=>Z.id===s);c.isChecked=r,o=r?o+1:o-1,this.context.checkUserOne(c,this.state.checkedUserType)}this.updateCheckedCount(o)},this.updateCheckedCount=s=>{this.setState({checkedCount:s})},this.checkAll=s=>{var e=this.state.contextData.breadNav[this.state.contextData.breadNav.length-1].value,r=[...this.context[this.state.checkedListType]],o=this.context[this.state.listType].map(Z=>{Z.isChecked=s,this.props.type!=="dept"&&r.forEach(J=>{J.parentId.indexOf("".concat(Z.id))!==-1&&(J.isChecked=!1)});var X=r.findIndex(J=>J.id===Z.id);return X!==-1?r[X].isChecked=s:r.push(Z),Z}),m=[];this.context.checkedUser.forEach(Z=>{if(this.props.type!=="dept"){if(typeof Z.parentId!="undefined"&&Z.parentId.indexOf("".concat(e))!==-1&&Z.parentId[Z.parentId.length-1]!==e)return}else{var X=typeof Z.parentId!="undefined"?Z.parentId:Z.department_ids||[];if(X.indexOf(e)!==-1)return}m.push(Z)});var c=Ct.includes(this.state.listType)?[]:this.context[this.state.checkedUserType].map(Z=>{Z.isChecked=s;var X=m.findIndex(J=>J.id===Z.id);return X!==-1?m[X].isChecked=s:m.push(Z),Z});this.context.toggleDisplayList(this.state.checkedListType,r,this.state.listType,o,this.state.checkedUserType,c,m),this.setState({checkedCount:s?(Ct.includes(this.state.listType)?0:this.context[this.state.checkedUserType].length)+this.context[this.state.listType].length:0})},this.nextLevel=(s,e,r)=>{this.context.clearTabPanelList(this.state.listType,this.state.checkedUserType);var o=[...this.state.contextData.breadNav,{value:s,label:e}];this.setState({contextData:(0,n.Z)((0,n.Z)({},this.state.contextData),{},{breadNav:o})},()=>{this.nextDeptLevel(s),this.getUserList(s===vt?gt:s)})},this.nextDeptLevel=s=>{if(this.context.asyncDeptTree)this.getDeptList(s);else{var e=this.state.deptList[s];typeof e!="undefined"&&e.forEach(r=>{r.parentId=this.state.contextData.breadNav.map(o=>o.value),r.userCount=r.user_count,r.name=r.department_name}),this.context.initTypeList("deptList","checkedDept",e||[])}this.getDeptUserList(s)},this.changeLevel=(s,e)=>{this.context.clearTabPanelList(this.state.listType,this.state.checkedUserType);var r=this.props.type==="group"?[this.state.contextData.breadNav[0]]:this.state.contextData.breadNav.slice(0,e+1);this.setState({contextData:(0,n.Z)((0,n.Z)({},this.state.contextData),{},{breadNav:r}),isSearch:!1},()=>{this.changeDeptLevel(s)})},this.changeDeptLevel=s=>{if(this.context.asyncDeptTree)this.getDeptList(s);else{var e=this.state.deptList[s];e.forEach(r=>{r.parentId=this.state.contextData.breadNav.map(o=>o.value),r.userCount=r.user_count,r.name=r.department_name}),this.context.initTypeList("deptList","checkedDept",e)}this.getDeptUserList(s===vt?gt:s)},this.state={deptList:[],contextData:{breadNav:[this.props.defaultBreadNav],checkOne:this.checkOne,checkAll:this.checkAll,nextLevel:this.nextLevel,changeLevel:this.changeLevel},checkedCount:0,listType:"".concat(this.props.type,"List"),checkedListType:"checked".concat(this.props.type.charAt(0).toUpperCase()).concat(this.props.type.substr(1)),checkedUserType:"".concat(this.props.type,"User"),isSearch:!1,searchResult:[],loadDept:!1,loadUser:!1}}componentDidMount(){this.getDefaultBread()}getDefaultBread(){this.setState({contextData:(0,n.Z)((0,n.Z)({},this.state.contextData),{},{breadNav:[{value:"root",label:"".concat(this.props.t("common.all")).concat(this.props.t("marketing.contactTitle"))}]})}),this.getDeptList("root"),this.getDeptUserList("root")}render(){return a().createElement(Ne.Provider,{value:this.state.contextData},a().createElement("div",{className:"org-display-container org-display-dept"},a().createElement(Ht,null),this.props.type==="dept"&&(this.state.loadDept||this.state.loadUser)?a().createElement("div",{className:"dept-loading"},a().createElement(tt.Z,null)):null,a().createElement(zt,{dataTypeKey:this.props.type})))}}lt.contextType=Ue;var Ht=(0,Qe.l)(Ne,it),zt=(0,Qe.l)(Ne,$t);lt.defaultProps={defaultBreadNav:{value:"",label:"\u9177\u6E32\u79D1\u6280"},queryType:1,type:"dept"};var ft=(0,M.Z)()(lt),Gt=t(54549),ct=t(60667);class Et extends a().Component{constructor(){super(...arguments);this.removeItem=(i,s,e,r)=>{i.preventDefault(),s.isChecked=!1,r==="user"?this.context.removeCheckedUser(s):this.context.checkListOne(s,e,"".concat(r,"List"))},this.displayName=(i,s)=>{var e={user:"userName",dept:"departmentName"}[i]||"";return a().createElement(ct.Z,{value:i==="dept"?s.id:s.user_id,name:s.name,type:s.source_type,dataType:e})},this.displayItem=i=>{var s="checked".concat(i.charAt(0).toUpperCase()).concat(i.substr(1)),e=this.context[s].map(r=>r.isChecked?a().createElement(O.Z,{placement:"top",title:r.all_name||"",getPopupContainer:()=>document.querySelector(".checked-display-container")},a().createElement("div",{className:"display-item",key:r.id},this.displayName(i,r),i!=="user"?"(".concat(r.userCount,")"):"",r.reserve?null:a().createElement("span",{className:"display-item-close",onClick:o=>this.removeItem(o,r,s,i)},a().createElement(Gt.Z,{style:{fontSize:"8px",color:"#afb5d2"}})))):null);return e}}render(){var i=["dept","user"].map(s=>this.displayItem(s));return a().createElement("div",{className:"checked-display-container"},i)}}Et.contextType=Ue;var Qt=Et,Yt=t(6793),Xt=De.Z.Search;class Jt extends a().Component{constructor(i){super(i);this.search=(s,e)=>{e.preventDefault(),!(!s&&!this.props.showCancel)&&this.props.onSearch(s)},this.onChange=s=>{s.preventDefault(),this.setState({value:s.target.value}),!(!s.target.value&&!this.props.showCancel)&&(this.props.disableChange||(0,Yt.Ds)(this.debounceChange,500)())},this.debounceChange=()=>{this.props.onSearch(this.state.value)},this.state={value:""}}render(){var i=this.props,s=i.t,e=i.selectType;return a().createElement("div",{className:"top-search"},a().createElement(Xt,{placeholder:e==="user"?"".concat(s("course.search")).concat(s("marketing.contactTitle")):e==="dept"?"".concat(s("course.search")).concat(s("marketing.contactGroup")):s("component.searchPost"),value:this.state.value,onSearch:this.search,allowClear:!0,onChange:this.onChange}))}}var qt=(0,M.Z)()(Jt),ea=t(87312);class dt extends w.Component{constructor(){super(...arguments);this.checkUser=(i,s)=>{s.isChecked=!0,this.context.checkUserOne(s,"checkedUser")},this.checkDept=(i,s)=>{s.isChecked=!0,this.context.checkListOne(s,"checkedDept","deptList")}}render(){var i=this.props.t;return a().createElement("div",{className:"search-result-container more-height"},this.props.list.length>0?this.renderList():a().createElement(ea.Z,{tipText:i("component.searchUserEmpty")}))}renderList(){var i=this.props,s=i.userListType,e=i.list,r=i.t;if(s==="user")return e.map(o=>a().createElement("div",{className:"search-result-item",key:o.id,onClick:m=>{this.checkUser(m,o)}},a().createElement("div",{className:"user-name"},o.name)));if(s==="dept")return e.map(o=>a().createElement("div",{className:"search-result-department-item",key:o.id,onClick:m=>{this.checkDept(m,o)}},a().createElement("div",{className:"department-left"},a().createElement("div",{className:"user-name"},o.name),o.path&&o.path.length>0?a().createElement(O.Z,{title:o.path.join(">"),mouseEnterDelay:.8},a().createElement("span",{className:"user-name-dept"},a().createElement("span",null,o.path.join(">")))):null),a().createElement("div",{className:"department-right"},"(",o.userCount,r("common.userUnit"),")")))}}dt.contextType=Ue,dt.defaultProps={list:[]};var ta=(0,M.Z)()(dt),aa=t(18329),sa=Ze.Z.TabPane,yt=xe.Z.Option,_t={size:"medium",destroyOnClose:!0,bodyStyle:{padding:"0 20px"},maskClosable:!1};class Pt extends a().Component{constructor(i){var s;super(i);s=this,this.getListParentId=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],o=e.concat(r).map(c=>c.id),m=r.map(c=>c.id);o||m?(e.forEach(c=>{c.isChecked=!0,c.parentId=[c.parent_id],c.userCount=c.userCount||c.user_count||0}),r.forEach(c=>{c.isChecked=!0,c.parentId=[c.parent_id]}),s.setState({contextData:(0,n.Z)((0,n.Z)({},s.state.contextData),{},{checkedDept:e,checkedUser:r})})):s.setState({contextData:(0,n.Z)((0,n.Z)({},s.state.contextData),{},{checkedDept:[],checkedUser:[]})})},this.initTypeList=(e,r,o)=>{o.forEach(m=>{var c=this.findItemIndex(m.id,r);c===-1?m.isChecked=!1:m.isChecked=this.state.contextData[r][c].isChecked}),this.setState({contextData:(0,n.Z)((0,n.Z)({},this.state.contextData),{},{[e]:o})})},this.initTypeUser=(e,r)=>{var o=r||[...this.state.contextData[e]],m=this.props.reserveUser;o.forEach(c=>{var Z=this.findItemIndex(c.id,"checkedUser");m.findIndex(X=>X.id===c.id)!==-1&&(c.reserve=!0),Z===-1?c.isChecked=!1:c.isChecked=this.state.contextData.checkedUser[Z].isChecked}),this.setState({contextData:(0,n.Z)((0,n.Z)({},this.state.contextData),{},{[e]:o})})},this.toggleDisplayItem=(e,r)=>{var o=this.findItemIndex(e.id,r);return o===-1?r.match(/checkedDept/)?{[r]:this.checkListParentId(r,e),checkedUser:e.isChecked?this.checkParentId(this.state.contextData.checkedUser,e.id):this.state.contextData.checkedUser}:{[r]:[...this.state.contextData[r],e]}:r.match(/checkedDept/)?{[r]:this.checkListParentId(r,e),checkedUser:e.isChecked?this.checkParentId(this.state.contextData.checkedUser,e.id):this.state.contextData.checkedUser}:{checkedUser:this.getNewList(e,"checkedUser",!0),[r]:this.getNewList(e,r)}},this.toggleDisplayList=(e,r,o,m,c,Z,X)=>{this.setState({contextData:(0,n.Z)((0,n.Z)({},this.state.contextData),{},{[e]:r,[o]:m,[c]:Z,checkedUser:X})})},this.checkUserOne=(e,r)=>{this.props.single?this.setState({contextData:(0,n.Z)((0,n.Z)({},this.state.contextData),{},{checkedUser:[e],[r]:r==="checkedUser"?[e]:this.getSingleUserList(e,r)})}):this.setState({contextData:(0,n.Z)((0,n.Z)({},this.state.contextData),this.toggleDisplayItem(e,r))})},this.checkListOne=(e,r,o)=>{this.setState({contextData:(0,n.Z)((0,n.Z)({},this.state.contextData),{},{[o]:this.getNewList(e,o,!1)},this.toggleDisplayItem(e,r))},()=>{console.log("context",this.state.contextData)})},this.checkListParentId=(e,r)=>{var o=[...this.state.contextData[e]],m=this.findItemIndex(r.id,e);return o.forEach(c=>{c.id!==r.id&&c.parentId.indexOf("".concat(r.id))!==-1?c.isChecked=!1:c.id===r.id&&(c.isChecked=r.isChecked)}),m===-1&&o.push(r),o},this.checkParentId=(e,r)=>{var o=[];return e.forEach(m=>{var c=typeof m.parentId!="undefined"?m.parentId:m.department_ids||[];c.indexOf(r)===-1&&o.push(m)}),o},this.removeCheckedUser=e=>{this.setState({contextData:(0,n.Z)((0,n.Z)({},this.state.contextData),{},{checkedUser:this.getNewList(e,"checkedUser"),deptUser:this.getNewList(e,"deptUser")})})},this.getNewList=(e,r,o)=>{var m=[...this.state.contextData[r]],c=this.findItemIndex(e.id,r);return c===-1?o&&m.push(e):m[c].isChecked=e.isChecked,m},this.getSingleUserList=(e,r)=>{var o=[...this.state.contextData[r]];return o.forEach(m=>{m.id===e.id?m.isChecked=e.isChecked:m.isChecked=!1}),o},this.findItemIndex=(e,r)=>this.state.contextData[r].findIndex(o=>o.id===e),this.clearTabPanelList=(e,r)=>{this.setState({contextData:(0,n.Z)((0,n.Z)({},this.state.contextData),{},{[e]:[],[r]:[]})})},this.onCancel=()=>{var e=this.props.onCancel;this.setState({showCancel:!1}),e&&this.props.onCancel()},this.onOk=()=>{var e=this.props.onOk,r=this.state.contextData;this.setState({showCancel:!1});var o=0;if(e){var m=[];r.checkedDept.map(Z=>(o+=Z.isChecked?Z.user_count:0,Z.isChecked?m.push((0,n.Z)((0,n.Z)({},Z),{},{renderType:"dept"})):null));var c=[];if(r.checkedUser.map(Z=>{if(!Z.reserve)return o+=Z.isChecked?1:0,Z.isChecked?c.push((0,n.Z)((0,n.Z)({},Z),{},{renderType:"user"})):null}),o>this.props.maxUserCount){_.default.warn(this.props.beyondLimitTip);return}e({dept:m,user:c})}},this.getTabs=()=>{var e=[],r,o,m=this.props.t;return this.state.displayType.forEach(c=>{switch(c){case"dept":e.push({label:m("component.orgDialogDeptLabel"),key:"dept",defaultBreadNav:{value:"",label:""},queryType:1});break;case"post":e.push({label:m("component.orgDialogPostLabel"),key:"post",defaultBreadNav:{value:"",label:""},queryType:3});break;default:break}}),e.length===1?o=a().createElement(ft,{defaultBreadNav:e[0].defaultBreadNav,queryType:e[0].queryType,type:e[0].key}):(r=e.map(c=>a().createElement(sa,{tab:c.label,key:c.key},a().createElement(ft,{defaultBreadNav:c.defaultBreadNav,queryType:c.queryType,type:c.key}))),o=a().createElement(Ze.Z,null,r)),o},this.handleSearch=e=>{var r=this.state.selectType;r==="user"?this.getUserList(e):r==="dept"&&this.getDeptList(e)},this.getUserList=e=>{var r=B.ZP.market.getListConcatPersonInfo({deptId:"root"}),o={search_key:e,status:""};k.WY.get({url:r,params:o}).then(m=>{this.setState({searchResult:m.data.data.list||[],showCancel:!0})})},this.getDeptList=e=>{var r=B.ZP.market.getConcatTree(),o={parent_id:"",search_key:e};k.WY.get({url:r,params:o}).then(m=>{m.data.data&&m.data.data.forEach(c=>{c.name=c.group_name,c.userCount=c.user_count}),this.setState({searchResult:m.data.data||[],showCancel:!0})})},this.handleCancel=()=>{this.setState({showCancel:!1})},this.handleSelectChange=e=>{this.setState({selectType:e,searchResult:[]})},this.state={title:i.title||i.t("component.chooseAssignScope"),displayType:i.displayType?i.displayType:["dept"],selectType:"user",showCancel:!1,contextData:{deptList:[],deptUser:[],checkedDept:[],checkedUser:[],searchResult:[],onlyUser:i.onlyUser,onlyDept:i.onlyDept,onlyPost:i.onlyPost,single:i.single,asyncDeptTree:this.props.asyncDeptTree,oneDisplayType:this.props.displayType?this.props.displayType.length<=1:!0,userType:this.props.userType,initTypeList:this.initTypeList,initTypeUser:this.initTypeUser,toggleDisplayItem:this.toggleDisplayItem,toggleDisplayList:this.toggleDisplayList,checkListOne:this.checkListOne,checkUserOne:this.checkUserOne,removeCheckedUser:this.removeCheckedUser,clearTabPanelList:this.clearTabPanelList,maxDeptUserCount:i.maxDeptUserCount}}}componentDidUpdate(i){if(i.visible!==this.props.visible&&this.props.visible){var s=this.props.initData,e=s.dept,r=s.user,o=this.props,m=o.reserveUser,c=o.t,Z=o.onlyUser,X=o.onlyDept;m.forEach(J=>{J.reserve=!0}),this.setState({title:this.props.title||c("component.chooseAssignScope"),displayType:this.props.displayType?this.props.displayType:["dept"],selectType:Z?"user":X?"dept":"user",contextData:(0,n.Z)((0,n.Z)({},this.state.contextData),{},{deptList:[],deptUser:[],onlyUser:this.props.onlyUser,onlyDept:this.props.onlyDept,onlyPost:this.props.onlyPost,asyncDeptTree:this.props.asyncDeptTree,oneDisplayType:this.props.displayType?this.props.displayType.length<=1:!0})},()=>{this.getListParentId(e,r.concat(m))})}}render(){var i=this.getTabs(),s=this.props,e=s.t,r=s.onlyUser,o=s.onlyDept,m=s.onlyPost,c=this.state,Z=c.showCancel,X=c.selectType,J=c.searchResult;return _t.okText=this.props.okText||e("common.ok"),a().createElement(aa.ZP,(0,N.Z)({},_t,this.props.modalConfig,{visible:this.props.visible,title:this.state.title,wrapClassName:this.props.className,onCancel:this.onCancel,onOk:this.onOk}),a().createElement(Ue.Provider,{value:this.state.contextData},a().createElement("div",{className:"cl-org"},a().createElement("div",{className:"cl-org-left"},this.props.visible?a().createElement("div",{className:"cl-org-left__top"},a().createElement(xe.Z,{className:"cl-org-left__top__select",value:X,style:{width:100},onChange:this.handleSelectChange},a().createElement(yt,{value:"user",disabled:o||m},e("marketing.contactTitle")),a().createElement(yt,{value:"dept",disabled:r},e("marketing.contactGroup"))),a().createElement(qt,{selectType:X,onSearch:this.handleSearch,showCancel:Z,disableChange:this.props.disableChange}),Z?a().createElement("div",{className:"cl-org-left__top__cancel",onClick:this.handleCancel},e("common.cancel")):null):null,Z?a().createElement(ta,{list:J,userListType:X}):i),a().createElement("div",{className:"cl-org-right"},a().createElement(Qt,null)))))}}Pt.defaultProps={visible:!0,displayType:["dept"],initData:{dept:[],post:[],group:[],user:[]},reserveUser:[],onlyUser:!1,onlyDept:!1,onlyPost:!1,asyncDeptTree:!0,userType:"active",single:!1,maxUserCount:Infinity,beyondLimitTip:"",onOk:()=>{},modalConfig:{},maxDeptUserCount:0};var ra=(0,M.Z)()(Pt),na=Ce=>{var i=Ce.advancedSetting;return{themeColor:i.themeColor}},ia=()=>{};class It extends a().Component{constructor(i){var s;super(i);s=this,this.getSetting=()=>{k.WY.get({url:B.ZP.advancedSetting.getSettingStatusByType("jurisdiction_setting"),params:{}}).then(e=>{this.setState({resourceViewRange:JSON.parse(e.data.actions)[1].param.checked==="true"})})},this.handleChange=e=>{var r=e.target.value;this.setState({rangeType:r}),this.triggerChange({rangeType:r,rangeList:this.state.rangeList})},this.triggerChange=e=>{var r=e.rangeType,o=e.rangeList,m=this.props.onChange;m({rangeType:r,rangeList:o})},this.handleOk=e=>{this.setRangeList(e)},this.setRangeList=e=>{var r=e.dept,o=e.user,m={dept:r,user:o};this.setState({rangeList:m,visible:!1}),this.triggerChange({rangeType:this.state.rangeType,rangeList:m})},this.handleCancel=()=>{this.setOrgModalVisibility(!1)},this.handleDeleteItem=e=>{var r=(0,n.Z)({},this.state.rangeList),o,m;for(var c in r)if(o=r[c].findIndex(X=>X.id===e),o>-1){m=c;break}var Z=[...r[m]];Z.splice(o,1),r[m]=Z,this.setState({rangeList:r}),this.triggerChange({rangeType:this.state.rangeType,rangeList:r})},this.setOrgModalVisibility=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ia;s.setState({visible:e,rangeType:2},()=>{r()})},this.renderRadioGroup=()=>{var e=this.props.prefixCls;return a().createElement("div",{className:"".concat(e,"__radios")},this.renderRadios())},this.renderRadios=()=>{var e=this.props,r=e.mode,o=e.t,m=e.prefixCls,c=e.rangeAuth,Z=e.disabledAdd,X=e.themeColor,J=this.props.partLabel,te=J===void 0?o("common.deptAndStu"):J,le=this.state.resourceViewRange;return Z?null:a().createElement(Le.ZP.Group,{name:"rangeGroup",value:this.state.rangeType,disabled:this.props.disabled,onChange:this.handleChange},r.includes("all")&&a().createElement(Le.ZP,{value:1},o("common.allCompany"),c&&le&&a().createElement(O.Z,{title:o("setting.selectPeopleTip")},a().createElement("span",null,a().createElement(st.Z,null)))),r.includes("private")&&a().createElement(Le.ZP,{value:3},o("common.onlySelf")),r.includes("part")&&r.length>1&&a().createElement(Le.ZP,{value:2},te),a().createElement(y.Z,{className:"".concat(m,"__addbtn qa-assign-employee-selector"),icon:a().createElement(R.Z,null),style:{color:X,border:"1px solid ".concat(X)},disabled:!1,onClick:()=>this.setOrgModalVisibility(!0)},o("common.select")))},this.renderGallery=()=>{var e=this.props.prefixCls,r=this.state.rangeType;return r!=2?null:a().createElement("div",{className:"".concat(e,"__gallery")},this.renderGropuGallery(),this.renderUserGallery())},this.renderGropuGallery=()=>{var e=this.props,r=e.prefixCls,o=e.t,m=this.state.rangeList.dept,c=[...m];return c.length?a().createElement(a().Fragment,null,a().createElement("div",{className:"".concat(r,"__gallery__row cl-clearfix content-wrapper")},a().createElement("span",{className:"".concat(r,"__gallery__row__title")},o("common.selectedGroups"),"\uFF1A"),a().createElement("div",{className:"".concat(r,"__gallery__row__container cl-clearfix scroll-style")},c.map(Z=>this.renderGalleryItem(Z))))):null},this.renderUserGallery=()=>{var e=this.props,r=e.prefixCls,o=e.t,m=this.state.rangeList.user,c=[...m];return c.length?a().createElement("div",{className:"".concat(r,"__gallery__row cl-clearfix content-wrapper")},a().createElement("span",{className:"".concat(r,"__gallery__row__title")},o("common.selectedClients"),"\uFF1A"),a().createElement("div",{className:"".concat(r,"__gallery__row__container cl-clearfix scroll-style")},c.map(Z=>this.renderGalleryItem(Z)))):null},this.renderGalleryItem=e=>{var r=this.props,o=r.prefixCls,m=r.disabled,c="".concat(o,"__gallery__row__item");return a().createElement("span",{className:c,key:e.id},a().createElement("div",{style:{display:"inline-block"}},e.name),m?null:a().createElement("span",{onClick:()=>this.handleDeleteItem(e.id)},a().createElement(I.Z,{iconClass:"icon-guanbi",size:"12px"})))},this.state={rangeType:i.rangeType,rangeList:i.rangeList||{},visible:!1}}componentDidMount(){this.getSetting()}render(){var i=this.props.prefixCls,s=this.state,e=s.rangeList,r=s.visible;return a().createElement("section",{className:"".concat(i)},this.renderRadioGroup(),this.renderGallery(),a().createElement(ra,{visible:r,initData:e,onOk:this.handleOk,onCancel:this.handleCancel}))}}It.defaultProps={prefixCls:"multi-login-employee-selector",showSectitle:!0,mode:[],orgProps:{},resourceViewRange:!1};var Tt=(0,A.$j)(na)((0,Ge.$j)((0,M.Z)()(It))),oa=Ce=>{var i=Ce.advancedSetting;return{themeColor:i.themeColor}};class la extends a().Component{constructor(){super(...arguments);this.onSignItem=(i,s)=>{this.props.onSignItem(i,s)},this.onChange=(i,s)=>{this.props.onChange(i,s)},this.onChangePhone=i=>{this.props.onChangePhone(i)}}render(){var i=this.props,s=i.t,e=i.initValues,r=i.themeColor,o={color:"".concat(r),border:"1px solid ".concat(r)};return a().createElement(a().Fragment,null,a().createElement("div",{className:"sign-info"},a().createElement("span",null,s("shareInfo.signInfo")),a().createElement("span",{className:"desc-text"},s("shareInfo.signInfoDesc"))),a().createElement("div",{className:"item-content"},a().createElement("div",{className:"item-wrapper column-left"},a().createElement("div",{style:e.disabledName?null:o,className:"item-left ".concat(e.disabledName?"item-unchecked":""),onClick:()=>this.onSignItem("name",e.disabledName)},a().createElement("span",null,s("shareInfo.signName")),a().createElement(L.Z,{checked:!0,disabled:e.disabledName,className:"checkout-sty"})),e.disabledName?null:a().createElement("div",null,a().createElement(L.Z,{checked:e.name.isCheckedMust,onChange:m=>this.onChange(m,"name")},s("shareInfo.signInfoMust")))),a().createElement("div",{className:"item-wrapper item-wrapper-phone"},a().createElement("div",{style:e.disabledPhone?null:o,className:"item-left item-left-phone ".concat(e.disabledPhone?"item-unchecked":"")},a().createElement("span",null,s("shareInfo.signPhone")),a().createElement(L.Z,{checked:!0,disabled:!0,className:"checkout-sty"})),a().createElement("div",null,a().createElement(L.Z,{checked:!0,disabled:!0,onChange:m=>this.onChange(m,"phone")},s("shareInfo.signInfoMust")),a().createElement(L.Z,{checked:!0,disabled:!0,onChange:this.onChangePhone},s("shareInfo.verifyPhone"))))),a().createElement("div",{className:"item-content"},a().createElement("div",{className:"item-wrapper column-left"},a().createElement("div",{style:e.disabledPosition?null:o,className:"item-left ".concat(e.disabledPosition?"item-unchecked":""),onClick:()=>this.onSignItem("position",e.disabledPosition)},a().createElement("span",null,s("shareInfo.signPosition")),a().createElement(L.Z,{checked:!0,disabled:e.disabledPosition,className:"checkout-sty"})),e.disabledPosition?null:a().createElement("div",null,a().createElement(L.Z,{checked:e.position.isCheckedMust,onChange:m=>this.onChange(m,"position")},s("shareInfo.signInfoMust")))),a().createElement("div",{className:"item-wrapper"},a().createElement("div",{style:e.disabledCompany?null:o,className:"item-left ".concat(e.disabledCompany?"item-unchecked":""),onClick:()=>this.onSignItem("company",e.disabledCompany)},a().createElement("span",null,s("shareInfo.signCompany")),a().createElement(L.Z,{checked:!0,disabled:e.disabledCompany,className:"checkout-sty"})),e.disabledCompany?null:a().createElement("div",null,a().createElement(L.Z,{checked:e.company.isCheckedMust,onChange:m=>this.onChange(m,"company")},s("shareInfo.signInfoMust"))))),a().createElement("div",{className:"item-content"},a().createElement("div",{className:"item-wrapper column-left"},a().createElement("div",{style:e.disabledSex?null:o,className:"item-left ".concat(e.disabledSex?"item-unchecked":""),onClick:()=>this.onSignItem("sex",e.disabledSex)},a().createElement("span",null,s("shareInfo.signSex")),a().createElement(L.Z,{checked:!0,disabled:e.disabledSex,className:"checkout-sty"})),e.disabledSex?null:a().createElement("div",null,a().createElement(L.Z,{checked:e.sex.isCheckedMust,onChange:m=>this.onChange(m,"sex")},s("shareInfo.signInfoMust")))),a().createElement("div",{className:"item-wrapper"},a().createElement("div",{style:e.disabledEmail?null:o,className:"item-left ".concat(e.disabledEmail?"item-unchecked":""),onClick:()=>this.onSignItem("email",e.disabledEmail)},a().createElement("span",null,s("shareInfo.signEmail")),a().createElement(L.Z,{checked:!0,disabled:e.disabledEmail,className:"checkout-sty"})),e.disabledEmail?null:a().createElement("div",null,a().createElement(L.Z,{checked:e.email.isCheckedMust,onChange:m=>this.onChange(m,"email")},s("shareInfo.signInfoMust"))))),a().createElement("div",{className:"item-content"},a().createElement("div",{className:"item-wrapper column-left"},a().createElement("div",{style:e.disabledWeChat?null:o,className:"item-left ".concat(e.disabledWeChat?"item-unchecked":""),onClick:()=>this.onSignItem("weChat",e.disabledWeChat)},a().createElement("span",null,s("shareInfo.signWeChat")),a().createElement(L.Z,{checked:!0,disabled:e.disabledWeChat,className:"checkout-sty"})),e.disabledWeChat?null:a().createElement("div",null,a().createElement(L.Z,{checked:e.weChat.isCheckedMust,onChange:m=>this.onChange(m,"weChat")},s("shareInfo.signInfoMust")))),a().createElement("div",{className:"item-wrapper"},a().createElement("div",{style:e.disabledRemark?null:o,className:"item-left ".concat(e.disabledRemark?"item-unchecked":""),onClick:()=>this.onSignItem("remark",e.disabledRemark)},a().createElement("span",null,s("shareInfo.signRemark")),a().createElement(L.Z,{checked:!0,disabled:e.disabledRemark,className:"checkout-sty"})),e.disabledRemark?null:a().createElement("div",null,a().createElement(L.Z,{checked:e.remark.isCheckedMust,onChange:m=>this.onChange(m,"remark")},s("shareInfo.signInfoMust"))))))}}var Dt=(0,A.$j)(oa)((0,M.Z)()(la)),ca=t(21049),St=Ze.Z.TabPane;class Lt extends a().Component{constructor(){super(...arguments);this.handleSwitch=i=>{this.props.handleSwitch(i)},this.onChangeTab=i=>{this.props.onChangeTab(i)},this.onRadioChange=i=>{this.props.onRadioChange(i)},this.handleChangeEmployeeRange=i=>{this.props.handleChangeEmployeeRange(i)},this.handleSignSwitch=i=>{this.props.handleSignSwitch(i)},this.onSignItem=(i,s)=>{this.props.onSignItem(i,s)},this.onChange=(i,s)=>{this.props.onChange(i,s)},this.onChangePhone=i=>{this.props.onChangePhone(i)},this.onLimitPersonChange=i=>{this.props.onLimitPersonChange(i)},this.onRadioApproveChange=i=>{this.props.onRadioApproveChange(i)},this.handleCollectInfoSwitch=i=>{this.props.handleCollectInfoSwitch(i)},this.handleHideCourseSwitch=i=>{this.props.handleHideCourseSwitch(i)},this.onHideCourseChange=i=>{this.props.onHideCourseChange(i)},this.onHideCoursewareChange=i=>{this.props.onHideCoursewareChange(i)},this.changePerm=i=>{this.props.changePerm(i)},this.selectOfficialAccount=(i,s)=>{this.props.selectOfficialAccount(i,s)},this.handleEmployeeCardSwitch=i=>{this.props.handleEmployeeCardSwitch(i)},this.handleDeleteCover=()=>{this.props.handleDeleteCover()},this.handleCoverChange=i=>{this.props.handleCoverChange(i)},this.onSignLimitChange=i=>{this.props.onSignLimitChange(i)},this.onHideContentPercentChange=i=>{this.props.onHideContentPercentChange(i)}}render(){var i=this.props,s=i.prefixCls,e=i.t,r=i.initValues,o=i.authorize_info_list,m=i.formRef,c=r.rangeType,Z=r.rangeList,X=r.inintRangeList,J=r.isOpenSign,te={labelCol:{span:3},wrapperCol:{span:21}},le={labelCol:{span:4},wrapperCol:{span:21}},pe={display:"block",height:"30px",lineHeight:"30px"};return a().createElement("div",{className:s},a().createElement("div",{className:"isOpenShare-switch"},a().createElement("span",{className:"isOpenShare-text"},e("common.shareSwitch")),a().createElement(P.Z,{checked:r.isOpenShare,onChange:this.handleSwitch,disabled:!1})),r.isOpenShare?a().createElement(Ze.Z,{defaultActiveKey:r.tabType,onChange:this.onChangeTab},a().createElement(St,{tab:e("shareInfo.basicSetting"),key:"basicSetting"},a().createElement("div",{className:"".concat(s,"_form")},a().createElement(Pe.Z,(0,N.Z)({name:"share_basic"},te,{ref:m,labelAlign:"left",initialValues:r,requiredMark:!1}),a().createElement(Pe.Z.Item,{name:"radioShareScene",label:e("shareInfo.shareScene")},a().createElement(Le.ZP.Group,{onChange:this.onRadioChange,value:r.radioShareScene},a().createElement(Le.ZP,{style:pe,value:"customer_training",className:"radio-sty"},e("shareInfo.customerTraining"),a().createElement("span",{className:"desc-text"},e("shareInfo.customerDesc"))),a().createElement(Le.ZP,{style:pe,value:"market"},e("shareInfo.marketing"),a().createElement("span",{className:"desc-text"},e("shareInfo.marketingDesc"))))),r.radioShareScene=="customer_training"?a().createElement(a().Fragment,null,a().createElement(Pe.Z.Item,{label:e("shareInfo.selectUser")},X.dept.length>0||X.user.length>0?a().createElement(Tt,{rangeType:c,rangeList:Z.dept.length>0||X.user.length>0?Z:{dept:[],user:[]},onChange:this.handleChangeEmployeeRange}):null,X.dept.length>0||X.user.length>0?null:a().createElement(Tt,{rangeType:c,rangeList:Z.dept.length>0?Z:{dept:[],user:[]},onChange:this.handleChangeEmployeeRange})),a().createElement(Pe.Z.Item,{label:e("shareInfo.signSetting"),valuepropname:J,key:J},a().createElement(P.Z,{defaultChecked:J,onChange:this.handleSignSwitch,disabled:!1}),a().createElement("span",{className:"desc-text"},e("shareInfo.signSettingDesc")),r.isOpenSign?a().createElement(a().Fragment,null,a().createElement(Dt,{initValues:r,onSignItem:(ue,de)=>this.onSignItem(ue,de),onChange:(ue,de)=>this.onChange(ue,de),onChangePhone:this.onChangePhone}),a().createElement("div",{className:"limit-info"},a().createElement("span",null,e("shareInfo.signLimit")),a().createElement(L.Z,{checked:r.isCheckedLimitPerson,onChange:this.onLimitPersonChange},e("shareInfo.signLimitPerson")),a().createElement(ke.Z,{precision:0,min:1,defaultValue:r.limitPerson,disabled:r.disabledLimitPerson,onChange:this.onSignLimitChange}),a().createElement("span",{style:{marginLeft:"8px"}},e("shareInfo.signLimitUnit")),r.isCheckedLimitPerson&&r.limitPerson<1?a().createElement("div",{className:"error-sty"},e("shareInfo.signLimitPersonError")):null),a().createElement("div",{className:"signUp-info"},a().createElement("span",null,e("shareInfo.signApprove")),a().createElement(Le.ZP.Group,{onChange:this.onRadioApproveChange,value:r.radioSignApprove},a().createElement(Le.ZP,{value:"automatic"},e("shareInfo.signAutomaticApprove")),a().createElement(Le.ZP,{value:"manual"},e("shareInfo.signManualApprove"))))):null)):null,r.radioShareScene=="market"?a().createElement(a().Fragment,null,a().createElement(Pe.Z.Item,{label:e("shareInfo.collectInfo"),valuepropname:r.isOpenCollectInfo,key:"isOpenCollectInfo"},a().createElement(P.Z,{defaultChecked:r.isOpenCollectInfo,onChange:this.handleCollectInfoSwitch,disabled:!1}),a().createElement("span",{className:"desc-text"},e("shareInfo.signSettingDesc")),r.isOpenCollectInfo?a().createElement(a().Fragment,null,a().createElement(Dt,{initValues:r,onSignItem:(ue,de)=>this.onSignItem(ue,de),onChange:(ue,de)=>this.onChange(ue,de),onChangePhone:this.onChangePhone})):null),a().createElement(Pe.Z.Item,(0,N.Z)({label:e("shareInfo.hideCourseContent")},le,{valuepropname:r.isOpenHideCourse,key:"isOpenHideCourse"}),a().createElement(P.Z,{defaultChecked:r.isOpenHideCourse,onChange:this.handleHideCourseSwitch,disabled:!1}),a().createElement("span",{className:"desc-text"},e("shareInfo.hideCourseContentDesc")),r.isOpenHideCourse?a().createElement(a().Fragment,null,a().createElement("div",{style:{marginTop:"24px"}},a().createElement(L.Z,{checked:r.isCheckedHideContent,onChange:this.onHideCourseChange},e("shareInfo.hideContent")),a().createElement(ke.Z,{precision:2,min:.01,max:100,defaultValue:r.hideContentPercent,disabled:r.disabledHideContent,onChange:this.onHideContentPercentChange}),a().createElement("span",{style:{marginLeft:"8px",marginRight:"40px"}},"%"),a().createElement(L.Z,{checked:r.isCheckedHideCourseware,onChange:this.onHideCoursewareChange},e("shareInfo.hideCourseware")),r.isCheckedHideContent&&r.hideContentPercent<.01?a().createElement("div",{className:"error-hide-sty"},e("shareInfo.hideContentError")):null)):null)):null,a().createElement(Pe.Z.Item,(0,N.Z)({label:e("shareInfo.weChatAuthorization"),style:{marginBottom:"16px"}},le,{colon:!0,className:"".concat(s,"_form_specials")}),a().createElement("span",{className:"desc-text"},e("shareInfo.weChatAuthorizationDesc"))),a().createElement(Pe.Z.Item,{colon:!1,className:"".concat(s,"_form_specials")},a().createElement(Ee.Z,{gutter:8},a().createElement(Oe.Z,{span:12},a().createElement(Pe.Z.Item,{name:"selectCount",colon:!1,rules:[{required:!0,message:e("shareInfo.selectWeiInfo")}]},a().createElement(xe.Z,{placeholder:e("shareInfo.selectCountWay"),allowClear:!0,width:200,onChange:this.changePerm},a().createElement(xe.Z.Option,{value:"select"},e("shareInfo.selectMine")),a().createElement(xe.Z.Option,{value:"all"},e("shareInfo.selectOfficial"))))),a().createElement(Oe.Z,{span:12},a().createElement(Pe.Z.Item,{noStyle:!0,shouldUpdate:(ue,de)=>ue.selectCount!==de.selectCount},ue=>{var de=ue.getFieldValue;return de("selectCount")==="select"?a().createElement(Pe.Z.Item,{name:"officialAccountId",colon:!1,rules:[{required:!0,message:e("shareInfo.pleaseSelectService")}]},a().createElement(xe.Z,{placeholder:e("shareInfo.pleaseSelectService"),allowClear:!0,width:200,onChange:this.selectOfficialAccount},o.map(ye=>a().createElement(xe.Z.Option,{info:ye,key:ye.auth_info_id,value:ye.authorizer_app_id},ye.name)))):null})))),r.radioShareScene=="market"?a().createElement(a().Fragment,null,a().createElement(Pe.Z.Item,{label:e("shareInfo.employeeCard"),valuepropname:r.isOpenEmployeeCard,key:"isOpenEmployeeCard"},a().createElement("div",{className:"employee-card"},a().createElement(P.Z,{defaultChecked:r.isOpenEmployeeCard,onChange:this.handleEmployeeCardSwitch,disabled:!1}),a().createElement("div",{className:"desc-text",style:{width:"564px"}},e("shareInfo.employeeCardDesc"))))):null))),a().createElement(St,{tab:e("shareInfo.shareSetting"),key:"shareSetting"},a().createElement(Pe.Z,(0,N.Z)({ref:m,className:"cl-form"},te,{labelAlign:"right"}),a().createElement(Pe.Z.Item,{style:{marginTop:"12px"},label:e("shareInfo.shareTitle"),colon:!0,name:"cardTitle"},a().createElement(De.Z,{defaultValue:r.cardTitle,placeholder:e("shareInfo.cardTitleTip"),maxLength:40})),a().createElement(Pe.Z.Item,{label:e("shareInfo.shareContent"),colon:!0,name:"cardContent"},a().createElement(De.Z.TextArea,{defaultValue:r.cardContent,autoSize:{minRows:3,maxRows:3},placeholder:e("shareInfo.cardContentTip"),maxLength:60})),a().createElement(Pe.Z.Item,{label:e("shareInfo.shareCover"),colon:!0,name:"cover"},a().createElement(ca.Z,{courseType:"graphic",handleDeleteCover:this.handleDeleteCover,defaultFieldList:r.cover,handleCoverChange:this.handleCoverChange}))))):null)}}Lt.defaultProps={prefixCls:"graphic-share-setting-page"};var da=(0,M.Z)()(Lt),ha=Ce=>{var i=Ce.user,s=Ce.resourceLibrary;return{userInfo:i,resourceLibrary:s}};class Rt extends a().PureComponent{constructor(i){super(i);this.formRef=a().createRef(),this.selectOfficialAccount=(s,e)=>{this.formRef.current.setFieldsValue({officialAccountId:s}),this.setState({initValues:(0,n.Z)((0,n.Z)({},this.state.initValues),{},{officialAccountId:s})}),this.setState({officialAccount:e&&e.children?e.children:""})},this.getAuthorizeList=()=>{(0,fe.iv)().then(s=>{var e=s.data.data.authorize_info_list;this.setState({authorize_info_list:e})})},this.getShareConfigs=()=>{var s=this.props,e=s.id,r=s.title,o=s.coverUrl;(0,fe.lK)(e).then(m=>{if(m.data.data&&m.data.data.app_id!==""){var c=m.data.data;if(c.open_share=="FALSE"){this.setState(Ie=>({initValues:(0,n.Z)((0,n.Z)({},Ie.initValues),{},{isOpenShare:!1,cardTitle:r,cover:o})})),this.setState({isAdd:!1,knowledge_id:c.knowledge_id});return}var Z,X,J,te,le,pe,ue,de={},ye=this.state.initValues,Me=ye.disabledName,be=ye.disabledPhone,Ae=ye.disabledPosition,We=ye.disabledCompany,Se=ye.disabledSex,Ke=ye.disabledEmail,Fe=ye.disabledWeChat,Ve=ye.disabledRemark;c.apply_info.forEach(Ie=>{Ie.site_name==="name"&&(Z={isCheckedMust:Ie.required_status==="TRUE"},Me=!1),Ie.site_name==="phone"&&(X={isCheckedMust:!0,isRequired:!0},be=!0),Ie.site_name==="position"&&(J={isCheckedMust:Ie.required_status==="TRUE"},Ae=!1),Ie.site_name==="company"&&(te={isCheckedMust:Ie.required_status==="TRUE"},We=!1),Ie.site_name==="sex"&&(le={isCheckedMust:Ie.required_status==="TRUE"},Se=!1),Ie.site_name==="email"&&(pe={isCheckedMust:Ie.required_status==="TRUE"},Ke=!1),Ie.site_name==="wechat"&&(ue={isCheckedMust:Ie.required_status==="TRUE"},Fe=!1),Ie.site_name==="remark"&&(de={isCheckedMust:Ie.required_status==="TRUE"},Ve=!1)}),this.setState({initValues:(0,n.Z)((0,n.Z)({},this.state.initValues),{},{isOpenShare:c.open_share=="TRUE",radioShareScene:c.share_type,rangeList:{dept:c.concat_person_group_infos||[],user:c.concat_person_infos||[]},inintRangeList:{dept:c.concat_person_group_infos||[],user:c.concat_person_infos||[]},isOpenSign:c.register_status==="TRUE",isOpenCollectInfo:c.share_type==="market"&&c.register_status==="TRUE",name:Z||this.state.initValues.name,phone:X||this.state.initValues.phone,position:J||this.state.initValues.position,company:te||this.state.initValues.company,sex:le||this.state.initValues.sex,email:pe||this.state.initValues.email,weChat:ue||this.state.initValues.weChat,remark:de||this.state.initValues.remark,disabledName:Me,disabledPhone:be,disabledPosition:Ae,disabledCompany:We,disabledSex:Se,disabledEmail:Ke,disabledWeChat:Fe,disabledRemark:Ve,limitPerson:c.restrict_num&&c.restrict_num>0?c.restrict_num:null,disabledLimitPerson:!(c.restrict_num&&c.restrict_num>0),isCheckedLimitPerson:!!(c.restrict_num&&c.restrict_num>0),radioSignApprove:c.approve_status==="MANUAL"?"manual":"automatic",isOpenHideCourse:c.hide_content_status==="TRUE",hideContentPercent:c.hide_content_percentage&&c.hide_content_percentage>0?c.hide_content_percentage:null,disabledHideContent:!(c.hide_content_percentage&&c.hide_content_percentage>0),isCheckedHideContent:!!(c.hide_content_percentage&&c.hide_content_percentage>0),isCheckedHideCourseware:c.hide_course_resource_status==="TRUE",isOpenEmployeeCard:c.open_staff_card==="TRUE",cardTitle:c.share_title,cover:c.share_image_url?c.share_image_url:o,cardContent:c.share_desc,officialAccountId:c.official_account_app_id})}),this.formRef.current.setFieldsValue({radioShareScene:c.share_type,officialAccountId:c.official_account_app_id,selectCount:c.official_account_app_id===ce.ZP.account?"all":"select",cardTitle:c.share_title,cardContent:c.share_desc}),this.setState({isAdd:!1,knowledge_id:c.knowledge_id,officialAccount:c.official_account,officialAccountNew:c.official_account_app_id===ce.ZP.account?ce.ZP.account:""})}else this.formRef.current.setFieldsValue({cardTitle:r,cover:o}),this.setState(Ie=>({initValues:(0,n.Z)((0,n.Z)({},Ie.initValues),{},{cardTitle:r,cover:o})}))})},this.doShare=s=>{var e=this.props.t;(0,fe.Ds)({source_knowledge_id:s,knowledge_type:"COURSE"}).then(r=>{var o=r.data,m=o.code,c=o.data;if(m===2e5||m==="200000"){var Z=this.props.cancelTipOpenWay;Z&&Z({shareUrl:"".concat(c.share_url,"&kid=").concat(this.props.id,"&eid=").concat(ce.ZP.enterpriseId,"&aid=").concat(ce.ZP.shareId),sourceKnowledgeId:this.props.id,shareScene:this.state.initValues.radioShareScene})}else _.default.error(e("study.operateFailed"))})},this.handleCancelShare=()=>{var s=this.props.onCancelShare;s&&s()},this.operate=s=>{if(s==="saveAndShare"){var e=this.state,r=e.officialAccount,o=e.officialAccountNew,m=e.isAdd,c=e.knowledge_id,Z=this.props,X=Z.id,J=Z.t,te=this.state.initValues,le=te.isOpenShare,pe=te.radioShareScene,ue=te.rangeList,de=te.isOpenSign,ye=te.disabledName,Me=te.disabledPosition,be=te.disabledCompany,Ae=te.disabledSex,We=te.disabledEmail,Se=te.disabledWeChat,Ke=te.disabledRemark,Fe=te.name,Ve=te.position,Ie=te.company,Oa=te.sex,xa=te.email,Ma=te.weChat,Za=te.remark,ba=te.isCheckedLimitPerson,wt=te.limitPerson,Aa=te.radioSignApprove,Ut=te.officialAccountId,wa=te.isOpenHideCourse,kt=te.hideContentPercent,Nt=te.isCheckedHideContent,Bt=te.isCheckedHideCourseware,Ua=te.isOpenEmployeeCard,Wt=te.isOpenCollectInfo,ka=te.cover;if(le&&!Ut){_.default.error(J("shareInfo.authorizationError"));return}if(le&&pe=="customer_training"&&ue.dept.length===0&&ue.user.length===0){_.default.error(J("shareInfo.selectUserError"));return}var we=[],Na={site_name:"name",check_status:"FALSE",required_status:Fe.isCheckedMust?"TRUE":"FALSE",name:"".concat(J("shareInfo.signName"))},Ba={site_name:"phone",check_status:"TRUE",required_status:"TRUE",name:"".concat(J("shareInfo.signPhone"))},Wa={site_name:"position",check_status:"FALSE",required_status:Ve.isCheckedMust?"TRUE":"FALSE",name:"".concat(J("shareInfo.signPosition"))},Ka={site_name:"company",check_status:"FALSE",required_status:Ie.isCheckedMust?"TRUE":"FALSE",name:"".concat(J("shareInfo.signCompany"))},Fa={site_name:"sex",check_status:"FALSE",required_status:Oa.isCheckedMust?"TRUE":"FALSE",name:"".concat(J("shareInfo.signSex"))},Va={site_name:"email",check_status:"FALSE",required_status:xa.isCheckedMust?"TRUE":"FALSE",name:"".concat(J("shareInfo.signEmail"))},ja={site_name:"wechat",check_status:"FALSE",required_status:Ma.isCheckedMust?"TRUE":"FALSE",name:"".concat(J("shareInfo.signWeChat"))},$a={site_name:"remark",check_status:"FALSE",required_status:Za.isCheckedMust?"TRUE":"FALSE",name:"".concat(J("shareInfo.signRemark"))};ye||we.push(Na),we.push(Ba),Me||we.push(Wa),be||we.push(Ka),Ae||we.push(Fa),We||we.push(Va),Se||we.push(ja),Ke||we.push($a);var Kt=le?this.formRef.current.getFieldValue().selectCount:"",Ha=le&&Object.keys(this.formRef.current.getFieldValue()).includes("cardContent")?this.formRef.current.getFieldValue().cardContent:this.state.initValues.cardContent,za=le&&Object.keys(this.formRef.current.getFieldValue()).includes("cardTitle")?this.formRef.current.getFieldValue().cardTitle:this.state.initValues.cardTitle,Ga=Kt||this.state.initValues.selectCount,Re={source_knowledge_id:X,knowledge_type:"course",auth_wechat:"TRUE",open_share:le?"TRUE":"FALSE",share_type:pe,official_account_app_id:Ga==="all"?o:Ut,official_account:r,share_title:za,share_desc:Ha,share_image_url:ka};if(pe=="customer_training"&&(Re.concat_person_group_ids=ue.dept.map(Je=>Je.id).join(","),Re.concat_person_ids=ue.user.map(Je=>Je.id).join(",")),(de||Wt)&&(Re.apply_info=we),pe=="customer_training"?Re.register_status=de?"TRUE":"FALSE":Re.register_status=Wt?"TRUE":"FALSE",de&&ba&&pe=="customer_training")if(wt>0)Re.restrict_num=wt;else return;else Re.restrict_num=0;if(de&&pe=="customer_training"&&(Re.approve_status=Aa=="automatic"?"AUTO":"MANUAL"),pe=="market"&&wa)if(Re.hide_content_status="TRUE",Re.hide_course_resource_status=Bt?"TRUE":"FALSE",Nt&&kt>0)Re.hide_content_percentage=kt;else if(Bt&&!Nt)Re.hide_content_percentage=0;else{_.default.error(J("shareInfo.hideCourseTips"));return}else Re.hide_content_status="FALSE";pe=="market"&&(Re.open_staff_card=Ua?"TRUE":"FALSE");var Qa={source_knowledge_id:X,knowledge_type:"course",auth_wechat:"TRUE",open_share:le?"TRUE":"FALSE"},Ya=le?Re:Qa;(0,fe.bS)(Ya,m).then(Je=>{var Ft=Je.data,Vt=Ft.code,Xa=Ft.data;Vt===2e5||Vt==="200000"?(_.default.success(J("common.saveSuccess")),le?this.doShare(m?Xa:c):this.handleCancelShare()):_.default.error(J("common.saveFailure"))})}s==="cancel"&&this.handleCancelShare()},this.handleSwitch=s=>{var e=this.props,r=e.title,o=e.coverUrl;this.setState(m=>({initValues:(0,n.Z)((0,n.Z)({},m.initValues),{},{isOpenShare:s,cardTitle:r,cover:o,officialAccountId:null})}))},this.handleSignSwitch=s=>{this.setState(e=>({initValues:(0,n.Z)((0,n.Z)({},e.initValues),{},{isOpenSign:s})}))},this.handleCollectInfoSwitch=s=>{this.setState(e=>({initValues:(0,n.Z)((0,n.Z)({},e.initValues),{},{isOpenCollectInfo:s})}))},this.handleEmployeeCardSwitch=s=>{this.setState(e=>({initValues:(0,n.Z)((0,n.Z)({},e.initValues),{},{isOpenEmployeeCard:s})}))},this.handleHideCourseSwitch=s=>{this.setState(e=>({initValues:(0,n.Z)((0,n.Z)({},e.initValues),{},{isOpenHideCourse:s,isCheckedHideContent:!1,disabledHideContent:!0,hideContentPercent:null,isCheckedHideCourseware:!1})}))},this.onChangeTab=s=>{var e=this.props,r=e.title,o=e.coverUrl,m=this.formRef.current.getFieldValue(),c=m.cardTitle,Z=c===void 0?"":c;this.setState(X=>({initValues:(0,n.Z)((0,n.Z)({},X.initValues),{},{tabType:s,cardTitle:Z&&Z!=r?Z:r,cover:this.state.initValues.cover!=o?this.state.initValues.cover:o})})),this.formRef.current.setFieldsValue({cardTitle:Z&&Z!=r?Z:r,cover:this.state.initValues.cover!=o?this.state.initValues.cover:o})},this.onRadioChange=s=>{this.setState(e=>({initValues:(0,n.Z)((0,n.Z)({},e.initValues),{},{radioShareScene:s.target.value})}))},this.onRadioApproveChange=s=>{this.setState(e=>({initValues:(0,n.Z)((0,n.Z)({},e.initValues),{},{radioSignApprove:s.target.value})}))},this.handleChangeEmployeeRange=s=>{var e=s.rangeType,r=s.rangeList;this.setState(o=>({initValues:(0,n.Z)((0,n.Z)({},o.initValues),{},{rangeType:e,rangeList:r})}))},this.onSignItem=(s,e)=>{s=="name"&&this.setState(r=>({initValues:(0,n.Z)((0,n.Z)({},r.initValues),{},{disabledName:!e,name:{isCheckedMust:!1}})})),s=="phone"&&this.setState(r=>({initValues:(0,n.Z)((0,n.Z)({},r.initValues),{},{disabledPhone:!e,phone:{isCheckedMust:!1,isRequired:!1}})})),s=="position"&&this.setState(r=>({initValues:(0,n.Z)((0,n.Z)({},r.initValues),{},{disabledPosition:!e,position:{isCheckedMust:!1}})})),s=="company"&&this.setState(r=>({initValues:(0,n.Z)((0,n.Z)({},r.initValues),{},{disabledCompany:!e,company:{isCheckedMust:!1}})})),s=="sex"&&this.setState(r=>({initValues:(0,n.Z)((0,n.Z)({},r.initValues),{},{disabledSex:!e,sex:{isCheckedMust:!1}})})),s=="email"&&this.setState(r=>({initValues:(0,n.Z)((0,n.Z)({},r.initValues),{},{disabledEmail:!e,email:{isCheckedMust:!1}})})),s=="weChat"&&this.setState(r=>({initValues:(0,n.Z)((0,n.Z)({},r.initValues),{},{disabledWeChat:!e,weChat:{isCheckedMust:!1}})})),s=="remark"&&this.setState(r=>({initValues:(0,n.Z)((0,n.Z)({},r.initValues),{},{disabledRemark:!e,remark:{isCheckedMust:!1}})}))},this.onChange=(s,e)=>{var r={};e==="name"?r={name:{isCheckedMust:s.target.checked}}:e==="phone"?r={phone:{isCheckedMust:s.target.checked,isRequired:prevState.initValues.phone.isRequired}}:e==="position"?r={position:{isCheckedMust:s.target.checked}}:e==="company"?r={company:{isCheckedMust:s.target.checked}}:e==="sex"?r={sex:{isCheckedMust:s.target.checked}}:e==="email"?r={email:{isCheckedMust:s.target.checked}}:e==="weChat"?r={weChat:{isCheckedMust:s.target.checked}}:e==="remark"&&(r={remark:{isCheckedMust:s.target.checked}}),this.setState(o=>({initValues:(0,n.Z)((0,n.Z)({},o.initValues),r)}))},this.onChangePhone=s=>{this.setState(e=>({initValues:(0,n.Z)((0,n.Z)({},e.initValues),{},{phone:{isCheckedMust:e.initValues.phone.isCheckedMust,isRequired:s.target.checked}})}))},this.onLimitPersonChange=s=>{this.setState(e=>({initValues:(0,n.Z)((0,n.Z)({},e.initValues),{},{isCheckedLimitPerson:s.target.checked,disabledLimitPerson:!s.target.checked})}))},this.onHideCourseChange=s=>{this.setState(e=>({initValues:(0,n.Z)((0,n.Z)({},e.initValues),{},{isCheckedHideContent:s.target.checked,disabledHideContent:!s.target.checked})}))},this.onHideCoursewareChange=s=>{this.setState(e=>({initValues:(0,n.Z)((0,n.Z)({},e.initValues),{},{isCheckedHideCourseware:s.target.checked})}))},this.onSignLimitChange=s=>{this.setState(e=>({initValues:(0,n.Z)((0,n.Z)({},e.initValues),{},{limitPerson:s})}))},this.onHideContentPercentChange=s=>{this.setState(e=>({initValues:(0,n.Z)((0,n.Z)({},e.initValues),{},{hideContentPercent:s})}))},this.handleCoverChange=s=>{this.setState(e=>({initValues:(0,n.Z)((0,n.Z)({},e.initValues),{},{cover:s})}))},this.handleDeleteCover=()=>{this.setState(s=>({initValues:(0,n.Z)((0,n.Z)({},s.initValues),{},{cover:this.props.coverUrl})}))},this.changePerm=s=>{s==="all"?(this.formRef.current.setFieldsValue({officialAccountId:ce.ZP.account}),this.setState({initValues:(0,n.Z)((0,n.Z)({},this.state.initValues),{},{officialAccountId:ce.ZP.account})}),this.setState({officialAccount:ce.ZP.accountName,officialAccountNew:ce.ZP.account})):(this.formRef.current.setFieldsValue({officialAccountId:null}),this.setState({initValues:(0,n.Z)((0,n.Z)({},this.state.initValues),{},{officialAccountId:null})}),this.setState({officialAccount:"",officialAccountNew:""}))},this.state={initValues:{isOpenShare:!0,tabType:"basicSetting",radioShareScene:"customer_training",rangeType:2,rangeList:{dept:[],user:[]},isOpenSign:!1,isOpenCollectInfo:!1,isOpenHideCourse:!1,disabledName:!0,disabledPhone:!0,disabledPosition:!0,disabledCompany:!0,disabledSex:!0,disabledEmail:!0,disabledWeChat:!0,disabledRemark:!0,name:{isCheckedMust:!1},phone:{isCheckedMust:!1,isRequired:!1},position:{isCheckedMust:!1},company:{isCheckedMust:!1},sex:{isCheckedMust:!1},email:{isCheckedMust:!1},weChat:{isCheckedMust:!1},remark:{isCheckedMust:!1},isCheckedLimitPerson:!1,disabledLimitPerson:!0,limitPerson:null,isCheckedHideContent:!1,disabledHideContent:!0,hideContentPercent:null,isCheckedHideCourseware:!1,radioSignApprove:"automatic",isOpenEmployeeCard:!1,cardTitle:"",cardContent:"",cover:"",officialAccountId:null,selectCount:"select",inintRangeList:{dept:[],user:[]}},authorize_info_list:[],officialAccount:"",officialAccountNew:"",isAdd:!0,knowledge_id:""}}componentDidMount(){this.getShareConfigs(),this.getAuthorizeList()}render(){var i=this.props,s=i.prefixCls,e=i.t,r=i.showShareConfig,o=this.state.authorize_info_list,m=this.state.initValues.isOpenShare;return a().createElement(me.Z,{title:e("common.share"),visible:r,footer:[a().createElement(y.Z,{key:"cancel",className:"".concat(s,"_button_cancel"),onClick:()=>this.operate("cancel")},e("common.cancel")),a().createElement(y.Z,{key:"saveAndShare",type:"primary",onClick:()=>this.operate("saveAndShare"),htmlType:"submit"},e(m?"shareInfo.saveAndShare":"common.save"))],footerStyle:{textAlign:"right"},onClose:this.handleCancelShare,width:750,destroyOnClose:!0,bodyStyle:{padding:"24px"}},a().createElement(da,{formRef:this.formRef,authorize_info_list:o,initValues:this.state.initValues,handleSwitch:this.handleSwitch,onChangeTab:this.onChangeTab,onRadioChange:this.onRadioChange,handleChangeEmployeeRange:this.handleChangeEmployeeRange,handleSignSwitch:this.handleSignSwitch,onSignItem:(c,Z)=>this.onSignItem(c,Z),onChange:(c,Z)=>this.onChange(c,Z),onChangePhone:this.onChangePhone,onLimitPersonChange:this.onLimitPersonChange,onRadioApproveChange:this.onRadioApproveChange,handleCollectInfoSwitch:this.handleCollectInfoSwitch,handleHideCourseSwitch:this.handleHideCourseSwitch,onHideCourseChange:this.onHideCourseChange,onHideCoursewareChange:this.onHideCoursewareChange,changePerm:this.changePerm,selectOfficialAccount:this.selectOfficialAccount,handleEmployeeCardSwitch:this.handleEmployeeCardSwitch,handleDeleteCover:this.handleDeleteCover,handleCoverChange:this.handleCoverChange,onSignLimitChange:this.onSignLimitChange,onHideContentPercentChange:this.onHideContentPercentChange}))}}Rt.defaultProps={prefixCls:"graphic-share-setting-page"};var pa=(0,A.$j)(ha)((0,M.Z)()(Rt)),ua=t(90994),ma=t(14409),va=t(28107),ga=t(59857),Ca=t(24144),ht=t(98078),fa=t(42086),Ea=T.Z.DragTableRow,Be={setTop:B.ZP.CourseManageList.setTop,removeTop:B.ZP.CourseManageList.removeTop,move:B.ZP.CourseManageList.move,translateCourseStatus:B.ZP.CourseManageList.translateCourseStatus,beforeSetEmployeeCheck:B.ZP.CourseManageList.beforeSetEmployeeCheck,setEmployee:B.ZP.CourseManageList.setEmployee,setProjectEmployee:B.ZP.StudyProjectList.setViewScope};class Ot extends a().Component{constructor(){var i;super(...arguments);i=this,this.state={dataSource:[],activeRowId:"",employeeProps:{visible:!1,courseId:"",initialParams:{employeeRange:{rangeType:1,rangeList:{dept:[],post:[],group:[],user:[]}}}},currentRecord:{},referenceWithOtherConfig:{visible:!1,type:"course",operation:"",resourceId:"",onCancel:this.handleReferenceList,onOk:this.handleReferenceList},AIModalFlag:!1,operateRecord:"",allowActions:(0,D.V9)("graphicLesson",this.props.userInfo.modules),showPromote:(0,D.e)("market",this.props.userInfo.modules),graphicLessonShare:{showShareConfig:!1,id:"",title:"",coverUrl:""},shareWay:{showShareWay:!1,shareUrl:"",sourceKnowledgeId:"",shareScene:""}},this.onCancel=s=>{this.setState({AIModalFlag:!1},()=>{s&&_.default.warning(this.props.t("common.maintain")),this.props.getList()})},this.tip=()=>a().createElement("div",null,a().createElement("p",null,this.props.t("courseManage.estimatedStandard")),a().createElement("p",null,this.props.t("courseManage.estimatedStandard1")),a().createElement("p",null,this.props.t("courseManage.estimatedStandard2")),a().createElement("p",null,this.props.t("courseManage.estimatedStandard3")),a().createElement("p",null,this.props.t("courseManage.estimatedStandard4"))),this.handleViewCourse=s=>{var e=s.record;(0,W.eJ)({url:"/course/watch?".concat(z.stringify({courseId:e.course_id,source:"enterprise",courseName:"",exitAiUpdate:!1,courseType:"imageText"}))})},this.columns=[{title:this.props.t("courseManage.courseTitle"),dataIndex:"title",key:"title",width:290,fixed:"left",render:(s,e)=>{var r=a().createElement("span",{className:"cl-pointer"},s);return a().createElement("div",{className:"cl-text-ellipsis",style:{width:270},onClick:()=>this.handleViewCourse({record:e})},a().createElement(O.Z,{placement:"top",title:s},r))}},{title:this.props.t("learning.learningProjectAddCategory"),width:200,dataIndex:"classify_name",key:"classify_name",render:(s,e)=>a().createElement("div",{className:"cl-text-ellipsis",style:{width:180}},a().createElement(ga.Z,{name:e.classify_name,full_name:e.classify_path_name}))},{title:this.props.t("common.visibleRange"),dataIndex:"is_all",key:"is_all",width:this.props.lng==="en_us"?120:100,render:s=>s===1?this.props.t("common.allCompany"):this.props.t("setting.partlyVisible")},{title:this.props.t("course.courseOrigin"),dataIndex:"course_type",key:"course_type",width:this.props.lng==="en_us"?220:90,render:s=>(0,ma.Ru)(s)},{title:this.props.t("courseManage.rewardCredits"),dataIndex:"s_credit",key:"s_credit",width:this.props.lng==="en_us"?130:90},{title:()=>a().createElement("div",null,this.props.t("courseManage.estimatedHours"),"\xA0\xA0\xA0",a().createElement(O.Z,{title:()=>this.tip()},a().createElement(C.Z,{style:{cursor:"pointer"}}))),dataIndex:"duration",key:"duration",width:150,render:s=>{var e="--",r=Number(s);return r<60&&r>0?e="".concat(r,"\u79D2"):r>60&&(e="".concat(Math.ceil(r/60),"\u5206\u949F")),a().createElement("span",null,e)}},{title:this.props.t("courseManage.views"),dataIndex:"plays",key:"plays",width:90,render:(s,e)=>e.biz_type===3?"-":s},{title:this.props.t("courseManage.numberOfViewers"),dataIndex:"study_count",key:"study_count",width:90,render:(s,e)=>s>0?a().createElement(u.Z,{name:s,onClick:()=>this.props.showViewDetail(e)}):s},{title:(0,ht.WC)()?this.props.t("course.rate"):this.props.t("courseManage.star"),dataIndex:"star_level",key:"star_level",width:90,render:s=>(0,ht.WC)()?(s/100).toFixed(2):s},{title:this.props.t("courseManage.likes"),dataIndex:"likes",key:"likes",width:90},{title:this.props.t("courseManage.comment"),dataIndex:"comments",key:"comments",width:100},{title:this.props.t("common.creator"),dataIndex:"create_user_name",key:"create_user_name",width:126,render:(s,e)=>a().createElement("div",{className:"cl-text-ellipsis",style:{width:80}},a().createElement(ct.Z,{dataType:"userName",value:e.creator_sync_user_id,name:s,type:e.creator_source_type}))},{title:this.props.t("course.lecturer"),dataIndex:"teacher_name",key:"teacher_name",width:126,render:(s,e)=>a().createElement("div",{className:"cl-text-ellipsis",style:{width:80}},e.teacher_type==="inside"?a().createElement(ct.Z,{dataType:"userName",value:e.teacher_sync_user_id,name:s,type:e.teacher_source_type}):a().createElement("span",null,s||"--"))},{title:this.props.t("courseManage.expireDate"),dataIndex:"expire_time",key:"expire_time",width:164},{title:this.props.t("common.updateTime"),dataIndex:"update_date",key:"update_date",width:164},{title:this.props.t("common.scheduleSync"),dataIndex:"sync_progress",key:"sync_progress",width:164,render:s=>s===1?this.props.t("common.synchronization"):this.props.t("common.outSync")},{title:this.props.t("courseManage.topping"),dataIndex:"is_top",key:"is_top",width:90,render:(s,e)=>a().createElement(P.Z,{checked:s==="true",onChange:r=>this.handleSetTop({isChecked:r,record:e})})},{title:this.props.t("common.operate"),key:"operate",width:220,fixed:"right",render:s=>this.renderActions({record:s})}],this.statusMap=s=>{var e;switch(s.ai_upgrade_status){case"not_processed":e=this.props.t("course.notUpdate");break;case"processing":e=this.props.t("course.updating");break;case"processed":e=this.props.t("course.dealSuccess");break;case"failed":e=this.props.t("course.updateFailed");break;default:e="/"}return e},this.handleTableChange=(s,e)=>{this.props.onTableChange({current:s,pageSize:e})},this.getColumns=()=>{var s=this.props.userInfo.enterpriseVersion==="comprehensive"&&(0,D.H3)("ai_upgrade",this.state.allowActions),e=[...this.columns];return s&&e.splice(-2,0,{title:this.props.t("course.isAIUpdate"),dataIndex:"createUserName",width:130,render:(r,o)=>a().createElement("span",null,this.statusMap(o))}),e},this.moveRow=(s,e)=>{var r=this.state.dataSource,o=r[s],m=r[e];if(o.is_top===m.is_top){var c=r[s],Z=s<e,X={direction:Z?"down":"up",drag_course_id:c.course_id,drop_course_id:r[e].course_id};r.splice(s,1),r.splice(e,0,c),this.setState({dataSource:r},()=>{k.WY.post({url:Be.move(),data:(0,n.Z)({},X)}).then(()=>{_.default.success(this.props.t("study.updateSuccess")),this.props.onForceRender()})})}},this.handleSetTop=s=>{var e=s.isChecked,r=s.record;k.qg.post({url:e?Be.setTop():Be.removeTop(),data:{id:r.course_id}}).then(o=>{var m=o.data,c=m.code,Z=m.msg;c===0?(_.default.success(this.props.t("study.updateSuccess")),this.props.onForceRender()):_.default.warning(Z)})},this.handleReferenceList=(s,e)=>{this.setState(r=>({referenceWithOtherConfig:(0,n.Z)((0,n.Z)({},r.referenceWithOtherConfig),{},{visible:!r.referenceWithOtherConfig.visible,resourceId:s||"",operation:e||""})}))},this.handleReleaseRow=s=>{var e=s.record,r=this.props,o=r.onForceRender,m=r.t,c=e.reference_plan_count,Z=e.course_id;c>0?this.handleReferenceList(e.course_id,"cancelPublish"):p.Z.confirm({title:m("common.tip"),content:m("personal.cancelPublish"),onOk(){k.qg.post({url:Be.translateCourseStatus({courseId:Z}),data:{action:"cancel"}}).then(X=>{var J=X.data,te=J.code,le=J.msg;_.default["".concat(te===0?"success":"warning")](le),te===0&&o()})}})},this.handleEditRow=s=>{var e=s.record,r=e.reference_plan_count,o=e.is_microcourse,m=e.course_id,c=this.props.t;if(o==="true"){_.default.warning(c("personal.editMicroTip"));return}r>0?this.handleReferenceList(m,"continueEdit"):e.biz_type===3?history.push("/training/learning/project/add?id=".concat(e.project_id,"&from=courseManage")):H.Z.targetTo({path:"/knowledgeBase/graphicLesson/detail?courseId=".concat(m,"&history=rescource")})},this.continueEdit=()=>{var s=this.state.referenceWithOtherConfig.resourceId;H.Z.targetTo({path:"/knowledgeBase/graphicLesson/detail?courseId=".concat(s,"&history=rescource")})},this.handleSetEmployeeRange=function(){var s=(0,l.Z)(S().mark(function e(r){var o,m,c,Z,X,J,te,le,pe,ue,de,ye,Me,be,Ae;return S().wrap(function(Se){for(;;)switch(Se.prev=Se.next){case 0:return o=r.record,m=o.is_all,c=o.course_id,Z=o.course_type==="platform",Se.next=5,(0,fa.dA)({courseId:c});case 5:X=Se.sent,J=X.data?X.data:{},te=J.department_list,le=te===void 0?[]:te,pe=J.post_list,ue=pe===void 0?[]:pe,de=J.group_list,ye=de===void 0?[]:de,Me=J.user_list,be=Me===void 0?[]:Me,Ae=[],i.setState({employeeProps:{visible:!0,courseId:o.course_id,initialParams:{employeeRange:{rangeType:Z&&m===0?1:m,rangeList:{dept:le,post:ue,group:ye,user:be}}},reserveUser:Ae},currentRecord:o});case 10:case"end":return Se.stop()}},e)}));return function(e){return s.apply(this,arguments)}}(),this.handleEmployeeCancel=()=>{this.setState(s=>({employeeProps:(0,n.Z)((0,n.Z)({},s.employeeProps),{},{visible:!1})}))},this.handleEmployeeOk=s=>{var e=this.props,r=e.onForceRender,o=e.t,m=s.isAll,c=s.departmentIds,Z=s.groupIds,X=s.postIds,J=s.userIds,te=s.qyWeChatVo,le={department_ids:c,group_ids:Z,is_all:m,post_ids:X,user_ids:J,qy_we_chat_vo:te};this.withApiBeforeSetEmployeeCheck(le).then(pe=>{pe.data?this.withApiSetEmployee(le).then(()=>{_.default.success(o("personal.batchSetRangeSuccess")),r()}):_.default.warning(o("personal.limitPersonTip"))}),this.handleEmployeeCancel()},this.withApiBeforeSetEmployeeCheck=s=>k.qg.post({url:Be.beforeSetEmployeeCheck({courseId:this.state.employeeProps.courseId}),data:(0,n.Z)({},s)}),this.withApiSetEmployee=s=>{var e=this.state.currentRecord,r=e.biz_type!==3?Be.setEmployee({courseId:this.state.employeeProps.courseId}):Be.setProjectEmployee(e.project_id);return e.biz_type===3?k.WY.post({url:r,data:(0,n.Z)({},s)}):k.qg.post({url:r,data:(0,n.Z)({},s)})},this.handleClickPopItem=s=>{var e=s.record,r=s.type;switch(r){case"release":this.handleReleaseRow({record:e});break;case"edit":this.handleEditRow({record:e});break;case"data":this.getShareConfigDetail(e);break;default:break}},this.clickApproval=s=>{var e=s.instance_id;(0,W.eJ)({url:"/personal/approval/approved-process?instanceId=".concat(e)})},this.getShareConfigDetail=s=>{(0,fe.lK)(s.course_id).then(e=>{if(e.data.data){var r=e.data.data;H.Z.targetTo({path:"/knowledgeBase/learningResources/graphicLesson/monitor?id=".concat(s.course_id,"&knowledgeId=").concat(r.knowledge_id,"&shareType=").concat(e.data.data.share_type)})}else H.Z.targetTo({path:"/knowledgeBase/learningResources/graphicLesson/monitor?id=".concat(s.course_id)})}).catch(()=>{H.Z.targetTo({path:"/knowledgeBase/learningResources/graphicLesson/monitor?id=".concat(s.course_id)})})},this.clickAIUpdate=()=>{_.default.warning(this.props.t("common.maintain"))},this.handleShare=s=>{var e=s.record,r=this,o=e.cover.startsWith("https")?e.cover:e.cover.replace(/http/,"https");Q().get(o,{responseType:"blob"}).then(m=>{var c=e.cover.split("/").reverse(),Z=(0,h.Z)(c,1),X=Z[0],J=m.headers["content-type"]||"",te=J.startsWith("image/")?J:"image/".concat(J);new(b())(new Blob([m.data],{type:te}),{quality:.6,maxHeight:100,maxWidth:100,success(le){var pe=new FormData;pe.append("file",new File([le],X,{type:te})),pe.append("access_token",window.localStorage.getItem("token")),(0,Ca.ws)(pe).then(ue=>{var de=ue.data,ye="".concat(de.data.server,"/").concat(de.data.fileNewName);r.setState({graphicLessonShare:{showShareConfig:!0,id:e.course_id,title:e.title,coverUrl:ye}})})}})})},this.handleShareGraphicLesson=s=>{var e=s.record,r=this.props.t,o=e.course_id,m=e.title,c=e.teacher_name,Z=e.teacher_source_type,X=e.teacher_sync_user_id,J=e.create_user_name,te=encodeURIComponent("courseId=".concat(o)),le={title:m,template:[1,2,3,4],site1:{label:r("common.creator"),value:J},lecture:X?{name:c,avatar:"",id:X,source_type:Z}:null,from:"imageText",path:(0,W.jr)({pc_url:"course/watch?courseId=".concat(o,"&exitAiUpdate=false&source=enterprise&courseType=imageText&courseName="),mobile_url:"/business-transit?businessType=graphicLesson&params=".concat(te),pc_type:"student",mobile_type:"h5"})};a().$share.show({detail:le})},this.cancelTipOpenWay=s=>{var e=s.shareUrl,r=s.sourceKnowledgeId,o=s.shareScene;this.setState({graphicLessonShare:{showShareConfig:!1,id:"",title:"",coverUrl:""},shareWay:{showShareWay:!0,shareUrl:e,sourceKnowledgeId:r,shareScene:o}})},this.handleQrCodePropsCancel=()=>{this.setState({graphicLessonShare:{showShareConfig:!1,id:"",title:"",coverUrl:""}})},this.cancelShareWay=()=>{this.setState({shareWay:{showShareWay:!1,shareUrl:"",sourceKnowledgeId:"",shareScene:""}})},this.closeShareWay=()=>{this.setState({h5ShareWay:{showShareWay:!1,shareUrl:"",sourceKnowledgeId:"",shareScene:""}})},this.renderActions=s=>{var e=s.record,r=this.props,o=r.allowActions,m=r.t,c=this.state.showPromote,Z=(0,D.H3)("release_or_cancelled",o),X=(0,D.H3)("project_data",o),J=(0,D.H3)("share_live",o),te=(0,D.H3)("set_visible",o),le=(0,D.H3)("edit",o),pe=[{type:"data",visible:X,title:this.props.t("common.data"),click:()=>this.handleClickPopItem({record:e,type:"data"})},{type:"share",visible:J,title:this.props.t("common.share"),click:()=>this.handleShareGraphicLesson({record:e})},{type:"share",visible:c&&J,title:this.props.t("course.promote"),click:()=>this.handleShare({record:e}),disabled:e.link_switch==="true",tooltip:m("course.shareLinkTips")},{type:"edit",visible:le,title:this.props.t("common.edit"),click:()=>this.handleClickPopItem({record:e,type:"edit"})},{type:"setTheVisibility",visible:te,title:this.props.t("courseManage.setTheVisibility"),click:()=>this.handleSetEmployeeRange({record:e})},{type:"cancelPublished",visible:Z&&e.release_status==="cancel_release"&&e.biz_type!==3,title:this.props.t("courseManage.cancelPublished"),click:()=>this.handleClickPopItem({record:e,type:"release"})},,{type:"aproval",visible:e.show_approval_process==="true",title:this.props.t("leftMenuLists.approvalProcess"),click:()=>this.clickApproval(e)}];return a().createElement("div",{className:"cl-table__cell-action"},a().createElement(Y.Z,{buttons:pe}),localStorage.getItem("dingPersonnel")!=="dingPersonnel"&&a().createElement(a().Fragment,null,a().createElement("span",{className:"cl-pointer-divide"}),a().createElement("a",{href:"javascript:;",className:"move"},a().createElement(I.Z,{iconClass:"iconf-move"}))))},this.renderActionMenu=s=>{var e=s.record,r=e.release_status,o=e.can_edit,m=this.props.allowActions,c=(0,D.H3)("release_or_cancelled",m),Z=(0,D.H3)("edit",m),X=(0,D.H3)("set_visible",m),J=this.props.userInfo.enterpriseVersion==="comprehensive"&&(0,D.H3)("ai_upgrade",this.state.allowActions);return a().createElement(q.Z,null,X&&J&&a().createElement(q.Z.Item,null,a().createElement("a",{className:"cl-pointer",onClick:()=>this.handleSetEmployeeRange({record:e})},this.props.t("courseManage.setTheVisibility"))),r==="cancel_release"&&e.biz_type!==3&&c&&a().createElement(q.Z.Item,{key:"1"},a().createElement("p",{className:"cl-dropdown-menuitem",onClick:()=>this.handleClickPopItem({record:e,type:"release"})},this.props.t("courseManage.cancelPublished"))),o==="true"&&Z&&a().createElement(q.Z.Item,{key:"2"},a().createElement("p",{className:"cl-dropdown-menuitem",onClick:()=>this.handleClickPopItem({record:e,type:"edit"})},this.props.t("common.edit"))))}}static getDerivedStateFromProps(i){return{dataSource:i.list}}componentWillUnmount(){a().$share&&a().$share.destroy()}render(){var i=this.props,s=i.prefixCls,e=i.loading,r=i.paginationParams,o=r===void 0?{}:r,m=i.selectedCourseIds,c=i.selectedProjectIds,Z=i.onSelectChange,X=i.t,J=i.headerTitle,te=i.toolBarRender,le=this.state,pe=le.dataSource,ue=le.employeeProps,de=le.activeRowId,ye=le.referenceWithOtherConfig,Me=le.graphicLessonShare,be=le.shareWay,Ae=(0,n.Z)((0,n.Z)({},B.XE.INITIAL_PAGINATION),o),We={selectedRowKeys:m.concat(c),onChange:Z};return a().createElement(a().Fragment,null,a().createElement("div",{className:s},a().createElement(ie.f,{style:{width:"100%",height:"100%",overflow:"hidden"},scroll:{x:"max-content",y:"100%"},columns:this.getColumns(),rowKey:Se=>Se.biz_type===3?Se.project_id:Se.course_id,dataSource:pe,pagination:!1,loading:e,rowSelection:We,onRow:(Se,Ke)=>({index:Ke,record:Se,loading:e,keyName:"course_id",moveRow:this.moveRow,activeRowId:de,onMouseEnter:Fe=>{var Ve=Fe.id;this.setState({activeRowId:Ve})},onMouseLeave:()=>{this.setState({activeRowId:""})}}),components:{body:{row:localStorage.getItem("dingPersonnel")!=="dingPersonnel"?Ea:!1}},headerTitle:J,toolBarRender:te,tableUUID:"ca0c347e-bdd0-46af-bff1-eb8f1de98935"}),ue.visible&&a().createElement(oe.Z,(0,N.Z)({},ue,{title:X("courseManage.setTheVisibility"),mode:["all","part","private"],isLoading:!ue.visible,onCancel:this.handleEmployeeCancel,onCreate:this.handleEmployeeOk})),a().createElement(va.Z,(0,N.Z)({},ye,{handleReferenceList:this.handleReferenceList,continueEdit:this.continueEdit}))),a().createElement("div",{className:"recourse-pagination-wrapper"},a().createElement(K.Z,(0,N.Z)({},Ae,{onChange:this.handleTableChange,className:"recourse-pagination"}))),this.state.AIModalFlag&&a().createElement(ae.Z,{visible:this.state.AIModalFlag,record:[this.state.operateRecord],onCancel:Se=>this.onCancel(Se)}),this.state.graphicLessonShare.showShareConfig?a().createElement(pa,(0,N.Z)({},Me,{cancelTipOpenWay:this.cancelTipOpenWay,onCancelShare:this.handleQrCodePropsCancel})):null,a().createElement(ua.Z,(0,N.Z)({},be,{courseType:"graphicLesson",closeShareWay:this.cancelShareWay})))}}Ot.defaultProps={prefixCls:"graphic-resource-course-list-page__release__content__scrolltable"};var ya=(0,A.$j)(Ce=>({appType:Ce.user.appType,userInfo:Ce.user}))((0,M.Z)()((0,f.Z5)(x.ZP)(Ot)));class xt extends a().Component{render(){var i=this.props,s=i.prefixCls,e=(0,j.Z)(i,["prefixCls"]);return a().createElement("section",{className:s},a().createElement(ya,e))}}xt.defaultProps={prefixCls:"graphic-resource-course-list-page__release__content"};var _a=xt,Pa=t(11449),Mt=t(72456),Zt=t(62117),Ia=t(74457),Ta=t(55722),Da=t(4408),Sa=t(31945),La=Ce=>({userInfo:Ce.user}),bt={getTableList:B.ZP.GraphicManagement.getTableListByAuth,getTableListByWH:B.ZP.GraphicManagement.getTableListByWH,exportTableList:B.ZP.CourseManageList.exportTableList};class At extends a().Component{constructor(){super(...arguments);this.state={params:{title:"",page_number:1,page_size:20,type:"",classify_id:"",view_range:"",view_sharing:"",course_status:"released",course_type:"all"},selectedCourseIds:[],selectedProjectIds:[],radioList:[{name:this.props.t("courseManage.published"),value:"released"},{name:this.props.t("courseManage.unPublished"),value:"unreleased"}],tableLoading:!0,tableList:[],tableTotal:0,viewDetailConfig:{visible:!1,courseId:"",onCancel:()=>{}},allowActions:(0,D.V9)("graphicLesson",this.props.userInfo.modules)},this.initData=()=>{this.initTableList()},this.initTableList=()=>{this.setState({tableLoading:!0});var i=this.state.params,s=i.classify_id.split(",");k.WY.get({url:(0,ht.WC)()?bt.getTableListByWH():bt.getTableList(),params:(0,n.Z)((0,n.Z)({},this.state.params),{},{classify_id:s[s.length-1]})}).then(e=>{setTimeout(()=>{this.setState({tableLoading:!1,tableList:e.data.list,tableTotal:e.data.total,selectedCourseIds:[],selectedProjectIds:[]})},300)})},this.handleQueryRowCheckboxChange=i=>{this.resetPagination().then(()=>{this.setState(s=>({params:(0,n.Z)((0,n.Z)({},s.params),{},{view_range:i?"own":"all"})}),()=>{this.initData()})})},this.handleSharingQueryRowCheckboxChange=i=>{this.resetPagination().then(()=>{this.setState(s=>({params:(0,n.Z)((0,n.Z)({},s.params),{},{view_sharing:i?"sharing":"all"})}),()=>{this.initData()})})},this.handleQueryRowRadiosChange=i=>{this.resetPagination().then(()=>{this.setState(s=>({params:(0,n.Z)((0,n.Z)({},s.params),{},{type:"",classify_id:"",title:"",course_status:i})}),()=>{this.initData()})})},this.handleQueryRowSearch=(i,s)=>{var e={title:s===""?i:"",userIds:s===""?"":s};this.resetPagination().then(()=>{this.setState(r=>({params:(0,n.Z)((0,n.Z)({},r.params),e)}),()=>{this.initData()})})},this.handleChangePagination=i=>{var s=i.current,e=i.pageSize;this.setState(r=>({params:(0,n.Z)((0,n.Z)({},r.params),{},{page_number:s,page_size:e})}),()=>{this.initData()})},this.handleChangeClassify=i=>{this.setState(s=>({params:(0,n.Z)((0,n.Z)({},s.params),{},{page_number:1,page_size:20,classify_id:i.join(",")})}),()=>{this.initData()})},this.handleChangeType=i=>{this.setState(s=>({params:(0,n.Z)((0,n.Z)({},s.params),{},{page_number:1,page_size:20,type:i})}),()=>{this.initData()})},this.handleChangeCourseType=i=>{this.setState(s=>({params:(0,n.Z)((0,n.Z)({},s.params),{},{page_number:1,page_size:20,course_type:i})}),()=>{this.initData()})},this.handleTableSelectChange=(i,s)=>{var e=[],r=[];s.map(o=>{o.biz_type===3?r.push(o.project_id):e.push(o.course_id)}),this.setState({selectedCourseIds:e,selectedProjectIds:r})},this.handleForceRender=()=>{this.resetPagination().then(()=>{this.initData()})},this.resetPagination=()=>new Promise(i=>{this.setState(s=>({params:(0,n.Z)((0,n.Z)({},s.params),{},{page_number:1})}),()=>{i()})}),this.handleMta=i=>{var s=i==="course_upload"?"/course/management/create/manage":"/knowledgeBase/graphicLesson/detail?history=rescource";U.m8.push(s)},this.renderExport=()=>{var i=this.state.allowActions,s=(0,D.H3)("add",i);return a().createElement(a().Fragment,null,s?a().createElement(y.Z,{type:"primary",className:"dropdown-btn-left",onClick:()=>this.handleMta("course_uploadztk")},a().createElement(R.Z,null),this.props.t("common.add")):null)},this.showViewDetail=i=>{var s=this.state.viewDetailConfig;s.visible=!0,s.courseId=i.course_id,s.onCancel=this.hiddenViewDetail,this.setState({viewDetailConfig:s})},this.hiddenViewDetail=()=>{var i=this.state.viewDetailConfig;i.visible=!1,this.setState({viewDetailConfig:i})},this.onChangeTab=i=>{this.setState({params:{title:"",page_number:1,page_size:20,type:"",classify_id:"",view_range:"",view_sharing:"",course_status:"released",course_type:"all"}},()=>this.handleQueryRowRadiosChange(i))},this.renderOther=()=>{var i=this.state,s=i.tableList,e=i.params,r=i.selectedCourseIds,o=i.selectedProjectIds,m=i.allowActions;return a().createElement("div",null,a().createElement(Sa.Z,{courseType:"graphic",rangeType:"newMode",params:e,list:s,selectedCourseIds:r,selectedProjectIds:o,onForceRender:this.handleForceRender,onClassifyChange:this.handleChangeClassify,onTypeChange:this.handleChangeType,onCourseTypeChange:this.handleChangeCourseType,allowActions:m,showRenderActions:!1,onCheckboxChange:this.handleQueryRowCheckboxChange,onSharingCheckboxChange:this.handleSharingQueryRowCheckboxChange}))},this.renderUnreleasedLeftRow=()=>a().createElement(Mt.Z,{showBtn:!1,renderActionBtn:this.renderExport}),this.renderUnreleasedRightRow=()=>{var i=this.state.radioList;return a().createElement(Zt.Z,{radioList:i,onRadiosChange:this.handleQueryRowRadiosChange,onSearch:this.handleQueryRowSearch,showRenderRadios:!1,showCheckbox:!1})},this.renderReleasedLeftRow=()=>{var i=this.state,s=i.tableList,e=i.params,r=i.selectedCourseIds,o=i.selectedProjectIds,m=i.allowActions;return a().createElement(Mt.Z,{showBtn:!1,renderActionBtn:this.renderExport,queryRowParams:e,queryRowList:s,queryRowSelectedCourseIds:r,queryRowSelectedProjectIds:o,queryRowOnForceRender:this.handleForceRender,queryRowOnClassifyChange:this.handleChangeClassify,queryRowOnTypeChange:this.handleChangeType,queryRowOnCourseTypeChange:this.handleChangeCourseType,queryRowAllowActions:m,showRenderQueryRow:!0})},this.renderReleasedRightRow=()=>{var i=this.state.radioList;return a().createElement(Zt.Z,{radioList:i,onRadiosChange:this.handleQueryRowRadiosChange,onSearch:this.handleQueryRowSearch,showRenderRadios:!1,showCheckbox:!1})}}componentDidMount(){this.initData()}render(){var i=this.props,s=i.prefixCls,e=i.userInfo,r=i.t,o=this.state,m=o.tableTotal,c=o.tableList,Z=o.tableLoading,X=o.params,J=o.selectedCourseIds,te=o.selectedProjectIds,le=o.viewDetailConfig,pe=o.allowActions,ue={total:m,current:X.page_number,pageSize:X.page_size};return a().createElement(Pa.Z,{isPersonal:!1,pageContainerParams:{header:{title:this.props.t("leftMenuLists.graphicManagement2")},tabList:[{tab:this.props.t("courseManage.published"),key:"released"},{tab:this.props.t("courseManage.unPublished"),key:"unreleased"}],onTabChange:de=>{this.onChangeTab(de)}}},a().createElement(Da.Z,{title:r("course.graphicDetailTitle")}),a().createElement("div",{className:s},a().createElement("div",{className:"".concat(s,"__content")},X.course_status==="released"?a().createElement(a().Fragment,null,a().createElement("div",{style:{padding:"24px 32px 0"}},this.renderOther()),a().createElement(_a,{courseType:"graphic",lng:e.lng,loading:Z,paginationParams:ue,params:X,list:c,selectedCourseIds:J,selectedProjectIds:te,onSelectChange:this.handleTableSelectChange,onTableChange:this.handleChangePagination,onForceRender:this.handleForceRender,onClassifyChange:this.handleChangeClassify,onTypeChange:this.handleChangeType,onCourseTypeChange:this.handleChangeCourseType,showViewDetail:this.showViewDetail,allowActions:pe,getList:this.initTableList,headerTitle:this.renderReleasedLeftRow(),toolBarRender:this.renderReleasedRightRow})):a().createElement(a().Fragment,null,a().createElement("div",{style:{padding:"24px 32px 0"}},a().createElement("div",{style:{padding:"0 0 24px 0"}},a().createElement(L.Z,{onChange:de=>this.handleQueryRowCheckboxChange(de.target.checked)},r("common.myCreated")))),a().createElement(Ta.Z,{courseType:"graphic",lng:e.lng,loading:Z,paginationParams:ue,list:c,onTableChange:this.handleChangePagination,onForceRender:this.handleForceRender,allowActions:pe,getList:this.initTableList,headerTitle:this.renderUnreleasedLeftRow(),toolBarRender:this.renderUnreleasedRightRow}))),a().createElement(Ia.Z,le)))}}At.defaultProps={prefixCls:"graphic-resource-course-list-page"};var Ra=(0,A.$j)(La)((0,M.Z)()(At))},21049:function(ve,se,t){"use strict";var ne=t(57663),L=t(71577),ee=t(34792),y=t(48086),n=t(12924),w=t.n(n),a=t(91768),A=t(80991),M=t(84874),R=t(24144);class U extends w().Component{constructor(F){super(F);this.onUploadSuccess=K=>{var N=K.fileList,$=this.props.t,q=this.props.courseType,h=q===void 0?"":q,l=N.length>0?N[0].url:"";h==="graphic"?this.props.handleCoverChange(l):this.props.formik.setFieldValue("cover",l),y.default.success(" ".concat($("course.courseDetailCoverSuccess")))},this.onUploadFailed=()=>{var K=this.props.t;y.default.error("".concat(K("course.courseDetailCoverFailure")))},this.handleDeleteCover=()=>{this.props.handleDeleteCover()},this.renderImageFilters=()=>{var K=this.props,N=K.prefixCls,$=K.defaultFieldList,q=K.courseType,h=q===void 0?"":q,l="".concat(N,"__imgfilters");return w().createElement("div",{className:"coverSty ".concat(l)},w().createElement("img",{src:$,alt:""}),w().createElement("div",{className:"".concat(l,"__mask")}),h==="graphic"?w().createElement("span",{className:"delete-icon",onClick:this.handleDeleteCover},w().createElement(M.Z,{iconClass:"icon-guanbi",size:"10px"})):null)},this.renderUploadBtn=()=>{var K=this.props,N=K.prefixCls,$=K.t,q=K.courseType,h=q===void 0?"":q,l=this.state.type,v="".concat(N,"__uploader");return w().createElement("div",{className:v},w().createElement(R.ZM,{uploadConfig:{listType:"picture",accept:"jpeg ,jpg ,png",showUploadList:!1,maxCount:1},size:{value:64,unit:"kb"},onUploadSuccess:this.onUploadSuccess,onUploadFailed:this.onUploadFailed,clip:l,imgCropConfig:{widthScale:1,heightScale:1},render:()=>w().createElement("div",null,w().createElement(L.Z,{type:"default"},w().createElement(M.Z,{iconClass:"iconf-add",color:"#4D536E",size:"14px"}),$("course.courseDetailCover")),h==="graphic"?w().createElement("p",null,"(",$("shareInfo.shareCoverTip"),")"):w().createElement("p",null,"(",$("shareInfo.articleCoverTip"),")"))}))},this.state={type:"crop"}}render(){var F=this.props.prefixCls;return w().createElement("section",{className:"".concat(F)},this.renderImageFilters(),this.renderUploadBtn())}}U.defaultProps={prefixCls:"article-cover__content"},se.Z=(0,A.$j)((0,a.Z)()(U))},95371:function(ve,se,t){"use strict";t.d(se,{iv:function(){return y},lK:function(){return n},bS:function(){return w},Ds:function(){return a},TP:function(){return M},bG:function(){return R},SI:function(){return U},PC:function(){return j}});var ne=t(88986),L=t(37055),ee=t(10237);function y(){var F=L.ZP.shareSettings.getServiceAuthorizeList();return ee.WY.get({url:F,params:{enterprise_id:L.ZP.enterpriseId,app_id:L.ZP.shareId}})}function n(F){var K=L.ZP.shareSettings.getShareConfig();return ee.WY.get({url:K,params:{enterprise_id:L.ZP.enterpriseId,app_id:L.ZP.shareId,source_knowledge_id:F}})}function w(F,K){var N=K?L.ZP.shareSettings.addShareSettings():L.ZP.shareSettings.editShareSettings();return ee.WY.post({url:N,data:(0,ne.Z)((0,ne.Z)({},F),{},{enterprise_id:L.ZP.enterpriseId,app_id:L.ZP.shareId,user_id:L.ZP.userId})})}function a(F){var K=F.source_knowledge_id,N=F.knowledge_type,$=L.ZP.shareSettings.doShare();return ee.WY.post({url:$,data:{knowledge_id:K,knowledge_type:N,enterprise_id:L.ZP.enterpriseId,app_id:L.ZP.shareId,share_user:L.ZP.userId}})}function A(F){var K=CONFIG.shareSettings.getShareInfo();return request.get({url:K,params:{share_id:F,enterprise_id:CONFIG.enterpriseId}})}function M(F){var K=L.ZP.H5Article.getArticleInfo({id:F});return ee.WY.get({url:K,params:{}})}function R(F,K){var N=L.ZP.shareSettings.sendMessage();return ee.WY.get({url:N,params:{enterprise_id:L.ZP.enterpriseId,app_id:L.ZP.shareId,source_knowledge_id:F,share_url:K}})}function U(F){var K=F.resourceId,N=L.ZP.LibraryList.uploadThirdPart(K);return ee.WY.post({url:N,data:{source:"lai_hua"}})}function j(F,K){var N=K.oldResourceId,$=K.resourceId,q=L.ZP.LibraryList.replaceResource({oldResourceId:N,resourceId:$});return ee.WY.post({url:q,data:F})}},90994:function(ve,se,t){"use strict";var ne=t(71194),L=t(57016),ee=t(57663),y=t(71577),n=t(47673),w=t(4107),a=t(34792),A=t(48086),M=t(12924),R=t.n(M),U=t(92592),j=t(91768),F=t(28216),K=t(95371),N=t(1164),$=h=>{var l=h.user,v=h.resourceLibrary;return{userInfo:l,resourceLibrary:v}};class q extends R().Component{constructor(){super(...arguments);this.state={codeUrl:"",isModalVisible:!1},this.handleCancel=()=>{var l=this.props.closeShareWay;l&&l()},this.copy=()=>{var l=document.getElementById("link");l.select(),document.execCommand("Copy"),A.default.success(this.props.t("live.copySuccess"))},this.open=()=>{var l=this.props.shareUrl;N.Z.targetTo({path:l,isExternalLink:!0})},this.sendMessage=()=>{this.setState({isModalVisible:!0})},this.handleOk=()=>{var l=this.props,v=l.sourceKnowledgeId,p=l.shareUrl,d=l.t;(0,K.bG)(v,p).then(P=>{var E=P.data.code;E===2e5||E==="200000"?(A.default.success(d("shareInfo.sendSuccess")),this.setState({isModalVisible:!1})):A.default.error(d("shareInfo.sendFail"))})},this.handleSendCancel=()=>{this.setState({isModalVisible:!1})},this.download=()=>{var l=document.getElementById("code_canvas"),v=this.state.codeUrl,p=new Image;p.crossOrigin="anonymous",p.src=v,p.onload=()=>{var d=l.getContext("2d");d.textAlign="center",d.fillStyle="#fff",d.fillRect(0,0,750,886),d.drawImage(p,185,217,381,381),d.font="42px bold serif",d.fillStyle="#4F4F4F";var P=l.toDataURL("image/jpeg"),E=document.createElement("a");E.setAttribute("href",P),E.setAttribute("download","\u4E8C\u7EF4\u7801.jpg"),document.body.insertAdjacentElement("beforeend",E),E.click(),E.remove()}}}componentDidUpdate(l){l.showShareWay!==this.props.showShareWay&&this.props.showShareWay&&U.toDataURL(this.props.shareUrl,{width:500}).then(v=>{this.setState({codeUrl:v})}).catch(()=>{A.default.error(this.props.t("integralMall.qrCodeFailed"))})}render(){var l=this.props,v=l.prefixCls,p=l.t,d=l.showShareWay,P=l.shareUrl,E=l.courseType,O=l.shareScene,g=this.state,_=g.codeUrl,V=g.isModalVisible;return R().createElement(L.Z,{centered:!0,title:p("shareInfo.shareWay"),visible:d,footer:null,onCancel:this.handleCancel,maskClosable:!1,width:920,bodyStyle:{padding:"24px"}},R().createElement("div",{className:"".concat(v)},R().createElement("div",{className:"".concat(v,"_tip")},O!="customer_training"?p("shareInfo.shareWayTipOne"):null,O!="customer_training"?R().createElement("br",null):null,O!="customer_training"?p("shareInfo.shareWayTipTwo"):null,O==="customer_training"?p("shareInfo.shareWayTip"):null),R().createElement("div",{className:"".concat(v,"_title")},R().createElement("span",null,p("shareInfo.firstWay"))," ",p("shareInfo.firstWayDesc")),R().createElement("div",{className:"".concat(v,"_url")},R().createElement(w.Z,{className:"".concat(v,"_url_input"),readOnly:!0,value:P}),R().createElement(w.Z,{className:"".concat(v,"_url_hidden"),value:P,id:"link"}),R().createElement(y.Z,{type:"link",onClick:this.copy},p("common.copy")),R().createElement(y.Z,{type:"link",onClick:this.open},p("shareInfo.openShare"))),R().createElement("div",{className:"".concat(v,"_title")},R().createElement("span",null,p("shareInfo.secondWay"))," ",p("shareInfo.secondWayDesc")),R().createElement("div",{className:"".concat(v,"_code")},R().createElement("div",{className:"".concat(v,"_code_white")},R().createElement("img",{className:"".concat(v,"_code_white_img"),src:_,alt:""})),R().createElement("canvas",{className:"".concat(v,"_code_canvas"),id:"code_canvas",width:750,height:886}),R().createElement(y.Z,{type:"link",onClick:this.download},p("shareInfo.downloadCode"))),E==="graphicLesson"&&O==="customer_training"&&R().createElement(R().Fragment,null,R().createElement("div",{className:"".concat(v,"_wrapper")},R().createElement("div",{className:"".concat(v,"_title")},R().createElement("span",null,p("shareInfo.thirdWay"))," ",p("shareInfo.thirdWayDesc"),R().createElement("span",{className:"".concat(v,"_descDetail")},p("shareInfo.thirdWayDescDetail"))),R().createElement(y.Z,{type:"link",onClick:this.sendMessage},p("shareInfo.sendMessages"))),R().createElement(L.Z,{title:p("shareInfo.modalTitle"),visible:V,onOk:this.handleOk,onCancel:this.handleSendCancel},R().createElement("p",null,p("shareInfo.modalTipsContent"))))))}}q.defaultProps={prefixCls:"share-way"},se.Z=(0,F.$j)($)((0,j.Z)()(q))},98005:function(ve){/*!
 * Compressor.js v1.1.1
 * https://fengyuanchen.github.io/compressorjs
 *
 * Copyright 2018-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2021-10-05T02:32:40.212Z
 */(function(se,t){ve.exports=t()})(this,function(){"use strict";function se(b,C){var f=Object.keys(b);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(b);C&&(x=x.filter(function(z){return Object.getOwnPropertyDescriptor(b,z).enumerable})),f.push.apply(f,x)}return f}function t(b){for(var C=1;C<arguments.length;C++){var f=arguments[C]!=null?arguments[C]:{};C%2?se(Object(f),!0).forEach(function(x){y(b,x,f[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(f)):se(Object(f)).forEach(function(x){Object.defineProperty(b,x,Object.getOwnPropertyDescriptor(f,x))})}return b}function ne(b,C){if(!(b instanceof C))throw new TypeError("Cannot call a class as a function")}function L(b,C){for(var f=0;f<C.length;f++){var x=C[f];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(b,x.key,x)}}function ee(b,C,f){return C&&L(b.prototype,C),f&&L(b,f),b}function y(b,C,f){return C in b?Object.defineProperty(b,C,{value:f,enumerable:!0,configurable:!0,writable:!0}):b[C]=f,b}function n(){return n=Object.assign||function(b){for(var C=1;C<arguments.length;C++){var f=arguments[C];for(var x in f)Object.prototype.hasOwnProperty.call(f,x)&&(b[x]=f[x])}return b},n.apply(this,arguments)}var w={exports:{}};(function(b){typeof window!="undefined"&&function(C){var f=C.HTMLCanvasElement&&C.HTMLCanvasElement.prototype,x=C.Blob&&function(){try{return Boolean(new Blob)}catch(H){return!1}}(),z=x&&C.Uint8Array&&function(){try{return new Blob([new Uint8Array(100)]).size===100}catch(H){return!1}}(),W=C.BlobBuilder||C.WebKitBlobBuilder||C.MozBlobBuilder||C.MSBlobBuilder,ie=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,oe=(x||W)&&C.atob&&C.ArrayBuffer&&C.Uint8Array&&function(H){var T,I,u,k,B,D,ae,Y,he;if(T=H.match(ie),!T)throw new Error("invalid data URI");for(I=T[2]?T[1]:"text/plain"+(T[3]||";charset=US-ASCII"),u=!!T[4],k=H.slice(T[0].length),u?B=atob(k):B=decodeURIComponent(k),D=new ArrayBuffer(B.length),ae=new Uint8Array(D),Y=0;Y<B.length;Y+=1)ae[Y]=B.charCodeAt(Y);return x?new Blob([z?ae:D],{type:I}):(he=new W,he.append(D),he.getBlob(I))};C.HTMLCanvasElement&&!f.toBlob&&(f.mozGetAsFile?f.toBlob=function(H,T,I){var u=this;setTimeout(function(){I&&f.toDataURL&&oe?H(oe(u.toDataURL(T,I))):H(u.mozGetAsFile("blob",T))})}:f.toDataURL&&oe&&(f.msToBlob?f.toBlob=function(H,T,I){var u=this;setTimeout(function(){(T&&T!=="image/png"||I)&&f.toDataURL&&oe?H(oe(u.toDataURL(T,I))):H(u.msToBlob(T))})}:f.toBlob=function(H,T,I){var u=this;setTimeout(function(){H(oe(u.toDataURL(T,I)))})})),b.exports?b.exports=oe:C.dataURLtoBlob=oe}(window)})(w);var a=w.exports,A=function(C){return typeof Blob=="undefined"?!1:C instanceof Blob||Object.prototype.toString.call(C)==="[object Blob]"},M={strict:!0,checkOrientation:!0,maxWidth:Infinity,maxHeight:Infinity,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},R=typeof window!="undefined"&&typeof window.document!="undefined",U=R?window:{},j=function(C){return C>0&&C<Infinity},F=Array.prototype.slice;function K(b){return Array.from?Array.from(b):F.call(b)}var N=/^image\/.+$/;function $(b){return N.test(b)}function q(b){var C=$(b)?b.substr(6):"";return C==="jpeg"&&(C="jpg"),".".concat(C)}var h=String.fromCharCode;function l(b,C,f){var x="",z;for(f+=C,z=C;z<f;z+=1)x+=h(b.getUint8(z));return x}var v=U.btoa;function p(b,C){for(var f=[],x=8192,z=new Uint8Array(b);z.length>0;)f.push(h.apply(null,K(z.subarray(0,x)))),z=z.subarray(x);return"data:".concat(C,";base64,").concat(v(f.join("")))}function d(b){var C=new DataView(b),f;try{var x,z,W;if(C.getUint8(0)===255&&C.getUint8(1)===216)for(var ie=C.byteLength,oe=2;oe+1<ie;){if(C.getUint8(oe)===255&&C.getUint8(oe+1)===225){z=oe;break}oe+=1}if(z){var H=z+4,T=z+10;if(l(C,H,4)==="Exif"){var I=C.getUint16(T);if(x=I===18761,(x||I===19789)&&C.getUint16(T+2,x)===42){var u=C.getUint32(T+4,x);u>=8&&(W=T+u)}}}if(W){var k=C.getUint16(W,x),B,D;for(D=0;D<k;D+=1)if(B=W+D*12+2,C.getUint16(B,x)===274){B+=8,f=C.getUint16(B,x),C.setUint16(B,1,x);break}}}catch(ae){f=1}return f}function P(b){var C=0,f=1,x=1;switch(b){case 2:f=-1;break;case 3:C=-180;break;case 4:x=-1;break;case 5:C=90,x=-1;break;case 6:C=90;break;case 7:C=90,f=-1;break;case 8:C=-90;break}return{rotate:C,scaleX:f,scaleY:x}}var E=/\.\d*(?:0|9){12}\d*$/;function O(b){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return E.test(b)?Math.round(b*C)/C:b}function g(b){var C=b.aspectRatio,f=b.height,x=b.width,z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"none",W=j(x),ie=j(f);if(W&&ie){var oe=f*C;(z==="contain"||z==="none")&&oe>x||z==="cover"&&oe<x?f=x/C:x=f*C}else W?f=x/C:ie&&(x=f*C);return{width:x,height:f}}var _=U.ArrayBuffer,V=U.FileReader,S=U.URL||U.webkitURL,G=/\.\w+$/,Q=U.Compressor,re=function(){function b(C,f){ne(this,b),this.file=C,this.image=new Image,this.options=t(t({},M),f),this.aborted=!1,this.result=null,this.init()}return ee(b,[{key:"init",value:function(){var f=this,x=this.file,z=this.options;if(!A(x)){this.fail(new Error("The first argument must be a File or Blob object."));return}var W=x.type;if(!$(W)){this.fail(new Error("The first argument must be an image File or Blob object."));return}if(!S||!V){this.fail(new Error("The current browser does not support image compression."));return}if(_||(z.checkOrientation=!1),S&&!z.checkOrientation)this.load({url:S.createObjectURL(x)});else{var ie=new V,oe=z.checkOrientation&&W==="image/jpeg";this.reader=ie,ie.onload=function(H){var T=H.target,I=T.result,u={};if(oe){var k=d(I);k>1||!S?(u.url=p(I,W),k>1&&n(u,P(k))):u.url=S.createObjectURL(x)}else u.url=I;f.load(u)},ie.onabort=function(){f.fail(new Error("Aborted to read the image with FileReader."))},ie.onerror=function(){f.fail(new Error("Failed to read the image with FileReader."))},ie.onloadend=function(){f.reader=null},oe?ie.readAsArrayBuffer(x):ie.readAsDataURL(x)}}},{key:"load",value:function(f){var x=this,z=this.file,W=this.image;W.onload=function(){x.draw(t(t({},f),{},{naturalWidth:W.naturalWidth,naturalHeight:W.naturalHeight}))},W.onabort=function(){x.fail(new Error("Aborted to load the image."))},W.onerror=function(){x.fail(new Error("Failed to load the image."))},U.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(U.navigator.userAgent)&&(W.crossOrigin="anonymous"),W.alt=z.name,W.src=f.url}},{key:"draw",value:function(f){var x=this,z=f.naturalWidth,W=f.naturalHeight,ie=f.rotate,oe=ie===void 0?0:ie,H=f.scaleX,T=H===void 0?1:H,I=f.scaleY,u=I===void 0?1:I,k=this.file,B=this.image,D=this.options,ae=document.createElement("canvas"),Y=ae.getContext("2d"),he=Math.abs(oe)%180==90,me=(D.resize==="contain"||D.resize==="cover")&&j(D.width)&&j(D.height),ce=Math.max(D.maxWidth,0)||Infinity,fe=Math.max(D.maxHeight,0)||Infinity,_e=Math.max(D.minWidth,0)||0,De=Math.max(D.minHeight,0)||0,Te=z/W,Ee=D.width,ge=D.height;if(he){var Oe=[fe,ce];ce=Oe[0],fe=Oe[1];var je=[De,_e];_e=je[0],De=je[1];var xe=[ge,Ee];Ee=xe[0],ge=xe[1]}me&&(Te=Ee/ge);var $e=g({aspectRatio:Te,width:ce,height:fe},"contain");ce=$e.width,fe=$e.height;var ke=g({aspectRatio:Te,width:_e,height:De},"cover");if(_e=ke.width,De=ke.height,me){var He=g({aspectRatio:Te,width:Ee,height:ge},D.resize);Ee=He.width,ge=He.height}else{var Pe=g({aspectRatio:Te,width:Ee,height:ge}),ze=Pe.width;Ee=ze===void 0?z:ze;var Le=Pe.height;ge=Le===void 0?W:Le}Ee=Math.floor(O(Math.min(Math.max(Ee,_e),ce))),ge=Math.floor(O(Math.min(Math.max(ge,De),fe)));var qe=-Ee/2,Ze=-ge/2,Ge=Ee,st=ge,et=[];if(me){var tt=0,Qe=0,Ye=z,Ne=W,at=g({aspectRatio:Te,width:z,height:W},{contain:"cover",cover:"contain"}[D.resize]);Ye=at.width,Ne=at.height,tt=(z-Ye)/2,Qe=(W-Ne)/2,et.push(tt,Qe,Ye,Ne)}if(et.push(qe,Ze,Ge,st),he){var Ue=[ge,Ee];Ee=Ue[0],ge=Ue[1]}ae.width=Ee,ae.height=ge,$(D.mimeType)||(D.mimeType=k.type);var rt="transparent";if(k.size>D.convertSize&&D.convertTypes.indexOf(D.mimeType)>=0&&(D.mimeType="image/jpeg"),D.mimeType==="image/jpeg"&&(rt="#fff"),Y.fillStyle=rt,Y.fillRect(0,0,Ee,ge),D.beforeDraw&&D.beforeDraw.call(this,Y,ae),!this.aborted&&(Y.save(),Y.translate(Ee/2,ge/2),Y.rotate(oe*Math.PI/180),Y.scale(T,u),Y.drawImage.apply(Y,[B].concat(et)),Y.restore(),D.drew&&D.drew.call(this,Y,ae),!this.aborted)){var Xe=function(it){x.aborted||x.done({naturalWidth:z,naturalHeight:W,result:it})};ae.toBlob?ae.toBlob(Xe,D.mimeType,D.quality):Xe(a(ae.toDataURL(D.mimeType,D.quality)))}}},{key:"done",value:function(f){var x=f.naturalWidth,z=f.naturalHeight,W=f.result,ie=this.file,oe=this.image,H=this.options;if(S&&!H.checkOrientation&&S.revokeObjectURL(oe.src),W)if(H.strict&&W.size>ie.size&&H.mimeType===ie.type&&!(H.width>x||H.height>z||H.minWidth>x||H.minHeight>z||H.maxWidth<x||H.maxHeight<z))W=ie;else{var T=new Date;W.lastModified=T.getTime(),W.lastModifiedDate=T,W.name=ie.name,W.name&&W.type!==ie.type&&(W.name=W.name.replace(G,q(W.type)))}else W=ie;this.result=W,H.success&&H.success.call(this,W)}},{key:"fail",value:function(f){var x=this.options;if(x.error)x.error.call(this,f);else throw f}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=Q,b}},{key:"setDefaults",value:function(f){n(M,f)}}]),b}();return re})}}]);
