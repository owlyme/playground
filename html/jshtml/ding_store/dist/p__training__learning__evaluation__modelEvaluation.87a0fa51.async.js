(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[1065],{98784:function(V,f,n){"use strict";n.r(f),n.d(f,{default:function(){return H}});var z=n(20228),x=n(11382),$=n(62029),K=n(34792),I=n(48086),A=n(93485),g=n(12924),a=n.n(g),c=n(91768),v=n(76651),h=n(80991),y=n(57068),D=n(28216),F=n(37055),C=n(10237);function T(i,e){var t=F.ZP.PostTalentEvaluation.getEvaluationQuestion(i,e);return C.WY.get({url:t})}function G(i){var e=i.userId,t=i.planId,s=i.submit_list,r=i.type,l=i.studentId,o={submit_list:s,type:r};l?o.assessed=l:o.assessed=e;var d=F.ZP.PostTalentEvaluation.commitEvaluationAnswer(e,t);return C.WY.post({url:d,data:o})}function U(i){var e=i.userId,t=i.planId,s=i.studentId,r=i.submit_list,l=i.type,o=CONFIG.PostTalentEvaluation.heEvaluationCommit(e,t,s);return request.post({url:o,data:{submit_list:r,assessed:s,type:l}})}var X=n(57663),N=n(71577),L=n(62615),q=n(88983),S=n(47933),M=n(43859),Q=S.ZP.Group;class R extends a().Component{constructor(e){super(e);this.onChange=t=>{this.props.onFieldChange({level_id:t.target.value})},this.state={}}render(){var e=this.props,t=e.baseData,s=e.defaultFieldList,r=e.idx,l=e.t,o=e.userName,d=s.level_id;return a().createElement("div",{className:"evaluation_question"},a().createElement("p",{className:"evaluation_question_title"},"".concat(r+1,".").concat(t.ability_title)),a().createElement("p",{className:"evaluation_question_desc"},t.ability_description),a().createElement(Q,{onChange:this.onChange,value:d},t.level_list.map((u,m)=>a().createElement("div",{key:u.level_id,className:"evaluation_question_item"},a().createElement(S.ZP,{value:u.level_id,key:m.toString()},u.level_title),a().createElement("p",{className:"evaluation_question_item_desc"},l("evaluation.levelDesc"),"\uFF1A",u.level_description||"--"),a().createElement("p",{className:"evaluation_question_item_desc"},l("evaluation.behaviorDesc"),"\uFF1A",u.behavior_desc||"--")))),t.trainee_level_title?a().createElement("p",{className:"evaluation_question_item_level"},l("evaluation.employeesMyself")," \uFF08",o,"\uFF09\uFF1A",t.trainee_level_title):null,t.dimensional_result&&a().createElement("div",null,t.dimensional_result.map((u,m)=>a().createElement(a().Fragment,{key:m.toString()},a().createElement("strong",null,u.dimension,"\uFF1A"),a().createElement("span",null,u.result),m!==t.dimensional_result.length-1&&a().createElement("span",null,"\uFF0C")))))}}var B=(0,M.Z)((0,c.Z)()(R));class O extends a().Component{constructor(){super(...arguments);this.handlePropsSubmit=()=>{var e=this.props.handleSubmit;e()},this.renderFooter=()=>{var e=this.props,t=e.isSubmitting,s=t===void 0?!1:t,r=e.onCancel,l=e.t;return a().createElement("footer",{className:"cl-form-fixed-footer"},a().createElement("div",{className:"cl-form-fixed-footer__container"},a().createElement(N.Z,{type:"primary",loading:s,onClick:this.handlePropsSubmit},l("common.submit")),a().createElement(N.Z,{onClick:r},l("common.cancel"))))},this.renderContent=()=>{var e=this.props,t=e.questions,s=e.title;return a().createElement(h.l0,{className:"cl-form"},this.renderFooter(),a().createElement("h1",{className:"cl-form-htitle"},s),t.map((r,l)=>this.renderField(r,l)))},this.checkSelect=e=>{var t=this.props.t,s="";return e||(s=t("evaluation.selectivityItem")),s},this.renderField=(e,t)=>{var s=this.props,r=s.values,l=s.userName;return a().createElement(h.gN,{key:e.ability_id,component:B,label:"",required:!0,idx:t,userName:l,baseData:e,validate:this.checkSelect,displayType:"Custom",name:e.ability_id,defaultFieldList:r[e.ability_id]})}}render(){return a().createElement(a().Fragment,null,this.renderContent(),a().createElement(L.I,null))}}var W=(0,c.Z)()(O),Y=i=>({userInfo:i.user});class j extends g.Component{constructor(){super(...arguments);this.state={infos:{title:"",list:[],userName:""},planId:"",request:!1,studentId:""},this.initialParams={},this.getQuestion=()=>{var e=this.props.userInfo.id,t=this.state,s=t.planId,r=t.studentId;T(r||e,s).then(l=>{var o=(0,A.Z)(l.data.list),d;try{for(o.s();!(d=o.n()).done;){var u=d.value;this.initialParams[u.ability_id]=""}}catch(m){o.e(m)}finally{o.f()}this.setState({request:!0,infos:{title:l.data.title,list:l.data.list,userName:l.data.user_name}})})},this.handleSubmit=(e,t)=>{for(var s=y.parse(v.m8.location.search),r=s.type,l=this.props.t,o=this.props.userInfo.id,d=this.state,u=d.planId,m=d.studentId,b=[],p=0,P=Object.keys(e);p<P.length;p++){var Z=P[p];b.push({level_id:e[Z].level_id,id:Z})}var E={planId:u,userId:o,submit_list:b,type:r};m?E.studentId=m:E.userId=o,G(E).then(J=>{t.setSubmitting(!1),J.data.code===0&&(I.default.success(l("common.submitSuccess")),v.m8.goBack())}).catch(()=>{I.default.success(l("common.submitFailure")),t.setSubmitting(!1)})},this.handleCancel=()=>{v.m8.goBack()}}componentDidMount(){var e=y.parse(v.m8.location.search),t=e.id,s=e.studentId;this.setState({planId:t,studentId:s},()=>{this.getQuestion()})}render(){var e=this.state,t=e.infos,s=e.request;return a().createElement("div",{className:"evaluation-model"},a().createElement("div",{className:"evaluation-model-container"},s?a().createElement(h.J9,{initialValues:this.initialParams,onSubmit:this.handleSubmit,render:r=>a().createElement(W,(0,$.Z)({},r,{title:t.title,questions:t.list,userName:t.userName,onCancel:this.handleCancel}))}):a().createElement(x.Z,null)))}}var H=(0,D.$j)(Y)((0,c.Z)()(j))}}]);
