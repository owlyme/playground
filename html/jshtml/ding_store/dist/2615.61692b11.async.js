(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[2615],{49146:function(gt,Se,e){"use strict";e.d(Se,{jz:function(){return y},uj:function(){return C},GY:function(){return p}});var O=e(34792),g=e(48086),b=e(57361),a=e(9754),T=e.n(a),o=e(10237),D=e(37055),K=e(43967),P=e(6793),y=function(c){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3,M=D.ZP.operationInfo.addOperationFile(),v=c.data.map(A=>{var d={content_type:c.type,id:A.spaceId,name:A.fileName,size:A.fileSize,type:A.fileType,biz_type:I,url:A.fileId};return d});return o.WY.post({url:M,params:{},data:{files:v}})},C=function(){var B=(0,b.Z)(T().mark(function c(I){var M;return T().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return M=D.ZP.advancedSetting.getSettingStatusByType("mobile_ding_disk_choose"),A.abrupt("return",new Promise(d=>{o.WY.get({url:M,params:{}}).then(l=>{var t=!1,h=JSON.parse(l.data.actions);h.map(F=>{F.type===I&&(t=F.param.checked==="true")}),d(t)}).catch(()=>{d(!1)})}));case 2:case"end":return A.stop()}},c)}));return function(I){return B.apply(this,arguments)}}(),p=(B,c)=>{var I=B.data.map(l=>{var t={content_type:B.type,id:l.id,path:l.path,name:l.name,size:l.size,type:l.type,biz_type:l.biz_type,url:l.url};return t}),M=c.t,v=c.value,A=c.uploaderList,d=(0,K.Y5)(A);if(I.length+d.length+v.length>5){g.default.warning((0,P.ZT)(M("component.stageAddFileTip"),5));return}return I}},57762:function(gt,Se,e){"use strict";var O=e(88983),g=e(47933),b=e(12924),a=e.n(b),T=e(91768),o=e(43859);class D extends a().Component{constructor(){super(...arguments);this.handleChange=P=>{var y=P.target.value;this.props.onFieldChange(y)}}render(){var P=this.props,y=P.value,C=P.radioList,p=P.placeHolder,B=P.isPreview;return a().createElement("div",{className:"radio-mentor-form"},a().createElement(g.ZP.Group,{onChange:this.handleChange,disabled:B,value:y},C.map(c=>a().createElement(g.ZP,{key:c.value,value:c.value},c.name))),p&&(y==="resource_evaluation"||y==="satisfaction")&&a().createElement("div",{className:"desc-tip"},p))}}Se.Z=(0,o.Z)((0,T.Z)()(D))},3233:function(gt,Se,e){"use strict";var O=e(62029),g=e(59250),b=e(13013),a=e(57663),T=e(71577),o=e(30887),D=e(99210),K=e(43185),P=e(53251),y=e(88986),C=e(22385),p=e(31097),B=e(57361),c=e(34792),I=e(48086),M=e(9754),v=e.n(M),A=e(12924),d=e.n(A),l=e(91768),t=e(28216),h=e(80991),F=e(49101),m=e(73566),E=e(9669),Q=e.n(E),G=e(49146),V=e(37055),z=e(10237),$=e(54531),W=e(40938),S=e(74262),x=e(84874),U=e(43859),L=e(10780),w=e(43967),k=e(6793),ne=e(1164),ie=e(76466),Ne=5,ue=j=>({uploaderList:j.uploader.list,uploadSucceedItem:j.uploader.uploadSucceedItem,uploadComponentType:j.uploader.uploadComponentType,dingUserId:j.user.account,corpId:j.user.corpId}),_e=j=>{if(j.icon)return j.icon;var R=j.name.split(".").pop();j.content_type==="html"?R="html":j.content_type==="scorm"&&(R="scorm");var le=V.e1[R];return le||"iconf-matter-picture"};class Ze extends d().Component{constructor(R){var le;super(R);le=this,this.handleBeforeUpload=H=>{var X=this.props,ce=X.t,Te=X.value,Le=H.name.split(".").pop();if(V.WB.indexOf(Le.toLowerCase())===-1)return I.default.warning((0,k.ZT)(ce("upload.fileTypeLimit"),H.name)),!1;this.props.formik.setFieldValue("attachment",Te.concat(H))},this.handleOnChange=H=>{var X=H.file,ce=this.props,Te=ce.value,Le=ce.t;X.status==="done"?this.props.formik.setFieldValue("attachment",Te.filter(he=>he.id!==X.id).concat(X.response.data)):X.status==="error"&&(I.default.error("".concat(X.name," ").concat(Le("course.courseDetailCoverFailure"))),this.props.formik.setFieldValue("attachment",Te.filter(he=>he.id!==X.id)))},this.handleRemove=H=>{var X=this.props.value;this.props.formik.setFieldValue("attachment",X.filter(ce=>ce.id!==H.id))},this.handleUploadFile=()=>{this.setState({showFileSelector:!0})},this.handleSelectedCancel=()=>{this.setState({showFileSelector:!1})},this.handleSelectedAttachment=H=>{var X=this.props,ce=X.t,Te=X.value,Le=Te.map(ve=>ve.id),he=H.filter(ve=>!Le.includes(ve.id)),Ee=Te.length;if(he.length>Ne-Ee){I.default.warning((0,k.ZT)(ce("component.stageAddFileTip"),5));return}this.handleSelectedCancel(),he=he.map(ve=>(ve.size=ve.data.size,ve)),this.props.formik.setFieldValue("attachment",Te.concat(he))},this.handlePreviewDingFile=(0,B.Z)(v().mark(function H(){var X,ce,Te,Le,he,Ee,ve,be;return v().wrap(function(Ae){for(;;)switch(Ae.prev=Ae.next){case 0:return X=le.props,ce=X.corpId,Te=X.dingUserId,Le=X.value,he=X.t,Ae.next=3,(0,$.Cz)({corpId:ce,userId:Te});case 3:Ee=Ae.sent,ve=at=>{(0,G.jz)(at,3).then(et=>{if(et.data.code===0){var ut=(0,G.GY)(et.data,le.props);ut&&ut.length>0&&le.props.formik.setFieldValue("attachment",Le.concat(ut))}}).catch(et=>console.error(et))},be=at=>{I.default.warn("".concat(he("learning.dingSelectError"),": ").concat(JSON.parse(at)))},(0,$.yZ)({space:{spaceId:Ee,corpId:ce,max:5},types:["space"],onSuccess:ve,onFail:be});case 7:case"end":return Ae.stop()}},H)})),this.handleChooseFiles=H=>{var X=this.props,ce=X.t,Te=X.value,Le=X.uploaderList,he=X.uploadComponentId,Ee=X.notLibrary,ve=X.maxFilesCount,be=ve===void 0?5:ve,Ve=X.hasZip,Ae=Ve===void 0?"":Ve,at=(0,w.Y5)(Le);if(H.target.files.length+at.length+Te.length>be){I.default.warning((0,k.ZT)(ce("submitReport.uploadFileReportTip"),be));return}this.props.dispatch({type:"uploader/chooseFiles",payload:{choosedFiles:H.target.files,dispatch:this.props.dispatch,uploadComponentType:he,notLibrary:Ee,hasZip:Ae==="true"}}),H.target.value=null,H.target.files=null},this.handleDownLoad=H=>{Q().get(H.url,{responseType:"blob"}).then(X=>{var ce=URL.createObjectURL(X.data),Te=document.createElement("a");Te.setAttribute("href",ce),Te.setAttribute("download",H.name),Te.click()})},this.renderFileListItem=(H,X)=>{var ce=this.props,Te=ce.previewable,Le=ce.t,he=ce.downloadAble;return d().createElement("div",{className:"file-list-item",key:H.id||H.uid},d().createElement(x.Z,{iconClass:_e(H),size:"22px"}),d().createElement("div",{className:"info"},d().createElement("span",{className:"name"},H.name),H.id&&d().createElement("span",{className:"size"},H.size/1024>1024?"".concat((H.size/1024/1024).toFixed(1),"MB"):"".concat((H.size/1024).toFixed(1),"KB")),!H.id&&d().createElement("span",{className:"size"},Le("lineClassStudy.uploading"))),he&&d().createElement("div",{className:"attachment-download",onClick:()=>{this.handleDownLoad(H)}},d().createElement(p.Z,{title:Le("personal.download")},d().createElement("span",{className:"attachment-download-icon"},d().createElement(x.Z,{iconClass:"icon-xiazai1",size:"14px"})))),Te&&d().createElement("div",{className:"attachment-view"},d().createElement(p.Z,{title:Le("course.preview")},d().createElement("span",{className:"attachment-view-icon",onClick:()=>this.handlePreview(H)},d().createElement(x.Z,{iconClass:"icon-chakan1",size:"14px"})))),X&&d().createElement("div",{className:"attachment-remove"},d().createElement(p.Z,{title:Le("common.delete")},d().createElement("span",{className:"attachment-remove-icon",onClick:()=>{this.handleRemove(H)}},d().createElement(x.Z,{iconClass:"icon-shanchu",size:"14px"})))))},this.cancelUpload=()=>{this.setState({uploadVisible:!1})},this.uploadSuccess=H=>{var X=this.props,ce=X.t,Te=X.value;if(H.length+Te.length>5){I.default.warning((0,k.ZT)(ce("component.stageAddFileTip"),5));return}var Le=H.map(he=>{var Ee=V.Ss.indexOf(he.contentType)>-1,ve={html:"html",scorm:"scorm"}[he.contentType]||he.type;return{id:he.id,name:he.name,duration:he.duration,type:he.contentType,contentType:he.contentType,originalType:he.type,icon:V.e1[Ee?"mp3":ve],status:he.status,size:he.size}});this.props.formik.setFieldValue("attachment",this.props.value.concat(Le)),this.setState({uploadVisible:!1})},this.handlePreview=H=>{var X=this.props,ce=X.appType,Te=X.t,Le=H.biz_type||H.bizType;if(ce==="wx_app"&&Le===3){I.default.info(Te("lineClassStudy.ddFileNoSee"));return}if(ce==="app"){this.handlePreviewSystemFile(H);return}if(!((H.type==="zip"||H.type==="rar")&&H.storage_type!=="DING_PAN")){if(!dd.version&&Le===3){I.default.info(Te("practiceOperation.dingFileTip"));return}if(Le!==3){this.handlePreviewSystemFile(H);return}var he=V.ZP.DingSpaceId.getSpaceId(),Ee={corpId:this.props.corpId,userId:this.props.dingUserId,fileids:H.url,timeStamp:Date.parse(new Date)};z.WY.get({url:he,params:Ee}).then(ve=>{ve.data.code===0?this.ddSpacePreview(H):I.default.info(ve.data.msg)}).catch(ve=>{I.default.error(ve.data)})}},this.ddSpacePreview=H=>{var X={spaceId:H.path,fileId:H.url,fileName:H.name,fileSize:H.size,fileType:H.type};(0,$.DR)(X)},this.handlePreviewSystemFile=H=>{var X=this.state.previewInfo,ce=H.status===1||H.status===2;if(ce){I.default.warning(this.props.t("resourceLibrary.transcodingPlayerTip"));return}var Te=H.contentType||H.content_type,Le=this.dealWatchType(H),he=V.Ss.indexOf(Te)>-1;if(Le==="article"){var Ee=H.contentType,ve=H.url,be=Ee==="h5/link";be?ne.Z.targetTo({path:ve,isExternalLink:!0}):ne.Z.targetTo({path:"/training/resourceManage/library/articlePreview?id=".concat(H.id)});return}if(Le==="scorm"){var Ve=H.url.split("//"),Ae=Ve[1].split("/"),at=[Ve[0],Ae[0]].join("//"),et="".concat(at,"/unzip_file/coolcollege-scorm/prod/preview.html?scormUrl=").concat(encodeURIComponent(H.url));ne.Z.targetTo({path:et,isExternalLink:!0});return}var ut={mode:"preview",watchType:Le};Le==="doc"?Object.assign(ut,{resourceInfo:{type:"",docType:H.type,aliUrl:H.path,url:H.url,docTitle:H.name,playId:H.videoId||H.video_id,storageType:H.storage_type}}):Le==="image"?Object.assign(ut,{resourceInfo:{url:H.url,playId:H.videoId||H.video_id,storageType:H.storage_type}}):Le==="html"?Object.assign(ut,{resourceInfo:{url:H.url}}):Object.assign(ut,{resourceInfo:{source:{FD:H.url,OD:H.path},originUrl:H.url,contentType:he?"mp3":H.type,playId:H.videoId||H.video_id,storageType:H.storage_type},autoPlay:!0,draggable:!0}),this.setState({resourcePlayInfo:ut,previewInfo:(0,y.Z)((0,y.Z)({},X),{},{title:H.name,visible:!0,onCancel:this.cancelPreview})})},this.dealWatchType=H=>{var X=H.contentType||H.content_type,ce=V.Yq.findIndex(Ae=>H.type.toLowerCase().includes(Ae))>-1,Te=X.indexOf("video")>-1,Le=V.Ss.indexOf(X)>-1,he=X.indexOf("image")>-1||H.type.indexOf("image")>-1||X.indexOf("picture")>-1||H.type.indexOf("picture")>-1,Ee=X.indexOf("html")>-1,ve=X.indexOf("scorm")>-1,be=X.indexOf("h5")>-1,Ve="";return be?Ve="article":ce?Ve="doc":Te||Le?Ve="video":he?Ve="image":Ee?Ve="html":ve&&(Ve="scorm"),Ve},this.cancelPreview=()=>{var H=this.state.previewInfo;this.setState({resourcePlayInfo:{mode:"preview",watchType:"",resourceInfo:{}},previewInfo:(0,y.Z)((0,y.Z)({},H),{},{visible:!1})})},this.state={showFileSelector:!1,UploadConfig:{data:{access_token:localStorage.token},action:V.ZP.PostAbility.operateAttachmentUpload(),beforeUpload:this.handleBeforeUpload,accept:".jpg,.jpeg,.png",showUploadList:!1,onChange:this.handleOnChange},uploadVisible:!1,isDingDiskChoose:!1,resourcePlayInfo:{mode:"preview",watchType:"",resourceInfo:{},autoPlay:!0,draggable:!0},previewInfo:{visible:!1,destroyOnClose:!0,title:this.props.t("resourceLibrary.previewCourseware"),onCancel:()=>{}}}}componentDidMount(){var R=this;return(0,B.Z)(v().mark(function le(){var H;return v().wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:return(0,$.TN)(),ce.next=3,(0,G.uj)("operation");case 3:H=ce.sent,R.setState({isDingDiskChoose:H});case 5:case"end":return ce.stop()}},le)}))()}UNSAFE_componentWillReceiveProps(R){if((0,w.Of)(R,this.props)){var le=R.uploadSucceedItem,H=le.id,X=le.name,ce=le.contentType,Te=le.type,Le=le.duration,he=le.status,Ee=le.size,ve=le.url,be=le.path;if(R.uploadComponentType!==R.uploadComponentId)return;var Ve=V.Ss.indexOf(ce)>-1,Ae={id:H,name:X,duration:Le,type:Te,originalType:Te,icon:V.e1[Ve?"mp3":Te],status:he,size:Ee,contentType:ce,url:ve,path:be};this.props.formik.setFieldValue("attachment",this.props.value.concat(Ae))}}render(){var R=this.props,le=R.t,H=R.value,X=R.removeable,ce=R.preview,Te=R.notLibrary,Le=Te===void 0?!1:Te,he=R.uploadTips,Ee=R.canSelectCourse,ve=Ee===void 0?!0:Ee,be=R.maxFilesCount,Ve=be===void 0?5:be,Ae=R.hasZip,at=Ae===void 0?"":Ae,et=R.downloadAble,ut=this.state,q=ut.uploadVisible,Oe=ut.showFileSelector,Je=ut.UploadConfig,je=ut.isDingDiskChoose,Be=ut.resourcePlayInfo,St=ut.previewInfo,Lt=d().createElement(D.Z,null,d().createElement(D.Z.Item,null,d().createElement(P.Z,Je,le("component.practiceUploadPicBtnText"))),d().createElement(D.Z.Item,null,Le?d().createElement("div",{className:"practice-attachment__upload__button"},le("component.practiceUploadFileBtnText"),d().createElement("input",{className:"file-input",multiple:!0,type:"file",onChange:this.handleChooseFiles})):d().createElement("div",{className:"practice-attachment__upload__button",onClick:()=>this.setState({uploadVisible:!0})},le("component.practiceUploadFileBtnText"))));return d().createElement("div",{className:"practice-attachment"},!ce&&d().createElement("div",null,d().createElement(L.Z,{visible:Oe,defaultChecked:H,onCancel:this.handleSelectedCancel,onOk:this.handleSelectedAttachment,excludeType:"h5",showPrivate:!1}),d().createElement(b.Z,{overlay:Lt,disabled:H.length===Ve},d().createElement(T.Z,null,d().createElement(F.Z,null)," ",le("component.localUpload"))),ve&&d().createElement(T.Z,{className:"practice-attachment__choose-courseware",icon:d().createElement(F.Z,null),disabled:H.length===5,onClick:this.handleUploadFile},le("component.coursewareLibSelect")),dd&&dd.version&&je&&!et?d().createElement(T.Z,{className:"practice-attachment__ding-upload-button",icon:d().createElement(m.Z,null),disabled:H.length===5,onClick:this.handlePreviewDingFile},le("learning.dingUpload")):null,d().createElement("div",{className:"tip"},he||le(at==="true"?"component.practiceUploadTipZip":"component.practiceUploadTipRange"))),d().createElement("div",{className:"file-list"},H.map(Wt=>this.renderFileListItem(Wt,X))),Le?d().createElement(W.Z,{params:{classifyId:0,bizType:1},hasZip:at}):d().createElement(S.Z,{visible:q,title:this.props.t("common.storage"),onCancel:this.cancelUpload,onSuccess:Wt=>this.uploadSuccess(Wt),params:{classifyId:0,bizType:0},hasZip:at,notLibrary:Le}),d().createElement(ie.Z,(0,O.Z)({},Be,{previewInfo:St})))}}Ze.defaultProps={removeable:!1,attachment:[],preview:!1,previewable:!1,downloadAble:!1},Se.Z=(0,t.$j)(ue)((0,U.Z)((0,h.$j)((0,l.Z)()(Ze))))},93117:function(gt,Se,e){"use strict";e.d(Se,{Z:function(){return G}});var O=e(88986),g=e(12924),b=e.n(g),a=e(91768),T=e(57663),o=e(71577),D=e(28216),K=e(49101),P=e(29182),y=e(1164),C=e(48479),p=e(45395),B=V=>({userInfo:V.user});class c extends b().Component{constructor(){super(...arguments);this.handleSearch=z=>{this.props.onSearch(z)},this.renderSearch=()=>{var z=this.props,$=z.prefixCls,W=z.t,S="".concat($,"__search");return b().createElement("div",{className:S},b().createElement(C.Z,{onSearch:this.handleSearch,placeholder:W("searchInputPlaceholder.certificate"),width:"238px"}))},this.renderAddBtn=()=>{var z=this.props,$=z.prefixCls,W=z.t,S="".concat($,"__add"),x=(0,p.F3)("/knowledgeBase/certificateResources/certificate",P.Cv);return x?b().createElement("div",{className:S},b().createElement(y.Z,{to:"/training/authentication/certificate/layout"},b().createElement(o.Z,{type:"primary",icon:b().createElement(K.Z,null)},W("authentication.newCertificate")))):null}}render(){var z=this.props.prefixCls;return b().createElement("header",{className:z},this.renderSearch(),this.renderAddBtn())}}c.defaultProps={prefixCls:"cl-certificate-selector__queryrow"};var I=(0,D.$j)(B)((0,a.Z)()(c)),M=e(66456),v=e(55313),A=e(95664),d=e(6793);class l extends b().Component{constructor(){super(...arguments);this.columns=[{title:this.props.t("component.certificateName"),dataIndex:"name"},{title:this.props.t("shareInfo.shareTitle"),dataIndex:"title"},{title:this.props.t("personnelDevelope.text"),dataIndex:"summary"},{title:this.props.t("common.createTime"),dataIndex:"createTime",render:z=>(0,d.p6)(z)}],this.handleTableChange=z=>{this.props.onTableChange(z)},this.handleRefresh=()=>{this.props.onRefresh()},this.handleSelectChange=(z,$)=>{this.props.onSelectChange({selectedRowKeys:z,selectedRows:$})}}render(){var z=this.props,$=z.prefixCls,W=z.list,S=W===void 0?[]:W,x=z.loading,U=z.paginationParams,L=U===void 0?{}:U,w=z.selectedRowKeys,k=w===void 0?[]:w,ne=z.selectType,ie={type:ne||"radio",selectedRowKeys:k,onChange:this.handleSelectChange};return b().createElement("section",{className:$},b().createElement(v.Z,{bordered:!0,size:"middle",columns:this.columns,rowKey:"id",rowSelection:ie,dataSource:S,pagination:!1,loading:x}),b().createElement(A.Z,{totalNum:L.total,totalPage:L.totalPage,defaultPageSize:L.pageSize,current:L.current,onChange:this.handleTableChange,onRefresh:this.handleRefresh}))}}l.defaultProps={prefixCls:"cl-certificate-selector__querycontent"};var t=(0,a.Z)()(l),h=e(18329),F=e(10237),m=e(37055),E={getList:m.ZP.SelectCertificate.getList};class Q extends b().Component{constructor(){super(...arguments);this.state={params:{keyword:"",status:"1",pageNumber:1,pageSize:5},tableLoading:!0,tableList:[],tableTotal:0,tablePageTotal:0,defaultChecked:[]},this.onInitTableList=()=>{this.setState({tableLoading:!0}),F.WY.get({url:E.getList(),params:(0,O.Z)({},this.state.params)}).then(z=>{setTimeout(()=>{this.setState({tableLoading:!1,tableList:z.data.list,tableTotal:z.data.total,tablePageTotal:z.data.pages})},300)})},this.handleChangePagination=z=>{this.setState($=>({params:(0,O.Z)((0,O.Z)({},$.params),{},{pageNumber:z})}),()=>{this.onInitTableList()})},this.handleQueryRowSearch=z=>{this.resetPagination().then(()=>{this.setState($=>({params:(0,O.Z)((0,O.Z)({},$.params),{},{keyword:z})}),()=>{this.onInitTableList()})})},this.resetPagination=()=>new Promise(z=>{this.setState($=>({params:(0,O.Z)((0,O.Z)({},$.params),{},{pageNumber:1,pageSize:5})}),()=>{z()})}),this.handleOk=()=>{this.props.onOk(this.state.defaultChecked)},this.handleSelectChange=z=>{var $=z.selectedRows,W=[];$.forEach(S=>{W.push({componentName:"ClCertificateSelector",id:S.id,name:S.name,previewUrl:S.previewUrl,description:S.summary,title:S.title})}),this.setState({defaultChecked:W})}}componentDidUpdate(z){this.props.visible&&this.props.visible!==z.visible&&this.setState({params:{keyword:"",status:"1",pageNumber:1,pageSize:5},defaultChecked:this.props.defaultChecked},()=>{this.onInitTableList()})}render(){var z=this.props,$=z.prefixCls,W=z.visible,S=z.onCancel,x=z.t,U=z.selectType,L=z.title,w=this.state,k=w.tableTotal,ne=w.tablePageTotal,ie=w.tableList,Ne=w.tableLoading,ue=w.params,_e=w.defaultChecked,Ze={total:k,totalPage:ne,current:ue.pageNumber,pageSize:ue.pageSize},j=_e.map(R=>R.id);return b().createElement(h.ZP,{visible:W,title:L||x("component.certificateSelect"),onCancel:S,okText:x("common.ok"),cancelText:x("common.cancel"),onOk:this.handleOk},b().createElement("div",{className:$},W?b().createElement(b().Fragment,null,b().createElement(I,{onSearch:this.handleQueryRowSearch}),b().createElement(t,{loading:Ne,paginationParams:Ze,list:ie,selectedRowKeys:j,onSelectChange:this.handleSelectChange,onTableChange:this.handleChangePagination,onRefresh:this.onInitTableList,selectType:U})):null))}}Q.defaultProps={prefixCls:"cl-certificate-selector",visible:!1,defaultChecked:[],onCancel:()=>{},onOk:()=>{},selectType:"radio",title:""};var G=(0,a.Z)()(Q)},86458:function(gt,Se,e){"use strict";e.d(Se,{Z:function(){return l}});var O=e(12924),g=e.n(O),b=e(36546),a=e(94184),T=e.n(a),o=e(53792),D=e.n(o),K=e(62029),P=e(81211);class y extends g().Component{constructor(){super(...arguments);this.handleDND=(h,F)=>{this.props.moveRow(h,F)}}render(){var h=this.props,F=h.index,m=h.record,E=h.keyName,Q=E===void 0?"id":E,G=h.disabled,V=(0,P.Z)(h,["index","record","keyName","disabled"]);return m?g().createElement(l,(0,K.Z)({},V,{id:m[Q],key:m[Q],title:m.title,disabled:G,index:F,wrapperInTable:!0,onDND:this.handleDND}),this.props.children):null}}var C=y;class p extends g().Component{render(){var h=this.props,F=h.className,m=h.children,E=T()(["ant-table-tbody",F]);return g().createElement("tbody",{className:E},m)}}var B=p,c={CARD:"CARD"},I={beginDrag(t){return{index:t.index}}},M={drop(t,h,F){if(!t.disabled){var m=document.getElementById("$Cl_drag_".concat(t.id));if(!F||!m)return null;var E=h.getItem().index,Q=t.index;E===t.lastIndex||Q===t.lastIndex||E!==Q&&(t.onDND(E,Q),h.getItem().index=Q)}}};function v(t,h){return{connectDropTarget:t.dropTarget(),isOver:h.isOver(),isOverCurrent:h.isOver({shallow:!0}),canDrop:h.canDrop(),itemType:h.getItemType()}}function A(t,h){return{connectDragSource:t.dragSource(),isDragging:h.isDragging()}}class d extends O.Component{render(){var h=this.props,F=h.isDragging,m=h.connectDragSource,E=h.connectDropTarget,Q=h.wrapperInTable,G=h.id,V=h.children,z=h.activeRowId,$=T()(["cl-drag-item",F?"cl-drag-item-isDragging":"",Q?"ant-table-row":"",Q&&G===z?"ant-table-row-hover":""]);return m(E(Q?g().createElement("tr",{id:"$Cl_drag_".concat(G),"data-domid":"$Cl_drag_".concat(G),className:$,onMouseEnter:W=>this.props.onMouseEnter({id:G,e:W}),onMouseLeave:W=>this.props.onMouseLeave({id:G,e:W})},V):g().createElement("div",{id:"$Cl_drag_".concat(G),className:$},this.props.children)))}}d.defaultProps={wrapperInTable:!1,disabled:!1},d.DragTableRow=C,d.DragTableWrapper=B;var l=D()((0,b.Ej)(c.CARD,I,A),(0,b.GR)(c.CARD,M,v))(d)},59081:function(gt,Se,e){"use strict";e.d(Se,{Z:function(){return E}});var O=e(62029),g=e(88986),b=e(34792),a=e(48086),T=e(12924),o=e.n(T),D=e(91768),K=e(32452),P=e(76466),y=e(84874),C=e(66126),p=e(31955),B=e(57361),c=e(9754),I=e.n(c),M=e(6793),v=e(67230);class A extends o().Component{constructor(){var G;super(...arguments);G=this,this.state={paused:!0,current:0,source:this.props.source},this.handleTogglePlay=()=>{var V=this.props.readOnly;if(!V){var z=this.state.paused;this.setState({paused:!z},()=>{this._audio[z?"play":"pause"]()})}},this.onTimeUpdate=()=>{var V=this.props.duration,z=Math.ceil(this._audio.currentTime),$=z>V,W=$?0:z;$||this.setState({current:W})},this.getSourcce=(0,B.Z)(I().mark(function V(){var z,$,W,S,x;return I().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:if(z=G.props,$=z.videoId,W=z.storage_type,S=z.source,W!=="ALIBABA_PRIVATE"){L.next=6;break}return L.next=4,(0,v.y5)($);case 4:x=L.sent,x&&(S=x);case 6:G.setState({source:S});case 7:case"end":return L.stop()}},V)})),this.onEnded=()=>{this._audio.currentTime=0,this.setState({current:0,paused:!0},()=>{this._audio.pause()})},this.handleChangeCurrent=V=>{this._audio.pause(),this.setState({paused:!0,current:V})},this.handleAfterChange=V=>{this.setState({paused:!1,current:V},()=>{this._audio.currentTime=V,this._audio.play()})},this.handleError=()=>{this.getSourcce()},this.renderAudio=()=>{var V=this.state.source;return o().createElement("audio",{ref:z=>this._audio=z,onTimeUpdate:this.onTimeUpdate,onEnded:this.onEnded,src:V,onError:this.handleError},o().createElement("source",{src:V}),"\u60A8\u7684\u6D4F\u89C8\u5668\u4E0D\u652F\u6301 audio \u5143\u7D20\u3002")},this.renderCustomUI=()=>{var V=this.props.prefixCls,z="".concat(V,"__content");return o().createElement("div",{className:z},this.renderPlayBtn(),this.renderDuration(),this.renderSlide())},this.renderPlayBtn=()=>{var V=this.props.prefixCls,z=this.state.paused,$="".concat(V,"__content__playbtn"),W=z?"icon-bofang":"icon-zanting";return o().createElement("span",{className:$,onClick:this.handleTogglePlay},o().createElement(y.Z,{iconClass:W,size:"18px",color:"#4D536E"}))},this.renderDuration=()=>{var V=this.props,z=V.prefixCls,$=V.duration,W="".concat(z,"__content__rest"),S=this.state.current,x=$-S>=0?$-S:0;return o().createElement("span",{className:W},(0,M.xj)(x))},this.renderSlide=()=>{var V=this.props,z=V.prefixCls,$=V.duration,W=V.readOnly,S="".concat(z,"__content__slide"),x=this.state.current;return o().createElement("div",{className:S},o().createElement(p.Z,{ref:U=>this._slider=U,min:0,max:$,value:x,disabled:W,tipFormatter:null,onChange:this.handleChangeCurrent,onAfterChange:this.handleAfterChange}))}}componentDidMount(){this.getSourcce()}render(){var G=this.props.prefixCls;return o().createElement("div",{className:G},this.renderAudio(),this.renderCustomUI())}}A.defaultProps={prefixCls:"cl-audio",source:"",duration:0,autoPlay:!1,readOnly:!1,videoId:""};var d=A,l=e(10237),t=e(37055),h=e(73488),F={getRecordInfo:t.ZP.CoursewareSelector.getRecordInfo};class m extends o().Component{constructor(G){super(G);this.getImmediateRecord=()=>{l.WY.get({url:F.getRecordInfo(),params:{resourceId:this.state.record.id}}).then(W=>{var S=W.data.data;this.setState({record:S,isLoading:!1})}).catch(()=>{this.setState({isLoading:!1,resourceError:!0})})},this.handlePreview=W=>{var S=W.record,x=this.state.previewInfo,U=S.status===1||S.status===2;if(U){a.default.warning(this.props.t("resourceLibrary.transcodingPlayerTip"));return}var L=this.props.editable;!L||this.setState({resourcePlayInfo:{mode:"preview",watchType:"video",resourceInfo:{source:{FD:S.url,OD:S.path},originUrl:S.url,contentType:"mp3",playId:S.videoId||S.video_id,storageType:S.storage_type},autoPlay:!0,draggable:!0},previewInfo:(0,g.Z)((0,g.Z)({},x),{},{title:S.name,visible:!0,onCancel:this.cancelPreview})})},this.cancelPreview=()=>{var W=this.state.previewInfo;this.setState({resourcePlayInfo:{mode:"preview",watchType:"",resourceInfo:{}},previewInfo:(0,g.Z)((0,g.Z)({},W),{},{visible:!1})})},this.handleDelete=()=>{this.props.editor.setValue(K.ContentUtils.removeBlock(this.props.editorState,this.props.block))},this.renderPlayWrapper=W=>{var S=W.record,x=this.props,U=x.prefixCls,L=x.editable,w=S.url,k=S.status,ne=S.storage_type,ie=S.videoId,Ne=S.duration;return Ne=k===3?parseInt(Ne,10):0,o().createElement("div",{className:"".concat(U,"__audio-wrapper"),onClick:()=>this.handlePreview({record:S})},o().createElement(d,{readOnly:L||k!==3,source:w,duration:Ne,storage_type:ne,videoId:ie}))},this.renderRemoveBtn=()=>{var W=this.props,S=W.prefixCls,x=W.editable;return x&&o().createElement("span",{className:"".concat(S,"__action"),onClick:this.handleDelete},o().createElement(y.Z,{iconClass:"icon-f-close",size:"12px",color:"#4D536E"}))};var V=G.meta,z=G.mediaData,$;V?$=V.record:$=z.meta.record,this.state={isLoading:!0,record:$,remainInfo:{name:$.title,iconType:"mp3"},resourceError:!1,resourcePlayInfo:{mode:"preview",watchType:"",resourceInfo:{},autoPlay:!0,draggable:!0},previewInfo:{visible:!1,destroyOnClose:!0,title:this.props.t("resourceLibrary.previewCourseware"),onCancel:()=>{}}}}componentDidMount(){this.getImmediateRecord()}render(){var G=this.props,V=G.prefixCls,z=G.editable,$=this.state,W=$.resourcePlayInfo,S=$.previewInfo,x=$.record,U=$.isLoading,L=$.resourceError,w=$.remainInfo;return U?null:L?o().createElement(h.Z,(0,O.Z)({},w,{editable:z,onDelete:this.handleDelete})):o().createElement("div",{className:V},o().createElement("span",{className:"".concat(V,"__title")},o().createElement(y.Z,{iconClass:t.e1.mp3,size:"18px"}),x.name),this.renderPlayWrapper({record:x}),this.renderRemoveBtn(),z&&o().createElement(P.Z,(0,O.Z)({},W,{previewInfo:S})))}}m.defaultProps={prefixCls:"cl-h5-article__atomics-audio",editable:!0};var E=(0,D.Z)()(m)},48033:function(gt,Se,e){"use strict";var O=e(62029),g=e(88986),b=e(34792),a=e(48086),T=e(12924),o=e.n(T),D=e(91768),K=e(32452),P=e(57068),y=e(73488),C=e(1164),p=e(76466),B=e(84874),c=e(65202),I=e(10237),M=e(37055),v={getRecordInfo:M.ZP.CoursewareSelector.getRecordInfo};class A extends o().Component{constructor(l){super(l);this.getImmediateRecord=()=>{I.WY.get({url:v.getRecordInfo(),params:{resourceId:this.state.record.id}}).then(m=>{var E=m.data.data;this.setState({record:E,isLoading:!1})}).catch(()=>{this.setState({isLoading:!1,resourceError:!0})})},this.handlePreview=m=>{var E=m.record,Q=this.state.previewInfo,G=E.status===1||E.status===2;if(G){a.default.warning(this.props.t("resourceLibrary.transcodingPlayerTip"));return}var V=this.props.editable,z=V===void 0?!0:V;if(z)this.setState({resourcePlayInfo:{mode:"preview",watchType:"doc",resourceInfo:{type:"",docType:E.type,aliUrl:E.path,url:E.url,docTitle:E.name,playId:E.videoId||E.video_id,storageType:E.storage_type}},previewInfo:(0,g.Z)((0,g.Z)({},Q),{},{title:E.name,visible:!0,onCancel:this.cancelPreview})});else{var $={docType:E.type,aliUrl:E.path,url:E.url,docTitle:E.name,videoId:E.videoId||E.video_id,storage_type:E.storage_type};C.Z.targetTo({path:"/training/learning/task/watchDoc?".concat(P.stringify($)),projectType:"student"})}},this.cancelPreview=()=>{var m=this.state.previewInfo;this.setState({resourcePlayInfo:{mode:"preview",watchType:"",resourceInfo:{}},previewInfo:(0,g.Z)((0,g.Z)({},m),{},{visible:!1})})},this.handleDelete=()=>{this.props.editor.setValue(K.ContentUtils.removeBlock(this.props.editorState,this.props.block))};var t=l.meta,h=l.mediaData,F;t?F=t.record:F=h.meta.record,this.state={isLoading:!0,record:F,remainInfo:{name:F.title,iconType:F.type},resourceError:!1,resourcePlayInfo:{mode:"preview",watchType:"doc",resourceInfo:{},autoPlay:!0,draggable:!0},previewInfo:{visible:!1,destroyOnClose:!0,title:this.props.t("resourceLibrary.previewCourseware"),onCancel:()=>{}}}}componentDidMount(){this.getImmediateRecord()}render(){var l=this.props,t=l.prefixCls,h=l.editable,F=h===void 0?!0:h,m=l.t,E=(0,c.p)(),Q=this.state,G=Q.resourcePlayInfo,V=Q.previewInfo,z=Q.record,$=Q.isLoading,W=Q.resourceError,S=Q.remainInfo;return $?null:W?o().createElement(y.Z,(0,O.Z)({},S,{editable:F,onDelete:this.handleDelete})):o().createElement("div",{className:t},o().createElement("span",{className:"".concat(t,"__title")},o().createElement(B.Z,{iconClass:M.e1[z.type],size:"18px"}),z.name),o().createElement("span",{className:"".concat(t,"__action")},o().createElement("span",{onClick:()=>this.handlePreview({record:z}),style:{color:E}},m("common.clickToView")),F&&o().createElement("span",{onClick:this.handleDelete},o().createElement(B.Z,{iconClass:"icon-f-close",size:"12px",color:"#4D536E"}))),o().createElement(p.Z,(0,O.Z)({},G,{previewInfo:V})))}}A.defaultProps={prefixCls:"cl-h5-article__atomics-doc"},Se.Z=(0,D.Z)()(A)},73488:function(gt,Se,e){"use strict";var O=e(12924),g=e.n(O),b=e(91768),a=e(84874),T=e(37055);class o extends g().Component{render(){var K=this.props,P=K.prefixCls,y=K.name,C=K.iconType,p=K.editable,B=p===void 0?!1:p,c=K.onDelete,I=K.t;return g().createElement("div",{className:P},g().createElement("span",{className:"".concat(P,"__title")},g().createElement(a.Z,{iconClass:T.e1[C],size:"18px"}),y),g().createElement("span",{className:"".concat(P,"__action")},g().createElement("span",{className:"".concat(P,"__action__disabled")},I("common.rsNonExistent")),B&&g().createElement("span",{onClick:c},g().createElement(a.Z,{iconClass:"icon-f-close",size:"12px",color:"#4D536E"}))))}}o.defaultProps={prefixCls:"cl-h5-article__atomics-empty"},Se.Z=(0,b.Z)()(o)},13129:function(gt,Se,e){"use strict";e.d(Se,{Z:function(){return P}});var O=e(62029),g=e(33565),b=e(88986),a=e(12924),T=e.n(a),o=e(32452),D=(y,C)=>[{key:"undo",title:y.controls.undo,text:React.createElement("i",{className:"bfi-undo"}),type:"editor-method",command:"undo"},{key:"redo",title:y.controls.redo,text:React.createElement("i",{className:"bfi-redo"}),type:"editor-method",command:"redo"},{key:"remove-styles",title:y.controls.removeStyles,text:React.createElement("i",{className:"bfi-format_clear"}),type:"editor-method",command:"removeSelectionInlineStyles"},{key:"hr",title:y.controls.hr,text:React.createElement("i",{className:"bfi-hr"}),type:"editor-method",command:"insertHorizontalLine"},{key:"bold",title:y.controls.bold,text:React.createElement("i",{className:"bfi-bold"}),type:"inline-style",command:"bold"},{key:"italic",title:y.controls.italic,text:React.createElement("i",{className:"bfi-italic"}),type:"inline-style",command:"italic"},{key:"underline",title:y.controls.underline,text:React.createElement("i",{className:"bfi-underlined"}),type:"inline-style",command:"underline"},{key:"strike-through",title:y.controls.strikeThrough,text:React.createElement("i",{className:"bfi-strikethrough"}),type:"inline-style",command:"strikethrough"},{key:"superscript",title:y.controls.superScript,text:React.createElement("i",{className:"bfi-superscript"}),type:"inline-style",command:"superscript"},{key:"subscript",title:y.controls.subScript,text:React.createElement("i",{className:"bfi-subscript"}),type:"inline-style",command:"subscript"},{key:"headings",title:y.controls.headings,type:"headings"},{key:"blockquote",title:y.controls.blockQuote,text:React.createElement("i",{className:"bfi-quote"}),type:"block-type",command:"blockquote"},{key:"code",title:y.controls.code,text:React.createElement("i",{className:"bfi-code"}),type:"block-type",command:"code-block"},{key:"list-ul",title:y.controls.unorderedList,text:React.createElement("i",{className:"bfi-list"}),type:"block-type",command:"unordered-list-item"},{key:"list-ol",title:y.controls.orderedList,text:React.createElement("i",{className:"bfi-list-numbered"}),type:"block-type",command:"ordered-list-item"},{key:"link",title:y.controls.link,type:"link"},{key:"text-color",title:y.controls.color,type:"text-color"},{key:"line-height",title:y.controls.lineHeight,type:"line-height"},{key:"letter-spacing",title:y.controls.letterSpacing,type:"letter-spacing"},{key:"text-indent",title:y.controls.textIndent,type:"text-indent"},{key:"font-size",title:y.controls.fontSize,type:"font-size"},{key:"font-family",title:y.controls.fontFamily,type:"font-family"},{key:"text-align",title:y.controls.textAlign,type:"text-align"},{key:"media",title:y.controls.media,text:React.createElement("i",{className:"bfi-media"}),type:"media"},{key:"emoji",title:y.controls.emoji,text:React.createElement("i",{className:"bfi-emoji"}),type:"emoji"},{key:"clear",title:y.controls.clear,text:React.createElement("i",{className:"bfi-clear_all"}),type:"editor-method",command:"clearEditorContent"},{key:"fullscreen",title:C.state.isFullscreen?y.controls.exitFullscreen:y.controls.fullscreen,text:React.createElement("i",{className:C.state.isFullscreen?"bfi-fullscreen-exit":"bfi-fullscreen"}),type:"editor-method",command:"toggleFullscreen"},{key:"modal",type:"modal"},{key:"button",type:"button"},{key:"dropdown",type:"dropdown"},{key:"component",type:"component"}],K={"float-left":{text:T().createElement("span",{"data-float":"left"},"\uE91E"),command:"setImageFloat|left"},"float-right":{text:T().createElement("span",{"data-float":"right"},"\uE914"),command:"setImageFloat|right"},"align-left":{text:T().createElement("span",{"data-align":"left"},"\uE027"),command:"setImageAlignment|left"},"align-center":{text:T().createElement("span",{"data-align":"center"},"\uE028"),command:"setImageAlignment|center"},"align-right":{text:T().createElement("span",{"data-align":"right"},"\uE029"),command:"setImageAlignment|right"},size:{text:T().createElement("span",null,"\uE3C2"),command:"toggleSizeEditor"},link:{text:T().createElement("span",null,"\uE91A"),command:"toggleLinkEditor"},remove:{text:T().createElement("span",null,"\uE9AC"),command:"removeImage"}};class P extends T().Component{constructor(){super(...arguments);this.state={toolbarVisible:!1,toolbarOffset:0,linkEditorVisible:!1,sizeEditorVisible:!1,tempLink:null,tempWidth:null,tempHeight:null},this.initialLeft=void 0,this.initialTop=void 0,this.initialWidth=void 0,this.initialHeight=void 0,this.reSizeType=void 0,this.aspectRatio=void 0,this.changeSize=C=>{var p=this.reSizeType;this.initialLeft||(this.initialLeft=C.screenX,this.initialTop=C.screenY),p==="rightbottom"&&(this.initialWidth+=C.screenX-this.initialLeft,this.initialHeight=this.initialWidth/this.aspectRatio),p==="leftbottom"&&(this.initialWidth+=-C.screenX+this.initialLeft,this.initialHeight=this.initialWidth/this.aspectRatio),this.initialLeft=C.screenX,this.initialTop=C.screenY},this.moveImage=C=>{this.changeSize(C),this.setState({tempWidth:Math.abs(this.initialWidth),tempHeight:Math.abs(this.initialHeight)})},this.upImage=()=>{this.confirmImageSize(),document.removeEventListener("mousemove",this.moveImage),document.removeEventListener("mouseup",this.upImage)},this.repareChangeSize=C=>p=>{this.reSizeType=C;var B=this.imageElement.getBoundingClientRect();this.initialLeft=this.initialTop=0,this.initialWidth=B.width,this.initialHeight=B.height,this.aspectRatio=B.width/B.height,p.preventDefault(),document.addEventListener("mousemove",this.moveImage),document.addEventListener("mouseup",this.upImage)},this.preventDragEvent=C=>{C.stopPropagation(),C.preventDefault()},this.handleDragStart=()=>this.props.editor.editorProps.readOnly||this.props.editor.editorProps.disabled?!1:(window.__BRAFT_DRAGING__IMAGE__={block:this.props.block,mediaData:(0,b.Z)({type:"IMAGE"},this.props.mediaData)},this.setState({toolbarVisible:!1},()=>{this.unlockEditor()}),!0),this.handleDragEnd=()=>(window.__BRAFT_DRAGING__IMAGE__=null,!1),this.executeCommand=C=>{if(typeof C=="string"){var p=C.split("|"),B=(0,g.Z)(p,2),c=B[0],I=B[1];this[c]&&this[c](I)}else typeof C=="function"&&C(this.props.block,this.props.mediaData,this.props.editor.getValue())},this.removeImage=()=>{this.props.editor.setValue(o.ContentUtils.removeBlock(this.props.editor.getValue(),this.props.block)),this.unlockEditor()},this.toggleLinkEditor=()=>{this.setState({linkEditorVisible:!this.state.linkEditorVisible,sizeEditorVisible:!1})},this.toggleSizeEditor=()=>{this.setState({linkEditorVisible:!1,sizeEditorVisible:!this.state.sizeEditorVisible})},this.handleLinkInputKeyDown=C=>{if(C.keyCode===13)this.confirmImageLink();else return},this.setImageLink=C=>{this.setState({tempLink:C.currentTarget.value})},this.confirmImageLink=()=>{var C=this.state.tempLink,p=this.props.hooks("set-image-link",C)(C);if(p===!1)return!1;typeof p=="string"&&(C=p),C!==null&&(this.props.editor.setValue(o.ContentUtils.setMediaData(this.props.editor.getValue(),this.props.entityKey,{link:C})),window.setImmediate(this.props.editor.forceRender))},this.handleSizeInputKeyDown=C=>{if(C.keyCode===13)this.confirmImageSize();else return},this.setImageWidth=C=>{var p=C.currentTarget,B=p.value;B&&!isNaN(B)&&(B=B+"px"),this.setState({tempWidth:B})},this.setImageHeight=C=>{var p=C.currentTarget,B=p.value;B&&!isNaN(B)&&(B=B+"px"),this.setState({tempHeight:B})},this.confirmImageSize=()=>{var C=this.state,p=C.tempWidth,B=C.tempHeight,c={};p!==null&&(c.width=p),B!==null&&(c.height=B);var I=this.props.hooks("set-image-size",c)(c);if(I===!1)return!1;I&&(I.width||I.height)&&(c=I),this.props.editor.setValue(o.ContentUtils.setMediaData(this.props.editor.getValue(),this.props.entityKey,c)),window.setImmediate(this.props.editor.forceRender)},this.setImageFloat=C=>{var p=this.props.hooks("set-image-float",C)(C);if(p===!1)return!1;typeof p=="string"&&(C=p),this.props.editor.setValue(o.ContentUtils.setMediaPosition(this.props.editor.getValue(),this.props.block,{float:C})),this.unlockEditor()},this.setImageAlignment=C=>{var p=this.props.hooks("set-image-alignment",C)(C);if(p===!1)return!1;typeof p=="string"&&(C=p),this.props.editor.setValue(o.ContentUtils.setMediaPosition(this.props.editor.getValue(),this.props.block,{alignment:C})),this.unlockEditor()},this.showToolbar=C=>{if(this.props.editor.editorProps.readOnly||this.props.editor.editorProps.disabled)return!1;C.preventDefault(),this.state.toolbarVisible||this.setState({toolbarVisible:!0},()=>{this.lockEditor(),this.setState({toolbarOffset:this.calcToolbarOffset()})})},this.hideToolbar=C=>{C.preventDefault(),this.setState({toolbarVisible:!1},()=>{this.unlockEditor(),this.props.editor.requestFocus()})}}render(){var C=this.props,p=C.mediaData,B=C.language,c=C.imageControls,I=C.imageResizable,M=this.state,v=M.toolbarVisible,A=M.toolbarOffset,d=M.sizeEditorVisible,l=M.tempWidth,t=M.tempHeight,h=this.props.block.getData(),F=h.get("float"),m=h.get("alignment"),E=p.url,Q=p.link,G=p.width,V=p.height,z=p.meta,$={},W=!1;F?m=null:m==="right"?($.float="right",W=!0):m==="center"?$.textAlign="center":($.float="left",W=!0);var S=c.map((x,U)=>typeof x=="string"&&K[x]?T().createElement("a",{className:x==="link"&&Q?"active":"",key:U,href:"javascript:void(0);",onClick:()=>this.executeCommand(K[x].command)},K[x].text):x&&(x.render||x.text)?x.render?x.render(p,this.props.block):T().createElement("a",{key:U,href:"javascript:void(0);",onClick:()=>x.onClick&&this.executeCommand(x.onClick)},x.text):null);return T().createElement("div",{className:"bf-media"},T().createElement("div",{style:$,draggable:!0,onClick:this.showToolbar,onMouseLeave:this.hideToolbar,onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,ref:x=>this.mediaEmbederInstance=x,className:"bf-image"},v?T().createElement("div",{style:{marginLeft:A},ref:x=>this.toolbarElement=x,"data-float":F,"data-align":m,className:"bf-media-toolbar"},d?T().createElement("div",{className:"bf-image-size-editor"},T().createElement("div",{className:"editor-input-group"},T().createElement("input",{type:"text",onDragStart:this.preventDragEvent,placeholder:B.base.width,onKeyDown:this.handleSizeInputKeyDown,onChange:this.setImageWidth,defaultValue:G}),T().createElement("input",{type:"text",onDragStart:this.preventDragEvent,placeholder:B.base.height,onKeyDown:this.handleSizeInputKeyDown,onChange:this.setImageHeight,defaultValue:V}),T().createElement("button",{type:"button",onClick:this.confirmImageSize},B.base.confirm))):null,S,T().createElement("i",{style:{marginLeft:A*-1},className:"bf-media-toolbar-arrow"})):null,T().createElement("div",{style:{position:"relative",width:"".concat(G,"px"),height:"".concat(V,"px"),display:"inline-block"}},T().createElement("img",(0,O.Z)({ref:x=>this.imageElement=x,src:E,width:G,height:V},z)),v&&I?T().createElement("div",{className:"bf-csize-icon right-bottom",onMouseDown:this.repareChangeSize("rightbottom")}):null,v&&I?T().createElement("div",{className:"bf-csize-icon left-bottom",onMouseDown:this.repareChangeSize("leftbottom")}):null,I?T().createElement("div",{className:"bf-pre-csize ".concat(this.reSizeType),style:{width:"".concat(l,"px"),height:"".concat(t,"px")}}):null)),W&&T().createElement("div",{className:"clearfix",style:{clear:"both",height:0,lineHeight:0,float:"none"}}))}lockEditor(){this.props.editor.lockOrUnlockEditor(!0)}unlockEditor(){this.props.editor.lockOrUnlockEditor(!1)}calcToolbarOffset(){var C=this.props,p=C.getContainerNode,B=C.containerNode,c=p?p():B;if(!c)return 0;var I=c.querySelector(".bf-content").getBoundingClientRect(),M=this.toolbarElement.getBoundingClientRect(),v=this.imageElement.getBoundingClientRect(),A=I.right-(v.right-v.width/2+M.width/2),d=v.left+v.width/2-M.width/2-I.left;return A<10?A-10:d<10?d*-1+10:0}setImageLinkTarget(C){var p=this.props.hooks("set-image-link-target",C)(C);if(p===!1)return!1;typeof p=="string"&&(C=p),C=C==="_blank"?"":"_blank",this.props.editor.setValue(o.ContentUtils.setMediaData(this.props.editor.getValue(),this.props.entityKey,{link_target:C})),window.setImmediate(this.props.editor.forceRender)}}},65454:function(gt,Se,e){"use strict";e.d(Se,{Z:function(){return A}});var O=e(62029),g=e(12924),b=e.n(g),a=e(32452),T=e(10237),o=e(37055),D=e(73488),K=e(88986),P=e(34792),y=e(48086),C=e(91768),p=e(76466),B=e(84874);class c extends b().Component{constructor(){super(...arguments);this.state={resourcePlayInfo:{mode:"preview",watchType:"",resourceInfo:{},autoPlay:!0,draggable:!0},previewInfo:{visible:!1,destroyOnClose:!0,title:this.props.t("resourceLibrary.previewCourseware"),onCancel:()=>{}}},this.handlePreview=()=>{var l=this.state.previewInfo,t=this.props,h=t.record,F=t.t,m=h.status!==3;if(m){y.default.warning(F("resourceLibrary.transcodingPlayerTip"));return}this.setState({resourcePlayInfo:{mode:"preview",watchType:"video",resourceInfo:{source:{FD:h.url,OD:h.path},originUrl:h.url,contentType:h.type,playId:h.videoId||h.video_id,storageType:h.storage_type},autoPlay:!0,draggable:!0},previewInfo:(0,K.Z)((0,K.Z)({},l),{},{title:h.name,visible:!0,onCancel:this.cancelPreview})})},this.cancelPreview=()=>{var l=this.state.previewInfo;this.setState({resourcePlayInfo:{mode:"preview",watchType:"",resourceInfo:{}},previewInfo:(0,K.Z)((0,K.Z)({},l),{},{visible:!1})})},this.renderTitle=()=>{var l=this.props.name,t="h5-bf-video-wrap__header";return b().createElement("header",{className:t},l)},this.renderMoveBtn=()=>{var l=this.props,t=l.onRemove,h=l.editable;return h?b().createElement("button",{onClick:t,className:"button-remove",type:"button"},b().createElement(B.Z,{iconClass:"icon-f-close",size:"12px",color:"#4D536E"})):null},this.renderPlayBtn=()=>{var l=this.props,t=l.editable,h=l.record;return t||h.status!==3?b().createElement("button",{onClick:this.handlePreview,className:"button-play",type:"button"},b().createElement(B.Z,{iconClass:"icon-bofang",size:"25px",color:"#fff"})):null},this.renderPoster=()=>{var l=this.props,t=l.poster,h=l.editable,F=l.record;return h||F.status!==3?b().createElement("div",{className:"bf-poster",style:{backgroundImage:"url(".concat(t,")")}}):null},this.renderVideo=()=>{var l=this.props,t=l.prefixCls,h=l.editable,F=l.record,m="".concat(t,"__video");if(F.status!==3)return null;var E={mode:"preview",watchType:"video",previewWay:"page",resourceInfo:{playerId:"J_prismPlayer__".concat(F.id),source:{FD:F.url,OD:F.path},originUrl:F.url,contentType:F.type,playId:F.videoId||F.video_id,storageType:F.storage_type},autoPlay:!1,draggable:!0};return h?null:b().createElement("div",{className:m},b().createElement(p.Z,E))}}render(){var l=this.props,t=l.prefixCls,h=l.type,F=l.editable,m=this.state,E=m.resourcePlayInfo,Q=m.previewInfo;return b().createElement(b().Fragment,null,this.renderTitle(),b().createElement("div",{className:"".concat(t," ").concat(h)},this.renderMoveBtn(),this.renderPlayBtn(),this.renderPoster(),this.renderVideo(),F&&b().createElement(p.Z,(0,O.Z)({},E,{previewInfo:Q}))))}}c.defaultProps={prefixCls:"h5-bf-player-holder",editable:!0};var I=(0,C.Z)()(c),M={getRecordInfo:o.ZP.CoursewareSelector.getRecordInfo};class v extends b().Component{constructor(l){super(l);this.getImmediateRecord=()=>{T.WY.get({url:M.getRecordInfo(),params:{resourceId:this.state.record.id}}).then(F=>{var m=F.data.data;this.setState({record:m,isLoading:!1})}).catch(()=>{this.setState({isLoading:!1,resourceError:!0})})},this.removeVideo=()=>{this.props.editor.setValue(a.ContentUtils.removeBlock(this.props.editorState,this.props.block))};var t=l.mediaData,h=t.meta.record;this.state={isLoading:!0,record:h,remainInfo:{name:h.title,iconType:"mp4"},resourceError:!1}}componentDidMount(){this.getImmediateRecord()}render(){var l=this.props.editable,t=l===void 0?!0:l,h=this.state,F=h.record,m=h.isLoading,E=h.resourceError,Q=h.remainInfo;return m?null:E?b().createElement(D.Z,(0,O.Z)({},Q,{editable:t,onDelete:this.removeVideo})):b().createElement("div",{className:"h5-bf-video-wrap"},b().createElement(I,{type:"video",name:F.title,poster:F.cover,record:F,editable:t,onRemove:this.removeVideo}))}}var A=v},62615:function(gt,Se,e){"use strict";e.d(Se,{i0:function(){return Xo},O:function(){return ed},Y9:function(){return rd},Mt:function(){return td},C0:function(){return Ho},E2:function(){return Rr},ww:function(){return Qo},Wc:function(){return Go},I:function(){return tr},h:function(){return nd},Eu:function(){return An.E},yK:function(){return ud},_e:function(){return id},OE:function(){return qo},xm:function(){return cd},Pk:function(){return od},Vi:function(){return Jo},QS:function(){return ld},en:function(){return ad},q6:function(){return sd}});var O=e(20560),g=e(49616),b=e(62029),a=e(63185),T=e(9676),o=e(34792),D=e(48086),K=e(57361),P=e(57663),y=e(71577),C=e(49111),p=e(19650),B=e(22385),c=e(31097),I=e(88983),M=e(47933),v=e(88986),A=e(9754),d=e.n(A),l=e(12924),t=e.n(l),h=e(28216),F=e(96486),m=e(80991),E=e(91768),Q=e(68628),G=e(90631),V=e(49101),z=e(57119),$=e(37055),W=e(10237),S=e(84874),x=e(88311),U=e(8908),L=e(60667),w=e(26885),k=Z=>{var r=Z.advancedSetting,n=Z.subsidyCourseInfo,s=Z.user;return{user:s,themeColor:r.themeColor,isSubsidyCourse:n.isSubsidyCourse,appType:s.appType,qyShield:s.qyShield}},ne=()=>{};class ie extends t().Component{constructor(r){var n;super(r);n=this,this.getUserManageRange=()=>{var s=$.ZP.Role.getUserManageRange();W.WY.get({url:s}).then(function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=i.data,f=u===void 0?{}:u,N=f.range_type;n.setState({userManageType:N})})},this.handleChange=s=>{var i=this.state.isSubsidy;if(!i){var u=s.target.value;this.setState({rangeType:u}),this.triggerChange({rangeType:u,rangeList:this.state.rangeList})}},this.triggerChange=s=>{var i=s.rangeType,u=s.rangeList,f={rangeType:i,rangeList:u},N=localStorage.getItem("authorityType"),Y=this.props.user.loginMode;Y==="WE_COM"&&N==="1"&&(f.qyWeChatVo=this.state.qyWeChatVo),Y==="WE_COM"&&N==="0"&&(f.qyWeChatVo=JSON.stringify({userList:u.user,departmentList:u.dept})),this.props.formik.setFieldValue("employeeRange",f)},this.handleOk=s=>{this.setRangeList(s)},this.setRangeList=s=>{var i=s.dept,u=s.group,f=s.post,N=s.user,Y=s.classes,J=s.cluster,se={dept:i,post:f,group:u,user:N,classes:Y,cluster:J};this.setState({rangeList:se,visible:!1}),this.triggerChange({rangeType:this.state.rangeType,rangeList:se})},this.handleImportOk=s=>{var i=this.state.rangeList,u=i.user,f=u===void 0?[]:u,N=[...s,...f],Y=(0,F.uniqBy)(N,"id");this.setState({rangeList:(0,v.Z)((0,v.Z)({},i),{},{user:Y})},()=>{this.triggerChange({rangeType:this.state.rangeType,rangeList:this.state.rangeList}),this.importModalVisibility(!1)})},this.handleImportCancel=()=>{this.importModalVisibility(!1)},this.handleCancel=()=>{this.setOrgModalVisibility(!1)},this.handleDeleteItem=s=>{var i=(0,v.Z)({},this.state.rangeList),u,f;for(var N in i)if(u=i[N].findIndex(J=>J.id===s),u>-1){f=N;break}var Y=[...i[f]];Y.splice(u,1),i[f]=Y,this.setState({rangeList:i}),this.triggerChange({rangeType:this.state.rangeType,rangeList:i})},this.handleSelectWx=()=>{var s=this.props.user,i=this.state.rangeList.user.map(u=>u.unionid||u.user_id||u.userId);(0,w.Sk)({userIds:i}).then(u=>{(0,w.$f)({result:u,user:s}).then(f=>{var N=f.qyWeChatVo,Y=f.rangeList;this.setState({qyWeChatVo:N},()=>{this.handleOk(Y)})})}).catch(()=>{this.handleCancel()})},this.setOrgModalVisibility=function(s){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ne,u=localStorage.getItem("authorityType"),f=n.props.user.loginMode;s&&n.props.qwTicketShow&&f==="WE_COM"&&u==="1"?(n.handleSelectWx(),n.setState({rangeType:2},()=>{i()})):n.setState({visible:s,rangeType:2},()=>{i()})},this.importModalVisibility=function(s){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ne;n.setState({importVisible:s,rangeType:2},()=>{i()})},this.renderRadioGroup=()=>{var s=this.props,i=s.prefixCls,u=s.t,f=s.showSectitle,N=s.secTitle,Y=N===void 0?u("common.assignRange"):N,J=s.secTitleInfoTip,se=J===void 0?"":J;return f?t().createElement("div",{className:"".concat(i,"__radios")},t().createElement("div",{className:"cl-form__sectitle"},Y,se&&t().createElement("span",{className:"cl-form__sectitle__infotip"},se),this.renderRadios())):this.renderRadios()},this.handleVisibleType=s=>{var i=this.state.rangeType,u=s.target.value;this.setState({visibleType:u,rangeType:u==="follow"?0:i||3},()=>{this.triggerChange({rangeType:u==="follow"?0:i||3,rangeList:this.state.rangeList})})},this.renderRadios=()=>{var s=this.props,i=s.mode,u=s.t,f=s.disabledAdd,N=s.themeColor,Y=s.onlyCreateUser,J=s.onlyDept,se=this.props.partLabel,Ce=se===void 0?u("common.deptAndStu"):se,Xe=this.state,ot=Xe.isSubsidy,He=Xe.visibleType,dt=Xe.userManageType,it=Xe.rangeType,Dt=!!(this.state.rangeType&&this.state.rangeType!==2);return f?null:t().createElement("div",{className:"visible-range-setting"},i.includes("follow")&&t().createElement(M.ZP.Group,{name:"visibleType",value:He,onChange:this.handleVisibleType},t().createElement(M.ZP,{value:"follow"},u("course.followClassify")),t().createElement(M.ZP,{value:"define"},u("course.customRange"))),(it>0||i.length===1||!i.includes("follow"))&&t().createElement("div",{className:"custom-range-setting"},t().createElement(M.ZP.Group,{name:"rangeGroup",value:it,disabled:this.props.disabled,onChange:this.handleChange,buttonStyle:"solid"},i.includes("all")&&t().createElement(M.ZP.Button,{value:1,disabled:dt!=="all"},u("common.allCompany")),i.includes("under")&&t().createElement(M.ZP.Button,{value:4},t().createElement(p.Z,null,u("setting.jurisdictionAndSubordinate"),t().createElement(c.Z,{title:u("setting.underTip")},t().createElement("span",null,t().createElement(Q.Z,null))))),i.includes("private")&&t().createElement(M.ZP.Button,{value:3},u(Y?"common.onlyCreate":"common.onlySelf")),i.includes("part")&&i.length>1&&t().createElement(M.ZP.Button,{value:2},Ce),!ot&&i.includes("part")?t().createElement(p.Z,{className:"range-setting-import"},!J&&t().createElement(y.Z,{className:"qa-assign-employee-selector",style:Dt?{}:{color:N,border:"1px solid ".concat(N)},icon:t().createElement(G.Z,null),disabled:Dt,onClick:()=>this.importModalVisibility(!0)},u("component.importPerson")),t().createElement(y.Z,{className:"qa-assign-employee-selector",style:Dt?{}:{color:N,border:"1px solid ".concat(N)},icon:t().createElement(V.Z,null),disabled:Dt,onClick:()=>this.setOrgModalVisibility(!0)},u("common.select"))):"",ot&&it===2?t().createElement(y.Z,{icon:this.renderIcon(),onClick:this.updateSubsidyStudent,style:{marginLeft:"8px",color:N,border:"1px solid ".concat(N)}},u("gzSubsidy.updateStudent"),t().createElement(c.Z,{placement:"top",title:this.renderText},t().createElement("span",{style:{display:"inline-block",marginLeft:"3px"}},t().createElement(S.Z,{iconClass:"icon-f-tipe"})))):"")))},this.renderText=()=>this.props.t("gzSubsidy.updateDesc"),this.renderIcon=()=>{var s=this.props.themeColor;return t().createElement(S.Z,{iconClass:"iconf-switch",size:"12px",color:s})},this.renderGallery=()=>{var s=this.props.prefixCls,i=this.state.rangeType;return i!==2?null:t().createElement("div",{className:"".concat(s,"__gallery")},this.renderGropuGallery(),this.renderUserGallery())},this.renderGropuGallery=()=>{var s=this.props,i=s.prefixCls,u=s.t,f=this.state.rangeList,N=f.dept,Y=f.group,J=f.post,se=f.cluster,Ce=se===void 0?[]:se,Xe=f.classes,ot=Xe===void 0?[]:Xe,He=[...N,...Y,...J,...ot,...Ce];return He.length?t().createElement("div",{className:"".concat(i,"__gallery__row cl-clearfix")},t().createElement("span",{className:"".concat(i,"__gallery__row__title colon")},u("common.selectedGroups")),t().createElement("div",{className:"".concat(i,"__gallery__row__container cl-clearfix")},He.map(dt=>this.renderGalleryItem(dt,"dept")))):null},this.renderUserGallery=()=>{var s=this.props,i=s.prefixCls,u=s.t,f=this.state.rangeList.user,N=[...f];return N.length?t().createElement("div",{className:"".concat(i,"__gallery__row cl-clearfix")},t().createElement("span",{className:"".concat(i,"__gallery__row__title colon")},u("common.selectedUsers")),t().createElement("div",{className:"".concat(i,"__gallery__row__container cl-clearfix")},N.map(Y=>this.renderGalleryItem(Y,"user")))):null},this.renderGalleryItem=(s,i)=>{var u=this.props,f=u.prefixCls,N=u.disabled,Y="".concat(f,"__gallery__row__item"),J=this.state.isSubsidy,se={user:"userName",dept:"departmentName"}[i]||"",Ce={user:s.unionid||s.user_id,dept:s.id}[i]||s.id;return t().createElement("span",{className:Y,key:s.id},t().createElement(L.Z,{dataType:se,value:Ce,name:s.name,type:s.source_type||s.sourceType}),N||J?null:t().createElement("span",{className:"".concat(Y,"__span"),onClick:()=>this.handleDeleteItem(s.id)},t().createElement(S.Z,{iconClass:"icon-guanbi",size:"14px"})))},this.updateSubsidyStudent=(0,K.Z)(d().mark(function s(){var i,u,f,N,Y,J,se,Ce,Xe;return d().wrap(function(He){for(;;)switch(He.prev=He.next){case 0:return i=n.props,u=i.projectId,f=i.onCancel,N=i.t,Y=$.ZP.subsidyGz.updateSubsidyStudent(u),J=$.ZP.StudyProjectList.setViewScope(u),He.next=5,W.WY.get({url:Y});case 5:return se=He.sent,Ce={is_all:2,user_ids:se.data.userIds},He.next=9,W.WY.post({url:J,data:Ce});case 9:Xe=He.sent,Xe.data.update?(f(),D.default.success(N("gzSubsidy.updateStudentSuccess"))):D.default.success(N("gzSubsidy.updateStudentFail"));case 11:case"end":return He.stop()}},s)})),this.state={rangeType:r.defaultFieldList.rangeType,rangeList:r.defaultFieldList.rangeList||{},qyWeChatVo:"",visible:!1,isSubsidy:!1,visibleType:r.defaultFieldList.rangeType===0?"follow":"define",userManageType:"all",importVisible:!1}}componentDidMount(){var r=this.props.isSubsidyCourse,n=localStorage.isSubsidyEnterprise==="true"&&r;this.setState({isSubsidy:n}),this.getUserManageRange()}renderTransfer(){var r=N=>{this.props.formik.setFieldValue("open_transfer_student",N.target.checked)},n=this.props,s=n.prefixCls,i=n.t,u=n.formik.values.open_transfer_student,f=u===void 0?!1:u;return t().createElement("div",{className:"".concat(s,"__transfer")},t().createElement(T.Z,{onChange:r,checked:f},i("course.transferJoin")),t().createElement(c.Z,{title:i("course.transferJoinTooltip")},t().createElement(z.Z,null)))}render(){var r=this.props,n=r.prefixCls,s=r.orgProps,i=r.qwTicketShow,u=r.onlyDept,f=u===void 0?!1:u,N=r.onlyPost,Y=N===void 0?!1:N,J=r.onlyChooseDept,se=J===void 0?!1:J,Ce=r.transferVisible,Xe=Ce===void 0?!1:Ce,ot=localStorage.getItem("authorityType"),He=this.state,dt=He.rangeList,it=He.visible,Dt=He.importVisible,Qe=navigator.userAgent.toLowerCase().indexOf("wxwork")>-1,ft=se?["dept"]:f&&Y?["dept","post"]:["dept","group","post"];return s.useGroups&&ft.push("cluster"),s.useClass&&ft.push("class"),t().createElement("section",{className:"".concat(n)},t().createElement("div",{className:"".concat(n,"-box")},this.renderRadioGroup(),this.renderGallery(),t().createElement(x.Z,(0,b.Z)({},s,{showUserCount:this.props.showUserCount,visible:it&&(!Qe||ot!=="1"||!i),initData:dt,displayType:ft,onlyDept:f,onlyPost:Y,onOk:this.handleOk,onCancel:this.handleCancel})),t().createElement(U.Z,{visible:Dt,onOk:this.handleImportOk,onCancel:this.handleImportCancel})),Xe&&t().createElement("div",{className:"".concat(n,"-transfer")},this.renderTransfer()))}}ie.defaultProps={prefixCls:"cl-employee-selector",showSectitle:!0,mode:["all","part"],orgProps:{},resourceViewRange:!1};var Ne=(0,h.$j)(k)((0,m.$j)((0,E.Z)()(ie))),ue=e(85372),_e=e(61066),Ze=Z=>{var r=Z.advancedSetting,n=Z.subsidyCourseInfo,s=Z.user;return{user:s,themeColor:r.themeColor,isSubsidyCourse:n.isSubsidyCourse,appType:s.appType}},j=()=>{};class R extends t().Component{constructor(r){var n;super(r);n=this,this.getUserManageRange=()=>{var s=$.ZP.Role.getUserManageRange();W.WY.get({url:s}).then(function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=i.data,f=u===void 0?{}:u,N=f.range_type;n.setState({userManageType:N})})},this.handleChange=s=>{var i=this.state.isSubsidy;if(!i){var u=s.target.value;this.setState({rangeType:u}),this.triggerChange({rangeType:u,rangeList:this.state.rangeList})}},this.triggerChange=s=>{var i=s.rangeType,u=s.rangeList,f={rangeType:i,rangeList:u},N=localStorage.getItem("authorityType"),Y=this.props.user.loginMode;Y==="WE_COM"&&N==="1"&&(f.qyWeChatVo=this.state.qyWeChatVo),Y==="WE_COM"&&N==="0"&&(f.qyWeChatVo=JSON.stringify({userList:u.users,departmentList:u.departments})),this.props.formik.setFieldValue("employeeRange",f)},this.handleOk=s=>{this.setRangeList(s)},this.setRangeList=s=>{var i=s.departments,u=s.groups,f=s.posts,N=s.users,Y=s.clusters,J=s.roles,se={departments:i,posts:f,groups:u,users:N,clusters:Y,roles:J};this.setState({rangeList:se,visible:!1}),this.triggerChange({rangeType:this.state.rangeType,rangeList:se})},this.handleCancel=()=>{this.setOrgModalVisibility(!1)},this.remove=(s,i)=>{var u=this.state.rangeList;this.setRangeList((0,v.Z)((0,v.Z)({},u),{},{[i]:s}))},this.handleSelectWx=()=>{var s=this.props.user.unionid,i=this.state.rangeList.user.map(u=>u.unionid);window.wx.invoke("selectPrivilegedContact",{fromDepartmentId:0,mode:"multi",selectedContextContact:0,selectedOpenUserIds:i||[],selectedTickets:[]},u=>{if(u.err_msg==="selectPrivilegedContact:ok"){typeof u.result=="string"&&(u.result=JSON.parse(u.result));var f=u.result,N=f.userList,Y=f.selectedUserCount,J=N||[];N?this.setState({isShowType:!1}):Y?(J.push({id:s,unionid:s,openUserId:s}),this.setState({isShowType:!0}),u.result.userList=[{id:s,unionid:s,openUserId:s}],u.result.selectedUserCount+=1):this.setState({isShowType:!1});var se={departments:[],posts:[],groups:[],users:J.map(Ce=>(0,v.Z)((0,v.Z)({},Ce),{},{unionid:Ce.openUserId,id:Ce.openUserId,source_type:"wx_sync"})),clusters:[],roles:[]};this.setState({qyWeChatVo:JSON.stringify(u.result)},()=>{this.handleOk(se)})}else u.errMsg==="selectPrivilegedContact:cancel"&&this.handleCancel()})},this.setOrgModalVisibility=function(s){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:j,u=localStorage.getItem("authorityType"),f=n.props.user.loginMode,N=navigator.userAgent.toLowerCase().indexOf("wxwork")>-1;s&&N&&n.props.qwTicketShow&&f==="WE_COM"&&u==="1"&&n.handleSelectWx(),n.setState({visible:s,rangeType:2},()=>{i()})},this.importModalVisibility=function(s){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:j;n.setState({importVisible:s,rangeType:2},()=>{i()})},this.renderRadioGroup=()=>{var s=this.props,i=s.prefixCls,u=s.t,f=s.showSectitle,N=s.secTitle,Y=N===void 0?u("common.assignRange"):N,J=s.secTitleInfoTip,se=J===void 0?"":J;return f?t().createElement("div",{className:"".concat(i,"__radios")},t().createElement("div",{className:"cl-form__sectitle"},Y,se&&t().createElement("span",{className:"cl-form__sectitle__infotip"},se),this.renderRadios())):this.renderRadios()},this.handleVisibleType=s=>{var i=this.state.rangeType,u=s.target.value;this.setState({visibleType:u,rangeType:u==="follow"?0:i||3},()=>{this.triggerChange({rangeType:u==="follow"?0:i||3,rangeList:this.state.rangeList})})},this.renderRadios=()=>{var s=this.props,i=s.mode,u=s.t,f=s.disabledAdd,N=s.themeColor,Y=s.onlyCreateUser,J=this.props.partLabel,se=J===void 0?u("common.deptAndStu"):J,Ce=this.state,Xe=Ce.isSubsidy,ot=Ce.visibleType,He=Ce.userManageType,dt=Ce.rangeType,it=!!(this.state.rangeType&&this.state.rangeType!==2);return f?null:t().createElement("div",{className:"visible-range-setting"},i.includes("follow")&&t().createElement(M.ZP.Group,{name:"visibleType",value:ot,onChange:this.handleVisibleType},t().createElement(M.ZP,{value:"follow"},u("course.followClassify")),t().createElement(M.ZP,{value:"define"},u("course.customRange"))),(dt>0||i.length===1||!i.includes("follow"))&&t().createElement("div",{className:"custom-range-setting"},t().createElement(M.ZP.Group,{name:"rangeGroup",value:dt,disabled:this.props.disabled,onChange:this.handleChange},i.includes("all")&&t().createElement(M.ZP,{value:1,disabled:He!=="all"},u("common.allCompany")),i.includes("under")&&t().createElement(M.ZP,{value:4},t().createElement(p.Z,null,u("setting.jurisdictionAndSubordinate"),t().createElement(c.Z,{title:u("setting.underTip")},t().createElement("span",null,t().createElement(Q.Z,null))))),i.includes("private")&&t().createElement(M.ZP,{value:3},u(Y?"common.onlyCreate":"common.onlySelf")),i.includes("part")&&i.length>1&&t().createElement(M.ZP,{value:2},se),!Xe&&i.includes("part")?t().createElement(p.Z,null,t().createElement(y.Z,{className:"qa-assign-employee-selector",style:it?{}:{color:N,border:"1px solid ".concat(N)},icon:t().createElement(V.Z,null),disabled:it,onClick:()=>this.setOrgModalVisibility(!0)},u("common.select"))):"",Xe&&dt===2?t().createElement(y.Z,{icon:this.renderIcon(),onClick:this.updateSubsidyStudent,style:{marginLeft:"8px",color:N,border:"1px solid ".concat(N)}},u("gzSubsidy.updateStudent"),t().createElement(c.Z,{placement:"top",title:this.renderText},t().createElement("span",{style:{display:"inline-block",marginLeft:"3px"}},t().createElement(S.Z,{iconClass:"icon-f-tipe"})))):"")))},this.renderText=()=>this.props.t("gzSubsidy.updateDesc"),this.renderIcon=()=>{var s=this.props.themeColor;return t().createElement(S.Z,{iconClass:"iconf-switch",size:"12px",color:s})},this.updateSubsidyStudent=(0,K.Z)(d().mark(function s(){var i,u,f,N,Y,J,se,Ce,Xe;return d().wrap(function(He){for(;;)switch(He.prev=He.next){case 0:return i=n.props,u=i.projectId,f=i.onCancel,N=i.t,Y=$.ZP.subsidyGz.updateSubsidyStudent(u),J=$.ZP.StudyProjectList.setViewScope(u),He.next=5,W.WY.get({url:Y});case 5:return se=He.sent,Ce={is_all:2,user_ids:se.data.userIds},He.next=9,W.WY.post({url:J,data:Ce});case 9:Xe=He.sent,Xe.data.update?(f(),D.default.success(N("gzSubsidy.updateStudentSuccess"))):D.default.success(N("gzSubsidy.updateStudentFail"));case 11:case"end":return He.stop()}},s)})),this.state={isShowType:!1,rangeType:r.defaultFieldList.rangeType,rangeList:r.defaultFieldList.rangeList||{},qyWeChatVo:"",visible:!1,isSubsidy:!1,visibleType:r.defaultFieldList.rangeType===0?"follow":"define",userManageType:"all"}}componentDidMount(){var r=this.props.isSubsidyCourse,n=localStorage.isSubsidyEnterprise==="true"&&r;this.setState({isSubsidy:n}),this.getUserManageRange()}renderTransfer(){var r=N=>{this.props.formik.setFieldValue("open_transfer_student",N.target.checked)},n=this.props,s=n.prefixCls,i=n.t,u=n.formik.values.open_transfer_student,f=u===void 0?!1:u;return t().createElement("div",{className:"".concat(s,"__transfer")},t().createElement(T.Z,{onChange:r,checked:f},i("course.transferJoin")),t().createElement(c.Z,{title:i("course.transferJoinTooltip")},t().createElement(z.Z,null)))}render(){var r=this.props,n=r.t,s=r.prefixCls,i=r.orgProps,u=r.qwTicketShow,f=r.onlyDept,N=f===void 0?!1:f,Y=r.onlyPost,J=Y===void 0?!1:Y,se=r.onlyChooseDept,Ce=se===void 0?!1:se,Xe=r.transferVisible,ot=Xe===void 0?!1:Xe,He=r.title,dt=r.okText,it=localStorage.getItem("authorityType"),Dt=this.state,Qe=Dt.rangeList,ft=Dt.visible,kt=Dt.rangeType,xt=navigator.userAgent.toLowerCase().indexOf("wxwork")>-1,Rt=Ce?["department"]:N&&J?["department","post"]:["department","post","group"];i.useGroups&&Rt.push("cluster");var qt=Qe.users,Pa=Qe.departments,sa=Qe.groups,ba=Qe.posts,oa=Qe.clusters,Yt=oa===void 0?[]:oa,Ta=Qe.roles,Ya=Ta===void 0?[]:Ta;return t().createElement("section",{className:"".concat(s)},t().createElement("div",{className:"".concat(s,"-box")},this.renderRadioGroup(),kt===2?t().createElement(_e.Z,{store:{users:qt,departments:Pa,groups:sa,posts:ba,clusters:Yt,roles:Ya,setGroups:va=>{this.remove(va,"groups")},setUsers:va=>{this.remove(va,"users")},setDepartments:va=>{this.remove(va,"departments")},setPosts:va=>{this.remove(va,"posts")}}}):null,t().createElement(ue.Z,(0,b.Z)({},i,{value:Qe,onOk:this.handleOk,onCancel:this.handleCancel,tabs:["user","scope"],scopeList:Rt,chooseUserList:N?["immediate"]:["immediate","import"],visible:ft&&(!xt||it!=="1"||!u),title:He,okText:dt}))),ot&&t().createElement("div",{className:"".concat(s,"-transfer")},this.renderTransfer()))}}R.defaultProps={prefixCls:"cl-employee-selector",showSectitle:!0,mode:["all","part"],orgProps:{},resourceViewRange:!1};var le=(0,h.$j)(Ze)((0,m.$j)((0,E.Z)()(R))),H=e(77883),X=e(21888),ce=e(81211),Te=e(14965),Le=e(11448),he=e(78138),Ee=e.n(he),ve=e(6793),be=e(38642),Ve=Le.Z.RangePicker;class Ae extends t().Component{constructor(){super(...arguments);this.state={whiteList:{showDuringDate:(0,be.UI)("TASKFORM_SHOWDURINGDATE")},endDuringDate:"",timeType:"week",isOpen:!1},this.onValueChange=r=>{var n;r!=null&&(n=r.target)!==null&&n!==void 0&&n.value&&this.setState({timeType:r.target.value})},this.onOpenChange=r=>{var n=this.state.whiteList;!r&&n.showDuringDate&&this.setState({endDuringDate:"",timeType:"week"}),this.setState({isOpen:r})},this.handleChangeInputNumber=r=>{var n=r,s=this.props.t,i=this.state.isOpen;i?((n<1||n>999||parseInt(n)<parseFloat(n))&&(n=0,D.default.warning(s("exam.validation.checkDuringDate"))),this.setState({endDuringDate:n})):this.setState({endDuringDate:"",timeType:"week"})},this.handleRangePickerOk=r=>{var n=this.state,s=n.timeType,i=n.endDuringDate;i&&r&&r[0]&&(r[1]=s==="week"?Ee()(r[0]).add(this.state.endDuringDate,"weeks"):Ee()(r[0]).add(this.state.endDuringDate,"days"),this.handleChange(r))},this.handleInputFocus=r=>{r.target.focus()},this.handleChange=r=>{if(!r||!r.length){this.props.formik.setFieldValue(this.props.fieldName||"dateRange",{startTime:null,endTime:null}),this.props.onAfterChange({startTime:null,endTime:null});return}var n=this.props.startEndFormat,s=this.props,i=s.startTimeFormatter,u=i===void 0?n?n.start:$.XE.INITIAL_DATE_FMT.PARAMS:i,f=s.endTimeFormatter,N=f===void 0?n?n.end:$.XE.INITIAL_DATE_FMT.PARAMS:f,Y=r[0].format(u),J=r[1].format(N);this.props.formik.setFieldValue(this.props.fieldName||"dateRange",{startTime:Y,endTime:J}),this.props.onAfterChange({startTime:Y,endTime:J})},this.handleChangeEnd=r=>{var n=this.props.defaultFieldList,s=n.startTime;s=Ee()(s,$.XE.INITIAL_DATE_FMT.PARAMS);var i=this.props,u=i.startTimeFormatter,f=u===void 0?$.XE.INITIAL_DATE_FMT.PARAMS:u,N=i.endTimeFormatter,Y=N===void 0?$.XE.INITIAL_DATE_FMT.PARAMS:N;r?this.props.formik.setFieldValue(this.props.fieldName||"dateRange",{startTime:s.format(f),endTime:r.format(Y)}):this.props.formik.setFieldValue(this.props.fieldName||"dateRange",{startTime:s.format(f),endTime:null})},this.handleMomentCompletionSecond=(r,n)=>Ee()(r).format("YYYY-MM-DD HH:mm:".concat(n==="start"?"00":"59"))}render(){var r=this.props,n=r.t,s=r.defaultFieldList,i=r.onlyChangeEndTime,u=r.customerShowTime,f=u===void 0?!1:u,N=r.showTime,Y=N===void 0?!0:N,J=(0,ce.Z)(r,["t","defaultFieldList","onlyChangeEndTime","customerShowTime","showTime"]),se=s.startTime,Ce=s.endTime,Xe=Ee()(se,$.XE.INITIAL_DATE_FMT.PARAMS),ot=Ee()(Ce,$.XE.INITIAL_DATE_FMT.PARAMS),He=se&&Ce?[Xe,ot]:[],dt=this.state,it=dt.whiteList,Dt=dt.endDuringDate,Qe=dt.timeType;return i?t().createElement("div",null,t().createElement(Le.Z,{value:Xe,showTime:{format:$.XE.INITIAL_TIME_FMT.VIEW},format:$.XE.INITIAL_DATE_FMT.VIEW,disabled:!0}),t().createElement("span",{style:{margin:"0 10px"}}," ~ "),t().createElement(Le.Z,{value:Ce?ot:void 0,showTime:{format:$.XE.INITIAL_TIME_FMT.VIEW},format:$.XE.INITIAL_DATE_FMT.VIEW,onChange:this.handleChangeEnd,disabledDate:ft=>ft<Xe.subtract("day",0)})):t().createElement(Ve,(0,b.Z)({},J,{showTime:f?Y:{format:$.XE.INITIAL_TIME_FMT.VIEW,defaultValue:[Ee()("00:00:00","HH:mm:ss"),Ee()("23:59:59","HH:mm:ss")]},format:$.XE.INITIAL_DATE_FMT.VIEW,ranges:it.showDuringDate?{["".concat(n("component.recentMonth"))]:[Ee()(),Ee()().add(30,"days")],["".concat(n("component.recentThreeMonth"))]:[Ee()(),Ee()().add(3,"months")]}:{["".concat(n("component.recentWeek"))]:[Ee()(),Ee()().add(7,"days")],["".concat(n("component.recentMonth"))]:[Ee()(),Ee()().add(30,"days")],["".concat(n("component.recentThreeMonth"))]:[Ee()(),Ee()().add(3,"months")]},dropdownClassName:"cl-date-range-picker",renderExtraFooter:()=>it.showDuringDate&&t().createElement(t().Fragment,null,t().createElement("div",{className:"time-type-date"},t().createElement(X.Z,{className:"time-type-date-input",size:"small",value:Dt,min:1,max:999,onClick:this.handleInputFocus,onChange:this.handleChangeInputNumber}),t().createElement(M.ZP.Group,{value:Qe,onChange:this.onValueChange,buttonStyle:"solid",className:"time-type-radio"},t().createElement(M.ZP.Button,{value:An.E.WEEK},n("eTouch.week")),t().createElement(M.ZP.Button,{value:An.E.DAY},n("eTouch.day"))))),disabledDate:ve.Kq,value:He,onOpenChange:this.onOpenChange,onChange:this.handleChange,onOk:this.handleRangePickerOk}))}}Ae.defaultProps={defaultFieldList:{},onlyChangeEndTime:!1,fieldName:"dateRange",rest:{},onAfterChange:()=>{}};var at=(0,m.$j)((0,E.Z)()(Ae)),et=Le.Z.RangePicker;class ut extends t().Component{constructor(r){super(r);this.handleChange=n=>{if(!n||!n.length){this.props.formik.setFieldValue("dateRange",{startTime:null,endTime:null}),this.props.onAfterChange({startTime:null,endTime:null});return}var s=this.props,i=s.startTimeFormatter,u=i===void 0?$.XE.INITIAL_DATE_FMT.PARAMS:i,f=s.endTimeFormatter,N=f===void 0?$.XE.INITIAL_DATE_FMT.PARAMS:f,Y=s.setFieldKey,J=n[0].format(u),se=n[1].format(N);if(this.props.formik.setFieldValue("dateRange",{startTime:J,endTime:se}),this.props.onAfterChange({startTime:J,endTime:se}),Y&&Y==="course_duration"){var Ce=this.handleMomentCompletionSecond(se,"start")-this.handleMomentCompletionSecond(J,"start");Ce=Ee().duration(Ce).asMinutes(),this.props.formik.setFieldValue(this.props.setFieldKey,Ce)}},this.handleMomentCompletionSecond=(n,s)=>Ee()(Ee()(n).format("YYYY-MM-DD HH:mm:".concat(s==="start"?"00":"59"))).valueOf(),this.handleChangeEnd=n=>{var s=this.props.defaultFieldList,i=s.startTime;i=Ee()(i,$.XE.INITIAL_DATE_FMT.PARAMS);var u=this.props,f=u.startTimeFormatter,N=f===void 0?$.XE.INITIAL_DATE_FMT.PARAMS:f,Y=u.endTimeFormatter,J=Y===void 0?$.XE.INITIAL_DATE_FMT.PARAMS:Y;n?this.props.formik.setFieldValue("dateRange",{startTime:i.format(N),endTime:n.format(J)}):this.props.formik.setFieldValue("dateRange",{startTime:i.format(N),endTime:null})},this.disabledDate=n=>{if(this.props.dateRangeLimit&&this.props.dateRangeLimit.startTime&&this.props.dateRangeLimit.endTime)return n>(0,ve.jZ)(this.props.dateRangeLimit.startTime)&&n<(0,ve.jZ)(this.props.dateRangeLimit.endTime);if(this.props.dateRange&&this.props.dateRange.startTime&&this.props.dateRange.endTime)return n<(0,ve.jZ)(this.props.dateRange.startTime.slice(0,10))||n>(0,ve.jZ)("".concat(this.props.dateRange.endTime.slice(0,10)," 23:59:59"))},this.datePickerDisable=n=>{if(this.props.dateRange&&this.props.dateRange.endTime)return n&&n>(0,ve.jZ)(this.props.dateRange.endTime)},this.handleChangeInputNumber=n=>{var s=n,i=this.props.t;(s<1||s>999||parseInt(s)<parseFloat(s))&&(s=0,D.default.warning(i("exam.validation.checkDuringDate"))),this.setState({endDuringDate:s})},this.handleRangePickerOk=n=>{this.state.endDuringDate&&n[0]&&(n[1]=Ee()(n[0]).add(this.state.endDuringDate,"days"),this.handleChange(n))},this.handleInputFocus=n=>{n.target.focus()},this.state={endDuringDate:""}}render(){var r=this.props,n=r.t,s=r.defaultFieldList,i=r.onlyChangeEndTime,u=r.showDuringDate,f=r.defaultValue,N=r.selAllDate,Y=(0,ce.Z)(r,["t","defaultFieldList","onlyChangeEndTime","showDuringDate","defaultValue","selAllDate"]),J=s.startTime,se=s.endTime,Ce=this.state.endDuringDate,Xe,ot=null;J&&(typeof J=="number"?Xe=Ee()(J):Xe=Ee()(J,[$.XE.INITIAL_DATE_FMT.PARAMS,"x"])),se&&(typeof se=="number"?ot=Ee()(se):ot=Ee()(se,[$.XE.INITIAL_DATE_FMT.PARAMS,"x"]));var He=J&&se?[Xe,ot]:[];return i?t().createElement("div",null,t().createElement(Le.Z,{value:Xe,showTime:{format:$.XE.INITIAL_TIME_FMT.VIEW},format:$.XE.INITIAL_DATE_FMT.VIEW,disabled:!0}),t().createElement("span",{style:{margin:"0 10px"}}," ~ "),t().createElement(Le.Z,{value:se?ot:void 0,showTime:{format:$.XE.INITIAL_TIME_FMT.VIEW},format:$.XE.INITIAL_DATE_FMT.VIEW,onChange:this.handleChangeEnd,disabledDate:N===!0?!1:dt=>dt<Xe.subtract("day",0)})):t().createElement(et,(0,b.Z)({},Y,{showTime:{format:$.XE.INITIAL_TIME_FMT.VIEW,defaultValue:f||[Ee()("00:00:00","HH:mm:ss"),Ee()("23:59:59","HH:mm:ss")]},format:$.XE.INITIAL_DATE_FMT.VIEW,ranges:{["".concat(n("component.recentWeek"))]:[Ee()(),Ee()().add(7,"days")],["".concat(n("component.recentMonth"))]:[Ee()(),Ee()().add(30,"days")],["".concat(n("component.recentThreeMonth"))]:[Ee()(),Ee()().add(3,"months")]},renderExtraFooter:()=>u&&t().createElement("div",{className:"ant-picker-dropdown-range-date"},t().createElement(X.Z,{className:"ant-picker-dropdown-range-date-input",size:"small",value:Ce,min:0,max:999,onClick:this.handleInputFocus,onChange:this.handleChangeInputNumber})," ",n("common.daysLater")),disabledDate:N===!0?!1:ve.Kq,value:He,onChange:this.handleChange,onOk:this.handleRangePickerOk}))}}ut.defaultProps={onAfterChange:()=>{}};var q=(0,m.$j)((0,E.Z)()(ut)),Oe=e(7653);class Je extends t().Component{constructor(r){super(r);this.userChange=(n,s)=>{this.setState({userList:n}),s?this.props.formik.setFieldValue("supervisor",(0,v.Z)((0,v.Z)({},this.props.defaultFieldList),{},{supervisorUserList:n,qyWeChatVo:s})):this.props.formik.setFieldValue("supervisor",(0,v.Z)((0,v.Z)({},this.props.defaultFieldList),{},{supervisorUserList:n}))},this.handleCheck=n=>{var s=n.target.checked;this.props.formik.setFieldValue("supervisor",(0,v.Z)((0,v.Z)({},this.props.defaultFieldList),{},{isChecked:s}))},this.handleCheckAuthScope=n=>{var s=n.target.checked;this.props.formik.setFieldValue("supervisor",(0,v.Z)((0,v.Z)({},this.props.defaultFieldList),{},{authScopeIsChecked:s}))},this.state={userList:[]}}render(){var r=this.state.userList,n=this.props,s=n.defaultFieldList,i=n.disabled,u=i===void 0?!1:i,f=n.createUserId,N=f===void 0?"":f,Y=n.qwTicketShow,J=n.t,se=s.visibleAuthScope,Ce=se===void 0?!1:se,Xe=s.authScopeIsChecked,ot=Xe===void 0?!1:Xe,He=s.hasMarking,dt=He===void 0?!0:He;return t().createElement("div",{className:"add-supervision"},t().createElement("div",{className:"add-supervision-header"},t().createElement("h4",{className:"add-supervision-header-title"},J("formItem.supervisor"),"(",r.length,")",t().createElement("span",{className:"add-supervision-header-subtitle"},J("formItem.defaultSupervisor")))),t().createElement("div",{className:"add-supervision-list"},t().createElement(Oe.Z,{onChange:this.userChange,createUserId:N,defaultChecked:s.supervisorUserList,disabled:u,qwTicketShow:Y,orgProps:{title:J("formItem.addSupervisor")}})),t().createElement("div",{className:"add-supervision-footer"},dt?t().createElement(T.Z,{onChange:this.handleCheck,checked:s.isChecked,disabled:u},J("formItem.withSupervisor")):null,Ce&&t().createElement(T.Z,{onChange:this.handleCheckAuthScope,checked:ot,disabled:u},J("formItem.supervisorAuthScope"))))}}var je=(0,m.$j)((0,E.Z)()(Je)),Be=e(33565),St=e(13254),Lt=e(14277),Wt=e(59250),pa=e(13013),Xt=e(30887),Et=e(99210),Fe=e(54029),Pe=e(62529),Ie=e(9715),$e=e(86585),te=e(71194),ae=e(57016),Re=e(47673),de=e(4107),we=e(18106),rt=e(88108),mt=e(29164),Zt=e(29208),bt=e.n(Zt),Ft=e(52506);class Ut extends t().Component{constructor(r){super(r);this.handleCheckOrder=(n,s)=>{var i=n.target.checked;s.inOrder=i,this.props.onStateChange()},this.state={}}render(){var r=this.props,n=r.isPreview,s=r.pane,i=r.t;return t().createElement("div",{className:"stage-task-tab-bottom"},t().createElement("div",{className:"stage-task-tab-bottom-label",style:{lineHeight:(0,ve.me)()==="en_us"?"20px":"45px"}},"".concat(i("learning.learningAddSecChallengeTitleStage"),":")),t().createElement("div",{className:"tab-bottom-item"},t().createElement(T.Z,{className:"stage-task-tab-bottom-checkbox",checked:s.inOrder,disabled:n,onChange:u=>this.handleCheckOrder(u,s)},i("component.arcadeMode")),t().createElement("span",{className:"stage-task-tab-bottom-tip"},i("component.arcadeModeTip"))))}}var ca=(0,E.Z)()(Ut);class Qt extends t().Component{constructor(){super(...arguments);this.handleCheckOrder=(r,n,s)=>{var i=r.target.checked,u=this.props,f=u.operationCount,N=u.examCount;if(s==="progressCheck")n[s]=i,this.handleInputOrder(n.progress?n.progress:100,n,"progress");else if(s==="jobEvaluationCheck")n[s]=i?"true":"false";else{n[s]=i;var Y=s==="examCheck"?"examNum":"practiceNum",J=s==="examCheck"?N:f;this.handleInputOrder(n[Y]?n[Y]:J,n,Y)}this.props.onStateChange()},this.handleInputOrder=(r,n,s)=>{n[s]=r,this.props.onStateChange()}}render(){var r=this.props,n=r.isPreview,s=r.itemVal,i=r.t,u=r.jobEvaluationCount,f=r.operationCount,N=r.courseCount,Y=r.examCount,J=r.isEvaluation;return t().createElement("div",{className:"stage-task-tab-bottom"},t().createElement("div",{className:"stage-task-tab-bottom-label",style:{lineHeight:(0,ve.me)()==="en_us"?"15px":"45px"}},"".concat(i("learning.learningAddSecPassTitleStage"),":")),t().createElement("div",{className:"tab-bottom-item"},t().createElement(T.Z,{disabled:N<1||n,style:{width:(0,ve.me)()==="en_us"?"290px":"180px"},className:"tab-bottom-item-label",checked:s.progressCheck,onChange:se=>this.handleCheckOrder(se,s,"progressCheck")},i("learning.learningAddProgressRequire2")),t().createElement(X.Z,{style:{"border-color":"#e8e8e8"},value:s.progress?s.progress:100,disabled:!s.progressCheck||n,onChange:se=>this.handleInputOrder(se,s,"progress"),className:"tab-bottom-number",min:1,max:100,precision:0}),t().createElement("span",{style:{position:"relative",left:"-20px"}}," %")),t().createElement("div",{className:"tab-bottom-item"},t().createElement(T.Z,{className:"tab-bottom-item-label",style:{width:(0,ve.me)()==="en_us"?"290px":"140px"},disabled:Y===0||n,checked:s.examCheck,onChange:se=>this.handleCheckOrder(se,s,"examCheck")},i("learning.learningAddPastRequired")),t().createElement(X.Z,{style:{"border-color":"#e8e8e8"},value:s.examNum?s.examNum:Y,disabled:!s.examCheck||n,className:"tab-bottom-number",onChange:se=>this.handleInputOrder(se,s,"examNum"),min:1,max:Y,precision:0})),t().createElement("div",{className:"tab-bottom-item"},t().createElement(T.Z,{className:"tab-bottom-item-label",style:{width:(0,ve.me)()==="en_us"?"290px":"140px"},disabled:f===0||n,checked:f>0&&s.practiceCheck,onChange:se=>this.handleCheckOrder(se,s,"practiceCheck")},i("learning.learningAddOperationRequire11")),t().createElement(X.Z,{style:{"border-color":"#e8e8e8"},value:s.practiceNum?s.practiceNum:f,disabled:!s.practiceCheck||n,className:"tab-bottom-number",onChange:se=>this.handleInputOrder(se,s,"practiceNum"),min:1,max:f,precision:0})),J&&t().createElement("div",{className:"tab-bottom-item"},t().createElement(T.Z,{className:"tab-bottom-item-label",style:{width:(0,ve.me)()==="en_us"?"290px":"140px"},disabled:u===0||n,checked:s.jobEvaluationCheck==="true"&&u>0,onChange:se=>this.handleCheckOrder(se,s,"jobEvaluationCheck")},i("learning.completeJobEvaluation")),u===0&&t().createElement("span",{className:"qualified-standard-tip"},i("learning.JobEvaluationTip"))))}}Qt.defaultProps={itemVal:{progressCheck:!1,progress:100,examCheck:!1,examNum:0,practiceCheck:!1,practiceNum:0,jobEvaluationCheck:"false"},jobEvaluationCount:0,operationCount:0,isEvaluation:!1,courseCount:0};var Va=(0,E.Z)()(Qt),Ra=e(12968),Ua=e(44208),ja=e(93117);class ua extends t().Component{constructor(r){super(r);this.handleCheckOrder=(n,s,i)=>{var u=n.target.checked;s[i]=u,this.props.onStateChange()},this.handleInputOrder=(n,s,i)=>{s[i]=n,this.props.onStateChange()},this.handleSelectCertificate=()=>{this.setState({visible:!0})},this.handleOk=(n,s)=>{this.setState({visible:!1}),s.certificateId=n[0].id,s.certificateName=n[0].name,s.certificateImage=n[0].previewUrl,this.props.onStateChange()},this.handleCancel=()=>{this.setState({visible:!1})},this.state={visible:!1}}deleteCertificate(){var r=this.props.itemVal;r.certificateId="",r.certificateName="",r.certificateImage="",this.props.onStateChange()}render(){var r=this.props,n=r.isPreview,s=r.itemVal,i=r.t,u=r.formik,f=u.errors,N=u.touched,Y=r.qyShield,J=this.state.visible,se=[{id:s.reward?s.reward.certificateId:"",name:s.reward?s.reward.certificateName:""}];return t().createElement("div",{className:"stage-task-tab-bottom"},t().createElement("div",{className:"stage-task-tab-bottom-label",style:{lineHeight:(0,ve.me)()==="en_us"?"15px":"45px"}},"".concat(i("learning.learningAddSecRewardTitleStage"),":")),t().createElement("div",{className:"tab-bottom-item"},t().createElement(T.Z,{className:"study-reward-checkbox",defaultValue:s.getScore,checked:s.getScoreChecked,disabled:n,onChange:Ce=>this.handleCheckOrder(Ce,s,"getScoreChecked")},i("learning.learningAddRewardPassScored")),t().createElement(X.Z,{style:{"border-color":"#e8e8e8"},value:s.getScore,disabled:!s.getScoreChecked||n,onChange:Ce=>this.handleInputOrder(Ce,s,"getScore"),defaultValue:s.getScore,min:0,max:999,precision:0,className:N.reward&&f.reward&&f.reward.scoreRewardChecked?"status-error":""}),t().createElement("span",{className:"study-reward-tip"},i("learning.learningAddRewardPassScoreStageTip"))),Y==="false"&&t().createElement("div",{className:"tab-bottom-item"},t().createElement(T.Z,{className:"study-reward-checkbox",disabled:n,checked:s.certificateChecked,onChange:Ce=>this.handleCheckOrder(Ce,s,"certificateChecked")},i("learning.learningAddRewardCerted")),t().createElement(y.Z,{type:"link",icon:t().createElement(V.Z,null),disabled:!s.certificateChecked||n,onClick:this.handleSelectCertificate},i("learning.learningAddRewardCertSelect"))),t().createElement(ja.Z,{visible:J,defaultChecked:se,onCancel:this.handleCancel,onOk:Ce=>this.handleOk(Ce,s)}),s.certificateImage&&t().createElement("div",{className:"tab-bottom-item",style:{position:"relative"}},t().createElement(y.Z,{type:"link",className:"item-remove-icon",onClick:()=>this.deleteCertificate()},t().createElement(S.Z,{iconClass:"icon-icon_close",size:"18px"})),t().createElement(Ua.Z,{preview:!1,width:120,src:s.certificateImage})))}}ua.defaultProps={itemVal:{getScoreChecked:!1,getScore:0,certificateChecked:!1,certificateId:"",certificateName:"",certificateImage:""}};var ts=(0,m.$j)((0,E.Z)()(ua)),as=e(76466),Fa=e(84717),Sa=e(41222),us=e(79284),Ds=e(10780),Za=e(74262),ga=e(50361),Ga=e.n(ga),La=e(18329),fa=e(93485),ke=e(3407),Ue=(0,ve.me)(),De=ke.Z[Ue].component.offlineValidation,oe=ke.Z[Ue];function xe(Z){return(0,ve.fy)(Z)?(0,ve.fy)(Z).length>30?ke.Z[Ue].validation.limitedThirty:"":De.title}function me(Z){return(0,ve.fy)(Z)?(0,ve.fy)(Z).length>50?ke.Z[Ue].validation.limitedFifty:"":De.address}var ye={title:Z=>xe(Z),address:Z=>me(Z),range:(Z,r)=>{var n;(!Z||!Z.startTime||!Z.endTime)&&(n=De.selectCourseTime);var s=(0,ve.jZ)(Z.startTime),i=(0,ve.jZ)(Z.endTime);return Z&&r&&(s<(0,ve.jZ)(r.startTime)||i>(0,ve.jZ)(r.endTime))&&(n=oe.learning.validation.learningAddItemDateRangeOnsite),n},courseList:(Z,r)=>{var n="",s=[];return!Z||Z.length===0?n=De.selectCourseTime:Z&&Object.prototype.toString.apply(Z).slice(8,-1)==="Array"&&Z.forEach((i,u)=>{(!i.name||!i.name.trim().length)&&(n=oe.setting.customModuleWarn),i.beginTime===""||i.endTime===""?n="".concat(i.name).concat(De.selectCourseTime):u>0&&(0,ve.jZ)(i.beginTime)<(0,ve.jZ)(Z[u-1].endTime)&&(n="".concat(i.name).concat(De.courseTimeNext)),i.beginTime!=""&&i.endTime!=""&&s.push(i)}),n===""&&s.length>0&&r.startTime&&r.endTime&&((0,ve.jZ)(s[0].beginTime)<(0,ve.jZ)(r.startTime)||(0,ve.jZ)(s[s.length-1].endTime)>(0,ve.jZ)(r.endTime))&&(n=De.courseTimeAndRange),n},signCharge:Z=>{var r;return(!Z||Z.length===0)&&(r=De.signCharge),r},introduction:Z=>{var r;return Z||(r=De.desc),r},attendanceSetValidate:Z=>{var r={};if(!Z||Z&&Z.length===0)r.all=ke.Z[Ue].lineClass.attendanceEmpty;else{var n=(0,fa.Z)(Z.entries()),s;try{for(n.s();!(s=n.n()).done;){var i=s.value,u=(0,Be.Z)(i,2),f=u[0],N=u[1];(!N.sign_in_time||N.sign_in_time&&!N.sign_in_time[0])&&(r[f]=ke.Z[Ue].lineClass.checkInEmpty),N.chooseOutSign&&(!N.sign_out_time||N.sign_out_time&&!N.sign_out_time[0])&&(r[f]=ke.Z[Ue].lineClass.checkOutEmpty)}}catch(Y){n.e(Y)}finally{n.f()}}return Object.keys(r).length?r:""},checkTime:Z=>{var r;return!Z&&Z!=0&&(r=oe.community.pleaseInput),r},evaluateValidate:Z=>{if(Z.is_lecturer_student_evaluate){if(Z.lecturer_student_evaluate_content.evaluate_type==="score"){if(!Z.lecturer_student_evaluate_content.total_score||!Z.lecturer_student_evaluate_content.passing_score)return ke.Z[Ue].lineClass.instructorEvaluationStudents+ke.Z[Ue].lineClass.fullPassMarksEmpty;if(Z.lecturer_student_evaluate_content.passing_score>Z.lecturer_student_evaluate_content.total_score)return ke.Z[Ue].lineClass.instructorEvaluationStudents+ke.Z[Ue].lineClass.greaterThanfullMark}else if(!Z.lecturer_student_evaluate_content.questionnaire_id)return ke.Z[Ue].lineClass.instructorEvaluationStudents+ke.Z[Ue].lineClass.questionEmpty}return Z.is_student_lecturer_evaluate&&Z.student_lecturer_evaluate_content.evaluate_type==="questionnaire"&&!Z.student_lecturer_evaluate_content.questionnaire_id?ke.Z[Ue].lineClass.studentEvaluationLecturer+ke.Z[Ue].lineClass.questionEmpty:Z.is_student_course_evaluate&&Z.student_course_evaluate_content.evaluate_type==="questionnaire"&&!Z.student_course_evaluate_content.questionnaire_id?ke.Z[Ue].lineClass.studentEvaluationCourse+ke.Z[Ue].lineClass.questionEmpty:""},userValidate:Z=>{var r;return Z.user.length===0&&Z.dept.length===0&&(r=ke.Z[Ue].component.pleaseChoose+ke.Z[Ue].tutorial.student),r},assessValidate:Z=>Z.is_open_offline_assessment?!Z.assessment_total_score||!Z.assessment_pass_score?ke.Z[Ue].lineClass.fullPassMarksEmpty:Z.assessment_pass_score>Z.assessment_total_score?ke.Z[Ue].lineClass.greaterThanfullMark:"":"",checkEmployeeRange:Z=>{var r,n=Z.rangeList,s=n.dept,i=n.group,u=n.post,f=n.user,N=n.cluster,Y=N===void 0?[]:N,J=n.classes,se=J===void 0?[]:J,Ce=[...s,...i,...u,...f,...Y,...se];return Ce.length||(r=ke.Z[Ue].component.pleaseChoose+ke.Z[Ue].tutorial.student),r}},We=e(7584),ze=e(2396),qe=e(70075),Tt=e(63273),Ct={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}};class Vt extends t().Component{constructor(r){super(r);this.initRef=n=>{this.formRef=n},this.taskStatusFun=()=>{var n=this.props.initData,s=n.status,i=n.has_lecturer_student_data,u=n.has_student_lecturer_data,f=n.has_student_course_data,N=n.has_lecturer_assess_student_data,Y=[];s==="settled"&&(Y=["dateRange","course_duration","teacher"]),i&&Y.push("student_data"),u&&Y.push("lecturer_data"),f&&Y.push("course_data"),N&&Y.push("assess"),this.setState({fieldList:Y})},this.state={fieldList:[],disabled:!1}}componentDidMount(){this.props.onFormMounted(this.formRef),this.taskStatusFun()}render(){var r=this.state,n=r.disabled,s=r.fieldList,i=this.props,u=i.initData,f=i.t,N=i.isPreview;return t().createElement("div",{className:"offline-train-content-body"},t().createElement("div",{className:"form-page-aside form-page-right"},t().createElement(m.J9,{className:"offline-train-form",ref:this.initRef,initialValues:u,onSubmit:this.props.onSubmit,render:Y=>t().createElement(m.l0,null,t().createElement("div",{className:"offline-train-form-header"},f("exam.basicInformation")),t().createElement("div",{className:"offline-train-form-basic"},t().createElement(m.gN,(0,b.Z)({name:"title",label:f("course.courseDetailName"),required:!0,type:"text",defaultValue:Y.values.title,validate:J=>(0,ze.QK)(J,f("validation.pleaseEnter")+f("course.courseDetailName")),placeholder:f("lineClass.courseDetailNameLimit"),component:We.Z,char:!0,LimitLength:64,isPreview:N||n},Ct)),t().createElement(m.gN,(0,b.Z)({name:"dateRange",className:"offline-input-width",label:f("component.courseTime"),required:!0,displayType:"Custom",validate:J=>ye.range(J,this.props.dateRange),setFieldKey:"course_duration",defaultValue:[Ee()("00:00:00","HH:mm:ss"),Ee()("23:59:00","HH:mm:ss")],selAllDate:!0,component:Rr,disabled:s.indexOf("dateRange")!==-1||n||N,defaultFieldList:Y.values.dateRange,dateRange:this.props.dateRange,dateRangeLimit:Y.values.dateRangeLimit},Ct)),t().createElement(m.gN,(0,b.Z)({name:"course_duration",label:f("lineClass.courseTime"),required:!0,displayType:"Custom",isPreview:n||N,max:999999,disabled:s.indexOf("course_duration")!==-1||n||N,validate:ye.checkTime,component:Tt.Af},Ct)),t().createElement(m.gN,(0,b.Z)({name:"teacher",canCancel:!0,label:f("component.courseLecturer"),displayType:"Custom",validate:ye.teacher,onShowDialog:this.props.onShowDialog,fieldList:s,disabled:s.indexOf("teacher")!==-1||n||N,onHiddenDialog:this.props.onHiddenDialog,component:Tt.Be},Ct)),t().createElement(m.gN,(0,b.Z)({name:"address",label:f("lineClass.classAddress"),type:"text",placeholder:f("lineClass.traningAddress"),component:We.Z,maxLength:64,defaultValue:Y.values.address,isPreview:n||N},Ct)),t().createElement(m.gN,(0,b.Z)({name:"introduction",label:f("learning.trainingPurpose"),displayType:"Custom",type:"text",placeholder:f("lineClass.traningAim"),disabled:n||N,component:qe.Z,char:!0,LimitLength:300},Ct)),t().createElement(m.gN,(0,b.Z)({name:"attachment",label:f("practiceOperation.annex"),component:Tt.Pg,displayType:"Custom",removeable:!(n||N),notLibrary:!0,uploadComponentId:"5340073f-2fab-4bed-816f-fa1afac3eeb8",canSelectCourse:!1,preview:n||N,uploadTips:f("tutorial.resourceTip")},Ct))),t().createElement("div",{className:"offline-train-form-header"},f("common.moreSetting")),t().createElement(m.gN,(0,b.Z)({name:"evaluate",label:f("lineClass.evaluate"),displayType:"Custom",component:Tt.e0,disabled:n||N,fieldList:s,validate:ye.evaluateValidate},Ct)),t().createElement(m.gN,(0,b.Z)({name:"assess",label:f("lineClass.assessmentOffline"),displayType:"Custom",max:999999,component:Tt.we,disabled:s.indexOf("assess")!==-1||n||N,validate:ye.assessValidate},Ct)),t().createElement(m.gN,(0,b.Z)({name:"remind",label:f("lineClass.newsRemind"),displayType:"Custom",component:Tt.J,disabled:n||N},Ct)),t().createElement(m.gN,(0,b.Z)({name:"other",label:f("leftMenuLists.other"),displayType:"Custom",disabled:n||N,fieldList:s,component:Tt.l3},Ct)))})))}}var ht=(0,E.Z)()(Vt),re={size:"oversized",destroyOnClose:!0,bodyStyle:{padding:"0"},maskClosable:!1,wrapClassName:"qa-add-offline-training-confirm"},fe={};class pe extends t().Component{constructor(r){super(r);this.onFormMounted=n=>{fe=n},this.onCancel=()=>{this.setState({showForm:!1});var n=this.props.onCancel;n&&this.props.onCancel()},this.finalSubmitData=n=>{if(this.setState({showForm:!1}),this.props.onOk){var s=this.state.editInfoObj,i={id:s.id?s.id:"",type:"xx",key:s.id?s.id:s.key?s.key:"newofflinetrain".concat(new Date().getTime()),name:n.title,componentName:"OfflineTrain",icon:$.e1.xx,data:(0,v.Z)({},n)};if(!this.state.closeVisible){D.default.success(this.props.t("common.saveSuccess"));var u=this.getInitData(!0);this.setState({initData:u,editInfoObj:{},showForm:!0}),fe.setFieldValue("title",u.title),fe.setFieldValue("dateRange",u.dateRange),fe.setFieldValue("course_duration",u.course_duration),fe.setFieldValue("teacher",u.teacher),fe.setFieldValue("address",n.address),fe.setFieldValue("introduction",u.introduction),fe.setFieldValue("attachment",u.attachment),fe.setFieldValue("evaluate",u.evaluate),fe.setFieldValue("assess",u.assess),fe.setFieldValue("remind",u.remind),fe.setFieldValue("other",u.other),fe.setFieldValue("id","")}this.props.onOk(i,this.state.closeVisible)}},this.submit=n=>{this.finalSubmitData(n)},this.handleSaveNext=()=>{this.setState({closeVisible:!1},()=>{fe.submitForm()})},this.handleCommit=()=>{this.setState({closeVisible:!0},()=>{fe.submitForm()})},this.getInitData=n=>{var s={title:"",classifyName:"",dateRange:{startTime:null,endTime:null},address:"",course_duration:"0",teacher:{},introduction:"",attachment:[],other:{is_open_schedule:!1,is_open_upload:!1},remind:{remind_type:"offline_course",advance_minute:"0",is_lecturer_remind:!1,is_student_remind:!1,is_director_remind:!1},evaluate:{is_lecturer_student_evaluate:!1,is_student_lecturer_evaluate:!1,is_student_course_evaluate:!1,lecturer_student_evaluate_content:{evaluate_type:"score",questionnaire_id:"",questionnaire_name:"",total_score:"",passing_score:""},student_lecturer_evaluate_content:{evaluate_type:"star",questionnaire_id:"",questionnaire_name:"",total_score:"",passing_score:""},student_course_evaluate_content:{evaluate_type:"star",questionnaire_id:"",questionnaire_name:"",total_score:"",passing_score:""}},assess:{is_open_offline_assessment:!1,assessment_total_score:0,assessment_pass_score:0},has_lecturer_student_data:!1,has_student_lecturer_data:!1,has_student_course_data:!1,has_lecturer_assess_student_data:!1,status:""};if(n)return s;var i=this.props.editInfo.data||{},u=this.props.t;if(i.title){var f=(0,v.Z)({},Ga()(i));return this.setState({title:u("common.edit")+u("common.offline")}),f}return s},this.renderModalFooter=()=>{var n=this.props,s=n.t,i=n.isPreview;return t().createElement("div",{className:"coach-task-modal-footer"},t().createElement(y.Z,{onClick:this.onCancel},s("common.cancel")),!i&&t().createElement(y.Z,{type:"primary",onClick:()=>this.handleSaveNext()},s("lineClass.saveNextAdd")),!i&&t().createElement(y.Z,{type:"primary",onClick:()=>this.handleCommit()},s("common.save")))},this.state={closeVisible:!0,title:r.t("component.addOfflineTitle"),initData:{},showForm:!1,editInfoObj:{}}}componentDidUpdate(r){r.visible!==this.props.visible&&this.props.visible&&this.setState({initData:this.getInitData(),editInfoObj:this.props.editInfo},()=>{this.setState({showForm:!0})})}render(){return t().createElement(La.ZP,(0,b.Z)({},re,{footerType:"custom",visible:this.props.visible,title:this.state.title,onCancel:this.onCancel,renderCustomFooter:this.renderModalFooter,onOk:()=>this.handleCommit()}),t().createElement("div",{className:"offline-train"},this.state.showForm?t().createElement(ht,{onFormMounted:this.onFormMounted,onSubmit:this.submit,initData:this.state.initData,dateRange:this.props.dateRange,isPreview:this.props.isPreview,editable:this.props.editable,dateRangeLimit:this.props.dateRangeLimit}):null))}}var ee=Z=>({userId:Z.user.id,userName:Z.user.name}),ge=(0,h.$j)(ee)((0,E.Z)()(pe)),Me=e(80007),Ke=e(43859);class ct extends t().Component{constructor(){super(...arguments);this.state={visible:!1,whiteList:{zaraFlag:(0,be.UI)("ZARA_H5")}},this.handleClick=()=>{this.setState({visible:!0})},this.handleOk=r=>{if(this.setState({visible:!1}),r.length!==0){var n=r[0];this.props.formik.setFieldValue("questionnaire",(0,v.Z)((0,v.Z)({},this.props.formik.values.questionnaire),{},{id:n.id,name:n.name}));var s=this.state.whiteList;if(s.zaraFlag){var i=this.props.onSelect;i&&this.props.onSelect(n)}}},this.handleCancel=()=>{this.setState({visible:!1})},this.compileData=r=>r.id?[{id:r.id,name:r.name}]:[]}render(){var r=this.props,n=r.defaultFieldList,s=r.t,i=r.btnText,u=this.state.visible,f=n.name,N=n.disabled,Y=this.compileData(n);return t().createElement(t().Fragment,null,t().createElement("div",null,t().createElement(de.Z,{value:f,disabled:!0,style:{width:260}}),t().createElement(y.Z,{type:"link",icon:t().createElement(V.Z,null),disabled:N,onClick:this.handleClick},i||s("questionn.investigateDetailBtn")),t().createElement(Me.Z,{visible:u,defaultChecked:Y,onOk:this.handleOk,onCancel:this.handleCancel})))}}ct.defaultProps={visible:!1,onCancel:()=>{},onOk:()=>{}};var pt=(0,Ke.Z)((0,m.$j)((0,E.Z)()(ct))),_t=(0,ve.me)(),At=ke.Z[_t].questionn.validation,Gt=Z=>Z.id?"":At.investigateDetailSelectNull,Ia={labelCol:{xs:{span:5},sm:{span:5}},wrapperCol:{xs:{span:16},sm:{span:16}}};class Ba extends t().Component{constructor(r){super(r);this.onCancel=()=>{this.setState({showForm:!1});var n=this.props.onCancel;n&&this.props.onCancel()},this.onOk=()=>{this.initRef.submitForm()},this.onSubmit=n=>{this.setState({showForm:!1});var s=this.props,i=s.onOk,u=s.editInfo,f=u===void 0?{}:u;if(i){var N=Object.assign(f,{id:f.id||"",key:f.id||f.key||"newinvestigate".concat(new Date().getTime()),name:n.title,componentName:"AddInvestigate",icon:$.e1.questionnaire,type:"investigate",questionnaire:{id:n.questionnaire.id,name:n.questionnaire.name},data:{id:n.questionnaire.id,name:n.questionnaire.name}});i(N)}},this.getInitData=()=>{var n=this.props.editInfo||{};return n.name?{title:n.name,questionnaire:{id:n.questionnaire.id||"",name:n.questionnaire.name||"",disabled:!!n.id}}:{title:"",questionnaire:{id:"",name:"",disabled:!1}}},this.state={initData:{title:"",questionnaire:{id:"",name:"",disabled:!1}},showForm:!1}}componentDidUpdate(r){r.visible!==this.props.visible&&this.props.visible&&this.setState({initData:this.getInitData()},()=>{this.setState({showForm:!0})})}render(){var r=this.state,n=r.initData,s=r.showForm,i=this.props.t,u={okText:i("common.ok"),cancelText:i("common.cancel"),size:"medium",destroyOnClose:!0,bodyStyle:{padding:"0"},maskClosable:!1};return t().createElement(La.ZP,(0,b.Z)({title:i("setting.addUserField")+i("questionn.questionnaire")},u,{visible:this.props.visible,onCancel:this.onCancel,onOk:this.onOk}),t().createElement("div",{className:"add-question-bank"},s&&t().createElement(m.J9,{ref:f=>{this.initRef=f},initialValues:n,onSubmit:this.onSubmit,render:f=>t().createElement(m.l0,{className:"add-question-bank-form"},t().createElement(m.gN,(0,b.Z)({component:We.Z,name:"title",label:i("questionn.investigateDetailName"),required:!0,type:"text",style:{width:"350px"},defaultValue:f.values.title,maxLength:60,placeholder:i("questionn.investigateDetailPlaceholder"),validate:N=>(0,ze.QK)(N,i("questionn.investigateDetailPlaceholder"))},Ia)),t().createElement(m.gN,(0,b.Z)({component:pt,displayType:"Custom",name:"questionnaire",label:i("questionn.investigateDetailSelect"),required:!0,defaultFieldList:f.values.questionnaire,validate:Gt},Ia)))})))}}Ba.defaultProps={visible:!1,onCancel:()=>{},onOk:()=>{}};var ia=(0,E.Z)()(Ba),da=e(59434),Es=e(16381);class Fs extends t().Component{constructor(){super(...arguments);this.initRef=r=>{this.formRef=r},this.renderQuestionsContent=r=>{var n=r.questionsMode===1;return n?this.renderFixedModeContent(r):this.renderRandomModeContent(r)},this.renderFixedModeContent=r=>{var n=this.props,s=n.examProps,i=n.isEdit,u=n.t,f=s.disabledFields,N=f===void 0?[]:f;return t().createElement(m.gN,{component:da.xE,displayType:"Custom",name:"fixedQuestion",label:u("exam.paper"),required:!0,onHiddenDialog:this.props.onHiddenDialog,onShowDialog:this.props.onShowDialog,defaultFieldList:r.fixedQuestion,validate:Y=>(0,Es.dy)(Y,r),disabled:i&&N.indexOf("questionsMode")!==-1})},this.renderRandomModeContent=r=>{var n=this.props,s=n.examProps,i=n.isEdit,u=n.t,f=n.multipleMissedScore,N=s.disabledFields,Y=N===void 0?[]:N;return t().createElement(m.gN,{component:da.B$,displayType:"Custom",name:"randomQuestion",label:u("exam.bank"),required:!0,customError:!0,onHiddenDialog:this.props.onHiddenDialog,onShowDialog:this.props.onShowDialog,multipleMissedScore:f,defaultFieldList:r.randomQuestion,validate:J=>(0,Es.cT)(J,r),disabled:i&&Y.indexOf("questionsMode")!==-1})},this.renderDrawQuestions=r=>{var n=this.props,s=n.examProps,i=n.isEdit,u=n.t,f=s.disabledFields,N=f===void 0?[]:f,Y=r.randomQuestion.bankQuesitonVoList&&r.randomQuestion.bankQuesitonVoList.length>0,J=r.questionsMode!==1;if(J&&Y){var se=this.getAllQuestionsNumber(r.randomQuestion.bankQuesitonInfo);return t().createElement(m.gN,{component:da.p7,displayType:"Custom",name:"DrawQuestionsSwitch",label:u("exam.weightedQuestions"),defaultValue:r.isOpenDrawQuestions,questionsNumber:se,disabled:i&&N.indexOf("drawQuestionsSwitch")!==-1})}return null},this.renderWeightInput=r=>{var n=this.props,s=n.examProps,i=n.isEdit,u=s.disabledFields,f=u===void 0?[]:u,N=r.questionsMode!==1;return r.isOpenDrawQuestions&&N&&r.proportional.length>0?t().createElement(t().Fragment,null,t().createElement(m.gN,{component:da.CZ,displayType:"Custom",name:"proportional",required:!0,defaultFieldList:r.proportional,validate:Es.RE,disabled:i&&f.indexOf("weightInput")!==-1}),t().createElement("div",{style:{height:"12px"}})):null},this.getAllQuestionsNumber=r=>{var n=r.fillBlankCount,s=r.multipleCount,i=r.shortAnswerCount,u=r.singleCount,f=r.trueOrFalseCount;return n+s+i+u+f}}componentDidMount(){this.props.onFormMounted(this.formRef)}render(){var r=this.props,n=r.initData,s=r.t,i=r.examProps,u=r.isEdit,f=r.anonymousMarking,N=i.disabledFields,Y=N===void 0?[]:N;return t().createElement(m.J9,{ref:this.initRef,initialValues:n,onSubmit:this.props.onSubmit,render:J=>t().createElement(m.l0,{className:"add-exam-form"},t().createElement(m.gN,{component:da.G2,displayType:"Custom",name:"questionsMode",label:s("exam.paperMode"),required:!0,defaultFieldList:J.values.questionsMode,disabled:u&&Y.indexOf("questionsMode")!==-1}),this.renderQuestionsContent(J.values),this.renderDrawQuestions(J.values),this.renderWeightInput(J.values),t().createElement(m.gN,{component:da.Fz,displayType:"Custom",name:"passLine",label:s("exam.passLine"),required:!0,defaultFieldList:J.values.passLine,validate:Es.QL,disabled:u&&Y.indexOf("passLine")!==-1}),t().createElement(m.gN,{component:We.Z,name:"title",label:s("exam.taskName"),required:!0,type:"text",defaultValue:J.values.title,validate:se=>(0,ze.QK)(se,s("exam.taskNamePlaceholder")),style:{width:"350px"},maxLength:60,className:"qa-mission-name-field",placeholder:s("exam.taskNamePlaceholder"),isPreview:u&&Y.indexOf("title")!==-1}),t().createElement(m.gN,{component:da.Xk,displayType:"Custom",name:"examDuration",label:s("exam.examinationTime"),required:!0,defaultFieldList:J.values.examDuration,validate:Es.$1,disabled:u&&Y.indexOf("examDuration")!==-1}),t().createElement("p",{className:"cl-form__divide"}),t().createElement(m.gN,{component:qe.Z,name:"summary",label:s("examing.examDesc"),type:"text",required:!1,defaultValue:J.values.summary,disabled:Y.indexOf("summary")!==-1,maxLength:150,rows:4,placeholder:s("exam.examInstructionPlaceholder")}),t().createElement("p",{className:"cl-form__divide"}),t().createElement(m.gN,{component:da.wu,displayType:"Custom",name:"cheatFlag",defaultFieldList:J.values.cheatFlag,disabled:u&&Y.indexOf("cheatFlag")!==-1,faceKnowDisabled:Y.indexOf("faceKnow")!==-1}),t().createElement("p",{className:"cl-form__divide"}),t().createElement(m.gN,{component:da.Sm,displayType:"Custom",name:"reExam",defaultFieldList:J.values.reExam,examProps:(0,v.Z)((0,v.Z)({},i),{},{isEdit:u}),disabled:u&&Y.indexOf("reExam")!==-1}),t().createElement("p",{className:"cl-form__divide"}),t().createElement(m.gN,{component:da.ZU,displayType:"Custom",name:"markType",anonymousMarking:f,validate:Es._F,papers:J.values.questionsMode===1?J.values.fixedQuestion.tableList:J.values.randomQuestion.bankQuesitonInfo,defaultFieldList:J.values.markType,disabled:u&&Y.indexOf("markType")!==-1}),t().createElement(m.gN,{component:da.Vu,displayType:"Custom",name:"knowledgePoints",defaultFieldList:J.values.knowledgePoints,disabled:u&&Y.indexOf("knowledgePoints")!==-1}))})}}Fs.defaultProps={initData:{},onShowDialog:()=>{},onHiddenDialog:()=>{},onFormMounted:()=>{},anonymousMarking:!1,multipleMissedScore:!1};var Ts=(0,E.Z)()(Fs),Ns={};class ks extends t().Component{constructor(r){super(r);this.onCancel=()=>{this.setState({showForm:!1});var n=this.props.onCancel;n&&this.props.onCancel()},this.onOk=()=>{var n=this.props.t,s=Ns,i=s.state,u=i===void 0?{}:i,f=u.values,N=f===void 0?{}:f,Y=N.markType,J=Y===void 0?{}:Y,se=J.checkedValue,Ce=se===void 0?1:se;Ce&&Ce===1?ae.Z.confirm({icon:t().createElement(z.Z,{style:{color:"#516AE6"}}),title:n("common.tip"),content:n("learning.isModalReplyUploadWaringContent"),okText:n("common.ok"),cancelText:n("common.cancel"),onOk:()=>{Ns.submitForm()}}):Ns.submitForm()},this.onSubmit=n=>{if(this.setState({showForm:!1}),this.props.onOk){var s=n.reExam,i=(0,ce.Z)(n,["reExam"]),u={id:this.props.editInfo.id?this.props.editInfo.id:"",name:n.title,key:this.props.editInfo.id?this.props.editInfo.id:this.props.editInfo.key?this.props.editInfo.key:"newexam".concat(new Date().getTime()),componentName:"AddExam",duration:n.examDuration*60,data:(0,v.Z)((0,v.Z)({},i),{},{reExam:(0,v.Z)((0,v.Z)({},s),{},{show_result:(0,da.hi)(s)})}),icon:$.e1.ex,type:"ex"};this.props.onOk(u)}},this.onShowDialog=()=>{this.setState({bodyMask:!0})},this.onHiddenDialog=()=>{this.setState({bodyMask:!1})},this.onFormMounted=n=>{Ns=n},this.getInitData=()=>{var n=this.props.editInfo.data||{};if(n.title){var s=n.title,i=n.examDuration,u=n.cheatFlag,f=n.reExam,N=n.markType,Y=n.questionsMode,J=n.passLine,se=n.fixedQuestion,Ce=n.randomQuestion,Xe=n.knowledgePoints,ot=Xe===void 0?1:Xe,He=n.summary,dt=n.isOpenDrawQuestions,it=dt===void 0?!1:dt,Dt=n.proportional,Qe={title:s,examDuration:i,cheatFlag:u,reExam:f,markType:N,questionsMode:Y,passLine:J,fixedQuestion:se,randomQuestion:Ce,knowledgePoints:ot,summary:He||"",isOpenDrawQuestions:it,proportional:Dt};return this.setState({isEdit:!!n.id}),Qe}return this.setState({isEdit:!1}),{title:"",examDuration:"",cheatFlag:{isChecked:!1,switchNum:null,faceRecognition:"off"},reExam:{show_result:!0,isChecked:!0,notAllowed:{end:2},allowed:{reRule:0,record:0,end:5,reNum:1,viewRule:1}},markType:{checkedValue:1,artificialDisabled:!0,fillBlank:{checked:!0,disabled:!1},shortAnswer:{checked:!0,disabled:!1}},questionsMode:1,passLine:"",fixedQuestion:{id:"",name:"",tableList:{fillBlankCount:0,fillBlankScore:0,multipleCount:0,multipleScore:0,shortAnswerCount:0,shortAnswerScore:0,singleCount:0,singleScore:0,totalCount:0,totalScore:0,trueOrFalseCount:0,trueOrFalseScore:0}},randomQuestion:{bankQuesitonVoList:[],bankQuesitonInfo:{fillBlankCount:0,fillBlankScore:0,fillBlankType:1,multipleCount:0,multipleScore:0,shortAnswerCount:0,shortAnswerScore:0,shortAnswerType:1,singleCount:0,singleScore:0,trueOrFalseCount:0,trueOrFalseScore:0}},knowledgePoints:1,summary:"",isOpenDrawQuestions:!1,proportional:[]}},this.state={title:this.props.t("exam.addTest"),bodyMask:!1,initData:{},showForm:!1,isEdit:!1}}componentDidUpdate(r){r.visible!==this.props.visible&&this.props.visible&&this.setState({initData:this.getInitData()},()=>{this.setState({showForm:!0})})}render(){var r=this.props.t,n={okText:r("common.ok"),cancelText:r("common.cancel"),size:"large",destroyOnClose:!0,bodyStyle:{padding:"0"},maskClosable:!1,wrapClassName:"qa-add-test-confirm"};return t().createElement(La.ZP,(0,b.Z)({},n,{visible:this.props.visible,title:this.state.title,bodyMask:this.state.bodyMask,onCancel:this.onCancel,onOk:this.onOk}),t().createElement("div",{className:"add-exam"},this.state.showForm?t().createElement(Ts,(0,b.Z)({onShowDialog:this.onShowDialog,onHiddenDialog:this.onHiddenDialog,onFormMounted:this.onFormMounted,onSubmit:this.onSubmit,initData:this.state.initData,isEdit:this.state.isEdit},this.props)):null))}}ks.defaultProps={visible:!1,editInfo:{},onCancel:()=>{},onOk:()=>{},anonymousMarking:!1,multipleMissedScore:!1};var Bs=(0,E.Z)()(ks),Wa=e(17780),hs=e(26017),Oa=e.n(hs),Ha=e(64134),ms=e(75205),wa=e(16267),xa=e(48194),rs={ADD:"add",EDIT:"edit"},ss={labelAlign:"right",labelCol:{span:4},wrapperCol:{span:20}};function Ks(Z,r){var n=Z.t,s=Z.initialValues,i=Z.type,u=Z.has_published,f=Z.from,N=(0,l.useRef)(null),Y=(0,l.useState)([]),J=(0,Be.Z)(Y,2),se=J[0],Ce=J[1];(0,l.useEffect)(()=>{Xe()},[]);var Xe=function(){var dt=(0,K.Z)(d().mark(function it(){var Dt,Qe,ft,kt;return d().wrap(function(Rt){for(;;)switch(Rt.prev=Rt.next){case 0:return Rt.next=2,(0,be.Kb)((0,xa.q)());case 2:if(Dt=Rt.sent,Qe=(0,Be.Z)(Dt,2),ft=Qe[0],kt=Qe[1],!ft){Rt.next=8;break}return Rt.abrupt("return");case 8:kt&&kt.data&&kt.data.sync_organizes&&Ce(kt.data.sync_organizes||[]);case 9:case"end":return Rt.stop()}},it)}));return function(){return dt.apply(this,arguments)}}();(0,l.useImperativeHandle)(r,()=>({onSubmitFormik:()=>{N.current.submitForm()},setFormikValues:dt=>{N.current.setValues(dt)}}));var ot=dt=>{He(dt)},He=dt=>{Z.onOk&&Z.onOk(dt)};return t().createElement("div",{className:Oa()["exam-form-container"]},t().createElement(m.J9,{ref:N,initialValues:s,onSubmit:ot,render:dt=>{var it=dt.values,Dt=dt.setFieldValue;return t().createElement(m.l0,null,t().createElement("div",{className:Oa()["form-content"]},t().createElement("div",{className:"".concat(Oa()["important-info"])},t().createElement("div",{className:Oa()["exam-info"]},t().createElement(wa.N,{title:n("examination.examInfo")}),t().createElement("div",{className:"".concat(Oa()["exam-info-content"]," ").concat(Oa()["section-content"])},t().createElement("div",{className:"".concat(Oa()["exam-content-container"])},t().createElement(m.gN,(0,b.Z)({component:Ha.wK,from:"addPaper",withBlankAndShortAnswer:!0,displayType:"Custom",name:"paperInfo",placeholder:n("examination.selectPlaceholder"),label:n("examination.referencePapers"),validate:Qe=>(0,ze.QK)(Qe.id,"".concat(n("examination.validatePaper"))),has_published:it.has_published||u,setFieldValue:Dt,required:!0},ms.mJ)),t().createElement(m.gN,(0,b.Z)({component:We.Z,valueSlice:!0,name:"title",label:n("examination.examTaskName"),validate:Qe=>(0,ze.QK)(Qe,"".concat(n("examination.validateTaskName"))),required:!0,type:"text",LimitLength:60,showCount:!0,char:!0,placeholder:n("examination.inputPlaceholder")},ms.mJ)),t().createElement(m.gN,(0,b.Z)({displayType:"Custom",component:Ha._e,name:"exam_duration",label:n("examination.answerLength"),required:!0,validate:Qe=>Ha.XQ.validateExamDuration(Qe)},ms.mJ)),t().createElement(m.gN,(0,b.Z)({displayType:"Custom",component:Ha.Fz,paperInfo:it.paperInfo,name:"pass_line",label:n("examination.passLine"),required:!0},ms.mJ)),t().createElement(m.gN,(0,b.Z)({component:qe.Z,name:"description",label:n("examination.examDesc"),type:"text",required:!1,LimitLength:200,char:!0,showCount:!0,rows:4,placeholder:n("examination.inputPlaceholder")},ms.mJ)))))),t().createElement("div",{className:"".concat(Oa()["advance-info-container"])},t().createElement("div",{className:"".concat(Oa()["advance-info-content"])},t().createElement("h3",{className:Oa()["advance-title"]},n("examination.examAdvanceSetting")),t().createElement("div",{className:Oa()["advance-setting"]},t().createElement("div",{className:Oa()["setting-section"]},t().createElement(wa.N,{title:n("examination.examSetting")}),t().createElement("div",{className:"".concat(Oa()["section-content"])},t().createElement(m.gN,(0,b.Z)({displayType:"Custom",component:Ha.QN,has_published:it.has_published||u,name:"exam_times",colon:!1,label:t().createElement("span",{className:Oa()["formik-label-title"]},n("examination.exam_times")," :")},ss)),t().createElement(m.gN,(0,b.Z)({displayType:"Custom",component:Ha.$O,has_published:it.has_published||u,name:"score_record_type",colon:!1,label:t().createElement("span",{className:Oa()["formik-label-title"]},n("examination.score_record_type")," :")},ss)),t().createElement(m.gN,(0,b.Z)({displayType:"Custom",component:Ha.Jv,name:"always_extract_paper",colon:!1,label:t().createElement("span",{className:Oa()["formik-label-title"]},n("examination.always_extract_paper")," :")},ss)),(0,ms.Ks)({orgTypes:se,type:"cutScreen"})?t().createElement(m.gN,(0,b.Z)({displayType:"Custom",component:Ha.U6,name:"cut_screen_times",colon:!1,label:t().createElement("span",{className:Oa()["formik-label-title"]},n("examination.cut_screen_times")," :")},ss)):null,t().createElement(m.gN,(0,b.Z)({displayType:"Custom",component:Ha.LH,name:"random_order",colon:!1,label:t().createElement("span",{className:Oa()["formik-label-title"]},n("examination.random_order")," :")},ss)),f==="trainingProject"?t().createElement(m.gN,(0,b.Z)({displayType:"Custom",component:Ha.kE,face_recognition:it.face_recognition,name:"answer_device",label:n("examination.answerDevice")},ss)):null,(0,ms.Ks)({orgTypes:se,type:"face"})&&!(0,Wa.xX)()?t().createElement(m.gN,(0,b.Z)({displayType:"Custom",component:Ha.Is,name:"face_recognition",exam_duration:it.exam_duration,validate:Qe=>Ha.XQ.validateFaceRecognition(Qe,it.exam_duration),colon:!1,label:t().createElement("span",{className:Oa()["formik-label-title"]},n("examination.face_recognition")," :")},ss)):null,t().createElement(m.gN,(0,b.Z)({displayType:"Custom",component:Ha.Vu,name:"show_tag",colon:!1,label:t().createElement("span",{className:Oa()["formik-label-title"]},n("examination.knowledgePoint")," :")},ss)))),t().createElement("div",{className:Oa()["setting-section"]},t().createElement(wa.N,{title:n("examination.displaySetting")}),t().createElement("div",{className:"".concat(Oa()["section-content"])},t().createElement(m.gN,(0,b.Z)({displayType:"Custom",component:Ha.xA,exam_period:it.exam_period,name:"result_visible",colon:!1,label:t().createElement("span",{className:Oa()["formik-label-title"]},n("examination.testData")," :")},ss)))),t().createElement("div",{className:Oa()["setting-section"]},t().createElement(wa.N,{title:n("examination.markingMethodSetting")}),t().createElement("div",{className:"".concat(Oa()["section-content"])},t().createElement(m.gN,(0,b.Z)({displayType:"Custom",component:Ha.g4,isEdit:i===rs.EDIT,paperInfo:it.paperInfo,name:"mark_setting",colon:!1,label:t().createElement("span",{className:Oa()["formik-label-title"]},n("examination.markingType")," :"),validate:Qe=>Ha.XQ.validateMarkingMethod(Qe)},ss)))))))),t().createElement(tr,null))}}))}var Qs=(0,l.forwardRef)(Ks),nn=e(28178),rn=e.n(nn);function vn(Z){var r=Z.t,n=Z.visible,s=Z.isEdit,i=Z.editInfo,u=Z.has_published,f=Z.from,N=(0,l.useRef)(null),Y=(0,h.v9)(it=>{var Dt=it.user;return{user:Dt}}),J=Y.user,se=(0,l.useState)((0,ms.AC)({user:{id:J.id,name:J.name,creator:!0},type:ms.DU.ADD_RELATION_EXAM_TASK})),Ce=(0,Be.Z)(se,1),Xe=Ce[0];(0,l.useEffect)(()=>{if(n){var it=s?i.data:(0,ms.AC)({user:{id:J.id,name:J.name,creator:!0},type:ms.DU.ADD_RELATION_EXAM_TASK});N.current&&it&&N.current.setFormikValues(it)}},[s,i.data,n]);var ot=it=>{Z.onOk&&Z.onOk({id:i&&i.id?i.id:"",name:it.title,key:i&&i.id?i.id:i&&i.key?i.key:"AddNewExam".concat(new Date().getTime()),componentName:"AddNewExam",data:it,duration:it.exam_duration*60,icon:$.e1.ex,type:"ex"})},He=()=>{Z.onCancel&&Z.onCancel()},dt=()=>{N.current&&N.current.onSubmitFormik()};return t().createElement(t().Fragment,null,n&&t().createElement(ae.Z,{visible:n,width:870,title:r(s?"exam.editExam":"exam.addExam"),onCancel:He,onOk:dt,maskClosable:!1,bodyStyle:{padding:"0 24px 24px 24px"}},t().createElement("div",{className:rn()["modal-content"]},t().createElement(Qs,{t:r,ref:N,initialValues:Xe,type:s?rs.EDIT:rs.ADD,has_published:u,from:f,onCancel:()=>{ae.Z.confirm({title:"",icon:t().createElement(z.Z,null),content:r("examination.confirmCancel"),okText:r("common.ok"),cancelText:r("common.cancel"),onOk:He})},onOk:ot}))))}vn.defaultProps={from:""};var As=(0,E.Z)()(vn),ln=e(3233),Cn=e(77576),ws=e(59314),yn=e(54549);class Tn extends t().Component{constructor(){super(...arguments);this.state={defaultCheckedResource:[],showQuestion:!1,assessValue:"score"},this.handleFullMarkChange=r=>{var n=r.target.checked;this.props.formik.setFieldValue("mark",(0,v.Z)((0,v.Z)({},this.props.value),{},{isFull:n}))},this.handleMarkChange=r=>{this.props.formik.setFieldValue("mark",(0,v.Z)((0,v.Z)({},this.props.value),{},{value:r}))},this.cancelEditResource=()=>{this.setState({showQuestion:!1})},this.sureAddResource=r=>{this.setState({defaultCheckedResource:r,showQuestion:!1})},this.showQuestion=()=>{this.setState({showQuestion:!0})},this.delQuestionItem=r=>{var n=this.state.defaultCheckedResource,s=(0,fa.Z)(n.entries()),i;try{for(s.s();!(i=s.n()).done;){var u=i.value,f=(0,Be.Z)(u,2),N=f[0],Y=f[1];if(Y.id===r){n.splice(N,1);break}}}catch(J){s.e(J)}finally{s.f()}this.setState({defaultCheckedResource:n})},this.changeAssess=r=>{var n=r.target.value;this.setState({assessValue:n})},this.renderQuestionContent=()=>{var r=this.state.defaultCheckedResource,n=this.props.t;return t().createElement("div",{className:"tutor-access-content-standard-question"},t().createElement(y.Z,{onClick:this.showQuestion,icon:t().createElement(V.Z,null)},n("questionn.investigateDetailSelect")),r.map(s=>t().createElement("div",{className:"question-item",key:s.id},s.name,t().createElement(yn.Z,{className:"close-btn",onClick:()=>this.delQuestionItem(s.id)}))))},this.renderScoreContent=()=>{var r=this.props,n=r.mark,s=r.t;return t().createElement("div",{className:"tutor-access-content-standard-score"},t().createElement("span",{className:"total-score"},s("practiceOperation.totalScore")),t().createElement(X.Z,{disabled:!n.isFull,size:"small",defaultValue:n.value,precision:0,min:0,max:99999,onChange:this.handleMarkChange}),t().createElement("span",{style:{marginLeft:"6px"}},s("practiceOperation.score")),t().createElement("span",{className:"qualified-standard-tip"},s("practiceOperation.scoreTip")))},this.tutorRender=()=>{var r=this.props.t,n=this.state,s=n.showQuestion,i=n.defaultCheckedResource,u=n.assessValue;return t().createElement("div",{className:"tutor-access-content"},t().createElement("div",{className:"tutor-access-content-switch"},t().createElement(ws.Z,null),t().createElement("span",null,r("tutorial.assessTip"))),t().createElement("div",{className:"tutor-access-content-standard"},t().createElement("div",{className:"tutor-access-content-standard-radio"},t().createElement("span",null,r("tutorial.assessment")),t().createElement(M.ZP.Group,{value:u,onChange:this.changeAssess},t().createElement(M.ZP,{value:"score"},r("tutorial.markSystem")),t().createElement(M.ZP,{value:"multi_dimension"},t().createElement(c.Z,{placement:"top",title:r("tutorial.assessmentTip")},t().createElement("span",{className:"shuoming-tip"},r("tutorial.multidimensionalEvaluation")),t().createElement(S.Z,{iconClass:"icon-shuoming",size:"16px",color:"rgba(87, 87, 87, 1)"}))))),u==="score"?this.renderScoreContent():this.renderQuestionContent()),t().createElement(Me.Z,{visible:s,defaultChecked:i,multiple:!0,onCancel:this.cancelEditResource,onOk:this.sureAddResource}))}}render(){var r=this.props,n=r.mark,s=r.t,i=r.isHasTutor,u=r.isHuaLaiShi;return i?this.tutorRender():t().createElement("div",{className:u?"":"qualified-standard practice-mark"},u?"":t().createElement("div",{className:"qualified-standard-title"},s("component.practiceAudit")),t().createElement("div",{className:u?"":"qualified-standard-item"},t().createElement(T.Z,{defaultChecked:n.isFull,onChange:this.handleFullMarkChange},s("practiceOperation.totalScore")),t().createElement(X.Z,{disabled:!n.isFull,size:"small",defaultValue:n.value,precision:0,min:0,max:99999,onChange:this.handleMarkChange}),t().createElement("span",{style:{marginLeft:"6px"}},s("practiceOperation.score")),t().createElement("span",{className:"qualified-standard-tip"},s("practiceOperation.scoreTip"))))}}Tn.defaultProps={isHasTutor:!1};var Sn=(0,Ke.Z)((0,m.$j)((0,E.Z)()(Tn))),Pn=(0,ve.me)(),Fn=ke.Z[Pn].component.addPracticeValidation,on=ke.Z[Pn].authentication.validation,Js={mark:Z=>{var r;return Z.isFull&&!Z.value&&(r=Fn.markTip),r},checkSupervisor:Z=>{var r,n=Z.multilevel,s=Z.type;if(s==="multilevel")if(n.length<2)r=on.abilityDetailSupervisionNull;else{var i={},u=[];n.forEach((f,N)=>{if(f.length===0){r=(0,ve.ZT)("".concat(on.abilityDetailSupervisionStepNull),N+1);return}if(f.length>5){r=(0,ve.ZT)("".concat(on.abilityDetailSupervisionStepLimit),N+1);return}f.forEach(Y=>{u.push(Y)})}),u.forEach(f=>{i[f.id]?r=on.abilityDetailSupervisionRepeat:i[f.id]=!0})}return r}};class Ge extends t().Component{constructor(){super(...arguments);this.onChange=r=>{this.props.onChange(r.target.value)}}render(){var r=this.props,n=r.value,s=r.t;return t().createElement("div",null,t().createElement(M.ZP.Group,{onChange:this.onChange,value:n},t().createElement(M.ZP,{value:"common"},s("component.practiceType1")),t().createElement(M.ZP,{value:"newcomer"},s("component.practiceType2"))),t().createElement("p",{className:"type-tip"},s("component.practiceTypeTip")))}}var st=(0,Ke.Z)((0,m.$j)((0,E.Z)()(Ge))),lt=e(49010),yt={labelCol:{xs:{span:4},sm:{span:4}},wrapperCol:{xs:{span:20,offset:0},sm:{span:20,offset:0}}},Nt=Z=>({enterpriseId:Z.user.enterpriseId});class Kt extends t().Component{constructor(){super(...arguments);this.initRef=r=>{this.formRef=r}}componentDidMount(){this.props.onFormMounted(this.formRef)}render(){var r=this.props,n=r.initData,s=r.t,i=r.createUserId,u=r.enterpriseId;return t().createElement(m.J9,{ref:this.initRef,initialValues:n,onSubmit:this.props.onSubmit,render:f=>t().createElement(m.l0,null,t().createElement(m.gN,(0,b.Z)({name:"title",label:s(u==="1074539867477774379"?"component.practiceName2":"component.practiceName"),required:!0,type:"text",defaultValue:f.values.title,validate:N=>(0,ze.QK)(N,s("component.practiceInputPlaceholder")),component:We.Z,placeholder:s("component.practiceInputPlaceholder"),maxLength:30},yt)),t().createElement(m.gN,(0,b.Z)({name:"content",required:!0,label:s(u==="1074539867477774379"?"component.practiceRequire2":"component.practiceRequire"),component:qe.Z,displayType:"Custom",type:"text",maxLength:500,rows:10,placeholder:s("component.practiceRequirePlaceholder"),validate:N=>(0,ze.QK)(N,s("component.practiceRequirePlaceholder"))},yt)),t().createElement(m.gN,(0,b.Z)({name:"attachment",label:s("component.practiceAttachment"),component:ln.Z,displayType:"Custom",notLibrary:!0,uploadComponentId:"0bab7fa2-40fd-4cee-898e-224640aea984",removeable:!0,hasZip:"true",validate:Js.attachment},yt)),t().createElement(m.gN,(0,b.Z)({name:"job_type",label:s("component.practiceType"),component:st},yt)),t().createElement(m.gN,{name:"mark",component:Sn,mark:f.values.mark,validate:Js.mark,displayType:"Custom",wrapperCol:{xs:{span:20,offset:4},sm:{span:20,offset:4}}}),t().createElement(m.gN,{name:"supervisor",component:lt.Z,defaultFieldList:f.values.supervisor,validate:Js.checkSupervisor,isHasTutor:this.props.isHasTutor,createUserId:i,displayType:"Custom",className:"practice-audit",qwTicketShow:"false",wrapperCol:{xs:{span:20,offset:4},sm:{span:20,offset:4}}}))})}}Kt.defaultProps={initData:{},onFormMounted:()=>{},isHasTutor:!1};var Jt=(0,h.$j)(Nt)((0,E.Z)()(Kt)),zt=e(13420),jt={labelCol:{xs:{span:4},sm:{span:4}},wrapperCol:{xs:{span:20,offset:0},sm:{span:20,offset:0}}},Mt=Z=>({enterpriseId:Z.user.enterpriseId});class aa extends t().Component{constructor(){super(...arguments);this.initRef=r=>{this.formRef=r}}componentDidMount(){this.props.onFormMounted(this.formRef)}render(){var r=this.props,n=r.initData,s=r.t,i=r.createUserId,u=r.enterpriseId,f=r.isHuaLaiShi;return t().createElement(m.J9,{ref:this.initRef,initialValues:n,onSubmit:this.props.onSubmit,render:N=>t().createElement(m.l0,null,t().createElement(m.gN,(0,b.Z)({name:"title",label:s("component.practiceName"),required:!0,type:"text",defaultValue:N.values.title,validate:Y=>(0,ze.QK)(Y,s("component.practiceInputPlaceholder")),component:We.Z,placeholder:s("component.practiceInputPlaceholder"),maxLength:30},jt)),t().createElement(m.gN,(0,b.Z)({name:"content",required:!0,label:s("component.practiceRequire"),component:qe.Z,displayType:"Custom",type:"text",maxLength:500,rows:10,placeholder:s("component.practiceRequirePlaceholder"),validate:Y=>(0,ze.QK)(Y,s("component.practiceRequirePlaceholder"))},jt)),t().createElement(m.gN,(0,b.Z)({name:"attachment",label:s("component.practiceAttachment"),component:ln.Z,displayType:"Custom",removeable:!0,validate:Js.attachment},jt)),t().createElement(m.gN,(0,b.Z)({name:"job_type",label:s("component.practiceType"),component:st},jt)),t().createElement(m.gN,(0,b.Z)({name:"mark",label:s("practiceOperation.scoreSetting"),component:Sn,mark:N.values.mark,validate:Js.mark,displayType:"Custom",isHuaLaiShi:!0},jt)),t().createElement(m.gN,(0,b.Z)({component:zt.Z,name:"workFlowTemplateId",displayType:"Custom",label:s("component.practiceAudit"),required:!0,placeholder:s("component.practiceAuditTip"),validate:Y=>(0,ze.QK)(Y,s("component.practiceAuditTip")),isHuaLaiShi:!0},jt)))})}}aa.defaultProps={initData:{},onFormMounted:()=>{},isHasTutor:!1};var Ht=(0,h.$j)(Mt)((0,E.Z)()(aa)),ma={};class na extends t().Component{constructor(r){super(r);this.onFormMounted=n=>{ma=n},this.onCancel=()=>{this.setState({showForm:!1});var n=this.props.onCancel;n&&this.props.onCancel()},this.onOk=()=>{ma.submitForm()},this.getInitData=()=>{var n=this.props.editInfo.data||{};if(n.title){var s={title:n.title,content:n.address||n.content,attachment:n.attachment||[],job_type:n.job_type||"common",mark:n.mark,supervisor:n.supervisor,workFlowTemplateId:n.workFlowTemplateId};return s}return{title:"",content:"",attachment:[],job_type:"common",mark:{isFull:!1,value:100},supervisor:{or:[],multilevel:[],lead:"",type:"or"},workFlowTemplateId:""}},this.submit=n=>{if(this.props.onOk){var s={id:this.props.editInfo.id?this.props.editInfo.id:"",key:this.props.editInfo.id?this.props.editInfo.id:this.props.editInfo.key?this.props.editInfo.key:"newprictice".concat(new Date().getTime()),name:n.title,componentName:"AddPracticeTest",data:n,icon:$.e1.sc,type:"sc",qy_we_chat_vo:n.supervisor.qy_we_chat_vo};this.props.isHuaLaiShi&&this.props.editInfo.data?this.huaLaiShiChangeModal(s):(this.setState({showForm:!1}),this.props.onOk(s))}},this.huaLaiShiChangeModal=n=>{var s=this.props.t,i=this.state.initData,u=n.data,f=this;i.workFlowTemplateId!==u.workFlowTemplateId||i.mark.isFull!==u.mark.isFull||i.mark.value!==u.mark.value?ae.Z.confirm({title:s("practiceOperation.hlsModalTitle"),content:s("practiceOperation.hlsModalContent"),okText:s("practiceOperation.hlsModalOkText"),cancelText:s("common.cancel"),centered:!0,onOk(){f.props.onOk(n),f.setState({showForm:!1})}}):(this.props.onOk(n),this.setState({showForm:!1}))},this.state={initData:{},showForm:!1}}componentDidUpdate(r){r.visible!==this.props.visible&&this.props.visible&&this.setState({initData:this.getInitData()},()=>{this.setState({showForm:!0})})}render(){var r=this.props,n=r.t,s=r.createUserId,i=r.isHuaLaiShi,u={title:n("component.addPracticeTitle"),okText:n("common.ok"),cancelText:n("common.cancel"),size:"medium",destroyOnClose:!0,maskClosable:!1};return t().createElement(La.ZP,(0,b.Z)({},u,{visible:this.props.visible,onCancel:this.onCancel,onOk:this.onOk}),t().createElement("div",{className:"add-practice"},this.state.showForm?i?t().createElement(Ht,{onFormMounted:this.onFormMounted,onSubmit:this.submit,initData:this.state.initData,createUserId:s,isHasTutor:this.props.isHasTutor,isHuaLaiShi:!0}):t().createElement(Jt,{onFormMounted:this.onFormMounted,onSubmit:this.submit,initData:this.state.initData,createUserId:s,isHasTutor:this.props.isHasTutor}):null))}}na.defaultProps={visible:!1,editInfo:{},onCancel:()=>{},onOk:()=>{},isHasTutor:!1};var Ca=(0,E.Z)()(na),Xa=e(55446),za=e(50053),Ka=e(21046),ha={labelCol:{xs:{span:5},sm:{span:5}},wrapperCol:{xs:{span:16},sm:{span:16}}};class ya extends t().Component{constructor(r){super(r);this.onCancel=()=>{this.setState({showForm:!1});var n=this.props.onCancel;n&&this.props.onCancel()},this.onOk=()=>{this.initRef.submitForm()},this.onSubmit=n=>{if(this.setState({showForm:!1}),this.props.onOk){var s={id:this.props.editInfo.id?this.props.editInfo.id:"",key:this.props.editInfo.id||(this.props.editInfo.key?this.props.editInfo.key:"newprictice".concat(new Date().getTime())),name:n.title,componentName:"AddJobEvaluation",data:n,icon:$.e1.jobEvaluation,type:"jobEvaluation"};this.props.onOk(s)}},this.getInitData=()=>{var n=this.props.editInfo||{};if(n.name){var s={title:n.data&&n.data.title||"",evaluationTools:n.data&&n.data.evaluationTools||{model_id:"",product_id:""}};return s}return{title:"",evaluationTools:{model_id:"",product_id:""}}},this.cancelOrgDialog=()=>{var n=this.state.orgDialogConfig;n.visible=!1,this.setState({orgDialogConfig:n})},this.addUserCbk=()=>{var n=this.state.orgDialogConfig;n.visible=!1,this.setState({orgDialogConfig:n})},this.state={orgDialogConfig:{visible:!1,onOk:this.addUserCbk,displayType:["dept"],onCancel:this.cancelOrgDialog},initData:{title:"",evaluationTools:""},showForm:!1}}componentDidUpdate(r){r.visible!==this.props.visible&&this.props.visible&&this.setState({initData:this.getInitData()},()=>{this.setState({showForm:!0})})}render(){var r=this.state,n=r.orgDialogConfig,s=r.initData,i=this.props,u=i.saveAndToAdd,f=i.t,N=i.isEdit,Y={okText:f("common.ok"),cancelText:f("common.cancel"),size:"medium",destroyOnClose:!0,bodyStyle:{padding:"0"},maskClosable:!1},J=t().createElement("div",null,t().createElement(y.Z,{type:"primary",onClick:()=>this.save(!1)},f("common.save")),t().createElement(y.Z,{type:"primary",onClick:this.onOk},f("component.saveAndAddQuestion")));return u?Y.footer=J:Y.footer&&delete Y.footer,t().createElement(La.ZP,(0,b.Z)({title:f("setting.addUserField")+f("learning.positionEvaluation")},Y,{visible:this.props.visible,bodyMask:n.visible,onCancel:this.onCancel,onOk:this.onOk}),t().createElement("div",{className:"add-question-bank"},this.state.showForm?t().createElement(m.J9,{ref:se=>{this.initRef=se},initialValues:s,onSubmit:this.onSubmit,render:se=>t().createElement(m.l0,{className:"add-question-bank-form"},t().createElement(m.gN,(0,b.Z)({component:We.Z,name:"title",label:f("questionn.evaluationName"),required:!0,type:"text",defaultValue:se.values.title,validate:Ce=>(0,ze.QK)(Ce,f("questionn.validation.investigateDetailNameNull")),maxLength:30,style:{width:"100%"},placeholder:f("questionn.evaluationPlacelimit")},ha)),t().createElement(m.gN,(0,b.Z)({label:f("questionn.selectEvaluationTools"),required:!0,component:Ka.t9,displayType:"Custom",name:"evaluationTools",type:"radio",defaultFieldList:se.values.evaluationTools},ha,{isEdit:N,validate:za.k_})))}):null))}}ya.defaultProps={visible:!1,saveAndToAdd:!1,isEdit:!1,onCancel:()=>{},onOk:()=>{}};var Na=(0,E.Z)()(ya),ps=e(17462),Ss=e(1474),ka=(0,ve.me)(),_s=ke.Z[ka].tutorial.errorMsg,Rs={specified:Z=>{var r;return Z.tutor_model==="custom"&&(!Z.user_ids||Z.user_ids.length===0)&&(r=_s.selectSpecifiedObject),r}},qs=e(57762);class dn extends t().Component{constructor(r){super(r);this.handleChange=n=>{var s=n.target.value;this.props.onFieldChange((0,v.Z)((0,v.Z)({},this.props.value),{},{tutor_model:s}))},this.showOrg=()=>{var n=this.state.orgDialogConfig;n.visible=!0,this.setState({orgDialogConfig:n})},this.hiddenOrg=()=>{var n=this.state.orgDialogConfig;n.visible=!1,this.setState({orgDialogConfig:n})},this.addUser=n=>{var s=n.user,i=this.state.orgDialogConfig;i.visible=!1,this.setState({orgDialogConfig:i}),this.props.onFieldChange((0,v.Z)((0,v.Z)({},this.props.value),{},{user_ids:s}))},this.delUser=n=>{var s=[...this.props.value.user_ids],i=(0,fa.Z)(s.entries()),u;try{for(i.s();!(u=i.n()).done;){var f=u.value,N=(0,Be.Z)(f,2),Y=N[0],J=N[1];if(J.id===n){s.splice(Y,1);break}}}catch(se){i.e(se)}finally{i.f()}this.props.onFieldChange((0,v.Z)((0,v.Z)({},this.props.value),{},{user_ids:s}))},this.state={orgDialogConfig:{visible:!1,onlyUser:!0,onOk:this.addUser,onCancel:this.hiddenOrg,single:!0}}}render(){var r=this.props,n=r.value,s=r.t,i=r.isPreview,u=this.state.orgDialogConfig;return t().createElement("div",{className:"radio-mentor-form"},t().createElement(M.ZP.Group,{onChange:this.handleChange,disabled:i,value:n.tutor_model},t().createElement(M.ZP,{value:"tutor"},t().createElement(c.Z,{placement:"top",title:t().createElement("span",null,s("tutorial.supervisorApprovalTip1"),t().createElement("br",null),s("tutorial.supervisorApprovalTip2"),t().createElement("br",null),s("tutorial.supervisorApprovalTip3"),t().createElement("br",null),s("tutorial.supervisorApprovalTip4"))},t().createElement("span",{className:"tooltip-span"},s("tutorial.studentTutor")),t().createElement(S.Z,{iconClass:"icon-shuoming",size:"16px",color:"rgba(87, 87, 87, 1)"}))),t().createElement(M.ZP,{value:"custom"},s("registerLogin.customize"))),t().createElement("div",{className:"desc-tip"},s("tutorial.specifiedTip")),n.tutor_model==="custom"&&t().createElement("div",{className:"btn-content"},i?null:t().createElement("div",{className:"people-add-btn",onClick:this.showOrg},t().createElement(S.Z,{iconClass:"icon-icon_addx",size:"10px"}),t().createElement("span",null,s("authScope.chooseUser"))),n.user_ids.map(f=>t().createElement("div",{className:"people-item"},t().createElement("span",null,f.name),i?null:t().createElement(yn.Z,{onClick:()=>this.delUser(f.id),style:{fontSize:"12px"}})))),t().createElement(x.Z,(0,b.Z)({},u,{initData:{user:n.user_ids}})))}}var cn=(0,Ke.Z)((0,E.Z)()(dn)),$s={labelCol:{xs:{span:4},sm:{span:4}},wrapperCol:{xs:{span:20,offset:0},sm:{span:20,offset:0}}};class en extends t().Component{constructor(){super(...arguments);this.initRef=r=>{this.formRef=r}}componentDidMount(){this.props.onFormMounted(this.formRef)}render(){var r=this.props,n=r.initData,s=r.t;return t().createElement(m.J9,{ref:this.initRef,initialValues:n,onSubmit:this.props.onSubmit,render:i=>t().createElement(m.l0,null,t().createElement(m.gN,(0,b.Z)({name:"title",label:s("common.name"),required:!0,type:"text",defaultValue:i.values.title,validate:u=>(0,ze.QK)(u,s("tutorial.limitText")),component:We.Z,placeholder:s("component.practiceInputPlaceholder"),maxLength:30},$s)),t().createElement(m.gN,(0,b.Z)({name:"content",required:!0,label:s("tutorial.require"),component:qe.Z,displayType:"Custom",type:"text",rows:10,maxLength:500,placeholder:s("tutorial.requirePlaceholder"),validate:u=>(0,ze.QK)(u,s("tutorial.requirePlaceholder"))},$s)),t().createElement(m.gN,(0,b.Z)({name:"model",label:s("tutorial.mode"),component:qs.Z,radioList:[{value:"resource_evaluation",name:s("tutorial.modeTextOne")},{value:"evaluation",name:s("tutorial.modeTextTwo")}],placeHolder:s("tutorial.modeTip"),isPreview:n.id,displayType:"Custom"},$s)),i.values.model==="resource_evaluation"?t().createElement(m.gN,(0,b.Z)({name:"tutorUser",label:s("tutorial.specified"),component:cn,displayType:"Custom",validate:Rs.specified,isPreview:n.id},$s)):null,t().createElement(m.gN,(0,b.Z)({name:"evaluation_type",label:s("tutorial.assessmentM"),component:qs.Z,radioList:[{value:"satisfaction",name:s("tutorial.markSystem")}],isPreview:n.id,placeHolder:s("tutorial.assessmentTipText"),displayType:"Custom"},$s)))})}}en.defaultProps={initData:{},onFormMounted:()=>{}};var Dn=(0,h.$j)()((0,E.Z)()(en));class bn extends t().Component{constructor(r){super(r);this.getInitData=n=>{var s=n.editInfo.data||{};if(s.title){var i={id:s.id,title:s.title,content:s.content,model:s.model,tutorUser:{tutor_model:s.tutor_model,user_ids:s.user_id?[{name:s.user_name,id:s.user_id}]:[]},evaluation_type:s.evaluation_type};return i}return{title:"",content:"",model:"resource_evaluation",tutorUser:{tutor_model:"tutor",user_ids:[]},evaluation_type:"satisfaction"}},this.onCancel=()=>{this.setState({showForm:!1}),this.props.onCancel&&this.props.onCancel()},this.onOk=()=>{this.AddFormInstance.submitForm()},this.onFormMounted=n=>{this.AddFormInstance=n},this.submit=n=>{if(this.setState({showForm:!1}),this.props.onOk){var s=(0,v.Z)((0,v.Z)({},n),{},{tutor_model:n.tutorUser.tutor_model,user_id:n.tutorUser.user_ids&&n.tutorUser.user_ids.length>0?n.tutorUser.user_ids[0].id:"",user_name:n.tutorUser.user_ids&&n.tutorUser.user_ids.length>0?n.tutorUser.user_ids[0].name:""});delete s.tutorUser;var i={id:this.props.editInfo.id?this.props.editInfo.id:"",key:this.props.editInfo.id?this.props.editInfo.id:this.props.editInfo.key?this.props.editInfo.key:"newMentor".concat(new Date().getTime()),name:n.title,componentName:"AddMentorCoaching",data:s,icon:$.e1.tutor,type:"tutor"};this.props.onOk(i)}},this.state={showForm:!0,initData:{}},this.formRef=null}UNSAFE_componentWillReceiveProps(r){r.visible!==this.props.visible&&r.visible&&this.setState({initData:this.getInitData(r)},()=>{this.setState({showForm:!0})})}render(){var r=this.props,n=r.t,s=r.visible,i=this.state.initData,u={title:i.id?n("common.edit")+n("tutorial.tutorShip"):n("common.add")+n("tutorial.tutorShip"),okText:n("common.ok"),cancelText:n("common.cancel"),size:"medium",destroyOnClose:!0,maskClosable:!1};return t().createElement(La.ZP,(0,b.Z)({},u,{visible:s,onCancel:this.onCancel,onOk:this.onOk}),t().createElement("div",{className:"add-mentor-coaching"},t().createElement(Ss.Z,{message:n("tutorial.useScenario"),type:"warning",showIcon:!0,style:{marginBottom:10}}),this.state.showForm?t().createElement(Dn,{onFormMounted:this.onFormMounted,onSubmit:this.submit,initData:this.state.initData}):null))}}bn.defaultProps={visible:!1,onCancel:()=>{},onOk:()=>{}};var fn=(0,E.Z)()(bn),On=Le.Z.RangePicker;class wn extends t().Component{constructor(r){super(r);this.onChange=(n,s)=>{n==="signIn"&&(this.props.formik.setFieldValue("signInStatus",s),s||(this.props.formik.setFieldValue("sign_in_begin_time",null),this.props.formik.setFieldValue("sign_in_end_time",null))),n==="signOut"&&(this.props.formik.setFieldValue("signOutStatus",s),s||(this.props.formik.setFieldValue("sign_out_begin_time",null),this.props.formik.setFieldValue("sign_out_end_time",null)))},this.onChangeDate=(n,s)=>{if(!n||!n.length){s==="signIn"&&(this.props.formik.setFieldValue("sign_in_begin_time",""),this.props.formik.setFieldValue("sign_in_end_time","")),s==="signOut"&&(this.props.formik.setFieldValue("sign_out_begin_time",""),this.props.formik.setFieldValue("sign_out_end_time",""));return}var i="YYYY-MM-DD HH:mm",u=n[0].format(i),f=n[1].format(i);s==="signIn"&&(this.props.formik.setFieldValue("sign_in_begin_time",u),this.props.formik.setFieldValue("sign_in_end_time",f)),s==="signOut"&&(this.props.formik.setFieldValue("sign_out_begin_time",u),this.props.formik.setFieldValue("sign_out_end_time",f))},this.formDate=n=>n?typeof n=="number"?Ee()(n).format("YYYY-MM-DD HH:mm"):n:null,this.state={}}render(){var r="YYYY-MM-DD HH:mm",n=this.props,s=n.t,i=n.isPreview,u=this.props.formik.values,f=u.sign_in_begin_time,N=u.sign_in_end_time,Y=u.sign_out_begin_time,J=u.sign_out_end_time,se=u.signInStatus,Ce=u.signOutStatus;return t().createElement(t().Fragment,null,t().createElement("div",{className:"attendance-time-limit-content"},t().createElement("div",{className:"attendance-time-limit-sign"},t().createElement("div",{className:"attendance-time-sign-label"},t().createElement(T.Z,{disabled:i,checked:se,onChange:Xe=>this.onChange("signIn",Xe.target.checked)},s("attendance.signInTime"),":")),t().createElement("div",{className:"attendance-time-sign-value"},t().createElement(On,{disabled:!se||i,format:r,showTime:!0,value:f?[Ee()(this.formDate(f),r),Ee()(this.formDate(N),r)]:[],onChange:Xe=>this.onChangeDate(Xe,"signIn")}))),t().createElement("div",{className:"attendance-time-limit-sign"},t().createElement("div",{className:"attendance-time-sign-label"},t().createElement(T.Z,{disabled:i,checked:Ce,onChange:Xe=>this.onChange("signOut",Xe.target.checked)},s("attendance.signOutTime"),":")),t().createElement("div",{className:"attendance-time-sign-value"},t().createElement(On,{disabled:!Ce||i,format:r,showTime:!0,value:Y?[Ee()(this.formDate(Y),r),Ee()(this.formDate(J),r)]:[null,null],onChange:Xe=>this.onChangeDate(Xe,"signOut")})))))}}var Un=()=>({}),Bn=(0,h.$j)(Un)((0,m.$j)((0,E.Z)()(wn))),ar=e(71153),Wn=e(60331);class qa extends t().Component{constructor(r){super(r);this.onAddUser=n=>{var s=n.user,i=this.state.orgDialogConfig;i.visible=!1,this.setState({orgDialogConfig:i},()=>{this.props.onFieldChange(s)})},this.onClose=n=>{var s=this.props.value;s.splice(n,1),this.props.onFieldChange(s)},this.onHiddenOrg=()=>{var n=this.state.orgDialogConfig;n.visible=!1,this.setState({orgDialogConfig:n})},this.onShowOrg=()=>{if(!this.props.isPreview){var n=localStorage.getItem("authorityType"),s=this.props.user,i=s.appType,u=s.loginMode;if(i==="wx_app"&&u==="WE_COM"&&n==="1")this.handleSelectWx();else{var f=this.state.orgDialogConfig;f.visible=!0,this.setState({orgDialogConfig:f})}}},this.handleSelectWx=()=>{var n=this.props.user,s=this.props.value.map(i=>i.sync_user_id||i.user_id);(0,w.Sk)({userIds:s,deptIds:[]}).then(i=>{(0,w.$f)({result:i,user:n}).then(u=>{var f=u.qyWeChatVo,N=u.rangeList;this.props.onFieldChange(N.user),this.props.formik.setFieldValue("qy_we_chat_vo",f)})}).catch(()=>{})},this.state={orgDialogConfig:{visible:!1,onlyUser:!0,onOk:this.onAddUser,onCancel:this.onHiddenOrg},reserveUser:[]}}render(){var r=this.props,n=r.orgProps,s=r.isPreview,i=r.value,u=r.user,f=this.state,N=f.orgDialogConfig,Y=f.reserveUser,J="";return s&&(J="supervision-selector-add-disable"),t().createElement(t().Fragment,null,t().createElement("div",null,t().createElement("div",{className:"add-officer-tag"},i.map((se,Ce)=>{var Xe=se.sync_user_id||se.user_id,ot=u.account||u.id;return t().createElement(Wn.Z,{className:"tag-text",key:se.user_id,closable:!s&&Xe!==ot,onClose:()=>this.onClose(Ce)},t().createElement(L.Z,{dataType:"userName",value:se.sync_user_id||se.user_id,name:se.user_name||se.name,type:se.sync_source_type||se.source_type}))}),t().createElement("div",{className:"add-btn-op ".concat(J),onClick:this.onShowOrg},t().createElement(S.Z,{iconClass:"icon-icon_addx",size:"10px"})))),t().createElement(x.Z,(0,b.Z)({},n,N,{onlyUser:!0,initData:{user:i},reserveUser:Y})))}}var xs=Z=>({userId:Z.user.id,user:Z.user}),Vs=(0,h.$j)(xs)((0,m.$j)((0,E.Z)()(qa)));class Kn extends t().Component{constructor(r){super(r);this.onChange=n=>{this.props.onFieldChange(n?"dynamic":"statics")},this.state={}}render(){var r=this.props,n=r.isPreview,s=r.value,i=r.t;return t().createElement("div",{className:"refresh-content"},t().createElement(p.Z,null,t().createElement(ws.Z,{disabled:n,checked:s==="dynamic",onChange:this.onChange}),t().createElement("div",{className:"refresh-content-tip"},i("component.dynamicQRCodeTip"))))}}var Fr=(0,m.$j)((0,E.Z)()(Kn)),hd=e(43358),tn=e(34041),wr=tn.Z.Option;class Ur extends t().Component{constructor(r){var n;super(r);n=this,this.onChange=s=>{if(this.props.formik.setFieldValue("relate_course_list",[]),s){this.filterLineClass(!0);return}this.props.formik.setFieldValue("relate_course",!1)},this.onHandleClick=()=>{this.setAttendanceTime()},this.filterLineClass=s=>{var i=this.props,u=i.tabPanes,f=u===void 0?[]:u,N=i.activeTab,Y=i.isAttendance,J=this.state.defaultClass,se=f.filter(xt=>xt.key===N),Ce=se.length>0?se[0]:[{list:[]}],Xe=Ce.list,ot=Xe.filter(xt=>xt.componentName==="OfflineTrain"),He=Xe.filter(xt=>xt.componentName==="Attendance"),dt=[],it=[],Dt=(0,fa.Z)(He),Qe;try{for(Dt.s();!(Qe=Dt.n()).done;){var ft=Qe.value;it=it.concat([...ft.data.relate_course_list.map(xt=>xt.course_id||xt.course_key)])}}catch(xt){Dt.e(xt)}finally{Dt.f()}var kt=it.filter(xt=>!J.includes(xt));dt=ot.filter(xt=>!kt.includes(xt.id||xt.key)).map(xt=>(0,v.Z)((0,v.Z)({},xt),{},{key:xt.id?xt.id:xt.key?xt.key:"newofflinetrain".concat(new Date().getTime())})),this.setState({opsList:dt}),dt.length?dt.length&&s&&this.props.formik.setFieldValue("relate_course",!0):this.props.formik.setFieldValue("relate_course",!1),Y&&(this.props.formik.setFieldValue("relate_course_list",dt.map(xt=>(0,v.Z)((0,v.Z)({},xt),{},{course_id:xt.id,course_key:xt.key,course_name:xt.name}))),this.props.formik.setFieldValue("relate_course",!0))},this.filterObjectInArr=(s,i)=>{var u={},f=[...s,...i],N=f.reduce((Y,J)=>(u[J.name]||(u[J.name]=Y.push(J)),Y),[]);return N},this.setAttendanceTime=()=>{var s="YYYY-MM-DD HH:mm",i=this.state.opsList;if(i&&i.length>0){var u=[...i.map(Y=>Y.data.dateRange.startTime),...i.map(Y=>Y.data.dateRange.endTime)],f=u.map(Y=>Ee()(Y).valueOf()).sort()[0],N=u.map(Y=>Ee()(Y).valueOf()).sort()[u.length-1];this.props.formik.setFieldValue("sign_in_begin_time",Ee()(f).subtract(15,"minute").format(s)),this.props.formik.setFieldValue("sign_in_end_time",Ee()(f).add(15,"minute").format(s)),this.props.formik.setFieldValue("sign_out_begin_time",Ee()(N).format(s)),this.props.formik.setFieldValue("sign_out_end_time",Ee()(N).add(30,"minute").format(s)),this.props.formik.setFieldValue("signInStatus",!0),this.props.formik.setFieldValue("signOutStatus",!0)}},this.handleChange=function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],i=n.state.opsList;if(s.length===0){n.props.formik.setFieldValue("relate_course_list",[]);return}var u=[];i.map(f=>{s.map(N=>{N===f.key&&u.push({course_id:f.id,course_key:f.key,course_name:f.name})})}),n.props.formik.setFieldValue("relate_course_list",u)},this.formateDefault=()=>{var s=[];return this.props.defaultValue.relate_course_list.map(i=>{s.push(i.course_key)}),s},this.disabledOpenSwitch=()=>{var s=this.state,i=s.opsList,u=s.defaultClass,f=this.props,N=f.isPreview,Y=f.defaultValue.user_has_attendanted,J=u.filter(se=>se.indexOf("newofflinetrain")===-1);return i.length===0||N||J.length&&Y},this.disabledHadAttendanted=s=>{var i=this.state.defaultClass,u=i.filter(f=>f===s&&s.indexOf("newofflinetrain")===-1);return!!u.length},this.state={opsList:[],defaultClass:[]}}componentDidMount(){var r=[];this.props.defaultValue.relate_course_list.map(n=>{r.push(n.course_key)}),this.setState({defaultClass:r},()=>{this.filterLineClass()})}render(){var r=this.state.opsList,n=this.props,s=n.t,i=n.isPreview,u=n.defaultValue,f=u.relate_course,N=u.relate_course_list,Y=u.user_has_attendanted,J=f&&N&&N.length>0&&!i,se=localStorage.getItem("themeColor")||"#465dcd";return t().createElement("div",{className:"correlation-content"},t().createElement("div",{className:"correlation-content-label"},t().createElement(p.Z,null,t().createElement(c.Z,{placement:"topLeft",title:f?"":this.disabledOpenSwitch()?s("attendance.noLineClass"):s("attendance.noRelatedLineClass"),getPopupContainer:()=>document.querySelector(".correlation-content-label")},t().createElement(ws.Z,{disabled:this.disabledOpenSwitch(),checked:f,onChange:this.onChange})),t().createElement("span",null," ",s("attendance.connectAttendanceTips")))),f&&t().createElement("div",{className:"correlation-content-value"},t().createElement(tn.Z,{allowClear:!1,disabled:i,mode:"multiple",style:{width:"90%"},placeholder:s("attendance.selectLineClass"),defaultValue:this.formateDefault,onChange:Ce=>this.handleChange(Ce)},r.map(Ce=>t().createElement(wr,{key:Ce.name,value:Ce.key,disabled:Y&&this.disabledHadAttendanted(Ce.key)},t().createElement(p.Z,{className:"correlation-content-options"},t().createElement("span",null,Ce.data.title),t().createElement("span",null,"".concat(Ee()(Ce.data.dateRange.startTime).format("YYYY-MM-DD HH:mm"),"~").concat(Ee()(Ce.data.dateRange.endTime).format("YYYY-MM-DD HH:mm"))))))),t().createElement("div",{style:{color:J?se:"#D3D3D6"},className:J?"is-auto-click":"not-auto-click",onClick:J&&this.onHandleClick},s("attendance.autoCreateTime"))))}}var Br=()=>({}),Wr=(0,h.$j)(Br)((0,m.$j)((0,E.Z)()(Ur)));class Kr extends t().Component{constructor(r){super(r);this.onChange=n=>{this.props.formik.setFieldValue("remind_directors",n.target.checked)},this.onHandleChange=n=>{this.props.formik.setFieldValue("advance_minute",n)},this.controlNum=n=>n||0,this.state={}}render(){var r=this.props,n=r.t,s=r.isPreview,i=r.defaultValue;return t().createElement("div",{className:"message-content"},t().createElement(p.Z,null,t().createElement(T.Z,{disabled:s,defaultChecked:!0,checked:i.remind_directors&&i.remind_directors!=="false",onChange:this.onChange}),t().createElement("div",{className:"message-content-tip"},n("attendance.tipAttendanceOfficer"))),t().createElement("div",null,t().createElement(p.Z,null,t().createElement("span",null,n("attendance.pxBefore")),t().createElement(X.Z,{min:0,max:999,precision:0,disabled:!i.remind_directors||i.remind_directors==="false"||s,defaultValue:i.advance_minute,style:{width:"80px"},formatter:this.controlNum,parser:this.controlNum,onChange:this.onHandleChange}),t().createElement("span",null,n("attendance.fzTips")))))}}var $r=()=>({}),Vr=(0,h.$j)($r)((0,m.$j)((0,E.Z)()(Kr))),jr=(0,Ke.Z)(Bn),zr=(0,Ke.Z)(Vs),Yr=(0,Ke.Z)(Fr),Qr=(0,Ke.Z)(Wr),Gr=(0,Ke.Z)(Vr),vd=null,Hr=(0,ve.me)(),un=ke.Z[Hr].attendance,In={name:Z=>(0,ve.fy)(Z)?"":un.pleaseEnterAttendanceName,directors:Z=>!Z||!Z.length?un.pleaseSelectOfficer:"",relateCourse:Z=>{var r=Z.values,n=r.relate_course,s=r.relate_course_list;return n&&!s.length?un.pleaseSelectConnectLine:""},attendanceTimeSet:Z=>{var r=Z.values,n=r.sign_in_begin_time,s=r.sign_out_begin_time,i=r.signInStatus,u=r.signOutStatus;if(!i&&!u)return un.pleaseSelectTimeLimit;if(i&&!n)return un.pleaseSelectSignTime;if(u&&!s)return un.pleaseSelectSignOutTime}},Xr=e(94406),Hs=e.n(Xr),Jr=e(81618),qr=e.n(Jr),gn,$n=()=>qr().load({key:"712584e4a90daa5602b025ab82b8bf7a",version:"2.0",plugins:["AMap.Autocomplete","AMap.PlaceSearch","AMap.Geocoder","AMap.Marker","AMap.Geolocation","AMap.Pixel","AMap.DistrictLayer","AMap.Map","AMap.LabelsLayer","AMap.ToolBar","AMap.Scale","AMap.LabelMarker"]}).catch(Z=>{console.error(Z)}),ei=(Z,r)=>{$n().then(n=>{n.plugin(["AMap.PlaceSearch","AMap.AutoComplete"],function(){var s={input:Z},i=new n.AutoComplete(s),u=new n.PlaceSearch({map:gn});i.on("select",f);function f(N){if(u.setCity(N.poi.adcode),u.search(N.poi.name),!!N){var Y=N.poi,J=Y.location,se=Y.name,Ce=J.lng,Xe=J.lat;r&&r(se,Ce,Xe)}}})})},ti=(Z,r,n)=>$n().then(s=>{gn=new s.Map(Z,{resizeEnable:!0});var i=new s.Marker;return i.setMap(gn),r.longitude&&r.latitude&&(n(r.longitude,r.latitude),i.setPosition([parseFloat(r.longitude),parseFloat(r.latitude)]),gn.setFitView()),{map:gn,mark:i}}).catch(()=>{D.default.error("map loading error")}),ai=(Z,r)=>{Z.map.on("click",n=>{var s=n.lnglat,i=s.lng,u=s.lat;r(i,u)})},si=e(58701),Zn=e.n(si),ni=Z=>{var r=Z.t,n=Z.title,s=n===void 0?"":n,i=Z.visible,u=i===void 0?!1:i,f=Z.value,N=f===void 0?{address:"",longitude:"",latitude:"",sign_range:500}:f,Y=Z.onConfirm,J=Y===void 0?()=>{}:Y,se=Z.onCancel,Ce=se===void 0?()=>{}:se,Xe=(0,l.useState)("map-container-".concat(Date.now())),ot=(0,Be.Z)(Xe,1),He=ot[0],dt=(0,l.useState)("map-container-search-".concat(Date.now())),it=(0,Be.Z)(dt,1),Dt=it[0],Qe=(0,l.useState)(N.address),ft=(0,Be.Z)(Qe,2),kt=ft[0],xt=ft[1],Rt=(0,l.useState)(N.longitude),qt=(0,Be.Z)(Rt,2),Pa=qt[0],sa=qt[1],ba=(0,l.useState)(N.latitude),oa=(0,Be.Z)(ba,2),Yt=oa[0],Ta=oa[1],Ya=(0,l.useState)(!1),va=(0,Be.Z)(Ya,2),Qa=va[0],gs=va[1],Aa=(0,l.useState)(!1),ls=(0,Be.Z)(Aa,2),Ja=ls[0],ds=ls[1],Ps=(0,l.useState)(N.address),ns=(0,Be.Z)(Ps,2),cs=ns[0],vs=ns[1],os=(0,l.useRef)({map:{setFitView:()=>{},on:()=>{},off:()=>{},destroy:()=>{}},mark:{setPosition:()=>{}}}),Ea=(0,l.useRef)({overlay:null}),la=(0,l.useCallback)((ra,Ye)=>{$n().then(vt=>{var It=new vt.Geocoder({extensions:"all",radius:200});It.getAddress(ra,(nt,tt)=>{if(!(Ye&&kt)){if(nt==="complete"&&tt.regeocode){if(xt(tt.regeocode.formattedAddress),vs(tt.regeocode.formattedAddress),Ea.current.overlay)Ea.current.overlay.setCenter([ra[0],ra[1]]),Ea.current.overlay.setRadius(N.sign_range||500);else{var Ot=new vt.Circle({center:new vt.LngLat(ra[0],ra[1]),radius:N.sign_range||500,fillColor:"#abb6ef",strokeColor:"#fff",strokeWeight:2});os.current.map.add(Ot),os.current.map.setFitView([Ot]),Ea.current.overlay=Ot}return}xt(""),vs(""),sa(""),D.default.error(r("attendance.mapSearchError"))}})})},[kt,Ea]),es=(0,l.useCallback)((ra,Ye,vt)=>{sa("".concat(ra)),Ta("".concat(Ye)),la([ra,Ye],vt),os.current.mark.setPosition([ra,Ye]),os.current.map.setFitView()},[la]),ea=(0,l.useCallback)(ra=>{vs(ra.target.value)},[]),Da=(0,l.useCallback)(()=>{J({address:kt,longitude:Pa,latitude:Yt})},[Yt,Pa,J,cs]),Bt=(0,l.useCallback)(()=>{Ta(N.latitude),sa(N.longitude),xt(N.address),Ce()},[Ce,N.address,N.latitude,N.longitude]);return(0,l.useEffect)(()=>{!u||Qa||ti(He,N,(ra,Ye)=>es(ra,Ye)).then(ra=>{gs(!0),setTimeout(()=>{ds(!0)},2e3),os.current=ra,ei(Dt,(Ye,vt,It)=>{vt?(vs(Ye),es(vt,It)):sa("")}),ai(ra,(Ye,vt)=>{es(Ye,vt)})})},[u]),(0,l.useEffect)(()=>()=>{os.current.map.off("click"),os.current.map.destroy()},[]),t().createElement(La.ZP,{title:s||r("attendance.modalTip"),visible:u,width:1100,onCancel:Bt,wrapClassName:Zn().wrap,centered:!0,footer:t().createElement(t().Fragment,null,t().createElement(y.Z,{onClick:Bt},r("common.cancel")),t().createElement(y.Z,{type:"primary",onClick:Da,disabled:!Pa},r("common.ok")))},(!Qa||!Ja)&&t().createElement("div",{className:Zn().message}," Loading"),t().createElement("div",{id:He,className:Zn().map},t().createElement(p.Z,{size:14,className:Zn().top},t().createElement(de.Z.Search,{id:Dt,value:cs,onChange:ea,placeholder:r("attendance.addressPlaceHolder"),allowClear:!0}))))},ri=(0,E.Z)()(ni),ii=e(52571),js=e.n(ii),li=Z=>{var r=Z.t,n=Z.isPreview,s=n===void 0?!1:n,i=Z.defaultValue,u=i===void 0?{address:"",longitude:"",latitude:"",address_detail:"",sign_range:500}:i,f=Z.formik,N=(0,l.useMemo)(()=>()=>localStorage.getItem("themeColor")||"#465dcd",[]),Y=(0,l.useState)(!1),J=(0,Be.Z)(Y,2),se=J[0],Ce=J[1],Xe=(0,l.useState)(""),ot=(0,Be.Z)(Xe,2),He=ot[0],dt=ot[1],it=(0,l.useState)(""),Dt=(0,Be.Z)(it,2),Qe=Dt[0],ft=Dt[1],kt=(0,l.useState)(N),xt=(0,Be.Z)(kt,2),Rt=xt[0],qt=xt[1],Pa=(0,l.useState)(u.sign_range||500),sa=(0,Be.Z)(Pa,2),ba=sa[0],oa=sa[1],Yt=(0,l.useCallback)(()=>{s||Ce(!0)},[s,ba]),Ta=(0,l.useCallback)(()=>{Ce(!1)},[]),Ya=(0,l.useCallback)(Ja=>{f.setFieldValue("address",Ja.address),f.setFieldValue("longitude",Ja.longitude),f.setFieldValue("latitude",Ja.latitude),Ce(!1)},[]),va=Ja=>{f.setFieldValue("address_detail",Ja.target.value)},Qa=Ja=>Ja||500,gs=Ja=>{f.setFieldValue("sign_range",Ja),oa(Ja)},Aa=()=>{f.setFieldValue("address",""),f.setFieldValue("longitude",""),f.setFieldValue("latitude","")};(0,l.useEffect)(()=>{u.address?(dt(r("attendance.onlyOneAddress")),ft(u.address_detail),qt("#666")):(dt(""),ft(r("attendance.noAddress")),qt(N))},[u.address]);var ls=()=>t().createElement("span",{className:js()["map-icon"]},t().createElement(S.Z,{iconClass:"icon-dingwei",size:"12px",color:Rt}));return t().createElement(t().Fragment,null,t().createElement("div",{className:js()["location-select"]},t().createElement("div",{className:js()["map-icon"]},t().createElement(c.Z,{title:He},t().createElement(y.Z,{onClick:Yt,icon:ls(),disabled:u.address||s},r("attendance.addAddress")))),u.address?t().createElement(t().Fragment,null,t().createElement("div",{className:js()["map-address"]},t().createElement(c.Z,{title:u.address},t().createElement("div",{className:js().address},(0,F.get)(u,"address"))),t().createElement("div",{className:js().opt},t().createElement("span",{onClick:Yt,className:js()["opt-item"]},r("common.edit")),t().createElement("span",{onClick:Aa,className:js()["opt-item"]},r("common.delete")))),t().createElement("div",{className:js()["detail-address"]},t().createElement("label",{className:js().label},r("attendance.detailAddress")),t().createElement(c.Z,{title:Qe},t().createElement(de.Z.TextArea,{placeholder:r("attendance.detailAddressPlaceholder"),autoSize:!0,maxLength:64,disabled:!u.address||s,allowClear:!1,onChange:va,defaultValue:u.address_detail}))),t().createElement("div",{className:js()["attendance-fence"]},t().createElement("div",null,t().createElement(p.Z,null,t().createElement("label",null,r("attendance.availableRange")),t().createElement(X.Z,{min:500,max:1e4,precision:0,disabled:!u.address||s,value:u.sign_range||500,style:{width:"80px"},formatter:Qa,parser:Qa,onChange:gs}),t().createElement("span",null,r("attendance.meter")))))):null),se?t().createElement(ri,{visible:se,value:(0,v.Z)((0,v.Z)({},u),{},{sign_range:ba}),onCancel:Ta,onConfirm:Ya}):null)},oi=(0,Ke.Z)((0,m.$j)((0,E.Z)()(li)));class di extends t().Component{constructor(r){super(r);this.cancelIsAuto=()=>{this.setState({isAuto:!1})},this.initRef=n=>{this.formRef=n},this.state={isAuto:!1}}componentDidMount(){this.props.onFormMounted(this.formRef)}render(){var r=this.props,n=r.t,s=r.tabPanes,i=r.activeTab,u=r.initData,f=r.isPreview,N=r.isAttendance,Y=this.state.isAuto,J={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}};return t().createElement(t().Fragment,null,t().createElement("div",{className:"".concat(Hs()["offline-train-form"]," form-page-aside form-page-right")},t().createElement(m.J9,{className:"offline-train-form",ref:this.initRef,initialValues:u,onSubmit:this.props.onSubmit,render:se=>t().createElement(m.l0,null,t().createElement(m.gN,(0,b.Z)({name:"name",isPreview:f,colon:!1,label:t().createElement("span",{className:Hs()["formik-label-title"]},n("attendance.attendanceName")," :"),required:!0,type:"text",defaultValue:se.values.name,component:We.Z,maxLength:64,style:{width:"90%"},validate:Ce=>In.name(Ce),placeholder:n("lineClass.attendanceNamePlaceholder")},J)),t().createElement(m.gN,(0,b.Z)({name:"relate_course",isPreview:f,colon:!1,label:t().createElement("span",{className:Hs()["formik-label-title"]},n("attendance.connectLine")," :"),defaultValue:se.values,displayType:"Custom",component:Qr,validate:()=>In.relateCourse(se),tabPanes:s,activeTab:i,isAttendance:N},J)),t().createElement(m.gN,(0,b.Z)({name:"signInStatus",isPreview:f,colon:!1,label:t().createElement("span",{className:Hs()["formik-label-title"]},n("attendance.attendanceTimeLimit")," :"),validate:()=>In.attendanceTimeSet(se),required:!0,displayType:"Custom",defaultValue:se.values,component:jr,isAuto:Y,tabPanes:s,activeTab:i,cancelIsAuto:this.cancelIsAuto},J)),t().createElement(m.gN,(0,b.Z)({name:"directors",isPreview:f,colon:!1,label:t().createElement("span",{className:Hs()["formik-label-title"]},n("attendance.attendanceOfficer")," :"),required:!0,validate:Ce=>In.directors(Ce),displayType:"Custom",component:zr},J)),t().createElement(m.gN,(0,b.Z)({name:"qrcode_type",isPreview:f,colon:!1,label:t().createElement("span",{className:Hs()["formik-label-title"]},n("attendance.dynicQrCode")," :"),displayType:"Custom",component:Yr},J)),t().createElement(m.gN,(0,b.Z)({name:"address",isPreview:f,colon:!1,label:t().createElement("span",{className:Hs()["formik-label-title"]},n("attendance.address")," :"),displayType:"Custom",defaultValue:se.values,component:oi},J)),t().createElement(m.gN,(0,b.Z)({name:"remind_directors",isPreview:f,colon:!1,label:t().createElement("span",{className:Hs()["formik-label-title"]},n("attendance.messageTip")," :"),displayType:"Custom",defaultValue:se.values,component:Gr},J)))})))}}var ci=()=>({}),ui=(0,h.$j)(ci)((0,E.Z)()(di)),mi={size:"oversized",destroyOnClose:!0,bodyStyle:{padding:"0"},maskClosable:!1,wrapClassName:"attendance-modal"},Cs={};class pi extends t().Component{constructor(r){var n;super(r);n=this,this.onFormMounted=s=>{Cs=s},this.onCancel=()=>{var s=this.props.onCancel;this.setState({closeVisible:!0}),s&&this.props.onCancel()},this.onCommit=()=>{this.setState({closeVisible:!0},()=>{Cs.submitForm()})},this.onSubmit=s=>{var i=this.translateTime(new Date().getTime());s.sign_in_begin_time&&this.translateTime(Ee()(s.sign_in_begin_time).valueOf())<i||s.sign_out_begin_time&&this.translateTime(Ee()(s.sign_out_begin_time).valueOf())<i?ae.Z.confirm({title:this.props.t("attendance.saveTipAboutPastTime"),icon:t().createElement(z.Z,null),onOk:()=>{this.submitForm(s)}}):this.submitForm(s)},this.translateTime=s=>Ee()(s).startOf("minute").unix()*1e3,this.submitForm=function(){var s=(0,K.Z)(d().mark(function i(u){var f,N,Y,J,se,Ce,Xe,ot;return d().wrap(function(dt){for(;;)switch(dt.prev=dt.next){case 0:n.setState({showForm:!1}),n.props.onOk&&(f=n.state.editInfoObj,N={id:f.id?f.id:"",type:"attendance",key:f.id?f.id:f.key?f.key:"attendance".concat(new Date().getTime()),name:u.name,componentName:"Attendance",icon:$.e1.attendance,data:(0,v.Z)((0,v.Z)({},u),{},{relate_course_list:u.relate_course?u.relate_course_list:[],sign_in_begin_time:u.sign_in_begin_time?Ee()(u.sign_in_begin_time).valueOf():"",sign_in_end_time:u.sign_in_end_time?Ee()(u.sign_in_end_time).valueOf():"",sign_out_begin_time:u.sign_out_begin_time?Ee()(u.sign_out_begin_time).valueOf():"",sign_out_end_time:u.sign_out_end_time?Ee()(u.sign_out_end_time).valueOf():""})},N.data.address||(N.data.sign_range=500,N.data.address_detail="",N.data.latitude="",N.data.longitude=""),Y=localStorage.getItem("authorityType"),n.props.appType==="wx_app"&&Y==="1"&&(N.data.qy_we_chat_vo=u.qy_we_chat_vo),n.state.closeVisible||(D.default.success(n.props.t("common.saveSuccess")),J=n.props,se=J.userId,Ce=J.userName,Xe=J.syncUserId,ot=J.sourceType,Cs.setFieldValue("name",""),Cs.setFieldValue("remind_directors",!1),Cs.setFieldValue("advance_minute",15),Cs.setFieldValue("relate_course",!1),Cs.setFieldValue("relate_course_list",[]),Cs.setFieldValue("qrcode_type","statics"),Cs.setFieldValue("sign_in_begin_time",""),Cs.setFieldValue("sign_in_end_time",""),Cs.setFieldValue("sign_out_begin_time",""),Cs.setFieldValue("sign_out_end_time",""),Cs.setFieldValue("signInStatus",!0),Cs.setFieldValue("signOutStatus",!1),Cs.setFieldValue("directors",[{id:se,user_name:Ce,name:Ce,sync_user_id:Xe,sync_source_type:ot}]),Cs.setFieldValue("id",""),Cs.setFieldValue("address",""),Cs.setFieldValue("longitude",""),Cs.setFieldValue("latitude",""),Cs.setFieldValue("address_detail",""),Cs.setFieldValue("sign_range",500),n.setState({initData:n.getInitData(!0),editInfoObj:{}},()=>{n.setState({showForm:!0})})),n.props.onOk(N,n.state.closeVisible));case 2:case"end":return dt.stop()}},i)}));return function(i){return s.apply(this,arguments)}}(),this.handleSaveNext=()=>{this.setState({closeVisible:!1},()=>{Cs.submitForm()})},this.getInitData=s=>{var i=this.props,u=i.userId,f=i.userName,N=i.syncUserId,Y=i.sourceType,J={name:"",directors:[{id:u,user_name:f,name:f,user_id:N,source_type:Y}],remind_directors:!1,advance_minute:15,qrcode_type:"statics",relate_course:!1,relate_course_list:[],signInStatus:!0,signOutStatus:!1,sign_in_begin_time:"",sign_in_end_time:"",sign_out_begin_time:"",sign_out_end_time:"",user_has_attendanted:!1,address:"",longitude:"",latitude:"",address_detail:"",sign_range:500};if(s)return J;var se=this.props.editInfo.data||{};if(se.name){var Ce=[];se.relate_course_list.map(ot=>{Ce.push((0,v.Z)((0,v.Z)({},ot),{},{course_key:ot.course_id||ot.course_key}))});var Xe=(0,v.Z)({},Ga()((0,v.Z)((0,v.Z)({},se),{},{sign_in_begin_time:se.sign_in_begin_time||"",sign_in_end_time:se.sign_in_end_time||"",sign_out_begin_time:se.sign_out_begin_time||"",sign_out_end_time:se.sign_out_end_time||"",signInStatus:!!se.sign_in_begin_time,signOutStatus:!!se.sign_out_begin_time,relate_course_list:Ce})));return Xe}return J},this.renderFooter=()=>{var s=this.props,i=s.t,u=s.isPreview;return t().createElement(t().Fragment,null,t().createElement(y.Z,{type:"default",onClick:this.onCancel},i("common.cancel")),!u&&t().createElement(y.Z,{type:"default",onClick:()=>this.handleSaveNext()},i("lineClass.saveNextAdd")),!u&&t().createElement(y.Z,{type:"primary",onClick:()=>this.onCommit()},i("common.save")))},this.state={title:r.t("component.attendance"),initData:{},showForm:!1,closeVisible:!0,editInfoObj:{}}}componentDidUpdate(r){r.visible!==this.props.visible&&this.props.visible&&this.setState({initData:this.getInitData(),editInfoObj:this.props.editInfo},()=>{this.setState({showForm:!0})})}render(){var r=this.props,n=r.tabPanes,s=r.activeTab,i=r.isPreview,u=r.isAttendance,f=this.state,N=f.initData,Y=f.showForm,J=f.closeVisible;return t().createElement(La.ZP,(0,b.Z)({},mi,{footerType:"custom",visible:this.props.visible,title:this.state.title,onCancel:this.onCancel,onOk:()=>this.onCommit(),renderCustomFooter:this.renderFooter}),t().createElement("div",{className:"offline-train"},Y&&t().createElement(ui,{isPreview:i,onFormMounted:this.onFormMounted,onSubmit:this.onSubmit,tabPanes:n,activeTab:s,initData:N,isAttendance:J?u:!1,ref:se=>this.formRef=se})))}}var hi=Z=>({userId:Z.user.id,userName:Z.user.name,syncUserId:Z.user.account,sourceType:Z.user.sourceType,appType:Z.user.appType}),Vn=(0,h.$j)(hi)((0,E.Z)()(pi));class vi extends l.Component{constructor(){super(...arguments);this.state={iptValue:this.props.defaultValue,maxLimitNum:this.props.maxLength,publicRemnant:this.props.maxLength},this.initPublicRemnant=()=>{var r=this.state,n=r.iptValue,s=r.maxLimitNum,i=s-n.length;this.setState({publicRemnant:i})},this.handleInput=r=>{if(r&&typeof r=="string"){var n=this.state.maxLimitNum,s=r.length>n?n:r.length,i=n-s;this.setState({publicRemnant:i},()=>{this.props.formik.setFieldValue("requirement",r)})}}}componentDidMount(){var r=this.state,n=r.iptValue,s=r.maxLimitNum;n.length>s?(this.setState({iptValue:n.substring(0,s)}),this.setState({iptValue:n.substring(0,s)},()=>{this.initPublicRemnant()})):this.initPublicRemnant()}render(){var r=this.state,n=r.iptValue,s=r.publicRemnant,i=r.maxLimitNum;return t().createElement("div",{className:"assessment-requirement-container"},t().createElement(qe.Z,(0,b.Z)({},this.props,{defaultValue:n,onInput:this.handleInput})),t().createElement("span",{className:"remnant"},s,"/",i))}}var fi=(0,m.$j)(vi),gi=tn.Z.Option;class Ei extends l.Component{constructor(){super(...arguments);this.state={classify:[]},this.getClassify=()=>{var r=$.ZP.StudyProjectWithAssessment.getResourceClassify();W.WY.get({url:r}).then(n=>{var s;!n.data||this.setState({classify:(n==null||(s=n.data)===null||s===void 0?void 0:s.list)||[]})})},this.handleChangeClassify=r=>{this.props.formik.setFieldValue("assessmentType",r)}}componentDidMount(){this.getClassify()}render(){var r=this.props.value,n=this.state.classify;return t().createElement("div",null,t().createElement(tn.Z,{style:{width:260},defaultValue:r,onChange:this.handleChangeClassify},n.map(s=>t().createElement(gi,{value:s.id,key:s.id},s.name))))}}var _i=(0,m.$j)(Ei);class Ci extends l.Component{constructor(){super(...arguments);this.onChange=r=>{this.props.onFieldChange(r)}}render(){var r=this.props,n=r.isPreview,s=r.value,i=r.t;return t().createElement(ws.Z,{checkedChildren:i("common.open"),unCheckedChildren:i("common.close"),defaultChecked:!0,disabled:n,checked:s,onChange:this.onChange})}}var yi=(0,m.$j)((0,E.Z)()(Ci)),jn=Z=>Z===""||Z==null?!1:!isNaN(Z)&&typeof Z=="number",mn=Z=>Z&&Z.toString().replace(/[^\d]+/g,"");class Ti extends l.Component{constructor(){super(...arguments);this.state={starMin:0},this.handleChangeValue=(r,n)=>{var s=this.props,i=s.value,u=s.onChange;u((0,v.Z)((0,v.Z)({},i),{},{[n]:r}))}}render(){var r=this.state.starMin,n=this.props,s=n.t,i=n.disabled,u=n.value,f=n.max;return t().createElement("div",{className:"unlock-time-region"},t().createElement(X.Z,{className:"item-gap",min:r,step:1,max:f,disabled:i,formatter:mn,parser:mn,value:u.begin_time_unlock,onChange:N=>this.handleChangeValue(N,"begin_time_unlock")}),t().createElement("span",{className:"unlock-time-region-split"},"-"),t().createElement(X.Z,{className:"item-gap",min:u.begin_time_unlock+1,step:1,max:f+1,disabled:i,formatter:mn,parser:mn,value:u.end_time_unlock,onChange:N=>this.handleChangeValue(N,"end_time_unlock")}),t().createElement("span",{className:"unlock-time-region-name"},s("common.day")),t().createElement("span",{className:"unlock-time-region-labels"},s("assessment.unlockTips")))}}var Si=(0,E.Z)()(Ti);class Pi extends l.Component{constructor(){super(...arguments);this.onSwitchChange=(r,n)=>{var s=this.props.value;s[n]=r,this.props.onFieldChange(s)},this.handleUnlockTimeValue=r=>{var n=this.props.value;n.begin_time_unlock=r.begin_time_unlock,n.end_time_unlock=r.end_time_unlock,this.props.onFieldChange(n)}}render(){var r=this.props,n=r.t,s=r.value,i=r.disabled,u=r.max;return t().createElement("div",{className:"unlock-time-con"},t().createElement(ws.Z,{checkedChildren:n("common.open"),unCheckedChildren:n("common.close"),defaultChecked:!0,disabled:i,checked:s.is_lock,onChange:f=>this.onSwitchChange(f,"is_lock")}),s.is_lock&&t().createElement(Si,{value:{begin_time_unlock:s.begin_time_unlock,end_time_unlock:s.end_time_unlock},max:u,onChange:this.handleUnlockTimeValue,disabled:i||!s.is_lock}))}}var Di=(0,m.$j)((0,E.Z)()(Pi));function bi(Z){var r=$.ZP.EditQuestionnaire.getQuestionnaireInfo(Z.id);return W.WY.get({url:r})}class Oi extends l.Component{constructor(){var r;super(...arguments);r=this,this.getQuestionnaireInfoData=function(){var n=(0,K.Z)(d().mark(function s(i){var u,f,N;return d().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:return J.prev=0,J.next=3,bi(i);case 3:u=J.sent,f=u.data.questions,N=f.filter(se=>se.type==="single"),N.length===0&&r.props.formik.setFieldValue("passStandard",{is_passed_standards:!1,is_passed_option_three:!1,selected_standard_list:"",pass_standards_number:""}),r.props.formik.setFieldValue("questionnaire",(0,v.Z)((0,v.Z)({},r.props.formik.values.questionnaire),{},{singleList:N})),r.props.formik.setFieldTouched("questionnaire",!0,!0),J.next=13;break;case 11:J.prev=11,J.t0=J.catch(0);case 13:case"end":return J.stop()}},s,null,[[0,11]])}));return function(s){return n.apply(this,arguments)}}(),this.handleSelect=n=>{this.getQuestionnaireInfoData(n)}}render(){return t().createElement(pt,(0,b.Z)({},this.props,{onSelect:this.handleSelect}))}}var Ii=(0,m.$j)(Oi);class Zi extends l.Component{constructor(){super(...arguments);this.onDaysChange=(r,n,s)=>{this.props.onChangeDays(r,n,s)},this.onCheckboxChange=(r,n,s)=>{this.props.onChange(r,n,s)}}render(){var r=this.props,n=r.keyName,s=r.remind_days,i=r.repeat_remind,u=r.no_remind,f=r.disabled,N=r.remindTitle,Y=r.remindUnit,J=r.repeatTitle,se=r.noRepeatTitle,Ce=f;return t().createElement("div",{className:"assess-reminder-stage"},t().createElement("div",{className:"reminder-container"},t().createElement("span",{className:"title"},N),t().createElement(X.Z,{min:0,step:1,max:999,disabled:Ce||u,formatter:mn,parser:mn,value:s,onChange:Xe=>this.onDaysChange(Xe,n,"remind_days")}),t().createElement("span",{className:"day"},Y)),t().createElement("div",{className:"checkbox-container"},t().createElement(T.Z,{disabled:Ce,checked:i,onChange:Xe=>this.onCheckboxChange(Xe,n,"repeat_remind")},J)),t().createElement("div",{className:"checkbox-container"},t().createElement(T.Z,{disabled:Ce,checked:u,onChange:Xe=>this.onCheckboxChange(Xe,n,"no_remind")},se)))}}var zn=Zi;class Li extends l.Component{constructor(){super(...arguments);this.onChangeDays=(r,n,s)=>{var i=this.props.value;this.props.onFieldChange((0,v.Z)((0,v.Z)({},i),{},{[n]:(0,v.Z)((0,v.Z)({},i[[n]]),{},{[s]:r})}))},this.onChange=(r,n,s)=>{var i=this.props.value;this.props.onFieldChange((0,v.Z)((0,v.Z)({},i),{},{[n]:(0,v.Z)((0,v.Z)({},i[[n]]),{},{repeat_remind:!1,no_remind:!1,[s]:r.target.checked})}))}}render(){var r=this.props,n=r.t,s=r.disabled,i=r.value,u=i.before_start,f=i.before_end,N=i.after_end;return t().createElement("div",{className:"assess-reminder"},t().createElement(zn,(0,b.Z)({keyName:"before_start"},u,{disabled:s,remindTitle:n("assessment.beforeStart"),remindUnit:n("common.day"),repeatTitle:n("assessment.repeatReminder"),noRepeatTitle:n("assessment.noReminder"),onChangeDays:this.onChangeDays,onChange:this.onChange})),t().createElement(zn,(0,b.Z)({keyName:"before_end"},f,{disabled:s,remindTitle:n("assessment.beforeEnd"),remindUnit:n("common.day"),repeatTitle:n("assessment.repeatReminder"),noRepeatTitle:n("assessment.noReminder"),onChangeDays:this.onChangeDays,onChange:this.onChange})),t().createElement(zn,(0,b.Z)({keyName:"after_end"},N,{disabled:s,remindTitle:n("assessment.afterEnd"),remindUnit:n("common.day"),repeatTitle:n("assessment.repeatReminder"),noRepeatTitle:n("assessment.noReminder"),onChangeDays:this.onChangeDays,onChange:this.onChange})))}}var xi=(0,m.$j)((0,E.Z)()(Li)),fd=tn.Z.Option;class Ni extends l.Component{constructor(){super(...arguments);this.state={optionStatusKnow:!1,optionStatusComplete:!1,optionsList:[{id:"1",title:this.props.t("assessment.optionOne")},{id:"2",title:this.props.t("assessment.optionTwo")},{id:"3",title:this.props.t("assessment.optionThree")}]},this.onChangStatus=(r,n,s)=>{var i=this.props.value;i[n]=r.target.checked,this.props.onFieldChange(i),i[n]||(i[s]="")},this.onNumChange=(r,n)=>{var s=this.props.value;s[n]=r,this.props.onFieldChange(s)},this.controlNum=r=>{var n=/^(\-)*(\d+)\.(\d\d).*$/;return typeof r=="string"?isNaN(Number(r))?"":r.replace(n,"$1$2.$3"):typeof r=="number"?isNaN(r)?"":String(r).replace(n,"$1$2.$3"):""}}render(){var r=this.state,n=r.optionsList,s=r.optionStatusKnow,i=r.optionStatusComplete,u=this.props,f=u.t,N=u.isPreview,Y=u.value,J=Y.is_passed_standards,se=Y.pass_standards_number,Ce=Y.is_passed_option_three,Xe=Y.pass_standard_conditions,ot=this.props.formik.values.questionnaire,He=ot.id,dt=ot.singleList;return t().createElement("div",{className:"pass-standard"},t().createElement("div",null,t().createElement(T.Z,{checked:J,disabled:N||He&&!dt.length,onChange:it=>this.onChangStatus(it,"is_passed_standards","pass_standard_conditions")}),t().createElement(de.Z,{disabled:!0,value:f("assessment.dontKnow"),style:{width:180,color:"#000000"},className:"disabled-option"}),t().createElement("span",null,"\u2264"),t().createElement(X.Z,{min:0,max:100,disabled:!J,className:"disabled-option",value:Xe,formatter:this.controlNum,parser:this.controlNum,onChange:it=>this.onNumChange(it,"pass_standard_conditions")}),t().createElement("span",null,"%")),t().createElement(T.Z,{checked:Ce,disabled:N||He&&!dt.length,onChange:it=>this.onChangStatus(it,"is_passed_option_three","pass_standards_number")}),t().createElement(de.Z,{disabled:!0,value:f("assessment.independently"),style:{width:180,color:"#000000"},className:"disabled-option"}),t().createElement("span",null,"\u2265"),t().createElement(X.Z,{min:0,max:100,disabled:!Ce,className:"disabled-option",value:se,formatter:this.controlNum,parser:this.controlNum,onChange:it=>this.onNumChange(it,"pass_standards_number")}),t().createElement("span",null,"%"))}}var Mi=(0,m.$j)((0,E.Z)()(Ni)),ki=fi,Ai=(0,Ke.Z)(_i),Ri=(0,Ke.Z)(yi),Fi=(0,Ke.Z)(Di),wi=Ii,Ui=(0,Ke.Z)(xi),Bi=(0,Ke.Z)(Mi),Wi=(0,ve.me)(),zs=ke.Z[Wi].assessment,an={checkName:Z=>((0,ve.fy)(Z)?"":zs.assessmentNameRequired)||((0,ve.fy)(Z).length>60?zs.assessmentNameLimit:""),checkRequirement:Z=>(0,ve.fy)(Z)?"":zs.assessmentRequireRequired,checkType:Z=>Z?"":zs.assessmentTypeRequired,checkUnlockTime:Z=>Z.is_lock?!jn(Z.begin_time_unlock)||!jn(Z.end_time_unlock)?zs.unlockTimeRequired:Z.begin_time_unlock>=Z.end_time_unlock?zs.unlockTimeLimit:"":"",checkQuestionnaire:Z=>{var r=Z.id,n=Z.singleList;if(!r)return zs.assessmentFormRequired;if(n.length!==0){var s=n.filter(i=>i.options.length===3);if(s.length!==n.length)return zs.questionnaireLimit}},checkReminder:Z=>{var r=Z.values.remind,n=!1;if(Object.keys(r).forEach(s=>{var i=r[s];if(!i.no_remind&&!jn(i.remind_days)){n=!0;return}}),n)return zs.assessmentRemindRequired},checkPassStandard:Z=>{var r=Z.values,n=r.passStandard,s=r.questionnaire.singleList,i=n.pass_standards_number,u=n.is_passed_standards,f=n.is_passed_option_three,N=n.pass_standard_conditions;if(u&&(N===null||N===""||N===void 0)||f&&(i===null||i===""||i===void 0))return zs.passStandardRequired}};class Ki extends l.Component{constructor(){super(...arguments);this.initRef=r=>{this.formRef=r}}componentDidMount(){this.props.onFormMounted(this.formRef)}render(){var r=this.props,n=r.t,s=r.initData,i=r.isPreview,u=r.evaluateAssign,f=r.isEdit,N={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}};return t().createElement(t().Fragment,null,t().createElement("div",{className:"form-page-aside form-page-right"},t().createElement(m.J9,{ref:this.initRef,initialValues:s,onSubmit:this.props.onSubmit,render:Y=>t().createElement(m.l0,{className:"assessment-form"},t().createElement(m.gN,(0,b.Z)({name:"name",label:n("assessment.assessmentName"),component:We.Z,required:!0,type:"text",defaultValue:Y.values.name,style:{width:"90%"},maxLength:60,isPreview:i,placeholder:n("assessment.assessmentNamePlaceholder"),validate:J=>an.checkName(J)},N)),t().createElement(m.gN,(0,b.Z)({name:"requirement",label:n("assessment.assessmentRequire"),component:ki,required:!0,type:"text",defaultValue:Y.values.requirement,style:{width:"90%"},maxLength:500,placeholder:n("assessment.assessmentRequirePlaceholder"),validate:J=>an.checkRequirement(J)},N)),t().createElement(m.gN,(0,b.Z)({name:"assessmentType",label:n("assessment.assessmentType"),component:Ai,required:!0,defaultValue:Y.values.assessmentType,displayType:"Custom",placeholder:n("component.pleaseChoose"),validate:J=>an.checkType(J)},N)),t().createElement(m.gN,(0,b.Z)({name:"studentSelfEvaluate",label:n("assessment.studentSelfAssessment"),component:Ri,isPreview:i||f&&u,defaultValue:Y.values.studentSelfEvaluate,displayType:"Custom"},N)),t().createElement(m.gN,(0,b.Z)({name:"unlockTime",label:n("assessment.unlockTime"),component:Fi,max:998,displayType:"Custom",validate:an.checkUnlockTime},N)),t().createElement(m.gN,(0,b.Z)({name:"questionnaire",label:n("assessment.assessmentForm"),component:wi,required:!0,displayType:"Custom",defaultFieldList:Y.values.questionnaire,btnText:n("assessment.chooseForm"),validate:an.checkQuestionnaire},N)),t().createElement(m.gN,(0,b.Z)({name:"remind",label:n("assessment.assessmentRemind"),component:Ui,required:!0,displayType:"Custom",defaultValue:Y.values.remind,validate:()=>an.checkReminder(Y)},N)),t().createElement(m.gN,(0,b.Z)({name:"passStandard",label:n("assessment.passStandard"),component:Bi,isPreview:i,displayType:"Custom",defaultValue:Y.values.passStandard,validate:()=>an.checkPassStandard(Y)},N)))})))}}var $i=(0,h.$j)()((0,E.Z)()(Ki)),Vi={size:"oversized",destroyOnClose:!0,bodyStyle:{padding:"0"},maskClosable:!1},sr={};class nr extends l.Component{constructor(){var r;super(...arguments);r=this,this.state={initData:{},showForm:!1,closeVisible:!0},this.onFormMounted=n=>{sr=n},this.onCancel=()=>{this.setState({showForm:!1});var n=this.props.onCancel;n&&this.props.onCancel()},this.onCommit=()=>{this.setState({closeVisible:!0},()=>{sr.submitForm()})},this.onSubmit=n=>{var s=this.handleDealFormData(n);if(this.setState({showForm:!this.state.closeVisible}),this.props.onOk){var i=this.props.editInfo,u={id:i.id||"",type:"assess",key:i.id?i.id:i.key?i.key:"assess".concat(new Date().getTime()),name:n.name,componentName:"AddAssessment",icon:$.e1.assess,data:s};this.props.onOk(u,this.state.closeVisible)}},this.handleDealFormData=n=>{var s=n.name,i=n.requirement,u=n.assessmentType,f=n.studentSelfEvaluate,N=n.unlockTime,Y=N.is_lock,J=N.begin_time_unlock,se=N.end_time_unlock,Ce=n.questionnaire,Xe=Ce.id,ot=Ce.name,He=Ce.singleList,dt=n.remind,it=dt.before_start,Dt=it.remind_days,Qe=it.repeat_remind,ft=it.no_remind,kt=dt.before_end,xt=kt.remind_days,Rt=kt.repeat_remind,qt=kt.no_remind,Pa=dt.after_end,sa=Pa.remind_days,ba=Pa.repeat_remind,oa=Pa.no_remind,Yt=n.passStandard,Ta=Yt.is_passed_option_three,Ya=Yt.is_passed_standards,va=Yt.pass_standard_conditions,Qa=Yt.pass_standards_number,gs=500,Aa=i.length>500?i.substring(0,gs):i,ls=Y?{begin_time_unlock:J,end_time_unlock:se}:{},Ja=Ya?{pass_standard_conditions:va,is_passed_standards:Ya}:{is_passed_standards:Ya},ds=Ta?{is_passed_option_three:Ta,pass_standards_number:Qa}:{is_passed_option_three:Ta},Ps=ft?"":Dt,ns=qt?"":xt,cs=oa?"":sa,vs=this.props.creator_user;return(0,v.Z)((0,v.Z)((0,v.Z)((0,v.Z)({name:s,requirement:Aa,resource_id:u,is_lock:Y},ls),{},{is_self_evaluate:f,questionnaire_id:Xe,evaluate_form_title:ot,singleList:He,before_start_day:Ps,before_start_repeat:Qe,before_start_un_remind:ft,before_end_day:ns,before_end_repeat:Rt,before_end_un_remind:qt,after_end_day:cs,after_end_repeat:ba,after_end_un_remind:oa},Ja),ds),{},{creator_user:vs})},this.handleFormatData=function(){var n=(0,K.Z)(d().mark(function s(i){var u,f,N,Y,J,se,Ce,Xe,ot,He,dt,it,Dt,Qe,ft,kt,xt,Rt,qt,Pa,sa,ba,oa,Yt,Ta,Ya,va,Qa;return d().wrap(function(Aa){for(;;)switch(Aa.prev=Aa.next){case 0:return u=i.data,f=u.id,N=u.name,Y=u.requirement,J=u.resource_id,se=u.is_self_evaluate,Ce=u.is_lock,Xe=u.begin_time_unlock,ot=u.end_time_unlock,He=u.questionnaire_id,dt=u.evaluate_form_title,it=u.before_start_day,Dt=u.before_start_repeat,Qe=u.before_start_un_remind,ft=u.before_end_day,kt=u.before_end_repeat,xt=u.before_end_un_remind,Rt=u.after_end_day,qt=u.after_end_repeat,Pa=u.after_end_un_remind,sa=u.is_passed_standards,ba=u.is_passed_option_three,oa=u.pass_standard_conditions,Yt=u.pass_standards_number,Ta=$.ZP.EditQuestionnaire.getQuestionnaireInfo(He),Aa.next=4,W.WY.get({url:Ta});case 4:return Ya=Aa.sent,va=Ya.data.questions,Qa=va.filter(ls=>ls.type==="single"),Aa.abrupt("return",{id:f,name:N,requirement:Y,assessmentType:J,studentSelfEvaluate:se,unlockTime:{is_lock:Ce,begin_time_unlock:Xe,end_time_unlock:ot},questionnaire:{id:He,name:dt,singleList:Qa,disabled:f&&r.props.evaluateAssign},remind:{before_start:{remind_days:it,repeat_remind:Dt,no_remind:Qe},before_end:{remind_days:ft,repeat_remind:kt,no_remind:xt},after_end:{remind_days:Rt,repeat_remind:qt,no_remind:Pa}},passStandard:{is_passed_standards:sa,is_passed_option_three:ba,pass_standard_conditions:oa,pass_standards_number:Yt}});case 8:case"end":return Aa.stop()}},s)}));return function(s){return n.apply(this,arguments)}}(),this.handleSetInitData=n=>{this.setState({initData:n},()=>{this.setState({showForm:!0})})},this.getInitData=()=>({name:"",requirement:"",assessmentType:"",studentSelfEvaluate:!0,unlockTime:{is_lock:!0,begin_time_unlock:"",end_time_unlock:""},questionnaire:{id:"",name:"",singleList:[],disabled:!1},remind:{before_start:{remind_days:"",repeat_remind:!0,no_remind:!1},before_end:{remind_days:"",repeat_remind:!0,no_remind:!1},after_end:{remind_days:"",repeat_remind:!0,no_remind:!1}},passStandard:{is_passed_standards:!0,is_passed_option_three:!0,pass_standard_conditions:"",pass_standards_number:""}}),this.initFormData=()=>{var n=this.props.editInfo||{};n.name?this.handleFormatData(n).then(s=>{this.handleSetInitData(s)}):this.handleSetInitData(this.getInitData())}}componentDidMount(){this.initFormData()}componentDidUpdate(r){r.visible!==this.props.visible&&this.props.visible&&this.initFormData()}render(){var r=this.props,n=r.t,s=r.isPreview,i=r.visible,u=r.evaluateAssign,f=this.props.editInfo.data||{},N=this.state,Y=N.initData,J=N.showForm;return t().createElement(La.ZP,(0,b.Z)({},Vi,{visible:i,title:f.id?n("assessment.editAssessmentTask"):n("assessment.createAssessmentTask"),onCancel:this.onCancel,onOk:this.onCommit}),J&&t().createElement($i,{isPreview:s,isEdit:f.id,evaluateAssign:u,onFormMounted:this.onFormMounted,onSubmit:this.onSubmit,initData:Y}))}}nr.defaultProps={visible:!1,editInfo:{},onCancel:()=>{},onOk:()=>{}};var ji=Z=>{var r=Z.user;return{creator_user:r.id}},Yn=(0,h.$j)(ji)((0,E.Z)()(nr)),zi=e(31916),rr=e(56075),Yi=rt.Z.TabPane,Qi=de.Z.TextArea,Gi=Le.Z.RangePicker,Hi=Z=>({uploaderList:Z.uploader.list,uploadSucceedItem:Z.uploader.uploadSucceedItem,uploadComponentType:Z.uploader.uploadComponentType,enterpriseId:Z.user.enterpriseId,isOpenTutorSystem:Z.publicVariable.isOpenTutorSystem,appType:Z.user.appType,qyShield:Z.user.qyShield});class ir extends t().Component{constructor(r){var n;super(r);n=this,this.getEnterpriseExamType=(0,K.Z)(d().mark(function i(){var u;return d().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.next=2,(0,zi.uH)();case 2:u=N.sent,n.setState({isOldExam:u==="old"});case 4:case"end":return N.stop()}},i)})),this.onStateChange=i=>{var u=this.state.tabPanes;this.props.onFieldChange(u),this.props.onChangeQualifiedStandard&&this.props.onChangeQualifiedStandard(u),this.checkStandard(i),this.setState({tabPanes:u}),this.props.onStageChange&&this.props.onStageChange(u)},this.onDragStart=()=>{this.setState({tabAddHide:!0})},this.onDragEnd=i=>{if(!(!i.destination||!i.source.index)){var u=this.state.tabPanes,f=0,N=i.destination.index-i.source.index,Y="";u.forEach((J,se)=>{J.key===i.draggableId&&(f=se,Y=J)}),N!==0&&(u.splice(f,1),u.splice(f+N,0,Y)),this.setState({tabPanes:u,activeTab:i.draggableId,tabAddHide:!1},this.onStateChange)}},this.onEditTab=(i,u)=>{this["".concat(u,"Tab")](i)},this.getResourceType=()=>{var i=this.props,u=i.resourceType,f=i.qyShield,N=i.from;if(f==="true"){var Y=["courseware","course","exam","imageTextCourse","offline","attendance","practice"];(N==="employees"||N==="certificate")&&(Y=["courseware","course","exam","imageTextCourse","practice"]),this.setState({resourceTypeNew:Y})}else this.setState({resourceTypeNew:u})},this.getVersionStatus=(0,K.Z)(d().mark(function i(){var u,f;return d().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:return Y.prev=0,Y.next=3,(0,Fa.UE)();case 3:u=Y.sent,f=u.data,f.code===2e5&&n.setState({isFree:f.data.isFree}),Y.next=11;break;case 8:Y.prev=8,Y.t0=Y.catch(0),n.setState({isFree:"false"});case 11:case"end":return Y.stop()}},i,null,[[0,8]])})),this.addTab=()=>{var i=this.state.tabPanes,u=this.getTimestamp();i.push({name:"",desc:"",list:[],key:u,inOrder:!1,Standard:{progressCheck:!1,progress:100,examCheck:!1,examNum:0,practiceCheck:!1,practiceNum:0,jobEvaluationCheck:"false"},reward:{getScoreChecked:!1,getScore:0,certificateChecked:!1,certificateId:"",certificateName:"",certificateImage:""}}),this.setState({tabPanes:i,activeTab:u},this.onStateChange)},this.removeTab=i=>{var u=this.props.t;ae.Z.confirm({title:u("common.tip"),content:u("component.removeStageTip"),okText:u("common.ok"),cancelText:u("common.cancel"),onOk:()=>{var f=this.state.activeTab,N=this.state.tabPanes,Y;N.forEach((se,Ce)=>{se.key===i&&(Y=Ce-1)});var J=N.filter(se=>se.key!==i);J.length&&f===i&&(Y>=0?f=J[Y].key:f=J[0].key),this.setState({tabPanes:J,activeTab:f},()=>{this.onStateChange("change")})}})},this.handleTabChange=i=>{this.setState({activeTab:i})},this.handleTabPanesChange=(i,u)=>{var f=this.state,N=f.tabPanes,Y=f.activeTab,J=N.find(se=>se.key===Y);J&&(J[i]=u.target.value),this.setState({tabPanes:N},this.onStateChange)},this.getTimestamp=()=>"".concat(new Date().getTime()),this.showResourceComponent=function(){var i=(0,K.Z)(d().mark(function u(f){var N,Y,J,se,Ce,Xe,ot,He,dt,it,Dt=arguments;return d().wrap(function(ft){for(;;)switch(ft.prev=ft.next){case 0:if(N=Dt.length>1&&Dt[1]!==void 0?Dt[1]:"",Y=n.props,J=Y.t,se=Y.taskType,!(f==="ClNewUpload"&&(se==="1"||se==="2"))){ft.next=8;break}return ft.next=5,(0,ve.x8)("quota_source_book",J("course.sourceValidateLimit",{courseType:J("documentTitle.matter")}));case 5:if(Ce=ft.sent,!Ce){ft.next=8;break}return ft.abrupt("return");case 8:Xe=n.state,ot=Xe.activeTab,He=Xe.tabPanes,dt=He.find(kt=>kt.key===ot).list,it=[],f!=="OfflineTrain"&&f!=="AddExam"&&f!=="AddNewExam"&&f!=="AddPracticeTest"&&f!=="AddMentorCoaching"&&f!=="AddInvestigate"&&f!=="Attendance"&&f!=="AddAssessment"&&(it=dt.filter(kt=>kt.componentName===f)),n.setState({editResourceComponent:f,extraType:N,defaultCheckedResource:it,replaceStatus:!1});case 13:case"end":return ft.stop()}},u)}));return function(u){return i.apply(this,arguments)}}(),this.filterLineClass=i=>{var u=this.state,f=u.activeTab,N=u.tabPanes,Y=N.find(Ce=>Ce.key===f).list,J=Y.filter(Ce=>Ce.componentName==="Attendance"),se=!1;return J.map(Ce=>{Ce.data.relate_course_list.map(Xe=>{(Xe.course_key||Xe.course_id)===i&&(se=!0)})}),se},this.handleCancelEditResource=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,u=arguments.length>1?arguments[1]:void 0,f=n.props.t,N=n.state.editResourceComponent;N==="OfflineTrain"&&i&&!n.filterLineClass(u.id||u.key)&&ae.Z.confirm({title:f("common.tip"),content:t().createElement("div",null,f("lineClass.linkAttendanceTip")),okText:f("common.ok"),cancelText:f("common.cancel"),onOk:()=>{n.setState({editResourceComponent:"Attendance",defaultCheckedResource:[]})}}),n.setState(Y=>({editResourceComponent:i?"":Y.editResourceComponent,defaultCheckedResource:i||N==="OfflineTrain"||N==="Attendance"?[]:Y.defaultCheckedResource}),()=>{})},this.handleCancelEditResourceOfflineTrain=()=>{this.setState({editResourceComponent:"",defaultCheckedResource:""})},this.replaceResource=i=>{var u=this.state,f=u.activeTab,N=u.tabPanes,Y=N.find(J=>J.key===f).list;this.setState({editResourceComponent:Y[i].componentName,defaultCheckedResource:[Y[i]],allDefaultCheckedResource:Y,replaceStatus:!0,replaceItemId:Y[i].id,extraType:Y[i].data&&(Y[i].data.biz_type==="imageText"||Y[i].data.bizType===6||Y[i].data.type==="imageText")&&Y[i].componentName==="CourseSelector"?"ImageTextCourse":""})},this.sureAddResource=(i,u,f)=>{if(this.state.replaceStatus){this.replaceCheckedList(i);return}var N=this.state.editResourceComponent;this.handleCancelEditResource(f,i);var Y=this.state,J=Y.activeTab,se=Y.tabPanes,Ce,Xe=se.findIndex(it=>it.key===J);if(N!=="OfflineTrain"&&N!=="AddExam"&&N!=="AddNewExam"&&N!=="AddPracticeTest"&&N!=="AddJobEvaluation"&&N!=="AddMentorCoaching"&&N!=="AddInvestigate"&&N!=="Attendance"&&N!=="AddAssessment")Ce=[...i],Ce.forEach(it=>{it.btnActionType=u}),se[Xe].list=se[Xe].list.filter(it=>{if(it.componentName===N){var Dt=Ce.findIndex(Qe=>Qe.id===it.id);return Dt!==-1?(Ce.splice(Dt,1),!0):!1}return!0}),se[Xe].list=se[Xe].list.concat(Ce);else{Ce=(0,v.Z)({},i),Ce.btnActionType=u;var ot=se[Xe].list.findIndex(it=>it.key===Ce.key||it.id!==""&&it.id===Ce.id);if(ot!==-1){var He=se[Xe].list[ot];He.mappingId&&(Ce.mappingId=He.mappingId),He.data&&He.data.unlockingTime&&Ce.data&&(Ce.data.unlockingTime=He.data.unlockingTime),Ce.resource_lock=He.resource_lock,se[Xe].list.splice(ot,1,Ce)}else se[Xe].list.push(Ce)}if(N==="OfflineTrain"){var dt=se[Xe].list.filter(it=>it.componentName==="Attendance");dt.forEach(it=>{it.data.relate_course_list.forEach(Dt=>{Dt.course_key===(i.key||i.id)&&(Dt.course_name=i.name)})})}this.setState({tabPanes:se},this.onStateChange("change"))},this.sureAddUploadResource=(i,u)=>{var f=this.state,N=f.activeTab,Y=f.tabPanes,J=[...i],se=Y.findIndex(Ce=>Ce.key===N);J.forEach(Ce=>{Ce.btnActionType=u}),Y[se].list=Y[se].list.concat(J),this.setState({tabPanes:Y,editResourceComponent:""},this.onStateChange)},this.sortResource=(i,u)=>{var f=this.state,N=f.activeTab,Y=f.tabPanes,J=Y.find(Ce=>Ce.key===N).list,se=J[i];J.splice(i,1),J.splice(u,0,se),this.setState({tabPanes:Y},this.onStateChange)},this.removeResource=(i,u)=>{var f=this.state,N=f.activeTab,Y=f.tabPanes,J=Y.find(Ce=>Ce.key===N).list;if(u==="xx"){var se=J[i].id||J[i].key;J.forEach(Ce=>{if(Ce.type==="attendance"){for(var Xe=Ce.data.relate_course_list,ot=0;ot<Xe.length;ot++){var He=Xe[ot];if((He.course_id||He.course_key)===se){Ce.data.relate_course_list.splice(ot,1);break}}Ce.data.relate_course=!!Ce.data.relate_course_list.length}})}J.splice(i,1),this.setState({tabPanes:Y,isEditAddJobEvaluation:!1},this.onStateChange("change"))},this.editResource=function(){var i=(0,K.Z)(d().mark(function u(f){var N,Y,J,se,Ce,Xe,ot;return d().wrap(function(dt){for(;;)switch(dt.prev=dt.next){case 0:if(N=n.state,Y=N.activeTab,J=N.tabPanes,se=J.find(it=>it.key===Y).list,Ce=se[f].componentName==="AddJobEvaluation",!Ce){dt.next=9;break}return dt.next=6,(0,rr.wp)({modelId:se[f].data.evaluationTools.model_id,productId:se[f].data.evaluationTools.product_id});case 6:Xe=dt.sent,ot=Xe.data.data.product_name,se[f].data.evaluationTools.product_name=ot;case 9:n.setState({editResourceComponent:se[f].componentName,defaultCheckedResource:[se[f]],isEditAddJobEvaluation:Ce});case 10:case"end":return dt.stop()}},u)}));return function(u){return i.apply(this,arguments)}}(),this.uploadSuccess=i=>{var u=i.map(f=>({id:f.id,name:f.name,duration:f.duration,type:f.type,originalType:f.type,icon:$.e1[f.originalType==="audio/mp3"?"mp3":f.type],componentName:"CoursewareSelector",status:f.status,data:(0,v.Z)({},f)}));this.sureAddUploadResource(u,"ClNewUpload")},this.disabledDateStage=i=>{var u=this.props.formik.values.dateRange,f=u.startTime,N=u.endTime;return i&&i<Ee()(Ee()(f).format("YYYY-MM-DD 00:00:00"))||i<Ee()().subtract("day",1)||i>Ee()(Ee()(N).format("YYYY-MM-DD 23:59:59"))},this.changeDate=(i,u,f)=>{var N=this.state.tabPanes;N.length!==0&&(N[u].list[f].data||(N[u].list[f].data={}),N[u].list[f].data.unlockingTime=i||"",this.setState({tabPanes:N},this.onStateChange))},this.laboratoryChange=(i,u,f)=>{this.props.handleEvent(i,u,f)},this.changeTime=(i,u)=>{var f=this.state.tabPanes;f.length!==0&&(f[u].studyTime=i||["",""],this.setState({tabPanes:f},this.onStateChange))},this.changeResourceLock=(i,u,f)=>{var N=this.state.tabPanes,Y=this.props.isResourceLockNotCheck;Y&&this.setState({isResourceLockNotCheckNew:!1}),!(N.length===0||N[u].list.length===0)&&(N[u].list[f].resource_lock=i||!1,this.setState({tabPanes:N},this.onStateChange))},this.renderTabCont=i=>{var u=this.props.t;return t().createElement("div",{className:"stage-task-tab-top"},t().createElement($e.Z,{className:"add-stage-tab-form"},t().createElement($e.Z.Item,{label:u("component.stageName"),required:!0},t().createElement(de.Z,{style:{borderColor:"#e8e8e8"},className:"add-stage-tab-name",placeholder:u("component.stageNameInputPlaceholder"),maxLength:60,defaultValue:i.name,onChange:this.handleTabPanesChange.bind(this,"name")})),t().createElement($e.Z.Item,{label:u("component.stageDesc")},t().createElement(Qi,{style:{borderColor:"#e8e8e8"},className:"add-stage-tab-desc",placeholder:u("component.stageDescPlaceholder"),maxLength:240,defaultValue:i.desc,onChange:this.handleTabPanesChange.bind(this,"desc")}))))},this.renderAddExamButton=()=>{var i=this.state.isOldExam,u=this.props.t;return i?t().createElement(y.Z,{className:"stage-task-btn",icon:t().createElement(V.Z,null),onClick:()=>this.showResourceComponent("AddExam")},u("common.exam")):t().createElement(Pe.Z,{offset:[-60,3],color:"#ED2B2B",count:t().createElement("span",{className:"old-stage-badge-new-tag"},"new")},t().createElement(y.Z,{className:"stage-task-btn",icon:t().createElement(V.Z,null),onClick:()=>this.showResourceComponent("AddNewExam")},u("common.exam")))},this.renderResourceBtn=()=>{var i=this.props,u=i.enterpriseId,f=i.t,N=i.jobEvaluationCount,Y=i.isOpenTutorSystem,J=i.scheduleSetting,se=i.appType,Ce=i.style_type,Xe=i.qyShield,ot=i.isHasToolEva,He=this.state,dt=He.blackList,it=He.isFree,Dt=He.resourceTypeNew,Qe=t().createElement(Et.Z,null,t().createElement(Et.Z.Item,null,t().createElement("div",{onClick:()=>this.showResourceComponent("CoursewareSelector")},f("component.coursewareLibSelect"))),t().createElement(Et.Z.Item,null,t().createElement("div",{className:"stage-upload-courseware",onClick:()=>this.showResourceComponent("ClNewUpload")},f("component.localUpload"))));return t().createElement("div",{className:"stageButtonWrap"},Dt.indexOf("courseware")!==-1?t().createElement(pa.Z,{overlay:Qe},t().createElement(y.Z,{className:"stage-task-btn",icon:t().createElement(V.Z,null)},f("common.courseware"))):null,Dt.indexOf("course")!==-1?t().createElement(y.Z,{className:"stage-task-btn",icon:t().createElement(V.Z,null),onClick:()=>this.showResourceComponent("CourseSelector")},f("common.courseLabel")):null,it==="false"&&se!=="fs_app"&&Dt.indexOf("imageTextCourse")!==-1?t().createElement(y.Z,{className:"stage-task-btn",icon:t().createElement(V.Z,null),onClick:()=>this.showResourceComponent("CourseSelector","ImageTextCourse")},f("course.graphicDetailTitle")):null,Dt.indexOf("exam")!==-1?this.renderAddExamButton():null,it==="false"&&J!=="unlock_mode"&&dt.offlineButFlag&&Dt.indexOf("offline")!==-1?t().createElement(y.Z,{className:"stage-task-btn",icon:t().createElement(V.Z,null),onClick:()=>this.showResourceComponent("OfflineTrain")},f("lineClass.listTitle")):null,it==="false"&&Xe==="false"&&Dt.indexOf("investigate")!==-1?t().createElement("span",null,t().createElement(y.Z,{className:"stage-task-btn",icon:t().createElement(V.Z,null),onClick:()=>this.showResourceComponent("AddInvestigate")},f("questionn.investigate"))):null,it==="false"&&Dt.indexOf("practice")!==-1?t().createElement(y.Z,{className:"stage-task-btn",icon:t().createElement(V.Z,null),onClick:()=>this.showResourceComponent("AddPracticeTest")},f(u==="1074539867477774379"?"component.practiceExam2":"component.practiceExam")):null,it==="false"&&Xe==="false"&&J!=="unlock_mode"&&Dt.indexOf("jobEvaluation")!==-1&&ot?t().createElement(y.Z,{className:"stage-task-btn",icon:t().createElement(V.Z,null),onClick:()=>this.showResourceComponent("AddJobEvaluation"),disabled:N>0},f("learning.jobEvaluation")):null,it==="false"&&Dt.indexOf("tutor")!==-1&&Y?t().createElement(y.Z,{className:"stage-task-btn",icon:t().createElement(V.Z,null),onClick:()=>this.showResourceComponent("AddMentorCoaching")},f("tutorial.coach")):null,it==="false"&&J!=="unlock_mode"&&Dt.indexOf("attendance")!==-1?t().createElement(y.Z,{className:"stage-task-btn",icon:t().createElement(V.Z,null),onClick:()=>this.showResourceComponent("Attendance")},f("tutorial.attendance")):null,Dt.indexOf("assess")!==-1&&Ce==="normal"?t().createElement(y.Z,{className:"stage-task-btn",icon:t().createElement(V.Z,null),onClick:()=>this.showResourceComponent("AddAssessment")},f("assessment.assess")):null)},this.cancelPreview=()=>{var i=this.state.previewInfo;this.setState({resourcePlayInfo:{mode:"preview",watchType:"",resourceInfo:{}},previewInfo:(0,v.Z)((0,v.Z)({},i),{},{visible:!1})})},this.viewResource=i=>{var u=this.state.previewInfo;if(i){var f=i.resourcePlayInfo,N=i.previewInfo.title;this.setState({resourcePlayInfo:f,previewInfo:(0,v.Z)((0,v.Z)({},u),{},{title:N,visible:!0,onCancel:this.cancelPreview})})}},this.tabStageList=(i,u)=>{var f=this.props,N=f.editable,Y=f.isPreview,J=f.showChangeBtn,se=f.deleteModal,Ce=f.scheduleSetting,Xe=f.formik.errors,ot=f.laboratoryList,He=f.isResourceLock,dt=f.renderAsTabs,it=f.isStageHasRewardAStandard,Dt=this.state,Qe=Dt.showLaboratory,ft=Dt.isResourceLockNotCheckNew,kt=i.list;return Ce==="unlock_mode"&&(kt=i.list.filter(xt=>xt.type!=="xx"&&xt.type!=="jobEvaluation"&&xt.type!=="attendance")),t().createElement(t().Fragment,null,t().createElement("div",{className:"stage-task-tab-list"},kt.length===0?t().createElement(Lt.Z,{imageStyle:{height:"30px"},image:Lt.Z.PRESENTED_IMAGE_SIMPLE}):t().createElement(Ft.Z,{list:i.list,sortResource:this.sortResource,removeResource:this.removeResource,editResource:this.editResource,replaceResource:this.replaceResource,unlockTimeDisable:Ce==="unlock_mode"?i.studyTime||[null,null]:null,changeDate:(xt,Rt)=>this.changeDate(xt,u,Rt),editable:N,isPreview:Y,showChangeBtn:J,deleteModal:se,parentId:i.key,errors:Xe,laboratoryList:ot,handleEvent:this.laboratoryChange,showLaboratory:Qe,isResourceLock:He,isResourceLockNotCheck:ft,changeResourceLock:(xt,Rt)=>this.changeResourceLock(xt,u,Rt),viewResource:this.viewResource})),t().createElement("div",{className:dt?"":"noTabs"},t().createElement(ca,{isPreview:Y,pane:i,onStateChange:this.onStateChange}),it&&this.renderTabRules(i,u)))},this.renderTabBar=(i,u)=>t().createElement(mt.Z5,{onDragStart:this.onDragStart,onDragEnd:this.onDragEnd},t().createElement(mt.bK,{droppableId:"droppable",direction:"horizontal",isDropDisabled:!1},f=>t().createElement("div",(0,b.Z)({className:"dragItemWrap",ref:f.innerRef},f.droppableProps),t().createElement(u,i,N=>(i.locale+=1,t().createElement(mt._l,{key:N.key,draggableId:N.key,index:i.locale,isDragDisabled:!1},Y=>t().createElement("div",(0,b.Z)({ref:Y.innerRef},Y.draggableProps,Y.dragHandleProps,{className:"dragItem".concat(i.locale)}),N)))),f.placeholder))),this.renderTabList=()=>{var i=this.state,u=i.activeTab,f=i.tabPanes,N=i.tabPanesMaxLength,Y=i.tabAddHide,J=this.props,se=J.editable,Ce=J.t,Xe=J.scheduleSetting;return t().createElement(rt.Z,{hideAdd:Y,locale:0,tabBarGutter:2,renderTabBar:this.renderTabBar,onChange:this.handleTabChange,activeKey:u,type:se&&f.length<N?"editable-card":"card",onEdit:this.onEditTab,className:se&&f.length===N?"length-limit":""},f.map((ot,He)=>t().createElement(Yi,{key:ot.key,tab:t().createElement("div",{className:"stage-task-tab-label"},"".concat(Ce("component.stage")).concat(He+1),f.length>1&&se?t().createElement("span",{className:"tab-pane-close",onClick:()=>this.removeTab(ot.key)},t().createElement(S.Z,{iconClass:"icon-guanbi1",size:"12px"})):null),closable:f.length>1},t().createElement("div",{className:"stage-task-tab"},this.renderTabCont(ot),Xe==="unlock_mode"&&this.renderLocalTime(ot,He),this.tabStageList(ot,He)))))},this.renderLocalTime=(i,u)=>{var f=this.props,N=f.editable,Y=f.formik.errors,J=f.t;return t().createElement("div",{className:"stage-task-tab-top",style:{paddingTop:"0px"}},t().createElement($e.Z,{className:"add-stage-tab-form"},t().createElement($e.Z.Item,{label:J("assgin.unLockTimeLabel")},t().createElement(Gi,{className:"stage_hour ".concat(Y&&Y.stages&&Y.stages[i.key]?"stage_hour_error":""),format:"YYYY-MM-DD HH:mm",disabledDate:this.disabledDateStage,disabled:!N,value:i.studyTime||[null,null],onChange:se=>this.changeTime(se,u),showTime:!0}))))},this.renderTabRules=i=>{var u=this.props,f=u.isPreview,N=u.scheduleSetting,Y=u.qyShield,J=this.state.resourceTypeNew,se=N!=="unlock_mode"&&J.indexOf("jobEvaluation")!==-1;return t().createElement(t().Fragment,null,t().createElement(Va,{isPreview:f,itemVal:i.Standard,onStateChange:this.onStateChange,courseCount:(0,Sa.Qz)([i]),jobEvaluationCount:(0,Sa.S1)([i]),operationCount:(0,Sa.GM)([i]),examCount:(0,Sa.z2)([i]),isEvaluation:se}),t().createElement(ts,{qyShield:Y,isPreview:f,itemVal:i.reward,onStateChange:this.onStateChange}))};var s=this.getTimestamp();this.state={activeTab:s,tabAddHide:!1,tabPanes:[{key:s,index:0,name:r.t("component.stage")+r.t("component.stageOne"),desc:"",list:[],inOrder:!1,studyTime:["",""],Standard:{progressCheck:!1,progress:100,examCheck:!1,examNum:0,practiceCheck:!1,practiceNum:0,jobEvaluationCheck:"false"},reward:{getScoreChecked:!1,getScore:0,certificateChecked:!1,certificateId:"",certificateName:"",certificateImage:""}}],tabPanesMaxLength:50,editResourceComponent:"",extraType:"",defaultCheckedResource:[],isEditAddJobEvaluation:!1,isResourceLockNotCheckNew:!1,blackList:{offlineButFlag:(0,be.eY)("LINE_CLASS_OFFLINE_TASK_BUT")},isFree:"false",resourceTypeNew:[],isOldExam:!1,resourcePlayInfo:{mode:"preview",watchType:"",resourceInfo:{},autoPlay:!0,draggable:!0},previewInfo:{visible:!1,destroyOnClose:!0,title:r.t("resourceLibrary.previewCourseware"),onCancel:()=>{}}}}UNSAFE_componentWillMount(){var r=this.props.value;r.length>0&&this.setState({tabPanes:r,activeTab:r[0].key})}componentDidMount(){this.props.dispatch({type:"publicVariable/getHasMenusPermissions",payload:{flag:"TutorSystem"}}),this.checkStandard("change"),this.setState({isResourceLockNotCheckNew:this.props.isResourceLockNotCheck}),this.getVersionStatus(),this.getResourceType(),this.getEnterpriseExamType()}checkStandard(r){var n=this.state,s=n.tabPanes,i=n.activeTab,u=this.props.isStageHasRewardAStandard,f=s.find(N=>N.key===i);u||s.forEach(N=>{delete N.Standard,delete N.reward}),f.Standard&&r==="change"&&(f.Standard.examCheck=(0,Sa.z2)([f])>0,f.Standard.progressCheck=(0,Sa.Qz)([f])>0,f.Standard.practiceCheck=(0,Sa.GM)([f])>0,f.Standard.jobEvaluationCheck=(0,Sa.S1)([f])>0?"true":"false",f.Standard.progress=f.Standard.progress===""?100:f.Standard.progress,f.Standard.examNum=f.Standard.examNum===0||f.Standard.examNum===""?(0,Sa.z2)([f]):f.Standard.examNum,f.Standard.practiceNum=f.Standard.practiceNum===0||f.Standard.practiceNum===""?(0,Sa.GM)([f]):f.Standard.practiceNum)}replaceCheckedList(r){var n=this.state,s=n.activeTab,i=n.tabPanes,u=n.replaceItemId,f=i.find(N=>N.key===s).list;f.forEach((N,Y)=>{if(N.id===u){r[0].mappingId=N.mappingId,N.data&&N.data.unlockingTime&&r[0].data&&(r[0].data.unlockingTime=N.data.unlockingTime);var J=(0,Be.Z)(r,1);i.find(se=>se.key===s).list[Y]=J[0]}}),this.handleCancelEditResource(),this.setState({tabPanes:i},this.onStateChange)}render(){var r=this.state,n=r.tabPanes,s=r.editResourceComponent,i=r.defaultCheckedResource,u=r.isEditAddJobEvaluation,f=r.replaceStatus,N=r.allDefaultCheckedResource,Y=r.extraType,J=r.resourcePlayInfo,se=r.previewInfo,Ce=this.props,Xe=Ce.courseSelectorFilterQuota,ot=Xe===void 0?!1:Xe,He=Ce.isHasTutor,dt=Ce.examProps,it=Ce.isPreview,Dt=Ce.isView,Qe=Dt===void 0?!1:Dt,ft=Ce.editable,kt=Ce.renderAsTabs,xt=Ce.jobEvaluationEdit,Rt=Ce.formik.errors,qt=Ce.useCustomValidate,Pa=Ce.resourceLocked,sa=Ce.anonymousMarking,ba=Ce.multipleMissedScore,oa=Ce.isHuaLaiShi;return it&&(dt.disabledFields=["questionsMode","passLine","title","examDuration","cheatFlag","reExam","markType","knowledgePoints","drawQuestionsSwitch","weightInput"]),Qe&&(dt.disabledFields.push("faceKnow"),dt.disabledFields.push("summary")),s==="AddExam"&&i.length&&(bt()(i[0],"data.reExam.userJoin",!1)?dt.disabledFields=["questionsMode","passLine","markType","drawQuestionsSwitch","weightInput"]:dt.disabledFields=[]),t().createElement("div",{className:"stage-task"},ft?this.renderResourceBtn():null,kt&&this.renderTabList(),!kt&&this.tabStageList(n[0],0),t().createElement(us.Z,{image_text:Y==="ImageTextCourse"?"true":"",visible:s==="CourseSelector",defaultChecked:i,allChecked:N,onCancel:this.handleCancelEditResource,filterQuota:ot,onOk:Yt=>this.sureAddResource(Yt,"CourseSelector"),replaceStatus:f,resourceLocked:Pa}),t().createElement(Ds.Z,{visible:s==="CoursewareSelector",defaultChecked:i,allChecked:N,onCancel:this.handleCancelEditResource,onOk:Yt=>this.sureAddResource(Yt,"CoursewareSelector"),replaceStatus:f,excludeType:"h5",resourceLocked:Pa}),t().createElement(Za.Z,{visible:s==="ClNewUpload",title:this.props.t("common.storage"),onCancel:this.handleCancelEditResource,onSuccess:Yt=>this.uploadSuccess(Yt),params:{classifyId:0,bizType:0}}),t().createElement(ge,{visible:s==="OfflineTrain",editInfo:i[0]||{},onCancel:this.handleCancelEditResourceOfflineTrain,onOk:(Yt,Ta)=>this.sureAddResource(Yt,"OfflineTrain",Ta),dateRange:this.props.dateRange,dateRangeLimit:this.props.dateRangeLimit,isPreview:it,editable:ft}),t().createElement(ia,{visible:s==="AddInvestigate",editInfo:i[0]||{},onCancel:this.handleCancelEditResource,onOk:Yt=>this.sureAddResource(Yt,"AddInvestigate")}),s==="AddNewExam"&&t().createElement(As,{visible:s==="AddNewExam",editInfo:i[0]||{},onCancel:this.handleCancelEditResource,isEdit:!!i[0],onOk:Yt=>this.sureAddResource(Yt,"AddNewExam")}),t().createElement(Bs,{visible:s==="AddExam",editInfo:i[0]||{},onCancel:this.handleCancelEditResource,isEdit:!!i[0],onOk:Yt=>this.sureAddResource(Yt,"AddExam"),examProps:dt,anonymousMarking:sa,multipleMissedScore:ba}),t().createElement(Ca,{visible:s==="AddPracticeTest",createUserId:this.props.createUserId,editInfo:i[0]||{},onCancel:this.handleCancelEditResource,onOk:Yt=>this.sureAddResource(Yt,"AddPracticeTest"),isHasTutor:He,isHuaLaiShi:oa}),t().createElement(Na,{visible:s==="AddJobEvaluation",createUserId:this.props.createUserId,editInfo:i[0]||{},onCancel:this.handleCancelEditResource,onOk:Yt=>this.sureAddResource(Yt,"AddJobEvaluation"),isEdit:(it||xt)&&u}),t().createElement(fn,{visible:s==="AddMentorCoaching",onCancel:this.handleCancelEditResource,editInfo:i[0]||{},createUserId:this.props.createUserId,onOk:Yt=>this.sureAddResource(Yt,"AddMentorCoaching")}),t().createElement(Vn,{visible:s==="Attendance",onCancel:this.handleCancelEditResourceOfflineTrain,editInfo:i[0]||{},createUserId:this.props.createUserId,tabPanes:n,isPreview:it,activeTab:this.state.activeTab,onOk:(Yt,Ta)=>this.sureAddResource(Yt,"Attendance",Ta)}),t().createElement(Yn,{visible:s==="AddAssessment",onCancel:this.handleCancelEditResourceOfflineTrain,editInfo:i[0]||{},tabPanes:n,isPreview:it,activeTab:this.state.activeTab,onOk:(Yt,Ta)=>this.sureAddResource(Yt,"AddAssessment",Ta)}),Rt&&Rt.stages&&Rt.stages.timeMsg&&t().createElement("p",{className:"stage-task-error-msg"},Rt.stages.timeMsg),Rt&&Rt.stages&&Rt.stages.commonMsg&&t().createElement("p",{className:"stage-task-error-msg"},Rt.stages.commonMsg),qt&&Rt&&Rt.stages&&typeof Rt.stages=="string"&&t().createElement("p",{className:"stage-task-error-msg"},Rt.stages),t().createElement(as.Z,(0,b.Z)({},J,{previewInfo:se})))}}ir.defaultProps={onChange:()=>{},renderAsTabs:!0,editable:!0,isPreview:!1,jobEvaluationEdit:!0,examProps:{},resourceType:["courseware","course","exam","offline","investigate","practice","attendance"],stageResourceError:[],jobEvaluationCount:0,isHasTutor:!1,scheduleSetting:"",useCustomValidate:!1,isResourceLock:!1,isResourceLockNotCheck:!1,resourceLocked:!1,anonymousMarking:!1,multipleMissedScore:!1,isStageHasRewardAStandard:!1,from:"",taskType:""};var Xi=(0,m.$j)((0,h.$j)(Hi)((0,E.Z)()(ir))),Ji=t().createContext(null),Ln=Ji,$a=e(78001),qi=e(76396),xn=e.n(qi),el=(0,ve.me)(),tl=ke.Z[el].trainingProject.addEdit,al=Z=>{var r;return Z||(r=tl.validation.accuracyTip),r},sl=Z=>{var r=Z.value,n=Z.t,s=i=>{Z.onFieldChange(i)};return t().createElement("div",{className:xn()["qualified-standard"]},t().createElement("span",{className:xn()["qualified-standard-title"]},n("trainingProject.addEdit.accuracy")),t().createElement(X.Z,{value:r,onChange:s,className:xn()["qualified-standard-number"],min:1,max:100,precision:0}),t().createElement("span",{className:xn()["qualified-standard-tip"]},"%"))},nl=(0,Ke.Z)((0,E.Z)()(sl)),rl=e(441),pn=e.n(rl),il=e(60211),ll=e(30179),lr={ADD:"add",EDIT:"edit"},or={labelCol:{span:3},wrapperCol:{span:21}},ol=(Z,r)=>{var n=Z.t,s=Z.initialValues,i=(0,l.useRef)(null);(0,l.useImperativeHandle)(r,()=>({onSubmitFormik:()=>{i.current.submitForm()},setFormikValues:N=>{i.current.setValues(N)}}));var u=N=>{f(N)},f=N=>{Z.onOk&&Z.onOk(N)};return t().createElement("div",{className:pn()["exam-form-container"]},t().createElement(m.J9,{ref:i,initialValues:s,onSubmit:u,render:N=>{var Y=N.values;return t().createElement(m.l0,null,t().createElement("div",{className:pn()["form-content"]},t().createElement("div",{className:pn()["section-title"]},n("trainingProject.addEdit.baseInfo")),t().createElement(m.gN,(0,b.Z)({component:We.Z,name:"title",label:n("exam.itemBankDetailName"),style:{width:"460px"},validate:J=>(0,ze.QK)(J,"".concat(n("exam.itemBankDetailName"))),required:!0,type:"text",LimitLength:60,char:!0,formItemClassName:pn()["cl-form_list-item"],placeholder:n("exam.itemBankDetailTitlePlaceholder")},or)),t().createElement(m.gN,{component:il.B,displayType:"Custom",name:"randomQuestion",required:!0,stageMode:!0,defaultFieldList:Y.randomQuestion,validate:J=>(0,ll.j)(J,Y)}),t().createElement("div",{className:pn()["section-title"]},n("trainingProject.addEdit.practiceSetting")),t().createElement(m.gN,(0,b.Z)({component:nl,displayType:"Custom",label:n("trainingProject.addEdit.learningAddSecPassTitle"),name:"stand",required:!0,formItemClassName:pn()["cl-form_list-item-margin"],validate:J=>al(J)},or))),t().createElement(tr,null))}}))},dl=(0,l.forwardRef)(ol),cl=e(72613),ul=e.n(cl);function ml(Z){var r=Z.t,n=Z.visible,s=Z.isEdit,i=Z.editInfo,u=Z.has_published,f=(0,l.useRef)(null),N=(0,l.useState)({title:"",randomQuestion:{bankQuesitonVoList:[]},stand:60}),Y=(0,Be.Z)(N,1),J=Y[0];(0,l.useEffect)(()=>{(function(){var ot=(0,K.Z)(d().mark(function dt(){var it;return d().wrap(function(Qe){for(;;)switch(Qe.prev=Qe.next){case 0:n&&(it=s?i.data:{title:"",randomQuestion:{bankQuesitonVoList:[]},stand:60},f.current&&it&&f.current.setFormikValues(it));case 1:case"end":return Qe.stop()}},dt)}));function He(){return ot.apply(this,arguments)}return He})()()},[s,i.data,n]);var se=ot=>{Z.onOk&&Z.onOk({id:i&&i.id?i.id:"",name:ot.title,key:i&&i.id?i.id:i&&i.key?i.key:"AddPracticeBank".concat(new Date().getTime()),componentName:"AddPracticeBank",data:ot,icon:"",type:"practice"})},Ce=()=>{Z.onCancel&&Z.onCancel()},Xe=()=>{f.current&&f.current.onSubmitFormik()};return t().createElement(t().Fragment,null,n&&t().createElement(ae.Z,{visible:n,width:870,title:r(s?"trainingProject.addEdit.editExercise":"trainingProject.addEdit.createExercise"),onCancel:Ce,onOk:Xe,maskClosable:!1,bodyStyle:{padding:"16px 24px 32px 24px"}},t().createElement("div",{className:ul()["modal-content"]},t().createElement(dl,{t:r,ref:f,initialValues:J,type:s?lr.EDIT:lr.ADD,has_published:u,onCancel:Ce,onOk:se}))))}var dr=(0,E.Z)()(ml),pl=e(91315),ys=e.n(pl),gd=e(20228),hl=e(11382),vl=e(1164),fl=e(87312),gl=e(60333),El=e(95664),_l=e(48479),Cl=e(66361),cr=e(86726),yl=Z=>{var r=Z.t,n=Z.changeCheckedList,s=Z.defaultChecked,i=Z.allChecked,u=Z.editInfo,f=Z.replaceStatus,N=Z.modules,Y=(0,l.useState)({liveStatus:"all",title:"",pageSize:12,pageNumber:1,liveClassify:"live",classifyId:""}),J=(0,Be.Z)(Y,2),se=J[0],Ce=J[1],Xe=(0,l.useState)({pages:1,total:0}),ot=(0,Be.Z)(Xe,2),He=ot[0],dt=ot[1],it=(0,l.useState)([]),Dt=(0,Be.Z)(it,2),Qe=Dt[0],ft=Dt[1],kt=(0,l.useState)([]),xt=(0,Be.Z)(kt,2),Rt=xt[0],qt=xt[1],Pa=(0,l.useState)(!1),sa=(0,Be.Z)(Pa,2),ba=sa[0],oa=sa[1],Yt=(0,l.useState)([]),Ta=(0,Be.Z)(Yt,2),Ya=Ta[0],va=Ta[1],Qa=(0,l.useState)({all:0,end:0,live:0,preparation:0}),gs=(0,Be.Z)(Qa,2),Aa=gs[0],ls=gs[1],Ja=(0,cr.V9)("liveRoom",N),ds=(0,cr.H3)("add_live",Ja);(0,l.useEffect)(()=>{os()},[se]),(0,l.useEffect)(()=>{os(),vs()},[]);var Ps=Bt=>{Ce((0,v.Z)((0,v.Z)({},se),{},{pageNumber:1,classifyId:Bt.id}))},ns=Bt=>{Ce((0,v.Z)((0,v.Z)({},se),{},{pageNumber:1,liveStatus:Bt.target.value}))},cs=Bt=>{Ce((0,v.Z)((0,v.Z)({},se),{},{pageNumber:1,keyword:Bt}))},vs=()=>{var Bt=[],ra=[];s.length&&!f?s.forEach(Ye=>{Bt.push(Ye.data),ra.push(Ye.data.courseId)}):f&&(Bt.push(u),ra.push(u.courseId)),ft(Bt),qt(ra)},os=()=>{oa(!0);var Bt=(0,v.Z)({},se);se.liveStatus==="all"&&delete Bt.liveStatus,(0,gl._u)(Bt).then(ra=>{var Ye=ra.data,vt=Ye.first,It=Ye.second;ra.status===200&&(oa(!1),va(vt.list),dt({total:vt.total,pages:vt.pages}),ls(It))}).catch(()=>{oa(!1)})},Ea=Bt=>{Ce((0,v.Z)((0,v.Z)({},se),{},{pageNumber:Bt}))},la=()=>{Ce((0,v.Z)((0,v.Z)({},se),{},{pageNumber:1}))},es=()=>{vl.Z.targetTo({path:"/training/learning/task/liveRoom/editLive?from=trainingProject"})},ea=Bt=>{var ra=[...Qe],Ye=[...Rt],vt=[];if(i.forEach(It=>{vt.push(It.id)}),vt.indexOf(Bt.courseId)!==-1&&f&&Bt.courseId!==u.courseId){D.default.warning(r("trainingProject.liveClass.liveClassExist"));return}f?(ra=[(0,v.Z)({},Bt)],Ye=[Bt.courseId]):Rt.indexOf(Bt.courseId)===-1?(ra.push(Bt),Ye.push(Bt.courseId)):(ra.splice(Ye.indexOf(Bt.courseId),1),Ye.splice(Ye.indexOf(Bt.courseId),1)),ft(ra),qt(Ye),n&&n(ra)},Da=Bt=>{var ra="",Ye="";switch(Bt.live_status){case"prepartion":ra=r("common.notStarted"),Ye="#ccc";break;case"live":ra=r("live.liveing"),Ye="#00CE00";break;case"end":ra=r("common.ended"),Ye="#ADADAD";break}return ra?t().createElement("span",{className:ys()["card-item-label"],style:{background:Ye}},ra):null};return t().createElement("div",{className:ys()["live-class-wrap"]},t().createElement("div",{className:ys()["classify-container"]},t().createElement(Cl.Z,{showSearch:!1,isRoot:!0,selectedKeys:[se.classifyId],stPickySearch:!0,className:ys()["classify-container-box"],placeholder:r("common.searchPlaceholder"),onSelect:Bt=>{Ps(Bt)},height:"calc(100vh - 350px)",type:"tree"})),t().createElement("div",{className:ys()["live-class-container"]},ds&&t().createElement("div",{className:ys()["operate-tips"]},r("trainingProject.liveClass.addTips"),t().createElement("span",{className:ys()["operate-btn"],onClick:()=>es()},r("trainingProject.liveClass.createLiveClass")),r("trainingProject.liveClass.complete"),t().createElement("span",{className:ys()["operate-btn"],onClick:()=>la()},r("trainingProject.liveClass.refresh")),r("trainingProject.liveClass.query")),t().createElement("div",{className:ys()["search-content"]},t().createElement(M.ZP.Group,{onChange:ns,value:se.liveStatus,style:{"padding-top":"5px"}},t().createElement(M.ZP,{value:"all"},r("common.all"),"(",Aa.all,")"),t().createElement(M.ZP,{value:"prepartion"},r("common.notStarted"),"(",Aa.preparation,")"),t().createElement(M.ZP,{value:"live"},r("live.liveing"),"(",Aa.live,")"),t().createElement(M.ZP,{value:"end"},r("common.ended"),"(",Aa.end,")")),t().createElement(_l.Z,{onSearch:cs,placeholder:r("trainingProject.liveClass.searchTips"),width:"250px"})),t().createElement("div",{className:ys()["live-class-cards"]},ba?t().createElement("div",{className:ys()["loading-wrap"]},t().createElement(hl.Z,null)):null,t().createElement("div",{className:ys()["live-class-cards-content"]},Ya.map((Bt,ra)=>t().createElement("div",{className:ys()["card-item"],key:ra,onClick:()=>ea(Bt)},Da(Bt),t().createElement("img",{className:ys()["card-item-cover"],src:Bt.cover,alt:""}),t().createElement("div",{className:ys()["card-item-info"]},t().createElement(c.Z,{title:Bt.title},t().createElement("div",{className:ys()["card-item-title"]},Bt.title)),t().createElement("div",{className:ys()["card-item-time"]},r("live.liveTime"),": ",Bt.startTime?Ee()(Bt.startTime*1).format("YYYY-MM-DD HH:mm"):"--"),t().createElement("div",{className:ys()["card-item-teacher-name"]},t().createElement(S.Z,{iconClass:"icon-jiangshi",size:"14px",color:"rgba(0, 0, 0, 0.25)"}),t().createElement("span",null,Bt.teacherName||"--")),Rt.indexOf(Bt.courseId)!==-1&&t().createElement("div",{className:ys()["selected-cover"]},t().createElement("span",{className:ys()["selected-cover-icon"]},t().createElement(S.Z,{iconClass:"iconf-ok",size:"30px"}))))))),Ya.length===0?t().createElement(fl.Z,{className:"no-result",tipText:r("course.courseNoDataTip")}):null),t().createElement("div",null,t().createElement(El.Z,{totalNum:He.total,totalPage:He.pages,current:se.pageNumber,onChange:Ea,onRefresh:os}))))},Tl=Z=>({modules:Z.user.modules}),Sl=(0,h.$j)(Tl)((0,E.Z)()(yl)),Pl=Z=>{var r=Z.t,n=Z.visible,s=Z.editInfo,i=Z.onCancel,u=Z.onOk,f=Z.defaultChecked,N=f===void 0?[]:f,Y=Z.allChecked,J=Y===void 0?[]:Y,se=Z.replaceStatus,Ce=(0,l.useState)([]),Xe=(0,Be.Z)(Ce,2),ot=Xe[0],He=Xe[1],dt={okText:r("common.ok"),cancelText:r("common.cancel"),size:"large",destroyOnClose:!0,bodyStyle:{padding:"0"},maskClosable:!1},it=()=>{if(ot.length!==0){var kt=[];ot.forEach(xt=>{kt.push({id:xt.courseId,name:xt.title,key:xt.courseId,componentName:"LiveClass",duration:xt.duration,data:(0,v.Z)({},xt),icon:$.e1.liveClass,type:"liveClass"})}),u(kt)}},Dt=()=>{i()},Qe=kt=>{He(kt)},ft=()=>t().createElement("div",{className:ys()["footer-render"]},t().createElement(y.Z,{onClick:()=>Dt()},r("common.cancel")),t().createElement(y.Z,{type:"primary",onClick:()=>it()},r("common.ok"),"(",ot.length,")"));return t().createElement(La.ZP,(0,b.Z)({},dt,{width:"920px",visible:n,title:r("trainingProject.liveClass.addLiveClass"),onCancel:Dt,footerType:"custom",renderCustomFooter:ft}),t().createElement("div",{className:ys()["add-live-class"]},n&&t().createElement(Sl,{changeCheckedList:Qe,defaultChecked:N,allChecked:J,editInfo:s.data,replaceStatus:se})))},ur=(0,E.Z)()(Pl),Dl=[{index:"materialCollection",description:$a.Z.t("trainingProject.addEdit.matter"),type:"courseware",showType:"courseware",icon:"icon-sucai",group:$a.Z.t("trainingProject.addEdit.courseContent"),list:[{index:"CoursewareSelector",description:$a.Z.t("trainingProject.addEdit.coursewareLibSelect"),addComponent:Ds.Z,editComponent:Ds.Z,type:"courseware",props:{image_text:"",replaceStatus:!1,resourceLocked:!1,allChecked:[],defaultChecked:[],filterQuota:!1}},{index:"ClNewUpload",description:$a.Z.t("trainingProject.addEdit.localUpload"),addComponent:Za.Z,editComponent:Za.Z,type:"bdsc",props:{}}]},{index:"CourseSelector",description:$a.Z.t("trainingProject.addEdit.courseLabel"),icon:"icon-kecheng2",addComponent:us.Z,editComponent:us.Z,type:"course",showType:"course",group:$a.Z.t("trainingProject.addEdit.courseContent"),props:{image_text:"",replaceStatus:!1,resourceLocked:!1,allChecked:[],defaultChecked:[],filterQuota:!1}},{index:"TwCourseSelector",description:$a.Z.t("trainingProject.addEdit.graphicManagement"),icon:"icon-tuwenke1",addComponent:us.Z,editComponent:us.Z,type:"twCourse",showType:"imageTextCourse",group:$a.Z.t("trainingProject.addEdit.courseContent"),props:{image_text:"true",replaceStatus:!1,resourceLocked:!1,allChecked:[],defaultChecked:[],filterQuota:!1}},{index:"LiveClass",description:$a.Z.t("live.live"),icon:"icon-zhiboke",addComponent:ur,editComponent:ur,showType:"liveClass",type:"liveClass",group:$a.Z.t("trainingProject.addEdit.courseContent"),props:{liveClassProps:{selectList:[],operateType:"add",tabPanes:[],activeTab:0}}},{index:"AddExam",description:$a.Z.t("trainingProject.addEdit.exam"),icon:"icon-kaoshi2",addComponent:Bs,editComponent:Bs,showType:"exam",type:"ex",group:$a.Z.t("trainingProject.addEdit.educationalTools"),props:{examProps:{}}},{index:"AddNewExam",description:$a.Z.t("trainingProject.addEdit.exam"),icon:"icon-kaoshi2",addComponent:As,editComponent:As,showType:"newExam",newType:!0,type:"ex",group:$a.Z.t("trainingProject.addEdit.educationalTools"),props:{examProps:{}}},{index:"AddPracticeBank",description:$a.Z.t("trainingProject.addEdit.practiceBank"),icon:"icon-lianxi1",addComponent:dr,editComponent:dr,showType:"practiceBank",newType:!0,type:"practice",group:$a.Z.t("trainingProject.addEdit.educationalTools"),props:{examProps:{}}},{index:"AddPracticeTest",description:$a.Z.t("trainingProject.addEdit.practiceExam"),icon:"icon-shicaozuoye1",iconColor:"#5DD69D",addComponent:Ca,editComponent:Ca,showType:"practice",type:"sc",group:$a.Z.t("trainingProject.addEdit.educationalTools"),props:{isHasTutor:!1}},{index:"OfflineTrain",description:$a.Z.t("trainingProject.addEdit.offline"),icon:"icon-xianxiake1",addComponent:ge,editComponent:ge,showType:"offline",type:"xx",group:$a.Z.t("trainingProject.addEdit.interactiveTools"),props:{editInfo:{}}},{index:"Attendance",description:$a.Z.t("trainingProject.addEdit.attendance"),icon:"icon-jieduankaoqin",showType:"attendance",addComponent:Vn,editComponent:Vn,type:"attendance",group:$a.Z.t("trainingProject.addEdit.interactiveTools"),props:{editInfo:{},activeTab:"".concat(new Date().getTime()),tabPanes:[{key:"".concat(new Date().getTime()),index:0,name:$a.Z.t("component.stage")+$a.Z.t("component.stageOne"),desc:"",list:[],inOrder:!0,studyTime:["",""],Standard:{progressCheck:!1,progress:100,examCheck:!1,examNum:0,bankCheck:!1,bankNum:0,practiceCheck:!1,practiceNum:0,jobEvaluationCheck:!1},reward:{getScoreChecked:!1,getScore:0,certificateChecked:!1,certificateId:"",certificateName:"",certificateImage:""}}]}},{index:"AddInvestigate",description:$a.Z.t("trainingProject.addEdit.investigate"),icon:"icon-tiaoyan",addComponent:ia,editComponent:ia,showType:"investigate",type:"investigate",group:$a.Z.t("trainingProject.addEdit.investigate")},{index:"AddMentorCoaching",description:$a.Z.t("trainingProject.addEdit.coach"),icon:"icon-fudao",addComponent:fn,editComponent:fn,type:"tutor",showType:"tutor",group:$a.Z.t("trainingProject.addEdit.coach"),props:{editInfo:{}}},{index:"AddAssessment",description:$a.Z.t("trainingProject.addEdit.assess"),icon:"icon-tuiguang",addComponent:Yn,editComponent:Yn,type:"assess",showType:"assess",group:$a.Z.t("trainingProject.addEdit.assess"),props:{editInfo:{}}},{index:"AddJobEvaluation",description:$a.Z.t("trainingProject.addEdit.jobEvaluation"),icon:"icon-gangweiceping1",showType:"jobEvaluation",addComponent:Na,editComponent:Na,type:"jobEvaluation",group:$a.Z.t("trainingProject.addEdit.evaluationTools"),props:{editInfo:{}}}],Xs=Dl,bl=e(16926),is=e.n(bl),Ol=Z=>{var r=Z.t,n=Z.resources,s=Z.jobEvaluationCount,i=Z.multipleMissedScore,u=Z.isHasTutor,f=Z.resourceType,N=Z.evaluateAssign,Y=Z.from,J=(0,l.useContext)(Ln),se=J.state,Ce=J.dispatch,Xe=(0,l.useState)(!1),ot=(0,Be.Z)(Xe,2),He=ot[0],dt=ot[1],it=(0,l.useState)({addComponent:t().Fragment,props:{}}),Dt=(0,Be.Z)(it,2),Qe=Dt[0],ft=Dt[1];(0,l.useEffect)(()=>{se.autoAddAttendance&&Xs.forEach(tt=>{tt.index==="Attendance"&&Ta((0,v.Z)((0,v.Z)({},tt),{},{isAttendance:!0}))})},[se.autoAddAttendance]),(0,l.useEffect)(()=>{se.attendanceClose||(Qe.props=(0,v.Z)((0,v.Z)({},Qe.props),{},{tabPanes:Z.value}),ft(Qe))},[se.attendanceClose,Z.value]);var kt=(0,l.useState)([]),xt=(0,Be.Z)(kt,2),Rt=xt[0],qt=xt[1];(0,l.useEffect)(()=>{Pa()},[f]);var Pa=()=>{localStorage.getItem("versionId")==="aad5d21977d541a9af77e5fb8cfa9ae8"?qt(["courseware","course","exam"]):qt(f)},sa=(0,l.useState)({}),ba=(0,Be.Z)(sa,2),oa=ba[0],Yt=ba[1];(0,l.useEffect)(()=>{if(Rt.length){var tt={};n.forEach(Ot=>{tt[Ot.group]&&Rt.indexOf(Ot.showType)!==-1?tt[Ot.group].push(Ot):Rt.indexOf(Ot.showType)!==-1&&(tt[Ot.group]=[Ot])}),Yt(tt)}},[Rt]);var Ta=tt=>{if(tt.index==="AddAssessment"&&N){ae.Z.confirm({title:r("common.tip"),content:r("trainingProject.assessment.addTip"),okText:r("common.ok"),cancelText:r("common.cancel"),icon:t().createElement(Q.Z,null),onOk:()=>{Ya(tt)},onCancel:()=>{}});return}else Ya(tt)},Ya=tt=>{var Ot=va(tt);if(!(s>0&&tt.index==="AddJobEvaluation")){var Pt="",ta=[];tt.index==="Attendance"&&(Pt=se.activeKey,ta=Z.value),tt.props=(0,v.Z)((0,v.Z)({},tt.props),{},{isEdit:!1,replaceStatus:!1,has_published:!1,multipleMissedScore:i,isHasTutor:u,editInfo:{},activeTab:Pt,tabPanes:ta,defaultChecked:[...Ot],evaluateAssign:N,isAttendance:tt.isAttendance}),ft(tt),setTimeout(()=>{dt(!0)},.2*1e3)}},va=tt=>{var Ot=Z.value.find(Pt=>Pt.key===se.activeKey);return Ot.list.filter(Pt=>Pt.type===tt.type)},Qa=function(Ot,Pt,ta){var wt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,$t=Ot;Pt==="ClNewUpload"&&($t=Ot.map(_a=>({id:_a.id,name:_a.name,duration:_a.duration,type:_a.type,originalType:_a.type,icon:$.e1[_a.originalType==="audio/mp3"?"mp3":_a.type],componentName:"CoursewareSelector",status:_a.status,data:(0,v.Z)({},_a)}))),Ce({type:"setResource",payload:{list:$t,closeVisible:wt,index:se.resourceIndex+1,type:Pt,typeKey:ta}}),!((Pt==="OfflineTrain"||Pt==="Attendance")&&!wt)&&dt(!1)},gs=tt=>t().createElement(Et.Z,null,tt.list.map(Ot=>t().createElement(Et.Z.Item,{key:Ot.index},t().createElement("div",{className:is()["group-content-container-item"],onClick:()=>Ta(Ot,Ot.index)},t().createElement("div",{className:is()["group-content-container-item__description"]},Ot.description))))),Aa=[];for(var ls in oa)if(oa.hasOwnProperty.call(oa,ls)){var Ja=oa[ls];Aa.push(t().createElement("div",{className:is()["group-container"],key:ls},t().createElement("div",{className:is()["group-content"]},Ja.map(tt=>t().createElement(t().Fragment,null,tt.newType?t().createElement(Pe.Z,{offset:[-60,3],color:"#ED2B2B",count:t().createElement("span",{className:is()["badge-new-tag"]},"new")},t().createElement("div",{className:is()["group-content-container-item"],key:tt.index,onClick:()=>Ta(tt,tt.index)},t().createElement(S.Z,{size:"16px",color:tt.iconColor||"#000000",iconClass:tt.icon}),t().createElement("div",{className:is()["group-content-container-item__description"]},tt.description))):t().createElement(t().Fragment,null,tt.index==="materialCollection"&&Rt.indexOf("courseware")!==-1?t().createElement(pa.Z,{overlayClassName:is()["dropdown-box"],overlay:()=>gs(tt)},t().createElement("div",{className:is()["group-content-container-item"],key:tt.index},t().createElement(S.Z,{size:"16px",color:tt.iconColor||"#000000",iconClass:tt.icon}),t().createElement("div",{className:is()["group-content-container-item__description"]},tt.description))):t().createElement(t().Fragment,null,tt.index==="AddJobEvaluation"&&Rt.indexOf("jobEvaluation")!==-1?t().createElement(c.Z,{title:r("trainingProject.addEdit.evaluationToolsTips")},t().createElement("div",{key:tt.index,className:s>0?"".concat(is()["group-content-container-disable"]," ").concat(is()["group-content-container-item"]):is()["group-content-container-item"],onClick:()=>Ta(tt,tt.index)},t().createElement(S.Z,{size:"16px",color:tt.iconColor||"#000000",iconClass:tt.icon}),t().createElement("div",{className:is()["group-content-container-item__description"]},tt.description))):t().createElement(t().Fragment,null,Rt.indexOf(tt.showType)!==-1?t().createElement("div",{key:tt.index,className:is()["group-content-container-item"],onClick:()=>Ta(tt,tt.index)},t().createElement(S.Z,{size:"16px",color:tt.iconColor||"#000000",iconClass:tt.icon}),t().createElement("div",{className:is()["group-content-container-item__description"]},tt.description)):null))))))))}var ds=(0,l.useRef)(null),Ps=(0,l.useState)(0),ns=(0,Be.Z)(Ps,2),cs=ns[0],vs=ns[1],os=(0,l.useState)(!0),Ea=(0,Be.Z)(os,2),la=Ea[0],es=Ea[1],ea=()=>{es(!la)};(0,l.useLayoutEffect)(()=>(ds&&ds.current&&(Da(),window.addEventListener("resize",Da)),()=>{window.removeEventListener("resize",Da)}),[Da]);var Da=(0,ve.Ds)(()=>{setTimeout(()=>{var tt=document.getElementById("study-stages-btn-box"),Ot=tt.clientHeight;vs(Ot),Ot>50?es(!1):es(!0)},100)},200),Bt=(0,l.useRef)(null),ra=(0,l.useState)(!1),Ye=(0,Be.Z)(ra,2),vt=Ye[0],It=Ye[1];(0,l.useEffect)(()=>{if(Bt&&Bt.current){var tt=document.getElementById("page-form");tt.addEventListener("scroll",nt)}return()=>{var Ot=document.getElementById("page-form");Ot.removeEventListener("scroll",nt)}},[Bt,nt]);var nt=(0,l.useCallback)(tt=>{var Ot=tt.target.scrollTop;Ot>172?It(!0):It(!1)},[]);return t().createElement("div",{ref:Bt,className:"".concat(is()["component-container"]," ").concat(vt?is().active:"")},t().createElement("div",{className:is()["container-title"]},r("coolDesgin.addContent")),t().createElement("div",{ref:ds,className:"".concat(is()["container-content"]," ").concat(la?is()["container-content-pack"]:is()["container-content-unfold"])},t().createElement(p.Z,{size:[16,16],wrap:!0,id:"study-stages-btn-box"},Aa,la&&cs>50&&t().createElement("span",{className:is()["operate-btn"],onClick:ea},t().createElement("span",{className:is()["unfold-title"]},r("trainingProject.addEdit.collapse")),t().createElement(S.Z,{size:"11px",color:"color: #516AE6",iconClass:"icon-Line_Up"}))),la,!la&&cs>50&&t().createElement("span",{className:"".concat(is()["operate-btn"]," ").concat(is()["operate-line-down"]),onClick:ea},t().createElement("span",{className:is()["unfold-title"]},r("trainingProject.addEdit.expand")),t().createElement(S.Z,{size:"11px",color:"color: #516AE6",iconClass:"icon-Line_down"}))),t().createElement(Qe.addComponent,(0,b.Z)({visible:He,onCancel:()=>dt(!1),onOk:(tt,Ot)=>Qa(tt,Qe.index,Qe.type,Ot),from:Y},Qe.props)))},Il=(0,E.Z)()(Ol),Zl=e(81309),bs=e.n(Zl),Os=e(64334),Ll=(0,ve.me)(),mr=ke.Z[Ll].learning.validation,xl=(Z,r)=>{var n;return Z&&(r&&r.reward&&(r.reward.certificateChecked||r.reward.getScoreChecked)&&!Z.progressCheck&&!Z.examCheck&&!Z.bankCheck&&!Z.practiceCheck&&!Z.jobEvaluationCheck&&(n=mr.learningAddItemPassTip),(Z.progressCheck&&!Z.progress||Z.examCheck&&!Z.examNum||Z.bankCheck&&!Z.bankNum||Z.practiceCheck&&!Z.practiceNum)&&(n=mr.learningAddItemPass)),n},Nl=Z=>{var r=(0,be.eY)("MANAGEMENT_JOBEVALUATION_BUT"),n=Z.user.JobEvaluationOpen,s=Z.value,i=Z.stages,u=Z.t,f=Z.onStateChange,N=Z.shouldRenderedOperationCount,Y=(0,Os.z2)(i),J=(0,Os.NK)(i),se=(0,Os.Qz)(i),Ce=(0,Os.GM)(i),Xe=(0,Os.S1)(i),ot=(Qe,ft)=>{var kt=Qe.target.checked;switch(ft){case"progress":s.progressCheck=kt;break;case"exam":s.examCheck=kt;break;case"bank":s.bankCheck=kt;break;case"operation":s.practiceCheck=kt;break;case"jobEvaluation":s.jobEvaluationCheck=kt;break;default:break}f(s),Z.onFieldChange(s)},He=Qe=>{s.progress=Qe,f(s),Z.onFieldChange(s)},dt=Qe=>{s.examNum=Qe,f(s),Z.onFieldChange(s)},it=Qe=>{s.bankNum=Qe,f(s),Z.onFieldChange(s)},Dt=Qe=>{s.practiceNum=Qe,f(s),Z.onFieldChange(s)};return t().createElement("div",{className:bs()["qualified-standard"]},(se>0||se===0&&Y===0&&J===0&&Ce===0&&Xe===0)&&t().createElement("div",{className:bs()["qualified-standard-item"]},t().createElement(T.Z,{className:bs()["label-checkbox-button"],checked:s.progressCheck,onChange:Qe=>ot(Qe,"progress")},u("component.learningProgress")),t().createElement("span",{className:bs()["qualified-standard-title"]},u("trainingProject.addEdit.reach")),t().createElement(X.Z,{value:s.progress,disabled:!s.progressCheck,onChange:He,className:"qualified-standard-number-box",min:0,max:100,precision:0}),t().createElement("span",{className:bs()["qualified-standard-tip"]},"%")),Y>0&&t().createElement("div",{className:bs()["qualified-standard-item"]},t().createElement(T.Z,{className:bs()["label-checkbox-button"],checked:s.examCheck,onChange:Qe=>ot(Qe,"exam")},u("common.exam")),t().createElement("span",{className:bs()["qualified-standard-title"]},u("trainingProject.addEdit.pass")),t().createElement(X.Z,{disabled:!s.examCheck,className:"qualified-standard-number-box",value:s.examNum,onChange:dt,min:0,max:Y,precision:0}),t().createElement("span",{className:bs()["qualified-standard-tip"]},u("common.examUnit"))),J>0&&t().createElement("div",{className:bs()["qualified-standard-item"]},t().createElement(T.Z,{className:bs()["label-checkbox-button"],checked:s.bankCheck,onChange:Qe=>ot(Qe,"bank")},u("trainingProject.addEdit.practiceBank")),t().createElement("span",{className:bs()["qualified-standard-title"]},u("study.employeePass")),t().createElement(X.Z,{disabled:!s.bankCheck,className:"qualified-standard-number-box",value:s.bankNum,onChange:it,min:1,max:J,precision:0}),t().createElement("span",{className:bs()["qualified-standard-tip"]},u("common.examUnit"))),N&&Ce>0&&t().createElement("div",{className:bs()["qualified-standard-item"]},t().createElement(T.Z,{className:bs()["label-checkbox-button"],checked:s.practiceCheck,onChange:Qe=>ot(Qe,"operation")},u("common.operation")),t().createElement("span",{className:bs()["qualified-standard-title"]},u("trainingProject.addEdit.pass")),t().createElement(X.Z,{value:s.practiceNum,disabled:!s.practiceCheck,className:"qualified-standard-number-box",onChange:Dt,min:0,max:Ce,precision:0}),t().createElement("span",{className:bs()["qualified-standard-tip"]},u("common.examUnit"))),r&&n&&Xe>0&&t().createElement("div",{className:bs()["qualified-standard-item"]},t().createElement(T.Z,{className:bs()["label-checkbox-button"],checked:s.jobEvaluationCheck,onChange:Qe=>ot(Qe,"jobEvaluation")},u("learning.jobEvaluation"))),t().createElement("div",{className:bs()["qualified-standard-item-tip"]},u("trainingProject.addEdit.stageQualifiedTip")))},Ml=Z=>{var r=Z.user;return{user:r}},kl=(0,h.$j)(Ml)((0,Ke.Z)((0,E.Z)()(Nl))),Al=e(19338),Is=e.n(Al),Rl=(0,ve.me)(),pr=ke.Z[Rl].learning.validation,Fl=Z=>{var r=Z.value,n=Z.isPreview,s=Z.t,i=Z.onStateChange,u=Z.formik,f=u.errors,N=u.touched,Y=(0,l.useState)({visible:!1,defaultChecked:[]}),J=(0,Be.Z)(Y,2),se=J[0],Ce=J[1],Xe=(0,l.useState)({width:0,height:0}),ot=(0,Be.Z)(Xe,2),He=ot[0],dt=ot[1];(0,l.useEffect)(()=>{r.getScoreChecked||it()},[it]);var it=(0,l.useCallback)(()=>{var sa=$.ZP.EditStudyTask.getScoreRule(),ba=Z.value;W.WY.get({url:sa}).then(oa=>{if(oa.data.data.hasRule){var Yt=oa.data.data.studyScore,Ta=Yt[0].finishScore;ba.getScore=Ta,Z.onFieldChange(ba),i(ba)}})},[Z]),Dt=()=>{Ce((0,v.Z)((0,v.Z)({},se),{},{visible:!0,defaultChecked:[{id:r.certificateId,name:r.certificateName,previewUrl:r.certificateImage}]}))},Qe=()=>{Ce((0,v.Z)((0,v.Z)({},se),{},{visible:!1}))},ft=sa=>{Qe(),r.certificateId=sa[0].id,r.certificateName=sa[0].name,r.certificateImage=sa[0].previewUrl,kt(sa[0].previewUrl),Z.onFieldChange(r),i(r)};(0,l.useEffect)(()=>{r.certificateImage&&kt(r.certificateImage)},[r.certificateImage]);var kt=sa=>{(0,ms.FX)(sa).then(ba=>{dt(ba)})},xt=sa=>{r.getScoreChecked=sa,Z.onFieldChange(r),i(r)},Rt=sa=>{r.certificateChecked=sa,Z.onFieldChange(r),i(r)},qt=sa=>{r.getScore=sa,Z.onFieldChange(r),i(r)},Pa=()=>{r.certificateId="",r.certificateName="",r.certificateImage="",Z.onFieldChange(r),i(r)};return t().createElement("div",{className:Is()["study-reward"]},t().createElement("div",{className:Is()["study-reward-item"]},t().createElement("span",{className:Is()["study-reward-switch-title"]},s("trainingProject.addEdit.rewardCredits")),t().createElement(ws.Z,{className:Is()["study-reward-checkbox"],defaultChecked:r.getScoreChecked,disabled:n,checkedChildren:s("trainingProject.addEdit.open"),unCheckedChildren:s("trainingProject.addEdit.close"),onChange:xt}),r.getScoreChecked&&t().createElement(t().Fragment,null,t().createElement(X.Z,{value:r.getScore,disabled:n,onChange:qt,min:0,max:999,precision:0,className:N.reward&&f.reward&&f.reward.scoreRewardChecked?Is()["status-error"]:""}),t().createElement("span",{className:Is()["study-reward-tip"]},s("trainingProject.addEdit.credit")))),t().createElement("div",{className:Is()["study-reward-item"]},t().createElement("span",{className:Is()["study-reward-switch-title"]},s("trainingProject.addEdit.awardCertificate")),t().createElement(ws.Z,{className:Is()["study-reward-checkbox"],defaultChecked:r.certificateChecked,checkedChildren:s("trainingProject.addEdit.open"),unCheckedChildren:s("trainingProject.addEdit.close"),disabled:n,onChange:Rt}),r.certificateChecked&&t().createElement(t().Fragment,null,r.certificateId?t().createElement("div",{className:"".concat(Is()["study-reward-list"]," ").concat(He.height>He.width?Is().vertical:Is().transverse)},t().createElement("img",{src:r.certificateImage,alt:"image",className:Is()["study-image-box"]}),t().createElement("div",{className:Is()["operate-container"]},t().createElement("span",{className:Is()["operate-item"],onClick:Dt},s("common.replace")),t().createElement("span",{className:Is()["operate-item"],onClick:Pa},s("common.delete")))):t().createElement(y.Z,{type:"link",icon:t().createElement(S.Z,{iconClass:"iconf-craditranking",size:"14px"}),disabled:n,className:Is()["study-reward-button"],onClick:Dt},s("trainingProject.addEdit.learningAddRewardCertSelect")))),N.reward&&f.reward&&t().createElement("div",{style:{lineHeight:"18px"},className:Is().tip_error_msg},f.reward.msg),t().createElement(ja.Z,(0,b.Z)({},se,{onCancel:Qe,onOk:ft})))},wl=Z=>{var r={};return(!Z||Z.certificateChecked&&!Z.certificateId)&&(r=(0,v.Z)((0,v.Z)({},r),{},{certificateChecked:!0,msg:pr.learningAddItemRewardCert})),Z.getScoreChecked&&!Z.getScore&&(r=(0,v.Z)((0,v.Z)({},r),{},{scoreRewardChecked:!0,msg:pr.qualifiedCredits})),Object.keys(r).length?r:""},Ul=(0,Ke.Z)((0,m.$j)((0,E.Z)()(Fl))),Ed=e(66456),Qn=e(55313),_d=e(62350),Bl=e(75443),Gn=e(95742),Wl=e(80454),Kl=e.n(Wl),$l=e(88339),Zs=e.n($l),Vl=e(19654),jl=e(2019),hr=ae.Z.confirm,Nn=(0,ve.me)(),Ws=ke.Z[Nn].validation,zl=(Z,r)=>Z.sort(function(n,s){return n[r]<s[r]?-1:n[r]>s[r]?1:0}),Yl=(Z,r)=>{var n,s=r&&r.dateRange?r.dateRange:{},i=r.stages,u=i.find(nt=>nt.key===Z)||{},f=u.list||[];f.length===0&&(n=Ws.checkStageTaskNull);var N=i.reduce((nt,tt)=>nt.concat(tt.list.filter(Ot=>Ot.type!=="ex"&&Ot.type!=="practice"&&Ot.type!=="xx"&&Ot.type!=="attendance"&&Ot.type!=="sc"&&Ot.type!=="tutor"&&Ot.type!=="investigate"&&Ot.type!=="assess")),[]),Y=[];if(i.forEach((nt,tt)=>{nt.list.forEach(Ot=>{N.filter(Pt=>Pt.id===Ot.id).length>1&&Y.findIndex(Pt=>Pt.id===Ot.id)===-1&&Y.push({name:Ot.name,id:Ot.id,key:nt.key,index:tt})})}),Y.length>0){var J=Y.map(nt=>"\u300A".concat(nt.name,"\u300B"));n=(0,ve.ZT)("".concat(Ws.checkStageTaskStageRepeat),"".concat(J.join("\u3001")))}else{var se=1;i.findIndex((nt,tt)=>{nt.key===Z&&(se=tt+1)});var Ce=f.reduce((nt,tt)=>(tt.type==="xx"&&nt.push(tt),nt),[]),Xe=[];i.forEach((nt,tt)=>{Xe=Xe.concat(nt.list.map((Ot,Pt)=>(0,v.Z)((0,v.Z)({},Ot),{},{index:Pt+1,paneIndex:tt+1})))});for(var ot=Xe.filter(nt=>nt.type==="xx"),He=[],dt=0;dt<ot.length;dt++){var it=ot[dt].data.dateRange;He.push({sTime:(0,ve.jZ)(it.startTime),startTime:it.startTime,endTime:it.endTime,eTime:(0,ve.jZ)(it.endTime),index:ot[dt].index,panelIndex:ot[dt].paneIndex})}for(var Dt=He.sort((nt,tt)=>nt.sTime-tt.sTime),Qe=!1,ft=[],kt=1;kt<Dt.length;kt++){var xt=Dt[kt-1],Rt=Dt[kt];(xt.sTime===Rt.sTime||Rt.sTime<xt.eTime)&&(ft.push(xt,Rt),Qe=!0)}var qt=[],Pa=[];if(ft.forEach(nt=>{qt.push(nt.panelIndex)}),qt=[...new Set(qt)],qt.forEach(nt=>{var tt=[];ft.forEach(Ot=>{nt===Ot.panelIndex&&tt.push(Ot.index)}),Pa.push([...new Set(tt)].sort((Ot,Pt)=>Ot-Pt))}),Qe&&(qt=qt.map((nt,tt)=>({paneIndex:nt,index:tt})),qt=zl(qt,"paneIndex"),qt&&se===qt[0].paneIndex))if(qt.length===1)n=$a.Z.t(Ws.projectOfflineTimeConflict,{key:Pa[0].join("\u3001")});else{var sa="";qt.forEach((nt,tt)=>{Nn==="en_us"?sa+="Offline classes of No. ".concat(Pa[nt.index].join("\u3001")," in stage  ").concat(nt.paneIndex," ").concat(tt<qt.length-1?"\uFF0C":""):Nn==="zh_cn"?sa+="\u9636\u6BB5".concat(nt.paneIndex,"\u4E2D\u7684\u5E8F\u53F7").concat(Pa[nt.index].join("\u3001"),"\u7684\u7EBF\u4E0B\u8BFE").concat(tt<qt.length-1?"\uFF0C":""):sa+="\u968E\u6BB5".concat(nt.paneIndex,"\u4E2D\u7684\u5E8F\u865F").concat(Pa[nt.index].join("\u3001"),"\u7684\u7DDA\u4E0B\u8AB2").concat(tt<qt.length-1?"\uFF0C":"")}),Nn==="en_us"?sa=sa+"conflict with each other,Please reset":sa=sa+Ws.timeConflict,n=sa}if(Ce.length){var ba=s.startTime,oa=s.endTime;if(ba&&oa){var Yt=Ce.map(nt=>nt.data),Ta=Ce.filter(nt=>!nt.id).map(nt=>nt.data),Ya=[],va=[];Yt.forEach(nt=>{Ya.push(nt.dateRange.startTime),Ya.push(nt.dateRange.endTime)}),Ta.forEach(nt=>{va.push(nt.dateRange.startTime),va.push(nt.dateRange.endTime)});var Qa=Ya.sort(),gs=va.sort();(Qa[0]<Ee()(ba).valueOf()||Qa[Qa.length-1]>Ee()(oa).valueOf())&&(n=Ws.classTimeRange);for(var Aa=0;Aa<gs.length;Aa++){var ls=gs[Aa];ls<new Date().getTime()&&(n=Ws.classTimeBeyond)}}}if(Ce.length){var Ja=[];Ce.forEach(nt=>{Ja.push(nt.name)});var ds=Ja.sort();if(ds.length)for(var Ps=0;Ps<ds.length-1;Ps++)ds[Ps]==ds[Ps+1]&&(n=(0,ve.ZT)("".concat(Ws.classNameRepeat),"\u300A".concat(ds[Ps],"\u300B")))}var ns=f.reduce((nt,tt)=>(tt.type==="attendance"&&nt.push(tt),nt),[]);if(Ce.length&&!ns.length&&(n=(0,ve.ZT)("".concat(Ws.addAttendanceTips),"".concat(Ws.thisPhase))),ns.length){var cs=[];ns.forEach(nt=>{cs.push(nt.name)});var vs=cs.sort();if(vs.length)for(var os=0;os<vs.length-1;os++)vs[os]==vs[os+1]&&(n=(0,ve.ZT)("".concat(Ws.attendanceNameRepeat),"\u300A".concat(vs[os],"\u300B")))}if(ns.length){var Ea=s.startTime,la=s.endTime;if(Ea&&la){var es=ns.map(nt=>nt.data),ea=ns.filter(nt=>!nt.id).map(nt=>nt.data),Da=[],Bt=[];es.forEach(nt=>{nt.sign_in_begin_time&&Da.push(nt.sign_in_begin_time),nt.sign_in_end_time&&Da.push(nt.sign_in_end_time),nt.sign_out_begin_time&&Da.push(nt.sign_out_begin_time),nt.sign_out_end_time&&Da.push(nt.sign_out_end_time)}),ea.forEach(nt=>{nt.sign_in_begin_time&&Bt.push(nt.sign_in_begin_time),nt.sign_in_end_time&&Bt.push(nt.sign_in_end_time),nt.sign_out_begin_time&&Bt.push(nt.sign_out_begin_time),nt.sign_out_end_time&&Bt.push(nt.sign_out_end_time)});var ra=Da.map(nt=>Ee()(nt).valueOf()).sort(),Ye=Bt.map(nt=>Ee()(nt).valueOf()).sort();(ra[0]<Ee()(Ea).valueOf()||ra[ra.length-1]>Ee()(la).valueOf())&&(n=Ws.attendanceTimeRange);for(var vt=0;vt<Ye.length;vt++){var It=Ye[vt];It<new Date().getTime()&&(n=Ws.attendanceTimeBeyond)}}}}return n},Ql=(0,Gn.gU)(Z=>t().createElement("tr",Z)),Gl=(0,Gn.hv)(Z=>t().createElement("tbody",Z)),vr=["CoursewareSelector","CourseSelector","TwCourseSelector","LiveClass"],Hl=Z=>{var r=Z.value,n=Z.formValue,s=Z.t,i=Z.isHasTutor,u=Z.jobEvaluationEdit,f=Z.deleteModal,N=Z.evaluateAssign,Y=Z.from,J=(0,l.useContext)(Ln),se=J.state,Ce=J.dispatch,Xe=(0,l.useState)([]),ot=(0,Be.Z)(Xe,2),He=ot[0],dt=ot[1],it=(0,l.useState)({editComponent:t().Fragment,props:{}}),Dt=(0,Be.Z)(it,2),Qe=Dt[0],ft=Dt[1],kt=(0,l.useState)(!1),xt=(0,Be.Z)(kt,2),Rt=xt[0],qt=xt[1],Pa=(0,l.useState)([]),sa=(0,Be.Z)(Pa,2),ba=sa[0],oa=sa[1],Yt=[{title:s("common.number"),dataIndex:"id",width:72,align:"center",className:"index-content-list",render:function(){for(var vt=arguments.length,It=new Array(vt),nt=0;nt<vt;nt++)It[nt]=arguments[nt];var tt=It[2];return t().createElement("span",null,tt+1)}},{title:s("study.type"),dataIndex:"type",width:116,className:"type-content-list",render:(Ye,vt)=>gs(Ye,vt)},{title:s("common.name"),dataIndex:"name",ellipsis:!0,width:250,className:"name-content-list",render:(Ye,vt)=>t().createElement("div",{onClick:()=>{Qa(vt)},className:vt.type==="courseware"?Zs()["content-name"]:""},vt.resourceErrTip?Aa(Ye,vt):t().createElement(c.Z,{overlayClassName:Zs()["tooltip-overlay"],placement:"topLeft",title:Aa(Ye,vt)},Aa(Ye,vt)))},{title:s("trainingProject.addEdit.contentLength"),dataIndex:"duration",width:140,className:"duration-content-list",render:(Ye,vt)=>ls(vt)}],Ta=Ye=>Ye&&Ye<Ee()().subtract(1,"days").endOf("day"),Ya=[{title:"",dataIndex:"unlocking_time",className:"unlocking_time-content-list",render:(Ye,vt,It)=>t().createElement(t().Fragment,null,vt.type==="xx"||vt.type==="attendance"||vt.type==="liveClass"?null:t().createElement(Le.Z,{format:"YYYY-MM-DD HH:mm",defaultValue:Ye?Ee()(Ye):void 0,placeholder:s("trainingProject.addEdit.unlockTime"),disabledDate:Ta,showTime:!0,size:"small",allowClear:!0,style:{width:"156px"},suffixIcon:t().createElement(S.Z,{size:"16px",color:"color: #516AE6",iconClass:"icon-jiesuoshijian"}),onChange:(nt,tt)=>Ps(nt,tt,It)}))}],va=[{title:"",align:"right",width:90,className:"operate-content-list",render:function(){for(var vt=arguments.length,It=new Array(vt),nt=0;nt<vt;nt++)It[nt]=arguments[nt];var tt=It[1],Ot=It[2],Pt=tt.type==="xx"||tt.type==="attendance"&&tt.data.relate_course_list.length;return t().createElement(p.Z,{className:Zs()["drag-operation"]},vr.indexOf(tt.componentName)>-1?t().createElement(c.Z,{placement:"top",title:s("trainingProject.addEdit.replaceResources")},t().createElement("span",{onClick:()=>ns(tt,Ot,"replaced")},t().createElement(S.Z,{iconClass:"icon-qiehuanqiye1",size:"16px"}))):t().createElement(c.Z,{placement:"top",title:s("trainingProject.addEdit.edit")},t().createElement("span",{onClick:()=>vs(tt,Ot)},t().createElement(S.Z,{iconClass:"icon-bianji",size:"15px"}))),t().createElement(c.Z,{placement:"top",title:s("trainingProject.addEdit.delete")},f||Pt?t().createElement("span",{onClick:()=>os(tt)},t().createElement(S.Z,{iconClass:"icon-shanchu",size:"16px"})):t().createElement(Bl.Z,{placement:"topLeft",title:s("component.removeFromStageTip"),onConfirm:()=>Ea(tt),okText:s("common.ok"),cancelText:s("common.cancel")},t().createElement("span",null,t().createElement(S.Z,{iconClass:"icon-shanchu",size:"16px"})))),t().createElement(ds,null))}}],Qa=Ye=>{var vt=Vl.Z.init(Ye.data.resource||Ye.data);Z.viewResource(vt)},gs=(Ye,vt)=>vt.resourceErrTip?null:t().createElement(t().Fragment,null,Xs.filter(It=>It.type===Ye)[0]?t().createElement("span",null,t().createElement(S.Z,{iconClass:Xs.filter(It=>It.type===Ye)[0].icon,size:"14px"}),t().createElement("span",{className:Zs()["type-title"]},Xs.filter(It=>It.type===Ye)[0].description)):""),Aa=(Ye,vt)=>{var It=null;if(vt.type==="xx"&&(It=t().createElement(t().Fragment,null,vt.data.teacher.name&&vt.data.teacher.teacher_sync_user_id&&t().createElement("div",{className:"resource-item-user-name"},s("component.lecturer"),"\uFF1A",t().createElement(L.Z,{dataType:"userName",value:vt.data.teacher.teacher_sync_user_id,name:vt.data.teacher.name,type:vt.data.teacher.teacher_sync_source_type})))),vt.type==="attendance"){var nt,tt=((nt=vt.data)===null||nt===void 0?void 0:nt.directors)||[],Ot=tt.map(wt=>wt.user_name||wt.name).join(","),Pt=tt.map(wt=>wt.sync_user_id||wt.user_id).join(",");It=t().createElement(t().Fragment,null,Ot&&Pt&&t().createElement("div",{className:"resource-item-user-name"},s("lineClass.principal"),"\uFF1A",tt.map((wt,$t)=>t().createElement("div",{key:wt.user_id,style:{display:"inline-block"}},t().createElement(L.Z,{dataType:"userName",value:wt.sync_user_id||wt.user_id,name:wt.user_name||wt.name,type:wt.sync_source_type||wt.source_type}),$t===tt.length-1?"":","))))}vt.type==="liveClass"&&(It=t().createElement("div",{className:"resource-item-user-name"},s("component.lecturer"),": ",vt.data.teacherName));var ta=null;return vt.resourceErrTip&&(ta=t().createElement("span",{className:Zs()["resource-item-error"]},t().createElement(S.Z,{iconClass:"icon-icon_attentionx1",size:"14px"}),vt.resourceErrTip)),ta||t().createElement("span",null,t().createElement("span",{className:Zs()["project-resource-name"]},Ye),It,Ja(vt))},ls=Ye=>{var vt=Ye.data,It=vt===void 0?{}:vt,nt=It.resourceSourceType?It.resourceSourceType:"",tt=It.source_type?It.source_type:nt;return console.warn(Ye,"\u6E32\u67D3\u9636\u6BB5\u5185\u5BB9"),tt!==8&&Ye.duration!=="0"&&(Ye.status===3&&(Ye.originalType==="mp4"||Ye.originalType==="mp3")||Ye.type==="course"||Ye.type==="ex")?t().createElement("span",{className:"resource-item-duration-title"},(0,ve.xj)(Ye.duration)):Ye.originalType==="html"||$.WB.includes(Ye.originalType)||Ye.originalType==="scorm"?t().createElement("span",{className:"resource-item-duration"},t().createElement("span",{className:Zs()["time-title"]},s("trainingProject.addEdit.noTime"))):Ye.type==="xx"?t().createElement("span",{className:"resource-item-duration-title"},(0,ve.xj)(Ye.data.course_duration*60)):Ye.type==="liveClass"?t().createElement(t().Fragment,null,Ye.data.duration==="0"?t().createElement("span",{className:"resource-item-duration"},t().createElement("span",{className:Zs()["time-title"]},s("trainingProject.addEdit.noTime"))):t().createElement("span",{className:"resource-item-duration-title"},(0,jl.g9)(Ye.data.duration))):Ye.type==="investigate"||Ye.type==="sc"||Ye.type==="operation"||Ye.type==="jobEvaluation"||Ye.type==="h5"||Ye.originalType==="h5"||Ye.type==="tutor"||Ye.type==="attendance"||Ye.type==="assess"?t().createElement("span",{className:"resource-item-duration"},t().createElement("span",{className:Zs()["time-title"]},s("trainingProject.addEdit.noTime"))):Ye.status&&Ye.status!==3?t().createElement("span",{className:"resource-item-duration"},t().createElement("span",{className:Zs()["time-title"]},s("trainingProject.addEdit.noTime")),t().createElement(c.Z,{placement:"top",title:s("course.transcodingStudyLimit")},t().createElement("span",null,t().createElement(S.Z,{iconClass:"icon-f-tipe",color:"#9C9C9F"})))):t().createElement("span",{className:"resource-item-duration"},t().createElement("span",{className:Zs()["time-title"]},s("trainingProject.addEdit.noTime")))},Ja=Ye=>{if(Ye.type==="xx"&&Ye.data.dateRange&&Ye.data.dateRange.startTime&&Ye.data.dateRange.endTime)return t().createElement("div",{className:"resource-item-duration"},s("practiceOperation.classStartTime"),":"," ",(0,be.yM)(+new Date(Ye.data.dateRange.startTime),+new Date(Ye.data.dateRange.endTime)));if(Ye.type==="attendance")return t().createElement("div",{className:"resource-item-attendance"},(Ye.data.sign_in_begin_time||Ye.data.sign_in_end_time)&&t().createElement("div",{className:Zs()["resource-item-attendance-span"]},s("lineClass.signInTime"),":"," ",(0,be.yM)(+new Date(Ye.data.sign_in_begin_time),+new Date(Ye.data.sign_in_end_time))),(Ye.data.sign_out_begin_time||Ye.data.sign_out_end_time)&&t().createElement("div",{className:Zs()["resource-item-attendance-span"]},s("lineClass.signBack"),":"," ",(0,be.yM)(+new Date(Ye.data.sign_out_begin_time),+new Date(Ye.data.sign_out_end_time))));if(Ye.type==="liveClass")return t().createElement("div",{className:"resource-item-duration"},t().createElement("div",null,s("live.liveTime"),":",Ye.data.startTime&&Ye.data.endTime===0?Ee()(Ye.data.startTime*1).format("YYYY-MM-DD HH:mm"):"",Ye.data.startTime&&Ye.data.endTime!==0?(0,be.yM)(Ye.data.startTime,Ye.data.endTime):""))};(0,l.useEffect)(()=>{n.studyMode==="free"?oa([...Yt,...Ya,...va]):n.studyMode==="map"&&oa([...Yt,...va])},[n.studyMode,n.stages,He,se.activeKey]),(0,l.useEffect)(()=>{var Ye=r.map((vt,It)=>(0,v.Z)((0,v.Z)({},vt),{},{index:It}));dt(Ye)},[r]);var ds=(0,Gn.JV)(()=>t().createElement(c.Z,{placement:"top",title:s("trainingProject.addEdit.drag")},t().createElement("span",{className:Zs()["resource-item-sort"]},t().createElement(S.Z,{iconClass:"icon-tuozhuai1",size:"16px"})))),Ps=(Ye,vt,It)=>{He[It].unlocking_time=vt,dt(He),Z.onStateChangeCal(He)},ns=(Ye,vt,It)=>{Ye.componentName==="AddAssessment"&&N?hr({title:s("common.tip"),icon:t().createElement(z.Z,null),content:s("trainingProject.assessment.editTip"),onOk(){cs(Ye,vt,It)}}):cs(Ye,vt,It)},cs=function(){var Ye=(0,K.Z)(d().mark(function vt(It,nt,tt){var Ot,Pt,ta,wt;return d().wrap(function(_a){for(;;)switch(_a.prev=_a.next){case 0:if(Ot={},It.type==="courseware"?Ot=Xs.filter(Ma=>Ma.index==="materialCollection")[0].list[0]:It.type==="twCourse"?Ot=Xs.filter(Ma=>Ma.index==="TwCourseSelector")[0]:Ot=Xs.filter(Ma=>Ma.index===It.componentName)[0],tt==="replaced"&&!He[nt].replaced_old_id&&(He[nt].replaced_old_id=It.id),Ot.props=(0,v.Z)((0,v.Z)({},Ot.props),{},{isHasTutor:i,editInfo:It,isEdit:!0,dataIndex:nt,replaceStatus:!0,allChecked:He,defaultChecked:vr.indexOf(It.componentName)>-1?[It]:[],evaluateAssign:N}),It.type==="ex"?Ot.props.has_published=u:It.type==="jobEvaluation"?Ot.props.isEdit=u:It.type==="liveClass"&&(Ot.props.liveClassProps.operateType="replace",Ot.props.liveClassProps.tabPanes=n.stages,Ot.props.liveClassProps.activeTab=se.activeKey),It.type==="attendance"&&(Ot.props.tabPanes=n.stages,Ot.props.activeTab=se.activeKey),It.type!=="jobEvaluation"){_a.next=12;break}return _a.next=9,(0,rr.wp)({modelId:Ot.props.editInfo.data.evaluationTools.model_id,productId:Ot.props.editInfo.data.evaluationTools.product_id});case 9:Pt=_a.sent,ta=Pt.data.data.product_name,Ot.props.editInfo.data.evaluationTools.product_name=ta;case 12:It.componentName==="AddExam"&&(wt=[],bt()(It,"data.reExam.userJoin",!0)&&(wt=["questionsMode","passLine","markType","drawQuestionsSwitch","weightInput"]),Ot.props.examProps={disabledFields:wt},delete Ot.props.isEdit),ft(Ot),setTimeout(()=>{qt(!0)},.1*1e3);case 15:case"end":return _a.stop()}},vt)}));return function(It,nt,tt){return Ye.apply(this,arguments)}}(),vs=ns,os=Ye=>{if(Ye.type==="xx"){var vt=Ye.id||Ye.key;He.forEach(tt=>{if(tt.type==="attendance"){for(var Ot=tt.data.relate_course_list,Pt=0;Pt<Ot.length;Pt++){var ta=Ot[Pt];if((ta.course_id||ta.course_key)===vt){tt.data.relate_course_list.splice(Pt,1);break}}tt.data.relate_course=!!tt.data.relate_course_list.length}})}var It=s("study.studyContentDeleteTip");if(Ye.type==="xx"&&Ye.data.user_has_attendanted)It=s("lineClass.delClassTips");else if(Ye.type==="attendance")if(Ye.data.relate_course_list.length){var nt="";Ye.data.relate_course_list.forEach(tt=>{nt+="\u300A".concat(tt.course_name,"\u300B")}),Ye.data.user_has_attendanted?It=s("lineClass.delAttendanceTips",{classListName:nt}):It=s("lineClass.delAttendanceTipsNoCourse",{classListName:nt})}else Ye.data.user_has_attendanted&&(It=s("lineClass.delSingleAttendanceTips"));hr({title:s("common.tip"),icon:t().createElement(z.Z,null),content:It,onOk(){Ea(Ye)}})},Ea=Ye=>{var vt=He.filter(It=>It.index!==Ye.index);dt(vt.map((It,nt)=>(0,v.Z)((0,v.Z)({},It),{},{index:nt}))),Z.onStateChange(vt)},la=function(vt,It){var nt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(vt.componentName==="OfflineTrain"){var tt=He.filter(wt=>wt.componentName==="Attendance");tt.forEach(wt=>{wt.data.relate_course_list.forEach($t=>{($t.course_key||$t.course_id)===(vt.key||vt.id)&&($t.course_name=vt.name)})})}Ce({type:"setAttendanceClose",payload:nt}),vt.componentName==="OfflineTrain"&&!es(vt.id||vt.key)&&nt&&ae.Z.confirm({title:s("common.tip"),content:t().createElement("div",null,s("lineClass.linkAttendanceTip")),okText:s("common.ok"),cancelText:s("common.cancel"),onOk:()=>{Ce({type:"setAutoAddAttendance",payload:"".concat(new Date().getTime())})}});var Ot=vt;Array.isArray(vt)&&(Ot=vt[0]),Ot.unlocking_time=He[It].unlocking_time,Ot.type=He[It].type,He[It].replaced_old_id&&(Ot.replaced_old_id=He[It].replaced_old_id);var Pt=[...He];if(vt.componentName==="OfflineTrain"||vt.componentName==="Attendance"){var ta=!0;He.forEach(wt=>{(wt.key||wt.id)===vt.key&&(ta=!1)}),ta?Pt.push(Ot):Pt.splice(It,1,Ot)}else Pt.splice(It,1,Ot);dt(Pt.map((wt,$t)=>(0,v.Z)((0,v.Z)({},wt),{},{index:$t}))),Z.onStateChange(Pt),!((vt.componentName==="OfflineTrain"||vt.componentName==="Attendance")&&!nt)&&qt(!1)},es=Ye=>{var vt=He.filter(nt=>nt.componentName==="Attendance"),It=!1;return vt.map(nt=>{nt.data.relate_course_list.map(tt=>{(tt.course_key||tt.course_id)===Ye&&(It=!0)})}),It},ea=Ye=>{var vt=Ye.oldIndex,It=Ye.newIndex;if(vt!==It){var nt=Kl()([].concat(He),vt,It).filter(tt=>!!tt);dt(nt),Z.onStateChangeCal(nt)}},Da=Ye=>t().createElement(Gl,(0,b.Z)({useDragHandle:!0,disableAutoscroll:!0,helperClass:Zs()["row-dragging"],onSortEnd:ea},Ye)),Bt=Ye=>{var vt=Ye.style,It=(0,ce.Z)(Ye,["style"]),nt=He.findIndex(tt=>tt.index===It["data-row-key"]);return t().createElement(Ql,(0,b.Z)({index:nt},It))},ra=(0,l.useMemo)(()=>t().createElement(t().Fragment,null," ",He.length?t().createElement(Qn.Z,{pagination:!1,columns:ba,dataSource:He,size:"small",rowKey:"index",scroll:{y:390},className:Zs()["content-list-box"],components:{body:{wrapper:Da,row:Bt}}}):t().createElement("div",{className:Zs()["content-list-empty-box"]},t().createElement(Lt.Z,{image:Lt.Z.PRESENTED_IMAGE_SIMPLE,description:s("trainingProject.addEdit.addStageContent")}))),[He,ba]);return t().createElement("div",{className:Zs()["content-list"]},ra,t().createElement(Qe.editComponent,(0,b.Z)({visible:Rt,onCancel:()=>qt(!1),onOk:(Ye,vt)=>{la(Ye,Qe.props.dataIndex,vt)},from:Y},Qe.props)))},Xl=()=>{},Jl=(0,h.$j)(Xl)((0,Ke.Z)((0,E.Z)()(Hl))),ql=e(74041),En=e.n(ql),eo=Z=>{var r=Z.t,n=Z.value,s=Z.tipHTML,i=Z.isPreview,u=Z.onStateChange,f=N=>{Z.onFieldChange(N),u(N)};return t().createElement("div",{className:En()["switch-reward"]},t().createElement("div",{className:En()["switch-reward-item"]},t().createElement(ws.Z,{className:En()["switch-reward-checkbox"],checked:n,checkedChildren:r("trainingProject.addEdit.open"),unCheckedChildren:r("trainingProject.addEdit.close"),disabled:i,onChange:f}),t().createElement(c.Z,{placement:"right",title:s,overlayClassName:En()["tooltip-overlay"]},t().createElement("span",{className:En()["toolTip-span"]},t().createElement(Q.Z,{style:{fontSize:"16px",color:"rgba(0, 0, 0, 0.45)"}})))))},to=(0,Ke.Z)((0,E.Z)()(eo)),ao=e(7160),Ys=e.n(ao),hn={labelCol:{xs:{span:24},sm:{span:2}}},Hn=(0,ve.me)(),so=(Z,r)=>{var n=Z.t,s=Z.itemVal,i=Z.formValue,u=Z.deleteModal,f=Z.isHasTutor,N=Z.tabList,Y=Z.jobEvaluationEdit,J=Z.evaluateAssign,se=Z.from,Ce=(0,l.useRef)(null);(0,l.useImperativeHandle)(r,()=>({checkValidate:()=>new Promise(Qe=>{Ce&&Ce.current?(Ce.current.setSubmitting(!0),Ce.current.validateForm().then(ft=>{JSON.stringify(ft)==="{}"?Qe({key:s.key,error:!1,res:{}}):(Qe({key:s.key,error:!0,res:ft}),Dt(ft),Object.keys(ft).forEach(kt=>{Ce.current.setFieldTouched(kt)}))})):Qe({key:s.key,error:!1,res:{}})}),setValue:(Qe,ft)=>{Ce&&Ce.current&&Ce.current.setFieldValue(Qe,JSON.parse(JSON.stringify(ft)))},updateData:Qe=>{Xe([Qe])}}));var Xe=function(ft){var kt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,xt=(0,Os.Qz)(ft),Rt=(0,Os.z2)(ft),qt=(0,Os.NK)(ft),Pa=(0,Os.GM)(ft),sa=(0,Os.S1)(ft);xt>0?(s.Standard.progressCheck=!0,s.Standard.progress=100):s.Standard.progressCheck=!1,Rt>0?(s.Standard.examCheck=!0,s.Standard.examNum=Rt):s.Standard.examCheck=!1,qt>0?(s.Standard.bankCheck=!0,s.Standard.bankNum=qt):s.Standard.bankCheck=!1,Pa>0?(s.Standard.practiceCheck=!0,s.Standard.practiceNum=Pa):s.Standard.practiceCheck=!1,sa>0?s.Standard.jobEvaluationCheck=!0:s.Standard.jobEvaluationCheck=!1,kt&&He("Standard",s.Standard),Ce.current.setFieldValue("Standard",s.Standard)},ot=()=>{},He=(Qe,ft)=>{s&&(s[Qe]=ft,Z.onStateChange(s))},dt=(Qe,ft)=>{s&&(s[Qe]=ft,Qe==="list"&&Xe([s],!1),Z.onStateChangeCalculate(s))},it=Qe=>{Z.viewResource(Qe)},Dt=Qe=>{var ft=Object.keys(Qe).reverse().pop(),kt='[class*="$$CL-FORM-ERROR__'.concat(ft,'"]'),xt=document.querySelectorAll(kt);xt.forEach(Rt=>{Rt.scrollIntoView({behavior:"auto",block:"center",inline:"center"})})};return t().createElement(m.J9,{ref:Ce,initialValues:JSON.parse(JSON.stringify(s)),onSubmit:ot,render:Qe=>t().createElement(m.l0,{className:Ys()["cl-form"]},t().createElement(m.gN,(0,b.Z)({component:We.Z,name:"name",label:n("trainingProject.addEdit.stageName"),required:!0,defaultValue:Qe.values.name,type:"text",maxLength:60,onInput:ft=>He("name",ft),placeholder:n("component.stageNameInputPlaceholder"),formItemClassName:Ys()["cl-form_list-item"],validate:ft=>(0,ze.QK)(ft,n("common.input",{name:n("trainingProject.addEdit.stageName")}))},hn)),t().createElement(m.gN,(0,b.Z)({name:"desc",label:n("trainingProject.addEdit.stageDesc"),component:qe.Z,maxLength:240,autoSize:!1,type:"text",onInput:ft=>He("desc",ft),formItemClassName:Ys()["cl-form_list-item"],placeholder:n("component.stageDescPlaceholder"),style:{height:"32px"}},hn)),t().createElement(m.gN,(0,b.Z)({name:"list",displayType:"Custom",label:n("trainingProject.addEdit.stageContent"),required:!0,component:Jl,formValue:i,isHasTutor:f,jobEvaluationEdit:Y,deleteModal:u,validate:()=>Yl(s.key,i),onStateChange:ft=>dt("list",ft),onStateChangeCal:ft=>He("list",ft),formItemClassName:Ys()["cl-form_list-item"]},hn,{evaluateAssign:J,viewResource:it,from:se})),i.studyMode==="map"&&t().createElement(m.gN,(0,b.Z)({component:to,displayType:"Custom",name:"inOrder",label:n("trainingProject.addEdit.learningAddSecChallengeTitleStage"),formItemClassName:Hn==="en_us"?Ys()["cl-form_list-item-en"]:Ys()["cl-form_list-item"],onStateChange:ft=>He("inOrder",ft),tipHTML:t().createElement("div",{className:Ys()["tip-content"]},n("component.arcadeModeTip"))},hn)),t().createElement(m.gN,(0,b.Z)({component:Ul,displayType:"Custom",name:"reward",label:n("trainingProject.addEdit.learningAddSecRewardTitleStage"),validate:wl,tipType:"project",customError:!0,onStateChange:ft=>He("reward",ft),formItemClassName:Hn==="en_us"?Ys()["cl-form_list-item-en"]:Ys()["cl-form_list-item"]},hn)),t().createElement(m.gN,(0,b.Z)({component:kl,displayType:"Custom",label:n("trainingProject.addEdit.learningAddSecPassTitleStage"),name:"Standard",stages:[N.find(ft=>ft.key===s.key)],shouldRenderedOperationCount:!0,formItemClassName:"".concat(Hn==="en_us"?Ys()["cl-form_list-item-en-stand"]:Ys()["cl-form_list-item-stand"]),onStateChange:ft=>He("Standard",ft),validate:ft=>xl(ft,N.find(kt=>kt.key===s.key))},hn)))})},no=(0,E.Z)("translation",{withRef:!0})((0,l.forwardRef)(so)),ro=e(62006),Xn=e.n(ro),io=rt.Z.TabPane,lo=Z=>{var r=Z.t,n=Z.value,s=Z.checkIndex,i=Z.formValue,u=Z.deleteModal,f=Z.editable,N=f===void 0?!0:f,Y=(0,l.useContext)(Ln),J=Y.state,se=Y.dispatch,Ce=J.tabPanesList,Xe=(0,l.useState)({}),ot=(0,Be.Z)(Xe,2),He=ot[0],dt=ot[1],it=(0,l.useState)([]),Dt=(0,Be.Z)(it,2),Qe=Dt[0],ft=Dt[1],kt=(0,l.useState)(""),xt=(0,Be.Z)(kt,2),Rt=xt[0],qt=xt[1],Pa=(0,l.useState)({visible:!1,destroyOnClose:!0,title:r("resourceLibrary.previewCourseware"),onCancel:()=>{}}),sa=(0,Be.Z)(Pa,2),ba=sa[0],oa=sa[1],Yt=(0,l.useState)({mode:"preview",watchType:"",resourceInfo:{},autoPlay:!0,draggable:!0}),Ta=(0,Be.Z)(Yt,2),Ya=Ta[0],va=Ta[1],Qa=50;(0,l.useEffect)(()=>{n&&n.length>0&&(se({type:"setTabPanes",payload:n}),qt(n[0].key),Ea(n),Z.onFieldChange(n))},[]),(0,l.useEffect)(()=>{ft(Ce)},[Ce]);var gs=Pt=>{qt(Pt)};(0,l.useEffect)(()=>{se({type:"setActiveKey",payload:Rt})},[Rt,se]);var Aa=()=>{if(N&&Qe.length<Qa){var Pt="".concat(new Date().getTime());Qe.push({name:"".concat(r("formItem.stageTaskPanelTitle")).concat(Qe.length+1),desc:"",list:[],key:Pt,inOrder:!0,Standard:{progressCheck:!1,progress:100,examCheck:!1,examNum:0,bankCheck:!1,bankNum:0,practiceCheck:!1,practiceNum:0,jobEvaluationCheck:!1},reward:{getScoreChecked:!1,getScore:0,certificateChecked:!1,certificateId:"",certificateName:"",certificateImage:""}}),qt(Pt),cs(Qe.splice(0))}else ae.Z.warning({title:r("common.tip"),content:"".concat(r("trainingProject.addEdit.stagesIncreasedMost",{count:Qa}))})},ls=Pt=>{ae.Z.confirm({title:t().createElement("span",{style:{color:"#EC6F73",paddingLeft:"15px",display:"inline-block"}},r("common.tip")),content:t().createElement("div",{className:Xn()["confirm-content"]},r("component.removeStageTip")),okText:r("common.ok"),cancelText:r("common.cancel"),okButtonProps:{danger:!0},className:Xn()["ant-modal-confirm-remove-content-box"],icon:t().createElement("span",{style:{paddingTop:"2px",float:"left"}},t().createElement(S.Z,{size:"22px",iconClass:"icon-xunwentishi"})),onOk:()=>{var ta=Rt,wt;Qe.forEach((_a,Ma)=>{_a.key===Pt&&(wt=Ma-1)});var $t=Qe.filter(_a=>_a.key!==Pt);$t.length&&ta===Pt&&(wt>=0?ta=$t[wt].key:ta=$t[0].key),He[Pt]="del",qt(ta),dt(He),ns($t,"change")}})},Ja=(Pt,ta)=>{switch(ta){case"add":Aa();break;case"remove":ls(Pt);break;default:break}};(0,l.useEffect)(()=>{J.resourceIndex&&ds(J.resourceList,J.resourceType,J.resourceTypeKey,J.closeVisible)},[J.resourceIndex,J.resourceList,J.resourceType]);var ds=function(ta,wt,$t){var _a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,Ma,Ls=Qe.findIndex(fs=>fs.key===Rt);if(se({type:"setAttendanceClose",payload:_a}),wt==="OfflineTrain"&&!Ps(ta.id||ta.key)&&_a&&ae.Z.confirm({title:r("common.tip"),content:t().createElement("div",null,r("lineClass.linkAttendanceTip")),okText:r("common.ok"),cancelText:r("common.cancel"),onOk:()=>{se({type:"setAutoAddAttendance",payload:"".concat(new Date().getTime())})}}),wt!=="AddJobEvaluation"&&wt!=="OfflineTrain"&&wt!=="AddExam"&&wt!=="AddNewExam"&&wt!=="AddPracticeBank"&&wt!=="AddPracticeTest"&&wt!=="AddMentorCoaching"&&wt!=="AddInvestigate"&&wt!=="Attendance"&&wt!=="AddAssessment")Ma=[...ta],Ma.forEach(fs=>{fs.btnActionType=wt,fs.unlocking_time||(fs.unlocking_time=""),fs.btnActionType==="CoursewareSelector"||fs.btnActionType==="ClNewUpload"?fs.type="courseware":fs.btnActionType==="CourseSelector"?fs.type="course":fs.btnActionType==="TwCourseSelector"&&(fs.type="twCourse")}),Qe[Ls].list=Qe[Ls].list.filter(fs=>{if(fs.type===$t){var _n=Ma.findIndex(pd=>pd.id===fs.id);return _n!==-1?(Ma.splice(_n,1),!0):!1}return!0}),Qe[Ls].list=Qe[Ls].list.concat(Ma);else{Ma=(0,v.Z)({},ta),Ma.btnActionType=wt,Ma.unlocking_time||(Ma.unlocking_time="");var Rn=Qe[Ls].list.findIndex(fs=>fs.key===Ma.key||fs.id!==""&&fs.id===Ma.id);if(Rn!==-1){var Ms=Qe[Ls].list[Rn];Ms.mappingId&&(Ma.mappingId=Ms.mappingId),Ms.data&&Ms.data.unlockingTime&&Ma.data&&(Ma.data.unlockingTime=Ms.data.unlockingTime),Ma.resource_lock=Ms.resource_lock,Qe[Ls].list.splice(Rn,1,Ma)}else Qe[Ls].list.push(Ma)}if(wt==="OfflineTrain"){var md=Qe[Ls].list.filter(fs=>fs.componentName==="Attendance");md.forEach(fs=>{fs.data.relate_course_list.forEach(_n=>{_n.course_key===(ta.key||ta.id)&&(_n.course_name=ta.name)})})}It.current[Rt].setValue("list",Qe[Ls].list),It.current[Rt].updateData(Qe[Ls]),ns(Qe,"change")},Ps=Pt=>{var ta=n.find(Ma=>Ma.key===Rt),wt=ta.list,$t=wt.filter(Ma=>Ma.componentName==="Attendance"),_a=!1;return $t.map(Ma=>{Ma.data.relate_course_list.map(Ls=>{(Ls.course_key||Ls.course_id)===Pt&&(_a=!0)})}),_a},ns=(Pt,ta)=>{Ea(Pt,ta),Z.onFieldChange(Pt),Z.onChangeQualifiedStandard&&Z.onChangeQualifiedStandard(Pt),se({type:"setTabPanes",payload:Pt}),Z.onStageChange&&Z.onStageChange(Pt)},cs=Pt=>{Ea(Pt),Z.onFieldChange(Pt),se({type:"setTabPanes",payload:Pt})},vs=Pt=>{var ta=Qe.filter($t=>He[$t.key]!=="del"),wt=ta.find($t=>$t.key===Pt.key);wt&&(wt=Object.assign(wt,Pt)),cs(ta)},os=Pt=>{var ta=Qe.filter($t=>He[$t.key]!=="del"),wt=ta.find($t=>$t.key===Pt.key);wt&&(wt=Object.assign(wt,Pt)),ns(ta)},Ea=(Pt,ta)=>{var wt=Z.isStageHasRewardAStandard,$t=Pt.find(_a=>_a.key===Rt);wt||Pt.forEach(_a=>{delete _a.Standard,delete _a.reward}),$t&&$t.Standard&&ta==="change"&&($t.Standard.examCheck=(0,Os.z2)([$t])>0,$t.Standard.bankCheck=(0,Os.NK)([$t])>0,$t.Standard.progressCheck=(0,Os.Qz)([$t])>0,$t.Standard.practiceCheck=(0,Os.GM)([$t])>0,$t.Standard.jobEvaluationCheck=(0,Os.S1)([$t])>0,$t.Standard.progress=$t.Standard.progress===""?100:$t.Standard.progress,$t.Standard.examNum=$t.Standard.examNum===0||$t.Standard.examNum===""?(0,Os.z2)([$t]):$t.Standard.examNum,$t.Standard.bankNum=$t.Standard.bankNum===0||$t.Standard.bankNum===""?(0,Os.NK)([$t]):$t.Standard.bankNum,$t.Standard.practiceNum=$t.Standard.practiceNum===0||$t.Standard.practiceNum===""?(0,Os.GM)([$t]):$t.Standard.practiceNum)};(0,l.useEffect)(()=>{s&&la()},[s,la]);var la=function(){var Pt=(0,K.Z)(d().mark(function ta(){var wt,$t,_a,Ma,Ls;return d().wrap(function(Ms){for(;;)switch(Ms.prev=Ms.next){case 0:wt={},$t=Object.keys(It.current),_a=0;case 3:if(!(_a<$t.length)){Ms.next=15;break}return Ma=$t[_a],Ms.next=7,It.current[Ma].checkValidate();case 7:if(Ls=Ms.sent,!Ls.error){Ms.next=12;break}return qt(Ma),wt=Ls,Ms.abrupt("break",15);case 12:_a++,Ms.next=3;break;case 15:Z.dispatch({type:"studyProject/updateCheckResult",payload:JSON.stringify(wt)==="{}"?{error:!1}:wt});case 16:case"end":return Ms.stop()}},ta)}));return function(){return Pt.apply(this,arguments)}}(),es=(0,l.useState)(!1),ea=(0,Be.Z)(es,2),Da=ea[0],Bt=ea[1],ra=()=>{Bt(!0)},Ye=Pt=>{if(!(!Pt.destination||!Pt.source.index)){var ta=0,wt=Pt.destination.index-Pt.source.index,$t="";Qe.forEach((_a,Ma)=>{_a.key===Pt.draggableId&&(ta=Ma,$t=_a)}),wt!==0&&(Qe.splice(ta,1),Qe.splice(ta+wt,0,$t)),Bt(!1),qt(Pt.draggableId),cs(Qe)}},vt=(Pt,ta)=>t().createElement(mt.Z5,{onDragStart:ra,onDragEnd:Ye},t().createElement(mt.bK,{droppableId:"droppable",direction:"horizontal",isDropDisabled:!1},wt=>t().createElement("div",(0,b.Z)({className:"dragItemWrap",ref:wt.innerRef},wt.droppableProps),t().createElement(ta,Pt,$t=>(Pt.locale+=1,t().createElement(mt._l,{key:$t.key,draggableId:$t.key,index:Pt.locale,isDragDisabled:!1},_a=>t().createElement("div",(0,b.Z)({ref:_a.innerRef},_a.draggableProps,_a.dragHandleProps,{className:"dragItem".concat(Pt.locale)}),$t)))),wt.placeholder))),It=(0,l.useRef)({}),nt=(Pt,ta)=>{Pt&&(It.current[ta.key]=Pt)},tt=()=>{oa((0,v.Z)((0,v.Z)({},ba),{},{visible:!1})),va({mode:"preview",watchType:"",resourceInfo:{}})},Ot=Pt=>{if(Pt){var ta=Pt.resourcePlayInfo,wt=Pt.previewInfo.title;oa((0,v.Z)((0,v.Z)({},ba),{},{title:wt,visible:!0,onCancel:tt})),va(ta)}};return t().createElement(t().Fragment,null,t().createElement(rt.Z,{className:Xn()["stage-tab-container"],hideAdd:Da,locale:0,tabBarGutter:2,type:"editable-card",renderTabBar:vt,onChange:gs,activeKey:Rt,onEdit:Ja},Qe.length,Qe.map((Pt,ta)=>t().createElement(io,{forceRender:!0,key:Pt.key,tab:t().createElement("div",{className:"stage-task-tab-label"},"".concat(r("component.stage")).concat(ta+1)),closable:Qe.length>1},t().createElement(no,(0,b.Z)({ref:wt=>nt(wt,Pt),itemVal:Pt,formValue:i,tabList:Qe,deleteModal:u,onStateChange:vs,onStateChangeCalculate:os,viewResource:Ot},Z))))),t().createElement(as.Z,(0,b.Z)({},Ya,{previewInfo:ba})))},oo=Z=>({checkIndex:Z.studyProject.checkIndex}),co=(0,h.$j)(oo)((0,E.Z)()(lo)),uo=(Z,r)=>{var n=r.type,s=r.payload;switch(n){case"setResource":return(0,v.Z)((0,v.Z)({},Z),{},{resourceList:s.list,resourceIndex:s.index,closeVisible:s.closeVisible,resourceType:s.type,resourceTypeKey:s.typeKey});case"setStagesIndex":return(0,v.Z)((0,v.Z)({},Z),{},{stagesIndex:s});case"setFormData":return(0,v.Z)((0,v.Z)({},Z),{},{formData:Object.assign(Z.formData,s),formIndex:Z.formIndex+1});case"setActiveKey":return(0,v.Z)((0,v.Z)({},Z),{},{activeKey:s});case"setAutoAddAttendance":return(0,v.Z)((0,v.Z)({},Z),{},{autoAddAttendance:s});case"setAttendanceClose":return(0,v.Z)((0,v.Z)({},Z),{},{attendanceClose:s});case"setTabPanes":return(0,v.Z)((0,v.Z)({},Z),{},{tabPanesList:JSON.parse(JSON.stringify(s))});default:throw new Error}},mo={tabPanesList:[],resourceList:[],resourceIndex:0,resourceType:"",resourceTypeKey:"",stagesIndex:0,formData:{},formIndex:0,activeKey:"",closeVisible:!1,autoAddAttendance:0,attendanceClose:!0},po=Z=>{var r=Z.isHasToolEva,n=(0,l.useReducer)(uo,mo),s=(0,Be.Z)(n,2),i=s[0],u=s[1],f=(0,l.useState)(Xs),N=(0,Be.Z)(f,1),Y=N[0];return Y=r?Y:Y.filter(J=>J.index!=="AddJobEvaluation"),t().createElement(Ln.Provider,{value:{state:i,dispatch:u}},t().createElement("div",null,t().createElement(Il,(0,b.Z)({},Z,{resources:Y})),t().createElement(co,Z)))},Cd=()=>{},ho=(0,m.$j)((0,E.Z)()(po)),fr=Z=>{var r='[class*="$$CL-FORM-ERROR__'.concat(Z,'"]'),n=document.querySelector(r);n.scrollIntoView()};class vo extends t().Component{componentDidUpdate(r){var n=r.formik,s=n.isSubmitting,i=n.isValidating,u=n.errors,f=Object.keys(u);f.length>0&&s&&!i&&fr(f[0])}render(){return null}}var gr=(0,m.$j)(vo);gr.scrollTo=fr;var fo=gr;class Jn extends t().Component{constructor(){super(...arguments);this.handleChange=(r,n)=>{if(!r){this.props.formik.setFieldValue(n,null);return}var s=this.props,i=s.timeFormatter,u=i===void 0?$.XE.INITIAL_DATE_FMT.PARAMS:i,f=s.valueType;this.props.formik.setFieldValue(n,f==="dataString"?r.format(u):r.valueOf())}}render(){var r=this.props,n=r.prefixCls,s=r.tipInfo,i=s===void 0?"":s,u=r.defaultFieldList,f=r.normalDisplay,N=r.currentDay,Y=N===void 0?!1:N,J=r.name,se=r.valueType,Ce=(0,ce.Z)(r,["prefixCls","tipInfo","defaultFieldList","normalDisplay","currentDay","name","valueType"]),Xe=u?Ee()(u,$.XE.INITIAL_DATE_FMT.PARAMS):null,ot=f?null:Y?ve.tI:ve.Kq;return t().createElement("div",{className:n},t().createElement(Le.Z,(0,b.Z)({},Ce,{showTime:{format:$.XE.INITIAL_TIME_FMT.VIEW},format:$.XE.INITIAL_DATE_FMT.VIEW,disabledDate:ot,value:se==="dataString"?Xe:u?Ee()(+u):void 0,onChange:He=>this.handleChange(He,J)})),i?t().createElement("span",{className:"infotext"},i):null)}}Jn.defaultProps={prefixCls:"cl-form-item__datepicker"},Jn.defaultProps={defaultFieldList:"",normalDisplay:!1,currentDay:!1,rest:{},valueType:"dataString"};var go=(0,m.$j)(Jn),qn=tn.Z.Option;class Eo extends t().Component{constructor(){super(...arguments);this.handleNumberChange=r=>{this.props.formik.setFieldValue("term",(0,v.Z)((0,v.Z)({},this.props.formik.values.term),{},{number:r}))},this.handleSelectChange=r=>{this.props.formik.setFieldValue("term",(0,v.Z)((0,v.Z)({},this.props.formik.values.term),{},{type:r}))}}render(){var r=this.props,n=r.defaultFieldList,s=r.disabled,i=r.t;return t().createElement(t().Fragment,null,t().createElement(X.Z,{precision:0,min:0,value:n.number,disabled:s,onChange:this.handleNumberChange}),t().createElement("span",{style:{marginLeft:"10px"}}),t().createElement(tn.Z,{value:n.type,style:{width:80},disabled:s,onChange:this.handleSelectChange},t().createElement(qn,{value:"D"},i("common.day")),t().createElement(qn,{value:"H"},i("common.hour")),t().createElement(qn,{value:"M"},i("common.minute"))))}}var _o=(0,m.$j)((0,E.Z)()(Eo)),Mn=e(1870),Co=e(71759);class Er extends t().Component{constructor(){super(...arguments);this.state={visible:!1},this.columnsOnce=[{title:this.props.t("exam.releaseType"),dataIndex:"type",key:"type",width:150,render:()=>this.props.t("exam.once")},{title:this.props.t("exam.executionTime"),dataIndex:"startTime",key:"startTime",render:r=>{if(!r)return"/";var n=(0,ve.p6)(new Date(r));return t().createElement("span",null,t().createElement("span",{style:{marginRight:"5px"}},n),t().createElement(c.Z,{title:(0,ve.ZT)("".concat(this.props.t("exam.executionTimeTip")),n)},t().createElement(Mn.Z,{style:{color:"#afb5d2"}})))}}],this.columnsPeriod=[{title:this.props.t("exam.releaseType"),dataIndex:"type",key:"type",width:150,render:()=>this.props.t("exam.loop")},{title:()=>this.props.t("exam.releaseInterval"),dataIndex:"interval",key:"interval",render:r=>t().createElement("span",null,t().createElement("span",{style:{marginRight:"5px"}},r),t().createElement(c.Z,{title:(0,ve.ZT)("".concat(this.props.t("exam.releaseIntervalTip")),r)},t().createElement(Mn.Z,{style:{color:"#afb5d2"}})))},{title:this.props.t("exam.remindTimes"),dataIndex:"times",key:"times",render:r=>t().createElement("span",null,t().createElement("span",{style:{marginRight:"5px"}},r),t().createElement(c.Z,{title:(0,ve.ZT)("".concat(this.props.t("exam.remindTimesTip")),r)},t().createElement(Mn.Z,{style:{color:"#afb5d2"}})))},{title:this.props.t("exam.nextExecutionTime"),dataIndex:"startTime",key:"startTime",render:r=>{if(!r)return"/";var n=(0,ve.p6)(new Date(r));return t().createElement("span",null,t().createElement("span",{style:{marginRight:"5px"}},n),t().createElement(c.Z,{title:(0,ve.ZT)("".concat(this.props.t("exam.executionTimeTip")),n)},t().createElement(Mn.Z,{style:{color:"#afb5d2"}})))}}],this.handleClick=()=>{this.setState({visible:!0})},this.handleChangModalCancel=()=>{this.setState({visible:!1})},this.handleChangModalOk=r=>{this.setState({visible:!1},()=>{this.props.formik.setFieldValue("timer",(0,v.Z)((0,v.Z)({},r),{},{shouldRendered:!0}))})},this.renderContent=()=>{var r=this.props.defaultFieldList,n=r.type===1;return n?this.renderOnceContent():this.renderPeriodContent()},this.renderOnceContent=()=>{var r=this.props,n=r.prefixCls,s=r.defaultFieldList,i="".concat(n,"__content"),u=s.shouldRendered,f=s.type,N=s.startTime;if(!!u){var Y=[{key:"once",type:f,startTime:N}];return t().createElement("div",{className:i},t().createElement(Qn.Z,{size:"middle",bordered:!0,pagination:!1,columns:this.columnsOnce,rowKey:"key",dataSource:Y}))}},this.renderPeriodContent=()=>{var r=this.props,n=r.prefixCls,s=r.defaultFieldList,i="".concat(n,"__content"),u=s.shouldRendered,f=s.type,N=s.startTime,Y=s.interval,J=s.times;if(!!u){var se=[{key:"period",type:f,startTime:N,interval:Y,times:J}];return t().createElement("div",{className:i},t().createElement(Qn.Z,{size:"middle",bordered:!0,pagination:!1,columns:this.columnsPeriod,rowKey:"key",dataSource:se}))}}}render(){var r=this.props,n=r.prefixCls,s=r.defaultFieldList,i=r.disabled,u=r.t,f=r.scopeType,N=this.state.visible;return t().createElement("section",{className:n},t().createElement("p",{className:"cl-form__sectitle"},u("exam.timer"),i?null:t().createElement(y.Z,{type:"primary",size:"small",onClick:this.handleClick},u("exam.settings"))),this.renderContent(),t().createElement(Co.Z,{visible:N,sholudRequest:!1,initialParams:(0,v.Z)({},s),onCancel:this.handleChangModalCancel,onOk:this.handleChangModalOk,scopeType:f}))}}Er.defaultProps={prefixCls:"timer"};var yo=(0,m.$j)((0,E.Z)()(Er)),To=e(85589),_r=e.n(To),er=e(32452),So=e(16830),Cr=e(48033),yr=e(59081),Tr=e(65454),Po=e(13129),Do=["undo","redo","separator","font-size","line-height","letter-spacing","separator","text-color","bold","italic","underline","strike-through","separator","superscript","subscript","remove-styles","separator","text-indent","text-align","separator","headings","list-ul","list-ol","blockquote","code","separator","separator","hr","separator","separator"],bo=["emoji","link","media","clear"],sn=e(24144);class Sr extends t().Component{constructor(){super(...arguments);this.state={editorState:_r().createEditorState(this.props.defaultFieldList),showCourseSelector:!1,controlBarClassName:"cl-h5-article__controlbar",scrollDOM:null,isFixed:!1,layoutSider:null},this.onUploadSuccess=r=>{var n=r.fileList,s=this.props.t,i=n.length>0?n[0].url:"",u=n.length>0?n[0].fileName:"";D.default.success("".concat(u).concat(s("setting.uploadSuccess"))),this.setState({editorState:er.ContentUtils.insertMedias(this.state.editorState,[{type:"IMAGE",url:i}])})},this.onUploadFailed=r=>{var n=r.data,s=this.props.t,i=n.fileList,u=i.length>0?i[0].fileName:"";D.default.error("".concat(u).concat(s("setting.uploadFail")))},this.handleWindowScroll=()=>{var r=this.props.topHeight,n=this.state.isFixed,s=document.querySelector(".cl-h5-article"),i=s.getBoundingClientRect().top,u=document.querySelector(".bf-controlbar").offsetHeight;n?i-u<=r?this.setState({isFixed:!0,controlBarClassName:"cl-h5-article__controlbar cl-h5-article__controlbar-fixed"}):this.setState({isFixed:!1,controlBarClassName:"cl-h5-article__controlbar"}):i<=r?this.setState({isFixed:!0,controlBarClassName:"cl-h5-article__controlbar cl-h5-article__controlbar-fixed"}):this.setState({isFixed:!1,controlBarClassName:"cl-h5-article__controlbar"})},this.handleChange=r=>{var n=this.props.formik;this.setState({editorState:r},()=>{n.setFieldValue("h5Article",r.toRAW())})},this.confirmEditResource=r=>{var n=r.map(s=>s.type==="mp3"?{type:"CUSTOMER_AUDIO",name:s.name,meta:{record:s.data}}:s.type==="mp4"?{type:"CUSTOMER_VIDEO",name:s.name,meta:{record:s.data}}:{type:"DOC",name:s.name,meta:{record:s.data}});this.setState({editorState:er.ContentUtils.insertMedias(this.state.editorState,n),showCourseSelector:!1})},this.cancelEditResource=()=>{this.setState({showCourseSelector:!1})},this.showCourseWareSelector=()=>{this.setState({showCourseSelector:!0})},this.entityExportFn=r=>{var n=r.data,s=r.type;return s==="DOC"?t().createElement(Cr.Z,n):s==="CUSTOMER_AUDIO"?t().createElement(yr.Z,n):s==="CUSTOMER_VIDEO"?t().createElement(Tr.Z,n):null}}componentDidMount(){var r=this.props.scrollDOMSelector,n=document.querySelector(r),s=document.querySelector(".layout-sideBar");this.setState({scrollDOM:n,layoutSider:s},()=>{n&&n.addEventListener("scroll",this.handleWindowScroll)})}componentWillUnmount(){var r=this.state.scrollDOM;r&&r.removeEventListener("scroll",this.handleWindowScroll)}render(){var r=this.props,n=r.prefixCls,s=r.lng,i=r.t,u=r.showPrivate,f=u===void 0?!0:u,N=r.from,Y=r.topHeight,J=Y===void 0?0:Y,se=r.collapsed,Ce=this.state,Xe=Ce.controlBarClassName,ot=Ce.isFixed,He=Ce.layoutSider,dt=[{key:"custom-button",type:"button",text:i("component.selectCourseware"),onClick:this.showCourseWareSelector},{key:"antd-uploader",type:"component",component:t().createElement(sn.ZM,{uploadConfig:{listType:"picture",showUploadList:!1,multiple:!0,accept:N==="notice"?".jpg,.jpeg,.png":".jpg,.jpeg,.png,.gif"},size:N==="notice"?{value:5,unit:"MB"}:void 0,onUploadSuccess:this.onUploadSuccess,onUploadFailed:this.onUploadFailed,render:()=>t().createElement("button",{type:"button",className:"control-item button upload-button","data-title":i("component.insertImage")},t().createElement(So.Z,null))})}],it=He?se?60:220:0,Dt={"set-image-size":kt=>{var xt=kt.width,Rt=kt.height;return{width:xt,height:Rt}}},Qe=[{type:"DOC",component:Cr.Z},{type:"CUSTOMER_AUDIO",component:yr.Z},{type:"CUSTOMER_VIDEO",component:Tr.Z},{type:"CUSTOMER_IMAGE",component:Po.Z}],ft;switch(s){case"en_us":ft="en";break;case"zh_hk":ft="zh-hant";break;default:ft="zh";break}return t().createElement(t().Fragment,null,t().createElement("div",{className:n},t().createElement(_r(),{ref:kt=>{this.editorInstance=kt},controlBarClassName:Xe,controlBarStyle:ot?{top:"".concat(J,"px"),left:"".concat(it,"px"),width:"calc(100% - ".concat(it,"px)")}:{},value:this.state.editorState,onChange:this.handleChange,controls:Do,extendControls:dt,excludeControls:bo,extendAtomics:Qe,hooks:Dt,language:ft,converts:{entityExportFn:this.entityExportFn},imageControls:["float-left","float-right","align-left","align-center","align-right","size",{text:"\u81EA\u9002\u5E94",onClick:kt=>{this.editorInstance.setValue(er.ContentUtils.setMediaData(this.editorInstance.getValue(),kt.getEntityAt(0),{width:300,height:"auto"})),window.setImmediate(this.editorInstance.forceRender)}},{text:"\u5220\u9664",onClick:"removeImage"}]})),t().createElement(Ds.Z,{showPrivate:f,visible:this.state.showCourseSelector,excludeType:"h5,html,picture,scorm",onCancel:this.cancelEditResource,onOk:this.confirmEditResource}))}}Sr.defaultProps={prefixCls:"cl-h5-article"};var Oo=Z=>{var r=Z.user.lng;return{lng:r,collapsed:Z.sideBar.collapsed}},Io=(0,m.$j)((0,h.$j)(Oo)((0,E.Z)()(Sr))),Pr=[{coverType:1,imgSrc:"".concat("https://oss.coolcollege.cn","/1800048808671973376.png")},{coverType:1,imgSrc:"".concat("https://oss.coolcollege.cn","/1821853658669780992.png")},{coverType:1,imgSrc:"".concat("https://oss.coolcollege.cn","/1821855561373847552.png")},{coverType:1,imgSrc:"".concat("https://oss.coolcollege.cn","/1821855704248619008.png")},{coverType:1,imgSrc:"".concat("https://oss.coolcollege.cn","/1821855828957859840.png")},{coverType:1,imgSrc:"".concat("https://oss.coolcollege.cn","/1821855947757326336.png")},{coverType:1,imgSrc:"".concat("https://oss.coolcollege.cn","/1821856108147511296.png")},{coverType:1,imgSrc:"".concat("https://oss.coolcollege.cn","/1821856223356653568.png")}],Dr=[{coverType:1,imgSrc:"".concat("https://oss.coolcollege.cn","/1821774172448231424.png")},{coverType:1,imgSrc:"".concat("https://oss.coolcollege.cn","/1821773911239561216.png")},{coverType:1,imgSrc:"".concat("https://oss.coolcollege.cn","/1821774453131055104.png")},{coverType:1,imgSrc:"".concat("https://oss.coolcollege.cn","/1821774579920670720.png")}];class br extends t().Component{constructor(r){super(r);this.onUploadSuccess=s=>{var i=s.fileList,u=this.props.t,f=this.state,N=f.activeImgIndex,Y=f.coverImgList,J=i.length>0?i[0].url:"",se=[...Y];se.splice(N,1,{coverType:0,imgSrc:J}),this.setState({coverImgList:se}),this.props.formik.setFieldValue("covers",{coverType:0,cover:se[0].imgSrc,baseCover:""}),D.default.success("".concat(u("course.courseDetailCoverSuccess"))),this.onUploadSuccessCallback(J)},this.onUploadSuccessCallback=s=>{this.setState(i=>{var u=[...i.coverImgList];return u.unshift({coverType:0,imgSrc:s}),{activeImgIndex:0,coverImgList:u}},()=>{this.triggerChange({coverType:0,cover:s,baseCover:""})})},this.onUploadFailed=()=>{var s=this.props.t;D.default.error("".concat(s("course.courseDetailCoverFailure")))},this.initCoverImgList=()=>{var s=this.props.value,i=s.coverType,u=s.cover,f=s.baseCover,N=this.props.coverSource==="offline"?Dr:Pr,Y=[...N],J=f||Y[Math.floor(Math.random()*Y.length)].imgSrc;if(i==0)Y.unshift({coverType:0,imgSrc:u}),this.setState({activeImgIndex:0,coverImgList:Y});else{var se=Y.findIndex(Ce=>Ce.imgSrc===J);se>-1?this.setState({activeImgIndex:se}):(Y.unshift({coverType:1,imgSrc:J}),this.setState({activeImgIndex:0,coverImgList:Y}))}},this.handleSwitchImg=()=>{var s=this.props.disabled;if(!s){var i=this.state,u=i.activeImgIndex,f=i.coverImgList,N=(u+1)%f.length;this.setState({activeImgIndex:N},()=>{var Y=f[N].coverType,J=f[N].imgSrc,se=Y===1;this.triggerChange({coverType:Y,cover:se?"":J,baseCover:se?J:""})})}},this.triggerChange=s=>{var i=s.coverType,u=s.cover,f=s.baseCover;this.props.formik.setFieldValue("covers",{coverType:i,cover:u,baseCover:f})},this.handleSuccessUpload=s=>{var i=s.imgUrl,u=this.state.activeImgIndex,f=[...this.state.coverImgList];f.splice(u,1,{coverType:0,imgSrc:i}),this.props.formik.setFieldValue("covers",{coverType:0,cover:i,baseCover:""}),this.setState({coverImgList:f})},this.handleSwitch=s=>{s?this.setState({type:""}):this.setState({type:"crop"})},this.renderImageFilters=()=>{var s=this.props.notUseTitle,i=this.state,u=i.activeImgIndex,f=i.coverImgList,N="upload_content_container__imgfilters",Y=f[u];return t().createElement("div",{className:N},t().createElement("img",{src:Y&&Y.imgSrc,alt:""}),Y&&Y.coverType===1&&!s?t().createElement("div",{className:"".concat(N,"__title")},this.props.formik.values.title):null,t().createElement("div",{className:"".concat(N,"__mask")}))},this.renderUploadBtn=()=>{var s=this.props,i=s.t,u=s.isCrop,f=this.state,N=f.coverImgList,Y=f.type,J="upload_content_container__uploader";return t().createElement("div",{className:J},t().createElement(sn.ZM,{fileList:N,uploadConfig:{listType:"picture",accept:"image/jpg,image/jpeg,image/png",showUploadList:!1,maxCount:1},size:{value:1,unit:"MB"},onUploadSuccess:this.onUploadSuccess,onUploadFailed:this.onUploadFailed,clip:u?"":Y,render:()=>t().createElement(y.Z,{type:"default"},t().createElement(S.Z,{iconClass:"iconf-add",color:"#4D536E",size:"14px"}),i("course.courseDetailCover"))}),t().createElement(y.Z,{type:"default",className:"".concat(J,"__switch"),onClick:this.handleSwitchImg},t().createElement(S.Z,{iconClass:"iconf-switch",color:"#4D536E",size:"14px"}),i("course.courseDetailCoverSwitch")),t().createElement("p",{className:"".concat(J,"__tips")},i("course.courseDetailCoverTip")))};var n=r.coverSource==="offline"?Dr:Pr;this.state={coverImgList:[...n],activeImgIndex:0,type:"crop"}}componentDidMount(){this.initCoverImgList()}render(){var r=this.props.isCrop,n=this.props,s=n.prefixCls,i=n.t;return t().createElement("section",{className:"".concat(s)},r?"":t().createElement("div",{className:"corp_switch_container"},t().createElement(ws.Z,{defaultChecked:!1,onChange:this.handleSwitch}),t().createElement("span",{className:"item-margin"},i("resourceLibrary.originUpload"))),t().createElement("div",{className:"upload_content_container"},this.renderImageFilters(),this.renderUploadBtn()))}}br.defaultProps={coverSource:"",prefixCls:"course-cover__content",notUseTitle:!1,disabled:!1};var Zo=(0,m.$j)((0,E.Z)()(br)),Lo=e(26726),xo=e.n(Lo),No=e(80711),Us=e.n(No),Mo=e(94184),ko=e.n(Mo),Ao=e(55055),kn=e.n(Ao),Or=Z=>{var r=Z.className,n=Z.isManage,s=Z.disabled,i=Z.checked,u=Z.info,f=Z.onSelect,N=Z.onDelete,Y=()=>{n||s||f&&f(u)},J=()=>{N&&N(u)},se=()=>{var Ce={};return!n&&i?(0,v.Z)((0,v.Z)({},Ce),{},{borderColor:localStorage.getItem("themeColor")||"#465dcd"}):Ce};return t().createElement(l.Fragment,null,t().createElement("div",{key:u.id||u.url,className:ko()(r,kn().themeBox,n?"":kn().hoverBox),style:se(),onClick:Y},t().createElement("img",{className:kn().img,src:u.url}),n&&!u.is_default&&t().createElement("span",{className:kn().deleteIcon,onClick:J})))};Or.defaultProps={className:"",info:{},isManage:!1,disabled:!1,checked:!1};var Ir=(0,E.Z)()(Or),Ro=e(72549),Gs=e.n(Ro),Zr=Z=>{var r=Z.visible,n=Z.title,s=Z.t,i=Z.bgList,u=Z.disabled,f=Z.defaultLen,N=Z.isManage,Y=Z.curObj,J=Z.modalWidth,se=Z.bgManageUploadTip,Ce=Z.uploadConfig,Xe=Z.onCancel,ot=Z.onSelect,He=Z.onRefresh,dt=Z.quality,it=(0,ce.Z)(Z,["visible","title","t","bgList","disabled","defaultLen","isManage","curObj","modalWidth","bgManageUploadTip","uploadConfig","onCancel","onSelect","onRefresh","quality"]),Dt=(0,l.useState)((0,v.Z)({},Y)),Qe=(0,Be.Z)(Dt,2),ft=Qe[0],kt=Qe[1],xt=(0,l.useState)([]),Rt=(0,Be.Z)(xt,2),qt=Rt[0],Pa=Rt[1],sa=(0,l.useState)([]),ba=(0,Be.Z)(sa,2),oa=ba[0],Yt=ba[1],Ta=(0,l.useState)([]),Ya=(0,Be.Z)(Ta,2),va=Ya[0],Qa=Ya[1],gs=(0,l.useState)(u),Aa=(0,Be.Z)(gs,2),ls=Aa[0],Ja=Aa[1],ds=20;(0,l.useEffect)(()=>{Pa(N?Ga()(i.filter(ea=>!ea.is_default)):Ga()(i))},[i,N]),(0,l.useEffect)(()=>{kt((0,v.Z)({},Y))},[Y]),(0,l.useEffect)(()=>{Yt(Ga()(qt))},[qt]),(0,l.useEffect)(()=>{Qa(oa.filter(ea=>!ea.needDelete)||[])},[oa]),(0,l.useEffect)(()=>{Ja(ds-va.length<=f)},[va]);var Ps=function(){var ea=(0,K.Z)(d().mark(function Da(){var Bt,ra,Ye,vt;return d().wrap(function(nt){for(;;)switch(nt.prev=nt.next){case 0:N?(ra=oa.filter(tt=>tt.needUpload).map(tt=>tt.url)||[],Ye=oa.filter(tt=>tt.needDelete).map(tt=>tt.id)||[],vt=[],ra.length&&vt.push((0,sn.$Y)({url_list:ra,config_type:Ce.config_type})),Ye.length&&vt.push((0,sn.VQ)({idList:Ye})),vt.length?Promise.all(vt).then(tt=>{var Ot=!1;tt.forEach(Pt=>{Pt.success==="false"&&(Ot=!0,D.default.error(Pt.message))}),Ot||(He(ra.length?tt[0].data:[],oa.filter(Pt=>Pt.needDelete)),Xe())}):cs()):(Bt=ft.url===Y.url?null:ft,ot(Bt,!0),ns());case 1:case"end":return nt.stop()}},Da)}));return function(){return ea.apply(this,arguments)}}(),ns=()=>{if(N){var ea=oa.filter(Bt=>Bt.needUpload).map(Bt=>Bt.url)||[],Da=oa.filter(Bt=>Bt.needDelete).map(Bt=>Bt.id)||[];ea.length||Da.length?ae.Z.confirm({title:s("course.leaveTipTitle"),content:s("course.leaveTip",{configType:n}),okText:s("common.ok"),cancelText:s("common.cancel"),onOk:()=>{cs()},onCancel(){}}):cs()}else cs()},cs=()=>{Yt(Ga()(qt)),Xe()},vs=ea=>{kt((0,v.Z)({},ea))},os=ea=>{ea.id?Yt(Ga()(oa.map(Da=>(Da.id===ea.id&&(Da.needDelete=!0),(0,v.Z)({},Da))))):Yt(Ga()(oa.filter(Da=>Da.url!==ea.url)))},Ea=ea=>{var Da=ea.fileList,Bt=Da.map(ra=>({url:ra.url,needUpload:!0}));Yt([...Bt,...oa])},la=()=>{D.default.error("".concat(s("course.courseDetailCoverFailure")))},es=()=>ls?s("course.uploadManageTooltip",{num:ds-f}):null;return t().createElement(l.Fragment,null,t().createElement(ae.Z,{title:"".concat(s(N?"course.management":"course.select")).concat(n),visible:r,onCancel:ns,onOk:Ps,width:J||728,className:Gs().bgSelectModal,destroyOnClose:!0,maskClosable:!1},N&&t().createElement("div",{className:Gs().bgUploadTip},se),t().createElement("div",{className:Gs().bgContent},N&&t().createElement(c.Z,{title:es()},t().createElement("div",{className:Gs().uploadBtnBox},t().createElement(sn.ZM,{fileList:qt,uploadConfig:{listType:"picture",accept:"image/jpg,image/jpeg,image/png",showUploadList:!1,maxCount:1,disabled:u||ls},size:{value:1,unit:"MB"},onUploadSuccess:Ea,onUploadFailed:la,clip:Ce.isCrop?"":"crop",quality:dt,render:()=>t().createElement(y.Z,{type:"dashed",disabled:u||ls,className:Gs().uploadBtn},t().createElement(S.Z,{iconClass:"iconf-add",className:Gs().uploadIcon,size:"12px"}),t().createElement("span",{className:Gs().uploadText},s("course.bgModalUploadTip"),"\xA0",t().createElement("span",{className:Gs().uploadNum},ds-va.length-f>0?ds-va.length-f:0),"\xA0",s("course.uploadUnit")))}))),va.map(ea=>t().createElement(Ir,(0,b.Z)({key:ea.id||ea.url,className:Gs().modalImg,info:ea,isManage:N,checked:ft.url===ea.url,onSelect:Da=>vs(Da),onDelete:os,disabled:u},it))))))};Zr.defaultProps={visible:!1,isManage:!1,bgList:[],onCancel:()=>{},onSelect:()=>{},onRefresh:()=>{}};var Fo=(0,h.$j)()((0,E.Z)()(Zr)),Lr=Z=>{var r=Z.coverSource,n=Z.isCrop,s=Z.t,i=Z.disabled,u=Z.notUseTitle,f=Z.value,N=Z.onFieldChange,Y=Z.needRefresh,J=Z.ifRefresh,se=Z.quality,Ce=20,Xe=8,ot=(0,l.useState)(i),He=(0,Be.Z)(ot,2),dt=He[0],it=He[1],Dt=(0,l.useState)(!1),Qe=(0,Be.Z)(Dt,2),ft=Qe[0],kt=Qe[1],xt=(0,l.useState)(!1),Rt=(0,Be.Z)(xt,2),qt=Rt[0],Pa=Rt[1],sa=(0,l.useState)({}),ba=(0,Be.Z)(sa,2),oa=ba[0],Yt=ba[1],Ta=(0,l.useState)([]),Ya=(0,Be.Z)(Ta,2),va=Ya[0],Qa=Ya[1];(0,l.useEffect)(()=>{gs()},[J]);var gs=()=>{W.WY.get({url:$.ZP.CourseManageList.aiImageConfigList(),params:{config_type:r}}).then(Ea=>{var la=Ea.success;la==="true"&&Aa(Ea.data||[])})};(0,l.useEffect)(()=>{it(va.length>=Ce)},[va,Ce]);var Aa=Ea=>{var la=Ga()(Ea),es=f.coverType===1||f.coverType==="1"?f.baseCover:f.cover;if(!es)N({coverType:la[0].is_default?1:0,cover:la[0].is_default?"":la[0].url,baseCover:la[0].is_default?la[0].url:""}),Yt(la[0]);else{var ea=la.filter(Da=>Da.url===es);ea.length?(la.forEach((Da,Bt)=>{Da.url===es&&la.unshift(la.splice(Bt,1)[0])}),Yt(la[0])):Yt({url:f.baseCover||f.cover,is_default:f.coverType===1||f.coverType==="1"})}Qa(la)},ls=Ea=>{kt(!ft),Pa(Ea)},Ja=function(la){var es=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(la&&(Yt((0,v.Z)({},la)),N({coverType:la.is_default?1:0,cover:la.is_default?"":la.url,baseCover:la.is_default?la.url:""}),es)){var ea=Ga()(va);ea.map((Da,Bt)=>{la.url===Da.url&&ea.unshift(ea.splice(Bt,1)[0])}),Qa(ea)}},ds=Ea=>{var la=Ea.fileList,es=la.map(ea=>ea.url);(0,sn.$Y)({url_list:es,config_type:r}).then(ea=>{ea.success==="true"&&(Qa([...ea.data,...va]),Yt(ea.data[0]||{}),N({coverType:0,cover:ea.data[0].url,baseCover:""}))})},Ps=()=>{D.default.error("".concat(s("course.courseDetailCoverFailure")))},ns=()=>t().createElement("div",{className:Us().uploadBox},t().createElement(sn.ZM,{fileList:va,uploadConfig:{listType:"picture",accept:"image/jpg,image/jpeg,image/png",showUploadList:!1,maxCount:1,disabled:i||dt},size:{value:1,unit:"MB"},onUploadSuccess:ds,onUploadFailed:Ps,clip:n?"":"crop",quality:se,render:()=>t().createElement(c.Z,{title:dt?s("course.courseCoverUploadDisabledTip"):null},t().createElement(y.Z,{type:"default",disabled:i||dt},t().createElement(S.Z,{iconClass:"iconf-add",color:"rgba(0,0,0,0.45)",size:"12px"}),s("course.courseDetailCover")))}),t().createElement("div",{className:Us().tip},s("course.courseCoverTextTip"))),cs=()=>{var Ea=va.length<=Xe;return t().createElement("div",{className:Us().manageBtns},t().createElement(p.Z,{size:24},t().createElement(c.Z,{title:Ea?s("course.courseCoverManageBtnTooltip"):null},t().createElement("span",{className:Us().themeBtn,disabled:Ea||i,onClick:()=>!Ea&&ls(!0)},t().createElement(S.Z,{iconClass:"icon-shezhi1"}),s("exam.settings"))),t().createElement("span",{type:"link",className:Us().themeBtn,disabled:i,onClick:()=>!i&&ls(!1)},s("common.more"))))},vs=function(){var la=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],es=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],ea=Ga()(va);es.length&&(ea=xo()(es,ea,"url")),la.length?(N({coverType:0,cover:la[0].url,baseCover:""}),Yt(la[0]),Qa([...la,...ea])):(es.filter(Da=>Da.url===oa.url).length&&(N({coverType:ea[0].is_default?1:0,cover:ea[0].is_default?"":ea[0].url,baseCover:ea[0].is_default?ea[0].url:""}),Yt(ea[0])),Qa(ea))},os=Ea=>{var la=Ea.url;return oa.url===la};return t().createElement("div",{className:Us().cover},t().createElement("div",{className:Us().top},ns(),cs()),t().createElement("div",{className:Us().imageContainer},t().createElement("div",{className:Us().selectedBox},t().createElement("img",{className:Us().selectedImg,src:oa.url}),!u&&f.coverType===1&&t().createElement("div",{className:Us().courseTitle},Z.formik.values.title)),t().createElement("div",{className:Us().displayBox},va.slice(0,6).map(Ea=>t().createElement(Ir,{key:Ea.url,info:Ea,disabled:i,className:Us().displayImg,checked:os(Ea),onSelect:Ja})))),t().createElement(Fo,{visible:ft,uploadConfig:{config_type:r,isCrop:n},quality:se,disabled:i,defaultLen:Xe,title:s("course.courseCreatePanelFTCover"),curObj:oa,bgList:va,isManage:qt,onCancel:()=>kt(!1),onSelect:Ja,onRefresh:vs}))};Lr.defaultProps={coverSource:"cover",notUseTitle:!1,disabled:!1,isCrop:!1,needRefresh:!1,ifRefresh:!1,quality:.4};var wo=(0,m.$j)((0,E.Z)()(Lr));class xr extends t().Component{constructor(){super(...arguments);this.handleCheckMultiStage=r=>{var n=r.target.checked;this.props.onChange(n)}}render(){var r=this.props,n=r.isPreview,s=r.t,i=r.Cls,u=r.value;return t().createElement("div",{className:i},t().createElement(T.Z,{className:"".concat(i,"__checkbox"),checked:u,disabled:n,onChange:this.handleCheckMultiStage},s("component.stageBreak")),t().createElement("span",{className:"".concat(i,"__tips")}," ",s("component.stageBreakTips")))}}xr.defaultProps={Cls:"multistage-check"};var Uo=(0,m.$j)((0,E.Z)()(xr));class Nr extends t().Component{constructor(){super(...arguments);this.handleScheduleSync=r=>{this.props.onChange(r.target.value)}}render(){var r=this.props,n=r.t,s=r.isPreview,i=r.value;return t().createElement("div",{className:"setting-item"},t().createElement("div",{className:"setting-item-title"},n("learning.examinationPassSettings")),t().createElement("div",{className:"setting-item-content"},t().createElement(M.ZP.Group,{disabled:s,onChange:this.handleScheduleSync,size:"small",value:i},t().createElement(M.ZP,{value:"done"},n("learning.submitThePass")),t().createElement(M.ZP,{value:"pass"},n("learning.passThePass"))),t().createElement("span",{className:"study-time-limit-tip"},n("learning.learningPassExam"))))}}Nr.defaultProps={Cls:"setting-item"};var Bo=(0,m.$j)((0,E.Z)()(Nr)),yd=e(20136),Wo=e(55241),Ko=e(40847);class Mr extends t().Component{constructor(){super(...arguments);this.handleScheduleSync=r=>{this.props.onChange(r.target.value)}}render(){var r=this.props,n=r.t,s=r.isPreview,i=r.value,u=r.Cls;return t().createElement("div",{className:u},t().createElement("span",{className:"".concat(u,"_label")},n("common.scheduleSync"),"\uFF1A"),t().createElement(M.ZP.Group,{disabled:s,onChange:this.handleScheduleSync,size:"small",value:i},t().createElement(M.ZP,{value:"true"},n("common.synchronization")),t().createElement(M.ZP,{value:"false"},n("common.outSync"))),t().createElement(Wo.Z,{placement:"top",content:n("trainee.syncTip")},t().createElement(Ko.Z,{className:"tip-icon"})))}}Mr.defaultProps={Cls:"schedule-synchronization"};var $o=(0,m.$j)((0,E.Z)()(Mr)),Vo=e(64262);class kr extends t().Component{constructor(){super(...arguments);this.handleTreeSelectChange=r=>{this.props.onFieldChange(r)}}render(){var r=this.props,n=r.Cls,s=r.value,i=r.selectWidth,u=i===void 0?308:i,f=r.disabled,N=r.asyncLoad,Y=N===void 0?!0:N;return t().createElement("div",{className:n},t().createElement(Vo.Z,{className:"offline-input-width",width:u,parentId:"",checkable:!1,asyncLoad:Y,disabled:f,defaultValue:s,treeSelect:!0,handleTreeSelectChange:this.handleTreeSelectChange}))}}kr.defaultProps={Cls:"select-department-check"};var jo=(0,m.$j)((0,E.Z)()(kr));class Ar extends t().Component{constructor(r){super(r);this.onChangeMode=n=>{var s="";n==="normal"?(s=n,this.setState({valueLevelOne:s,valueLevelTwo:""})):(s=n==="desert"?n:"star",this.setState({valueLevelOne:"map",valueLevelTwo:s})),this.props.onChangeMode(s)},this.state={valueLevelOne:"normal",valueLevelTwo:"",mapModeListLevelOne:[{value:"normal",label:r.t("common.normalMode")},{value:"map",label:r.t("common.mapMode")}],mapModeListLevelTwo:[{value:"star",label:r.t("learning.learnUpgrade.universe"),path:"".concat("https://oss.coolcollege.cn","/1805135310212960256.png")},{value:"desert",label:r.t("learning.learnUpgrade.DesertOasis"),path:"".concat("https://oss.coolcollege.cn","/1805135433466777600.png")}]}}componentDidMount(){var r=this.props.value;this.setState({valueLevelOne:r==="normal"?r:"map",valueLevelTwo:r==="normal"?"":r})}render(){var r=this.props,n=r.isPreview,s=r.Cls,i=this.state,u=i.mapModeListLevelOne,f=i.mapModeListLevelTwo,N=i.valueLevelOne,Y=i.valueLevelTwo;return t().createElement("div",{className:s},t().createElement(M.ZP.Group,{disabled:n,onChange:J=>this.onChangeMode(J.target.value),size:"small",value:N},u.map(J=>t().createElement(M.ZP,{className:"itemLevel1",key:J.value,value:J.value},J.label))),N==="map"&&t().createElement(M.ZP.Group,{disabled:n,onChange:J=>this.onChangeMode(J.target.value),size:"small",className:"mapModeItem",value:Y},f.map(J=>t().createElement(M.ZP,{className:"radioItem",key:J.value,value:J.value},t().createElement("div",null,t().createElement(Ua.Z,{preview:!1,width:270,src:J.path}),t().createElement("div",null,J.label))))))}}Ar.defaultProps={Cls:"map-mode-set",isPreview:!1};var zo=(0,m.$j)((0,E.Z)()(Ar)),Yo=e(14011),An=e(38029),Qo=(0,Ke.Z)(Ne),Go=(0,Ke.Z)(le),Ho=(0,Ke.Z)(at),Rr=(0,Ke.Z)(q),Xo=(0,Ke.Z)(je),Jo=(0,Ke.Z)(Xi),qo=(0,Ke.Z)(ho),tr=fo,ed=(0,Ke.Z)(O.Z),td=(0,Ke.Z)(go),ad=(0,Ke.Z)(_o),sd=(0,Ke.Z)(yo),nd=(0,Ke.Z)(Io),Td=(0,Ke.Z)(Zo),rd=(0,Ke.Z)(wo),id=(0,Ke.Z)(Uo),ld=(0,Ke.Z)(g.Z),Sd=(0,Ke.Z)(Bo),od=(0,Ke.Z)($o),Pd=(0,Ke.Z)(jo),Dd=(0,Ke.Z)(zo),cd=(0,Ke.Z)(Yo.Z),ud=(0,Ke.Z)(An.Z)},38029:function(gt,Se,e){"use strict";e.d(Se,{E:function(){return h}});var O=e(59250),g=e(13013),b=e(89032),a=e(15746),T=e(71153),o=e(60331),D=e(13062),K=e(71230),P=e(57663),y=e(71577),C=e(33565),p=e(12924),B=e.n(p),c=e(94184),I=e.n(c),M=e(91768),v=e(80991),A=e(25459),d=e(62011),l=e.n(d),t=e(6793),h={WEEK:"week",MONTH:"month",DAY:"day"},F=m=>{var E=m.t,Q=m.value,G=Q===void 0?{days:[],dates:[]}:Q,V=m.formik,z=m.style,$=(0,p.useMemo)(()=>[E("common.monday"),E("common.tuesday"),E("common.wednesday"),E("common.thursday"),E("common.friday"),E("common.saturday"),E("common.sunday")],[E]),W=new Array(31).fill(1).map((H,X)=>X+1),S=V.values.loopType.type,x=(0,p.useState)(!1),U=(0,C.Z)(x,2),L=U[0],w=U[1],k=G.days,ne=G.dates,ie=(0,p.useMemo)(()=>S===h.MONTH?!G.dates.length:!G.days.length,[S,G.dates,G.days]),Ne=(0,p.useCallback)(H=>{w(H)},[]),ue=H=>{H.stopPropagation(),w(!1)},_e=(0,p.useMemo)(()=>{var H=G.dates||[];return H.length>=7?[...H.slice(0,8),(0,t.ZT)(E("eTouch.totalDate"),H.length)]:H},[G,E]),Ze=(0,p.useCallback)(()=>{if(S===h.MONTH){var H=new Array(31).fill(1);V.setFieldValue("loopCycle",{days:[],dates:H.map((ce,Te)=>Te)});return}if(S===h.WEEK){var X=new Array(7).fill(1);V.setFieldValue("loopCycle",{days:X.map((ce,Te)=>Te),dates:[]})}},[V,S]),j=(0,p.useCallback)(()=>{V.setFieldValue("loopCycle",{days:[],dates:[]}),V.validateField(["loopCycle"])},[V]),R=(0,p.useCallback)(H=>{var X=Array.from(k||[]),ce=Array.from(ne||[]),Te=S==="month"?ce:X,Le=Te.findIndex(he=>he===H);Le>-1?Te.splice(Le,1):Te.push(H),V.setFieldValue("loopCycle",{days:X,dates:ce}),!X.length&&!ce.length&&V.validateField(["loopCycle"])},[ne,k,V,S]),le=(0,p.useMemo)(()=>B().createElement("div",{className:l()["loop-select"]},B().createElement("div",{className:l().body},S===h.MONTH&&B().createElement("div",{className:l().week},W.map((H,X)=>B().createElement("div",{key:X,className:I()(l().tag,(ne||[]).includes(X)?l().active:"",l().small),onClick:()=>R(X)},H)),B().createElement("a",{className:l().action,onClick:Ze},E("eTouch.selectAll")),B().createElement("a",{className:l().action,onClick:j},E("eTouch.clearAll"))),S===h.WEEK&&B().createElement("div",{className:l().week},$.map((H,X)=>B().createElement("div",{key:X,className:I()(l().tag,(k||[]).includes(X)?l().active:""),onClick:()=>R(X)},H)),B().createElement("a",{className:l().action,onClick:Ze},E("eTouch.selectAll")),B().createElement("a",{className:l().action,onClick:j},E("eTouch.clearAll")))),B().createElement(K.Z,{className:l()["button-wrap"],justify:"space-around",align:"middle"},B().createElement(y.Z,{type:"link",className:l().cancel,onClick:ue},E("common.cancel")),B().createElement(y.Z,{type:"link",onClick:ue},E("common.ok")))),[E,W,$,ne,k,j,R,Ze,S]);return B().createElement(g.Z,{overlay:le,trigger:["click"],onVisibleChange:Ne,visible:L,overlayClassName:l()["drop-down"]},B().createElement("div",{className:I()(l().wrap,{[l().focus]:L,[l().placeholder]:ie}),style:z},B().createElement(K.Z,{justify:"space-between",style:{width:"100%"}},B().createElement(a.Z,{flex:"1"},ie?S===h.WEEK?E("eTouch.selectDay"):E("eTouch.selectDate"):B().createElement(B().Fragment,null,S===h.WEEK&&B().createElement("div",{className:l().week},(k||[]).map(H=>B().createElement(o.Z,{key:H},$[H]))),S===h.MONTH&&B().createElement("div",{className:l().week},(_e||[]).map(H=>B().createElement(o.Z,{key:H},W[H]||H))))),B().createElement(a.Z,null,B().createElement(A.Z,{style:{color:"rgba(0, 0, 0, 0.25)"}})))))};Se.Z=(0,v.$j)((0,M.Z)()(F))},14011:function(gt,Se,e){"use strict";var O=e(88983),g=e(47933),b=e(12924),a=e.n(b),T=o=>{var D=o.value,K=o.radioList,P=K===void 0?[]:K,y=o.onChange,C=p=>{y(p.target.value)};return a().createElement(g.ZP.Group,{onChange:C,value:D},P.map(p=>a().createElement(g.ZP,{key:p.value,value:p.value},p.title)))};Se.Z=T},52506:function(gt,Se,e){"use strict";var O=e(62350),g=e(75443),b=e(57663),a=e(71577),T=e(14965),o=e(11448),D=e(22385),K=e(31097),P=e(71194),y=e(57016),C=e(43358),p=e(34041),B=e(12924),c=e.n(B),I=e(91768),M=e(57119),v=e(36546),A=e(78138),d=e.n(A),l=e(44289),t=e(19654),h=e(37055),F=e(86458),m=e(84874),E=e(6793),Q=e(38642),G=e(60667),V=p.Z.Option;class z extends c().Component{constructor(W){super(W);this.handleDND=(S,x)=>{this.props.sortResource(S,x)},this.deleteModal=(S,x)=>{var U=this.props.t,L=U("study.studyContentDeleteTip");if(x.type==="xx"&&x.data.user_has_attendanted)L=U("lineClass.delClassTips");else if(x.type==="attendance")if(x.data.relate_course_list.length){var w="";x.data.relate_course_list.forEach(k=>{w+="\u300A".concat(k.course_name,"\u300B")}),x.data.user_has_attendanted?L=U("lineClass.delAttendanceTips",{classListName:w}):L=U("lineClass.delAttendanceTipsNoCourse",{classListName:w})}else x.data.user_has_attendanted&&(L=U("lineClass.delSingleAttendanceTips"));y.Z.confirm({title:U("common.tip"),icon:c().createElement(M.Z,null),content:L,onOk:()=>this.props.removeResource(S,x.type)})},this.renderTaskTip=S=>{var x=this.props.t;switch(S){case"xx":return x("common.offline");case"investigate":return x("questionn.investigate");case"sc":case"operation":return x("component.practiceExam");case"jobEvaluation":return x("learning.jobEvaluation");case"tutor":return x("tutorial.tutorShip");case"html":return x("common.html");case"jpg":case"jpeg":case"png":return x("common.image");case"attendance":return x("attendance.attendance");case"assess":return x("assessment.assess");default:return x("h5Article.title")}},this.renderTimeContent=(S,x)=>{var U=this.props.t,L=this.renderTaskTip(S.type);return x!==8&&S.duration!=="0"&&(S.status===3&&(S.originalType==="mp4"||S.originalType==="mp3")||S.type==="course"||S.type==="ex")?c().createElement("span",{className:"resource-item-duration"},(0,E.xj)(S.duration)):S.originalType==="html"||h.WB.includes(S.originalType)||S.originalType==="scorm"?c().createElement("span",{className:"resource-item-duration"},"--:--:--",c().createElement(K.Z,{placement:"top",title:U("common.notSupportSetTime")},c().createElement("span",null,c().createElement(m.Z,{iconClass:"icon-f-tipe",color:"#9C9C9F"})))):S.type==="xx"?c().createElement("span",{className:"resource-item-duration"},(0,E.xj)(S.data.course_duration*60)):S.type==="investigate"||S.type==="sc"||S.type==="operation"||S.type==="jobEvaluation"||S.type==="h5"||S.originalType==="h5"||S.type==="tutor"||S.type==="attendance"||S.type==="assess"?c().createElement("span",{className:"resource-item-duration"},"--:--:--",c().createElement(K.Z,{placement:"top",title:"".concat(L," ").concat(U("course.notStudyLimit"))},c().createElement("span",null,c().createElement(m.Z,{iconClass:"icon-f-tipe",color:"#9C9C9F"})))):S.status&&S.status!==3?c().createElement("span",{className:"resource-item-duration"},"--:--:--",c().createElement(K.Z,{placement:"top",title:U("course.transcodingStudyLimit")},c().createElement("span",null,c().createElement(m.Z,{iconClass:"icon-f-tipe",color:"#9C9C9F"})))):c().createElement("span",{className:"resource-item-duration"},"--:--:--",c().createElement(K.Z,{placement:"top",title:U("course.documentStudyLimitTip3")},c().createElement("span",null,c().createElement(m.Z,{iconClass:"icon-f-tipe",color:"#9C9C9F"}))))},this.renderOther=(S,x)=>{if(S.type==="xx"){if(x==="dateRange"&&S.data.dateRange&&S.data.dateRange.startTime&&S.data.dateRange.endTime)return c().createElement("span",{className:"resource-item-duration"},d()(S.data.dateRange.startTime).format("YYYY-MM-DD HH:mm")," ~ ",d()(S.data.dateRange.endTime).format("YYYY-MM-DD HH:mm"));if(x==="user")return c().createElement("span",{className:"resource-item-duration user-name"},this.props.t("component.lecturer"),"\uFF1A",S.data.teacher.teacher_sync_type==="inside"?c().createElement(G.Z,{dataType:"userName",value:S.data.teacher.teacher_sync_user_id,name:S.data.teacher.lecturer_name,type:S.data.teacher.teacher_sync_source_type}):S.data.teacher.lecturer_name)}if(S.type==="attendance"){if(x==="dateRange")return c().createElement("div",{className:"resource-item-attendance"},(S.data.sign_in_begin_time||S.data.sign_in_end_time)&&c().createElement("div",{className:"resource-item-duration"},d()(S.data.sign_in_begin_time).format("YYYY-MM-DD HH:mm")," ~ ",d()(S.data.sign_in_end_time).format("YYYY-MM-DD HH:mm")),(S.data.sign_out_begin_time||S.data.sign_out_end_time)&&c().createElement("div",{className:"resource-item-duration"},d()(S.data.sign_out_begin_time).format("YYYY-MM-DD HH:mm")," ~ ",d()(S.data.sign_out_end_time).format("YYYY-MM-DD HH:mm")));if(x==="user"){var U,L=((U=S.data)===null||U===void 0?void 0:U.directors)||[];return c().createElement("span",{className:"resource-item-duration user-name"},this.props.t("lineClass.principal"),"\uFF1A",L.map((w,k)=>c().createElement("div",{key:w.user_id,style:{display:"inline-block"}},c().createElement(G.Z,{dataType:"userName",value:w.sync_user_id||w.user_id,name:w.user_name||w.name,type:w.sync_source_type||w.source_type}),k===L.length-1?"":",")))}}return null},this.disabledDateResource=(S,x)=>{var U=x[0],L=x[1];return S&&S<d()(d()(U).format("YYYY-MM-DD 00:00:00"))||S<d()().subtract("day",1)||S>d()(d()(L).format("YYYY-MM-DD 23:59:59"))},this.handleEvent=(S,x,U)=>{this.props.handleEvent(S,x,U)},this.renderLaboratorySelect=(S,x,U)=>{var L=U.lab_resource_id||"";return c().createElement("div",{className:"resource-item-laboratory"},c().createElement(p.Z,{showSearch:!0,value:L,style:{width:130},placeholder:this.props.t("lab.notSelEnv"),optionFilterProp:"children",onChange:(w,k)=>this.handleEvent(w,k,x)},c().createElement(V,{value:"",key:""},this.props.t("lab.notSelEnv")),S.map(w=>c().createElement(V,{value:w.value,key:w.value},w.label))))},this.handlePreview=S=>{var x,U=t.Z.init(S.data.resource||S.data);U!=null&&(x=U.resourcePlayInfo)!==null&&x!==void 0&&x.watchType&&this.props.viewResource(U)},this.renderItem=(S,x,U)=>{var L=this.props,w=L.editable,k=L.isPreview,ne=L.t,ie=L.showChangeBtn,Ne=L.deleteModal,ue=L.unlockTimeDisable,_e=L.errors,Ze=L.parentId,j=L.laboratoryList,R=S.data,le=R===void 0?{}:R,H=S.componentName,X=localStorage.getItem("themeColor")||"#516AE6",ce=this.state,Te=ce.showLaboratory,Le=ce.whiteList,he=le.resourceSourceType?le.resourceSourceType:"",Ee=le.source_type?le.source_type:he,ve=["attendance","xx","sc","operation","jobEvaluation","ex","tutor","investigate","assess"],be=ve.some(Ae=>S.type===Ae),Ve=(S.type==="xx"||S.type==="attendance")&&S.data.user_has_attendanted||S.type==="attendance"&&S.data.relate_course_list.length;return c().createElement(F.Z,{id:S.id,key:S.id||x,title:S.name,index:x,disabled:k,onDND:this.handleDND},c().createElement("div",{className:"stage-resource-list-item",key:x},c().createElement("span",{className:"resource-item-index"},U),c().createElement("span",{className:"resource-item-icon"},c().createElement(m.Z,{iconClass:S.data&&S.data.bizType&&S.data.bizType===6&&S.data.type==="crs"?"icon-wenzhang":S.icon,size:"14px"})),c().createElement("span",{className:S.componentName==="CoursewareSelector"?"resource-item-name active":"resource-item-name",onClick:()=>{this.handlePreview(S)}},c().createElement(K.Z,{placement:"top",title:S.name},S.type==="attendance"?S.data.name:S.name)),S.resourceErrTip?c().createElement("span",{className:"resource-item-error"},c().createElement(m.Z,{iconClass:"icon-icon_attentionx1",size:"14px"}),S.resourceErrTip):null,this.renderOther(S,"dateRange"),S.type!=="attendance"&&this.renderTimeContent(S,Ee),this.renderOther(S,"user"),Le.addLabSelect&&Te&&(H==="CoursewareSelector"||H==="CourseSelector")&&this.renderLaboratorySelect(j,S.id,S),c().createElement("span",{className:"resource-item-action"},ue?c().createElement(o.Z,{className:"unlock_Hour ".concat(_e&&_e.stages&&_e.stages[Ze+(S.id||S.key)]?"stage_hour_error":""),showTime:!0,disabledDate:Ae=>this.disabledDateResource(Ae,ue),size:"small",showNow:!1,value:le.unlockingTime,disabled:!this.props.editable,format:"YYYY-MM-DD HH:mm",placeholder:ne("assgin.unLockTimeLabel"),onChange:Ae=>this.props.changeDate(Ae,x)}):null,be?c().createElement("span",{className:"resource-item-edit",onClick:()=>this.props.editResource(x)},c().createElement(m.Z,{iconClass:"icon-icon_settingx1",size:"14px"})):null,ie&&(S.componentName==="CourseSelector"||S.componentName==="CoursewareSelector")?c().createElement("span",{className:"resource-item-replace",style:{color:X},onClick:()=>this.props.replaceResource(x)},c().createElement(K.Z,{placement:"top",title:ne("common.replace")},c().createElement("span",null,c().createElement(m.Z,{iconClass:"icon-genghuan",size:"14px",color:"#9C9C9F"})))):null,w&&(Ne||Ve?c().createElement("span",{className:"resource-item-remove"},c().createElement(a.Z,{type:"link",className:"resource-item-remove-icon",onClick:()=>this.deleteModal(x,S)},c().createElement(m.Z,{iconClass:"icon-icon_close",size:"14px"}))):c().createElement("span",{className:"resource-item-remove"},c().createElement(g.Z,{placement:"topLeft",title:ne("component.removeFromStageTip"),onConfirm:()=>this.props.removeResource(x,S.type),okText:ne("common.ok"),cancelText:ne("common.cancel")},c().createElement(a.Z,{type:"link",className:"resource-item-remove-icon"},c().createElement(m.Z,{iconClass:"icon-icon_close",size:"14px"}))))),c().createElement("span",{className:"resource-item-sort"},c().createElement(m.Z,{iconClass:"icon-yidong",size:"14px"})))))},this.state={showLaboratory:!1,whiteList:{addLabSelect:(0,Q.UI)("TRAINING_ADD_LAB_SELECT")}}}componentDidMount(){var W=window.location.href.split("#")[1].split("?")[0];W==="/training/learning/project/add"&&this.setState({showLaboratory:!0})}render(){var W=this.props,S=W.list,x=W.unlockTimeDisable,U=0;return c().createElement("div",{className:"stage-resource-list"},S.map((L,w)=>x&&(L.type==="xx"||L.type==="jobEvaluation"||L.type=="attendance")?null:(U+=1,this.renderItem(L,w,U))))}}Se.Z=(0,v.Z5)(l.ZP)((0,I.Z)()(z))},52670:function(gt,Se,e){"use strict";e.d(Se,{V5:function(){return p},FI:function(){return B},WW:function(){return c},NW:function(){return A},ZE:function(){return d},Pe:function(){return l},EU:function(){return t},oN:function(){return h},rn:function(){return F},kT:function(){return m},t3:function(){return E}});var O=e(93485),g=e(88986),b=e(78138),a=e.n(b),T=e(41222),o=e(38029),D=e(2396),K=e(3407),P=e(6793),y=(0,P.me)(),C=K.Z[y].validation,p=Q=>{var G;return(!Q.startTime||!Q.endTime)&&(G=C.dateRange),G},B=(Q,G)=>{var V,z=Q.rangeType,$=Q.rangeList;if(!z&&z!==0)V=C.employeeAssignment;else if(z===2){var W=$.dept,S=$.group,x=$.post,U=$.user,L=$.cluster,w=L===void 0?[]:L,k=$.classes,ne=k===void 0?[]:k,ie=[...W,...S,...x,...U,...w,...ne];ie.length||(V=G||C.employeeNull)}return V},c=(Q,G)=>{var V,z=Q.rangeType,$=Q.rangeList;if(!z&&z!==0)V=C.employeeAssignment;else if(z===2){var W=$.departments,S=$.groups,x=$.posts,U=$.users,L=$.clusters,w=L===void 0?[]:L,k=$.roles,ne=k===void 0?[]:k,ie=[...W,...S,...x,...U,...w,...ne];ie.length||(V=G||C.employeeNull)}return V},I=Q=>{var G,V=Q.rangeType,z=Q.rangeList;if(!V&&V!==0)G=C.employeeAssignment;else if(V===2){var $=z.dept,W=z.group,S=z.post,x=z.user,U=z.cluster,L=U===void 0?[]:U,w=z.classes,k=w===void 0?[]:w,ne=[...$,...W,...S,...x,...L,...k];ne.length||(G=C.employeeOnlyGroupNull)}return G},M=(Q,G)=>a()(Q).format("YYYY-MM-DD HH:mm:".concat(G==="start"?"00":"59")),v=(Q,G,V)=>{var z=(0,g.Z)({},V),$=G.startTime,W=G.endTime,S=[],x=(0,O.Z)(Q),U;try{for(x.s();!(U=x.n()).done;){var L=U.value;if(!L.studyTime){z[L.key]=!0,S.push(L.name);continue}if(!L.studyTime[0]||!L.studyTime[1]){z[L.key]=!0,S.push(L.name);continue}if(L.studyTime[0].valueOf()==L.studyTime[1].valueOf()){z[L.key]=!0,S.push(L.name);continue}if(($||W)&&(L.studyTime[0]&&L.studyTime[0]<a()(M($,"start"))||L.studyTime[1]>a()(M(W,"end")))){z[L.key]=!0,S.push(L.name);continue}var w=!1,k=(0,O.Z)(L.validateList),ne;try{for(k.s();!(ne=k.n()).done;){var ie=ne.value;if(!ie.data.unlockingTime){z[L.key+(ie.id||ie.key)]=!0,w=!0;continue}if(ie.data.unlockingTime<a()(M(L.studyTime[0],"start"))||ie.data.unlockingTime>a()(M(L.studyTime[1],"end"))){z[L.key+(ie.id||ie.key)]=!0,w=!0;continue}}}catch(Ne){k.e(Ne)}finally{k.f()}w&&S.push(L.name)}}catch(Ne){x.e(Ne)}finally{x.f()}return S.length&&(z.timeMsg=(0,P.ZT)("".concat(C.checkStageTaskStageTime),"".concat(S.join("\u3001")))),z},A=(Q,G,V)=>{var z=G?G.scheduleSetting:null,$=G?G.dateRange:{},W={},S=(0,O.Z)(Q),x;try{for(S.s();!(x=S.n()).done;){var U=x.value;U.validateList=[...z==="unlock_mode"?U.list.filter(de=>de.type!=="xx"&&de.type!=="jobEvaluation"&&de.type!=="attendance"):U.list]}}catch(de){S.e(de)}finally{S.f()}if(!Q||Q.length===0)W.commonMsg=C.checkStageTaskNull;else{var L=Q.filter((de,we)=>(de.indexName="".concat(C.stage).concat(we+1),de.validateList.length===0)),w=Q.filter((de,we)=>(de.indexName="".concat(C.stage).concat(we+1),de.name===""));if(w.length>0){var k=w.map(de=>de.indexName).join("\u3001");W.commonMsg=(0,P.ZT)("".concat(C.errorTips,": ").concat(C.checkStageTaskNameNull),k)}if(L.length>0){var ne=L.map(de=>de.indexName).join("\u3001");W.commonMsg=(0,P.ZT)("".concat(C.checkStageTaskStageNull),ne)}else{var ie=Q.reduce((de,we)=>de.concat(we.validateList.filter(rt=>rt.type!=="ex"&&rt.type!=="xx"&&rt.type!=="attendance"&&rt.type!=="sc"&&rt.type!=="tutor"&&rt.type!=="investigate"&&rt.type!=="assess")),[]),Ne=[];if(Q.forEach((de,we)=>{if(de.validateList.forEach(Ft=>{ie.filter(Ut=>Ut.id===Ft.id).length>1&&Ne.findIndex(Ut=>Ut.id===Ft.id)===-1&&Ne.push({name:Ft.name,id:Ft.id})}),de.Standard){var rt=(0,T.z2)([de]),mt=(0,T.GM)([de]),Zt=(0,T.S1)([de]),bt=(0,T.Qz)([de]);(bt===0&&rt===0&&mt===0&&Zt===0||!de.Standard.progressCheck&&!de.Standard.examCheck&&!de.Standard.practiceCheck&&de.Standard.jobEvaluationCheck==="false"||de.Standard.progressCheck&&!de.Standard.progress||rt!==0&&!de.Standard.examCheck||mt!==0&&!de.Standard.practiceCheck)&&(W.commonMsg=(0,P.ZT)("".concat(C.stage).concat(we+1).concat(C.checkStageAddItemPass)))}de.reward&&(de.reward.getScoreChecked&&!de.reward.getScore||de.reward.certificateChecked&&!de.reward.certificateId)&&(W.commonMsg=(0,P.ZT)("".concat(C.stage).concat(we+1).concat(C.checkStageAddItemPassTwo)))}),Ne.length>0){var ue=Ne.map(de=>"\u300A".concat(de.name,"\u300B"));W.commonMsg=(0,P.ZT)("".concat(C.checkStageTaskStageRepeat),"".concat(ue.join("\u3001")))}else if(z!=="unlock_mode"){for(var _e=Q.reduce((de,we)=>de.concat(we.validateList.filter(rt=>rt.type==="xx")),[]),Ze=[],j=0;j<_e.length;j++){var R=_e[j].data.dateRange;Ze.push({sTime:(0,P.jZ)(R.startTime),startTime:R.startTime,endTime:R.endTime,eTime:(0,P.jZ)(R.endTime)})}for(var le=Ze.sort((de,we)=>de.sTime-we.sTime),H=!1,X=1;X<le.length;X++){var ce=le[X-1],Te=le[X];(ce.sTime===Te.sTime||Te.sTime<ce.eTime)&&(H=!0)}if(H&&(W.commonMsg=C.learningAddItemDateRangeTraining),_e.length&&!V){var Le=$.startTime,he=$.endTime;if(Le&&he){var Ee=_e.map(de=>de.data),ve=_e.filter(de=>!de.id).map(de=>de.data),be=[],Ve=[];Ee.forEach(de=>{be.push(de.dateRange.startTime),be.push(de.dateRange.endTime)}),ve.forEach(de=>{Ve.push(de.dateRange.startTime),Ve.push(de.dateRange.endTime)});var Ae=be.sort(),at=Ve.sort();(Ae[0]<a()(Le).valueOf()||Ae[Ae.length-1]>a()(he).valueOf())&&(W.commonMsg=C.classTimeRange);for(var et=0;et<at.length;et++){var ut=at[et];ut<new Date().getTime()&&(W.commonMsg=C.classTimeBeyond)}}}if(_e.length){var q=[];_e.forEach(de=>{q.push(de.name)});var Oe=q.sort();if(Oe.length)for(var Je=0;Je<Oe.length-1;Je++)Oe[Je]==Oe[Je+1]&&(W.commonMsg=(0,P.ZT)("".concat(C.classNameRepeat),"\u300A".concat(Oe[Je],"\u300B")))}var je=[];if(Q.forEach(de=>{var we=[],rt=[];de.validateList.forEach(mt=>{mt.type==="xx"?we.push(mt):mt.type==="attendance"&&rt.push(mt)}),we.length&&!rt.length&&je.push(de)}),je.length){var Be=je.map(de=>de.indexName).join("\u3001");W.commonMsg=(0,P.ZT)("".concat(C.addAttendanceTips),Be)}var St=Q.reduce((de,we)=>de.concat(we.validateList.filter(rt=>rt.type==="attendance")),[]);if(St.length){var Lt=[];St.forEach(de=>{Lt.push(de.name)});var Wt=Lt.sort();if(Wt.length)for(var Je=0;Je<Wt.length-1;Je++)Wt[Je]==Wt[Je+1]&&(W.commonMsg=(0,P.ZT)("".concat(C.attendanceNameRepeat),"\u300A".concat(Wt[Je],"\u300B")))}if(St.length&&!V){var pa=$.startTime,Xt=$.endTime;if(pa&&Xt){var Et=St.map(de=>de.data),Fe=St.filter(de=>!de.id).map(de=>de.data),Pe=[],Ie=[];Et.forEach(de=>{de.sign_in_begin_time&&Pe.push(de.sign_in_begin_time),de.sign_in_end_time&&Pe.push(de.sign_in_end_time),de.sign_out_begin_time&&Pe.push(de.sign_out_begin_time),de.sign_out_end_time&&Pe.push(de.sign_out_end_time)}),Fe.forEach(de=>{de.sign_in_begin_time&&Ie.push(de.sign_in_begin_time),de.sign_in_end_time&&Ie.push(de.sign_in_end_time),de.sign_out_begin_time&&Ie.push(de.sign_out_begin_time),de.sign_out_end_time&&Ie.push(de.sign_out_end_time)});var $e=Pe.map(de=>a()(de).valueOf()).sort(),te=Ie.map(de=>a()(de).valueOf()).sort();($e[0]<a()(pa).valueOf()||$e[$e.length-1]>a()(Xt).valueOf())&&(W.commonMsg=C.attendanceTimeRange);for(var ae=0;ae<te.length;ae++){var Re=te[ae];Re<new Date().getTime()&&(W.commonMsg=C.attendanceTimeBeyond)}}}}}}return z==="unlock_mode"?(W=v(Q,$,W),W=Object.keys(W).length?W:""):W=W.commonMsg||"",W},d=Q=>{var G;return Q||(G=C.checkClassify),G},l=Q=>{var G;return Q||(G=C.checkDatePicker),G},t=Q=>{var G;switch(D.fA.positiveInteger.test(Q.number)||(G=C.checkTemplateTerm),Q.type){case"D":Q.number>365&&(G=C.dayMaxCheck);break;case"H":Q.number>8760&&(G=C.monthMaxCheck);break;case"M":Q.number>525600&&(G=C.minuteMaxCheck);break;default:break}return G},h=Q=>{var G;return Q.shouldRendered||(G=C.checkTemplateTimer),G},F=Q=>{var G;return Q||(G=C.h5ArticleNull),G},m=(Q,G)=>{var V,z=G===o.E.WEEK&&!Q.days.length,$=G===o.E.MONTH&&!Q.dates.length;return(z||$)&&(V=C.checkLoopCyclePicker),V},E=Q=>{var G;if(!Q||!Q.trim()){var V=K.Z[y].learning.validation;G=V.tutorTip}return G}},19654:function(gt,Se,e){"use strict";var O=e(88986),g=e(34792),b=e(48086),a=e(78001),T=e(57068),o=e(1164),D=e(37055);class K{init(y){try{var C=y.name,p=y.videoId,B=y.video_id,c=y.storage_type,I=y.status,M=y.type,v=y.contentType,A=y.aiUpgradeStatus,d=y.id,l=y.url,t=y.path,h=I===1||I===2;if(h){b.default.warning(a.Z.t("resourceLibrary.transcodingPlayerTip"));return}var F=this.transWatchType(y),m=D.Ss.indexOf(v)>-1;switch(M==="mp4"&&A==="finish"&&(F="aiCourse"),F){case"aiCourse":this.viewAiCourse(d);break;case"article":this.viewArticle({contentType:v,url:l,id:d});break;case"doc":return this.viewResourcePlay({watchType:F,name:C,dataInfo:{resourceInfo:{type:"",docType:M,aliUrl:t,url:l,docTitle:C,playId:p||B,storageType:c}}});case"image":return this.viewResourcePlay({watchType:F,name:C,dataInfo:{resourceInfo:{url:l,playId:p||B,storageType:c}}});case"html":return this.viewResourcePlay({watchType:F,name:C,dataInfo:{resourceInfo:{url:l}}});case"scorm":var E=l.split("//"),Q=E[1].split("/"),G=[E[0],Q[0]].join("//"),V="".concat(G,"/unzip_file/coolcollege-scorm/prod/preview.html?scormUrl=").concat(encodeURIComponent(l));return this.viewResourcePlay({watchType:F,name:C,dataInfo:{resourceInfo:{url:V}}});default:return this.viewResourcePlay({watchType:F,name:C,dataInfo:{resourceInfo:{source:{FD:l,OD:t},originUrl:l,contentType:m?"mp3":M,playId:p||B,storageType:c},autoPlay:!0,draggable:!0}})}}catch(z){console.error(z)}}viewAiCourse(y){history.push({pathname:"/training/resourceManage/library/videoPreview",search:T.stringify({id:y})})}viewArticle(y){var C=y.contentType,p=y.url,B=y.id,c=C==="h5/link";c?o.Z.targetTo({path:p,isExternalLink:!0}):o.Z.targetTo({path:"/training/resourceManage/library/articlePreview?id=".concat(B)})}transWatchType(y){var C=D.Yq.findIndex(d=>y.type.toLowerCase().includes(d))>-1,p=D.WB.indexOf(y.type.toLowerCase())>-1,B=D.SR.indexOf(y.type.toLowerCase())>-1||y.contentType.indexOf("html")>-1,c=y.contentType.indexOf("scorm")>-1,I=y.contentType.indexOf("video")>-1,M=D.Ss.indexOf(y.contentType)>-1,v=y.contentType.indexOf("h5")>-1,A="";return v?A="article":C?A="doc":I||M?A="video":p?A="image":B?A="html":c&&(A="scorm"),A}viewResourcePlay(y){var C=y.watchType,p=y.name,B=y.dataInfo,c=(0,O.Z)({mode:"preview",watchType:C},B);return{resourcePlayInfo:c,previewInfo:{title:p}}}}Se.Z=new K},95664:function(gt,Se,e){"use strict";var O=e(14781),g=e(53431),b=e(12924),a=e.n(b),T=e(91768),o=e(84874);class D extends a().Component{render(){var P=this.props,y=P.prefixCls,C=P.showRenderRefresh,p=P.totalNum,B=P.totalPage,c=P.onRefresh,I=P.onChange,M=P.defaultPageSize,v=P.current,A=P.t,d=P.onShowSizeChange,l=d===void 0?()=>{}:d;return a().createElement("div",{className:y},a().createElement("span",{className:"".concat(y,"__info")},C&&a().createElement("span",{className:"".concat(y,"__info__refresh"),onClick:c},a().createElement(o.Z,{iconClass:"iconf-switch",color:"#535B6E",size:"14px"})),A("component.totalLabel"),a().createElement("b",null,B),A("component.pageLabel"),"\uFF0C",a().createElement("b",null,p),A("component.dataItems")),p?a().createElement(g.Z,{size:"small",total:p,onChange:I,current:v,defaultPageSize:M,showSizeChanger:!1,onShowSizeChange:l}):null)}}D.defaultProps={prefixCls:"cl-modal-pagination",showRenderRefresh:!0,totalNum:0,totalPage:0,defaultPageSize:12,current:1,onRefresh:()=>{},onChange:()=>{}},Se.Z=(0,T.Z)()(D)},48194:function(gt,Se,e){"use strict";e.d(Se,{q:function(){return b},$:function(){return a}});var O=e(37055),g=e(10237);function b(){var T=O.ZP.multiTerminalLogin.getEnterpriseOrganizations();return g.WY.get({url:T})}function a(){var T=O.ZP.advancedSetting.getSetting();return g.WY.get({url:T,params:{page_size:9999,page_number:1}})}},87722:function(gt,Se,e){"use strict";var O=e(62029),g=e(81211),b=e(14965),a=e(11448),T=e(12924),o=e.n(T),D=e(91768),K=e(78138),P=e.n(K),y=e(6793),C=e(37055),p=a.Z.RangePicker;class B extends o().Component{constructor(){super(...arguments);this.state={value:[]},this.handleChange=(I,M)=>{var v=this.props,A=v.onCustomChange,d=v.timestamp;if(!I||!I.length){this.setState({value:[]},()=>{A({startTime:null,endTime:null,value:I,dateStrings:M})});return}var l=this.props,t=l.startTimeFormatter,h=t===void 0?C.XE.INITIAL_DATE_FMT.PARAMS:t,F=l.endTimeFormatter,m=F===void 0?C.XE.INITIAL_DATE_FMT.PARAMS:F,E=d?I[0].valueOf():I[0].format(h),Q=d?I[1].valueOf():I[1].format(m),G=(0,y.jZ)(M[0])>(0,y.jZ)(M[1]);G&&M.reverse(),this.setState({value:G?[I[1],I[0]]:I},()=>{A({startTime:E,endTime:Q,value:I,dateStrings:M})})},this.clearTime=()=>{this.setState({value:[]})}}componentDidMount(){var I=this.props.defaultValue;if(I&&I[0]&&I[1]){var M=I.map(v=>P()(v));this.setState({value:M})}}UNSAFE_componentWillReceiveProps(I){if(I.defaultValue&&this.props.defaultValue&&(I.defaultValue[0]!==this.props.defaultValue[0]||I.defaultValue[1]!==this.props.defaultValue[1]))if(I.defaultValue[0]&&I.defaultValue[1]){var M=I.defaultValue.map(v=>P()(v));this.setState({value:M})}else this.setState({value:[]})}render(){var I=this.props,M=I.t,v=I.showTime,A=v===void 0?!0:v,d=I.disabledDate,l=I.noRange,t=I.ranges,h=I.customerShowTime,F=h===void 0?!1:h,m=(0,g.Z)(I,["t","showTime","disabledDate","noRange","ranges","customerShowTime"]),E=this.state.value,Q=t&&JSON.stringify(t)!="{}"?t:{["".concat(M("component.lastWeek"))]:[P()().subtract("day",7),P()()],["".concat(M("component.lastMonth"))]:[P()().subtract("day",30),P()()],["".concat(M("component.lastThreeMonth"))]:[P()().subtract("month",3),P()()]};return o().createElement(p,(0,O.Z)({value:E,showTime:A?F?A:{format:C.XE.INITIAL_TIME_FMT.VIEW,defaultValue:[P()("00:00:00","HH:mm:ss"),P()("23:59:59","HH:mm:ss")]}:!1,format:C.XE.INITIAL_DATE_FMT.PARAMS,ranges:l?{}:Q,disabledDate:d||y.tI,onChange:this.handleChange},m))}}B.defaultProps={showTime:!0,disabledDate:null,noRange:!1,ranges:{},rest:{},timestamp:!1},Se.Z=(0,D.Z)("translation",{withRef:!0})(B)},76343:function(gt,Se,e){"use strict";var O=e(71194),g=e(57016),b=e(57361),a=e(88986),T=e(57663),o=e(71577),D=e(34792),K=e(48086),P=e(9754),y=e.n(P),C=e(12924),p=e.n(C),B=e(91768),c=e(96120),I=e.n(c),M=e(24144);class v extends C.PureComponent{constructor(){super(...arguments);this.state={src:null,crop:{unit:"%",width:80,height:80,x:10,y:10,aspect:16/9},imgBold:{},fileName:"",imgType:"image/jpg"},this.onSelectFile=d=>{if(d.target.files&&d.target.files.length>0){var l=new FileReader,t=d.target.files[0];l.addEventListener("load",()=>{this.setState({src:l.result,fileName:t.name,imgType:t.type})}),l.readAsDataURL(t)}},this.onImageLoaded=d=>{this.imageRef=d},this.onCropComplete=d=>{this.makeClientCrop(d)},this.onCropChange=d=>{this.setState({crop:d})},this.onOk=()=>{var d=this.state,l=d.imgBold,t=d.imgType,h=new File([l],l.name,{type:t}),F=new FormData;F.append("file",h),F.append("access_token",localStorage.getItem("token")),(0,M.ws)(F).then(m=>{m.data.code===0&&(this.props.isShowMsg&&K.default.success("".concat(this.props.t("course.courseDetailCoverSuccess"))),this.handleSuccessUpload(m.data))}).catch(m=>{var E=this.props.onUploadFailed;E&&E({error:m,data:{fileList:[{fileName:h.name}]}})})},this.handleSuccessUpload=d=>{var l=this.props.onOk,t=d.data,h=t.fileNewName,F=t.server,m=t.fileName,E="".concat(F,"/").concat(h);l({fileName:m,imgUrl:E,fileNewName:h})},this.renderFooter=()=>{var d=this.props,l=d.prefixCls,t=d.t,h=d.accept,F="".concat(l,"__upload");return p().createElement("div",{className:"".concat(l,"__footer")},p().createElement(o.Z,{type:"default",className:F},t("component.reUpload"),p().createElement("input",{type:"file",multiple:!1,accept:h,onChange:this.onSelectFile})),p().createElement(o.Z,{type:"primary",onClick:this.onOk},t("common.ok")))}}componentDidMount(){var d=this.props,l=d.file,t=d.widthScale,h=d.heightScale,F=this.state.crop,m=new FileReader;m.readAsDataURL(l),m.addEventListener("load",()=>{this.setState({src:m.result,crop:(0,a.Z)((0,a.Z)({},F),{},{aspect:t/h}),fileName:l.name,imgType:l.type})})}getCroppedImg(d,l,t){var h=this.state.imgType,F=this.props.quality,m=document.createElement("canvas"),E=d.naturalWidth/d.width,Q=d.naturalHeight/d.height;F?(m.width=l.width*E,m.height=l.height*E):(m.width=l.width,m.height=l.height);var G=m.getContext("2d");return G.drawImage(d,l.x*E,l.y*Q,l.width*E,l.height*Q,0,0,m.width,m.height),new Promise((V,z)=>{m.toBlob($=>{if(!$){z(new Error("Canvas is empty"));return}$.name=t,window.URL.revokeObjectURL(this.fileUrl),this.fileUrl=window.URL.createObjectURL($),this.setState({imgBold:$}),V(this.fileUrl)},h,F)})}makeClientCrop(d){var l=this;return(0,b.Z)(y().mark(function t(){return y().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(!(l.imageRef&&d.width&&d.height)){F.next=3;break}return F.next=3,l.getCroppedImg(l.imageRef,d,l.state.fileName);case 3:case"end":return F.stop()}},t)}))()}render(){var d=this.state,l=d.crop,t=d.src,h=this.props,F=h.visible,m=h.prefixCls,E=h.onCancel;return p().createElement(g.Z,{className:m,title:"\u8C03\u6574\u5C3A\u5BF8",visible:F,footer:this.renderFooter(),width:623,onCancel:E},p().createElement("div",{className:"".concat(m,"__container")},p().createElement("div",{className:"".concat(m,"__container__crop")},t&&p().createElement(I(),{className:"".concat(m,"__crop"),src:t,crop:l,ruleOfThirds:!0,keepSelection:!0,imageStyle:{width:"100%"},onImageLoaded:this.onImageLoaded,onComplete:this.onCropComplete,onChange:this.onCropChange}))))}}v.defaultProps={prefixCls:"img-corp-modal",visible:!1,widthScale:16,heightScale:9,sizeLimit:1,sizeLimitUnit:"MB",accept:"image/jpg,image/jpeg,image/png",isShowMsg:!1,onCancel:()=>{},onOk:()=>{}},Se.Z=(0,B.Z)()(v)},63273:function(gt,Se,e){"use strict";e.d(Se,{Pg:function(){return Ie},e0:function(){return Xt},we:function(){return Et},l3:function(){return Lt},J:function(){return Fe},Be:function(){return St},Af:function(){return pa}});var O=e(88983),g=e(47933),b=e(12924),a=e.n(b),T=e(91768),o=e(80991),D=e(78138),K=e.n(D);class P extends a().Component{constructor(){super(...arguments);this.handleCheckType=te=>{var ae=this.props,Re=ae.formik.values,de=ae.formik,we=ae.t;if(te.target.value==="course_config"){var rt=Re.courseList.map((mt,Zt)=>({name:"".concat(we("component.offlineCourseTime")).concat(Zt+1).concat(we("common.course")),custom:!1,time_type:"time_slot",qrcode_type:"statics",sign_in_begin_min:15,sign_in_end_min:15,sign_out_begin_min:0,sign_out_end_min:30,sign_in_time:mt.dateString?[K()(mt.dateString).subtract(15,"m"),K()(mt.dateString).add(15,"m")]:["",""],sign_out_time:mt.dateString?[K()(mt.dateString),K()(mt.dateString).add(30,"m")]:["",""]}));de.setFieldValue("offline_course_sign_config_list",rt)}te.target.value==="custom"&&de.setFieldValue("offline_course_sign_config_list",[]),this.props.onFieldChange(te.target.value)}}render(){var te=this.props,ae=te.t,Re=te.isPreview,de=te.value;return a().createElement(g.ZP.Group,{disabled:Re,onChange:this.handleCheckType,size:"small",value:de},a().createElement(g.ZP,{value:"course_config"},ae("lineClass.byCourseSetting")),a().createElement(g.ZP,{value:"custom"},ae("lineClass.setUp")))}}P.defaultProps={Cls:"schedule-synchronization"};var y=(0,o.$j)((0,T.Z)()(P)),C=e(63185),p=e(9676),B=e(71153),c=e(60331),I=e(88986),M=e(84874),v=e(31151),A=e(60667);class d extends a().Component{constructor(te){super(te);this.onChange=(ae,Re)=>{var de=this.props,we=de.onFieldChange,rt=de.value;we((0,I.Z)((0,I.Z)({},rt),{},{[Re]:ae.target.checked}))},this.onSelectTeacher=ae=>{var Re=this.props,de=Re.onHiddenDialog,we=Re.onFieldChange;de&&de(),this.setState({teacherSelectorVisible:!1}),we&&we(ae)},this.onCancelSelectTeacher=()=>{var ae=this.props.onHiddenDialog;ae&&ae(),this.setState({teacherSelectorVisible:!1})},this.cancelSelected=()=>{var ae=this.props,Re=ae.onFieldChange,de=ae.value,we=ae.fieldList,rt=ae.formik,mt=we.indexOf("student_data")>-1,Zt=we.indexOf("lecturer_data")>-1;Re&&Re((0,I.Z)((0,I.Z)({},de),{},{id:"",name:"",is_lecturer_subsidy:!1,is_lecturer_confirm:!1})),mt||(rt.setFieldValue("evaluate.is_lecturer_student_evaluate",!1),rt.setFieldValue("evaluate.lecturer_student_evaluate_content",{evaluate_type:"score",questionnaire_id:"",questionnaire_name:"",total_score:"",passing_score:""})),Zt||(rt.setFieldValue("evaluate.is_student_lecturer_evaluate",!1),rt.setFieldValue("evaluate.student_lecturer_evaluate_content",{evaluate_type:"star",questionnaire_id:"",questionnaire_name:"",total_score:"",passing_score:""}))},this.showSelectTeacher=()=>{var ae=this.props.onShowDialog;ae&&ae(),this.setState({teacherSelectorVisible:!0})},this.state={teacherSelectorVisible:!1}}render(){var te=this.state.teacherSelectorVisible,ae=this.props.value,Re=this.props,de=Re.disabled,we=Re.canCancel,rt=Re.onlyShowFree,mt=Re.t,Zt=localStorage.getItem("themeColor")||"#516AE6";return a().createElement("div",{className:"offline-teacher-select"},a().createElement("div",{className:""},ae.name?a().createElement(c.Z,{closable:we&&!de,onClose:this.cancelSelected},ae.teacher_sync_type==="inside"?a().createElement(A.Z,{dataType:"userName",value:ae.teacher_sync_user_id,name:ae.name,type:ae.teacher_sync_source_type}):ae.name):null,de?a().createElement("span",{className:"add-teacher-btn add-teacher-btn-disabled"},a().createElement(M.Z,{iconClass:"iconf-add"})):a().createElement("span",{className:"add-teacher-btn add-teacher-btn_able",style:{color:Zt,borderColor:Zt},onClick:this.showSelectTeacher},a().createElement(M.Z,{iconClass:"iconf-add"}))),rt?a().createElement("div",{className:"checkbox-div"},a().createElement(p.Z,{checked:ae.is_lecturer_subsidy,onChange:bt=>this.onChange(bt,"is_lecturer_subsidy"),disabled:de||!ae.name},mt("lineClass.notCalcClassFee"))):a().createElement(a().Fragment,null,a().createElement("div",{className:"checkbox-div"},a().createElement(p.Z,{checked:ae.is_lecturer_confirm,onChange:bt=>this.onChange(bt,"is_lecturer_confirm"),disabled:de||!ae.name},mt("lineClass.affirmPlan")),a().createElement(p.Z,{checked:ae.is_lecturer_subsidy,onChange:bt=>this.onChange(bt,"is_lecturer_subsidy"),disabled:de||!ae.name},mt("lineClass.notCountedClass")))),a().createElement(v.Z,{visible:te,selected:ae,onOk:this.onSelectTeacher,onCancel:this.onCancelSelectTeacher}))}}d.defaultProps={value:void 0,disabled:!1,canCancel:!1,onlyShowFree:!1};var l=(0,o.$j)((0,T.Z)()(d)),t=e(22385),h=e(31097),F=e(28216),m=e(38642);class E extends a().Component{constructor(){super(...arguments);this.onChange=(te,ae)=>{var Re=this.props.value;this.props.onFieldChange((0,I.Z)((0,I.Z)({},Re),{},{[ae]:te.target.checked}))},this.onChangeMin=te=>{var ae=this.props.value;this.props.onFieldChange((0,I.Z)((0,I.Z)({},ae),{},{advance_minute:te}))},this.onChangeType=te=>{var ae=this.props.value;this.props.onFieldChange((0,I.Z)((0,I.Z)({},ae),{},{remind_type:te.target.value}))}}render(){var te=this.props,ae=te.t,Re=te.disabled,de=te.value,we=te.Cls,rt=te.fieldList,mt=te.appType;return a().createElement("div",{className:we},a().createElement("div",{className:"".concat(we,"-content")},mt==="wx_app"&&(0,m.UI)("OFFLINE_COURSE_SCHEDULE")?a().createElement(p.Z,{disabled:Re||rt.indexOf("calendar")!==-1,checked:de.is_open_schedule,onChange:Zt=>this.onChange(Zt,"is_open_schedule")},ae("lineClass.enableCalendarAlerts"),a().createElement("span",{className:"".concat(we,"-content-tips")},ae("lineClass.openTask"))):null,a().createElement(p.Z,{disabled:Re,checked:de.is_open_upload,onChange:Zt=>this.onChange(Zt,"is_open_upload")},ae("lineClass.enableTeacher"),a().createElement(h.Z,{title:ae("lineClass.enableTeacherMore")},a().createElement("span",{className:"infos"},a().createElement(M.Z,{color:"rgba(0, 0, 0, 0.25)",iconClass:"icon-shuoming",className:"explains",size:"17px"}))))))}}var Q=$e=>({appType:$e.user.appType});E.defaultProps={Cls:"offline-other-setting"};var G=(0,F.$j)(Q)((0,o.$j)((0,T.Z)()(E))),V=e(57663),z=e(71577),$=e(77576),W=e(59314),S=e(47673),x=e(4107),U=e(14965),L=e(11448),w=e(8212),k=e(73218),ne=e(49101),ie=e(6793),Ne=L.Z.RangePicker;class ue extends a().Component{constructor(){super(...arguments);this.handleCheckType=te=>{this.props.onChange(te.target.value)},this.handleEditStatus=te=>{var ae=this.props.value;ae[te].editStatus=!0,this.props.onFieldChange(ae),setTimeout(()=>{this["input".concat(te)]&&this["input".concat(te)].focus()})},this.handleBlur=te=>{var ae=this.props.value;ae[te].editStatus=!1,this.props.onFieldChange(ae)},this.handleTitleInput=(te,ae)=>{var Re=this.props.value;Re[ae].name=te.target.value,this.props.onFieldChange(Re)},this.changeDate=(te,ae,Re)=>{var de=this.props.value;de[Re][ae]=te,this.props.onFieldChange(de)},this.handleDynamic=(te,ae)=>{var Re=this.props.value;Re[ae].qrcode_type=te?"dynamic":"statics",this.props.onFieldChange(Re)},this.handleNewSignBtn=()=>{var te=this.props.t,ae=this.props.value;ae.push({name:"".concat(te("component.offlineCourseTime")).concat(ae.length+1).concat(te("common.course")),qrcode_type:"statics",sign_in_begin_time:"",sign_in_end_time:"",sign_out_begin_time:"",sign_out_end_time:"",sign_in_time:["",""],sign_out_time:["",""]}),this.props.onFieldChange(ae)},this.handleDeleteItem=te=>{var ae=this.props.value;ae.splice(te,1),this.props.onFieldChange(ae)},this.changeChooseOutSign=(te,ae)=>{var Re=this.props.value;Re[ae].chooseOutSign=te.target.checked,this.props.onFieldChange(Re)},this.getInputRef=(te,ae)=>{this["input".concat(ae)]=te}}render(){var te=this.props,ae=te.t,Re=te.value,de=te.Cls,we=te.formik.errors,rt=te.name,mt=te.disabled;return a().createElement("div",{className:"offline-attendance-management-content"},Re&&Re.length?Re.map((Zt,bt)=>a().createElement("div",{className:"offline-attendance-add",key:bt},a().createElement("div",{className:"".concat(de)},a().createElement("div",{className:"".concat(de,"-header")},Zt.editStatus?a().createElement(x.Z,{ref:Ft=>this.getInputRef(Ft,bt),className:"handle-input-error",maxLength:30,value:Zt.name,disabled:mt,onChange:Ft=>this.handleTitleInput(Ft,bt),onBlur:()=>this.handleBlur(bt),placeholder:ae("validation.pleaseEnter")}):a().createElement(a().Fragment,null,a().createElement("span",{className:"".concat(de,"-header-name")},Zt.name),mt?null:a().createElement(a().Fragment,null,a().createElement(w.Z,{onClick:()=>this.handleEditStatus(bt)}),a().createElement(k.Z,{className:"".concat(de,"-header-close-btn"),onClick:()=>this.handleDeleteItem(bt)})))),a().createElement("div",{className:"".concat(de,"-container")},a().createElement("div",{className:"".concat(de,"-container-item time-item ")},a().createElement("span",{className:"item-required"},"*"),a().createElement("span",null,ae("component.checkInTime"),"\uFF1A"),a().createElement(Ne,{disabled:mt,format:"YYYY-MM-DD HH:mm",disabledDate:Zt.id?ie.Kq:()=>!1,showTime:!0,value:Zt.sign_in_time,onChange:Ft=>this.changeDate(Ft,"sign_in_time",bt)})),a().createElement("div",{className:"".concat(de,"-container-item")},a().createElement(p.Z,{disabled:mt,checked:Zt.chooseOutSign,onChange:Ft=>this.changeChooseOutSign(Ft,bt)}),a().createElement("span",null,ae("lineClass.signBack"),"\uFF1A"),a().createElement(Ne,{disabled:!Zt.chooseOutSign||mt,format:"YYYY-MM-DD HH:mm",disabledDate:Zt.id?ie.Kq:()=>!1,showTime:!0,value:Zt.sign_out_time,onChange:Ft=>this.changeDate(Ft,"sign_out_time",bt)})),a().createElement("div",{className:"".concat(de,"-container-item")},a().createElement("span",null,ae("component.dynamicQRCode"),"\uFF1A"),a().createElement(W.Z,{checked:Zt.qrcode_type==="dynamic",disabled:mt,onChange:Ft=>this.handleDynamic(Ft,bt)}),a().createElement("span",{className:"".concat(de,"-container-item-tips")},ae("component.dynamicQRCodeTip"))))),we[rt]&&we[rt][bt]&&a().createElement("span",{className:"tip_error_msg"},we[rt][bt]))):a().createElement("div",{className:"offline-attendance-management-content-empty"},ae("lineClass.emptyCheck")),a().createElement(z.Z,{className:"add-sign-btn",icon:a().createElement(ne.Z,null),disabled:mt,onClick:this.handleNewSignBtn},ae("lineClass.addSignIn")),we[rt]&&we[rt].all&&a().createElement("p",{className:"tip_error_msg"},we[rt].all))}}ue.defaultProps={Cls:"offline-attendance-management"};var _e=(0,o.$j)((0,T.Z)()(ue)),Ze=e(77883),j=e(21888);class R extends a().Component{constructor(){super(...arguments);this.handleChangeTime=te=>{this.props.onFieldChange(te)},this.limitNumber=te=>typeof te=="string"?Number.isNaN(Number(te))?"":te.replace(/[^\d]/g,""):typeof te=="number"?Number.isNaN(te)?"":String(te).replace(/[^\d]/g,""):""}render(){var te=this.props,ae=te.t,Re=te.isPreview,de=te.value,we=te.Cls,rt=te.max;return a().createElement("div",{className:we},a().createElement(j.Z,{disabled:Re,min:0,step:1,max:rt,value:de,formatter:this.limitNumber,onChange:this.handleChangeTime}),a().createElement("span",{className:"".concat(we,"-unit")},ae("common.minutes")))}}R.defaultProps={Cls:"training-time"};var le=(0,o.$j)((0,T.Z)()(R));class H extends a().Component{constructor(){super(...arguments);this.handleCheckType=te=>{this.props.onChange(te.target.value)},this.limitDecimals=te=>te&&te.toString().replace(/[^\d]+/g,""),this.handleChangeValue=(te,ae)=>{var Re=this.props,de=Re.value,we=Re.onChange;we((0,I.Z)((0,I.Z)({},de),{},{[ae]:te}))}}render(){var te=this.props,ae=te.t,Re=te.disabled,de=te.value,we=te.max;return a().createElement("div",{className:"offline-mark-score"},a().createElement("span",{className:"offline-mark-score-required"},"*"),a().createElement("span",{className:"offline-mark-score-name"},ae("myExamTask.perfect")),a().createElement(j.Z,{className:"item-gap",min:0,step:1,max:we,disabled:Re,formatter:this.limitDecimals,parser:this.limitDecimals,value:de.total_score,onChange:rt=>this.handleChangeValue(rt,"total_score")}),a().createElement("span",{className:"offline-mark-score-required"},"*"),a().createElement("span",{className:"offline-mark-score-name"},ae("exam.passingGrade")),a().createElement(j.Z,{className:"item-gap",min:0,step:1,max:we,disabled:Re,formatter:this.limitDecimals,parser:this.limitDecimals,value:de.passing_score,onChange:rt=>this.handleChangeValue(rt,"passing_score")}))}}H.defaultProps={Cls:"mark-score"};var X=(0,T.Z)()(H),ce=e(80007);class Te extends a().Component{constructor(){super(...arguments);this.state={visible:!1},this.handleClick=()=>{this.setState({visible:!0})},this.handleOk=te=>{var ae=this.props.onChange;this.setState({visible:!1});var Re=te[0];ae({questionnaire_id:Re.id,questionnaire_name:Re.name})},this.handleCancel=()=>{this.setState({visible:!1})},this.compileData=te=>te.questionnaire_id?[{id:te.questionnaire_id,name:te.questionnaire_name}]:[]}render(){var te=this.props,ae=te.value,Re=te.t,de=te.disabled,we=this.state.visible,rt=this.compileData(ae),mt=localStorage.getItem("themeColor")||"#516AE6",Zt=rt.length?rt[0].name:"";return a().createElement(a().Fragment,null,a().createElement("span",null,Zt?a().createElement(h.Z,{title:Zt},a().createElement("div",{className:"cl-text-ellipsis question-name"},Zt)):null,a().createElement(z.Z,{className:"vertical-middle",type:"link",disabled:de,onClick:this.handleClick},a().createElement(M.Z,{iconClass:"icon-wenjuan1",size:"12px"}),Re("questionn.investigateDetailBtn")),a().createElement(ce.Z,{visible:we,defaultChecked:rt,onOk:this.handleOk,onCancel:this.handleCancel})))}}var Le=(0,T.Z)()(Te);class he extends a().Component{constructor(){super(...arguments);this.onChangeEnable=(te,ae)=>{var Re=this.props.value;Re[ae]=te,this.props.onFieldChange(Re)},this.onChangeType=(te,ae)=>{var Re=this.props.value;Re[ae].evaluate_type=te.target.value,this.props.onFieldChange(Re)},this.handleQuestion=(te,ae)=>{var Re=this.props.value;Re[ae]=(0,I.Z)((0,I.Z)({},Re[ae]),te),this.props.onFieldChange(Re)},this.changeValue=(te,ae)=>{var Re=this.props.value;Re[ae]=(0,I.Z)((0,I.Z)({},Re[ae]),te),this.props.onFieldChange(Re)}}render(){var te=this.props,ae=te.t,Re=te.disabled,de=te.value,we=te.Cls,rt=te.formik,mt=te.fieldList,Zt=te.qyShield,bt=Re,Ft=mt.indexOf("student_data")>-1,Ut=mt.indexOf("lecturer_data")>-1,ca=mt.indexOf("course_data")>-1;return a().createElement("div",{className:we},a().createElement("div",{className:"".concat(we,"-content")},a().createElement("div",{className:"".concat(we,"-content-item")},a().createElement("div",null,a().createElement("span",{className:"".concat(we,"-labels")},ae("lineClass.instructorEvaluationStudents")),a().createElement(W.Z,{disabled:bt||!rt.values.teacher.id||Ft,onChange:Qt=>this.onChangeEnable(Qt,"is_lecturer_student_evaluate"),checked:de.is_lecturer_student_evaluate})),de.is_lecturer_student_evaluate?a().createElement(a().Fragment,null,a().createElement("div",{className:"".concat(we,"-content-item-radio")},a().createElement(g.ZP.Group,{disabled:bt||!rt.values.teacher.id||Ft,onChange:Qt=>this.onChangeType(Qt,"lecturer_student_evaluate_content"),value:de.lecturer_student_evaluate_content.evaluate_type},a().createElement(g.ZP,{value:"score"},ae("lineClass.directScore")),Zt==="false"&&a().createElement(g.ZP,{value:"questionnaire"},ae("lineClass.multidimensionalEvaluation"))),Zt==="false"&&a().createElement(Le,{disabled:bt||!rt.values.teacher.id||Ft||de.is_lecturer_student_evaluate&&de.lecturer_student_evaluate_content.evaluate_type==="score",value:{questionnaire_id:de.lecturer_student_evaluate_content.questionnaire_id,questionnaire_name:de.lecturer_student_evaluate_content.questionnaire_name},onChange:Qt=>this.handleQuestion(Qt,"lecturer_student_evaluate_content")})),de.lecturer_student_evaluate_content.evaluate_type==="score"&&a().createElement(X,{value:{total_score:de.lecturer_student_evaluate_content.total_score,passing_score:de.lecturer_student_evaluate_content.passing_score},max:999,disabled:bt||!rt.values.teacher.id||Ft,onChange:Qt=>this.changeValue(Qt,"lecturer_student_evaluate_content")})):null),a().createElement("div",{className:"".concat(we,"-content-item")},a().createElement("div",null,a().createElement("span",{className:"".concat(we,"-labels")},ae("lineClass.studentEvaluationLecturer")),a().createElement(W.Z,{disabled:bt||!rt.values.teacher.id||Ut,onChange:Qt=>this.onChangeEnable(Qt,"is_student_lecturer_evaluate"),checked:de.is_student_lecturer_evaluate})),de.is_student_lecturer_evaluate?a().createElement(a().Fragment,null,a().createElement("div",{className:"".concat(we,"-content-item-radio")},a().createElement(g.ZP.Group,{disabled:bt||!rt.values.teacher.id||Ut,onChange:Qt=>this.onChangeType(Qt,"student_lecturer_evaluate_content"),value:de.student_lecturer_evaluate_content.evaluate_type},a().createElement(g.ZP,{value:"star"},ae("lineClass.starRate")),Zt==="false"&&a().createElement(g.ZP,{value:"questionnaire"},ae("lineClass.multidimensionalEvaluation"))),Zt==="false"&&a().createElement(Le,{disabled:bt||!rt.values.teacher.id||Ut||de.is_student_lecturer_evaluate&&de.student_lecturer_evaluate_content.evaluate_type==="star",value:{questionnaire_id:de.student_lecturer_evaluate_content.questionnaire_id,questionnaire_name:de.student_lecturer_evaluate_content.questionnaire_name},onChange:Qt=>this.handleQuestion(Qt,"student_lecturer_evaluate_content")}))):null),a().createElement("div",null,a().createElement("span",{className:"".concat(we,"-labels")},ae("lineClass.studentEvaluationCourse")),a().createElement(W.Z,{disabled:bt||ca,onChange:Qt=>this.onChangeEnable(Qt,"is_student_course_evaluate"),checked:de.is_student_course_evaluate})),de.is_student_course_evaluate?a().createElement(a().Fragment,null,a().createElement("div",{className:"".concat(we,"-content-item-radio")},a().createElement(g.ZP.Group,{disabled:bt||ca,onChange:Qt=>this.onChangeType(Qt,"student_course_evaluate_content"),value:de.student_course_evaluate_content.evaluate_type},a().createElement(g.ZP,{value:"star"},ae("lineClass.starRate")),Zt==="false"&&a().createElement(g.ZP,{value:"questionnaire"},ae("lineClass.multidimensionalEvaluation"))),Zt==="false"&&a().createElement(Le,{disabled:bt||ca||de.is_student_course_evaluate&&de.student_course_evaluate_content.evaluate_type==="star",value:{questionnaire_id:de.student_course_evaluate_content.questionnaire_id,questionnaire_name:de.student_course_evaluate_content.questionnaire_name},onChange:Qt=>this.handleQuestion(Qt,"student_course_evaluate_content")}))):null))}}he.defaultProps={Cls:"offline-evaluate"};var Ee=$e=>({qyShield:$e.user.qyShield}),ve=(0,F.$j)(Ee)((0,o.$j)((0,T.Z)()(he)));class be extends a().Component{constructor(){super(...arguments);this.onChange=(te,ae)=>{var Re=this.props.value;Re[ae]=te,this.props.onFieldChange(Re)},this.handleValue=te=>{var ae=this.props.value;ae.assessment_total_score=te.total_score,ae.assessment_pass_score=te.passing_score,this.props.onFieldChange(ae)},this.handleChangePeople=te=>{var ae=this.props.value;ae.approvers=te,this.props.onFieldChange(ae)}}render(){var te=this.props,ae=te.t,Re=te.value,de=te.Cls,we=te.disabled,rt=te.max;return a().createElement("div",{className:de},a().createElement("div",{className:"".concat(de,"-content")},a().createElement("div",null,a().createElement(W.Z,{disabled:we,checked:Re.is_open_offline_assessment,onChange:mt=>this.onChange(mt,"is_open_offline_assessment")}),a().createElement("span",{className:"".concat(de,"-labels")},ae("lineClass.openTheInspection")),a().createElement(h.Z,{title:ae("lineClass.openTheInspectionMore")},a().createElement("span",{className:"infos"},a().createElement(M.Z,{color:"rgba(0, 0, 0, 0.25)",iconClass:"icon-shuoming",className:"explains",size:"17px"})))),Re.is_open_offline_assessment&&a().createElement(X,{value:{total_score:Re.assessment_total_score,passing_score:Re.assessment_pass_score},max:rt,onChange:this.handleValue,disabled:we||!Re.is_open_offline_assessment})))}}be.defaultProps={Cls:"offline-assess"};var Ve=(0,o.$j)((0,T.Z)()(be)),Ae=e(62029),at=e(18329);class et extends a().Component{constructor(){super(...arguments);this.state={visible:!1},this.handleCancel=()=>{this.setState({visible:!1})},this.handleShowModal=()=>{this.setState({visible:!0})},this.handleAutoCheckSetting=()=>{var te=this.props,ae=te.formik.values,Re=te.disabled;if(!Re){var de=ae.offline_course_sign_config_list,we=ae.courseList.map(rt=>({chooseOutSign:!0,name:rt.name,qrcode_type:"statics",sign_in_begin_time:"",sign_in_end_time:"",sign_in_time:rt.beginTime?[K()(rt.beginTime).subtract(15,"m"),K()(rt.beginTime).add(15,"m")]:["",""],sign_out_time:rt.endTime?[K()(rt.endTime),K()(rt.endTime).add(30,"m")]:["",""],sign_out_begin_time:"",sign_out_end_time:""}));this.props.formik.setFieldValue("offline_course_sign_config_list",de.concat(we))}}}render(){var te=this.props,ae=te.value,Re=te.t,de=ae.dateRange,we=de.startTime,rt=de.endTime,mt=this.state.visible,Zt={size:"medium",destroyOnClose:!0,bodyStyle:{padding:"0"},maskClosable:!1,footer:null};return a().createElement("div",{className:"offline-training-time"},a().createElement("span",null,Re("lineClass.trainingTime"),"\uFF1A",we?K()(we).format("YYYY.MM.DD HH:mm"):null," - ",rt?K()(rt).format("YYYY.MM.DD HH:mm"):null),a().createElement("span",{className:"offline-training-time-href",onClick:this.handleShowModal},Re("lineClass.viewCourseSchedule")),a().createElement("span",{className:"offline-training-time-href",onClick:this.handleAutoCheckSetting},Re("lineClass.byCheckIn")),a().createElement(at.ZP,(0,Ae.Z)({title:Re("lineClass.viewCourseSchedule")},Zt,{visible:mt,onCancel:this.handleCancel}),ae.courseList&&ae.courseList.map((bt,Ft)=>a().createElement("div",{key:Ft,className:"offline-training-time-text"},a().createElement("p",{className:"offline-training-time-text-title"},bt.name),a().createElement("p",{className:"offline-training-time-text-content"},bt.beginTime?K()(bt.beginTime).format("YYYY.MM.DD HH:mm"):"","\xA0-\xA0",bt.endTime?K()(bt.endTime).format("YYYY.MM.DD HH:mm"):"")))))}}var ut=(0,o.$j)((0,T.Z)()(et));class q extends a().Component{constructor(){super(...arguments);this.onChange=(te,ae)=>{var Re=this.props.value;this.props.onFieldChange((0,I.Z)((0,I.Z)({},Re),{},{[ae]:te.target.checked}))},this.onChangeMin=te=>{var ae=this.props.value;this.props.onFieldChange((0,I.Z)((0,I.Z)({},ae),{},{advance_minute:te}))},this.onChangeType=te=>{var ae=this.props.value;this.props.onFieldChange((0,I.Z)((0,I.Z)({},ae),{},{remind_type:te.target.value}))}}render(){var te=this.props,ae=te.t,Re=te.disabled,de=te.value,we=te.Cls,rt=Re;return a().createElement("div",{className:we},a().createElement("div",{className:"".concat(we,"-content")},a().createElement("div",{className:"".concat(we,"-msg-reminder messge-box")},a().createElement(p.Z,{disabled:rt,checked:de.is_lecturer_remind,onChange:mt=>this.onChange(mt,"is_lecturer_remind")},ae("lineClass.reminderToLecturers")),a().createElement(p.Z,{disabled:rt,checked:de.is_student_remind,onChange:mt=>this.onChange(mt,"is_student_remind")},ae("lineClass.remindStudents")),a().createElement("div",null,a().createElement("span",{className:"".concat(we,"-msg-reminder-right")},ae("lineClass.beforeBegins")),a().createElement(j.Z,{disabled:rt||!de.is_lecturer_remind&&!de.is_student_remind,value:de.advance_minute,step:1,min:0,onChange:this.onChangeMin,className:"".concat(we,"-msg-reminder-right")}),a().createElement("span",null,ae("common.minutes")),a().createElement("span",{className:"".concat(we,"-msg-reminder-left")},ae("lineClass.toRemind"))))))}}q.defaultProps={Cls:"offline-other-setting"};var Oe=(0,o.$j)((0,T.Z)()(q)),Je=e(3233),je=e(43859),Be=(0,je.Z)(y),St=(0,je.Z)(l),Lt=(0,je.Z)(G),Wt=(0,je.Z)(_e),pa=(0,je.Z)(le),Xt=(0,je.Z)(ve),Et=(0,je.Z)(Ve),Fe=(0,je.Z)(Oe),Pe=null,Ie=Je.Z},72387:function(gt,Se,e){"use strict";var O=e(12924),g=e.n(O),b=e(84874);class a extends g().PureComponent{constructor(o){super(o);this.onPrev=()=>{var D=this.state.activeIndex;this.setState({activeIndex:D<=0?0:D-1})},this.onNext=()=>{var D=this.props.imgList,K=this.state.activeIndex;this.setState({activeIndex:D.length<=K+1?K:K+1})},this.state={activeIndex:o.defaultActive}}componentDidUpdate(o){o.visible!==this.props.visible&&this.props.visible&&this.setState({activeIndex:this.props.defaultActive})}render(){var o=this.props,D=o.visible,K=o.imgList,P=this.state.activeIndex;return g().createElement("div",{className:"preview-img-mask",style:{display:D?"block":"none"}},g().createElement("div",{className:"preview-img-bg"},g().createElement("div",{className:"preview-img"},g().createElement("img",{src:K[P]}),g().createElement("span",{className:"preview-img-close",onClick:this.props.onClose},g().createElement(b.Z,{iconClass:"iconf-close"})))),P>=1?g().createElement("span",{className:"preview-img-left",onClick:this.onPrev},g().createElement(b.Z,{iconClass:"iconf-arrow-left",size:"20px"})):null,P<=K.length-2?g().createElement("span",{className:"preview-img-right",onClick:this.onNext},g().createElement(b.Z,{iconClass:"iconf-arrow-right",size:"20px"})):null)}}a.defaultProps={visible:!1,imgList:[],defaultActive:0,onClose:()=>{}},Se.Z=a},80007:function(gt,Se,e){"use strict";var O=e(88983),g=e(47933),b=e(63185),a=e(9676),T=e(20228),o=e(11382),D=e(57663),K=e(71577),P=e(62029),y=e(32157),C=e(75869),p=e(12924),B=e.n(p),c=e(28216),I=e(91768),M=e(49101),v=e(18329),A=e(86726),d=e(87312),l=e(10237),t=e(37055),h=e(1164),F=e(6793),m=e(95664),E=e(48479),Q=e(44881),G=W=>({userInfo:W.user}),V=C.Z.TreeNode,z={size:"large",destroyOnClose:!0,bodyStyle:{padding:"0"},maskClosable:!1,wrapClassName:"qa-select-questionnaire-confirm"};class $ extends B().Component{constructor(S){super(S);this.onChangePage=x=>{var U=this.state.page;U.pageNumber=x,this.setState({page:U},()=>{this.getQuestionnaireList(this.state.selectClassifyKey[0])})},this.onOk=()=>{if(this.props.onOk){var x=this.state.checkedList.map(U=>({id:U.id,name:U.name,componentName:"QuestionnaireSelector",data:U.data,icon:t.e1.questionnaire,type:"questionnaire"}));this.props.onOk(x)}},this.onCancel=()=>{var x=this.props.onCancel;x&&this.props.onCancel()},this.compileData=x=>{var U=this.state.checkedList,L=x.map(w=>({id:w.id,name:w.title,create_user_name:w.create_user_name,create_time_label:(0,F.p6)(w.create_time,"yyyy.MM.dd hh:mm"),isChecked:U.findIndex(k=>k.id===w.id||k.data&&k.data.questionnaire_id===w.id||k.data&&k.data.questionnaireId===w.id)!==-1,data:w}));return L},this.getClassifyTree=()=>{var x=t.ZP.Classify.getResourceClassify();l.WY.get({url:x,params:{auth_type:"refer",include_unclassified:"true",parent_id:0}}).then(U=>{var L=(0,Q.P)(U.data.list,"refer");this.setState({classifyList:L}),this.getQuestionnaireList("")})},this.loadData=x=>new Promise(U=>{var L=x.id;setTimeout(()=>{var w=t.ZP.Classify.getResourceClassify(),k=L;l.WY.get({url:w,params:{parent_id:k,auth_type:"refer"}}).then(ne=>{if(!(!ne.data||x.dataRef.children)){var ie=(0,Q.P)(ne.data.list,"refer");x.dataRef.children=ie,this.setState({classifyList:[...this.state.classifyList]})}}),U()},300)}),this.getQuestionnaireList=x=>{var U=this.state,L=U.page,w=U.keyword,k=U.userIds;this.setState({isLoading:!0});var ne=t.ZP.QuestionnaireSelector.getQuestionnaireList(),ie={status:"release",create_status:"all",course_classify:x,keyword:w,userIds:k,page_number:L.pageNumber,page_size:L.pageSize};l.WY.get({url:ne,params:ie}).then(Ne=>{this.setState({isLoading:!1,questionnaireList:this.compileData(Ne.data.questionnaires.list),paginationData:{total:Ne.data.questionnaires.total,pages:Ne.data.questionnaires.pages,current:Ne.data.questionnaires.page_num}})})},this.handleRefresh=()=>{this.getClassifyTree()},this.handleClassifySelect=x=>{var U=this.state.page;U.pageNumber=1,this.setState({selectClassifyKey:x,page:U}),this.getQuestionnaireList(x[0])},this.renderTreeNodes=x=>x.map(U=>U.children?B().createElement(V,{title:U.label,key:U.id,dataRef:U,disabled:U.disabled||!1},this.renderTreeNodes(U.children)):B().createElement(V,(0,P.Z)({title:U.label,dataRef:U,key:U.id,disabled:U.disabled||!1},U))),this.checkOne=(x,U)=>{var L=[...this.state.checkedList],w=[...this.state.questionnaireList],k=this.props.multiple;if(k)if(x.isChecked){var ne=L.findIndex(ie=>ie.id===x.id);L.splice(ne,1),w[U].isChecked=!1}else w[U].isChecked=!0,L.push(x);else x.isChecked?(L=[],w[U].isChecked=!1):(w.forEach(ie=>{ie.isChecked=!1}),w[U].isChecked=!0,L=[x]);this.setState({checkedList:L,questionnaireList:w})},this.handleSearch=(x,U)=>{this.setState({keyword:U===""?x:"",userIds:U},()=>{this.getQuestionnaireList(this.state.selectClassifyKey[0])})},this.state={title:S.t("component.selectQuestionnaire"),keyword:"",userIds:"",checkedList:[],classifyList:[],questionnaireList:[],selectClassifyKey:[""],paginationData:{},page:{pageNumber:1,pageSize:12},allowActions:(0,A.V9)("questionnaire",this.props.userInfo.modules)}}componentDidUpdate(S){if(S.visible!==this.props.visible&&this.props.visible){var x=[...this.props.defaultChecked];this.setState({checkedList:x,keyword:"",page:{pageNumber:1,pageSize:12},selectClassifyKey:[""]},()=>{this.getClassifyTree()})}}render(){var S={onSelect:this.handleClassifySelect,selectedKeys:this.state.selectClassifyKey,loadData:this.loadData},x=this.state,U=x.questionnaireList,L=x.paginationData,w=x.isLoading,k=x.allowActions,ne=this.props,ie=ne.multiple,Ne=ne.t,ue={shouldRenderAddQuestionnaire:(0,A.H3)("add",k)},_e=localStorage.getItem("themeColor")||"#516ae6";return B().createElement(v.ZP,(0,P.Z)({},z,{visible:this.props.visible,title:this.state.title,onCancel:this.onCancel,onOk:this.onOk}),B().createElement("div",{className:"questionnaire-selector"},B().createElement("div",{className:"questionnaire-selector-top"},B().createElement(E.Z,{onSearch:this.handleSearch,prefixCls:"questionnaire-selector-top-search",placeholder:Ne("searchInputPlaceholder.questionnaire"),width:"310px"}),B().createElement("div",{className:"questionnaire-selector-top-addBtn qa-add-new-questionnaire-button"},ue.shouldRenderAddQuestionnaire?null:B().createElement(h.Z,{to:"/training/questionn/questionnaire/add"},B().createElement(K.Z,{type:"primary",icon:B().createElement(M.Z,null)},Ne("investigatePageList.newQuestionnaire"))))),B().createElement("div",{className:"questionnaire-selector-list"},B().createElement("div",{className:"questionnaire-selector-tree"},B().createElement("div",{className:"questionnaire-selector-tree-all ".concat(this.state.selectClassifyKey[0]===""?"selected":""),onClick:()=>this.handleClassifySelect([""]),style:this.state.selectClassifyKey[0]===""?{color:_e}:{}},Ne("common.all")),B().createElement(C.Z,S,this.renderTreeNodes(this.state.classifyList))),B().createElement("div",{className:"questionnaire-selector-questionnaire"},w?B().createElement("div",{className:"questionnaire-selector-loading"},B().createElement(o.Z,null)):null,B().createElement("div",{className:"questionnaire-selector-questionnaire-list"},U.map((Ze,j)=>ie?B().createElement(a.Z,{value:Ze.id,key:j.toString(),onClick:()=>this.checkOne(Ze,j),checked:Ze.isChecked,className:"questionnaire-selector-questionnaire-item"},B().createElement("span",{className:"questionnaire-title"},Ze.name),B().createElement("span",{className:"questionnaire-info"},B().createElement("span",{className:"questionnaire-time"},Ze.create_time_label),B().createElement("span",{className:"questionnaire-user"},Ze.create_user_name,Ne("component.createLabel")),B().createElement(h.Z,{to:"/training/questionn/questionnaire/view?id=".concat(Ze.id)},B().createElement("span",{className:"questionnaire-preview",style:{color:_e}},Ne("component.preview"))))):B().createElement(g.ZP,{value:Ze.id,key:j.toString(),onClick:()=>this.checkOne(Ze,j),checked:Ze.isChecked,className:"questionnaire-selector-questionnaire-item"},B().createElement("span",{className:"questionnaire-title"},Ze.name),B().createElement("span",{className:"questionnaire-info"},B().createElement("span",{className:"questionnaire-time"},Ze.create_time_label),B().createElement("span",{className:"questionnaire-user"},Ze.create_user_name,Ne("component.createLabel")),B().createElement(h.Z,{to:"/training/questionn/questionnaire/view?id=".concat(Ze.id)},B().createElement("span",{className:"questionnaire-preview"},Ne("component.preview")))))),U.length===0?B().createElement(d.Z,{className:"no-result",tipText:Ne("course.courseNoDataTip")}):null),B().createElement(m.Z,{totalNum:L.total,totalPage:L.pages,current:L.current,onChange:this.onChangePage,onRefresh:this.handleRefresh})))))}}$.defaultProps={visible:!1,defaultChecked:[],multiple:!1,onCancel:()=>{},onOk:()=>{}},Se.Z=(0,c.$j)(G)((0,I.Z)()($))},71759:function(gt,Se,e){"use strict";e.d(Se,{Z:function(){return ue}});var O=e(20228),g=e(11382),b=e(12924),a=e.n(b),T=e(91768),o=e(80991),D=e(18329),K=e(10237),P=e(37055),y=e(6793),C=e(62029),p=e(88983),B=e(47933),c=e(43859);class I extends a().Component{constructor(){super(...arguments);this.handleChange=Ze=>{this.props.formik.setFieldValue("type",Ze.target.value)}}render(){return a().createElement(B.ZP.Group,{value:this.props.defaultFieldList,onChange:this.handleChange},a().createElement(B.ZP,{value:1},this.props.t("exam.once")),a().createElement(B.ZP,{value:2},this.props.t("exam.loop")))}}var M=(0,c.Z)((0,o.$j)((0,T.Z)()(I))),v=e(77883),A=e(21888);class d extends a().Component{constructor(){super(...arguments);this.handleChange=Ze=>{this.props.formik.setFieldValue("interval",Ze)}}render(){return a().createElement(A.Z,{precision:0,min:0,max:99999,value:this.props.defaultFieldList,onChange:this.handleChange})}}var l=(0,c.Z)((0,o.$j)(d));class t extends a().Component{constructor(){super(...arguments);this.handleChange=Ze=>{this.props.formik.setFieldValue("times",Ze)}}render(){return a().createElement(A.Z,{precision:0,min:0,max:99999,value:this.props.defaultFieldList,onChange:this.handleChange})}}var h=(0,c.Z)((0,o.$j)(t)),F=e(14965),m=e(11448);class E extends a().Component{constructor(){super(...arguments);this.handleOk=Ze=>{this.props.formik.setFieldValue("startTime",Ze?Ze.valueOf():null)}}render(){return a().createElement(m.Z,{showTime:!0,value:(0,y.k7)(this.props.defaultFieldList||new Date().getTime()),format:P.XE.INITIAL_DATE_FMT.VIEW,disabledDate:y.Kq,onChange:this.handleOk,showNow:!1,renderExtraFoote:null})}}var Q=(0,c.Z)((0,o.$j)(E)),G=e(78138),V=e.n(G),z=e(2396),$=e(3407),W=(0,y.me)(),S=$.Z[W].validation,x=(_e,Ze)=>{var j;return Ze.type===2&&!z.fA.positiveInteger.test(_e)&&(j=S.checkIntegerGreaterThan0),j},U=(_e,Ze)=>{var j;return Ze.type===2&&!z.fA.positiveInteger.test(_e)&&(j=S.checkIntegerGreaterThan0),j},L=_e=>{var Ze,j=V()().add("year",1).valueOf();return _e<new Date().getTime()&&(Ze=S.checkTimeAfterNow),_e>j&&(Ze=S.checkTimeMoreThan1Year),Ze},w={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}};class k extends a().Component{render(){var Ze=this.props,j=Ze.values,R=Ze.t;return a().createElement(o.l0,{className:"cl-form"},a().createElement(o.gN,(0,C.Z)({component:M,displayType:"Custom",name:"type",label:R("exam.releaseType"),required:!0,defaultFieldList:j.type},w)),j.type===1?null:a().createElement(o.gN,(0,C.Z)({component:l,displayType:"Custom",name:"interval",label:R("exam.releaseInterval"),required:!0,defaultFieldList:j.interval,validate:le=>x(le,j)},w)),j.type===1?null:a().createElement(o.gN,(0,C.Z)({component:h,displayType:"Custom",name:"times",label:R("exam.releaseTimes"),required:!0,defaultFieldList:j.times,validate:le=>U(le,j)},w)),a().createElement(o.gN,(0,C.Z)({component:Q,displayType:"Custom",name:"startTime",label:j.type===1?R("exam.executionTime"):R("exam.nextExecutionTime"),required:!0,defaultFieldList:j.startTime,validate:L},w)))}}var ne=(0,T.Z)()(k),ie={getTemplateScheduler:P.ZP.TimingTemplateList.getTemplateScheduler,updateTemplateScheduler:P.ZP.TimingTemplateList.updateTemplateScheduler};class Ne extends a().Component{constructor(){super(...arguments);this.state={initialParams:{type:1,interval:0,times:0,startTime:Date.parse(new Date)},isLoading:!0},this.initRefFormik=Ze=>{this.refFormik=Ze},this.initParams=()=>{this.setState({isLoading:!0}),this.props.sholudRequest?K.WY.get({url:ie.getTemplateScheduler({schedulerId:this.props.record.schedule_id})}).then(Ze=>{var j=Ze.data;this.setState({initialParams:{type:j.type==="once"?1:2,interval:j.interval,times:j.times,startTime:j.start_time?(0,y.jZ)(j.start_time):(0,y.jZ)()},isLoading:!1})}):setImmediate(()=>{this.setState({initialParams:this.props.initialParams,isLoading:!1})})},this.handleBeforeCreate=()=>{var Ze=this.refFormik;Ze.submitForm(),Ze.runValidations().then(j=>{if(!Object.keys(j).length){var R=Ze.state.values,le=R.interval,H=R.startTime,X=R.times,ce=R.type;this.props.sholudRequest?K.WY.post({url:ie.updateTemplateScheduler({schedulerId:this.props.record.schedule_id,scope:this.props.scopeType||"exam"}),data:{interval:le,scheduler_id:this.props.record.schedule_id,next_time:(0,y.p6)(new Date(H)),start_time:(0,y.p6)(new Date(H)),status:"on",template_id:this.props.record.id,times:X,type:ce===1?"once":"period"}}).then(()=>{this.props.onOk()}):this.props.onOk({interval:le,startTime:H,times:X,type:ce})}})}}componentDidUpdate(Ze){this.props.visible&&this.props.visible!==Ze.visible&&this.initParams(),!this.props.visible&&this.props.visible!==Ze.visible&&this.setState({isLoading:!0})}render(){var Ze=this.props,j=Ze.visible,R=Ze.onCancel,le=Ze.t,H=this.state,X=H.initialParams,ce=H.isLoading;return a().createElement(D.ZP,{title:le("exam.settings"),visible:j,onOk:this.handleBeforeCreate,onCancel:R},ce?a().createElement("div",{className:"cl-text-center"},a().createElement(g.Z,{size:"large"})):a().createElement(o.J9,{ref:this.initRefFormik,initialValues:X,onSubmit:this.handleSubmit,render:Te=>a().createElement(ne,Te)}))}}Ne.defaultProps={sholudRequest:!0};var ue=(0,T.Z)()(Ne)},7653:function(gt,Se,e){"use strict";var O=e(62029),g=e(22385),b=e(31097),a=e(12924),T=e.n(a),o=e(91768),D=e(28216),K=e(68628),P=e(88311),y=e(84874),C=e(60667),p=e(26885),B=I=>{var M=I.user,v=I.advancedSetting;return{user:M,appType:M.appType,reserveUser:[{id:M.id||window.localStorage.getItem("uid"),name:M.name||"\u5F20\u8F69",unionid:M.unionid,sourceType:M.sourceType}],themeColor:v.themeColor}};class c extends T().Component{constructor(M){super(M);this.showOrg=()=>{var v=this.state.orgDialogConfig;v.visible=!0;var A=localStorage.getItem("authorityType"),d=this.props.user.loginMode;if(this.props.qwTicketShow&&d==="WE_COM"&&A==="1"){this.handleSelectWx();return}this.setState({orgDialogConfig:v})},this.handleSelectWx=()=>{var v=this.state.userList.map(A=>A.unionid||A.user_id||A.userId||A.name);(0,p.Sk)({userIds:v}).then(A=>{var d={type:"supervision",result:A,reserveUser:this.state.reserveUser};(0,p.$f)(d).then(l=>{var t=l.user,h=l.qyWeChatVo;this.setState({qyWeChatVo:h},()=>{this.addUser({user:t})})})}).catch(()=>{this.hiddenOrg()})},this.addUser=v=>{var A=v.user,d=this.props.notCreator,l=this.state,t=l.orgDialogConfig,h=l.reserveUser,F=l.qyWeChatVo;t.visible=!1;var m=A,E=this.props.filterUserListIds;E&&E.length&&(m=A.filter(k=>!E.includes(k.id))),this.setState({orgDialogConfig:t,userList:m});var Q=localStorage.getItem("authorityType"),G="",V=this.props.user,z=V.loginMode,$=V.unionid,W=V.account,S=V.id,x=V.name,U=V.sourceType;if(this.props.qwTicketShow&&z==="WE_COM"){if(Q==="0")G=JSON.stringify({userList:[{unionid:$,name:x,sourceType:U,id:S||window.localStorage.getItem("uid"),user_id:W},...A],departmentList:[]});else if(Q==="1"){var L=JSON.parse(F);L.userList&&L.userList.length?(L.userList=L.userList.filter(k=>k.openUserId!==this.state.reserveUser[0].unionid).map(k=>k),L.userList.push({unionid:$,id:S||window.localStorage.getItem("uid"),openUserid:$})):L.userList=[{unionid:$,id:S||window.localStorage.getItem("uid"),openUserid:$}],L.userList=Array.from(new Set(L.userList)),G=JSON.stringify(L)}}var w=d?[]:h;this.props.onChange(m.concat(w),G)},this.hiddenOrg=()=>{var v=this.state.orgDialogConfig;v.visible=!1,this.setState({orgDialogConfig:v})},this.removeUser=v=>{var A=this.props.notCreator,d=this.state,l=d.userList,t=d.reserveUser;l.splice(v,1),this.setState({userList:l});var h=A?[]:t;this.props.onChange(l.concat(h))},this.dealReserveUser=v=>v[0].unionid||v[0].userId||v[0].user_id||v[0].name,this.state={orgDialogConfig:{visible:!1,onlyUser:!0,onOk:this.addUser,onCancel:this.hiddenOrg},qyWeChatVo:"",userList:[],reserveUser:[{}]}}componentDidMount(){var M=this.props,v=M.defaultChecked,A=M.reserveUser,d=M.createUserId,l=M.notCreator,t=[...A],h=this.props.user,F=h.appType,m=h.unionid,E=h.account,Q=h.id,G=h.name,V=h.sourceType,z=h.loginMode,$=localStorage.getItem("authorityType");F==="wx_app"&&($==="1"?t=[{unionid:m,id:Q||window.localStorage.getItem("uid"),openUserid:m,sourceType:"wx_sync"}]:$==="0"&&(t=[{unionid:m,name:G,sourceType:V,id:Q||window.localStorage.getItem("uid"),user_id:E}]));var W=[...v];z==="WX"&&W.forEach(U=>{U.user_id=U.name,U.source_type=U.source_type||U.sourceType||"wx_sync"});var S=W.length>0?W.findIndex(U=>U.id===d):0;F==="wx_app"&&W.length&&!d&&(S=W.length>0?W.findIndex(U=>U.unionid===m):0);var x=l?[]:W.length>0?W.splice(S,1):t;this.setState({userList:W,reserveUser:x},()=>{var U=l?W:this.state.reserveUser.concat(W);this.props.onChange(U)})}render(){var M=this.state,v=M.orgDialogConfig,A=M.userList,d=M.reserveUser,l=this.props,t=l.className,h=l.disabled,F=l.addBtnText,m=l.t,E=l.themeColor,Q=l.orgProps,G=l.qwTicketShow,V=l.appType,z=l.tipHtml,$=this.props.user.loginMode,W=F||m("formItem.addSupervisor"),S=localStorage.getItem("authorityType"),x=navigator.userAgent.toLowerCase().indexOf("wxwork")>-1,U=d.length?this.dealReserveUser(d):"";return T().createElement(T().Fragment,null,T().createElement("div",{className:"".concat(t," supervision-selector")},d.length?T().createElement("div",{className:"supervision-selector-item"},V==="wx_app"&&S==="1"?T().createElement(C.Z,{dataType:"userName",value:U,name:d[0].name,type:"wx_sync"}):T().createElement(C.Z,{dataType:"userName",value:d.length?d[0].userId||d[0].user_id:"",name:d.length?d[0].name:"",type:d.length?d[0].sourceType||d[0].source_type:""})):null,A.map((L,w)=>{var k=G&&V==="wx_app"&&S==="1"?L.unionid||L.userId||L.user_id||L.name:L.userId||L.user_id,ne=L.source_type||L.sourceType||"";return T().createElement("div",{className:"supervision-selector-item",key:w.toString()},T().createElement(C.Z,{dataType:"userName",value:k,name:L.name,type:ne}),h||S==="1"&&G&&$==="WE_COM"?null:T().createElement("span",{className:"remove-icon",onClick:()=>this.removeUser(w)},T().createElement(y.Z,{iconClass:"icon-guanbi1",size:"10px"})))}),h?null:T().createElement("div",{className:"supervision-selector-add",onClick:this.showOrg,style:{color:E,border:"1px solid ".concat(E)}},T().createElement(y.Z,{iconClass:"icon-icon_addx",size:"10px"}),W),z&&T().createElement(b.Z,{placement:"right",title:z,overlayClassName:"tooltip-overlay"},T().createElement("span",{className:"toolTip-span"},T().createElement(K.Z,{style:{fontSize:"16px",color:"rgba(0, 0, 0, 0.45)"}}))),(!x||S!=="1"||!G)&&T().createElement(P.Z,(0,O.Z)({},Q,v,{initData:{user:A},reserveUser:d}))))}}c.defaultProps={defaultChecked:[],createUserId:"",disabled:!1,orgProps:{},onChange:()=>{},isOperation:!1,tipHtml:"",filterUserListIds:"",notCreator:""},Se.Z=(0,D.$j)(B)((0,o.Z)()(c))},31151:function(gt,Se,e){"use strict";e.d(Se,{Z:function(){return L}});var O=e(62029),g=e(57663),b=e(71577),a=e(18106),T=e(88108),o=e(20228),D=e(11382),K=e(12924),P=e.n(K),y=e(91768),C=e(28216),p=e(49101),B=e(37055),c=e(18329),I=e(87312),M=e(88983),v=e(47933),A=e(60667);class d extends P().PureComponent{render(){var k=this.props,ne=k.teacher,ie=k.t,Ne=ne.adept_field.length>0&&ne.adept_field.split(",")?ne.adept_field.split(","):[];return P().createElement("div",{className:"teacher-radio-item"},P().createElement("img",{src:ne.avatar||"".concat("https://oss.coolcollege.cn","/1790708689137700864.png"),className:"teacher-radio-item_img"}),P().createElement("img",{className:"teacher-radio-item_sex",src:ne.sex===0?"".concat("https://oss.coolcollege.cn","/1790706775494889472.png"):"".concat("https://oss.coolcollege.cn","/1790706776073703424.png")}),P().createElement("div",{className:"teacher-radio-item_info"},P().createElement("div",{className:"teacher-info-top"},P().createElement("span",{className:"teacher-info-top-name"},ne.type==="inside"?P().createElement(A.Z,{dataType:"userName",value:ne.sync_user_id,name:ne.lecturer_name,type:ne.source_type}):ne.lecturer_name||ie("component.noGrade")),P().createElement("span",{className:"teacher-info-top-level"},ne.level_name),ne.course_count>0?P().createElement("span",{className:"teacher-info-top-count"},"(",ie("component.CoursesTaught"),ne.course_count,")"):null),P().createElement("div",{className:"teacher-info-bottom"},Ne.map((ue,_e)=>P().createElement("span",{className:"field-item",key:_e.toString()},ue)))))}}d.defaultProps={teacher:{}};var l=(0,y.Z)()(d),t=v.ZP.Group;class h extends P().PureComponent{constructor(k){super(k);this.onChange=ne=>{this.setState({value:ne.target.value}),this.props.onChange(ne.target.value)},this.state={value:k.defaultSelected}}render(){return P().createElement(t,{className:"teacher-radio-group",onChange:this.onChange,value:this.state.value},this.props.teacherList.map((k,ne)=>P().createElement(v.ZP,{key:ne.toString(),value:k.id},P().createElement(l,{teacher:k.data}))))}}h.defaultProps={defaultSelected:"",onChange:()=>{}};var F=h,m=e(63185),E=e(9676);class Q extends P().PureComponent{constructor(){super(...arguments);this.onChange=k=>{var ne=this.props.defaultSelected,ie=k.target,Ne=ie.value,ue=ie.checked,_e=this.isRepeat(ne,Ne);ue?_e===-1&&ne.push(Ne):_e===-1?ne.push(Ne):ne.splice(_e,1),this.props.onChange(ne)},this.isRepeat=(k,ne)=>k.indexOf(ne)}render(){var k=this.props,ne=k.teacherList,ie=k.defaultSelected;return P().createElement("div",{className:"teacher-radio-group"},ne.map(Ne=>P().createElement(P().Fragment,null,P().createElement(E.Z,{value:Ne.id,checked:ie.indexOf(Ne.id)!==-1,onChange:this.onChange},P().createElement(l,{teacher:Ne.data})))))}}Q.defaultProps={defaultSelected:[],onChange:()=>{}};var G=Q,V=e(10237),z=e(86726),$=e(48479),W=e(1164),S={size:"medium",destroyOnClose:!0,bodyStyle:{padding:"0"},maskClosable:!1,wrapClassName:"qa-select-teacher-confirm"},x=w=>({userInfo:w.user});class U extends P().Component{constructor(k){super(k);this.onOk=()=>{var ie=this.props.multiple,Ne=ie===void 0?!1:ie;this.setState({status:1}),Ne?this.props.onOk(this.state.teacherArr):this.props.onOk(this.state.selectTeacher)},this.onCancel=()=>{this.props.onCancel()},this.onChangeTab=ie=>{this.setState({activeLevel:"",status:ie},()=>{this.getTeacherList("")})},this.onSearchTeacher=ie=>{this.setState({keyword:ie},()=>{this.getTeacherList(this.state.activeLevel)})},this.onSelectMultipleTeacher=ie=>{var Ne=this.state.allTeacherList,ue=ie.map(_e=>Ne.find(Ze=>Ze.id===_e));this.setState({teacherArr:ue})},this.onSelectTeacher=ie=>{var Ne=this.state.teacherList.find(ue=>ue.id===ie);this.setState({selectTeacher:Ne})},this.compileData=ie=>{var Ne=ie.map(ue=>({id:ue.id,name:ue.lecturer_name,componentName:"TeacherSelector",data:ue,type:ue.type,icon:"",teacher_sync_user_id:ue.lecturer_sync_user_id,lecturer_name:ue.lecturer_name,teacher_sync_source_type:ue.lecturer_source_type,teacher_sync_type:ue.type}));return Ne},this.getTeacherLevel=()=>{var ie=B.ZP.SelectTeacher.getLevelList();V.WY.get({url:ie}).then(Ne=>{this.setState({levelList:Ne.data.list}),this.getTeacherList("")})},this.getTeacherList=ie=>{this.setState({loading:!0});var Ne=B.ZP.SelectTeacher.getTeacherList(),ue={keyword:this.state.keyword,level:ie,status:this.state.status,type:this.props.isInternal?"inside":""};V.WY.get({url:Ne,params:ue}).then(_e=>{this.setState({loading:!1,teacherList:this.compileData(_e.data.list)})})},this.getAllTeacherList=()=>{var ie=B.ZP.SelectTeacher.getTeacherList(),Ne={keyword:"",level:""};V.WY.get({url:ie,params:Ne}).then(ue=>{this.setState({allTeacherList:this.compileData(ue.data.list)})})},this.changeLevel=ie=>{this.setState({activeLevel:ie}),this.getTeacherList(ie)};var ne=(0,z.V9)("lecturerList",k.userInfo.modules);this.state={title:k.title||k.t("component.selectLecturer"),levelList:[],teacherList:[],activeLevel:"",selectTeacher:k.selected,actionAdd:(0,z.H3)("add",ne),teacherArr:k.selectedArr||[],status:1,allTeacherList:[],loading:!1}}componentDidMount(){this.getAllTeacherList()}UNSAFE_componentWillReceiveProps(k){k.selectedArr&&this.setState({teacherArr:k.selectedArr||[]})}componentDidUpdate(k){if(k.visible!==this.props.visible&&this.props.visible){var ne=this.props.selected,ie={id:ne.id,name:ne.name,componentName:"TeacherSelector",data:ne.data,lecturer_name:ne.data?ne.data.lecturer_name:"",teacher_sync_source_type:ne.data?ne.data.teacher_sync_source_type:"",teacher_sync_type:ne.data?ne.data.teacher_sync_type:"",teacher_sync_user_id:ne.data?ne.data.teacher_sync_user_id:"",type:"teacher",icon:""};this.setState({selectTeacher:ie,activeLevel:"",keyword:""},()=>{this.getTeacherLevel()})}}render(){var k=this.props,ne=k.t,ie=k.multiple,Ne=ie===void 0?!1:ie,ue=k.showTab,_e=ue===void 0?!1:ue,Ze=this.state,j=Ze.actionAdd,R=Ze.teacherArr,le=Ze.status,H=Ze.loading,X=R.map(Te=>Te.id),ce=localStorage.getItem("themeColor")||"#516AE6";return P().createElement(c.ZP,(0,O.Z)({},S,{visible:this.props.visible,title:this.state.title,onCancel:this.onCancel,onOk:this.onOk}),H&&P().createElement("div",{className:"teacher-select-loading"},P().createElement(D.Z,{size:"large"})),P().createElement("div",{className:"teacher-select-dialog"},P().createElement("div",{className:"teacher-select-dialog-top"},_e&&P().createElement(T.Z,{defaultActiveKey:le,onChange:this.onChangeTab},P().createElement(T.Z.TabPane,{tab:ne("common.activated"),key:"1"}),P().createElement(T.Z.TabPane,{tab:ne("common.deactivated"),key:"0"})),P().createElement($.Z,{onSearch:this.onSearchTeacher,prefixCls:"teacher-select-dialog-top-search",placeholder:ne("searchInputPlaceholder.lecturer")}),P().createElement("span",{className:"teacher-select-dialog-top-addBtn"},j?P().createElement(W.Z,{to:"/lecturer/lecturerManage/lecturerList"},P().createElement(b.Z,{type:"primary",icon:P().createElement(p.Z,null)},ne("lecturerPage.newLecturer"))):null)),P().createElement("div",{className:"teacher-select-dialog-content"},P().createElement("div",{className:"teacher-select-dialog-content_level"},P().createElement("div",{onClick:()=>this.changeLevel(""),className:"teacher-level-item",style:this.state.activeLevel===""?{color:ce,borderRight:"2px solid ".concat(ce)}:{}},ne("common.all")),this.state.levelList.map((Te,Le)=>P().createElement("div",{onClick:()=>this.changeLevel(Te.id),className:"teacher-level-item",style:this.state.activeLevel===Te.id?{color:ce,borderRight:"2px solid ".concat(ce)}:{},key:Le.toString()},Te.name))),P().createElement("div",{className:"teacher-select-dialog-content_teacher"},Ne?P().createElement(G,{teacherList:this.state.teacherList,onChange:this.onSelectMultipleTeacher,defaultSelected:X}):P().createElement(F,{teacherList:this.state.teacherList,onChange:this.onSelectTeacher,defaultSelected:this.state.selectTeacher.id}),this.state.teacherList.length===0?P().createElement(I.Z,null):null))))}}U.defaultProps={visible:!1,selected:{},multiple:!1,isInternal:!1,onCancel:()=>{},onOk:()=>{}};var L=(0,C.$j)(x)((0,y.Z)()(U))},55285:function(gt,Se,e){"use strict";e.d(Se,{Z:function(){return G}});var O=e(20228),g=e(11382),b=e(62029),a=e(88986),T=e(22385),o=e(31097),D=e(57361),K=e(33565),P=e(9754),y=e.n(P),C=e(12924),p=e.n(C),B=e(91768),c=e(28216),I=e(93485),M=e(38642);function v(V){var z={};if(V)for(var $=0,W=Object.entries(V);$<W.length;$++){var S=W[$],x=(0,K.Z)(S,2),U=x[0],L=x[1];z["user_info_".concat((0,M.FI)(U))]=L}return z}function A(V){if(!Array.isArray(V))return[];var z=V.map($=>{var W=$.user_info,S=$.userInfo,x={},U=W||S;if(U){var L=U.extendList,w=U.extend_list,k=L||w||[];if(k.length>0){var ne=(0,I.Z)(k),ie;try{for(ne.s();!(ie=ne.n()).done;){var Ne=ie.value,ue=Ne.columnKey,_e=Ne.column_key,Ze=Ne.extendValue,j=Ne.extend_value;x["user_info_".concat((0,M.FI)(ue||_e))]=Ze||j}}catch(R){ne.e(R)}finally{ne.f()}}}return(0,a.Z)((0,a.Z)((0,a.Z)({},$),x),v(U))});return z}function d(V,z){for(var $=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"right",W=V.slice(0).reverse(),S=0;S<W.length;S+=1)for(var x=S+1;x<W.length;x+=1)W[S][z]===W[x][z]&&(W.splice(x,1),x-=1);return $==="right"?W.reverse():W}var l=e(17215),t=e(36202),h=e(6793),F=e(9925),m=e(6934),E=V=>({userInfo:V.user}),Q=(0,C.forwardRef)((V,z)=>{var $=V.tableUUID,W=V.withLoginPhoneNumber,S=V.withCustomField,x=V.withLoginEmail,U=V.withJoinTime,L=V.onlyShowCurrentDept,w=(0,C.useState)([]),k=(0,K.Z)(w,2),ne=k[0],ie=k[1],Ne=(0,C.useState)([]),ue=(0,K.Z)(Ne,2),_e=ue[0],Ze=ue[1],j=(0,C.useState)(!1),R=(0,K.Z)(j,2),le=R[0],H=R[1];$||console.error("tableUUID is required!!!"),(0,C.useImperativeHandle)(z,()=>({getColumns:()=>ne})),(0,C.useEffect)(()=>{function ce(){return Te.apply(this,arguments)}function Te(){return Te=(0,D.Z)(y().mark(function Le(){var he,Ee,ve,be,Ve;return y().wrap(function(at){for(;;)switch(at.prev=at.next){case 0:return H(!0),at.next=3,(0,M.Kb)((0,l.h)());case 3:if(he=at.sent,Ee=(0,K.Z)(he,2),ve=Ee[0],be=Ee[1],!ve){at.next=10;break}return H(!1),at.abrupt("return");case 10:Ve=be.data,S||(Ve=Ve.filter(et=>Object.keys(et)[0].indexOf("column")===-1)),x||(Ve=Ve.filter(et=>Object.keys(et)[0].indexOf("loginEmail")===-1)),U||(Ve=Ve.filter(et=>Object.keys(et)[0].indexOf("joinTime")===-1)),H(!1),Ze(Ve);case 16:case"end":return at.stop()}},Le)})),Te.apply(this,arguments)}ce()},[]),(0,C.useEffect)(()=>{var ce=_e.map((he,Ee)=>{var ve=(0,K.Z)(Array.from(Object.entries(he))[0],2),be=ve[0],Ve=ve[1];return V.nameColumn&&Ee===0?V.nameColumn:be==="name"?{title:Ve,dataIndex:"user_info_".concat(be),key:"user_info_".concat(be),width:150,fixed:"left",render:(Ae,at)=>p().createElement(o.Z,{title:p().createElement(F.Z,{userId:at.user_info.id,userName:Ae})},p().createElement("div",{className:"cl-text-ellipsis",style:{width:140}},at.user_info&&p().createElement(F.Z,{userId:at.user_info.id,userName:Ae}),!at.user_info&&Ae))}:be==="deptName"||be==="dept_name"?{title:Ve,dataIndex:"user_info_".concat(be),key:"user_info_".concat(be),width:150,fixed:"left",render:(Ae,at)=>{var et=at.user_info,ut=et.department_infos,q=et.department_info;return Ae?p().createElement(o.Z,{title:p().createElement(m.P,{allDepartmentsList:ut||[]})},p().createElement("div",{className:"cl-text-ellipsis",style:{width:140}},p().createElement(m.P,{allDepartmentsList:(L?q:ut)||[]}))):"--"}}:be==="joinTime"?{title:Ve,dataIndex:"user_info_".concat(be),key:"user_info_".concat(be),width:150,render:Ae=>p().createElement(o.Z,{title:Ae?(0,h.p6)(Ae,"yyyy-MM-dd hh:mm:ss"):"--"},p().createElement("div",{className:"cl-text-ellipsis",style:{width:140}},Ae?(0,h.p6)(Ae,"yyyy-MM-dd hh:mm:ss"):"--"))}:{title:Ve,dataIndex:"user_info_".concat(be),key:"user_info_".concat(be),width:150,render:Ae=>p().createElement(o.Z,{title:Ae},p().createElement("div",{className:"cl-text-ellipsis",style:{width:140}},Ae||"--"))}}),Te=V.columns.map(he=>he.dataIndex==="creator_user_name"?(0,a.Z)((0,a.Z)({},he),{},{render:(Ee,ve)=>p().createElement(o.Z,{title:p().createElement(F.Z,{userId:ve.creator_sync_user_id,userName:Ee})},p().createElement("div",{className:"cl-text-ellipsis",style:{width:140}},p().createElement(F.Z,{userId:ve.creator_sync_user_id,userName:Ee})))}):he),Le=V.headExtra.concat(ce).concat(W?[{title:V.t("setting.loginPhoneNumber"),key:"user_info_loginMobile",dataIndex:"user_info_loginMobile",width:150,render:he=>he||"--"}]:[]).concat(Te);ie(Le)},[V.headExtra,V.columns,V.nameColumn,_e,V.userInfo.appType]);var X=(0,C.useMemo)(()=>A(V.dataSource),[V.dataSource]);return p().createElement(g.Z,{spinning:le},p().createElement(t.f,(0,b.Z)({scroll:{y:V.y||"100%",x:V.x||"max-content"}},V,{columns:ne,dataSource:X})))});Q.defaultProps={dataSource:[],headExtra:[],columns:[],nameColumn:null,namedType:"underLine",withLoginPhoneNumber:!1,withCustomField:!0,withLoginEmail:!0,withJoinTime:!0,onlyShowCurrentDept:!1};var G=(0,c.$j)(E,null,null,{forwardRef:!0})((0,B.Z)("translation",{withRef:!0})(Q))},87143:function(gt,Se,e){"use strict";var O=e(57338),g=e(83107),b=e(54029),a=e(62529),T=e(20228),o=e(11382),D=e(57663),K=e(71577),P=e(13062),y=e(71230),C=e(22385),p=e(31097),B=e(89032),c=e(15746),I=e(34792),M=e(48086),v=e(43358),A=e(34041),d=e(71153),l=e(60331),t=e(12924),h=e.n(t),F=e(91768),m=e(59239),E=e(55446),Q=e.n(E),G=e(49101),V=e(6793),z=e(28531),$=e(87312),W=e(63521),S=l.Z.CheckableTag,x=A.Z.Option;class U extends h().Component{constructor(w){super(w);this.onAddCancel=k=>{this.setState({addVisible:!1}),k!==""&&k&&this.getTagListByGroupData(k)},this.onAddOpen=()=>{this.setState({addVisible:!0})},this.onSubmit=()=>{this.props.onOk(this.state.selectTagsList),this.onClearTags()},this.onClearTag=(k,ne)=>{k.preventDefault(),this.handleChangeTag(ne,!1)},this.onClearTags=()=>{this.setState({selectTagsList:[],selectTagKey:[],selectGroupKey:[]})},this.getTagGroupData=()=>{(0,z.VL)(this.props.status).then(k=>{this.setState({tagsGroupList:k.data||[]}),k.data&&k.data.length>0&&this.getTagListByGroupData(k.data[0].id)})},this.getTagListByGroupData=k=>{this.setState({groupId:k}),(0,z.BY)(k,this.props.status).then(ne=>{this.setState({tagData:ne.data.group_tag_vo_list})})},this.handleTagsCancel=()=>{this.setState({inputSelectedTags:this.props.selectedAllTags,searchVal:"",tagsGroupList:[],tagData:[],searchTagsList:[],selectTagsList:[],isLoadingSearch:!1}),this.props.onCancel()},this.handleChangeTag=(k,ne)=>{var ie=!0;ne?this.checkTag(k)&&this.setState(Ne=>({selectTagsList:[...Ne.selectTagsList,k],selectTagKey:[...Ne.selectTagKey,k.tag_id],selectGroupKey:[...Ne.selectGroupKey,k.group_id]})):this.setState(Ne=>({selectTagsList:Ne.selectTagsList.filter(ue=>ue.tag_id!==k.tag_id),selectTagKey:Ne.selectTagKey.filter(ue=>ue!==k.tag_id),selectGroupKey:Ne.selectGroupKey.filter(ue=>{var _e=ie&&ue===k.group_id;return ue===k.group_id&&(ie=!1),!_e})}))},this.checkTag=k=>{var ne=this.state,ie=ne.selectTagsList,Ne=ne.selectGroupKey,ue=ne.selectTagKey,_e=this.props,Ze=_e.t,j=_e.maxNum,R=_e.canSingle;return k.tag_id?ie.length===j?(M.default.destroy(),M.default.error((0,V.ZT)("".concat(Ze("tagManage.limitTip")),j)),!1):ue.indexOf(k.tag_id)!==-1?(M.default.destroy(),M.default.error(Ze("tagManage.hasTag")),!1):R&&Ne.indexOf(k.group_id)!==-1?(M.default.destroy(),M.default.error(Ze("tagManage.groupLimit")),!1):!0:(M.default.destroy(),M.default.error(Ze("tagManage.errorTagId")),!1)},this.handleSearchTagsList=k=>{this.setState({searchTagsList:[],isLoadingSearch:!0}),(0,z.Mj)((0,V.fy)(k),this.props.status).then(ne=>{this.setState({searchTagsList:ne.data,isLoadingSearch:!1})})},this.handleSelectChange=(k,ne)=>{this.setState({searchVal:k}),this.checkTag({tag_id:ne.key})&&this.setState(ie=>({selectTagsList:[...ie.selectTagsList,{group_id:ne.titleTemp,group_name:ne.titleTempText,tag_id:ne.key,tag_name:ne.label}],selectGroupKey:[...ie.selectGroupKey,ne.titleTemp],selectTagKey:[...ie.selectTagKey,ne.key]}))},this.computeGroupNmu=k=>{var ne=this.state.selectGroupKey,ie=0;return ne.forEach(Ne=>{Ne===k&&(ie+=1)}),ie},this.renderTagsFooter=()=>{var k=this.state.selectTagsList,ne=this.props,ie=ne.prefixCls,Ne=ne.t,ue=ne.maxNum,_e=localStorage.getItem("themeColor")||"#465dcd";return h().createElement(h().Fragment,null,h().createElement(y.Z,{className:"".concat(ie,"__result")},h().createElement(c.Z,{span:4},h().createElement("span",{className:"selectTitle"},"".concat(Ne("component.selected"),"(").concat(k.length,"/").concat(ue,"):"))),h().createElement(c.Z,{span:18,className:"".concat(ie,"__result__center")},k.map(Ze=>h().createElement(p.Z,{key:Ze.tag_id,title:"".concat(Ze.tag_name).concat(Ze.tag_group_name?"("+Ze.tag_group_name+")":"")},h().createElement(l.Z,{closable:!0,className:"".concat(ie,"__tagList"),onClose:j=>this.onClearTag(j,Ze)},h().createElement("span",{className:"".concat(ie,"__tagNameText")},Ze.tag_name))))),h().createElement(c.Z,{span:2,className:"".concat(ie,"__delete")},h().createElement("span",{style:{color:"".concat(k.length>0?_e:"rgba(0,0,0,0.25)","  ")},onClick:this.onClearTags},Ne("common.clear")))),h().createElement(y.Z,{className:"".concat(ie,"__action")},h().createElement(c.Z,{span:24},h().createElement(K.Z,{onClick:this.handleTagsCancel},Ne("common.cancel")),h().createElement(K.Z,{type:"primary",onClick:this.onSubmit},Ne("common.ok")))))},this.state={searchVal:"",tagsGroupList:[],tagData:[],searchTagsList:[],selectTagsList:[],groupId:"",selectGroupKey:[],selectTagKey:[],isLoadingTags:!1,isLoadingSearch:!1,inputSelectedTags:w.selectedAllTags,addVisible:!1}}UNSAFE_componentWillReceiveProps(w){this.setState({inputSelectedTags:w.selectedAllTags})}componentDidUpdate(w){this.props.visible&&this.props.visible!==w.visible&&this.setState(k=>({selectTagsList:[...k.selectTagsList,...k.inputSelectedTags],selectTagKey:[...k.inputSelectedTags.map(ne=>ne.tag_id)],selectGroupKey:[...k.inputSelectedTags.map(ne=>ne.group_id||ne.tag_group_id)]}),()=>{this.getTagGroupData()})}render(){var w=this.props,k=w.visible,ne=w.prefixCls,ie=w.t,Ne=w.canAdd,ue=w.maxNum,_e=this.state,Ze=_e.searchTagsList,j=_e.isLoadingSearch,R=_e.isLoadingTags,le=_e.tagsGroupList,H=_e.groupId,X=_e.tagData,ce=_e.selectTagKey,Te=_e.addVisible,Le=_e.searchVal;return h().createElement(g.Z,{visible:k,width:680,maskClosable:!1,className:"".concat(ne),title:ie("common.detailChooseTag"),onClose:this.handleTagsCancel,okText:ie("common.ok"),cancelText:ie("common.cancel"),footer:this.renderTagsFooter()},h().createElement(y.Z,{className:"".concat(ne,"__search__warp")},h().createElement(c.Z,{span:19},h().createElement(A.Z,{allowClear:!0,style:{width:"260px"},showSearch:!0,filterOption:!1,value:Le===""?null:Le,optionLabelProp:"label",placeholder:(0,V.ZT)("".concat(ie("tagManage.search")),ue),showArrow:!1,onSearch:this.handleSearchTagsList,onSelect:this.handleSelectChange,notFoundContent:j&&Ze.length?h().createElement(o.Z,{size:"small"}):null},Ze.length>0&&Ze.map(he=>h().createElement(x,{className:"".concat(ne,"__option"),key:he.tag_id,titleTemp:he.tag_group_id,titleTempText:he.tag_group_name,value:he.tag_id,label:he.tag_name},h().createElement(p.Z,{title:"".concat(he.tag_name).concat(he.tag_group_name?"("+he.tag_group_name+")":"")},h().createElement("span",null,"".concat(he.tag_name)),h().createElement("span",{className:"groupName"},"".concat(he.tag_group_name?"("+he.tag_group_name+")":""))))))),h().createElement(c.Z,{span:5,className:"".concat(ne,"__addBtn")},Ne&&h().createElement(K.Z,{onClick:this.onAddOpen,icon:h().createElement(G.Z,null)},ie("tagManage.add")))),h().createElement(y.Z,{className:"".concat(ne,"__content")},h().createElement(c.Z,{span:6,className:"".concat(ne,"__tagGroupList")},le.map(he=>h().createElement("div",{key:he.id,className:H===he.id?"".concat(ne,"__groupName active"):"".concat(ne,"__groupName"),onClick:()=>this.getTagListByGroupData(he.id)},h().createElement(p.Z,{title:he.group_name},h().createElement("span",{className:"".concat(ne,"__groupNameText")},he.group_name)),h().createElement(a.Z,{size:"small",count:this.computeGroupNmu(he.id)})))),h().createElement(c.Z,{className:"".concat(ne,"__tagListResult"),span:18},R?h().createElement("div",{className:"".concat(ne,"__loading")},h().createElement(o.Z,null)):null,X&&X.map(he=>h().createElement(S,{type:"text",className:"".concat(ne,"__tagList"),key:he.tag_id,checked:ce.indexOf(he.tag_id)!==-1,onChange:Ee=>this.handleChangeTag(he,Ee)},h().createElement(p.Z,{title:he.tag_name},he.tag_name))),!X||X.length===0?h().createElement($.Z,{className:"".concat(ne,"__noResult")}):null)),h().createElement(W.Z,{visible:Te,enable:!0,onCancel:he=>this.onAddCancel(he)}))}}U.defaultProps={prefixCls:"cl-all-tags",maxNum:5,canAdd:!1,canSingle:!1,status:1},Se.Z=m.Z.create({name:"ClAllTags"})((0,F.Z)()(U))},58546:function(gt,Se,e){"use strict";var O=e(12924),g=e.n(O),b=e(91768),a=e(18329),T=e(89560),o=e(37055),D=e(10237),K=e(25547),P=e(44881),y={getResourceClassify:o.ZP.Classify.getResourceClassify};class C extends g().Component{constructor(){var B;super(...arguments);B=this,this.state={treeData:[],node:{},selectedKeys:[]},this.loadData=c=>{var I=this.props.authType;return new Promise(M=>{var v=c.id;setTimeout(()=>{var A=o.ZP.Classify.getResourceClassify(),d=v;D.WY.get({url:A,params:{parent_id:d,auth_type:I}}).then(l=>{if(!(!l.data||c.dataRef.children)){var t=(0,P.P)(l.data.list,I);c.dataRef.children=t,this.setState({treeData:[...this.state.treeData]})}}),M()},300)})},this.getList=function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,I=B.props,M=I.selectedKeys,v=I.authType,A=I.selectedNames;D.WY.get({url:y.getResourceClassify(),params:{parent_id:0,auth_type:v}}).then(d=>{var l=d.data.list,t=(0,P.P)(l,v),h=c?[{courseCount:0,createTime:0,createUser:"",id:"0",label:"\u5168\u90E8",level:0,name:"\u5168\u90E8",orderId:0,parentId:"-1",value:"0",children:t}]:t;B.setState({treeData:h,node:{id:M[0],name:A[0]},selectedKeys:M})})},this.handleClickNode=c=>{this.setState({node:c,selectedKeys:[c.id]})},this.handleOk=()=>{var c=this.state,I=c.node,M=c.treeData,v=c.selectedKeys;this.props.onOk({id:this.props.id,node:Object.keys(I).length>0?I:(0,K.lK)(M,v[0])})}}componentDidUpdate(B){this.props.visible&&this.props.visible!==B.visible&&this.getList(this.props.isRoot)}render(){var B=this.props,c=B.visible,I=B.title,M=B.prefixCls,v=B.onCancel,A=B.selectedNames,d=B.t,l=B.isRoot,t=this.state,h=t.treeData,F=t.selectedKeys;return g().createElement(a.ZP,{size:"small",visible:c,title:I,okText:d("common.ok"),cancelText:d("common.cancel"),onCancel:v,onOk:this.handleOk,destroyOnClose:!0},g().createElement("div",{className:"".concat(M)},g().createElement("header",{className:"".concat(M,"__title")},d("component.currentClassify"),": ",g().createElement("span",null,A)),g().createElement("div",{className:"".concat(M,"__content")},h.length?g().createElement(T.Z,{list:h,isRoot:l,selectedKeys:F,loadData:this.loadData,onSelect:this.handleClickNode}):null)))}}C.defaultProps={prefixCls:"cl-category-selector",id:"",visible:!1,title:"SelectCategory",selectedKeys:[],selectedNames:[],onCancel:()=>{},onOk:()=>{},isRoot:!1,authType:"edit"},Se.Z=(0,b.Z)()(C)},40646:function(gt,Se,e){"use strict";e.d(Se,{l:function(){return I},t:function(){return d}});var O=e(62029),g=e(12924),b=e.n(g),a=e(22385),T=e(31097),o=e(63185),D=e(9676),K=e(28216),P=e(17780),y=e(13875),C=e.n(y),p=(l,t)=>{var h=(0,K.v9)($=>{var W=$.advancedSetting;return{themeColor:W.themeColor}}),F=h.themeColor,m=l.options,E=l.onChange,Q=l.values,G=Q===void 0?[]:Q,V=l.labelClassName,z=G.slice();return b().createElement("div",{className:C()["cl-checkbox-group"],ref:t},m.map($=>{var W=z.includes($.value);return $.disabled&&$.disabledTip?b().createElement(T.Z,{title:$.disabledTip,overlayClassName:C()["tooltip-overlay"]},b().createElement("span",{key:"".concat($.value).concat(W),className:C()["check-box-content"]},b().createElement(D.Z,{id:"".concat($.value),key:"".concat($.value).concat(W),value:$.value,checked:z.includes($.value),disabled:$.disabled,onChange:E,className:"".concat(C().checkbox_button," ").concat(V)},b().createElement("span",{style:{color:"".concat(W?($.disabled,F):"")},className:C()["check-title"]},$.label)))):$.toolTip?b().createElement(T.Z,{title:$.toolTip,overlayClassName:C()["tooltip-overlay"]},b().createElement("span",{key:"".concat($.value).concat(W),className:C()["check-box-content"]},b().createElement(D.Z,{id:"".concat($.value),key:"".concat($.value).concat(W),value:$.value,checked:z.includes($.value),disabled:$.disabled,onChange:E,className:"".concat(C().checkbox_button," ").concat(V)},b().createElement("span",{style:{color:"".concat(W?($.disabled,F):"")},className:C()["check-title"]},$.label)))):b().createElement("span",{key:"".concat($.value).concat(W),className:(0,P.xX)()?C()["check-box-micro-content"]:C()["check-box-content"]},b().createElement(D.Z,{id:"".concat($.value),value:$.value,checked:z.includes($.value),disabled:$.disabled,onChange:E,className:"".concat(C()["checkbox-button-box"]," ").concat(V)},b().createElement("span",{style:{color:"".concat(W?($.disabled,F):"")},className:C()["check-title"]},$.label)))}))};p.defaultProps={options:[],values:[],labelClassName:"",disabled:!1,disabledTip:""};var B=(0,g.forwardRef)(p);function c(l,t){var h=F=>{var m=F.target,E=m.checked,Q=m.value;l.onChange&&l.onChange({checked:E,value:Q})};return b().createElement(B,(0,O.Z)({},l,{onChange:h,ref:t}))}c.defaultValue={value:[]};var I=(0,g.forwardRef)(c),M=e(33565),v=e(81211);function A(l){var t=l.defaultValue,h=l.onChange,F=(0,v.Z)(l,["defaultValue","onChange"]),m=(0,g.useState)(t),E=(0,M.Z)(m,2),Q=E[0],G=E[1];(0,g.useEffect)(()=>{h&&h(Q)},[Q]);var V=z=>{var $=z.target,W=$.checked,S=$.value;W&&G(x=>[...x,S]),W||G(x=>x.filter(U=>U!==S))};return b().createElement(B,(0,O.Z)({},F,{values:Q,onChange:V}))}A.defaultValue={defaultValue:[]};var d=A},66361:function(gt,Se,e){"use strict";var O=e(88986),g=e(62029),b=e(47673),a=e(4107),T=e(32157),o=e(75869),D=e(12924),K=e.n(D),P=e(91768),y=e(16162),C=e.n(y),p=e(84874),B=e(56130),c=o.Z.TreeNode,I=a.Z.Search;class M extends K().PureComponent{constructor(){super(...arguments);this.state={searchValue:"",timeStamp:""},this.onSearch=A=>{var d=this.props.refresh;d(A),this.setState({searchValue:A,timeStamp:new Date().getTime()})},this.handleSelect=(A,d)=>{var l=d.node,t=l.props,h=t.eventKey,F=t.dataLable,m=t.children;this.props.onSelect({id:h,name:F,children:m})},this.renderTreeNodes=A=>A.map(d=>d.children?K().createElement(c,{key:d.id,dataRef:d,disabled:d.disabled||!1,title:this.renderTreeNodeTitle(d),dataLable:d.label},this.renderTreeNodes(d.children)):K().createElement(c,(0,g.Z)({key:d.id},d,{title:this.renderTreeNodeTitle(d),dataRef:d,dataLable:d.label,disabled:d.disabled||!1}))),this.renderTreeNodeTitle=A=>{var d=K().createElement("span",{className:C().row_icon},K().createElement(p.Z,{iconClass:"icon-icon_donex1"}));return K().createElement("span",{className:C().row},K().createElement("span",{className:C().row_label,title:A.label},A.label),d)}}render(){var A=this.props,d=A.t,l=A.classify,t=A.isRoot,h=A.selectedKeys,F=A.placeholder,m=A.showSearch,E=A.stickySearch,Q=A.height,G=this.state,V=G.searchValue,z=G.timeStamp,$=[];return t&&!V?$=[{id:"",name:d("common.all"),label:d("common.all"),isLeaf:!0}].concat(l):$=l.map(W=>(0,O.Z)((0,O.Z)({},W),{},{isLeaf:!0})),K().createElement("div",{className:"".concat(C()["classify-tree-container"]," ").concat(this.props.className)},m?K().createElement(I,{className:C()["classify-tree-search"],placeholder:F,onSearch:this.onSearch,allowClear:!0}):null,K().createElement(o.Z,{blockNode:!0,height:Q,key:z,selectedKeys:h,onSelect:this.handleSelect,className:"".concat(E?C().fixed:""),loadData:this.props.loadData},this.renderTreeNodes($||[])))}}M.defaultProps={showSearch:!1,placeholder:"Search",immediateSearch:!0,stickySearch:!1},Se.Z=(0,B.Z)((0,P.Z)()(M))},6934:function(gt,Se,e){"use strict";e.d(Se,{P:function(){return v}});var O=e(12924),g=e.n(O),b=e(18446),a=e.n(b),T=e(57361),o=e(33565),D=e(9754),K=e.n(D),P=e(28216);function y(A){var d=A.openid,l=(0,O.useRef)(null);return(0,O.useLayoutEffect)(()=>{var t=window.parent.WWOpenData;t&&t.bind(l.current)}),g().createElement("ww-open-data",{ref:l,type:"departmentName",openid:d})}var C=e(14441),p=A=>{var d=A.separator,l=A.departmentIds,t=A.departmentNames,h=A.appType,F=(0,O.useState)([]),m=(0,o.Z)(F,2),E=m[0],Q=m[1];(0,O.useEffect)(()=>{h==="wx_app"&&G()},[l]);function G(){return V.apply(this,arguments)}function V(){return V=(0,T.Z)(K().mark(function W(){var S,x,U;return K().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,(0,C.t)(l);case 2:S=w.sent,x=S.code,U=S.data,x==="200000"&&U&&Q(U);case 5:case"end":return w.stop()}},W)})),V.apply(this,arguments)}function z(){return E.length?g().createElement(g().Fragment,null,E.map((W,S)=>W.hasName?g().createElement(g().Fragment,null,W.name,S===t.length-1?"":d):g().createElement(g().Fragment,null,g().createElement(y,{openid:W.thirdId}),S===t.length-1?"":d," "))):null}function $(){var W="";return t.forEach((S,x)=>{W+=S+(x===t.length-1?"":d)}),g().createElement(g().Fragment,null,W)}switch(h){case"wx_app":return z();default:return $()}};p.defaultProps={departmentIds:[],departmentNames:[],separator:","};var B=A=>({appType:A.user.appType}),c=g().memo((0,P.$j)(B)(p)),I=A=>{var d=A.allDepartmentsList,l=function(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{department_ids:[],department_names:[]},F=h.department_ids.split("/"),m=h.department_names.split("/");return g().createElement(c,{departmentNames:m,departmentIds:F,separator:"/"})};return d.length?g().createElement(g().Fragment,null,d.map((t,h)=>g().createElement("span",{key:t.department_ids},l(t),h===d.length-1?"":"\uFF0C"))):null};I.defaultProps={allDepartmentsList:[]};function M(A,d){return a()(A,d)}var v=g().memo(I,M)},20560:function(gt,Se,e){"use strict";var O=e(62029),g=e(49111),b=e(19650),a=e(57663),T=e(71577),o=e(71153),D=e(60331),K=e(22385),P=e(31097),y=e(88986),C=e(12924),p=e.n(C),B=e(91768),c=e(80991),I=e(56130),M=e(58546);class v extends p().Component{constructor(d){super(d);this.handleChange=(l,t)=>{if(this.props.isObj)this.props.formik.setFieldValue("courseClassify",{id:l,name:t.name});else{var h=this.props.formik;if(h&&h.setValues){var F=h.values;h.setValues((0,y.Z)((0,y.Z)({},F),{},{classifyName:t.name}))}this.props.onFieldChange(l,t)}},this.handleClear=()=>{this.setState({id:"",name:"",categoryConfig:(0,y.Z)((0,y.Z)({},this.state.categoryConfig),{},{selectedKeys:[],selectedNames:[]})},()=>{this.handleChange("",{})})},this.handleSetCategory=l=>{var t=l.node;this.setState({id:t.id,name:t.name,categoryConfig:(0,y.Z)((0,y.Z)({},this.state.categoryConfig),{},{selectedKeys:[t.id],selectedNames:[t.name]})},()=>{this.handleChange(t.id,t),this.handleCategoryModal(!1)})},this.handleCategoryModal=l=>{this.setState({categoryConfig:(0,y.Z)((0,y.Z)({},this.state.categoryConfig),{},{visible:l})})},this.state={id:"",name:"",categoryConfig:{selectedKeys:[],selectedNames:[],visible:!1,onCancel:()=>this.handleCategoryModal(!1),onOk:this.handleSetCategory}}}static getDerivedStateFromProps(d,l){if(d.value!==l.value){var t=d.isObj,h=d.value,F=d.classifyName;return t&&typeof h!="string"?{id:h.id,name:h.id==="999"?"\u672A\u5F52\u7C7B":h.name,categoryConfig:(0,y.Z)((0,y.Z)({},l.categoryConfig),{},{selectedKeys:[h.id],selectedNames:[h.id==="999"?"\u672A\u5F52\u7C7B":h.name]})}:{id:h,name:h==="999"?"\u672A\u5F52\u7C7B":F,categoryConfig:(0,y.Z)((0,y.Z)({},l.categoryConfig),{},{selectedKeys:[h],selectedNames:[h==="999"?"\u672A\u5F52\u7C7B":F]})}}return null}render(){var d=this.state,l=d.id,t=d.categoryConfig,h=d.name,F=this.props.t;return p().createElement("div",{className:"classify-select-action",id:"courseClassify"},p().createElement(b.Z,null,(l||h)&&p().createElement(D.Z,{closable:!0,onClose:this.handleClear},p().createElement(P.Z,{title:h||l},p().createElement("span",{className:"classify-select-action-label"},h||l))),p().createElement(T.Z,{onClick:()=>this.handleCategoryModal(!0)},F("course.chooseCategory"))),p().createElement(M.Z,(0,O.Z)({},t,{title:F("course.adjustClassify"),authType:"edit"})))}}v.defaultProps={showAdd:!1,isObj:!1},Se.Z=(0,c.$j)((0,I.Z)((0,B.Z)()(v)))},49616:function(gt,Se,e){"use strict";var O=e(62029),g=e(57663),b=e(71577),a=e(22385),T=e(31097),o=e(81211),D=e(34792),K=e(48086),P=e(43358),y=e(34041),C=e(12924),p=e.n(C),B=e(28216),c=e(91768),I=e(80991),M=e(8812),v=e(6793),A=e(87143),d=e(28531),l=F=>({themeColor:F.advancedSetting.themeColor}),t=y.Z.Option;class h extends p().Component{constructor(m){super(m);this.handleSelectOptionNull=E=>{this.setState({searchTagsList:[{tag_id:"",tag_name:this.props.t(E||"tagManage.searchOther")}]})},this.handleAllTags=()=>{this.setState({visible:!0}),this.allTags.getTagGroupData&&this.allTags.getTagGroupData()},this.handleCancel=()=>{this.setState({visible:!1})},this.handleOk=E=>{this.setState({selectTagsList:E,selectTagName:E.map(Q=>Q.tag_name),selectGroupKey:E.map(Q=>Q.group_id),selectTagKey:E.map(Q=>Q.tag_id),visible:!1},()=>{this.setFieldValueForFormik(this.state.selectTagsList)})},this.initRef=E=>{this.selectRef=E},this.handleSelectChange=(E,Q)=>{var G=this.state.selectTagsList;G.length<Q.length?Q.forEach(V=>{this.checkTag(V)&&this.setTagVal(V)}):this.setNullTagVal(()=>{Q.length===0&&this.setFieldValueForFormik(this.state.selectTagsList),Q.forEach(V=>{setTimeout(()=>{this.setTagVal(V)},0)})}),this.handleSelectOptionNull()},this.setTagVal=E=>{var Q=this.state,G=Q.selectTagsList,V=Q.selectTagName,z=Q.selectGroupKey,$=Q.selectTagKey;this.setState({selectTagsList:[...G,{group_id:E.titleTemp,group_name:E.titleTempName,tag_id:E.key,tag_name:E.tagName}],selectTagName:[...V,E.label],selectGroupKey:[...z,E.titleTemp],selectTagKey:[...$,E.key]},()=>{this.setFieldValueForFormik(this.state.selectTagsList)})},this.setNullTagVal=E=>{this.setState({selectTagsList:[],selectTagName:[],selectGroupKey:[],selectTagKey:[]},E)},this.setFieldValueForFormik=E=>{this.props.formik.setFieldValue?this.props.formik.setFieldValue(this.props.name,{resourceType:this.props.defaultFieldList.resourceType,tagsNameList:E}):this.props.setFieldValue(E)},this.handleSearchTagsList=E=>{E!==""?(0,d.Mj)(E,this.state.status).then(Q=>{Q.data.length>0?this.setState({searchTagsList:Q.data}):this.handleSelectOptionNull("customFields.noData")}):this.handleSelectOptionNull()},this.getResourceQueryTags=(E,Q)=>{(0,d.S8)(E,Q).then(G=>{G.data.data.forEach(V=>{var z={titleTemp:V.group_id,titleTempName:V.group_name,key:V.tag_id,value:V.tag_id,tagName:V.tag_name};this.setTagVal(z)}),this.setFieldValueForFormik(this.state.selectTagsList)})},this.checkTag=E=>{var Q=this.state,G=Q.selectTagsList,V=Q.selectGroupKey,z=Q.selectTagKey,$=Q.canSingle,W=this.props,S=W.t,x=W.maxNum;return E.key?G.length===x?(K.default.destroy(),K.default.error(S("common.detailAllTagLimit")),!1):z.indexOf(E.key)!==-1?!1:$&&V.indexOf(E.titleTemp)!==-1?(K.default.destroy(),K.default.error(S("tagManage.groupLimit")),!1):!0:!1},this.getOptionTags=()=>{var E=this.state,Q=E.searchTagsList,G=E.selectTagsList,V=Q.concat(G);if(V.length===0)return[];var z={};return V.map($=>{if($.tag_group_name=$.tag_group_name?$.tag_group_name:$.group_name,$.tag_group_id=$.tag_group_id?$.tag_group_id:$.group_id,!z[$.tag_id])return z[$.tag_id]=!0,$})},this.getTagSettings=()=>{(0,d.kF)("create_new_label").then(E=>{this.setState({canAdd:E.data.status})}),(0,d.kF)("tag_select_mode").then(E=>{this.setState({canSingle:E.data.status})})},this.state={visible:!1,selectTagsList:[],searchTagsList:[],selectGroupKey:[],selectTagKey:[],selectTagName:[],canAdd:!1,canSingle:!1,status:1}}componentDidMount(){var m=this.props.defaultFieldList,E=m.resourceId,Q=m.resourceType;E?this.getResourceQueryTags(E,Q):this.handleSelectOptionNull(),this.getTagSettings()}render(){var m=this.state,E=m.selectTagsList,Q=m.visible,G=m.canAdd,V=m.canSingle,z=m.selectTagKey,$=this.getOptionTags().filter(w=>w&&w.tag_id),W=this.props,S=W.t,x=W.maxNum,U=W.selectWidth,L=(0,o.Z)(W,["t","maxNum","selectWidth"]);return p().createElement(C.Fragment,null,p().createElement("div",(0,O.Z)({className:"select_box"},L),p().createElement("div",{className:"select_parent",style:{width:U||"auto",flex:U?"initial":"1"}},p().createElement(y.Z,{showSearch:!0,className:"search_tag",ref:this.initRef,mode:"multiple",maxTagTextLength:30,filterOption:!1,optionLabelProp:"label",placeholder:(0,v.ZT)("".concat(S("tagManage.search")),x),value:z,getPopupContainer:w=>w.parentNode,onSearch:this.handleSearchTagsList,onChange:this.handleSelectChange,onBlur:()=>this.handleSelectOptionNull(),onFocus:()=>{this.handleSelectOptionNull()}},$.length>0&&$.map(w=>p().createElement(t,{className:w.tag_id===""?"invisible":"result",key:w.tag_id,titleTemp:w.tag_group_id,titleTempName:w.tag_group_name,value:w.tag_id,tagName:w.tag_name,label:w.tag_name},p().createElement(T.Z,{title:"".concat(w.tag_name).concat(w.tag_group_name?"("+w.tag_group_name+")":"")},p().createElement("span",null,"".concat(w.tag_name)),p().createElement("span",{className:"groupName"},"".concat(w.tag_group_name?"("+w.tag_group_name+")":""))))))),p().createElement("div",{className:"add_parent"},p().createElement(b.Z,{block:!0,onClick:this.handleAllTags},p().createElement("span",{className:"select_btn_text"},S("common.detailChooseTag")),p().createElement(M.Z,null)),p().createElement(A.Z,{ref:w=>this.allTags=w,visible:Q,t:S,maxNum:x,canAdd:G,canSingle:V,selectedAllTags:E,onCancel:this.handleCancel,onOk:this.handleOk}))))}}h.defaultProps={defaultFieldList:{resourceType:"",resourceId:""},maxNum:5,name:"tagGroup"},Se.Z=(0,B.$j)(l)((0,I.$j)((0,c.Z)()(h)))},28531:function(gt,Se,e){"use strict";e.d(Se,{tB:function(){return b},VL:function(){return a},BY:function(){return T},Mj:function(){return o},S8:function(){return K},kF:function(){return P}});var O=e(37055),g=e(10237);function b(y){var C=y.tags,p=y.resourceId,B=y.resourceType,c=O.ZP.tagsInformation.addResourceTags();return g.WY.post({url:c,data:{tags:C.map(I=>I.tag_name),tagGroupInfoList:C,resourceId:p,resourceType:B}})}var a=y=>{var C=O.ZP.tagsInformation.tagGroupList();return g.WY.get({url:C,params:{status:y===1?y:"",is_deleted:1}})},T=(y,C)=>{var p=O.ZP.tagsInformation.tagsList();return g.WY.get({url:p,params:{group_id:y,status:C===1?C:"",is_deleted:1}})},o=(y,C)=>{var p=O.ZP.tagsInformation.getAllTagList();return g.WY.get({url:p,params:{group_status:C===1?C:"",keyword:y,status:C===1?C:"",is_deleted:1}})},D=(y,C)=>{var p=CONFIG.tagsInformation.recommendedTags();return request.get({url:p,params:{num:y,type:C}})},K=(y,C)=>{var p=O.ZP.tagsInformation.resourceQueryTags();return g.WY.get({url:p,params:{resourceId:y,type:C,isNewTag:!0}})},P=y=>{var C=O.ZP.advancedSetting.getSettingStatusByType(y);return g.WY.get({url:C})}},70075:function(gt,Se,e){"use strict";e.d(Se,{a:function(){return c}});var O=e(62029),g=e(33565),b=e(81211),a=e(47673),T=e(4107),o=e(12924),D=e.n(o),K=e(47444),P=e(60006),y=e.n(P),C=e(43859),p=T.Z.TextArea;function B(I){var M=I.char,v=I.displayType,A=I.LimitLength,d=I.value,l=I.valueSlice,t=I.showCount,h=I.onChange,F=I.disabledInput,m=(0,b.Z)(I,["char","displayType","LimitLength","value","valueSlice","showCount","onChange","disabledInput"]),E=(0,o.useState)(()=>l?(0,K.B)({value:d,LimitLength:A,char:M}):I.defaultValue||""),Q=(0,g.Z)(E,2),G=Q[0],V=Q[1],z=(0,o.useRef)({evtName:""});(0,o.useEffect)(()=>{V(l?(0,K.B)({value:d,LimitLength:A,char:M,disabledInput:F}):d)},[d,A,M,l,F]),(0,o.useEffect)(()=>{if(z.current.evtName==="input"){v==="Custom"?I.onFieldChange(G):h(G),I.onInput&&I.onInput(G),z.current.evtName="";return}l&&(v==="Custom"?I.onFieldChange(G):h(G),I.onInput&&I.onInput(G))},[G,v,l]);var $=U=>{z.current.evtName="input";var L=U.target,w=L.value,k=(0,K.B)({value:w,LimitLength:A,char:M,disabledInput:F});V(k)},W=(0,o.useMemo)(()=>(0,K.S)({inputValue:G,LimitLength:A,char:M,showCount:t,disabledInput:F}),[G,A,M,t,F]),S=W.dataCount,x=W.usedLength;return D().createElement("div",{className:"".concat(y()["textarea-wrap"]," ").concat(x&&A&&x>A?y()["textarea-wrap-error"]:""),"data-count":S},v==="Custom"?D().createElement(p,(0,O.Z)({},m,{value:G,onInput:$})):D().createElement(p,(0,O.Z)({},m,{value:G,onInput:$})))}B.defaultProps={valueSlice:!1,disabledInput:!0,onChange:()=>{},onInput:()=>{},char:!1,autoSize:{minRows:4,maxRows:10},displayType:""};var c=B;Se.Z=(0,C.Z)(B)},7584:function(gt,Se,e){"use strict";e.d(Se,{t:function(){return c}});var O=e(47673),g=e(4107),b=e(62029),a=e(33565),T=e(81211),o=e(12924),D=e.n(o),K=e(80991),P=e(47444),y=e(60006),C=e.n(y),p=e(43859);function B(I){var M=I.isPreview,v=I.char,A=I.displayType,d=I.width,l=I.LimitLength,t=I.showCount,h=I.value,F=I.valueSlice,m=I.onChange,E=I.disabledInput,Q=(0,T.Z)(I,["isPreview","char","displayType","width","LimitLength","showCount","value","valueSlice","onChange","disabledInput"]),G=(0,o.useState)(()=>F?(0,P.B)({value:h,LimitLength:l,char:v}):I.defaultValue||""),V=(0,a.Z)(G,2),z=V[0],$=V[1],W=(0,o.useRef)({evtName:""});(0,o.useEffect)(()=>{$(F?(0,P.B)({value:h,LimitLength:l,char:v,disabledInput:E}):h)},[h,l,v,F,E]),(0,o.useEffect)(()=>{if(W.current.evtName==="input"){A==="Custom"?I.onFieldChange(z):m(z),I.onInput&&I.onInput(z),W.current.evtName="";return}F&&(A==="Custom"?I.onFieldChange(z):m(z),I.onInput&&I.onInput(z))},[z,A,F]);var S=k=>{W.current.evtName="input";var ne=k.target,ie=ne.value,Ne=(0,P.B)({value:ie,LimitLength:l,char:v,disabledInput:E});$(Ne)},x=(0,o.useMemo)(()=>(0,P.S)({inputValue:z,LimitLength:l,char:v,showCount:t,disabledInput:E}),[z,l,v,t,E]),U=x.dataCount,L=x.usedLength,w=(0,o.useRef)(null);return(0,o.useEffect)(()=>{w&&w.current&&(I.autoFocus==="true"?w.current.focus():w.current.blur())},[I.autoFocus]),D().createElement("div",{className:"".concat(C()["input-wrap"]," ").concat(L&&l&&L>l?C()["input-wrap-error"]:""),"data-count":U,style:{width:d||void 0}},A==="Custom"?D().createElement(g.Z,(0,b.Z)({},Q,{value:z,disabled:M,onInput:S})):D().createElement(g.Z,(0,b.Z)({},Q,{value:z,ref:w,disabled:M,onInput:S})))}B.defaultProps={valueSlice:!1,disabledInput:!0,onChange:()=>{},onInput:()=>{},char:!1,LimitLength:void 0,showCount:!1,displayType:"",width:void 0};var c=B;Se.Z=(0,p.Z)((0,K.$j)(B))},47444:function(gt,Se,e){"use strict";e.d(Se,{B:function(){return g},S:function(){return b}});var O=e(2396);function g(a){var T=a.value,o=a.LimitLength,D=a.char,K=a.disabledInput,P=T&&typeof T=="string"?T:"",y=P;return K&&D&&o&&(0,O.$s)(y)>o&&(y=P.substring(0,(0,O.rw)(P,o))),y}function b(a){var T=a.inputValue,o=a.LimitLength,D=a.char,K=a.showCount,P="",y=T&&typeof T=="string"?T:"",C=D?Math.ceil((0,O.$s)(y)):y.length;return K&&o&&(P="".concat(C,"/").concat(o)),{dataCount:P,usedLength:C}}},99367:function(gt,Se,e){"use strict";var O=e(62029),g=e(57361),b=e(30887),a=e(99210),T=e(59250),o=e(13013),D=e(22385),K=e(31097),P=e(34792),y=e(48086),C=e(88986),p=e(33565),B=e(81211),c=e(9754),I=e.n(c),M=e(12924),v=e.n(M),A=e(91768),d=e(28216),l=e(57254),t=e(50361),h=e.n(t),F=e(7304),m=e.n(F),E=e(55285),Q=e(38642),G=e(36202),V=e(37055),z=e(86726),$=(0,M.forwardRef)((S,x)=>{var U=S.t,L=S.modules,w=S.userId,k=S.isAdmin,ne=S.uniKey,ie=S.queryParams,Ne=S.queryParam,ue=S.pagerConfig,_e=S.rowSelection,Ze=S.pagination,j=S.toolBarRender,R=S.headerTitle,le=S.footerRightRender,H=S.uuid,X=S.collapsed,ce=S.showUserInfo,Te=S.loadComplete,Le=S.sortFormate,he=S.themeColor,Ee=S.loadingHttp,ve=S.from,be=(0,B.Z)(S,["t","modules","userId","isAdmin","uniKey","queryParams","queryParam","pagerConfig","rowSelection","pagination","toolBarRender","headerTitle","footerRightRender","uuid","collapsed","showUserInfo","loadComplete","sortFormate","themeColor","loadingHttp","from"]),Ve=(0,z.V9)(ne,L),Ae=(0,M.useRef)(),at=(0,M.useState)([]),et=(0,p.Z)(at,2),ut=et[0],q=et[1],Oe=(0,M.useState)([]),Je=(0,p.Z)(Oe,2),je=Je[0],Be=Je[1],St=(0,M.useState)(0),Lt=(0,p.Z)(St,2),Wt=Lt[0],pa=Lt[1],Xt=(0,M.useState)(!1),Et=(0,p.Z)(Xt,2),Fe=Et[0],Pe=Et[1],Ie=(0,M.useState)(!0),$e=(0,p.Z)(Ie,2),te=$e[0],ae=$e[1],Re=(0,M.useState)({pageSize:10,current:1,total:0}),de=(0,p.Z)(Re,2),we=de[0],rt=de[1],mt=(0,M.useState)({pageSize:"page_size",pageIndex:"page_number"}),Zt=(0,p.Z)(mt,2),bt=Zt[0],Ft=Zt[1],Ut=(0,M.useState)({}),ca=(0,p.Z)(Ut,2),Qt=ca[0],Va=ca[1],Ra=(0,M.useState)({}),Ua=(0,p.Z)(Ra,2),ja=Ua[0],ua=Ua[1];(0,M.useEffect)(()=>{if(ue&&JSON.stringify(ue)!=="{}"){if((ue.pageSize||ue.pageIndex)&&Ft({pageSize:ue.pageSize||bt.pageSize,pageIndex:ue.pageIndex||bt.pageIndex}),(ue.pageSizeNum||ue.pageIndexNum)&&rt((0,C.Z)((0,C.Z)({},we),{},{pageSize:ue.pageSizeNum||we.pageSize,current:ue.pageIndexNum||we.current})),Ne&&JSON.stringify(Ne)!=="{}"){var me={};Object.keys(Ne).forEach(We=>{me[We]=Ne[We]}),ua((0,C.Z)((0,C.Z)({},me),{},{[ue.pageSize||bt.pageSize]:ue.pageSizeNum||we.pageSize,[ue.pageIndex||bt.pageIndex]:ue.pageIndexNum||we.current}))}}else if(Ne&&JSON.stringify(Ne)!=="{}"){var ye={};Object.keys(Ne).forEach(We=>{ye[We]=Ne[We]}),ua((0,C.Z)((0,C.Z)({},ye),{},{[bt.pageSize]:we.pageSize,[bt.pageIndex]:we.current}))}else ua({[bt.pageSize]:we.pageSize,[bt.pageIndex]:we.current})},[]);var ts=(0,M.useState)({}),as=(0,p.Z)(ts,2),Fa=as[0],Sa=as[1];(0,M.useEffect)(()=>{var me;if(typeof Ze=="boolean")Ze?me=(0,C.Z)((0,C.Z)({},V.XE.INITIAL_PAGINATION),we):me=!1;else if(typeof Ze=="object")me=(0,C.Z)((0,C.Z)({},Ze),we);else return Error("pagination param is not correct");Va(me)},[Ze,we]),(0,M.useImperativeHandle)(x,()=>({load:me=>{var ye=we.pageSize;ue&&JSON.stringify(ue)!=="{}"&&ue.pageSizeNum&&(ye=ue.pageSizeNum),rt((0,C.Z)((0,C.Z)({},we),{},{pageSize:ye,current:1})),ua(We=>(0,C.Z)((0,C.Z)((0,C.Z)({},We),me),{},{[bt.pageIndex]:1}))},clear:()=>{Be([]),rt((0,C.Z)((0,C.Z)({},we),{},{current:1,total:0}))},getDataList:()=>je,getColumns:()=>Ae.current?Ae.current.getColumns():Ne,getTotal:()=>Wt})),(0,M.useEffect)(()=>{!Fe&&je.length&&S.onChangeData&&S.onChangeData()},[Fe,je]);var us=(me,ye,We)=>{var ze={};for(var qe in ye)if(Object.prototype.hasOwnProperty.call(ye,qe)){var Tt=ye[qe]?ye[qe].join(","):"";ze[qe]=Tt==="all"?"":Tt}if(Le)ze=(0,C.Z)((0,C.Z)({},ze),Le(We));else for(var Ct in We)Object.prototype.hasOwnProperty.call(We,Ct)&&(ze[Ct]=We[Ct]);Sa(ye||{}),rt((0,C.Z)((0,C.Z)({},we),{},{pageSize:me.pageSize,current:me.current})),ua(Vt=>(0,C.Z)((0,C.Z)({},Vt),{},{[bt.pageSize]:me.pageSize,[bt.pageIndex]:me.current},ze))};(0,M.useEffect)(()=>{var me=[];ie.columns.forEach(ye=>{ye.key==="operate"?me.push((0,C.Z)((0,C.Z)({dataIndex:ye.key},ye),{},{render:(We,ze)=>La(ye,ze)})):(0,Q.oL)(ye.filters)==="array"&&ye.filters.length>0?me.push((0,C.Z)({filteredValue:Fa[ye.key]||[ye.filters[0].value],dataIndex:ye.key},ye)):me.push((0,C.Z)({dataIndex:ye.key},ye))}),q(me)},[La,ie.columns,ja]),(0,M.useEffect)(()=>{Pe(!0),JSON.stringify(ja)!=="{}"&&Ds(ja)},[ja]);var Ds=me=>{ie.query(me).then(ye=>{Pe(!1),ye.data.code&&+ye.data.code==2e5?(Be(ye.data.data.list||[]),pa(ye.data.data.total*1),rt((0,C.Z)((0,C.Z)({},we),{},{total:ye.data.data.total*1})),ae(!0),typeof ie.successBack=="function"&&ie.successBack(ye.data.data),Te&&Te(ye.data)):(Be([]),rt((0,C.Z)((0,C.Z)({},we),{},{total:0})))}).catch(ye=>{ye.code==="503014"&&Ee&&(y.default.warning(U("component.dataLoadingTip")),setTimeout(()=>{Ds(me)},2e3))})},Za=(me,ye)=>{var We=!1;switch(typeof me.disabled){case"function":We=me.disabled(ye);break;case"boolean":We=me.disabled;break;default:We=!1;break}return We},ga=(me,ye,We)=>typeof ye.tooltips=="object"?ye.tooltips.normal&&!We?v().createElement(K.Z,{placement:"top",title:ye.tooltips.normal},me):ye.tooltips.disable&&We?v().createElement(K.Z,{placement:"top",title:ye.tooltips.disable},me):me:me,Ga=(0,M.useCallback)((me,ye)=>me.filter(We=>{var ze=We.checkAuth||!1;return ze?(0,z.H3)(We.key,Ve)||ye.creatorId===w||k:!0}),[Ve,k,w]),La=(0,M.useCallback)((me,ye)=>{var We=h()(me.buttons),ze=We.filter(fe=>typeof fe.visible=="function"?fe.visible(ye):fe),qe=me.visibleNum||1;qe>2&&(qe=2);var Tt=[],Ct=[];ze.length>0&&(Ct=[...ze.slice(0,qe)],Tt=[...ze.slice(qe)]);var Vt=[],ht=[];if(Vt=Ga(Ct,ye),ht=Ga(Tt,ye),Vt.length!==Ct.length){var re=Ct.length-Vt.length;Vt=[...Vt,...ht.slice(0,re)],ht=[...ht.slice(re)]}return v().createElement("div",{className:"cl-table__cell-action"},Vt.length?Vt.map((fe,pe)=>{var ee=Za(fe,ye);return fe.render?fe.render(ye):ga(v().createElement(v().Fragment,null,v().createElement("a",{key:pe,className:"cl-table_cell-list ".concat(m().cl_pointer_btn," ").concat(ee?"table_disable_cell_list ".concat(m().operate_btn_disabled):""," "),onClick:()=>Ue({item:fe,record:ye},ee)},fe.name),ht.length>0&&v().createElement("span",{className:m().cl_pointer_divide})),fe,ee)}):null,ht.length?ht.length>1?v().createElement(o.Z,{overlay:ke(ht,ye)},v().createElement("span",{className:m().cl_pointer_btn,style:{color:he}},U("common.more"),v().createElement(l.Z,null))):fa(ht[0],ye):null)},[ke,Ue,Ga,fa,U]),fa=(0,M.useCallback)((me,ye)=>{var We=Za(me,ye);return me.render?me.render(ye):ga(v().createElement("a",{key:me.key,className:"cl-table_cell-list ".concat(m().cl_pointer_btn," ").concat(We?"table_disable_cell_list ".concat(m().operate_btn_disabled):""," "),onClick:()=>Ue({item:me,record:ye},We)},me.name),me,We)},[Ue]),ke=(0,M.useCallback)((me,ye)=>v().createElement(a.Z,null,me.map((We,ze)=>{var qe=Za(We,ye);return We.render?We.render(ye):v().createElement(a.Z.Item,{key:ze,disabled:qe,onClick:()=>Ue({item:We,record:ye},qe)},ga(v().createElement("span",null,We.name),We,qe))})),[Ue]),Ue=(0,M.useCallback)((me,ye)=>{var We=me.item,ze=me.record;ye||(ie.operateHandles&&ie.operateHandles({type:We.key,record:ze}),We.handleClick&&We.handleClick(ze))},[ie]),De=X?"59px":"219px",oe=()=>_e?v().createElement("div",null,_e.selectedRowKeys&&_e.selectedRowKeys.length&&le?v().createElement("div",{className:m()["table-extra"],style:{left:De,width:"calc(100% - ".concat(De,")")}},v().createElement("span",{className:"table-selected-count"},U("component.selected"),_e.selectedRowKeys.length,U("component.itemUnit")),v().createElement("div",{className:"table-extra-action"},le())):null):null,xe=ce?E.Z:G.f;return v().createElement("div",{className:te?"":m()["pagination-config"]},v().createElement(xe,(0,O.Z)({ref:Ae,rowSelection:_e,style:{"margin-bottom":_e?"20px":"0"},dataSource:je,columns:ut,scroll:{x:"max-content"},pagination:Qt,loading:Fe,toolBarRender:j,headerTitle:R,request:function(){var me=(0,g.Z)(I().mark(function ye(We,ze,qe){return I().wrap(function(Ct){for(;;)switch(Ct.prev=Ct.next){case 0:ve==="interactiveVideo"&&qe&&ie&&Array.isArray(ie.columns)&&ie.columns.length>1&&qe.type===null&&ie.columns[1].key==="type"&&(qe.type=[ie.columns[1].filters[0].value]),us(We,qe,ze);case 2:case"end":return Ct.stop()}},ye)}));return function(ye,We,ze){return me.apply(this,arguments)}}(),tableUUID:H},be)),oe())}),W=S=>{var x=S.user,U=S.sideBar,L=S.advancedSetting;return{userId:x.id||window.localStorage.getItem("uid"),isAdmin:x.isAdmin,modules:x.modules,collapsed:U.collapsed,themeColor:L.themeColor}};Se.Z=(0,d.$j)(W,null,null,{forwardRef:!0})((0,A.Z)("translation",{withRef:!0})($))},74262:function(gt,Se,e){"use strict";e.d(Se,{Z:function(){return Xt}});var O=e(71194),g=e(57016),b=e(62029),a=e(13062),T=e(71230),o=e(89032),D=e(15746),K=e(88986),P=e(22385),y=e(31097),C=e(57663),p=e(71577),B=e(34792),c=e(48086),I=e(57361),M=e(18106),v=e(88108),A=e(9754),d=e.n(A),l=e(12924),t=e.n(l),h=e(28216),F=e(91768),m=e(17829),E=e(40938),Q=e(84874),G=e(81211),V=e(34669),z=e(82833),$=e(94184),W=e.n($),S=e(6793),x=e(37055),U=e(65202);class L extends t().Component{constructor(){super(...arguments);this.dealName=Fe=>{var Pe="",Ie=Fe.split(".");return Ie[0].length>50?Pe="".concat(Ie[0].slice(0,50),".").concat(Ie[1]):Pe=Fe,Pe},this.renderInner=()=>{var Fe=this.props,Pe=Fe.prefixCls,Ie=Fe.file,$e=Ie.name,te=Ie.process,ae=Ie.uploadedSize,Re=Ie.size,de=(0,U.p)(),we="".concat(Pe,"__inner");return t().createElement("div",{className:we},t().createElement("div",{className:"".concat(we,"__top")},this.renderTypeIcon(),t().createElement("span",{className:"".concat(we,"__name")},this.dealName($e)),t().createElement("span",{className:"".concat(we,"__size")},"\uFF08",(0,S.sS)(ae),"/",(0,S.sS)(Re),"\uFF09"),te!==100&&t().createElement("span",{className:"".concat(we,"__progress")},t().createElement(z.Z,{strokeColor:de,percent:te,format:rt=>"".concat(rt,"%")})),this.renderRightInfo()),t().createElement("div",{className:"".concat(we,"__bottom")},this.renderErrorMsg()))},this.renderTypeIcon=()=>{var Fe=this.props,Pe=Fe.prefixCls,Ie=Fe.file,$e="".concat(Pe,"__inner__type"),te=Ie.name.split(".").pop().toLowerCase(),ae=(0,K.Z)({},x.e1),Re={html:"html",scorm:"scorm"}[Ie.contentType]||te;return t().createElement("span",{className:$e},t().createElement(Q.Z,{iconClass:ae[Re],size:"20px"}))},this.renderRightInfo=()=>{var Fe=this.props,Pe=Fe.prefixCls,Ie=Fe.file,$e=Ie.status,te="".concat(Pe,"__inner__info");return t().createElement("div",{className:te},t().createElement("span",{className:"".concat(te,"__status ").concat(te,"__status-").concat($e)},this.renderRestart(),this.renderAction()))},this.renderErrorMsg=()=>{var Fe=this.props,Pe=Fe.prefixCls,Ie=Fe.file,$e=Fe.t,te=Ie.isError,ae="".concat(Pe,"__inner__bottom");return te?t().createElement("span",{className:"".concat(ae,"__errmsg")},t().createElement(Q.Z,{iconClass:"icon-f-attention"}),$e("component.uploadFailed")):null},this.handleRestart=()=>{var Fe=this.props,Pe=Fe.file,Ie=Fe.onRestart;(0,S.Ds)(()=>Ie(Pe),500)()},this.renderRestart=()=>{var Fe=this.props,Pe=Fe.file,Ie=Fe.t,$e=Pe.isError;return $e?t().createElement("span",{className:"restart",onClick:this.handleRestart},Ie("component.reUpload")):null},this.handleStop=()=>{var Fe=this.props,Pe=Fe.file,Ie=Fe.onStop;(0,S.Ds)(()=>Ie(Pe),500)()},this.renderAction=()=>{var Fe=(0,U.p)(),Pe=this.props,Ie=Pe.file,$e=Pe.t,te=Ie.process,ae=Ie.isError,Re=Ie.isDoc,de=Ie.isCanceling,we=Ie.isLoading,rt=Ie.status;return we?t().createElement("span",{className:"unzip-going",style:{color:Fe}},$e("upload.unzipTip")):rt==="success"?t().createElement("span",{className:"success"},t().createElement(Q.Z,{iconClass:"icon-f-ok",style:{color:Fe}})):Re?null:de?t().createElement("span",{className:"spinner"},t().createElement(Q.Z,{iconClass:"icon-loading-xs"})):te!==100||ae?t().createElement("span",{className:"close",style:{color:Fe},onClick:this.handleStop},$e("common.delete")):null}}render(){var Fe=this.props,Pe=Fe.prefixCls,Ie=Fe.file,$e=Ie.isError,te=Ie.status,ae=W()(["".concat(Pe),"".concat(Pe,"-").concat(te),$e?"".concat(Pe,"-error"):""]);return t().createElement("section",{className:ae},this.renderInner())}}L.defaultProps={prefixCls:"cl-new-uploads_up_item",file:{},onStop:()=>{},onRestart:()=>{}};var w=(0,F.Z)()(L),k=Et=>{var Fe=Et.prefixCls,Pe=Et.list,Ie=Pe===void 0?[]:Pe,$e=(0,G.Z)(Et,["prefixCls","list"]);return t().createElement("div",{className:Fe},Ie.map(te=>t().createElement(w,(0,b.Z)({key:te.id},$e,{file:te}))))};k.defaultProps={prefixCls:"cl-new-uploads_map",list:[]};var ne=k,ie=e(43967),Ne=e(38642);class ue extends t().Component{constructor(){var Fe;super(...arguments);Fe=this,this.state={list:[],blackList:{uploadHtmlTip:(0,Ne.eY)("NEW_UPLOAD_BUTTON_HTML_TIP"),uploadScormTip:(0,Ne.eY)("NEW_UPLOAD_BUTTON_SCORM_TIP")}},this.resetUploader=(Pe,Ie)=>{var $e=this.props,te=$e.list,ae=$e.t,Re=$e.onClearList,de=(0,ie.Y5)(te),we={changeFolder:ae("privateCloud.folder"),changeStorage:ae("privateCloud.storage"),close:ae("privateCloud.close")};te.length!==0?g.Z.confirm({title:ae("upload.tip"),content:(0,S.ZT)(ae("upload.switchTips"),we[Pe]),cancelText:ae("upload.cancel"),okText:ae("upload.ok"),onOk:()=>{Pe==="changeFolder"?this.handleClearList(de):this.props.dispatch({type:"uploader/destroyUploader"}),this.setState({list:[]}),Re&&Re(),Ie&&Ie()},onCancel:()=>{}}):(Pe==="changeFolder"?this.handleClearList():this.props.dispatch({type:"uploader/destroyUploader"}),Ie&&Ie())},this.handleClearList=function(){var Pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Pe.length>0&&Fe.props.dispatch({type:"uploader/stopUpladerProcess"}),Fe.props.dispatch({type:"uploader/resetProperty",payload:{queues:{},list:[],showWrapper:!1,isMinimized:!1,successItemArray:[]}})},this.handleStop=Pe=>{var Ie=Pe.status,$e=Pe.id,te=this.props,ae=te.dispatch,Re=te.t;Ie==="error"?ae({type:"uploader/removeListItemById",payload:{fileId:$e}}):g.Z.confirm({content:Re("localStorage.deleteUploadTip"),okText:Re("common.ok"),cancelText:Re("common.cancel"),onOk:()=>{ae({type:"uploader/stopUploadFile",payload:{file:Pe}})},onCancel:()=>{}})},this.handleRestart=Pe=>{var Ie=this.props,$e=Ie.hasZip,te=Ie.notLibrary,ae={html:"html",scorm:"scorm"}[Pe.contentType]||"other";this.props.dispatch({type:"uploader/deleteUploadFile",payload:{fileId:Pe.id}}),this.props.dispatch({type:"uploader/chooseFiles",payload:{choosedFiles:[Pe],isUpdate:!0,discriminate:ae,dispatch:this.props.dispatch,hasZip:$e==="true",notLibrary:te,open:!1}})},this.handleChooseFiles=(Pe,Ie)=>{var $e=Pe.target.files;this.dealFiles($e,Ie),Pe.target.value=null,Pe.target.files=null},this.dealFiles=(Pe,Ie)=>{var $e=this.props,te=$e.limit,ae=te===void 0?5:te,Re=$e.hasZip,de=$e.notLibrary,we=this.state.list,rt=(0,ie.Y5)(this.props.list);ae>0&&we.length+Pe.length+rt.length>ae?c.default.warning(this.props.t("course.courseCreateLimitTip")):this.props.dispatch({type:"uploader/chooseFiles",payload:{choosedFiles:Pe,discriminate:Ie,dispatch:this.props.dispatch,hasZip:Re==="true",notLibrary:de,open:!1}})},this.renderUpload=()=>{var Pe=this.props,Ie=Pe.prefixCls,$e=Pe.t,te=Pe.hasZip,ae=Pe.storageType,Re=this.state.blackList,de=ae==="ALIBABA_PRIVATE"?"".concat(Ie,"_uploadButton_all_disabled"):"";return t().createElement("div",{id:"drop_area",className:"".concat(Ie,"_uploadButton")},t().createElement("div",{className:"".concat(Ie,"_uploadButton_all")},t().createElement("div",{className:"".concat(Ie,"_uploadButton_all_left")},t().createElement("img",{src:"".concat("https://oss.coolcollege.cn","/1800732990851125248.png"),alt:"knowledge"})),t().createElement("div",{className:"".concat(Ie,"_uploadButton_all_right")},t().createElement("p",{className:"".concat(Ie,"_uploadButton_all_right_title")},$e("upload.uploadKnow")),t().createElement("p",{className:"".concat(Ie,"_uploadButton_all_right_content")},$e(te==="true"?"upload.uploadKnowTip":"upload.uploadKnowAno"))),t().createElement("input",{className:"".concat(Ie,"_uploadButton_input"),title:"",multiple:!0,type:"file",onChange:we=>this.handleChooseFiles(we,"other")})),Re.uploadHtmlTip?t().createElement("div",{className:"".concat(Ie,"_uploadButton_all ").concat(de)},t().createElement("div",{className:"".concat(Ie,"_uploadButton_all_left")},t().createElement("img",{src:"".concat("https://oss.coolcollege.cn","/1800733000502218752.png"),alt:"knowledge"})),t().createElement("div",{className:"".concat(Ie,"_uploadButton_all_right")},t().createElement("p",{className:"".concat(Ie,"_uploadButton_all_right_title")},$e("upload.importHTML")),t().createElement("p",{className:"".concat(Ie,"_uploadButton_all_right_content")},$e("upload.importHTMLTip"))),t().createElement("input",{className:"".concat(Ie,"_uploadButton_input"),title:"",accept:".zip",multiple:!0,type:"file",onChange:we=>this.handleChooseFiles(we,"html"),disabled:ae==="ALIBABA_PRIVATE"})):null,Re.uploadScormTip?t().createElement("div",{className:"".concat(Ie,"_uploadButton_all ").concat(de)},t().createElement("div",{className:"".concat(Ie,"_uploadButton_all_left")},t().createElement("img",{src:"".concat("https://oss.coolcollege.cn","/1800733005405360128.png"),alt:"knowledge"})),t().createElement("div",{className:"".concat(Ie,"_uploadButton_all_right")},t().createElement("p",{className:"".concat(Ie,"_uploadButton_all_right_title")},$e("upload.importScorm")),t().createElement("p",{className:"".concat(Ie,"_uploadButton_all_right_content")},$e("upload.importHTMLTip"))),t().createElement("input",{className:"".concat(Ie,"_uploadButton_input"),title:"",accept:".zip",multiple:!0,type:"file",onChange:we=>this.handleChooseFiles(we,"scorm"),disabled:ae==="ALIBABA_PRIVATE"})):null)},this.renderTip=()=>{var Pe=this.props,Ie=Pe.prefixCls,$e=Pe.t,te=Pe.hasZip;return t().createElement("div",{className:"".concat(Ie,"_tip")},t().createElement("span",{className:"".concat(Ie,"_tip_desc")},$e("upload.uploadLimit")),t().createElement(E.Z.Tooltip,{hasZip:te==="true"},t().createElement(Q.Z,{iconClass:"icon-shuoming",size:"16px",color:"rgba(0, 0, 0, 0.25)"})))}}UNSAFE_componentWillReceiveProps(Fe){if((0,ie.Of)(Fe,this.props)){var Pe=this.state,Ie=[...Pe.list,Fe.uploadSucceedItem];Ie[0].isOpened=!0,this.setState({list:Ie})}}componentWillUnmount(){this.props.dispatch({type:"uploader/destroyUploader"})}render(){var Fe=this.props.prefixCls;return t().createElement("div",{className:Fe},this.renderTip(),this.renderUpload(),t().createElement(ne,(0,b.Z)({},this.props,{onStop:this.handleStop,onRestart:this.handleRestart})))}}ue.defaultProps={prefixCls:"cl-new-uploads",list:[],params:{classifyId:0,bizType:0}};var _e=(0,F.Z)("translation",{withRef:!0})(ue),Ze=e(84391);class j extends t().Component{constructor(){super(...arguments);this.dealName=Fe=>{var Pe="",Ie=Fe.split(".");return Ie[0].length>50?Pe="".concat(Ie[0].slice(0,50),".").concat(Ie[1]):Pe=Fe,Pe},this.renderInner=()=>{var Fe=this.props,Pe=Fe.prefixCls,Ie=Fe.file,$e=Ie.name,te=Ie.process,ae=Ie.uploadedSize,Re=Ie.size,de=(0,U.p)(),we="".concat(Pe,"__inner");return t().createElement("div",{className:we},t().createElement("div",{className:"".concat(we,"__top")},this.renderTypeIcon(),t().createElement("span",{className:"".concat(we,"__name")},this.dealName($e)),t().createElement("span",{className:"".concat(we,"__size")},"\uFF08",(0,S.sS)(ae),"/",(0,S.sS)(Re),"\uFF09"),te!==100&&t().createElement("span",{className:"".concat(we,"__progress")},t().createElement(z.Z,{strokeColor:de,percent:te,format:rt=>"".concat(rt,"%")})),this.renderRightInfo()),t().createElement("div",{className:"".concat(we,"__bottom")},this.renderErrorMsg()))},this.renderTypeIcon=()=>{var Fe=this.props,Pe=Fe.prefixCls,Ie=Fe.file,$e="".concat(Pe,"__inner__type"),te=Ie.name.split(".").pop().toLowerCase(),ae=(0,K.Z)({},x.e1);return t().createElement("span",{className:$e},t().createElement(Q.Z,{iconClass:ae[te],size:"20px"}))},this.renderRightInfo=()=>{var Fe=this.props,Pe=Fe.prefixCls,Ie=Fe.file,$e=Ie.status,te="".concat(Pe,"__inner__info");return t().createElement("div",{className:te},t().createElement("span",{className:"".concat(te,"__status ").concat(te,"__status-").concat($e)},this.renderAction()))},this.renderErrorMsg=()=>{var Fe=this.props,Pe=Fe.prefixCls,Ie=Fe.file,$e=Fe.t,te=Ie.isError,ae="".concat(Pe,"__inner__bottom");return te?t().createElement("span",{className:"".concat(ae,"__errmsg")},t().createElement(Q.Z,{iconClass:"icon-f-attention"}),$e("component.uploadFailed")):null},this.renderAction=()=>{var Fe=(0,U.p)(),Pe=this.props,Ie=Pe.file,$e=Pe.onRemove,te=Pe.t,ae=Ie.process,Re=Ie.isError,de=Ie.status;return de==="success"?t().createElement("span",{className:"success"},t().createElement(Q.Z,{iconClass:"icon-f-ok",style:{color:Fe}})):ae!==100||Re?t().createElement("span",{className:"close",style:{color:Fe},onClick:()=>$e(Ie)},te("common.delete")):null}}render(){var Fe=this.props,Pe=Fe.prefixCls,Ie=Fe.file,$e=Ie.isError,te=Ie.status,ae=W()(["".concat(Pe),"".concat(Pe,"-").concat(te),$e?"".concat(Pe,"-error"):""]);return t().createElement("section",{className:ae},this.renderInner())}}j.defaultProps={prefixCls:"cl-local-uploads_up_item",file:{},onRemove:()=>{}};var R=(0,F.Z)()(j),le=Et=>{var Fe=Et.fileList;return t().createElement("ul",{className:"local-upload-list"},Fe.map(Pe=>t().createElement(R,(0,b.Z)({key:Pe.id},Et,{file:Pe}))))},H=(0,F.Z)()(le),X=e(33565),ce=Et=>{var Fe=Et.onFile,Pe=Et.children,Ie=Et.themeColor,$e=(0,l.useState)(!1),te=(0,X.Z)($e,2),ae=te[0],Re=te[1],de=W()("local-uploader-dragger",{"is-dragover":ae}),we=mt=>{mt.preventDefault(),Re(!1),Fe(mt.dataTransfer.files)},rt=(mt,Zt)=>{mt.preventDefault(),Re(Zt)};return t().createElement("div",{className:de,style:{border:"1px dashed ".concat(Ie)},onDragOver:mt=>{rt(mt,!0)},onDragLeave:mt=>{rt(mt,!1)},onDrop:we},Pe)},Te=ce,Le=Et=>{var Fe=Et.t;return t().createElement("div",{className:"cl--local-uploader__tooltips__text"},t().createElement("p",{className:"title"},Fe("component.uploadTypeTitle"),":"),t().createElement("p",{className:"text"},Fe("common.video"),": 3gp\u3001asf\u3001 avi\u3001 dat\u3001 dv\u3001 flv\u3001 f4v\u3001 m2t\u3001 m3u8\u3001 m4v\u3001 mj2\u3001 mjpeg\u3001 mkv\u3001 mov\u3001 mp4\u3001 mpe\u3001 mpg\u3001 mpeg\u3001 mts\u3001 qt\u3001 rm\u3001 rmvb\u3001 swf\u3001 ts\u3001 vob\u3001 wmv\u3001 webm"),t().createElement("p",{className:"text"},Fe("common.audio"),": aac\u3001 ac3\u3001 acm\u3001 amr\u3001 ape\u3001 caf\u3001 flac\u3001 m4a\u3001 mp3\u3001 ra\u3001 wav\u3001 wma\u3001 ogg"),t().createElement("p",{className:"text"},Fe("common.doc"),": pdf\u3001doc\u3001docx\u3001xls\u3001xlsx \u3001ppt\u3001pptx"),t().createElement("p",{className:"text"},Fe("common.image"),": jpg\u3001jpeg\u3001png"),t().createElement("br",null),t().createElement("p",{className:"title"},Fe("component.tipAndDesc"),":"),t().createElement("p",{className:"text"},"1. ",Fe("component.videoLimitTip"),"\uFF1B",Fe("component.audioLimitTip"),"\uFF1B",Fe("component.docLimitTip"),"\uFF1B",Fe("component.imageLimitTip"),"\uFF1B"),t().createElement("p",{className:"text"},"2. ",Fe("component.uploadTipTwo")),t().createElement("p",{className:"text"},"3. ",Fe("component.uploadTipThree")))},he={position:"relative",zIndex:3,marginLeft:"5px"},Ee=Et=>t().createElement("div",{onClick:Fe=>{Fe.stopPropagation()}},t().createElement(y.Z,(0,b.Z)({overlayClassName:"cl-local-uploader__tooltips",placement:"bottom",title:Le({t:Et.t})},Et),t().createElement("span",{style:he},t().createElement(Q.Z,{iconClass:"icon-shuoming",color:"#D1D2D6",size:"14px"})))),ve=(0,F.Z)()(Ee);function be(Et){var Fe=Et.localList,Pe=Et.t,Ie=Et.onStart,$e=Et.onRemove,te=(0,l.useRef)(null),ae=(0,U.p)(),Re=mt=>{Ie(mt)},de=()=>{te.current&&te.current.click()},we=mt=>{var Zt=mt.target.files;!Zt||(Re(Zt),te.current&&(te.current.value=""))},rt=mt=>{Re(mt)};return t().createElement("div",{className:"local-upload-component"},t().createElement("div",{className:"local-upload-input",onClick:de},t().createElement(Te,{themeColor:ae,onFile:mt=>{rt(mt)}},t().createElement("div",{className:"ant-upload-drag-icon"},t().createElement("div",{className:"ant-upload-drag-icon-box"},t().createElement(Ze.Z,{className:"ant-upload-drag-icon-upload",style:{color:ae}}))),t().createElement("p",{className:"ant-upload-text",style:{color:ae}},Pe("localStorage.handleUpload")),t().createElement("p",{className:"ant-upload-hint"},t().createElement("span",null,Pe("localStorage.supportFormat"),".mp3 .mp4 .doc .pdf .ppt..."),t().createElement(ve,null)))),t().createElement("input",{className:"local-file-input",style:{display:"none"},ref:te,type:"file",onChange:we,multiple:!0}),t().createElement(H,{themeColor:ae,fileList:Fe,onRemove:$e}))}be.defaultProps={name:"file"};var Ve=(0,F.Z)()(be),Ae=(Et,Fe)=>{var Pe=Et.classifyId,Ie=Et.bizType,$e=Ie===void 0?0:Ie,te=Fe.classifyId,ae=Fe.bizType;return Pe!==te||$e!==ae};class at extends t().Component{constructor(){super(...arguments);this.handleRemove=Fe=>{var Pe=Fe.status,Ie=Fe.id,$e=this.props,te=$e.dispatch,ae=$e.t;if(Pe==="error")te({type:"localUploader/removeListItemById",payload:{fileId:Ie}});else{var Re=ae(Pe==="success"?"localStorage.deleteUploadTip":"localStorage.cancelUploadTip");g.Z.confirm({content:Re,okText:ae("common.ok"),cancelText:ae("common.cancel"),onOk:()=>{Pe==="success"?(te({type:"localUploader/deleteResource",payload:{fileId:Ie}}),te({type:"localUploader/removeListItemById",payload:{fileId:Ie}})):(te({type:"localUploader/stopUploadFile",payload:{fileId:Ie}}),te({type:"localUploader/removeListItemById",payload:{fileId:Ie}}))}})}},this.handleStop=Fe=>{this.props.dispatch({type:"localUploader/stopUploadFile",payload:{fileId:Fe.id}})},this.handleChooseFiles=Fe=>{var Pe=this.props.localList;Fe.length+Pe.length>5?c.default.warning(this.props.t("course.courseCreateLimitTip")):this.props.dispatch({type:"localUploader/chooseFiles",payload:{choosedFiles:Fe,dispatch:this.props.dispatch}})},this.resetUploader=(Fe,Pe)=>{var Ie=this.props,$e=Ie.localList,te=Ie.t,ae={changeFolder:te("privateCloud.folder"),changeStorage:te("privateCloud.storage"),close:te("privateCloud.close")};$e.length!==0?g.Z.confirm({title:te("upload.tip"),content:(0,S.ZT)(te("upload.switchTips"),ae[Fe]),cancelText:te("upload.cancel"),okText:te("upload.ok"),onOk:()=>{Fe==="changeFolder"?this.props.dispatch({type:"localUploader/resetUploadList"}):this.props.dispatch({type:"localUploader/destroyUploader"}),Pe&&Pe()}}):(Fe==="changeFolder"?this.props.dispatch({type:"localUploader/resetUploadList"}):this.props.dispatch({type:"localUploader/destroyUploader"}),Pe&&Pe())}}componentWillUnmount(){this.props.dispatch({type:"localUploader/destroyUploader"})}render(){var Fe=this.props.prefixCls;return t().createElement("div",{className:Fe},t().createElement(Ve,(0,b.Z)({},this.props,{onStart:this.handleChooseFiles,onRemove:this.handleRemove})))}}at.defaultProps={prefixCls:"cl-new-uploads",list:[],params:{classifyId:0,bizType:0}};var et=(0,F.Z)("translation",{withRef:!0})(at),ut=e(10237);function q(Et){var Fe=x.ZP.LibraryList.addFolder();return ut.qg.post({url:Fe,data:Et})}var Oe=Et=>{var Fe=x.ZP.localStorage.getStorage();return ut.WY.get({url:Fe,params:Et})},Je=e(32407),je=e(86726),Be=e(79096),St=e(1164),Lt=v.Z.TabPane,Wt=Et=>({successItemArray:Et.uploader.successItemArray,list:Et.uploader.list,userInfo:Et.user,localList:Et.localUploader.list,localSucceedList:Et.localUploader.updateSucceedList});class pa extends l.Component{constructor(){var Fe;super(...arguments);Fe=this,this.state={visible:!1,allowActions:(0,je.V9)("library",this.props.userInfo.modules),relation:{width:950,centered:!0,maskClosable:!1,destroyOnClose:!0,bodyStyle:{padding:0,height:"480px"}},addFolderProps:{id:"",title:this.props.t("resourceLibrary.newFolder"),initialParams:{title:"",employeeRange:{rangeType:3,rangeList:{dept:[],post:[],group:[],user:[]}}},labelTxt:this.props.t("resourceLibrary.folderName"),visible:!1,canSetVisible:!1,parentId:this.props.classifyId},isRootDirectory:!0,nowKey:"0",storage:[{id:"0",name:this.props.t("localStorage.commonStorage"),storageType:"PUBLIC_CLOUD"}],activeStorageId:"0",transformStorage:{"0":{id:"0",name:this.props.t("localStorage.commonStorage"),storageType:"PUBLIC_CLOUD"}},nowTitle:this.props.t("common.all")},this.prefixCls="cl-new-upload",this.componentDidUpdate=Pe=>{if(Pe.visible!==this.props.visible&&this.props.visible){if(this.props.activeStorageId&&this.setState({activeStorageId:this.props.activeStorageId}),this.props.defaultFolder){var Ie=this.props.defaultFolder;this.setState({nowKey:Ie.value,nowTitle:Ie.name},()=>{this.handleInitUploadParams()})}this.initUploader()}},this.getStorage=(0,I.Z)(d().mark(function Pe(){var Ie,$e,te,ae;return d().wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return Ie=Fe.props.isAllowLocal,$e={storage_type:"ALIBABA_PRIVATE"},(Ie||window.OnlyShowLocalStorage)&&($e.storage_type=null),de.next=5,Oe($e);case 5:te=de.sent,ae=te.data,ae.code===0&&(window.OnlyShowLocalStorage?Fe.handleLocalStorageTab(ae.data):Fe.handleStorageTab(ae.data));case 8:case"end":return de.stop()}},Pe)})),this.handleLocalStorageTab=Pe=>{var Ie=this.state.activeStorageId,$e=Pe.filter(we=>we.status&&we.storageType==="LOCAL"),te=[...$e],ae=te.findIndex(we=>we.storageType==="ALIBABA_PRIVATE"&&we.isDefault);if(ae>-1){Ie=$e[ae].id;var Re=te.splice(ae,1);te=[...Re,...te]}else te=[...te],Ie=window.OnlyShowLocalStorage?te[0].id:Ie;var de={};te.forEach(we=>{de[we.id]=we}),this.setState({storage:te,activeStorageId:this.props.activeStorageId||Ie,transformStorage:de},()=>{this.initUploader()})},this.handleStorageTab=Pe=>{var Ie=this.state,$e=Ie.storage,te=Ie.activeStorageId,ae=Pe.filter(mt=>mt.status),Re=[...ae],de=Re.findIndex(mt=>mt.storageType==="ALIBABA_PRIVATE"&&mt.isDefault);if(de>-1){te=ae[de].id;var we=Re.splice(de,1);Re=[...we,...$e,...Re]}else Re=[...$e,...Re];var rt={};Re.forEach(mt=>{rt[mt.id]=mt}),this.setState({storage:Re,activeStorageId:this.props.activeStorageId||te,transformStorage:rt},()=>{this.initUploader()})},this.initUploader=()=>{var Pe=this.state,Ie=Pe.transformStorage,$e=Pe.activeStorageId,te=Ie[$e]||{};te.storageType==="LOCAL"?this.props.dispatch({type:"localUploader/initUploader",payload:{localStorageInfo:{uploadAddress:"https://".concat(te.host,"/cms/upload"),privatization:te.id,storageName:te.name}}}):this.props.dispatch({type:"uploader/initUploader",payload:{dispatch:this.props.dispatch,storageType:{type:te.storageType,id:te.id}}})},this.handleInitUploadParams=()=>{var Pe=this.state,Ie=Pe.nowKey,$e=Pe.transformStorage,te=Pe.activeStorageId,ae={classifyId:Ie,bizType:0},Re=$e[te]||{};Re.storageType==="LOCAL"?this.props.dispatch({type:"localUploader/initSaveParams",payload:{params:ae}}):this.props.dispatch({type:"uploader/initSaveParams",payload:{params:ae}})},this.clearSuccessList=()=>{this.props.dispatch({type:"uploader/updateSucceedItemArray",payload:{successItemArray:[]}})},this.onSuccess=()=>{var Pe=this.state,Ie=Pe.transformStorage,$e=Pe.activeStorageId;Ie[$e].storageType==="LOCAL"?this.handleLocalSuccess():this.handleAliSuccess()},this.handleAliSuccess=()=>{var Pe=this.props,Ie=Pe.list,$e=Pe.t,te=Pe.onSuccess,ae=Pe.onOk,Re=Pe.successItemArray,de=(0,ie.d2)(Ie),we=(0,ie.Y5)(Ie);we.length>0?c.default.warn($e("upload.uploadFileTip")):de.length===0?c.default.warn($e("upload.uploadSuccess")):(te(Re),ae(Re))},this.handleLocalSuccess=()=>{var Pe=this.props,Ie=Pe.localList,$e=Pe.t,te=Pe.onSuccess,ae=Pe.onOk,Re=Pe.localSucceedList,de=(0,ie.d2)(Ie),we=(0,ie.Y5)(Ie);we.length>0?c.default.warn($e("upload.uploadFileTip")):de.length===0?c.default.warn($e("upload.uploadSuccess")):(te(Re),ae(Re))},this.handleSuccess=(0,S.E5)(()=>{this.onSuccess()},100),this.handleClose=()=>{var Pe=this.props,Ie=Pe.onCancel,$e=Pe.t,te=this.state,ae=te.transformStorage,Re=te.activeStorageId,de=()=>{this.setState({isRootDirectory:!0,nowKey:"0",nowTitle:$e("common.all")},()=>{Ie()})};ae[Re].storageType==="LOCAL"?this.localUpload.resetUploader("close",de):this.upload.resetUploader("close",de)},this.renderFooter=()=>{var Pe=this.props,Ie=Pe.t,$e=Pe.hasCancel,te=$e===void 0?!0:$e,ae=navigator.userAgent.toLocaleLowerCase();return t().createElement("div",{className:"".concat(this.prefixCls,"_button")},te&&t().createElement(p.Z,{type:"primary",onClick:this.handleClose,ghost:!0,className:"".concat(this.prefixCls,"_button_cancel")},Ie("common.cancel")),ae.indexOf("lark")===-1&&t().createElement(y.Z,{title:Ie("common.newWindowTip")},t().createElement(p.Z,{type:"primary",ghost:!0,onClick:this.handleJumpToManage},Ie("common.newWindow"))),t().createElement(p.Z,{type:"primary",onClick:this.handleSuccess},Ie("common.ok")))},this.handleJumpToManage=()=>{St.Z.targetTo({path:this.props.userInfo.AdminmenuFirstPath})},this.onChangeClassify=(Pe,Ie)=>{var $e=this.state.nowKey;if(Pe.eventKey!==$e){var te=this.state,ae=te.transformStorage,Re=te.activeStorageId,de=()=>{this.realChangeClassify(Pe,Ie)};ae[Re].storageType==="LOCAL"?this.localUpload.resetUploader("changeFolder",de):this.upload.resetUploader("changeFolder",de)}},this.realChangeClassify=Pe=>{this.setState({isRootDirectory:Pe.eventKey==="0",nowKey:Pe.eventKey,nowTitle:Pe.title},()=>{this.handleInitUploadParams()})},this.createUpload=Pe=>{this.upload=Pe},this.createLocalUpload=Pe=>{this.localUpload=Pe},this.createTree=Pe=>{this.tree=Pe},this.handleAddFolder=()=>{var Pe=this.state,Ie=Pe.allowActions,$e=Pe.isRootDirectory,te=(0,je.H3)("set_visible",Ie);this.setState(ae=>({addFolderProps:(0,K.Z)((0,K.Z)({},ae.addFolderProps),{},{initialParams:{title:"",employeeRange:{rangeType:3,rangeList:{dept:[],post:[],group:[],user:[]}}},canSetVisible:$e&&te,visible:!0})}))},this.handleCancelAddFolder=()=>{this.setState(Pe=>({addFolderProps:(0,K.Z)((0,K.Z)({},Pe.addFolderProps),{},{canSetVisible:!1,visible:!1,initialParams:{title:"",employeeRange:{rangeType:3,rangeList:{dept:[],post:[],group:[],user:[]}}}})}))},this.handleOkAddFolder=Pe=>{var Ie=this.state,$e=Ie.nowKey,te=Ie.activeStorageId,ae=(0,K.Z)({},Pe);te!=="0"&&(ae.privatization=te),q((0,K.Z)((0,K.Z)({},ae),{},{parentId:$e})).then(Re=>{var de=Re.data,we=de.code,rt=de.msg;c.default["".concat(we===0?"success":"warning")](rt),we===0&&this.tree.getTree(),this.handleCancelAddFolder()})},this.handleChangeTab=Pe=>{var Ie=this.state,$e=Ie.transformStorage,te=Ie.activeStorageId,ae=this.props.t,Re=()=>{this.setState({activeStorageId:Pe,isRootDirectory:!0,nowKey:"0",nowTitle:ae("common.all")},()=>{this.initUploader()})};$e[te].storageType==="LOCAL"?this.localUpload.resetUploader("changeStorage",Re):this.upload.resetUploader("changeStorage",Re)},this.renderBreadCrumbs=()=>{var Pe=this.props.t,Ie=this.state.nowTitle;return t().createElement("div",{className:"".concat(this.prefixCls,"_row_uploader_title")},t().createElement(T.Z,{className:"".concat(this.prefixCls,"_row")},t().createElement(D.Z,{className:"".concat(this.prefixCls,"_row_desc")},Pe("upload.savePosition"),"\uFF1A"),t().createElement(D.Z,{className:"".concat(this.prefixCls,"_breadcrumb")},Ie)))}}static getDerivedStateFromProps(Fe,Pe){if(Fe.visible!==Pe.visible){var Ie={};return Fe.visible&&(Ie.nowKey="0"),(0,K.Z)({visible:Fe.visible},Ie)}return null}componentDidMount(){this.getStorage()}render(){var Fe=this.state,Pe=Fe.visible,Ie=Fe.relation,$e=Fe.addFolderProps,te=Fe.nowKey,ae=Fe.storage,Re=Fe.activeStorageId,de=Fe.transformStorage,we=this.props,rt=we.footer,mt=we.t,Zt=(0,U.p)(),bt=de[Re]&&de[Re].storageType||"PUBLIC_CLOUD",Ft=(0,K.Z)((0,K.Z)((0,K.Z)({},Ie),this.props),{},{visible:Pe,storageType:bt});return t().createElement(g.Z,(0,b.Z)({footer:rt||this.renderFooter()},Ft,{onCancel:this.handleClose}),t().createElement(T.Z,{className:"".concat(this.prefixCls,"_row")},t().createElement(D.Z,{className:"".concat(this.prefixCls,"_row_tree")},t().createElement(v.Z,{defaultActiveKey:de[Re],className:"storage-tabs",onChange:this.handleChangeTab,activeKey:Re},ae.map(Ut=>t().createElement(Lt,{tab:Ut.name,key:Ut.id}))),t().createElement(m.Z,{privatization:Re==="0"?null:Re,controls:{selectedKeys:[te]},ref:this.createTree,onChangeClassify:this.onChangeClassify,showTotal:!1})),t().createElement(D.Z,{className:"".concat(this.prefixCls,"_row_uploader")},t().createElement("div",{className:"".concat(this.prefixCls,"_row_uploader_addfolder"),style:{color:Zt},onClick:()=>this.handleAddFolder()},mt("upload.newFolders")),this.renderBreadCrumbs(),(de[Re]&&de[Re].storageType)==="LOCAL"?t().createElement(et,(0,b.Z)({},Ft,{ref:this.createLocalUpload})):t().createElement(_e,(0,b.Z)({},Ft,{ref:this.createUpload})))),t().createElement(Be.Z,(0,b.Z)({},$e,{onCancel:this.handleCancelAddFolder,onCreate:this.handleOkAddFolder})))}}pa.defaultProps={visible:!1,title:Je.Z.t("common.storage"),onCancel:()=>{},onSuccess:()=>{},onOk:()=>{},params:{classifyId:0,bizType:0},notLibrary:!1,form:"",activeStorageId:"",isAllowLocal:!1};var Xt=(0,h.$j)(Wt)((0,F.Z)()(pa))},89560:function(gt,Se,e){"use strict";var O=e(62029),g=e(32157),b=e(75869),a=e(12924),T=e.n(a),o=e(84874),D=e(25547),K=b.Z.TreeNode;class P extends T().Component{constructor(){super(...arguments);this.state={defaultExpandedKeys:[]},this.handleSelect=(C,p)=>{var B=p.node,c=B.props,I=c.eventKey,M=c.dataLable,v=c.children;this.props.onSelect({id:I,name:M,children:v})},this.renderTreeNodes=C=>C.map(p=>p.children?T().createElement(K,{key:p.id,dataRef:p,disabled:p.disabled||!1,title:this.renderTreeNodeTitle(p),dataLable:p.label},this.renderTreeNodes(p.children)):T().createElement(K,(0,O.Z)({key:p.id,title:this.renderTreeNodeTitle(p)},p,{dataRef:p,dataLable:p.label,disabled:p.disabled||!1}))),this.renderTreeNodeTitle=C=>{var p=this.props,B=p.prefixCls,c=p.renderIcon,I=c()||T().createElement("span",{className:"".concat(B,"__row__icon")},T().createElement(o.Z,{iconClass:"icon-icon_donex1"}));return T().createElement("span",{className:"".concat(B,"__row")},T().createElement("span",{className:"".concat(B,"__row__label"),title:C.label},C.label),I)}}static getDerivedStateFromProps(C,p){var B=C.list,c=C.selectedKeys,I=C.isRoot;if(!I){var M=p.defaultExpandedKeys;M.push((0,D.lK)(B,c[0]).parentId);var v=Array.from(new Set(M.filter(d=>d!==void 0)));return{defaultExpandedKeys:v}}var A=[0];return{defaultExpandedKeys:A}}render(){var C=this.props,p=C.prefixCls,B=C.list,c=C.selectedKeys,I=C.className,M=C.height,v=this.state.defaultExpandedKeys;return T().createElement("div",{className:"".concat(p," ").concat(I)},T().createElement(b.Z,{blockNode:!0,defaultExpandedKeys:v,height:M,selectedKeys:c,onSelect:this.handleSelect,loadData:this.props.loadData},this.renderTreeNodes(B)))}}P.defaultProps={prefixCls:"cl-tree",list:[],selectedKeys:[],renderIcon:()=>null,onSelect:()=>{}},Se.Z=P},77219:function(gt,Se,e){"use strict";var O=e(22385),g=e(31097),b=e(62029),a=e(12924),T=e.n(a),o=e(91768),D=e(84874),K=C=>{var p=C.t,B=C.hasZip;return T().createElement("div",{className:"cl-uploader__tooltips__text"},T().createElement("p",{className:"title"},p("component.uploadTypeTitle"),":"),T().createElement("p",{className:"text"},p("common.video"),": 3gp\u3001asf\u3001 avi\u3001 dat\u3001 dv\u3001 flv\u3001 f4v\u3001 m2t\u3001 m3u8\u3001 m4v\u3001 mj2\u3001 mjpeg\u3001 mkv\u3001 mov\u3001 mp4\u3001 mpe\u3001 mpg\u3001 mpeg\u3001 mts\u3001 qt\u3001 rm\u3001 rmvb\u3001 swf\u3001 ts\u3001 vob\u3001 wmv\u3001 webm"),T().createElement("p",{className:"text"},p("common.audio"),": aac\u3001 ac3\u3001 acm\u3001 amr\u3001 ape\u3001 caf\u3001 flac\u3001 m4a\u3001 mp3\u3001 ra\u3001 wav\u3001 wma\u3001 ogg"),T().createElement("p",{className:"text"},p("common.doc"),": pdf\u3001doc\u3001docx\u3001xls\u3001xlsx\u3001txt \u3001ppt\u3001pptx"),T().createElement("p",{className:"text"},p("common.image"),": jpg\u3001jpeg\u3001png"),T().createElement("p",{className:"text"},p("common.html"),": zip"),T().createElement("p",{className:"text"},"SCORM: zip"),B&&T().createElement("p",{className:"text"},p("common.zip"),": zip\u3001rar"),T().createElement("br",null),T().createElement("p",{className:"title"},p("component.tipAndDesc"),":"),T().createElement("p",{className:"text"},"1. ",p("component.videoLimitTip"),"\uFF1B",p("component.audioLimitTip"),"\uFF1B",p("component.docLimitTip"),"\uFF1B",p("component.imageLimitTip"),"\uFF1B",p("component.htmlLimitTip"),"\uFF1B",B?"".concat(p("component.zipLimitTip"),"\uFF1B"):""),T().createElement("p",{className:"text"},"2. ",p("component.uploadTipTwo")),T().createElement("p",{className:"text"},"3. ",p("component.uploadTipThree")),T().createElement("p",{className:"text"},"4. ",p("component.htmlTipFour")),T().createElement("p",{className:"text"},"5. ",p("upload.scormTip")))},P={position:"relative",zIndex:3,marginLeft:"5px"},y=C=>T().createElement(g.Z,(0,b.Z)({overlayClassName:"cl-uploader__tooltips",placement:"top",title:K({t:C.t,hasZip:C.hasZip})},C),T().createElement("span",{style:P},C.children||T().createElement(D.Z,{iconClass:"iconf-tipe",color:"#D1D2D6",size:"14px"})));Se.Z=(0,o.Z)()(y)},40938:function(gt,Se,e){"use strict";e.d(Se,{Z:function(){return z}});var O=e(12924),g=e.n(O),b=e(11092),a=e.n(b),T=e(28216),o=e(77219),D=e(66438),K=e(94184),P=e.n(K),y=e(84874),C=$=>{var W=$.prefixCls,S=$.title,x=$.isMinimized,U=$.onToggleMinimize,L=$.onClose,w=P()(["".concat(W),x?"".concat(W,"-minimized"):""]);return g().createElement("header",{className:w},S,g().createElement("div",{className:"".concat(W,"__action")},g().createElement("span",{className:"".concat(W,"__action__minimize"),onClick:U},g().createElement(y.Z,{iconClass:"icon-jinrujiantou"})),g().createElement("span",{className:"".concat(W,"__action__close"),onClick:L},g().createElement(y.Z,{iconClass:"icon-guanbi1"}))))};C.defaultProps={prefixCls:"cl-uploader__header",title:"",isMinimized:!0,onToggleMinimize:()=>{},onClose:()=>{}};var p=C,B=e(62029),c=e(81211),I=e(88986),M=e(91768),v=e(6793),A=e(37055);class d extends g().Component{constructor(){super(...arguments);this.renderOuter=()=>{var W=this.props,S=W.prefixCls,x=W.file,U=x.process;return g().createElement("div",{className:"".concat(S,"__outer"),style:{width:"".concat(U,"%")}})},this.renderInner=()=>{var W=this.props,S=W.prefixCls,x=W.file,U=x.name,L="".concat(S,"__inner");return g().createElement("div",{className:L},this.renderTypeIcon(),g().createElement("span",{className:"".concat(L,"__name")},U,this.renderErrorMsg()),this.renderRightInfo())},this.renderTypeIcon=()=>{var W=this.props,S=W.prefixCls,x=W.file,U=x.name.split(".").pop().toLowerCase(),L="".concat(S,"__inner__type"),w=(0,I.Z)({},A.e1);return g().createElement("span",{className:L},g().createElement(y.Z,{iconClass:w[U],size:"22px"}))},this.renderRightInfo=()=>{var W=this.props,S=W.prefixCls,x=W.file,U=x.uploadedSize,L=x.size,w=x.status,k="".concat(S,"__inner__info");return g().createElement("div",{className:k},g().createElement("span",{className:"".concat(k,"__size")},(0,v.sS)(U),"/",(0,v.sS)(L)),g().createElement("span",{className:"".concat(k,"__status ").concat(k,"__status-").concat(w)},this.renderRestart(),this.renderAction()))},this.renderErrorMsg=()=>{var W=this.props,S=W.prefixCls,x=W.file,U=W.t,L=x.isError,w="".concat(S,"__inner__name");return L?g().createElement("span",{className:"".concat(w,"__errmsg")},g().createElement(y.Z,{iconClass:"icon-f-attention"}),U("component.uploadFailed")):null},this.renderRestart=()=>{var W=this.props,S=W.file,x=W.onRestart,U=W.t,L=S.isError;return L?g().createElement("span",{className:"restart",onClick:()=>x(S)},U("component.reUpload")):null},this.renderAction=()=>{var W=this.props,S=W.file,x=W.onStop,U=S.process,L=S.isError,w=S.isDoc,k=S.isCanceling,ne=S.status;return ne==="success"?g().createElement("span",{className:"success"},g().createElement(y.Z,{iconClass:"icon-f-ok"})):w?null:k?g().createElement("span",{className:"spinner"},g().createElement(y.Z,{iconClass:"icon-loading-xs"})):U!==100||L?g().createElement("span",{className:"close",onClick:()=>x(S)},g().createElement(y.Z,{iconClass:"icon-close-xs"})):null}}render(){var W=this.props,S=W.prefixCls,x=W.file,U=x.isError,L=x.status,w=P()(["".concat(S),"".concat(S,"-").concat(L),U?"".concat(S,"-error"):""]);return g().createElement("section",{className:w},this.renderOuter(),this.renderInner())}}d.defaultProps={prefixCls:"cl-uploader__queue__item",file:{},onStop:()=>{},onRestart:()=>{}};var l=(0,M.Z)()(d),t=$=>{var W=$.prefixCls,S=$.list,x=S===void 0?[]:S,U=(0,c.Z)($,["prefixCls","list"]);return g().createElement("div",{className:W},x.map(L=>g().createElement(l,(0,B.Z)({key:L.id},U,{file:L}))))};t.defaultProps={prefixCls:"cl-uploader__queue",list:[]};var h=t,F=e(3407),m=e(43967);class E extends g().Component{constructor(){super(...arguments);this.state={showWrapper:!1},this.handleStop=W=>{this.props.dispatch({type:"uploader/stopUploadFile",payload:{file:W}})},this.handleRestart=W=>{this.props.dispatch({type:"uploader/deleteUploadFile",payload:{fileId:W.id}}),this.props.dispatch({type:"uploader/chooseFiles",payload:{choosedFiles:[W],isUpdate:!0,dispatch:this.props.dispatch,hasZip:this.props.hasZip==="true"}})},this.handleToggleMinimize=()=>{this.props.dispatch({type:"uploader/toggleMinimize",payload:{isMinimized:!this.props.isMinimized}})},this.handleClose=()=>{this.props.dispatch({type:"uploader/closeWrapper",payload:{dispatch:this.props.dispatch}})},this.renderTitle=(W,S)=>{var x=this.props.lngType,U=F.Z[x].component,L="";return W.length?L="".concat(U.uploading).concat(W.length).concat(U.itemUnit):S.length&&(L="".concat(U.completeUpload).concat(S.length).concat(U.itemUnit)),L}}static getDerivedStateFromProps(W,S){return W.showWrapper!==S.showWrapper?{showWrapper:W.showWrapper}:null}componentDidMount(){this.props.dispatch({type:"uploader/initUploader",payload:{dispatch:this.props.dispatch}}),this.props.dispatch({type:"uploader/initSaveParams",payload:{params:this.props.params}})}componentWillUnmount(){this.props.dispatch({type:"uploader/destroyUploader"})}render(){var W=this.props,S=W.prefixCls,x=W.list,U=W.isMinimized,L=this.state.showWrapper,w=(0,m.Y5)(x),k=(0,m.d2)(x),ne=this.renderTitle(w,k);return g().createElement(g().Fragment,null,g().createElement(p,{title:ne,onToggleMinimize:this.handleToggleMinimize,onClose:this.handleClose,isMinimized:L&&U}),g().createElement(D.Z,{in:L&&!U,timeout:300,classNames:"".concat(S,"__queen-csstransition")},g().createElement(h,{list:x,onStop:this.handleStop,onRestart:this.handleRestart})))}}E.defaultProps={prefixCls:"cl-uploader",list:[],params:{classifyId:0,bizType:0},isMinimized:!1};var Q=E,G=$=>({queues:$.uploader.queues,list:$.uploader.list,isMinimized:$.uploader.isMinimized,showWrapper:$.uploader.showWrapper,lngType:$.user.lng});class V extends g().Component{constructor(){super(...arguments);this.renderContent=()=>{var W=this.props,S=W.prefixCls,x=S===void 0?"cl-uploader":S,U=W.showWrapper;this.popup.classList.add(x),U?this.popup.classList.remove("".concat(x,"-closed")):this.popup.classList.add("".concat(x,"-closed")),a().render(g().createElement(Q,this.props),this.popup)}}componentDidMount(){this.popup=document.createElement("div"),document.body.appendChild(this.popup),this.renderContent()}componentDidUpdate(){this.renderContent()}componentWillUnmount(){var W=this.popup,S=a().unmountComponentAtNode(W);S&&W.parentNode&&W.parentNode.removeChild(W)}render(){return null}}V.Tooltip=o.Z;var z=(0,T.$j)(G)(V)},9925:function(gt,Se,e){"use strict";var O=e(57361),g=e(33565),b=e(9754),a=e.n(b),T=e(12924),o=e.n(T),D=e(28216),K=e(14441),P=C=>{var p=C.userId,B=C.userName,c=C.appType,I=(0,T.useRef)(null),M=(0,T.useState)(""),v=(0,g.Z)(M,2),A=v[0],d=v[1],l=(0,T.useState)(""),t=(0,g.Z)(l,2),h=t[0],F=t[1],m=(0,T.useState)(!0),E=(0,g.Z)(m,2),Q=E[0],G=E[1];(0,T.useEffect)(()=>{c==="wx_app"&&(p?V():(console.warn("userId is required"),F(B)))},[p]);function V(){return z.apply(this,arguments)}function z(){return z=(0,O.Z)(a().mark(function W(){var S,x,U,L,w,k,ne,ie,Ne,ue;return a().wrap(function(Ze){for(;;)switch(Ze.prev=Ze.next){case 0:return Ze.prev=0,Ze.next=3,(0,K.v)(p);case 3:S=Ze.sent,x=S.code,U=S.data,x==="200000"&&U&&(L=U.hasName,w=L===void 0?!0:L,k=U.sourceType,ne=U.name,ie=ne===void 0?"":ne,Ne=U.thirdId,G(w),w?F(ie):k==="wx_sync"&&(d(Ne),ue=window.parent.WWOpenData,ue&&ue.bind(I.current))),Ze.next=12;break;case 8:Ze.prev=8,Ze.t0=Ze.catch(0),console.error(Ze.t0,"error"),F(B);case 12:case"end":return Ze.stop()}},W,null,[[0,8]])})),z.apply(this,arguments)}function $(){return Q?h:o().createElement("ww-open-data",{ref:I,type:"userName",openid:A})}switch(c){case"wx_app":return $();default:return B}};P.defaultProps={userName:""};var y=C=>({appType:C.user.appType});Se.Z=o().memo((0,D.$j)(y)(P))},40572:function(gt,Se,e){"use strict";e.d(Se,{X:function(){return v}});var O=e(62029),g=e(62999),b=e(85733),a=e(47673),T=e(4107),o=e(81211),D=e(12924),K=e.n(D),P=e(91768),y=e(80991),C=e(5227),p=e.n(C),B=e(43859),c=e(84874),I=e(56130);class M extends K().PureComponent{constructor(d){super(d);this.componentDidUpdate=l=>{l.refreshData!==this.props.refreshData&&this.props.refreshData&&this.props.refresh(),this.props.classify.length!=l.classify.length&&this.props.hasDefaultValue&&!this.props.formik.values.classify&&this.onChange(this.props.classify[0].value,[this.props.classify[0].name])},this.onChange=(l,t)=>{this.setState({open:!1,name:t[0]});var h=this.props.formik;h&&h.setValues&&this.props.formik.setFieldValue("classify_name",t[0]),this.props.onFieldChange(l,t)},this.onFocus=()=>{this.setState({open:!this.state.open})},this.onBlurChange=()=>{setTimeout(()=>{this.setState({open:!1})},100)},this.hideDropDown=l=>{l.stopPropagation();var t=document.getElementsByClassName("edit-classify")[0],h=document.getElementsByClassName("classify-edit-select")[0],F=l.clientX,m=l.clientY;if(!(!h||h.offsetLeft<=0)){var E=h.offsetLeft,Q=h.offsetTop-t.offsetHeight,G=h.offsetLeft+h.offsetWidth,V=h.offsetTop+h.offsetHeight;(F<E||F>G||m<Q||m>V)&&this.onBlurChange()}},this.state={open:!1,name:""}}static getDerivedStateFromProps(d,l){if(d.value!==l.value){var t=d.classifyName;return{name:t}}return null}componentDidMount(){document.addEventListener("click",this.hideDropDown)}componentWillUnmount(){document.removeEventListener("click",this.hideDropDown)}render(){var d=this.state,l=d.open,t=d.name,h=this.props,F=h.classify,m=h.t,E=h.multiple,Q=h.allowClear,G=h.placeholder,V=h.disabled,z=h.className,$=z===void 0?"":z,W=(0,o.Z)(h,["classify","t","multiple","allowClear","placeholder","disabled","className"]);return K().createElement("div",(0,O.Z)({className:"".concat(p()["classify-tree-select"]," ").concat($," edit-classify")},W),K().createElement(T.Z,{className:"".concat(p()["classify-tree-select-result"]," ").concat($),placeholder:G,onFocus:this.onFocus,value:t,suffix:K().createElement(c.Z,{iconClass:"".concat(l?"iconf-arrow-up":"iconf-arrow-under")})}),K().createElement(b.Z,{treeDataSimpleMode:!0,showSearch:!0,dropdownStyle:{maxHeight:300,overflow:"auto"},treeNodeFilterProp:"name",treeData:F,placeholder:G||m("component.selectClassifyLabel"),onChange:this.onChange,showArrow:!0,open:l,multiple:E,allowClear:Q,disabled:V,loadData:this.props.loadData,onTreeExpand:this.onTreeExpand,dropdownClassName:"classify-edit-select"}))}}M.defaultProps={defaultValue:"",refreshData:!1,onChange:()=>{}};var v=(0,I.Z)((0,P.Z)()(M));Se.Z=(0,B.Z)((0,y.$j)((0,I.Z)((0,P.Z)()(M))))},12378:function(gt,Se,e){"use strict";var O=e(62999),g=e(85733),b=e(12924),a=e.n(b),T=e(91768),o=e(56130);class D extends a().PureComponent{constructor(P){super(P);this.componentDidUpdate=y=>{y.refreshData!==this.props.refreshData&&this.props.refreshData&&this.props.refresh()},this.onChange=(y,C)=>{this.setState({value:y}),this.props.onChange(y,C)},this.state={value:void 0}}render(){var P=this.state.value,y=this.props,C=y.classify,p=y.defaultValue,B=y.bindValue,c=y.t,I=y.multiple,M=y.allowClear,v=y.placeholder,A=y.disabled,d=y.className,l=d===void 0?"":d;return a().createElement("div",{className:"classify-tree-select ".concat(l)},a().createElement(g.Z,{value:B?p===""?void 0:p:P||(p===""?void 0:p),treeDataSimpleMode:!0,showSearch:!0,dropdownStyle:{maxHeight:300,overflow:"auto"},treeNodeFilterProp:"name",treeData:C,placeholder:v||c("component.selectClassifyLabel"),onChange:this.onChange,showArrow:!0,multiple:I,allowClear:M,loadData:this.props.loadData,disabled:A}))}}D.defaultProps={defaultValue:"",refreshData:!1,bindValue:!1,onChange:()=>{}},Se.Z=(0,o.Z)((0,T.Z)()(D))},79284:function(gt,Se,e){"use strict";var O=e(62029),g=e(22385),b=e(31097),a=e(96433),T=e(33304),o=e(20228),D=e(11382),K=e(57663),P=e(71577),y=e(36017),C=e(35247),p=e(34792),B=e(48086),c=e(57361),I=e(88986),M=e(88983),v=e(47933),A=e(9754),d=e.n(A),l=e(12924),t=e.n(l),h=e(28216),F=e(91768),m=e(49101),E=e(18329),Q=e(89560),G=e(1164),V=e(95664),z=e(84874),$=e(87312),W=e(10237),S=e(38642),x=e(37055),U=e(16239),L=e(86726),w=e(48479),k=e(60667),ne=e(6793),ie=e(44881),Ne=j=>({userInfo:j.user,newCourseManagement:j.newCourseManagement}),ue=v.ZP.Group,_e={size:"large",destroyOnClose:!0,bodyStyle:{padding:"0"},maskClosable:!1,wrapClassName:"qa-select-course-confirm"};class Ze extends t().Component{constructor(R){var le;super(R);le=this,this.onCancel=()=>{var H=this.props.onCancel;H&&(this.setState({selectedKeys:[""]}),this.props.onCancel())},this.onOk=()=>{var H=this.state.checkedList;if(this.props.onOk){var X=(0,ne.Cj)(H);X=X.map(ce=>({id:ce.id,name:ce.name,type:"course",componentName:"CourseSelector",icon:x.e1.course,duration:ce.duration,data:ce.data,crsType:this.props.image_text?"imageText":"crs"})),this.setState({selectedKeys:[""]}),this.props.onOk(X)}},this.onChangePage=H=>{var X=this.state.page;X.pageNumber=H,this.setState({page:X},()=>{this.getCourseList()})},this.onSearch=H=>{var X=this.state.page;X.title=H,X.pageNumber=1,this.setState({page:X},()=>{this.getCourseList()})},this.classifyTabChange=H=>{var X=H.target.value,ce=this.state.page;ce.queryType=X,ce.pageNumber=1,this.setState({page:ce},()=>{this.getCourseList()})},this.getCourseList=()=>{var H=this.state.page,X=this.props,ce=X.scenesType,Te=ce===void 0?"":ce,Le=X.fromComponent;this.setState({isLoading:!0});var he=Le==="CustomModuleEdit"?(0,I.Z)((0,I.Z)({},H),{},{image_text:this.props.image_text?this.props.image_text:"",classifyType:"all",auth_type:"refer"}):(0,I.Z)((0,I.Z)({},H),{},{image_text:this.props.image_text?this.props.image_text:"",auth_type:"refer"});W.WY.get({url:Te==="marketing"?x.ZP.CourseSelector.getImageTextCourseListByAuth():x.ZP.CourseSelector.getCourseListByAuth(),params:he}).then(Ee=>{Ee.data.list=this.compileData(Ee.data.list||[]),this.setState({isLoading:!1,title:this.props.modelType==="select"?this.props.t("component.addCourse"):this.props.image_text?"".concat(this.props.t("setting.addUser")).concat(this.props.t("course.graphicDetailTitle")):this.props.t("component.addCourse"),courseList:Ee.data.list,paginationData:{pages:Ee.data.pages,total:Ee.data.total}})})},this.getClassifyTab=H=>{var X=this.props,ce=X.scope,Te=X.t,Le=X.useType,he=X.filterQuota,Ee=he===void 0?!1:he,ve=X.courseType,be=X.scenesType,Ve=be===void 0?"":be,Ae=x.ZP.CourseSelector.getClassifyCount(),at={parentId:H,courseType:ve||"course",useType:Le||"",filterQuota:Ee,image_text:this.props.image_text?this.props.image_text:""};Ve==="marketing"&&(at.sharing="true",at.share_type="market"),W.WY.get({url:Ae,params:at}).then(et=>{var ut=[{id:0,count:0,type:Te("common.all")}];et.data.data.map(Je=>{switch(Je.queryType){case 1:Je.type=Te("common.originalCourse");break;case 2:Je.type=Te("common.noOriginalCourse");break;case 3:Je.type=Te("common.platformCourse");break;default:break}});var q=[],Oe=this.state.whiteList;ce&&ce===2?q=et.data.data.splice(0,et.data.data.length-1):q=Oe.classifyTypeFlag?et.data.data.splice(0,et.data.data.length-1):et.data.data,this.setState({classifyTab:ut.concat(q)})})},this.compileData=function(){var H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],X=le.state.checkedList,ce=H.map(Te=>({name:Te.title,id:Te.id,cover:Te.cover,teacherName:Te.teacherName,teacher_source_type:Te.teacher_source_type,teacher_sync_user_id:Te.teacher_sync_user_id,teacher_type:Te.teacher_type,scope:Te.scope,config:Te.config,officialPrice:Te.officialPrice,score:Te.score,remainderCount:Te.remainderCount,original:Te.original,count:Te.count,duration:Te.duration,isChecked:X.findIndex(Le=>Le.id===Te.id)!==-1,data:Te}));return ce},this.handleRefresh=()=>{this.getCourseList(),this.getClassifyTab(0),this.getList(0)},this.handleClickNode=H=>{var X=this.state.page;X.classifyId=H.id,X.queryType=0,X.pageNumber=1,this.setState({selectedKeys:[H.id],page:X},()=>{this.getCourseList(),this.getClassifyTab(H.id)})},this.getList=(0,c.Z)(d().mark(function H(){var X,ce;return d().wrap(function(Le){for(;;)switch(Le.prev=Le.next){case 0:return X=le.props.t,Le.next=3,W.WY.get({url:x.ZP.Classify.getResourceClassify(),params:{include_unclassified:"true",auth_type:"refer",parent_id:0}});case 3:ce=Le.sent,ce.data.list=(0,ie.P)(ce.data.list,"refer"),ce.data.list.unshift({label:X("common.all"),id:"",isLeaf:!0}),le.setState({treeData:ce.data.list||[]});case 7:case"end":return Le.stop()}},H)})),this.loadData=H=>new Promise(X=>{var ce=H.id;setTimeout(()=>{var Te=x.ZP.Classify.getResourceClassify(),Le=ce;W.WY.get({url:Te,params:{parent_id:Le,auth_type:"refer"}}).then(he=>{if(!he.data||H.dataRef.children){X();return}var Ee=(0,ie.P)(he.data.list,"refer");H.dataRef.children=Ee,this.setState({treeData:[...this.state.treeData]})}),X()},300)}),this.jumpToRoot=()=>{var H=this.state.page;H.classifyId="",H.queryType=0,this.setState({activeClassifyOne:{id:"",label:""},activeClassifyTwo:[],page:H},()=>{this.getCourseList(),this.getClassifyTab()})},this.jumpToLevelOne=()=>{var H=this.state,X=H.page,ce=H.activeClassifyOne,Te=ce.id;X.classifyId=Te,X.queryType=0,this.setState({page:X,activeClassifyTwo:[]},()=>{this.getCourseList(),this.getClassifyTab(Te)})},this.jumpToLevelTwo=(H,X)=>{var ce=this.state.page,Te=this.state.activeClassifyTwo;Te=Te.slice(0,X+1),ce.classifyId=H,ce.queryType=0,this.setState({page:ce,activeClassifyTwo:Te},()=>{this.getCourseList(),this.getClassifyTab(H)})},this.selectItem=(H,X,ce)=>{var Te=this.props,Le=Te.useType,he=Te.fromComponent,Ee=Te.t,ve=Te.replaceStatus,be=Te.resourceLocked,Ve=Te.defaultChecked,Ae=[...this.state.courseList],at=[...this.state.checkedList];if(be){var et=Ve.some(je=>je.id===H&&je.resource_lock);if(et){B.default.warning(Ee("learning.lockedTip"));return}}if(ve){var ut=!1;if(this.props.allChecked.forEach(je=>{je.id===H&&(B.default.warning(Ee("study.courseAlreadyExists")),ut=!0)}),ut)return;at.splice(Ae[X],1),Ae.forEach(je=>{je.isChecked=!1})}if(he==="evaluation"&&at.length>=10){B.default.warn(Ee("evaluationManage.chooseUpTip"));return}if(he==="evaluation"&&ce.data.type==="wei"){B.default.warn(Ee("evaluationManage.notWei"));return}var q=Ae[X];if(Le&&Le==="banner")if(q.isChecked){var Oe=at.findIndex(je=>je.id===H);at.splice(Oe,1),q.isChecked=!1}else at=[],Ae.forEach(je=>{je.isChecked=!1}),q.isChecked=!0,at.push(q);else if(q.isChecked){var Je=at.findIndex(je=>je.id===H);at.splice(Je,1),q.isChecked=!1}else q.isChecked=!0,at.push(q);this.setState({checkedList:at,courseList:Ae})},this.toggleClassifyOneSwitch=()=>{var H=this.state.classifyOneSwitch;this.setState({classifyOneSwitch:H==="on"?"off":"on"})},this.renderItemLabel=H=>{var X="",ce="",Te=this.props.t;return H.scope===2&&H.original===!1?(X=Te("common.noOriginalCourse"),ce="#bb8cee"):H.scope===2&&H.original===!0?(X=Te("common.originalCourse"),ce="#ffa818"):H.scope!==2&&(X=Te("common.platformCourse"),ce="#465DCD"),t().createElement("span",{className:"course-item-label",style:{background:ce}},X)},this.state={title:R.modelType==="select"?R.t("component.addCourse"):R.image_text?"".concat(R.t("setting.addUser")).concat(R.t("course.graphicDetailTitle")):R.t("component.addCourse"),page:{type:"",courseType:R.courseType||"course",title:"",classifyId:"",queryType:0,pageNumber:1,pageSize:12,scope:0,useType:"",filterQuota:!1},classifyTab:[],courseList:[],paginationData:{},checkedList:[],activeClassifyOne:{},activeClassifyTwo:[],isLoading:!1,classifyOneSwitch:"off",shouldRenderCreateCourse:(0,L.H3)("createCourse",(0,L.V9)("course",R.userInfo.modules)),treeData:[],selectedKeys:[""],whiteList:{classifyTypeFlag:(0,S.UI)("COURSE_SELECTOR_CLASSIFY_TYPE")}}}componentDidUpdate(R){if(R.visible!==this.props.visible&&this.props.visible){var le=[...this.props.defaultChecked],H=this.props.scope?this.props.scope:0,X=this.props.useType?this.props.useType:"",ce=this.props.courseType?this.props.courseType:"course",Te=this.props.filterQuota,Le=Te===void 0?!1:Te;this.getList(),this.setState({checkedList:le,page:{type:"",title:"",classifyId:"",queryType:0,pageNumber:1,pageSize:12,scope:H,filterQuota:Le,useType:X,courseType:ce||(X==="banner"?"all":"course")},activeClassifyOne:{},activeClassifyTwo:[]},()=>{this.getCourseList(),this.getClassifyTab(0)})}}render(){var R=this.state,le=R.checkedList,H=le===void 0?[]:le,X=R.paginationData,ce=R.activeClassifyOne,Te=R.activeClassifyTwo,Le=R.courseList,he=R.classifyTab,Ee=R.page,ve=R.isLoading,be=R.shouldRenderCreateCourse,Ve=this.props,Ae=Ve.t,at=Ve.image_text,et=Ve.modelType,ut;return et==="select"?ut=H:ut=at?H.filter(q=>q.crsType==="imageText"||q.data&&q.data.bizType===6||q.data&&q.data.type==="imageText"||q.data&&q.data.biz_type==="imageText"):H.filter(q=>!(q.crsType==="imageText"||q.data&&q.data.bizType===6||q.data&&q.data.type==="imageText"||q.data&&q.data.biz_type==="imageText")),_e.okText="".concat(Ae("common.ok"),"(").concat(ut.length,")"),t().createElement(E.ZP,(0,O.Z)({},_e,{visible:this.props.visible,title:this.state.title,onCancel:this.onCancel,onOk:this.onOk}),t().createElement("div",{className:"course-selector"},t().createElement("div",{className:"course-selector-top"},t().createElement(C.Z,{className:"course-selector-top-nav"},t().createElement(C.Z.Item,{onClick:this.jumpToRoot},Ae("component.allCourse")),ce.id?t().createElement(C.Z.Item,{onClick:this.jumpToLevelOne},ce.label):null,Te.map((q,Oe)=>t().createElement(C.Z.Item,{key:q.id,onClick:()=>this.jumpToLevelTwo(q.id,Oe)},q.label))),t().createElement(w.Z,{onSearch:this.onSearch,prefixCls:"course-selector-top-search",placeholder:Ae("searchInputPlaceholder.course")}),t().createElement("span",{className:"course-selector-top-addBtn"},be?t().createElement(G.Z,{to:"/course/management/create",projectType:"student"},t().createElement(P.Z,{type:"primary",icon:t().createElement(m.Z,null)},Ae("course.newCourse"))):null)),t().createElement("div",{className:"course-selector-classify-box"},t().createElement("div",{className:"course-selector-classify-tree"},t().createElement(Q.Z,{list:this.state.treeData,isRoot:!0,selectedKeys:this.state.selectedKeys,onSelect:this.handleClickNode,loadData:this.loadData})),t().createElement("div",{className:"course-selector-classify-right"},t().createElement("div",{className:"course-selector-classify-tab"},t().createElement(ue,{name:"radiogroup",defaultValue:0,value:Ee.queryType,onChange:this.classifyTabChange},he.map((q,Oe)=>t().createElement(v.ZP,{key:Oe,value:q.id},q.id===0?q.type:"".concat(q.type,"(").concat(q.count,")"))))),t().createElement("div",{className:"course-selector-list"},ve?t().createElement("div",{className:"course-selector-loading"},t().createElement(D.Z,null)):null,Le.map((q,Oe)=>t().createElement("div",{key:Oe,className:"course-selector-list-item",onClick:()=>this.selectItem(q.id,Oe,q)},t().createElement("img",{className:"course-item-cover",src:q.cover,alt:""}),this.renderItemLabel(q),t().createElement("div",{className:"course-item-info"},t().createElement("p",{className:"course-item-info-title"},q.name),t().createElement("div",{className:"course-item-info-sub"},q.scope===2?t().createElement(T.Z,{className:"course-item-info-rate",value:q.score===0?5:q.score,disabled:!0}):null,q.teacherName&&q.teacherName.length*12>70?t().createElement(b.Z,{title:!U.Z[(0,U.c)()].showCl&&q.teacherName==="\u9177\u5B66\u9662\u8D60\u9001"?"":q.teacher_type==="inside"?t().createElement(k.Z,{dataType:"userName",value:q.teacher_sync_user_id,name:q.teacherName,type:q.teacher_source_type}):q.teacherName},t().createElement("span",{className:"course-item-info-name"},!U.Z[(0,U.c)()].showCl&&q.teacherName==="\u9177\u5B66\u9662\u8D60\u9001"?"":q.teacher_type==="inside"?t().createElement(k.Z,{dataType:"userName",value:q.teacher_sync_user_id,name:q.teacherName,type:q.teacher_source_type}):q.teacherName)):t().createElement("span",{className:"course-item-info-name"},!U.Z[(0,U.c)()].showCl&&q.teacherName==="\u9177\u5B66\u9662\u8D60\u9001"?"":q.teacher_type==="inside"?t().createElement(k.Z,{dataType:"userName",value:q.teacher_sync_user_id,name:q.teacherName,type:q.teacher_source_type}):q.teacherName),q.scope!==2?t().createElement("span",{className:"course-item-info-count"},q.config||q.officialPrice===0?Ae("component.noLimit"):"".concat(Ae("component.remain")).concat(q.remainderCount).concat(Ae("component.courseUnit"),"(").concat(Ae("component.totalLabel")).concat(q.count).concat(Ae("component.courseUnit"),")")):null)),q.isChecked?t().createElement("div",{className:"selected-cover"},t().createElement("span",{className:"selected-cover-icon"},t().createElement(z.Z,{iconClass:"iconf-ok",size:"30px"}))):null)),Le.length===0?t().createElement($.Z,{className:"no-result",tipText:Ae("course.courseNoDataTip")}):null),t().createElement(V.Z,{totalNum:X.total,totalPage:X.pages,current:Ee.pageNumber,onChange:this.onChangePage,onRefresh:this.handleRefresh})))))}}Se.Z=(0,h.$j)(Ne)((0,F.Z)()(Ze))},17829:function(gt,Se,e){"use strict";e.d(Se,{Z:function(){return B}});var O=e(62029),g=e(32157),b=e(75869),a=e(12924),T=e.n(a),o=e(91768),D=e(38642),K=e(37055),P=e(10237);function y(c){var I=K.ZP.CoursewareSelector.getTree();return P.WY.get({url:I,params:c})}var C=b.Z.TreeNode;class p extends T().Component{constructor(I){super(I);this.onSelect=(M,v)=>{var A=this.state.treeData,d=v.node.props,l=d.title,t=d.eventKey,h=d.dataRef,F={title:l,eventKey:t,dataRef:h};this.setState({active:t});var m=(0,D.XN)(A,t);this.props.onChangeClassify(F,m)},this.getTree=()=>{var M={privatization:this.props.privatization||null};y(M).then(v=>{this.setState({treeData:v.data})})},this.chooseRoot=()=>{var M=this.props.t;this.setState({active:"0"});var v={title:M("common.all"),eventKey:"0",dataRef:{}};this.props.onChangeClassify(v,[M("common.all")])},this.state={treeData:[],active:"0"}}componentDidMount(){this.getTree()}componentDidUpdate(I){var M=this.props.privatization,v=I.privatization;M!==v&&this.getTree()}render(){var I=this.props,M=I.t,v=I.showTotal,A=I.total,d=I.controls,l=I.noHeader,t=this.state,h=t.treeData,F=t.active,m=E=>E.map(Q=>Q.children&&Q.children.length?T().createElement(C,{key:Q.value,title:Q.label,dataRef:Q},m(Q.children)):T().createElement(C,{key:Q.value,title:Q.label,dataRef:Q}));return T().createElement("div",{className:l?"courseware__left courseware__left_active":"courseware__left"},T().createElement("div",{className:F==="0"?"courseware__left__all active":"courseware__left__all",onClick:this.chooseRoot},M("common.all")," ",v?T().createElement(T().Fragment,null,"(",A,")"):null),T().createElement(b.Z,(0,O.Z)({},d,{defaultExpandAll:!0,onSelect:this.onSelect,className:F==="0"?"blur":"focus"}),m(h)))}}p.defaultProps={showTotal:!0,noHeader:!1,total:0,controls:{},onChangeClassify:()=>{},privatization:null};var B=(0,o.Z)("translation",{withRef:!0})(p)},10780:function(gt,Se,e){"use strict";e.d(Se,{Z:function(){return Te}});var O=e(62029),g=e(34792),b=e(48086),a=e(57361),T=e(18106),o=e(88108),D=e(9754),K=e.n(D),P=e(12924),y=e.n(P),C=e(91768),p=e(78001),B=e(28216),c=e(18329),I=e(17829),M=e(20228),v=e(11382),A=e(63185),d=e(9676),l=e(84874),t=e(95664),h=e(87312);class F extends y().Component{constructor(){super(...arguments);this.onCheckAll=he=>{var Ee=he.target.checked;this.props.checkAll(Ee)},this.onChangePage=he=>{this.props.onChangePageNumber(he)},this.checkOne=he=>{var Ee=he.target.checked,ve=he.target.value;this.props.checkOne(ve,Ee)}}render(){var he=this.props,Ee=he.coursewares,ve=Ee===void 0?[]:Ee,be=he.paginationData,Ve=he.isLoading,Ae=he.onRefresh,at=he.t,et=he.replaceStatus,ut=ve.findIndex(q=>q.isChecked===!1);return y().createElement("div",{className:"courseware__right__list"},ve.length>0?y().createElement("div",{className:"courseware__right__list__box"},y().createElement(d.Z,{className:"courseware__right__list__checkall",onChange:this.onCheckAll,checked:ut===-1,disabled:et},at("component.selectPage")),y().createElement("div",{className:"courseware__right__list__group"},Ve?y().createElement("div",{className:"courseware__right__loading"},y().createElement(v.Z,null)):null,ve.map((q,Oe)=>y().createElement(d.Z,{value:q.id,key:Oe,onChange:this.checkOne,checked:q.isChecked},y().createElement("span",{className:"courseware__right__list__icon"},y().createElement(l.Z,{iconClass:q.icon})),q.name))),y().createElement(t.Z,{totalNum:be.total,totalPage:be.pages,current:be.page_num,defaultPageSize:10,onChange:this.onChangePage,onRefresh:Ae})):y().createElement(h.Z,{tipText:at("course.courseNoDataTip")}))}}F.defaultProps={coursewares:[],paginationData:{pages:0,total:0},onChangePageNumber:()=>{},checkOne:()=>{},checkAll:()=>{}};var m=(0,C.Z)()(F),E=e(49111),Q=e(19650),G=e(88983),V=e(47933),z=e(59250),$=e(13013),W=e(57663),S=e(71577),x=e(30887),U=e(99210),L=e(1164),w=e(86726),k=Le=>({userInfo:Le.user});class ne extends y().Component{constructor(he){super(he);this.handleMenuClick=Ee=>{var ve=parseInt(Ee.key,10);ve===2&&this.handleAddArticle()},this.handleAddArticle=()=>{var Ee=this.props.classifyId;L.Z.targetTo({path:"/training/resourceManage/library/articleDetail?classifyId=".concat(Ee)})},this.handleChooseFiles=Ee=>{this.props.dispatch({type:"uploader/chooseFiles",payload:{choosedFiles:Ee.target.files,dispatch:this.props.dispatch}}),Ee.target.value=null,Ee.target.files=null},this.renderDropdown=()=>{var Ee=this.props,ve=Ee.prefixCls,be=Ee.t,Ve=this.state,Ae=Ve.shouldRenderCreateCourse,at=Ve.shouldRenderNewArticle,et=y().createElement(U.Z,{className:"".concat(ve,"__dropdowm__menu"),onClick:this.handleMenuClick},Ae&&null,at&&y().createElement(U.Z.Item,{key:2},be("resourceLibrary.newArticle")));return at?y().createElement($.Z,{overlay:et},y().createElement(S.Z,{type:"primary"},be("course.courseDetailAddCourseware"),y().createElement(l.Z,{iconClass:"iconf-arrow-under",size:"14px"}))):null},this.state={shouldRenderCreateCourse:(0,w.H3)("createCourse",(0,w.V9)("course",he.userInfo.modules)),shouldRenderNewArticle:(0,w.H3)("add_articles",(0,w.V9)("library",he.userInfo.modules))}}render(){var he=this.props.prefixCls,Ee=this.state,ve=Ee.shouldRenderCreateCourse,be=Ee.shouldRenderNewArticle;return!ve&&!be?null:y().createElement("div",{className:he},this.renderDropdown())}}ne.defaultProps={prefixCls:"courseware__right__filter__new-create-btn"};var ie=(0,B.$j)(k)((0,C.Z)()(ne)),Ne=e(48479);class ue extends y().Component{constructor(he){super(he);this.onSearch=Ee=>{var ve=this.props,be=ve.contentType,Ve=ve.isSearchOneResource,Ae={contentType:this.state.contentType,keyword:Ee};Ve&&(Ae.contentType=be),this.props.getQueryData(Ae),this.setState({keyword:Ee})},this.changeType=Ee=>{var ve=Ee.target.value==="all"?"":Ee.target.value,be={contentType:ve,keyword:this.state.keyword};this.props.getQueryData(be),this.setState({contentType:ve})},this.state={contentType:"",keyword:""}}componentDidMount(){var he=this.props,Ee=he.replaceStatus,ve=he.setButtonDisabled;if(Ee){var be={contentType:ve,keyword:this.state.keyword};this.props.getQueryData(be),this.setState({contentType:ve})}}render(){var he=this.props,Ee=he.classifyCount,ve=he.excludeType,be=he.classifyId,Ve=he.shouldRenderCreateBtns,Ae=he.t,at=he.classifyData,et=he.replaceStatus,ut=he.setButtonDisabled,q=he.showHtml,Oe=q===void 0?!0:q,Je={all:y().createElement(V.ZP.Button,{value:"all",key:"all",disabled:et?ut!=="all":!1},Ae("common.all"),"(",Ee.all,")"),video:y().createElement(V.ZP.Button,{value:"video",key:"video",disabled:et?ut!=="video":!1},Ae("common.video"),"(",Ee.video,")"),audio:y().createElement(V.ZP.Button,{value:"audio",key:"audio",disabled:et?ut!=="audio":!1},Ae("common.audio"),"(",Ee.audio,")"),application:y().createElement(V.ZP.Button,{value:"application",key:"application",disabled:et?ut!=="application":!1},Ae("common.doc"),"(",Ee.application,")"),h5:y().createElement(V.ZP.Button,{value:"h5",key:"h5",disabled:et?ut!=="h5":!1},Ae("h5Article.title"),"(",Ee.h5,")"),html:y().createElement(V.ZP.Button,{value:"html",key:"html",disabled:et?ut!=="html":!1},Ae("common.html"),"(",Ee.html,")"),picture:y().createElement(V.ZP.Button,{value:"picture",key:"picture",disabled:et?ut!=="picture":!1},Ae("common.image"),"(",Ee.picture,")"),scorm:y().createElement(V.ZP.Button,{value:"scorm",key:"scorm",disabled:et?ut!=="scorm":!1},"SCORM(",Ee.scorm,")")},je=ve.split(",");return!Oe&&!je.includes("html")&&je.push("html"),!Oe&&!je.includes("scorm")&&je.push("scorm"),y().createElement("div",{className:"courseware__right__filter"},y().createElement("div",{className:"courseware__right__filter__header"},y().createElement("div",{className:"courseware__right__filter__header__title"},at.title||Ae("common.all")),y().createElement(Ne.Z,{onSearch:this.onSearch,prefixCls:"courseware__right__filter__header__search",placeholder:Ae("searchInputPlaceholder.courseware")})),y().createElement(V.ZP.Group,{defaultValue:"all",onChange:this.changeType},y().createElement(Q.Z,{size:0,wrap:!0,style:{flexWrap:"wrap"}},Object.keys(Je).map(Be=>{var St=je.includes(Be)?null:Je[Be];return St}))),Ve&&y().createElement(ie,{classifyId:be}))}}ue.defaultProps={classifyCount:{all:0,video:0,audio:0,application:0,excludeType:"",showHtml:!0},getQueryData:()=>{}};var _e=(0,C.Z)()(ue),Ze=e(10237),j=e(37055),R=o.Z.TabPane,le={size:"large",destroyOnClose:!0,bodyStyle:{padding:"0"},width:1e3,maskClosable:!1,wrapClassName:"qa-select-courseware-confirm"},H=Le=>({userInfo:Le.user});class X extends y().Component{constructor(he){var Ee;super(he);Ee=this,this.getLocalTabs=ve=>{var be=this.state.tabs;return Array.isArray(ve)&&ve.length>0?ve.filter(Ve=>Ve.storageType==="LOCAL"):[...be]},this.getStorageSetting=(0,a.Z)(K().mark(function ve(){var be,Ve,Ae,at,et;return K().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return be=Ee.props.onlyShowStorageTabKey,Ve=j.ZP.localStorage.getStorage(),q.next=4,Ze.WY.get({url:Ve});case 4:Ae=q.sent,at=Ae.data,at.code===0&&(et=window.OnlyShowLocalStorage?Ee.getLocalTabs(at.data):Ee.getTabs(at.data),be&&(et=et.filter(Oe=>Oe.id===be)),Ee.setState({storageTabs:[...et]},()=>{var Oe=Ee.state.storageTabs,Je=Oe===void 0?[]:Oe;Ee.setState({activeTabKey:Je.length>0?Je[0].id:"public"})}));case 7:case"end":return q.stop()}},ve)})),this.getTabs=ve=>{var be=this.props.showPrivate,Ve=be===void 0?!0:be,Ae=this.state.tabs;if(Array.isArray(ve)&&ve.length>0){var at=ve.filter(q=>q.isDefault),et=ve.findIndex(q=>q.isDefault);et>-1&&ve.splice(et,1);var ut=[...at,...Ae,...ve];return Ve!==void 0&&!Ve&&(ut=ut.filter(q=>q.storageType!=="LOCAL")),ut}return[...Ae]},this.compileData=ve=>{var be=this.state.checkedList,Ve=ve.map(Ae=>{var at=j.Ss.indexOf(Ae.contentType)>-1;return at?{name:Ae.title,id:Ae.id,status:Ae.status,type:"mp3",icon:j.e1.mp3,duration:Ae.duration,originalType:"mp3",isChecked:be.findIndex(et=>et.id===Ae.id)!==-1,data:Ae}:Ae.contentType==="scorm"?{name:Ae.title,id:Ae.id,status:Ae.status,type:"scorm",icon:j.e1.scorm,duration:Ae.duration,originalType:"scorm",isChecked:be.findIndex(et=>et.id===Ae.id)!==-1,data:Ae}:{name:Ae.title,id:Ae.id,status:Ae.status,type:Ae.type,icon:j.e1[Ae.type],duration:Ae.duration,originalType:Ae.type,isChecked:be.findIndex(et=>et.id===Ae.id)!==-1,data:Ae}});return Ve},this.onCancel=()=>{var ve=this.props.onCancel;ve&&this.props.onCancel()},this.onOk=()=>{if(this.props.onOk){if(this.props.replaceStatus&&this.state.checkedList.length===0){var ve=this.props.t;b.default.warning(ve("study.onlyChooseOne"));return}var be=this.state.checkedList.map(Ve=>({id:Ve.id,name:Ve.name,type:Ve.type,componentName:"CoursewareSelector",icon:Ve.icon,duration:Ve.duration,originalType:Ve.type,status:Ve.status,data:Ve.data}));this.props.onOk(be)}},this.onChangeClassify=ve=>{var be=this.state.page;be.resourceClassify=ve.eventKey,this.setState({page:be,classifyData:ve},()=>{this.props.dispatch({type:"uploader/setUploaderParams",payload:{classifyId:ve.eventKey,bizType:0}}),this.getList(),this.getCount()})},this.getQueryData=ve=>{var be=this.state.page;be.contentType=ve.contentType,be.keyword=ve.keyword,be.pageNumber=1,this.setState({page:be},()=>{this.getList(),this.getCount()})},this.handleRefresh=()=>{this.getList(),this.getCount()},this.checkOne=(ve,be)=>{var Ve=this.props,Ae=Ve.t,at=Ve.resourceLocked,et=Ve.defaultChecked,ut=[...this.state.coursewares],q=[...this.state.checkedList],Oe=ut.findIndex(St=>St.id===ve),Je=q.findIndex(St=>St.id===ve);if(at){var je=et.some(St=>St.id===ve&&St.resource_lock);if(je){b.default.warning(Ae("learning.lockedTip"));return}}if(Je===-1?q.push(ut[Oe]):q.splice(Je,1),this.props.replaceStatus){var Be=!1;if(this.props.allChecked.forEach(St=>{St.id===ve&&(b.default.warning(Ae("study.courseworkAlreadyExists")),Be=!0)}),Be)return;q.length>1&&q.splice(ut[Oe],1),ut.forEach(St=>{St.isChecked=!1})}ut[Oe].isChecked=be,this.setState({coursewares:ut,checkedList:q})},this.checkAll=ve=>{var be=[...this.state.checkedList],Ve=this.props,Ae=Ve.resourceLocked,at=Ve.t,et=Ve.defaultChecked,ut=this.state.coursewares.map(q=>{q.isChecked=ve;var Oe=be.findIndex(je=>je.id===q.id);if(Oe===-1&&ve)be.push(q);else if(!ve){var Je=et.some(je=>je.id===q.id&&je.resource_lock);Ae&&Je?(q.isChecked=!0,b.default.warning(at("learning.lockedTip"))):be.splice(Oe,1)}return q});this.setState({coursewares:ut,checkedList:be})},this.getList=()=>{var ve=this.state,be=ve.page,Ve=ve.total,Ae=ve.activeTabKey;this.setState({isLoading:!0}),Ae&&Ae!=="public"&&(be.privatization=Ae),Ze.WY.get({url:j.ZP.CoursewareSelector.getList(),params:be}).then(at=>{at.data.list=this.compileData(at.data.list),this.setState({isLoading:!1,coursewares:at.data.list,coursewaresData:at.data,total:"".concat(be.resourceClassify)==="0"?at.data.total:Ve})})},this.getCount=ve=>{var be=this.state,Ve=be.activeTabKey,Ae=be.page,at=j.ZP.CoursewareSelector.getCount(),et={resourceClassify:this.state.page.resourceClassify,excludeType:this.props.excludeType,privatization:Ve==="public"?null:Ve,keyword:ve?ve.keyword:Ae.keyword};Ze.WY.get({url:at,params:et}).then(ut=>{this.setState({classifyCount:ut.data.data})})},this.onChangePageNumber=ve=>{var be=this.state.page;be.pageNumber=ve,this.setState({page:be},()=>{this.getList()})},this.handleTabChange=ve=>{var be=this.state.page;be.privatization=ve==="public"?null:ve,be.resourceClassify="0",this.setState({activeTabKey:ve,page:be,classifyData:{}},()=>{this.getList(),this.getCount()})},this.getTabType=()=>{var ve=this.state,be=ve.storageTabs,Ve=be===void 0?[]:be,Ae=ve.activeTabKey,at=Ve.filter(et=>et.id===Ae);return!(at.length>0&&at[0].storageType&&at[0].storageType!=="PUBLIC_CLOUD")},this.state={classifyData:{},page:{resourceClassify:0,keyword:"",contentType:he.contentType,pageNumber:1,pageSize:10,excludeType:he.excludeType},coursewares:[],coursewaresData:{},total:0,classifyCount:{all:0,video:0,audio:0,application:0},checkedList:[],isLoading:!1,activeTabKey:"public",tabs:[{id:"public",name:he.t("localStorage.commonStorage"),key:"public",storageType:"PUBLIC_CLOUD"}]}}componentDidMount(){this.getStorageSetting()}componentDidUpdate(he){if(he.visible!==this.props.visible&&this.props.visible){var Ee=[...this.props.defaultChecked],ve=this.props.replaceStatus,be=this.state.storageTabs,Ve=be===void 0?[]:be,Ae;if(ve){var at=Ee[0].originalType;at==="mp4"?Ae="video":at==="mp3"?Ae="audio":j.Yq.includes(at)?Ae="application":at==="h5"?Ae="h5":at==="html"?Ae="html":at==="scorm"?Ae="scorm":j.WB.includes(at)&&(Ae="picture")}var et=this.props.showPrivate;et!==he.showPrivate&&this.getStorageSetting(),this.setState({checkedList:Ee,page:{resourceClassify:"0",keyword:"",contentType:this.props.contentType,pageNumber:1,pageSize:10,excludeType:this.props.excludeType===""?"zip,rar":"".concat(this.props.excludeType,",zip,rar")},setButtonDisabled:Ae,activeTabKey:Ve.length>0?Ve[0].id:"public",classifyData:{}},()=>{this.getList(),this.getCount()})}}render(){var he=this.props,Ee=he.t,ve=he.excludeType,be=he.shouldRenderCreateBtns,Ve=he.replaceStatus,Ae=he.visible,at=he.title,et=he.onlyShowStorageTabKey,ut=he.isSearchOneResource,q=he.contentType,Oe=this.state,Je=Oe.classifyData,je=Oe.coursewares,Be=Oe.coursewaresData,St=Oe.total,Lt=Oe.classifyCount,Wt=Oe.checkedList,pa=Oe.isLoading,Xt=Oe.page,Et=Oe.setButtonDisabled,Fe=Oe.storageTabs,Pe=Fe===void 0?[]:Fe,Ie=Oe.activeTabKey,$e=Pe.length>0?Pe[0].id:"public",te=this.getTabType();return le.okText="".concat(Ee("common.ok"),"(").concat(Wt.length,")"),y().createElement(c.Om,(0,O.Z)({},le,{visible:Ae,title:at,onCancel:this.onCancel,onOk:this.onOk}),y().createElement("div",{className:"courseware"},y().createElement("div",{className:"courseware_left"},y().createElement("div",{className:"courseware_left__tabs"},y().createElement(o.Z,{defaultActiveKey:$e,onChange:this.handleTabChange,size:"small"},Pe.map(ae=>y().createElement(R,{tab:ae.name,key:ae.id})))),y().createElement(I.Z,{privatization:Ie==="public"?null:Ie,onChangeClassify:this.onChangeClassify,total:St})),y().createElement("div",{className:"courseware__right"},y().createElement(_e,{classifyData:Je,getQueryData:this.getQueryData,getCount:this.getCount,classifyCount:Lt,excludeType:ve,classifyId:Xt.resourceClassify,shouldRenderCreateBtns:be,replaceStatus:et?!1:Ve,setButtonDisabled:Et,showHtml:te,isSearchOneResource:ut,contentType:q}),y().createElement(m,{isLoading:pa,coursewares:je,paginationData:Be,onChangePageNumber:this.onChangePageNumber,checkOne:this.checkOne,checkAll:this.checkAll,onRefresh:this.handleRefresh,replaceStatus:Ve}))))}}X.defaultProps={componentName:"ClCoursewareSelector",title:p.Z.t("component.addCourseware"),visible:!1,defaultChecked:[],excludeType:"",shouldRenderCreateBtns:!1,onCancel:()=>{},onOk:()=>{},contentType:"",resourceLocked:!1,onlyShowStorageTabKey:"",isSearchOneResource:!1};var ce=(0,B.$j)(H)((0,C.Z)()(X));ce.CoursewareTree=I.Z;var Te=ce},10659:function(gt,Se,e){"use strict";e.d(Se,{rD:function(){return F},S3:function(){return ue},NQ:function(){return Ne},Rk:function(){return ie},XE:function(){return _e},je:function(){return ne},B_:function(){return Ze}});var O=e(77883),g=e(21888),b=e(12924),a=e.n(b),T=e(80991),o=e(91768),D=j=>{var R=j.t,le=j.formik,H=j.name,X=j.defaultValue,ce=Te=>{le.setFieldValue(H,Te||1)};return a().createElement(a().Fragment,null,a().createElement(g.Z,{precision:0,min:1,max:99999,value:X,onChange:ce}),a().createElement("span",{style:{marginLeft:"10px"}},R("common.day")))},K=(0,T.$j)((0,o.Z)()(D)),P=e(88983),y=e(47933),C=j=>{var R=j.formik,le=j.name,H=j.defaultValue,X=j.valueList,ce=Te=>{R.setFieldValue(le,Te.target.value)};return a().createElement(y.ZP.Group,{onChange:ce,value:H},X.map(Te=>a().createElement(y.ZP,{value:Te.value,key:Te.value}," ",Te.label," ")))},p=(0,T.$j)((0,o.Z)()(C)),B=e(43358),c=e(34041),I=e(62615),M=j=>{var R=j.t,le=j.formik,H=j.value,X=(ce,Te)=>{var Le=Te==="num"?ce||1:ce;Te==="type"&&(ce===I.Eu.WEEK||ce===I.Eu.MONTH)?le.setFieldValue("loopType",{type:ce,num:1}):le.setFieldValue("loopType.[".concat(Te,"]"),Le)};return a().createElement(a().Fragment,null,a().createElement(g.Z,{precision:0,min:1,max:999,disabled:H.type===I.Eu.WEEK||H.type===I.Eu.MONTH,value:H.num,onChange:ce=>{X(ce,"num")}}),a().createElement(c.Z,{value:H.type,style:{width:60,marginLeft:"8px"},onChange:ce=>{X(ce,"type")}},a().createElement(c.Z.Option,{value:I.Eu.DAY},R("eTouch.day")),a().createElement(c.Z.Option,{value:I.Eu.WEEK},R("eTouch.week")),a().createElement(c.Z.Option,{value:I.Eu.MONTH},R("eTouch.month"))))},v=(0,T.$j)((0,o.Z)()(M)),A=e(14965),d=e(11448),l=e(88986),t=e(78138),h=e.n(t),F={UNLIMITED:"unlimited",FIXED_TIME:"fixedTime",FIXED_COUNT:"fixedCount"},m=j=>j&&j<h()().subtract(1,"days").endOf("day"),E=j=>{var R=j.t,le=j.formik,H=j.value,X=j.customDisabledDate,ce=j.valueType,Te=j.loopType;(0,b.useEffect)(()=>{(Te.type===I.Eu.WEEK||Te.type===I.Eu.MONTH)&&H.type===F.FIXED_COUNT&&le.setFieldValue("endLoop",(0,l.Z)((0,l.Z)({},H),{},{type:F.FIXED_TIME,time:void 0}))},[Te,H]);var Le=(he,Ee)=>{var ve=Ee==="num"?he||1:ce==="timeStamp"&&he?he.valueOf():he;le.setFieldValue("endLoop.[".concat(Ee,"]"),ve)};return a().createElement(a().Fragment,null,a().createElement(c.Z,{value:H.type,style:{width:116,marginRight:"8px"},onChange:he=>{Le(he,"type")}},Te.type===I.Eu.DAY&&a().createElement(c.Z.Option,{value:F.FIXED_COUNT},R("eTouch.endFrequency")),a().createElement(c.Z.Option,{value:F.FIXED_TIME},R("eTouch.endDay")),a().createElement(c.Z.Option,{value:F.UNLIMITED},R("eTouch.endUnlimited"))),H.type===F.FIXED_COUNT&&a().createElement(a().Fragment,null,a().createElement(g.Z,{precision:0,min:1,max:999,value:H.num,onChange:he=>{Le(he,"num")}}),a().createElement("span",{style:{marginLeft:"8px"}},R("eTouch.endTip"))),H.type===F.FIXED_TIME&&a().createElement(d.Z,{showTime:!0,style:{width:252},placeholder:R("examination.loopEndTimePlaceholder"),format:"YYYY-MM-DD HH:mm",disabledDate:X||m,value:H.time?h()(H.time):void 0,onChange:he=>Le(he,"time")}))};E.defaultProps={customDisabledDate:m,valueType:"timeStamp"};var Q=(0,T.$j)((0,o.Z)()(E)),G=e(62029),V=e(81211),z=e(7584),$=j=>{var R=j.t,le=j.formik,H=j.name,X=(0,V.Z)(j,["t","formik","name"]),ce=Te=>{le.setFieldValue(Te)};return a().createElement(z.t,(0,G.Z)({type:"text",placeholder:R("common.pleaseEnter")+R("eTouch.taskNameLabel")},X,{onInput:ce}))},W=(0,T.$j)((0,o.Z)()($)),S=e(30553),x=e.n(S),U=e(40646),L=j=>{var R=j.t,le=j.formik,H=j.name,X=j.value,ce=Te=>{var Le=[...X];switch(Te.value){case"creator":Te.checked?!Le.includes("creator")&&Le.push("creator"):Le=Le.filter(he=>he!=="creator");break;case"supervisor":Te.checked?!Le.includes("supervisor")&&Le.push("supervisor"):Le=Le.filter(he=>he!=="supervisor");break;case"leader":Te.checked?!Le.includes("leader")&&Le.push("leader"):Le=Le.filter(he=>he!=="leader");break;case"tutor":Te.checked?!Le.includes("tutor")&&Le.push("tutor"):Le=Le.filter(he=>he!=="tutor");break;default:break}le.setFieldValue(H,Le)};return a().createElement(a().Fragment,null,a().createElement(U.l,{values:X,labelClassName:x()["label-checkbox-button"],options:[{label:R("eTouch.creator"),disabled:!!(X.length===1&&X.includes("creator")),disabledTip:X.length===1&&X.includes("creator")?R("eTouch.onlyPushObject"):"",value:"creator"},{label:R("eTouch.supervisor"),disabled:!!(X.length===1&&X.includes("supervisor")),disabledTip:X.length===1&&X.includes("supervisor")?R("eTouch.onlyPushObject"):"",value:"supervisor"},{label:R("eTouch.charge"),disabled:!!(X.length===1&&X.includes("leader")),disabledTip:X.length===1&&X.includes("leader")?R("eTouch.onlyPushObject"):"",value:"leader"},{label:R("eTouch.tutor"),disabled:!!(X.length===1&&X.includes("tutor")),disabledTip:X.length===1&&X.includes("tutor")?R("eTouch.onlyPushObject"):"",value:"tutor"}],onChange:ce}))},w=(0,T.$j)((0,o.Z)()(L)),k=e(43859),ne=(0,k.Z)(K),ie=(0,k.Z)(p),Ne=(0,k.Z)(v),ue=(0,k.Z)(Q),_e=(0,k.Z)(W),Ze=(0,k.Z)(w)},14923:function(gt,Se,e){"use strict";var O=e(20228),g=e(11382),b=e(62029),a=e(13062),T=e(71230),o=e(77576),D=e(59314),K=e(89032),P=e(15746),y=e(71194),C=e(57016),p=e(88986),B=e(57361),c=e(34792),I=e(48086),M=e(33565),v=e(9754),A=e.n(v),d=e(12924),l=e.n(d),t=e(91768),h=e(80991),F=e(78138),m=e.n(F),E=e(10659),Q=e(38367),G=e(15215),V=e(18329),z=e(62615),$=e(52670),W=e(35085),S=x=>{var U=x.t,L=x.visible,w=x.onCancel,k=x.isOpenLoop,ne=x.title,ie=x.onOperateSuccessCallback,Ne=x.getAssignSettingApiUrl,ue=x.closeSettingApiUrl,_e=x.loopTaskAssignApiUrl,Ze=x.loopTaskAssignApiParams,j=x.planId,R=x.modalTitle,le=x.label,H=x.ruleTip,X=x.type,ce=X===void 0?"":X,Te=x.scenes,Le=Te===void 0?"":Te,he=x.period_type,Ee=he===void 0?"":he,ve=(0,d.useState)(k),be=(0,M.Z)(ve,2),Ve=be[0],Ae=be[1],at=(0,d.useState)(!0),et=(0,M.Z)(at,2),ut=et[0],q=et[1],Oe=(0,d.useState)(!1),Je=(0,M.Z)(Oe,2),je=Je[0],Be=Je[1],St=(0,d.useState)(!1),Lt=(0,M.Z)(St,2),Wt=Lt[0],pa=Lt[1],Xt=(0,d.useRef)(null),Et=(0,d.useRef)({inEffectLoop:!1}),Fe=(0,d.useState)({startTime:void 0,taskName:"[".concat(U("examination.loop"),"]").concat(ne)||0,period:1,employeeRange:{rangeType:2,rangeList:{dept:[],post:[],group:[],user:[]}},endLoop:{type:E.rD.FIXED_COUNT,num:1,time:void 0},loopType:{num:1,type:z.Eu.DAY},loopCycle:{days:[],dates:[]},personnel:["creator"]}),Pe=(0,M.Z)(Fe,2),Ie=Pe[0],$e=Pe[1];(0,d.useEffect)(()=>{k?(q(!0),(0,G.d)(Ne,{period_type:Ee}).then(Zt=>{var bt=Zt.data,Ft=bt.code,Ut=bt.data;if(Ft==="200000"&&Ut){var ca=Ut.assign_config,Qt=Ut.assign_object,Va=Ut.period_enabled;if(Va==="true"?(Et.current.inEffectLoop=!0,Ae(!0)):Va==="false"&&(Et.current.inEffectLoop=!1,Ae(!1)),ca&&Qt){var Ra=Qt.user,Ua=Qt.post,ja=Qt.department,ua=Qt.group,ts=Qt.any_type,as=ca.begin_time,Fa=ca.end_time,Sa=ca.task_name,us=ca.task_interval,Ds=ca.count,Za=ca.cycle_end_style,ga=ca.cycle_interval,Ga=ca.cycle_values,La=ca.cycle_time_type,fa={startTime:as&&m()(+as)||void 0,taskName:Sa||ne||"",period:us,endLoop:{type:Za,num:Ds,time:Fa?+Fa:void 0},loopType:{num:ga,type:La},loopCycle:{days:La===z.Eu.WEEK?Ga.split(",").map(ke=>ke-1):"",dates:La===z.Eu.MONTH?Ga.split(",").map(ke=>ke-1):""},employeeRange:{rangeType:2,rangeList:{dept:ja||[],post:Ua||[],group:ua||[],user:Ra||[]}},personnel:ts?ts.split(","):["creator"]};$e(fa)}q(!1)}}).finally(()=>{})):q(!1)},[k,ne]);var te=()=>{w()},ae=()=>{Ve?Xt.current.submitForm():(0,G.jW)(ue,{period_type:Ee}).then(Zt=>{var bt=Zt.data,Ft=bt.code;Ft==="200000"&&(ie(),Le==="reminder"?I.default.success(U("examination.closeLoopSuccessTip")):I.default.success(U("examination.closeLoopSuccess")),te())})},Re=function(){var Zt=(0,B.Z)(A().mark(function bt(Ft){var Ut,ca,Qt,Va,Ra,Ua,ja,ua,ts,as,Fa,Sa,us;return A().wrap(function(Za){for(;;)switch(Za.prev=Za.next){case 0:return Be(!0),Ut=Ft.startTime,ca=Ft.taskName,Qt=Ft.period,Va=Ft.employeeRange,Ra=Ft.personnel,Ua=Ft.endLoop,ja=Ft.loopType,ua=Ft.loopCycle,ts=(ga,Ga)=>ga.type===z.Eu.WEEK?Ga.days.map(La=>La+1).join(","):ga.type===z.Eu.MONTH?Ga.dates.map(La=>La+1).join(","):"",as={assign_config:{task_name:ca,begin_time:m()(Ut).startOf("minute").unix()*1e3,task_interval:Qt,cycle_time_type:ja.type,cycle_interval:ja.num,cycle_values:ts(ja,ua),cycle_end_style:Ua.type,count:Ua.type===E.rD.FIXED_COUNT?Ua.num:"",end_time:Ua.type===E.rD.FIXED_TIME?m()(Ua.time).startOf("minute").unix()*1e3:"",type:ce,scenes:Le},assign_object:{user_list:Va.rangeList.user.map(ga=>ga.id)||[],post_list:Va.rangeList.post.map(ga=>ga.id)||[],department_list:Va.rangeList.dept.map(ga=>ga.id)||[],group_list:Va.rangeList.group.map(ga=>ga.id)||[]}},Le==="reminder"&&(as.assign_object.any_type=Ra.join()),Fa=(0,p.Z)((0,p.Z)({},Ze),as),Le||delete Fa.assign_config.scenes,ce||delete Fa.assign_config.type,Za.prev=8,Za.next=11,(0,G.rW)(_e,Fa);case 11:Sa=Za.sent,us=Sa.data,us.code==="200000"?(Le==="reminder"?I.default.success(U("setting.setUpSucceed")):I.default.success(U("eTouch.repeatSubmit")),ie&&ie(),w(),Be(!1)):(I.default.error(us.message),Be(!1)),Za.next=19;break;case 16:Za.prev=16,Za.t0=Za.catch(8),Be(!1);case 19:case"end":return Za.stop()}},bt,null,[[8,16]])}));return function(Ft){return Zt.apply(this,arguments)}}(),de=function(){var Zt=(0,B.Z)(A().mark(function bt(Ft){var Ut,ca,Qt,Va,Ra,Ua;return A().wrap(function(ua){for(;;)switch(ua.prev=ua.next){case 0:if(Ut=ts=>{var as=ts.content,Fa=ts.checked;C.Z.confirm({title:U("common.tip"),content:as,okText:U("common.ok"),cancelText:U("common.cancel"),onOk:()=>{Ae(Fa)},onCancel:()=>{Ae(!Fa)}})},!(Et.current.inEffectLoop&&Ve&&j&&Le!=="reminder")){ua.next=22;break}return pa(!0),ua.prev=3,ua.next=6,(0,W.ry)(j);case 6:if(ca=ua.sent,Qt=ca.data,Va=Qt.code,Ra=Qt.data,pa(!1),Va!=="200000"){ua.next=15;break}if(Ua=Ra.has_end,!(Ua==="false"||Ua===!1)){ua.next=14;break}return ua.abrupt("return",Ut({content:l().createElement("div",{className:"confirm-content"},l().createElement("div",{className:"content-top"},l().createElement("span",{className:"top-tip"},U("examination.closeLoopModalContent"),"\uFF1F")),l().createElement("span",{className:"bottom-tip"},U("examination.closeLoopModalContentTip")))}));case 14:Ae(Ft);case 15:ua.next=20;break;case 17:ua.prev=17,ua.t0=ua.catch(3),pa(!1);case 20:ua.next=23;break;case 22:Ae(Ft);case 23:case"end":return ua.stop()}},bt,null,[[3,17]])}));return function(Ft){return Zt.apply(this,arguments)}}(),we={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},rt={okText:U("common.ok"),cancelText:U("common.cancel"),size:"medium",destroyOnClose:!0,bodyStyle:{padding:"32px"},wrapClassName:"modal-config-repeat-assignment-rule",maskClosable:!1,okButtonProps:{loading:je}},mt=l().createElement("div",{className:"repeat-assignment-form__addstaff"},U("eTouch.addStaffTitle"));return l().createElement(V.ZP,(0,b.Z)({title:R},rt,{visible:L,onCancel:te,onOk:ae}),l().createElement(g.Z,{spinning:ut},l().createElement(l().Fragment,null,l().createElement("div",{className:"repeat-assignment-rule"},H&&l().createElement("p",{className:"repeat-assignment-rule__tip"},H),l().createElement(T.Z,null,l().createElement(P.Z,{span:4,className:"repeat-assignment-rule__label"}," ",le&&le.switchTitle?le.switchTitle:U("eTouch.repeatSwitch")," "),l().createElement(P.Z,{span:20},l().createElement(D.Z,{loading:Wt,checked:Ve,onChange:de,checkedChildren:U("customFields.open"),unCheckedChildren:U("customFields.close")})))),!ut&&Ve&&l().createElement(h.J9,{ref:Xt,initialValues:Ie,onSubmit:Re},Zt=>{var bt=Zt.values,Ft=bt.startTime,Ut=bt.loopCycle,ca=bt.loopType,Qt=bt.employeeRange,Va=bt.period;return l().createElement(l().Fragment,null,l().createElement(h.l0,{className:"repeat-assignment-form"},l().createElement(h.gN,(0,b.Z)({component:z.Mt,valueType:"timeStamp",displayType:"Custom",name:"startTime",label:U("common.beginTime"),style:{minWidth:"320px"},required:!0,placeholder:U("common.selectP",{name:U("common.beginTime")}),defaultFieldList:Ft,validate:Q.zO},we)),l().createElement(h.gN,(0,b.Z)({component:E.NQ,displayType:"Custom",name:"loopType",label:le&&le.loopType?le.loopType:U("eTouch.loopTypeLabel"),style:{width:"300px"},required:!0},we)),(ca.type===z.Eu.WEEK||ca.type===z.Eu.MONTH)&&l().createElement(h.gN,(0,b.Z)({component:z.yK,displayType:"Custom",name:"loopCycle",label:le&&le.loopCycle?le.loopCycle:U("eTouch.loopCycleLabel"),required:!0,style:{minWidth:"320px"},value:Ut,validate:Ra=>(0,$.kT)(Ra,ca.type)},we)),l().createElement(h.gN,(0,b.Z)({component:E.S3,displayType:"Custom",name:"endLoop",label:le&&le.endLoop?le.endLoop:U("eTouch.endLoopLabel"),required:!0,loopType:ca,validate:Ra=>(0,Q.Kt)(Ra,Ft)},we)),Le==="reminder"?l().createElement(h.gN,(0,b.Z)({component:E.B_,name:"personnel",label:U("eTouch.pushObj"),required:!0,formItemClassName:"personnel-task-margin-bottom"},we)):l().createElement(l().Fragment,null,l().createElement(h.gN,(0,b.Z)({component:E.XE,LimitLength:60,showCount:!0,char:!0,width:"300px",name:"taskName",label:U("eTouch.taskNameLabel"),required:!0,valueSlice:!0,validate:Q.mD},we)),l().createElement(h.gN,(0,b.Z)({component:E.je,name:"period",label:U("eTouch.taskRange"),required:!0,defaultValue:Va},we)),l().createElement(h.gN,{component:z.ww,displayType:"Custom",required:!0,formItemClassName:"repeat-assignment-label__employeeRange",secTitle:mt,name:"employeeRange",showUserCount:!1,defaultFieldList:(0,p.Z)((0,p.Z)({},Qt),{},{rangeType:2}),mode:["part"],validate:Ra=>(0,$.FI)(Ra,U("validation.employeeNull"))})),l().createElement(z.I,null)))}))))};S.defaultProps={visible:!1,isOpenLoop:!1,title:"",getAssignSettingApiUrl:"",getAssignSettingParams:"",closeSettingApiUrl:"",closeSettingApiParams:{},loopTaskAssignApiUrl:"",loopTaskAssignApiParams:{},onCancel:null},Se.Z=(0,t.Z)()(S)},15215:function(gt,Se,e){"use strict";e.d(Se,{aL:function(){return g},rW:function(){return b},d:function(){return a},jW:function(){return T},Vl:function(){return o}});var O=e(10237);function g(D,K){return O.WY.post({url:D,data:K})}function b(D){var K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return O.WY.post({url:D,data:K})}function a(D){var K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return O.WY.get({url:D,params:K})}function T(D){var K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return O.WY.post({url:D,data:K})}function o(D){var K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return O.WY.get({url:D,param:K})}},43720:function(gt,Se,e){"use strict";e.d(Se,{Z:function(){return U}});var O=e(20228),g=e(11382),b=e(62029),a=e(34792),T=e(48086),o=e(88986),D=e(57361),K=e(33565),P=e(9754),y=e.n(P),C=e(12924),p=e.n(C),B=e(91768),c=e(80991),I=e(78138),M=e.n(I),v=e(15215),A=e(10659),d=e(38367),l=e(62615),t={NOW:"now",TIMING:"timing"},h=L=>{var w=L.t,k=L.values,ne=L.releaseOptions,ie=ne.filter(ue=>ue!==t.TIMING).map(ue=>({value:ue,label:w("eTouch.release".concat(ue))})),Ne={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}};return p().createElement("div",null,p().createElement("div",{className:"e-touch-form-item-title"},"  ",w("study.releaseTime")),p().createElement(c.gN,(0,b.Z)({component:A.Rk,name:"releaseType",label:w("exam.releaseType"),required:!0,defaultValue:k.releaseType,valueList:ie},Ne)),k.releaseType===t.TIMING&&p().createElement(c.gN,(0,b.Z)({component:l.Mt,displayType:"Custom",name:"releaseTime",label:w("study.releaseTime"),style:{width:"366px"},required:!0,defaultFieldList:k.releaseTime,validate:d.t0},Ne)))};h.defaultProps={values:{},releaseOptions:[t.NOW,t.TIMING]};var F=(0,B.Z)()((0,c.$j)(h)),m={TIME_FRAME:"timeFrame",TIME_INTERVAL:"timeInterval"},E=L=>{var w=L.t,k=L.values,ne=L.periodOptions,ie=L.customerShowTime,Ne=ie===void 0?!1:ie,ue=L.showTime,_e=ue===void 0?!0:ue,Ze=ne.map(R=>({value:R,label:w("eTouch.fixed".concat(R))})),j={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}};return p().createElement("div",null,p().createElement("div",{className:"e-touch-form-item-title"}," ",w("eTouch.taskRange")),Ze.length>1&&p().createElement(c.gN,(0,b.Z)({component:A.Rk,name:"periodType",label:w("eTouch.periodType"),required:!0,defaultValue:k.periodType,valueList:Ze},j)),k.periodType===m.TIME_FRAME?p().createElement(c.gN,(0,b.Z)({component:l.C0,displayType:"Custom",customerShowTime:Ne,showTime:_e,name:"dateRange",label:w("eTouch.taskRange"),required:k.periodType===m.TIME_FRAME,defaultFieldList:k.dateRange,validate:d.V5},j)):p().createElement(c.gN,(0,b.Z)({component:A.je,name:"period",label:w("eTouch.taskRange"),required:k.periodType===m.TIME_INTERVAL,defaultValue:k.period},j)))};E.defaultProps={values:{},periodOptions:[m.TIME_FRAME,m.TIME_INTERVAL]};var Q=(0,B.Z)()((0,c.$j)(E)),G=e(18329),V=e(7584),z=e(52670),$=e(31459),W=e(38642),S={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},x=L=>{var w=L.t,k=L.title,ne=L.visible,ie=L.hasPeriod,Ne=L.periodOptions,ue=L.hasRelease,_e=L.releaseOptions,Ze=L.onCancel,j=L.apiUrl,R=L.params,le=L.onOperateSuccessCallback,H=L.projectName,X=L.zaraEvaluateUrl,ce=L.wholeLoad,Te=L.customerShowTime,Le=Te===void 0?!1:Te,he=L.showTime,Ee=he===void 0?!0:he,ve=L.isTaskAssignment,be=(0,C.useState)(!1),Ve=(0,K.Z)(be,2),Ae=Ve[0],at=Ve[1],et=(0,C.useState)(!1),ut=(0,K.Z)(et,2),q=ut[0],Oe=ut[1],Je=(0,C.useState)(""),je=(0,K.Z)(Je,2),Be=je[0],St=je[1],Lt=we=>{St(we)},Wt=()=>{ce&&q||Ze()},pa=()=>{Be.submitForm()},Xt=function(){var we=(0,D.Z)(y().mark(function rt(mt){var Zt,bt,Ft,Ut,ca,Qt,Va,Ra,Ua,ja,ua,ts;return y().wrap(function(Fa){for(;;)switch(Fa.prev=Fa.next){case 0:return at(!0),Oe(!0),ce&&setTimeout(()=>{Oe(!1)},1e4),Zt=mt.periodType,bt=mt.dateRange,Ft=mt.period,Ut=mt.employeeRange,ca=mt.releaseType,Qt=mt.releaseTime,Va=mt.lecturer_name,Ra=mt.user_id,Ua={assign_config:{time_type:Zt,begin_time:Zt===m.TIME_FRAME?M()(bt.startTime).startOf("minute").unix()*1e3:"",end_time:Zt===m.TIME_FRAME?M()(bt.endTime).startOf("minute").unix()*1e3+59e3:"",interval:Zt===m.TIME_INTERVAL?Ft:"",release_type:ue?ca:t.NOW,release_time:ca===t.TIMING?Qt:""},assign_object:{user_list:Ut.rangeList.user.map(Sa=>Sa.id),post_list:Ut.rangeList.post.map(Sa=>Sa.id),department_list:Ut.rangeList.dept.map(Sa=>Sa.id),group_list:Ut.rangeList.group.map(Sa=>Sa.id)},lecturer_name:Va,tutor_id:Ra},ja=(0,o.Z)((0,o.Z)({},R),Ua),Fa.prev=6,Fa.next=9,(0,v.aL)(j,ja);case 9:ua=Fa.sent,ts=ua.data,ts.code==="200000"?(T.default.success(w("setting.addSucceed")),le&&le(),Ze(),at(!1),Oe(!1)):(T.default.error(ts.message),at(!1),Oe(!1)),Fa.next=18;break;case 14:Fa.prev=14,Fa.t0=Fa.catch(6),at(!1),Oe(!1);case 18:case"end":return Fa.stop()}},rt,null,[[6,14]])}));return function(mt){return we.apply(this,arguments)}}(),Et={projectName:H,periodType:Ne[0]||m.TIME_FRAME,period:1,dateRange:{startTime:null,endTime:null},employeeRange:{rangeType:"",rangeList:{dept:[],post:[],group:[],user:[]}},releaseType:ue?_e[0]:t.NOW,releaseTime:null,lecturer_name:"",user_id:""},Fe={okText:w("common.ok"),cancelText:w("common.cancel"),size:"medium",destroyOnClose:!0,bodyStyle:{padding:"0"},maskClosable:!1,okButtonProps:{loading:Ae},wrapClassName:"task-assignment-modal",cancelButtonProps:{disabled:q}},Pe={zaraFlag:(0,W.UI)("ZARA_H5")},Ie=(0,C.useState)(!1),$e=(0,K.Z)(Ie,2),te=$e[0],ae=$e[1],Re=function(){var we=(0,D.Z)(y().mark(function rt(){var mt,Zt,bt;return y().wrap(function(Ut){for(;;)switch(Ut.prev=Ut.next){case 0:return Ut.prev=0,Ut.next=3,(0,v.Vl)(X,{});case 3:Zt=Ut.sent,bt=Zt.data,bt.code==="200000"&&((mt=bt.data)===null||mt===void 0?void 0:mt.score_type)==="contains_evaluate"?ae(!0):ae(!1),Ut.next=11;break;case 8:Ut.prev=8,Ut.t0=Ut.catch(0),ae(!1);case 11:case"end":return Ut.stop()}},rt,null,[[0,8]])}));return function(){return we.apply(this,arguments)}}();(0,C.useEffect)(()=>{Pe.zaraFlag&&Re()},[]);var de=we=>p().createElement("span",{className:"zara-lecturer"},p().createElement("div",{className:"e-touch-form-item-title"},w("learning.learningAddTutorManage")),p().createElement(c.gN,(0,b.Z)({name:"lecturer_name",required:!0,label:w("learning.learningSelectedTutor"),lectureInfo:{default_avatar:"".concat("https://oss.coolcollege.cn","/1790708689137700864.png"),lectureSyncUserId:"",lectureSourceType:""},defaultValue:we.lecturer_name,lecturerName:we.lecturer_name,validate:z.t3,component:$.Z},S)));return p().createElement(G.ZP,(0,b.Z)({title:k||w("eTouch.taskAssignment")},Fe,{visible:ne,onCancel:Wt,onOk:pa}),p().createElement(g.Z,{spinning:ce&&q},p().createElement(c.J9,{ref:Lt,initialValues:Et,onSubmit:Xt},we=>{var rt=we.values;return p().createElement(c.l0,{className:"students-assignment-form"},ve?p().createElement("div",{className:"task-assignment-tip"},w("trainingProject.taskAssignTip")):"",ie&&p().createElement(Q,{values:rt,periodOptions:Ne,customerShowTime:Le,showTime:Ee}),Et.projectName?p().createElement(c.gN,(0,b.Z)({component:V.Z,displayType:"Custom",label:w("employeeSummary.projectName"),name:"projectName",isPreview:!0,style:{width:"70%"},defaultFieldList:rt.projectName},S)):null,p().createElement("div",null,p().createElement(c.gN,{component:l.ww,displayType:"Custom",secTitle:w("eTouch.addStaffTitle"),name:"employeeRange",defaultFieldList:rt.employeeRange,mode:["part"],validate:z.FI})),p().createElement("div",null,Pe.zaraFlag&&te&&de(rt)),ue&&p().createElement(F,{values:rt,releaseOptions:_e}),p().createElement(l.I,null))})))};x.defaultProps={title:"",visible:!1,hasPeriod:!0,periodOptions:[m.TIME_FRAME,m.TIME_INTERVAL],hasRelease:!1,releaseOptions:[t.NOW,t.TIMING],apiUrl:"",params:{},onCancel:()=>{},wholeLoad:!1};var U=(0,B.Z)()(x)},38367:function(gt,Se,e){"use strict";e.d(Se,{V5:function(){return D},t0:function(){return K},mD:function(){return P},zO:function(){return y},Kt:function(){return C}});var O=e(10659),g=e(6793),b=e(3407),a=(0,g.me)(),T=b.Z[a].eTouch.validation,o=b.Z[a].examination,D=p=>{if(!p.startTime||!p.endTime)return T.dateRange;var B=new Date(p.startTime).getTime(),c=new Date(p.endTime).getTime();return c<Date.now()?o.checkEndTime:c<B?o.checkStartAndEndTime:""},K=p=>{if(!p)return T.checkReleaseTime;var B=new Date(p).getTime();return B<Date.now()?T.checkDatePickerNow:""},P=p=>(0,g.fy)(p)?"":T.checkTaskNameNull,y=p=>{if(!p)return T.checkStartTime;var B=new Date(p).getTime();return B<Date.now()?T.checkDatePickerNow:""},C=(p,B)=>{if(p.type===O.rD.UNLIMITED)return"";if(p.type===O.rD.FIXED_COUNT&&!p.num)return o.inputPlaceholder;if(p.type===O.rD.FIXED_TIME){if(!p.time)return T.checkEndLoop;var c=new Date(p.time).getTime();if(c<Date.now())return T.checkDatePickerNow;if(B){var I=new Date(B).getTime();if(c<I)return T.checkEndLoopTime}}return""}},64262:function(gt,Se,e){"use strict";var O=e(88986),g=e(20228),b=e(11382),a=e(22385),T=e(31097),o=e(32157),D=e(75869),K=e(62999),P=e(85733),y=e(12924),C=e.n(y),p=e(91768),B=e(60667),c=e(38642),I=e(10237),M=e(37055),v=P.Z.TreeNode;class A extends C().Component{constructor(l){super(l);this.getDeptTree=t=>{var h=this.props,F=h.filterAuth,m=h.handleLoadedCbk,E=this.state.whiteList,Q=M.ZP.OrgTree.getDeptTree(),G={recursion:!this.props.asyncLoad,query_user_count:this.props.showUserCount,parent_id:t,filter_auth:F,query_selected_user_id:this.props.querySelectedUserId,sync_organization:E.organizationFlag?"lenovo_sync":this.props.organizationType||""};I.WY.get({url:Q,params:G}).then(V=>{var z=this.sumCheckedKeys(V.data.children||[],V.data.selected==="true"?[V.data.id]:[]);m&&m({department_name:V.data.department_name,id:V.data.id,source_type:V.data.source_type}),this.setState({treeData:[{department_name:V.data.department_name,id:V.data.id,source_type:V.data.source_type,children:V.data.children,user_count:V.data.user_count,enable_edit:V.enable_edit,enable_delete:V.enable_delete}],checkedKeys:z}),this.props.handleCheck&&this.props.handleCheck(z)})},this.sumCheckedKeys=(t,h)=>(t instanceof Array&&t.forEach(F=>{F.selected==="true"?h.push(F.id):F.children&&this.sumCheckedKeys(F.children,h)}),h),this.loadChildren=t=>new Promise(h=>{if(t.props.children){h();return}var F=this.props.filterAuth,m=this.state.whiteList,E=M.ZP.OrgTree.getDeptTree(),Q={recursion:!this.props.asyncLoad,query_user_count:this.props.showUserCount,parent_id:t.props.dataRef.id,filter_auth:F,query_selected_user_id:this.props.querySelectedUserId,sync_organization:m.organizationFlag?"lenovo_sync":this.props.organizationType||""};I.WY.get({url:E,params:Q}).then(G=>{if(G.data.children){var V=G.data.children.map($=>({department_name:$.department_name,id:$.id,user_count:$.user_count,selected:$.selected,has_children:$.has_children,enable_edit:$.enable_edit,enable_delete:$.enable_delete,source_type:$.source_type}));t.props.dataRef.children=V;var z=this.sumCheckedKeys(V,this.state.checkedKeys);this.setState({treeData:[...this.state.treeData],checkedKeys:z}),this.props.handleCheck&&this.props.handleCheck(z)}else t.props.dataRef.children=[],this.setState({treeData:[...this.state.treeData]});h()})}),this.handleCheck=t=>{this.setState({checkedKeys:t}),this.props.handleCheck&&this.props.handleCheck(t)},this.treeSelectChange=(t,h)=>{this.setState({treeSelectValue:t});var F=this.props,m=F.handleTreeSelectChange,E=F.onTreeSelectChange;m?m(t||"",h):E&&E(t||"",h)},this.renderTreeNodes=t=>t.map(h=>h.children?C().createElement(D.Z.TreeNode,{title:this.renderTitle(h),key:h.id,value:h.id,isLeaf:h.has_children!=="true",switcherIcon:h.children.length===0?C().createElement("span",null):null,dataRef:h,selected:h.selected==="true"},this.renderTreeNodes(h.children)):C().createElement(D.Z.TreeNode,{title:this.renderTitle(h),dataRef:h,value:h.id,key:h.id,isLeaf:h.has_children!=="true",switcherIcon:this.props.asyncLoad?null:C().createElement("span",null),selected:h.selected==="true"})),this.renderSelectTreeNodes=t=>{var h=this.props.disabledFirstNode,F=this.state.treeData.length?this.state.treeData[0].id:"";return t.map(m=>m.children?C().createElement(v,{title:this.renderTitle(m),key:m.id,value:m.id,isLeaf:!1,switcherIcon:m.children.length===0?C().createElement("span",null):null,dataRef:m,disabled:h?m.id===F:!1,selected:m.selected==="true",departmentName:m.department_name},this.renderSelectTreeNodes(m.children)):C().createElement(v,{title:this.renderTitle(m),dataRef:m,value:m.id,key:m.id,isLeaf:!1,switcherIcon:this.props.asyncLoad?null:C().createElement("span",null),selected:m.selected==="true",departmentName:m.department_name}))},this.dealText=t=>{var h=this.props.showUserCount;return C().createElement(y.Fragment,null,C().createElement(B.Z,{type:t.source_type,value:t.id,node:t,name:t.department_name,dataType:"departmentName"}),h&&C().createElement("span",null,"(",t.user_count,")"))},this.renderTitle=t=>{var h=this.props,F=h.showTitleToolTip,m=h.DeptTreeNodeTitle,E=h.titleOperateProps,Q=E===void 0?{}:E,G=this.dealText(t);return m?C().createElement(m,{title:G,titleOperateProps:Q,deptId:t.id||"1",deptName:t.department_name,enableEdit:t.enable_edit==="true",enableDelete:t.enable_delete==="true"}):F?C().createElement(T.Z,{title:G},C().createElement("span",null,G)):G},this.renderTree=()=>{var t={showLine:{showLeafIcon:!1},checkable:this.props.checkable,checkStrictly:this.props.checkStrictly,checkedKeys:this.state.checkedKeys,onCheck:this.handleCheck,onSelect:this.props.handleSelect,defaultExpandAll:this.props.defaultExpandAll,defaultExpandedKeys:this.state.treeData.length>0?["".concat(this.state.treeData[0].id)]:[""],className:this.props.className};return this.props.asyncLoad&&(t.loadData=this.loadChildren),this.state.treeData.length>0?C().createElement(D.Z,t,this.renderTreeNodes(this.state.treeData)):C().createElement("div",{style:{textAlign:"center"}},C().createElement(b.Z,null))},this.renderTreeSelect=()=>{var t=this.props,h=t.t,F=t.width,m=F===void 0?180:F,E=t.placeholder,Q=t.open,G=(0,O.Z)((0,O.Z)({},this.props),{},{showLine:{showLeafIcon:!1},style:{width:m},value:this.state.treeSelectValue,dropdownStyle:{maxHeight:300,overflow:"scroll",whiteSpace:"nowrap",maxWidth:m},dropdownMatchSelectWidth:!1,treeDefaultExpandedKeys:this.state.treeData.length>0?["".concat(this.state.treeData[0].id)]:[""],placeholder:E||h("component.chooseDeptTip"),allowClear:!0,multiple:this.props.multiple,disabled:this.props.disabled,onChange:this.treeSelectChange,className:this.props.className,treeNodeFilterProp:"departmentName",open:Q});return this.props.asyncLoad&&(G.loadData=this.loadChildren),this.state.treeData.length>=0?C().createElement(P.Z,G,this.renderSelectTreeNodes(this.state.treeData)):C().createElement("div",{style:{textAlign:"center"}})},this.state={treeData:[],checkedKeys:[],treeSelectValue:this.props.defaultValue||[],whiteList:{organizationFlag:(0,c.UI)("ORG_TREE_SYNC_ORGANIZATION")}}}componentDidMount(){this.getDeptTree(this.props.parentId)}componentDidUpdate(l){l.refresh!==this.props.refresh&&this.setState({treeData:[],checkedKeys:[],treeSelectValue:this.props.defaultValue||[]},()=>{this.getDeptTree(this.props.parentId)})}render(){return C().createElement("div",{className:"org-tree-container ".concat(this.props.className)},this.props.treeSelect?this.renderTreeSelect():this.renderTree())}}A.defaultProps={parentId:"",asyncLoad:!1,checkable:!0,disabledFirstNode:!1,querySelectedUserId:"",checkStrictly:!1,showUserCount:!1,showTitleToolTip:!1,defaultExpandAll:!1,multiple:!1,treeSelect:!1,filterAuth:!0,organizationType:"",disabled:!1,handleCheck:()=>{},handleLoadedCbk:()=>{},handleTreeSelectChange:void 0,onTreeSelectChange:void 0},Se.Z=(0,p.Z)("",{withRef:!0})(A)},28391:function(gt,Se,e){"use strict";var O=e(62029),g=e(20228),b=e(11382),a=e(66456),T=e(55313),o=e(57663),D=e(71577),K=e(62999),P=e(85733),y=e(88986),C=e(22385),p=e(31097),B=e(57361),c=e(9754),I=e.n(c),M=e(12924),v=e.n(M),A=e(28216),d=e(91768),l=e(49101),t=e(18329),h=e(37055),F=e(10237),m=e(44881),E=e(86726),Q=e(48479),G=e(95664),V=e(1164),z=e(60667),$={okType:"primary",bodyStyle:{padding:"20px 32px 0"},size:"large",maskClosable:!1},W={pageNumber:1,pageSize:5,courseClassify:"",keyword:""},S=U=>({userInfo:U.user});class x extends M.Component{constructor(L){var w;super(L);w=this,this.onPageChange=k=>{W.pageNumber=k,this.getQuestionBankList()},this.onPageRefresh=()=>{this.getQuestionBankList()},this.onSelect=(k,ne)=>{if(ne){var ie=this.state.selectedRows;this.cachedSelectedRows.push(k),ie.push(k),this.setState({selectedRows:ie})}if(!ne){for(var Ne=null,ue=0;ue<this.cachedSelectedRows.length;ue++)if(this.cachedSelectedRows[ue].id===k.id){Ne=ue;break}this.cachedSelectedRows.splice(Ne,1)}this.setState({selectedList:this.convertQuestionBanks(this.cachedSelectedRows)})},this.onSelectAll=(k,ne,ie)=>{if(k){var Ne=this.cachedSelectedRows;this.cachedSelectedRows=Ne.concat(ie)}if(!k){for(var ue=[],_e=JSON.parse(JSON.stringify(this.cachedSelectedRows)),Ze=0;Ze<_e.length;Ze++)for(var j=0;j<ie.length;j++)if(ie[j].id===_e[Ze].id){ue.push(Ze);break}for(var R=0;R<ue.length;R++)delete _e[ue[R]];this.cachedSelectedRows=_e.filter(le=>le!==void 0)}this.setState({selectedList:this.convertQuestionBanks(this.cachedSelectedRows)})},this.onProductListSelectedRowKeysChange=(k,ne)=>{this.setState({selectedRowKeys:k,selectedRows:ne})},this.initData=k=>{var ne=this.props.privateCustom;W.pageNumber=1,W.pageSize=ne==="maiTian"?100:5,W.keyword="",W.courseClassify="",this.setState({total:0,totalPage:0,loading:!0,classification:[],questionBanks:[],selectedRowKeys:[],selectedRows:[],selectedList:[]},k)},this.getClassification=()=>{var k=h.ZP.Classify.getResourceClassify();F.WY.get({url:k,params:{auth_type:"refer",include_unclassified:"true",parent_id:0}}).then(ne=>{var ie=(0,m.P)(ne.data.list,"refer");this.setState({classification:ie})})},this.loadData=k=>new Promise(ne=>{var ie=k.id;setTimeout(()=>{var Ne=h.ZP.Classify.getResourceClassify(),ue=ie;F.WY.get({url:Ne,params:{parent_id:ue,auth_type:"refer"}}).then(_e=>{if(!_e.data){ne();return}this.setState({classification:[...this.state.classification.concat((0,m.P)(_e.data.list,"refer"))]})}),ne()},300)}),this.getQuestionBankList=(0,B.Z)(I().mark(function k(){var ne,ie,Ne,ue,_e;return I().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(w.setState({loading:!0}),w.props.privateCustom!=="maiTian"){j.next=7;break}return j.next=4,F.WY.post({url:h.ZP.QuestionBankSelector.maiTianGetList(),data:W});case 4:ne=j.sent,j.next=10;break;case 7:return j.next=9,F.WY.get({url:h.ZP.QuestionBankSelector.getList(),params:W});case 9:ne=j.sent;case 10:ie=ne.data.data.list,Ne=w.cachedSelectedRows.map(R=>R.id),ue=ie.filter(R=>Ne.indexOf(R.id)>-1),_e=ue.map(R=>R.id),w.setState({selectedRowKeys:_e,questionBanks:ie,loading:!1,total:ne.data.data.total,totalPage:ne.data.data.pages});case 15:case"end":return j.stop()}},k)})),this.convertQuestionBanks=k=>k.map(ne=>({id:ne.id,name:ne.name,type:"QUESTION_BANK",icon:"",componentName:"QuestionBankSelector",data:ne})),this.handleSaveQuestionBank=()=>{this.props.onOk(this.state.selectedList)},this.handleSelectClassification=k=>{W.courseClassify=k,W.pageNumber=1,this.getQuestionBankList()},this.handleChangeSearchKeyword=(k,ne)=>{W.keyword=k,ne!=="change"&&(W.pageNumber=1,this.getQuestionBankList())},this.state={loading:!0,total:0,classification:[],questionBanks:[],selectedRowKeys:[],selectedRows:[],selectedList:[],shouldRenderAddBank:(0,E.H3)("question",(0,E.V9)("add",this.props.userInfo.modules))},this.tableColumns=[{title:L.t("component.questionBankName"),dataIndex:"name",width:200,render:k=>v().createElement(p.Z,{title:k,placement:"bottomLeft"},v().createElement("div",{className:"fixed-width-col"},k))},{title:L.t("component.questionBankClassify"),dataIndex:"classifyName",width:200,render:k=>v().createElement(p.Z,{title:k,placement:"bottomLeft"},v().createElement("div",{className:"fixed-width-col"},k))},{title:L.t("common.creator"),dataIndex:"createName",render:(k,ne)=>v().createElement(z.Z,{dataType:"userName",value:ne.creator_user_id,name:k,type:ne.creator_source_type})},{title:L.t("component.singleSample"),dataIndex:"singleCount"},{title:L.t("component.multipleSample"),dataIndex:"multipleCount"},{title:L.t("component.tofSample"),dataIndex:"trueOrFalseCount",key:"trueOrFalseCount"},{title:L.t("component.blankSample"),dataIndex:"fillBlankCount"},{title:L.t("component.describeSample"),dataIndex:"shortAnswerCount"}],this.cachedSelectedRows=[]}componentDidMount(){var L=this.props.defaultChecked;L.length&&(this.cachedSelectedRows=L.map(w=>(0,y.Z)((0,y.Z)({},w),w.data)))}componentDidUpdate(L){var w=this.props.visible;w!==L.visible&&w&&this.initData(()=>{this.getClassification(),this.getQuestionBankList();var k=this.props.defaultChecked,ne=k.map(ie=>ie.id);k.length?this.cachedSelectedRows=k.map(ie=>(0,y.Z)((0,y.Z)({},ie),ie.data)):this.cachedSelectedRows=[],this.setState({selectedRowKeys:ne,selectedList:k})})}render(){var L=this.props,w=L.t,k=L.visible,ne=L.tips,ie=this.state,Ne=ie.total,ue=ie.totalPage,_e=ie.selectedRowKeys,Ze=ie.selectedRows,j=ie.shouldRenderAddBank,R={selectedRowKeys:_e,selectedRows:Ze,onSelect:this.onSelect,onSelectAll:this.onSelectAll,onChange:this.onProductListSelectedRowKeysChange};return v().createElement(t.ZP,(0,O.Z)({},$,{title:w("exam.selectBank"),visible:this.props.visible,onOk:this.handleSaveQuestionBank,onCancel:this.props.onCancel,destroyOnClose:!0}),v().createElement("div",{className:"question-set-selector"},k?v().createElement(v().Fragment,null,v().createElement("p",{className:"tips"},ne||w("component.chooseQuestionBankTip")),v().createElement("div",{style:{display:"flex",justifyContent:"space-between"}},v().createElement(P.Z,{allowClear:!0,style:{width:"300px"},treeData:this.state.classification,dropdownStyle:{maxHeight:300,overflow:"auto"},loadData:this.loadData,onChange:this.handleSelectClassification,placeholder:w("component.questionBankClassifyLabel"),treeDataSimpleMode:!0}),v().createElement("div",{style:{display:"flex"}},v().createElement(Q.Z,{onSearch:this.handleChangeSearchKeyword,placeholder:w("searchInputPlaceholder.questionBank"),immediate:!0,width:"238px"}),j?null:v().createElement(V.Z,{to:"/knowledgeBase/examResources/question"},v().createElement(D.Z,{type:"primary",icon:v().createElement(l.Z,null),style:{marginLeft:"8px"}},w("component.addQuestionBank"))))),v().createElement("div",{className:"table-container"},v().createElement(T.Z,{bordered:!0,size:"small",rowKey:le=>le.id,loading:this.state.loading,columns:this.tableColumns,pagination:!1,rowSelection:R,dataSource:this.state.questionBanks}),v().createElement(G.Z,{totalNum:Ne,totalPage:ue,current:W.pageNumber,defaultPageSize:W.pageSize,onChange:this.onPageChange,onRefresh:this.onPageRefresh}))):v().createElement(b.Z,{size:"large"})))}}x.defaultProps={visible:!1,onOk:()=>{},onCancel:()=>{},defaultChecked:[]},Se.Z=(0,A.$j)(S)((0,d.Z)()(x))},24144:function(gt,Se,e){"use strict";e.d(Se,{G2:function(){return $},Sc:function(){return E},Ur:function(){return ce},VI:function(){return at},Lh:function(){return ut},DZ:function(){return d},ZM:function(){return t},tX:function(){return Q},VQ:function(){return M},_D:function(){return L},iM:function(){return w},vx:function(){return k},$Y:function(){return I},ws:function(){return B},Pd:function(){return c}});var O=e(43185),g=e(53251),b=e(62029),a=e(34792),T=e(48086),o=e(88986),D=e(33565),K=e(12924),P=e.n(K),y=e(91768),C=e(10237),p=e(37055);function B(q){var Oe=p.ZP.Common.upload();return C.WY.post({url:Oe,data:q})}function c(q){var Oe=p.ZP.CourseManageList.uploadAiImage();return C.WY.post({url:Oe,data:q})}function I(q){var Oe=p.ZP.CourseManageList.saveAiImage();return C.WY.post({url:Oe,data:q})}function M(q){var Oe=q.idList,Je=p.ZP.CourseManageList.deleteAiImage();return C.WY.put({url:Je,data:{id_list:Oe}})}var v=e(72387),A=e(76343),d={IMAGE:"image"},l=q=>{var Oe=q.uploadConfig,Je=q.uploadType,je=q.clip,Be=q.size,St=q.quality,Lt=q.t,Wt=Array.isArray(q.fileList)?q.fileList:[],pa=(0,K.useState)(!1),Xt=(0,D.Z)(pa,2),Et=Xt[0],Fe=Xt[1],Pe=(0,K.useState)(!1),Ie=(0,D.Z)(Pe,2),$e=Ie[0],te=Ie[1],ae=(0,K.useState)(0),Re=(0,D.Z)(ae,2),de=Re[0],we=Re[1],rt=(0,K.useState)(!1),mt=(0,D.Z)(rt,2),Zt=mt[0],bt=mt[1],Ft=(0,K.useState)({}),Ut=(0,D.Z)(Ft,2),ca=Ut[0],Qt=Ut[1],Va=fa=>{var ke=fa.file;je?Ra({file:ke},je):Ua({file:ke})},Ra=(fa,ke)=>{var Ue=fa.file;ke==="crop"&&(Qt(Ue),as())},Ua=fa=>{var ke=fa.file;Fe(!0);var Ue=new FormData;Ue.append("file",ke),Ga(Ue,Je).then(De=>{var oe="".concat(De.data.data.server,"/").concat(De.data.data.fileNewName),xe=De.data.data.fileNewName,me=[(0,o.Z)({url:oe,uid:xe,name:xe,thumbUrl:oe,status:"done",response:"Server Error 500"},De.data.data)];ua({newImgList:me})}).catch(De=>{ts({error:De,data:{fileList:[{fileName:ke.name}]}})}).finally(()=>{Fe(!1)})},ja=fa=>{q.onUploadedListChange&&q.onUploadedListChange(fa)},ua=fa=>{var ke=fa.newImgList,Ue=Oe.maxCount;q.onUploadSuccess&&q.onUploadSuccess({fileList:[...ke]});var De=[...Wt,...ke],oe=[];typeof Ue=="number"&&Ue===1?oe=ke:typeof Ue=="number"&&De.length>Ue?oe=De.slice(0,Ue+1):oe=De,ja({fileList:oe})},ts=fa=>{var ke=fa.error,Ue=fa.data;q.onUploadFailed&&q.onUploadFailed({error:ke,data:Ue})},as=()=>{bt(!0)},Fa=()=>{bt(!1)},Sa=fa=>{if(q.onBeforeUpload)return q.onBeforeUpload(fa);var ke=Oe.accept;if(ke&&ke.indexOf(fa.name.split(".").pop().toLowerCase())<0)return T.default.error(Lt("component.imgTypeError")),!1;if(Be&&Be.value&&Be.unit){var Ue=Be.value,De=Be.unit,oe=De.toLowerCase()==="kb"?fa.size/1024<Ue:fa.size/1024/1024<Ue;if(!oe)return T.default.error("".concat(Lt("component.imgUploadLimit")).concat(Ue).concat(De,"!")),!1}return!0},us=fa=>{var ke=[...Wt],Ue=ke.findIndex(De=>De.uid===fa.uid);ke.splice(Ue,1),ja({fileList:ke})},Ds=fa=>{var ke=Wt.findIndex(Ue=>Ue.uid===fa.uid);we(ke),te(!0)},Za=()=>{te(!1)},ga=fa=>{var ke=fa.fileName,Ue=fa.imgUrl,De=fa.fileNewName,oe={url:Ue,uid:De,fileName:ke,name:De,thumbUrl:Ue,status:"done"};ua({newImgList:[oe]}),bt(!1)},Ga=(fa,ke)=>ke===d.IMAGE?B(fa):null,La={listType:"picture-card",accept:"*",fileList:[],beforeUpload:Sa,customRequest:Va,onPreview:Ds,onRemove:us};return P().createElement(P().Fragment,null,P().createElement(g.Z,(0,b.Z)({},La,Oe,q,{className:"upload_container_19fb1b0b-5573-42cb-b6a2-b39518df62cd ".concat(q.className)}),q.render((0,o.Z)((0,o.Z)({},q),{},{loading:Et}))),P().createElement(v.Z,{visible:$e,imgList:Wt.map(fa=>fa.url),defaultActive:de,onClose:Za}),Zt&&P().createElement(A.Z,(0,b.Z)({visible:Zt,file:ca,widthScale:16,heightScale:9,sizeLimit:Be.value,sizeLimitUnit:Be.unit,accept:Oe.accept,onCancel:Fa,onOk:ga,onUploadFailed:ts,quality:St},q.imgCropConfig)))};l.defaultProps={fileList:[],uploadType:"image",size:{},clip:"",quality:void 0};var t=(0,y.Z)()(l);function h(q){return(0,o.Z)((0,o.Z)({},q),{},{lastModified:q.lastModified,lastModifiedDate:q.lastModifiedDate,name:q.name,size:q.size,type:q.type,uid:q.uid,percent:0,originFileObj:q})}var F={IMAGE:"image",VIDEO:"video",AUDIO:"audio"},m=q=>{var Oe=(0,K.useRef)({fileList:[],file:{}}),Je=q.uploadConfig,je=q.size,Be=q.t;(0,K.useEffect)(()=>{Oe.current.fileList=q.fileList?q.fileList:[]},[q.fileList]);function St(Xt){var Et=!0;if(je&&je.value&&je.unit){var Fe=je.value,Pe=je.unit,Ie=Pe.toLowerCase()==="kb"?Xt.size/1024<Fe:Xt.size/1024/1024<Fe;Ie||(T.default.error("".concat(Be("component.imgUploadLimit")).concat(Fe).concat(Pe,"!")),Et=!1)}return Et&&(Oe.current.fileList=[...Oe.current.fileList,h(Xt)]),Et}function Lt(Xt){var Et=Xt.file,Fe=Xt.onError,Pe=Xt.onProgress,Ie=Xt.onSuccess,$e=new FormData;return $e.append("file",Et),B($e,{onUploadProgress:te=>{var ae=te.total,Re=te.loaded;Pe({percent:Math.round(Re/ae*100).toFixed(2)},Et)}}).then(te=>{var ae=te.data;Ie(ae,Et)}).catch(Fe),{abort(){console.log("upload progress is aborted.")}}}var Wt={listType:"text",accept:"*",beforeUpload:St,customRequest:Lt,onStart(Xt){Oe.current.file=Xt,Oe.current.fileList=Oe.current.fileList.map(Et=>Et.uid===Xt.uid?(0,o.Z)((0,o.Z)({},Et),{},{status:"uploading"}):Et),q.onChange&&q.onChange(Q({file:Oe.current.file,fileList:Oe.current.fileList}))},onSuccess(Xt,Et){Oe.current.file=Et,Oe.current.fileList=Oe.current.fileList.map(Fe=>Fe.uid===Et.uid?(0,o.Z)((0,o.Z)({},Fe),{},{response:Xt,status:"done"}):Fe),q.onChange&&q.onChange(Q({file:Oe.current.file,fileList:Oe.current.fileList}))},onError(Xt,Et){q.onChange(Q({file:Oe.current.file,fileList:Oe.current.fileList.map(Fe=>Fe.url?Fe:(0,o.Z)((0,o.Z)({},Fe),{},{status:"error"}))}))},onProgress(Xt,Et){var Fe=Xt.percent;Oe.current.file=Et,Oe.current.fileList=Oe.current.fileList.map(Pe=>Pe.uid===Et.uid?(0,o.Z)((0,o.Z)({},Pe),{},{percent:Fe}):Pe),q.onChange&&q.onChange(Q({file:Oe.current.file,fileList:Oe.current.fileList}))}},pa=(0,o.Z)((0,o.Z)({},Wt),Je);return P().createElement(P().Fragment,null,P().createElement(g.Z,pa,q.render((0,o.Z)({},q))))},E=(0,y.Z)()(m);function Q(q){var Oe=q.file,Je=q.fileList;return{file:(0,o.Z)({},Oe),fileList:Je.map(je=>{var Be=je.response,St=je.name,Lt=je.type,Wt=je.size,pa=je.status,Xt=je.percent,Et=je.uid,Fe=je.url;if(Be){var Pe=Be.data,Ie=Be.error;return Ie?(0,o.Z)((0,o.Z)((0,o.Z)({},je),Pe),{},{status:"error"}):(0,o.Z)((0,o.Z)((0,o.Z)({},je),Pe),{},{url:"".concat(Pe.server,"/").concat(Pe.fileNewName)})}return{name:St,size:Wt,type:Lt,percent:Xt,status:pa,url:Fe,uid:Et}})}}function G(q){var Oe=q.name,Je=Oe.match(/\.([0-9a-z]+)(?:[\?#]|$)/i),je=(0,D.Z)(Je,1),Be=je[0];switch(Be.toLowerCase()){case".mp3":return d.AUDIO;case".mp4":return d.VIDEO;case".webp":case".svg":case".png":case".gif":case".jpg":case".jpeg":case".jfif":case".bmp":case".dpg":case".ico":return d.IMAGE;default:return""}}function V(q){var Oe=q.split("/"),Je=Oe[Oe.length-1],je=Je.split(/#|\?/)[0];return(/\.[^./\\]*$/.exec(je)||[""])[0]}var z=q=>P().createElement(t,(0,b.Z)({},q,{uploadConfig:(0,o.Z)((0,o.Z)({},q.uploadConfig),{},{showUploadList:!1,maxCount:1,fileList:q.fileList}),className:"sample_upload_image_container",render:Oe=>L(Oe)}));z.defaultProps={uploadConfig:{listType:"picture-card",maxCount:1},addTitle:"",size:{value:2,unit:"MB"},fileList:[]};var $=(0,y.Z)()(z),W=e(20228),S=e(11382),x=e(7085),U=e(49101),L=q=>{var Oe=q.uploadConfig,Je=q.loading,je=q.fileList,Be=q.addTitle,St=q.changeTip,Lt=St===void 0?"":St,Wt=q.imageContainerClassName,pa=Oe.maxCount;return Je?P().createElement(x.Z,null):je.length>0&&je.length<=pa?P().createElement("div",{className:"avatar_list_container ".concat(Wt)},P().createElement("img",{className:"avatar",src:je[0].url,alt:"img"}),Lt&&P().createElement("div",{className:"change_btn"},Lt)):P().createElement("div",{className:"avatar_select_container"},P().createElement(U.Z,null),P().createElement("div",{className:"avatar_select_tip"},Be))},w=q=>{var Oe=q.uploadConfig,Je=q.loading,je=q.fileList,Be=q.selectTip,St=Oe.maxCount;return Je?P().createElement(x.Z,null):je.length>=St?null:P().createElement("div",{className:"picture_select"},P().createElement(U.Z,null),Be&&P().createElement("div",{className:"picture_select_tip"},Be))},k=q=>{var Oe=q.loading,Je=q.fileList,je=q.changeTip,Be=q.addTitle,St=q.renderClassName,Lt=(0,D.Z)(Je,1),Wt=Lt[0];return Oe?P().createElement(S.Z,{spinning:Oe,indicator:P().createElement(x.Z,{spin:!0})},P().createElement("div",{className:"class_6f5ad7a8_6cee_4858_99d0_b3dd950f662b ".concat(St)})):Wt?P().createElement("div",{className:"class_6f5ad7a8_6cee_4858_99d0_b3dd950f662b ".concat(St)},P().createElement("img",{src:Wt,alt:"image"}),P().createElement("div",{className:"change_btn"},je)):P().createElement("div",{className:"upload_btn_container ".concat(St)},P().createElement("div",{className:"upload_btn"},P().createElement(U.Z,null),Be&&P().createElement("div",{className:"avatar_select_tip"},Be)))},ne=q=>{var Oe=q.loading,Je=q.fileList,je=q.changeTip,Be=q.reset,St=q.renderClassName,Lt=_slicedToArray(Je,1),Wt=Lt[0],pa=Xt=>{Xt.stopPropagation(),Be.resetEvent&&Be.resetEvent(Xt)};return Oe?React.createElement(_Spin,{spinning:Oe,indicator:React.createElement(LoadingOutlined,{spin:!0})},React.createElement("div",{className:"class_bf5f55ec_25c6_45b1_b5a4_f5b467257caa ".concat(St)})):React.createElement("div",{className:"class_bf5f55ec_25c6_45b1_b5a4_f5b467257caa ".concat(St)},React.createElement("img",{src:Wt,alt:"image"}),React.createElement("div",{className:"change_btns"},React.createElement("span",{className:"operate_item operate_change"},je),React.createElement("span",{onClick:Xt=>{pa(Xt)},className:"operate_item operate_reset"},Be.tip)))},ie=e(84874),Ne=q=>{var Oe=Je=>{q.onChange&&q.onChange(Je)};return P().createElement(E,(0,b.Z)({onChange:Oe,uploadType:d.VIDEO},q,{uploadConfig:(0,o.Z)({accept:"video/*",showUploadList:!1},q.uploadConfig),render:()=>P().createElement("span",{className:"icon"},P().createElement(ie.Z,{iconClass:"icon-shipinfujian",color:q.iconColor,size:"16px"}))}))};Ne.defaultProps={uploadConfig:{listType:"text"},addTitle:""};var ue=(0,y.Z)()(Ne),_e=q=>{var Oe=Je=>{q.onChange&&q.onChange(Je)};return P().createElement(E,(0,b.Z)({onChange:Oe,uploadType:d.AUDIO},q,{uploadConfig:(0,o.Z)({accept:"audio/*",showUploadList:!1},q.uploadConfig),render:()=>P().createElement("span",{className:"icon"},P().createElement(ie.Z,{iconClass:"icon-yinpinfujian",size:"16px",color:q.iconColor}))}))};_e.defaultProps={uploadConfig:{listType:"text"},addTitle:""};var Ze=(0,y.Z)()(_e),j=e(22385),R=e(31097),le=e(86506),H=e.n(le),X=q=>{var Oe=Je=>{q.onChange&&q.onChange(Je)};return P().createElement(E,(0,b.Z)({onChange:Oe,uploadType:d.IMAGE},q,{uploadConfig:(0,o.Z)({accept:"image/*",showUploadList:!1},q.uploadConfig),render:()=>P().createElement(P().Fragment,null,q.uploadImageIcon?q.uploadImageIcon((0,o.Z)({},q.uploadConfig)):P().createElement(R.Z,{title:q.t("examination.uploadImgTip"),overlayStyle:{fontSize:"12px"}},P().createElement("span",{className:H()["icon-container"]},P().createElement(ie.Z,{iconClass:"icon-tupianfujian",color:"#979797",size:"16px"}))))}))};X.defaultProps={uploadConfig:{listType:"text"},addTitle:""};var ce=(0,y.Z)()(X),Te=e(34669),Le=e(82833),he=e(12968),Ee=e(44208),ve=e(54549),be=e(56653),Ve=e.n(be),Ae=e(76466),at={OPEN:"open",CLOSE:"close",CUSTOM:"custom"},et=q=>{var Oe=q.t,Je=q.preview,je=q.previewSize,Be=q.remove,St=q.status,Lt=q.name,Wt=q.extension,pa=!St||St==="done",Xt=St&&St==="error",Et=q.resourceType||G({name:Lt,extension:Wt}),Fe=(0,K.useState)({mode:"preview",watchType:"",resourceInfo:{},autoPlay:!0,draggable:!0}),Pe=(0,D.Z)(Fe,2),Ie=Pe[0],$e=Pe[1],te=(0,K.useState)({visible:!1,destroyOnClose:!0,title:Oe("common.resourcePreview"),onCancel:bt}),ae=(0,D.Z)(te,2),Re=ae[0],de=ae[1];function we(Ft){var Ut=Ft||window.event;Ut.stopPropagation(),Ut.cancelBubble=!0,q.onDeleteItem&&q.onDeleteItem()}function rt(Ft){var Ut=Ft.percent,ca=Ft.url;if(pa)switch(Et){case d.IMAGE:return P().createElement("div",{className:Ve().cover},P().createElement(Ee.Z,{width:je,height:je,alt:"img",className:Ve()["ant-image-container"],src:ca}));case d.VIDEO:return P().createElement("div",{className:Ve().cover},P().createElement("img",{className:"",src:"https://oss.coolcollege.cn/1815010117263953920.png",alt:"video"}));case d.AUDIO:return P().createElement("div",{className:Ve().cover},P().createElement("img",{className:"",src:"https://oss.coolcollege.cn/1815010117280731136.png",alt:"audio"}));default:return null}if(Xt)return P().createElement("div",{className:"".concat(Ve().cover," ").concat(Ve()["error-cover"])},Oe("component.uploadFailed"));var Qt=Math.floor(Ut);return P().createElement("div",{className:Ve().cover},P().createElement("div",{className:Ve()["cover-content"]},P().createElement(Le.Z,{showInfo:!1,strokeWidth:4,percent:Math.floor(Qt)}),P().createElement("span",{className:Ve()["progress-tip"]},Qt>0?"\u4E0A\u4F20\u4E2D...":"\u7B49\u5F85\u4E2D")))}function mt(){switch(Et){case d.IMAGE:return P().createElement(ie.Z,{iconClass:"icon-FView",size:"16px",color:"#fff"});case d.VIDEO:case d.AUDIO:return P().createElement(ie.Z,{iconClass:"icon-bofang",size:"22px",color:"#fff"});default:return null}}function Zt(Ft,Ut){var ca=Ut.type,Qt=Ut.url,Va=Ut.resourceList,Ra=Ut.resourceType,Ua=Ut.index,ja=Ft||window.event;if(ja.stopPropagation(),ja.cancelBubble=!0,Je!==at.CLOSE){if(Je===at.CUSTOM&&q.onPreview){q.onPreview({resourceList:Va,resourceType:Ra,index:Ua,e:Ft});return}if(Ra.includes(d.VIDEO)||ca.includes(d.AUDIO)){var ua=q.extension==="mp3";$e((0,o.Z)((0,o.Z)({},Ie),{},{watchType:"video",resourceInfo:{source:{FD:Qt,OD:Qt},originUrl:Qt,contentType:ua?"audio/mp3":Ra},autoPlay:!0,draggable:!0})),de((0,o.Z)((0,o.Z)({},Re),{},{visible:!0}))}}}function bt(Ft){var Ut=Ft||window.event;Ut.stopPropagation(),Ut.cancelBubble=!0,$e({mode:"preview",watchType:"",resourceInfo:{},autoPlay:!0,draggable:!0}),de((0,o.Z)((0,o.Z)({},Re),{},{visible:!1}))}return P().createElement(P().Fragment,null,P().createElement("div",{className:Ve()["resource-item-container"],style:{width:"".concat(je,"px"),height:"".concat(je,"px")}},rt(q),(!St||St==="done"||St==="error")&&P().createElement("div",null,Je!==at.CLOSE&&St!=="error"&&Et!==d.IMAGE&&P().createElement("div",{className:Ve().mask,onClick:Ft=>{Zt(Ft,q)}},mt(q)),Be&&P().createElement("div",{className:Ve().delete,onClick:we},P().createElement(ve.Z,{className:Ve()["delete-icon"]})))),Je===at.OPEN&&Et!==d.IMAGE&&P().createElement(Ae.Z,(0,b.Z)({},Ie,{previewInfo:Re})))};et.defaultProps={preview:at.OPEN,previewSize:72,remove:!0,resourceType:""};var ut=(0,y.Z)()(et)},54262:function(gt,Se,e){"use strict";e.d(Se,{w:function(){return y}});var O=e(62029),g=e(88986),b=e(12924),a=e.n(b),T=e(91768),o=e(48103),D=e.n(o),K=e(62185),P=e(24144),y={UPLOAD:"upload",PREVIEW:"preview"},C=p=>{var B=p.t,c=p.type,I=p.preview,M=p.previewSize,v=p.size,A=p.remove,d=p.resource,l=p.onResourceChange,t=p.uploadTip,h=p.maxCount,F=p.resourceContainerClassName,m=p.uploadBthContainerClassName,E=p.uploadImageIcon,Q=d.images,G=Q===void 0?[]:Q,V=d.videos,z=V===void 0?[]:V,$=d.audios,W=$===void 0?[]:$;function S(w){l&&l(w)}function x(w){var k=w.data,ne=w.type,ie=k.fileList;switch(ne){case P.DZ.IMAGE:{S((0,g.Z)((0,g.Z)({},d),{},{images:ie}));break}case P.DZ.VIDEO:{S((0,g.Z)((0,g.Z)({},d),{},{videos:ie}));break}case P.DZ.AUDIO:{S((0,g.Z)((0,g.Z)({},d),{},{audios:ie}));break}default:break}}function U(w){var k=w.type,ne=w.index;switch(k){case P.DZ.IMAGE:{var ie=G.filter((_e,Ze)=>Ze!==ne);S((0,g.Z)((0,g.Z)({},d),{},{images:ie}));break}case P.DZ.VIDEO:{var Ne=z.filter((_e,Ze)=>Ze!==ne);S((0,g.Z)((0,g.Z)({},d),{},{videos:Ne}));break}case P.DZ.AUDIO:{var ue=W.filter((_e,Ze)=>Ze!==ne);S((0,g.Z)((0,g.Z)({},d),{},{audios:ue}));break}default:break}}var L=w=>{var k=w.resourceList,ne=w.resourceType,ie=w.index,Ne=w.e;p.onPreview&&p.onPreview({resourceList:k,resourceType:ne,index:ie,e:Ne})};return a().createElement("div",{className:"".concat(D().container," ").concat(m)},c===y.UPLOAD&&a().createElement(a().Fragment,null,a().createElement("div",{className:"".concat(D()["upload-container"]),style:p.style},a().createElement(P.Ur,{uploadConfig:{maxCount:h.image,disabled:G.length>=h.image,fileList:G,multiple:!1},size:v.image?v.image:null,iconColor:"#979797",fileList:G,onChange:w=>{x({data:w,type:P.DZ.IMAGE})},uploadImageIcon:E})),t&&typeof t=="boolean"?a().createElement(K.Ch,{tip:B("examination.resourceUploadTip",{imageLength:h.image,imageSize:"".concat(v.image.value).concat(v.image.unit)})}):t),a().createElement("div",{className:"".concat(D()["resource-container"]," ").concat(F)},G.map((w,k)=>a().createElement(P.Lh,(0,O.Z)({},w,{key:w.uid||k,remove:A.image,preview:I.image,index:k,resourceList:G,resourceType:P.DZ.IMAGE,onDeleteItem:()=>{U({type:P.DZ.IMAGE,index:k})},onPreview:L,previewSize:M}))),W.map((w,k)=>a().createElement(P.Lh,(0,O.Z)({},w,{key:w.uid||k,remove:A.audio,preview:I.audio,index:k,resourceList:W,resourceType:P.DZ.AUDIO,onDeleteItem:()=>{U({type:P.DZ.AUDIO,index:k})},onPreview:L,previewSize:M}))),z.map((w,k)=>a().createElement(P.Lh,(0,O.Z)({},w,{key:w.uid||k,remove:A.video,preview:I.video,index:k,resourceList:z,resourceType:P.DZ.VIDEO,onDeleteItem:()=>{U({type:P.DZ.VIDEO,index:k})},onPreview:L,previewSize:M})))))};C.defaultProps={type:y.UPLOAD,previewSize:72,resource:{images:[],videos:[],audios:[],uploadTip:null},maxCount:{image:9,video:1,audio:1},preview:{image:P.VI.OPEN,audio:P.VI.OPEN,video:P.VI.OPEN},remove:{image:!0,audio:!0,video:!0},size:{image:{unit:"M",value:2}},uploadTip:!1,onResourceChange:p=>p},Se.Z=(0,T.Z)()(C)},76591:function(gt,Se,e){"use strict";e.d(Se,{Nb:function(){return O},kh:function(){return b},OH:function(){return a},k4:function(){return T}});var O={SINGLE:"single",MULTIPLE:"multiple",TOF:"trueOrFalse",BLANK:"fillBlank",DESCRIBE:"shortAnswer"},g={EASY:"easy",NORMAL:"normal",HARDER:"harder",HARDEST:"hardest"},b={QUESTION_TYPE:"questionType",QUESTION_DIFFICULT:"questionDifficult"};function a(o){var D=o.t;return[{id:O.SINGLE,value:O.SINGLE,name:D("examination.single"),label:D("examination.single"),text:D("examination.single")},{id:O.MULTIPLE,value:O.MULTIPLE,name:D("examination.multiple"),label:D("examination.multiple"),text:D("examination.multiple")},{id:O.TOF,value:O.TOF,name:D("examination.tof"),label:D("examination.tof"),text:D("examination.tof")},{id:O.BLANK,value:O.BLANK,name:D("examination.blank"),label:D("examination.blank"),text:D("examination.blank")},{id:O.DESCRIBE,value:O.DESCRIBE,name:D("examination.describe"),label:D("examination.describe"),text:D("examination.describe")}]}function T(o){var D=o.t;return[{id:g.EASY,value:g.EASY,label:D("examination.questionSimple"),text:D("examination.questionSimple")},{id:g.NORMAL,value:g.NORMAL,label:D("examination.questionGeneral"),text:D("examination.questionGeneral")},{id:g.HARDER,value:g.HARDER,label:D("examination.questionDifficult"),text:D("examination.questionDifficult")},{id:g.HARDEST,value:g.HARDEST,label:D("examination.questionHard"),text:D("examination.questionHard")}]}},56130:function(gt,Se,e){"use strict";var O=e(62029),g=e(12924),b=e.n(g),a=e(28216),T=e(37055),o=e(10237),D=e(44881),K=y=>{var C=y.studyProject.classify;return{classify:C}},P=y=>{var C=(0,a.$j)(K)(class extends b().Component{constructor(B){var c;super(B);c=this,this.updateData=I=>{var M=this.props.dispatch,v=I||[...this.state.classify];this.setState({classify:v}),M({type:"studyProject/updateClassify",classify:v})},this.getClassify=function(){var I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",M=c.props,v=M.unclassified,A=v===void 0?!1:v,d=M.parent_id,l=d===void 0?0:d,t=M.auth_type,h=t===void 0?"query":t,F=T.ZP.Classify.getResourceClassify();o.WY.get({url:F,params:{include_unclassified:A,parent_id:l,auth_type:h,name:I}}).then(m=>{!m.data||c.updateData((0,D.P)(m.data.list,h))})},this.loadData=I=>{var M=this.props,v=M.unclassified,A=v===void 0?"":v,d=M.auth_type,l=d===void 0?"query":d,t=M.filter,h=M.dispatch,F=M.type,m=F===void 0?"":F;if(console.warn(l,"auth_type"),Array.isArray(I)){var E=I[I.length-1];E.loading=!0,setTimeout(()=>{var Q=T.ZP.Classify.getResourceClassify(),G=E.id;o.WY.get({url:Q,params:{include_unclassified:A,parent_id:G,auth_type:l}}).then(V=>{!V.data||E.children||(E.loading=!1,E.children=(0,D.P)(V.data.list,l),this.updateData())})},1e3)}else return new Promise(Q=>{var G=I.id;setTimeout(()=>{var V=T.ZP.Classify.getResourceClassify(),z=G;o.WY.get({url:V,params:{include_unclassified:A,parent_id:z,auth_type:l}}).then($=>{if(!$.data){Q();return}if(t&&$.data.list.length===0){var W=this.state.classify.map(x=>(t&&G===x.id&&(x.isLeaf=!0),x));this.setState({classify:W}),h({type:"studyProject/updateClassify",classify:W});return}var S=(0,D.P)($.data.list,l);if(m==="tree"){I.dataRef.children=S,this.setState({classify:[...this.state.classify]}),h({type:"studyProject/updateClassify",classify:[...this.state.classify]});return}this.updateData(this.state.classify.concat(S))}),Q()},300)})},this.state={classify:[]}}componentDidMount(){this.getClassify()}render(){return b().createElement(y,(0,O.Z)({classify:this.props.classify,refresh:this.getClassify,loadData:this.loadData},this.props))}});return C};Se.Z=P},43859:function(gt,Se,e){"use strict";var O=e(62029),g=e(81211),b=e(43358),a=e(34041),T=e(12924),o=e.n(T),D=e(94184),K=e.n(D),P=e(59239),y=e(55446),C=e.n(y),p=e(6793),B=P.Z.Item,c=a.Z.Option,I=M=>function(A){var d=A.field,l=A.form,t=A.hasFeedback,h=A.label,F=A.selectOptions,m=A.submitCount,E=A.type,Q=A.displayType,G=A.labelCol,V=G===void 0?{}:G,z=A.wrapperCol,$=z===void 0?{}:z,W=A.required,S=W===void 0?!1:W,x=A.customError,U=x===void 0?!1:x,L=A.colon,w=L===void 0?!0:L,k=A.formItemClassName,ne=(0,g.Z)(A,["field","form","hasFeedback","label","selectOptions","submitCount","type","displayType","labelCol","wrapperCol","required","customError","colon","formItemClassName"]),ie=l.touched[d.name],Ne=m>0,ue=l.errors[d.name],_e=ue&&Ne,Ze=ue&&ie,j=X=>{var ce=X!=null&&X.target?X.target.value:X;l.setFieldValue(d.name,ce),l.touched[d.name]||setTimeout(()=>{l.setFieldTouched(d.name,!0)},0)},R=X=>{var ce={},Te={},Le=X;if(X===void 0&&(Le=""),l.setFieldValue(d.name,Le),d.name==="courseList"&&X&&Object.prototype.toString.apply(X).slice(8,-1)==="Array"&&X.length>0){ce.startTime=X[0].beginTime,Te.startTime=Number((0,p.jZ)(X[0].beginTime))+864e5;var he=[];X.forEach(ve=>{ve.endTime!==""&&he.push(ve)}),he.length>0&&l.values.dateRange.endTime?(0,p.jZ)(l.values.dateRange.endTime)>he[he.length-1].endTime?(ce.endTime=l.values.dateRange.endTime,Te.endTime=Number((0,p.jZ)(l.values.dateRange.endTime))-864e5):he.length>0&&l.values.dateRange.endTime&&(0,p.jZ)(l.values.dateRange.endTime)<=he[he.length-1].endTime&&(ce.endTime=he[he.length-1].endTime,Te.endTime=Number((0,p.jZ)(he[he.length-1].endTime))-864e5):he.length>0&&!l.values.dateRange.endTime&&(ce.endTime=he[he.length-1].endTime,Te.endTime=Number((0,p.jZ)(he[he.length-1].endTime))-864e5),he.length>0&&l.setFieldValue("dateRange",ce),l.setFieldValue("dateRangeLimit",Te)}if(d.name==="stages"&&X&&Object.prototype.toString.apply(X).slice(8,-1)==="Array"&&X.length>0){var Ee=[];X.forEach(ve=>{ve.list&&ve.list.forEach(be=>{be.componentName==="OfflineTrain"&&Ee.push(be.data)})}),Ee.length>0&&(ce.startTime=Ee[0].beginTimeStr,ce.endTime=Ee[Ee.length-1].endTimeStr,ce.startTime=Number((0,p.jZ)(Ee[0].beginTimeStr))+864e5,ce.endTime=Number((0,p.jZ)(Ee[Ee.length-1].endTimeStr))-864e5,l.setFieldValue("dateRangeLimit",ce))}l.touched[d.name]||setTimeout(()=>{l.setFieldTouched(d.name,!0)},0)},le=()=>l.setFieldTouched(d.name,!0),H=K()(["cl-form__field"]);return o().createElement("div",{className:H},o().createElement(B,{label:h,className:"$$CL-FORM-ERROR__".concat(d.name," antd-field-item ").concat(k),hasFeedback:!!(t&&Ne||t&&ie),help:(_e||Ze)&&!U?ue:!1,validateStatus:(_e||Ze)&&!U?"error":"success",labelCol:V,wrapperCol:$,required:S,colon:w},Q==="Custom"?o().createElement(M,(0,O.Z)({},d,ne,{displayType:Q,onBlur:le,onFieldChange:R})):o().createElement(M,(0,O.Z)({},d,ne,{displayType:Q,onBlur:le,onChange:E?j:R,form:l}),F&&F.map(X=>o().createElement(c,{key:X},X)))))};Se.Z=I},13420:function(gt,Se,e){"use strict";var O=e(43358),g=e(34041),b=e(12924),a=e.n(b),T=e(91768),o=e(80991),D=e(5105),K=e(43859),P=g.Z.Option;class y extends a().Component{constructor(p){super(p);this.getBusinessTypes=()=>{(0,D.zk)().then(B=>{this.setState({businessType:B.data.data})})},this.getCustomBusinessTypes=()=>{(0,D.HO)().then(B=>{this.setState({businessType:B.data.data})})},this.state={businessType:[]}}componentDidMount(){this.props.isHuaLaiShi?this.getCustomBusinessTypes():this.getBusinessTypes()}render(){var p=this.props,B=p.width,c=p.value,I=p.placeholder,M=p.disabled,v=this.state.businessType,A=v.some(d=>d.biz_type===c);return a().createElement(g.Z,{value:A?c:"",disabled:M,placeholder:I,style:{width:B},onChange:this.props.onFieldChange},v.map(d=>a().createElement(P,{value:d.biz_type,key:d.biz_type},d.biz_name)))}}Se.Z=(0,K.Z)((0,o.$j)((0,T.Z)()(y)))},5105:function(gt,Se,e){"use strict";e.d(Se,{zk:function(){return b},HO:function(){return a},r4:function(){return T},XS:function(){return o},Xu:function(){return D},BE:function(){return K},uw:function(){return P},A8:function(){return y},sB:function(){return C},UE:function(){return p},f9:function(){return B},m1:function(){return c},Az:function(){return I}});var O=e(37055),g=e(10237);function b(){return g.WY.get({url:O.ZP.approval.getTypeList()})}function a(){return g.WY.get({url:O.ZP.approval.getCustomTypeList(),params:{status:"enable",type:"hands_on_approval"}})}function T(M){return g.WY.get({url:O.ZP.approval.getTemplatePage(),params:M})}function o(M){return g.WY.post({url:O.ZP.approval.deleteTemplateById(M)})}function D(M){return g.WY.post({url:O.ZP.approval.saveTemplate(),data:M})}function K(M){return g.WY.get({url:O.ZP.approval.getTemplateInfo(M)})}function P(M){return g.WY.post({url:O.ZP.approval.settingStatus(M)})}function y(M){var v=O.ZP.approval.getTemplateList();return g.WY.get({url:v,params:{biz_type:M}})}function C(M){var v=M.templateId,A=M.version,d=M.dept_id,l=O.ZP.approval.previewTemplates({templateId:v,version:A});return g.WY.get({url:l,params:{dept_id:d}})}function p(M){var v=M.templateId,A=M.version,d=M.title,l=M.assignNodeList,t=M.dataId,h=M.content,F=M.dept_id,m=O.ZP.approval.submitWorkflow();return g.WY.post({url:m,data:{dept_id:F,template_id:v,template_version:A,title:d,assign_node_list:l,data_id:t,content:h}})}function B(M){var v=O.ZP.approval.submitWorkflowBatch();return g.WY.post({url:v,data:M})}function c(M){var v=M.templateId,A=M.version,d=M.nodeNo,l=O.ZP.approval.getNodeUsers({templateId:v,version:A});return g.WY.post({url:l,params:{node_no:d}})}function I(M){var v=O.ZP.CourseManagement.templateIsNeed(M);return g.WY.get({url:v})}},97413:function(gt,Se,e){"use strict";e.d(Se,{E1:function(){return Ze},lg:function(){return L},Dc:function(){return y},pU:function(){return d}});var O=e(61834),g=e(71194),b=e(57016),a=e(62029),T=e(81211),o=e(12924),D=e.n(o),K=e(91768);function P(j){var R=j.t,le=j.visible,H=j.onCancel,X=j.onOk,ce=j.questionInfo,Te=j.questionId,Le=(0,T.Z)(j,["t","visible","onCancel","onOk","questionInfo","questionId"]);return D().createElement("div",{id:"previewQuestion"},D().createElement(b.Z,{title:R("examination.previewQuestion"),width:"700px",maskClosable:!1,visible:le,onCancel:H,onOk:X,footer:null,getContainer:document.getElementById("previewQuestion"),zIndex:10},le&&(ce?D().createElement(O.Z,(0,a.Z)({questionInfo:ce},Le)):D().createElement(O.Z,(0,a.Z)({questionId:Te},Le)))))}P.defaultProps={visible:!1,onCancel:()=>{},onOk:()=>{},questionInfo:null,questionId:""};var y=(0,K.Z)()(P),C=e(22385),p=e(31097),B=e(27527),c=e.n(B),I=e(36202),M=e(84874),v=e(74689);function A(j){var R=(0,o.useRef)([]),le=j.visible,H=j.rowSelection,X=j.list,ce=j.title,Te=j.tip,Le=j.tipContent,he=[{title:j.t("common.name"),key:"title",dataIndex:"title",render:(Ve,Ae)=>D().createElement("div",{className:"".concat(c().ellipsis)},D().createElement(p.Z,{placement:"top",title:Ve},Ve))},{title:j.t("trainingPlan.associatedTask"),key:"plan_title",dataIndex:"plan_title",width:200,render:(Ve,Ae)=>Ve?D().createElement("div",{className:"".concat(c().ellipsis)},D().createElement(p.Z,{placement:"top",title:Ve},Ve)):"--"}],Ee=()=>{j.onOk&&j.onOk(R.current.selectedRowKeys)},ve=()=>{j.onCancel&&j.onCancel()},be=H&&H===!0?{onChange:Ve=>{R.current.selectedRowKeys=Ve}}:H;return D().createElement(b.Z,{title:ce,visible:le,onOk:Ee,width:600,onCancel:ve},D().createElement("div",null,D().createElement("div",{className:c()["tip-container"]},D().createElement("div",{className:c().tip},D().createElement(M.Z,{iconClass:"icon-xunwentishi",size:"22px"}),D().createElement("span",{className:c()["tip-content"]},Te)),D().createElement("div",{className:c()["sub-tip"]},"*",Le)),D().createElement(I.f,{dataSource:X,columns:he,scroll:{y:240},sticky:!0,rowSelection:be,options:!1})))}var d=(0,K.Z)()(A),l=e(88986),t=e(34792),h=e(48086),F=e(57361),m=e(33565),E=e(43358),Q=e(34041),G=e(9754),V=e.n(G),z=e(2047),$=e.n(z),W=e(18329),S=e(5259),x=Q.Z.Option;function U(j){var R=j.onCancel,le=j.onOk,H=j.visible,X=j.t,ce=(0,o.useState)([]),Te=(0,m.Z)(ce,2),Le=Te[0],he=Te[1],Ee=(0,o.useState)({id:"",title:""}),ve=(0,m.Z)(Ee,2),be=ve[0],Ve=ve[1],Ae={title:X("exam.selectBank"),okText:X("common.ok"),cancelText:X("common.cancel"),size:"small",destroyOnClose:!0,maskClosable:!1};(0,o.useEffect)(()=>{at()},[]);function at(){return et.apply(this,arguments)}function et(){return et=(0,F.Z)(V().mark(function Oe(){var Je,je,Be,St;return V().wrap(function(Wt){for(;;)switch(Wt.prev=Wt.next){case 0:return Wt.next=2,(0,S.Ut)();case 2:Je=Wt.sent,je=Je.data,Be=je.code,St=je.data,Be==="200000"&&he(St);case 7:case"end":return Wt.stop()}},Oe)})),et.apply(this,arguments)}var ut=(Oe,Je)=>{Ve({id:Oe,title:Je.children})},q=()=>{if(!be.id){h.default.warning(X("exam.validation.checkRandomdModeNull"));return}le((0,l.Z)({},be))};return(0,o.useEffect)(()=>{H&&Ve({id:"",title:""})},[H]),D().createElement(W.ZP,(0,a.Z)({},Ae,{visible:H,onCancel:R,onOk:q}),D().createElement("div",{className:$()["move-question"]},X("exam.moveTo"),"\uFF1A",D().createElement(Q.Z,{className:"move-question-select",onChange:ut},Le.map((Oe,Je)=>D().createElement(x,{value:Oe.id,key:Je},Oe.title)))))}U.defaultProps={visible:!1,onCancel:()=>{},onOk:()=>{}};var L=(0,K.Z)()(U),w=e(57663),k=e(71577),ne=e(49101),ie=e(57068),Ne=e(48547),ue=e(1164);function _e(j){var R=j.t,le=j.from,H=j.className,X=(0,o.useState)({visible:!1,type:"Add",paperId:""}),ce=(0,m.Z)(X,2),Te=ce[0],Le=ce[1],he=()=>{Le({visible:!0,type:"Add",paperId:""})},Ee=()=>{Le((0,l.Z)((0,l.Z)({},Te),{},{visible:!1}))},ve=be=>{if(Le((0,l.Z)((0,l.Z)({},Te),{},{visible:!1})),j.onOk){j.onOk(be);return}ue.Z.targetTo({path:"/knowledgeBase/examResources/newPaper/edit?".concat(ie.stringify({paperId:be,from:le}))})};return D().createElement(D().Fragment,null,D().createElement(k.Z,{type:"primary",className:"".concat(H),icon:D().createElement(ne.Z,null),onClick:he},R("examination.newPaper")),Te.visible&&D().createElement(Ne.Z,(0,a.Z)({},Te,{onCancel:Ee,onCreate:ve})))}_e.defaultProps={from:"",className:""};var Ze=(0,K.Z)()(_e)},61834:function(gt,Se,e){"use strict";var O=e(20228),g=e(11382),b=e(13254),a=e(14277),T=e(33565),o=e(12924),D=e.n(o),K=e(91768),P=e(61698),y=e(25965),C=e.n(y),p=e(6793),B=e(5259),c=e(60828),I=e(54262),M=e(56089);function v(l){var t=l.t,h=l.questionId,F=l.index,m=l.difficultyShow,E=l.tagsShow,Q=l.analysisShow,G=l.scoreShow,V=l.className,z=l.previewType,$=(0,o.useState)(l.questionInfo),W=(0,T.Z)($,2),S=W[0],x=W[1],U=(0,o.useState)(!1),L=(0,T.Z)(U,2),w=L[0],k=L[1],ne=(0,o.useState)(!1),ie=(0,T.Z)(ne,2),Ne=ie[0],ue=ie[1];(0,o.useEffect)(()=>{l.questionInfo?x(l.questionInfo):h&&_e({questionId:h})},[h,l.questionInfo]);function _e(q){var Oe=q.questionId;k(!0),B.gu({questionId:Oe}).then(Je=>{var je=Je.data,Be=je.code,St=je.data;Be==="200000"?x(St):ue(!0)}).catch(()=>{ue(!0)}).finally(()=>{k(!1)})}var Ze=()=>{l.onQuestionItemClick&&l.onQuestionItemClick(S)};function j(q){var Oe=q.e,Je=Oe||window.event;Je.stopPropagation(),Je.cancelBubble=!0}function R(q){var Oe=q.t,Je=q.previewType,je=q.questionInfo,Be=je.type,St=je.options;return[c.Nb.SINGLE,c.Nb.MULTIPLE,c.Nb.TOF].includes(Be)?D().createElement("div",{className:C()["options-container"]},St.map((Lt,Wt)=>D().createElement("div",{className:C()["option-item"],key:Wt},(Je===M.wD.BATCH_ADD||Lt.title.length>0||Lt.image.length>0||Lt.video.length>0||Lt.audio.length>0)&&D().createElement("p",{className:C().reset},(0,c.NK)(Wt),"\uFF1A",Lt.title&&D().createElement("span",{className:C()["title-content"]},Lt.title),Lt.is_answer==="true"||Lt.is_answer===!0?D().createElement("span",{className:C()["correct-answer"]},"(",Oe("learning.questionAddOptionSubName"),")"):null),Be!==c.Nb.TOF&&le(Lt,60)))):[c.Nb.BLANK,c.Nb.DESCRIBE].includes(Be)?D().createElement("div",{className:C()["options-container"]},St.map((Lt,Wt)=>D().createElement("div",{key:Wt,className:C()["option-item"]},Be===c.Nb.BLANK?Oe("examing.blankLabel"):Oe("examing.describeLabel"),D().createElement("span",{className:C()["blank-label"]},"".concat(Wt+1)),"\uFF1A ",Lt.title.split(c.Zl).map((pa,Xt)=>pa.trim()?D().createElement(d,{className:C()["answer-item"],key:Xt},pa):null)))):null}function le(q){var Oe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:72,Je=q.image,je=q.video,Be=q.audio;return Array.isArray(Je)&&Je.length>0||Array.isArray(je)&&je.length>0||Array.isArray(Be)&&Be.length>0?D().createElement(I.Z,{resource:{images:Je,videos:je,audios:Be},remove:{image:!1,audio:!1,video:!1},previewSize:Oe,onPreview:j,type:I.w.PREVIEW}):null}var H=(0,o.useMemo)(()=>(0,c.AZ)({t,type:c.kh.QUESTION_TYPE}),[t]),X=(0,o.useMemo)(()=>(0,c.AZ)({t,type:c.kh.QUESTION_DIFFICULT}),[t]),ce=(0,o.useMemo)(()=>(0,P.Gz)({data:S}),[S]),Te=ce.type,Le=ce.difficulty,he=ce.tags,Ee=ce.title,ve=ce.summary,be=ce.analysis,Ve=ce.score,Ae=ce.score_type,at=ce.options;if(Ne)return D().createElement(a.Z,{image:a.Z.PRESENTED_IMAGE_SIMPLE,description:t("exam.getDataError")});var et=()=>{var q=Te==="fillBlank",Oe=Te==="shortAnswer",Je=0;return Ae==="wordSpace"&&(q||Oe)?Je=(0,p.Yz)(Ve*at.length):Je=Ve,G?Ve?D().createElement("span",{className:C().score},"(".concat(Je," ").concat(t("course.points"),")")):D().createElement(D().Fragment,null,D().createElement("span",{className:C().score},"(",D().createElement("span",{className:C().error_score},Je),t("course.points"),")")):null},ut=()=>l.renderTitleRight?l.renderTitleRight(S,F-1):null;return D().createElement("div",{className:"".concat(C()["preview-question-container"]," ").concat(V),onClick:Ze,id:l.domId},w?D().createElement(g.Z,{spinning:w}):D().createElement(D().Fragment,null,D().createElement("div",{className:C()["title-container"]},D().createElement("div",{className:C().title},D().createElement("p",{className:C().reset},F>0?D().createElement("span",null,F,"."):null,D().createElement("span",null,"\u3010",H[Te],"\u3011"),Te===c.Nb.BLANK?(0,c.D1)({title:Ee}):Ee),et()),ut()),(ve.image.length>0||ve.video.length>0||ve.audio.length>0)&&D().createElement("div",{className:C()["title-resource-container"]},le(ve)),R({t,previewType:z,questionInfo:ce}),m||E&&he.length>0||Q&&(be.title.length>0||be.image.length>0||be.video.length>0||be.audio.length>0)?D().createElement("div",{className:C()["question-knowledge-analysis"]},m?D().createElement("div",{className:C().section},D().createElement(A,{style:{color:"#1890FF",backgroundColor:"#D1E9FF",marginBottom:"12px"}},t("examination.difficulty")),D().createElement("div",null,X[Le])):null,E?he.length>0&&D().createElement("div",{className:C().section},D().createElement(A,{style:{color:"#44B975",backgroundColor:"#D0F6E1",marginBottom:"12px"}},t("course.knowledgePoint")),he.map((q,Oe)=>q?D().createElement("div",{key:Oe,className:"knowledge-item"},D().createElement("span",null,Oe+1,"\u3001"),q):null)):null,Q?(be.title.length>0||be.image.length>0||be.video.length>0||be.audio.length>0)&&D().createElement("div",{className:C().section},D().createElement(A,{style:{color:"#FF7130",backgroundColor:"#FFE2CF",marginBottom:"12px"}},t("examination.analysis")),D().createElement("p",{className:C().reset},be.title),D().createElement("div",{className:C()["resource-container"]},le(be,60))):null):null))}function A(l){var t=l.style,h=l.children;return D().createElement("span",{className:C()["tag-label"],style:t},h)}function d(l){var t=l.children,h=l.className;return D().createElement("span",{className:"".concat(h," ").concat(C()["answer-tag"])},t)}v.defaultProps={questionId:"",difficultyShow:!0,tagsShow:!0,analysisShow:!0,scoreShow:!1,index:0,questionInfo:null,previewType:""},Se.Z=(0,K.Z)()(v)},51927:function(gt,Se,e){"use strict";e.d(Se,{Z:function(){return Q}});var O=e(62029),g=e(57663),b=e(71577),a=e(34792),T=e(48086),o=e(88986),D=e(33565),K=e(12924),P=e.n(K),y=e(91768),C=e(49101),p=e(76651),B=e(78001),c=e(54618),I=e.n(c),M=e(74689);function v(G,V){return{columns:[{title:G("component.questionBankName"),key:"title",width:200,render:z=>P().createElement(M.Z,{className:V["fixed-width-col"],placement:"bottomLeft",width:182,title:z})},{title:G("component.questionBankClassify"),key:"classify_name",width:200,render:z=>P().createElement(M.Z,{className:V["fixed-width-col"],placement:"bottomLeft",width:182,title:z})},{title:G("common.creator"),key:"create_user_name",width:60,render:z=>P().createElement(M.Z,{className:V["fixed-width-col"],placement:"bottomLeft",width:42,title:z})},{title:G("examing.single"),key:"single_count",width:60},{title:G("examing.multiple"),key:"multiple_count",width:60},{title:G("examing.tof"),key:"true_or_false_count",width:60},{title:G("examing.blank"),key:"fill_blank_count",width:60},{title:G("examing.describe"),key:"short_answer_count",width:60}]}}var A=e(18329),d=e(48479),l=e(1164),t=e(12378),h=e(5259),F=e(99367),m=e(54092),E=G=>{var V=G.t,z=G.visible,$=G.defaultChecked,W=G.limitCount,S=G.onOk,x=G.onCancel,U=G.selectTip,L=G.tabVal,w=(0,K.useRef)(),k={okType:"primary",bodyStyle:{padding:"20px 32px 0"},size:"large",maskClosable:!1},ne={keyword:"",classify_id:"",status:"enable"},ie={pageSize:"page_size",pageIndex:"page_number",pageSizeNum:L==="student"?100:5,pageIndexNum:1},Ne={size:"small",showSizeChanger:!1,showTotal:et=>{var ut=L==="student"?100:5,q=Math.ceil(et/ut);return"".concat(V("historicRecords.altogether")).concat(q).concat(V("component.pageLabel"),"\uFF0C").concat(et).concat(V("component.dataItems"))}};(0,K.useEffect)(()=>{if($.length){var et=[];$.forEach(ut=>{et.push(ut.id)}),X(et),j($)}else X([]),j([])},[$]);var ue=(0,K.useState)([]),_e=(0,D.Z)(ue,2),Ze=_e[0],j=_e[1],R=(0,K.useState)([]),le=(0,D.Z)(R,2),H=le[0],X=le[1],ce=(0,K.useState)({keyword:"",classify_id:"",status:"enable"}),Te=(0,D.Z)(ce,2),Le=Te[0],he=Te[1],Ee=et=>{var ut=et.type,q=et.value;he(Oe=>(0,o.Z)((0,o.Z)({},Oe),{},{[ut]:q}))};(0,K.useEffect)(()=>{w.current&&w.current.load()},[Le.keyword,Le.classify_id]);var ve=et=>{var ut=(0,o.Z)((0,o.Z)({},et),Le),q=h.bB;if(m.b&&L==="student"){var Oe=p.m8.location.query.paperId;ut.paper_id=Oe||"",ut.all_data="all",q=h.Qm}return q(ut)};function be(et,ut){var q=[...H],Oe=[...Ze],Je=H.findIndex(je=>et.id===je);Je===-1&&ut&&(W?H.length<W?(q.push(et.id),Oe.push(et)):T.default.info("".concat(V("exam.limitSelectBlank")).concat(W).concat(V("common.count"))):(q.push(et.id),Oe.push(et))),!ut&&Je!==-1&&(q.splice(Je,1),Oe.splice(Je,1)),X(q),j(Oe)}function Ve(et,ut,q){var Oe=[...H],Je=[...Ze];et?W?ut.length<=W?q.forEach(je=>{var Be=Oe.findIndex(St=>je.id===St);Be===-1&&et&&(Oe.push(je.id),Je.push(je))}):T.default.info("".concat(V("exam.limitSelectBlank")).concat(W).concat(V("common.count"))):q.forEach(je=>{var Be=Oe.findIndex(St=>je.id===St);Be===-1&&et&&(Oe.push(je.id),Je.push(je))}):q.forEach(je=>{if(je){var Be=Oe.findIndex(St=>je.id===St);Be!==-1&&(Oe.splice(Be,1),Je.splice(Be,1))}}),X(Oe),j(Je)}var Ae=()=>{S(Ze)},at=()=>P().createElement(P().Fragment,null,P().createElement(b.Z,{type:"default",onClick:x},V("common.cancel")),P().createElement(b.Z,{type:"primary",onClick:Ae},"".concat(V("common.ok")," (").concat(H.length,")")));return P().createElement(A.ZP,(0,O.Z)({},k,{title:V("exam.selectBank"),visible:z,footer:at(),onCancel:x}),P().createElement("div",{className:I()["question-set-selector"]},P().createElement("p",{className:I().tips},U||V("exam.chooseQuestionBankTip")),P().createElement("div",{style:{display:"flex",justifyContent:"space-between"}},P().createElement(t.Z,{className:I()["question-set-cascader"],defaultValue:Le.classify_id,allowClear:!0,placeholder:B.Z.t("common.selectP",{name:B.Z.t("component.questionBankClassifyLabel")}),onChange:et=>Ee({type:"classify_id",value:et})}),P().createElement("div",{style:{display:"flex"}},P().createElement(d.Z,{onSearch:et=>{Ee({type:"keyword",value:et})},placeholder:V("searchInputPlaceholder.questionBank"),maxLength:30,width:"238px"}),P().createElement(l.Z,{to:"/knowledgeBase/examResources/newQuestion"},P().createElement(b.Z,{type:"primary",icon:P().createElement(C.Z,null),style:{marginLeft:"8px"}},V("component.addQuestionBank"))))),P().createElement("div",{className:I()["table-container"]},P().createElement(F.Z,{ref:w,size:"small",uuid:"27259772-ac05-4966-bb75-a4f4e253d019",queryParams:(0,o.Z)((0,o.Z)({},v(V,I())),{},{query:ve}),rowSelection:{selectedRowKeys:H,onSelect:be,onSelectAll:Ve},scroll:L==="student"?{y:390}:{},queryParam:ne,pagerConfig:ie,pagination:Ne,options:!1,bordered:!0,tableAlertRender:()=>!1}))))};E.defaultProps={selectTip:""};var Q=(0,y.Z)()(E)},74689:function(gt,Se,e){"use strict";var O=e(22385),g=e(31097),b=e(62029),a=e(33565),T=e(81211),o=e(12924),D=e.n(o),K=P=>{var y=P.title,C=P.width,p=P.className,B=(0,T.Z)(P,["title","width","className"]),c=(0,o.useRef)(null),I=(0,o.useState)(!0),M=(0,a.Z)(I,2),v=M[0],A=M[1],d=(0,o.useCallback)(l=>{var t=l,h=C||t.getBoundingClientRect().width,F=document.createRange();F.setStart(t,0),F.setEnd(t,t.childNodes.length);var m=F.getBoundingClientRect().width;return m<h},[C]);return(0,o.useEffect)(()=>{c.current&&y&&A(d(c.current))},[d,y]),D().createElement(D().Fragment,null,v?D().createElement("div",{ref:c,style:{width:"".concat(C,"px"),whiteSpace:"nowrap"},className:p},y):D().createElement(g.Z,(0,b.Z)({title:y},B),D().createElement("div",{style:{width:"".concat(C,"px"),overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},className:p},y)))};Se.Z=K},75908:function(gt,Se,e){"use strict";e.d(Se,{OH:function(){return g},k4:function(){return a},kh:function(){return T},AZ:function(){return o}});var O=e(99533);function g(D){var K=D.t;return[{id:O.Nb.SINGLE,value:O.Nb.SINGLE,name:K("examination.single"),label:K("examination.single"),text:K("examination.single")},{id:O.Nb.MULTIPLE,value:O.Nb.MULTIPLE,name:K("examination.multiple"),label:K("examination.multiple"),text:K("examination.multiple")},{id:O.Nb.TOF,value:O.Nb.TOF,name:K("examination.tof"),label:K("examination.tof"),text:K("examination.tof")},{id:O.Nb.BLANK,value:O.Nb.BLANK,name:K("examination.blank"),label:K("examination.blank"),text:K("examination.blank")},{id:O.Nb.DESCRIBE,value:O.Nb.DESCRIBE,name:K("examination.describe"),label:K("examination.describe"),text:K("examination.describe")}]}function b(D){var K=D.t;return[{id:VISIBLE_RANGE.MY,value:VISIBLE_RANGE.MY,name:"\u6211\u521B\u5EFA\u7684"},{id:VISIBLE_RANGE.JURISDICTION,value:VISIBLE_RANGE.JURISDICTION,name:"\u6211\u7BA1\u8F96\u7684"}]}function a(D){var K=D.t;return[{id:O.Uh.EASY,value:O.Uh.EASY,label:K("examination.questionSimple"),text:K("examination.questionSimple")},{id:O.Uh.NORMAL,value:O.Uh.NORMAL,label:K("examination.questionGeneral"),text:K("examination.questionGeneral")},{id:O.Uh.HARDER,value:O.Uh.HARDER,label:K("examination.questionDifficult"),text:K("examination.questionDifficult")},{id:O.Uh.HARDEST,value:O.Uh.HARDEST,label:K("examination.questionHard"),text:K("examination.questionHard")}]}var T={QUESTION_TYPE:"questionType",QUESTION_DIFFICULT:"questionDifficult"};function o(D){var K=D.t,P=D.type;if(P===T.QUESTION_TYPE){var y={},C=g({t:K});return C.forEach(c=>{var I=c.value,M=c.label;y[I]=M}),y}if(P===T.QUESTION_DIFFICULT){var p={},B=a({t:K});return B.forEach(c=>{var I=c.value,M=c.label;p[I]=M}),p}return{}}},99533:function(gt,Se,e){"use strict";e.d(Se,{Nb:function(){return O},Uh:function(){return g},oc:function(){return a},xj:function(){return T},kC:function(){return o},Zl:function(){return D},$V:function(){return K}});var O={SINGLE:"single",MULTIPLE:"multiple",TOF:"trueOrFalse",BLANK:"fillBlank",DESCRIBE:"shortAnswer"},g={EASY:"easy",NORMAL:"normal",HARDER:"harder",HARDEST:"hardest"},b={MY:"my",JURISDICTION:"jurisdic"},a={EDIT:"edit",DELETE:"delete",COPY:"copy",PREVIEW:"preview"},T={all:1,part:2,onlyMe:3},o={1:"all",2:"part",3:"onlyMe"},D="/",K="/"},60828:function(gt,Se,e){"use strict";e.d(Se,{e5:function(){return o},$V:function(){return O.$V},Uh:function(){return O.Uh},Zl:function(){return O.Zl},oc:function(){return O.oc},kh:function(){return g.kh},Nb:function(){return O.Nb},NK:function(){return T},k4:function(){return g.k4},OH:function(){return g.OH},PP:function(){return K},iq:function(){return D},D1:function(){return P},AZ:function(){return g.AZ}});var O=e(99533),g=e(75908),b=e(88986),a=e(61698);function T(y){return String.fromCharCode("A".codePointAt(0)+y)}var o={blanksMaxCount:a.EZ,blankReg:new RegExp(/([^]*?)/g,"g"),blankPosition:"\u3010\u7B54\u68481/\u5907\u9009\u7B54\u68482/\u5907\u9009\u7B54\u68483\u3011"};function D(y){var C=(0,b.Z)({title:"",reg:o.blankReg},y),p=C.reg,B=C.title,c=[];return B.replaceAll(p,(I,M)=>{c.push(M)}),c.map(I=>({is_answer:!0,title:I,image:[],audio:[],video:[]}))}function K(y){var C=(0,b.Z)({title:"",reg:o.blankReg},y),p=C.reg,B=C.title;return B.replaceAll(p,"")}function P(y){var C=(0,b.Z)({title:"",reg:o.blankReg},y),p=C.reg,B=C.title;return B.replaceAll(p,()=>{var c="(____)";return c})}},48547:function(gt,Se,e){"use strict";e.d(Se,{Z:function(){return $}});var O=e(62029),g=e(34792),b=e(48086),a=e(33565),T=e(12924),o=e.n(T),D=e(91768),K=e(28216),P=e(80991),y=e(49550),C=e.n(y),p=e(5259),B=e(52670),c=e(62615),I=e(40572),M=e(86726),v=e(18329),A=e(7584),d=e(70075),l=e(34773),t=e(88983),h=e(47933),F=e(43859);class m extends o().Component{constructor(){super(...arguments);this.handleChange=S=>{this.props.formik.setFieldValue(this.props.name,S.target.value)}}render(){return o().createElement(h.ZP.Group,{value:this.props.defaultFieldList,onChange:this.handleChange,disabled:this.props.disabled},o().createElement(h.ZP,{value:"fixed"},this.props.t("exam.fixed")),o().createElement(h.ZP,{value:"random"},this.props.t("exam.random")))}}m.defaultProps={prefixCls:"fix-mode-question"};var E=(0,F.Z)((0,P.$j)((0,D.Z)()(m))),Q=e(2396),G=e(54092),V=(W,S)=>{var x=(0,T.useRef)(),U=W.language,L=U==="en_us"?{labelCol:{xs:{span:5},sm:{span:5}},wrapperCol:{xs:{span:16},sm:{span:16}}}:{labelCol:{xs:{span:3},sm:{span:3}},wrapperCol:{xs:{span:20},sm:{span:20}}},w=(0,M.V9)("classify",JSON.parse(localStorage.getItem("modules"))),k=W.t,ne=W.visible,ie=W.type,Ne=W.paperId,ue=W.onCancel,_e=W.onCreate,Ze=(0,T.useState)(""),j=(0,a.Z)(Ze,2),R=j[0],le=j[1],H=(0,T.useState)(!1),X=(0,a.Z)(H,2),ce=X[0],Te=X[1],Le=(0,T.useState)(!1),he=(0,a.Z)(Le,2),Ee=he[0],ve=he[1],be=(0,T.useState)({id:"",title:"",type:"fixed",classify_id:"",classify_name:"",summary:"",employeeRange:{rangeType:3,rangeList:{departments:[],posts:[],groups:[],users:[]}}}),Ve=(0,a.Z)(be,2),Ae=Ve[0],at=Ve[1];(0,T.useEffect)(()=>{ie==="Add"?(le(k("documentTitle.addPaper")),Te(!1)):ie==="Edit"&&(le(k("documentTitle.editPaper")),Te(!0))},[ie,k]),(0,T.useImperativeHandle)(S,()=>({setPaperInfo:je=>et(je)}));var et=je=>{var Be=je.id,St=je.title,Lt=je.type,Wt=je.classify_id,pa=je.classify_name,Xt=je.summary,Et=je.visible_range_vo,Fe=Et.visible_range_type;at({id:Be,title:St,type:Lt,classify_id:Wt,classify_name:pa,summary:Xt,employeeRange:{rangeType:Fe==="all"?1:Fe==="part"?2:3,rangeList:{departments:Et.departments_list,posts:Et.posts_list,groups:Et.groups_list,users:Et.users_list}}})},ut=()=>{x.current.submitForm()},q=()=>{ue()},Oe=je=>{var Be=je.employeeRange,St=(0,l.N)(Be.rangeList),Lt="";switch(Be.rangeType){case 1:Lt="all";break;case 2:Lt="part";break;default:Lt="onlyMe";break}return{id:Ne,title:je.title.replace(/(^\s*)|(\s*$)/g,""),type:je.type,classify_id:je.classify_id,classify_name:je.classify_name,summary:je.summary.replace(/(^\s*)|(\s*$)/g,""),visible_range_vo:{visible_range_type:Lt,departments_list:Be.rangeType===2?St.deptIds:[],posts_list:Be.rangeType===2?St.postIds:[],groups_list:Be.rangeType===2?St.groupIds:[],users_list:Be.rangeType===2?St.userIds:[]}}},Je=je=>{ve(!0);var Be=Oe(je);if(ie==="Add"){var St=G.b?p.ji:p.pT;St(Be).then(Wt=>{Wt.data.code==="200000"&&(b.default.success(k("common.addSuccess")),ve(!1),_e(Wt.data.data))}).catch(()=>{ve(!1)})}else if(ie==="Edit"){var Lt=G.b?p.Zl:p.Le;Lt(Be).then(Wt=>{Wt.data.code==="200000"&&(b.default.success(k("common.editSuccess")),ve(!1),_e(Be))}).catch(()=>{ve(!1)})}};return o().createElement(v.ZP,{wrapClassName:"cl-employee-selector-modal",visible:ne,title:R,size:"medium",okText:k("common.ok"),cancelText:k("common.cancel"),confirmLoading:Ee,onCancel:q,onOk:ut},(Ae.title&&ie==="Edit"||ie==="Add")&&o().createElement(P.J9,{ref:x,initialValues:Ae,onSubmit:Je,render:je=>o().createElement(P.l0,{className:C()["add-question-bank-form"]},o().createElement(P.gN,(0,O.Z)({component:A.Z,name:"title",label:k("component.paperName"),required:!0,type:"text",LimitLength:30,char:!0,showCount:!0,placeholder:k("exam.validation.itemPaperTitle"),validate:Be=>(0,Q.QK)(Be,k("common.input",{name:k("component.paperName")}))},L)),o().createElement(P.gN,(0,O.Z)({name:"summary",label:k("exam.paperAddItemDesc"),component:d.Z,type:"text",rows:10,showCount:!0,LimitLength:200,char:!0,placeholder:k("common.input",{name:k("exam.paperAddItemDesc")})},L)),o().createElement(P.gN,(0,O.Z)({name:"classify_id",label:k("exam.paperClassify"),required:!0,defaultValue:je.values.classify_id,classifyName:je.values.classify_name,displayType:"Custom",validate:B.ZE,component:I.Z,auth_type:"edit",filter:!0},L)),o().createElement(P.gN,(0,O.Z)({component:E,name:"type",required:!0,label:k("exam.paperModeWay"),defaultFieldList:je.values.type,disabled:ce},L)),o().createElement(P.gN,(0,O.Z)({component:c.Wc,displayType:"Custom",showSectitle:!1,required:!0,name:"employeeRange",label:k("examination.visibleRange"),defaultFieldList:je.values.employeeRange,validate:B.WW,mode:["all","part","private"],rangeAuth:!0,orgProps:{title:k("component.chooseVisibleScope")},title:k("examination.visibleRange"),okText:k("common.ok")},L)))}))},z=W=>{var S=W.user;return{language:S.lng}},$=(0,K.$j)(z,null,null,{forwardRef:!0})((0,D.Z)("translation",{withRef:!0})((0,T.forwardRef)(V)))},62185:function(gt,Se,e){"use strict";e.d(Se,{Io:function(){return C},Ch:function(){return p}});var O=e(57663),g=e(71577),b=e(62029),a=e(12924),T=e.n(a),o=e(28216),D=e(22034),K=e.n(D),P=e(84874);function y(B){var c=B.title,I=B.className;return React.createElement("div",{className:"".concat(style["section-title"]," ").concat(I)},c)}function C(B){var c=B.disabled,I=c===void 0?!1:c,M=B.value,v=B.icon,A=v===void 0?!1:v,d=B.children,l=(0,o.v9)(F=>{var m=F.advancedSetting;return{themeColor:m.themeColor}}),t=l.themeColor;function h(F){return typeof F=="boolean"&&F?F?T().createElement(P.Z,{iconClass:"icon-icon_addx",size:"12px"}):null:F}return T().createElement(g.Z,(0,b.Z)({},B,{style:I?{}:{color:t,borderColor:t},icon:(0,a.useMemo)(()=>h(A),[A])}),d||M)}function p(B){var c=B.className,I=B.tip;return T().createElement("div",{className:"".concat(K()["tip-container"]," ").concat(c)},T().createElement(P.Z,{iconClass:"icon-shuoming",size:"12px",color:"rgba(0, 0, 0, 0.45)"}),T().createElement("span",{className:K().tip},I))}},61698:function(gt,Se,e){"use strict";e.d(Se,{ab:function(){return K},EZ:function(){return I},I4:function(){return y},YX:function(){return C},lO:function(){return B},_:function(){return o},Jp:function(){return P},to:function(){return p},fh:function(){return T},g5:function(){return c},Ef:function(){return M},wN:function(){return D},oo:function(){return d},Uh:function(){return l},Gz:function(){return t},mh:function(){return h}});var O=e(88986),g=e(81211),b=e(76651),a=e(57068),T={PREVIEW:"preview",PUBLISH:"publish",PUBLISH_THEN_CONTINUE:"publish_then_continue",CANCEL:"cancel",REFRESH:"refresh"},o={formFieldLayout:{labelCol:{xs:{span:0},sm:{span:0}},wrapperCol:{xs:{span:24},sm:{span:24}}},formNoLabelLayout:{wrapperCol:{span:16,offset:2}},formTitleLayout:{labelCol:{span:2},wrapperCol:{span:22}}},D=3e3,K=3e3,P=12,y=3,C=1e3,p=5,B=30,c=12,I=12,M=1e3,v=e(60828),A=e(56089);function d(F){var m=F.t,E=F.data,Q=F.type;if(E&&E.title||Q===A.wD.BATCH_ADD){var G={["".concat(v.Nb.SINGLE)]:"choiceOptions",[v.Nb.MULTIPLE]:"choiceOptions",[v.Nb.TOF]:"tofOptions",[v.Nb.BLANK]:"blankOptions",[v.Nb.DESCRIBE]:"describeOptions"},V=E.options,z=E.type,$=E.tags,W=E.summary,S=E.analysis,x=(0,g.Z)(E,["options","type","tags","summary","analysis"]);return(0,O.Z)((0,O.Z)({type:z,tags:$||[]},x),{},{summary:(0,O.Z)((0,O.Z)({},W),{},{image:W.image.map(U=>({url:U})),audio:W.audio.map(U=>({url:U})),video:W.video.map(U=>({url:U}))}),analysis:(0,O.Z)((0,O.Z)({},S),{},{image:S.image.map(U=>({url:U})),audio:S.audio.map(U=>({url:U})),video:S.video.map(U=>({url:U}))}),[G[z]]:V.map(U=>(0,O.Z)((0,O.Z)({},U),{},{image:U.image.map(L=>({url:L})),audio:U.audio.map(L=>({url:L})),video:U.video.map(L=>({url:L}))}))})}return{type:v.Nb.SINGLE,difficulty:v.Uh.EASY,is_order_match:!0,is_answer_upload_image:!1,tags:[],title:"",summary:{image:[],audio:[],video:[],formula:[]},analysis:{title:"",image:[],audio:[],video:[],formula:[]},choiceOptions:[{is_answer:!1,title:"",image:[],audio:[],video:[],formula:[]},{is_answer:!1,title:"",image:[],audio:[],video:[],formula:[]},{is_answer:!1,title:"",image:[],audio:[],video:[],formula:[]},{is_answer:!1,title:"",image:[],audio:[],video:[],formula:[]}],tofOptions:[{option:"option1",title:m("learning.questionAddOptionTofPlaceholderCorrect"),is_answer:!1,image:[],audio:[],video:[],formula:[]},{option:"option2",is_answer:!1,title:m("learning.questionAddOptionTofPlaceholderFalse"),image:[],audio:[],video:[],formula:[]}],describeOptions:[],blankOptions:[{is_answer:!0,title:"",image:[],audio:[],video:[],formula:[]}]}}function l(F){var m=F.choiceOptions,E=F.tofOptions,Q=F.blankOptions,G=F.describeOptions,V=F.tags,z=F.type,$=F.summary,W=F.analysis,S=(0,g.Z)(F,["choiceOptions","tofOptions","blankOptions","describeOptions","tags","type","summary","analysis"]);function x(){return z===v.Nb.SINGLE||z===v.Nb.MULTIPLE?m.map(L=>(0,O.Z)((0,O.Z)({},L),{},{image:L.image.map(w=>{var k=w.url;return k}),audio:L.audio.map(w=>{var k=w.url;return k}),video:L.video.map(w=>{var k=w.url;return k})})):z===v.Nb.TOF?E.map(L=>(0,O.Z)((0,O.Z)({},L),{},{image:[],audio:[],video:[]})):z===v.Nb.BLANK?(0,v.iq)({title:S.title}):z===v.Nb.DESCRIBE?G.map(L=>(0,O.Z)((0,O.Z)({},L),{},{image:L.image.map(w=>{var k=w.url;return k}).filter(w=>w),audio:L.audio.map(w=>{var k=w.url;return k}).filter(w=>w),video:L.video.map(w=>{var k=w.url;return k}).filter(w=>w)})):[]}var U=x()||[];return(0,O.Z)((0,O.Z)({},S),{},{type:z,tags:V,summary:(0,O.Z)((0,O.Z)({},$),{},{image:$.image.map(L=>{var w=L.url;return w}).filter(L=>L),audio:$.audio.map(L=>{var w=L.url;return w}).filter(L=>L),video:$.video.map(L=>{var w=L.url;return w}).filter(L=>L)}),analysis:(0,O.Z)((0,O.Z)({},W),{},{image:W.image.map(L=>{var w=L.url;return w}).filter(L=>L),audio:W.audio.map(L=>{var w=L.url;return w}).filter(L=>L),video:W.video.map(L=>{var w=L.url;return w}).filter(L=>L)}),options:U.map((L,w)=>(0,O.Z)({option:"option".concat(w)},L))})}function t(F){var m=F.data;if(m){var E=m.type,Q=m.tags,G=m.options,V=G===void 0?[]:G,z=m.summary,$=z===void 0?{image:[],audio:[],video:[]}:z,W=m.analysis,S=W===void 0?{title:"",image:[],audio:[],video:[]}:W,x=(0,g.Z)(m,["type","tags","options","summary","analysis"]);return(0,O.Z)((0,O.Z)({type:E,tags:Q||[]},x),{},{summary:$?(0,O.Z)((0,O.Z)({},$),{},{image:$.image?$.image.map(U=>({url:U})):[],audio:$.audio?$.audio.map(U=>({url:U})):[],video:$.video?$.video.map(U=>({url:U})):[]}):{image:[],audio:[],video:[]},analysis:S?(0,O.Z)((0,O.Z)({},S),{},{image:S.image?S.image.map(U=>({url:U})):[],audio:S.audio?S.audio.map(U=>({url:U})):[],video:S.video?S.video.map(U=>({url:U})):[]}):{title:"",image:[],audio:[],video:[]},options:V.map(U=>(0,O.Z)((0,O.Z)({},U),{},{image:U.image?U.image.map(L=>({url:L})):[],audio:U.audio?U.audio.map(L=>({url:L})):[],video:U.video?U.video.map(L=>({url:L})):[]}))})}return{tags:[],options:[],summary:{image:[],audio:[],video:[]},analysis:{title:"",image:[],audio:[],video:[]}}}function h(F){b.m8.push("/knowledgeBase/examResources/newQuestion/detail?".concat(a.stringify({questionBankId:F.question_bank_id,questionBankName:F.question_bank_name})))}},56089:function(gt,Se,e){"use strict";e.d(Se,{sc:function(){return La},wD:function(){return Za},ZP:function(){return fa}});var O=e(20228),g=e(11382),b=e(57663),a=e(71577),T=e(62029),o=e(57361),D=e(34792),K=e(48086),P=e(88986),y=e(33565),C=e(9754),p=e.n(C),B=e(12924),c=e.n(B),I=e(91768),M=e(76651),v=e(80991),A=e(57068),d=e(88983),l=e(47933),t=e(43859),h=e(60828);function F(ke){var Ue=ke.t,De=ke.value,oe=ke.onFieldChange,xe=(0,B.useMemo)(()=>(0,h.k4)({t:Ue}),[Ue]);function me(ye){var We=ye.target.value;oe&&oe(We)}return c().createElement(l.ZP.Group,{onChange:me,value:De},xe.map(ye=>c().createElement(l.ZP,{key:ye.id,value:ye.value},ye.label)))}var m=(0,t.Z)((0,I.Z)()(F)),E=e(28216),Q=e(28668),G=e.n(Q);function V(ke){var Ue=ke.t,De=ke.onChange,oe=ke.disabled,xe=ke.onFieldChange,me=(0,E.v9)(qe=>{var Tt=qe.advancedSetting;return{themeColor:Tt.themeColor}}),ye=me.themeColor;function We(qe){xe(qe),De({currentType:qe,previousType:ke.value})}var ze=(0,B.useMemo)(()=>(0,h.OH)({t:Ue}),[Ue]);return c().createElement("div",{className:G()["type-tab"]},ze.map(qe=>{var Tt=qe.value,Ct=qe.id,Vt=qe.label,ht=Tt===ke.value?{color:ye,borderBottom:"1px solid ".concat(ye)}:{};return c().createElement("button",{type:"button",style:ht,disabled:oe,className:"".concat(G()["type-tab-item"]," ").concat(Tt!==ke.value&&oe?G()["disabled-tab"]:G()["normal-tab"]),key:Ct,onClick:()=>We(Tt)},Vt)}))}V.defaultProps={disabled:!1};var z=(0,t.Z)((0,I.Z)()(V)),$=e(62185),W=e(63393),S=e.n(W),x=e(70075),U=e(47444),L=e(54262),w=e(61698);function k(ke){var Ue=ke.t,De=ke.questionType,oe=ke.value,xe=ke.onFieldChange,me=ke.setFieldValue,ye=ke.summary,We=ke.disabledInput;function ze(re){xe(re)}function qe(){var re=h.e5.blankPosition,fe=document.getElementById("question-title");if(document.selection){fe.focus();var pe=document.selection.createRange();pe.text=re,pe.select()}else if(fe.selectionStart||fe.selectionStart==="0"){var ee=fe.selectionStart,ge=fe.selectionEnd,Me=fe.scrollTop;fe.value=fe.value.substring(0,ee)+re+fe.value.substring(ge,fe.value.length),Me>0&&(fe.scrollTop=Me),fe.focus(),fe.selectionStart=ee+re.length,fe.selectionEnd=ee+re.length}else fe.value+=re,fe.focus();xe((0,U.B)({value:fe.value,LimitLength:w.wN,char:!0}))}function Tt(re){var fe=re.resource,pe=fe.images,ee=fe.audios,ge=fe.videos;me("summary",(0,P.Z)((0,P.Z)({},ye),{},{image:pe||[],audio:ee||[],video:ge||[]}))}function Ct(){return c().createElement(L.Z,{uploadTip:!0,uploadBthContainerClassName:S()["title-resource-upload-container"],resource:{images:ye.image,audios:ye.audio,videos:ye.video},onResourceChange:re=>{Tt({resource:re})}})}var Vt=(0,B.useMemo)(()=>(0,h.iq)({title:oe}),[oe]),ht=Vt.length>=h.e5.blanksMaxCount;return De===h.Nb.BLANK?c().createElement("div",{className:S()["question-blank-title"]},c().createElement(x.a,{rows:2,LimitLength:w.wN,char:!0,showCount:!0,autoSize:!0,placeholder:Ue("examination.blankPlaceholder"),value:oe,id:"question-title",onChange:ze,disabledInput:We}),Ct(),c().createElement($.Io,{disabled:ht,icon:!0,onClick:qe},Ue("examination.addBlank")),c().createElement($.Ch,{className:S()["blank-add-tip"],tip:Ue("examination.blankKeywordTip")})):c().createElement("div",{className:S()["question-blank-title"]},c().createElement(x.a,{placeholder:Ue("learning.questionAddContentNamePlaceholder"),value:oe,onChange:ze,rows:1,autoSize:!0,LimitLength:w.wN,char:!0,showCount:!0,disabledInput:We}),Ct())}var ne=(0,t.Z)((0,I.Z)()(k)),ie=e(45876),Ne=e.n(ie);function ue(ke){var Ue=ke.t,De=ke.value,oe=ke.onFieldChange,xe=ke.disabledInput;function me(We){oe((0,P.Z)((0,P.Z)({},De),{},{title:We}))}function ye(We){var ze=We.resource,qe=ze.images,Tt=ze.audios,Ct=ze.videos;oe((0,P.Z)((0,P.Z)({},De),{},{image:qe||[],audio:Tt||[],video:Ct||[]}))}return c().createElement("div",{className:Ne()["answer-analysis"]},c().createElement(x.a,{showCount:!0,value:De.title,LimitLength:w.ab,char:!0,placeholder:Ue("learning.questionAddSecAnalysisNamePlaceholder"),autoSize:{minRows:4,maxRows:10},onChange:me,disabledInput:xe}),c().createElement(L.Z,{uploadBthContainerClassName:Ne()["analysis-resource-upload-container"],resource:{images:De.image,audios:De.audio,videos:De.video},onResourceChange:We=>{ye({resource:We})}}))}var _e=(0,t.Z)((0,I.Z)()(ue)),Ze=e(22385),j=e(31097),R=e(71153),le=e(60331),H=e(47673),X=e(4107),ce=e(49101),Te=e(40989),Le=e.n(Te),he=e(2396);function Ee(ke){var Ue=ke.defaultTags,De=ke.defaultInputVisible,oe=ke.addTitle,xe=ke.tagCount,me=ke.maxLength,ye=ke.displayLength,We=ke.closable,ze=ke.data,qe=ke.dataDeDuplication,Tt=ke.disabledInput,Ct=ke.disabledStr,Vt=(0,B.useRef)(),ht=(0,B.useRef)(),re=(0,B.useState)(De),fe=(0,y.Z)(re,2),pe=fe[0],ee=fe[1],ge=(0,B.useState)(""),Me=(0,y.Z)(ge,2),Ke=Me[0],ct=Me[1],pt=(0,B.useState)(-1),_t=(0,y.Z)(pt,2),At=_t[0],Gt=_t[1],Ia=(0,B.useState)(""),Ba=(0,y.Z)(Ia,2),ia=Ba[0],da=Ba[1],Es=(0,B.useState)(Ue),Fs=(0,y.Z)(Es,2),Ts=Fs[0],Ns=Fs[1];(0,B.useEffect)(()=>{pe&&Vt.current.focus(),At!==-1&&ia&&ht.current.focus()},[pe,At,ia]),(0,B.useEffect)(()=>{wa(Ts)},[Ts]);var ks=xa=>{var rs=Ts.filter(ss=>ss!==xa);Ns(rs)},Bs=()=>{ee(()=>!0)},Wa=xa=>{ct(ms(xa.target.value))},hs=()=>{var xa=Ts,rs=Ke.trim();if(rs&&Ts.indexOf(rs)===-1)if(ze&&qe){var ss=ze.includes(rs);ss||(xa=[...Ts,rs])}else xa=[...Ts,rs];Ns(xa),ct(""),ee(!1)},Oa=xa=>{da(ms(xa.target.value))},Ha=()=>{var xa=[...Ts];xa[At]=ia,da(""),Gt(-1),Ns(xa.filter(rs=>rs.trim()))},ms=function(){var rs=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",ss=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ct,Ks=rs;return ss?Ks.replaceAll(ss,"")||"":Ks},wa=xa=>{ke.onTagsChange&&ke.onTagsChange(xa)};return c().createElement(c().Fragment,null,Ts.map((xa,rs)=>{if(At===rs)return c().createElement(be,{disabledInput:Tt,LimitLength:me,value:ia,render:()=>c().createElement(X.Z,{ref:ht,key:xa,size:"small",className:Le()["tag-input"],value:ia,maxLength:Tt&&me,onChange:Oa,onBlur:Ha,onPressEnter:Ha})});var ss=xa.length>ye,Ks=c().createElement(le.Z,{className:Le()["edit-tag"],key:xa,closable:Array.isArray(We)?We.includes(rs):!0,onClose:()=>ks(xa)},c().createElement("span",{onDoubleClick:Qs=>{Gt(()=>rs),da(()=>xa),Qs.preventDefault()}},ss?"".concat(xa.slice(0,ye),"..."):xa));return ss?c().createElement(j.Z,{title:xa,key:xa,mouseEnterDelay:1},Ks):Ks}),pe&&c().createElement(be,{disabledInput:Tt,LimitLength:me,value:Ke,render:()=>c().createElement(X.Z,{ref:Vt,type:"text",size:"small",maxLength:Tt&&me,className:Le()["tag-input"],value:Ke,onChange:Wa,onBlur:hs,onPressEnter:hs})}),!pe&&Ts.length<xe&&c().createElement(le.Z,{className:Le()["site-tag-plus"],onClick:Bs},c().createElement(ce.Z,null)," ",oe))}Ee.defaultProps={tagCount:Number.POSITIVE_INFINITY,maxLength:15,displayLength:20,closable:!0,addTitle:"\u6DFB\u52A0",defaultTags:[],defaultInputVisible:!1,data:[],dataDeDuplication:!1,disabledInput:!0,disabledStr:""};var ve=(0,I.Z)()(Ee);function be(ke){var Ue=ke.value,De=ke.LimitLength,oe=ke.char,xe=ke.disabledInput,me=(0,B.useMemo)(()=>{if(xe){var ye=Ue.length;return ye>=De?De:ye}return oe?(0,he.$s)(Ue):Ue.length},[Ue]);return c().createElement("div",{className:"".concat(Le()["input-wrap"]," ").concat(me&&De&&me>De?Le()["input-wrap-error"]:""),"data-count":"".concat(me,"/").concat(De)},ke.render((0,P.Z)({},ke)))}function Ve(ke){var Ue=ke.t,De=ke.value,oe=ke.onFieldChange,xe=ke.disabledInput;function me(ye){oe(ye)}return c().createElement(ve,{defaultTags:De,tagCount:w.to,maxLength:w.lO,disabledInput:xe,onTagsChange:me,addTitle:Ue("course.knowledgePoint")})}var Ae=(0,t.Z)((0,I.Z)()(Ve)),at=e(13062),et=e(71230),ut=e(63185),q=e(9676),Oe=e(89032),Je=e(15746),je=e(50361),Be=e.n(je),St=e(52752),Lt=e.n(St);function Wt(ke){var Ue=ke.t,De=ke.value,oe=ke.questionType,xe=ke.onFieldChange,me=ke.layout,ye=ke.disabledInput,We=(0,E.v9)(ee=>{var ge=ee.advancedSetting;return{themeColor:ge.themeColor}}),ze=We.themeColor;function qe(ee){var ge=ee.resource,Me=ee.index,Ke=ge.images,ct=ge.audios,pt=ge.videos;De[Me].image=Ke||[],De[Me].audio=ct||[],De[Me].video=pt||[],xe(Be()(De))}function Tt(ee,ge){var Me=ee.target.checked;oe===h.Nb.MULTIPLE?De[ge].is_answer=Me:De.forEach((Ke,ct)=>{Ke.is_answer=ct===ge?Me:!1}),xe(Be()(De))}function Ct(ee,ge){De[ge].title=ee,xe(Be()(De))}function Vt(ee){De.splice(ee,1),xe(Be()(De))}function ht(){var ee={title:"",is_answer:!1,image:[],audio:[],video:[]};De.push(ee),xe(Be()(De))}function re(ee){var ge=ee.option,Me=ee.index;return Me>1?null:c().createElement(c().Fragment,null,c().createElement(et.Z,{key:Me,align:"middle"},c().createElement(Je.Z,{flex:me.label},c().createElement("span",{className:Lt()["item-label"]},(0,h.NK)(Me))),c().createElement(Je.Z,{span:me.content},c().createElement(x.a,{value:ge.title,placeholder:Ue("learning.questionAddOptionPlaceholder"),rows:1,autoSize:!0,className:Lt()["item-input"],onChange:Ke=>Ct(Ke,Me),disabled:!0,showCount:!1,disabledInput:ye})),c().createElement(Je.Z,{span:me.checkbox},c().createElement(q.Z,{checked:ge.is_answer==="true"||ge.is_answer===!0,className:Lt()["option-checkbox"],onChange:Ke=>Tt(Ke,Me)})),c().createElement(Je.Z,{span:me.placeholder})))}function fe(ee){var ge=ee.index,Me=c().createElement("span",{className:Lt()["item-remove"],style:{color:ze},onClick:()=>Vt(ge)},Ue("common.delete"));return oe===h.Nb.SINGLE&&De.length>1||oe===h.Nb.MULTIPLE&&De.length>2?Me:null}function pe(ee){var ge=ee.option,Me=ee.index;return c().createElement(c().Fragment,null,c().createElement(et.Z,{key:Me,align:"middle"},c().createElement(Je.Z,{flex:me.label},c().createElement("span",{className:Lt()["item-label"]},(0,h.NK)(Me))),c().createElement(Je.Z,{span:me.content},c().createElement(x.a,{value:ge.title,placeholder:Ue("learning.questionAddOptionPlaceholder"),rows:1,autoSize:!0,className:Lt()["item-input"],onChange:Ke=>Ct(Ke,Me),LimitLength:w.Ef,char:!0,showCount:!0,disabledInput:ye})),c().createElement(Je.Z,{span:me.checkbox},c().createElement(q.Z,{checked:ge.is_answer==="true"||ge.is_answer===!0,className:Lt()["option-checkbox"],onChange:Ke=>Tt(Ke,Me)})),c().createElement(Je.Z,{span:me.placeholder},fe({index:Me}))),c().createElement(et.Z,null,c().createElement(Je.Z,{flex:me.label}),c().createElement(Je.Z,{span:me.content},c().createElement(L.Z,{uploadBthContainerClassName:Lt()["option-resource-upload-container"],resource:{images:ge.image,audios:ge.audio,videos:ge.video},onResourceChange:Ke=>{qe({resource:Ke,index:Me})}})),c().createElement(Je.Z,{span:me.checkbox}),c().createElement(Je.Z,{span:me.placeholder})))}return c().createElement("div",{className:Lt()["options-container"]},c().createElement(et.Z,{align:"middle"},c().createElement(Je.Z,{flex:me.label,className:Lt()["select-answer-col"]},c().createElement("span",{className:"".concat(Lt()["option-header"]," ").concat(Lt()["option-label"])},Ue("learning.questionAddOptionName"))),c().createElement(Je.Z,{span:me.content}),c().createElement(Je.Z,{span:me.checkbox,className:Lt()["select-answer-col"]},c().createElement("span",{className:"".concat(Lt()["option-header"]," ").concat(Lt()["option-answer"])},Ue("learning.questionAddOptionSubName"))),c().createElement(Je.Z,{span:me.placeholder})),De.map((ee,ge)=>oe===h.Nb.TOF?re({option:ee,index:ge}):oe===h.Nb.SINGLE||oe===h.Nb.MULTIPLE?pe({option:ee,index:ge}):null),(oe===h.Nb.SINGLE||oe===h.Nb.MULTIPLE)&&c().createElement($.Io,{onClick:ht,icon:!0,disabled:De.length>=w.g5},Ue("learning.questionAddOptionAddBtn")))}Wt.defaultProps={layout:{label:"56px",content:18,checkbox:2,placeholder:2}};var pa=(0,t.Z)((0,I.Z)()(Wt)),Xt=e(77576),Et=e(59314),Fe=e(68628),Pe=e(31130),Ie=e.n(Pe);function $e(ke){var Ue=ke.t,De=ke.value,oe=ke.onFieldChange,xe=me=>{oe(me)};return c().createElement(c().Fragment,null,c().createElement(Et.Z,{onChange:xe,checked:De==="true"||De===!0}),c().createElement("div",{className:Ie()["toolTip-container"]},c().createElement(j.Z,{placement:"right",title:Ue("learning.isOrderReplyUploadPicturesSwitchTip")},c().createElement(Fe.Z,{style:{fontSize:"16px",color:"rgba(0, 0, 0, 0.45)"}}))))}var te=(0,t.Z)((0,I.Z)()($e)),ae=e(28071),Re=e.n(ae);function de(ke){var Ue=ke.t,De=ke.value,oe=ke.onFieldChange,xe=me=>{oe(me)};return c().createElement(c().Fragment,null,c().createElement(Et.Z,{onChange:xe,checked:De==="true"||De===!0}),c().createElement("div",{className:Re()["toolTip-container"]},c().createElement(j.Z,{placement:"right",title:Ue("learning.isOrderMatchTip")},c().createElement(Fe.Z,{style:{fontSize:"16px",color:"rgba(0, 0, 0, 0.45)"}}))))}var we=(0,t.Z)((0,I.Z)()(de)),rt=e(17026),mt=e.n(rt);function Zt(ke){var Ue=ke.value,De=Ue.map(oe=>{var xe=oe.title;return xe.split(h.Zl)});return(De||[]).flat()}function bt(ke){var Ue=ke.t,De=ke.value,oe=ke.onFieldChange,xe=ke.disabledInput,me=(0,B.useState)(0),ye=(0,y.Z)(me,2),We=ye[0],ze=ye[1];function qe(){De.push({title:"",is_answer:!0,image:[],audio:[],video:[]}),oe(Be()(De))}function Tt(Vt){De.splice(Vt,1),ze(We+1),oe(Be()(De))}function Ct(Vt,ht){De[ht].title=Vt.join(h.Zl),oe(Be()(De))}return c().createElement("div",{className:mt()["blank-keyword"]},De.map((Vt,ht)=>{var re=Vt.title.split(h.Zl).filter(fe=>fe);return c().createElement("div",{key:ht,className:mt()["keyword-item"]},c().createElement("div",{className:mt()["keyword-left"]},c().createElement("span",{className:mt().label},"".concat(Ue("examination.keyword")).concat(ht+1)),c().createElement("div",{className:mt()["keyword-container"]},c().createElement(ve,{key:"".concat(ht,"_").concat(We),data:Zt({value:De}),dataDeDuplication:!0,defaultTags:re,onTagsChange:fe=>Ct(fe,ht),disabledInput:xe,disabledStr:h.Zl,defaultInputVisible:re.length<=0,tagCount:w.I4,maxLength:w.YX,addTitle:Ue("examination.addAnswer")}))),De.length>1&&c().createElement("span",{className:mt()["remove-keyword-btn"],onClick:()=>Tt(ht)},Ue("common.delete")))}),c().createElement("div",{className:mt()["btn-container"]},c().createElement($.Io,{disabled:De.length>=w.Jp,onClick:qe,icon:!0},Ue("learning.questionAddOptionDescAddBtn"))))}bt.defaultProps={disabled:!1};var Ft=(0,t.Z)((0,I.Z)()(bt)),Ut=e(26922),ca=e(64615),Qt=e.n(ca),Va=e(4408),Ra=e(97413),Ua=e(56316),ja=e.n(Ua),ua=e(84874);function ts(ke){var Ue=ke.title,De=ke.className;return c().createElement("div",{className:"".concat(ja()["section-title"]," ").concat(De)},Ue)}function as(ke){var Ue=ke.disabled,De=Ue===void 0?!1:Ue,oe=ke.value,xe=ke.icon,me=xe===void 0?!1:xe,ye=ke.children,We=(0,E.v9)(Tt=>{var Ct=Tt.advancedSetting;return{themeColor:Ct.themeColor}}),ze=We.themeColor;function qe(Tt){return typeof Tt=="boolean"&&Tt?Tt?c().createElement(ua.Z,{iconClass:"icon-icon_addx",size:"12px"}):null:Tt}return c().createElement(a.Z,(0,T.Z)({},ke,{style:De?{}:{color:ze,borderColor:ze},icon:(0,B.useMemo)(()=>qe(me),[me])}),ye||oe)}function Fa(ke){return React.createElement("div",{className:style["textarea-container"]},React.createElement(_Input.TextArea,_extends({showCount:!0},ke)))}function Sa(ke){var Ue=ke.className,De=ke.tip;return React.createElement("div",{className:"".concat(style["tip-container"]," ").concat(Ue)},React.createElement(SvgIcon,{iconClass:"icon-shuoming",size:"12px",color:"rgba(0, 0, 0, 0.45)"}),React.createElement("span",{className:style.tip},De))}var us=e(5259),Ds=e(62615),Za={ADD:"add",EDIT:"edit",BATCH_ADD:"batchAdd"},ga=ke=>{var Ue=ke.t,De=ke.initialValues,oe=ke.type,xe=(0,B.useRef)(),me=(0,B.useRef)({operationType:""}),ye=(0,B.useState)({question_bank_id:"",question_bank_name:"",question_id:""}),We=(0,y.Z)(ye,2),ze=We[0],qe=We[1],Tt=(0,B.useState)(new Date().getTime()),Ct=(0,y.Z)(Tt,2),Vt=Ct[0],ht=Ct[1],re=(0,B.useState)(!1),fe=(0,y.Z)(re,2),pe=fe[0],ee=fe[1],ge=(0,B.useState)([]),Me=(0,y.Z)(ge,2),Ke=Me[0],ct=Me[1],pt=(0,B.useState)(!1),_t=(0,y.Z)(pt,2),At=_t[0],Gt=_t[1],Ia=(0,B.useState)(!1),Ba=(0,y.Z)(Ia,2),ia=Ba[0],da=Ba[1];(0,B.useEffect)(()=>{var Wa=A.parse(M.m8.location.search),hs=Wa.questionBankId,Oa=Wa.questionBankName,Ha=Wa.questionId;qe({question_bank_id:hs,question_bank_name:Oa,question_id:Ha})},[]);function Es(Wa){var hs=Wa.currentType,Oa=Wa.previousType,Ha=xe.current.getFormikBag().values,ms=Ha.choiceOptions,wa=Ha.title,xa=wa===void 0?"":wa;ms.forEach(rs=>{rs.is_answer=!1}),[h.Nb.SINGLE,h.Nb.MULTIPLE].includes(hs)&&xe.current.setFieldValue("choiceOptions",ms),Oa===h.Nb.BLANK&&hs!==h.Nb.BLANK&&xe.current.setFieldValue("title",(0,h.PP)({title:xa}))}function Fs(Wa){var hs=Wa.data,Oa=Wa.paper_ids,Ha=Oa===void 0?"":Oa;ee(!0);var ms=(0,P.Z)((0,P.Z)({},hs),{},{paper_ids:Ha}),wa=ze.question_id;us.WW({data:ms,questionId:wa}).then(xa=>{var rs=xa.data,ss=rs.code;ss==="200000"&&(K.default.success(Ue("study.updateSuccess")),me.current.operationType===w.fh.REFRESH&&(0,w.mh)(ze))}).finally(()=>{ee(!1)})}function Ts(Wa,hs){return Ns.apply(this,arguments)}function Ns(){return Ns=(0,o.Z)(p().mark(function Wa(hs,Oa){var Ha,ms,wa,xa,rs,ss,Ks,Qs,nn,rn;return p().wrap(function(As){for(;;)switch(As.prev=As.next){case 0:if(Ha=Oa.resetForm,!(oe===Za.ADD&&me.current.operationType)){As.next=7;break}ee(!0),ms=(0,P.Z)((0,P.Z)({},(0,w.Uh)(hs)),{},{question_bank_id:ze.question_bank_id}),us.xL({data:ms}).then(ln=>{var Cn=ln.data,ws=Cn.code;ws==="200000"&&(K.default.success(Ue("common.releaseSuccess")),me.current.operationType===w.fh.PUBLISH&&(0,w.mh)(ze),me.current.operationType===w.fh.PUBLISH_THEN_CONTINUE&&(Ha((0,P.Z)((0,P.Z)({},(0,w.oo)({t:Ue})),{},{type:hs.type})),ee(!1),ht(new Date().getTime())),me.current.operationType="")}).catch(()=>{ee(!1)}),As.next=14;break;case 7:if(!(me.current.operationType&&me.current.operationType===w.fh.REFRESH)){As.next=14;break}return As.next=10,us.Nl({ids:"".concat(ze.question_id)});case 10:wa=As.sent,xa=wa.data,rs=xa.code,ss=xa.data,rs==="200000"&&(Ks=ss.is_quote,Qs=ss.quote_list,nn=Qs===void 0?[]:Qs,Ks==="true"?(ct(nn),Gt(!0)):(rn=(0,P.Z)((0,P.Z)({},(0,w.Uh)(hs)),{},{question_bank_id:ze.question_bank_id}),Fs({data:rn})));case 14:case"end":return As.stop()}},Wa)})),Ns.apply(this,arguments)}function ks(Wa){me.current.operationType=Wa,Wa===w.fh.PREVIEW?da(!0):Wa===w.fh.CANCEL?(0,w.mh)(ze):(Wa===w.fh.PUBLISH||Wa===w.fh.PUBLISH_THEN_CONTINUE||w.fh.REFRESH)&&xe.current.submitForm()}var Bs=(0,B.useMemo)(()=>oe===Za.EDIT?Ue("documentTitle.editQuestion"):Ue("documentTitle.addQuestion"),[oe,Ue]);return c().createElement("div",{className:Qt().container},c().createElement(Va.Z,{title:Bs}),c().createElement(g.Z,{spinning:pe},c().createElement("div",{className:Qt().edit},c().createElement("div",{className:Qt()["form-container"]},c().createElement("h1",{className:Qt()["page-title"]},oe===Za.EDIT?"".concat(Ue("common.edit")).concat(Ue("learning.questionAddTitle")):"".concat(Ue("common.add")).concat(Ue("learning.questionAddTitle"))),c().createElement(g.Z,{spinning:pe},c().createElement(v.J9,{ref:xe,initialValues:De,onSubmit:Ts,render:Wa=>c().createElement(La,(0,T.Z)({},Wa,{layout:w._,formContainer:Qt()["cl-form"],type:oe,onTypeChange:Es,componentKey:Vt}))}),c().createElement("div",{className:"cl-form-fixed-footer"},c().createElement("div",{className:"cl-form-fixed-footer__container"},oe===Za.EDIT?c().createElement(c().Fragment,null,c().createElement(as,{onClick:()=>{ks(w.fh.CANCEL)},icon:!1},Ue("common.cancel")),c().createElement(a.Z,{type:"primary",onClick:()=>{ks(w.fh.REFRESH)}},Ue("examination.updateQuestion"))):c().createElement(c().Fragment,null,c().createElement(as,{onClick:()=>{ks(w.fh.PREVIEW)},icon:!1},Ue("component.preview")),c().createElement(as,{onClick:()=>{ks(w.fh.PUBLISH)},icon:!1},Ue("common.release")),c().createElement(a.Z,{type:"primary",onClick:()=>{ks(w.fh.PUBLISH_THEN_CONTINUE)}},Ue("examination.publishThenAdd"))))))),ia&&c().createElement(Ra.Dc,{visible:ia,questionInfo:(0,w.Uh)(xe.current.getFormikBag().values),onOk:()=>{},onCancel:()=>{da(!1)}}))),Ke.length>0&&c().createElement(Ra.pU,{title:Ue("examination.questionReferTitle"),tip:Ue("examination.questionReferTip"),tipContent:Ue("examination.questionReferTipContent"),list:Ke,visible:At,onOk:Wa=>{Fs({data:(0,P.Z)((0,P.Z)({},(0,w.Uh)(xe.current.getFormikBag().values)),{},{question_bank_id:ze.question_bank_id}),paper_ids:Wa})},onCancel:()=>{Gt(!1)},rowSelection:!0}))},Ga=ke=>{var Ue=ke.t,De=ke.type,oe=ke.onTypeChange,xe=ke.componentKey,me=ke.disabledInput,ye=ke.formContainer,We=ke.formik,ze=ke.optionLayout,qe=ke.layout,Tt=We.values,Ct=We.submitForm;(0,B.useEffect)(()=>{De===Za.BATCH_ADD&&Ct()},[]),(0,B.useEffect)(()=>{Vt&&Vt(Tt)},[Tt]);var Vt=re=>{ke.onFormValuesChange&&ke.onFormValuesChange(re)};function ht(re){var fe=re.props,pe=fe.values,ee=pe.type;return ee===h.Nb.SINGLE||ee===h.Nb.MULTIPLE||ee===h.Nb.TOF?c().createElement(v.gN,(0,T.Z)({name:ee===h.Nb.TOF?"tofOptions":"choiceOptions",label:"",displayType:"Custom",disabledInput:me,component:pa,layout:ze,questionType:ee,validate:ge=>Ut.Z.options(ge,fe.values.type)},qe.formFieldLayout)):null}return c().createElement(v.l0,{className:ye},De!==Za.BATCH_ADD&&c().createElement(c().Fragment,null,c().createElement(v.gN,(0,T.Z)({name:"type",disabled:De===Za.EDIT,component:z,onChange:oe,displayType:"Custom"},qe.formFieldLayout)),c().createElement(ts,{t:Ue,title:Ue("learning.questionAddSecContent")})),c().createElement(v.gN,{name:"difficulty",label:Ue("learning.questionAddContentLevel"),required:!0,displayType:"Custom",component:m}),c().createElement(v.gN,(0,T.Z)({name:"title",displayType:"Custom",label:Ue("learning.questionAddContentName"),required:!0,disabledInput:me,component:ne,options:ke.values.blankOptions,validate:re=>Ut.Z.title(re,ke.values.type,ke.values.summary),questionType:ke.values.type,summary:ke.values.summary,setFieldValue:ke.setFieldValue},qe.formTitleLayout)),ht({props:ke}),ke.values.type===h.Nb.BLANK&&c().createElement(v.gN,{name:"is_order_match",label:Ue("learning.isOrderMatchLabel"),displayType:"Custom",component:we}),ke.values.type===h.Nb.DESCRIBE&&c().createElement(v.gN,{formItemClassName:"describe-options-container",name:"describeOptions",displayType:"Custom",required:!0,disabledInput:me,component:Ft,validate:re=>Ut.Z.options(re,h.Nb.DESCRIBE)}),(ke.values.type===h.Nb.DESCRIBE||ke.values.type===h.Nb.BLANK)&&c().createElement(v.gN,{name:"is_answer_upload_image",label:Ue("learning.isOrderReplyUploadPicturesSwitchLabel"),displayType:"Custom",component:te}),c().createElement(v.gN,{key:xe,name:"tags",label:Ue("learning.questionAddTag"),displayType:"Custom",disabledInput:me,validate:re=>Ut.Z.knowledgePoint(re),component:Ae}),c().createElement(ts,{t:Ue,title:Ue("learning.questionAddSecAnalysis"),className:Qt()["analysis-title"]}),c().createElement(v.gN,(0,T.Z)({name:"analysis",displayType:"Custom",label:Ue("learning.questionAddSecAnalysisName"),component:_e,disabledInput:me,validate:re=>Ut.Z.analysis(re),type:"text"},qe.formTitleLayout)),c().createElement(Ds.I,null))},La=(0,v.$j)((0,I.Z)()(Ga)),fa=(0,I.Z)()(ga)},26922:function(gt,Se,e){"use strict";var O=e(93485),g=e(3407),b=e(6793),a=e(60828),T=e(61698),o=e(2396),D=(0,b.me)(),K=g.Z[D].learning.validation,P=g.Z[D].examination,y=P.visualization;function C(M,v){if(!(0,b.fy)(M))return K.questionAddTitleNull;if((0,o.$s)(M)>T.wN)return(0,b.ZT)(y.titleMaxLength,T.wN);if(v===a.Nb.BLANK){var A=M.replaceAll(a.e5.blankReg,"");if(!(0,b.fy)(A))return P.blankNoTextTip;var d=(0,a.iq)({title:M});if(d.length<1)return P.blankFormatTip;if(d.length>T.EZ)return(0,b.ZT)(y.blankMaxCount,T.EZ);var l=(0,O.Z)(d),t;try{for(l.s();!(t=l.n()).done;){var h=t.value,F=h.title.split("".concat(a.$V));if(F.length<1)return P.blankNullAnswerTip;var m=F.some(E=>!E.trim());if(m)return P.blankNullAnswerTip}}catch(E){l.e(E)}finally{l.f()}}return""}function p(M){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(v===a.Nb.DESCRIBE){if(M.length<1)return P.addKeyword;if(M.length>T.Jp)return(0,b.ZT)(y.maxKeywordCount,T.Jp);var A=M.find(m=>{var E=m.title;return E.length<1});if(A)return P.addKeywordContent;var d=M.find(m=>{var E=m.title,Q=E.split("/");return Q.find(G=>G.length>T.YX)}),l=M.find(m=>{var E=m.title,Q=E.split("/");return Q.length>T.I4});if(l)return(0,b.ZT)(y.keywordAlterCount,T.I4);if(d)return(0,b.ZT)(y.keywordMaxLength,T.YX)}if(v===a.Nb.MULTIPLE||v===a.Nb.SINGLE){if(M.length<=0)return y.noneOption;if(M.length>T.g5)return(0,b.ZT)(y.optionsMaxCount,T.g5);var t=M.filter(m=>{var E=m.title,Q=m.image;return E===""&&Q.length<=0});if(t.length>0)return g.Z[D].learning.questionAddOptionPlaceholder;var h=M.filter(m=>{var E=m.title;return(0,o.$s)(E)>T.Ef});if((v===a.Nb.MULTIPLE||v===a.Nb.SINGLE)&&h.length>0)return(0,b.ZT)(y.optionMaxLength,T.Ef)}var F=M.filter(m=>{var E=m.is_answer;return E==="true"||E===!0});return(v===a.Nb.TOF||v===a.Nb.SINGLE)&&F.length<1?P.settingAnswer:v===a.Nb.MULTIPLE&&F.length<2?P.settingTwoAnswer:""}function B(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return M.length>0&&M.length!==new Set(M).size?K.questionAddKowRepeat:M.length>T.to?(0,b.ZT)(y.maxKnowledgeCount,T.to):M.find(v=>v.length>T.lO)?(0,b.ZT)(y.knowledgeMaxLength,T.lO):""}function c(M){return(0,o.$s)(M.title||"")>T.ab?(0,b.ZT)(y.analysisMaxLength,T.ab):""}function I(M){var v=M.title,A=M.tags,d=M.options,l=M.type,t=M.analysis,h=C(v,l)||p(d,l)||B(A)||c(t);return!h}Se.Z={title:C,options:p,knowledgePoint:B,analysis:c,verifyQuestion:I}},5259:function(gt,Se,e){"use strict";e.d(Se,{bB:function(){return b},Qm:function(){return a},Dx:function(){return T},Ut:function(){return o},s4:function(){return D},Z2:function(){return K},gB:function(){return P},Ff:function(){return y},Wu:function(){return C},mA:function(){return p},BX:function(){return c},eb:function(){return I},Km:function(){return M},MJ:function(){return v},dY:function(){return A},yB:function(){return d},eg:function(){return l},NZ:function(){return t},Le:function(){return h},Zl:function(){return F},pT:function(){return m},ji:function(){return E},C0:function(){return Q},W9:function(){return G},vV:function(){return V},Ww:function(){return z},tT:function(){return $},uG:function(){return W},fZ:function(){return S},qp:function(){return x},RS:function(){return U},JR:function(){return L},Gw:function(){return w},X5:function(){return k},xL:function(){return ie},gu:function(){return Ne},WW:function(){return ue},Nl:function(){return _e},P2:function(){return Ze}});var O=e(10237),g=e(5430);function b(j){var R=g.OB.questionBank.list(j);return O.WY.get({url:R,params:j})}function a(j){var R=g.OB.questionBank.wheatList(j);return O.WY.get({url:R,params:j})}function T(j){var R=g.OB.questionBank.questionList(j);return O.WY.get({url:R,params:j})}function o(){var j=g.OB.questionBank.listAll();return O.WY.get({url:j})}function D(j){var R=g.OB.questionBank.info(j);return O.WY.get({url:R})}function K(j){var R=g.OB.questionBank.add();return O.WY.post({url:R,data:j})}function P(j,R){var le=g.OB.questionBank.edit(j);return O.WY.post({url:le,data:R})}function y(j){var R=g.OB.questionBank.authorize();return O.WY.post({url:R,data:j})}function C(j){var R=g.OB.questionBank.delete(j);return O.WY.post({url:R})}function p(j,R){var le=g.OB.questionBank.updateStatus(j);return O.WY.post({url:le,params:R})}function B(j){var R=EXAM_API.question.download();return formDataRequest.post({url:R,data:j})}function c(j){var R=g.OB.question.importSubmit();return O.qg.post({url:R,data:j})}function I(j){var R=g.OB.question.list();return O.WY.get({url:R,params:j})}function M(j){var R=g.OB.question.delete();return O.WY.post({url:R,data:j})}function v(j,R){var le=g.OB.question.move(j);return O.WY.post({url:le,data:R})}function A(j){var R=g.OB.question.copy(j);return O.WY.post({url:R})}function d(j,R){var le=g.OB.question.export(j);return O.WY.post({url:le,data:R})}function l(j){var R=g.OB.question.batchQueryList();return O.WY.post({url:R,data:j})}function t(j){var R=g.OB.PaperManager.getPaperList();return O.WY.get({url:R,params:j})}function h(j){var R=g.OB.PaperManager.postEditPaper(j.id);return O.WY.post({url:R,data:j})}function F(j){var R=g.OB.PaperManager.postEditWheatPaper(j.id);return O.WY.post({url:R,data:j})}function m(j){var R=g.OB.PaperManager.postAddPaper();return O.WY.post({url:R,data:j})}function E(j){var R=g.OB.PaperManager.postAddWheatPaper();return O.WY.post({url:R,data:j})}function Q(j){var R=g.OB.PaperManager.getPaperInfo(j);return O.WY.get({url:R})}function G(j){var R=g.OB.PaperManager.getWheatPaperInfo(j);return O.WY.get({url:R})}function V(j){var R=g.OB.PaperManager.postCopyPaper(j.paperId);return O.WY.post({url:R,data:j})}function z(j){var R=g.OB.PaperManager.postUpdatePaperStatus(j.paperId);return O.WY.post({url:R,params:j})}function $(j){var R=g.OB.PaperManager.postUpdateWheatPaperStatus(j.paperId);return O.WY.post({url:R,params:j})}function W(j){var R=g.OB.PaperManager.deletePaper(j);return O.WY.post({url:R})}function S(j,R){var le=g.OB.PaperManager.referencePaperById(j);return O.WY.get({url:le,params:R})}function x(j){var R=g.OB.PaperManager.postPaperAuthorization();return O.WY.post({url:R,data:j})}function U(j){var R=g.OB.PaperManager.getPaperTestInfo(j);return O.WY.get({url:R})}function L(j,R){var le=g.OB.PaperManager.postSaveFixedPaper(j);return O.WY.post({url:le,data:R})}function w(j,R){var le=g.OB.PaperManager.postSaveRandomPaper(j);return O.WY.post({url:le,data:R})}function k(j,R){var le=g.OB.PaperManager.postSaveStudentRandomPaper(j);return O.WY.post({url:le,data:R})}function ne(j,R){var le=EXAM_API.PaperManager.getExportPaper(j);return request.get({url:le,params:R})}function ie(j){var R=j.data,le=g.OB.question.add();return O.WY.post({url:le,data:R})}function Ne(j){var R=j.questionId,le=g.OB.question.queryQuestionDetail({questionId:R});return O.WY.get({url:le})}function ue(j){var R=j.questionId,le=j.data,H=g.OB.question.edit({questionId:R});return O.WY.post({url:H,data:le})}function _e(j){var R=g.OB.question.check();return O.WY.post({url:R,data:j})}function Ze(j){var R=g.OB.question.batchAdd();return O.WY.post({url:R,data:j})}},31459:function(gt,Se,e){"use strict";var O=e(57663),g=e(71577),b=e(57361),a=e(9754),T=e.n(a),o=e(12924),D=e.n(o),K=e(91768),P=e(80991),y=e(28216),C=e(37055),p=e(10237),B=e(88311),c=e(43859),I=e(60667),M=e(38642),v=e(26885);class A extends D().Component{constructor(){var t;super(...arguments);t=this,this.state={orgDialogVisible:!1,qyWeChatVo:"",whiteList:{zaraFlag:(0,M.UI)("ZARA_H5")}},this.cancelOrg=()=>{this.setState({orgDialogVisible:!1})},this.getLecturer=function(){var h=(0,b.Z)(T().mark(function F(m){var E,Q,G,V,z,$;return T().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(E=t.state.qyWeChatVo,Q=t.props.lectureInfo.default_avatar,G=localStorage.getItem("authorityType"),V=navigator.userAgent.toLowerCase().indexOf("wxwork")>-1,t.setState({orgDialogVisible:!1}),z=m.user&&m.user.length,!(V&&G==="1")){S.next=19;break}if(!z){S.next=14;break}return S.next=10,p.WY.get({url:C.ZP.Lecturer.getUserInfoByQyId(),params:{user_id:m.user[0].user_id||""}});case 10:$=S.sent,t.props.formik.setFieldValue("inside_avatar",$.data.avatar||Q),S.next=15;break;case 14:t.props.formik.setFieldValue("inside_avatar",Q);case 15:t.props.formik.setFieldValue("lecturer_name",z?m.user[0].user_id:""),t.props.formik.setFieldValue("qy_we_chat_vo",E),S.next=22;break;case 19:t.props.formik.setFieldValue("lecturer_name",m.user[0].name),t.props.formik.setFieldValue("user_id",m.user[0].id),t.props.formik.setFieldValue("inside_avatar",m.user[0].avator||Q);case 22:t.props.updateLectureInfo&&t.props.updateLectureInfo({lectureSyncUserId:z?m.user[0].user_id:"",lectureSourceType:z?m.user[0].source_type:""});case 23:case"end":return S.stop()}},F)}));return function(F){return h.apply(this,arguments)}}(),this.openOrg=()=>{var h=localStorage.getItem("authorityType"),F=this.props.user.loginMode;F==="WE_COM"&&h==="1"?this.handleSelectWx():this.setState({orgDialogVisible:!0})},this.handleSelectWx=()=>{var h=this.props.user,F=this.props.lectureInfo,m=[F.lectureSyncUserId];(0,v.Sk)({userIds:m,mode:"single"}).then(E=>{(0,v.$f)({result:E,user:h,hasDefault:!1}).then(Q=>{var G=Q.qyWeChatVo,V=Q.rangeList;this.setState({qyWeChatVo:G},()=>{this.getLecturer(V)})})}).catch(()=>{this.cancelOrg()})}}render(){var t=this.state,h=t.orgDialogVisible,F=t.whiteList,m=this.props,E=m.t,Q=m.value,G=m.lectureInfo;return D().createElement("div",{className:"select_lecturer"},D().createElement("div",null,D().createElement("span",{className:"addLecturerName"},F.zaraFlag?Q:D().createElement(I.Z,{dataType:"userName",value:G.lectureSyncUserId,name:Q,type:G.lectureSourceType})),D().createElement(g.Z,{onClick:this.openOrg},F.zaraFlag?E("lecturerPage.zaraLecturer"):E("lecturerPage.chooseLecturer")),h?D().createElement(B.Z,{visible:h,onOk:this.getLecturer,onCancel:this.cancelOrg,onlyUser:!0,single:!0,title:E("lecturerPage.chooseLecturer")}):null))}}var d=l=>({user:l.user});Se.Z=(0,y.$j)(d)((0,c.Z)((0,P.$j)((0,K.Z)()(A))))},49010:function(gt,Se,e){"use strict";e.d(Se,{Z:function(){return E}});var O=e(22385),g=e(31097),b=e(88983),a=e(47933),T=e(88986),o=e(12924),D=e.n(o),K=e(91768),P=e(80991),y=e(28216),C=e(62029),p=e(88311),B=e(84874),c=e(60667),I=e(26885);class M extends D().Component{constructor(G){super(G);this.showOrg=()=>{var V=this.state.orgDialogConfig,z=localStorage.getItem("authorityType"),$=this.props.user.loginMode;this.props.qwTicketShow&&$==="WE_COM"&&z==="1"?this.handleSelectWx():(V.visible=!0,this.setState({orgDialogConfig:V}))},this.handleSelectWx=()=>{var V=this.state.userList.map(z=>z.unionid||z.user_id||z.userId);(0,I.Sk)({userIds:V}).then(z=>{(0,I.$f)({type:"normal",result:z}).then($=>{var W=$.user,S=$.qyWeChatVo;this.setState({qyWeChatVo:S},()=>{this.addUser({user:W})})})}).catch(()=>{this.hiddenOrg()})},this.addUser=V=>{var z=V.user,$=this.state,W=$.orgDialogConfig,S=$.stepIndex,x=$.qyWeChatVo;W.visible=!1,this.setState({orgDialogConfig:W,userList:z}),this.props.onChange(z,S,x)},this.hiddenOrg=()=>{var V=this.state.orgDialogConfig;V.visible=!1,this.setState({orgDialogConfig:V})},this.removeUser=V=>{var z=this.state,$=z.userList,W=z.stepIndex;$.splice(V,1),this.setState({userList:$}),this.props.onChange($,W)},this.deleteMultiStep=()=>{this.props.deleteMultiStep()},this.state={orgDialogConfig:{visible:!1,onlyUser:!0,displayType:["dept"],onOk:this.addUser,onCancel:this.hiddenOrg},userList:[],stepIndex:G.stepIndex,qyWeChatVo:""}}static getDerivedStateFromProps(G,V){if(G.userList!==V.userList)return{userList:G.userList||[]}}render(){var G=this.state,V=G.orgDialogConfig,z=G.userList,$=this.props,W=$.orgProps,S=$.t,x=localStorage.getItem("authorityType"),U=this.props.user.appType;return D().createElement("div",{className:"authvision-selector"},z.map((L,w)=>{var k=U==="wx_app"&&x==="1"?(L==null?void 0:L.unionid)||(L==null?void 0:L.userId)||(L==null?void 0:L.user_id):(L==null?void 0:L.userId)||(L==null?void 0:L.user_id);return D().createElement("div",{className:"supervision-selector-item",key:w},D().createElement(c.Z,{dataType:"userName",value:k,name:L.name||L.user_name,type:(L==null?void 0:L.source_type)||(L==null?void 0:L.sourceType)}),D().createElement("span",{className:"remove-icon",onClick:()=>this.removeUser(w)},D().createElement(B.Z,{iconClass:"icon-guanbi1",size:"10px"})))}),D().createElement("div",{className:"authvision-selector-add",onClick:this.showOrg},D().createElement(B.Z,{iconClass:"icon-icon_addx",size:"10px"})),D().createElement("div",{className:"operation"},D().createElement("div",{className:"arrow"},D().createElement(B.Z,{iconClass:"icon-icon_doingx1"})),D().createElement("div",{className:"delete",onClick:this.deleteMultiStep},D().createElement(B.Z,{iconClass:"icon-icon_close"}))),D().createElement(p.Z,(0,C.Z)({},W,V,{initData:{user:z}})))}}M.defaultProps={addBtnText:"",defaultChecked:[],disabled:!1,orgProps:{},onChange:()=>{}};var v=Q=>{var G=Q.user;return{user:G}},A=(0,y.$j)(v)((0,K.Z)()(M));class d extends D().Component{constructor(){super(...arguments);this.userChange=(G,V,z)=>{var $=[...this.props.formik.values.supervisor.multilevel];$[V]=G,this.props.formik.setFieldValue("supervisor",(0,T.Z)((0,T.Z)({},this.props.formik.values.supervisor),{},{multilevel:$,type:"multilevel",qy_we_chat_vo:z}))},this.addMultiStep=()=>{var G=[...this.props.formik.values.supervisor.multilevel],V=G.length;V>=5||(G.push([]),this.props.formik.setFieldValue("supervisor",(0,T.Z)((0,T.Z)({},this.props.formik.values.supervisor),{},{multilevel:G,type:"multilevel"})))},this.deleteMultiStep=G=>{var V=[...this.props.formik.values.supervisor.multilevel];V.splice(G,1),this.props.formik.setFieldValue("supervisor",(0,T.Z)((0,T.Z)({},this.props.formik.values.supervisor),{},{multilevel:V,type:"multilevel"}))}}componentDidMount(){}render(){var G=this.props.formik.values.supervisor,V=this.props,z=V.t,$=V.qwTicketShow,W=localStorage.getItem("themeColor")||"#516ae6";return D().createElement("div",{className:"multilevel"},G.multilevel.map((S,x)=>D().createElement("ul",{className:"multilevel__step",key:x},D().createElement(A,{onChange:this.userChange,orgProps:{title:z("authentication.abilityDetailSecSelectApprover")},stepIndex:x,userList:S,deleteMultiStep:()=>this.deleteMultiStep(x),qwTicketShow:$!=="false"}))),D().createElement("div",{className:"addSupervision ".concat(G.multilevel.length>=5?"addSupervision-disabled":null),onClick:this.addMultiStep,style:{color:W,borderColor:W}},D().createElement(B.Z,{iconClass:"icon-icon_addx",size:"10px"}),z("authentication.abilityDetailSecAddApprover")))}}var l=(0,K.Z)()((0,P.$j)(d)),t=e(7653),h=e(43859);class F extends D().Component{constructor(){super(...arguments);this.onChange=G=>{this.props.formik.setFieldValue("supervisor",(0,T.Z)((0,T.Z)({},this.props.defaultFieldList),{},{type:G.target.value})),G.target.value==="lead"&&this.props.formik.setFieldValue("supervisor",(0,T.Z)((0,T.Z)({},this.props.defaultFieldList),{},{supervisorUserList:[],type:"lead"}))},this.handleOrChange=(G,V)=>{var z=(0,T.Z)((0,T.Z)({},this.props.defaultFieldList),{},{or:G,type:"or",qy_we_chat_vo:V});this.props.formik.setFieldValue("supervisor",z)},this.renderDialogActions=()=>{var G=this.props,V=G.defaultFieldList,z=G.disabled,$=z===void 0?!1:z,W=G.t,S=G.createUserId,x=G.isHasTutor,U=G.isOpenTutorSystem,L=G.qwTicketShow,w=V.type,k=V.or;return D().createElement("div",{className:"add-supervision-list"},D().createElement("div",null,D().createElement(a.ZP.Group,{onChange:this.onChange,value:w},D().createElement(a.ZP,{value:"or"},W("authentication.abilityDetailSecSupervisionOr")),D().createElement(a.ZP,{value:"multilevel"}," ",W("authentication.abilityDetailSecSupervisionMultiple")),D().createElement(a.ZP,{value:"lead"},W("authentication.abilityDetailSecSupervisionLeader")),x&&U?D().createElement(a.ZP,{value:"tutor"},D().createElement(g.Z,{placement:"top",title:D().createElement("p",null,W("tutorial.tutorTip"),D().createElement("br",null),W("tutorial.approvalTip1"),D().createElement("br",null),W("tutorial.approvalTip2"),D().createElement("br",null),W("tutorial.approvalTip3"))},D().createElement("span",{className:"shuoming-tip"},W("tutorial.supervisorApproval")),D().createElement(B.Z,{iconClass:"icon-shuoming",size:"16px",color:"rgba(87, 87, 87, 1)"}))):null)),D().createElement("div",{className:"add-supervision-list__tip"},w==="or"?W("authentication.abilityDetailSecSupervisionOrTips"):w==="lead"?W("authentication.abilityDetailSecSupervisionLeaderTips"):""),w==="or"?D().createElement(t.Z,{onChange:this.handleOrChange,createUserId:S,defaultChecked:k,disabled:$,orgProps:{title:W("authentication.abilityDetailSecSelectApprover")},addBtnText:W("authentication.abilityDetailSecAddApprover"),qwTicketShow:L!=="false"}):null,w==="multilevel"?D().createElement(l,{qwTicketShow:L}):null)},this.renderPageActions=()=>{var G=this.props,V=G.defaultFieldList,z=G.disabled,$=z===void 0?!1:z,W=G.t,S=G.createUserId,x=G.isHasTutor,U=G.isOpenTutorSystem,L=G.qyShield,w=G.qwTicketShow,k=V.type,ne=V.or;return D().createElement("div",{className:"add-supervision-list"},D().createElement("div",null,D().createElement(a.ZP.Group,{onChange:this.onChange,value:k},D().createElement(a.ZP,{value:"or"},D().createElement(g.Z,{placement:"top",title:W("authentication.abilityDetailSecSupervisionOrTip")},W("authentication.abilityDetailSecSupervisionOr"))),D().createElement(a.ZP,{value:"multilevel"}," ",W("authentication.abilityDetailSecSupervisionMultiple")),D().createElement(a.ZP,{value:"lead"},D().createElement(g.Z,{placement:"top",title:W("authentication.abilityDetailSecSupervisionLeaderTip")},W("authentication.abilityDetailSecSupervisionLeader"))),x&&U&&L==="false"?D().createElement(a.ZP,{value:"tutor"},D().createElement(g.Z,{placement:"top",title:D().createElement("p",null,W("tutorial.tutorTip"),D().createElement("br",null),W("tutorial.approvalTip1"),D().createElement("br",null),W("tutorial.approvalTip2"),D().createElement("br",null),W("tutorial.approvalTip3"))},D().createElement("span",{className:"shuoming-tip"},W("tutorial.supervisorApproval")),D().createElement(B.Z,{iconClass:"icon-shuoming",size:"16px",color:"rgba(87, 87, 87, 1)"}))):null)),k==="or"?D().createElement(t.Z,{createUserId:S,onChange:this.handleOrChange,defaultChecked:ne,disabled:$,orgProps:{title:W("authentication.abilityDetailSecSelectApprover")},addBtnText:W("authentication.abilityDetailSecAddApprover"),qwTicketShow:w!=="false"}):null,k==="multilevel"?D().createElement(l,{qwTicketShow:w}):null)}}componentDidMount(){this.props.dispatch({type:"publicVariable/getHasMenusPermissions",payload:{flag:"TutorSystem"}})}render(){var G=this.props,V=G.t,z=G.mode;return D().createElement("div",null,z==="dialog"?this.renderDialogActions():D().createElement("div",{className:"add-supervision"},D().createElement("div",{className:"add-supervision-header"},D().createElement("h4",{className:"add-supervision-header-title"},V("authentication.abilityDetailSecSupervisionTitle"))),this.renderPageActions()))}}var m=Q=>({isOpenTutorSystem:Q.publicVariable.isOpenTutorSystem,qyShield:Q.user.qyShield}),E=(0,y.$j)(m)((0,K.Z)()((0,h.Z)((0,P.$j)(F))))},16267:function(gt,Se,e){"use strict";e.d(Se,{N:function(){return T}});var O=e(12924),g=e.n(O),b=e(74946),a=e.n(b);function T(o){var D=o.title,K=o.className,P=o.children;return g().createElement("div",{className:"".concat(a()["section-title"]," ").concat(K)},D,P)}},64461:function(gt,Se,e){"use strict";e.d(Se,{mJ:function(){return O},wT:function(){return g},e9:function(){return b},iY:function(){return a},lt:function(){return T},Zt:function(){return D},bL:function(){return K},iN:function(){return P},bY:function(){return y},Qn:function(){return C},Tv:function(){return p},gm:function(){return B},FD:function(){return c},OU:function(){return I},$u:function(){return M},ub:function(){return v},Dq:function(){return A},Uc:function(){return d},aM:function(){return l},aS:function(){return t},z$:function(){return h}});var O={labelAlign:"right",labelCol:{span:3},wrapperCol:{span:21}},g={labelAlign:"right",labelCol:{span:3},wrapperCol:{span:21}},b={CUSTOM:"custom",UNLIMITED:"unlimited",AFTER_PASSED:"stopWhenPassed"},a={NEWEST:"latest",HIGHEST:"highest"},T={SYSTEM:"system",MANUAL:"manual"},o={SCORE:"score ",MANUAL:"manual"},D={AFTER_COMMIT:"afterCommit",AFTER_EXAM_PASSED:"afterExamPassed",AFTER_EXAM_END:"afterExamEnd",DISABLE_VIEWING:"disableViewing"},K={JUST_RIGHT_WRONG:"justRightWrong",ANSWER_ANALYSIS:"answerAnalysis",ANSWER_ERROR:"onlyError"},P={NO_CREDIT:"noCredit",STATUS:"score",SUBSECTION:"subsection"},y={PASS:"passed",ABSENCE:"absence",FAIL:"failed"},C={UNLIMITED:"unlimited",DISABLE:"disable",CUSTOM:"custom"},p={UNLIMITED:"unlimited",PC:"pc",MOBILE:"mobile"},B=99,c=1,I=100,M=10,v=300,A=0,d=99,l=1,t=999,h=0},75205:function(gt,Se,e){"use strict";e.d(Se,{mJ:function(){return g.mJ},wT:function(){return g.wT},e9:function(){return g.e9},iY:function(){return g.iY},lt:function(){return g.lt},Zt:function(){return g.Zt},Qn:function(){return g.Qn},FX:function(){return O.FX},iN:function(){return g.iN},bL:function(){return g.bL},bY:function(){return g.bY},AC:function(){return O.AC},S8:function(){return O.S8},jJ:function(){return O.jJ},DU:function(){return O.DU},F_:function(){return O.F_},Ck:function(){return O.Ck},gm:function(){return g.gm},FD:function(){return g.FD},OU:function(){return g.OU},$u:function(){return g.$u},ub:function(){return g.ub},Dq:function(){return g.Dq},Uc:function(){return g.Uc},aM:function(){return g.aM},aS:function(){return g.aS},z$:function(){return g.z$},Tv:function(){return g.Tv},Ks:function(){return O.Ks}});var O=e(85026),g=e(64461)},85026:function(gt,Se,e){"use strict";e.d(Se,{DU:function(){return D},bP:function(){return K},AC:function(){return P},S8:function(){return y},jJ:function(){return C},FX:function(){return B},F_:function(){return c},Ck:function(){return I},Ks:function(){return M}});var O=e(88986),g=e(81211),b=e(76651),a=e(64461),T=e(38642),o=e(22444),D={ADD_EXAM_TASK:"addExamTask",ADD_RELATION_EXAM_TASK:"addRelationExamTask"},K=(0,T.UI)("EXAM_BANK_CONFIG");function P(v){var A=v.data,d=v.user,l=v.type,t=l===void 0?D.ADD_EXAM_TASK:l,h={has_published:!1,paperInfo:{id:"",name:"",total_score:0,fill_blank_count:0,short_answer_count:0},exam_paper_info:{paper_name:"",pass_score:0,total_score:0,type:""},title:"",exam_duration:0,pass_line:60,description:"",classify_id:"",exam_times:{answer_rule:a.e9.UNLIMITED,exam_count:1},score_record_type:a.iY.NEWEST,always_extract_paper:!0,cut_screen_times:{cut_screen_rule:a.Qn.UNLIMITED,cut_screen_count:1,cut_screen_interval:0},random_order:{random_question:!1,random_options:!1},show_tag:!1,face_recognition:{before_exam:!1,in_exam:{checked:!1,type:o.tT.FREQUENCY,random_times:void 0,custom_interval_time:void 0}},mark_setting:{mark_type:a.lt.SYSTEM,fill_blank:!1,short_answer:!1,anonymous_marking:!1,marker_list:[{id:d.id,name:d.name,creator:!0}]},result_visible:{show_result:!0,result_view_rule:a.Zt.AFTER_COMMIT,answer_parsing:K?a.bL.ANSWER_ERROR:a.bL.ANSWER_ANALYSIS,ranking_list_view_rule:a.Zt.AFTER_COMMIT},answer_device:a.Tv.UNLIMITED};if(t===D.ADD_EXAM_TASK){if(A){var F=A.paper_id,m=A.classify_id,E=A.answer_rule,Q=A.exam_count,G=A.cut_screen_rule,V=A.cut_screen_count,z=A.cut_screen_interval,$=A.random_question,W=A.random_options,S=A.mark_question_type,x=A.mark_type,U=A.anonymous_marking,L=A.show_result,w=A.result_view_rule,k=A.answer_parsing,ne=A.ranking_list_view_rule,ie=A.exam_certificate_id,Ne=A.exam_certificate_url,ue=A.marker_list,_e=A.exam_object_info,Ze=A.exam_paper_info,j=A.create_user,R=A.create_user_name,le=A.authority_range,H=A.supervisor_mark,X=A.has_published,ce=A.face_recognition,Te=A.face_snapshot_rule,Le=A.answer_device,he=(0,g.Z)(A,["paper_id","classify_id","answer_rule","exam_count","cut_screen_rule","cut_screen_count","cut_screen_interval","random_question","random_options","mark_question_type","mark_type","anonymous_marking","show_result","result_view_rule","answer_parsing","ranking_list_view_rule","exam_certificate_id","exam_certificate_url","marker_list","exam_object_info","exam_paper_info","create_user","create_user_name","authority_range","supervisor_mark","has_published","face_recognition","face_snapshot_rule","answer_device"]);return(0,O.Z)({paperInfo:{id:F,name:Ze?Ze.paper_name:"",total_score:Ze?Ze.total_score:"",fill_blank_count:Ze&&Ze.fill_blank_count||0,short_answer_count:Ze&&Ze.short_answer_count||0},classify_id:m||"",exam_paper_info:Ze||{},exam_times:{answer_rule:E,exam_count:Q},cut_screen_times:{cut_screen_rule:G,cut_screen_count:V,cut_screen_interval:z},random_order:{random_question:$,random_options:W},mark_setting:{mark_type:x,fill_blank:S.fill_blank,short_answer:S.short_answer,anonymous_marking:U,marker_list:ue.length>0?ue:[{id:j,name:R,creator:!0}]},result_visible:{show_result:L,result_view_rule:w,answer_parsing:k,ranking_list_view_rule:ne},exam_certificate:{id:ie,name:"",url:Ne},jurisdiction:{authority_range:le,supervisor_mark:H},tagGroup:{resourceType:"examTask",tagsNameList:[]},has_published:X==="true"||X===!0,face_recognition:p({face_recognition:ce,face_snapshot_rule:Te}),answer_device:Le||a.Tv.UNLIMITED},he)}return(0,O.Z)((0,O.Z)({},h),{},{reward_rule:{type:a.iN.NO_CREDIT,absence:{checked:!0,score:0},passed:{checked:!0,score:0},failed:{checked:!0,score:0}},exam_certificate:{id:"",name:"",url:""},supervisor_list:[{id:d.id,name:d.name,creator:!0}],jurisdiction:{authority_range:!1,supervisor_mark:!0},tagGroup:{resourceType:"examTask",tagsNameList:[]}})}if(t===D.ADD_RELATION_EXAM_TASK){if(A){var Ee=A.paper_id,ve=A.classify_id,be=A.answer_rule,Ve=A.exam_count,Ae=A.cut_screen_rule,at=A.cut_screen_count,et=A.cut_screen_interval,ut=A.random_question,q=A.random_options,Oe=A.mark_question_type,Je=A.mark_type,je=A.anonymous_marking,Be=A.marker_list,St=A.exam_paper_info,Lt=A.create_user,Wt=A.create_user_name,pa=A.authority_range,Xt=A.supervisor_mark,Et=A.has_published,Fe=A.face_recognition,Pe=A.face_snapshot_rule,Ie=(0,g.Z)(A,["paper_id","classify_id","answer_rule","exam_count","cut_screen_rule","cut_screen_count","cut_screen_interval","random_question","random_options","mark_question_type","mark_type","anonymous_marking","marker_list","exam_paper_info","create_user","create_user_name","authority_range","supervisor_mark","has_published","face_recognition","face_snapshot_rule"]);return(0,O.Z)({paperInfo:{id:Ee,name:St?St.paper_name:"",total_score:St?St.total_score:"",fill_blank_count:St&&St.fill_blank_count||0,short_answer_count:St&&St.short_answer_count||0},classify_id:ve||"",exam_paper_info:St||{},exam_times:{answer_rule:be,exam_count:Ve},cut_screen_times:{cut_screen_rule:Ae,cut_screen_count:at,cut_screen_interval:et},random_order:{random_question:ut,random_options:q},mark_setting:{mark_type:Je,fill_blank:Oe.fill_blank,short_answer:Oe.short_answer,anonymous_marking:je,marker_list:Be.length>0?Be:[{id:Lt,name:Wt,creator:!0}]},has_published:Et==="true"||Et===!0,face_recognition:p({face_recognition:Fe,face_snapshot_rule:Pe})},Ie)}return(0,O.Z)({},h)}}function y(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},A=[];return v.question_bank_info_list&&v.question_bank_info_list.length&&v.question_bank_info_list.forEach(d=>{var l={fillBlankCount:d.fill_blank_count,shortAnswerCount:d.short_answer_count,multipleCount:d.multiple_count,singleCount:d.single_count,totalCount:d.total_count,trueOrFalseCount:d.true_or_false_count};A.push((0,O.Z)((0,O.Z)((0,O.Z)({},d),l),{},{data:(0,O.Z)({},l)}))}),{title:v.title,randomQuestion:{bankQuesitonVoList:A},stand:Number(v.pass_line||0)}}function C(v){return{face_recognition:v.before_exam,face_snapshot_rule:{face_process_switch:v.in_exam.checked,face_process_type:v.in_exam.type,face_process_value:v.in_exam.type===o.tT.FREQUENCY?v.in_exam.random_times:v.in_exam.custom_interval_time}}}function p(v){var A=v.face_recognition,d=v.face_snapshot_rule,l=d?typeof d=="string"?JSON.parse(d):d:{},t=l.face_process_switch,h=l.face_process_type,F=l.face_process_value;return{before_exam:A==="true"||A===!0,in_exam:{checked:t==="true"||t===!0,type:h||o.tT.FREQUENCY,random_times:h===o.tT.FREQUENCY&&F||void 0,custom_interval_time:h===o.tT.INTERVAL&&F||void 0}}}function B(v){var A=new Image;return A.src=v,new Promise((d,l)=>{A.onload=()=>{d({width:A.width,height:A.height})},A.onerror=t=>{l(t)}})}function c(){b.m8.push("/training/examination/newPlan")}function I(v){var A=v.min,d=v.max,l=v.value,t;return Number(l)>d?t=d:t=Number(l)||A,t}function M(v){var A=v.orgTypes,d=v.type,l=(0,T.UI)("FACE"),t=(0,T.UI)("CUT_SCREEN");if(Array.isArray(A)){if(d==="face")return A.includes("weixin")||A.includes("ding")||A.includes("third_oa_app")||A.length===1&&A.includes("app")||localStorage.uid==="10"||l;if(d==="cutScreen")return A.includes("ding")||A.includes("third_oa_app")||A.length===1&&A.includes("app")||localStorage.uid==="10"||t}return!1}},22444:function(gt,Se,e){"use strict";e.d(Se,{tT:function(){return I},fU:function(){return M},_D:function(){return A}});var O=e(77883),g=e(21888),b=e(88986),a=e(43358),T=e(34041),o=e(12924),D=e.n(o),K=e(91768),P=e(13364),y=e.n(P),C=e(40646),p=e(6793),B=T.Z.Option,c={BEFORE_EXAM:"before_exam",IN_EXAM:"in_exam"},I={FREQUENCY:"frequency",INTERVAL:"interval"},M=5,v=10;function A(l){var t=l.exam_duration,h=l.in_exam;if(t<=M)return{min:h.type===I.FREQUENCY?1:M,max:Number.MAX_SAFE_INTEGER};if(h.type===I.FREQUENCY){var F=t%5!=0?t/5:t/5-1;return{min:1,max:F<=v?F:v}}return{min:5,max:t-1}}function d(l){var t=l.t,h=l.value,F=l.onFieldChange,m=l.exam_duration,E=h.before_exam,Q=h.in_exam,G=(S,x)=>{var U=S.checked;if(x===c.BEFORE_EXAM&&F)if(U)F((0,b.Z)((0,b.Z)({},h),{},{before_exam:U}));else{F((0,b.Z)((0,b.Z)({},h),{},{before_exam:U,in_exam:(0,b.Z)((0,b.Z)({},Q),{},{checked:U})}));return}if(x===c.IN_EXAM){F&&F(U?(0,b.Z)((0,b.Z)({},h),{},{in_exam:(0,b.Z)((0,b.Z)({},Q),{},{checked:U}),before_exam:U}):(0,b.Z)((0,b.Z)({},h),{},{in_exam:(0,b.Z)((0,b.Z)({},Q),{},{checked:U})}));return}},V=S=>{F&&F((0,b.Z)((0,b.Z)({},h),{},{in_exam:(0,b.Z)((0,b.Z)({},Q),{},{type:S})}))},z=S=>{Q.type===I.FREQUENCY?F&&F((0,b.Z)((0,b.Z)({},h),{},{in_exam:(0,b.Z)((0,b.Z)({},Q),{},{random_times:S})})):F&&F((0,b.Z)((0,b.Z)({},h),{},{in_exam:(0,b.Z)((0,b.Z)({},Q),{},{custom_interval_time:S})}))},$=S=>{var x=Q.type===I.FREQUENCY?Q.random_times:Q.custom_interval_time;return D().createElement(D().Fragment,null,D().createElement(g.Z,{disabled:S,placeholder:t("common.pleaseEnter"),value:x,onChange:z,precision:0}),D().createElement("span",null,Q.type===I.FREQUENCY?t("common.times"):t("common.minutes")))},W=(0,o.useMemo)(()=>[{value:I.FREQUENCY,label:t("examination.faceRecognitionInExam.random")},{value:I.INTERVAL,label:t("examination.faceRecognitionInExam.interval")}],[]);return D().createElement("div",{className:y()["face-recognition-container"]},D().createElement("div",{className:y()["before-exam-container"]},D().createElement(C.l,{values:E?c.BEFORE_EXAM:"",options:[{label:t("examination.faceRecognitionInExam.enter"),value:c.BEFORE_EXAM}],onChange:S=>{G(S,c.BEFORE_EXAM)}})),D().createElement("div",{className:y()["in-exam-container"]},D().createElement(C.l,{values:Q.checked?c.IN_EXAM:"",options:[{label:t("examination.faceRecognitionInExam.inExam"),value:c.IN_EXAM,disabled:!Q.checked&&m<=M,disabledTip:(0,p.ZT)(t("examination.faceRecognitionInExam.verifyExamDurationTip"),M+1)}],onChange:S=>{G(S,c.IN_EXAM)}}),D().createElement(T.Z,{disabled:!Q.checked,value:Q.type,onChange:V,style:{width:"100px"}},W.map(S=>{var x=S.label,U=S.value;return D().createElement(B,{key:U,value:U},x)})),$(!Q.checked)))}Se.ZP=(0,K.Z)()(d)},64134:function(gt,Se,e){"use strict";e.d(Se,{Jv:function(){return Cn},kE:function(){return Js},_e:function(){return rn},EM:function(){return Fn},U6:function(){return ws},XQ:function(){return O},wo:function(){return Qs},QN:function(){return As},Is:function(){return Tn},hw:function(){return on},Vu:function(){return Sn},g4:function(){return nn},Fz:function(){return vn},NI:function(){return Oa},LH:function(){return yn},$O:function(){return ln},xA:function(){return Pn},wK:function(){return xa},Or:function(){return ss}});var O={};e.r(O),e.d(O,{validateBonusCredit:function(){return Gt},validateExamDuration:function(){return At},validateExamPeriod:function(){return _t},validateFaceRecognition:function(){return Ba},validateMarkingMethod:function(){return Ia}});var g=e(43358),b=e(34041),a=e(33565),T=e(12924),o=e.n(T),D=e(8812),K=e(91768),P=e(18958),y=e.n(P),C=e(71194),p=e(57016),B=e(22385),c=e(31097),I=e(28216),M=e(47167),v=e.n(M),A=e(1164),d=e(6793),l=e(48479),t=e(86726),h=e(5259),F=e(66361),m=e(99367),E=e(35085),Q=e(97413),G=e(9925),V=Ge=>{var st=Ge.user,lt=Ge.advancedSetting;return{modules:st.modules,themeColor:lt.themeColor}};function z(Ge){var st=Ge.t,lt=Ge.multiple,yt=Ge.visible,Nt=Ge.defaultSelectedKeys,Kt=Ge.withBlankAndShortAnswer,Jt=Ge.from,zt=(0,T.useState)(Ge.t("component.addPaper")),jt=(0,a.Z)(zt,1),Mt=jt[0],aa=(0,T.useState)([]),Ht=(0,a.Z)(aa,2),ma=Ht[0],na=Ht[1],Ca=(0,T.useState)(Nt),Xa=(0,a.Z)(Ca,2),za=Xa[0],Ka=Xa[1],ha=(0,T.useState)(""),ya=(0,a.Z)(ha,2),Na=ya[0],ps=ya[1],Ss=(0,T.useState)(""),ka=(0,a.Z)(Ss,2),_s=ka[0],Rs=ka[1],qs=(0,T.useState)({type:"",status:"enable",visible_range:"all",keyword:"",classify_id:"",filter_fill_blank_and_short_answer:!1}),dn=(0,a.Z)(qs,1),cn=dn[0],$s=(0,t.V9)("newPaper",Ge.modules),en=(0,T.useRef)();(0,T.useEffect)(()=>{Ka(Nt)},[Nt]),(0,T.useEffect)(()=>{en.current&&en.current.load({keyword:_s,classify_id:Na})},[_s,Na]);var Dn=()=>{Ge.onCancel&&Ge.onCancel()},bn=()=>{if(!ma.length){Dn();return}Kt&&ma.length>0&&(0,E.zh)({paperId:ma[0].id,version:ma[0].version}).then(qa=>{var xs=qa.data,Vs=xs.data;Ge.onOk([Vs])}),Ge.onOk(ma)},fn=qa=>(0,h.NZ)(qa),On={query:qa=>fn(qa),columns:[{title:st("exam.paperAddItemName"),key:"title",width:230,ellipsis:!0,render:(qa,xs)=>{var Vs=xs.title,Kn=xs.id;return(0,t.H3)("preview",$s)?o().createElement(A.Z,{to:"/knowledgeBase/examResources/newPaper/preview?paperId=".concat(Kn)},o().createElement(c.Z,{placement:"topLeft",overlayClassName:v()["cl-question__tooltips"],title:Vs},o().createElement("div",{className:[v()["paper-table-title"],"cl-text-ellipsis"]},Vs))):o().createElement("span",null,Vs)}},{title:st("study.type"),key:"type",width:80,filters:[{text:st("myExamTask.all"),value:"all"},{text:st("exam.fixed"),value:"fixed"},{text:st("exam.random"),value:"random"}],filterMultiple:!1,render:(qa,xs)=>{var Vs=xs.type;return st(Vs==="fixed"?"exam.fixed":"exam.random")},onFilter:(qa,xs)=>qa==="all"?!0:xs.type.indexOf(qa)===0},{title:st("common.createTime"),key:"create_time",width:130,render:(qa,xs)=>{var Vs=xs.create_time;return(0,d.p6)(Number(Vs),"yyyy-MM-dd hh:mm")}},{title:st("common.creator"),width:80,key:"create_user_name",render:(qa,xs)=>o().createElement(G.Z,{userId:xs.create_user,userName:xs.create_user_name})}]},wn=()=>{var qa=en.current;qa&&qa.load&&qa.load()},Un=(qa,xs)=>{Ka(qa),na(xs)},Bn=()=>o().createElement("div",{className:"".concat(v()["right-container"])},o().createElement("div",{className:v()["right-item"]},o().createElement("span",{className:"".concat(v()["refresh-tip"])},st("examination.selectPaperListRefreshTip")),o().createElement("span",{className:"".concat(v().refresh," cl-pointer"),onClick:wn},st("other.randomInspectionDesc.refresh"))),(0,t.H3)("add",$s)&&o().createElement(Q.E1,{className:v()["right-item"],from:Jt})),ar=()=>o().createElement("div",{className:"".concat(v()["left-container"])},o().createElement(l.Z,{onSearch:qa=>{Rs(qa)},placeholder:st("examination.searchPaperTip"),width:272,maxLength:15})),Wn=qa=>{ps(qa.id)};return o().createElement(p.Z,{visible:yt,title:Mt,onCancel:Dn,onOk:bn,width:960,height:652,className:v()["select-paper-modal"]},o().createElement("div",{className:v()["select-paper-container"]},o().createElement("div",{className:v()["classify-container"]},o().createElement(F.Z,{showSearch:!0,isRoot:!0,selectedKeys:[Na],stPickySearch:!0,className:v()["classify-container-box"],placeholder:st("common.searchPlaceholder"),onSelect:qa=>{Wn(qa)},height:"calc(100vh - 310px)",type:"tree"})),o().createElement("div",{className:v()["paper-list-container"]},o().createElement("div",{className:v()["table-container"]},o().createElement(m.Z,{uniKey:"paper",uuid:"BEE8272C-8EA2-8C81-B9BC-E8165DCA042B",type:"rowSelection",ref:en,queryParams:On,queryParam:cn,rowSelection:{type:lt?"checkbox ":"radio",selectedRowKeys:za,onChange:Un},pagerConfig:{pageSize:"page_size",pageIndex:"page_number",pageSizeNum:10,pageIndexNum:1},pagination:{size:"small",showSizeChanger:!1,showTotal:qa=>"".concat(st("historicRecords.altogether")).concat(Math.ceil(qa/10)).concat(st("component.pageLabel"),"\uFF0C").concat(qa).concat(st("component.dataItems"))},options:!1,tableAlertRender:()=>!1,headerTitle:ar(),toolBarRender:Bn,scroll:{y:"calc(100vh - 400px)"}})))))}z.defaultProps={visible:!1,withBlankAndShortAnswer:!1,defaultSelectedKeys:[],multiple:!1,onCancel:()=>{},onOk:Ge=>Ge,from:""};var $=(0,I.$j)(V)((0,K.Z)()(z));function W(Ge){var st=Ge.has_published,lt=Ge.value,yt=Ge.onFieldChange,Nt=Ge.placeholder,Kt=Ge.withBlankAndShortAnswer,Jt=Ge.setFieldValue,zt=Ge.from,jt=(0,T.useState)(!1),Mt=(0,a.Z)(jt,2),aa=Mt[0],Ht=Mt[1],ma=()=>{st||(Ht(!0),Ge.onShowDialog&&Ge.onShowDialog())},na=Xa=>{Ht(!1);var za=(0,a.Z)(Xa,1),Ka=za[0],ha=Ka.id,ya=Ka.title,Na=Ka.total_score,ps=Ka.fill_blank_count,Ss=Ka.short_answer_count,ka=Ka.type;yt&&yt({id:ha,name:ya,total_score:Na,fill_blank_count:ps||0,short_answer_count:Ss||0,paperType:ka}),Jt&&Jt("title",ya)},Ca=()=>{Ht(!1)};return o().createElement(o().Fragment,null,o().createElement("div",{className:y()["operate-container"]},o().createElement(b.Z,{notFoundContent:null,className:y()["select-paper-input"],dropdownClassName:y()["select-dropdown"],onClick:ma,placeholder:Nt,disabled:st,suffixIcon:o().createElement(D.Z,{onClick:ma}),value:lt.name||void 0})),aa&&o().createElement($,{from:zt,withBlankAndShortAnswer:Kt||!1,visible:aa,defaultSelectedKeys:[lt.id],onCancel:Ca,onOk:na}))}W.defaultProps={placeholder:"\u8BF7\u9009\u62E9",withBlankAndShortAnswer:!1};var S=(0,K.Z)()(W),x=e(14965),U=e(11448),L=e(63185),w=e(9676),k=e(88986),ne=e(78138),ie=e.n(ne),Ne=e(42523),ue=e.n(Ne),_e=e(37055),Ze=e(87722),j=e(75205);function R(Ge){var st=Ge.t,lt=Ge.value,yt=Ge.has_published,Nt=Ge.result_visible,Kt=Ge.onFieldChange,Jt=lt.begin_time,zt=lt.begin_time_save,jt=lt.end_time,Mt=lt.unlimited,aa=Nt.show_result,Ht=Nt.result_view_rule,ma=Nt.ranking_list_view_rule,na=ka=>{var _s=ka.target.checked;Kt&&Kt((0,k.Z)((0,k.Z)({},lt),{},{begin_time:"",end_time:"",unlimited:_s}))},Ca=ka=>{var _s=ka.valueOf();Kt&&Kt((0,k.Z)((0,k.Z)({},lt),{},{end_time:_s}))},Xa=ka=>{var _s=ka.startTime,Rs=ka.endTime;Kt&&Kt((0,k.Z)((0,k.Z)({},lt),{},{begin_time:_s,end_time:Rs}))},za=()=>{var ka=(aa==="true"||aa===!0)&&(Ht===j.Zt.AFTER_EXAM_END||ma===j.Zt.AFTER_EXAM_END);return o().createElement("span",{className:ue()["unlimited-checkbox-container"]},yt||ka?o().createElement(c.Z,{title:st(ka?"examination.unlimitedDisableTip":"examination.unlimitedEditDisableTip")},o().createElement(w.Z,{onChange:na,checked:Ss,disabled:yt||ka},st("examination.timeUnlimited"))):o().createElement(w.Z,{onChange:na,checked:Ss},st("examination.timeUnlimited")))},Ka=()=>yt?o().createElement("div",{className:ue().tip},st("examination.examPeriodEditTip")):null,ha=ka=>{var _s=ka.isUnlimited,Rs=ka.timeValue;return o().createElement("div",null,o().createElement(Ze.Z,{showTime:{format:_e.XE.INITIAL_TIME_FMT.VIEW},format:_e.XE.INITIAL_DATE_FMT.VIEW,onCustomChange:Xa,ranges:{["".concat(st("component.recentWeek"))]:[ie()(),ie()().add(7,"days")],["".concat(st("component.recentMonth"))]:[ie()(),ie()().add(30,"days")],["".concat(st("component.recentThreeMonth"))]:[ie()(),ie()().add(3,"months")]},timestamp:!0,defaultValue:Rs,disabledDate:d.Kq,disabled:_s}),za(),Ka())},ya=ie()(Jt),Na=ie()(jt),ps=Jt&&jt?[ya,Na]:[],Ss=Mt==="true"||Mt===!0;return yt?zt&&new Date().getTime()>=zt?o().createElement("div",null,o().createElement(U.Z,{value:ya,showTime:{format:_e.XE.INITIAL_TIME_FMT.VIEW},format:_e.XE.INITIAL_DATE_FMT.VIEW,disabled:!0}),o().createElement("span",{style:{margin:"0 10px"}}," ~ "),o().createElement(U.Z,{value:jt?Na:void 0,showTime:{format:_e.XE.INITIAL_TIME_FMT.VIEW},format:_e.XE.INITIAL_DATE_FMT.VIEW,onChange:Ca,disabledDate:ka=>ka<ya.subtract("day",0),disabled:Ss}),za(),Ka()):ha({isUnlimited:Ss,timeValue:ps}):ha({isUnlimited:Ss,timeValue:ps})}var le=(0,K.Z)()(R),H=e(68892),X=e(54092),ce=e(57663),Te=e(71577),Le=e(12968),he=e(44208),Ee=e(49101),ve=e(59130),be=e.n(ve),Ve=e(93117);function Ae(Ge){var st=Ge.t,lt=Ge.value,yt=Ge.onFieldChange,Nt=lt.url,Kt=lt.name,Jt=(0,T.useState)(!1),zt=(0,a.Z)(Jt,2),jt=zt[0],Mt=zt[1],aa=(0,T.useState)({width:0,height:0}),Ht=(0,a.Z)(aa,2),ma=Ht[0],na=Ht[1];(0,T.useEffect)(()=>{var za=lt.url;za&&(0,j.FX)(za).then(Ka=>{na(Ka)})},[lt]);var Ca=za=>{Mt(!1);var Ka=(0,a.Z)(za,1),ha=Ka[0],ya=ha.id,Na=ha.name,ps=ha.previewUrl;yt&&yt({id:ya,name:Na,url:ps})},Xa=()=>{yt&&yt({id:"",name:"",url:""})};return o().createElement("div",null,Nt?o().createElement(o().Fragment,null,o().createElement("div",{className:"".concat(be()["display-certificate"]," ").concat(ma.height>ma.width?be().vertical:be().transverse)},o().createElement("div",null,o().createElement(he.Z,{className:be().image,alt:Kt||st("common.certificate"),src:Nt})),o().createElement("div",{className:be()["operate-container"]},o().createElement("span",{className:be()["operate-item"],onClick:()=>{Mt(!0)}},st("setting.change")),o().createElement("span",{className:be()["operate-item"],onClick:Xa},st("common.delete")))),o().createElement("span",{className:be().tip},st("examination.passedGet"))):o().createElement("div",{className:be()["button-container"]},o().createElement(Te.Z,{icon:o().createElement(Ee.Z,null),onClick:()=>{Mt(!0)}},st("examination.selectCertificate")),o().createElement("span",{className:be().tip},st("examination.passedGet"))),o().createElement(Ve.Z,{visible:jt,defaultChecked:[lt],onCancel:()=>{Mt(!1)},onOk:Ca}))}var at=(0,K.Z)()(Ae),et=e(77576),ut=e(59314),q=e(88983),Oe=e(47933),Je=e(62029),je=e(7145),Be=e.n(je),St=e(54549),Lt=e(26726),Wt=e.n(Lt),pa=e(56160),Xt=e.n(pa),Et=e(88311);function Fe(Ge){var st=Ge.value,lt=Ge.onFieldChange,yt=Ge.type,Nt=Ge.onSelectedChange,Kt=Ge.selectPersonOptions,Jt=Ge.className,zt=(0,T.useState)({visible:!1,onlyUser:!0}),jt=(0,a.Z)(zt,2),Mt=jt[0],aa=jt[1],Ht=(0,T.useState)(st),ma=(0,a.Z)(Ht,2),na=ma[0],Ca=ma[1],Xa=na.filter(ya=>{var Na=ya.creator;return Na});(0,T.useEffect)(()=>{lt&&lt(na),Nt&&Nt(na)},[na]);var za=ya=>{var Na=ya.user;Ca(ps=>Be()(ps,{$set:Xa.concat(Na)})),ha(!1)},Ka=ya=>{var Na=na.findIndex(ps=>ps.id===ya);Ca(ps=>Be()(ps,{$splice:[[Na,1]]}))},ha=ya=>{aa(Na=>Be()(Na,{visible:{$set:ya}}))};return o().createElement(o().Fragment,null,o().createElement("div",{className:"".concat(Xt()["select-person"]," ").concat(Jt)},o().createElement("div",{className:Xt()["button-container"]},o().createElement(Te.Z,{icon:o().createElement(Ee.Z,null),onClick:()=>ha(!0)},Kt.title)),na.length>0&&o().createElement(Ie,{selected:na,type:yt,onRemoveUser:Ka})),o().createElement(Et.Z,(0,Je.Z)({title:Kt.title},Mt,{onOk:za,onCancel:()=>ha(!1),initData:{user:Wt()(na,Xa,"id")},reserveUser:Xa})))}Fe.defaultProps={selectPersonOptions:{title:"\u6DFB\u52A0\u4EBA\u5458"},value:[]};var Pe=(0,K.Z)()(Fe);function Ie(Ge){var st=Ge.selected,lt=st===void 0?[]:st,yt=Ge.onRemoveUser,Nt=Ge.type;return o().createElement("div",{className:Xt()["display-select-people"]},lt.length>0&&lt.map(Kt=>{var Jt=Kt.id,zt=Kt.name,jt=Kt.creator;return jt?o().createElement(Te.Z,{key:Jt,disabled:!0},zt):o().createElement(Te.Z,{key:Jt},o().createElement("span",null,zt),o().createElement("span",{className:"remove-icon",onClick:()=>yt(Jt)},o().createElement(St.Z,{style:{paddingLeft:"8px",fontSize:"12px",color:"rgba(0, 0, 0, 0.65)"}})))}))}var $e=e(3289),te=e(58683),ae=e.n(te),Re=e(40646),de=e(76591);function we(Ge){var st=Ge.t,lt=Ge.value,yt=Ge.paperInfo,Nt=Ge.isEdit,Kt=Ge.onFieldChange,Jt=lt.mark_type,zt=lt.fill_blank,jt=lt.short_answer,Mt=lt.anonymous_marking,aa=lt.marker_list;(0,T.useEffect)(()=>{var ha=yt.fill_blank_count,ya=yt.short_answer_count;Nt||Kt((0,k.Z)((0,k.Z)({},lt),{},{fill_blank:ha>0,short_answer:ya>0,mark_type:ha<=0&&ya<=0?j.lt.SYSTEM:Jt}))},[yt]);var Ht=ha=>{var ya=ha.target,Na=ya.value;Kt&&Kt((0,k.Z)((0,k.Z)({},lt),{},{mark_type:Na,fill_blank:Nt&&Na===j.lt.MANUAL&&yt.fill_blank_count>0?!0:zt,short_answer:Nt&&Na===j.lt.MANUAL&&yt.short_answer_count>0?!0:jt}))},ma=ha=>{var ya=ha.checked,Na=ha.value;Na===de.Nb.BLANK&&Kt((0,k.Z)((0,k.Z)({},lt),{},{fill_blank:ya,short_answer:Nt?yt.short_answer_count>0&&(jt==="true"||jt===!0):jt})),Na===de.Nb.DESCRIBE&&Kt((0,k.Z)((0,k.Z)({},lt),{},{short_answer:ya,fill_blank:Nt?yt.fill_blank_count>0&&(zt==="true"||zt===!0):zt}))},na=ha=>{Kt((0,k.Z)((0,k.Z)({},lt),{},{anonymous_marking:ha}))},Ca=ha=>{Kt((0,k.Z)((0,k.Z)({},lt),{},{marker_list:ha}))},Xa=(0,T.useMemo)(()=>(0,$e.Ag)({t:st,paperInfo:yt,mark_type:Jt}),[st,yt,Jt]),za=(0,T.useMemo)(()=>(0,$e.to)({t:st,paperInfo:yt}),[st,yt]),Ka=[];return(zt==="true"||zt===!0)&&Ka.push(de.Nb.BLANK),(jt==="true"||jt===!0)&&Ka.push(de.Nb.DESCRIBE),o().createElement(o().Fragment,null,o().createElement(Oe.ZP.Group,{value:Jt,buttonStyle:"solid",onChange:Ht},Xa.map(ha=>{var ya=ha.value,Na=ha.label,ps=ha.disabled,Ss=ha.disabledTip;return ps?Ss?o().createElement(c.Z,{title:Ss},o().createElement(Oe.ZP.Button,{key:ya,value:ya,disabled:ps},Na)):o().createElement(Oe.ZP.Button,{key:ya,value:ya,disabled:ps},Na):o().createElement(Oe.ZP.Button,{key:ya,value:ya},Na)})),Jt===j.lt.MANUAL&&o().createElement(o().Fragment,null,o().createElement("div",{className:ae()["question-type"]},o().createElement("span",{className:ae().label,style:{width:(0,d.me)()==="en_us"?"138px":"72px"}},st("examination.markingQuestionType")),o().createElement(Re.l,{values:Ka,options:za,onChange:ha=>{ma(ha,lt)}})),o().createElement("div",{className:ae()["anonymous-marking-container"]},o().createElement("span",{className:ae().label,style:{width:(0,d.me)()==="en_us"?"138px":"72px"}},st("exam.anonymousMarking")),o().createElement(ut.Z,{checked:Mt==="true"||Mt===!0,onChange:na,checkedChildren:st("examination.open"),unCheckedChildren:st("examination.close")})),o().createElement("div",{className:ae()["add-marking-people"]},o().createElement("span",{className:ae().label,style:{width:(0,d.me)()==="en_us"?"138px":"72px"}},st("examination.markingPerson")),o().createElement(Pe,{type:"marker_list",value:aa,onSelectedChange:Ca,selectPersonOptions:{title:st("examination.addPeople")},className:ae()["marking-select-people"]}))))}var rt=(0,K.Z)()(we),mt=e(77883),Zt=e(21888),bt=e(76739),Ft=e.n(bt);function Ut(Ge){var st=Ge.t,lt=Ge.value,yt=Ge.onFieldChange,Nt=Jt=>{yt&&yt(Jt)},Kt=(0,T.useMemo)(()=>(0,j.Ck)({min:j.Dq,max:j.ub,value:lt}),[lt]);return o().createElement("div",null,o().createElement(Zt.Z,{value:Kt,onChange:Nt,min:j.Dq,max:j.ub,precision:0}),o().createElement("span",{className:Ft()["answer-time-unit"]}," ",st("common.minutes")," "),o().createElement("div",{className:Ft().tip},st("examination.answerTimeTip")))}var ca=(0,K.Z)()(Ut),Qt=e(47328),Va=e.n(Qt);function Ra(Ge){var st=Ge.t,lt=Ge.value,yt=Ge.paperInfo,Nt=Ge.onFieldChange,Kt=yt.total_score,Jt=yt.paperType,zt=Mt=>{Nt&&Nt(Mt)},jt=(0,T.useMemo)(()=>(0,j.Ck)({min:j.$u,max:j.OU,value:lt}),[lt]);return o().createElement("div",null,o().createElement(Zt.Z,{value:jt,onChange:zt,max:j.OU,min:j.$u,precision:0,formatter:Mt=>"".concat(Mt,"%")}),Jt==="fixed"&&o().createElement("span",{className:Va()["pass-line-tip"]},st("examination.passLineTip",{passScore:Math.floor(Kt*(jt/100)*10)/10,totalScore:Kt,passLine:jt})))}var Ua=(0,K.Z)()(Ra),ja=e(44060),ua=e.n(ja);function ts(Ge){var st=Ge.t,lt=Ge.value,yt=Ge.has_published,Nt=Ge.onFieldChange,Kt=lt.exam_count,Jt=lt.answer_rule,zt=Ht=>{Nt&&Nt((0,k.Z)((0,k.Z)({},lt),{},{exam_count:Ht}))},jt=Ht=>{Nt&&Nt((0,k.Z)((0,k.Z)({},lt),{},{answer_rule:Ht.target.value}))},Mt=(0,T.useMemo)(()=>(0,j.Ck)({min:j.FD,max:j.gm,value:Kt}),[Kt]),aa=(0,T.useMemo)(()=>(0,$e.ZB)({t:st,answer_rule:Jt,has_published:yt}),[st,Jt,yt]);return o().createElement("div",{className:ua()["exam-times-container"]},o().createElement(Oe.ZP.Group,{value:Jt,buttonStyle:"solid",onChange:jt},aa.map(Ht=>{var ma=Ht.value,na=Ht.label,Ca=Ht.disabled,Xa=Ht.disabledTip;return Ca?Xa?o().createElement(c.Z,{key:ma,title:Xa},o().createElement(Oe.ZP.Button,{disabled:Ca,value:ma},na)):o().createElement(Oe.ZP.Button,{key:ma,disabled:Ca,value:ma},na):o().createElement(Oe.ZP.Button,{key:ma,value:ma},na)}),Jt===j.e9.CUSTOM&&o().createElement(o().Fragment,null,o().createElement(Zt.Z,{className:ua().exam_count,value:Mt,onChange:zt,max:j.gm,min:j.FD,precision:0}),o().createElement("span",{className:ua().unit},st("common.times")))),yt&&o().createElement("span",{className:ua()["change-tip"]},st("examination.examTimesChangeTip")))}var as=(0,K.Z)()(ts);function Fa(Ge){var st=Ge.t,lt=Ge.value,yt=Ge.has_published,Nt=Ge.onFieldChange,Kt=zt=>{var jt=zt.target.value;Nt&&Nt(jt)},Jt=(0,T.useMemo)(()=>(0,$e.JN)({t:st,has_published:yt,value:lt}),[st,yt,lt]);return o().createElement(Oe.ZP.Group,{value:lt,buttonStyle:"solid",onChange:Kt},Jt.map(zt=>{var jt=zt.value,Mt=zt.label,aa=zt.disabled;return o().createElement(Oe.ZP.Button,{key:jt,value:jt,disabled:aa},Mt)}))}var Sa=(0,K.Z)()(Fa),us=e(72523),Ds=e.n(us);function Za(Ge){var st=Ge.t,lt=Ge.value,yt=Ge.onFieldChange,Nt=Jt=>{var zt=Jt.target.value;yt&&yt(zt)},Kt=(0,T.useMemo)(()=>(0,$e.E4)({t:st}),[st]);return o().createElement(o().Fragment,null,o().createElement(Oe.ZP.Group,{value:"".concat(lt),buttonStyle:"solid",onChange:Nt},Kt.map(Jt=>{var zt=Jt.value,jt=Jt.label;return o().createElement(Oe.ZP.Button,{key:zt,value:zt},jt)})),o().createElement("div",{className:Ds().tip},st("examination.alwaysExtractPaperTip")))}var ga=(0,K.Z)()(Za),Ga=e(44042),La=e.n(Ga);function fa(Ge){var st=Ge.t,lt=Ge.value,yt=Ge.onFieldChange,Nt=lt.cut_screen_rule,Kt=lt.cut_screen_count,Jt=lt.cut_screen_interval,zt=na=>{yt&&yt((0,k.Z)((0,k.Z)({},lt),{},{cut_screen_count:na}))},jt=na=>{yt&&yt((0,k.Z)((0,k.Z)({},lt),{},{cut_screen_rule:na.target.value}))},Mt=na=>{yt&&yt((0,k.Z)((0,k.Z)({},lt),{},{cut_screen_interval:na}))},aa=(0,T.useMemo)(()=>(0,$e.Qd)({t:st}),[st]),Ht=(0,T.useMemo)(()=>(0,j.Ck)({min:j.aM,max:j.Uc,value:Kt}),[Kt]),ma=(0,T.useMemo)(()=>(0,j.Ck)({min:j.z$,max:j.aS,value:Jt}),[Jt]);return o().createElement(o().Fragment,null,o().createElement(Oe.ZP.Group,{value:Nt,buttonStyle:"solid",onChange:jt},aa.map(na=>{var Ca=na.value,Xa=na.label;return o().createElement(Oe.ZP.Button,{key:Ca,value:Ca},Xa)}),Nt===j.Qn.CUSTOM&&o().createElement(o().Fragment,null,o().createElement(Zt.Z,{className:La().cut_screen_count,value:Ht,onChange:zt,max:j.Uc,min:j.aM,precision:0}),o().createElement("span",{className:La().unit},st("common.times")))),Nt!==j.Qn.DISABLE&&o().createElement("div",{className:La().tip},st("examination.openCutScreenTip")),Nt!==j.Qn.UNLIMITED&&o().createElement("div",{className:La().cut_screen_interval},st("examination.cutOut")," ",o().createElement(Zt.Z,{className:La().cut_screen_interval,value:ma,onChange:Mt,max:j.aS,min:j.z$,precision:0})," ",st("examination.addCutCount"),o().createElement("div",{className:La().tip},st("examination.cutScreenIntervalTip"))),o().createElement("div",null))}var ke=(0,K.Z)()(fa);function Ue(Ge){var st=Ge.t,lt=Ge.value,yt=Ge.onFieldChange,Nt=lt.random_question,Kt=lt.random_options,Jt=Mt=>{yt&&Mt&&(Mt.value==="random_question"&&yt({random_options:Kt,random_question:Mt.checked}),Mt.value==="random_options"&&yt({random_question:Nt,random_options:Mt.checked}))},zt=(0,T.useMemo)(()=>(0,$e.Ti)({t:st}),[st]),jt=[];return(Nt==="true"||Nt===!0)&&jt.push("random_question"),(Kt==="true"||Kt===!0)&&jt.push("random_options"),o().createElement(Re.l,{values:jt,options:zt,onChange:Jt})}var De=(0,K.Z)()(Ue);function oe(Ge){var st=Ge.t,lt=Ge.value,yt=Ge.onFieldChange,Nt=Kt=>{yt&&yt(Kt)};return o().createElement(ut.Z,{checked:lt==="true"||lt===!0,onChange:Nt,checkedChildren:st("common.shown"),unCheckedChildren:st("common.hidden")})}var xe=(0,K.Z)()(oe),me=e(22444),ye=e(17598),We=e.n(ye),ze=e(91534),qe=e.n(ze),Tt=b.Z.Option,Ct={ADD:"add",REDUCE:"reduce"},Vt=Ge=>{var st=Math.sign(Ge);if(st===1||Object.is(st,0))return Ct.ADD;if(st===-1||Object.is(st,-0))return Ct.REDUCE};function ht(Ge){var st=Ge.t,lt=Ge.inputNumberProps,yt=Ge.selectProps,Nt=Ge.unit,Kt=Ge.className,Jt=(Mt,aa)=>{var Ht=0,ma=Number(Mt);aa===Ct.ADD?Ht=ma:aa===Ct.REDUCE&&(Ht=-ma),Ge.onNumberChange&&Ge.onNumberChange(Ht)},zt=Mt=>{var aa=lt.value,Ht=aa;Mt===Ct.ADD?Ht=aa:Mt===Ct.REDUCE&&(Ht=-aa),Ge.onNumberChange&&Ge.onNumberChange(Ht)},jt=yt.options?yt.options:[{value:Ct.ADD,label:st("examination.add")},{value:Ct.REDUCE,label:st("examination.reduce")}];return o().createElement("div",{className:"".concat(qe()["select-input-number"]," ").concat(Kt)},o().createElement(b.Z,(0,Je.Z)({},yt,{value:yt.value,onChange:zt,style:{width:"56px"},disabled:yt.disabled,showArrow:yt.showArrow}),jt.map(Mt=>{var aa=Mt.label,Ht=Mt.value;return o().createElement(Tt,{key:Ht,value:Ht},aa)})),o().createElement(Zt.Z,(0,Je.Z)({precision:0},lt,{onChange:Mt=>{Jt(Mt,yt.value)},value:lt.value||lt.min})),Nt&&o().createElement("span",{className:qe().unit},Nt))}ht.defaultProps={inputNumberProps:{},selectProps:{},className:""};var re=(0,K.Z)()(ht);function fe(Ge){var st=Ge.t,lt=Ge.value,yt=Ge.isEdit,Nt=Ge.onFieldChange,Kt=lt.absence,Jt=lt.passed,zt=lt.failed,jt=lt.type,Mt=(0,T.useState)({missScore:0,passScore:0,unPassScore:0}),aa=(0,a.Z)(Mt,2),Ht=aa[0],ma=aa[1];(0,T.useEffect)(()=>{E.Pw().then(za=>{var Ka=za.data,ha=Ka.code,ya=Ka.data,Na=ya.examScore;if(ha===0){var ps=(0,a.Z)(Na,1),Ss=ps[0];ma(Ss),Nt((0,k.Z)((0,k.Z)({},lt),{},{failed:yt&&lt.type!==j.iN.STATUS||!yt?(0,k.Z)((0,k.Z)({},zt),{},{score:Ss.unPassScore}):zt,passed:yt&&lt.type!==j.iN.STATUS||!yt?(0,k.Z)((0,k.Z)({},Jt),{},{score:Ss.passScore}):Jt,absence:yt&&lt.type!==j.iN.STATUS||!yt?(0,k.Z)((0,k.Z)({},Kt),{},{score:-Ss.missScore}):Kt}))}})},[]);var na=za=>{Nt&&Nt((0,k.Z)((0,k.Z)({},lt),za))},Ca=za=>{Nt&&Nt((0,k.Z)((0,k.Z)({},lt),{},{type:za.target.value}))},Xa=(0,T.useMemo)(()=>(0,$e.cC)({t:st}),[st]);return o().createElement(o().Fragment,null,o().createElement(Oe.ZP.Group,{value:jt,buttonStyle:"solid",onChange:Ca},Xa.map(za=>{var Ka=za.value,ha=za.label;return o().createElement(Oe.ZP.Button,{key:Ka,value:Ka},ha)})),jt===j.iN.STATUS&&o().createElement(ee,{t:st,isEdit:yt,defaultExamScore:Ht,value:lt,onChange:na}))}var pe=(0,K.Z)()(fe);function ee(Ge){var st=Ge.t,lt=Ge.value,yt=Ge.defaultExamScore,Nt=Mt=>{Ge.onChange&&Ge.onChange(Mt)},Kt=(Mt,aa)=>{switch(aa){case j.bY.PASS:{Nt((0,k.Z)((0,k.Z)({},lt),{},{passed:(0,k.Z)((0,k.Z)({},lt.passed),{},{score:Mt})}));break}case j.bY.FAIL:{Nt((0,k.Z)((0,k.Z)({},lt),{},{failed:(0,k.Z)((0,k.Z)({},lt.failed),{},{score:Mt})}));break}case j.bY.ABSENCE:{Nt((0,k.Z)((0,k.Z)({},lt),{},{absence:(0,k.Z)((0,k.Z)({},lt.absence),{},{score:Mt})}));break}default:console.log("default")}},Jt=(Mt,aa)=>{var Ht=Mt.checked;switch(aa){case j.bY.PASS:{var ma=(0,k.Z)((0,k.Z)({},lt.passed),{},{checked:Ht});Ht&&(ma.score=ma.score||yt.passScore),Nt((0,k.Z)((0,k.Z)({},lt),{},{passed:ma}));break}case j.bY.FAIL:{var na=(0,k.Z)((0,k.Z)({},lt.failed),{},{checked:Ht});Ht&&(na.score=na.score||yt.unPassScore),Nt((0,k.Z)((0,k.Z)({},lt),{},{failed:na}));break}case j.bY.ABSENCE:{var Ca=(0,k.Z)((0,k.Z)({},lt.absence),{},{checked:Ht});Ht&&(Ca.score=Ca.score||-yt.missScore),Nt((0,k.Z)((0,k.Z)({},lt),{},{absence:Ca}));break}default:console.log("default")}},zt=Mt=>{var aa=Mt.value,Ht=Mt.t,ma=aa.absence,na=aa.passed,Ca=aa.failed,Xa=999,za=0;return[{type:j.bY.PASS,checkBoxGroup:{value:na.checked===!0||na.checked==="true"?[j.bY.PASS]:[],options:[{label:Ht("examination.resultStatus.pass"),value:j.bY.PASS}]},selectInputNumber:{unit:Ht("examination.point"),inputNumberProps:{value:Math.abs(na.score),disabled:!(na.checked===!0||na.checked==="true"),min:za,max:Xa},selectProps:{value:Ct.ADD,showArrow:!1,disabled:!0}}},{type:j.bY.FAIL,checkBoxGroup:{value:Ca.checked===!0||Ca.checked==="true"?[j.bY.FAIL]:[],options:[{label:Ht("examination.resultStatus.fail"),value:j.bY.FAIL}]},selectInputNumber:{unit:Ht("examination.point"),inputNumberProps:{value:Math.abs(Ca.score),disabled:!(Ca.checked===!0||Ca.checked==="true"),min:za,max:Xa},selectProps:{value:Vt(Ca.score),disabled:!(Ca.checked===!0||Ca.checked==="true"),showArrow:!0}}},{type:j.bY.ABSENCE,checkBoxGroup:{value:ma.checked===!0||ma.checked==="true"?[j.bY.ABSENCE]:[],options:[{label:Ht("examination.resultStatus.absence"),value:j.bY.ABSENCE}]},selectInputNumber:{unit:Ht("examination.point"),inputNumberProps:{value:Math.abs(ma.score),disabled:!(ma.checked===!0||ma.checked==="true"),min:za,max:Xa},selectProps:{value:Ct.REDUCE,disabled:!0,showArrow:!1}}}]},jt=(0,T.useMemo)(()=>zt({t:st,value:lt}),[st,lt]);return o().createElement("div",{className:We()["credit-setting-container"]},jt.map(Mt=>{var aa=Mt.type,Ht=Mt.checkBoxGroup,ma=Mt.selectInputNumber;return o().createElement("div",{className:We()["credit-setting-item"],key:aa},o().createElement(Re.l,{labelClassName:We()["credit-check-group"],values:Ht.value,options:Ht.options,onChange:na=>{Jt(na,aa)}}),o().createElement(re,(0,Je.Z)({},ma,{onNumberChange:na=>{Kt(na,aa)}})))}))}function ge(Ge){var st=Ge.t,lt=Ge.value,yt=Ge.onFieldChange,Nt=lt.authority_range,Kt=lt.supervisor_mark,Jt=Mt=>{yt&&yt({authority_range:Mt.includes("authority_range"),supervisor_mark:Mt.includes("supervisor_mark")})},zt=(0,T.useMemo)(()=>(0,$e.h9)({t:st}),[st]),jt=[];return(Kt==="true"||Kt===!0)&&jt.push("supervisor_mark"),(Nt==="true"||Nt===!0)&&jt.push("authority_range"),o().createElement(Re.t,{defaultValue:jt,options:zt,onChange:Jt})}var Me=(0,K.Z)()(ge),Ke=e(3407),ct=(0,d.me)(),pt=Ke.Z[ct].examination;function _t(Ge){var st=Ge.begin_time,lt=Ge.end_time,yt=Ge.unlimited;return yt==="true"||yt===!0||st&&lt?"":pt.validateExamPeriod}function At(Ge){var st=Number(Ge)||0;return st>j.ub||Ge<=j.Dq?pt.validateExamDuration:""}function Gt(Ge){var st=Ge.type,lt=Ge.absence,yt=Ge.passed,Nt=Ge.failed;if(st===j.iN.STATUS){if((lt.checked==="false"||lt.checked===!1)&&(yt.checked==="false"||yt.checked===!1)&&(Nt.checked==="false"||Nt.checked===!1))return pt.validateBonusCredit;if((lt.checked==="true"||lt.checked===!0)&&lt.score===0||(yt.checked==="true"||yt.checked===!0)&&yt.score===0||(Nt.checked==="true"||Nt.checked===!0)&&Nt.score===0)return pt.bonusCreditErrorValue}return""}function Ia(Ge){var st=Ge.mark_type,lt=Ge.fill_blank,yt=Ge.short_answer;return st===j.lt.MANUAL&&(lt==="false"||lt===!1)&&(yt==="false"||yt===!1)?pt.validateMarkingMethod:""}function Ba(Ge,st){var lt=Ge.in_exam,yt=lt.checked,Nt=lt.type,Kt=lt.random_times,Jt=lt.custom_interval_time,zt=Nt===me.tT.FREQUENCY?Kt:Jt;if(yt){if(st==null||+st<=me.fU)return(0,d.ZT)(pt.faceRecognitionInExam.verifyExamDurationTip,me.fU+1);if(!zt)return(0,d.ZT)(pt.faceRecognitionInExam.verifyValueNullTip);if(zt){var jt=(0,me._D)({in_exam:Ge.in_exam,exam_duration:st}),Mt=jt.min,aa=jt.max;return Nt===me.tT.FREQUENCY?Mt===Math.floor(aa)&&zt!==Mt?(0,d.ZT)(pt.faceRecognitionInExam.verifyRandomRangeTip,st,Mt):zt>=Mt&&zt<=Math.floor(aa)?"":(0,d.ZT)(pt.faceRecognitionInExam.verifyRandomRangeTip,st,"".concat(Mt," ~ ").concat(Math.floor(aa))):Nt===me.tT.INTERVAL?Mt===aa&&zt!==Mt?(0,d.ZT)(pt.faceRecognitionInExam.verifyIntervalRangeTip,st,Mt):zt>=Mt&&zt<=aa?"":(0,d.ZT)(pt.faceRecognitionInExam.verifyIntervalRangeTip,st,"".concat(Mt," ~ ").concat(aa)):""}return""}return""}var ia=e(49111),da=e(19650),Es=e(57119),Fs=e(31745),Ts=e.n(Fs),Ns=e(43720),ks=e(14923),Bs=e(18329),Wa=e(5430),hs=Ge=>{var st=Ge.t,lt=Ge.updateTip,yt=lt===void 0?!1:lt,Nt=Ge.visible,Kt=Ge.planId,Jt=Ge.repeatTaskTitle,zt=Ge.onCancel,jt=(0,I.v9)(ka=>{var _s=ka.user;return{modules:_s.modules}}),Mt=jt.modules,aa=(0,t.V9)("newPlan",Mt),Ht={width:"100%",destroyOnClose:!0,bodyStyle:{padding:"0",height:"100%"},maskClosable:!1,title:st("common.tip"),centered:!0,closable:!1,wrapClassName:"ant_model_tip-content-box",modalRender:()=>Na()},ma=(0,T.useState)({visible:!1,planId:Kt}),na=(0,a.Z)(ma,2),Ca=na[0],Xa=na[1],za=(0,T.useState)({visible:!1,modalTitle:st("eTouch.repeatAssignment"),ruleTip:st("eTouch.repeatRule"),planId:Kt,title:"",isOpenLoop:!1}),Ka=(0,a.Z)(za,2),ha=Ka[0],ya=Ka[1];(0,T.useEffect)(()=>{Xa(ka=>(0,k.Z)((0,k.Z)({},ka),{},{planId:Kt})),ya(ka=>(0,k.Z)((0,k.Z)({},ka),{},{planId:Kt,title:Jt}))},[Kt,Jt]);var Na=()=>o().createElement("div",{className:Ts()["tip-ant-modal"]},o().createElement("div",{className:Ts()["tip-content-box"]},o().createElement("div",{className:Ts()["tip-content"]},o().createElement(Es.Z,{style:{fontSize:"22px",color:"#faad14",marginRight:"16px"}}),o().createElement("span",null,st(yt?"study.updateSuccess":"common.releaseSuccess"))),Ss())),ps=ka=>{var _s=ka.type;switch(_s){case"toList":(0,j.F_)(),zt();break;case"setLoop":ya(Rs=>(0,k.Z)((0,k.Z)({},Rs),{},{visible:!0})),zt();break;case"addPeople":Xa(Rs=>(0,k.Z)((0,k.Z)({},Rs),{},{visible:!0})),zt();break;default:break}},Ss=()=>{var ka=[{visible:!0,btnType:"default",onClick:()=>{ps({type:"toList"})},label:st("shareInfo.returnTable")},{visible:(0,t.H3)("set_cycle_plan",aa),btnType:"default",onClick:()=>{ps({type:"setLoop"})},label:st("examination.setLoop"),tip:st("examination.setLoopTip")},{visible:(0,t.H3)("add_user",aa),btnType:"primary",onClick:()=>{ps({type:"addPeople"})},label:st("examination.addUser"),tip:st("examination.addUserTip")}];return o().createElement("div",{className:Ts()["footer-box"]},o().createElement(da.Z,{value:8},ka.map(_s=>{var Rs=_s.visible,qs=_s.btnType,dn=_s.onClick,cn=_s.label,$s=_s.tip;return $s?Rs&&o().createElement(c.Z,{placement:"top",title:$s},o().createElement(Te.Z,{type:qs,onClick:dn},cn)):Rs&&o().createElement(Te.Z,{type:qs,onClick:dn},cn)})))};return o().createElement(o().Fragment,null,o().createElement(Bs.ZP,(0,Je.Z)({},Ht,{visible:Nt})),Ca.visible&&o().createElement(Ns.Z,(0,Je.Z)({},Ca,{apiUrl:Wa.OB.examTask.singleTaskAssign({planId:Ca.planId}),onCancel:()=>{Xa(ka=>(0,k.Z)((0,k.Z)({},ka),{},{visible:!1})),(0,j.F_)()}})),ha.visible&&o().createElement(ks.Z,(0,Je.Z)({},ha,{getAssignSettingApiUrl:Wa.OB.examTask.getLastLoopTaskSetting({planId:ha.planId}),closeSettingApiUrl:Wa.OB.examTask.closeLoopTask({planId:ha.planId}),loopTaskAssignApiUrl:Wa.OB.examTask.loopTaskAssign({planId:ha.planId}),title:"".concat(ha.title),onCancel:()=>{Xa(ka=>(0,k.Z)((0,k.Z)({},ka),{},{visible:!1})),(0,j.F_)()}})))},Oa=(0,K.Z)()(hs);function Ha(Ge){var st=Ge.t,lt=Ge.value,yt=Ge.onFieldChange,Nt=Ge.face_recognition,Kt=Nt.before_exam,Jt=jt=>{var Mt=jt.target.value;yt&&yt(Mt)},zt=(0,T.useMemo)(()=>(0,$e.XK)({t:st,before_exam:Kt}),[st,Kt]);return o().createElement(o().Fragment,null,o().createElement(Oe.ZP.Group,{value:lt,buttonStyle:"solid",onChange:Jt},zt.map(jt=>{var Mt=jt.value,aa=jt.label,Ht=jt.disabled;return o().createElement(Oe.ZP.Button,{key:Mt,value:Mt,disabled:Ht},aa)})))}var ms=(0,K.Z)()(Ha),wa=e(43859),xa=(0,wa.Z)(S),rs=(0,wa.Z)(le),ss=(0,wa.Z)(Pe),Ks=(0,wa.Z)(H.Z),Qs=(0,wa.Z)(at),nn=(0,wa.Z)(rt),rn=(0,wa.Z)(ca),vn=(0,wa.Z)(Ua),As=(0,wa.Z)(as),ln=(0,wa.Z)(Sa),Cn=(0,wa.Z)(ga),ws=(0,wa.Z)(ke),yn=(0,wa.Z)(De),Tn=(0,wa.Z)(me.ZP),Sn=(0,wa.Z)(xe),Pn=(0,wa.Z)(X.Z),Fn=(0,wa.Z)(pe),on=(0,wa.Z)(Me),Js=(0,wa.Z)(ms)},68892:function(gt,Se,e){"use strict";var O=e(22385),g=e(31097),b=e(88983),a=e(47933),T=e(12924),o=e.n(T),D=e(91768),K=e(3289);function P(y){var C=y.t,p=y.value,B=y.exam_period,c=M=>{y.onChange&&y.onChange(M.target.value)},I=(0,T.useMemo)(()=>(0,K.Ek)({t:C,exam_period:B,type:"ranking"}),[C,B]);return o().createElement(a.ZP.Group,{value:p,buttonStyle:"solid",onChange:c},I.map(M=>{var v=M.value,A=M.label,d=M.disabled;return d?o().createElement(g.Z,{title:C("examination.afterExamEndDisable")},o().createElement(a.ZP.Button,{key:v,value:v,disabled:d},A)):o().createElement(a.ZP.Button,{key:v,value:v,disabled:d},A)}))}Se.Z=(0,D.Z)()(P)},54092:function(gt,Se,e){"use strict";e.d(Se,{b:function(){return v}});var O=e(22385),g=e(31097),b=e(88983),a=e(47933),T=e(77576),o=e(59314),D=e(88986),K=e(12924),P=e.n(K),y=e(91768),C=e(68892),p=e(3289),B=e(9093),c=e.n(B),I=e(75205),M=e(38642),v=(0,M.UI)("EXAM_BANK_CONFIG");function A(d){var l=d.t,t=d.value,h=d.exam_period,F=d.onFieldChange,m=t.show_result,E=t.result_view_rule,Q=t.answer_parsing,G=t.ranking_list_view_rule,V=(0,K.useMemo)(()=>(0,p.oY)({t:l,exam_period:h}),[l,h]),z=(0,K.useMemo)(()=>(0,p.hI)({t:l}),[l]),$=(0,K.useMemo)(()=>(0,p.lU)({t:l}),[l]),W=L=>{L?F&&F((0,D.Z)((0,D.Z)({},t),{},{show_result:L})):F&&F((0,D.Z)((0,D.Z)({},t),{},{result_view_rule:I.Zt.AFTER_COMMIT,ranking_list_view_rule:I.Zt.AFTER_COMMIT,show_result:L}))},S=L=>{var w=L.target.value;F&&F((0,D.Z)((0,D.Z)({},t),{},{result_view_rule:w}))},x=L=>{var w=L.target.value;F&&F((0,D.Z)((0,D.Z)({},t),{},{answer_parsing:w}))},U=L=>{F&&F((0,D.Z)((0,D.Z)({},t),{},{ranking_list_view_rule:L}))};return P().createElement(P().Fragment,null,P().createElement("div",{className:c()["result-visible"]},P().createElement(o.Z,{checked:m==="true"||m===!0,onChange:W,checkedChildren:l("common.shown"),unCheckedChildren:l("common.hidden")}),P().createElement("div",{className:c().tip},l("examination.resultVisibleTip"))),(m==="true"||m===!0)&&P().createElement(P().Fragment,null,P().createElement("div",{className:c()["result-view-rule"]},P().createElement("span",{className:c().label,style:{width:"85px"}},l("examination.answerDetail")),P().createElement(a.ZP.Group,{value:E,buttonStyle:"solid",onChange:S},V.map(L=>{var w=L.value,k=L.label,ne=L.disabled;return ne?P().createElement(g.Z,{title:l("examination.afterExamEndDisable")},P().createElement(a.ZP.Button,{key:w,value:w,disabled:ne},k)):P().createElement(a.ZP.Button,{key:w,value:w,disabled:ne},k)}))),E!==I.Zt.DISABLE_VIEWING&&P().createElement("div",{className:c()["answer-parsing"]},P().createElement("span",{className:c().label},l("examination.viewContent")),P().createElement(a.ZP.Group,{value:Q,buttonStyle:"solid",onChange:x},(v?$:z).map(L=>{var w=L.value,k=L.label;return P().createElement(a.ZP.Button,{key:w,value:w},k)}))),P().createElement("div",{className:c()["ranking-setting-container"]},P().createElement("span",{className:c().label},l("examination.ranking")),P().createElement(C.Z,{onChange:U,value:G,exam_period:h}))))}Se.Z=(0,y.Z)()(A)},3289:function(gt,Se,e){"use strict";e.d(Se,{ZB:function(){return b},JN:function(){return a},E4:function(){return T},Qd:function(){return o},Ti:function(){return D},h9:function(){return K},oY:function(){return P},hI:function(){return y},lU:function(){return C},Ek:function(){return p},cC:function(){return B},Ag:function(){return I},to:function(){return M},XK:function(){return v}});var O=e(75205),g=e(76591);function b(A){var d=A.t,l=A.answer_rule,t=A.has_published;return[{label:d("examination.unlimited"),value:O.e9.UNLIMITED,disabled:t&&l===O.e9.CUSTOM,disabledTip:d("examination.examTimesChangePopTip")},{label:d("examination.terminationAfterPassing"),value:O.e9.AFTER_PASSED,disabled:t&&l===O.e9.CUSTOM,disabledTip:d("examination.examTimesChangePopTip")},{label:d("examination.custom"),value:O.e9.CUSTOM,disabled:t&&(l===O.e9.AFTER_PASSED||l===O.e9.UNLIMITED),disabledTip:d("examination.examTimesChangePopTip")}]}function a(A){var d=A.t,l=A.has_published,t=A.value;return[{label:d("myExamTask.newest"),value:O.iY.NEWEST,disabled:l&&t===O.iY.HIGHEST},{label:d("myExamTask.highest"),value:O.iY.HIGHEST,disabled:l&&t===O.iY.NEWEST}]}function T(A){var d=A.t;return[{label:d("examination.setVolume"),value:"true"},{label:d("examination.notSetVolume"),value:"false"}]}function o(A){var d=A.t;return[{label:d("examination.unlimited"),value:O.Qn.UNLIMITED},{label:d("examination.notAllow"),value:O.Qn.DISABLE},{label:d("examination.custom"),value:O.Qn.CUSTOM}]}function D(A){var d=A.t;return[{label:d("examination.tryOrder"),value:"random_question"},{label:d("examination.answerOrder"),value:"random_options"}]}function K(A){var d=A.t;return[{label:d("examination.collaborativeMarking"),value:"supervisor_mark"},{label:d("examination.viewGovernedData"),value:"authority_range"}]}function P(A){var d=A.t,l=A.exam_period;return[{label:d("examination.afterCommit"),value:O.Zt.AFTER_COMMIT},{label:d("examination.afterPassed"),value:O.Zt.AFTER_EXAM_PASSED},{label:d("examination.afterEnd"),value:O.Zt.AFTER_EXAM_END,disabled:l&&(l.unlimited==="true"||l.unlimited===!0)},{label:d("examination.disableViewing"),value:O.Zt.DISABLE_VIEWING}]}function y(A){var d=A.t;return[{label:d("examination.answerAnalysis"),value:O.bL.ANSWER_ANALYSIS},{label:d("examination.justRightWrong"),value:O.bL.JUST_RIGHT_WRONG}]}function C(A){var d=A.t;return[{label:d("examination.onlyWrong"),value:O.bL.ANSWER_ERROR},{label:d("examination.answerAnalysis"),value:O.bL.ANSWER_ANALYSIS},{label:d("examination.justRightWrong"),value:O.bL.JUST_RIGHT_WRONG}]}function p(A){var d=A.t,l=A.exam_period,t=A.type;return[{label:d(t==="ranking"?"exam.retakeSettingFalseRow1Checkbox1":"examination.afterCommit"),value:O.Zt.AFTER_COMMIT},{label:d("examination.afterPassed"),value:O.Zt.AFTER_EXAM_PASSED},{label:d("examination.afterEnd"),value:O.Zt.AFTER_EXAM_END,disabled:l&&(l.unlimited==="true"||l.unlimited===!0)},{label:d("examination.disableViewing"),value:O.Zt.DISABLE_VIEWING}]}function B(A){var d=A.t;return[{label:d("examination.noScore"),value:O.iN.NO_CREDIT},{label:d("examination.rewardByStatus"),value:O.iN.STATUS}]}function c(A){var d=A.t,l=A.has_published,t=A.mark_type,h=A.fill_blank_count,F=A.short_answer_count;return l&&t!==MARK_TYPE.MANUAL?"":Number(h)<=0&&Number(F)<=0?d("examination.manualScoringDisabled"):""}function I(A){var d=A.t,l=A.paperInfo,t=l.fill_blank_count,h=l.short_answer_count;return[{label:d("examination.systemScoring"),value:O.lt.SYSTEM},{label:d("examination.manualScoring"),disabled:Number(t)<=0&&Number(h)<=0,value:O.lt.MANUAL,disabledTip:d("examination.manualScoringDisabled")}]}function M(A){var d=A.t,l=A.paperInfo,t=l.fill_blank_count,h=l.short_answer_count;return[{label:d("examination.blank"),value:g.Nb.BLANK,disabled:Number(t)<=0},{label:d("examination.describe"),value:g.Nb.DESCRIBE,disabled:Number(h)<=0}]}function v(A){var d=A.t,l=A.before_exam;return[{label:d("examination.pureUnlimited"),value:O.Tv.UNLIMITED},{label:d("examination.onlyPC"),value:O.Tv.PC},{label:d("examination.onlyMobile"),value:O.Tv.MOBILE}]}},35085:function(gt,Se,e){"use strict";e.d(Se,{Wl:function(){return T},Eh:function(){return o},mM:function(){return D},Ll:function(){return y},oj:function(){return C},Uq:function(){return p},f5:function(){return B},MC:function(){return c},GL:function(){return I},WK:function(){return M},Dm:function(){return v},kh:function(){return A},Xv:function(){return d},TM:function(){return l},cf:function(){return t},sO:function(){return h},ZF:function(){return F},Dc:function(){return m},Pw:function(){return E},ZN:function(){return Q},I$:function(){return G},GI:function(){return V},ry:function(){return $},zh:function(){return W},UY:function(){return S}});var O=e(81211),g=e(10237),b=e(5430),a=e(37055);function T(x){var U=x.planId,L=x.params,w=b.OB.examTask.getExamTaskInfo(U);return g.WY.get({url:w,params:L})}function o(x){var U=x.planId,L=x.params,w=b.OB.examTask.getExamTaskList(U);return g.WY.get({url:w,params:L})}function D(x){var U=x.planId,L=x.params,w=b.OB.examTask.getAnswerDataList(U);return g.WY.get({url:w,params:L})}function K(x){var U=x.planId,L=x.data,w=EXAM_API.examTask.urgeUserExam(U);return request.post({url:w,data:L})}function P(x){var U=x.planId,L=x.data,w=EXAM_API.examTask.examTaskDelay(U);return request.post({url:w,data:L})}function y(x){var U=x.planId,L=x.data,w=b.OB.examTask.updateExamObject(U);return g.WY.post({url:w,data:L})}function C(x){var U=x.planId,L=x.data,w=b.OB.examTask.examTaskChangeStatus(U);return g.WY.post({url:w,data:L})}function p(x){var U=x.planId,L=x.params,w=b.OB.examTask.getExamTaskStatistics(U);return g.WY.get({url:w,params:L})}function B(x){var U=x.planId,L=x.questionId,w=x.params,k=b.OB.examTask.getQuestionUserResult(U,L);return g.WY.get({url:k,params:w})}function c(x){var U=b.OB.examTask.addExamTask();return g.WY.post({url:U,data:x})}function I(x){var U=x.planId,L=b.OB.examTask.queryExamTaskDetail({planId:U});return g.WY.get({url:L})}function M(x){var U=x.planId,L=x.data,w=b.OB.examTask.editExamTask({planId:U});return g.WY.post({url:w,data:L})}function v(x){return g.WY.post({url:b.OB.ExamManagement.getExamListUrl(),data:x})}function A(x){return g.WY.post({url:b.OB.ExamManagement.postExamUrgeUrl(x.planId),data:x})}function d(x){return g.WY.post({url:b.OB.ExamManagement.postExamDelayUrl(x.planId),data:x})}function l(x){return g.WY.post({url:b.OB.ExamManagement.checkExamDelay(x.planId),data:x})}function t(x){return g.WY.post({url:b.OB.ExamManagement.postExamCopyUrl(x.planId),data:x})}function h(x){return g.WY.post({url:b.OB.ExamManagement.postExamChangeStatusUrl(x.planId),data:x})}function F(x){return g.WY.post({url:b.OB.ExamManagement.postExamDeleteUrl(x.planId),data:x})}function m(x){return g.WY.post({url:b.OB.ExamManagement.getExamListStatisticsUrl(),data:x})}function E(){return g.WY.get({url:a.ZP.creditrules.getScoreRule()})}function Q(x){var U=x.planId,L=x.data;return g.WY.post({url:b.OB.examTask.checkPeopleDelete({planId:U}),data:L})}function G(x){var U=x.planId;return g.WY.get({url:b.OB.examTask.getPeopleRoleForExam({planId:U})})}function V(x){return g.WY.get({url:b.OB.examTask.getUrgeUserIds(x),params:{user_type:"all"}})}function z(x){var U=x.planId,L=x.data;return request.post({url:EXAM_API.examTask.singleTaskAssign({planId:U}),data:L})}function $(x){return g.WY.get({url:b.OB.examTask.examRecallCheck({planId:x})})}function W(x){var U=x.paperId,L=(0,O.Z)(x,["paperId"]);return g.WY.get({url:b.OB.PaperManager.getPaperRelationInfo(U)},L)}function S(x){var U=x.examId;return g.WY.post({url:b.OB.examTask.examPrepare({examId:U}),data:{exam_id:U}})}},59434:function(gt,Se,e){"use strict";e.d(Se,{wu:function(){return La},R4:function(){return We},p7:function(){return Tt},Xk:function(){return Ga},xE:function(){return xe},Vu:function(){return qe},ZU:function(){return fa},Fz:function(){return oe},G2:function(){return De},B$:function(){return me},Sm:function(){return ke},Qp:function(){return Ue},wr:function(){return ye},LE:function(){return ze},CZ:function(){return Ct},hi:function(){return x}});var O=e(77883),g=e(21888),b=e(12924),a=e.n(b),T=e(80991),o=e(91768);class D extends a().Component{constructor(){super(...arguments);this.handleChange=re=>{this.props.formik.setFieldValue("examDuration",re)}}render(){var re=this.props.t;return a().createElement(a().Fragment,null,a().createElement(g.Z,{precision:0,min:1,max:300,className:"qa-total-testing-time-field",disabled:this.props.disabled,value:this.props.defaultFieldList,onChange:this.handleChange}),a().createElement("span",{style:{marginLeft:"10px"}},this.props.t("common.minutes")),a().createElement("span",{className:"infotext"},re("exam.examDuration")))}}var K=(0,T.$j)((0,o.Z)()(D)),P=e(13062),y=e(71230),C=e(77576),p=e(59314),B=e(89032),c=e(15746),I=e(28216),M=e(17780),v=e(16239),A=e(38642);class d extends a().Component{constructor(){super(...arguments);this.state={blackList:{switchScreenFlag:(0,A.eY)("EXAM_SWITCH_SCREEN"),faceFlag:(0,A.eY)("CHEATFLAG_EXAM_FACE_KNOW")}},this.handleSwitch=re=>{this.triggerChange({isChecked:re,switchNum:this.props.defaultFieldList.switchNum,faceRecognition:this.props.defaultFieldList.faceRecognition})},this.handleChange=re=>{this.triggerChange({isChecked:this.props.defaultFieldList.isChecked,faceRecognition:this.props.defaultFieldList.faceRecognition,switchNum:re})},this.triggerChange=re=>{var fe=re.isChecked,pe=re.switchNum,ee=re.faceRecognition;this.props.formik.setFieldValue("cheatFlag",{isChecked:fe,faceRecognition:ee,switchNum:pe})},this.handleSwitchFace=re=>{this.triggerChange({isChecked:this.props.defaultFieldList.isChecked,switchNum:this.props.defaultFieldList.switchNum,faceRecognition:re?"on":"off"})},this.renderSwitchNumContent=()=>{var re=this.props,fe=re.defaultFieldList,pe=re.disabled,ee=re.t,ge=fe.switchNum;return a().createElement(a().Fragment,null,a().createElement(c.Z,{span:24},a().createElement("span",{className:"item-margin"},ee("exam.switchScreen")),a().createElement(g.Z,{min:0,max:100,value:ge,parser:Me=>Me.replace(/[^0-9]/g,""),onChange:this.handleChange,disabled:pe}),a().createElement("span",{className:"infotext"},ee("exam.switchScreenTipBefore")),a().createElement("p",{style:{margin:0}},a().createElement("span",{className:"infotext"},ee("exam.switchScreenTipAfter")))))}}render(){var re=this.props,fe=re.prefixCls,pe=re.defaultFieldList,ee=re.disabled,ge=re.faceKnowDisabled,Me=ge===void 0?!1:ge,Ke=re.t,ct=re.appType,pt=pe.isChecked,_t=pe.faceRecognition,At=this.state.blackList;return(0,M.xX)()?null:a().createElement("section",{className:"cl-form__secbox ".concat(fe)},a().createElement("header",{className:"cl-form__secbox__header"},Ke("exam.antiCheating")),a().createElement("div",{className:"cl-form__secbox__content"},a().createElement(y.Z,null,a().createElement(c.Z,{span:24},a().createElement(p.Z,{defaultChecked:pt,onChange:this.handleSwitch,disabled:ee}),a().createElement("span",{className:"item-margin"},Ke("exam.antiCheatingTip"))),v.Z[(0,v.c)()].showCl&&ct!=="fs_app"&&At.switchScreenFlag?this.renderSwitchNumContent():null,ct==="wx_app"||ct==="fs_app"||!v.Z[(0,v.c)()].showCl||!At.faceFlag?null:a().createElement(c.Z,{span:24},a().createElement("span",{className:"item-margin"},Ke("exam.faceKnow")),a().createElement(p.Z,{defaultChecked:_t==="on",onChange:this.handleSwitchFace,disabled:Me}),a().createElement("p",{style:{margin:0}},a().createElement("span",{className:"infotext"},"(",Ke("exam.faceKnowTip"),")"))))))}}d.defaultProps={prefixCls:"cheat-flag"};var l=(0,I.$j)(ht=>({appType:ht.user.appType}))((0,T.$j)((0,o.Z)()(d))),t=e(63185),h=e(9676),F=e(88983),m=e(47933),E=e(88986);class Q extends a().Component{constructor(){super(...arguments);this.handleRadioChange=re=>{if(this.props.formik.setFieldValue("markType",(0,E.Z)((0,E.Z)({},this.props.formik.values.markType),{},{checkedValue:re.target.value,artificialDisabled:this.props.defaultFieldList.artificialDisabled})),re.target.value===2&&this.props.papers){var fe=this.props.papers,pe=fe.shortAnswerCount,ee=fe.fillBlankCount;this.props.formik.setFieldValue("markType",(0,E.Z)((0,E.Z)({},this.props.formik.values.markType),{},{checkedValue:re.target.value,artificialDisabled:this.props.defaultFieldList.artificialDisabled,fillBlank:{checked:ee!==0,disabled:!ee},shortAnswer:{checked:pe!==0,disabled:!pe}}))}},this.chooseFillBlank=re=>{this.props.formik.setFieldValue("markType",(0,E.Z)((0,E.Z)({},this.props.formik.values.markType),{},{fillBlank:(0,E.Z)((0,E.Z)({},this.props.formik.values.markType.fillBlank),{},{checked:re.target.checked})}))},this.chooseShortAnswer=re=>{this.props.formik.setFieldValue("markType",(0,E.Z)((0,E.Z)({},this.props.formik.values.markType),{},{shortAnswer:(0,E.Z)((0,E.Z)({},this.props.formik.values.markType.shortAnswer),{},{checked:re.target.checked})}))},this.onAnonymousMarkingChange=re=>{var fe=this.props.defaultFieldList,pe=fe.fillBlank,ee=fe.shortAnswer;ee.disabled&&pe.disabled||this.props.formik.setFieldValue("markType",(0,E.Z)((0,E.Z)({},this.props.formik.values.markType),{},{anonymousMarking:re}))}}render(){var re=this.props,fe=re.prefixCls,pe=re.disabled,ee=re.t,ge=re.anonymousMarking,Me=this.props.defaultFieldList,Ke=Me.checkedValue,ct=Me.artificialDisabled,pt=Me.fillBlank,_t=Me.shortAnswer,At=Me.anonymousMarking;return a().createElement("section",{className:"cl-form__secbox ".concat(fe)},a().createElement("header",{className:"cl-form__secbox__header"},ee("exam.wayOfReading")),a().createElement("div",{className:"cl-form__secbox__content"},a().createElement(m.ZP.Group,{value:Ke,onChange:this.handleRadioChange,disabled:pe},a().createElement(m.ZP,{value:1},ee("exam.systemScoring"),a().createElement("span",{className:"infotext"},ee("exam.systemScoringTip"))),a().createElement("br",null),a().createElement(m.ZP,{value:2,disabled:ct},ee("exam.manualScoring"),a().createElement("span",{className:"infotext"},ee("exam.manualScoringTip")))),Ke===2?a().createElement(a().Fragment,null,a().createElement("div",null,a().createElement(h.Z,{checked:pt.checked,onClick:this.chooseFillBlank,disabled:pe||pt.disabled},ee("common.blank")),a().createElement(h.Z,{checked:_t.checked,onClick:this.chooseShortAnswer,disabled:pe||_t.disabled},ee("common.describe")),a().createElement("span",{className:"infotext"},ee("exam.manualOptionsScoringTip"))),ge&&a().createElement("div",{className:"setting_line"},a().createElement("div",{className:"anonymous_reading"},a().createElement("span",{className:"label ".concat(_t.disabled&&pt.disabled&&"disable_label")},ee("exam.anonymousMarking")),a().createElement(p.Z,{disabled:pe||_t.disabled&&pt.disabled,size:"middle",defaultChecked:At||!1,onChange:this.onAnonymousMarkingChange})))):null))}}Q.defaultProps={prefixCls:"mark-type",anonymousMarking:!1};var G=(0,T.$j)((0,o.Z)()(Q)),V=e(22385),z=e(31097),$=e(1870);class W extends a().Component{constructor(){super(...arguments);this.onShowResultSwitchChange=re=>{this.props.formik.setFieldValue("reExam",(0,E.Z)((0,E.Z)({},this.props.defaultFieldList),{},{show_result:re}))},this.handleSwitch=re=>{this.props.formik.setFieldValue("reExam",(0,E.Z)((0,E.Z)({},this.props.defaultFieldList),{},{isChecked:re}))},this.handleNotAllowChange=re=>{this.props.formik.setFieldValue("reExam",(0,E.Z)((0,E.Z)({},this.props.defaultFieldList),{},{notAllowed:{end:re.target.value}}))},this.handleAllowChangeReRule=re=>{this.props.formik.setFieldValue("reExam",(0,E.Z)((0,E.Z)({},this.props.defaultFieldList),{},{allowed:(0,E.Z)((0,E.Z)({},this.props.defaultFieldList.allowed),{},{reRule:re.target.value})}))},this.handleChangeReNum=re=>{this.props.formik.setFieldValue("reExam",(0,E.Z)((0,E.Z)({},this.props.defaultFieldList),{},{allowed:(0,E.Z)((0,E.Z)({},this.props.defaultFieldList.allowed),{},{reNum:re})}))},this.handleAllowChangeRecord=re=>{this.props.formik.setFieldValue("reExam",(0,E.Z)((0,E.Z)({},this.props.defaultFieldList),{},{allowed:(0,E.Z)((0,E.Z)({},this.props.defaultFieldList.allowed),{},{record:re.target.value})}))},this.handleAllowChangeEnd=re=>{this.props.formik.setFieldValue("reExam",(0,E.Z)((0,E.Z)({},this.props.defaultFieldList),{},{allowed:(0,E.Z)((0,E.Z)({},this.props.defaultFieldList.allowed),{},{end:re.target.value})}))},this.handleAllowChangeRule=re=>{this.props.formik.setFieldValue("reExam",(0,E.Z)((0,E.Z)({},this.props.defaultFieldList),{},{allowed:(0,E.Z)((0,E.Z)({},this.props.defaultFieldList.allowed),{},{viewRule:re.target.value})}))},this.renderSwitchContent=()=>{var re=this.props.defaultFieldList.isChecked;return re?this.renderAllowContent():this.renderNotAllowContent()},this.renderNotAllowContent=()=>{var re=this.props,fe=re.disabled,pe=re.defaultFieldList,ee=re.t,ge=pe.notAllowed.end;return a().createElement(c.Z,{span:24},a().createElement("div",{className:"retake__title"},ee("exam.retakeExamAnalysisSetting")),a().createElement("span",{className:"retake__content"},ee("exam.retakeExamViewSetting")),a().createElement(m.ZP.Group,{onChange:this.handleNotAllowChange,value:ge,disabled:fe},a().createElement(m.ZP,{value:2},ee("exam.retakeSettingFalseRow1Checkbox1")),a().createElement(m.ZP,{value:3},ee("exam.retakeSettingFalseRow1Checkbox3")),a().createElement(m.ZP,{value:1},ee("exam.retakeSettingFalseRow1Checkbox2"))),ge!==1?this.renderAllowViewRule():this.renderStudentTestResultSetting())},this.renderAllowContent=()=>a().createElement(a().Fragment,null,this.renderAllowContentReRule(),this.renderAllowContentRecord(),this.renderAllowContentEnd()),this.renderAllowContentReRule=()=>{var re=this.props,fe=re.disabled,pe=re.defaultFieldList,ee=re.t,ge=pe.allowed,Me=ge.reRule,Ke=ge.reNum;return a().createElement(c.Z,{span:24},a().createElement("div",{className:"retake__title"},ee("exam.retakeExamTimeSetting")),a().createElement(m.ZP.Group,{onChange:this.handleAllowChangeReRule,value:Me,disabled:fe},a().createElement(m.ZP,{value:0},ee("exam.retakeSettingTrueRow1Checkbox1")),a().createElement(m.ZP,{value:1},ee("exam.retakeSettingTrueRow1Checkbox2")),a().createElement(m.ZP,{value:2},ee("exam.retakeSettingTrueRow1Checkbox3"))),Me===2?a().createElement(g.Z,{precision:0,min:1,max:99,value:Ke,disabled:fe,onChange:this.handleChangeReNum}):null)},this.renderAllowContentRecord=()=>{var re=this.props,fe=re.disabled,pe=re.defaultFieldList,ee=re.t,ge=pe.allowed.record,Me=pe.userJoin,Ke=Me===void 0?!1:Me;return a().createElement(c.Z,{span:24},a().createElement("div",{className:"retake__title"},ee("exam.retakeExamGradeSetting")),Ke?a().createElement(z.Z,{title:ee("exam.retakeSettingTrueRow2CheckboxDisabledTip")},a().createElement(m.ZP.Group,{onChange:this.handleAllowChangeRecord,value:ge,disabled:Ke},a().createElement(m.ZP,{value:0},ee("exam.retakeSettingTrueRow2Checkbox1")),a().createElement(m.ZP,{value:1},ee("exam.retakeSettingTrueRow2Checkbox2")))):a().createElement(m.ZP.Group,{onChange:this.handleAllowChangeRecord,value:ge,disabled:fe},a().createElement(m.ZP,{value:0},ee("exam.retakeSettingTrueRow2Checkbox1")),a().createElement(m.ZP,{value:1},ee("exam.retakeSettingTrueRow2Checkbox2"))))},this.renderAllowContentEnd=()=>{var re=this.props,fe=re.disabled,pe=re.defaultFieldList,ee=re.t,ge=re.examProps,Me=ge===void 0?{}:ge,Ke=pe.allowed.end;return a().createElement(c.Z,{span:24},a().createElement("div",{className:"retake__title"},ee("exam.retakeExamAnalysisSetting")),a().createElement("span",{className:"retake__content"},ee("exam.retakeExamViewSetting")),a().createElement(m.ZP.Group,{onChange:this.handleAllowChangeEnd,value:Ke,disabled:fe},a().createElement(m.ZP,{value:5},ee("exam.retakeSettingTrueRow3Checkbox1")),a().createElement(m.ZP,{value:4},ee("exam.retakeSettingTrueRow3Checkbox3")),!Me.disabled&&a().createElement(m.ZP,{value:3},ee("exam.retakeSettingFalseRow1Checkbox3")),a().createElement(m.ZP,{value:1},ee("exam.retakeSettingTrueRow3Checkbox2"))),Ke!==1?this.renderAllowViewRule():this.renderStudentTestResultSetting())},this.renderAllowViewRule=()=>{var re=this.props,fe=re.disabled,pe=re.defaultFieldList,ee=re.t,ge=re.canShowErrorAnalysis,Me=pe.allowed.viewRule;return a().createElement(c.Z,{span:24},a().createElement("span",{className:"retake__content"},ee("exam.retakeExamContentSetting")),a().createElement(m.ZP.Group,{onChange:this.handleAllowChangeRule,value:Me,disabled:fe},a().createElement(m.ZP,{value:1},ee("exam.retakeSettingTrueRow4Checkbox1")),a().createElement(m.ZP,{value:2},ee("exam.retakeSettingTrueRow4Checkbox2")),ge?a().createElement(m.ZP,{value:3},ee("exam.retakeSettingTrueRow4Checkbox3")):null))},this.renderStudentTestResultSetting=()=>{var re=this.props,fe=re.disabled,pe=re.defaultFieldList,ee=re.t,ge=pe.show_result;return a().createElement(c.Z,{span:24},a().createElement("span",{className:"retake__content"},ee("exam.showExamResultSetting")),a().createElement(p.Z,{checked:ge,onChange:this.onShowResultSwitchChange,disabled:fe}),a().createElement("span",{className:"showExamResultSettingTip"},"(".concat(ee("exam.showExamResultSettingTip"),")")))},this.renderTooltip=()=>{var re=this.props.defaultFieldList.isChecked;return re?null:this.renderNotAllowedTooltip()},this.renderNotAllowedTooltip=()=>a().createElement("div",null,a().createElement("p",null,this.props.t("common.explain")),a().createElement("p",null,this.props.t("exam.retakeSettingFalseInfoTip")))}render(){var re=this.props,fe=re.prefixCls,pe=re.defaultFieldList,ee=re.disabled,ge=re.t,Me=re.examProps,Ke=Me===void 0?{}:Me,ct=pe.isChecked,pt=pe.userJoin,_t=pt===void 0?!1:pt;return a().createElement("section",{className:"cl-form__secbox ".concat(fe)},a().createElement("header",{className:"cl-form__secbox__header"},ge("exam.retakeSetting")),a().createElement("div",{className:"cl-form__secbox__content"},a().createElement(y.Z,null,a().createElement(c.Z,{span:24},a().createElement(p.Z,{checked:ct,onChange:this.handleSwitch,disabled:ee||Ke.disabled||_t}),a().createElement("span",{className:"item-margin"},ge("exam.retakeSettingInfo")),ct?null:a().createElement(z.Z,{title:this.renderTooltip()},a().createElement("span",null,a().createElement($.Z,{style:{color:"#FAAD14"}})))),this.renderSwitchContent())))}}W.defaultProps={prefixCls:"re-exam"};var S=(0,T.$j)((0,o.Z)()(W));function x(ht){return ht.isChecked?ht.allowed.end===1?ht.show_result:!0:ht.notAllowed.end===1?ht.show_result:!0}var U=e(57663),L=e(71577),w=e(47673),k=e(4107),ne=e(43358),ie=e(34041),Ne=e(49101),ue=e(93117),_e=ie.Z.Option,Ze=ht=>{var re=ht.user;return{qyShield:re.qyShield}};class j extends a().Component{constructor(re){super(re);this.handleChangeCertificate=ge=>{var Me=ge.target.checked;this.props.formik.setFieldValue("reward",(0,E.Z)((0,E.Z)({},this.props.defaultFieldList),{},{certificate:{id:this.props.defaultFieldList.certificate.id,name:this.props.defaultFieldList.certificate.name,isChecked:Me}}))},this.handleChangePass=ge=>{var Me=ge.target.checked;this.props.formik.setFieldValue("reward",(0,E.Z)((0,E.Z)({},this.props.defaultFieldList),{},{pass:{score:this.props.defaultFieldList.pass.score,isChecked:Me}}))},this.handleChangePassScore=ge=>{this.props.formik.setFieldValue("reward",(0,E.Z)((0,E.Z)({},this.props.defaultFieldList),{},{pass:{score:ge,isChecked:this.props.defaultFieldList.pass.isChecked}}))},this.handleChangeFlunk=ge=>{var Me=ge.target.checked;this.props.formik.setFieldValue("reward",(0,E.Z)((0,E.Z)({},this.props.defaultFieldList),{},{flunk:{score:this.props.defaultFieldList.flunk.score,isChecked:Me}}))},this.handleChangeFlunkScore=ge=>{var Me=this.state.add,Ke;Me===1?Ke=Math.abs(ge):Ke=-Math.abs(ge),this.props.formik.setFieldValue("reward",(0,E.Z)((0,E.Z)({},this.props.defaultFieldList),{},{flunk:{score:Ke,isChecked:this.props.defaultFieldList.flunk.isChecked}}))},this.handleChangeMiss=ge=>{var Me=ge.target.checked;this.props.formik.setFieldValue("reward",(0,E.Z)((0,E.Z)({},this.props.defaultFieldList),{},{miss:{score:this.props.defaultFieldList.miss.score,isChecked:Me}}))},this.handleChangeMissScore=ge=>{this.props.formik.setFieldValue("reward",(0,E.Z)((0,E.Z)({},this.props.defaultFieldList),{},{miss:{score:ge,isChecked:this.props.defaultFieldList.miss.isChecked}}))},this.handleSelectCertificate=()=>{this.setState({visible:!0})},this.handleOk=ge=>{this.setState({visible:!1}),this.props.formik.setFieldValue("reward",(0,E.Z)((0,E.Z)({},this.props.defaultFieldList),{},{certificate:{id:ge[0].id,name:ge[0].name,isChecked:this.props.defaultFieldList.certificate.isChecked}}))},this.handleCancel=()=>{this.setState({visible:!1})},this.renderCertificateContent=()=>{var ge=this.props,Me=ge.defaultFieldList,Ke=ge.disabled,ct=ge.t,pt=ge.formik,_t=pt.errors,At=pt.touched,Gt=Me.certificate;return a().createElement(y.Z,null,a().createElement(c.Z,{span:6},a().createElement(h.Z,{checked:Gt.isChecked,onChange:this.handleChangeCertificate,disabled:Ke},ct("exam.issuingCertificate"))),a().createElement(c.Z,{span:16},a().createElement(k.Z,{value:Gt.name,disabled:!0,style:{width:160},className:At.reward&&_t.reward&&_t.reward.certificateChecked?"status-error":""}),Ke?null:a().createElement(L.Z,{type:"link",icon:a().createElement(Ne.Z,null),disabled:!Gt.isChecked,onClick:this.handleSelectCertificate},ct("exam.issuingCertificateBtn")),a().createElement("span",{className:"infotext"},ct("exam.issuingCertificateTip"))))},this.renderPassContent=()=>{var ge=this.props,Me=ge.defaultFieldList,Ke=ge.disabled,ct=ge.t,pt=ge.formik,_t=pt.errors,At=pt.touched,Gt=Me.pass;return a().createElement(y.Z,null,a().createElement(c.Z,{span:6},a().createElement(h.Z,{checked:Gt.isChecked,onChange:this.handleChangePass,disabled:Ke},ct("exam.passRewardScore"))),a().createElement(c.Z,{span:16},a().createElement(g.Z,{precision:0,min:0,max:999,value:Gt.score,disabled:!Gt.isChecked||Ke,onChange:this.handleChangePassScore,className:At.reward&&_t.reward&&_t.reward.passChecked?"status-error":""}),a().createElement("span",{className:"infotext"},ct("exam.passRewardScoreTip"))))},this.renderFlunkContent=()=>{var ge=this.props,Me=ge.defaultFieldList,Ke=ge.disabled,ct=ge.t,pt=ge.formik,_t=pt.errors,At=pt.touched,Gt=Me.flunk,Ia=this.state.add,Ba=Math.abs(Gt.score);return a().createElement(y.Z,null,a().createElement(c.Z,{span:6},a().createElement(h.Z,{checked:Gt.isChecked,onChange:this.handleChangeFlunk,disabled:Ke},ct("exam.unpassRewardScore"))),a().createElement(c.Z,{span:16},a().createElement(k.Z.Group,{compact:!0},a().createElement(ie.Z,{defaultValue:Ia,onChange:this.onChangeSelect,disabled:!Gt.isChecked||Ke},a().createElement(_e,{value:1},ct("scoreRankingList.add")),a().createElement(_e,{value:2},ct("scoreRankingList.minus"))),a().createElement(g.Z,{precision:0,min:0,max:999,value:Ba,disabled:!Gt.isChecked||Ke,onChange:this.handleChangeFlunkScore,className:At.reward&&_t.reward&&_t.reward.flunkChecked?"status-error":""}),a().createElement("span",{className:"infotext vertical"},ct("exam.unpassRewardScoreTip")))))},this.renderMissContent=()=>{var ge=this.props,Me=ge.defaultFieldList,Ke=ge.disabled,ct=ge.t,pt=ge.formik,_t=pt.errors,At=pt.touched,Gt=Me.miss;return a().createElement(y.Z,null,a().createElement(c.Z,{span:6},a().createElement(h.Z,{checked:Gt.isChecked,onChange:this.handleChangeMiss,disabled:Ke},ct("exam.flunkRewardScore"))),a().createElement(c.Z,{span:16},a().createElement(g.Z,{precision:0,min:0,max:999,value:Gt.score,disabled:!Gt.isChecked||Ke,onChange:this.handleChangeMissScore,className:At.reward&&_t.reward&&_t.reward.missChecked?"status-error":""}),a().createElement("span",{className:"infotext vertical"},ct("exam.flunkRewardScoreTip"))))},this.onChangeSelect=ge=>{this.setState({add:ge},()=>{this.handleChangeFlunkScore(0)})};var fe=re.defaultFieldList,pe=fe.flunk,ee=1;pe.score<0&&(ee=2),this.state={visible:!1,add:ee}}render(){var re=this.props,fe=re.prefixCls,pe=re.defaultFieldList,ee=re.t,ge=re.formik,Me=ge.errors,Ke=ge.touched,ct=this.state.visible,pt=pe.certificate,_t=[{id:pt.id,name:pt.name}];return a().createElement("section",{className:"cl-form__secbox ".concat(fe)},a().createElement("header",{className:"cl-form__secbox__header"},ee("exam.passReward")),a().createElement("div",{className:"cl-form__secbox__content"},this.renderCertificateContent(),this.renderPassContent(),this.renderFlunkContent(),this.renderMissContent()),Ke.reward&&Me.reward&&a().createElement("span",{style:{paddingLeft:"16px"},className:"tip_error_msg"},Me.reward.msg),a().createElement(ue.Z,{visible:ct,defaultChecked:_t,onCancel:this.handleCancel,onOk:this.handleOk}))}}j.defaultProps={prefixCls:"rewrad"};var R=(0,I.$j)(Ze)((0,T.$j)((0,o.Z)()(j)));class le extends a().Component{constructor(){super(...arguments);this.handleChange=re=>{this.props.formik.setFieldValue("questionsMode",re.target.value),this.props.formik.setFieldValue("summary",""),this.props.formik.setFieldValue("title","");var fe=this.props.formik.values,pe=fe.fixedQuestion,ee=fe.randomQuestion,ge=re.target.value===1;ge?!pe.tableList.fillBlankCount&&!pe.tableList.shortAnswerCount?this.props.formik.setFieldValue("markType",{checkedValue:1,artificialDisabled:!0}):!pe.tableList.fillBlankCount&&pe.tableList.shortAnswerCount?this.props.formik.setFieldValue("markType",(0,E.Z)((0,E.Z)({},this.props.formik.values.markType),{},{fillBlank:{disabled:!0,checked:!1},shortAnswer:{disabled:!1,checked:!0},artificialDisabled:!1})):!pe.tableList.shortAnswerCount&&pe.tableList.fillBlankCount?this.props.formik.setFieldValue("markType",(0,E.Z)((0,E.Z)({},this.props.formik.values.markType),{},{shortAnswer:{disabled:!0,checked:!1},fillBlank:{disabled:!1,checked:!0},artificialDisabled:!1})):this.props.formik.setFieldValue("markType",(0,E.Z)((0,E.Z)({},this.props.formik.values.markType),{},{artificialDisabled:!1,shortAnswer:{disabled:!1,checked:!0},fillBlank:{disabled:!1,checked:!0}})):!ee.bankQuesitonInfo.fillBlankCount&&!ee.bankQuesitonInfo.shortAnswerCount?this.props.formik.setFieldValue("markType",(0,E.Z)((0,E.Z)({},this.props.formik.values.markType),{},{checkedValue:1,artificialDisabled:!0})):!ee.bankQuesitonInfo.fillBlankCount&&ee.bankQuesitonInfo.shortAnswerCount?this.props.formik.setFieldValue("markType",(0,E.Z)((0,E.Z)({},this.props.formik.values.markType),{},{fillBlank:{disabled:!0,checked:!1},shortAnswer:{disabled:!1,checked:!0},artificialDisabled:!1})):!ee.bankQuesitonInfo.shortAnswerCount&&ee.bankQuesitonInfo.fillBlankCount?this.props.formik.setFieldValue("markType",(0,E.Z)((0,E.Z)({},this.props.formik.values.markType),{},{shortAnswer:{disabled:!0,checked:!1},fillBlank:{disabled:!1,checked:!0},artificialDisabled:!1})):this.props.formik.setFieldValue("markType",(0,E.Z)((0,E.Z)({},this.props.formik.values.markType),{},{artificialDisabled:!1,shortAnswer:{disabled:!1,checked:!0},fillBlank:{disabled:!1,checked:!0}}))}}render(){return a().createElement(m.ZP.Group,{value:this.props.defaultFieldList,onChange:this.handleChange,disabled:this.props.disabled},a().createElement(m.ZP,{value:1},this.props.t("exam.fixed")),a().createElement(m.ZP,{value:2},this.props.t("exam.random")))}}le.defaultProps={prefixCls:"fix-mode-question"};var H=(0,T.$j)((0,o.Z)()(le)),X=e(6793);class ce extends a().Component{constructor(){super(...arguments);this.handleChange=re=>{this.props.formik.setFieldValue("passLine",re)},this.renderTip=()=>{var re=this.props,fe=re.defaultFieldList,pe=re.formik,ee=re.t,ge=pe.values,Me=ge.questionsMode,Ke=ge.fixedQuestion;if(Me===1){var ct=Ke.tableList.totalScore;return a().createElement("span",{className:"infotext"},ee("exam.passingGrade"),(0,X.zC)(ct*fe/100),"=",ee("exam.totalScore"),ct,"*",ee("exam.passline"),fe,"%")}else return a().createElement("span",{className:"infotext"},ee("exam.passExample"))}}render(){return a().createElement(a().Fragment,null,a().createElement(g.Z,{precision:0,min:0,max:100,className:"qa-pass-line-field",value:this.props.defaultFieldList,onChange:this.handleChange,disabled:this.props.disabled}),a().createElement("span",{style:{marginLeft:"10px"}},"%"),this.renderTip())}}var Te=(0,T.$j)((0,o.Z)()(ce)),Le=e(66456),he=e(55313),Ee=e(20228),ve=e(11382),be=e(62029),Ve=e(32157),Ae=e(75869),at=e(87312),et=e(1164),ut=e(10237),q=e(37055),Oe=e(18329),Je=e(95664),je=e(48479),Be=e(86726),St=e(44881),Lt=e(60667),Wt=ht=>({userInfo:ht.user,themeColor:ht.advancedSetting.themeColor}),pa=Ae.Z.TreeNode,Xt={size:"large",destroyOnClose:!0,bodyStyle:{padding:"0"},maskClosable:!1,wrapClassName:"qa-select-test-paper-confirm"};class Et extends a().Component{constructor(re){var fe;super(re);fe=this,this.onCancel=()=>{var pe=this.props.onCancel;pe&&this.props.onCancel()},this.onOk=()=>{var pe=this.state.checkedList.map(ge=>({id:ge.id,name:ge.name,componentName:"PaperSelector",data:ge.data||{},icon:"",type:"paper"}));if(!pe.length){this.props.onCancel();return}if(this.props.withPaperInfo&&!this.props.multiple){var ee=pe[0];this.asyncGetPaperInfoById(ee.id).then(ge=>{ee.data.withPaperInfo=ge,this.props.onOk([ee])})}else this.props.onOk(pe)},this.onChangePage=pe=>{var ee=this.state.page;ee.pageNumber=pe,this.setState({page:ee},()=>{this.getPaperList(this.state.selectClassifyKey[0])})},this.onSearch=pe=>{var ee=this.state.page;ee.pageNumber=1,this.setState({keyword:pe,page:ee},()=>{this.getPaperList(this.state.selectClassifyKey[0])})},this.handleRefresh=()=>{this.getClassifyTree(),this.getPaperList("")},this.compileData=function(){var pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],ee=fe.state.checkedList,ge=pe.map(Me=>({id:Me.id,name:Me.title,creatorName:Me.creatorName,creator_user_id:Me.creator_user_id,creator_source_type:Me.creator_source_type,createTime:(0,X.p6)(Me.createTime,"yyyy.MM.dd hh:mm"),isChecked:ee.findIndex(Ke=>Ke.id===Me.id)!==-1,data:Me}));return ge},this.getClassifyTree=()=>{var pe=q.ZP.Classify.getResourceClassify();ut.WY.get({url:pe,params:{auth_type:"refer",include_unclassified:"true",parent_id:0}}).then(ee=>{var ge=(0,St.P)(ee.data.list,"refer");this.setState({classifyList:ge})})},this.loadData=pe=>new Promise(ee=>{var ge=pe.id;setTimeout(()=>{var Me=q.ZP.Classify.getResourceClassify(),Ke=ge;ut.WY.get({url:Me,params:{parent_id:Ke,auth_type:"refer"}}).then(ct=>{if(!ct.data||pe.dataRef.children){ee();return}var pt=(0,St.P)(ct.data.list,"refer");pe.dataRef.children=pt,this.setState({classifyList:[...this.state.classifyList]})}),ee()},300)}),this.getPaperList=pe=>{var ee=this.state,ge=ee.page,Me=ee.keyword,Ke=q.ZP.PaperSelector.getPaperList(),ct={sortOrder:"desc",sortName:"createTime",courseClassify:pe,keyword:Me,pageNumber:ge.pageNumber,pageSize:ge.pageSize};this.setState({isLoading:!0}),ut.WY.get({url:Ke,params:ct}).then(pt=>{this.setState({isLoading:!1,paperList:this.compileData(pt.data.list),paginationData:{total:pt.data.total,pages:pt.data.pages,pageNum:pt.data.page_num}})})},this.asyncGetPaperInfoById=pe=>new Promise(ee=>{var ge=q.ZP.PaperSelector.getPaperInfoById();ut.WY.get({url:ge,params:{paperId:pe}}).then(Me=>{ee(Me.data)})}),this.handleClassifySelect=pe=>{var ee=this.state.page;ee.pageNumber=1,this.setState({selectClassifyKey:pe,page:ee}),this.getPaperList(pe[0])},this.renderTreeNodes=pe=>pe.map(ee=>ee.children?a().createElement(pa,{title:ee.label,key:ee.id,dataRef:ee,disabled:ee.disabled||!1},this.renderTreeNodes(ee.children)):a().createElement(pa,(0,be.Z)({title:ee.label,dataRef:ee,key:ee.id},ee,{disabled:ee.disabled||!1}))),this.checkOne=(pe,ee)=>{var ge=[...this.state.checkedList],Me=[...this.state.paperList];if(this.props.multiple)if(pe.isChecked){var Ke=ge.findIndex(ct=>ct.id===pe.id);ge.splice(Ke,1),Me[ee].isChecked=!1}else Me[ee].isChecked=!0,ge.push(pe);else pe.isChecked?(ge=[],Me[ee].isChecked=!1):(Me=Me.map(ct=>(ct.isChecked=!1,ct)),Me[ee].isChecked=!0,ge=[pe]);this.setState({checkedList:ge,paperList:Me})},this.renderMultipleItem=(pe,ee)=>{var ge=this.props,Me=ge.t,Ke=ge.themeColor,ct=pe.id,pt=pe.name,_t=pe.isChecked,At=pe.createTime,Gt=pe.creatorName,Ia=pe.creator_user_id,Ba=pe.creator_source_type;return a().createElement(h.Z,{value:ct,key:ct,onClick:()=>this.checkOne(pe,ee),checked:_t,className:"paper-selector-paper-item"},a().createElement("span",{className:"paper-title"},a().createElement("span",{className:"paper-name"},pt),a().createElement("span",{className:"paper-info"},a().createElement("span",{className:"paper-time"},At),a().createElement("span",{className:"paper-user"},a().createElement(Lt.Z,{dataType:"userName",value:Ia,name:Gt,type:Ba}),Me("component.createLabel")),a().createElement(et.Z,{to:"/training/examination/paper/info?paperId=".concat(ct)},a().createElement("span",{className:"paper-preview",style:{color:Ke}},Me("component.preview"))))))},this.renderSingleItem=(pe,ee)=>{var ge=this.props.t,Me=pe.id,Ke=pe.name,ct=pe.isChecked,pt=pe.createTime,_t=pe.creatorName,At=pe.creator_user_id,Gt=pe.creator_source_type;return a().createElement(m.ZP,{value:Me,key:Me,onClick:()=>this.checkOne(pe,ee),checked:ct,className:"paper-selector-paper-item"},a().createElement("span",{className:"paper-title"},a().createElement("span",{className:"paper-name"},Ke),a().createElement("span",{className:"paper-info"},a().createElement("span",{className:"paper-time"},pt),a().createElement("span",{className:"paper-user"},a().createElement(Lt.Z,{dataType:"userName",value:At,name:_t,type:Gt}),ge("component.createLabel")),a().createElement(et.Z,{to:"/training/examination/paper/info?paperId=".concat(Me)},a().createElement("span",{className:"paper-preview"},ge("component.preview"))))))},this.state={title:re.t("component.addPaper"),keyword:"",checkedList:[],classifyList:[],paperList:[],selectClassifyKey:[""],paginationData:{},page:{pageNumber:1,pageSize:12},isLoading:!1,allowActions:(0,Be.V9)("paper",this.props.userInfo.modules)}}componentDidUpdate(re){var fe=this.props,pe=fe.visible,ee=fe.defaultChecked;if(re.visible!==pe&&pe){var ge=[...ee];this.setState({checkedList:ge,keyword:"",page:{pageNumber:1,pageSize:12}},()=>{this.getClassifyTree(),this.getPaperList("")})}}render(){var re={onSelect:this.handleClassifySelect,selectedKeys:this.state.selectClassifyKey,loadData:this.loadData},fe=this.state,pe=fe.paperList,ee=fe.paginationData,ge=fe.isLoading,Me=fe.allowActions,Ke=this.props,ct=Ke.multiple,pt=Ke.t,_t=Ke.themeColor,At={shouldRenderAddPaper:(0,Be.H3)("add",Me)};return a().createElement(Oe.ZP,(0,be.Z)({},Xt,{visible:this.props.visible,title:this.state.title,onCancel:this.onCancel,onOk:this.onOk}),a().createElement("div",{className:"paper-selector"},a().createElement("div",{className:"paper-selector-top"},a().createElement(je.Z,{onSearch:this.onSearch,prefixCls:"paper-selector-top-search",placeholder:pt("searchInputPlaceholder.paper")}),a().createElement("div",{className:"paper-selector-top-addBtn"},At.shouldRenderAddPaper?a().createElement(et.Z,{to:"/training/examination/paper/add"},a().createElement(L.Z,{type:"primary",icon:a().createElement(Ne.Z,null)},pt("exam.paperAdd"))):null)),a().createElement("div",{className:"paper-selector-list"},a().createElement("div",{className:"paper-selector-tree"},a().createElement("div",{style:this.state.selectClassifyKey[0]===""?{color:_t}:{},className:"paper-selector-tree-all ".concat(this.state.selectClassifyKey[0]===""?"selected":""),onClick:()=>this.handleClassifySelect([""])},pt("common.all")),a().createElement(Ae.Z,re,this.renderTreeNodes(this.state.classifyList))),a().createElement("div",{className:"paper-selector-paper"},ge?a().createElement("div",{className:"paper-selector-loading"},a().createElement(ve.Z,null)):null,a().createElement("div",{className:"paper-selector-paper-list"},pe.length<=0?a().createElement(at.Z,{className:"no-result",tipText:pt("course.courseNoDataTip")}):a().createElement(a().Fragment,null,pe.map((Gt,Ia)=>(ct&&this.renderMultipleItem(Gt,Ia),this.renderSingleItem(Gt,Ia))))),a().createElement(Je.Z,{defaultPageSize:"12",totalNum:ee.total,totalPage:ee.pages,current:ee.pageNum,onChange:this.onChangePage,onRefresh:this.handleRefresh})))))}}Et.defaultProps={visible:!1,defaultChecked:[],multiple:!1,withPaperInfo:!1,onCancel:()=>{},onOk:ht=>ht};var Fe=(0,I.$j)(Wt)((0,o.Z)()(Et)),Pe=e(3407),Ie=(0,X.me)(),$e=Pe.Z[Ie],te=[{title:$e.examing.single,dataIndex:"single",key:"single"},{title:$e.examing.multiple,dataIndex:"multiple",key:"multiple"},{title:$e.examing.tof,dataIndex:"trueOrFalse",key:"trueOrFalse"},{title:$e.examing.blank,dataIndex:"fillBlank",key:"fillBlank"},{title:$e.examing.describe,dataIndex:"shortAnswer",key:"shortAnswer"},{title:$e.common.total,dataIndex:"total",key:"total"}],ae=ht=>{var re=[],fe=["Count","Score"];return fe.forEach(pe=>{var ee={};ee.key=pe,te.forEach(ge=>{ee["".concat(ge.dataIndex)]=Re[pe](ht["".concat(ge.dataIndex).concat(pe)])}),re.push(ee)}),re},Re={Count:ht=>(0,X.ZT)("".concat($e.exam.questionCalcCount),ht),Score:ht=>(0,X.ZT)("".concat($e.exam.scoreCalcCount),ht)};class de extends a().Component{constructor(){super(...arguments);this.state={visible:!1},this.handleClick=()=>{this.setState({visible:!0}),this.props.onShowDialog&&this.props.onShowDialog()},this.handleOk=re=>{this.setState({visible:!1}),this.props.onHiddenDialog&&this.props.onHiddenDialog();var fe=re[0];this.props.formik.setFieldValue("fixedQuestion",{id:fe.id,name:fe.name,tableList:fe.data.withPaperInfo}),this.props.formik.setFieldValue("passLine",fe.data.withPaperInfo.passLine),this.props.formik.setFieldValue("summary",fe.data.summary),this.props.formik.setFieldValue("title",fe.name),!fe.data.withPaperInfo.fillBlankCount&&!fe.data.withPaperInfo.shortAnswerCount?this.props.formik.setFieldValue("markType",(0,E.Z)((0,E.Z)({},this.props.formik.values.markType),{},{checkedValue:1,artificialDisabled:!0})):!fe.data.withPaperInfo.fillBlankCount&&fe.data.withPaperInfo.shortAnswerCount?this.props.formik.setFieldValue("markType",(0,E.Z)((0,E.Z)({},this.props.formik.values.markType),{},{fillBlank:{disabled:!0,checked:!1},shortAnswer:{disabled:!1,checked:!0},artificialDisabled:!1})):!fe.data.withPaperInfo.shortAnswerCount&&fe.data.withPaperInfo.fillBlankCount?this.props.formik.setFieldValue("markType",(0,E.Z)((0,E.Z)({},this.props.formik.values.markType),{},{shortAnswer:{disabled:!0,checked:!1},fillBlank:{disabled:!1,checked:!0},artificialDisabled:!1})):this.props.formik.setFieldValue("markType",(0,E.Z)((0,E.Z)({},this.props.formik.values.markType),{},{artificialDisabled:!1,shortAnswer:{disabled:!1,checked:!0},fillBlank:{disabled:!1,checked:!0}}))},this.handleCancel=()=>{this.setState({visible:!1}),this.props.onHiddenDialog&&this.props.onHiddenDialog()},this.compileData=re=>re.id?[{id:re.id,name:re.name}]:[],this.renderContent=()=>{var re=this.props,fe=re.prefixCls,pe=re.defaultFieldList,ee="".concat(fe,"__content");return pe.id?a().createElement("div",{className:ee},a().createElement(he.Z,{size:"middle",bordered:!0,pagination:!1,columns:te,rowKey:"key",dataSource:ae(pe.tableList)})):null}}render(){var re=this.props,fe=re.prefixCls,pe=re.defaultFieldList,ee=re.disabled,ge=re.t,Me=this.state.visible,Ke=pe.name,ct=this.compileData(pe);return a().createElement(a().Fragment,null,a().createElement("div",{className:fe},a().createElement(k.Z,{value:Ke,disabled:!0,style:{width:260}}),ee?null:a().createElement(L.Z,{type:"link",icon:a().createElement(Ne.Z,null),onClick:this.handleClick},ge("exam.selectPaper")),this.renderContent(),a().createElement(Fe,{visible:Me,withPaperInfo:!0,defaultChecked:ct,onCancel:this.handleCancel,onOk:this.handleOk})))}}de.defaultProps={prefixCls:"fixed-questions-mode"};var we=(0,T.$j)((0,o.Z)()(de)),rt=e(28391),mt=ie.Z.Option;class Zt extends a().Component{constructor(){super(...arguments);this.state={visible:!1},this.columns=[{title:this.props.t("exam.bankName"),dataIndex:"name",key:"name",width:130,render:re=>a().createElement("div",{className:"cl-text-ellipsis",style:{width:130}},re)},{title:()=>"".concat(this.props.t("examing.single"),"(").concat(this.getTotalCount("single"),")"),dataIndex:"single",key:"single",render:(re,fe)=>{var pe=this.props.formik,ee=pe.errors.randomQuestion,ge=pe.touched;if(fe.isInputNumber){var Me=this.props.defaultFieldList.bankQuesitonInfo,Ke=Me.singleScore===0?"":Me.singleScore;return fe.isSettingCount?a().createElement(g.Z,{className:ge.randomQuestion&&ee&&(ee.singleCount||ee.all)&&"status-error",precision:0,min:0,max:this.getTotalCount("single"),value:Me.singleCount,onChange:ct=>this.handlenCountChange("single",ct),disabled:this.props.disabled}):a().createElement(a().Fragment,null,a().createElement("p",{className:"infotext"},this.props.t("exam.giveSingleScore")),a().createElement(g.Z,{className:ge.randomQuestion&&ee&&(ee.singleScore||ee.all)&&"status-error",precision:1,min:0,value:Ke,onChange:ct=>this.handlenScoreChange("single",ct),disabled:this.props.disabled}))}return re}},{title:()=>"".concat(this.props.t("examing.multiple"),"(").concat(this.getTotalCount("multiple"),")"),dataIndex:"multiple",key:"multiple",render:(re,fe)=>{var pe=this.props.formik,ee=pe.errors.randomQuestion,ge=pe.touched;if(fe.isInputNumber){var Me=this.props.defaultFieldList.bankQuesitonInfo,Ke=Me.multipleScore===0?"":Me.multipleScore;return fe.isSettingCount?a().createElement(g.Z,{precision:0,className:ge.randomQuestion&&ee&&(ee.multipleCount||ee.all)&&"status-error",min:0,max:this.getTotalCount("multiple"),value:Me.multipleCount,onChange:At=>this.handlenCountChange("multiple",At),disabled:this.props.disabled}):a().createElement(a().Fragment,null,a().createElement("p",{className:"infotext"},this.props.t("exam.giveSingleScore")),a().createElement(g.Z,{precision:1,className:ge.randomQuestion&&ee&&(ee.multipleScore||ee.all)&&"status-error",min:0,value:Ke,onChange:At=>this.handlenScoreChange("multiple",At),disabled:this.props.disabled}))}if(fe.key==="multipleMissed"){var ct=this.props.defaultFieldList,pt=ct.bankQuesitonInfo,_t=pt.multipleMissedScore;return a().createElement(a().Fragment,null,a().createElement("p",{className:"infotext"},this.props.t("exam.missedScore")),a().createElement(g.Z,{precision:1,className:ge.randomQuestion&&ee&&(ee.multipleMissedScore||ee.all)&&"status-error",min:0,value:_t||0,onChange:At=>this.handlenScoreChange("multipleMissed",At),disabled:this.props.disabled}))}return re}},{title:()=>"".concat(this.props.t("examing.tof"),"(").concat(this.getTotalCount("trueOrFalse"),")"),dataIndex:"trueOrFalse",key:"trueOrFalse",render:(re,fe)=>{var pe=this.props.formik,ee=pe.errors.randomQuestion,ge=pe.touched;if(fe.isInputNumber){var Me=this.props.defaultFieldList.bankQuesitonInfo,Ke=Me.trueOrFalseScore===0?"":Me.trueOrFalseScore;return fe.isSettingCount?a().createElement(g.Z,{precision:0,min:0,className:ge.randomQuestion&&ee&&(ee.trueOrFalseCount||ee.all)&&"status-error",max:this.getTotalCount("trueOrFalse"),value:Me.trueOrFalseCount,onChange:ct=>this.handlenCountChange("trueOrFalse",ct),disabled:this.props.disabled}):a().createElement(a().Fragment,null,a().createElement("p",{className:"infotext"},this.props.t("exam.giveSingleScore")),a().createElement(g.Z,{precision:1,className:ge.randomQuestion&&ee&&(ee.trueOrFalseScore||ee.all)&&"status-error",min:0,value:Ke,onChange:ct=>this.handlenScoreChange("trueOrFalse",ct),disabled:this.props.disabled}))}return re}},{title:()=>"".concat(this.props.t("examing.blank"),"(").concat(this.getTotalCount("fillBlank"),")"),dataIndex:"fillBlank",key:"fillBlank",render:(re,fe)=>{var pe=this.props,ee=pe.formik,ge=ee.errors.randomQuestion,Me=ee.touched,Ke=pe.t;if(fe.isInputNumber){var ct=this.props.defaultFieldList.bankQuesitonInfo,pt=ct.fillBlankScore===0?"":ct.fillBlankScore;return fe.isSettingCount?a().createElement(g.Z,{precision:0,min:0,className:Me.randomQuestion&&ge&&(ge.fillBlankCount||ge.all)&&"status-error",max:this.getTotalCount("fillBlank"),value:ct.fillBlankCount,onChange:_t=>this.handlenCountChange("fillBlank",_t),disabled:this.props.disabled}):a().createElement(a().Fragment,null,a().createElement("p",{className:"infotext"},ct.fillBlankType===1?Ke("exam.giveBlankScore"):Ke("exam.giveSingleScore")),a().createElement("div",{className:"input_group"},a().createElement(ie.Z,{value:ct.fillBlankType,disabled:this.props.disabled,className:"type_select",onChange:_t=>this.changeSelcet("fillBlank",_t)},a().createElement(mt,{value:1},Ke("exam.paperAddSecItemDescBlank")),a().createElement(mt,{value:2},Ke("exam.topic"))),a().createElement(g.Z,{precision:1,min:0,className:"".concat(Me.randomQuestion&&ge&&(ge.fillBlankScore||ge.all)&&"status-error"," short"),value:pt,onChange:_t=>this.handlenScoreChange("fillBlank",_t),disabled:this.props.disabled})))}return re}},{title:()=>"".concat(this.props.t("examing.describe"),"(").concat(this.getTotalCount("shortAnswer"),")"),dataIndex:"shortAnswer",key:"shortAnswer",render:(re,fe)=>{var pe=this.props,ee=pe.formik,ge=ee.errors.randomQuestion,Me=ee.touched,Ke=pe.t;if(fe.isInputNumber){var ct=this.props.defaultFieldList.bankQuesitonInfo,pt=ct.shortAnswerScore===0?"":ct.shortAnswerScore;return fe.isSettingCount?a().createElement(g.Z,{precision:0,className:Me.randomQuestion&&ge&&(ge.shortAnswerCount||ge.all)&&"status-error",min:0,max:this.getTotalCount("shortAnswer"),value:ct.shortAnswerCount,onChange:_t=>this.handlenCountChange("shortAnswer",_t),disabled:this.props.disabled}):a().createElement(a().Fragment,null,a().createElement("p",{className:"infotext"},ct.shortAnswerType===1?Ke("exam.giveDescScore"):Ke("exam.giveSingleScore")),a().createElement("div",{className:"input_group"},a().createElement(ie.Z,{value:ct.shortAnswerType,disabled:this.props.disabled,className:"type_select",onChange:_t=>this.changeSelcet("shortAnswer",_t)},a().createElement(mt,{value:1},Ke("exam.paperAddSecItemDescDesc")),a().createElement(mt,{value:2},Ke("exam.topic"))),a().createElement(g.Z,{precision:1,className:"".concat(Me.randomQuestion&&ge&&(ge.shortAnswerScore||ge.all)&&"status-error"," short"),min:0,value:pt,onChange:_t=>this.handlenScoreChange("shortAnswer",_t),disabled:this.props.disabled})))}return re}}],this.actionColumn=[{title:this.props.t("exam.operate"),dataIndex:"action",key:"action",width:70,render:(re,fe)=>re?a().createElement("a",{href:"javascript:;",onClick:()=>this.handleDeleteRow(fe)},re):null}],this.handleClick=()=>{this.setState({visible:!0}),this.props.onShowDialog&&this.props.onShowDialog()},this.handleOk=re=>{this.setState({visible:!1}),this.props.onHiddenDialog&&this.props.onHiddenDialog();var fe=re.map(pe=>({id:pe.id,name:pe.name,proportion:0,disabled:pe.data.totalCount===0}));this.props.formik.setFieldValue("randomQuestion",(0,E.Z)((0,E.Z)({},this.props.defaultFieldList),{},{bankQuesitonVoList:re})),this.props.formik.setFieldValue("proportional",fe),setImmediate(()=>{this.changeMarkType()})},this.handleCancel=()=>{this.setState({visible:!1}),this.props.onHiddenDialog&&this.props.onHiddenDialog()},this.handleDeleteRow=re=>{var fe=this.props.formik.values&&this.props.formik.values.proportional&&this.props.formik.values.proportional.filter(pe=>pe.id!==re.key)||[];this.props.formik.setFieldValue("randomQuestion",(0,E.Z)((0,E.Z)({},this.props.defaultFieldList),{},{bankQuesitonVoList:this.props.defaultFieldList.bankQuesitonVoList.filter(pe=>pe.id!==re.key)})),this.props.formik.setFieldValue("proportional",fe),setImmediate(()=>{this.props.formik.values.randomQuestion.bankQuesitonVoList.length?this.changeMarkType():this.props.formik.setFieldValue("markType",(0,E.Z)((0,E.Z)({},this.props.formik.values.markType),{},{checkedValue:1,artificialDisabled:!0}))})},this.handlenCountChange=(re,fe)=>{var pe=fe;pe==null&&(pe=0),this.props.formik.setFieldValue("randomQuestion",(0,E.Z)((0,E.Z)({},this.props.defaultFieldList),{},{bankQuesitonInfo:(0,E.Z)((0,E.Z)({},this.props.defaultFieldList.bankQuesitonInfo),{},{["".concat(re,"Count")]:pe})})),setImmediate(()=>{this.changeMarkType()})},this.handlenScoreChange=(re,fe)=>{var pe=fe;pe==null&&(pe=0);var ee=this.props.defaultFieldList,ge=ee.bankQuesitonInfo;this.props.formik.setFieldValue("randomQuestion",(0,E.Z)((0,E.Z)({},ee),{},{bankQuesitonInfo:(0,E.Z)((0,E.Z)({},ge),{},{["".concat(re,"Score")]:pe})}))},this.compileDataSource=()=>{var re=this.props,fe=re.defaultFieldList,pe=re.disabled,ee=re.t,ge=pe?this.columns:this.columns.concat(this.actionColumn),Me=[],Ke=fe.bankQuesitonVoList;Ke.forEach(pt=>{var _t={};_t.key=pt.id,ge.forEach(At=>{At.key==="name"?_t["".concat(At.dataIndex)]=pt.name:At.key==="action"?_t["".concat(At.dataIndex)]=this.props.t("common.remove"):_t["".concat(At.dataIndex)]=this.formatFunc.Count(pt.data["".concat(At.dataIndex,"Count")])}),Me.push(_t)});var ct=["Count","Score"];return ct.forEach(pt=>{var _t={};_t.key=pt,_t.isInputNumber=!0,pt==="Count"&&(_t.isSettingCount=!0),ge.forEach(At=>{var Gt=At.dataIndex;Gt==="name"?_t["".concat(Gt)]=pt==="Count"?this.props.t("exam.selectQusCount"):this.props.t("exam.setBatchScore"):_t["".concat(Gt)]=""}),Me.push(_t)}),this.props.multipleMissedScore&&Me.push({key:"multipleMissed",name:"".concat(ee("exam.missedScoreSetting")," \uFF08").concat(ee("course.points"),"\uFF09"),multiple:"/",single:"/",trueOrFalse:"/",fillBlank:"/",shortAnswer:"/",action:""}),Me.push({key:"total",name:this.props.t("exam.totalCalcScore"),multiple:this.calcTotalScore("multiple"),single:this.calcTotalScore("single"),trueOrFalse:this.calcTotalScore("trueOrFalse"),fillBlank:this.calcTotalScore("fillBlank"),shortAnswer:this.calcTotalScore("shortAnswer"),action:""}),Me},this.formatFunc={Count:re=>(0,X.ZT)("".concat(this.props.t("exam.questionCalcCount")),re),Score:re=>(0,X.ZT)("".concat(this.props.t("exam.scoreCalcCount")),re)},this.compileData=re=>{var fe=[];return re.forEach(pe=>{var ee=pe.data;fe.push({componentName:"QuestionBankSelector",id:pe.id,name:pe.name,icon:"",type:"QUESTION_BANK",data:ee||pe})}),fe},this.getTotalCount=re=>this.props.defaultFieldList.bankQuesitonVoList.reduce((fe,pe)=>parseInt(fe+pe.data["".concat(re,"Count")],10),[]),this.calcTotalScore=re=>{var fe=this.props.defaultFieldList.bankQuesitonInfo;return re==="fillBlank"&&fe.fillBlankType===1||re==="shortAnswer"&&fe.shortAnswerType===1?"/":(0,X.Yz)(fe["".concat(re,"Count")]*fe["".concat(re,"Score")])},this.changeMarkType=()=>{var re=this.props.formik.values.randomQuestion.bankQuesitonInfo,fe=re.fillBlankCount,pe=re.shortAnswerCount;!fe&&!pe?this.props.formik.setFieldValue("markType",{checkedValue:1,artificialDisabled:!0}):fe?pe?this.props.formik.setFieldValue("markType",(0,E.Z)((0,E.Z)({},this.props.formik.values.markType),{},{artificialDisabled:!1,shortAnswer:{disabled:!1,checked:!0},fillBlank:{disabled:!1,checked:!0}})):this.props.formik.setFieldValue("markType",(0,E.Z)((0,E.Z)({},this.props.formik.values.markType),{},{shortAnswer:{disabled:!0,checked:!1},fillBlank:{disabled:!1,checked:!0},artificialDisabled:!1})):this.props.formik.setFieldValue("markType",(0,E.Z)((0,E.Z)({},this.props.formik.values.markType),{},{fillBlank:{disabled:!0,checked:!1},shortAnswer:{disabled:!1,checked:!0},artificialDisabled:!1}))},this.renderContent=()=>{var re=this.props,fe=re.prefixCls,pe=re.defaultFieldList,ee=re.disabled,ge=re.t,Me="".concat(fe,"__content");return pe.bankQuesitonVoList.length?a().createElement("div",{className:Me},a().createElement(he.Z,{size:"middle",bordered:!0,pagination:!1,columns:ee?this.columns:this.columns.concat(this.actionColumn),rowKey:"key",dataSource:this.compileDataSource(pe)}),a().createElement("div",{className:"black_tips"},ge("exam.blackTip"))):null},this.changeSelcet=(re,fe)=>{this.props.formik.setFieldValue("randomQuestion",(0,E.Z)((0,E.Z)({},this.props.defaultFieldList),{},{bankQuesitonInfo:(0,E.Z)((0,E.Z)({},this.props.defaultFieldList.bankQuesitonInfo),{},{["".concat(re,"Type")]:fe})}))}}render(){var re=this.props,fe=re.prefixCls,pe=re.defaultFieldList,ee=re.disabled,ge=re.t,Me=re.formik,Ke=Me.errors,ct=Me.touched,pt=re.privateCustom,_t=this.state.visible,At=pe.bankQuesitonVoList,Gt=this.compileData(At);return a().createElement(a().Fragment,null,a().createElement("div",{className:"".concat(fe)},ee?null:a().createElement(L.Z,{type:"link",icon:a().createElement(Ne.Z,null),onClick:this.handleClick},ge("exam.selectBank")),this.renderContent(),a().createElement(rt.Z,{visible:_t,defaultChecked:Gt,onCancel:this.handleCancel,onOk:this.handleOk,privateCustom:pt}),ct.randomQuestion&&Ke.randomQuestion&&a().createElement("span",{className:"tip_error_msg"},Ke.randomQuestion.msg)))}}Zt.defaultProps={multipleMissedScore:!1,prefixCls:"random-questions-mode"},Zt.defaultProps={prefixCls:"random-questions-mode"};var bt=Zt,Ft=(0,T.$j)((0,o.Z)()(Zt));class Ut extends bt{constructor(re){super(re);this.handlenScoreChange=(fe,pe)=>{var ee=pe;ee==null&&(ee=0);var ge=this.props.defaultFieldList,Me=ge.bankQuesitonInfo;this.props.formik.setFieldValue("randomQuestion",(0,E.Z)((0,E.Z)({},ge),{},{bankQuesitonInfo:(0,E.Z)((0,E.Z)({},Me),{},{[fe]:ee})}))},this.getName=(fe,pe)=>({countName:pe?"".concat(fe,"Count"):"".concat(fe,"CountChoose"),unitName:"".concat(fe,"UnitCount")}),this.handlenCountChange=fe=>{var pe=fe.type,ee=fe.isRequired,ge=fe.v,Me=ge;Me==null&&(Me=0);var Ke=this.getName(pe,ee),ct=Ke.unitName,pt=Ke.countName,_t=(0,E.Z)((0,E.Z)({},this.props.defaultFieldList.bankQuesitonInfo),{},{[pt]:Me}),At=pt.indexOf("Choose")===-1?"".concat(pe,"CountChoose"):"".concat(pe,"Count"),Gt=_t[pt]||0,Ia=_t[At]||0;_t[ct]=Gt+Ia,this.props.formik.setFieldValue("randomQuestion",(0,E.Z)((0,E.Z)({},this.props.defaultFieldList),{},{bankQuesitonInfo:_t})),setImmediate(()=>{this.changeMarkType()})},this.getRequiredTotalCount=(fe,pe)=>{var ee=this.compileDataSource(this.props.defaultFieldList),ge=fe?ee.filter(Me=>Me.isRequired).map(Me=>Me.name):ee.filter(Me=>!Me.isRequired).map(Me=>Me.name).filter(Me=>Me);return this.props.defaultFieldList.bankQuesitonVoList.filter(Me=>{var Ke=Me.data;return ge.includes(Ke.name)}).reduce((Me,Ke)=>parseInt(Me+Ke.data["".concat(pe,"Count")],10),0)},this.getColumnsConfig=()=>{var fe=pe=>{var ee=pe.type,ge=pe.inputType,Me=pe.requiredType,Ke=pe.config,ct=Me==="requiredCount",pt=this.getName(ee,ct),_t=pt.unitName,At=pt.countName,Gt=this.props,Ia=Gt.formik,Ba=Ia.errors.randomQuestion,ia=Ia.touched,da=Gt.defaultFieldList.bankQuesitonInfo;if(ge==="total")return a().createElement(g.Z,{className:ia.randomQuestion&&Ba&&(Ba[_t]||Ba.all)&&"status-error",precision:0,min:0,value:da[_t],disabled:this.props.disabled});if(ge==="score"){var Es="".concat(ee,"Score"),Fs=da[Es]===0?"":da[Es];return a().createElement(a().Fragment,null,a().createElement("p",{className:"infotext"},this.props.t("exam.giveSingleScore")),a().createElement(g.Z,{className:ia.randomQuestion&&Ba&&(Ba[Es]||Ba.all)&&"status-error",precision:1,min:0,value:isNaN(parseInt(Fs))?0:Fs,onChange:hs=>this.handlenScoreChange(Es,hs),disabled:this.props.disabled}))}if(ge==="multipleInput"&&At==="multipleCount"){var Ts=this.props.defaultFieldList,Ns=Ts.bankQuesitonInfo,ks=Ns.multipleMissedScore;return a().createElement(a().Fragment,null,a().createElement("p",{className:"infotext"},this.props.t("exam.missedScore")),a().createElement(g.Z,{precision:1,className:ia.randomQuestion&&Ba&&(Ba.multipleMissedScore||Ba.all)&&"status-error",min:0,value:ks||0,onChange:hs=>this.handlenScoreChange("multipleMissedScore",hs),disabled:this.props.disabled}))}if(ge==="chooseInput"){var Bs=parseInt(da[At]),Wa=isNaN(Bs)?"":Bs;return a().createElement(g.Z,{className:ia.randomQuestion&&Ba&&(Ba[At]||Ba.all)&&"status-error",precision:0,min:0,max:this.getRequiredTotalCount(ct,ee),value:Wa,onChange:hs=>this.handlenCountChange({type:ee,isRequired:ct,v:hs}),disabled:this.props.disabled})}};return[{title:this.props.t("exam.bankName"),dataIndex:"name",key:"name",width:130,render:pe=>a().createElement("div",{className:"cl-text-ellipsis",style:{width:130}},pe)},{title:()=>"".concat(this.props.t("examing.single"),"(").concat(this.getTotalCount("single"),")"),dataIndex:"single",key:"single",render:(pe,ee)=>{var ge={type:"single",requiredType:ee.key,inputType:ee.inputType,record:ee};return fe(ge)||pe}},{title:()=>"".concat(this.props.t("examing.multiple"),"(").concat(this.getTotalCount("multiple"),")"),dataIndex:"multiple",key:"multiple",render:(pe,ee)=>{var ge={type:"multiple",requiredType:ee.key,inputType:ee.inputType,record:ee};return fe(ge)||pe}},{title:()=>"".concat(this.props.t("examing.tof"),"(").concat(this.getTotalCount("trueOrFalse"),")"),dataIndex:"trueOrFalse",key:"trueOrFalse",render:(pe,ee)=>{var ge={type:"trueOrFalse",requiredType:ee.key,inputType:ee.inputType,record:ee};return fe(ge)||pe}},{title:()=>"".concat(this.props.t("examing.blank"),"(").concat(this.getTotalCount("fillBlank"),")"),dataIndex:"fillBlank",key:"fillBlank",render:(pe,ee)=>{var ge={type:"fillBlank",inputType:ee.inputType,requiredType:ee.key,record:ee};return fe(ge)||pe}},{title:()=>"".concat(this.props.t("examing.describe"),"(").concat(this.getTotalCount("shortAnswer"),")"),dataIndex:"shortAnswer",key:"shortAnswer",render:(pe,ee)=>{var ge={type:"shortAnswer",inputType:ee.inputType,requiredType:ee.key,record:ee};return fe(ge)||pe}}]},this.requiredColumn=[{title:"\u662F\u5426\u5FC5\u9009",dataIndex:"isRequired",key:"isRequired",width:90,render:(fe,pe)=>{var ee=this.props.formik,ge=ee.errors.randomQuestion,Me=ee.touched,Ke=this.props.defaultFieldList.bankQuesitonInfo;if(pe.isRequiredInput)return a().createElement(h.Z,{checked:fe,disabled:this.props.disabled,onChange:this.handleRequiredChange(pe.name)})}}],this.handleRequiredChange=fe=>pe=>{var ee=pe.target.checked,ge=this.props.defaultFieldList,Me=ge.bankQuesitonVoList,Ke=ge.bankQuesitonInfo,ct=Me.findIndex(_t=>_t.name===fe),pt=Me[ct];this.props.formik.setFieldValue("randomQuestion",(0,E.Z)((0,E.Z)({},this.props.defaultFieldList),{},{bankQuesitonVoList:Object.assign([],Me,{[ct]:(0,E.Z)((0,E.Z)({},pt),{},{data:(0,E.Z)((0,E.Z)({},pt.data),{},{isRequired:ee})})})}))},this.getColumns=()=>{var fe=this.props.disabled,pe=this.getColumnsConfig().concat(this.requiredColumn);return fe||(pe=pe.concat(this.actionColumn)),pe},this.calcTotalScore=fe=>{var pe=this.props.defaultFieldList.bankQuesitonInfo;if(fe==="fillBlank"&&pe.fillBlankType===1||fe==="shortAnswer"&&pe.shortAnswerType===1)return"/";var ee=pe["".concat(fe,"Count")]||0,ge=pe["".concat(fe,"CountChoose")]||0;return(0,X.Yz)((ee+ge)*pe["".concat(fe,"Score")])},this.compileDataSource=()=>{var fe=this.props,pe=fe.defaultFieldList,ee=fe.disabled,ge=fe.t,Me=this.getColumns(),Ke=[],ct=pe.bankQuesitonVoList;ct.forEach(_t=>{var At={};At.key=_t.id,At.isRequiredInput=!0,Me.forEach(Gt=>{if(Gt.key==="name")At["".concat(Gt.dataIndex)]=_t.name;else if(Gt.key==="action")At["".concat(Gt.dataIndex)]=this.props.t("common.remove");else if(Gt.key==="isRequired"){var Ia;At.isRequired=_t==null||(Ia=_t.data)===null||Ia===void 0?void 0:Ia.isRequired}else At["".concat(Gt.dataIndex)]=this.formatFunc.Count(_t.data["".concat(Gt.dataIndex,"Count")])}),Ke.push(At)});var pt=["requiredCount","notRequiredCount","count","batchScore"];return pt.forEach(_t=>{var At={};At.key=_t,_t==="requiredCount"||_t==="notRequiredCount"?At.inputType="chooseInput":_t==="count"?At.inputType="total":_t==="batchScore"&&(At.inputType="score"),Me.forEach(Gt=>{var Ia=Gt.dataIndex;Ia==="name"&&(At["".concat(Ia)]=this.props.t("exam.".concat(_t)))}),Ke.push(At)}),this.props.multipleMissedScore&&Ke.push({key:"multipleMissed",inputType:"multipleInput",name:"".concat(ge("exam.missedScoreSetting")," \uFF08").concat(ge("course.points"),"\uFF09"),multiple:"/",single:"/",trueOrFalse:"/",fillBlank:"/",shortAnswer:"/",action:""}),Ke.push({key:"total",name:this.props.t("exam.totalCalcScore"),multiple:this.calcTotalScore("multiple"),single:this.calcTotalScore("single"),trueOrFalse:this.calcTotalScore("trueOrFalse"),fillBlank:this.calcTotalScore("fillBlank"),shortAnswer:this.calcTotalScore("shortAnswer"),action:""}),Ke},this.renderContent=()=>{var fe=this.props,pe=fe.prefixCls,ee=fe.defaultFieldList,ge=fe.disabled,Me=fe.t,Ke="".concat(pe,"__content");if(!ee.bankQuesitonVoList.length)return null;var ct=this.getColumns();return a().createElement("div",{className:Ke},a().createElement(he.Z,{size:"middle",bordered:!0,pagination:!1,columns:ct,rowKey:"key",dataSource:this.compileDataSource(ee)}),a().createElement("div",{className:"black_tips"},Me("exam.blackTip")))}}componentDidMount(){var re=this.props.defaultFieldList;this.props.formik.setFieldValue("randomQuestion",(0,E.Z)((0,E.Z)({},re),{},{bankQuesitonInfo:(0,E.Z)((0,E.Z)({},re.bankQuesitonInfo),{},{shortAnswerType:2,fillBlankType:2,singleCount:"",multipleCount:"",fillBlankCount:"",shortAnswerCount:"",trueOrFalseCount:""})}))}}var ca=(0,T.$j)((0,o.Z)()(Ut)),Qt=e(33565),Va=ht=>{var re=ht.t,fe=ht.disabled,pe=ht.formik,ee=ht.name,ge=Ia=>{var Ba=Ia!=null&&Ia.target?Ia.target.value:Ia;pe.setFieldValue("chooseBankCount",Ba)},Me=pe.values.randomQuestion.bankQuesitonVoList,Ke=Me===void 0?[]:Me,ct=Ke.length&&Ke.every(Ia=>Ia.data.isRequired),pt=(0,b.useState)(ht.value),_t=(0,Qt.Z)(pt,2),At=_t[0],Gt=_t[1];return(0,b.useEffect)(()=>{ct?(pe.setFieldValue("chooseBankCount",0),Gt(0)):Gt(ht.value)},[ct,ht.value]),a().createElement(a().Fragment,null,a().createElement(g.Z,{precision:0,min:0,value:At,onChange:ge,disabled:fe}),a().createElement("span",{style:{marginLeft:"10px"},className:"infotext"},re("exam.numberOfOptionalQuestion")))},Ra=(0,T.$j)((0,o.Z)()(Va)),Ua=ht=>{var re=ht.t,fe=ht.disabled,pe=ht.formik,ee=ht.name,ge=ht.defaultFieldList,Me=ge.bankQuesitonInfo,Ke=pt=>{if(pt==="fillBlank"&&Me.fillBlankType===1||pt==="shortAnswer"&&Me.shortAnswerType===1)return"/";var _t=Me["".concat(pt,"Count")]||0,At=Me["".concat(pt,"CountChoose")]||0;return(_t+At)*Me["".concat(pt,"Score")]},ct=0;return Me&&(ct=["multiple","single","trueOrFalse","fillBlank","shortAnswer"].map(pt=>Ke(pt)).filter(pt=>_.isNumber(pt)).reduce((pt,_t)=>(pt+=_t,pt),0)),(0,b.useEffect)(()=>{pe.setFieldValue("totalScore",ct)},[ct]),a().createElement(a().Fragment,null,a().createElement(g.Z,{min:0,value:isNaN(ct)?0:ct,disabled:fe}),a().createElement("span",{style:{marginLeft:"10px"},className:"infotext"},re("exam.totalScoreOfTestPaperDesc")))},ja=(0,T.$j)((0,o.Z)()(Ua));class ua extends a().Component{constructor(){super(...arguments);this.handleChange=re=>{this.props.formik.setFieldValue("knowledgePoints",re.target.value)}}render(){var re=this.props,fe=re.prefixCls,pe=re.defaultFieldList,ee=re.disabled,ge=re.t;return a().createElement("section",{className:"cl-form__secbox ".concat(fe)},a().createElement("header",{className:"cl-form__secbox__header"},ge("exam.knowledgePoint"),a().createElement("span",{className:"cl-form__secbox__header__tipinfo"},ge("exam.knowledgePointTip"))),a().createElement("div",{className:"cl-form__secbox__content"},a().createElement(m.ZP.Group,{value:pe,onChange:this.handleChange,disabled:ee},a().createElement(m.ZP,{value:1},ge("common.shown")),a().createElement(m.ZP,{value:2},ge("common.hidden")))))}}ua.defaultProps={prefixCls:"knowledge-points"};var ts=(0,T.$j)((0,o.Z)()(ua));class as extends a().Component{constructor(){super(...arguments);this.handleChange=re=>{this.props.formik.setFieldValue("isOpenDrawQuestions",re)}}render(){var re=this.props,fe=re.t,pe=re.defaultValue,ee=re.questionsNumber,ge=re.disabled;return a().createElement("div",{className:"questions_switch"},a().createElement(p.Z,{disabled:ge,checked:pe,onChange:this.handleChange}),a().createElement("span",{style:{marginLeft:"10px"}},"".concat(fe("exam.totalQuestions")," ").concat(ee," ").concat(fe("exam.questionsUnit"))))}}var Fa=(0,T.$j)((0,o.Z)()(as));class Sa extends a().Component{constructor(){super(...arguments);this.handleChange=(re,fe)=>{var pe=this.props.defaultFieldList;pe[fe].proportion=re,this.props.formik.setFieldValue("proportional",pe)}}render(){var re=this.props,fe=re.t,pe=re.defaultFieldList,ee=re.formik,ge=ee.errors,Me=ee.touched,Ke=re.disabled,ct=Me.randomQuestion&&ge.WeightInput;return a().createElement(a().Fragment,null,a().createElement("div",{className:"weight_input"},a().createElement("div",{className:"title"},fe("exam.weightTip")),pe.map((pt,_t)=>a().createElement("div",{className:"weight_input_item",key:pt.id},a().createElement(g.Z,{className:ct?"error":"",min:0,max:100,precision:0,disabled:Ke||pt.disabled,value:pt.proportion||0,onChange:At=>{this.handleChange(At,_t)}}),a().createElement("span",{className:"symbol"},"%"),a().createElement("span",{className:"name"},pt.name))),ct&&a().createElement("span",{className:"tip_error_msg"},ge.WeightInput)))}}var us=(0,T.$j)((0,o.Z)()(Sa));class Ds extends a().Component{constructor(){super(...arguments);this.handleSwitch=re=>{this.props.formik.setFieldValue("isOpenRobot",re);var fe=this.props.formik.values.employeeRange;fe.rangeList.cluster=[],this.props.formik.setFieldValue("employeeRange",fe)}}render(){var re=this.props,fe=re.t,pe=re.disabled,ee=re.value;return a().createElement(a().Fragment,null,a().createElement(p.Z,{defaultChecked:ee,onChange:this.handleSwitch,disabled:pe}),a().createElement("span",{className:"item-margin"},fe("exam.swarmRobotTip")))}}var Za=(0,T.$j)((0,o.Z)()(Ds)),ga=e(43859),Ga=(0,ga.Z)(K),La=(0,ga.Z)(l),fa=(0,ga.Z)(G),ke=(0,ga.Z)(S),Ue=(0,ga.Z)(R),De=(0,ga.Z)(H),oe=(0,ga.Z)(Te),xe=(0,ga.Z)(we),me=(0,ga.Z)(Ft),ye=(0,ga.Z)(ca),We=(0,ga.Z)(Ra),ze=(0,ga.Z)(ja),qe=(0,ga.Z)(ts),Tt=(0,ga.Z)(Fa),Ct=(0,ga.Z)(us),Vt=(0,ga.Z)(Za)},16381:function(gt,Se,e){"use strict";e.d(Se,{$1:function(){return D},JJ:function(){return K},QL:function(){return P},dy:function(){return y},cT:function(){return B},jx:function(){return I},pm:function(){return M},_F:function(){return v},RE:function(){return A}});var O=e(88986),g=e(6793),b=e(2396),a=e(3407),T=(0,g.me)(),o=a.Z[T].exam.validation,D=d=>{var l;return b.fA.positiveInteger.test(d)||(l=o.checkExamDuration),l},K=d=>{var l=d.certificate,t=d.pass,h=d.flunk,F=d.miss,m={};return l.isChecked&&!l.id&&(m=(0,O.Z)((0,O.Z)({},m),{},{certificateChecked:!0,msg:o.checkRewardCertificate})),t.isChecked&&(0,b.kh)(t.score)&&(m=(0,O.Z)((0,O.Z)({},m),{},{passChecked:!0,msg:o.checkRewardPass})),h.isChecked&&(0,b.kR)(h.score)&&(m=(0,O.Z)((0,O.Z)({},m),{},{flunkChecked:!0,msg:o.checkRewardFlunk})),F.isChecked&&(0,b.kh)(F.score)&&(m=(0,O.Z)((0,O.Z)({},m),{},{missChecked:!0,msg:o.checkRewardMiss})),Object.keys(m).length?m:""},P=d=>{var l;return(!b.fA.positiveInteger.test(d)||d<10||d>100)&&(l=o.checkPassLine),l},y=(d,l)=>{var t;return l.questionsMode===1&&!d.id&&(t=o.checkFixedMode),t},C=(d,l)=>l.reduce((t,h)=>parseInt(t+h.data["".concat(d,"Count")]),[]),p=(d,l)=>(0,g.Yz)(l["".concat(d,"Count")]*l["".concat(d,"Score")]),B=(d,l)=>{var t={};if(l.questionsMode===2)if(!d.bankQuesitonVoList.length)t={msg:o.checkRandomdModeNull};else{var h=d.bankQuesitonVoList,F=d.bankQuesitonInfo,m=C("fillBlank",h),E=C("multiple",h),Q=C("shortAnswer",h),G=C("single",h),V=C("trueOrFalse",h);if(F.fillBlankCount>m)t=(0,O.Z)((0,O.Z)({},t),{},{fillBlankCount:!0,msg:o.checkRandomdModeOther});else if(F.multipleCount>E)t=(0,O.Z)((0,O.Z)({},t),{},{multipleCount:!0,msg:o.checkRandomdModeOther});else if(F.shortAnswerCount>Q)t=(0,O.Z)((0,O.Z)({},t),{},{shortAnswerCount:!0,msg:o.checkRandomdModeOther});else if(F.singleCount>G)t=(0,O.Z)((0,O.Z)({},t),{},{singleCount:!0,msg:o.checkRandomdModeOther});else if(F.trueOrFalseCount>V)t=(0,O.Z)((0,O.Z)({},t),{},{trueOrFalseCount:!0,msg:o.checkRandomdModeOther});else{if((!F.fillBlankCount&&F.fillBlankScore||F.fillBlankCount&&!F.fillBlankScore)&&(t=(0,O.Z)((0,O.Z)({},t),{},{fillBlankCount:!0,fillBlankScore:!0,msg:o.checkRandomdModeOther})),(!F.multipleCount&&(F.multipleScore||F.multipleMissedScore)||F.multipleCount&&!F.multipleScore)&&(t=(0,O.Z)((0,O.Z)({},t),{},{multipleCount:!0,multipleScore:!0,msg:o.checkRandomdModeOther})),F.multipleScore&&F.multipleMissedScore&&F.multipleMissedScore>F.multipleScore&&(t=(0,O.Z)((0,O.Z)({},t),{},{multipleMissedScore:!0,msg:o.missedScoreTip})),(!F.shortAnswerCount&&F.shortAnswerScore||F.shortAnswerCount&&!F.shortAnswerScore)&&(t=(0,O.Z)((0,O.Z)({},t),{},{shortAnswerCount:!0,shortAnswerScore:!0,msg:o.checkRandomdModeOther})),(!F.singleCount&&F.singleScore||F.singleCount&&!F.singleScore)&&(t=(0,O.Z)((0,O.Z)({},t),{},{singleCount:!0,singleScore:!0,msg:o.checkRandomdModeOther})),(!F.trueOrFalseCount&&F.trueOrFalseScore||F.trueOrFalseCount&&!F.trueOrFalseScore)&&(t=(0,O.Z)((0,O.Z)({},t),{},{trueOrFalseCount:!0,trueOrFalseScore:!0,msg:o.checkRandomdModeOther})),Object.keys(t).length)return t;p("fillBlank",F)+p("multiple",F)+p("shortAnswer",F)+p("single",F)+p("trueOrFalse",F)||(t={all:!0,msg:o.checkRandomdModeOther})}}return Object.keys(t).length?t:""},c=d=>d===void 0,I=(d,l)=>{if(l.questionsMode===2){if(!d.bankQuesitonVoList.length)return{msg:o.checkRandomdModeNull};if(d.bankQuesitonVoList.every(m=>!m.data.isRequired))return{msg:o.pleaseSelectAtLeastOne};var t=["multiple","single","trueOrFalse","fillBlank","shortAnswer"],h=t.find(m=>{var E="".concat(m,"Count"),Q="".concat(m,"CountChoose"),G=l.randomQuestion.bankQuesitonInfo[E],V=l.randomQuestion.bankQuesitonInfo[Q];return c(G)||c(V)});if(h)return{msg:o.pleaseSetTheNumber};var F=t.every(m=>{var E="".concat(m,"Count");return!l.randomQuestion.bankQuesitonInfo[E]});if(F)return{msg:o.thereIsNoQuestionSelected}}},M=function(l){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h=t.bankQuesitonVoList,F=h===void 0?[]:h,m=F.length&&F.every(Q=>Q.data.isRequired);if(!m){if(l<=0||l===void 0||l==="")return o.pleaseFillInTheNumberOf;var E=F.filter(Q=>!Q.data.isRequired).length;if(l>E)return o.theNumberOfOptional}},v=d=>{var l,t=d.checkedValue,h=d.fillBlank,F=d.shortAnswer;return t===2&&h.checked===!1&&F.checked===!1&&(l="\u8BF7\u9009\u62E9\u4EBA\u5DE5\u9605\u5377\u65B9\u5F0F"),l},A=d=>{var l,t=d.reduce((h,F)=>F.proportion?h+F.proportion:h,0);return(t>100||t===0)&&(l=o.weightInput),l}},60211:function(gt,Se,e){"use strict";e.d(Se,{B:function(){return W},e:function(){return S}});var O=e(43859),g=e(57663),b=e(71577),a=e(22385),T=e(31097),o=e(57361),D=e(66456),K=e(55313),P=e(34792),y=e(48086),C=e(88986),p=e(9754),B=e.n(p),c=e(12924),I=e.n(c),M=e(91768),v=e(80991),A=e(49101),d=e(28391),l=e(51927),t=e(31916),h=e(38642),F=e(6793);class m extends I().Component{constructor(){super(...arguments);this.state={visible:!1,isNew:!1,columns:[]},this.handleClick=()=>{this.setState({visible:!0})},this.camelCaseObject=U=>{var L={};for(var w in U)L[(0,h.FI)(w)]=U[w];return L},this.handleOk=U=>{this.setState({visible:!1});var L=this.state.isNew,w=this.props,k=w.defaultFieldList,ne=w.formik;if(L){var ie=U.map(Ne=>{if(!Ne.type){var ue=this.camelCaseObject(Ne);return{id:Ne.id,name:Ne.title,type:"QUESTION_BANK",icon:"",componentName:"NewQuestionBankSelector",data:(0,C.Z)((0,C.Z)({},ue),{},{name:ue.name})}}return Ne});ne.setFieldValue("randomQuestion",(0,C.Z)((0,C.Z)({},k),{},{bankQuesitonVoList:ie}))}else ne.setFieldValue("randomQuestion",(0,C.Z)((0,C.Z)({},k),{},{bankQuesitonVoList:U}))},this.handleCancel=()=>{this.setState({visible:!1})},this.handleDeleteRow=U=>{var L=this.props.t;this.props.formik.setFieldValue("randomQuestion",(0,C.Z)((0,C.Z)({},this.props.defaultFieldList),{},{bankQuesitonVoList:this.props.defaultFieldList.bankQuesitonVoList.filter(w=>w.id!==U.key)})),y.default.success(L("exam.removeSuccessful"))},this.compileDataSource=()=>{var U=this.props.defaultFieldList,L=[],w=U.bankQuesitonVoList;return w.forEach(k=>{var ne={};ne.key=k.id,this.state.columns.forEach(ie=>{ie.key==="name"?ne["".concat(ie.dataIndex)]=k.name:ie.key==="action"?ne["".concat(ie.dataIndex)]=this.props.t("common.remove"):ne["".concat(ie.dataIndex)]=this.formatFunc.Count(k.data["".concat(ie.dataIndex,"Count")])}),L.push(ne)}),L},this.formatFunc={Count:U=>(0,F.ZT)("".concat(this.props.t("exam.questionCalcCount")),U)},this.compileData=U=>{var L=[];return U.forEach(w=>{var k=w.data;L.push({componentName:"QuestionBankSelector",id:w.id,name:w.name,icon:"",type:"QUESTION_BANK",data:k||w})}),L},this.getTotalCount=U=>{var L=this.props.defaultFieldList;return L.bankQuesitonVoList.length?L.bankQuesitonVoList.reduce((w,k)=>parseInt(w+k.data["".concat(U,"Count")]),[]):0},this.renderContent=()=>{var U=this.props,L=U.prefixCls,w=U.defaultFieldList,k=U.stageMode,ne="".concat(L,"__content");return!w.bankQuesitonVoList.length&&!k?null:I().createElement("div",{className:ne},I().createElement(K.Z,{size:"middle",bordered:!0,pagination:!1,scroll:{y:260},columns:this.state.columns,rowKey:"key",dataSource:this.compileDataSource(w)}))}}componentDidMount(){this.funGetEnterpriseExamType()}funGetEnterpriseExamType(){var U=this;return(0,o.Z)(B().mark(function L(){var w,k,ne,ie,Ne,ue;return B().wrap(function(Ze){for(;;)switch(Ze.prev=Ze.next){case 0:return w=U.props.t,Ze.next=3,(0,t.uH)();case 3:k=Ze.sent,ne=k==="new",ie="trueOrFalse",Ne="fillBlank",ue="shortAnswer",U.setState({isNew:ne,columns:[{title:w("exam.bankName"),dataIndex:"name",key:"name",width:150,render:(j,R)=>{var le=R.name;return I().createElement("div",{className:"ellipsis title"},I().createElement(T.Z,{placement:"top",title:le},le))}},{title:()=>"".concat(w("examing.single"),"(").concat(U.getTotalCount("single"),")"),dataIndex:"single",key:"single"},{title:()=>"".concat(w("examing.multiple"),"(").concat(U.getTotalCount("multiple"),")"),dataIndex:"multiple",key:"multiple"},{title:()=>"".concat(w("examing.tof"),"(").concat(U.getTotalCount(ie),")"),dataIndex:ie,key:"trueOrFalse"},{title:()=>"".concat(w("examing.blank"),"(").concat(U.getTotalCount(Ne),")"),dataIndex:Ne,key:"fillBlank"},{title:()=>"".concat(w("examing.describe"),"(").concat(U.getTotalCount(ue),")"),dataIndex:ue,key:"shortAnswer"},{title:()=>"".concat(w("common.total"),"(").concat(U.getTotalCount("total"),")"),dataIndex:"total",key:"total"},{title:w("exam.operate"),dataIndex:"action",key:"action",width:70,render:(j,R)=>j?I().createElement("a",{href:"javascript:;",onClick:()=>U.handleDeleteRow(R)},j):null}]});case 9:case"end":return Ze.stop()}},L)}))()}render(){var U=this.props,L=U.prefixCls,w=U.defaultFieldList,k=U.t,ne=this.state,ie=ne.visible,Ne=ne.isNew,ue=w.bankQuesitonVoList,_e=this.compileData(ue);return I().createElement(I().Fragment,null,I().createElement("div",{className:L},I().createElement("div",{className:"cl-form__sectitle"},k("exam.selectBank"),I().createElement(b.Z,{type:"link",icon:I().createElement(A.Z,null),onClick:this.handleClick},k("exam.selectBank"))),this.renderContent(),Ne?I().createElement(l.Z,{visible:ie,defaultChecked:_e,onCancel:this.handleCancel,onOk:this.handleOk,selectTip:k("questionPractice.selectQuestionTip")}):I().createElement(d.Z,{visible:ie,defaultChecked:_e,onCancel:this.handleCancel,onOk:this.handleOk})))}}m.defaultProps={prefixCls:"choose-questions-bank"};var E=(0,v.$j)((0,M.Z)()(m)),Q=e(77576),G=e(59314),V=e(24144);class z extends I().Component{constructor(U){super(U);this.onChange=L=>{var w=L.fileList;this.props.onChange(w)},this.handleSwitch=L=>{L?this.setState({type:""}):this.setState({type:"crop"})},this.state={type:"crop"}}render(){var U=this.props,L=U.value,w=U.t;return I().createElement(I().Fragment,null,I().createElement("div",{style:{marginBottom:"7px"}},I().createElement(G.Z,{defaultChecked:!1,onChange:this.handleSwitch}),I().createElement("span",{className:"item-margin"},w("resourceLibrary.originUpload"))),I().createElement("div",{className:"practice_cover_upload_field"},I().createElement("div",{className:"practice_cover_upload_container"},I().createElement(V.ZM,{uploadConfig:{maxCount:1},size:{value:2,unit:"MB"},clip:this.state.type,fileList:L,onUploadedListChange:this.onChange,render:k=>(0,V.iM)(k)})),I().createElement("span",{className:"practice_cover_upload_tip"},w("exam.itemBankDetailCoverTip"))))}}var $=(0,M.Z)()(z),W=(0,O.Z)(E),S=(0,O.Z)($)},30179:function(gt,Se,e){"use strict";e.d(Se,{j:function(){return o}});var O=e(6793),g=e(3407),b=(0,O.me)(),a=g.Z[b].exam.validation,T=(D,K)=>K.reduce((P,y)=>parseInt(P+y.data["".concat(D,"Count")],10),[]),o=D=>{var K,P=D.bankQuesitonVoList,y=T("total",P);return P.length===0?K=a.itemBankDetailRandomdModeNull:y===0&&(K=a.itemBankDetailRandomdModeOther),K}},41222:function(gt,Se,e){"use strict";e.d(Se,{z2:function(){return O},Qz:function(){return g},GM:function(){return b},S1:function(){return a},VB:function(){return T}});var O=function(D){var K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",P=0;return K==="studyPreview"?D.forEach(y=>{P+=y.courseMappingList.filter(C=>C.type==="ex").length}):D.forEach(y=>{P+=y.list.filter(C=>C.type==="ex").length}),P},g=o=>{var D=0;return o.forEach(K=>{D+=K.list.filter(P=>["ex","sc","jobEvaluation"].indexOf(P.type)<0).length}),D},b=function(D){var K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",P=0;return K==="studyPreview"?D.forEach(y=>{var C=y.courseMappingList,p=C.filter(B=>B.type==="operation");P+=p.length}):D.forEach(y=>{P+=y.list.filter(C=>C.type==="sc").length}),P},a=o=>{var D=0;return o.forEach(K=>{D+=K.list.filter(P=>P.type==="jobEvaluation").length}),D},T=o=>{var D=[];return o.forEach(K=>{D=D.concat(K.list.filter(P=>P.type==="xx"))}),D}},2019:function(gt,Se,e){"use strict";e.d(Se,{Dp:function(){return T},eD:function(){return o},g9:function(){return D}});var O=e(78138),g=e.n(O),b=e(78001),a=()=>{var K=localStorage.getItem("corpId");return K.slice(0,4)==="ding"},T=()=>a(),o=()=>a()?"".concat(b.Z.t("live.live"),"/").concat(b.Z.t("live.conference")):b.Z.t("live.live"),D=function(P){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"milliseconds",C=g().duration(P,y),p=C.hours(),B=C.minutes(),c=C.seconds();return g()({h:p,m:B,s:c}).format("HH:mm:ss")}},60333:function(gt,Se,e){"use strict";e.d(Se,{Bj:function(){return b},yF:function(){return a},wY:function(){return o},lH:function(){return D},hF:function(){return K},k3:function(){return y},jG:function(){return C},xR:function(){return p},Eq:function(){return B},Dr:function(){return I},IR:function(){return M},c3:function(){return v},$m:function(){return d},Ff:function(){return l},$e:function(){return t},ts:function(){return h},nv:function(){return F},wE:function(){return m},NH:function(){return E},lq:function(){return Q},dk:function(){return S},uA:function(){return x},Hn:function(){return U},u0:function(){return L},_u:function(){return w},K6:function(){return ie},kG:function(){return Ne}});var O=e(37055),g=e(10237);function b(ue){var _e=O.ZP.DdLive.createDdLive();return g.WY.post({url:_e,data:ue})}function a(ue){var _e=O.ZP.DdLive.editDdLive();return g.WY.post({url:_e,data:ue})}function T(ue){var _e=CONFIG.DdLive.deleteLive();return request.post({url:_e,data:ue})}function o(ue){var _e=O.ZP.DdLive.deleteMeeting();return g.WY.put({url:_e,data:ue})}function D(ue){var _e=O.ZP.DdLive.getSelectRecordList();return g.WY.get({url:_e,params:ue})}function K(ue){var _e=O.ZP.DdLive.getLecturerInfo(ue);return g.WY.get({url:_e})}function P(ue){var _e=CONFIG.DdLive.getUserCheckLimit();return request.post({url:_e,data:ue})}function y(ue){var _e=O.ZP.DdLive.getLiveList();return g.WY.get({url:_e,params:ue})}function C(ue){var _e=O.ZP.DdLive.getLiveDetail();return g.WY.get({url:_e,params:ue})}function p(ue){var _e=O.ZP.Live.liveRoomConfig();return g.WY.get({url:_e,params:ue})}function B(ue){var _e=O.ZP.DdLive.liveCourseExport();return g.WY.get({url:_e,params:ue})}function c(ue){var _e=CONFIG.live.exportWatchInfo();return request.get({url:_e,params:ue})}function I(ue){var _e=O.ZP.DdLive.checkDingAnchorInfo();return g.WY.get({url:_e,params:ue})}function M(ue){var _e=O.ZP.DdLive.checkCourseAnchor();return g.WY.get({url:_e,params:ue})}function v(ue){var _e=O.ZP.DdLive.getLiveWatchList();return g.WY.get({url:_e,params:ue})}function A(ue){var _e=CONFIG.DdLive.getMeetingWatchList();return request.get({url:_e,params:ue})}function d(ue){var _e=ue.projectId,Ze=ue.courseId,j=ue.keyword,R=ue.pageSize,le=ue.pageNum,H=O.ZP.DdLive.getLiveWatchListProject({projectId:_e,courseId:Ze});return g.WY.get({url:H,params:{keyword:j,pageSize:R,pageNum:le}})}function l(ue){var _e=O.ZP.CourseManageList.setBatchEmployee();return g.WY.post({url:_e,data:ue})}function t(ue){var _e=O.ZP.CourseManageList.setClassify();return g.qg.post({url:_e,data:ue})}function h(ue){var _e=O.ZP.CourseManageList.setScore();return g.qg.post({url:_e,data:ue})}function F(ue){var _e=O.ZP.CourseManageList.syncCourse();return g.qg.post({url:_e,data:ue})}function m(ue,_e){var Ze=O.ZP.CourseManageList.setTop(),j=O.ZP.CourseManageList.removeTop(),R=ue?Ze:j;return g.qg.post({url:R,data:_e})}function E(ue){var _e=O.ZP.Personal.courseReleaseOrNot(ue.courseId);return g.qg.post({url:_e,data:ue})}function Q(ue){var _e=O.ZP.Courses.getScoreApi();return g.WY.get({url:_e,params:ue})}function G(ue){var _e=CONFIG.Live.addLiveRoom();return request.post({url:_e,data:ue})}function V(ue){var _e=CONFIG.Live.getLiveRoomsList();return request.get({url:_e,params:ue})}function z(ue){var _e=CONFIG.Live.getLiveLink(ue);return request.get({url:_e})}function $(ue){var _e=CONFIG.Live.deleteLiveRoom(ue);return request.post({url:_e})}function W(ue){var _e=CONFIG.ContactCustomerService.joinGroup(ue);return request.get({url:_e,params:{type:"login"}})}function S(ue){var _e=ue.courseId,Ze=ue.user_name,j=ue.password,R=ue.enterpriseId,le=O.ZP.Live.getLiveCourseViewLinkNoToken({enterpriseId:R,courseId:_e});return g.WY.get({url:le,params:{user_name:Ze,password:j}})}function x(ue){var _e=O.ZP.Live.getLiveCourseViewLink(ue);return g.WY.get({url:_e})}function U(ue){var _e=ue.courseId,Ze=ue.password,j=ue.enterpriseId,R=O.ZP.Live.getLiveCourseBroadcastLinkNoToken(_e,j);return g.WY.get({url:R,params:{courseId:_e,password:Ze}})}function L(ue){var _e=O.ZP.Live.getLiveCourseBroadcastLink(ue);return g.WY.get({url:_e})}function w(ue){var _e=O.ZP.DdLive.getLiveListProject();return g.WY.get({url:_e,params:ue})}function k(ue){var _e=CONFIG.DdLive.createMeeting();return request.post({url:_e,data:ue})}function ne(ue){var _e=CONFIG.DdLive.editMeeting();return request.put({url:_e,data:ue})}function ie(ue){var _e=O.ZP.DdLive.startMeeting(ue);return g.WY.get({url:_e,params:ue})}function Ne(ue){var _e=O.ZP.DdLive.checkMeetCourseAnchor(ue);return g.WY.get({url:_e,params:ue})}},50053:function(gt,Se,e){"use strict";e.d(Se,{eS:function(){return T},V5:function(){return D},k_:function(){return K}});var O=e(6793),g=e(3407),b=(0,O.me)(),a=g.Z[b].questionn.validation,T=P=>{var y=P,C,p=/^[0-9a-zA-Z\u4e00-\u9fa5\(\)]+$/;return y?y.length>30?C=a.investigateDetailNameLimit:p.test(y)||(C=a.investigateSpecialSign):C=a.investigateDetailNameNull,C},o=P=>P.id?"":a.investigateDetailSelectNull,D=(P,y)=>{var C;return y.termType===2&&(!P.startTime||!P.endTime)&&(C=a.investigateDetailValidityNull),C},K=P=>{var y;return P.product_id||(y=g.Z[b].evaluationManage.selectEvaluateTools),y}},79096:function(gt,Se,e){"use strict";var O=e(62029),g=e(12924),b=e.n(g),a=e(91768),T=e(80991),o=e(18329),D=e(62615),K=e(52670),P=e(34773),y=e(7584),C=e(2396),p={labelCol:{xs:{span:4},sm:{span:4}},wrapperCol:{xs:{span:12},sm:{span:12}}};class B extends b().Component{constructor(){super(...arguments);this.initRefFormik=I=>{this._refFormik=I},this.handleBeforeCreate=()=>{var I=this._refFormik;I.submitForm(),I.runValidations().then(M=>{if(!Object.keys(M).length){var v=I.state.values,A=v.employeeRange,d=v.title,l=(0,P.b)(A.rangeList),t={name:d,visibleRange:A.rangeType===1?"all":A.rangeType===2?"part":"mySelf",groupIds:A.rangeType===2?l.groupIds.join(","):"",departmentIds:A.rangeType===2?l.deptIds.join(","):"",userIds:A.rangeType===2?l.userIds.join(","):"",postIds:A.rangeType===2?l.postIds.join(","):"",qy_we_chat_vo:A.qyWeChatVo};this.props.onCreate(t)}})},this.handleBeforeCancel=()=>{var I=this.props.onCancel;I()}}render(){var I=this.props,M=I.t,v=I.visible,A=I.canSetVisible,d=I.initialParams;return b().createElement(o.ZP,{visible:v,title:M("resourceLibrary.newFolder"),onCancel:this.handleBeforeCancel,onOk:this.handleBeforeCreate},v?b().createElement("div",{className:"add-folder-modal"},b().createElement(T.J9,{ref:this.initRefFormik,initialValues:d,onSubmit:this.submit,render:l=>b().createElement(T.l0,{className:"cl-form"},b().createElement(T.gN,(0,O.Z)({name:"title",label:M("resourceLibrary.folderName"),required:!0,maxLength:60,placeholder:M("upload.folderNamePlaceholder"),validate:t=>(0,C.QK)(t,M("resourceLibrary.validationNewFolder")),component:y.Z,type:"text"},p)),A?b().createElement(T.gN,{component:D.ww,displayType:"Custom",name:"employeeRange",defaultFieldList:l.values.employeeRange,secTitle:M("authentication.abilityDetailSecAssignTitle"),validate:K.FI,mode:["all","part","private"],orgProps:{title:M("component.chooseVisibleScope")},onlyChooseDept:!0,onlyCreateUser:!0,qwTicketShow:!0}):null,b().createElement(D.I,null))})):null)}}Se.Z=(0,a.Z)()(B)},63521:function(gt,Se,e){"use strict";var O=e(71194),g=e(57016),b=e(62029),a=e(34792),T=e(48086),o=e(57361),D=e(9715),K=e(86585),P=e(33565),y=e(43358),C=e(34041),p=e(9754),B=e.n(p),c=e(12924),I=e.n(c),M=e(91768),v=e(35428),A=e(30565),d=e.n(A),l=e(2396),t=C.Z.Option,h=F=>{var m=F.t,E=F.group_id,Q=F.visible,G=Q===void 0?!1:Q,V=F.onCancel,z=F.enable,$=z===void 0?!1:z,W=K.Z.useForm(),S=(0,P.Z)(W,1),x=S[0],U=(0,c.useState)(!1),L=(0,P.Z)(U,2),w=L[0],k=L[1],ne=(0,c.useState)([]),ie=(0,P.Z)(ne,2),Ne=ie[0],ue=ie[1],_e=(0,c.useState)({}),Ze=(0,P.Z)(_e,2),j=Ze[0],R=Ze[1],le=(0,c.useState)(void 0),H=(0,P.Z)(le,2),X=H[0],ce=H[1];(0,c.useEffect)(()=>{Te()},[]),(0,c.useEffect)(()=>{G?x.setFieldsValue({group_id:E||void 0}):x.resetFields()},[x,G,E]);var Te=()=>{(0,v.iJ)($).then(be=>{be.success==="true"&&ue(be.data||[])})},Le=function(){var be=(0,o.Z)(B().mark(function Ve(Ae){var at,et,ut;return B().wrap(function(Oe){for(;;)switch(Oe.prev=Oe.next){case 0:return k(!0),Oe.next=3,(0,v.pM)({group_id:Ae.group_id,tag_names:Ae.tag_names});case 3:at=Oe.sent,et=at.data,ut=at.success,k(!1),ut==="true"&&(et.exists_tag_names&&et.exists_tag_names.length>0?T.default.success(m("tagManage.createSuccess",{num:et.exists_tag_names.length})):T.default.success(m("personnelDevelope.createSuccess")),V(Ae.group_id));case 8:case"end":return Oe.stop()}},Ve)}));return function(Ae){return be.apply(this,arguments)}}(),he=be=>{ce(be.slice(0,30))},Ee=be=>{ce(void 0),be&&be.length>0&&be[be.length-1].length>0?(x.setFieldsValue({tag_names:be}),R({})):x.setFieldsValue({tag_names:be.slice(0,-1)})},ve=(be,Ve)=>{var Ae=!1,at=new RegExp(l.fA.tagName);return Ve.forEach(et=>{at.test(et)&&(Ae=!0)}),Ae?Promise.reject(m("tagManage.tagValidMessage")):Promise.resolve()};return I().createElement(c.Fragment,null,I().createElement(g.Z,{title:m("tagManage.add"),visible:G,destroyOnClose:!0,width:620,onOk:()=>{x.validateFields().then(be=>{Le(be)})},confirmLoading:w,onCancel:()=>V(),className:d().addTagModal},I().createElement(K.Z,{form:x,colon:!1,preserve:!1,initialValues:{group_id:E||void 0}},I().createElement(K.Z.Item,(0,b.Z)({name:"tag_names",label:m("tagManage.tags")},j,{validateFirst:!0,rules:[{required:!0,message:m("common.requiredNotBlank"),type:"array"},{validator:ve}]}),I().createElement(C.Z,{className:d().selectTag,mode:"tags",placeholder:m("tagManage.placeholderTag2"),onSearch:he,onChange:Ee,maxTagCount:100,maxTagPlaceholder:m("tagManage.addTagsLimit"),maxTagTextLength:30,open:!1,optionFilterProp:"label",searchValue:X})),I().createElement(K.Z.Item,{name:"group_id",label:m("tagManage.group"),rules:[{required:!0,message:m("common.requiredNotBlank")}]},I().createElement(C.Z,{showSearch:!0,placeholder:m("tagManage.selectTagGroups"),filterOption:(be,Ve)=>Ve.children.toLowerCase().indexOf(be.toLowerCase())>=0},Ne.map(be=>I().createElement(t,{key:be.id,value:be.id},be.group_name)))))))};Se.Z=(0,M.Z)()(h)},21046:function(gt,Se,e){"use strict";e.d(Se,{kX:function(){return La},t9:function(){return ga},oK:function(){return Za},q2:function(){return Ds},NP:function(){return Ga},EG:function(){return ke},K5:function(){return us}});var O=e(88983),g=e(47933),b=e(12924),a=e.n(b),T=e(91768),o=e(80991);class D extends a().Component{constructor(){super(...arguments);this.handleChange=De=>{this.props.formik.setFieldValue("termType",De.target.value)}}render(){var De=this.props,oe=De.defaultFieldList,xe=De.t;return a().createElement(g.ZP.Group,{value:oe,onChange:this.handleChange},a().createElement(g.ZP,{value:1},xe("questionn.investigateDetailPermanent")),a().createElement(g.ZP,{value:2},xe("questionn.investigateDetailCustom")))}}D.defaultProps={prefixCls:"termtype"};var K=(0,o.$j)((0,T.Z)()(D)),P=e(62029),y=e(57663),C=e(71577),p=e(88986),B=e(49111),c=e(19650),I=e(34792),M=e(48086),v=e(71194),A=e(57016),d=e(57361),l=e(35556),t=e(27220),h=e(9754),F=e.n(h),m=e(37055),E=e(10237);function Q(Ue){var De=Ue.evaluation_rule_result_vo,oe=Ue.user_ids,xe=m.ZP.personnelDevelope.getAssessorUser(),me={evaluation_rule_result_vo:De,user_ids:oe};return E.WY.post({url:xe,data:me})}function G(Ue){var De=Ue.title,oe=Ue.product_id,xe=Ue.term_type,me=Ue.start_time,ye=Ue.end_time,We=Ue.open_result,ze=Ue.supervisor_Id,qe=Ue.source,Tt=Ue.user_ids,Ct=Ue.department_ids,Vt=Ue.group_ids,ht=Ue.post_ids,re=Ue.authority_range,fe=Ue.status,pe=Ue.model_id,ee=Ue.finish_promote,ge=Ue.certificate_id,Me=Ue.is_get_score,Ke=Ue.finish_score,ct=Ue.evaluation_tool_type,pt=Ue.evaluation_way_self,_t=Ue.evaluation_way_superior,At=Ue.evaluation_rule_result_vo,Gt=Ue.personnel_echo_request_list,Ia=m.ZP.PostTalentEvaluation.checkSave();return E.WY.post({url:Ia,data:{title:De,product_id:oe,term_type:xe,start_time:me,end_time:ye,open_result:We,supervisor_Id:ze,source:qe,user_ids:Tt,department_ids:Ct,group_ids:Vt,post_ids:ht,authority_range:re,status:fe,model_id:pe,finish_promote:ee,certificate_id:ge,is_get_score:Me,study_score:{finish_score:Ke},evaluation_tool_type:ct,evaluation_way_self:pt,evaluation_way_superior:_t,evaluation_rule_result_vo:At,personnel_echo_request_list:Gt}})}var V=e(77883),z=e(21888),$=e(22385),W=e(31097),S=e(63185),x=e(9676),U=e(9715),L=e(86585),w=e(1870),k=e(78001),ne=e(6793),ie=L.Z.Item;class Ne extends a().Component{constructor(De){super(De);this.handleCheckChange=(oe,xe)=>{var me=this.props.result;me[xe].checked=oe.target.checked;var ye=me.reduce((ze,qe)=>qe.checked?ze+1:ze,0),We=0;me.forEach(ze=>{ze.checked&&(We+=1,We===3&&ye===3?ze.weight=Number((100/ye).toFixed(0))+1:ze.weight=Number((100/ye).toFixed(0)))}),this.transferFormat(me)},this.weightChange=(oe,xe)=>{var me=this.props.result;me[xe].weight=oe||0,this.transferFormat(me)},this.evalutionChange=(oe,xe)=>{var me=this.props.result;me[xe].detail.need_all=oe.target.value,this.transferFormat(me)},this.evalutionNumChange=(oe,xe)=>{var me=this.props.result;me[xe].detail.user_num=oe||1,this.transferFormat(me)},this.transferFormat=oe=>{this.props.formik.setFieldValue("evaluation_rule_result_vo",oe.reduce((xe,me)=>(xe["evaluation_way_".concat(me.name)]=me.checked,xe["".concat(me.name,"_weight")]=me.weight,xe["".concat(me.name,"_details")]=me.detail,xe),{}))},this.renderSettingText=oe=>{var xe=(0,ne.me)(),me=this.props.t,ye="",We="";switch(oe.name){case"superior":ye=me("personnelDevelope.superior");break;case"subordinate":ye=me("personnelDevelope.subordinate");break;case"same_level":ye=me("personnelDevelope.sameLevel");break;default:break}return xe==="en_us"?We=k.Z.t("personnelDevelope.allLevelEvaluationTip"):We=k.Z.t("personnelDevelope.levelEvaluationTip",{name:ye}),We},this.state={}}componentDidMount(){}render(){var De=this.props,oe=De.prefixCls,xe=De.result,me=De.isEdit,ye=De.t,We=De.isCopy,ze=()=>{var qe=!0,Tt=xe.filter(Ct=>Ct.checked);return(Tt.length===0||Tt.length===1&&Tt[0].name==="self")&&(qe=!1),qe};return a().createElement("div",{className:"".concat(oe,"_content")},a().createElement("div",{className:"".concat(oe,"_content_group")},xe.map((qe,Tt)=>a().createElement(x.Z,{key:qe.name,checked:qe.checked,disabled:me&&!Boolean(We),onChange:Ct=>{this.handleCheckChange(Ct,Tt)}},qe.label)),a().createElement(W.Z,{placement:"top",title:ye("personnelDevelope.superiorEvaluationTip")},a().createElement("span",null,a().createElement(w.Z,null)))),a().createElement(ie,{label:ye("evaluation.theWeighting"),required:!0}),a().createElement("div",{className:"".concat(oe,"_content_item")},a().createElement(c.Z,null,xe.map((qe,Tt)=>qe.checked&&a().createElement("div",{key:qe.name},qe.label," ",a().createElement(z.Z,{disabled:me&&!Boolean(We),min:0,max:100,value:qe.weight,onChange:Ct=>{this.weightChange(Ct,Tt)}}))))),ze()&&a().createElement(a().Fragment,null,a().createElement(ie,{label:a().createElement("div",null,ye("evaluation.evaluateStafSettings"),a().createElement(W.Z,{title:ye("evaluation.evaluateStafTip")},a().createElement(w.Z,null))),required:!0}),a().createElement("div",{className:"".concat(oe,"_content_people_set")},xe.map((qe,Tt)=>qe.checked&&qe.name!=="self"&&a().createElement("div",{key:qe.name,className:"".concat(oe,"_content_people_set_item")},a().createElement(g.ZP.Group,{value:qe.detail.need_all,disabled:me&&!Boolean(We),onChange:Ct=>{this.evalutionChange(Ct,Tt)}},a().createElement(g.ZP,{value:0},qe.label,a().createElement("span",{className:"".concat(oe,"_content_people_set-input")},a().createElement(z.Z,{disabled:me&&!Boolean(We),min:1,max:20,value:qe.detail.user_num,onChange:Ct=>{this.evalutionNumChange(Ct,Tt)}})),ye("evaluation.peopleEvaluate")),a().createElement(g.ZP,{value:1},this.renderSettingText(qe))))))))}}Ne.defaultProps={prefixCls:"selectSetChild"};var ue=(0,o.$j)((0,T.Z)()(Ne)),_e=e(54549),Ze=e(49101),j=e(88311),R=L.Z.Item;class le extends a().Component{constructor(De){super(De);this.onOk=oe=>{var xe=this.props.formik.values.employeeRange;xe.rangeList.user=[...xe.rangeList.user.filter(me=>me.reserve&&me),...oe.user],xe.rangeType=2,this.props.formik.setFieldValue("employeeRange",xe),this.onCancel()},this.onCancel=()=>{this.setState({orgModalConfig:(0,p.Z)((0,p.Z)({},this.state.orgModalConfig),{},{visible:!1})})},this.deletePeople=oe=>{var xe=this.props.formik.values.employeeRange;xe.rangeList.user.splice(oe,1),this.props.formik.setFieldValue("employeeRange",xe)},this.handleOpenOrgDialog=()=>{this.setState({orgModalConfig:(0,p.Z)((0,p.Z)({},this.state.orgModalConfig),{},{visible:!0})})},this.state={orgModalConfig:{beyondLimitTip:De.t("evaluation.maxPeople"),visible:!1,title:De.t("evaluation.selectPeople"),onlyUser:!0,displayType:["post",""],onOk:this.onOk,onCancel:this.onCancel}}}render(){var De=this.props,oe=De.prefixCls,xe=De.t,me=De.formik.values.employeeRange,ye=me.rangeList,We=me.rangeList.user,ze=this.state.orgModalConfig;return a().createElement("div",{className:"".concat(oe,"_content")},a().createElement("div",{className:"".concat(oe,"_content_step2")},a().createElement(R,{label:xe("evaluation.assessee"),required:!0}),a().createElement("div",{className:"".concat(oe,"_content_step2-people")},We.map((qe,Tt)=>a().createElement("div",{key:qe.id,className:"".concat(oe,"_content_step2-people-item")},a().createElement("span",{className:"".concat(oe,"_content_step2-people-item-desc")},qe.name),!qe.reserve&&a().createElement(_e.Z,{onClick:()=>{this.deletePeople(Tt)}}))),a().createElement(C.Z,{icon:a().createElement(Ze.Z,null),onClick:this.handleOpenOrgDialog,className:"".concat(oe,"_content_step2-people-add")},xe("personnelDevelope.addedSubCategory")))),a().createElement(j.Z,(0,P.Z)({},ze,{initData:ye})))}}le.defaultProps={prefixCls:"selectSetChild"};var H=(0,o.$j)((0,T.Z)()(le)),X=e(36202);class ce extends a().Component{constructor(De){super(De);this.onOrgDialogCancel=()=>{this.setState({orgModalConfig:(0,p.Z)((0,p.Z)({},this.state.orgModalConfig),{},{visible:!1})})},this.onOrgDialogOk=oe=>{var xe=this.props,me=xe.list,ye=xe.setEvaluationPlanList,We=this.state,ze=We.currentIndex,qe=We.startIndex;me[ze].personnel_echo_user_list[qe].assessor_users=[...me[ze].personnel_echo_user_list[qe].assessor_users.filter(Tt=>Tt.reserve&&Tt),...oe.user],ye(me),this.onOrgDialogCancel()},this.handleOrgDialog=(oe,xe,me)=>{var ye=this.props.list;this.setState({orgModalConfig:(0,p.Z)((0,p.Z)({},this.state.orgModalConfig),{},{initData:{user:ye[xe].personnel_echo_user_list[me].assessor_users}})},()=>{this.setState({orgModalConfig:(0,p.Z)((0,p.Z)({},this.state.orgModalConfig),{},{visible:!0}),currentIndex:xe,startIndex:me})})},this.handleDeleteEvaluator=(oe,xe,me)=>{var ye=this.props,We=ye.list,ze=ye.setEvaluationPlanList;We[xe].personnel_echo_user_list[me].assessor_users.splice(oe,1),ze(We)},this.selectChange=oe=>{this.props.oneHeaderTitleChange(oe)},this.assessmentDimensions=()=>a().createElement("div",{className:"selectSetChild_content_step3_dimensions"},this.state.optionsWithDisabled.map(oe=>a().createElement("div",{className:"selectSetChild_content_step3_dimensions-item",key:oe.value},oe.label))),this.evaluator=(oe,xe)=>a().createElement("div",{className:"selectSetChild_content_step3_evaluator"},oe.personnel_echo_user_list.map((me,ye)=>a().createElement("div",{className:"selectSetChild_content_step3_evaluator-box",key:me.type},this.renderEvaluator(me,xe,ye)))),this.renderEvaluator=(oe,xe,me)=>{var ye=oe.assessor_users,We={self:this.props.t("evaluation.employeesMyself"),superior:this.props.t("personnelDevelope.evaluationSuperior"),sameLevel:this.props.t("evaluation.sameLevel"),subordinate:this.props.t("evaluation.subordinate")};return a().createElement("div",{className:"selectSetChild_content_step3_renderEvaluator"},ye.map((ze,qe)=>a().createElement("div",{className:"selectSetChild_content_step3_renderEvaluator-item",key:qe.toString()},ze.name,oe.type!=="self"&&!ze.reserve&&a().createElement("span",{onClick:()=>{this.handleDeleteEvaluator(qe,xe,me)},className:"selectSetChild_content_step3_renderEvaluator-item-delete"},a().createElement(_e.Z,null)))),oe.type==="self"?oe.name:a().createElement(C.Z,{disabled:ye.length>=20,className:"selectSetChild_content_step3_renderEvaluator-add",onClick:()=>this.handleOrgDialog(oe,xe,me),size:"small",icon:a().createElement(Ze.Z,null)},this.props.t("personnelDevelope.addedSubCategory")),a().createElement("div",{className:"selectSetChild_content_step3_renderEvaluator-type"},We[oe.type],oe.type==="superior"&&a().createElement(W.Z,{title:this.props.t("evaluation.superiorTip")},a().createElement("span",{className:"selectSetChild_content_step3_renderEvaluator-type-tip"},a().createElement(w.Z,null)))))},this.state={optionsWithDisabled:[{label:De.t("evaluation.employeesMyself"),value:"myself"},{label:De.t("evaluation.heReview"),value:"superior"},{label:De.t("evaluation.subordinate"),value:"subordinate"},{label:De.t("evaluation.sameLevel"),value:"lateral"}],orgModalConfig:{maxUserCount:20,beyondLimitTip:De.t("evaluation.maxPeople"),initData:{},visible:!1,title:De.t("evaluation.selectEaluationPeople"),onlyUser:!0,displayType:["post",""],onOk:this.onOrgDialogOk,onCancel:this.onOrgDialogCancel},currentIndex:"",startIndex:""}}render(){var De=this.props,oe=De.list,xe=oe===void 0?[]:oe,me=De.loading,ye=De.rowSelection,We=De.headerTitle,ze=De.t,qe=this.state.orgModalConfig,Tt=[{title:ze("evaluation.assessee"),dataIndex:"name",width:80},{title:ze("learnRecord.department"),dataIndex:"dept_name",width:90,render:Ct=>a().createElement(W.Z,{title:Ct},a().createElement("div",{className:"selectSetChild_content_step3-ellipsis selectSetChild_content_step3-postname"},Ct))},{title:ze("learnRecord.post"),dataIndex:"post_name",width:90,render:Ct=>a().createElement(W.Z,{title:Ct},a().createElement("div",{className:"selectSetChild_content_step3-ellipsis selectSetChild_content_step3-postname"},Ct))},{title:ze("evaluation.assessmentDimensions"),dataIndex:"update_time",width:100,render:()=>""},{title:()=>a().createElement("div",null,ze("tutorial.evaluator"),a().createElement(W.Z,{title:ze("evaluation.multipleEvaluatorsTip")},a().createElement(w.Z,null))),dataIndex:"ziping",width:260,render:(Ct,Vt,ht)=>this.evaluator(Vt,ht)}];return a().createElement("section",null,a().createElement("div",null,a().createElement(X.f,{columns:Tt,dataSource:xe,bordered:!0,headerTitle:We,loading:me,rowSelection:ye,tableUUID:"c3655e99-f5e8-45a8-97b6-45e79ef61dcf",scroll:{x:"max-content",y:"100%"}})),a().createElement(j.Z,qe))}}var Te=(0,T.Z)()(ce);class Le extends a().Component{constructor(De){super(De);this.onOrgDialogCancel=()=>{this.setState({orgModalConfig:(0,p.Z)((0,p.Z)({},this.state.orgModalConfig),{},{visible:!1})})},this.onOrgDialogOk=oe=>{oe.user.length===0&&M.default.error(this.props.t("evaluation.selectPeople"));var xe=this.state,me=xe.selectedRowKeys,ye=xe.type,We=this.props.formik.values.personnel_echo_request_list;We.forEach(ze=>{me.forEach(qe=>{ze.id===qe&&ze.personnel_echo_user_list.forEach(Tt=>{if(Tt.type===ye){var Ct=[...Tt.assessor_users,...oe.user].reduce((Vt,ht)=>Vt.some(re=>re.id===ht.id)?Vt:[...Vt,ht],[]);Tt.assessor_users=Ct}})})}),this.props.formik.setFieldValue("personnel_echo_request_list",We),this.onOrgDialogCancel()},this.handleOrgDialog=oe=>{this.setState({orgModalConfig:(0,p.Z)((0,p.Z)({},this.state.orgModalConfig),{},{visible:!0}),type:oe})},this.setSelectedRowKeys=oe=>{this.setState({selectedRowKeys:oe})},this.headerTitle=()=>{var oe=this.state.selectedRowKeys,xe=this.props,me=xe.t,ye=xe.isEdit,We=this.props.formik.values.evaluation_rule_result_vo,ze=We.evaluation_way_superior,qe=We.evaluation_way_same_level,Tt=We.evaluation_way_subordinate,Ct=Vt=>{var ht=!0;return ye&&Vt!=="true"&&(ht=!1),!ye&&!Vt&&(ht=!1),ht};return a().createElement("div",null,a().createElement(c.Z,null,Ct(ze)&&a().createElement(C.Z,{type:"primary",onClick:()=>{this.handleOrgDialog("superior")},disabled:!oe.length,size:"small"},me("evaluation.chooseSuperior")),Ct(qe)&&a().createElement(C.Z,{type:"primary",onClick:()=>{this.handleOrgDialog("sameLevel")},disabled:!oe.length,size:"small"},me("evaluation.selectPeers")),Ct(Tt)&&a().createElement(C.Z,{type:"primary",onClick:()=>{this.handleOrgDialog("subordinate")},disabled:!oe.length,size:"small"},me("evaluation.selectLower"))))},this.setEvaluationPlanList=oe=>{this.props.formik.setFieldValue("personnel_echo_request_list",oe)},this.state={tableLoading:!1,orgModalConfig:{maxUserCount:20,beyondLimitTip:De.t("evaluation.maxPeople"),visible:!1,title:De.t("evaluation.selectEaluationPeople"),onlyUser:!0,displayType:["post",""],onOk:this.onOrgDialogOk,onCancel:this.onOrgDialogCancel},selectedRowKeys:[],type:""}}render(){var De=this.props,oe=De.prefixCls,xe=De.formik.values,me=xe.personnel_echo_request_list,ye=xe.evaluation_rule_result_vo.self_weight,We=this.state,ze=We.tableLoading,qe=We.orgModalConfig,Tt={hideSelectAll:ye===100,onChange:Ct=>{this.setSelectedRowKeys(Ct)}};return a().createElement("div",{className:"".concat(oe,"_content")},a().createElement("div",{className:"".concat(oe,"_content_step3")},a().createElement(Te,{loading:ze,toolBarRender:!1,headerTitle:this.headerTitle(),list:me,scroll:{y:"100%",x:"max-content"},rowSelection:Tt,setEvaluationPlanList:this.setEvaluationPlanList})),a().createElement(j.Z,qe))}}Le.defaultProps={prefixCls:"selectSetChild"};var he=(0,o.$j)((0,T.Z)()(Le)),Ee=e(18329),ve=t.Z.Step;class be extends a().Component{constructor(De){var oe;super(De);oe=this,this.handleChange=xe=>{this.props.formik.setFieldValue("selectSet",xe.target.value)},this.setEvaluation=xe=>{this.setState({result:(0,p.Z)((0,p.Z)({},this.state.result),{},{evaluation:xe})},this.returnResetInfo())},this.setEvaluationPlanList=(xe,me)=>{var ye=this.props.values.personnel_echo_request_list;me==="add"&&this.setState(this.props.formik.setFieldValue("personnel_echo_request_list",xe)),me==="edit"&&this.setState(this.props.formik.setFieldValue("personnel_echo_request_list",[...ye,...xe])),me==="copy"&&(ye.map(We=>{xe.map(ze=>{if(We.id==ze.id){var qe=We.personnel_echo_user_list.filter(Vt=>ze.personnel_echo_user_list.some(ht=>ht.type===Vt.type)),Tt=[...qe,...ze.personnel_echo_user_list],Ct={};We.personnel_echo_user_list=Tt.reduce((Vt,ht)=>(Ct[ht.type]||(Ct[ht.type]=Vt.push(ht)),Vt),[])}})}),this.setState(this.props.formik.setFieldValue("personnel_echo_request_list",[...ye])))},this.copyResetInfo=()=>{var xe=this.props,me=xe.values,ye=me.evaluation_rule_result_vo,We=me.employeeRange,ze=xe.t;this.setState({copy_evaluation_rule_result_vo:JSON.parse(JSON.stringify(ye)),result:(0,p.Z)((0,p.Z)({},this.state.result),{},{employeeRange:JSON.parse(JSON.stringify(We)),evaluation_rule_result_vo:[{name:"self",checked:ye.evaluation_way_self.toString()==="true",weight:ye.self_weight,detail:{type:"self",user_num:1,need_all:0},label:ze("evaluation.employeesMyself")},{name:"subordinate",checked:ye.evaluation_way_subordinate.toString()==="true",weight:ye.subordinate_weight,detail:ye.subordinate_details,label:ze("evaluation.subordinate")},{name:"same_level",checked:ye.evaluation_way_same_level.toString()==="true",weight:ye.same_level_weight,detail:ye.same_level_details,label:ze("evaluation.sameLevel")},{name:"superior",checked:ye.evaluation_way_superior.toString()==="true",weight:ye.superior_weight,detail:ye.superior_details,label:ze("personnelDevelope.evaluationSuperior")}]})})},this.returnResetInfo=()=>{var xe=this.state.result.evaluation_rule_result_vo.reduce((me,ye)=>(me["evaluation_way_".concat(ye.name)]=ye.checked,me["".concat(ye.name,"_weight")]=ye.weight,me["".concat(ye.name,"_details")]=ye.detail,me),{});this.props.formik.setFieldValue("evaluation_rule_result_vo",xe)},this.handlePrevClick=()=>{this.setState({current:this.state.current-1})},this.handleNextClick=(0,d.Z)(F().mark(function xe(){var me,ye,We,ze,qe,Tt,Ct,Vt,ht,re,fe,pe,ee,ge,Me,Ke,ct,pt,_t,At,Gt;return F().wrap(function(Ba){for(;;)switch(Ba.prev=Ba.next){case 0:me=oe.state,ye=me.current,We=me.result,ze=oe.props,qe=ze.isEdit,Tt=ze.isCopy,Ct=ze.t,Vt=ze.prefixCls,ht=ze.formik.values,re=ht.personnel_echo_request_list,fe=ht.evaluationTools.product_id,pe=ht.employeeRange.rangeList.user,ee=!0,ge="",Me=We.evaluation_rule_result_vo.reduce((ia,da)=>da.checked?ia+1:ia,0),Ke=We.evaluation_rule_result_vo.reduce((ia,da)=>da.checked?ia+da.weight:ia,0),ye===0&&(Me||(ee=!1,ge=Ct("evaluation.selectTheEvaluationType")),Ke!==100&&(ee=!1,ge=Ct("evaluation.totalWeight"))),ye===1&&(pe.length===0?(ee=!1,ge="\u8BF7\u9009\u62E9\u88AB\u8BC4\u4F30\u4EBA"):(ct=We.evaluation_rule_result_vo.reduce((ia,da)=>(ia["evaluation_way_".concat(da.name)]=da.checked,ia["".concat(da.name,"_weight")]=da.weight,ia["".concat(da.name,"_details")]=da.detail,ia),{}),pt=oe.props.values.employeeRange.rangeList.user,_t=[],At=pt.filter(ia=>{var da=!0;return re.forEach(Es=>{Es.id===ia.id&&(_t.push(Es),da=!1)}),da}),oe.props.formik.setFieldValue("personnel_echo_request_list",_t),Boolean(Tt)&&_t.length>0&&Q({evaluation_rule_result_vo:ct,user_ids:_t.map(ia=>ia.id)}).then(ia=>{oe.setEvaluationPlanList(ia.data.data,"copy")}),qe&&At.length>0&&Q({evaluation_rule_result_vo:ct,user_ids:At.map(ia=>ia.id)}).then(ia=>{oe.setEvaluationPlanList(ia.data.data,"edit")}),qe||(JSON.stringify(We.employeeRange.rangeList.user)!==JSON.stringify(pt)||JSON.stringify(oe.state.copy_evaluation_rule_result_vo)!==JSON.stringify(oe.props.values.evaluation_rule_result_vo))&&Q({evaluation_rule_result_vo:ct,user_ids:pt.map(ia=>ia.id)}).then(ia=>{oe.setEvaluationPlanList(ia.data.data,"add")}))),ye===2&&(Gt=We.evaluation_rule_result_vo.reduce((ia,da)=>(ia["evaluation_way_".concat(da.name)]=da.checked,ia["".concat(da.name,"_weight")]=da.weight,ia["".concat(da.name,"_details")]=da.detail,ia),{}),G({evaluation_rule_result_vo:Gt,product_id:fe,personnel_echo_request_list:re,user_ids:pe.map(ia=>ia.id).join(",")}).then(ia=>{ia.data.data.pass==="true"?oe.props.onCancel("end"):A.Z.warning({title:Ct("common.tip"),content:a().createElement("div",{className:"".concat(Vt,"_content_err")},ia.data.data.result.map((da,Es)=>a().createElement("div",{key:Es.toString(),className:"".concat(Vt,"_content_err_msg")},da)))})})),ee?oe.setState({current:ye!==2?ye+1:ye}):M.default.error(ge);case 10:case"end":return Ba.stop()}},xe)})),this.state={current:0,result:{employeeRange:{},evaluation_rule_result_vo:[]},copy_evaluation_rule_result_vo:[]}}componentDidMount(){this.copyResetInfo()}render(){var De=this.props,oe=De.prefixCls,xe=De.isEdit,me=De.isCopy,ye=De.visible,We=De.t,ze=this.state,qe=ze.current,Tt=ze.result,Ct=[{title:We("evaluation.assessmentDimensions"),content:"First-content"},{title:We("evaluation.assessee"),content:"Second-content"},{title:We("evaluation.evaluationRelationship"),content:"Last-content"}];return a().createElement(Ee.ZP,{visible:ye,footer:null,size:"large",onCancel:()=>{this.props.onCancel("close")}},a().createElement("div",{className:"".concat(oe,"_content")},a().createElement("div",{className:"".concat(oe,"_content_step")},a().createElement(t.Z,{current:qe},Ct.map(Vt=>a().createElement(ve,{key:Vt.title,title:Vt.title})))),a().createElement("div",{className:"".concat(oe,"_content-stepbox")},qe===0&&a().createElement(ue,{setEvaluation:this.setEvaluation,isEdit:xe,isCopy:me,result:Tt.evaluation_rule_result_vo}),qe===1&&a().createElement(H,null),qe===2&&a().createElement(he,{isEdit:xe})),a().createElement("div",{className:"".concat(oe,"_content_buttons")},a().createElement(c.Z,null,a().createElement(C.Z,{type:"primary",onClick:this.handlePrevClick,disabled:qe===0},We("evaluation.prev")),a().createElement(C.Z,{type:"primary",onClick:this.handleNextClick},We(qe!==2?"evaluation.next":"common.completed"))))))}}be.defaultProps={prefixCls:"selectSet"};var Ve=(0,o.$j)((0,T.Z)()(be));class Ae extends a().Component{constructor(De){super(De);this.onCancel=oe=>{if(oe==="close"){var xe=this.state.copyInfo,me=xe.employeeRange,ye=xe.personnel_echo_request_list,We=xe.evaluation_rule_result_vo;this.props.formik.setFieldValue("employeeRange",me),this.props.formik.setFieldValue("personnel_echo_request_list",ye),this.props.formik.setFieldValue("evaluation_rule_result_vo",We)}this.setState({modalConfig:(0,p.Z)((0,p.Z)({},this.modalConfig),{},{visible:!1})})},this.openContent=()=>{var oe=this.props.values,xe=oe.employeeRange,me=oe.personnel_echo_request_list,ye=oe.evaluation_rule_result_vo;this.setState({copyInfo:JSON.parse(JSON.stringify({employeeRange:xe,personnel_echo_request_list:me,evaluation_rule_result_vo:ye})),modalConfig:(0,p.Z)((0,p.Z)({},this.modalConfig),{},{visible:!0})})},this.state={modalConfig:{visible:!1},copyInfo:{}}}render(){var De=this.state.modalConfig,oe=this.props,xe=oe.values.personnel_echo_request_list,me=oe.t;return a().createElement("div",null,a().createElement(C.Z,{shape:"round",onClick:this.openContent},xe.length>0?me("evaluationManage.configured"):me("evaluationManage.notConfigured")),De.visible&&a().createElement(Ve,(0,P.Z)({},this.props,De,{onCancel:this.onCancel})))}}Ae.defaultProps={prefixCls:"selectSet"};var at=(0,o.$j)((0,T.Z)()(Ae)),et=e(13062),ut=e(71230),q=e(89032),Oe=e(15746),Je=e(77576),je=e(59314);class Be extends a().Component{constructor(){super(...arguments);this.handleSwitch=De=>{this.props.formik.setFieldValue("openResult",De)}}render(){var De=this.props,oe=De.defaultFieldList,xe=De.t;return a().createElement("section",{className:"cl-form__secbox"},a().createElement("header",{className:"cl-form__secbox__header"},xe("evaluationManage.openReport")),a().createElement("div",{className:"cl-form__secbox__content"},a().createElement(ut.Z,null,a().createElement(Oe.Z,{span:24},a().createElement(je.Z,{checked:oe,onChange:this.handleSwitch}),a().createElement("span",{className:"infotext"},xe("evaluationManage.openReportTip"))))))}}var St=(0,o.$j)((0,T.Z)()(Be)),Lt=e(47673),Wt=e(4107),pa=e(20228),Xt=e(11382),Et=e(13254),Fe=e(14277),Pe=e(93485),Ie=e(18106),$e=e(88108),te=e(70596),ae=e.n(te),Re=e(56075),de=$e.Z.TabPane,we=Wt.Z.Search;class rt extends a().Component{constructor(De){super(De);this.onChangeRadio=oe=>{var xe=this.state,me=xe.tools,ye=xe.type,We=(0,Pe.Z)(me),ze;try{for(We.s();!(ze=We.n()).done;){var qe=ze.value;if(qe.id===oe.target.value){var Tt=ye==="tool"?{name:qe.product_name,product_id:qe.product_id,model_id:qe.model_id,type:ye,id:qe.id}:{name:qe.product_name,product_id:qe.id,model_id:qe.id,type:ye,id:qe.id};this.setState({checkObj:Tt,radioValue:oe.target.value}),this.renderCharts(qe,ye);break}}}catch(Ct){We.e(Ct)}finally{We.f()}},this.onTabChange=oe=>{this.setState({type:oe},()=>{this.initData()})},this.getEvaluateToolsApi=oe=>{var xe=this.state,me=xe.page,ye=xe.checkObj;this.setState({loading:!0}),(0,Re.lf)(me).then(We=>{this.setState({loading:!1});var ze=We.data.list;if(this.setState({tools:ze}),oe){var qe=(0,Pe.Z)(ze),Tt;try{for(qe.s();!(Tt=qe.n()).done;){var Ct=Tt.value;Ct.id===ye.id&&this.renderCharts(Ct,"tool")}}catch(Vt){qe.e(Vt)}finally{qe.f()}}})},this.getEvaluationModelApi=oe=>{var xe=this.state,me=xe.page,ye=xe.checkObj;this.setState({loading:!0}),(0,Re.jh)(me).then(We=>{this.setState({loading:!1});var ze=We.data.data.list;if(this.setState({tools:ze.map(Vt=>(0,p.Z)((0,p.Z)({},Vt),{},{product_name:Vt.model_name,id:Vt.id}))}),oe){var qe=(0,Pe.Z)(ze),Tt;try{for(qe.s();!(Tt=qe.n()).done;){var Ct=Tt.value;Ct.id===ye.id&&this.renderCharts(Ct,"model")}}catch(Vt){qe.e(Vt)}finally{qe.f()}}})},this.handleOk=()=>{this.props.onOk(this.state.checkObj)},this.handleCancel=()=>{this.props.onCancel()},this.renderFooter=()=>a().createElement(C.Z,{key:"submit",type:"primary",onClick:this.handleOk},this.props.t("common.submit")),this.initData=()=>{var oe=this.state.type;oe==="model"?this.setState({page:(0,p.Z)((0,p.Z)({},this.state.page),{},{model_type:"ability"})},()=>{this.getEvaluationModelApi()}):oe==="post"?this.setState({page:(0,p.Z)((0,p.Z)({},this.state.page),{},{model_type:"post"})},()=>{this.getEvaluationModelApi()}):this.getEvaluateToolsApi()},this.renderCharts=(oe,xe)=>{var me=[];xe==="model"||xe==="post"?me=oe.relation_abilities?oe.relation_abilities.split("\uFF0C").map(ye=>({ability_name:ye,dependency:"5"})):[]:oe.ability_dependencys_vos.length?me=oe.ability_dependencys_vos:me=oe.product_purpose.split("\uFF0C").map(ye=>({ability_name:ye,dependency:"5"})),this.showCharts(me)},this.showCharts=oe=>{var xe=this.props.t,me=[],ye=[],We=[...oe];We.length>10&&(We=We.slice(0,10)),We.forEach(Tt=>{me.push({text:Tt.ability_name,max:10}),ye.push(Tt.dependency)});var ze=ae().init(this.chart);if(this.chart&&me.length>0){var qe={title:{text:xe("evaluationManage.investigation"),textStyle:{color:"rgba(0, 0, 0, 0.25)",fontSize:12},x:10,y:10},tooltip:{trigger:"axis"},radar:{shape:"circle",splitArea:{show:!0,areaStyle:{color:["#fafafa"]}},name:{formatter:Tt=>(Tt=Tt.replace(/\S{11}/g,Ct=>"".concat(Ct,`
`)),Tt)},textStyle:{color:"#2D3040",overflow:"truncate",width:72},indicator:me,center:["50%","50%"],radius:55},series:[{type:"radar",areaStyle:{},data:[{value:ye}]}]};ze.setOption(qe),window.addEventListener("resize",()=>{ze.resize()})}else ze.clear()},this.getChart=oe=>{this.chart=oe},this.handleSearch=oe=>{var xe=this.state.page;this.setState({page:(0,p.Z)((0,p.Z)({},xe),{},{keyword:oe,key_word:oe})},()=>{this.initData()})},this.state={prefixCls:"measure_training_model",giveMarkModal:{title:De.t("evaluationManage.selectEvaluateTools"),mask:!0,onCancel:this.handleCancel},page:{page_number:1,page_size:1e4,keyword:"",key_word:"",model_type:"ability"},type:"model",tools:[],checkObj:{name:"",product_id:"",model_id:"",type:"model",id:""},radioValue:"",loading:!1}}UNSAFE_componentWillReceiveProps(De){De.visible!==this.props.visible&&De.visible&&this.setState({checkObj:De.checkObject,radioValue:De.checkObject.id,type:De.checkObject.type},()=>{if(!De.checkObject.id&&this.chart){var oe=ae().init(this.chart);oe.clear()}this.initData()})}render(){var De=this.state,oe=De.prefixCls,xe=De.giveMarkModal,me=De.type,ye=De.tools,We=De.radioValue,ze=De.loading,qe=this.props,Tt=qe.t,Ct=qe.visible,Vt=qe.checkObject.type;return a().createElement(Ee.ZP,(0,P.Z)({className:"".concat(oe)},xe,{visible:Ct,footer:this.renderFooter()}),a().createElement("div",{className:"".concat(oe,"__content")},a().createElement($e.Z,{activeKey:me,type:"card",onChange:this.onTabChange,size:"small"},Vt==="model"&&a().createElement(de,{tab:Tt("evaluation.evaluationModel"),key:"model"}),Vt==="post"&&a().createElement(de,{tab:Tt("evaluation.postModal"),key:"post"}),Vt==="tool"&&a().createElement(de,{tab:Tt("questionn.evaluationTool"),key:"tool"})),a().createElement("div",{className:"".concat(oe,"__content__search")},a().createElement(we,{onSearch:ht=>this.handleSearch(ht),placeholder:Tt("evaluation.searchByName")})),a().createElement("div",{className:"".concat(oe,"__content__center")},a().createElement("div",{className:"".concat(oe,"__content__center__left")},a().createElement(Xt.Z,{spinning:ze},ye.length>0?a().createElement(g.ZP.Group,{onChange:this.onChangeRadio,value:We},ye.map(ht=>a().createElement(g.ZP,{value:ht.id,key:ht.id},ht.product_name))):a().createElement(Fe.Z,{image:Fe.Z.PRESENTED_IMAGE_SIMPLE}))),a().createElement("div",{className:"".concat(oe,"__content__center__right"),ref:this.getChart}))))}}var mt=(0,T.Z)()(rt);class Zt extends a().Component{constructor(De){super(De);this.sureMode=oe=>{this.setState({showVisible:!1}),this.props.formik.setFieldValue("evaluationTools",{model_id:oe.model_id,product_id:oe.product_id,name:oe.name,type:oe.type,id:oe.id})},this.state={showVisible:!1}}render(){var De=this.state.showVisible,oe=this.props,xe=oe.t,me=oe.defaultFieldList,ye=me===void 0?{model_id:"",product_id:"",name:"",type:"",id:""}:me,We=oe.isEdit,ze=oe.isCopy;return a().createElement("div",{ref:this.tool,className:"evaluation_tools"},a().createElement(Wt.Z,{disabled:We&&!Boolean(ze),placeholder:xe("evaluation.pleaseEvaluation"),value:ye.name,readOnly:!0,onClick:()=>this.setState({showVisible:!0})}),a().createElement(mt,{checkObject:ye,visible:De,onOk:this.sureMode,onCancel:()=>this.setState({showVisible:!1})}))}}Zt.defaultProps={prefixCls:"evaluation-tools"};var bt=(0,o.$j)((0,T.Z)()(Zt)),Ft=e(43358),Ut=e(34041);class ca extends a().Component{constructor(De){super(De);this.getEvaluateToolsApi=oe=>{(0,Re.lf)(oe).then(xe=>{var me=xe.data.list;this.setState({tools:me})})},this.findProductName=(oe,xe)=>{var me=this.props.isEdit;if(me)return xe.product_name;var ye=null;if(oe.length===0)return ye;if(xe.model_id!==""){var We=oe.find(ze=>ze.model_id==xe.model_id&&ze.product_id==xe.product_id);ye=We?We.product_name:null}return ye},this.onSelect=oe=>{this.props.formik.setFieldValue("evaluationTools",{model_id:oe.model_id,product_id:oe.product_id})},this.getContain=()=>{var oe=this.props.from;return oe==="evaluation"?this.tool.current:document.body},this.state={tools:[],page:{page_number:1,page_size:1e3,keyword:""}},this.tool=(0,b.createRef)()}componentDidMount(){var De=this.state.page,oe=this.props.isEdit;oe||this.getEvaluateToolsApi(De)}render(){var De=this.state.tools,oe=this.props,xe=oe.t,me=oe.isEdit,ye=oe.defaultFieldList,We=ye===void 0?{model_id:"",product_id:"",product_name:""}:ye;return a().createElement("div",{ref:this.tool,className:"evaluation_tools"},a().createElement(Ut.Z,{showSearch:!0,disabled:me,onSelect:(ze,qe)=>this.onSelect(qe),value:this.findProductName(De,We),placeholder:xe("component.pleaseChoose"),getPopupContainer:this.getContain},De.map(ze=>a().createElement(Ut.Z.Option,{product_id:ze.product_id,model_id:ze.model_id,key:ze.product_name},ze.product_name))))}}ca.defaultProps={prefixCls:"evaluation-tools"};var Qt=(0,o.$j)((0,T.Z)()(ca));class Va extends b.Component{constructor(){super(...arguments);this.handleChecked=De=>{this.props.formik.setFieldValue("qualified",De.target.checked)}}render(){var De=this.props,oe=De.defaultFieldList,xe=De.t,me=De.isEdit,ye=De.isCopy;return a().createElement("section",{className:"cl-form__secbox"},a().createElement("header",{className:"cl-form__secbox__header"},xe("common.qualificationCriteria")),a().createElement("div",{className:"cl-form__secbox__content"},a().createElement(ut.Z,null,a().createElement(x.Z,{disabled:!0,checked:!0},xe("learning.completeEvaluationTask"))),a().createElement(ut.Z,null,a().createElement(x.Z,{disabled:me&&!Boolean(ye),checked:oe,onChange:this.handleChecked},xe("evaluationManage.checkCaseStudy")))))}}var Ra=(0,o.$j)((0,T.Z)()(Va)),Ua=e(93117);class ja extends b.Component{constructor(De){super(De);this.handleCheckReward=oe=>{var xe=this.props.formik.values.completeStand,me="";oe.target.checked&&(me=xe.reward.value),this.props.formik.setFieldValue("completeStand",(0,p.Z)((0,p.Z)({},xe),{},{reward:{checked:oe.target.checked,value:me}}))},this.handleCheckStandard=oe=>{var xe=this.props.formik.values.completeStand,me={id:"",name:""};oe.target.checked&&(me=xe.standard.certificate),this.props.formik.setFieldValue("completeStand",(0,p.Z)((0,p.Z)({},xe),{},{standard:{checked:oe.target.checked,certificate:me}}))},this.cancelSelectCertificate=()=>{var oe=this.state.certificateConfig;oe.visible=!1,this.setState({certificateConfig:oe})},this.sureSelectCertificate=oe=>{this.cancelSelectCertificate();var xe={};xe.id=oe[0].id,xe.name=oe[0].name;var me=this.props.formik.values.completeStand.standard;this.props.formik.setFieldValue("completeStand",(0,p.Z)((0,p.Z)({},this.props.defaultFieldList),{},{standard:(0,p.Z)((0,p.Z)({},me),{},{certificate:xe})}))},this.handleChangeReward=oe=>{var xe=this.props.formik.values.completeStand.reward;this.props.formik.setFieldValue("completeStand",(0,p.Z)((0,p.Z)({},this.props.defaultFieldList),{},{reward:(0,p.Z)((0,p.Z)({},xe),{},{value:oe})}))},this.showCertificate=()=>{var oe=this.state.certificateConfig;oe.visible=!0,this.setState({certificateConfig:oe})},this.state={certificateConfig:{visible:!1,defaultChecked:[],onCancel:this.cancelSelectCertificate,onOk:this.sureSelectCertificate}}}render(){var De=this.props,oe=De.defaultFieldList,xe=De.t,me=De.isEdit,ye=De.isCopy,We=this.state.certificateConfig;return a().createElement("section",{className:"cl-form__secbox"},a().createElement("header",{className:"cl-form__secbox__header"},xe("learning.learningAddSecRewardTitle")),a().createElement(Ua.Z,We),a().createElement("div",{className:"cl-form__secbox__content"},a().createElement(ut.Z,null,a().createElement(Oe.Z,{span:6},a().createElement(x.Z,{disabled:me&&!Boolean(ye),checked:oe.standard.checked,onChange:ze=>this.handleCheckStandard(ze)},xe("learning.learningAddReward"))),a().createElement(Oe.Z,{span:6,offset:1},a().createElement(Wt.Z,{disabled:!0,value:oe.standard.certificate.name})),a().createElement(Oe.Z,{span:4},a().createElement(C.Z,{disabled:me&&!Boolean(ye)||!oe.standard.checked,icon:a().createElement(Ze.Z,null),type:"link",onClick:this.showCertificate},xe("evaluationManage.addCertificate")))),a().createElement(ut.Z,null,a().createElement(Oe.Z,{span:6},a().createElement(x.Z,{disabled:me&&!Boolean(ye),checked:oe.reward.checked,onChange:ze=>this.handleCheckReward(ze)},xe("learning.learningAddRewardPassCredit"))),a().createElement(Oe.Z,{span:2,offset:1},a().createElement(z.Z,{disabled:me&&!Boolean(ye)||!oe.reward.checked,value:oe.reward.value,onChange:this.handleChangeReward})),a().createElement(Oe.Z,{span:14,offset:1},a().createElement("span",{className:"complete_tip"},xe("evaluationManage.rewardTip"))))))}}var ua=(0,o.$j)((0,T.Z)()(ja)),ts=e(68628);class as extends a().Component{constructor(){super(...arguments);this.handleChange=De=>{this.props.formik.setFieldValue("selectMode",De)}}render(){var De=this.props,oe=De.defaultFieldList,xe=De.t,me=De.isEdit,ye=[{label:xe("evaluation.employeesMyself"),value:"myself"},{label:a().createElement("span",null,xe("evaluation.heReview"),a().createElement(W.Z,{placement:"topLeft",title:xe("evaluation.heReviewTips"),arrowPointAtCenter:!0},a().createElement(ts.Z,{style:{marginLeft:10}}))),value:"superior"}];return a().createElement(x.Z.Group,{disabled:me,options:ye,value:oe,onChange:this.handleChange})}}as.defaultProps={prefixCls:"termtype"};var Fa=(0,o.$j)((0,T.Z)()(as)),Sa=e(43859),us=(0,Sa.Z)(K),Ds=(0,Sa.Z)(St),Za=(0,Sa.Z)(bt),ga=(0,Sa.Z)(Qt),Ga=(0,Sa.Z)(Ra),La=(0,Sa.Z)(ua),fa=(0,Sa.Z)(Fa),ke=(0,Sa.Z)(at)},56075:function(gt,Se,e){"use strict";e.d(Se,{lf:function(){return b},wp:function(){return a},IT:function(){return T},Ty:function(){return o},UN:function(){return D},tb:function(){return K},el:function(){return P},K:function(){return y},yx:function(){return p},aB:function(){return c},VI:function(){return I},B5:function(){return M},M5:function(){return v},di:function(){return A},b9:function(){return d},tQ:function(){return t},hB:function(){return h},DK:function(){return F},y4:function(){return m},Ys:function(){return E},sG:function(){return Q},jh:function(){return G},h4:function(){return V},sE:function(){return z},lo:function(){return $},zG:function(){return W},Yy:function(){return S},xX:function(){return x},m_:function(){return U},$t:function(){return L},Sh:function(){return w},$s:function(){return k},Ne:function(){return ne},B:function(){return ie},TK:function(){return Ne},_u:function(){return ue},DF:function(){return _e},Mq:function(){return Ze},Kx:function(){return j}});var O=e(37055),g=e(10237);function b(R){var le=R.page_number,H=R.page_size,X=R.keyword,ce=X===void 0?"":X,Te=O.ZP.evaluateManage.getEvaluateTools();return g.WY.get({url:Te,params:{page_number:le,page_size:H,keyword:ce}})}function a(R){var le=R.modelId,H=R.productId,X=O.ZP.evaluateManage.getEvaluateTool();return g.WY.get({url:X,params:{modelId:le,productId:H}})}function T(){var R=O.ZP.evaluateManage.getEvaluateType();return g.WY.get({url:R})}function o(R){var le=R.evaluation_tools,H=O.ZP.evaluateManage.addEvaluateTools();return g.WY.post({url:H,data:{evaluation_tools:le}})}function D(R){var le=R.keyword,H=le===void 0?"":le,X=R.industry,ce=O.ZP.evaluateManage.queryEvaluateTools();return g.WY.get({url:ce,params:{keyword:H,industry:X}})}function K(R){var le=R.ids,H=R.visible_range,X=R.department_ids,ce=R.group_ids,Te=R.post_ids,Le=R.user_ids,he=O.ZP.evaluateManage.setEmployRange();return g.WY.post({url:he,data:{ids:le,visible_range:H,department_ids:X,group_ids:ce,post_ids:Te,user_ids:Le}})}function P(R){var le=R.id,H=O.ZP.evaluateManage.deleteEvaluateTool({id:le});return g.WY.post({url:H})}function y(R){var le=R.id,H=O.ZP.evaluateManage.queryVisible({toolId:le});return g.WY.get({url:H})}function C(R){var le=R.page_number,H=R.page_size,X=R.name,ce=R.ability_type,Te=R.source,Le=R.evaluation_tool_id,he=CONFIG.evaluateManage.getAbilityList();return request.get({url:he,params:{page_number:le,page_size:H,name:X,ability_type:ce,source:Te,evaluation_tool_id:Le}})}function p(R){var le=R.id,H=O.ZP.evaluateManage.getToolsListByAbility({abilityId:le});return g.WY.get({url:H})}function B(R){var le=R.ids,H=R.training_courses,X=R.isBatchOperation,ce=CONFIG.evaluateManage.batchSetCase();return request.post({url:ce,data:{ids:le,training_courses:H,isBatchOperation:X}})}function c(R){var le=R.id,H=R.source,X=O.ZP.evaluateManage.queryTrainingCase({abilityId:le});return g.WY.get({url:X,params:{source:H}})}function I(R){var le=R.page_number,H=R.page_size,X=R.only_see_me,ce=R.keyword,Te=R.status,Le=R.product_id,he=R.plan_type,Ee=O.ZP.PostTalentEvaluation.getList();return g.WY.get({url:Ee,params:{page_number:le,page_size:H,only_see_me:X,keyword:ce,status:Te,product_id:Le,plan_type:he}})}function M(R){var le=R.title,H=R.product_id,X=R.term_type,ce=R.start_time,Te=R.end_time,Le=R.open_result,he=R.supervisor_Id,Ee=R.source,ve=R.user_ids,be=R.department_ids,Ve=R.group_ids,Ae=R.post_ids,at=R.authority_range,et=R.status,ut=R.model_id,q=R.finish_promote,Oe=R.certificate_id,Je=R.is_get_score,je=R.finish_score,Be=R.isEdit,St=R.editId,Lt=R.evaluation_tool_type,Wt=R.evaluation_way_self,pa=R.evaluation_way_superior,Xt=R.evaluation_rule_result_vo,Et=R.personnel_echo_request_list,Fe=Be?O.ZP.PostTalentEvaluation.edit(St):O.ZP.PostTalentEvaluation.add();return g.WY.post({url:Fe,data:{title:le,product_id:H,term_type:X,start_time:ce,end_time:Te,open_result:Le,supervisor_Id:he,source:Ee,user_ids:ve,department_ids:be,group_ids:Ve,post_ids:Ae,authority_range:at,status:et,model_id:ut,finish_promote:q,certificate_id:Oe,is_get_score:Je,study_score:{finish_score:je},evaluation_tool_type:Lt,evaluation_way_self:Wt,evaluation_way_superior:pa,evaluation_rule_result_vo:Xt,personnel_echo_request_list:Et}})}function v(R){var le=R.taskId,H=O.ZP.PostTalentEvaluation.publish(le);return g.WY.post({url:H})}function A(R){var le=R.taskId,H=O.ZP.PostTalentEvaluation.unPublish(le);return g.WY.post({url:H})}function d(R){var le=R.id,H=O.ZP.evaluateManage.isReferenceWithOther({id:le});return g.WY.get({url:H})}function l(R){var le=R.type,H=CONFIG.deleteResource.check();return request.get({url:H,params:{type:le}})}function t(R){var le=O.ZP.PostTalentEvaluation.delete(R);return g.WY.post({url:le,data:{}})}function h(R){var le=O.ZP.PostTalentEvaluation.getInfo(R);return g.WY.get({url:le,params:{}})}function F(){var R=O.ZP.PostTalentEvaluation.getEvaluationAbilityLevel();return g.WY.get({url:R,params:{}})}function m(R){var le=R.id,H=R.name,X=O.ZP.PostTalentEvaluation.editEvaluationAbilityLevel();return g.WY.post({url:X,data:{id:le,name:H}})}function E(R){var le=O.ZP.PostTalentEvaluation.queryAbilityRange(R);return g.WY.get({url:le})}function Q(R){var le=R.ability_ids,H=R.visible_range,X=R.department_ids,ce=R.group_ids,Te=R.post_ids,Le=R.user_ids,he=R.userId,Ee=O.ZP.PostTalentEvaluation.setAbilityRange(he);return g.WY.post({url:Ee,data:{ability_ids:le,visible_range:H,department_ids:X,group_ids:ce,post_ids:Te,user_ids:Le}})}function G(R){var le=R.only_see_me,H=R.key_word,X=R.page_number,ce=R.page_size,Te=R.model_type,Le=O.ZP.PostTalentEvaluation.getEvaluationModel();return g.WY.get({url:Le,params:{only_see_me:le,key_word:H,page_number:X,page_size:ce,model_type:Te}})}function V(R){var le=R.ids,H=R.visible_range,X=R.department_ids,ce=R.group_ids,Te=R.user_ids,Le=R.post_ids,he=O.ZP.PostTalentEvaluation.settingEvaluationModalRange();return g.WY.post({url:he,data:{ids:le,visible_range:H,department_ids:X,group_ids:ce,user_ids:Te,post_ids:Le}})}function z(R){var le=O.ZP.PostTalentEvaluation.saveEditEvaluationModal();return g.WY.post({url:le,data:R})}function $(R){var le=O.ZP.PostTalentEvaluation.getEvaluationModal(R);return g.WY.get({url:le})}function W(R){var le=R.abilityName,H=R.abilityType,X=R.source,ce=R.description,Te=R.abilityLevels,Le=R.visibleRange,he=O.ZP.PostTalentEvaluation.addEvaluationAbility();return g.WY.post({url:he,data:{abilityName:le,abilityType:H,source:X,description:ce,abilityLevels:Te,visibleRange:Le}})}function S(R){var le=O.ZP.PostTalentEvaluation.queryEvaluationAbility(R);return g.WY.get({url:le})}function x(R){var le=R.id,H=R.abilityName,X=R.abilityType,ce=R.source,Te=R.description,Le=R.abilityLevels,he=R.visibleRange,Ee=O.ZP.PostTalentEvaluation.editEvaluationAbility({});return g.WY.post({url:Ee,data:{id:le,abilityName:H,abilityType:X,source:ce,description:Te,abilityLevels:Le,visibleRange:he}})}function U(R){var le=R.page_number,H=R.page_size,X=R.name,ce=R.ability_type,Te=R.source,Le=R.evaluation_tool_id,he=O.ZP.PostTalentEvaluation.getEvaluateList();return g.WY.get({url:he,params:{page_number:le,page_size:H,name:X,ability_type:ce,source:Te,evaluation_tool_id:Le}})}function L(R){var le=O.ZP.PostTalentEvaluation.deleteAbilityOption();return g.WY.post({url:le,params:{ability_ids:R}})}function w(R){var le=O.ZP.PostTalentEvaluation.refEvaluationModel(R);return g.WY.get({url:le})}function k(R){var le=O.ZP.PostTalentEvaluation.deleteModel(R);return g.WY.post({url:le})}function ne(R){var le=R.is_batch_operation,H=R.ids,X=R.training_courses,ce=R.source,Te=O.ZP.PostTalentEvaluation.setImprove();return g.WY.post({url:Te,data:{is_batch_operation:le,ids:H,training_courses:X},params:{source:ce}})}function ie(R,le,H){var X=O.ZP.PostTalentEvaluation.viewModelReport(le,R);return g.WY.get({url:X,params:{platformType:H}})}function Ne(R){var le=O.ZP.PostTalentEvaluation.checkAbilitiesDelete(R);return g.WY.post({url:le})}function ue(R){var le=O.ZP.personnelDevelope.getPostAbility();return g.WY.post({url:le,data:R})}function _e(R){var le=O.ZP.personnelDevelope.checkPostModal(R);return g.WY.get({url:le})}function Ze(R,le){var H=O.ZP.personnelDevelope.getPostAssessList(le);return g.WY.get({url:H,params:R})}function j(R){var le=O.ZP.personnelDevelope.importTaskSubmit();return g.WY.get({url:le,params:{new_file_name:R}})}},64334:function(gt,Se,e){"use strict";e.d(Se,{z2:function(){return O},NK:function(){return g},Hh:function(){return b},Qz:function(){return a},GM:function(){return T},S1:function(){return o},LH:function(){return K},MB:function(){return P},tk:function(){return y}});var O=function(p){var B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",c=0;return B==="studyPreview"?p.forEach(I=>{c+=I.courseMappingList.filter(M=>M.type==="ex").length}):p.forEach(I=>{c+=I.list.filter(M=>M.type==="ex").length}),c},g=C=>{var p=0;return C.forEach(B=>{p+=B.list.filter(c=>c.type==="practice").length}),p},b=C=>{var p=0;return C.forEach(B=>{p+=B.list.filter(c=>c.type==="sc").length}),p},a=C=>{var p=0;return C.forEach(B=>{p+=B.list.filter(c=>["ex","sc","practice","jobEvaluation"].indexOf(c.type)<0).length}),p},T=function(p){var B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",c=0;return B==="studyPreview"?p.forEach(I=>{var M=I.courseMappingList,v=M.filter(A=>A.type==="operation");c+=v.length}):p.forEach(I=>{c+=I.list.filter(M=>M.type==="sc").length}),c},o=C=>{var p=0;return C.forEach(B=>{p+=B.list.filter(c=>c.type==="jobEvaluation").length}),p},D=C=>{var p=[];return C.forEach(B=>{p=p.concat(B.list.filter(c=>c.type==="xx"))}),p},K=C=>{var p=0;return C.forEach(B=>{p+=B.list.filter(c=>c.type==="xx"||c.type==="attendance").length}),p},P=C=>{var p=0;return C.forEach(B=>{p+=B.list.filter(c=>c.type==="course"||c.type==="twCourse"||c.type==="liveClass"||c.type==="courseware").length}),p},y=C=>{var p=0;return C.forEach(B=>{p+=B.list.filter(c=>c.type==="course"||c.type==="courseware").length}),p}},14441:function(gt,Se,e){"use strict";e.d(Se,{v:function(){return b},t:function(){return a}});var O=e(10237),g=e(5430);function b(T){var o=g.Fc.getUserName();return O.WY.get({url:o,params:{user_id:T}})}function a(T){var o=g.Fc.getDepartmentNames();return O.WY.post({url:o,data:{ids:T}})}},54531:function(gt,Se,e){"use strict";e.d(Se,{TN:function(){return y},nb:function(){return C},DR:function(){return p},yZ:function(){return B},Cz:function(){return c}});var O=e(57361),g=e(34792),b=e(48086),a=e(9754),T=e.n(a),o=e(17780),D=e(37055),K=e(10237),P=localStorage.getItem("corpId"),y=()=>{if(!!dd.version&&!(0,o.xX)()){var I=D.ZP.util.getSignature(),M=window.location.href;K.WY.get({url:I,params:{corpId:P,url:M,uuid:""}}).then(v=>{var A=v.data;dd.config({agentId:A.agentId,corpId:A.corpId,timeStamp:A.timeStamp,nonceStr:A.nonceStr,signature:A.signature,type:0,jsApiList:["biz.ding.post","biz.cspace.preview","biz.util.uploadAttachment"]}),dd.error(d=>{b.default.info("dd error:".concat(JSON.stringify(d)))})})}},C=I=>{var M=I.users,v=M===void 0?[]:M,A=I.attachmentTitle,d=A===void 0?"":A,l=I.text,t=l===void 0?"":l,h=I.mobileUrl,F=h===void 0?"":h,m=sessionStorage.getItem("CL_E_APP_ID"),E=sessionStorage.getItem("CL_MINI_APP_ID"),Q=encodeURIComponent("/pages/login/login"),G="dingtalk://dingtalkclient/action/open_micro_app?&appId=".concat(m,"&miniAppId=").concat(E,"&page=").concat(Q,"&corpId=$CORPID$"),V=F||G;dd.biz.ding.post({users:v,corpId:P,type:2,alertType:2,attachment:{title:d,url:V,image:"",text:"",showInApp:!1},text:t,onSuccess:()=>{},onFail:()=>{}})},p=I=>{var M=I.spaceId,v=M===void 0?"":M,A=I.fileId,d=A===void 0?"":A,l=I.fileName,t=l===void 0?"":l,h=I.fileSize,F=h===void 0?"":h,m=I.fileType,E=m===void 0?"":m;dd.biz.cspace.preview({corpId:P,spaceId:v,fileId:d,fileName:t,fileSize:F,fileType:E,onSuccess(){},onFail(){}})},B=I=>{var M=I.image,v=M===void 0?{}:M,A=I.space,d=A===void 0?{}:A,l=I.file,t=l===void 0?{}:l,h=I.types,F=h===void 0?[]:h,m=I.onSuccess,E=m===void 0?()=>{}:m,Q=I.onFail,G=Q===void 0?()=>{}:Q;dd.biz.util.uploadAttachment({image:v,space:d,file:t,types:F,onSuccess:V=>{E(V)},onFail:V=>{G(V)}})},c=function(){var I=(0,O.Z)(T().mark(function M(v){var A,d,l,t,h;return T().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return A=v.corpId,d=v.userId,l=D.ZP.DingSpaceId.getSpaceId(),t={corpId:A,userId:d,timeStamp:Date.parse(new Date)},m.next=5,K.WY.get({url:l,params:t});case 5:return h=m.sent,m.abrupt("return",h.data.data.spaceId);case 7:case"end":return m.stop()}},M)}));return function(v){return I.apply(this,arguments)}}()},67230:function(gt,Se,e){"use strict";e.d(Se,{J7:function(){return y},y5:function(){return C},km:function(){return p}});var O=e(57361),g=e(9754),b=e.n(g),a=e(37055),T=e(10237);function o(B){return D.apply(this,arguments)}function D(){return D=(0,O.Z)(b().mark(function B(c){var I,M,v;return b().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return I=a.ZP.localStorage.getPravateDocUrl(c),d.prev=1,d.next=4,T.WY.get({url:I});case 4:if(M=d.sent,v=M.data,!(v.code===0&&v.data)){d.next=8;break}return d.abrupt("return",v.data.docResourceDownloadUrl||"");case 8:return d.abrupt("return","");case 11:return d.prev=11,d.t0=d.catch(1),d.abrupt("return","");case 14:case"end":return d.stop()}},B,null,[[1,11]])})),D.apply(this,arguments)}function K(B){return P.apply(this,arguments)}function P(){return P=(0,O.Z)(b().mark(function B(c){var I,M,v;return b().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return I=a.ZP.localStorage.getPravateVideoUrl(c),d.prev=1,d.next=4,T.WY.get({url:I,params:{type:"source"}});case 4:if(M=d.sent,v=M.data,!(v.code===0&&v.data)){d.next=8;break}return d.abrupt("return",v.data.videoPlayInfo||"");case 8:return d.abrupt("return","");case 11:return d.prev=11,d.t0=d.catch(1),d.abrupt("return","");case 14:case"end":return d.stop()}},B,null,[[1,11]])})),P.apply(this,arguments)}var y=B=>o(B),C=B=>K(B);function p(B){var c=a.ZP.Common.downloadUrl(B);return T.WY.get({url:c})}},44881:function(gt,Se,e){"use strict";e.d(Se,{P:function(){return O}});var O=function(b){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"query";return b.forEach(T=>{T.isLeaf=!T.has_children,T.value=T.id,T.pId=T.parent_id,T.label=T.name,T.key=T.id,T.title=T.name,a==="refer"&&(T.disabled=!T.allow_refer),a==="edit"&&(T.disabled=!T.allow_edit)}),b}},86726:function(gt,Se,e){"use strict";e.d(Se,{V9:function(){return g},H3:function(){return b},e:function(){return a},F:function(){return T}});var O=e(93485);function g(o){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],K=[];function P(y,C){var p=(0,O.Z)(C),B;try{for(p.s();!(B=p.n()).done;){var c=B.value;if(c.key===y){K=c.actions;break}c.children instanceof Array&&c.children.length&&P(o,c.children)}}catch(I){p.e(I)}finally{p.f()}}return P(o,D),K}function b(o){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],K=D.find(P=>P.key===o)||{};return K.checked||!1}function a(o){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],K=!1;function P(y,C){var p=(0,O.Z)(C),B;try{for(p.s();!(B=p.n()).done;){var c=B.value;if(c.key===y){K=c.checked;break}c.children instanceof Array&&c.children.length&&P(o,c.children)}}catch(I){p.e(I)}finally{p.f()}}return P(o,D),K}function T(o){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],K="";function P(y,C){var p=(0,O.Z)(C),B;try{for(p.s();!(B=p.n()).done;){var c=B.value;if(c.key===y){K=c.id;break}c.children instanceof Array&&c.children.length&&P(o,c.children)}}catch(I){p.e(I)}finally{p.f()}}return P(o,D),K}},34773:function(gt,Se,e){"use strict";e.d(Se,{b:function(){return g},N:function(){return b}});var O=e(93212),g=a=>{var T=[],o=[],D=[],K=[],P=[];return T=a.dept.filter(y=>y.id).map(y=>y.id),o=a.group.filter(y=>y.id).map(y=>y.id),D=a.post.filter(y=>y.id).map(y=>y.id),K=a.user.filter(y=>y.id).map(y=>y.id),P=a.cluster?a.cluster.filter(y=>y.id).map(y=>y.id):[],{deptIds:T,groupIds:o,postIds:D,userIds:K,clusterIds:P}},b=a=>{var T=[],o=[],D=[],K=[],P=[];return T=(0,O.GU)(a.departments),D=(0,O.GU)(a.posts),o=a.groups.filter(y=>y.id).map(y=>({id:y.id})),K=a.users.filter(y=>y.id).map(y=>({id:y.id})),P=a.clusters?a.clusters.filter(y=>y.id).map(y=>({id:y.id})):[],{deptIds:T,groupIds:o,postIds:D,userIds:K,clusterIds:P}}},43967:function(gt,Se,e){"use strict";e.d(Se,{Of:function(){return O},SH:function(){return g},Y5:function(){return b},d2:function(){return a}});var O=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return o.uploadSucceedItem&&o.uploadSucceedItem.id&&o.uploadSucceedItem.id!==D.uploadSucceedItem.id},g=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return o.localSuccessList.length!==D.localSuccessList.length},b=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return o.filter(D=>!D.isError&&!D.isCanceling&&D.status!=="success")},a=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return o.filter(D=>D.status==="success")}},26885:function(gt,Se,e){"use strict";e.d(Se,{mw:function(){return c},kr:function(){return I},w8:function(){return M},Sk:function(){return A},$f:function(){return d}});var O=e(34792),g=e(48086),b=e(88986),a=e(57361),T=e(9754),o=e.n(T),D=e(76651),K=e(78001),P=e(37055),y=e(10237),C=localStorage.getItem("corpId"),p=(l,t)=>{wx.config({beta:!0,debug:!1,appId:l.corpId||localStorage.getItem("corpId"),timestamp:l.timeStamp,nonceStr:l.nonceStr,signature:l.signature,jsApiList:["openDefaultBrowser","innerSaveWebPerformance"]}),wx.ready(()=>{t&&I()}),wx.error(h=>{console.log("error",h)})},B=(l,t)=>{wx.agentConfig({corpid:l.corpId,agentid:l.agentId,timestamp:l.timeStamp,nonceStr:l.nonceStr,signature:l.signature,jsApiList:["openDefaultBrowser","selectExternalContact","selectEnterpriseContact","selectPrivilegedContact","createChatWithMsg","openEnterpriseChat","openExistedChatWithMsg"],success:()=>{t("success"),(0,D.Qm)()._store.dispatch({type:"user/setWxWorkApiFlag",payload:{wxWorkApiFlag:(0,D.Qm)()._store.getState().user.wxWorkApiFlag+=1}})},fail:h=>{h.errMsg.indexOf("function not exist")>-1&&alert("\u7248\u672C\u8FC7\u4F4E\u8BF7\u5347\u7EA7")}})},c=(l,t,h)=>{window.wx.openEnterpriseChat({userIds:l.join(";"),groupName:t.title,chatId:"",success:function(m){var E=m.chatId;window.wx.invoke("openExistedChatWithMsg",{chatId:E,msg:{msgtype:"link",link:{title:t.title,desc:t.desc,url:t.url,imgUrl:t.imgUrl}}},function(Q){Q.err_msg=="openExistedChatWithMsg:ok"&&h&&h(E)})},fail:function(m){m.errMsg.indexOf("function not exist")>-1&&alert("\u7248\u672C\u8FC7\u4F4E\u8BF7\u5347\u7EA7")}})},I=function(){var l=(0,a.Z)(o().mark(function t(h){var F,m,E,Q,G,V,z=arguments;return o().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return F=z.length>1&&z[1]!==void 0?z[1]:()=>{},m=P.ZP.util.getAppSignature(),E=window.location.href.split("#")[0],Q=h||P.ZP.enterpriseId,W.next=6,y.WY.get({url:m,params:{enterprise_id:Q,url:E,batch_id:""}});case 6:G=W.sent,V=G.data,B(V,F);case 9:case"end":return W.stop()}},t)}));return function(h){return l.apply(this,arguments)}}(),M=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(navigator.userAgent.toLowerCase().indexOf("wxwork")>-1){var F=P.ZP.util.getCorpSignature(),m=window.location.href.split("#")[0];y.WY.get({url:F,params:{enterprise_id:P.ZP.enterpriseId,url:m,batch_id:h}}).then(E=>{var Q=E.data;p(Q,t)})}else t&&I()},v=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,h=CONFIG.util.getSignature(),F=window.location.href;request.get({url:h,params:{corpId:C,url:F,uuid:""}}).then(m=>{var E=m.data;p(E,t)})},A=l=>{var t=l.userIds,h=t===void 0?[]:t,F=l.deptIds,m=F===void 0?[]:F,E=l.mode,Q=E===void 0?"multi":E;return new Promise((G,V)=>{window.wx.invoke("selectPrivilegedContact",{fromDepartmentId:0,mode:Q,selectedContextContact:0,selectedOpenUserIds:h||[],selectedTickets:m||[]},z=>{z.err_msg==="selectPrivilegedContact:ok"?(typeof z.result=="string"&&(z.result=JSON.parse(z.result)),G(z.result)):z.err_msg==="selectPrivilegedContact:cancel"&&V("cancel")})})},d=l=>{var t=l.type,h=t===void 0?"employeeRange":t,F=l.result,m=F===void 0?{}:F,E=l.user,Q=E===void 0?{}:E,G=l.reserveUser,V=G===void 0?[]:G,z=l.rangeType,$=z===void 0?"all":z,W=l.hasDefault,S=W===void 0?!0:W;return new Promise(x=>{var U=m.userList,L=U===void 0?[]:U,w=m.selectedUserCount,k=L||[];if(h==="employeeRange"){var ne=Q.unionid,ie="";!L.length&&w?(S&&(k.push({id:ne,unionid:ne,openUserId:ne}),m.userList=[{id:ne,unionid:ne,openUserId:ne}],m.selectedUserCount+=1),ie=!0):ie=!1;var Ne={dept:[],post:[],group:[],user:k.map(ce=>(0,b.Z)((0,b.Z)({},ce),{},{unionid:ce.openUserId,id:ce.openUserId,user_id:ce.openUserId,source_type:"wx_sync"})),classes:[],cluster:[]};$==="onlyDeptUser"&&(Ne={dept:[],user:k.map(ce=>(0,b.Z)((0,b.Z)({},ce),{},{unionid:ce.openUserId,id:ce.openUserId,user_id:ce.openUserId,source_type:"wx_sync"}))});var ue={isShowType:ie,qyWeChatVo:JSON.stringify(m),rangeList:Ne},_e=m.selectedUserCount-Ne.user.length;_e>0&&(ie&&S?g.default.warning(K.Z.t("component.selectedErrorTips",{count:_e})):g.default.warning(K.Z.t("component.selectedErrorTips2",{count:_e}))),x(ue)}if(h==="supervision"){L&&(k.find(ce=>ce.openUserId===(V[0].unionid||V[0].user_id||V[0].name))&&(m.selectedUserCount-=1),k=k.filter(ce=>ce.openUserId!==V[0].unionid&&ce.openUserId!==V[0].user_id&&ce.openUserId!==V[0].name).map(ce=>ce));var Ze=k.map(ce=>(0,b.Z)((0,b.Z)({},ce),{},{unionid:ce.openUserId,id:ce.openUserId,user_id:ce.openUserId,source_type:"wx_sync"})),j={qyWeChatVo:JSON.stringify(m),user:Ze},R=m.selectedUserCount-Ze.length;R>0&&g.default.warning(K.Z.t("component.selectedErrorTips2",{count:R})),x(j)}if(h==="normal"){var le=k.map(ce=>(0,b.Z)((0,b.Z)({},ce),{},{unionid:ce.openUserId,id:ce.openUserId,user_id:ce.openUserId,source_type:"wx_sync",qyWeChatVo:JSON.stringify(m)})),H={qyWeChatVo:JSON.stringify(m),user:le},X=m.selectedUserCount-le.length;X>0&&g.default.warning(K.Z.t("component.selectedErrorTips2",{count:X})),x(H)}})}}}]);
