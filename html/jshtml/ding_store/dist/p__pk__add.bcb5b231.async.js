(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[151],{11449:function(De,se,r){"use strict";r.d(se,{Z:function(){return ye}});var M=r(88986),B=r(33565),G=r(12924),$=r.n(G),W=r(3115),Te=r(49111),re=r(19650),w=r(62029),A=r(57663),U=r(71577),_=r(91768),J=r(28216),X=r(37055),v=r(10237);function e(R){var F=X.ZP.getHelpContentByMenuKey(),x={key:R};return v.WY.get({url:F,params:x})}var ie=r(74228),k=r.n(ie),ge=r(1164),b=r(76466),q=r(38642);class ce extends $().Component{constructor(F){var x;super(F);x=this,this.getHelpContentByMenuKey=()=>{var D=this.props.defaultMenuKey;e(D).then(I=>{var V=I.data,S=V.help_url,N=V.video_url;this.setState({videoUrl:N,helpUrl:S})})},this.handleOpenHelpUrl=D=>{if((0,q.ve)()){window.open(D,"_blank");return}ge.Z.targetTo({path:D,isExternalLink:!0})},this.handleOpenVideo=function(D){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:x.props.t("helpCenter.video");x.setState(V=>({resourcePlayInfo:(0,M.Z)((0,M.Z)({},V.resourcePlayInfo),{},{resourceInfo:{originUrl:D,source:{FD:D,OD:D},contentType:"mp4"}}),previewInfo:(0,M.Z)((0,M.Z)({},V.previewInfo),{},{title:I,visible:!0,onCancel:x.handleCancelPreview})}))},this.handleCancelPreview=()=>{var D=this.state.previewInfo;this.setState({resourcePlayInfo:{mode:"preview",watchType:"video",resourceInfo:{}},previewInfo:(0,M.Z)((0,M.Z)({},D),{},{visible:!1})})},this.state={helpUrl:"",videoUrl:"",resourcePlayInfo:{autoPlay:!0,draggable:!0,mode:"preview",resourceInfo:{},watchType:"video"},previewInfo:{visible:!1,destroyOnClose:!0,title:F.t("helpCenter.video")||"\u89C6\u9891\u6307\u5BFC",onCancel:()=>{}}}}componentDidMount(){this.getHelpContentByMenuKey()}render(){var F=this.state,x=F.helpUrl,D=F.resourcePlayInfo,I=F.previewInfo,V=F.videoUrl,S=this.props.t;return $().createElement("div",{className:k().helpCenter},V&&$().createElement(U.Z,{type:"link",className:k()["video-btn"],style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenVideo(V)},S("helpCenter.video")),x&&$().createElement(U.Z,{type:"link",style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenHelpUrl(x)},S("helpCenter.tutorial")),$().createElement(b.Z,(0,w.Z)({},D,{previewInfo:I})))}}var _e=R=>({defaultMenuKey:R.currentRoute.menuKey});ce.defaultProps={defaultMenuKey:""};var Ne=(0,J.$j)(_e)((0,_.Z)()(ce));function L(R){var F=R.extra,x=localStorage.getItem("dingPersonnel"),D=sessionStorage.getItem("dingPersonnel");return $().createElement(re.Z,null,F,x!=="dingPersonnel"&&D!=="dingPersonnel"&&(0,q.eY)("COMMONEXTRA_HELP_CENTER")&&$().createElement(Ne,null))}var H=L,Le=r(4408);function ee(R){var F=(0,G.useState)({helpCenter:(0,q.eY)("HEAD_HELP_CENTER_BUT")}),x=(0,B.Z)(F,1),D=x[0],I=R.pageContainerParams,V=I===void 0?{}:I,S=R.noPadding,N=S===void 0?!1:S,m=R.isPersonal,p=m===void 0?!1:m,u=R.pageTitle,y=R.className,g=y===void 0?"":y,P={extra:D.helpCenter?$().createElement(H,{extra:V.extra}):V.extra},T=(0,M.Z)((0,M.Z)({},V),P);return $().createElement("div",{className:"page-container-content ".concat(N?"page-container-noPadding":""," ").concat(p?"page-container-content_personal_background":""," ").concat(g)},u&&$().createElement(Le.Z,{title:u}),p?$().createElement(W.Z,null,R.children):$().createElement(W.Z,T,R.children))}var ye=ee},85242:function(De,se,r){"use strict";r.r(se),r.d(se,{default:function(){return Zt}});var M=r(13062),B=r(71230),G=r(62029),$=r(89032),W=r(15746),Te=r(20228),re=r(11382),w=r(57361),A=r(34792),U=r(48086),_=r(88986),J=r(9754),X=r.n(J),v=r(12924),e=r.n(v),ie=r(28216),k=r(80991),ge=r(57068),b=r(91768),q=r(76651),ce=E=>{var n=E.title,t=E.operateStageList,a=E.opearateStage,s=E.onChangeStep,i=E.displayType,l=E.stepStyle,o=(d,c)=>d===c?"form-page-left-step-active":d>c||i==="edit"||l[c-1]==="success"?"form-page-left-step-success":"form-page-left-step-noallow";return e().createElement(e().Fragment,null,e().createElement("h1",{className:"form-page-left-title"},n),e().createElement("div",{className:"form-page-left-step"},t.map(d=>e().createElement("div",{onClick:()=>{d.key!==a&&s(d.key)},key:d.key,className:"form-page-left-step-item ".concat(o(a,d.key))},e().createElement("div",{className:"form-page-left-step-item-number"},d.key),e().createElement("div",{className:"form-page-left-step-item-name"},d.name)))))},_e=ce,Ne=r(57663),L=r(71577),H=r(43859),Le=r(88983),ee=r(47933),ye=E=>{var n=E.t,t=E.value,a=E.onChange,s=E.isEdit,i=l=>{a(l.target.value)};return e().createElement(ee.ZP.Group,{onChange:i,value:t,disabled:s},e().createElement(ee.ZP,{value:1},n("pk.multiplePk")),e().createElement(ee.ZP,{value:2},n("pk.teamPk")))},R=(0,b.Z)()(ye),F=r(22385),x=r(31097),D=r(77883),I=r(21888),V=r(66456),S=r(55313),N=r(68628),m=r(49101),p=r(57119),u=r(28391),y=r(51927),g=r(6793),P=r(38642),T=r(96627);class O extends e().Component{constructor(){var n;super(...arguments);n=this,this.state={visible:!1,isNew:!1,columns:[]},this.handleClick=()=>{this.setState({visible:!0})},this.handleOk=t=>{this.setState({visible:!1});var a=this.state.isNew,s=this.props,i=s.defaultFieldList,l=s.formik;if(a){var o=t.map(d=>d.title?{id:d.id,name:d.title,single:d.single_count,singleCount:d.single_count,trueOrFalse:d.true_or_false_count,trueOrFalseCount:d.true_or_false_count,data:{singleCount:d.single_count,trueOrFalseCount:d.true_or_false_count}}:d);l.setFieldValue("randomQuestion",(0,_.Z)((0,_.Z)({},i),{},{bankQuestionVoList:o}))}else l.setFieldValue("randomQuestion",(0,_.Z)((0,_.Z)({},i),{},{bankQuestionVoList:t}))},this.handleCancel=()=>{this.setState({visible:!1})},this.handleDeleteRow=t=>{var a=this.props,s=a.t,i=a.defaultFieldList,l=i.single_num,o=i.judgment_num,d=i.bankQuestionVoList,c=d.filter(Z=>Z.id!==t.key),h=this.getTotalCount("single",c),f=this.getTotalCount("trueOrFalse",c),C=(0,_.Z)((0,_.Z)({},this.props.defaultFieldList),{},{single_num:h>=l?l:h,judgment_num:f>=o?o:f,bankQuestionVoList:d.filter(Z=>Z.id!==t.key)});c.length===0&&(C.single_num=0,C.judgment_num=0),this.props.formik.setFieldValue("randomQuestion",C),U.default.success(s("exam.removeSuccessful"))},this.camelCaseObject=t=>{var a={};for(var s in t)a[(0,P.FI)(s)]=t[s];return a},this.compileDataSource=()=>{var t=this.props,a=t.defaultFieldList,s=t.isEdit,i=t.isPreview,l=this.state.columns,o=[],d=a.bankQuestionVoList;return d.forEach(c=>{var h={};h.key=c.id,l.forEach(f=>{f.key==="name"?h["".concat(f.dataIndex)]=c.name:f.key==="action"&&!s&&!i?h["".concat(f.dataIndex)]=this.props.t("common.remove"):h["".concat(f.dataIndex)]=this.formatFunc.Count(c.data["".concat(f.dataIndex,"Count")])}),o.push(h)}),o},this.formatFunc={Count:t=>(0,g.ZT)("".concat(this.props.t("exam.questionCalcCount")),t)},this.questionNumChange=(t,a)=>{var s=this.props,i=s.formik,l=s.defaultFieldList;t==="select"?i.setFieldValue("randomQuestion",(0,_.Z)((0,_.Z)({},l),{},{single_num:a})):i.setFieldValue("randomQuestion",(0,_.Z)((0,_.Z)({},l),{},{judgment_num:a}))},this.compileData=t=>{var a=[];return t.forEach(s=>{var i=s.data;a.push({componentName:"QuestionBankSelector",id:s.id,name:s.name,icon:"",type:"QUESTION_BANK",data:i||s})}),a},this.getTotalCount=function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n.props.defaultFieldList.bankQuestionVoList;return a.reduce((s,i)=>parseInt(s+i.data["".concat(t,"Count")]),[])},this.renderContent=()=>{var t=this.props,a=t.prefixCls,s=t.defaultFieldList,i=t.isPreview,l=t.isEdit,o=t.t,d=this.state.columns,c=s.single_num,h=s.judgment_num,f=s.bankQuestionVoList,C="".concat(a,"__content"),Z=this.getTotalCount("single"),Y=this.getTotalCount("trueOrFalse");return f.length?e().createElement("div",{className:C},e().createElement(S.Z,{size:"middle",pagination:!1,columns:d,rowKey:"key",dataSource:this.compileDataSource(s)}),e().createElement("div",{className:"pk_table_bottom_getNum"},e().createElement("div",{className:"title"},"".concat(o("pk.setQuestionCount"))),e().createElement("div",null,i?c:e().createElement(I.Z,{min:0,max:Z,precision:0,value:c>=0?c:0,disabled:l,onChange:ue=>{this.questionNumChange("select",ue)}})),e().createElement("div",null,i?h:e().createElement(I.Z,{min:0,max:Y,precision:0,value:h>=0?h:0,disabled:l,onChange:ue=>{this.questionNumChange("tof",ue)}})),e().createElement("div",null))):null}}componentDidMount(){this.funGetEnterpriseExamType()}funGetEnterpriseExamType(){var n=this;return(0,w.Z)(X().mark(function t(){var a,s,i;return X().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,T.XL)();case 2:a=o.sent,s=a.data.data,i=s==="true",n.setState({isNew:i,columns:[{title:n.props.t("exam.bankName"),dataIndex:"name",key:"name",width:"50%"},{title:()=>"".concat(n.props.t("examing.single"),"(").concat(n.getTotalCount("single"),")"),dataIndex:"single",key:"single",width:"20%"},{title:()=>"".concat(n.props.t("examing.tof"),"(").concat(n.getTotalCount("trueOrFalse"),")"),dataIndex:"trueOrFalse",key:"trueOrFalse",width:"20%"},{title:n.props.t("exam.operate"),dataIndex:"action",key:"action",width:"10%",render:(d,c)=>{var h="";return d&&(h=e().createElement("a",{href:"javascript:;",onClick:()=>n.handleDeleteRow(c),disabled:n.props.isEdit},d)),h}}]});case 6:case"end":return o.stop()}},t)}))()}renderScoreTip(){var n=this.props.t;return e().createElement("span",{className:"pk_all_score_tip"},e().createElement(x.Z,{placement:"top",title:n("pk.scoreTip")},e().createElement(N.Z,null)))}render(){var n=this.props,t=n.prefixCls,a=n.defaultFieldList,s=n.t,i=n.isPreview,l=n.isEdit,o=this.state,d=o.visible,c=o.isNew,h=a.bankQuestionVoList,f=this.compileData(h);return e().createElement(e().Fragment,null,e().createElement("div",{className:t},e().createElement("div",{className:"pk_choose_question_content"},!i&&e().createElement(e().Fragment,null,e().createElement(L.Z,{type:"link",icon:e().createElement(m.Z,null),disabled:l,onClick:this.handleClick},s("exam.selectBank")),e().createElement("span",{className:"pk_choose_select_tip"},e().createElement(p.Z,{style:{color:"#f61717",marginRight:"5px"}}),s("pk.chooseQuestionTip")))),this.renderContent(),c?e().createElement(y.Z,{visible:d,defaultChecked:f,onCancel:this.handleCancel,onOk:this.handleOk,selectTip:s("pk.selectQuestionBankTips")}):e().createElement(u.Z,{tips:s("pk.selectQuestionBankTips"),visible:d,defaultChecked:f,onCancel:this.handleCancel,onOk:this.handleOk})))}}O.defaultProps={prefixCls:"pk_question_add"};var j=(0,k.$j)((0,b.Z)()(O));class K extends e().Component{constructor(){super(...arguments);this.onChange=n=>{var t=this.props.onChange;t&&t(n)}}render(){var n=this.props,t=n.defaultValue,a=n.unit,s=n.max,i=n.min,l=i===void 0?0:i,o=n.isPreview,d=n.isEdit;return e().createElement("div",null,o?e().createElement("span",null,t):e().createElement(I.Z,{value:t,min:l,max:s,precision:0,defaultValue:t,disabled:d,onChange:this.onChange}),e().createElement("span",{style:{paddingLeft:"8px"}},a))}}var le=(0,b.Z)()(K);class oe extends e().Component{constructor(){super(...arguments);this.onChange=n=>{var t=this.props.onChange;t&&t(n<=0?"":n)}}render(){var n=this.props,t=n.defaultValue,a=n.unit,s=n.isPreview,i=n.isEdit;return e().createElement("div",null,s?e().createElement("span",null,t):e().createElement(I.Z,{min:"",max:99999,precision:0,defaultValue:t,disabled:i,onChange:this.onChange}),e().createElement("span",{style:{paddingLeft:"8px"}},a))}}var ae=(0,b.Z)()(oe),ne=(0,H.Z)(R),Ce=(0,H.Z)(j),de=(0,H.Z)(le),ve=(0,H.Z)(ae),z={labelCol:{xs:{span:24},sm:{span:3}},wrapperCol:{xs:{span:24},sm:{span:20}}},Ye=E=>{var n=E.title,t=E.desc;return e().createElement(B.Z,{className:"preview_item"},e().createElement(W.Z,{span:3},n,":"),e().createElement(W.Z,null,t))},Je=Ye,Fe=r(3407),Ve=(0,g.me)(),Ee=Fe.Z[Ve].pk,ke=Fe.Z[Ve].learning,pe={title:E=>{var n;return E||(n=Ee.titleValidate),n},inputNumber:E=>{var n;return E||(n=Ee.validationPositiveInteger),n},inputNumberMin:(E,n)=>{var t;return E||(t=typeof E=="number"?null:(0,g.ZT)(Ee.validationPositiveIntegerMin,n)),t},questionLib:E=>{var n=E.bankQuestionVoList,t=E.single_num,a=E.judgment_num,s;return!n.length>0?s=Ee.selectBank:Number(t)+Number(a)<=0?s=Ee.selectOneBank:Number(t)+Number(a)>50&&(s=Ee.pkGameMaxBank),s},registerRange:(E,n,t)=>{var a;return!E.startTime||!E.endTime?a=ke.validation.learningAddItemDateRangeNull:(0,g.jZ)(E.startTime)>=(0,g.jZ)(E.endTime)?a=ke.validation.learningAddItemDateRangeLimit:n==="un_start"&&(0,g.jZ)(E.startTime)<(0,g.jZ)()?a=ke.validation.greaterCurrentTime:n==="processing"&&(0,g.jZ)(E.endTime)<(0,g.jZ)()?a=ke.validation.pkEndTimeTips:n==="processing"&&t&&t.startTime&&(0,g.jZ)(E.startTime)!==(0,g.jZ)(t.startTime)&&(a="".concat(ke.validation.pkStartTimeDisable).concat((0,g.p6)(t.startTime))),a}},Xe=r(62615),$e=r(7584),qe=r(70075),Ae=r(2396),et=E=>{var n=E.t,t=E.values,a=E.isPreview,s=E.isEdit,i=E.toEdit,l=E.cancelCreate,o=E.pkStatus,d=(0,_.Z)({},t.oldDatePicker),c=[{title:n("pk.pkTitle"),desc:t.title,key:1},{title:n("historicRecords.startDate"),desc:(0,g.p6)(t.datePicker.startTime),key:2},{title:n("common.endTime"),desc:(0,g.p6)(t.datePicker.endTime),key:3},{title:n("pk.challengeDescription"),desc:t.summary,key:4},{title:n("pk.challengeType"),desc:t.challengeType===1?n("pk.multiplePk"):n("pk.teamPk"),key:5}];return e().createElement("div",{className:"basic_info"},e().createElement("div",{className:"basic_pk_title"},n(a?"component.preview":"learning.learnUpgrade.bascInfo")),a?e().createElement("div",null,e().createElement("div",{className:"stage-preview-content-top"},n("learning.learnUpgrade.bascInfo")),e().createElement("div",{className:"preview_container"},c.map(h=>e().createElement(Je,{title:h.title,desc:h.desc,key:h.key}))),e().createElement("div",null,s?e().createElement(L.Z,{htmlType:"submit",type:"primary",className:"pk-basic-info-release"},n("common.release")):"",e().createElement(L.Z,{className:"cancel_btn",onClick:i},n("common.return")))):e().createElement("div",null,e().createElement(k.gN,(0,G.Z)({name:"title",label:n("pk.pkTitle"),required:!0,validate:h=>(0,Ae.QK)(h,n("pk.titlePlaceHolder")),component:$e.Z,isPreview:a,style:{width:"532px"},placeholder:n("pk.titlePlaceHolder"),maxLength:60,type:"text"},z)),e().createElement(k.gN,(0,G.Z)({component:Xe.C0,displayType:"Custom",name:"datePicker",disabled:!(s||o==="processing"),label:n("common.startEndTime"),required:!0,defaultFieldList:t.datePicker,validate:h=>pe.registerRange(h,o,d),onlyChangeEndTime:o==="processing"},z,{fieldName:"datePicker"})),e().createElement(k.gN,(0,G.Z)({name:"summary",label:n("pk.challengeDescription"),component:qe.Z,rows:5,placeholder:n("learning.validation.taskSummaryTip"),maxLength:150,type:"text",disabled:a},z)),e().createElement(k.gN,(0,G.Z)({name:"challengeType",label:n("pk.challengeType"),component:ne,isEdit:!s},z)),e().createElement("div",null,a?"":e().createElement(L.Z,{type:"primary",htmlType:"submit",className:"pk-save-next-btn"},n("learning.learnUpgrade.saveAndNext")),e().createElement(L.Z,{className:"cancel_btn",onClick:l},n("common.cancel")))))},tt=(0,b.Z)()(et),Ue=r(1058),at=r(89613),Q=r.n(at);class nt extends e().Component{constructor(n){super(n);this.handleAddRanking=()=>{var t=this.state.rewardList,a=this.props,s=a.formik,i=a.rewards_type;this.setState({rewardList:t.concat({gain_point:0,gain_experience_point:0,reward_order:t.length+1})},()=>{s.setFieldValue("leaderboard_rewards_".concat(i),this.state.rewardList)})},this.handleChange=(t,a,s)=>{var i=this.state.rewardList,l=this.props,o=l.formik,d=l.rewards_type;this.setState({rewardList:i.map((c,h)=>{if(h===t){var f={};return a==="score"?f.gain_point=s:f.gain_experience_point=s,(0,_.Z)((0,_.Z)({},c),f)}return c})},()=>{o.setFieldValue("leaderboard_rewards_".concat(d),this.state.rewardList)})},this.handleDeleteRank=t=>{var a=this.props,s=a.formik,i=a.rewards_type,l=this.state.rewardList,o=l;o.splice(t,1),this.setState({rewardList:o},()=>{s.setFieldValue("leaderboard_rewards_".concat(i),this.state.rewardList)})},this.handleCollapse=()=>{var t=this.state.showCollapse,a=this.props.t;this.setState({showCollapse:!t,collapseName:a(t?"common.expand":"common.collapse")})},this.renderRewardList=()=>{var t=this.state.rewardList,a=this.props.value,s=[];a.length!==0?s=(0,g.Cj)(a.concat(t),"reward_order"):s=t,this.setState({rewardList:s})},this.renderRewardTip=t=>{var a=this.props.t,s="";switch(t){case"high":s=a("pk.highRewardsTip");break;case"total":s=a("pk.totalRewardsTip");break;case"group_average":s=a("pk.groupRewardsTip");break;default:break}return e().createElement("span",{className:"".concat(Q().reward_setting_tip)},e().createElement(x.Z,{placement:"top",title:s},a("pk.ruledDesc")))},this.state={showCollapse:!1,collapseName:n.t("common.expand"),rewardList:[{gain_point:0,gain_experience_point:0,reward_order:1},{gain_point:0,gain_experience_point:0,reward_order:2},{gain_point:0,gain_experience_point:0,reward_order:3}]}}componentDidMount(){this.renderRewardList()}render(){var n=this.props,t=n.isEdit,a=n.t,s=n.rewards_type,i=n.isPreview,l=this.state,o=l.rewardList,d=l.showCollapse,c=l.collapseName;return e().createElement("div",{className:d?"".concat(Q().pk_collapse," ").concat(Q().pk_collapse_active):"".concat(Q().pk_collapse)},e().createElement("a",{onClick:this.handleCollapse},c),this.renderRewardTip(s),e().createElement("div",{className:"".concat(Q().pk_reward_content," ").concat(Q()[s])},o.map((h,f)=>e().createElement("div",{key:f.toString(),className:Q().reward_item},e().createElement("span",{className:Q().pk_score_content},e().createElement("strong",{className:Q().pk_score_title},a("pk.rewardPointsDesc",{index:f+1})),e().createElement(I.Z,{min:0,max:99999,precision:0,value:h.gain_point,disabled:t||i,onChange:C=>{this.handleChange(f,"score",C)}}),e().createElement("strong",{className:Q().pk_score},a("pk.branch"))),e().createElement("span",{className:Q().pk_experience_content},e().createElement("strong",{className:Q().pk_experience_title},a("pk.rewardExperience"),"\uFF1A"),e().createElement(I.Z,{min:0,max:99999,precision:0,value:h.gain_experience_point,disabled:t||i,onChange:C=>{this.handleChange(f,"experience",C)}}),e().createElement("strong",{className:Q().pk_score},a("pk.branch"))),f===o.length-1&&o.length>1&&!t&&!i?e().createElement(L.Z,{type:"link",icon:e().createElement(Ue.Z,null),onClick:()=>{this.handleDeleteRank(f)}},a("common.delete")):"")),!t&&!i&&o.length<100?e().createElement(L.Z,{type:"link",icon:e().createElement(m.Z,null),onClick:this.handleAddRanking},a("pk.addRank")):""))}}var Ie=(0,k.$j)((0,b.Z)()((0,H.Z)(nt)));class st extends e().Component{constructor(){super(...arguments);this.onChange=n=>{var t=n.target.value,a=this.props,s=a.onChangeShow,i=a.formik;s(t!==0),i.setFieldValue("whether_limit",t)}}render(){var n=this.props,t=n.value,a=n.t,s=n.isEdit,i=n.isPreview;return e().createElement(ee.ZP.Group,{onChange:this.onChange,size:"small",value:t,disabled:s||i},e().createElement(ee.ZP,{value:0},a("exam.unlimited")),e().createElement(ee.ZP,{value:1},a("pk.limit")))}}var rt=(0,k.$j)((0,b.Z)()((0,H.Z)(st))),Yt=r(43358),Ge=r(34041),it=r(39586),We=r.n(it),je=Ge.Z.Option;class lt extends e().Component{constructor(){super(...arguments);this.handleChange=(n,t)=>{var a=this.props.formik,s="";t==="input-number"?s="limit_times":s="limit_type",a.setFieldValue(s,n)}}render(){var n=this.props,t=n.defaultValue,a=n.t,s=n.isEdit,i=n.isPreview,l=t.limit_times,o=t.limit_type;return e().createElement("div",{className:We().set_pk_second_content},e().createElement(I.Z,{min:"1",max:"999",value:l,onChange:d=>{this.handleChange(d,"input-number")},disabled:s||i}),e().createElement("div",{className:We().pk_set_second_select},e().createElement(Ge.Z,{value:o,style:{width:80},onChange:d=>{this.handleChange(d,"select")},disabled:s||i},e().createElement(je,{value:"all"},a("pk.times")),e().createElement(je,{value:"day"},a("pk.day")))))}}var ot=(0,b.Z)()((0,k.$j)((0,H.Z)(lt)));class dt extends e().Component{constructor(){super(...arguments);this.state={isShowSecond:!1},this.handleChangeShow=n=>{this.setState({isShowSecond:n})},this.renderCommonLabel=(n,t)=>e().createElement(e().Fragment,null,e().createElement("span",{className:"pk_content_label_name"},n),e().createElement("span",{className:"pk_content_label_tip"},e().createElement(x.Z,{placement:"top",title:t},e().createElement(N.Z,null)))),this.renderQuestionTips=()=>{var n=this.props.t;return e().createElement(e().Fragment,null,e().createElement("p",{className:"pk_content_question_tip"},n("pk.questionTipsFirst")),e().createElement("p",{className:"pk_content_question_tip"},n("pk.questionTipsSecond")),e().createElement("p",{className:"pk_content_question_tip"},n("pk.questionTipsThird")))},this.renderTotoalScore=()=>{var n=this.props,t=n.t,a=n.values,s=0;if(a){var i=a.randomQuestion,l=i.single_num,o=i.judgment_num,d=Number(l)+Number(o);s=(Number(a.score)+Number(a.answer_time)*Number(a.answer_time_score))*d,s=s>=0?s:0}return e().createElement("div",null,e().createElement("div",{className:"total_score_row"},e().createElement("div",{className:"label_name"},t("pk.totalScore")),e().createElement("div",{className:"total_score"},s)),e().createElement("div",{className:"total_score_desc"},e().createElement("div",null,t("pk.totalScoreDesc")),e().createElement("div",{className:"examples"},e().createElement(x.Z,{placement:"top",title:this.renderExamples()},t("pk.examples")))))},this.renderTotoalQuestionsCount=n=>{var t=this.props.t;return e().createElement("div",null,e().createElement("div",{className:"total_score_row"},e().createElement("div",{className:"label_name"},this.renderCommonLabel(t("pk.totalQuestionCount"),t("pk.totalQuestionCountTips"))),e().createElement("div",{className:"total_score"},n)))},this.renderExamples=()=>{var n=this.props.t;return e().createElement("div",null,e().createElement("div",null,n("pk.totalScoreExam1")),e().createElement("div",null,n("pk.totalScoreExam2")))},this.renderOption=()=>{var n=this.props,t=n.isPreview,a=n.isEdit,s=n.saveNext,i=n.t,l=n.toEdit,o=n.cancelCreate,d="";return t||(d=e().createElement(L.Z,{type:"primary",className:"pk-save-next-btn",onClick:s},i("learning.learnUpgrade.saveAndNext"))),t&&a&&(d=e().createElement(L.Z,{htmlType:"submit",type:"primary",className:"pk-content-release"},i("common.release"))),e().createElement("div",{className:"operate_container"},d,t?e().createElement(L.Z,{className:"cancel_btn",onClick:l},i("common.return")):e().createElement(L.Z,{className:"cancel_btn",onClick:o},i("common.cancel")))}}componentDidMount(){var n=this.props.values,t=n.whether_limit;t&&this.setState({isShowSecond:!0})}render(){var n=this.props,t=n.t,a=n.values,s=n.isPreview,i=n.isEdit,l=this.state.isShowSecond,o=a.randomQuestion,d=o.single_num,c=o.judgment_num,h=1,f=Number(d)+Number(c);return f>0&&(h=f),e().createElement("div",{className:"pk_content"},e().createElement("div",{className:"pk_content__title"},t("pk.pkContent")),e().createElement("div",{className:"pk_content__title__sub"},e().createElement("span",{className:"dot"},"|"),t("pk.testScore")),e().createElement(k.gN,{name:"randomQuestion",label:t("exam.selectBank"),required:!0,defaultFieldList:a.randomQuestion,rewardScoreData:{time:a.answer_time,rewardScore:a.answer_time_score},isPreview:s,isEdit:!i,component:Ce,validate:C=>pe.questionLib(C)}),f>0?this.renderTotoalQuestionsCount(f):"",e().createElement("div",{className:"pk-base-content"},e().createElement("div",{className:"pk-item"},e().createElement(k.gN,{name:"score",label:t("pk.scoreForQuestion"),required:!0,defaultValue:a.score,isPreview:s,isEdit:!i,max:20,min:1,unit:t("common.score"),component:de,validate:C=>pe.inputNumber(C)})),e().createElement("div",{className:"pk-item"},e().createElement(k.gN,{name:"answer_time",label:this.renderCommonLabel(t("pk.timeToAnswer"),t("pk.answerTimeTip")),unit:t("pk.second"),required:!0,defaultValue:a.answer_time,isPreview:s,isEdit:!i,max:120,min:3,component:de,validate:C=>pe.inputNumberMin(C,"3")})),e().createElement("div",{className:"pk-item"},e().createElement(k.gN,{name:"answer_time_score",label:this.renderCommonLabel(t("pk.answerTimeScore"),t("pk.answerTimeScoreTips")),unit:t("common.score"),defaultValue:a.answer_time_score,isPreview:s,isEdit:!i,max:20,min:0,component:de,validate:C=>pe.inputNumberMin(C,"0")})),e().createElement("div",{className:"pk-item"},this.renderTotoalScore()),e().createElement("div",{className:"pk_content__title__sub"},e().createElement("span",{className:"dot"},"|"),t("pk.pkRule")),e().createElement("div",{className:"pk-item"},e().createElement(k.gN,{name:"expect_correct_num",label:t("pk.expectcorrectNum"),required:!0,defaultValue:a.expect_correct_num,isPreview:s,isEdit:!i,max:h,min:1,unit:t("pk.tiScore"),component:de,validate:C=>pe.inputNumber(C)})),e().createElement("div",{className:"pk-item"},e().createElement(k.gN,{label:t("pk.challengeTime"),required:!0,component:rt,isEdit:!i,isPreview:s,onChangeShow:this.handleChangeShow,name:"whether_limit"}),l?e().createElement(k.gN,{name:"limit_times",component:ot,defaultValue:a,required:!0,isEdit:!i,isPreview:s,validate:C=>pe.inputNumber(C)}):""),e().createElement("div",{className:"pk-item"},e().createElement(k.gN,{name:"gain_point",label:t("pk.gainPoint"),required:!1,unit:t("common.minute"),defaultValue:a.gain_point,isPreview:s,isEdit:!i,component:ve}),e().createElement(k.gN,{name:"gain_experience_point",label:t("pk.gainExperiencePoint"),required:!1,unit:t("common.minute"),defaultValue:a.gain_experience_point,isPreview:s,isEdit:!i,component:ve})),e().createElement("div",{className:"pk-item"},e().createElement(k.gN,{name:"deduction_point",label:t("pk.deductionsForFailure"),required:!1,unit:t("common.minute"),defaultValue:a.deduction_point,isPreview:s,isEdit:!i,component:ve}),e().createElement(k.gN,{name:"deduction_experience_point",label:t("pk.failGainExperiencePoint"),required:!1,unit:t("common.minute"),defaultValue:a.deduction_experience_point,isPreview:s,isEdit:!i,component:ve}))),e().createElement("div",{className:"pk-set-reword"},e().createElement(k.gN,{label:t("pk.leaderboardRewardsHigh"),component:Ie,name:"leaderboard_rewards_high",rewards_type:"high",isEdit:!i,isPreview:s})),e().createElement("div",{className:"pk-set-reword"},e().createElement(k.gN,{label:t("pk.leaderboardRewardsTotal"),component:Ie,name:"leaderboard_rewards_total",rewards_type:"total",isEdit:!i,isPreview:s})),a.challengeType===2?e().createElement("div",{className:"pk-set-reword"},e().createElement(k.gN,{label:t("pk.leaderboardRewardsGroupAverage"),component:Ie,name:"leaderboard_rewards_group_average",rewards_type:"group_average",isEdit:!i,isPreview:s})):"",this.renderOption())}}var mt=(0,b.Z)()(dt),Jt=r(14781),ct=r(53431),Xt=r(13254),Ke=r(14277),qt=r(71153),Oe=r(60331),ea=r(47673),pt=r(4107),ut=r(52670),ht=r(21063);class gt extends e().Component{constructor(){super(...arguments);this.handlePkGroupOk=n=>{var t=this.props,a=t.formik,s=t.rangeName,i=t.onPkGroupOk,l=n.rangeType,o=n.rangeList;a.setFieldValue(s,{rangeType:l,rangeList:o}),i(n)}}render(){var n=this.props,t=n.values,a=n.mode,s=n.showStudentList,i=n.handleDeleteRank,l=n.rangeName,o=n.onInputChange,d=n.groupName,c=n.t,h=n.competitionId,f=n.isEdit;return e().createElement(e().Fragment,null,t.challengeType===2?e().createElement("div",{className:"pk_group_name_content"},e().createElement("div",{className:"group_name"},e().createElement(k.gN,{name:d,label:c("pk.groupName"),required:!0,component:$e.Z,size:"middle",maxLength:32,type:"text",isPreview:!f,defaultValue:t[d],validate:C=>(0,Ae.QK)(C,c("pk.enterGroupName")),onInput:o})),f?e().createElement(L.Z,{type:"link",icon:e().createElement(Ue.Z,null),onClick:i},c("common.delete")):""):"",e().createElement(k.gN,{component:ht.Z,displayType:"Custom",name:l,mode:a,showSectitle:!1,isAssignRange:!0,defaultFieldList:t[l],isPkGroupSetting:t.challengeType===2,isShowPkStudentList:!!h,handleStudentList:s,onPkGroupOk:this.handlePkGroupOk,validate:ut.FI,disabled:!f,rangeType:f?2:1}))}}var vt=(0,k.$j)((0,b.Z)()(gt)),Qe=r(18329),Et=pt.Z.Search;class ft extends e().Component{constructor(n){super(n);this.onInputChange=(t,a)=>{this.commonChangeData({group_name:t},a)},this.getEmployeeArr=t=>{var a=t.dept,s=t.group,i=t.post,l=t.user;return[].concat(a,s,i,l)},this.handleAddPkGroup=()=>{var t=this.state.groupSetting,a=this.props.formik;if(t.length>=32){U.default.error("pk.maxLimitGroups");return}a.setFieldValue("group_name_".concat(t.length+1),""),a.setFieldValue("range_name_".concat(t.length+1),{rangeType:2,rangeList:{dept:[],post:[],group:[],user:[]}}),this.setState({groupSetting:t.concat({group_order:t.length+1,group_name:""})},()=>{a.setFieldValue("group_user_mapping",this.state.groupSetting)})},this.showStudentList=t=>{var a={pkListVisible:!0};t.id&&(a.team_id=t.id),this.setState(a,()=>{this.getStudentList()})},this.getStudentList=()=>{var t=this.props.competitionId,a=this.state,s=a.searchValue,i=a.currentPage,l=a.team_id,o={competitionId:t,name:s,page_number:i};l&&(o.team_id=l),(0,T.TF)(o).then(d=>{var c=d.data,h=c.success,f=c.data;h==="true"&&this.setState({peopleList:f.list,total:f.total})})},this.handleCancel=()=>{this.setState({pkListVisible:!1})},this.handleOk=()=>{this.handleCancel()},this.modalCancel=()=>{this.props.setHideVisible()},this.handlePkGroupOk=(t,a)=>{var s=t.rangeType,i=t.rangeList;this.commonChangeData({employeeRange:{rangeType:s,rangeList:i}},a)},this.commonChangeData=(t,a)=>{var s=this.props.formik,i=this.state.groupSetting;this.setState({groupSetting:i.map((l,o)=>a===o?(0,_.Z)((0,_.Z)({},l),t):l)},()=>{s.setFieldValue("group_user_mapping",this.state.groupSetting)})},this.handleDeleteRank=t=>{var a=this.props.formik,s=this.state.groupSetting,i=s;i.splice(t,1),this.setState({groupSetting:i},()=>{a.setFieldValue("group_user_mapping",this.state.groupSetting)})},this.renderViewGroupSetting=()=>{var t=this.state.groupSetting,a=this.props.t;return t.map((s,i)=>e().createElement("div",{key:i.toString(),className:"preview-group"},e().createElement("div",null,a("pk.groupName"),":",s.group_name),e().createElement("div",{className:"preview_item_tag-content"},e().createElement(e().Fragment,null,e().createElement("div",null,a("common.assignRange"),"\uFF1A"),s.employeeRange&&this.getEmployeeArr(s.employeeRange.rangeList).map((l,o)=>e().createElement(Oe.Z,{className:"card_item",key:o.toString()},l.name))))))},this.searchStudent=t=>{this.setState({searchValue:t},()=>{this.getStudentList()})},this.handleStudentListChange=t=>{this.setState({currentPage:t},()=>{this.getStudentList()})},this.state={pkListVisible:!1,groupSetting:[],peopleList:[],total:0,currentPage:1,team_id:""}}componentDidMount(){var n=this.props,t=n.values,a=n.formik,s=n.competitionId;t.challengeType===1?(t.group_user_mapping.length&&a.setFieldValue("group_user_mapping",[]),this.setState({groupSetting:[(0,_.Z)({},t.employeeRange)]})):t.group_user_mapping.length&&(s&&t.group_user_mapping.map((i,l)=>{var o=i.employeeRange;a.setFieldValue("group_name_".concat(l+1),i.group_name),a.setFieldValue("range_name_".concat(l+1),o)}),this.setState({groupSetting:t.group_user_mapping}))}render(){var n=this.props,t=n.t,a=n.values,s=n.isPreview,i=n.toPreview,l=n.toEdit,o=n.cancelCreate,d=n.competitionId,c=n.isEdit,h=this.state,f=h.pkListVisible,C=h.groupSetting,Z=h.peopleList,Y=h.total,ue=h.currentPage;return e().createElement("div",{className:"pk_setting"},e().createElement("div",{className:"pk_setting__title"},t(s?"component.preview":"learning.learnUpgrade.setUp")),s?e().createElement(e().Fragment,null,e().createElement("div",{className:"stage-preview-content-top"},t("learning.learnUpgrade.setUp")),e().createElement("div",{className:"preview_container"},a.challengeType===1?e().createElement("div",{className:"preview_item"},e().createElement("div",{className:"preview_item_assign-range"},t("common.assignRange"),":"),e().createElement("div",{className:"preview_item_tag-content"},a.employeeRange.rangeType===1?e().createElement(Oe.Z,{className:"card_item"},t("common.allCompany")):this.getEmployeeArr(a.employeeRange.rangeList).map(me=>e().createElement(Oe.Z,{className:"card_item",key:me.id},me.name)))):this.renderViewGroupSetting()),e().createElement("div",null,c?e().createElement(L.Z,{htmlType:"submit",type:"primary",className:"pk-setting-release"},t("common.release")):"",e().createElement(L.Z,{className:"cancel_btn",onClick:l},t("common.return")))):e().createElement(e().Fragment,null,C.map((me,te)=>e().createElement(vt,{key:te.toString(),groupName:"group_name_".concat(te+1),rangeName:a.challengeType===2?"range_name_".concat(te+1):"employeeRange",values:a,mode:a.challengeType===2?["part",""]:["all","part"],showStudentList:()=>{this.showStudentList(me)},onPkGroupOk:Se=>{this.handlePkGroupOk(Se,te)},onInputChange:Se=>{this.onInputChange(Se,te)},handleDeleteRank:()=>{this.handleDeleteRank(te)},competitionId:d,isEdit:c})),a.challengeType===2&&c?e().createElement(L.Z,{onClick:this.handleAddPkGroup,type:"link",icon:e().createElement(m.Z,null)},t("pk.addGroup")):"",e().createElement("div",null,e().createElement(L.Z,{type:"primary",htmlType:"submit",className:"pk-release-next-btn"},t("common.release")),e().createElement(L.Z,{className:"preview_btn",onClick:i},t("component.preview")),e().createElement(L.Z,{className:"cancel_btn",onClick:o},t("common.cancel")))),e().createElement(Qe.ZP,{title:t("pk.personList"),okText:t("common.ok"),cancelText:t("common.cancel"),size:"medium",destroyOnClose:!0,bodyStyle:{padding:"20"},maskClosable:!1,visible:f,onCancel:this.handleCancel,onOk:this.handleOk,wrapClassName:"pk-student-list-modal"},e().createElement(Et,{placeholder:t("pk.enterPersonSearch"),onSearch:this.searchStudent}),e().createElement("span",{className:"pk-group-list-line"}),e().createElement("div",{className:"pk-group-list-content"},Z.length?Z.map((me,te)=>e().createElement(L.Z,{key:te.toString()},me.name)):e().createElement(Ke.Z,{image:Ke.Z.PRESENTED_IMAGE_SIMPLE})),e().createElement("div",{className:"pk-student-list-pagination"},e().createElement(ct.Z,{pageSize:20,total:Y,current:ue,onChange:this.handleStudentListChange}))))}}var _t=(0,k.$j)((0,b.Z)()(ft)),yt=r(42154),Pe=r.n(yt),Ct=r(84874);class kt extends e().Component{constructor(){super(...arguments);this.handleCancel=()=>{this.props.modalCancel()},this.handleOk=()=>{this.props.conflictConfirm()}}render(){var n=this.props,t=n.modalVisible,a=n.t,s=n.data,i=n.delPost;return e().createElement(Qe.ZP,{title:a("pk.conflictDetails"),okText:a("common.ok"),cancelText:a("common.cancel"),size:"medium",destroyOnClose:!0,bodyStyle:{padding:"20"},maskClosable:!1,visible:t,onCancel:this.handleCancel,onOk:this.handleOk,wrapClassName:"pk-student-list-modal"},s.map((l,o)=>e().createElement("div",{key:o.toString(),className:Pe().conflict_student_content},e().createElement("div",{className:Pe().group_name},e().createElement("strong",null,a("pk.groupName"),"\uFF1A"),e().createElement("span",null,l.group_name)),e().createElement("div",{className:Pe().conflict_student_title},a("pk.conflictPerson")),e().createElement("div",{className:Pe().conflict_btn_content},l.user_infos.map((d,c)=>e().createElement(L.Z,{key:c.toString(),className:Pe().conflict_btn},d.user_name,e().createElement("a",{onClick:()=>{i(o,c)}},e().createElement(Ct.Z,{iconClass:"icon-guanbi",size:"12px"}))))))))}}var Pt=(0,b.Z)()(kt),St=r(4408),Re=r(37055),Tt=r(11449),Be=r(10237),Nt=E=>({userInfo:E.user});class Lt extends e().Component{constructor(n){var t;super(n);t=this,this.onChangeStep=a=>{var s=this.state,i=s.stepStyle,l=s.displayType,o=s.opearateStage;i[a-1]==="success"&&(l==="edit"?this.changeStage(a):a<o&&(o!==2||i[2]==="disabled")?this.changeStage(a):this.leftValidateForm(a))},this.initialValues={title:"",startTime:"",answer_time_score:1,expect_correct_num:1,gain_experience_point:0,deduction_experience_point:0,whether_limit:0,limit_times:1,limit_type:"all",endTime:"",displayType:"",challengeType:1,leaderboard_rewards_total:[],leaderboard_rewards_high:[],leaderboard_rewards_group_average:[],group_user_mapping:[],summary:"",datePicker:{startTime:"",endTime:""},oldDatePicker:{startTime:"",endTime:""},depart_post_group_mark:"",user_ids_mark:"",employeeRange:{rangeType:"",rangeList:{dept:[],post:[],group:[],user:[]}},randomQuestion:{bankQuestionVoList:[],single_num:0,judgment_num:0},answer_time:5,score:10,gain_point:0,deduction_point:0},this.getDetails=()=>{var a=this.state.competitionId,s=Re.ZP.pkGame.getDetails(a);Be.WY.get({url:s}).then(i=>{var l=i.data.data,o=l.question_vos,d=l.status,c=[];o instanceof Array&&o.length&&o.forEach(h=>{var f=h.single,C=h.trueOrFalse,Z={singleCount:f,trueOrFalseCount:C};c.push((0,_.Z)((0,_.Z)((0,_.Z)({},h),Z),{},{data:(0,_.Z)({},Z)}))}),this.initialValues={title:l.title,displayType:"",challengeType:l.type==="multiple"?1:2,summary:l.description,datePicker:{endTime:(0,g.k7)(Number(l.end_time)),startTime:(0,g.k7)(Number(l.start_time))},oldDatePicker:{endTime:(0,g.k7)(Number(l.end_time)),startTime:(0,g.k7)(Number(l.start_time))},employeeRange:{rangeType:l.is_all==="all"?1:2,rangeList:{dept:l.department_vos||[],post:l.post_vos||[],group:l.group_vos||[],user:l.users||[]}},randomQuestion:{bankQuestionVoList:c,single_num:l.single_num,judgment_num:l.judgment_num},score:l.score,answer_time:l.answer_time,gain_point:l.gain_point,deduction_point:l.deduction_point,answer_time_score:l.answer_time_score,expect_correct_num:l.expect_correct_num,gain_experience_point:l.gain_experience_point,deduction_experience_point:l.deduction_experience_point,whether_limit:l.whether_limit==="true"?1:0,limit_times:l.limit_times,limit_type:l.limit_type,leaderboard_rewards_total:l.leaderboard_rewards_total,leaderboard_rewards_high:l.leaderboard_rewards_high,leaderboard_rewards_group_average:l.leaderboard_rewards_group_average,group_user_mapping:l.group_user_mapping.map(h=>(h.employeeRange={rangeType:2,rangeList:{dept:h.department_vos||[],post:h.post_vos||[],group:h.group_vos||[],user:h.users||[]}},h)),depart_post_group_mark:l.depart_post_group_mark,user_ids_mark:l.user_ids_mark},this.setState({showLoading:!1,pkStatus:d,canEdit:l.can_edit==="true"},()=>{this.formRef.setFieldValue("displayType","add")})})},this.beforeSavePk=(0,g.E5)(a=>{var s=this.state.isSavePk;s&&this.setState({isSavePk:!1},()=>{this.savePk(a)})},1e3),this.savePk=a=>{var s=this.state.competitionId,i=s?Re.ZP.pkGame.edit(s):Re.ZP.pkGame.add();Be.WY.post({url:i,data:a}).then(l=>{var o=l.data,d=o.success,c=o.message,h=o.result_code,f=o.data;h==="1003"?this.setState({conflictData:f,conflictVisible:!0,isSavePk:!0}):d==="true"?this.setState({conflictVisible:!1},()=>{U.default.success(s?this.props.t("common.saveSuccess"):this.props.t("common.releaseSuccess")),q.m8.push("/talentedDevelopment/practiceMenu/pk_game")}):(U.default.error(c),this.setState({isSavePk:!0}))}).catch(()=>{this.setState({isSavePk:!0})})},this.filterData=a=>{var s=a.map(i=>i.id).join();return s},this.handleSubmit=()=>{var a=this.props.t,s=this.state,i=s.opearateStage,l=s.isPreview,o=s.stepStyle,d=s.conflictData;if(i<3&&!l)o[i]="success",this.setState({opearateStage:i+1,stepStyle:o});else{var c=this.formRef.state.values,h=c.title,f=c.datePicker,C=c.challengeType,Z=c.employeeRange,Y=c.randomQuestion,ue=c.answer_time,me=c.gain_point,te=c.deduction_point,Se=c.score,wt=c.summary,bt=c.answer_time_score,xt=c.expect_correct_num,Dt=c.gain_experience_point,It=c.deduction_experience_point,Ot=c.whether_limit,Rt=c.limit_times,Mt=c.limit_type,Ze=c.group_user_mapping,Ft=c.leaderboard_rewards_total,Vt=c.leaderboard_rewards_high,$t=c.leaderboard_rewards_group_average,At=Y.bankQuestionVoList,Ut=Y.single_num,Gt=Y.judgment_num,we=Z.rangeList,Wt=we.dept,jt=we.post,Kt=we.group,Me=we.user,He=[],ze=[];if(C===2&&Ze.length===0){U.default.error(a("pk.addGroupDesc"));return}if(C===2&&Ze.length===1){U.default.error(a("pk.setMoreGroup"));return}C===2&&Ze.length&&(He=Ze.map(he=>{var xe=he.employeeRange.rangeList,Qt=xe.dept,Bt=xe.group,Ht=xe.user,zt=xe.post;return(0,_.Z)((0,_.Z)({},he),{},{group_name:(0,g.fy)(he.group_name),depart_post_group_mark:{departments:this.filterData(Qt),posts:this.filterData(zt),groups:this.filterData(Bt)},user_ids_mark:this.filterData(Ht)})}),ze=d);var fe={title:(0,g.fy)(h),description:wt,end_time:(0,g.jZ)(f.endTime),start_time:(0,g.jZ)(f.startTime),answer_time_score:bt,expect_correct_num:xt,gain_experience_point:Dt,whether_limit:Ot,limit_type:Mt,deduction_experience_point:It,group_user_mapping:He,leaderboard_rewards_total:Ft,leaderboard_rewards_high:Vt,leaderboard_rewards_group_average:C===1?[]:$t,limit_times:Rt,type:C===1?"multiple":"team",is_all:Z.rangeType===1?"all":"part",user_ids:Me.length>0?Me.map(he=>he.id).join(","):"",question_bank:At.map(he=>he.id).join(","),single_num:Ut,judgment_num:Gt,answer_time:ue,score:Se,gain_point:me,deduction_point:te,user_ids_mark:C===2?"":this.filterData(Me),depart_post_group_mark:C===2?"":{departments:this.filterData(Wt),posts:this.filterData(jt),groups:this.filterData(Kt)},confirm_group_users:ze};for(var be in fe)(fe[be]instanceof Array&&!fe[be].length||fe[be]==="")&&delete fe[be];this.beforeSavePk(fe)}},this.toPreview=(0,w.Z)(X().mark(function a(){var s,i,l;return X().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,t.formRef.validateField("employeeRange");case 2:s=d.sent,i=t.formRef.state.values,l=i.challengeType,s&&l===1?t.formRef.setFieldTouched("employeeRange",!0):t.setState({isPreview:!0,opearateStage:1});case 6:case"end":return d.stop()}},a)})),this.cancelCreate=()=>{q.m8.push("/talentedDevelopment/practiceMenu/pk_game")},this.toEdit=()=>{this.setState({isPreview:!1,opearateStage:3})},this.leftValidateForm=a=>{this.formRef.validateForm().then(s=>{Object.keys(s).length===0?this.setState({opearateStage:a}):this.dealNormalError(s)})},this.dealNormalError=a=>{for(var s in a)if(a[s]){this.formRef.setFieldTouched(s,!0);return}},this.changeStage=a=>{this.setState({opearateStage:a})},this.initRef=a=>{this.formRef=a},this.delPost=(a,s)=>{var i=this.state.conflictData,l=i[a].user_infos;l.splice(s,1),this.setState({conflictData:i.map((o,d)=>d===a?(0,_.Z)((0,_.Z)({},o),{},{user_infos:l}):o)})},this.setHideVisible=()=>{this.setState({conflictVisible:!1,conflictData:[]})},this.conflictConfirm=()=>{this.handleSubmit()},this.saveNext=()=>{this.formRef.submitForm()},this.state={operateStageList:[{key:1,name:n.t("learning.learnUpgrade.bascInfo")},{key:2,name:n.t("pk.pkContent")},{key:3,name:n.t("learning.learnUpgrade.setUp")}],opearateStage:1,isPreview:!1,competitionId:"",showLoading:!0,stepStyle:["success","disabled","disabled"],displayType:"add",canEdit:!0,conflictData:[],conflictVisible:!1,isSavePk:!0,pkStatus:"un_start"}}componentDidMount(){var n=ge.parse(q.m8.location.search),t=n.id;t?this.setState({competitionId:t,displayType:"edit",stepStyle:["success","success","success"]},()=>{this.getDetails(t)}):this.setState({showLoading:!1},()=>{this.formRef.setFieldValue("displayType","add")})}render(){var n=this.state,t=n.competitionId,a=n.operateStageList,s=n.opearateStage,i=n.isPreview,l=n.showLoading,o=n.displayType,d=n.stepStyle,c=n.canEdit,h=n.conflictData,f=n.conflictVisible,C=n.pkStatus,Z=this.props.t;return l?e().createElement(re.Z,null):(t&&(document.title=Z("pk.edit")),e().createElement(Tt.Z,{pageContainerParams:{header:{title:Z(t?"pk.edit":"pk.add")}}},e().createElement("div",{className:"add_pkgame"},e().createElement(St.Z,{title:Z(t?"pk.edit":"pk.add")}),e().createElement("div",{className:"form-page-container"},e().createElement(B.Z,{className:"form-page-container-row",justify:"space-between"},e().createElement(W.Z,{className:"form-page-aside form-page-left"},e().createElement(_e,{title:Z(t?"pk.edit":"pk.add"),operateStageList:a,onChangeStep:this.onChangeStep,opearateStage:s,displayType:o,stepStyle:d})),e().createElement(W.Z,{className:"form-page-aside form-page-right"},e().createElement(k.J9,{ref:this.initRef,initialValues:this.initialValues,onSubmit:this.handleSubmit,render:Y=>e().createElement(k.l0,{className:"cl-form"},s===1&&e().createElement(tt,(0,G.Z)({},Y,{isPreview:i,isEdit:c,toEdit:this.toEdit,competitionId:t,cancelCreate:this.cancelCreate,pkStatus:C})),s===2&&e().createElement(mt,(0,G.Z)({},Y,{isPreview:i,isEdit:c,cancelCreate:this.cancelCreate,toEdit:this.toEdit,saveNext:this.saveNext,pkStatus:C})),s===3&&e().createElement(_t,(0,G.Z)({},Y,{isPreview:i,toPreview:this.toPreview,toEdit:this.toEdit,cancelCreate:this.cancelCreate,competitionId:t,isEdit:c,pkStatus:C})))})))),f?e().createElement(Pt,{modalVisible:f,modalCancel:this.setHideVisible,data:h,delPost:this.delPost,conflictConfirm:this.conflictConfirm}):"")))}}var Zt=(0,ie.$j)(Nt)((0,b.Z)()(Lt))},96627:function(De,se,r){"use strict";r.d(se,{TF:function(){return G},qU:function(){return $},SN:function(){return W},Ve:function(){return Te},XL:function(){return re}});var M=r(37055),B=r(10237);function G(w){var A=w.competitionId,U=w.page_size,_=U===void 0?20:U,J=w.page_number,X=J===void 0?1:J,v=w.name,e=v===void 0?"":v,ie=w.team_id,k=ie===void 0?"":ie,ge=M.ZP.pkGame.getStudentList(A),b={competitionId:A,page_size:_,page_number:X,name:e};return k&&(b.team_id=k),B.WY.get({url:ge,params:b})}function $(w){var A=M.ZP.pkGame.endPk(w);return B.WY.get({url:A})}function W(w){var A=M.ZP.pkGame.removeQuestionRef(w);return B.WY.get({url:A})}function Te(w){var A=w.params,U=w.competitionId,_=M.ZP.pkGame.getAnswerRecordList(U,A.userId);return B.WY.get({url:_,params:A})}function re(){var w=M.ZP.pkGame.queryIsNewExam();return B.WY.get({url:w})}},21063:function(De,se,r){"use strict";var M=r(62029),B=r(63185),G=r(9676),$=r(57663),W=r(71577),Te=r(49111),re=r(19650),w=r(22385),A=r(31097),U=r(88983),_=r(47933),J=r(88986),X=r(12924),v=r.n(X),e=r(91768),ie=r(28216),k=r(96486),ge=r.n(k),b=r(80991),q=r(68628),ce=r(49101),_e=r(57119),Ne=r(43859),L=r(37055),H=r(10237),Le=r(84874),ee=r(88311),ye=r(8908),R=r(60667),F=r(26885),x=V=>{var S=V.advancedSetting,N=V.user;return{user:N,themeColor:S.themeColor}},D=()=>{};class I extends v().Component{constructor(S){var N;super(S);N=this,this.getUserManageRange=()=>{var m=L.ZP.Role.getUserManageRange();H.WY.get({url:m}).then(function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=p.data,y=u===void 0?{}:u,g=y.range_type;N.setState({userManageType:g})})},this.handleChange=m=>{var p=m.target.value;this.setState({rangeType:p}),this.triggerChange({rangeType:p,rangeList:this.state.rangeList})},this.triggerChange=m=>{var p=m.rangeType,u=m.rangeList,y=this.props,g=y.isPkGroupSetting,P=y.onPkGroupOk;if(g){P({rangeType:p,rangeList:u});return}var T=this.props.from,O={rangeType:p,rangeList:u},j=localStorage.getItem("authorityType"),K=this.props.user.loginMode;T!=="employees"&&K==="WE_COM"&&j==="1"&&(O.qyWeChatVo=this.state.qyWeChatVo),T!=="employees"&&K==="WE_COM"&&j==="0"&&(O.qyWeChatVo=JSON.stringify({userList:u.user,departmentList:u.dept})),this.props.formik.setFieldValue("employeeRange",O)},this.handleOk=m=>{this.setRangeList(m)},this.setRangeList=m=>{var p=m.dept,u=m.group,y=m.post,g=m.user,P={dept:p,post:y,group:u,user:g};this.setState({rangeList:P,visible:!1}),this.triggerChange({rangeType:this.state.rangeType,rangeList:P})},this.importModalVisibility=function(m){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:D;N.setState({importVisible:m,rangeType:2},()=>{p()})},this.handleImportOk=m=>{var p=this.state.rangeList,u=p.user,y=u===void 0?[]:u,g=[...m,...y],P=(0,k.uniqBy)(g,"id");this.setState({rangeList:(0,J.Z)((0,J.Z)({},p),{},{user:P})},()=>{this.triggerChange({rangeType:this.state.rangeType,rangeList:this.state.rangeList}),this.importModalVisibility(!1)})},this.handleImportCancel=()=>{this.importModalVisibility(!1)},this.handleCancel=()=>{this.setOrgModalVisibility(!1)},this.handleDeleteItem=m=>{var p=(0,J.Z)({},this.state.rangeList),u,y;for(var g in p)if(u=p[g].findIndex(T=>T.id===m),u>-1){y=g;break}var P=[...p[y]];P.splice(u,1),p[y]=P,this.setState({rangeList:p}),this.triggerChange({rangeType:this.state.rangeType,rangeList:p})},this.handleSelectWx=()=>{var m=this.props.user,p=this.state.rangeList.user.map(u=>u.unionid||u.user_id||u.userId);(0,F.Sk)({userIds:p}).then(u=>{(0,F.$f)({result:u,user:m}).then(y=>{var g=y.qyWeChatVo,P=y.rangeList;this.setState({qyWeChatVo:g},()=>{this.handleOk(P)})})}).catch(()=>{this.handleCancel()})},this.setOrgModalVisibility=function(m){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:D,u=localStorage.getItem("authorityType"),y=N.props.user.loginMode,g=N.props.from;g!=="employees"&&m&&N.props.qwTicketShow&&y==="WE_COM"&&u==="1"?(N.handleSelectWx(),N.setState({rangeType:2})):N.setState({visible:m,rangeType:2},()=>{p()})},this.renderRadioGroup=()=>{var m=this.props,p=m.prefixCls,u=m.t,y=m.showSectitle,g=m.secTitle,P=g===void 0?u("common.assignRange"):g,T=m.secTitleInfoTip,O=T===void 0?"":T;return y?v().createElement("div",{className:"".concat(p,"__radios")},v().createElement("div",{className:"cl-form__sectitle"},P,O&&v().createElement("span",{className:"cl-form__sectitle__infotip"},O),this.renderRadios())):this.renderRadios()},this.handleVisibleType=m=>{var p=this.state.rangeType,u=m.target.value;this.setState({visibleType:u,rangeType:u==="follow"?0:p||3},()=>{this.triggerChange({rangeType:u==="follow"?0:p||3,rangeList:this.state.rangeList})})},this.renderRadios=()=>{var m=this.props,p=m.mode,u=m.t,y=m.prefixCls,g=m.rangeAuth,P=m.disabledAdd,T=m.themeColor,O=m.onlyDept,j=m.rangeType,K=m.handleStudentList,le=m.isShowPkStudentList,oe=this.props.partLabel,ae=oe===void 0?u("common.deptAndStu"):oe,ne=this.state,Ce=ne.resourceViewRange,de=ne.visibleType,ve=ne.userManageType,z=!!(j&&j!==2);return P?null:v().createElement("div",{className:"visible-range-setting"},p.includes("follow")&&v().createElement(_.ZP.Group,{name:"visibleType",value:de,onChange:this.handleVisibleType},v().createElement(_.ZP,{value:"follow"},u("course.followClassify")),v().createElement(_.ZP,{value:"define"},u("course.customRange"))),(this.state.rangeType>0||p.length===1||!p.includes("follow"))&&v().createElement("div",{className:"custom-range-setting"},v().createElement(_.ZP.Group,{name:"rangeGroup",value:this.state.rangeType,disabled:this.props.disabled,onChange:this.handleChange},p.includes("all")&&v().createElement(_.ZP,{value:1,disabled:ve!=="all"},u("common.allCompany"),g&&Ce&&v().createElement(A.Z,{title:u("setting.selectPeopleTip")},v().createElement("span",null,v().createElement(q.Z,null)))),p.includes("under")&&v().createElement(_.ZP,{value:4},v().createElement(re.Z,null,u("setting.jurisdictionAndSubordinate"),v().createElement(A.Z,{title:u("setting.underTip")},v().createElement("span",null,v().createElement(q.Z,null))))),p.includes("private")&&v().createElement(_.ZP,{value:3},u("common.onlySelf")),p.includes("part")&&p.length>1&&v().createElement(_.ZP,{value:2},ae),v().createElement(re.Z,null,!O&&v().createElement(W.Z,{className:"qa-assign-employee-selector",style:z?{}:{color:T,border:"1px solid ".concat(T)},icon:v().createElement(ce.Z,null),disabled:z,onClick:()=>this.importModalVisibility(!0)},u("component.importPerson")),v().createElement(W.Z,{style:z?{}:{color:T,border:"1px solid ".concat(T)},className:"".concat(y,"__addbtn qa-assign-employee-selector"),icon:v().createElement(ce.Z,null),disabled:z,onClick:()=>this.setOrgModalVisibility(!0)},u("common.select")),le?v().createElement(W.Z,{style:z?{}:{color:T,border:"1px solid ".concat(T)},onClick:K,disabled:z},u("pk.viewStudents")):""))))},this.renderGallery=()=>{var m=this.props.prefixCls,p=this.state.rangeType;return p!==2?null:v().createElement("div",{className:"".concat(m,"__gallery")},this.renderGropuGallery(),this.renderUserGallery())},this.renderGropuGallery=()=>{var m=this.props,p=m.prefixCls,u=m.t,y=this.state.rangeList,g=y.dept,P=y.group,T=y.post,O=[...g,...P,...T];return O.length?v().createElement("div",{className:"".concat(p,"__gallery__row cl-clearfix")},v().createElement("span",{className:"".concat(p,"__gallery__row__title")},u("common.selectedGroups"),"\uFF1A"),v().createElement("div",{className:"".concat(p,"__gallery__row__container cl-clearfix")},O.map(j=>this.renderGalleryItem(j,"dept")))):null},this.renderUserGallery=()=>{var m=this.props,p=m.prefixCls,u=m.t,y=this.state.rangeList.user,g=[...y];return g.length?v().createElement("div",{className:"".concat(p,"__gallery__row cl-clearfix")},v().createElement("span",{className:"".concat(p,"__gallery__row__title")},u("common.selectedUsers"),"\uFF1A"),v().createElement("div",{className:"".concat(p,"__gallery__row__container cl-clearfix")},g.map(P=>this.renderGalleryItem(P,"user")))):null},this.renderGalleryItem=(m,p)=>{var u=this.props,y=u.prefixCls,g=u.disabled,P=u.qwTicketShow,T=u.from,O="".concat(y,"__gallery__row__item"),j=this.props.user.loginMode,K=localStorage.getItem("authorityType"),le=T!=="employees"&&P&&K==="1"?m.unionid||m.userId||m.user_id||m.id:m.unionid||m.user_id,oe=m.source_type||m.sourceType,ae={user:"userName",dept:"departmentName"}[p]||"",ne={user:le,dept:m.id}[p]||m.id;return v().createElement("span",{className:O,key:m.id},v().createElement(R.Z,{dataType:ae,value:ne,name:m.name,type:oe}),g||T!=="employees"&&K==="1"&&P&&j==="WE_COM"?null:v().createElement("span",{className:"item-icon",onClick:()=>this.handleDeleteItem(m.id)},v().createElement(Le.Z,{iconClass:"icon-guanbi",size:"12px"})))},this.state={rangeType:S.defaultFieldList.rangeType,rangeList:S.defaultFieldList.rangeList||{},visible:!1,visibleType:S.defaultFieldList.rangeType===0?"follow":"define",userManageType:"all",importVisible:!1,qyWeChatVo:""}}componentDidMount(){this.getUserManageRange()}renderTransfer(){var S=g=>{this.props.formik.setFieldValue("open_transfer_student",g.target.checked)},N=this.props,m=N.prefixCls,p=N.t,u=N.formik.values.open_transfer_student,y=u===void 0?!1:u;return v().createElement("div",{className:"".concat(m,"__transfer")},v().createElement(G.Z,{onChange:S,checked:y},p("course.transferJoin")),v().createElement(A.Z,{title:p("course.transferJoin")},v().createElement(_e.Z,null)))}render(){var S=this.props,N=S.prefixCls,m=S.orgProps,p=S.onlyDept,u=p===void 0?!1:p,y=S.onlyPost,g=y===void 0?!1:y,P=S.onlyChooseDept,T=P===void 0?!1:P,O=S.t,j=S.isAssignRange,K=S.noBorder,le=S.transferVisible,oe=le===void 0?!1:le,ae=this.state,ne=ae.rangeList,Ce=ae.visible,de=ae.importVisible;return v().createElement("div",{className:K?"":"visible-range-out"},K?null:v().createElement("div",{className:"visible-range-out-title"},O(j?"common.assignRange":"learning.learnUpgrade.visibleRange")),v().createElement("div",{className:"visible-range-out-inner".concat(K?"-no":"")},v().createElement("section",{className:"".concat(N)},this.renderRadioGroup(),this.renderGallery(),v().createElement(ee.Z,(0,M.Z)({},m,{visible:Ce,initData:ne,displayType:T?["dept"]:u&&g?["dept","post"]:["dept","group","post"],onlyDept:u,onlyPost:g,onOk:this.handleOk,onCancel:this.handleCancel})),v().createElement(ye.Z,{visible:de,onOk:this.handleImportOk,onCancel:this.handleImportCancel})),oe&&v().createElement("section",{className:"".concat(N)},this.renderTransfer())))}}I.defaultProps={prefixCls:"cl-employee-selector",showSectitle:!0,mode:["all","part"],orgProps:{},resourceViewRange:!1},se.Z=(0,ie.$j)(x)((0,b.$j)((0,Ne.Z)((0,e.Z)()(I))))}}]);
