(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[7075],{26096:function(se,W,t){"use strict";var U=t(30887),$=t(99210),_=t(62029),p=t(22385),b=t(31097),y=t(12924),i=t.n(y),T=t(71967),K=t.n(T),k=t(1164),B=m=>m.type==="more"?m.disabled?i().createElement($.Z.Item,(0,_.Z)({},m,{key:m.key,disabled:!0}),m.tooltip?i().createElement(b.Z,{title:m.tooltip},i().createElement("p",{className:"cl-dropdown-menuitem"},m.title)):i().createElement("p",{className:"cl-dropdown-menuitem"},m.title)):m.link?i().createElement($.Z.Item,(0,_.Z)({},m,{key:m.key}),i().createElement(k.Z,{to:m.link},i().createElement("p",{className:"cl-dropdown-menuitem"},m.title))):i().createElement($.Z.Item,(0,_.Z)({},m,{key:m.key}),i().createElement("p",{className:"cl-dropdown-menuitem",onClick:m.click},m.title)):m.disabled?m.tooltip?i().createElement(i().Fragment,{key:m.key},i().createElement(b.Z,{title:m.tooltip},i().createElement("span",{className:"".concat(K().pointer," ").concat(K().disabled)},m.title))):i().createElement(i().Fragment,{key:m.key},i().createElement("span",{className:"".concat(K().pointer," ").concat(K().disabled)},m.title)):m.link?i().createElement(i().Fragment,{key:m.key},i().createElement(k.Z,{to:m.link},i().createElement("span",{className:"cl-pointer ".concat(K().pointer)},m.title))):i().createElement(i().Fragment,{key:m.key},i().createElement("span",{className:"cl-pointer ".concat(K().pointer),onClick:m.click},m.title));W.Z=B},30389:function(se,W,t){"use strict";t.d(W,{Z:function(){return v}});var U=t(62029),$=t(20228),_=t(11382),p=t(12924),b=t.n(p),y=t(91768),i=t(80991),T={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},K=t(62615),k=t(52670);class B extends b().Component{render(){var c=this.props,O=c.values,g=c.mode,E=c.onlyChooseDept,S=c.reserveUser,G=c.t,z=c.orgProps,H=c.rangeAuth,q=c.projectId,w=c.onCancel,Q=c.onlyCreateUser;return b().createElement(i.l0,{className:"cl-form"},b().createElement(i.gN,(0,U.Z)({component:K.ww,displayType:"Custom",showSectitle:!1,name:"employeeRange",label:G("common.visibleRange"),defaultFieldList:O.employeeRange,validate:k.FI,mode:g,rangeAuth:H,onlyChooseDept:E,onlyCreateUser:Q,orgProps:z,reserveUser:S,projectId:q,onCancel:w,qwTicketShow:!0},T)))}}var m=(0,y.Z)()(B),F=t(18329),I=t(34773);class a extends b().Component{constructor(){super(...arguments);this.initRefFormik=c=>{this.refFormik=c},this.handleBeforeCreate=()=>{var c=this.refFormik;c.submitForm(),c.runValidations().then(O=>{if(!Object.keys(O).length){var g=c.state.values.employeeRange,E=(0,I.b)(g.rangeList),S={qyWeChatVo:g.qyWeChatVo,id:this.props.actionId,isAll:g.rangeType,groupIds:g.rangeType===2?E.groupIds.join(","):"",departmentIds:g.rangeType===2?E.deptIds.join(","):"",userIds:g.rangeType===2?E.userIds.join(","):"",postIds:g.rangeType===2?E.postIds.join(","):"",clusterIds:g.rangeType===2?E.clusterIds.join(","):"",qy_we_chat_vo:g.qyWeChatVo};this.props.onCreate(S)}})},this.handleBeforeCancel=()=>{var c=this.props.onCancel;c()}}render(){var c=this.props,O=c.visible,g=c.initialParams,E=c.isLoading,S=c.tipInfo,G=c.mode,z=c.onlyChooseDept,H=c.reserveUser,q=H===void 0?[]:H,w=c.t,Q=c.title,D=c.orgProps,A=c.rangeAuth,N=c.projectId,P=c.onCancel,j=c.onlyCreateUser,x=c.size;return E?b().createElement(_.Z,{size:"large"}):b().createElement(F.ZP,{wrapClassName:"cl-employee-selector-modal",visible:O,title:Q||w("component.changeUser"),okText:w("common.ok"),cancelText:w("common.cancel"),size:x,onCancel:this.handleBeforeCancel,onOk:this.handleBeforeCreate},E?b().createElement(_.Z,{size:"large"}):b().createElement(i.J9,{ref:this.initRefFormik,initialValues:g,render:Y=>b().createElement(m,(0,U.Z)({},Y,{mode:G,rangeAuth:A,orgProps:D,onlyChooseDept:z,onlyCreateUser:j,reserveUser:q,projectId:N,onCancel:P}))}),S&&b().createElement("p",{style:{padding:"0 24px",wordBreak:"break-all",whiteSpace:"normal"}},S))}}a.defaultProps={visible:!1,initialParams:{employeeRange:{rangeType:1,rangeList:{dept:[],post:[],group:[],user:[],cluster:[]}}},tipInfo:"",isLoading:!1,mode:["all","part"],onlyChooseDept:!1,onlyCreateUser:!1,orgProps:{},onCancel:()=>{},onCreate:()=>{},size:"middle"};var v=(0,y.Z)()(a)},16598:function(se,W,t){"use strict";var U=t(59250),$=t(13013),_=t(30887),p=t(99210),b=t(62029),y=t(12924),i=t.n(y),T=t(57254),K=t(91768),k=t(26096),B=(F,I)=>{var a=F.map(v=>i().createElement(k.Z,(0,b.Z)({},v,{type:I,key:v.key||v.type})));return I==="more"?i().createElement(p.Z,null,a):a},m=F=>{var I=F.buttons,a=F.t,v=F.visibleNum,M=I.filter(E=>E.visible),c=v||1,O=[],g=[];if(M.length<=c)g=[...M];else if(M.length>c)g=[...M.slice(0,c)],O=[...M.slice(c)];else return"/";return i().createElement("div",{className:"cl-table__cell-action"},B(g),g.some(E=>E.visible)&&O.some(E=>E.visible)?i().createElement(i().Fragment,null,i().createElement("span",{className:"cl-pointer-divide"}),i().createElement($.Z,{overlay:B(O,"more")},i().createElement("span",{className:"cl-pointer"},a("common.more")," ",i().createElement(T.Z,null)))):null)};m.defaultProps={visibleNum:1},W.Z=(0,K.Z)()(m)},11449:function(se,W,t){"use strict";t.d(W,{Z:function(){return Q}});var U=t(88986),$=t(33565),_=t(12924),p=t.n(_),b=t(3115),y=t(49111),i=t(19650),T=t(62029),K=t(57663),k=t(71577),B=t(91768),m=t(28216),F=t(37055),I=t(10237);function a(D){var A=F.ZP.getHelpContentByMenuKey(),N={key:D};return I.WY.get({url:A,params:N})}var v=t(74228),M=t.n(v),c=t(1164),O=t(76466),g=t(38642);class E extends p().Component{constructor(A){var N;super(A);N=this,this.getHelpContentByMenuKey=()=>{var P=this.props.defaultMenuKey;a(P).then(j=>{var x=j.data,Y=x.help_url,ne=x.video_url;this.setState({videoUrl:ne,helpUrl:Y})})},this.handleOpenHelpUrl=P=>{if((0,g.ve)()){window.open(P,"_blank");return}c.Z.targetTo({path:P,isExternalLink:!0})},this.handleOpenVideo=function(P){var j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:N.props.t("helpCenter.video");N.setState(x=>({resourcePlayInfo:(0,U.Z)((0,U.Z)({},x.resourcePlayInfo),{},{resourceInfo:{originUrl:P,source:{FD:P,OD:P},contentType:"mp4"}}),previewInfo:(0,U.Z)((0,U.Z)({},x.previewInfo),{},{title:j,visible:!0,onCancel:N.handleCancelPreview})}))},this.handleCancelPreview=()=>{var P=this.state.previewInfo;this.setState({resourcePlayInfo:{mode:"preview",watchType:"video",resourceInfo:{}},previewInfo:(0,U.Z)((0,U.Z)({},P),{},{visible:!1})})},this.state={helpUrl:"",videoUrl:"",resourcePlayInfo:{autoPlay:!0,draggable:!0,mode:"preview",resourceInfo:{},watchType:"video"},previewInfo:{visible:!1,destroyOnClose:!0,title:A.t("helpCenter.video")||"\u89C6\u9891\u6307\u5BFC",onCancel:()=>{}}}}componentDidMount(){this.getHelpContentByMenuKey()}render(){var A=this.state,N=A.helpUrl,P=A.resourcePlayInfo,j=A.previewInfo,x=A.videoUrl,Y=this.props.t;return p().createElement("div",{className:M().helpCenter},x&&p().createElement(k.Z,{type:"link",className:M()["video-btn"],style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenVideo(x)},Y("helpCenter.video")),N&&p().createElement(k.Z,{type:"link",style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenHelpUrl(N)},Y("helpCenter.tutorial")),p().createElement(O.Z,(0,T.Z)({},P,{previewInfo:j})))}}var S=D=>({defaultMenuKey:D.currentRoute.menuKey});E.defaultProps={defaultMenuKey:""};var G=(0,m.$j)(S)((0,B.Z)()(E));function z(D){var A=D.extra,N=localStorage.getItem("dingPersonnel"),P=sessionStorage.getItem("dingPersonnel");return p().createElement(i.Z,null,A,N!=="dingPersonnel"&&P!=="dingPersonnel"&&(0,g.eY)("COMMONEXTRA_HELP_CENTER")&&p().createElement(G,null))}var H=z,q=t(4408);function w(D){var A=(0,_.useState)({helpCenter:(0,g.eY)("HEAD_HELP_CENTER_BUT")}),N=(0,$.Z)(A,1),P=N[0],j=D.pageContainerParams,x=j===void 0?{}:j,Y=D.noPadding,ne=Y===void 0?!1:Y,ie=D.isPersonal,le=ie===void 0?!1:ie,oe=D.pageTitle,re=D.className,de=re===void 0?"":re,ce={extra:P.helpCenter?p().createElement(H,{extra:x.extra}):x.extra},me=(0,U.Z)((0,U.Z)({},x),ce);return p().createElement("div",{className:"page-container-content ".concat(ne?"page-container-noPadding":""," ").concat(le?"page-container-content_personal_background":""," ").concat(de)},oe&&p().createElement(q.Z,{title:oe}),le?p().createElement(b.Z,null,D.children):p().createElement(b.Z,me,D.children))}var Q=w},90259:function(se,W,t){"use strict";var U=t(71194),$=t(57016),_=t(66456),p=t(55313),b=t(57663),y=t(71577),i=t(12924),T=t.n(i),K=t(28216),k=t(91768),B=t(6793),m=I=>{var a=I.advancedSetting,v=I.user;return{themeColor:a.themeColor,userInfo:v}};class F extends i.Component{constructor(a){super(a);this.state={}}render(){var a=this.props,v=a.t,M=a.toolsList,c=a.visible,O=a.onCancel,g=a.operation,E=a.resourceName,S=a.isShowType,G=a.isNewEvaluationAbility,z=[{title:v("common.number"),render:(q,w,Q)=>Q+1,width:"25%"}];if(S){var H=[{title:v("common.name"),key:"value",dataIndex:"value"}];G&&H.push({title:v("study.type"),key:"type",dataIndex:"type",width:"25%",render:(q,w)=>w.type==="qz"?v("personnelDevelope.qualificationName"):v("leftMenuLists.evaluateTask")}),z=z.concat(H)}else z.push({title:v("personal.belongTaskName"),width:"75%"});return T().createElement($.Z,{visible:c,title:(0,B.ZT)(v("component.deleteReminder"),v(g==="delete"?"common.delete":"common.edit")),onOk:()=>O(),onCancel:()=>O(),destroyOnClose:!0,footer:T().createElement(y.Z,{key:"back",onClick:()=>O()},v("common.close")),width:600,bodyStyle:{height:"400px",overflow:"auto"}},T().createElement("span",{style:{marginBottom:5}},E,v(g==="delete"?"evaluation.reference":"evaluation.referenceEdit")),T().createElement(p.Z,{columns:z,dataSource:M,pagination:!1}))}}W.Z=(0,K.$j)(m)((0,k.Z)()(F))},1310:function(se,W,t){"use strict";var U=t(66456),$=t(55313),_=t(12924),p=t.n(_),b=t(91768);class y extends _.Component{constructor(T){super(T);this.columns=[{title:T.t("common.number"),render:(K,k,B)=>B+1,width:"25%"},{title:T.t("evaluationManage.toolName"),width:"75%"}]}render(){var T=this.props.toolsList;return p().createElement("div",{className:"ability_query_modal"},p().createElement($.Z,{columns:this.columns,dataSource:T,pagination:!1}))}}W.Z=(0,b.Z)()(y)},82692:function(se,W,t){"use strict";t.r(W),t.d(W,{default:function(){return Te}});var U=t(14781),$=t(53431),_=t(22385),p=t(31097),b=t(57663),y=t(71577),i=t(88986),T=t(47673),K=t(4107),k=t(43358),B=t(34041),m=t(18106),F=t(88108),I=t(12924),a=t.n(I),v=t(91768),M=t(76651),c=t(57068),O=t(49101),g=t(1870),E=t(68628),S=t(56075),G=t(62029),z=t(71194),H=t(57016),q=t(34792),w=t(48086),Q=t(28216),D=t(78138),A=t.n(D),N=t(90259),P=t(1310),j=t(36202),x=t(16598),Y=t(30389),ne=J=>{var l=J.advancedSetting,e=J.user;return{themeColor:l.themeColor,userInfo:e}};class ie extends I.Component{constructor(l){super(l);this.onExportTemplate=()=>{this.setState({templateVisible:!1})},this.onCancelExport=()=>{this.setState({templateVisible:!1})},this.handleShowToolModal=e=>{this.setState({templateVisible:!0},()=>{(0,S.yx)({id:e.id}).then(s=>{this.setState({toolsList:s.data.list})})})},this.handleSetCase=e=>{this.props.setShowCase&&this.props.setShowCase([e],"row",e.source)},this.handleSetEmployeeRange=e=>{var s=e.record;(0,S.Ys)(s.id).then(n=>{var r=n.data,d=r.visible_range,u=r.user_list,o=r.group_list,h=r.post_list,L=r.department_list,R={all:1,part:2,myself:3}[d]||1,C=[];this.setState({employeeProps:{visible:!0,actionId:[s.id],initialParams:{employeeRange:{rangeType:R,rangeList:{dept:L,post:h,group:o,user:u}}},reserveUser:C}})})},this.multSetVisible=e=>{this.setState({employeeProps:e})},this.handleEmployeeCancel=()=>{this.setState(e=>({employeeProps:(0,i.Z)((0,i.Z)({},e.employeeProps),{},{visible:!1})}))},this.handleEmployeeOk=e=>{var s=this.props,n=s.onForceRender,r=s.t,d=s.userInfo,u=e.isAll,o=e.departmentIds,h=e.groupIds,L=e.postIds,R=e.userIds,C=e.id,V={department_ids:o,group_ids:h,visible_range:{1:"all",2:"part"}[u]||"myself",post_ids:L,user_ids:R,ability_ids:C.join(","),userId:d.id};(0,S.sG)(V).then(ee=>{ee.data.code===0&&(w.default.success(r("setting.setUpSucceed")),this.handleEmployeeCancel(),n())})},this.handleEdit=e=>{M.m8.push("/talentedDevelopment/evaluationMenu/evaluationAbility/add?id=".concat(e.id))},this.beforeOperate=e=>{(0,S.TK)(e.id).then(s=>{s.data.code===0&&(s.data.data.length!==0?this.setState({refReferences:!0,refReferencesList:s.data.data}):this.operateClick(e))})},this.operateClick=e=>{var s=this.props,n=s.t,r=s.onForceRender;H.Z.confirm({title:n("common.delete"),content:n("common.confirmDeleteTitle"),okCancel:()=>!1,onOk:()=>{(0,S.$t)(e.id).then(d=>{d.data.code===0&&(d.data.data.length===0?(r(),w.default.success(n("common.deleteSuccess"))):this.setState({refReferences:!0,refReferencesList:d.data.data}))})}})},this.clearSelectedRowKeys=()=>{this.setState({selectedRowKeys:[]})},this.state={selectedRowKeys:[],templateVisible:!1,toolsList:[],refReferences:!1,refReferencesList:[],employeeProps:{visible:!1,courseId:[],initialParams:{employeeRange:{rangeType:1,rangeList:{dept:[],post:[],group:[],user:[]}}}}}}render(){var l=this.props,e=l.t,s=l.dataSource,n=l.loading,r=l.toolBarRender,d=l.headerTitle,u=l.source,o=l.actionSetVisibile,h=l.actionLiftingPlan,L=l.actionEdit,R=l.actionDelete,C=l.isNewEvaluationAbility,V=[{title:e("evaluationManage.abilityOptionName"),dataIndex:"ability_name",key:"ability_name",textWrap:"word-break",ellipsis:!0,render:(Z,f)=>a().createElement("div",{className:"evaluationManage-name"},a().createElement(p.Z,{placement:"top",title:f.ability_name},f.ability_name))},{title:e("evaluationManage.ownerTool"),dataIndex:"subordinate_tools_count",key:"subordinate_tools_count",width:"100px",render:(Z,f)=>f.source==="self"||Z===0?a().createElement(y.Z,{type:"link"},"-"):a().createElement(y.Z,{type:"link",onClick:()=>this.handleShowToolModal(f)},Z)},{title:e("evaluation.powerType"),dataIndex:"ability_type",key:"ability_type",width:"100px",render:Z=>{var f={special:e("evaluation.professional"),common:e("evaluation.generalAbility")};return a().createElement("span",null,f[Z])}},{title:e("evaluation.powerLevel"),dataIndex:"source",key:"source",width:"100px",render:Z=>a().createElement("span",null,Z==="tool"?3:5)},{title:e("common.creator"),dataIndex:"create_user_str",key:"create_user_str",width:"100px"},{title:e("common.createTime"),dataIndex:"create_time",key:"create_time",width:"150px",render:Z=>a().createElement("span",null,Z?A()(Z).format("YYYY-MM-DD HH:mm"):"")}];C||V.push({title:e("common.operate"),key:"operate",width:"150px",render:(Z,f)=>{var ae=[{visible:!0,title:e("common.visibleRange"),click:()=>this.handleSetEmployeeRange({record:f}),disabled:f.source!=="self"},{visible:!0,title:e("evaluationManage.trainingCase"),click:()=>this.handleSetCase(f)},{visible:!0,title:e("common.edit"),click:()=>this.handleEdit(f),disabled:f.source!=="self"},{visible:!0,title:e("community.deleteQuestion"),click:()=>this.operateClick(f),disabled:f.source!=="self"}];return a().createElement(x.Z,{buttons:ae})}}),C&&(o||h||L||R)&&V.push({title:e("common.operate"),key:"operate",width:"150px",render:(Z,f)=>{var ae=[];return o&&ae.push({visible:!0,title:e("common.visibleRange"),click:()=>this.handleSetEmployeeRange({record:f}),disabled:f.source!=="self"}),h&&ae.push({visible:!0,title:e("evaluationManage.trainingCase"),click:()=>this.handleSetCase(f)}),L&&ae.push({visible:!0,title:e("common.edit"),click:()=>this.handleEdit(f),disabled:f.source!=="self"}),R&&ae.push({visible:!0,title:e("community.deleteQuestion"),click:()=>this.beforeOperate(f),disabled:f.source!=="self"}),a().createElement(x.Z,{buttons:ae})}});var ee={selectedRowKeys:this.state.selectedRowKeys,onChange:(Z,f)=>{this.setState({selectedRowKeys:Z},()=>{this.props.handleSelect(Z,f)})},columnWidth:"50px"},te=this.state,he=te.templateVisible,ve=te.toolsList,pe=te.employeeProps,Oe=te.refReferencesList,Ze=te.refReferences;return a().createElement("div",{className:"training_ability_listTable"},u!==""?a().createElement(j.f,{columns:V,dataSource:s,rowSelection:ee,rowKey:Z=>Z.id,pagination:!1,loading:n,toolBarRender:r,headerTitle:d,tableUUID:"9b1efdfe-630a-4f21-8f37-81d45281dc52"}):a().createElement(j.f,{columns:V,dataSource:s,rowKey:Z=>Z.id,pagination:!1,loading:n,toolBarRender:r,headerTitle:d,tableUUID:"9b1efdfe-630a-4f21-8f37-81d45281dc52"}),pe.visible&&a().createElement(Y.Z,(0,G.Z)({},pe,{title:e("courseManage.setTheVisibility"),mode:["all","part","private"],orgProps:{title:e("component.chooseVisibleScope")},isLoading:!pe.visible,onCancel:this.handleEmployeeCancel,onCreate:this.handleEmployeeOk})),a().createElement(H.Z,{visible:he,title:e("evaluationManage.ownerTool"),onOk:this.onExportTemplate,onCancel:this.onCancelExport,destroyOnClose:!0,footer:a().createElement(y.Z,{key:"back",onClick:this.onCancelExport},e("common.close")),width:600,bodyStyle:{height:"400px",overflow:"auto"}},a().createElement(P.Z,{toolsList:ve})),a().createElement(N.Z,{operation:"delete",resourceName:e("leftMenuLists.evaluateOptions"),visible:Ze,toolsList:Oe,isShowType:!0,onCancel:()=>this.setState({refReferences:!1}),isNewEvaluationAbility:C}))}}var le=(0,Q.$j)(ne,()=>{},null,{forwardRef:!0})((0,v.Z)("translation",{withRef:!0})(ie)),oe=t(93485),re=t(33565),de=t(79284),ce=t(38642),me=J=>{var l=J.advancedSetting;return{themeColor:l.themeColor}};class ye extends I.Component{constructor(){super(...arguments);this.toWatchCourse=l=>{(0,ce.eJ)({url:"/course/enterpriseCourse?".concat(c.stringify({courseId:l}))})},this.handleDelete=(l,e)=>{e.stopPropagation(),this.props.deleteCourse(l)},this.renderCourseList=l=>{var e=this.props,s=e.t,n=e.type,r=e.activeRate,d=e.themeColor,u=l.find(h=>h.level===r),o;return u&&(o=u.courses),o&&o.map((h,L)=>a().createElement("div",{className:"upgrade_plan_courseList_item",key:L,onClick:()=>this.toWatchCourse(h.id)},a().createElement("img",{src:h.cover,alt:""}),a().createElement("div",{className:"upgrade_plan_courseList_item_bottom"},a().createElement(p.Z,{title:h.title},a().createElement("h3",null,h.title)),n==="row"?a().createElement("span",{className:"upgrade_plan_courseList_item_bottom_btn",style:{color:d},onClick:R=>this.handleDelete(L,R)},s("common.delete")):"")))},this.setActiveRate=l=>{this.props.changeRate(l)},this.renderTags=(l,e)=>{var s=this.props,n=s.activeRate,r=s.themeColor;return l&&l.map((d,u)=>{var o=d.id===n?"active":"";return e==="upgrade_plan_rate"?a().createElement("span",{className:"".concat(e,"_tag ").concat(o),style:{color:o?r:""},onClick:()=>this.setActiveRate(d.id),key:d.id},d.name):a().createElement("span",{className:"".concat(e,"_tag"),key:u},d)})}}render(){var l=this.props,e=l.t,s=l.ability,n=l.rates,r=l.courseList;return a().createElement("div",{className:"upgrade_plan"},a().createElement("div",{className:"upgrade_plan_ability"},a().createElement("div",{className:"upgrade_plan_ability_name"},e("evaluationManage.abilityOption"),":"),a().createElement("div",{className:"upgrade_plan_ability_single"},this.renderTags(s,"upgrade_plan_ability"))),a().createElement("div",{className:"upgrade_plan_rate"},a().createElement("span",null,e("learning.questionnaireAddToolScore"),":"),this.renderTags(n,"upgrade_plan_rate")),a().createElement(y.Z,{type:"primary",icon:a().createElement(O.Z,null),onClick:this.props.handleShowCourse},e("setting.addCourse")),a().createElement("div",{className:"upgrade_plan_courseList"},this.renderCourseList(r)))}}var fe=(0,Q.$j)(me)((0,v.Z)()(ye));class Ee extends I.Component{constructor(l){super(l);this.getEvaluateLevelList=()=>{(0,S.DK)().then(e=>{e.data.code===0&&this.setState({levelList:e.data.data.map(s=>({id:s.id,name:s.name}))})})},this.handleSetCase=(e,s,n)=>{var r=this.state,d=r.toolList,u=r.levelList,o;if(this.setState({dataType:n}),n==="tool"?this.setState({rates:d,activeRate:"develop"}):this.setState({rates:u,activeRate:u.length?u[0].id:""}),s==="row")(0,S.aB)({id:e[0].id,source:n}).then(C=>{o=C.data.data,n==="tool"&&(o=o.map(V=>(0,i.Z)((0,i.Z)({},V),{},{level:V.name}))),this.setState({setCaseVisible:!0,courseList:o,type:s,ability:[e[0].ability_name],abilityIds:[e[0].id]})});else{o=[{courses:[],level:"develop"},{courses:[],level:"medium"},{courses:[],level:"advantage"}],n==="self"&&(o=u.map(C=>({courses:[],level:C.id})));var h=[],L=this.props.selectedRows,R=[];L.forEach(C=>{h.push(C.ability_name),R.push(C.id)}),this.setState({setCaseVisible:!0,courseList:o,type:s,ability:h,abilityIds:R})}},this.getEvaluateToolsList=()=>{(0,S.lf)({page_size:1e3}).then(e=>{this.setState({toolsList:e.data.list})})},this.handleShowCourse=()=>{var e=this.state,s=e.activeRate,n=e.courseList,r=e.type;if(r==="row"){var d=n.find(o=>o.level===s),u=[];d&&d.courses.forEach(o=>{u.push({id:o.id,data:o})}),this.setState({checkedList:u,courseSelectVisible:!0})}else this.setState({courseSelectVisible:!0,checkedList:[]})},this.cancelEditResource=()=>{this.setState({courseSelectVisible:!1})},this.sureAddResource=e=>{var s=this.props.t;if(e.length===0){w.default.error(s("setting.selectCourse"));return}this.setState({courseSelectVisible:!1},()=>{var n=this.state,r=n.activeRate,d=n.courseList,u=d.findIndex(o=>o.level===r);u>-1&&(d[u].courses=[],e.forEach(o=>{d[u].courses.push(o.data)})),this.setState({courseList:[...d]})})},this.nextRating=()=>{var e=this.state,s=e.activeRate,n=e.dataType,r=e.levelList,d=0,u={develop:"medium",medium:"advantage"}[s]||"advantage";if(n==="self"){var o=(0,oe.Z)(r.entries()),h;try{for(o.s();!(h=o.n()).done;){var L=h.value,R=(0,re.Z)(L,2),C=R[0],V=R[1];if(V.id===s){d=C+1;break}}}catch(ee){o.e(ee)}finally{o.f()}u=r[d].id}this.handleSaveCourse(u)},this.changeRate=e=>{this.handleSaveCourse(e)},this.handleSave=()=>{var e=this.props.t,s=this.state.activeRate;w.default.success(e("common.saveSuccess")),this.handleSaveCourse(s,"close"),this.setState({setCaseVisible:!1})},this.handleSaveCourse=(e,s)=>{var n=this.state,r=n.abilityIds,d=n.courseList,u=n.type,o=n.dataType,h=d.map(L=>({level:L.level,course_ids:L.courses.map(R=>R.id)}));(0,S.Ne)({ids:[...r],training_courses:h,is_batch_operation:u!=="row",source:o}),this.setState({activeRate:s==="close"?"develop":e})},this.onCancel=()=>{this.setState({setCaseVisible:!1,activeRate:"develop"})},this.deleteCourse=e=>{var s=this.state,n=s.activeRate,r=s.courseList,d=r.findIndex(u=>u.level===n);d>-1&&r[d].courses.splice(e,1),this.setState({courseList:[...r]})},this.state={courseSelectVisible:!1,rates:[{id:"develop",name:l.t("questionn.developedLevel")},{id:"medium",name:l.t("questionn.intermediateLevel")},{id:"advantage",name:l.t("questionn.advantageLevel")}],toolList:[{id:"develop",name:l.t("questionn.developedLevel")},{id:"medium",name:l.t("questionn.intermediateLevel")},{id:"advantage",name:l.t("questionn.advantageLevel")}],levelList:[],courseList:[],setCaseVisible:!1,type:"",ability:[],activeRate:"develop",checkedList:[],abilityIds:[]}}componentDidMount(){this.getEvaluateToolsList(),this.getEvaluateLevelList()}render(){var l=this.props.t,e=this.state,s=e.courseSelectVisible,n=e.courseList,r=e.type,d=e.setCaseVisible,u=e.ability,o=e.activeRate,h=e.checkedList,L=e.rates,R=l(r==="row"?"evaluationManage.trainingCase":"evaluationManage.setTrainingCase"),C=[a().createElement(y.Z,{key:"back",onClick:this.onCancel},l("common.cancel")),a().createElement(y.Z,{key:"submit",type:"primary",onClick:this.handleSave},"".concat(l("common.save")))];return n.length&&o!==n[n.length-1].level&&C.push(a().createElement(y.Z,{key:"next",type:"primary",onClick:this.nextRating},l("evaluationManage.nextRating"))),a().createElement("div",null,a().createElement(H.Z,{title:R,visible:d,width:1e3,bodyStyle:{height:"600px",overflow:"auto"},footer:C,maskClosable:!1,onCancel:this.onCancel},a().createElement(fe,{courseList:n,ability:u,rates:L,activeRate:o,handleShowCourse:this.handleShowCourse,type:r,changeRate:this.changeRate,deleteCourse:this.deleteCourse})),a().createElement(de.Z,{visible:s,onCancel:this.cancelEditResource,onOk:V=>this.sureAddResource(V),fromComponent:"evaluation",defaultChecked:h}))}}var Ce=(0,v.Z)("translation",{withRef:!0})(Ee),be=t(4408),Se=t(11449),X=t(86726),Pe=t(37055),ue=F.Z.TabPane,ge=B.Z.Option,Le=K.Z.Search;class Re extends I.Component{constructor(l){super(l);this.tableListRef=a().createRef(),this.getEvaluateToolsList=()=>{(0,S.lf)({page_size:1e3}).then(e=>{this.setState({toolsList:e.data.list})})},this.handleSelect=(e,s)=>{this.setState({selectedRowKeys:e,selectedRows:s})},this.getValuateAbilityList=()=>{var e=this.state.pageConfig;this.setState({loading:!0});var s=e.pageNumber,n=e.pageSize,r=e.name,d=e.ability_type,u=e.source,o=e.evaluation_tool_id;(0,S.m_)({page_number:s,page_size:n,name:r,ability_type:d,source:u,evaluation_tool_id:o}).then(h=>{this.setState({dataSource:h.data.list,loading:!1,toolTotal:h.data.total,selectedRowKeys:[],selectedRows:[]}),this.tableListRef.current.clearSelectedRowKeys()})},this.getListRef=e=>{this.query=e},this.pageChange=(e,s)=>{var n=this.state.pageConfig;this.setState({pageConfig:(0,i.Z)((0,i.Z)({},n),{},{pageNumber:n.pageSize!==s?1:e,pageSize:s})},()=>{this.getValuateAbilityList()})},this.pageSizeChange=(e,s)=>{var n=this.state.pageConfig;this.setState({pageConfig:(0,i.Z)((0,i.Z)({},n),{},{pageNumber:1,pageSize:s})},()=>{this.getValuateAbilityList()})},this.onSearchVal=e=>{var s=this.state.pageConfig;this.setState({pageConfig:(0,i.Z)((0,i.Z)({},s),{},{name:e,pageNumber:1})},()=>{this.getValuateAbilityList()})},this.handleForceRender=()=>{this.resetPagination().then(()=>{this.getValuateAbilityList()})},this.resetPagination=()=>new Promise(e=>{this.setState(s=>({pageConfig:(0,i.Z)((0,i.Z)({},s.pageConfig),{},{pageNumber:1})}),()=>{e()})}),this.onJumpAdd=()=>{M.m8.push("/talentedDevelopment/evaluationMenu/evaluationAbility/add")},this.renderSelectTools=()=>{var e=this.state.toolsList;return e&&e.map(s=>a().createElement(ge,{value:s.id,key:s.id},s.product_name))},this.onChangeTab=e=>{this.setState({pageConfig:{pageNumber:1,pageSize:20,name:"",ability_type:"",source:e,evaluation_tool_id:void 0},selectedRowKeys:[],selectedRows:[]},()=>{this.resetPagination().then(()=>{this.getValuateAbilityList()})})},this.handleSelectTool=e=>{var s=this.state.pageConfig;this.setState({pageConfig:(0,i.Z)((0,i.Z)({},s),{},{ability_type:e})},()=>{this.resetPagination().then(()=>{this.getValuateAbilityList()})})},this.handleSelectToolId=e=>{var s=this.state.pageConfig;this.setState({pageConfig:(0,i.Z)((0,i.Z)({},s),{},{evaluation_tool_id:e})},()=>{this.resetPagination().then(()=>{this.getValuateAbilityList()})})},this.onMultSetVisible=()=>{var e=this.state.selectedRowKeys,s={visible:!0,actionId:e,initialParams:{employeeRange:{rangeType:1,rangeList:{dept:[],post:[],group:[],user:[]}}},reserveUser:[]};this.tableListRef.current.multSetVisible(s)},this.renderNewOption=()=>{var e=this.props.t,s=this.state,n=s.pageConfig,r=s.selectedRowKeys,d=s.selectedRows,u=(0,X.H3)("add",this.state.actions),o=(0,X.H3)("set_visible",this.state.actions),h=(0,X.H3)("lifting_plan",this.state.actions);return a().createElement(a().Fragment,null,u&&a().createElement(y.Z,{type:"primary",icon:a().createElement(O.Z,null),onClick:this.onJumpAdd},e("libraryPractice.newPractice")),n.source!=="self"?null:o&&a().createElement(y.Z,{disabled:r.length===0,onClick:this.onMultSetVisible},e("common.visibleRange")),n.source?h&&a().createElement(y.Z,{disabled:d.length===0,onClick:()=>this.query&&this.query.handleSetCase([],"batch",n.source)},e("questionn.improvePlaned"),a().createElement(p.Z,{placement:"right",title:e("evaluationManage.allSetTip")},a().createElement(g.Z,null))):null)},this.renderOption=()=>{var e=this.props.t,s=this.state,n=s.pageConfig,r=s.selectedRowKeys,d=s.selectedRows;return a().createElement("div",{className:"training_abilityOption_table_header-left"},a().createElement(y.Z,{type:"primary",icon:a().createElement(O.Z,null),onClick:this.onJumpAdd},e("libraryPractice.newPractice")),n.source!=="self"?null:a().createElement(y.Z,{disabled:r.length===0,onClick:this.onMultSetVisible},e("common.visibleRange")),n.source?a().createElement(y.Z,{disabled:d.length===0,onClick:()=>this.query&&this.query.handleSetCase([],"batch",n.source)},e("questionn.improvePlan"),a().createElement(p.Z,{placement:"right",title:e("evaluationManage.allSetTip")},a().createElement(g.Z,null))):null)},this.headerTitle=()=>{var e=this.state.isNewEvaluationAbility;return a().createElement("div",{className:"training_abilityOption_table_header-left"},e?this.renderNewOption():this.renderOption())},this.toolBarRender=()=>{var e=this.state,s=e.pageConfig,n=e.powType,r=this.props.t,d=c.parse(M.m8.location.search),u=d.abilityName;return a().createElement("div",{className:"training_abilityOption_table_header-right"},a().createElement(B.Z,{className:"ability_query_select",allowClear:!0,onChange:this.handleSelectTool,value:s.ability_type,placeholder:r("evaluation.powerType")},n.map(o=>a().createElement(ge,{value:o.id,key:o.id},o.name))),s.source==="tool"?a().createElement(B.Z,{value:s.evaluation_tool_id,allowClear:!0,className:"ability_query_select",placeholder:r("evaluationManage.selectOwnerTools"),onChange:this.handleSelectToolId},this.renderSelectTools()):null,a().createElement(Le,{style:{width:224},onSearch:this.onSearchVal,placeholder:r("evaluation.searchByName"),defaultValue:u}))},this.state={actions:(0,X.V9)("evaluationAbility",l.modules),selectedRowKeys:[],selectedRows:[],dataSource:[],loading:!1,powType:[{name:l.t("common.all"),id:""},{name:l.t("evaluation.professional"),id:"special"},{name:l.t("evaluation.generalAbility"),id:"common"}],pageConfig:{pageNumber:1,pageSize:20,name:"",ability_type:"",source:"",evaluation_tool_id:void 0},isNewEvaluationAbility:(0,X.F)("evaluationAbility",l.modules)==="856363557683976148"}}componentDidMount(){var l=c.parse(M.m8.location.search),e=l.abilityName;e?this.onSearchVal(e):this.getValuateAbilityList(),this.getEvaluateToolsList()}render(){var l=this.props,e=l.t,s=l.userLng,n=this.state,r=n.dataSource,d=n.loading,u=n.toolTotal,o=n.pageConfig,h=n.selectedRowKeys,L=n.selectedRows,R=n.isNewEvaluationAbility,C=(0,i.Z)((0,i.Z)({},Pe.XE.INITIAL_PAGINATION),{},{current:o.pageNumber,total:u,onChange:this.pageChange,pageSize:o.pageSize}),V=(0,X.H3)("set_visible",this.state.actions),ee=(0,X.H3)("lifting_plan",this.state.actions),te=(0,X.H3)("edit",this.state.actions),he=(0,X.H3)("delete",this.state.actions);return a().createElement(Se.Z,{pageContainerParams:{header:{title:e("leftMenuLists.evaluateOptions")}}},a().createElement(be.Z,{title:e("leftMenuLists.evaluateOptions")}),a().createElement("div",{className:"training_abilityOption_content"},a().createElement(F.Z,{value:o.source,onChange:this.onChangeTab},a().createElement(ue,{tab:e("common.all"),key:""}),a().createElement(ue,{tab:e("dashboard.selfcreate"),key:"self"}),a().createElement(ue,{tab:a().createElement("span",null,e("evaluation.clouds"),a().createElement(p.Z,{title:e("evaluation.cloudsTip")},a().createElement(E.Z,{style:{marginLeft:5}}))),key:"tool"})),a().createElement(Ce,{ref:this.getListRef,selectedRowKeys:h,selectedRows:L,evaluation_tool_id:o.evaluation_tool_id}),a().createElement("div",{className:"training_abilityOption_table-padding"},a().createElement("div",{className:"training_abilityOption_table",ref:ve=>{this.tableRef=ve}},a().createElement(le,{ref:this.tableListRef,setShowCase:this.query&&this.query.handleSetCase,lng:s.lng,source:o.source,dataSource:r,handleSelect:this.handleSelect,pageConfig:C,loading:d,onForceRender:this.handleForceRender,toolBarRender:this.toolBarRender,headerTitle:this.headerTitle(),actionSetVisibile:V,actionLiftingPlan:ee,actionEdit:te,actionDelete:he,isNewEvaluationAbility:R})),u>o.pageSize||!C.hideOnSinglePage?a().createElement("div",{className:"training_abilityOption_pagination"},a().createElement($.Z,C)):null)))}}var Te=(0,M.$j)(J=>({modules:J.user.modules,userLng:J.user}))((0,v.Z)()(Re))}}]);
