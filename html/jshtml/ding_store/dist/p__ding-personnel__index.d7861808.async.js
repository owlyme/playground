(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[2059],{62215:function(C,g,r){"use strict";r.r(g);var N=r(57663),f=r(71577),y=r(20228),m=r(11382),p=r(57361),D=r(9754),d=r.n(D),u=r(12924),e=r.n(u),I=r(28216),O=r(91768),h=r(67222),_=r(38642);class w extends u.Component{constructor(){var i;super(...arguments);i=this,this.state={loading:!0,status:"",initLoading:!1},this.onOpen=()=>{var n=window.location.href.match(/corpId=(\w*)/)[1],t=Array.isArray(window.location.href.match(/purchaseToken=(\w*)/))?window.location.href.match(/purchaseToken=(\w*)/)[1]:"";dd&&dd.version&&dd.design.biz.openTryoutSku({corpId:n,appId:sessionStorage.getItem("CL_E_APP_ID"),token:t,miniAppId:""}).then(s=>{var a=s.action;a==="ok"&&this.setState({initLoading:!0},()=>{localStorage.removeItem("enterprise_id"),this.checkInitDataIsComplete()})}).catch(()=>{})},this.onEnable=()=>{dd.extendApi({app:"hrm",funcName:"enableApp",params:{},onSuccess:n=>{console.log(n)},onFail:n=>{console.log(n)}})},this.handleFreezeOrder=()=>{var n=window.location.href.match(/corpId=(\w*)/)[1],t=encodeURIComponent("https://h5.dingtalk.com/open-market/skuDetail.html?dd_share=false&showmenu=false&bizCode=isv&goodsCode=".concat("FW_GOODS-1000651011","&corpId=").concat(n,"&funnelsource=hrmportal&source=hrmportal"));dd.biz.util.openLink({url:"dingtalk://dingtalkclient/page/link?pc_slide=true&url=".concat(t)}).then(()=>{})},this.handleGoHome=()=>{this.setState({initLoading:!1},()=>{var n=window.location.href.match(/corpId=(\w*)/)[1];(0,_.eJ)({url:"/login?corp=".concat(n[1])})})},this.loopRequestInitDataStatus=(0,p.Z)(d().mark(function n(){var t,s,a,o,l,v,P;return d().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return t=localStorage.getItem("enterprise_id")||"",s=window.location.href.match(/corpId=(\w*)/)[1],c.next=4,(0,h.Y8)(s,t);case 4:a=c.sent,o=a.data,o.code===2e5&&(l=o.data,v=l.enterpriseId,P=l.progress,localStorage.setItem("enterprise_id",v),P==="100"&&(clearInterval(i.timer),i.setState({loading:!1,status:"guide",initLoading:!1})));case 7:case"end":return c.stop()}},n)})),this.checkInitDataIsComplete=(0,p.Z)(d().mark(function n(){return d().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:i.loopRequestInitDataStatus(),i.timer=setInterval(()=>{i.loopRequestInitDataStatus()},1e4);case 2:case"end":return s.stop()}},n)})),this.getFirmOpenStatus=(0,p.Z)(d().mark(function n(){var t,s,a;return d().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(t=window.location.href.match(/corpId=(\w*)/),i.props.dispatch({type:"user/setPageFrom",payload:{pageFrom:"dingPersonnel"}}),!t){l.next=8;break}return l.next=5,(0,h.ez)({corpId:t[1]});case 5:s=l.sent,a=s.data,a.code===2e5&&(a.data.status==="initial"||a.data.status==="normal"||a.data.status==="open"?(i.setState({loading:!1}),i.handleLinkData(),(0,_.eJ)({url:"/login?corp=".concat(t[1])})):i.setState({loading:!1,status:a.data.status}));case 8:case"end":return l.stop()}},n)})),this.handleLinkData=()=>{var n=this.getQueryVariable("type"),t=this.getQueryVariable("corpId"),s={};if(n){if(n==="px"&&(s[n]={corpId:t,type:n}),n==="profile"||n==="pxDetail"){var a=this.getQueryVariable("userId"),o=this.getQueryVariable("dimission_status");s[n]={corpId:t,type:n,userId:a,dimission_status:o}}this.props.dispatch({type:"dingPersonnel/setDingPersonnel",payload:{dingDingPersonnel:s}})}}}componentDidMount(){var i=window.location.href.match(/noPermission=(\w*)/),n=window.location.href.match(/status=(\w*)/);i?this.setState({loading:!1,status:n||"noPermission"}):this.getFirmOpenStatus()}getQueryVariable(i){try{for(var n=window.location.href.split("?")[1],t=n.split("&"),s=0;s<t.length;s+=1){var a=t[s].split("=");if(a[0]===i)return a[1]}return!1}catch(o){return!1}}render(){var i=this.state,n=i.loading,t=i.status,s=i.initLoading,a=this.props.t;return e().createElement(e().Fragment,null,e().createElement("div",{className:"ding-personnel"},n&&e().createElement("div",{classN:!0,ame:"ding-personnel-loading"},e().createElement(m.Z,null)),!n&&!s&&(t==="failed"||t==="unopen")&&e().createElement("div",{className:"ding-personnel-img ding-box-width",onClick:this.onOpen},e().createElement("img",{className:"ding-img-width",src:"".concat("https://oss.coolcollege.cn","/1836031304303513600.png")})),!n&&t==="freeze"&&e().createElement("div",{className:"ding-personnel-page",onClick:this.handleFreezeOrder},e().createElement("div",{className:"ding-personnel-page-img"},e().createElement("img",{src:"".concat("https://oss.coolcollege.cn","/1819104275767365632.png")})),e().createElement("div",{className:"ding-personnel-page-name"},a("dingPersonnel.applyFreeze")),e().createElement("div",{className:"ding-personnel-page-tip"},a("dingPersonnel.applyFreezeTip"))),!n&&t==="delete"&&e().createElement("div",{className:"ding-personnel-page"},e().createElement("div",{className:"ding-personnel-page-img"},e().createElement("img",{src:"".concat("https://oss.coolcollege.cn","/1819103840180506624.png")})),e().createElement("div",{className:"ding-personnel-page-tip"},a("dingPersonnel.applyDeactivatedTip")),e().createElement("div",{className:"ding-personnel-page-btn"},e().createElement("span",{onClick:this.onEnable},a("questionn.openNow")))),!n&&t==="noPermission"&&e().createElement("div",{className:"ding-personnel-page"},e().createElement("div",{className:"ding-personnel-page-img"},e().createElement("img",{src:"".concat("https://oss.coolcollege.cn","/1819103840180506624.png")})),e().createElement("div",{className:"ding-personnel-page-name"},a("dingPersonnel.noPermission")),e().createElement("div",{className:"ding-personnel-page-tip"},a("dingPersonnel.noPermissionTip"))),!n&&t==="preserve"&&e().createElement("div",{className:"ding-personnel-page"},e().createElement("div",{className:"ding-personnel-page-img"},e().createElement("img",{src:"".concat("https://oss.coolcollege.cn","/1819711429704552448.png")})),e().createElement("div",{className:"ding-personnel-page-name ding-personnel-page-top"},a("dingPersonnel.systemReserve")),e().createElement("div",{className:"ding-personnel-page-tip"},a("dingPersonnel.systemReserveTips"))),!n&&t==="guide"&&e().createElement("div",{className:"ding-personnel-img ding-box-width"},e().createElement("img",{className:"ding-img-width",src:"".concat("https://oss.coolcollege.cn","/1822358942592929792.png")}),e().createElement(f.Z,{type:"primary",className:"ding-personnel-btn",onClick:this.handleGoHome},a("dingPersonnel.enterCool"))),!n&&t==="noUserPermission"&&e().createElement("div",{className:"ding-personnel-page"},e().createElement("div",{className:"ding-personnel-page-img"},e().createElement("img",{src:"".concat("https://oss.coolcollege.cn","/1819103840180506624.png")})),e().createElement("div",{className:"ding-personnel-page-name ding-personnel-page-top"},a("dingPersonnel.noPermission")),e().createElement("div",{className:"ding-personnel-page-tip"},a("dingPersonnel.noUserPermission"))),s&&e().createElement("div",{className:"ding-loading"},e().createElement("div",{className:"ding-loading-page"},e().createElement(m.Z,{size:"large"}),e().createElement("div",{className:"ding-loading-tip"},a("dingPersonnel.loadingTip"))))))}}g.default=(0,I.$j)(E=>({user:E.user}))((0,O.Z)()(w))}}]);
