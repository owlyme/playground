(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[1003,2812],{64630:function(le,H,t){"use strict";var S=t(62029),x=t(62999),f=t(85733),_=t(12924),R=t.n(_),F=t(91768),s=t(10237),V=t(37055),c=t(25547),r=f.Z.TreeNode;class E extends R().Component{constructor(A){super(A);this.getPostTree=()=>{var k=V.ZP.OrgTree.getPostTree();s.WY.get({url:k}).then(m=>{var i=(0,c.NP)(m.data.posts,{id:"value",post_name:"postName"});this.setState({treeData:i})})},this.handleChange=(k,m,i)=>{this.props.onChange(typeof k=="undefined"?"":k,m,i)},this.renderTreeNodes=k=>k.map(m=>{var i=!0;return this.props.noChildSelect&&(i=m.post_type==="post"),m.children?R().createElement(r,{selectable:!this.props.noChildSelect,title:m.postName,key:m.id,value:m.id,isLeaf:!1,dataRef:m},this.renderTreeNodes(m.children)):R().createElement(r,{selectable:i,title:m.postName,dataRef:m,value:m.id,key:m.id,isLeaf:!0})}),this.renderTreeSelect=()=>{var k=this.props,m=k.t,i=k.defaultValue,B=i===void 0?[]:i,L=k.multiple,K=L===void 0?!1:L,O=k.width,j=O===void 0?180:O,Y={showSearch:!1,style:{width:j},defaultValue:B,multiple:K,dropdownStyle:{maxHeight:300,overflow:"auto"},placeholder:m("component.choosePostTip"),allowClear:!0,disabled:this.props.disabled};return this.state.treeData.length>0?R().createElement(f.Z,(0,S.Z)({},Y,{onChange:this.handleChange,className:this.props.className}),this.renderTreeNodes(this.state.treeData)):R().createElement("div",{style:{textAlign:"center"}})},this.state={treeData:[]}}componentDidMount(){this.getPostTree()}render(){return R().createElement("div",{className:"org-tree-container ".concat(this.props.className)},this.renderTreeSelect())}}E.defaultProps={disabled:!1,onChange:()=>{}},H.Z=(0,F.Z)()(E)},11449:function(le,H,t){"use strict";t.d(H,{Z:function(){return ae}});var S=t(88986),x=t(33565),f=t(12924),_=t.n(f),R=t(3115),F=t(49111),s=t(19650),V=t(62029),c=t(57663),r=t(71577),E=t(91768),y=t(28216),A=t(37055),k=t(10237);function m(U){var d=A.ZP.getHelpContentByMenuKey(),W={key:U};return k.WY.get({url:d,params:W})}var i=t(74228),B=t.n(i),L=t(1164),K=t(76466),O=t(38642);class j extends _().Component{constructor(d){var W;super(d);W=this,this.getHelpContentByMenuKey=()=>{var Z=this.props.defaultMenuKey;m(Z).then(p=>{var o=p.data,T=o.help_url,N=o.video_url;this.setState({videoUrl:N,helpUrl:T})})},this.handleOpenHelpUrl=Z=>{if((0,O.ve)()){window.open(Z,"_blank");return}L.Z.targetTo({path:Z,isExternalLink:!0})},this.handleOpenVideo=function(Z){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:W.props.t("helpCenter.video");W.setState(o=>({resourcePlayInfo:(0,S.Z)((0,S.Z)({},o.resourcePlayInfo),{},{resourceInfo:{originUrl:Z,source:{FD:Z,OD:Z},contentType:"mp4"}}),previewInfo:(0,S.Z)((0,S.Z)({},o.previewInfo),{},{title:p,visible:!0,onCancel:W.handleCancelPreview})}))},this.handleCancelPreview=()=>{var Z=this.state.previewInfo;this.setState({resourcePlayInfo:{mode:"preview",watchType:"video",resourceInfo:{}},previewInfo:(0,S.Z)((0,S.Z)({},Z),{},{visible:!1})})},this.state={helpUrl:"",videoUrl:"",resourcePlayInfo:{autoPlay:!0,draggable:!0,mode:"preview",resourceInfo:{},watchType:"video"},previewInfo:{visible:!1,destroyOnClose:!0,title:d.t("helpCenter.video")||"\u89C6\u9891\u6307\u5BFC",onCancel:()=>{}}}}componentDidMount(){this.getHelpContentByMenuKey()}render(){var d=this.state,W=d.helpUrl,Z=d.resourcePlayInfo,p=d.previewInfo,o=d.videoUrl,T=this.props.t;return _().createElement("div",{className:B().helpCenter},o&&_().createElement(r.Z,{type:"link",className:B()["video-btn"],style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenVideo(o)},T("helpCenter.video")),W&&_().createElement(r.Z,{type:"link",style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenHelpUrl(W)},T("helpCenter.tutorial")),_().createElement(K.Z,(0,V.Z)({},Z,{previewInfo:p})))}}var Y=U=>({defaultMenuKey:U.currentRoute.menuKey});j.defaultProps={defaultMenuKey:""};var w=(0,y.$j)(Y)((0,E.Z)()(j));function q(U){var d=U.extra,W=localStorage.getItem("dingPersonnel"),Z=sessionStorage.getItem("dingPersonnel");return _().createElement(s.Z,null,d,W!=="dingPersonnel"&&Z!=="dingPersonnel"&&(0,O.eY)("COMMONEXTRA_HELP_CENTER")&&_().createElement(w,null))}var D=q,ne=t(4408);function te(U){var d=(0,f.useState)({helpCenter:(0,O.eY)("HEAD_HELP_CENTER_BUT")}),W=(0,x.Z)(d,1),Z=W[0],p=U.pageContainerParams,o=p===void 0?{}:p,T=U.noPadding,N=T===void 0?!1:T,b=U.isPersonal,z=b===void 0?!1:b,Q=U.pageTitle,X=U.className,oe=X===void 0?"":X,re={extra:Z.helpCenter?_().createElement(D,{extra:o.extra}):o.extra},ie=(0,S.Z)((0,S.Z)({},o),re);return _().createElement("div",{className:"page-container-content ".concat(N?"page-container-noPadding":""," ").concat(z?"page-container-content_personal_background":""," ").concat(oe)},Q&&_().createElement(ne.Z,{title:Q}),z?_().createElement(R.Z,null,U.children):_().createElement(R.Z,ie,U.children))}var ae=te},85161:function(le,H,t){"use strict";t.r(H),t.d(H,{default:function(){return fe}});var S=t(57663),x=t(71577),f=t(62029),_=t(34792),R=t(48086),F=t(12924),s=t.n(F),V=t(91768),c=t(80991),r=t(64593),E=t(76651),y=t(78138),A=t.n(y),k=t(4408),m=t(37055),i=t(57068),B=t(11449),L=t(62615),K=t(24628),O=t(43859),j=t(47673),Y=t(4107);class w extends F.Component{constructor(){super(...arguments);this.handleChange=n=>{this.props.formik.setFieldValue("taskName",n.target.value)}}render(){var n=this.props,e=n.defaultValue,a=n.isPreview,l=n.disabled;return s().createElement(s().Fragment,null,a?"":s().createElement(Y.Z,{onChange:this.handleChange,maxLength:64,value:e,disabled:l}))}}var q=(0,c.$j)(w),D=t(88986),ne=t(88311),te=t(84874),ae=t(49101);class U extends F.Component{constructor(n){super(n);this.handleShowOrg=()=>{var e=this.state.orgDialogConfig;e.visible=!0,this.setState({orgDialogConfig:e})},this.hiddenOrg=()=>{var e=this.state.orgDialogConfig;e.visible=!1,this.setState({orgDialogConfig:e})},this.addUserCbk=e=>{var a=this.state.orgDialogConfig;a.visible=!1,this.setState({orgDialogConfig:a},()=>{this.props.formik.setFieldValue("users",(0,D.Z)({},e))})},this.removeDept=e=>{var a=this.props.formik.values.users,l=a.dept;l.splice(e,1),this.props.formik.setFieldValue("users",(0,D.Z)((0,D.Z)({},a),{},{dept:l}))},this.removeUser=e=>{var a=this.props.formik.values.users,l=a.user;l.splice(e,1),this.props.formik.setFieldValue("users",(0,D.Z)((0,D.Z)({},a),{},{user:l}))},this.state={orgDialogConfig:{visible:!1,onOk:this.addUserCbk,onCancel:this.hiddenOrg}}}render(){var n=this.props,e=n.t,a=n.isPreview,l=n.defaultValue,C=n.disabled,v=this.state.orgDialogConfig,g=l.dept,P=l.user,h=localStorage.getItem("themeColor")||"#516ae6";return s().createElement("div",null,a?"":s().createElement(x.Z,{type:"primary",icon:s().createElement(ae.Z,null),ghost:!0,disabled:C,onClick:this.handleShowOrg},e("marketing.selectEmploy")),s().createElement(ne.Z,(0,f.Z)({},v,{title:e("marketing.selectEmploy"),initData:{dept:g,user:P},displayType:["dept"]})),g.length>0?s().createElement("div",{className:"add-question-bank-dept"},s().createElement("div",{className:"dept-label"},e("common.selectedGroups")),s().createElement("div",{className:"dept-list"},g.map((J,I)=>s().createElement("div",{key:I,className:"dept-list-item",style:{color:h,borderColor:h}},J.name,C||a?"":s().createElement(s().Fragment,null,s().createElement("span",{className:"icon",onClick:()=>this.removeDept(I)},s().createElement(te.Z,{iconClass:"icon-guanbi1",size:"10px"}))))))):null,P.length>0?s().createElement("div",{className:"add-question-bank-dept"},s().createElement("div",{className:"dept-label"},e("common.selectedUsers")),s().createElement("div",{className:"dept-list"},P.map((J,I)=>s().createElement("span",{key:I,className:"dept-list-item",style:{color:h,borderColor:h}},J.name,C||a?"":s().createElement("span",{className:"icon",onClick:()=>this.removeUser(I)},s().createElement(te.Z,{iconClass:"icon-guanbi1",size:"10px"})))))):null)}}var d=(0,c.$j)((0,V.Z)()(U)),W=t(79284),Z=t(52506);class p extends F.Component{constructor(n){super(n);this.handleClick=()=>{var e=this.state.courseConfig;e.visible=!0,this.setState({courseConfig:(0,D.Z)((0,D.Z)({},this.state.courseConfig),{},{defaultChecked:this.props.formik.values.resources})})},this.handleSelectedCancel=()=>{var e=this.state.courseConfig;e.visible=!1,this.setState({courseConfig:e})},this.handleSelectedAttachment=e=>{e.forEach(a=>{a.data&&(a.data.type="imageText")}),this.handleSelectedCancel(),this.props.formik.setFieldValue("resources",e)},this.sortResource=(e,a)=>{var l=this.props.formik.values.resources,C=l[e];l.splice(e,1),l.splice(a,0,C),this.props.formik.setFieldValue("resources",l)},this.removeResource=e=>{var a=this.props.formik.values.resources;a.splice(e,1),this.props.formik.setFieldValue("resources",a)},this.state={courseConfig:{visible:!1,defaultChecked:[],onCancel:this.handleSelectedCancel,onOk:this.handleSelectedAttachment,excludeType:"all,video,audio,application,html,picture,scorm",contentType:"h5"}}}componentDidMount(){this.setState({courseConfig:(0,D.Z)((0,D.Z)({},this.state.courseConfig),{},{defaultChecked:this.props.formik.values.resources})})}render(){var n=this.props,e=n.t,a=n.defaultFieldList,l=n.isPreview,C=n.disabled,v=this.state.courseConfig;return s().createElement("div",null,l?"":s().createElement(x.Z,{type:"primary",icon:s().createElement(ae.Z,null),ghost:!0,disabled:C,onClick:this.handleClick},e("marketing.addImageText")),s().createElement(W.Z,(0,f.Z)({scenesType:"marketing",image_text:"true",showPrivate:!1},v)),s().createElement(Z.Z,{list:a,sortResource:this.sortResource,removeResource:this.removeResource,editable:!(l||C)}))}}var o=(0,c.$j)((0,V.Z)()(p)),T=t(77883),N=t(21888),b=t(63185),z=t(9676);class Q extends F.Component{constructor(){super(...arguments);this.handleChange=(n,e)=>{var a=this.props.formik.values.taskIndicator;this.props.formik.setFieldValue("taskIndicator",(0,D.Z)((0,D.Z)({},a),{},{["".concat(e)]:n}))},this.handleCheck=(n,e)=>{var a=this.props.formik.values.taskIndicator;this.props.formik.setFieldValue("taskIndicator",(0,D.Z)((0,D.Z)({},a),{},{["".concat(e)]:n.target.checked}))}}render(){var n=this.props,e=n.t,a=n.defaultValue,l=n.disabled,C=n.isPreview;return s().createElement("div",null,s().createElement("span",{className:"task_indicator_padding"},C?e("marketing.shareCount"):s().createElement(z.Z,{disabled:l,checked:a.isShare,onChange:v=>this.handleCheck(v,"isShare")},e("marketing.shareCount")),s().createElement("span",null,s().createElement(N.Z,{className:"task_indicator_padding_sub",disabled:l,parser:v=>v.replace(/[^0-9]/g,""),value:a.shareCount,onChange:v=>this.handleChange(v,"shareCount")})," ",e("common.times"))),s().createElement("span",null,C?e("marketing.leadCount"):s().createElement(z.Z,{disabled:l,checked:a.isClue,onChange:v=>this.handleCheck(v,"isClue")},e("marketing.leadCount")),s().createElement("span",null,s().createElement(N.Z,{className:"task_indicator_padding_sub",disabled:l,parser:v=>v.replace(/[^0-9]/g,""),value:a.clueCount,onChange:v=>this.handleChange(v,"clueCount")})," ",e("common.people"))))}}var X=(0,c.$j)((0,V.Z)()(Q)),oe=t(77576),re=t(59314);class ie extends F.Component{constructor(){super(...arguments);this.handleChange=(n,e)=>{var a=this.props.formik.values.remind;this.props.formik.setFieldValue("remind",(0,D.Z)((0,D.Z)({},a),{},{["".concat(n)]:e})),n==="isTurnOn"&&!e&&this.props.formik.setFieldValue("remind",(0,D.Z)((0,D.Z)({},a),{},{isTurnOn:!1,hours:0,minutes:0}))}}componentDidMount(){}render(){var n=this.props,e=n.t,a=n.defaultValue,l=n.disabled,C=n.isPreview,v=a.hours<10?"0".concat(a.hours):a.hours,g=a.minutes<10?"0".concat(a.minutes):a.minutes,P=a.isTurnOn?"".concat(v," : ").concat(g):e("marketing.remindTimeNotSet");return s().createElement("div",null,C?P:s().createElement(s().Fragment,null,s().createElement("div",null,e("marketing.remindTitle")),s().createElement(re.Z,{disabled:l,checked:a.isTurnOn,onChange:h=>this.handleChange("isTurnOn",h)}),a.isTurnOn?s().createElement("div",null,s().createElement("span",{className:"task_indicator_padding"},e("marketing.remindStartTime"),s().createElement(N.Z,{className:"task_indicator_padding_sub",disabled:l||C||!a.isTurnOn,parser:h=>h.replace(/[^0-9]/g,""),value:a.hours,onChange:h=>this.handleChange("hours",h)}),e("common.hour")),s().createElement("span",null,s().createElement(N.Z,{className:"task_indicator_padding_sub",disabled:l||C||!a.isTurnOn,parser:h=>h.replace(/[^0-9]/g,""),value:a.minutes,onChange:h=>this.handleChange("minutes",h)}),e("common.minutes"))):""))}}var se=(0,c.$j)((0,V.Z)()(ie)),ee=(0,O.Z)(q),G=(0,O.Z)(d),de=(0,O.Z)(o),ue=(0,O.Z)(X),ce=(0,O.Z)(se),me=t(6793),he=(u,n)=>{var e;return(u===""||u.trim()==="")&&(e=n("marketing.taskNameIsRequired")),e},ve=(u,n)=>{var e;return!u.isShare&&!u.isClue&&(e=n("marketing.leastChoose")),u.isShare&&u.shareCount<=0&&(e=n("marketing.shareCountRules")),u.isClue&&u.clueCount<=0&&(e=n("marketing.clueCountRules")),e},ge=(u,n)=>{var e;return u.length===0?e=n("marketing.articleRequired"):u.length>100&&(e=n("marketing.maxResourcesTip")),e},pe=(u,n)=>{var e;return u.user.length===0&&u.dept.length===0&&(e=n("marketing.userRequired")),e},Ce=(u,n,e)=>{var a;return(0,me.jZ)(u.startTime)<new Date().getTime()&&!e&&(a=n("marketing.dataRangeRulesTip")),(!u||!u.startTime||!u.endTime)&&(a=n("validation.checkDatePicker")),a},Ee=(u,n,e)=>{var a,l=(0,me.jZ)(n.startTime),C=(0,me.jZ)(n.endTime),v=u.hours*3600+u.minutes*60;return u.isTurnOn&&!u.hours&&!u.minutes&&(a=e("marketing.remindTimeRequired")),A()(C).diff(A()(l),"seconds")<v&&(a=e("marketing.remindTimeValidateTip")),a},$={labelCol:{xs:{span:24},sm:{span:3}},wrapperCol:{xs:{span:24},sm:{span:21}}};class ke extends F.Component{constructor(n){super(n);this.getTaskHeader=()=>{var e=this.state.initParams;return{taskName:e.taskName,taskStatus:e.taskStatus}},this.initData=e=>{Promise.all([(0,K.KR)({taskId:e}),(0,K.zr)({taskId:e})]).then(a=>{if(a[0].data.code==="200000"){var l=a[0].data.data,C=a[1].data.data,v=parseInt(l.second/3600,10)||0,g=parseInt(l.second/60%60,10)||0;this.setState(()=>({initParams:{taskName:l.task_name,users:{dept:C.departmentList||[],post:[],group:[],user:C.userList||[],cluster:[]},resources:C.courseMappingList.map(P=>({icon:m.e1[P.icon],id:P.id,name:P.name,crsType:"imageText"})),taskIndicator:{isShare:l.is_share||!1,isClue:l.is_clue||!1,shareCount:l.share_count||0,clueCount:l.clue_count||0},dateRange:{startTime:new Date(l.begin_time)||null,endTime:new Date(l.end_time)||null},remind:{isTurnOn:l.is_alert||!1,hours:v,minutes:g}},requested:!0,taskStatus:l.task_status}))}})},this.handleCancel=()=>{E.m8.push({pathname:"/market/market/promote_task/all_task"})},this.handleSubmit=e=>{var a=i.parse(E.m8.location.search),l=a.id,C=e.remind.hours*3600+e.remind.minutes*60,v={taskId:l,taskName:e.taskName,startTime:A()(e.dateRange.startTime).format("YYYY-MM-DD HH:mm"),endTime:A()(e.dateRange.endTime).format("YYYY-MM-DD HH:mm"),resources:e.resources.map(P=>({resource_name:P.name,resource_id:P.id,resource_type:P.type})),userIds:e.users.user.map(P=>P.id).join(","),departmentIds:e.users.dept.map(P=>P.id).join(","),isShare:e.taskIndicator.isShare,shareCount:e.taskIndicator.shareCount,isClue:e.taskIndicator.isClue,clueCount:e.taskIndicator.clueCount,isAlert:e.remind.isTurnOn,seconds:C},g=this.props.t;l?(0,K.Fp)(v).then(P=>{P.data.code==="200000"?R.default.success(g("common.editSuccess")):R.default.error(g("common.editFailure")),this.handleCancel()}):(0,K.QK)(v).then(P=>{P.data.code==="200000"?R.default.success(g("common.addSuccess")):R.default.error(g("common.addFailure")),this.handleCancel()})},this.initRef=e=>{this.form=e},this.state={initParams:{taskName:"",users:{dept:[],post:[],group:[],user:[],cluster:[]},resources:[],taskIndicator:{isShare:!1,isClue:!1,shareCount:0,clueCount:0},dateRange:{startTime:null,endTime:null},remind:{isTurnOn:!1,hours:0,minutes:0}},requested:!1}}componentDidMount(){var n=i.parse(E.m8.location.search),e=n.id;e?this.initData(e):this.setState({requested:!0})}render(){var n=this.props,e=n.isPreview,a=n.t,l=this.state,C=l.initParams,v=l.requested,g=l.taskStatus,P=i.parse(E.m8.location.search),h=P.id,J;return e?J=a("marketing.viewTask"):h?J=a("marketing.editTask"):J=a("marketing.addTask"),s().createElement(s().Fragment,null,s().createElement(k.Z,{title:a("documentTitle.addTask")}),e?s().createElement(s().Fragment,null,v?s().createElement("div",{className:"task_container"},s().createElement("div",{className:"task_container_content"},s().createElement(c.J9,{ref:this.initRef,initialValues:C,onSubmit:this.handleSubmit,render:I=>s().createElement(c.l0,null,s().createElement("div",{className:"cl-form__sectitle"},a("exam.basicInformation")),e?"":s().createElement(c.gN,(0,f.Z)({name:"taskName",label:a("exam.taskName"),required:!0,defaultValue:I.values.taskName,validate:M=>he(M,a),component:ee,disabled:!!h&&g==="finish",placeholder:a("checkTitleNull.checkTitleNull")},$)),s().createElement(c.gN,(0,f.Z)({name:"users",label:a("marketing.taskPerformer"),displayType:"Custom",component:G,required:!0,defaultValue:I.values.users,validate:M=>pe(M,a),isPreview:e,disabled:!!h&&g==="finish"},$)),s().createElement(c.gN,(0,f.Z)({name:"resources",label:a("marketing.taskContent"),displayType:"Custom",component:de,required:!0,validate:M=>ge(M,a),defaultFieldList:I.values.resources,isPreview:e,disabled:!!h&&g!=="notStarted"},$)),s().createElement(c.gN,(0,f.Z)({name:"taskIndicator",label:a("marketing.taskIndicator"),displayType:"Custom",component:ue,validate:M=>ve(M,a),defaultValue:I.values.taskIndicator,isPreview:e,disabled:!!h&&g!=="notStarted"},$)),s().createElement(c.gN,(0,f.Z)({component:L.E2,displayType:"Custom",name:"dateRange",label:a("marketing.marketTaskTime"),required:!0,disabled:e||!!h&&g!=="notStarted",defaultFieldList:I.values.dateRange,dateRangeLimit:I.values.dateRangeLimit||!!h&&g!=="notStarted"},$)),s().createElement(c.gN,(0,f.Z)({name:"remind",label:a("marketing.remindTime"),displayType:"Custom",defaultValue:I.values.remind,component:ce,isPreview:e,disabled:!!h&&g!=="notStarted"},$)),s().createElement(L.I,null))}))):null):s().createElement(B.Z,{pageContainerParams:{header:{title:J}}},s().createElement(r.q,null,s().createElement("title",null,J)),v?s().createElement("div",{className:"task_container"},s().createElement("div",{className:"task_container_content"},s().createElement(c.J9,{ref:this.initRef,initialValues:C,onSubmit:this.handleSubmit,render:I=>s().createElement(c.l0,null,s().createElement("div",{className:"cl-form__sectitle"},a("exam.basicInformation")),e?"":s().createElement(c.gN,(0,f.Z)({name:"taskName",label:a("exam.taskName"),required:!0,defaultValue:I.values.taskName,validate:M=>he(M,a),component:ee,disabled:!!h&&g==="finish",placeholder:a("checkTitleNull.checkTitleNull")},$)),s().createElement(c.gN,(0,f.Z)({name:"users",label:a("marketing.taskPerformer"),displayType:"Custom",component:G,required:!0,defaultValue:I.values.users,validate:M=>pe(M,a),isPreview:e,disabled:!!h&&g==="finish"},$)),s().createElement(c.gN,(0,f.Z)({name:"resources",label:a("marketing.taskContent"),displayType:"Custom",component:de,required:!0,validate:M=>ge(M,a),defaultFieldList:I.values.resources,isPreview:e,disabled:!!h&&g!=="notStarted"},$)),s().createElement(c.gN,(0,f.Z)({name:"taskIndicator",label:a("marketing.taskIndicator"),displayType:"Custom",component:ue,validate:M=>ve(M,a),defaultValue:I.values.taskIndicator,isPreview:e,disabled:!!h&&g!=="notStarted"},$)),s().createElement(c.gN,(0,f.Z)({component:L.E2,displayType:"Custom",name:"dateRange",label:a("marketing.marketTaskTime"),required:!0,disabled:e||!!h&&g!=="notStarted",validate:M=>Ce(M,a,!!h&&g!=="notStarted"),defaultFieldList:I.values.dateRange,dateRangeLimit:I.values.dateRangeLimit},$)),s().createElement(c.gN,(0,f.Z)({name:"remind",label:a("marketing.remindTime"),displayType:"Custom",defaultValue:I.values.remind,validate:M=>Ee(M,I.values.dateRange,a),component:ce,isPreview:e,disabled:!!h&&g!=="notStarted"},$)),s().createElement(L.I,null),s().createElement("div",null,s().createElement(x.Z,{className:"task_container_padding",onClick:this.handleCancel},a("common.cancel")),s().createElement(x.Z,{type:"primary",htmlType:"submit"},a("common.save"))))}))):null))}}var fe=(0,V.Z)()(ke)},1278:function(le,H,t){"use strict";t.r(H);var S=t(14781),x=t(53431),f=t(62029),_=t(13062),R=t(71230),F=t(89032),s=t(15746),V=t(95300),c=t(7277),r=t(88983),E=t(47933),y=t(88986),A=t(47673),k=t(4107),m=t(12924),i=t.n(m),B=t(91768),L=t(76651),K=t(57068),O=t(24628),j=t(85161),Y=t(11449),w=t(55285),q=t(37055),D=t(4408),ne=t(64262),te=t(6793),ae=t(64630),U=k.Z.Search,d={pageNum:1,pageSize:20,keyword:"",taskStatus:"",department:"",position:"",taskId:"",departmentId:"",positionId:""};class W extends m.Component{constructor(p){super(p);this.getStatus=(o,T)=>{var N;switch(o){case"finish":N=T("dashboard.completed");break;case"notStarted":N=T("common.unFinish");break;case"underway":N=T("common.unFinish");break;case"overdue":N=T("marketing.hasOverdue");break;default:N="";break}return N},this.onChangeTab=o=>{this.setState({activeKey:o})},this.getList=()=>{var o=K.parse(L.m8.location.search),T=o.id;d.taskId=T,(0,O.aC)((0,y.Z)({},d)).then(N=>{var b=N.data.data,z=b.total_people-b.finish,Q="".concat((b.finish/b.total_people*100).toFixed(2),"%");this.setState({countList:b.mineTaskInfos,countTotal:b.total,statistics:{finish:b.finish,notComplete:z,percent:Q},taskName:b.task_name,taskStatus:b.task_status})})},this.handleChangeStatus=o=>{d.pageNum=1,d.taskStatus=o.target.value,this.getList()},this.handleSearch=o=>{d.pageNum=1,d.keyword=o,this.getList()},this.handlePostSelectChange=(o,T)=>{d.pageNum=1,d.position=T.join(","),d.positionId=o,this.getList()},this.handleTreeSelectChange=(o,T)=>{d.pageNum=1,d.department=T.join(","),d.departmentId=o,this.getList()},this.renderRightRow=()=>{var o=this.props.t,T=[{label:o("common.all"),value:""},{label:o("dashboard.completed"),value:"finish"},{label:o("common.unFinish"),value:"notStarted"},{label:o("marketing.hasOverdue"),value:"overdue"}];return i().createElement("div",{className:"detail_content_query_right"},i().createElement(E.ZP.Group,{options:T,onChange:this.handleChangeStatus,value:d.taskStatus,optionType:"button",buttonStyle:"solid"}),i().createElement(U,{className:"detail_content_query_right_search",onSearch:this.handleSearch,allowClear:!0}))},this.state={activeKey:"count",countTotal:0,countList:[],statistics:{notComplete:0,finish:0,percent:0},taskName:"",taskStatus:""},this.nameColumn={dataIndex:"userName",key:"userName",title:p.t("marketing.taskPerformer"),width:130,fixed:"left"},this.columns=[{dataIndex:"shareCount",key:"shareCount",width:100,title:p.t("marketing.shareCount")},{dataIndex:"clueCount",key:"clueCount",width:100,title:p.t("marketing.leadCount")},{width:150,dataIndex:"taskStatus",key:"taskStatus",title:p.t("marketing.completeStatus"),render:o=>this.getStatus(o,p.t)},{width:200,dataIndex:"finishDate",key:"finishDate",title:p.t("marketing.taskCompleteTime"),render:o=>o?(0,te.p6)(o):""}]}componentDidMount(){this.getList()}componentWillUnmount(){d={pageNum:1,pageSize:20,keyword:"",taskStatus:"",department:"",position:"",taskId:""}}render(){var p=this.props.t,o=this.state,T=o.activeKey,N=o.countTotal,b=o.countList,z=o.statistics,Q=o.taskName,X=o.taskStatus,oe=K.parse(L.m8.location.search),re=oe.id,ie=(0,y.Z)((0,y.Z)({},q.XE.INITIAL_PAGINATION),{},{total:N,current:d.pageNum,onChange:G=>{d.pageNum=G,this.getList()},onShowSizeChange:(G,de)=>{d.pageNum=1,d.pageSize=de,this.getList()}}),se,ee;return X==="finish"?(se="marketing_detail_header_finish",ee=p("common.ended")):X==="underway"?(se="marketing_detail_header_underway",ee=p("common.ongoing")):X==="notStarted"&&(se="marketing_detail_header_notStart",ee=p("myExamTask.unStart")),i().createElement(Y.Z,{pageContainerParams:{header:{title:i().createElement("div",null,i().createElement("span",null,Q),i().createElement("span",{className:se},ee))},tabList:[{tab:this.props.t("marketing.taskCount"),key:"count"},{tab:this.props.t("marketing.taskDetail"),key:"detail"}],onTabChange:G=>{this.onChangeTab(G)}}},i().createElement(D.Z,{title:p("marketing.taskDetail")}),T==="count"?i().createElement(i().Fragment,null,i().createElement(R.Z,{className:"marketing_detail_header"},i().createElement(s.Z,{span:8,align:"center",className:"marketing_detail_header_border"},i().createElement(c.Z,{title:p("marketing.hasCompleted"),value:z.finish})),i().createElement(s.Z,{span:8,align:"center",className:"marketing_detail_header_border"},i().createElement(c.Z,{title:p("marketing.notComplete"),value:z.notComplete})),i().createElement(s.Z,{span:8,align:"center"},i().createElement(c.Z,{title:p("marketing.percentComplete"),value:z.percent}))),i().createElement("div",{className:"detail_content"},i().createElement("div",{className:"detail_content_query"},i().createElement("div",{className:"detail_content_query_left"},i().createElement(ne.Z,{parentId:"",checkable:!1,asyncLoad:!0,treeSelect:!0,handleTreeSelectChange:this.handleTreeSelectChange,className:"detail_content_query_left_dept"}),i().createElement(ae.Z,{className:"detail_content_query_left_post",onChange:this.handlePostSelectChange}))),i().createElement("div",{className:"detail_content_table"},i().createElement(w.Z,{columns:this.columns,dataSource:b,pagination:!1,toolBarRender:this.renderRightRow,tableUUID:"d7f582a6-4875-468f-ae16-5cd92b3b30a6"})),i().createElement(x.Z,(0,f.Z)({className:"detail_content_pagination"},ie)))):null,T==="detail"?i().createElement(i().Fragment,null,i().createElement(j.default,{isPreview:!0,taskId:re,ref:G=>{this.detail=G}})):"")}}H.default=(0,B.Z)()(W)},24628:function(le,H,t){"use strict";t.d(H,{QK:function(){return f},Fp:function(){return _},KR:function(){return R},ar:function(){return F},vt:function(){return s},aC:function(){return V},zr:function(){return c}});var S=t(37055),x=t(10237);function f(r){var E=r.taskName,y=r.startTime,A=r.endTime,k=r.resources,m=r.isShare,i=r.shareCount,B=r.isClue,L=r.clueCount,K=r.isAlert,O=r.seconds,j=r.userIds,Y=r.departmentIds,w=S.ZP.market.addMarketTask();return x.WY.post({url:w,data:{task_name:E,start_time:y,end_time:A,resources:k,is_share:m,share_count:i,is_clue:B,clue_count:L,is_alert:K,seconds:O,user_ids:j,department_ids:Y}})}function _(r){var E=r.taskName,y=r.startTime,A=r.endTime,k=r.resources,m=r.isShare,i=r.shareCount,B=r.isClue,L=r.clueCount,K=r.isAlert,O=r.seconds,j=r.userIds,Y=r.departmentIds,w=r.taskId,q=S.ZP.market.updateMarketTask();return x.WY.post({url:q,data:{task_id:w,task_name:E,start_time:y,end_time:A,resources:k,is_share:m,share_count:i,is_clue:B,clue_count:L,is_alert:K,seconds:O,user_ids:j,department_ids:Y}})}function R(r){var E=r.taskId,y=S.ZP.market.getMarketTaskDetail();return x.WY.get({url:y,params:{task_id:E}})}function F(r){var E=r.taskStatus,y=r.pageNum,A=r.pageSize,k=r.keyword,m=S.ZP.market.getAllMarketTask();return x.WY.get({url:m,params:{task_status:E,page_num:y,page_size:A,key_word:k}})}function s(r){var E=r.taskId,y=S.ZP.market.deleteMarketTask();return x.WY.delete({url:y,params:{task_id:E}})}function V(r){var E=r.taskStatus,y=r.taskId,A=r.department,k=r.position,m=r.pageNum,i=r.pageSize,B=r.keyword,L=r.departmentId,K=r.positionId,O=S.ZP.market.getStatistics();return x.WY.get({url:O,params:{task_status:E,task_id:y,department:A,position:k,page_num:m,page_size:i,key_word:B,department_id:L,position_id:K}})}function c(r){var E=r.taskId,y=S.ZP.market.getTaskEcho();return x.WY.get({url:y,params:{task_id:E}})}}}]);
