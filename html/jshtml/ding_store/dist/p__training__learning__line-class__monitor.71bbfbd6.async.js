(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[6089],{30311:function(Ce,H,e){"use strict";var A=e(22385),r=e(31097),S=e(12924),E=e.n(S),T=e(8812),C=e(28216),N=d=>{var K=(0,C.v9)(f=>{var h=f.advancedSetting;return{themeColor:h.themeColor}}),O=K.themeColor;return E().createElement(r.Z,{placement:"top",title:d.name},E().createElement("span",{className:"cl-table__cell-arrow",onClick:d.onClick},E().createElement("span",{style:{color:O}},d.name),E().createElement("span",{className:"cl-table__cell-arrow-icon"},E().createElement(T.Z,null))))};H.Z=N},30389:function(Ce,H,e){"use strict";e.d(H,{Z:function(){return w}});var A=e(62029),r=e(20228),S=e(11382),E=e(12924),T=e.n(E),C=e(91768),N=e(80991),d={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},K=e(62615),O=e(52670);class f extends T().Component{render(){var s=this.props,t=s.values,i=s.mode,o=s.onlyChooseDept,n=s.reserveUser,a=s.t,l=s.orgProps,u=s.rangeAuth,p=s.projectId,y=s.onCancel,W=s.onlyCreateUser;return T().createElement(N.l0,{className:"cl-form"},T().createElement(N.gN,(0,A.Z)({component:K.ww,displayType:"Custom",showSectitle:!1,name:"employeeRange",label:a("common.visibleRange"),defaultFieldList:t.employeeRange,validate:O.FI,mode:i,rangeAuth:u,onlyChooseDept:o,onlyCreateUser:W,orgProps:l,reserveUser:n,projectId:p,onCancel:y,qwTicketShow:!0},d)))}}var h=(0,C.Z)()(f),g=e(18329),c=e(34773);class M extends T().Component{constructor(){super(...arguments);this.initRefFormik=s=>{this.refFormik=s},this.handleBeforeCreate=()=>{var s=this.refFormik;s.submitForm(),s.runValidations().then(t=>{if(!Object.keys(t).length){var i=s.state.values.employeeRange,o=(0,c.b)(i.rangeList),n={qyWeChatVo:i.qyWeChatVo,id:this.props.actionId,isAll:i.rangeType,groupIds:i.rangeType===2?o.groupIds.join(","):"",departmentIds:i.rangeType===2?o.deptIds.join(","):"",userIds:i.rangeType===2?o.userIds.join(","):"",postIds:i.rangeType===2?o.postIds.join(","):"",clusterIds:i.rangeType===2?o.clusterIds.join(","):"",qy_we_chat_vo:i.qyWeChatVo};this.props.onCreate(n)}})},this.handleBeforeCancel=()=>{var s=this.props.onCancel;s()}}render(){var s=this.props,t=s.visible,i=s.initialParams,o=s.isLoading,n=s.tipInfo,a=s.mode,l=s.onlyChooseDept,u=s.reserveUser,p=u===void 0?[]:u,y=s.t,W=s.title,P=s.orgProps,L=s.rangeAuth,B=s.projectId,D=s.onCancel,J=s.onlyCreateUser,G=s.size;return o?T().createElement(S.Z,{size:"large"}):T().createElement(g.ZP,{wrapClassName:"cl-employee-selector-modal",visible:t,title:W||y("component.changeUser"),okText:y("common.ok"),cancelText:y("common.cancel"),size:G,onCancel:this.handleBeforeCancel,onOk:this.handleBeforeCreate},o?T().createElement(S.Z,{size:"large"}):T().createElement(N.J9,{ref:this.initRefFormik,initialValues:i,render:z=>T().createElement(h,(0,A.Z)({},z,{mode:a,rangeAuth:L,orgProps:P,onlyChooseDept:l,onlyCreateUser:J,reserveUser:p,projectId:B,onCancel:D}))}),n&&T().createElement("p",{style:{padding:"0 24px",wordBreak:"break-all",whiteSpace:"normal"}},n))}}M.defaultProps={visible:!1,initialParams:{employeeRange:{rangeType:1,rangeList:{dept:[],post:[],group:[],user:[],cluster:[]}}},tipInfo:"",isLoading:!1,mode:["all","part"],onlyChooseDept:!1,onlyCreateUser:!1,orgProps:{},onCancel:()=>{},onCreate:()=>{},size:"middle"};var w=(0,C.Z)()(M)},74525:function(Ce,H,e){"use strict";var A=e(57361),r=e(34792),S=e(48086),E=e(9754),T=e.n(E),C=e(12924),N=e.n(C),d=e(91768),K=e(28216),O=e(92592),f=e(5430),h=e(10237),g=e(84874),c=e(16239),M=e(38642),w=e(28963);class m extends N().Component{constructor(t){var i;super(t);i=this,this.appId=sessionStorage.getItem("CL_E_APP_ID"),this.miniAppId=sessionStorage.getItem("CL_MINI_APP_ID"),this.initCode=()=>{var o=this.props,n=o.type,a=o.isProjectShare,l=o.isCommodityExchange,u=o.userInfo;["wx","weixin"].includes(n)?n==="weixin"&&u.appId==="9005"?this.initOtherCode():this.initWXCode():a&&n==="ding"?this.getProjectShareUrl():l&&n==="ding"?this.getCommodityExchangeUrl():n==="fullWebLink"?this.initOtherCode(this.props.option.scene):this.initOtherCode()},this.getCommodityExchangeUrl=()=>{var o=this.props,n=o.t,a=o.appType,l=o.orderId,u=this.props.option.scene,p=localStorage.getItem("uid");if(!c.Z[(0,c.c)()].showCl||a!=="e_app"){var y={deliverUserId:p,orderId:l,flag:"exchange"};O.toDataURL(JSON.stringify(y),{width:500}).then(B=>{this.setState({img:B})}).catch(()=>{S.default.error(n("integralMall.qrCodeFailed"))})}else{var W="/pages/messageRedirect/messageRedirect?".concat(u),P=encodeURIComponent(W),L="dingtalk://dingtalkclient/action/open_micro_app/=questionMark=/appId=".concat(this.appId,"&pVersion=1&miniAppId=").concat(this.miniAppId,"&packageType=1&page=").concat(P,"&corpId=").concat(this.props.userInfo.corpId);this.getShortLink(L).then(B=>{O.toDataURL(B.data.short_link,{width:500}).then(D=>{this.setState({img:D})}).catch(()=>{S.default.error(n("integralMall.qrCodeFailed"))})})}},this.getProjectShareUrl=()=>{var o=this.props.option.scene,n=encodeURIComponent("/pages/messageRedirect/messageRedirect?".concat(o)),a="dingtalk://dingtalkclient/action/open_micro_app/=questionMark=/corpId=".concat(this.props.userInfo.corpId,"&appId=").concat(this.appId,"&miniAppId=").concat(this.miniAppId,"&page=").concat(n);this.getShortLink(a).then(l=>{this.initOtherCode(l.data.short_link)})},this.getShortLink=o=>h.WY.post({url:f.ZP.Common.getQrUrl(),data:{link:o}}),this.initWXCode=(0,A.Z)(T().mark(function o(){var n,a,l,u;return T().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return n=i.props.option,a=n.scene,l=n.flag,y.next=3,h.WY.post({url:f.ZP.createWxCode(),data:{flag:l,scene:"".concat(a,"&enterpriseId=").concat(f.ZP.enterpriseId),enterprise_id:f.ZP.enterpriseId}});case 3:u=y.sent,i.setState({img:u.data.wx_code,linkUrl:"data:image/png;base64,".concat(u.data.wx_code)});case 5:case"end":return y.stop()}},o)})),this.initOtherCode=function(){var o=(0,A.Z)(T().mark(function n(a){var l,u,p,y;return T().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(l=i.props,u=l.type,p=l.fsUrl,P.t0=a,P.t0){P.next=6;break}return P.next=5,i.handleScanCode();case 5:P.t0=P.sent;case 6:y=P.t0,u==="fs"&&p&&(y=p),i.setState({linkUrl:y}),O.toDataURL(y,{width:500}).then(L=>{i.setState({img:L})}).catch(()=>{S.default.error(i.props.t("personal.failedGenerateCode"))});case 10:case"end":return P.stop()}},n)}));return function(n){return o.apply(this,arguments)}}(),this.handleScanCode=(0,A.Z)(T().mark(function o(){var n,a,l,u,p,y,W,P,L,B,D,J,G,z,se,he,_e,Pe;return T().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:if(n=i.props,a=n.type,l=n.userInfo,u=n.universalFn,p=i.state.wxH5Url,y=i.props.option,W=y.scene,P=y.pc_url,L=P===void 0?"":P,B=y.mobile_url,D=B===void 0?"":B,J=y.pc_type,G=J===void 0?"":J,z=y.mobile_type,se=z===void 0?"":z,he=encodeURIComponent("/pages/messageRedirect/messageRedirect?"),_e=encodeURIComponent(W),!u){Y.next=12;break}return Y.next=8,i.getShortLink((0,M.jr)({pc_url:L,mobile_url:D,pc_type:G,mobile_type:se}));case 8:return Pe=Y.sent,Y.abrupt("return",(0,w.fZ)(Pe.data.short_link));case 12:Y.t0=a,Y.next=Y.t0==="app"?15:Y.t0==="ding"?16:Y.t0==="fs"?17:Y.t0==="weixin"?18:19;break;case 15:return Y.abrupt("return","".concat(W,"&fromApp=true"));case 16:return Y.abrupt("return","dingtalk://dingtalkclient/action/open_micro_app?corpId=".concat(l.corpId,"&appId=").concat(i.appId,"&miniAppId=").concat(i.miniAppId,"&packageType=1&pVersion=1&page=").concat(he+_e));case 17:return Y.abrupt("return","https://applink.feishu.cn/client/web_app/open?appId=".concat("cli_a0aa5e0fe5f8500d","&path=").concat(encodeURIComponent("/index.html"),"&").concat(W,"&appType=lark"));case 18:return Y.abrupt("return","".concat(p,"/#/pages/login/login-we-com/index?appType=weCom&corp=").concat(l.corpId,"&").concat(W));case 19:return Y.abrupt("return","");case 20:case"end":return Y.stop()}},o)})),this.saveQrcode=()=>{var o=this.state.img,n=this.props,a=n.type,l=n.t,u=n.userInfo,p=document.createElement("a");p.download=l("setting.Qrcode")+new Date().getTime(),p.href=a==="wx"||a==="weixin"&&u.appId!=="9005"?"data:image/png;base64,".concat(o):o,document.body.appendChild(p),p.click(),document.body.removeChild(p)},this.generatePoster=o=>{var n=o.linkUrl,a=o.type,l=o.activeKey,u=o.option,p=this.props.universalFn;typeof p=="function"&&p({linkUrl:n,type:a,activeKey:l,option:u})},this.state={img:"",linkUrl:"",wxH5Url:"https://mobile.coolcollege.cn"}}componentDidMount(){this.initCode()}componentDidUpdate(t){t.option.scene!==this.props.option.scene&&this.initCode()}render(){var t=this.props,i=t.type,o=t.tip,n=t.extraTip,a=t.t,l=t.canSave,u=t.refreshQrCode,p=t.label,y=t.saveText,W=y===void 0?"":y,P=t.downloadAsBtn,L=t.userInfo,B=t.universalFn,D=t.activeKey,J=t.option,G=this.state,z=G.img,se=G.linkUrl,he=localStorage.getItem("themeColor")||"#465dcd";return z?N().createElement("div",{className:"qr-code-content"},p?N().createElement("div",{className:"label-text"},p,":"):null,N().createElement("div",{className:"qr-code-div ".concat(p?"left":"")},i==="wx"||i==="weixin"&&L.appId!=="9005"?N().createElement("img",{src:"data:image/png;base64,".concat(z),alt:""}):N().createElement("img",{src:z,alt:""}),o?N().createElement("div",{className:"tip-text"},o):null,n?N().createElement("div",{className:"tip-text"},n):null,l?N().createElement("div",{className:"save_qrcode ".concat(P?"save-btn":""),style:{color:he},onClick:()=>this.saveQrcode()},P?null:N().createElement(g.Z,{iconClass:"icon-f-download",size:"14px"}),W||a("personal.saveCode")):null,B&&!u?N().createElement("div",{className:"save_qrcode",style:{color:he},onClick:()=>this.generatePoster({linkUrl:se,type:i,activeKey:D,option:J})},a("personal.saveCodePoster")):null,u?N().createElement("div",{className:"save_qrcode",style:{color:he},onClick:()=>u()},N().createElement(g.Z,{iconClass:"iconf-switch",size:"14px"}),a("personal.refreshCodeTip")):null)):N().createElement("div",{className:"qr-code-placeholder"})}}H.Z=(0,K.$j)(s=>{var t=s.user;return{userInfo:t,appType:t.appType,corpId:t.corpId}})((0,d.Z)()(m))},63848:function(Ce,H,e){"use strict";var A=e(36877),r=e(32969),S=e(12924),E=e.n(S),T=e(91768),C=e(56130);class N extends E().PureComponent{constructor(){super(...arguments);this.onChange=(K,O)=>{this.props.onChange(K,O)}}render(){var K=this.props,O=K.value,f=K.classify,h=K.showLabel,g=K.className,c=K.t,M=K.style;return E().createElement("div",{className:"classify-cascader ".concat(g)},h?E().createElement("span",{className:"classify-cascader-label"},c("component.selectClassifyLabel")):null,E().createElement(r.Z,{changeOnSelect:this.props.changeOnSelect,className:"classify-cascader-select ".concat(g),options:f,onChange:this.onChange,placeholder:c("component.selectClassifyLabel"),value:O,style:M,loadData:this.props.loadData}))}}N.defaultProps={showLabel:!0,changeOnSelect:!0,onChange:()=>{}},H.Z=(0,C.Z)((0,T.Z)()(N))},51697:function(Ce,H,e){"use strict";var A=e(22385),r=e(31097),S=e(33565),E=e(12924),T=e.n(E),C=e(28216),N=e(84874),d=O=>{var f=O.title,h=O.visible,g=O.placement,c=g===void 0?"top":g,M=O.children,w=M===void 0?null:M,m=O.isNewUser,s=m===void 0?"":m,t=O.closeGuide,i=O.guideStatus,o=(0,E.useState)(!1),n=(0,S.Z)(o,2),a=n[0],l=n[1],u=W=>T().createElement("div",{className:"guide-tooltip-title"},W,T().createElement("span",{onClick:p},T().createElement(N.Z,{iconClass:"icon-f-close",size:"12px",color:"#fff"})));(0,E.useEffect)(()=>{l(h)},[h]);var p=W=>{if(W.stopPropagation(),W.preventDefault(),l(!1),t){t();return}s==="true"&&O.dispatch({type:"shouldRenderHeaderGuide",payload:{headerGuideStatus:!0}}),y()},y=()=>{localStorage.setItem("guideStatus","false"),O.dispatch({type:"updateGuideStatus",payload:{guideStatus:"false"}})};return T().createElement(r.Z,{title:u(f),placement:c,visible:a&&i==="true"&&f},w)},K=O=>({guideStatus:O.advancedSetting.guideStatus,isNewUser:O.advancedSetting.isNewUser});H.Z=(0,C.$j)(K)(d)},64630:function(Ce,H,e){"use strict";var A=e(62029),r=e(62999),S=e(85733),E=e(12924),T=e.n(E),C=e(91768),N=e(10237),d=e(37055),K=e(25547),O=S.Z.TreeNode;class f extends T().Component{constructor(g){super(g);this.getPostTree=()=>{var c=d.ZP.OrgTree.getPostTree();N.WY.get({url:c}).then(M=>{var w=(0,K.NP)(M.data.posts,{id:"value",post_name:"postName"});this.setState({treeData:w})})},this.handleChange=(c,M,w)=>{this.props.onChange(typeof c=="undefined"?"":c,M,w)},this.renderTreeNodes=c=>c.map(M=>{var w=!0;return this.props.noChildSelect&&(w=M.post_type==="post"),M.children?T().createElement(O,{selectable:!this.props.noChildSelect,title:M.postName,key:M.id,value:M.id,isLeaf:!1,dataRef:M},this.renderTreeNodes(M.children)):T().createElement(O,{selectable:w,title:M.postName,dataRef:M,value:M.id,key:M.id,isLeaf:!0})}),this.renderTreeSelect=()=>{var c=this.props,M=c.t,w=c.defaultValue,m=w===void 0?[]:w,s=c.multiple,t=s===void 0?!1:s,i=c.width,o=i===void 0?180:i,n={showSearch:!1,style:{width:o},defaultValue:m,multiple:t,dropdownStyle:{maxHeight:300,overflow:"auto"},placeholder:M("component.choosePostTip"),allowClear:!0,disabled:this.props.disabled};return this.state.treeData.length>0?T().createElement(S.Z,(0,A.Z)({},n,{onChange:this.handleChange,className:this.props.className}),this.renderTreeNodes(this.state.treeData)):T().createElement("div",{style:{textAlign:"center"}})},this.state={treeData:[]}}componentDidMount(){this.getPostTree()}render(){return T().createElement("div",{className:"org-tree-container ".concat(this.props.className)},this.renderTreeSelect())}}f.defaultProps={disabled:!1,onChange:()=>{}},H.Z=(0,C.Z)()(f)},54792:function(Ce,H,e){"use strict";var A=e(62029),r=e(63185),S=e(9676),E=e(47673),T=e(4107),C=e(88986),N=e(12924),d=e.n(N),K=e(91768),O=e(59239),f=e(55446),h=e.n(f),g=e(18329),c=e(2396);class M extends d().Component{constructor(){super(...arguments);this.state={isChecked:!1},this.handleBeforeCreate=()=>{var s=this.props,t=s.form,i=s.id,o=s.onCreate,n=this.state.isChecked;t.validateFields((a,l)=>{if(!a){var u=(0,C.Z)({},l);n||(u.value=0);var p=(0,C.Z)((0,C.Z)({},u),{},{id:i});o(p),setTimeout(()=>{t.resetFields()},100)}})},this.handleBeforeCancel=()=>{var s=this.props,t=s.form,i=s.onCancel;i(),setTimeout(()=>{t.resetFields()},100)},this.checkScore=(s,t,i)=>{var o=this.props.t,n=this.state.isChecked;if(n&&(0,c.kh)(t)){i(o("component.setScoreRuleTip"));return}i()},this.handleCheckChange=s=>{this.setState({isChecked:s.target.checked})},this.renderItem=()=>{var s=this.props,t=s.form,i=s.initialValue,o=s.labelTxt,n=this.state.isChecked,a=t.getFieldDecorator,l={labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:18}}},u=n?a("value",{initialValue:i,rules:[{validator:this.checkScore}]})(d().createElement(T.Z,{maxLength:30,placeholder:""})):null,p=d().createElement(d().Fragment,null,d().createElement(S.Z,{checked:n,onChange:this.handleCheckChange},o));return d().createElement(O.Z.Item,(0,A.Z)({label:p},l),u)}}componentDidUpdate(s){this.props.visible&&this.props.visible!==s.visible&&this.setState({isChecked:!!this.props.initialValue})}render(){var s=this.props,t=s.visible,i=s.title,o=s.prefixCls;return d().createElement(g.ZP,{size:"small",visible:t,title:i,onCancel:this.handleBeforeCancel,onOk:this.handleBeforeCreate},d().createElement(O.Z,{className:"".concat(o),layout:"horizontal",colon:!1},this.renderItem(),d().createElement("div",{className:"".concat(o,"__children")},this.props.children)))}}M.defaultProps={prefixCls:"cl-setscore",id:"",visible:!1,title:"SetScore",labelTxt:"",initialValue:"",onCancel:()=>{},onCreate:()=>{}};var w=O.Z.create({name:"ClSetupBoxInModal"})(M);H.Z=(0,K.Z)()(w)},11449:function(Ce,H,e){"use strict";e.d(H,{Z:function(){return W}});var A=e(88986),r=e(33565),S=e(12924),E=e.n(S),T=e(3115),C=e(49111),N=e(19650),d=e(62029),K=e(57663),O=e(71577),f=e(91768),h=e(28216),g=e(37055),c=e(10237);function M(P){var L=g.ZP.getHelpContentByMenuKey(),B={key:P};return c.WY.get({url:L,params:B})}var w=e(74228),m=e.n(w),s=e(1164),t=e(76466),i=e(38642);class o extends E().Component{constructor(L){var B;super(L);B=this,this.getHelpContentByMenuKey=()=>{var D=this.props.defaultMenuKey;M(D).then(J=>{var G=J.data,z=G.help_url,se=G.video_url;this.setState({videoUrl:se,helpUrl:z})})},this.handleOpenHelpUrl=D=>{if((0,i.ve)()){window.open(D,"_blank");return}s.Z.targetTo({path:D,isExternalLink:!0})},this.handleOpenVideo=function(D){var J=arguments.length>1&&arguments[1]!==void 0?arguments[1]:B.props.t("helpCenter.video");B.setState(G=>({resourcePlayInfo:(0,A.Z)((0,A.Z)({},G.resourcePlayInfo),{},{resourceInfo:{originUrl:D,source:{FD:D,OD:D},contentType:"mp4"}}),previewInfo:(0,A.Z)((0,A.Z)({},G.previewInfo),{},{title:J,visible:!0,onCancel:B.handleCancelPreview})}))},this.handleCancelPreview=()=>{var D=this.state.previewInfo;this.setState({resourcePlayInfo:{mode:"preview",watchType:"video",resourceInfo:{}},previewInfo:(0,A.Z)((0,A.Z)({},D),{},{visible:!1})})},this.state={helpUrl:"",videoUrl:"",resourcePlayInfo:{autoPlay:!0,draggable:!0,mode:"preview",resourceInfo:{},watchType:"video"},previewInfo:{visible:!1,destroyOnClose:!0,title:L.t("helpCenter.video")||"\u89C6\u9891\u6307\u5BFC",onCancel:()=>{}}}}componentDidMount(){this.getHelpContentByMenuKey()}render(){var L=this.state,B=L.helpUrl,D=L.resourcePlayInfo,J=L.previewInfo,G=L.videoUrl,z=this.props.t;return E().createElement("div",{className:m().helpCenter},G&&E().createElement(O.Z,{type:"link",className:m()["video-btn"],style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenVideo(G)},z("helpCenter.video")),B&&E().createElement(O.Z,{type:"link",style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenHelpUrl(B)},z("helpCenter.tutorial")),E().createElement(t.Z,(0,d.Z)({},D,{previewInfo:J})))}}var n=P=>({defaultMenuKey:P.currentRoute.menuKey});o.defaultProps={defaultMenuKey:""};var a=(0,h.$j)(n)((0,f.Z)()(o));function l(P){var L=P.extra,B=localStorage.getItem("dingPersonnel"),D=sessionStorage.getItem("dingPersonnel");return E().createElement(N.Z,null,L,B!=="dingPersonnel"&&D!=="dingPersonnel"&&(0,i.eY)("COMMONEXTRA_HELP_CENTER")&&E().createElement(a,null))}var u=l,p=e(4408);function y(P){var L=(0,S.useState)({helpCenter:(0,i.eY)("HEAD_HELP_CENTER_BUT")}),B=(0,r.Z)(L,1),D=B[0],J=P.pageContainerParams,G=J===void 0?{}:J,z=P.noPadding,se=z===void 0?!1:z,he=P.isPersonal,_e=he===void 0?!1:he,Pe=P.pageTitle,Oe=P.className,Y=Oe===void 0?"":Oe,v={extra:D.helpCenter?E().createElement(u,{extra:G.extra}):G.extra},U=(0,A.Z)((0,A.Z)({},G),v);return E().createElement("div",{className:"page-container-content ".concat(se?"page-container-noPadding":""," ").concat(_e?"page-container-content_personal_background":""," ").concat(Y)},Pe&&E().createElement(p.Z,{title:Pe}),_e?E().createElement(T.Z,null,P.children):E().createElement(T.Z,U,P.children))}var W=y},17762:function(Ce,H,e){"use strict";var A=e(66456),r=e(55313),S=e(62029),E=e(88986),T=e(34792),C=e(48086),N=e(12924),d=e.n(N),K=e(91768),O=e(28216),f=e(37055),h=e(10237),g=e(18329),c=e(87312),M=e(84874),w=e(1164),m=e(76466),s=e(54531),t=e(6793);class i extends d().Component{constructor(n){super(n);this.onCancel=()=>{this.props.onCancel()},this.dealWatchType=a=>{var l=a.contentType||a.content_type,u=f.Yq.findIndex(J=>a.type.toLowerCase().includes(J))>-1,p=l.indexOf("video")>-1,y=f.Ss.indexOf(l)>-1,W=l.indexOf("image")>-1||a.type.indexOf("image")>-1||l.indexOf("picture")>-1||a.type.indexOf("picture")>-1,P=l.indexOf("html")>-1,L=l.indexOf("scorm")>-1,B=l.indexOf("h5")>-1,D="";return B?D="article":u?D="doc":p||y?D="video":W?D="image":P?D="html":L&&(D="scorm"),D},this.handlePreviewSystemFile=a=>{var l=this.state.previewInfo,u=a.status===1||a.status===2;if(u){C.default.warning(this.props.t("resourceLibrary.transcodingPlayerTip"));return}var p=a.contentType||a.content_type,y=this.dealWatchType(a),W=f.Ss.indexOf(p)>-1;if(y==="article"){var P=a.contentType,L=a.url,B=P==="h5/link";B?w.Z.targetTo({path:L,isExternalLink:!0}):w.Z.targetTo({path:"/training/resourceManage/library/articlePreview?id=".concat(a.id)});return}if(y==="scorm"){var D=a.url.split("//"),J=D[1].split("/"),G=[D[0],J[0]].join("//"),z="".concat(G,"/unzip_file/coolcollege-scorm/prod/preview.html?scormUrl=").concat(encodeURIComponent(a.url));w.Z.targetTo({path:z,isExternalLink:!0});return}var se={mode:"preview",watchType:y};y==="doc"?Object.assign(se,{resourceInfo:{type:"",docType:a.type,aliUrl:a.path,url:a.url,docTitle:a.name,playId:a.videoId||a.video_id,storageType:a.storage_type}}):y==="image"?Object.assign(se,{resourceInfo:{url:a.url,playId:a.videoId||a.video_id,storageType:a.storage_type}}):y==="html"?Object.assign(se,{resourceInfo:{url:a.url}}):Object.assign(se,{resourceInfo:{source:{FD:a.url,OD:a.path},originUrl:a.url,contentType:W?"mp3":a.type,playId:a.videoId||a.video_id,storageType:a.storage_type},autoPlay:!0,draggable:!0}),this.setState({resourcePlayInfo:se,previewInfo:(0,E.Z)((0,E.Z)({},l),{},{title:a.name,visible:!0,onCancel:this.cancelPreview})})},this.cancelPreview=()=>{var a=this.state.previewInfo;this.setState({resourcePlayInfo:{mode:"preview",watchType:"",resourceInfo:{}},previewInfo:(0,E.Z)((0,E.Z)({},a),{},{visible:!1})})},this.funGetList=()=>{var a=this.props,l=a.fileId,u=a.fileList;l?h.WY.get({url:f.ZP.lineClassStudy.getResource(),params:{id:l}}).then(p=>{this.setState({files:p.data})}):this.setState({files:u||[]})},this.handlePreview=a=>{var l=this.props,u=l.appType,p=l.t,y=a.biz_type||a.bizType;if(u==="wx_app"&&y===3){C.default.info(p("lineClassStudy.ddFileNoSee"));return}if(u==="app"){this.handlePreviewSystemFile(a);return}if(!((a.type==="zip"||a.type==="rar")&&a.storage_type!=="DING_PAN")){if(!dd.version&&y===3){C.default.info(p("practiceOperation.dingFileTip"));return}if(y!==3){this.handlePreviewSystemFile(a);return}var W=f.ZP.DingSpaceId.getSpaceId(),P={corpId:this.props.corpId,userId:this.props.account,fileids:a.url,timeStamp:Date.parse(new Date)};h.WY.get({url:W,params:P}).then(L=>{L.data.code===0?this.ddSpacePreview(a):C.default.info(L.data.msg)}).catch(L=>{C.default.error(L.data)})}},this.ddSpacePreview=a=>{var l={spaceId:a.path,fileId:a.url,fileName:a.name,fileSize:a.size,fileType:a.type};(0,s.DR)(l)},this.getIconType=a=>{var l=f.e1[a.type];return l||"iconf-matter-picture"},this.renderModalPreview=()=>{var a=this.state,l=a.resourcePlayInfo,u=a.previewInfo;return d().createElement(m.Z,(0,S.Z)({},l,{previewInfo:u}))},this.renderCard=a=>{var l=this.props,u=l.prefixCls,p=l.t,y="".concat(u,"__file"),W=a.type;return W.indexOf("image")!==-1&&(W="png"),d().createElement(d().Fragment,null,d().createElement("div",{key:a.id,className:y},d().createElement("span",{className:"".concat(y,"__item")},d().createElement("span",{style:{"vertical-align":"middle"}},d().createElement(M.Z,{iconClass:f.e1[W],size:"16px"}))," ",d().createElement("span",{className:"".concat(y,"__name")},a.name),d().createElement("span",{className:"cl-pointer",style:{marginLeft:"15px","vertical-align":"middle"},onClick:()=>this.handlePreview(a)},p("common.preview")))))},this.renderTable=()=>{var a=this.props,l=a.t,u=a.useLocalList,p=a.fileList,y=this.state.files,W=u?p:y,P=[{title:l("common.number"),dataIndex:"id",width:80,key:"id",render:(L,B,D)=>d().createElement("span",null,D+1)},{title:l("practiceOperation.annex"),dataIndex:"name",key:"name",ellipsis:!0,render:(L,B)=>d().createElement("div",null,d().createElement(M.Z,{iconClass:this.getIconType(B),size:"16px"}),d().createElement("span",{style:{marginLeft:"8px"}},L))},{title:l("common.operate"),width:130,fixed:"right",render:(L,B)=>d().createElement("div",null,d().createElement("span",{className:"cl-pointer",onClick:()=>this.handlePreview(B)},l("common.preview")))}];return d().createElement(r.Z,{style:{minHeight:"400px"},columns:P,dataSource:W,pagination:!1})},this.renderFileList=()=>{var a=this.props,l=a.t,u=a.isComponent,p=a.isCard,y=a.fileList,W=a.useLocalList,P=a.prefixCls,L=a.title,B=this.state.files,D=W?y:B;if(u&&!p)return this.renderTable();if(p)return d().createElement(d().Fragment,null,D.length?d().createElement("div",{className:"file-list-item-card"},D.map(z=>this.renderCard(z))):d().createElement(c.Z,{tipText:l("lineClassStudy.noResult")}));var J=d().createElement("div",null,B.length>0?d().createElement("div",{className:"".concat(P,"_page")},d().createElement("div",{className:"".concat(P,"_page_num")},(0,t.ZT)(l("lineClassStudy.pageTotal"),B.length))):null),G={okText:l("common.ok"),cancelText:l("common.cancel"),size:"medium",destroyOnClose:!0,bodyStyle:{padding:"0"},maskClosable:!1,footer:J};return d().createElement(g.ZP,(0,S.Z)({title:L||l("practiceOperation.annex")},G,{visible:this.props.visible,onCancel:this.onCancel}),d().createElement("div",{className:P},this.renderTable()))},this.state={files:[],resourcePlayInfo:{mode:"preview",watchType:"",resourceInfo:{},autoPlay:!0,draggable:!0},previewInfo:{visible:!1,destroyOnClose:!0,title:this.props.t("resourceLibrary.previewCourseware"),onCancel:()=>{}}}}componentDidMount(){this.funGetList()}componentDidUpdate(n){n.fileId!==this.props.fileId&&this.props.fileId&&this.funGetList()}render(){var n=this.state,a=n.resourcePlayInfo,l=n.previewInfo;return d().createElement("div",null,this.renderFileList(),d().createElement(m.Z,(0,S.Z)({},a,{previewInfo:l})))}}i.defaultProps={prefixCls:"file-list-line-class",title:"",fileId:"",isComponent:!1,fileList:[],useLocalList:!1,isCard:""},H.Z=(0,O.$j)(o=>({corpId:o.user.corpId,account:o.user.account}))((0,K.Z)()(i))},72358:function(Ce,H,e){"use strict";e.d(H,{g3:function(){return S},hR:function(){return E},ZQ:function(){return T},HM:function(){return C},RZ:function(){return N},K5:function(){return d},az:function(){return K},_C:function(){return O},p_:function(){return f}});var A=e(37055),r=e(10237);function S(h){return r.WY.get({url:A.ZP.lineClassStudy.getMyEvaluate(),params:h})}function E(h,g){return r.WY.post({url:A.ZP.lineClassStudy.evaluateSubmit(h),data:g})}function T(h,g){return r.WY.post({url:A.ZP.lineClassStudy.scoreSubmit(h),data:g})}function C(h,g){return r.WY.post({url:A.ZP.lineClassStudy.approvalSubmit(h),data:g})}function N(h,g){return r.WY.get({url:A.ZP.lineClassStudy.getEvaluateMyInfo(h),params:g})}function d(h,g){return r.WY.get({url:A.ZP.lineClassStudy.getMyEvaluateInfo(h),params:g})}function K(h,g){return r.WY.get({url:A.ZP.lineClassStudy.getMyEvaluateInfoManage(h),params:g})}function O(h,g){return r.WY.get({url:A.ZP.lineClassStudy.userEvaluateLecturerList(h),params:g})}function f(h){return r.WY.get({url:A.ZP.lineClassStudy.getEvaluateCount(),params:h})}},17676:function(Ce,H,e){"use strict";e.d(H,{E6:function(){return E},h$:function(){return T},_v:function(){return C},R9:function(){return N},wq:function(){return K},BV:function(){return O},Np:function(){return f},af:function(){return c},RX:function(){return M},WF:function(){return w},gm:function(){return m}});var A=e(88986),r=e(37055),S=e(10237);function E(s){return S.WY.get({url:r.ZP.lineClassStudy.signCourses(),params:s})}function T(s){return S.WY.get({url:r.ZP.lineClassStudy.signCoursesCount(),params:s})}function C(s){return S.WY.get({url:r.ZP.lineClassStudy.teachingsList(),params:s})}function N(s){return S.WY.get({url:r.ZP.lineClassStudy.teachingCoursesCount(),params:s})}function d(s){return request.get({url:CONFIG.lineClass.getOfflineCourseSignAnalysis(s)})}function K(s,t){return S.WY.post({url:r.ZP.lineClass.updateOfflineCourseSetting(),data:(0,A.Z)({courseId:s,enterpriseId:localStorage.getItem("enterpriseId")},t)})}function O(s){return S.WY.get({url:r.ZP.lineClass.getOfflineCourseSetting(),params:{courseId:s,enterpriseId:localStorage.getItem("enterpriseId")}})}function f(s){return S.WY.post({url:r.ZP.lineClassStudy.lecturerRefuse(s)})}function h(s){return request.get({url:CONFIG.lineClassStudy.approvalsList(),params:s})}function g(){return request.get({url:CONFIG.lineClassStudy.approvalCoursesCount()})}function c(s){return S.WY.post({url:r.ZP.lineClassStudy.resouceAdd(),data:s})}function M(s){return S.WY.get({url:r.ZP.lineClassStudy.getResource(),params:s})}function w(s){return S.WY.get({url:r.ZP.lineClassStudy.getLineCourse(),params:s})}function m(s){return S.WY.get({url:r.ZP.lineClassStudy.getStuAttendanceInfo(s),params:{}})}},72456:function(Ce,H,e){"use strict";var A=e(49111),r=e(19650),S=e(57663),E=e(71577),T=e(12924),C=e.n(T),N=e(28216),d=e(91768),K=e(84391),O=e(90631),f=e(49101),h=e(76651),g=e(31945),c=e(1164),M=e(51697),w=s=>{var t=s.user,i=s.currentRoute,o=s.advancedSetting;return{currentPath:i.path,allAuthRoutes:i.allAuthRoutes,userLng:t.lng,themeColor:o.themeColor,qyShield:t.qyShield}};class m extends C().Component{constructor(){super(...arguments);this.handleDownload=()=>{this.props.onDownload()},this.handleImport=()=>{this.props.onImport()},this.handleCreate=()=>{var t=this.props.tabLink;h.m8.push(t)},this.renderActionBtn=()=>{var t=this.props,i=t.prefixCls,o=t.actionText,n=t.t,a=t.tabLink,l=t.showBtn,u=t.renderActionBtn,p=t.newPage,y=t.popOverProps,W=y===void 0?[]:y,P=t.renderGuide,L=P===void 0?!1:P,B=t.showDownloadBtn,D=B===void 0?!1:B,J=t.showImportBtn,G=J===void 0?!1:J,z=t.showCreateBtn,se=z===void 0?!0:z,he=t.rowReverse,_e=he===void 0?!1:he,Pe="".concat(i,"__action");if(!l&&u&&typeof u=="function")return C().createElement("div",{className:Pe},u());if(!l||!o)return null;var Oe=W.length?W[0].contentText:"";return C().createElement("div",{className:"".concat(Pe," ").concat(_e&&"row-reverse")},C().createElement(r.Z,{size:16},D&&C().createElement(E.Z,{icon:C().createElement(K.Z,null),onClick:this.handleDownload},n("common.exportData")),G&&C().createElement(E.Z,{icon:C().createElement(O.Z,null),onClick:this.handleImport},n("exam.importTemplate")),se&&p&&C().createElement(c.Z,{to:a},C().createElement(M.Z,{visible:Oe&&L,placement:"topLeft",title:Oe},C().createElement(E.Z,{type:"primary",id:"create-project-button",icon:C().createElement(f.Z,null)},o))),se&&!p&&C().createElement(E.Z,{type:"primary",id:"create-project-button",icon:C().createElement(f.Z,null),onClick:this.handleCreate},o)))},this.renderQueryRow=()=>{var t=this.props,i=t.queryRowParams,o=t.queryRowList,n=t.queryRowSelectedCourseIds,a=t.queryRowSelectedProjectIds,l=t.queryRowOnForceRender,u=t.queryRowOnClassifyChange,p=t.queryRowOnTypeChange,y=t.queryRowOnCourseTypeChange,W=t.queryRowAllowActions,P=t.showNum,L=P===void 0?1:P;return C().createElement(g.Z,{params:i,list:o,selectedCourseIds:n,selectedProjectIds:a,onForceRender:l,onClassifyChange:u,onTypeChange:p,onCourseTypeChange:y,allowActions:W,showNum:L,showRenderCondition:!1})},this.rendeExtraBtn=()=>{var t=this.props,i=t.t,o=t.extraBtnSelectedRowKeys,n=t.extraBtnHandleMultiVisibleRange;return C().createElement(E.Z,{disabled:o.length===0,onClick:n},i("courseManage.setTheVisibility"))}}render(){var t=this.props,i=t.prefixCls,o=t.wrapCls,n=t.showRenderQueryRow,a=t.showRendeExtraBtn;return C().createElement(C().Fragment,null,C().createElement("div",{className:"render_other"},C().createElement("header",{className:"".concat(i," ").concat(o)},C().createElement("section",{className:"".concat(i,"__radiocol")},this.renderActionBtn(),n&&this.renderQueryRow(),a&&this.rendeExtraBtn()))))}}m.defaultProps={prefixCls:"cl-listQueryRow",wrapCls:"",label:"",actionText:"add",showSearch:!0,showBtn:!0,newPage:!0,searchStylesProps:{},selectList:[],renderActionBtn:()=>null},H.Z=(0,N.$j)(w)((0,d.Z)()(m))},62117:function(Ce,H,e){"use strict";var A=e(63185),r=e(9676),S=e(43358),E=e(34041),T=e(88983),C=e(47933),N=e(12924),d=e.n(N),K=e(28216),O=e(91768),f=e(48479),h=e(2971),g=e(45601),c=e(7249),M=m=>{var s=m.user,t=m.currentRoute,i=m.advancedSetting;return{currentPath:t.path,allAuthRoutes:t.allAuthRoutes,userLng:s.lng,themeColor:i.themeColor,appType:s.appType,appId:s.appId}};class w extends d().Component{constructor(s){super(s);this.setPlaceholder=()=>{var t=this.props,i=t.currentPath,o=t.allAuthRoutes,n=t.userLng,a=this.state.language,l=o[i],u=this.props,p=u.appType,y=u.appId,W=localStorage.getItem("qyWechatBook"),P=p==="wx_app"&&W==="true"&&y==="9005";if(!!l){var L=a[n].searchInputPlaceholder,B="";l.menuKey==="studyTemplate"||l.menuKey==="examTemplate"?B=L.template:l.menuKey==="employee"||l.menuKey==="obligatory"||l.menuKey==="elective"||l.menuKey==="plan"||l.menuKey==="evaluation"||l.menuKey==="myEvaluationPlan"?B=L.task:l.menuKey==="studyProject"?B=P?L.byProjectName:L.byProjectNameOrCreator:l.menuKey==="management"?B=P?L.byTaskName:L.byTaskNameOrCreator:B=L[l.menuKey],this.setState({currentPlaceholder:B})}},this.handleRadiosChange=t=>{this.props.onRadiosChange(t.target.value)},this.handleSelectChange=t=>{this.props.onSelectChange(t)},this.handleSearch=(t,i)=>{this.props.onSearch(t,i)},this.handleChange=t=>{this.props.onCheckboxChange(t.target.checked)},this.renderRadios=()=>{var t=this.props,i=t.prefixCls,o=t.radioList,n=t.defaultRadioValue,a=t.radioValue;if(!o.length)return null;var l=n||o[0].value,u="".concat(i,"__radios");return d().createElement("div",{className:u},typeof a!="undefined"?d().createElement(C.ZP.Group,{defaultValue:l,value:a,onChange:this.handleRadiosChange},o.map(p=>d().createElement(C.ZP.Button,{key:p.value,value:p.value},p.name))):d().createElement(C.ZP.Group,{defaultValue:l,onChange:this.handleRadiosChange},o.map(p=>d().createElement(C.ZP.Button,{key:p.value,value:p.value},p.name))))},this.renderSelect=()=>{var t=this.props,i=t.prefixCls,o=t.selectList,n=t.defaultSelectValue;if(!o.length)return null;var a=n||o[0].value,l="".concat(i,"__select");return d().createElement("div",{className:l},d().createElement(E.Z,{defaultValue:a,onChange:this.handleSelectChange,style:{minWidth:100}},o.map(u=>d().createElement(E.Z.Option,{key:u.value,value:u.value},u.name))))},this.renderOther=()=>{var t=this.props,i=t.prefixCls,o=t.renderOther,n=t.showOther,a="".concat(i,"__other");if(n&&o&&typeof o=="function")return d().createElement("div",{className:a},o())},this.renderCheckbox=()=>{var t=this.props,i=t.prefixCls,o=t.t,n=t.label,a=t.showCheckbox,l=t.renderActionSelect,u="".concat(i,"__checkbox");return!a&&l&&typeof l=="function"?d().createElement("div",{className:u},l()):a?d().createElement("div",{className:u},d().createElement(r.Z,{onChange:this.handleChange},n||o("common.myCreated"))):null},this.renderSearch=()=>{var t=this.props,i=t.prefixCls,o=t.showSearch,n=t.inputPlaceholder,a=t.maxLength,l=a===void 0?400:a,u=t.value,p="".concat(i,"__search");if(!o)return null;var y=this.state.currentPlaceholder;return n?d().createElement("div",{className:p},d().createElement(f.Z,{onSearch:this.handleSearch,placeholder:n,width:272,maxLength:l})):d().createElement("div",{className:p},d().createElement(f.Z,{onSearch:this.handleSearch,placeholder:y,width:272,maxLength:l,value:u}))},this.renderSearchOther=()=>{var t=this.props.renderSearchOther;return t?t():null},this.state={language:{zh_cn:g.Z,en_us:h.Z,zh_hk:c.Z},currentPlaceholder:""}}componentDidMount(){this.setPlaceholder()}componentDidUpdate(s){s.userLng!==this.props.userLng&&this.setPlaceholder()}render(){var s=this.props,t=s.prefixCls,i=s.wrapCls,o=s.showRenderRadios,n=o===void 0?!0:o,a=s.showRenderSelect;return d().createElement(d().Fragment,null,d().createElement("div",{className:"render_other"},this.renderOther(),d().createElement("header",{className:"".concat(t," ").concat(i)},d().createElement("section",{className:"".concat(t,"__searchcol")},this.renderSearchOther(),this.renderCheckbox(),n&&this.renderRadios(),a&&this.renderSelect(),this.renderSearch()))))}}w.defaultProps={prefixCls:"cl-listQueryRow",wrapCls:"",label:"",showRadioList:!0,showCheckbox:!0,showSearch:!0,inputPlaceholder:"",defaultRadioValue:"",radioList:[],searchStylesProps:{},showRenderSelect:!1,selectList:[],renderActionBtn:()=>null,onRadiosChange:()=>{},onSearch:()=>{},onCheckboxChange:()=>{},renderSearchOther:()=>{}},H.Z=(0,K.$j)(M)((0,O.Z)()(w))},22687:function(Ce,H,e){"use strict";e.r(H),e.d(H,{default:function(){return w}});var A=e(12924),r=e.n(A),S=e(28216),E=e(91768),T=e(76651),C=e(57068),N=e(78138),d=e.n(N),K=e(90734),O=e(60667);class f extends r().Component{constructor(s){super(s);this.getBasicData=()=>{var t=this.props,i=t.courseId,o=t.getTitleName;(0,K.Tq)(i).then(n=>{n.data.code==="200000"&&(this.setState({basicData:n.data.data}),o&&o(n.data.data.title))})},this.state={basicData:{}}}componentDidMount(){this.getBasicData()}render(){var s=this.props,t=s.prefixCls,i=s.t,o=this.state.basicData;return r().createElement("div",{className:"".concat(t,"-desc")},r().createElement("div",{className:"".concat(t,"-desc-row")},r().createElement("span",null,i("component.lecturer"),"\uFF1A",o.teacher_sync_type==="inside"?r().createElement(O.Z,{dataType:"userName",value:o.teacher_sync_user_id,name:o.lecturer_name,type:o.teacher_sync_source_type}):r().createElement("span",null,o.lecturer_name||"--")),r().createElement("span",null,i("learning.learningEmployeeAddTerm"),"\uFF1A","".concat(d()(o.begin_time).format("YYYY-MM-DD HH:mm"),"~").concat(d()(o.end_time).format("YYYY-MM-DD HH:mm"))),r().createElement("span",{className:"".concat(t,"-desc-row-address")},i("component.offlineAddress"),"\uFF1A",o.address||"--")),r().createElement("div",{className:"".concat(t,"-desc-row")},r().createElement("span",null,i("common.creator"),"\uFF1A",r().createElement(O.Z,{dataType:"userName",value:o.creator_sync_user_id,name:o.create_user_name,type:o.creator_source_type})),r().createElement("span",null,i("common.createTime"),"\uFF1A",d()(o.create_time).format("YYYY-MM-DD HH:mm"))))}}f.defaultProps={prefixCls:"line-class-monitor"};var h=(0,S.$j)()((0,E.Z)()(f)),g=e(20294),c=e(11449);class M extends r().Component{constructor(s){super(s);this.onGetTitleName=i=>{this.setState({title:i})},this.renderExtra=()=>{var i=C.parse(T.m8.location.search),o=i.courseId;return r().createElement(h,{courseId:o,getTitleName:this.onGetTitleName})},this.handleChangeActive=i=>{this.setState({activeKey:i})},this.renderTabPanel=()=>{var i=C.parse(T.m8.location.search),o=i.sourceType,n=i.signId,a=this.state,l=a.activeKey,u=a.title;switch(l){case"user":return r().createElement(g.Z,{title:u,sourceType:o,signId:n});default:return r().createElement(g.Z,{sourceType:o,signId:n})}};var t=s.t;this.state={tabList:[{key:"user",tab:t("study.monitoring")}],activeKey:"user",title:""}}render(){var s=this.props,t=s.t,i=s.prefixCls,o=this.state,n=o.tabList,a=o.title;return r().createElement(c.Z,{noPadding:!0,className:i,pageTitle:t("lineClass.lineClassMonitor"),pageContainerParams:{header:{title:a},content:this.renderExtra(),tabList:n,onTabChange:this.handleChangeActive}},r().createElement("div",{className:"".concat(i,"-container")},this.renderTabPanel()))}}M.defaultProps={prefixCls:"line-class-monitor"};var w=(0,S.$j)()((0,E.Z)()(M))},20294:function(Ce,H,e){"use strict";e.d(H,{Z:function(){return fe}});var A=e(12924),r=e.n(A),S=e(28216),E=e(91768),T=e(62029),C=e(14781),N=e(53431),d=e(34792),K=e(48086),O=e(57663),f=e(71577),h=e(57361),g=e(93485),c=e(33565),M=e(34669),w=e(82833),m=e(22385),s=e(31097),t=e(88986),i=e(9754),o=e.n(i),n=e(84391),a=e(76651),l=e(78138),u=e.n(l),p=e(57068),y=e(27326),W=e.n(y),P=e(61120),L=e.n(P),B=e(38642),D=e(37055),J=e(18329),G=e(44970),z=e(72456),se=e(62117),he=e(30311),_e=e(97593),Pe=e(55285),Oe=e(17676),Y=e(90734),v=e(17762),U=e(83655),x=e(59169),F=e(65202),k=e(72358),j=e(60667);class te extends r().Component{constructor(re){var ue;super(re);ue=this,this.getLineClassList=()=>{var _=this.state.listParam,I=this.props,R=I.type,q=I.sourceType,ce=I.signId,ae=p.parse(a.m8.location.search),ee=ae.taskId,b=ae.courseId;(0,Y.MI)((0,t.Z)((0,t.Z)({},_),{},{planId:ee,courseId:b,signId:ce,type:q,score:R||"management"})).then(V=>{V.data.code==="200000"&&this.setState({taskList:V.data.data.list,listParam:(0,t.Z)((0,t.Z)({},_),{},{total:V.data.data.total})})})},this.resetRequestList=function(){var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},I=ue.state.listParam;ue.setState({listParam:(0,t.Z)((0,t.Z)({},I),{},{pageNumber:1},_)},()=>ue.getLineClassList())},this.getBasicData=()=>{var _=p.parse(a.m8.location.search),I=_.courseId;(0,Y.Tq)(I).then(R=>{R.data.code==="200000"&&this.setState({lecturerId:R.data.data.lecturer_user_id})})},this.getTableColumns=()=>{var _=(0,F.p)(),I=this.props,R=I.t,q=I.type,ce=this.state,ae=ce.taskList,ee=ce.signStatus,b=ce.showAddress,V=[];ae[0]&&(V=ae[0].sign_details.map((ie,$)=>{var Q={title:R("component.checkInTime"),width:200,dataIndex:["sign_details",$],render:X=>X.sign_status==="leaved"?"\u8BF7\u5047":X.sign_in_time?r().createElement("span",null,u()(X.sign_in_time).format("YYYY-MM-DD HH:mm"),"(",ee[X.sign_in_status],")"):"-- (".concat(ee[X.sign_in_status],")")},le={title:R("component.checkInAddress"),width:200,dataIndex:["sign_details",$],render:X=>r().createElement(s.Z,{title:X.sign_in_address||"--"},r().createElement("div",{className:"cl-text-ellipsis",style:{width:150}},X.sign_in_address||"--"))},me={title:R("lineClass.signBack"),width:200,dataIndex:["sign_details",$],render:X=>X.sign_status==="leaved"?"\u8BF7\u5047":X.sign_out_time?r().createElement("span",null,u()(X.sign_out_time).format("YYYY-MM-DD HH:mm"),"(",ee[X.sign_out_status],")"):"-- (".concat(ee[X.sign_out_status],")")},Ie={title:R("lineClass.signAddress"),width:200,dataIndex:["sign_details",$],render:X=>r().createElement(s.Z,{title:X.sign_out_address||"--"},r().createElement("div",{className:"cl-text-ellipsis",style:{width:150}},X.sign_out_address||"--"))},ye=[];return ie.is_set_sign_in&&(ye.push(Q),b&&ye.push(le)),ie.is_set_sign_out&&(ye.push(me),b&&ye.push(Ie)),{title:ie.sign_name,children:ye}}));var ve=[{title:R("lineClass.totalProgressTraining"),dataIndex:"progress",key:"progress",width:200,render:ie=>r().createElement(w.Z,{strokeColor:_,percent:ie,format:$=>"".concat($,"%")})},{title:R("lineClass.offlineTrainingDuration"),dataIndex:"study_duration_str",key:"study_duration_str",width:150,render:ie=>ie||"--"},{title:R("lineClass.assesResult"),dataIndex:"score",key:"score",width:150,render:(ie,$)=>r().createElement(r().Fragment,null,$.assessment_user_name?ie:"--")},{title:R("examing.comments"),dataIndex:"remark",key:"remark",width:150,render:ie=>r().createElement(s.Z,{title:ie||"--"},r().createElement("div",{className:"cl-text-ellipsis",style:{width:150}},ie||"--"))},{title:R("lineClass.gradeAttachment"),dataIndex:"attachment_count",key:"attachment_count",width:150,render:(ie,$)=>ie?r().createElement(he.Z,{name:ie,onClick:()=>this.showAttachmentList(ie,$.attachment_id)}):"--"},{title:R("lineClass.recordPersonnel"),dataIndex:"assessment_user_name",key:"assessment_user_name",width:150,render:(ie,$)=>{var Q=$.assessment_sync_user_id,le=$.assessment_sync_source_type;return r().createElement(j.Z,{dataType:"userName",value:Q,name:ie,type:le})}}];if(q!=="student"&&ve.push({title:R("lineClass.studentsScore"),dataIndex:"evaluate_message",key:"evaluate_message",width:150,render:(ie,$)=>$.evaluate_message?$.evaluate_message.evaluate_type==="questionnaire"?r().createElement(he.Z,{name:$.evaluate_message.evaluate_name,onClick:()=>this.viewQuestion($.evaluate_message,$)}):$.evaluate_message.evaluate_name:"--"}),V.length>0){var oe=(0,g.Z)(V.entries()),De;try{for(oe.s();!(De=oe.n()).done;){var Me=De.value,Le=(0,c.Z)(Me,2),Re=Le[0],Ze=Le[1];ve.splice(1+Re,0,Ze)}}catch(ie){oe.e(ie)}finally{oe.f()}}return ve},this.viewQuestion=function(){var _=(0,h.Z)(o().mark(function I(R,q){var ce,ae,ee,b,V;return o().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return ce=R.evaluate_id,ae=q.user_id,ee=p.parse(a.m8.location.search),b=ee.courseId,oe.next=5,(0,k.az)({courseId:b,lecturer_user_id:ue.state.lecturerId},{evaluate_id:ce,is_evaluated:!0,evaluate_object_id:ae});case 5:V=oe.sent,V.data.code==="200000"&&V.data.data.questionnaire_result_vo&&ue.setState({question:{visible:!0,info:V.data.data.questionnaire_result_vo}});case 7:case"end":return oe.stop()}},I)}));return function(I,R){return _.apply(this,arguments)}}(),this.showAttachmentList=(_,I)=>{!_||this.setState({fileList:{visible:!0,id:I}})},this.handleSingleCollection=()=>{var _=p.parse(a.m8.location.search),I=_.taskId,R=_.courseId;a.m8.push("/knowledgeBase/learningResources/lineClass/additionalRecording?fromType=task&courseId=".concat(R,"&taskId=").concat(I))},this.renderExportBtn=()=>{var _=(0,B.UI)("PRINT_SIGNATURE"),I=this.props.t;return r().createElement("div",{className:"btn-group"},r().createElement(f.Z,{icon:r().createElement(n.Z,null),type:"primary",onClick:this.handleDownload},I("common.exportData")),_&&r().createElement(f.Z,{style:{marginLeft:10},onClick:this.handleShowPrintSignature},I("common.printSignature")))},this.handleDownload=()=>{var _=this.state.listParam,I=this.props,R=I.type,q=I.sourceType,ce=I.signId,ae=p.parse(a.m8.location.search),ee=ae.taskId,b=ae.courseId,V={plan_id:ee,department_id:_.departmentId,post_id:_.postId,keyword:_.keyword,source:R||"management"},ve="?".concat(p.stringify(V),"&type=").concat(q,"&course_id=").concat(b);(0,_e.N)({page:"monitorUserExport",props:this.props,query:ve,rest:ce})},this.headerTitle=()=>{var _=this.props.type;return _==="student"?null:r().createElement(z.Z,{showBtn:!1,renderActionBtn:this.renderExportBtn})},this.handleSearch=(_,I)=>{var R=this.state.listParam,q=(0,t.Z)((0,t.Z)({},R),{},{pageNumber:1,keyword:I===""?_:"",userIds:I});this.setState({listParam:q},()=>this.getLineClassList())},this.handleShowPrintSignature=()=>{this.setState({showPrint:!0})},this.handleHidePrintSignature=()=>{this.setState({showPrint:!1,printConfig:null})},this.handlePreview=(0,h.Z)(o().mark(function _(){var I,R,q,ce;return o().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:if(!ue.printRef){ee.next=11;break}if(I=ue.printRef.current,R=I.getErrorMsg(),!R){ee.next=6;break}return K.default.error(R),ee.abrupt("return");case 6:return q=ue.state.signatureId,ce=(0,t.Z)((0,t.Z)({},I.printOptions),{},{userIds:I.selectStudents&&I.selectStudents.map(b=>b.id).join(",")}),ee.next=10,(0,Oe.wq)(q,ce);case 10:ue.setState({printConfig:(0,t.Z)((0,t.Z)({},I.printOptions),{},{selectStudents:I.selectStudents,backContent:I.backContent})});case 11:case"end":return ee.stop()}},_)})),this.handlePrintf=()=>{this.setState({signatureId:null});var _=this.props.t,I=this.state.printConfig.selectStudents,R=navigator.appVersion,q="DingTalk";if(R.indexOf(q.toLowerCase())>-1){K.default.warn(_("printingIsNotSupported.printingIsNotSupported"));return}try{if(I){var ce=document.createElement("div"),ae=document.body.innerHTML,ee=document.getElementById("printContainer");I.forEach(b=>{var V=this.generateHtml(ee,ce,b);ce.appendChild(V)}),document.body.innerHTML=ce.innerHTML,document.body.style.paddingTop="150px",window.print(),document.body.innerHTML=ae,window.location.reload()}}catch(b){console.error(b)}},this.generateHtml=(_,I,R)=>{var q=_.cloneNode(!0);q.id=R.id,q["data-html2canvas-ignore"]=!0;var ce=this.findDomByCls(q,"studentName"),ae=this.findDomByCls(q,"deptName"),ee=this.findDomByCls(q,"postName");return ce.forEach(b=>{b.innerHTML=R.name}),ae.forEach(b=>{b.innerHTML=R.dept_name}),ee.forEach(b=>{b.innerHTML=R.post_name}),I.appendChild(q),q.style.width="100%",q},this.handleDownloadSignature=()=>{var _=this.state.printConfig.selectStudents,I=new(W())("p","mm","a4");if(_){var R=document.createElement("div"),q=document.getElementById("printContainer"),ce=_.map((ae,ee)=>{var b=this.generateHtml(q,R,ae);document.body.appendChild(R),R.style.width="1120px";var V=new Promise(ve=>{L()(b,{allowTaint:!0,scale:1}).then(oe=>{var De=oe.getContext("2d"),Me=190,Le=277,Re=Math.floor(Le*oe.width/Me),Ze=0,ie=document.createElement("canvas");ie.width=oe.width,ie.height=Math.min(Re,oe.height-Ze);var $=Me*oe.height/oe.width,Q=(Le-$)/2;ie.getContext("2d").putImageData(De.getImageData(0,Ze,oe.width,Math.min(Re,oe.height-Ze)),0,0),I.addImage(ie.toDataURL("image/jpeg",1),"JPEG",10,Q,Me,$),_.length-1!==ee&&I.addPage(),ve(!0)})});return V});Promise.all(ce).then(()=>{I.save("".concat(this.props.title,".pdf")),document.body.removeChild(R)})}},this.findDomByCls=function(_,I){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];return _.className&&_.className.indexOf(I)>-1&&R.push(_),_.childNodes.forEach(q=>{ue.findDomByCls(q,I,R)}),R},this.toolBarRender=()=>{var _=this.props.t;return r().createElement(se.Z,{showCheckbox:!1,onSearch:this.handleSearch,inputPlaceholder:_("searchInputPlaceholder.name")})},this.pageChange=(_,I)=>{var R=this.state.listParam;this.setState({listParam:(0,t.Z)((0,t.Z)({},R),{},{pageNumber:_,pageSize:I})},()=>this.getLineClassList())};var ge=re.t;this.state={isLoading:!1,taskList:[],listParam:{pageNumber:1,pageSize:20,total:0},signStatus:{missing:ge("lineClass.missing"),normal:ge("marketing.normal"),abnormal:ge("lineClass.abnormal"),leaved:ge("lineClass.leave")},fileList:{visible:!1,id:""},showAddress:!1,question:{visible:!1,info:{}},lecturerId:""},this.printRef=r().createRef()}componentDidMount(){this.getBasicData(),this.getLineClassList()}render(){var re=this.props,ue=re.prefixCls,ge=re.t,_=re.sourceType,I=re.signId,R=this.state,q=R.taskList,ce=R.isLoading,ae=R.listParam,ee=R.fileList,b=R.question,V=R.printConfig,ve=R.showPrint,oe=this.getTableColumns(),De=(0,t.Z)((0,t.Z)({},D.XE.INITIAL_PAGINATION),{},{current:ae.pageNumber,total:Number(ae.total),onChange:this.pageChange}),Me=p.parse(a.m8.location.search),Le=Me.taskId,Re=Me.courseId,Ze={okText:ge("common.ok"),cancelText:ge("common.cancel"),size:"large",destroyOnClose:!0,bodyStyle:{padding:"0"},maskClosable:!1,footer:null};return r().createElement("div",{className:"".concat(ue)},r().createElement(Pe.Z,{loading:ce,dataSource:q,columns:oe,rowKey:ie=>ie.id,pagination:!1,headerTitle:this.headerTitle(),toolBarRender:this.toolBarRender,tableUUID:"804e66cd-7156-4e14-bad8-388da74fa3f1"}),ae.total>ae.pageSize||!De.hideOnSinglePage?r().createElement("div",{className:"".concat(ue,"-pagination")},r().createElement(N.Z,De)):null,r().createElement(v.Z,{title:ge("lineClass.trainingAttachment"),visible:ee.visible,fileId:ee.id,onCancel:()=>{this.setState({fileList:(0,t.Z)((0,t.Z)({},ee),{},{visible:!1})})}}),r().createElement(J.ZP,{visible:ve,title:"\u6253\u5370\u5EA7\u7B7E",width:"60%",onCancel:this.handleHidePrintSignature,footer:r().createElement("div",{className:"align-center"},V?r().createElement(r().Fragment,null,r().createElement(f.Z,{onClick:()=>{this.setState({printConfig:null})}},"\u53D6\u6D88"),r().createElement(f.Z,{type:"primary",onClick:this.handlePrintf},"\u6253\u5370\u5168\u90E8"),r().createElement(f.Z,{type:"primary",onClick:this.handleDownloadSignature},"\u4E0B\u8F7D\u5168\u90E8")):r().createElement(r().Fragment,null,r().createElement(f.Z,{onClick:this.handleHidePrintSignature},"\u53D6\u6D88"),r().createElement(f.Z,{type:"primary",onClick:this.handlePreview},"\u6253\u5370\u9884\u89C8")))},V?r().createElement(x.Z,{printConfig:V}):r().createElement(U.Z,{sourceType:_,signId:I,t:ge,ref:this.printRef,courseId:Re,taskId:Le})),r().createElement(J.ZP,(0,T.Z)({title:ge("common.questionnaire")},Ze,{visible:b.visible,onCancel:()=>{this.setState({question:(0,t.Z)((0,t.Z)({},b),{},{visible:!1})})}}),r().createElement("div",{className:"".concat(ue,"-question")},r().createElement(G.Z,{questionnaireInfo:b.info,isPreview:!0,setQuestionValue:()=>{}}))))}}te.defaultProps={prefixCls:"line-class-monitor-user-list",title:""};var ne=(0,S.$j)(de=>({appType:de.user.appType,themeColor:de.advancedSetting.themeColor,qyShield:de.user.qyShield}),()=>{},null,{forwardRef:!0})((0,E.Z)("translation",{withRef:!0})(te)),Z=e(64630),pe=e(64262);class Ee extends r().Component{constructor(){super(...arguments);this.handleTreeSelectChange=re=>{this.tableRef&&this.tableRef.resetRequestList({departmentId:re})},this.handlePostSelectChange=re=>{this.tableRef&&this.tableRef.resetRequestList({postId:re})},this.getTableRef=re=>{this.tableRef=re}}render(){var re=this.props,ue=re.prefixCls,ge=re.type,_=re.sourceType,I=re.signId,R=re.title;return r().createElement("div",{className:"".concat(ue," line-class-monitor-container-border")},r().createElement("div",{className:"".concat(ue,"-header")},r().createElement(pe.Z,{className:"".concat(ue,"-header-select"),parentId:"",width:245,checkable:!1,asyncLoad:!0,treeSelect:!0,handleTreeSelectChange:this.handleTreeSelectChange}),r().createElement(Z.Z,{disabled:!1,className:"user-panel-monitor-filter-dept choose-by-select cl-search-normal-width",onChange:this.handlePostSelectChange})),r().createElement(ne,{ref:this.getTableRef,type:ge,sourceType:_,signId:I,title:R}))}}Ee.defaultProps={prefixCls:"line-class-monitor-user",title:""};var fe=(0,S.$j)()((0,E.Z)()(Ee))},90734:function(Ce,H,e){"use strict";e.d(H,{Tq:function(){return S},MI:function(){return E},bp:function(){return d},DD:function(){return K},hM:function(){return O},HE:function(){return f},yt:function(){return c},yy:function(){return M},$W:function(){return w}});var A=e(37055),r=e(10237);function S(m){return r.WY.get({url:A.ZP.lineClass.getOfflineCourseBasicById(m)})}function E(m){var s=m.type,t=m.planId,i=m.departmentId,o=i===void 0?"":i,n=m.postId,a=n===void 0?"":n,l=m.keyword,u=l===void 0?"":l,p=m.courseId,y=m.pageNumber,W=m.pageSize,P=m.signId,L=P===void 0?"":P,B=m.source,D=m.userIds;return r.WY.get({url:A.ZP.lineClass.getMonitorUserList(L),params:{plan_id:t,course_id:p,department_id:o,post_id:a,keyword:u,page_number:y,page_size:W,sign_id:L,source:B,type:s,userIds:D}})}function T(m){return request.get({url:CONFIG.lineClass.getOfflineCourseSignAnalysis(m)})}function C(m){return request.get({url:CONFIG.lineClass.getOfflineSignSetting(m)})}function N(m){var s=m.courseId,t=m.signId,i=m.userId;return request.post({url:CONFIG.lineClass.offlineMarkLeave(s,t),params:{user_id:i}})}function d(){return r.WY.get({url:A.ZP.Common.getServerTime()})}function K(m){var s=m.integral,t=m.courseId,i=m.subsidy,o=m.is_lecturer_subsidy,n=m.lectureId;return r.WY.post({url:A.ZP.lineClass.commitCourseStatement(t),data:{integral:s,subsidy:i,is_lecturer_subsidy:o,lecture_id:n}})}function O(m){var s=m.courseId,t=m.actual_cost,i=m.summary,o=m.summary_attachment_id_list;return r.WY.post({url:A.ZP.lineClass.commitOfflineCourseSummary(s),data:{actual_cost:t,summary:i,summary_attachment_id_list:o}})}function f(m){var s=m.courseId,t=m.lecturer_id;return r.WY.get({url:A.ZP.lineClass.getOfflineCourseSummary(s),param:{lecturer_id:t}})}function h(m){return request.get({url:CONFIG.lineClass.getOfflineDetail(m)})}function g(m){return request.get({url:CONFIG.lineClass.getEvaluateDataByOffline(m)})}function c(m){var s=m.courseId,t=m.type,i=m.evaluate_id,o=m.evaluate_type,n=m.lecturer_id,a=m.post_id,l=m.department_id,u=m.keyword,p=m.page_number,y=m.page_size,W=m.userIds;return r.WY.get({url:A.ZP.lineClass.getEvaluateDetailDataList(s),params:{type:t,evaluate_id:i,evaluate_type:o,lecturer_id:n,post_id:a,department_id:l,keyword:u,page_number:p,page_size:y,userIds:W}})}function M(){return r.WY.post({url:A.ZP.lineClass.studyProjectsImportConfirm()})}function w(m,s,t){return r.WY.post({url:A.ZP.lineClass.attendanceConform(m,s,t)})}},83655:function(Ce,H,e){"use strict";e.d(H,{Z:function(){return Oe}});var A=e(13062),r=e(71230),S=e(89032),E=e(15746),T=e(43185),C=e(53251),N=e(57663),d=e(71577),K=e(47673),O=e(4107),f=e(63185),h=e(9676),g=e(88986),c=e(57361),M=e(33565),w=e(9754),m=e.n(w),s=e(12924),t=e.n(s),i=e(96486),o=e(49101),n=e(22385),a=e(31097),l=e(43358),u=e(34041),p=e(48736),y=e(27049),W=(Y,v)=>{var U=Y.students,x=Y.defaultValue,F=x===void 0?0:x,k=Y.onChange,j=Y.t,te=(0,s.useState)(U),ne=(0,M.Z)(te,2),Z=ne[0],pe=ne[1],Ee=(0,s.useState)([]),fe=(0,M.Z)(Ee,2),de=fe[0],re=fe[1],ue=(0,s.useState)(!1),ge=(0,M.Z)(ue,2),_=ge[0],I=ge[1];(0,s.useImperativeHandle)(v,()=>({setOpen:I})),(0,s.useEffect)(()=>{if(U){var b=U.map(V=>({value:V.id,key:V.id,title:V.name}));pe(b),parseInt(F)===0?re(b.map(V=>V.value)):re(F)}},[U,F]);var R=b=>()=>{if(I(!0),de.find(oe=>oe===b)){var V=de.filter(oe=>oe!==b);re(V),k(V)}else{var ve=(de||[]).concat(b);re(ve),k(ve)}},q=b=>{if(b.target.checked){var V=Z.map(ve=>ve.value);re(V),k(V)}else re([]),k([])},ce=!(de.length&&de.length===Z.length),ae=()=>de&&de.map(b=>{var V=U.find(ve=>ve.id===b);return(0,i.get)(V,"name")}).join(","),ee=t().createElement(u.Z,{value:[],style:{width:300},placeholder:ae(),open:_,onClick:()=>{I(!0)}},t().createElement(u.Z.Option,{onMouseEnter:()=>I(!0),onMouseLeave:()=>I(!1)},t().createElement("div",null,t().createElement(h.Z,{indeterminate:ce,checked:!ce,onChange:q},j("lineClassStudy.whole")),t().createElement(y.Z,{style:{margin:"2px 0px"}}))),Z.map(b=>{var V=b.title,ve=b.value,oe=b.key;return t().createElement(u.Z.Option,{onChange:R(ve),key:oe,value:ve,onMouseEnter:()=>I(!0),onMouseLeave:()=>I(!1)},t().createElement(h.Z,{checked:de.find(De=>De===ve)},V))}));return t().createElement(t().Fragment,null,t().createElement(a.Z,{title:ae()},ee),t().createElement("span",{onMouseEnter:()=>I(!1),style:{marginLeft:10}}," ",j("lineClassStudy.selected")," ",de.length," ",j("lineClassStudy.people")," "))};W.defaultProps={students:[],onChange:()=>{}};var P=(0,s.forwardRef)(W),L=e(83581),B=e(430),D=e.n(B),J=e(74525),G=Y=>{var v=Y.defaultUrl,U=Y.codeType,x=Y.detail,F=(0,s.useState)(""),k=(0,M.Z)(F,2),j=k[0],te=k[1],ne=(0,s.useState)(),Z=(0,M.Z)(ne,2),pe=Z[0],Ee=Z[1];switch((0,s.useEffect)(()=>{if(U!=="custom"&&x.id){var fe="";te({flag:"offline",scene:"flag=offline&clockTimeId=".concat(x.id,"&qcTime=").concat(fe,"&signStyle=").concat(U)})}},[U,x.id]),(0,s.useEffect)(()=>{v&&(0,L.y)(v).then(fe=>{Ee(fe)})},[v]),U){case"sign_in":return j&&t().createElement(J.Z,{option:j,type:"weixin",canSave:!1});case"sign_out":return j&&t().createElement(J.Z,{option:j,type:"weixin",canSave:!1});case"custom":return t().createElement("img",{src:pe,style:{width:200}});default:return null}};G.defaultProps={defaultUrl:"",codeType:"",detail:{}};var z=G,se=e(17676),he=e(10237),_e=e(37055),Pe=(Y,v)=>{var U=Y.signId,x=Y.courseId,F=Y.t,k=Y.sourceType,j=Y.taskId,te=(0,s.useState)({}),ne=(0,M.Z)(te,2),Z=ne[0],pe=ne[1],Ee=(0,s.useState)([]),fe=(0,M.Z)(Ee,2),de=fe[0],re=fe[1],ue=(0,s.useState)({}),ge=(0,M.Z)(ue,2),_=ge[0],I=ge[1],R=(0,s.useRef)(null),q=$=>{var Q;return $===void 0||Z.userIds==="0"?de:((Q=Z.userIds)===null||Q===void 0?void 0:Q.map)&&Z.userIds.map(le=>de.find(me=>me.id===le)).filter(le=>le)||[]},ce=function(){var $=(0,c.Z)(m().mark(function Q(le){var me,Ie,ye,X,Te,Ae,xe,we;return m().wrap(function(Se){for(;;)switch(Se.prev=Se.next){case 0:return Se.prev=0,Se.next=3,(0,se.BV)(le);case 3:return Ie=Se.sent,Se.next=6,he.WY.get({url:_e.ZP.StudyTaskMonitor.getAttendanceData(j),params:{source_type:k}});case 6:ye=Se.sent,X=Ie.data.data,Te=ye.data.data,Ae=Te.find(Ne=>Ne.course_id===le)||{},xe=(0,g.Z)((0,g.Z)({},X),{},{signInQrCode:{isShowSignIn:X.isShowSignIn,id:Ae.id},userIds:X.userIds==0?X.userIds:(me=X.userIds)===null||me===void 0?void 0:me.split(","),isShowCustom:!!X.qrCodePicture}),we=(0,i.cloneDeep)(xe),(Ae.qrcode_type==="dynamic"||!Ae.qrcode_type)&&(we.isSameAsReverse=!0),Te.length===1&&(we.signInQrCode.id=Te[0].id),I(Ae),pe(we),Se.next=21;break;case 18:Se.prev=18,Se.t0=Se.catch(0),console.error(Se.t0);case 21:case"end":return Se.stop()}},Q,null,[[0,18]])}));return function(le){return $.apply(this,arguments)}}();(0,s.useImperativeHandle)(v,()=>{var $,Q,le,me=q(Z.userIds),Ie=X=>X===void 0?!1:X,ye=["isShowLogo","isShowDepartment","isShowPosition","isSameAsReverse","isShowSignOut"];return{getErrorMsg:()=>{if(!me.length)return F("lineClassStudy.selectAtLeastOneStudent")},printOptions:(0,g.Z)((0,g.Z)({},ye.reduce((X,Te)=>(X[Te]=Ie(Z[Te]),X),{})),{},{isShowSignIn:(($=Z.signInQrCode)===null||$===void 0?void 0:$.isShowSignIn)||!1,signId:(Q=Z.signInQrCode)===null||Q===void 0?void 0:Q.id,qrCodePicture:Z.isShowCustom?Z.qrCodePicture:"",qrCodeName:Z.isShowCustom?Z.qrCodeName:""}),backContent:{signId:(le=Z.signInQrCode)===null||le===void 0?void 0:le.id,content:document.getElementById("backContent")},selectStudents:me,getSetting:ce}}),(0,s.useEffect)(()=>{try{if(U){var $=_e.ZP.lineClass.getMonitorUserList(U);he.WY.get({url:$,params:{course_id:x,page_number:1,page_size:100,source:"management",type:k}}).then(Q=>{var le=Q.data,me=le.data,Ie=le.code;if(Ie==="200000"){var ye=me.list&&me.list.map(X=>{var Te=X.user_info;return Te});re(ye)}})}}catch(Q){console.error(Q)}},[U,x,k]),(0,s.useEffect)(()=>{ce(x)},[x]);var ae=$=>Q=>{var le,me,Ie,ye,X=((le=Q.target)===null||le===void 0?void 0:le.checked)!==void 0||((me=Q.target)===null||me===void 0?void 0:me.value)!==void 0,Te=X?((Ie=Q.target)===null||Ie===void 0?void 0:Ie.checked)||((ye=Q.target)===null||ye===void 0?void 0:ye.value):Q;(0,i.set)(Z,$,Te),pe((0,g.Z)({},Z))},ee=$=>{var Q;((Q=$.file.response)===null||Q===void 0?void 0:Q.msg.toLowerCase())==="ok"&&pe((0,g.Z)((0,g.Z)({},Z),{},{qrCodePicture:$.file.response.data.path}))},b=$=>{pe((0,g.Z)((0,g.Z)({},Z),{},{userIds:$}))},V=localStorage.getItem("enterpriseLogo"),ve=()=>{var $,Q=_.qrcode_type==="statics";if(!_)return null;if(($=Z.signInQrCode)!==null&&$!==void 0&&$.isShowSignIn||Z.isShowSignOut||Z.qrCodePicture&&Z.isShowCustom){var le,me,Ie,ye=(0,i.get)(_,"exist_sign_out_config"),X=(0,i.get)(_,"exist_sign_in_config");return t().createElement(t().Fragment,null,t().createElement("div",{className:D().pictureContainer},((le=Z.signInQrCode)===null||le===void 0?void 0:le.isShowSignIn)&&((me=Z.signInQrCode)===null||me===void 0?void 0:me.id)&&X&&Q&&t().createElement("div",null,t().createElement(z,{codeType:"sign_in",detail:_,canSave:!1}),t().createElement("div",{className:"".concat(D().alignCenter," ").concat(D().signIn)},F("lineClassStudy.signIn"))),Z.isShowSignOut&&((Ie=Z.signInQrCode)===null||Ie===void 0?void 0:Ie.id)&&ye&&Q&&t().createElement("div",null,t().createElement(z,{codeType:"sign_out",detail:_,canSave:!1}),t().createElement("div",{className:"".concat(D().alignCenter," ").concat(D().signOut)},F("lineClassStudy.signOut"))),Z.qrCodePicture&&Z.isShowCustom&&t().createElement("div",null,t().createElement(z,{codeType:"custom",defaultUrl:Z.qrCodePicture}),t().createElement("div",{className:"".concat(D().alignCenter," ").concat(D().custom)},Z.qrCodeName))))}},oe=()=>(0,i.get)(_,"qrcode_type")==="dynamic",De=()=>{var $=oe();if($||!_.qrcode_type)return null;var Q=(0,i.get)(_,"exist_sign_in_config");if(!Q)return null;var le=(0,i.get)(Z,"signInQrCode.isShowSignIn"),me=t().createElement(h.Z,{checked:le,onChange:ae("signInQrCode.isShowSignIn")},F("lineClassStudy.signInQrCode"));return me},Me=()=>t().createElement(t().Fragment,null,t().createElement(h.Z,{checked:Z.isShowCustom,onChange:ae("isShowCustom")},F("lineClassStudy.custom")),Z.isShowCustom&&t().createElement("div",{style:{marginTop:10}},t().createElement(O.Z,{style:{marginBottom:10,width:250,marginRight:10},maxLength:16,placeholder:F("lineClassStudy.pleaseEnterANameWithAMaximumOf16Characters"),onChange:$=>{pe((0,g.Z)((0,g.Z)({},Z),{},{qrCodeName:$.target.value}))}}),t().createElement(C.Z,{accept:".jpeg,.png,jpg",onChange:ee,data:{access_token:localStorage.token},action:_e.ZP.PostAbility.operateAttachmentUpload(),showUploadList:!1},t().createElement(d.Z,{icon:t().createElement(o.Z,null)},F("lineClassStudy.selectPicture"))))),Le=()=>{var $=(0,i.get)(_,"exist_sign_out_config"),Q=oe();if(Q||!_.qrcode_type)return null;if($)return t().createElement(t().Fragment,null,t().createElement(h.Z,{checked:Z.isShowSignOut,onChange:ae("isShowSignOut")},F("lineClassStudy.signOutQrCode")))},Re=()=>{R.current.setOpen(!1)},Ze=()=>{var $=[{label:F("lineClassStudy.companyLogo"),name:"isShowLogo"},{label:F("lineClassStudy.department"),name:"isShowDepartment"},{label:F("lineClassStudy.postName"),name:"isShowPosition"}];return t().createElement(t().Fragment,null,t().createElement(E.Z,{span:24,className:D().leftContainer},t().createElement("div",{className:D().title},F("lineClassStudy.frontOfSeatSign")),$.map(Q=>{var le=Q.label,me=Q.name;return t().createElement(t().Fragment,null,t().createElement(h.Z,{checked:Z[me],onChange:ae(me)},le))})),t().createElement(E.Z,{span:24,className:D().rightContainer},t().createElement(L.Z,{formState:Z,logo:V})))},ie=()=>t().createElement(t().Fragment,null,t().createElement(E.Z,{span:24,className:D().marginTop},t().createElement("h3",null,F("lineClassStudy.backOfSeatTag")),t().createElement(t().Fragment,null,t().createElement(h.Z,{checked:Z.isSameAsReverse,onChange:ae("isSameAsReverse")},F("lineClassStudy.sameAsFront"))),Z.isSameAsReverse?"":t().createElement(t().Fragment,null,De(),Le(),t().createElement("br",null),Me())),t().createElement(E.Z,{span:24,className:"".concat(D().marginTop," ").concat(D().rightContainer),id:"backContent"},Z.isSameAsReverse?t().createElement(L.Z,{logo:V,formState:Z}):ve()));return t().createElement("div",null,t().createElement("h3",{className:D().marginTop,onMouseEnter:Re},F("lineClassStudy.selectStudents")),t().createElement(P,{t:F,ref:R,onChange:b,students:de,defaultValue:Z.userIds}),t().createElement(r.Z,{className:D().signatureContainer,onClick:Re},Ze(),ie()))};Pe.defaultProps={taskId:"",courseId:"",signId:"",sourceType:""};var Oe=(0,s.forwardRef)(Pe)},83581:function(Ce,H,e){"use strict";e.d(H,{y:function(){return N}});var A=e(33565),r=e(12924),S=e.n(r),E=e(91768),T=e(430),C=e.n(T),N=K=>new Promise((O,f)=>{var h=new Image;h.onload=function(){var g=document.createElement("canvas");g.width=this.naturalWidth,g.height=this.naturalHeight,g.getContext("2d").drawImage(h,0,0);var c=g.toDataURL("image/png");O(c)},h.setAttribute("crossOrigin","Anonymous"),h.src=K,h.onerror=()=>{f(new Error("urlToBase64 error"))}}),d=K=>{var O=K.formState,f=K.logo,h=K.data,g=h===void 0?{}:h,c=K.t,M=g.name!==void 0?g.name:c("lineClassStudy.studentName"),w=g.dept_name!==void 0?g.dept_name:c("lineClassStudy.department"),m=g.post_name!==void 0?g.post_name:c("lineClassStudy.postName"),s=(0,r.useState)(""),t=(0,A.Z)(s,2),i=t[0],o=t[1];return(0,r.useEffect)(()=>{f&&N(f).then(n=>{o(n)})},[f]),S().createElement("div",null,O.isShowLogo&&S().createElement("div",{className:C().logo},S().createElement("img",{src:i})," "),S().createElement("div",{className:"".concat(C().content," ").concat(C().studentName)},M),S().createElement("div",{className:C().footer},O.isShowDepartment&&S().createElement("div",{className:C().deptName},w),O.isShowPosition&&S().createElement("div",{className:C().postName},m)))};H.Z=(0,E.Z)()(d)},59169:function(Ce,H,e){"use strict";var A=e(12924),r=e.n(A),S=e(96486),E=e.n(S),T=e(91768),C=e(83581),N=e(430),d=e.n(N);class K extends r().Component{constructor(f){super(f);this.generateHtml=()=>{var h=(0,S.get)(this.props,"printConfig.backContent.content"),g=document.getElementById("backContentContainer");h.style.border=0;var c=h.cloneNode(!0);c.style.border=0,g.appendChild(h),g.style.transform="rotate(180deg)"}}componentDidMount(){var f=this.props.printConfig.isSameAsReverse;f||this.generateHtml()}componentDidUpdate(f){var h=(0,S.get)(this.props,"printConfig.backContent.signId"),g=(0,S.get)(f,"printConfig.backContent.signId");h!==g&&content&&this.generateHtml()}renderFront(){var f=this.props.printConfig.selectStudents,h=(0,S.get)(f,"0",{});return r().createElement("div",{className:d().rightContainer},r().createElement(C.Z,{data:h,formState:this.props.printConfig,logo:localStorage.getItem("enterpriseLogo")}))}renderPreviewContent(){var f=this.props,h=f.printConfig.isSameAsReverse,g=f.t;return r().createElement("div",{className:d().signatureContainer},h?r().createElement("div",{className:d().backContentContainer},this.renderFront()):r().createElement("div",{className:d().backContentContainer,id:"backContentContainer"}),r().createElement("div",{className:"frontContentContainer"},this.renderFront()))}render(){var f=this.props,h=f.printConfig.selectStudents,g=f.t;return r().createElement("div",null,r().createElement("div",{id:"printContainer"},r().createElement("div",{className:d().printContainer},this.renderPreviewContent())),r().createElement("div",{className:d().alignRight},"\u6BCF\u9875\u663E\u793A\u4E00\u6761\uFF0C\u5171",h&&h.length,"\u9875"),r().createElement("div",{className:d().alignCenter},g("lineClassStudy.warmTip")))}}K.defaultProps={printConfig:{}},H.Z=(0,T.Z)("translation",{withRef:!0})(K)},44970:function(Ce,H,e){"use strict";var A=e(49111),r=e(19650),S=e(96433),E=e(33304),T=e(22385),C=e(31097),N=e(88983),d=e(47933),K=e(63185),O=e(9676),f=e(47673),h=e(4107),g=e(12924),c=e.n(g),M=e(91768),w=h.Z.TextArea;class m extends c().Component{constructor(){super(...arguments);this.setQuestionValue=(t,i)=>{this.props.setQuestionValue(t,i)},this.renderQuestionItem=(t,i)=>{var o=!1,n=this.props,a=n.isPreview,l=n.t;return(t.type==="single"||t.type==="multiple")&&(o=t.options.find(u=>u.is_other==="true")),c().createElement("div",{key:i,className:"questionnaire-view-question"},c().createElement("div",{className:"questionnaire-view-question-title"},t.is_must==="true"?c().createElement("span",{className:"question-must-icon"},"*"):null,t.type==="single"?"\u3010".concat(l("learning.questionnaireAddToolSingle"),"\u3011"):t.type==="multiple"?"\u3010".concat(l("learning.questionnaireAddToolMul"),"\u3011"):null,t.title),t.type==="multiple"?c().createElement("div",{className:"questionnaire-view-question-option"},t.options.map((u,p)=>u.is_other==="true"?null:a?c().createElement(O.Z,{checked:t.answer.normal.indexOf(u.id)!==-1,disabled:a,key:p,className:"option-item"},c().createElement("span",{style:{whiteSpace:"normal",wordBreak:"break-all"}},u.title)):c().createElement(O.Z,{key:p,className:"option-item"},c().createElement("span",{style:{whiteSpace:"normal",wordBreak:"break-all"}},u.title))),o?a?c().createElement(O.Z,{disabled:a,checked:!!t.answer.other,className:"option-item"},l("learning.questionnaireAddQusOptionOther"),t.answer.other?c().createElement(h.Z,{value:t.answer.other,disabled:a,className:"other-input"}):c().createElement(h.Z,{disabled:a,className:"other-input"})):c().createElement(O.Z,{className:"option-item"},l("learning.questionnaireAddQusOptionOther"),c().createElement(h.Z,{className:"other-input"})):null):null,t.type==="single"?c().createElement("div",{className:"questionnaire-view-question-option"},t.options.map((u,p)=>u.is_other==="true"?null:a?c().createElement(d.ZP,{disabled:a,key:p,checked:t.answer.normal.indexOf(u.id)!==-1,className:"option-item"},c().createElement("span",{style:{whiteSpace:"normal",wordBreak:"break-all"}},u.title)):c().createElement(d.ZP,{key:p,checked:p===t.value,onClick:()=>this.setQuestionValue(i,p),className:"option-item"},c().createElement("span",{style:{whiteSpace:"normal",wordBreak:"break-all"}},u.title))),o?a?c().createElement(d.ZP,{disabled:a,checked:!!t.answer.other,className:"option-item"},l("learning.questionnaireAddQusOptionOther"),t.answer.other?c().createElement(h.Z,{value:t.answer.other,disabled:a,className:"other-input"}):c().createElement(h.Z,{disabled:a,className:"other-input"})):c().createElement(d.ZP,{checked:t.value===-1,onClick:()=>this.setQuestionValue(i,-1),className:"option-item"},l("learning.questionnaireAddQusOptionOther"),c().createElement(h.Z,{className:"other-input"})):null):null,t.type==="score"?c().createElement("div",{className:"questionnaire-view-question-score"},a?c().createElement(r.Z,{direction:"vertical"},c().createElement("div",{className:"questionnaire-view-question-score-box"},c().createElement(C.Z,{title:t.options[0].title},c().createElement("div",{className:"questionnaire-view-question-score-title"},t.options[0].title)),c().createElement("div",{className:"questionnaire-view-question-score-rate"},c().createElement(E.Z,{disabled:!0,value:t.answer.normal[0],tooltips:t.options.map((u,p)=>c().createElement("div",{className:"questionnaire-view-question-score-rate-tip",key:p.toString},c().createElement("div",{className:"ellipsis"},u.title),c().createElement("div",null,l("learning.score"),"\uFF1A",u.score))),count:t.options.length})),c().createElement(C.Z,{title:t.options[t.options.length-1].title},c().createElement("div",{className:"questionnaire-view-question-score-title"},t.options[t.options.length-1].title))),t.instruction==!0&&c().createElement(w,{disabled:!0,value:t.answer.instructionContent?t.answer.instructionContent:t.answer.instruction_content,className:"questionnaire-view-question-score-textarea",rows:4,placeholder:"".concat(l("learning.scoringExplanation")).concat(t.must&&t.instruction_must?"\uFF08".concat(l("learning.required"),"\uFF09"):""),maxLength:300})):c().createElement(r.Z,{direction:"vertical"},c().createElement("div",{className:"questionnaire-view-question-score-box"},c().createElement(C.Z,{title:t.options[0].title},c().createElement("div",{className:"questionnaire-view-question-score-title"},t.options[0].title)),c().createElement("div",{className:"questionnaire-view-question-score-rate"},c().createElement(E.Z,{tooltips:t.options.map((u,p)=>c().createElement("div",{className:"questionnaire-view-question-score-rate-tip",key:p.toString},c().createElement("div",null,u.title),c().createElement("div",null,l("learning.score"),"\uFF1A",u.score))),count:t.options.length})),c().createElement(C.Z,{title:t.options[t.options.length-1].title},c().createElement("div",{className:"questionnaire-view-question-score-title"},t.options[t.options.length-1].title))),t.instruction==!0&&c().createElement(w,{className:"questionnaire-view-question-score-textarea",rows:4,placeholder:"".concat(l("learning.scoringExplanation")).concat(t.instruction_must?"\uFF08".concat(l("learning.required"),"\uFF09"):""),maxLength:300}))):null,t.type==="input"?c().createElement("div",{className:"questionnaire-view-question-input"},t.is_multiple_rows==="1"||t.is_multiple_rows==="true"?c().createElement(w,{rows:3,value:a?t.answer.normal[0]:"",disabled:a}):c().createElement(h.Z,{value:a?t.answer.normal[0]:"",disabled:a})):null)}}render(){var t=this.props.questionnaireInfo;return c().createElement("div",null,c().createElement("div",{className:"questionnaire-view-title"},t.title),c().createElement("div",{className:"questionnaire-view-desc"},t.description),c().createElement("div",{className:"questionnaire-view-list"},t.questions.map((i,o)=>this.renderQuestionItem(i,o))))}}H.Z=(0,M.Z)()(m)},31945:function(Ce,H,e){"use strict";e.d(H,{Z:function(){return Oe}});var A=e(88983),r=e(47933),S=e(20228),E=e(11382),T=e(62029),C=e(30887),N=e(99210),d=e(59250),K=e(13013),O=e(57663),f=e(71577),h=e(63185),g=e(9676),c=e(71194),M=e(57016),w=e(88986),m=e(34792),s=e(48086),t=e(43358),i=e(34041),o=e(12924),n=e.n(o),a=e(28216),l=e(91768),u=e(57254),p=e(18329);class y extends n().Component{constructor(){super(...arguments);this.onCancel=()=>{this.props.showReferenceCourseList()}}render(){var v=this.props,U=v.visible,x=v.courseList,F=v.t;return n().createElement(p.ZP,{visible:U,title:F("common.tip"),onCancel:this.onCancel,onOk:this.onCancel},n().createElement("div",{className:"referenceWithOtherCourses"},n().createElement("div",{className:"referenceWithOtherCourses__tip"},F("course.deleteCourseTip")),x.map((k,j)=>n().createElement("div",{className:"referenceWithOtherCourses__item",key:j},x.length>1?"".concat(j+1,"\u3001"):null," ",k))))}}var W=(0,l.Z)()(y),P=e(10237),L=e(63848),B=e(58546),D=e(30389),J=e(54792),G=e(86726),z=e(37055),se=i.Z.Option,he={setClassify:z.ZP.CourseManageList.setClassify,setScore:z.ZP.CourseManageList.setScore,setBatchEmployee:z.ZP.CourseManageList.setBatchEmployee,deleteCourse:z.ZP.CourseManageList.deleteCourse,exportCourseView:z.ZP.CourseManageList.exportCourseView,syncCourse:z.ZP.CourseManageList.syncCourse},_e=Y=>({qyShield:Y.user.qyShield});class Pe extends n().Component{constructor(){super(...arguments);this.state={classifyProps:{visible:!1},scoreProps:{title:this.props.t("course.setCredits"),labelTxt:this.props.t("course.credit"),initialValue:"",visible:!1},employeeProps:{visible:!1,initialParams:{employeeRange:{rangeType:3,rangeList:{dept:[],post:[],group:[],user:[]}}}},asyncProps:{value:0,visible:!1},showReferenceCourseListProps:{visible:!1,courseList:[],onOk:this.showReferenceCourseList,onCancel:this.showReferenceCourseList}},this.handleChangeClassify=v=>{this.props.onClassifyChange(v)},this.handleChangeType=v=>{this.props.onTypeChange(v)},this.handleChangeCourseType=v=>{this.props.onCourseTypeChange(v)},this.actionChangeClassify=()=>{this.setState({classifyProps:{visible:!0}})},this.handleCategoryCancel=()=>{this.setState({classifyProps:{visible:!1}})},this.handleCategoryOk=v=>{var U=v.node,x=this.props,F=x.selectedCourseIds,k=x.selectedProjectIds,j=x.onForceRender,te=x.t,ne=U.id;ne&&P.qg.post({url:he.setClassify(),data:{course_ids:F.join(","),project_ids:k.join(","),classify_id:ne}}).then(()=>{s.default.success(te("course.setCourseClassifySuccess")),j()}),this.handleCategoryCancel()},this.actionSetScore=()=>{this.setState(v=>({scoreProps:(0,w.Z)((0,w.Z)({},v.scoreProps),{},{initialValue:"",visible:!0})}))},this.handleScoreCancel=()=>{this.setState(v=>({scoreProps:(0,w.Z)((0,w.Z)({},v.scoreProps),{},{visible:!1})}))},this.handleScoreOk=v=>{var U=v.value;if(U===0){this.handleScoreCancel();return}var x=this.props,F=x.selectedCourseIds,k=x.selectedProjectIds,j=x.onForceRender,te=x.t;P.qg.post({url:he.setScore(),data:{course_ids:F.join(","),project_ids:k.join(","),credit:U}}).then(()=>{s.default.success(te("course.setCourseScoreSuccess")),j()}),this.handleScoreCancel()},this.actionSetEmployeeRange=()=>{this.setState(v=>({employeeProps:(0,w.Z)((0,w.Z)({},v.employeeProps),{},{visible:!0})}))},this.handleEmployeeCancel=()=>{this.setState({employeeProps:{visible:!1,initialParams:{employeeRange:{rangeType:3,rangeList:{dept:[],post:[],group:[],user:[]}}}}})},this.handleEmployeeOk=v=>{var U=this.props,x=U.selectedCourseIds,F=U.selectedProjectIds,k=U.onForceRender,j=U.t,te=v.isAll,ne=v.departmentIds,Z=v.groupIds,pe=v.postIds,Ee=v.userIds,fe=v.qy_we_chat_vo;P.WY.post({url:he.setBatchEmployee(),data:{course_ids:x.join(","),project_ids:F.join(","),department_ids:ne,group_ids:Z,is_all:te,post_ids:pe,user_ids:Ee,qy_we_chat_vo:fe}}).then(()=>{s.default.success(j("personal.batchSetRangeSuccess")),k()}),this.handleEmployeeCancel()},this.showReferenceCourseList=v=>{this.setState(U=>({showReferenceCourseListProps:(0,w.Z)((0,w.Z)({},U.showReferenceCourseListProps),{},{visible:!U.showReferenceCourseListProps.visible,courseList:v||[]})}))},this.actionDelete=()=>{var v=this.props,U=v.selectedCourseIds,x=v.selectedProjectIds,F=v.list,k=v.onForceRender,j=v.t,te=0,ne=0,Z=[];if(F.forEach(pe=>{U.includes(pe.course_id)&&(pe.reference_plan_count>0&&(ne+=1),pe.reference_plan_count>0&&Z.push(pe.title),pe.can_delete==="true"&&(te+=1))}),ne>0)this.showReferenceCourseList(Z);else if(te!==U.length)s.default.warning(j("personal.deletePlatformCourseTip"));else{if(x.length>0){s.default.warning(j("personal.deleteProjectCourseTip"));return}M.Z.confirm({title:j("common.tip"),content:j("common.confirmDeleteTitle"),onOk(){P.qg.post({url:he.deleteCourse(),data:{enterpriseId:z.ZP.enterpriseId,ids:U.join(","),project_ids:x.join(",")}}).then(pe=>{var Ee=pe.data,fe=Ee.code,de=Ee.msg;s.default["".concat(fe===0?"success":"warning")](de),fe===0&&k()})}})}},this.actionSyncSetting=()=>{this.setState(v=>({asyncProps:(0,w.Z)((0,w.Z)({},v.asyncProps),{},{visible:!0})}))},this.onAsyncChange=v=>{this.setState(U=>({asyncProps:(0,w.Z)((0,w.Z)({},U.asyncProps),{},{value:v.target.value})}))},this.handleSyncCancel=()=>{this.setState({asyncProps:{visible:!1,value:0}})},this.handleSyncOk=()=>{var v=this.props,U=v.selectedCourseIds,x=v.selectedProjectIds,F=v.onForceRender,k=v.t,j=this.state.asyncProps;P.qg.post({url:he.syncCourse(),data:{course_ids:U.join(","),project_ids:x.join(","),syncProgress:j.value}}).then(te=>{var ne=te.data,Z=ne.code,pe=ne.msg;Z===0?(s.default.success(k("setting.setUpSucceed")),F()):s.default.warning(pe)}),this.handleSyncCancel()},this.actionImportDetail=()=>{var v=this.props,U=v.selectedCourseIds,x=v.selectedProjectIds,F=v.onForceRender,k=v.t;if(U.concat(x).length>20){s.default.warning(k("courseManage.exportMoreTip"));return}var j=he.exportCourseView(),te={course_Ids:U.join(","),project_Ids:x.join(",")};P.WY.get({url:j,params:te}).then(ne=>{ne.data.code===200&&s.default.success("\u6587\u4EF6\u751F\u6210\u4E2D\uFF0C\u8BF7\u7A0D\u540E\u5728\u6587\u4EF6\u4E0B\u8F7D\u4E2D\u4E0B\u8F7D"),F(),this.getDownloadingNumber()})},this.getDownloadingNumber=()=>{var v=z.ZP.downLoadCenter.getDownLoadingCount();P.WY.get({url:v,params:{}}).then(U=>{sessionStorage.setItem("downloadingCount",U.data.data),this.props.dispatch({type:"download/updateDownloadingNumber",downloadingNumber:U.data.data})}).catch(()=>{sessionStorage.setItem("downloadingCount",0),this.props.dispatch({type:"download/updateDownloadingNumber",downloadingNumber:0})})},this.handleChangeCheckBox=v=>{this.props.onCheckboxChange(v.target.checked)},this.handleSharingQueryRowCheckboxChange=v=>{this.props.onSharingCheckboxChange(v.target.checked)},this.renderCondition=()=>{var v=this.props,U=v.prefixCls,x=v.params,F=v.qyShield,k=v.t,j=x.classify_id?x.classify_id.split(","):[];return n().createElement("div",{className:"".concat(U,"__condition")},this.props.extraDom&&this.props.extraDom(),n().createElement(L.Z,{onChange:this.handleChangeClassify,className:"cl-search-normal-width",value:j,showLabel:!1,placeholder:"Please select",queryType:"course_manage",unclassified:"true"}),n().createElement(i.Z,{value:x.type,className:"cl-search-normal-width",onChange:this.handleChangeType},n().createElement(se,{value:""},this.props.t("courseManage.allOrigin")),n().createElement(se,{value:"original"},this.props.t("courseManage.originalCourse")),n().createElement(se,{value:"notOriginal"},this.props.t("courseManage.nonOriginalCourse")),n().createElement(se,{value:"platform"},this.props.t("courseManage.platformProcurement"))),this.props.courseType&&this.props.courseType=="graphic"?null:n().createElement(i.Z,{value:x.course_type,className:"cl-search-normal-width",onChange:this.handleChangeCourseType},n().createElement(se,{value:"all"},this.props.t("courseManage.allType")),n().createElement(se,{value:"course"},this.props.t("common.courseLabel")),n().createElement(se,{value:"microCourse"},this.props.t("common.microCourse")),n().createElement(se,{value:"project"},this.props.t("leftMenuLists.studyProject"))),n().createElement(g.Z,{onChange:this.handleChangeCheckBox,style:{marginRight:16}},k("common.myCreated")),this.props.courseType&&this.props.courseType==="graphic"&&F==="false"?n().createElement(g.Z,{onChange:this.handleSharingQueryRowCheckboxChange},k("common.sharing")):null)},this.renderActions=()=>{var v=this.props,U=v.prefixCls,x=v.selectedCourseIds,F=v.selectedProjectIds,k=v.showNum,j=k===void 0?1:k,te=this.props.allowActions,ne=(0,G.H3)("delete",te),Z=(0,G.H3)("adjustment_classification",te),pe=(0,G.H3)("set_visible",te),Ee=(0,G.H3)("export",te),fe=(0,G.H3)("set_score",te),de=(0,G.H3)("progressSync",te),re=[{name:this.props.t("courseManage.adjustClassification"),type:"actionChangeClassify",isShow:Z},{name:this.props.t("courseManage.exportViewDetail"),type:"actionImportDetail",isShow:Ee},{name:this.props.t("courseManage.setCredits"),type:"actionSetScore",isShow:fe},{name:this.props.t("courseManage.setTheVisibilityed"),type:"actionSetEmployeeRange",isShow:pe},{name:this.props.t("common.delete"),type:"actionDelete",isShow:ne},{name:this.props.t("common.scheduleSyncSetting"),type:"actionSyncSetting",isShow:de}],ue=re.filter(I=>I.isShow),ge=[],_=[];if(ue.length)j?(ge=[...ue.slice(0,j)],_=[...ue.slice(j)]):_=[...ue];else return null;return n().createElement("div",{className:"".concat(U,"__action")},ge.map(I=>n().createElement(f.Z,{style:{marginRight:"8px"},key:I.type,disabled:!(x.length+F.length),onClick:this[I.type]},I.name)),_.length?n().createElement(K.Z,{disabled:!(x.length+F.length),overlay:this.renderMoreButton({buttons:_})},n().createElement(f.Z,{className:"cl-pointer"},"".concat(this.props.t("common.more"))," ",n().createElement(u.Z,null))):"")}}renderMoreButton(v){var U=v.buttons,x=this.props,F=x.selectedCourseIds,k=x.selectedProjectIds;return n().createElement(N.Z,{onClick:j=>{var te=j.key;this[te]()}},U.map(j=>j.isShow?n().createElement(N.Z.Item,{key:j.type,disabled:!(F.length+k.length)},n().createElement("span",{className:"cl-pointer"},j.name)):null))}render(){var v=this.props,U=v.prefixCls,x=v.t,F=v.showRenderCondition,k=F===void 0?!0:F,j=v.showRenderActions,te=j===void 0?!0:j,ne=this.state,Z=ne.classifyProps,pe=ne.scoreProps,Ee=ne.employeeProps,fe=ne.showReferenceCourseListProps,de=ne.asyncProps;return n().createElement("div",{className:U},k&&this.renderCondition(),te&&this.renderActions(),n().createElement(B.Z,(0,T.Z)({},Z,{title:x("personal.chooseClassify"),onCancel:this.handleCategoryCancel,onOk:this.handleCategoryOk})),n().createElement(J.Z,(0,T.Z)({},pe,{onCancel:this.handleScoreCancel,onCreate:this.handleScoreOk})),Ee.visible&&n().createElement(D.Z,(0,T.Z)({},Ee,{title:x("courseManage.setTheVisibility"),mode:["all","part","private"],orgProps:{title:x("component.chooseVisibleScope")},isLoading:!Ee.visible,onCancel:this.handleEmployeeCancel,onCreate:this.handleEmployeeOk})),de.visible&&n().createElement(p.ZP,{wrapClassName:"cl-async-selector-modal",visible:de.visible,title:x("common.scheduleSyncSetting"),okText:x("common.ok"),cancelText:x("common.cancel"),onCancel:this.handleSyncCancel,onOk:this.handleSyncOk},de.visible?n().createElement("div",{className:"".concat(U,"__async")},n().createElement("p",null," ",x("common.scheduleSyncSettingTip")),n().createElement(r.ZP.Group,{onChange:this.onAsyncChange,value:de.value},n().createElement(r.ZP,{value:0},x("common.outSync")),n().createElement(r.ZP,{value:1},x("common.synchronization")))):n().createElement(E.Z,{size:"large"})),n().createElement(W,(0,T.Z)({},fe,{showReferenceCourseList:this.showReferenceCourseList})))}}Pe.defaultProps={prefixCls:"resource-course-list-page__release__content__queryrow",rangeType:""};var Oe=(0,l.Z)()((0,a.$j)(_e)(Pe))}}]);
