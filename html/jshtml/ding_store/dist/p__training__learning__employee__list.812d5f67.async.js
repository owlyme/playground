(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[8495],{30389:function(ce,z,e){"use strict";e.d(z,{Z:function(){return v}});var _=e(62029),O=e(20228),F=e(11382),f=e(12924),S=e.n(f),r=e(91768),K=e(80991),Z={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},c=e(62615),h=e(52670);class y extends S().Component{render(){var n=this.props,L=n.values,D=n.mode,k=n.onlyChooseDept,P=n.reserveUser,de=n.t,re=n.orgProps,H=n.rangeAuth,l=n.projectId,$=n.onCancel,b=n.onlyCreateUser;return S().createElement(K.l0,{className:"cl-form"},S().createElement(K.gN,(0,_.Z)({component:c.ww,displayType:"Custom",showSectitle:!1,name:"employeeRange",label:de("common.visibleRange"),defaultFieldList:L.employeeRange,validate:h.FI,mode:D,rangeAuth:H,onlyChooseDept:k,onlyCreateUser:b,orgProps:re,reserveUser:P,projectId:l,onCancel:$,qwTicketShow:!0},Z)))}}var w=(0,r.Z)()(y),t=e(18329),g=e(34773);class o extends S().Component{constructor(){super(...arguments);this.initRefFormik=n=>{this.refFormik=n},this.handleBeforeCreate=()=>{var n=this.refFormik;n.submitForm(),n.runValidations().then(L=>{if(!Object.keys(L).length){var D=n.state.values.employeeRange,k=(0,g.b)(D.rangeList),P={qyWeChatVo:D.qyWeChatVo,id:this.props.actionId,isAll:D.rangeType,groupIds:D.rangeType===2?k.groupIds.join(","):"",departmentIds:D.rangeType===2?k.deptIds.join(","):"",userIds:D.rangeType===2?k.userIds.join(","):"",postIds:D.rangeType===2?k.postIds.join(","):"",clusterIds:D.rangeType===2?k.clusterIds.join(","):"",qy_we_chat_vo:D.qyWeChatVo};this.props.onCreate(P)}})},this.handleBeforeCancel=()=>{var n=this.props.onCancel;n()}}render(){var n=this.props,L=n.visible,D=n.initialParams,k=n.isLoading,P=n.tipInfo,de=n.mode,re=n.onlyChooseDept,H=n.reserveUser,l=H===void 0?[]:H,$=n.t,b=n.title,R=n.orgProps,N=n.rangeAuth,i=n.projectId,d=n.onCancel,I=n.onlyCreateUser,C=n.size;return k?S().createElement(F.Z,{size:"large"}):S().createElement(t.ZP,{wrapClassName:"cl-employee-selector-modal",visible:L,title:b||$("component.changeUser"),okText:$("common.ok"),cancelText:$("common.cancel"),size:C,onCancel:this.handleBeforeCancel,onOk:this.handleBeforeCreate},k?S().createElement(F.Z,{size:"large"}):S().createElement(K.J9,{ref:this.initRefFormik,initialValues:D,render:T=>S().createElement(w,(0,_.Z)({},T,{mode:de,rangeAuth:N,orgProps:R,onlyChooseDept:re,onlyCreateUser:I,reserveUser:l,projectId:i,onCancel:d}))}),P&&S().createElement("p",{style:{padding:"0 24px",wordBreak:"break-all",whiteSpace:"normal"}},P))}}o.defaultProps={visible:!1,initialParams:{employeeRange:{rangeType:1,rangeList:{dept:[],post:[],group:[],user:[],cluster:[]}}},tipInfo:"",isLoading:!1,mode:["all","part"],onlyChooseDept:!1,onlyCreateUser:!1,orgProps:{},onCancel:()=>{},onCreate:()=>{},size:"middle"};var v=(0,r.Z)()(o)},64549:function(ce,z,e){"use strict";var _=e(12924),O=e.n(_),F=e(28216),f=e(84874),S=K=>({guideStatus:K.advancedSetting.guideStatus,isNewUser:K.advancedSetting.isNewUser});class r extends O().Component{constructor(){super(...arguments);this.state={guideIndex:0,showGuide:this.props.renderGuide},this.onNextStep=()=>{var Z=this.state.guideIndex,c=this.props.guidePageProps;if(Z>=c.length-1){this.onCloseGuide();return}this.setState({guideIndex:Z+1})},this.onCloseGuide=()=>{this.setState({showGuide:!1},()=>{this.props.closeGuide&&this.props.closeGuide()}),this.props.isNewUser==="true"&&this.props.dispatch({type:"shouldRenderHeaderGuide",payload:{headerGuideStatus:!0}}),this.updateAllStatus()},this.updateAllStatus=()=>{localStorage.setItem("guideStatus","false"),this.props.dispatch({type:"updateGuideStatus",payload:{guideStatus:"false"}})},this.renderRightItem=Z=>O().createElement(O().Fragment,null,O().createElement("div",{className:"clguide-popover__content"},O().createElement("span",{onClick:this.onCloseGuide},O().createElement(f.Z,{iconClass:"icon-f-close",size:"12px",color:"#fff"})),O().createElement("div",{className:"clguide-popover__content__text"},Z.contentText),O().createElement("div",{className:"clguide-popover__content__button",onClick:this.onNextStep},Z.buttonText)),O().createElement("div",{className:"clguide-popover__righttriangle"}),Z.typeText&&O().createElement("div",{className:" clguide-popover__circle"},Z.typeText)),this.renderLeftItem=Z=>O().createElement(O().Fragment,null,O().createElement("div",{className:" clguide-popover__circle"},Z.typeText),O().createElement("div",{className:"clguide-popover__lefttriangle"}),O().createElement("div",{className:"clguide-popover__content"},O().createElement("span",{onClick:this.onCloseGuide},O().createElement(f.Z,{iconClass:"icon-f-close",size:"12px",color:"#fff"})),O().createElement("div",{className:"clguide-popover__content__text"},Z.contentText),O().createElement("div",{className:"clguide-popover__content__button",onClick:this.onNextStep},Z.buttonText)))}render(){var Z=this.state,c=Z.guideIndex,h=Z.showGuide,y=this.props,w=y.className,t=y.guideStatus,g=y.guidePageProps,o=g===void 0?[]:g,v=y.direction,M=v===void 0?"right":v,n=y.showDownloadBtn;return!h&&!t?null:O().createElement("div",{className:"clguide-popover-container"},h&&t==="true"&&O().createElement("div",{className:"clguide-popover-mask"}),h&&t==="true"&&c===0&&o.length?O().createElement("div",{className:"".concat(w,"_next clguide-popover ").concat(n?"":"right")},M==="left"?this.renderLeftItem(o[0]):this.renderRightItem(o[0])):null,h&&t==="true"&&c===1&&o.length?O().createElement("div",{className:"".concat(w,"_know clguide-popover")},M==="left"?this.renderLeftItem(o[1]):this.renderRightItem(o[1])):null)}}z.Z=(0,F.$j)(S)(r)},63848:function(ce,z,e){"use strict";var _=e(36877),O=e(32969),F=e(12924),f=e.n(F),S=e(91768),r=e(56130);class K extends f().PureComponent{constructor(){super(...arguments);this.onChange=(c,h)=>{this.props.onChange(c,h)}}render(){var c=this.props,h=c.value,y=c.classify,w=c.showLabel,t=c.className,g=c.t,o=c.style;return f().createElement("div",{className:"classify-cascader ".concat(t)},w?f().createElement("span",{className:"classify-cascader-label"},g("component.selectClassifyLabel")):null,f().createElement(O.Z,{changeOnSelect:this.props.changeOnSelect,className:"classify-cascader-select ".concat(t),options:y,onChange:this.onChange,placeholder:g("component.selectClassifyLabel"),value:h,style:o,loadData:this.props.loadData}))}}K.defaultProps={showLabel:!0,changeOnSelect:!0,onChange:()=>{}},z.Z=(0,r.Z)((0,S.Z)()(K))},66123:function(ce,z,e){"use strict";e.d(z,{T:function(){return i},t:function(){return de}});var _=e(71194),O=e(57016),F=e(22385),f=e(31097),S=e(88986),r=e(57361),K=e(33565),Z=e(9754),c=e.n(Z),h=e(12924),y=e.n(h),w=e(91768),t=e(28216),g=e(57068),o=e(76651),v=e(87983),M=e.n(v),n=e(99367),L=e(98233),D=e(67479),k=e(1164);function P(d){var I=d.t,C=d.title,T=d.visible,B=d.uuid,j=d.id,V=d.fieldNames,X=d.from,pe=d.getList,oe=d.onCancel,p=d.hasTitleLink,x=p===void 0?!0:p,A=(0,t.v9)(q=>{var se=q.advancedSetting;return{themeColor:se.themeColor}}),Y=A.themeColor,J=(0,h.useState)({}),W=(0,K.Z)(J,2),G=W[0],ae=W[1],he={task:"learning",employee:"employee"},le=(q,se)=>{if(q)return(0,L.nn)({origin:he[X],search:g.stringify({id:se.id,title:se.title,origin:he[X]})});var ne={},ee="";switch(X){case"task":ne={id:se.id,taskId:j,taskType:X},ee="/training/learning/management/monitor/exam?".concat(g.stringify(ne));break;case"employee":ne={id:se.id,taskId:j,taskType:X},ee="/training/learning/task/employeeResult/exam?".concat(g.stringify(ne));break;default:break}return ee},me=function(){var q=(0,r.Z)(c().mark(function se(){var ne,ee,Pe,ie=arguments;return c().wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:if(ne=ie.length>0&&ie[0]!==void 0?ie[0]:"unKnow",ee=ie.length>1?ie[1]:void 0,ne!=="unKnow"){Ce.next=7;break}return Ce.next=5,(0,D.D)(ee.id);case 5:return Pe=Ce.sent,Ce.abrupt("return",le(Pe,ee));case 7:return Ce.abrupt("return",le(ne,ee));case 8:case"end":return Ce.stop()}},se)}));return function(){return q.apply(this,arguments)}}(),ge=function(){var q=(0,r.Z)(c().mark(function se(ne){var ee;return c().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:if(x){ie.next=2;break}return ie.abrupt("return");case 2:return ie.next=4,me(ne.new_exam==="true",ne);case 4:ee=ie.sent,o.m8.push(ee);case 6:case"end":return ie.stop()}},se)}));return function(ne){return q.apply(this,arguments)}}(),ve=function(){var q=(0,r.Z)(c().mark(function se(ne){var ee;return c().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:if(ne.pending_count!==0){ie.next=2;break}return ie.abrupt("return");case 2:return ie.next=4,(0,L.Md)(ne.new_exam==="true",{id:ne.id,taskId:j,status:"pending",from:"projectNew"});case 4:ee=ie.sent,ne.new_exam==="true"?k.Z.targetTo({path:ee}):o.m8.push(ee);case 6:case"end":return ie.stop()}},se)}));return function(ne){return q.apply(this,arguments)}}(),Se=q=>pe((0,S.Z)((0,S.Z)({},q),{},{id:j}));return(0,h.useEffect)(()=>{ae({query:q=>Se(q),columns:[{title:I("exam.testName"),dataIndex:V&&V.title||"title",width:300,key:"id",render:(q,se)=>y().createElement(f.Z,{title:se.title},y().createElement("div",{style:x?{color:Y,cursor:"pointer",width:300}:{},className:"cl-text-ellipsis",onClick:()=>{ge(se)}},se[V&&V.title||"title"]))},{title:I("exam.toBeGraded"),width:120,dataIndex:V&&V.pending_count||"pending_count",key:V&&V.pending_count||"pending_count",render:(q,se)=>se[V&&V.pending_count||"pending_count"]},{title:I("exam.operate"),key:"operate",width:localStorage.getItem("lng")==="en_us"?210:100,fixed:"right",buttons:[{name:I("trainingProject.markingPapers"),disabled:q=>!(q.pending_count>0&&q.reading_operation==="has_operation"),handleClick:q=>ve(q)}]}]})},[V,B,j]),y().createElement(O.Z,{title:C||I("myExamTask.marking"),visible:T,width:600,bodyStyle:{padding:"0 24px 24px"},footer:null,onCancel:oe},G.query?y().createElement("div",{className:M()["pending-pager-container"]},y().createElement(n.Z,{uniKey:"",uuid:B,queryParams:G,pagination:!0})):null)}var de=(0,w.Z)()(P),re=e(20136),H=e(55241),l=e(38778),$=e.n(l),b=e(84874);function R(d){var I=d.contentString,C=d.scrollElement,T=d.visible,B=d.authJudge,j=d.placement,V=j===void 0?"bottom":j,X=d.closeGuide,pe=d.zIndex,oe=pe===void 0?100:pe,p=(0,h.useState)(!1),x=(0,K.Z)(p,2),A=x[0],Y=x[1],J=G=>{G.stopPropagation(),C&&!C.isRelative&&(document.querySelector('[class*="'.concat(C.classContent,'"]')).style.position=""),Y(!1),typeof X=="function"&&X()},W=()=>y().createElement("div",{className:$()["intro-content"]},I,y().createElement("span",{className:$().close,onClick:G=>J(G)},y().createElement(b.Z,{iconClass:"icon-guanbi1",size:"12px"})));return(0,h.useEffect)(()=>{T&&!A&&(typeof B=="function"&&B()||!B)&&(C&&!C.isRelative&&(document.querySelector('[class*="'.concat(C.classContent,'"]')).style.position="relative"),setTimeout(()=>{Y(!0)},500))},[T]),y().createElement(H.Z,{visible:A,placement:V,title:"",overlayClassName:$()["intro-card"],content:W(),zIndex:oe,getPopupContainer:()=>document.querySelector('[class*="'.concat(C.classContent,'"]'))},d.children)}var N=d=>({userId:d.user.id||window.localStorage.getItem("uid")}),i=(0,t.$j)(N)((0,w.Z)()(R))},64630:function(ce,z,e){"use strict";var _=e(62029),O=e(62999),F=e(85733),f=e(12924),S=e.n(f),r=e(91768),K=e(10237),Z=e(37055),c=e(25547),h=F.Z.TreeNode;class y extends S().Component{constructor(t){super(t);this.getPostTree=()=>{var g=Z.ZP.OrgTree.getPostTree();K.WY.get({url:g}).then(o=>{var v=(0,c.NP)(o.data.posts,{id:"value",post_name:"postName"});this.setState({treeData:v})})},this.handleChange=(g,o,v)=>{this.props.onChange(typeof g=="undefined"?"":g,o,v)},this.renderTreeNodes=g=>g.map(o=>{var v=!0;return this.props.noChildSelect&&(v=o.post_type==="post"),o.children?S().createElement(h,{selectable:!this.props.noChildSelect,title:o.postName,key:o.id,value:o.id,isLeaf:!1,dataRef:o},this.renderTreeNodes(o.children)):S().createElement(h,{selectable:v,title:o.postName,dataRef:o,value:o.id,key:o.id,isLeaf:!0})}),this.renderTreeSelect=()=>{var g=this.props,o=g.t,v=g.defaultValue,M=v===void 0?[]:v,n=g.multiple,L=n===void 0?!1:n,D=g.width,k=D===void 0?180:D,P={showSearch:!1,style:{width:k},defaultValue:M,multiple:L,dropdownStyle:{maxHeight:300,overflow:"auto"},placeholder:o("component.choosePostTip"),allowClear:!0,disabled:this.props.disabled};return this.state.treeData.length>0?S().createElement(F.Z,(0,_.Z)({},P,{onChange:this.handleChange,className:this.props.className}),this.renderTreeNodes(this.state.treeData)):S().createElement("div",{style:{textAlign:"center"}})},this.state={treeData:[]}}componentDidMount(){this.getPostTree()}render(){return S().createElement("div",{className:"org-tree-container ".concat(this.props.className)},this.renderTreeSelect())}}y.defaultProps={disabled:!1,onChange:()=>{}},z.Z=(0,r.Z)()(y)},54792:function(ce,z,e){"use strict";var _=e(62029),O=e(63185),F=e(9676),f=e(47673),S=e(4107),r=e(88986),K=e(12924),Z=e.n(K),c=e(91768),h=e(59239),y=e(55446),w=e.n(y),t=e(18329),g=e(2396);class o extends Z().Component{constructor(){super(...arguments);this.state={isChecked:!1},this.handleBeforeCreate=()=>{var n=this.props,L=n.form,D=n.id,k=n.onCreate,P=this.state.isChecked;L.validateFields((de,re)=>{if(!de){var H=(0,r.Z)({},re);P||(H.value=0);var l=(0,r.Z)((0,r.Z)({},H),{},{id:D});k(l),setTimeout(()=>{L.resetFields()},100)}})},this.handleBeforeCancel=()=>{var n=this.props,L=n.form,D=n.onCancel;D(),setTimeout(()=>{L.resetFields()},100)},this.checkScore=(n,L,D)=>{var k=this.props.t,P=this.state.isChecked;if(P&&(0,g.kh)(L)){D(k("component.setScoreRuleTip"));return}D()},this.handleCheckChange=n=>{this.setState({isChecked:n.target.checked})},this.renderItem=()=>{var n=this.props,L=n.form,D=n.initialValue,k=n.labelTxt,P=this.state.isChecked,de=L.getFieldDecorator,re={labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:18}}},H=P?de("value",{initialValue:D,rules:[{validator:this.checkScore}]})(Z().createElement(S.Z,{maxLength:30,placeholder:""})):null,l=Z().createElement(Z().Fragment,null,Z().createElement(F.Z,{checked:P,onChange:this.handleCheckChange},k));return Z().createElement(h.Z.Item,(0,_.Z)({label:l},re),H)}}componentDidUpdate(n){this.props.visible&&this.props.visible!==n.visible&&this.setState({isChecked:!!this.props.initialValue})}render(){var n=this.props,L=n.visible,D=n.title,k=n.prefixCls;return Z().createElement(t.ZP,{size:"small",visible:L,title:D,onCancel:this.handleBeforeCancel,onOk:this.handleBeforeCreate},Z().createElement(h.Z,{className:"".concat(k),layout:"horizontal",colon:!1},this.renderItem(),Z().createElement("div",{className:"".concat(k,"__children")},this.props.children)))}}o.defaultProps={prefixCls:"cl-setscore",id:"",visible:!1,title:"SetScore",labelTxt:"",initialValue:"",onCancel:()=>{},onCreate:()=>{}};var v=h.Z.create({name:"ClSetupBoxInModal"})(o);z.Z=(0,c.Z)()(v)},11449:function(ce,z,e){"use strict";e.d(z,{Z:function(){return b}});var _=e(88986),O=e(33565),F=e(12924),f=e.n(F),S=e(3115),r=e(49111),K=e(19650),Z=e(62029),c=e(57663),h=e(71577),y=e(91768),w=e(28216),t=e(37055),g=e(10237);function o(R){var N=t.ZP.getHelpContentByMenuKey(),i={key:R};return g.WY.get({url:N,params:i})}var v=e(74228),M=e.n(v),n=e(1164),L=e(76466),D=e(38642);class k extends f().Component{constructor(N){var i;super(N);i=this,this.getHelpContentByMenuKey=()=>{var d=this.props.defaultMenuKey;o(d).then(I=>{var C=I.data,T=C.help_url,B=C.video_url;this.setState({videoUrl:B,helpUrl:T})})},this.handleOpenHelpUrl=d=>{if((0,D.ve)()){window.open(d,"_blank");return}n.Z.targetTo({path:d,isExternalLink:!0})},this.handleOpenVideo=function(d){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:i.props.t("helpCenter.video");i.setState(C=>({resourcePlayInfo:(0,_.Z)((0,_.Z)({},C.resourcePlayInfo),{},{resourceInfo:{originUrl:d,source:{FD:d,OD:d},contentType:"mp4"}}),previewInfo:(0,_.Z)((0,_.Z)({},C.previewInfo),{},{title:I,visible:!0,onCancel:i.handleCancelPreview})}))},this.handleCancelPreview=()=>{var d=this.state.previewInfo;this.setState({resourcePlayInfo:{mode:"preview",watchType:"video",resourceInfo:{}},previewInfo:(0,_.Z)((0,_.Z)({},d),{},{visible:!1})})},this.state={helpUrl:"",videoUrl:"",resourcePlayInfo:{autoPlay:!0,draggable:!0,mode:"preview",resourceInfo:{},watchType:"video"},previewInfo:{visible:!1,destroyOnClose:!0,title:N.t("helpCenter.video")||"\u89C6\u9891\u6307\u5BFC",onCancel:()=>{}}}}componentDidMount(){this.getHelpContentByMenuKey()}render(){var N=this.state,i=N.helpUrl,d=N.resourcePlayInfo,I=N.previewInfo,C=N.videoUrl,T=this.props.t;return f().createElement("div",{className:M().helpCenter},C&&f().createElement(h.Z,{type:"link",className:M()["video-btn"],style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenVideo(C)},T("helpCenter.video")),i&&f().createElement(h.Z,{type:"link",style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenHelpUrl(i)},T("helpCenter.tutorial")),f().createElement(L.Z,(0,Z.Z)({},d,{previewInfo:I})))}}var P=R=>({defaultMenuKey:R.currentRoute.menuKey});k.defaultProps={defaultMenuKey:""};var de=(0,w.$j)(P)((0,y.Z)()(k));function re(R){var N=R.extra,i=localStorage.getItem("dingPersonnel"),d=sessionStorage.getItem("dingPersonnel");return f().createElement(K.Z,null,N,i!=="dingPersonnel"&&d!=="dingPersonnel"&&(0,D.eY)("COMMONEXTRA_HELP_CENTER")&&f().createElement(de,null))}var H=re,l=e(4408);function $(R){var N=(0,F.useState)({helpCenter:(0,D.eY)("HEAD_HELP_CENTER_BUT")}),i=(0,O.Z)(N,1),d=i[0],I=R.pageContainerParams,C=I===void 0?{}:I,T=R.noPadding,B=T===void 0?!1:T,j=R.isPersonal,V=j===void 0?!1:j,X=R.pageTitle,pe=R.className,oe=pe===void 0?"":pe,p={extra:d.helpCenter?f().createElement(H,{extra:C.extra}):C.extra},x=(0,_.Z)((0,_.Z)({},C),p);return f().createElement("div",{className:"page-container-content ".concat(B?"page-container-noPadding":""," ").concat(V?"page-container-content_personal_background":""," ").concat(oe)},X&&f().createElement(l.Z,{title:X}),V?f().createElement(S.Z,null,R.children):f().createElement(S.Z,x,R.children))}var b=$},404:function(ce,z,e){"use strict";e.d(z,{Z:function(){return R}});var _=e(62029),O=e(57663),F=e(71577),f=e(88986),S=e(12924),r=e.n(S),K=e(91768),Z=e(20228),c=e(11382),h=e(34792),y=e(48086),w=e(80991),t=e(49010),g=e(77444),o=e(10237),v=e(37055),M=e(18329);class n extends r().Component{constructor(){super(...arguments);this.initRefFormik=i=>{this._refFormik=i},this.state={initialValues:{supervisor:{or:[],multilevel:[],lead:"",type:"or"}},isLoading:!0},this.getSingleApproval=()=>{var i=this.props.operationId,d=v.ZP.PostAbility.queryAuthApprovels(i);o.WY.get({url:d}).then(I=>{var C=[],T=I.data;T.type==="multilevel"&&T.approvers.map(B=>C.push(B)),this.setState({initialValues:{supervisor:{or:T.type==="or"?[...I.data.approvers[0]]:[],multilevel:C,lead:"",type:T.type}},isLoading:!1})})},this.handleBeforeCreate=()=>{var i=this._refFormik;i.submitForm(),i.runValidations().then(d=>{if(!Object.keys(d).length){var I=i.state.values.supervisor,C=localStorage.getItem("authorityType"),T=navigator.userAgent.toLowerCase().indexOf("wxwork")>-1,B=[],j=[];if(I.type==="multilevel"){var V=I.multilevel;V.forEach(oe=>{var p=[];oe.forEach(x=>{p.push({id:x.id})}),B.push(p)}),T&&C==="1"&&V.forEach(oe=>{var p=[];p.push(oe[0].qyWeChatVo),j.push(p)})}else if(I.type==="or"){var X=[];I.or.map(oe=>{X.push({id:oe.id})}),B.push(X),T&&C==="1"&&(j=[[I.qy_we_chat_vo]])}else B=[],j=[];var pe={type:I.type,operation_ids:this.props.operationId,approvers:B,qy_we_approve_users:j};this.submit(pe)}})},this.submit=i=>{o.WY.post({url:v.ZP.PostAbility.updateApprover(),data:i}).then(d=>{d.data&&(y.default.success(this.props.t("study.updateSuccess")),this.onCancel())})},this.onCancel=()=>{this.setState({initialValues:{supervisor:{or:[],multilevel:[],lead:"",type:"or"}}},()=>{this.props.cancelSettingApprover()})}}componentDidUpdate(i){this.props.visible&&this.props.visible!==i.visible&&this.props.operationId&&(this.setState({isLoading:!0,initialValues:{supervisor:{or:[],multilevel:[],lead:"",type:"or"}}}),this.props.isSingle?this.getSingleApproval():this.setState({isLoading:!1}))}render(){var i=this.state,d=i.initialValues,I=i.isLoading,C=this.props,T=C.visible,B=C.t,j=C.createUserId,V=C.isHasTutor;return r().createElement(M.ZP,{visible:T,title:B("authentication.abilityDetailSecSupervisionTitle"),onCancel:this.onCancel,onOk:this.handleBeforeCreate,size:"medium"},I?r().createElement(c.Z,{size:"large"}):T&&r().createElement("div",{className:"auth-people"},r().createElement(w.J9,{ref:this.initRefFormik,initialValues:d,onSubmit:this.submit,render:X=>r().createElement(w.l0,{className:"cl-form"},r().createElement(w.gN,{component:t.Z,isHasTutor:V,displayType:"Custom",name:"supervisor",createUserId:j,defaultFieldList:X.values.supervisor,validate:g.Z.checkSupervisor,mode:"dialog"}))})))}}var L=(0,K.Z)()(n),D=e(22385),k=e(31097),P=e(28216),de=e(36202),re=e(60667);class H extends r().Component{constructor(){super(...arguments);this.columns=[{title:this.props.t("personal.practicalName"),dataIndex:"title",key:"title"},{title:this.props.t("authentication.abilityDetailApprover"),dataIndex:"approvers_list",key:"approvers_list",width:250,render:function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],I=Array.isArray(d)?[...d]:[];return r().createElement(k.Z,null,r().createElement("div",{className:"cl-text-ellipsis",style:{width:230}},I.map((C,T)=>Array.isArray(C)?r().createElement(r().Fragment,null,C.map((B,j)=>r().createElement(S.Fragment,{key:C.id},r().createElement(re.Z,{dataType:"userName",value:B.sync_user_id,name:B.name,type:B.source_type||C.sourceType}),j*T!=C.length*I.length-1&&","))):r().createElement(S.Fragment,{key:C.id},r().createElement(re.Z,{dataType:"userName",value:C.sync_user_id,name:C.name,type:C.source_type||C.sourceType}),T!==I.length-1&&","))))}},{title:this.props.t("common.operate"),width:80,key:"operate",render:i=>r().createElement("div",{className:"cl-table__cell-action"},r().createElement("span",{className:"cl-pointer",onClick:()=>this.props.settingApprover(i)},this.props.t("common.edit")))}]}render(){var i=this.props,d=i.list,I=d===void 0?[]:d,C=i.loading,T=i.selectedRowKeys,B=T===void 0?[]:T,j=i.onSelectChange,V=i.toolBarRender,X={selectedRowKeys:B,onChange:j};return r().createElement("section",{className:"auth-people__content__table"},r().createElement(de.f,{bordered:!0,columns:this.columns,rowSelection:X,rowKey:"id",dataSource:I,pagination:!1,loading:C,toolBarRender:V,tableUUID:"eebd1b51-6aad-436e-be45-a4fc2e1e858d"}))}}var l=N=>{var i=N.user;return{user:i,qyShield:i.qyShield}},$=(0,P.$j)(l)((0,K.Z)()(H));class b extends r().Component{constructor(){super(...arguments);this.state={params:{entity_type:"",entity_id:""},tableLoading:!0,tableList:[],settingApproverProps:{operationId:[],createUserId:"",isSingle:!1,visible:!1,isHasTutor:this.props.isHasTutor},selectedRowKeys:[]},this.initTableList=()=>{this.setState({tableLoading:!0}),o.WY.post({url:v.ZP.PostAbility.queryAuthWorkList(),data:this.state.params}).then(i=>{setTimeout(()=>{this.setState({tableLoading:!1,tableList:i.data.operations})},300)})},this.handleSelectChange=i=>{this.setState({selectedRowKeys:i})},this.multiSettingApprover=()=>{var i=this.state.selectedRowKeys;this.setState(d=>({settingApproverProps:(0,f.Z)((0,f.Z)({},d.settingApproverProps),{},{visible:!0,isSingle:!1,operationId:i})}))},this.settingApprover=i=>{this.setState(d=>({settingApproverProps:(0,f.Z)((0,f.Z)({},d.settingApproverProps),{},{visible:!0,isSingle:!0,operationId:[i.id],createUserId:this.props.createUserId})}))},this.cancelSettingApprover=()=>{this.initTableList(),this.setState(i=>({settingApproverProps:(0,f.Z)((0,f.Z)({},i.settingApproverProps),{},{visible:!1,operationId:[]})})),this.setState({selectedRowKeys:[]})},this.onCancel=()=>{this.props.closeApprovalList()},this.renderRightRow=()=>{var i=this.props.t,d=this.state.selectedRowKeys;return r().createElement("div",{className:"auth-people__content__query"},r().createElement(F.Z,{type:"primary",onClick:this.multiSettingApprover,disabled:d.length===0},i("personal.batchEdit")))}}componentDidUpdate(i){if(this.props.visible&&this.props.visible!==i.visible&&this.props.entityId){var d=this.props,I=d.entityId,C=d.entityType;this.setState({params:{entity_type:C,entity_id:I},tableList:[]},()=>{this.initTableList()})}}render(){var i=this.props,d=i.visible,I=i.t,C=i.isHasTutor,T=this.state,B=T.tableList,j=T.tableLoading,V=T.settingApproverProps,X=T.selectedRowKeys;return r().createElement(M.ZP,{visible:d,title:I("authentication.editApprovals"),onCancel:this.onCancel,footer:null,size:"large"},r().createElement("div",{className:"auth-people"},d?r().createElement(r().Fragment,null,r().createElement("div",{className:"auth-people__content"},r().createElement($,{loading:j,list:B,selectedRowKeys:X,onSelectChange:this.handleSelectChange,settingApprover:this.settingApprover,toolBarRender:this.renderRightRow}),r().createElement(L,(0,_.Z)({},V,{isHasTutor:C,cancelSettingApprover:this.cancelSettingApprover})))):null))}}var R=(0,K.Z)()(b)},77444:function(ce,z,e){"use strict";var _=e(6793),O=e(3407),F=(0,_.me)(),f=O.Z[F].authentication.validation;z.Z={title:S=>(0,_.fy)(S)?(0,_.fy)(S).length>60?f.abilityDetailNameLimit:"":f.abilityDetailNameNull,summary:S=>{var r;return S?(0,_.fy)(S).length>500&&(r=O.Z[F].validation.limitedFiveHundred):r=f.abilityDetailSummaryNull,r},certificate:S=>{var r;return S.id||(r=f.abilityDetailIssueNull),r},checkSupervisor:S=>{var r,K=S.multilevel,Z=S.type;if(Z==="multilevel")if(K.length<2)r=f.abilityDetailSupervisionNull;else{var c={},h=[];K.forEach((y,w)=>{if(y.length===0){r=(0,_.ZT)("".concat(f.abilityDetailSupervisionStepNull),w+1);return}if(y.length>5){r=(0,_.ZT)("".concat(f.abilityDetailSupervisionStepLimit),w+1);return}y.forEach(t=>{h.push(t)})}),h.forEach(y=>{c[y.id]?r=f.abilityDetailSupervisionRepeat:c[y.id]=!0})}return r}}},27550:function(ce,z,e){"use strict";var _=e(57663),O=e(71577),F=e(63185),f=e(9676),S=e(43358),r=e(34041),K=e(88983),Z=e(47933),c=e(12924),h=e.n(c),y=e(28216),w=e(91768),t=e(49101),g=e(84391),o=e(1164),v=e(48479),M=e(2971),n=e(45601),L=e(7249),D=e(64549),k=e(31945),P=re=>{var H=re.user,l=re.currentRoute,$=re.advancedSetting;return{currentPath:l.path,allAuthRoutes:l.allAuthRoutes,userLng:H.lng,themeColor:$.themeColor}};class de extends h().Component{constructor(H){super(H);this.setPlaceholder=()=>{var l=this.props,$=l.currentPath,b=l.allAuthRoutes,R=l.userLng,N=this.state.language,i=b[$];if(!!i){var d=N[R].searchInputPlaceholder,I="";i.menuKey==="studyTemplate"||i.menuKey==="examTemplate"?I=d.template:i.menuKey==="management"||i.menuKey==="employee"||i.menuKey==="obligatory"||i.menuKey==="elective"||i.menuKey==="plan"||i.menuKey==="evaluation"||i.menuKey==="myEvaluationPlan"?I=d.task:I=d[i.menuKey],this.setState({currentPlaceholder:I})}},this.handleRadiosChange=l=>{this.props.onRadiosChange(l.target.value)},this.handleSelectChange=l=>{this.props.onSelectChange(l)},this.handleSearch=l=>{this.props.onSearch(l)},this.handleChange=l=>{this.props.onCheckboxChange(l.target.checked)},this.handleDownload=()=>{this.props.onDownload()},this.renderRadios=()=>{var l=this.props,$=l.prefixCls,b=l.radioList,R=l.defaultRadioValue,N=l.radioValue;if(!b.length)return null;var i=R||b[0].value,d="".concat($,"__radios");return h().createElement("div",{className:d},typeof N!="undefined"?h().createElement(Z.ZP.Group,{defaultValue:i,value:N,onChange:this.handleRadiosChange},b.map(I=>h().createElement(Z.ZP.Button,{key:I.value,value:I.value},I.name))):h().createElement(Z.ZP.Group,{defaultValue:i,onChange:this.handleRadiosChange},b.map(I=>h().createElement(Z.ZP.Button,{key:I.value,value:I.value},I.name))))},this.renderSelect=()=>{var l=this.props,$=l.prefixCls,b=l.selectList,R=l.defaultSelectValue;if(!b.length)return null;var N=R||b[0].value,i="".concat($,"__select");return h().createElement("div",{className:i},h().createElement(r.Z,{defaultValue:N,onChange:this.handleSelectChange,getPopupContainer:()=>document.getElementsByClassName("cl-listQueryRow__select")[0],style:{minWidth:100}},b.map(d=>h().createElement(r.Z.Option,{key:d.value,value:d.value},d.name))))},this.renderOther=()=>{var l=this.props,$=l.prefixCls,b=l.renderOther,R=l.showOther,N="".concat($,"__other");if(R&&b&&typeof b=="function")return h().createElement("div",{className:N},b())},this.renderCheckbox=()=>{var l=this.props,$=l.prefixCls,b=l.t,R=l.label,N=l.showCheckbox,i=l.renderActionSelect,d="".concat($,"__checkbox");return!N&&i&&typeof i=="function"?h().createElement("div",{className:d},i()):N?h().createElement("div",{className:d},h().createElement(f.Z,{onChange:this.handleChange},R||b("common.myCreated"))):null},this.renderSearch=()=>{var l=this.props,$=l.prefixCls,b=l.showSearch,R=l.inputPlaceholder,N=l.maxLength,i=N===void 0?400:N,d="".concat($,"__search");if(!b)return null;var I=this.state.currentPlaceholder;return R?h().createElement("div",{className:d},h().createElement(v.Z,{onSearch:this.handleSearch,placeholder:R,width:272,maxLength:i})):h().createElement("div",{className:d},h().createElement(v.Z,{onSearch:this.handleSearch,placeholder:I,width:272,maxLength:i}))},this.renderActionBtn=()=>{var l=this.props,$=l.prefixCls,b=l.actionText,R=l.t,N=l.tabLink,i=l.showBtn,d=l.renderActionBtn,I=l.popOverProps,C=I===void 0?[]:I,T=l.renderGuide,B=T===void 0?!1:T,j=l.showDownloadBtn,V=j===void 0?!1:j,X=l.guideClassName,pe=X===void 0?"guide-popover":X,oe=l.themeColor,p="".concat($,"__action");return!i&&d&&typeof d=="function"?h().createElement("div",{className:p},d()):!i||!b?null:h().createElement("div",{className:p},h().createElement(o.Z,{to:N},h().createElement(O.Z,{type:"primary",icon:h().createElement(t.Z,null)},b)),h().createElement(D.Z,{className:pe,renderGuide:B,guidePageProps:C,direction:"left",showDownloadBtn:V}),V&&h().createElement(O.Z,{style:{marginLeft:"8px",color:oe,border:"1px solid ".concat(oe)},icon:h().createElement(g.Z,null),onClick:this.handleDownload},R("common.exportData")))},this.renderQueryRow=()=>{var l=this.props,$=l.queryRowParams,b=l.queryRowList,R=l.queryRowSelectedCourseIds,N=l.queryRowSelectedProjectIds,i=l.queryRowOnForceRender,d=l.queryRowOnClassifyChange,I=l.queryRowOnTypeChange,C=l.queryRowOnCourseTypeChange,T=l.queryRowAllowActions;return h().createElement(k.Z,{params:$,list:b,selectedCourseIds:R,selectedProjectIds:N,onForceRender:i,onClassifyChange:d,onTypeChange:I,onCourseTypeChange:C,allowActions:T,showRenderCondition:!1})},this.rendeExtraBtn=()=>{var l=this.props,$=l.t,b=l.extraBtnSelectedRowKeys,R=l.extraBtnHandleMultiVisibleRange;return h().createElement(O.Z,{disabled:b.length===0,onClick:R},$("courseManage.setTheVisibility"))},this.state={language:{zh_cn:n.Z,en_us:M.Z,zh_hk:L.Z},currentPlaceholder:""}}componentDidMount(){this.setPlaceholder()}componentDidUpdate(H){H.userLng!==this.props.userLng&&this.setPlaceholder()}render(){var H=this.props,l=H.prefixCls,$=H.wrapCls,b=H.showRenderRadios,R=b===void 0?!0:b,N=H.showRenderQueryRow,i=H.showRendeExtraBtn,d=H.showRenderSelect;return h().createElement(h().Fragment,null,h().createElement("div",{className:"render_other"},this.renderOther(),h().createElement("header",{className:"".concat(l," ").concat($)},h().createElement("section",{className:"".concat(l,"__radiocol")},this.renderActionBtn(),N&&this.renderQueryRow(),i&&this.rendeExtraBtn()),h().createElement("section",{className:"".concat(l,"__searchcol")},this.renderCheckbox(),R&&this.renderRadios(),d&&this.renderSelect(),this.renderSearch()))))}}de.defaultProps={prefixCls:"cl-listQueryRow",wrapCls:"",label:"",actionText:"add",showRadioList:!0,showCheckbox:!0,showSearch:!0,showBtn:!0,inputPlaceholder:"",defaultRadioValue:"",radioList:[],searchStylesProps:{},showRenderSelect:!1,selectList:[],renderActionBtn:()=>null,onRadiosChange:()=>{},onSearch:()=>{},onCheckboxChange:()=>{}},z.Z=(0,y.$j)(P)((0,w.Z)()(de))},83431:function(ce,z,e){"use strict";var _=e(30887),O=e(99210),F=e(22385),f=e(31097),S=e(12924),r=e.n(S),K=e(91768),Z=e(57119),c=e(28216),h=w=>{var t=w.user;return{loginMode:t.loginMode}};function y(w){var t=w.onUrge,g=w.onDing,o=w.t,v=localStorage,M=v.appType,n=o(M==="wx_app"?"component.ordinaryUrgingWxTips":M==="fs_app"?"component.ordinaryUrgingFsTips":"component.ordinaryUrgingTips");return r().createElement(O.Z,null,r().createElement(O.Z.Item,{key:"1"},r().createElement(f.Z,{title:n},r().createElement("div",{className:"urge-menu-item",onClick:t},r().createElement("span",{className:"urge-menu-item__text"},o("component.ordinaryUrging")),r().createElement(Z.Z,null)))),M==="e_app"?r().createElement(O.Z.Item,{key:"2"},r().createElement(f.Z,{title:o("component.dingStudentsTips")},dd.version?r().createElement("div",{className:"urge-menu-item",onClick:g},r().createElement("span",{className:"urge-menu-item__text"},o("component.dingStudents")),r().createElement(Z.Z,null)):r().createElement("div",{className:"urge-menu-item__forbidden"},r().createElement("span",{className:"urge-menu-item__text"},o("component.dingStudents")),r().createElement(Z.Z,null)))):null)}z.Z=(0,c.$j)(h)((0,K.Z)()(y))},19866:function(ce,z,e){"use strict";e.r(z),e.d(z,{default:function(){return Ke}});var _=e(20228),O=e(11382),F=e(71194),f=e(57016),S=e(34792),r=e(48086),K=e(14781),Z=e(53431),c=e(88986),h=e(43358),y=e(34041),w=e(12924),t=e.n(w),g=e(91768),o=e(57068),v=e(76651),M=e(27550),n=e(62029),L=e(59250),D=e(13013),k=e(77576),P=e(59314),de=e(22385),re=e(31097),H=e(30887),l=e(99210),$=e(57361),b=e(9754),R=e.n(b),N=e(57119),i=e(43123),d=e(28216),I=e(404),C=e(10237),T=e(37055),B=e(18329),j=e(54531),V=e(6793),X=e(34669),pe=e(82833),oe=e(55285);class p extends t().Component{constructor(){super(...arguments);this.columns=[{title:this.props.t("learning.learningEmployeeAddTerm"),dataIndex:"taskBeginTime",key:"taskBeginTime",width:260,render:(E,s)=>{var a=s.taskBeginTime,m=s.taskEndTime;return"".concat((0,V.p6)(a),"~").concat((0,V.p6)(m))}},{title:()=>this.props.status!=="2"?this.props.t("study.trainingProgress"):this.props.t("personal.getCerti"),dataIndex:"process",key:"process",width:140,render:(E,s)=>{var a=s.hasCertificate?this.props.t("employeeSummary.yes"):this.props.t("employeeSummary.no"),m=this.props.status!=="2"?t().createElement(pe.Z,{percent:s.process}):a;return m}}],this.handleTableChange=E=>{this.props.onTableChange(E)},this.onSelectChange=E=>{this.props.onSelectChange(E)}}render(){var E={onChange:this.onSelectChange},s=this.props,a=s.list,m=a===void 0?[]:a,u=s.loading,U=s.paginationParams,te=U===void 0?{}:U,ue=s.status,Q=s.toolBarRender,Ee=(0,c.Z)((0,c.Z)({},T.XE.INITIAL_PAGINATION),te);return t().createElement("section",{className:"employee-people__content__table"},t().createElement(oe.Z,{bordered:!0,headExtra:[{title:this.props.t("common.number"),width:55,dataIndex:"id",key:"id",render:(ye,Ie,De)=>De+1,fixed:"left"}],columns:this.columns,rowKey:"userId",dataSource:m,pagination:Ee,loading:u,onChange:this.handleTableChange,rowSelection:ue==="3"?E:!1,toolBarRender:Q,tableUUID:"c4baa2d0-0a3a-49e1-b73a-9f28e1e5b225"}))}}var x=(0,g.Z)()(p),A=e(47673),Y=e(4107),J=e(57663),W=e(71577),G=e(57254),ae=e(59239),he=e(55446),le=e(48479),me=e(83431),ge=ae.Z.Item;class ve extends t().Component{constructor(){super(...arguments);this.state={visible:!1,days:""},this.handleSearch=E=>{this.props.handleSearch(E)},this.urgeUserStudy=()=>{var E=this.props.t;f.Z.confirm({title:E("study.remind"),content:E("study.urgeTip"),zIndex:99999,onOk:()=>{var s=T.ZP.EmployeeTrain.urgeUsers(),a={planId:this.props.planId};C.WY.get({url:s,params:a}).then(m=>{m.data.code===0&&r.default.success(m.data.msg)})}})},this.showDelay=()=>{this.setState({visible:!this.state.visible})},this.handleSubmit=E=>{E.preventDefault(),this.props.form.validateFields((s,a)=>{s||(this.props.handleDelay(a),this.showDelay())})},this.renderOngoingBtn=()=>t().createElement("div",{className:"employee_people__queryrow__action"},t().createElement(D.Z,{overlay:t().createElement(me.Z,{onUrge:this.urgeUserStudy,onDing:this.props.onDing})},t().createElement(W.Z,{type:"primary"},this.props.t("study.remind")," ",t().createElement(G.Z,null)))),this.renderOverdueBtn=()=>{var E=this.props.selectedRowKeys,s=E.length;return t().createElement("div",{className:"employee_people__queryrow__action"},t().createElement(W.Z,{type:"primary",className:"ongoing-user-top-btn",onClick:this.showDelay,disabled:s<=0},this.props.t("common.postpone")))},this.renderActionBtn=()=>{var E=this.props.status;if(E==="3")return t().createElement("div",null,this.renderOverdueBtn());if(E==="1")return t().createElement("div",null,this.renderOngoingBtn())}}render(){var E=this.props.t,s={okText:E("common.ok"),cancelText:E("common.cancel"),size:"small",destroyOnClose:!0,bodyStyle:{padding:"20px"},maskClosable:!1},a={labelCol:{span:5},wrapperCol:{span:15}},m=this.props.form.getFieldDecorator,u=this.state,U=u.visible,te=u.days;return t().createElement("header",{className:"employee_people__queryrow"},t().createElement("section",null,t().createElement(le.Z,{onSearch:this.handleSearch,width:"260px",placeholder:E("searchInputPlaceholder.userName")}),this.renderActionBtn()),t().createElement(B.ZP,(0,n.Z)({},s,{visible:U,title:E("common.postpone"),onCancel:this.showDelay,onOk:this.handleSubmit}),t().createElement("div",{className:"employee-delay"},t().createElement(ae.Z,{layout:"vertical"},t().createElement(ge,(0,n.Z)({},a,{label:E("common.postpone")}),m("delayDay",{rules:[{validator:this.checkPostponeDays}],initialValue:te})(t().createElement("span",null,t().createElement(Y.Z,{placeholder:"\u9650\u523630",style:{width:200}}),E("common.day"))))))))}}var Se=(0,g.Z)()(ae.Z.create()(ve));class q extends t().Component{constructor(){super(...arguments);this.state={params:{keyword:"",pageNumber:1,pageSize:20,taskStatus:this.props.status,planId:this.props.planId},tableLoading:!0,tableList:[],tableTotal:0,selectedRowKeys:[],trainTask:{},dingUserIds:[]},this.appId=sessionStorage.getItem("CL_E_APP_ID"),this.miniAppId=sessionStorage.getItem("CL_MINI_APP_ID"),this.initTableList=()=>{var E=this.props.planId;this.setState({tableLoading:!0}),C.WY.get({url:T.ZP.EmployeeTrain.getMonitorList(E),params:this.state.params}).then(s=>{setTimeout(()=>{this.setState({tableLoading:!1,tableList:s.data.data.voList.list,tableTotal:s.data.data.voList.total,trainTask:s.data.data.trainTask,dingUserIds:s.data.data.dingUserIds})},300)})},this.handleChangPagination=E=>{var s=E.current,a=E.pageSize;this.setState(m=>({params:(0,c.Z)((0,c.Z)({},m.params),{},{pageNumber:s,pageSize:a})}),()=>{this.initTableList()})},this.resetPagination=()=>new Promise(E=>{this.setState(s=>({params:(0,c.Z)((0,c.Z)({},s.params),{},{pageNumber:1,pageSize:20})}),()=>{E()})}),this.handleSearch=E=>{this.resetPagination().then(()=>{this.setState(s=>({params:(0,c.Z)((0,c.Z)({},s.params),{},{keyword:E})}),()=>{this.initTableList()})})},this.onSelectChange=E=>{this.setState({selectedRowKeys:E})},this.delayUsers=E=>{C.WY.post({url:T.ZP.EmployeeTrain.delayTrain(),params:{planId:this.props.planId,userIds:this.state.selectedRowKeys.join(","),delayDay:E.delayDay}}).then(s=>{s.data.code===0?(r.default.success(this.props.t("study.updateSuccess")),this.initTableList()):r.default.error(s.data.msg)})},this.onCancel=()=>{this.props.hideOngoingAndCompletedUsers()},this.handleDing=()=>{var E=this.state,s=E.trainTask,a=E.dingUserIds,m=s.trainName,u=encodeURIComponent("/pages/messageRedirect/messageRedirect?flag=study&planId=".concat(this.props.planId)),U="dingtalk://dingtalkclient/action/open_micro_app?&appId=".concat(this.appId,"&miniAppId=").concat(this.miniAppId,"&page=").concat(u,"&corpId=$CORPID$"),te={users:a,attachmentTitle:m,text:(0,V.ZT)(this.props.t("study.dingTips"),m),mobileUrl:U};(0,j.nb)(te)},this.renderRightRow=()=>{var E=this.props,s=E.status,a=E.planId,m=this.state.selectedRowKeys;return t().createElement(Se,{handleSearch:this.handleSearch,handleDelay:this.delayUsers,planId:a,status:s,selectedRowKeys:m,onDing:this.handleDing})}}componentDidUpdate(E){this.props.visible&&this.props.visible!==E.visible&&this.props.planId&&this.setState({params:{keyword:"",pageNumber:1,pageSize:20,taskStatus:this.props.status,planId:this.props.planId},tableList:[],tableTotal:0,selectedRowKeys:[]},()=>{this.initTableList(),(0,j.TN)()})}render(){var E=this.props,s=E.visible,a=E.t,m=E.status,u=this.state,U=u.tableTotal,te=u.tableList,ue=u.tableLoading,Q=u.params,Ee=a(m==="1"?"common.ongoing":m==="2"?"dashboard.completed":"common.overdue"),ye={total:U,current:Q.pageNumber,pageSize:Q.pageSize};return t().createElement(B.ZP,{visible:s,title:Ee,onCancel:this.onCancel,footer:null,size:"large"},s?t().createElement("div",{className:"employee_people"},t().createElement("div",{className:"employee_people__content"},t().createElement(x,{loading:ue,paginationParams:ye,list:te,onSelectChange:this.onSelectChange,status:m,onTableChange:this.handleChangPagination,toolBarRender:this.renderRightRow}))):null)}}var se=(0,g.Z)()(q),ne=e(60667),ee=e(1164),Pe=e(88311),ie=e(80430),Te=e(26885),Ce=e(66123),Le=e(98233),Oe=e(5364);class Ze extends t().Component{constructor(E){var s;super(E);s=this,this.handleDetails=a=>{var m=a.id,u=a.planId;ee.Z.targetTo({path:"/training/learning/task/employeeInfo?type=edit&editTaskId=".concat(m,"&planId=").concat(u)})},this.showOngoingAndCompletedUsers=(a,m)=>{this.setState(u=>({ongoingAndCompletedUsers:(0,c.Z)((0,c.Z)({},u.ongoingAndCompletedUsers),{},{visible:!0,planId:a,status:m})}))},this.hideOngoingAndCompletedUsers=()=>{this.setState(a=>({ongoingAndCompletedUsers:(0,c.Z)((0,c.Z)({},a.ongoingAndCompletedUsers),{},{visible:!1,planId:"",status:""})}))},this.showReadPaper=function(){var a=(0,$.Z)(R().mark(function m(u){var U,te;return R().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:if(!(u.pendingCount===0||u.course_mapping_list.length===1&&u.readingOperation!=="has_operation")){Q.next=3;break}return r.default.warning(s.props.t("examination.cannotMark")),Q.abrupt("return");case 3:if(u.course_mapping_list.length!==1){Q.next=10;break}return Q.next=6,(0,Le.Md)(u.course_mapping_list[0].courseType===15,{id:u.course_mapping_list[0].courseId,taskId:u.id,status:"pending",from:"projectNew"});case 6:U=Q.sent,u.course_mapping_list[0].courseType===15?ee.Z.targetTo({path:U}):v.m8.push(U),Q.next=14;break;case 10:te=s.state.pendingListConfig,te.visible=!0,te.id=u.planId,s.setState({pendingListConfig:te});case 14:case"end":return Q.stop()}},m)}));return function(m){return a.apply(this,arguments)}}(),this.showAssignedUserModal=()=>{var a=localStorage.getItem("authorityType"),m=this.props.user.loginMode,u=navigator.userAgent.toLowerCase().indexOf("wxwork")>-1;u&&m==="WE_COM"&&a==="1"?this.handleSelectWx():this.setState({orgDialogVisible:!0})},this.handleSelectWx=()=>{var a=this.props.user;(0,Te.Sk)().then(m=>{(0,Te.$f)({result:m,user:a}).then(u=>{var U=u.qyWeChatVo,te=u.rangeList;this.setState({qyWeChatVo:U},()=>{this.handleOk(te)})})}).catch(()=>{this.handleCancel()})},this.handleOk=a=>{this.setState({orgDialogVisible:!1});var m=this.props.data.id,u=this.state.qyWeChatVo;this.props.onAssignTask({trainId:m,rangeList:a,qyWeChatVo:u})},this.handleCancel=()=>{this.setState({orgDialogVisible:!1})},this.getApprovalList=a=>{this.setState(m=>({approvalListProps:(0,c.Z)((0,c.Z)({},m.approvalListProps),{},{visible:!0,entityId:a.planId,createUserId:a.createUser})}))},this.closeApprovalList=()=>{this.setState(a=>({approvalListProps:(0,c.Z)((0,c.Z)({},a.approvalListProps),{},{visible:!1,entityId:"",createUserId:""})}))},this.cancelRelease=a=>{var m=this,u=this.props.t;f.Z.confirm({title:u("common.tip"),icon:t().createElement(N.Z,null),content:u("study.afterTheReleaseTaskNotBeVisible"),onOk(){m.props.cancelRelease(a.planId)}})},this.renderActionItems=()=>{var a=this.props,m=a.t,u=a.data,U=[];return U.push(t().createElement(t().Fragment,null,t().createElement(ee.Z,{to:"/training/learning/task/employeeResult?id=".concat(u.planId,"&planStatus=").concat(u.planStatus)},t().createElement("span",{className:"cl-pointer operation-divide"},m("common.monitor"))),t().createElement("span",{className:"operation-divide-line"}))),u.planStatus==="published"?U.push(t().createElement(l.Z.Item,null,t().createElement("p",{className:"cl-dropdown-menuitem",onClick:()=>{this.cancelRelease(u)}},m("course.cancelRelease")))):U.push(t().createElement(l.Z.Item,null,t().createElement(ee.Z,{to:"/training/learning/task/employeeEdit?type=edit&editTaskId=".concat(u.id,"&planId=").concat(u.planId)},t().createElement("p",{className:"cl-dropdown-menuitem"}," ",m("common.release"))))),U.push(t().createElement(l.Z.Item,null,u.planStatus==="published"?t().createElement("p",{className:"cl-dropdown-menuitem",onClick:()=>{this.showAssignedUserModal(u)}},m("myExamTask.assigned")):t().createElement("p",{className:"cl-pointer\u2014forbid  cl-dropdown-menuitem cl-disabled"},m("myExamTask.assigned")))),U.push(t().createElement(l.Z.Item,null,u.planStatus==="published"?t().createElement(re.Z,{placement:"leftTop",title:m("myExamTask.cancelRelease")},t().createElement("p",{className:"cl-pointer\u2014forbid  cl-dropdown-menuitem cl-disabled"},m("common.edit")," ")):t().createElement(ee.Z,{to:"/training/learning/task/employeeEdit?type=edit&editTaskId=".concat(u.id,"&planId=").concat(u.planId)},t().createElement("p",{className:"cl-pointe cl-dropdown-menuitem"},m("common.edit")," ")))),U.push(t().createElement(l.Z.Item,null,u.pendingCount>0?t().createElement("p",{className:"cl-dropdown-menuitem",onClick:()=>this.showReadPaper(u)},m("exam.toBeGraded"),"(",u.pendingCount,")"):t().createElement("p",{className:"cl-dropdown-menuitem cl-pointer\u2014forbid cl-disabled"},m("exam.toBeGraded"),"(",u.pendingCount,")"))),U.push(t().createElement(l.Z.Item,null,u.operationCount?t().createElement("p",{className:"cl-dropdown-menuitem",onClick:()=>this.getApprovalList(u)},m("authentication.editApprovals")):t().createElement("p",{className:"cl-pointer\u2014forbid  cl-dropdown-menuitem cl-disabled"}," ",m("authentication.editApprovals")))),U.push(t().createElement(l.Z.Item,null,u.planOperation==="has_operation"?t().createElement("p",{className:"cl-dropdown-menuitem",onClick:()=>this.props.showConfirmDelete(u.planId)},m("common.delete")):t().createElement("p",{className:"cl-pointer\u2014forbid cl-dropdown-menuitem cl-disabled"},m("common.delete")))),U},this.moreOperate=a=>t().createElement(l.Z,null,a.slice(1)),this.getPendingPaperList=a=>(0,Oe.Un)((0,c.Z)({},a)),this.handlePendingCancel=()=>{var a=this.state.pendingListConfig;a.visible=!1,a.id="",this.setState({pendingListConfig:a})},this.state={ongoingAndCompletedUsers:{planId:"",status:"",visible:!1},orgDialogVisible:!1,approvalListProps:{entityType:"study",entityId:"",createUserId:"",visible:!1,isHasTutor:!0},qyWeChatVo:"",pendingListConfig:{visible:!1,uuid:"67e1ed5d-eabf-4bbe-9f70-5dd224f61e09",getList:this.getPendingPaperList,onCancel:this.handlePendingCancel,from:"employee"}}}render(){var E=this.props,s=E.t,a=E.data,m=E.lng,u=this.state,U=u.pendingListConfig,te=u.ongoingAndCompletedUsers,ue=u.orgDialogVisible,Q=u.approvalListProps,Ee=this.renderActionItems(),ye=m==="en_us";return t().createElement("div",null,t().createElement("div",{className:"employee-lists__item",key:a.id},t().createElement("div",{className:"employee-lists__item__title",onClick:()=>this.handleDetails(a)},a.trainName),t().createElement("div",{className:"employee-lists__item__info"},t().createElement("ul",{className:"left"},t().createElement("li",null,t().createElement("span",{className:"".concat(ye?"":"label-employee-title")},s("common.creator")),"\uFF1A",t().createElement(ne.Z,{dataType:"userName",value:a.creator_sync_user_id,name:a.createUserName,type:a.creator_source_type})),t().createElement("li",null,s("component.trainingRange"),"\uFF1A",a.trainLimit,s("common.day")),t().createElement("li",null,s("learning.learningEmployeeAddSecAssignment"),"\uFF1A",t().createElement(ie.Z,{list:a.departmentInfos||[],displayAll:!0}),a.postNames?",".concat(a.postNames):""),t().createElement("li",null,s("learning.learningEmployeeAddValidity"),"\uFF1A",(0,V.p6)(a.effectTime)),t().createElement("li",null,s("learning.taskStatus"),"\uFF1A",a.planStatus==="published"?s("courseManage.published"):s("courseManage.unPublished"))),t().createElement("ul",{className:"right"},t().createElement("li",{className:"finish active",onClick:()=>this.showOngoingAndCompletedUsers(a.planId,"2")},t().createElement("span",{className:"".concat(ye?"":"label-employee-title-num")},s("common.completed")),"\uFF1A",a.finishUserCount,s("common.userUnit")),t().createElement("li",{className:"going active",onClick:()=>this.showOngoingAndCompletedUsers(a.planId,"1")},s("common.ongoing"),"\uFF1A",a.onGoingUserCount,s("common.userUnit")),t().createElement("li",{className:"overdue active",onClick:()=>this.showOngoingAndCompletedUsers(a.planId,"3")},t().createElement("span",{className:"".concat(ye?"":"label-employee-title-num")},s("common.overdue")),"\uFF1A",a.unFinishUserCount,s("common.userUnit")),t().createElement("li",{className:"study"},t().createElement("span",{className:"".concat(ye?"":"label-employee-title-num")},s("common.study")),"\uFF1A",a.studyCount,s("common.examUnit")),t().createElement("li",{className:"exam"},t().createElement("span",{className:"".concat(ye?"":"label-employee-title-num")},s("common.exam")),"\uFF1A",a.examCount,s("common.examUnit")),t().createElement("li",{className:"exam"},t().createElement("span",{className:"".concat(ye?"":"label-employee-title-num")},s("common.operation")),"\uFF1A",a.operationCount,s("common.examUnit")))),t().createElement("div",{className:"employee-lists__item__actions"},t().createElement("div",{className:"status"},t().createElement("span",null,a.statusType===1?s("study.employeeNotActived"):a.statusType===2?s("study.employeeActivated"):s("common.deactivated")),t().createElement(P.Z,{checked:a.statusType!==3,onChange:Ie=>this.props.handleStatus(Ie,a.id)})),t().createElement("div",{className:"operation"},Ee.length?Ee.slice(0,1):null,Ee.length>2?t().createElement(D.Z,{overlay:this.moreOperate(Ee),placement:"topLeft"},t().createElement(i.Z,null)):null))),t().createElement(Ce.t,U),t().createElement(se,(0,n.Z)({},te,{hideOngoingAndCompletedUsers:this.hideOngoingAndCompletedUsers})),t().createElement(Pe.Z,{visible:ue,onOk:this.handleOk,onCancel:this.handleCancel}),t().createElement(I.Z,(0,n.Z)({},Q,{closeApprovalList:this.closeApprovalList})))}}var Re=fe=>{var E=fe.user.lng;return{lng:E,user:fe.user}},xe=(0,g.Z)()((0,d.$j)(Re)(Ze)),Ae=e(63848),Me=e(11449),Ne=e(87312),we=e(64262),Ue=e(64630),be=e(4408),We={access_token:"c4a6969e90324ea8a5c38af5c11fd642",questionMode:1,passLine:10,totalScore:24,singleCount:"",singleUnitScore:"",multipleCount:"",multipleUnitScore:"",trueOrFalseCount:"",trueOrFalseUnitScore:"",fillBlankCount:"",fillBlankUnitScore:"",shortAnswerCount:"",shortAnswerUnitScore:"",questionBankId:"",answerParsing:5,title:"title",beginTime:"2019-6-13 17:0:11",endTime:"2019-6-20 17:0:11",isAllIn:0,groupIds:"",userIds:"",departmentIds:"62155898,89955382",postIds:"",paperId:"1789886546128801792",examDuration:10,cheatFlag:0,repeatExam:!0,markType:1,examCertificateId:0,passingScore:2.4,cutScreenCount:0,reExamRule:0,scoreRule:0,examScore:"",isGetScore:!1,supervisorPaper:!1,supervisorId:950311681215565800},$e=null,Be=y.Z.Option;class _e extends t().Component{constructor(E){super(E);this.initData=()=>{this.getEmployeeList()},this.renderPagination=()=>{var s=this.state,a=s.params,m=s.employeeTotal,u="employee-lists__pagination",U=(0,c.Z)((0,c.Z)({},T.XE.INITIAL_PAGINATION),{},{total:m,current:a.pageNumber,pageSize:a.pageSize,onChange:this.handleNumberChange,onShowSizeChange:this.handleSizeChange});return t().createElement("div",{className:u},t().createElement(Z.Z,U))},this.handleNumberChange=s=>{this.setState(a=>({params:(0,c.Z)((0,c.Z)({},a.params),{},{pageNumber:s})}),()=>{this.getEmployeeList()})},this.handleSizeChange=(s,a)=>{this.setState(m=>({params:(0,c.Z)((0,c.Z)({},m.params),{},{pageSize:a})}),()=>{this.getEmployeeList()})},this.resetPagination=()=>new Promise(s=>{this.setState(a=>({params:(0,c.Z)((0,c.Z)({},a.params),{},{pageNumber:1,pageSize:20})}),()=>{s()})}),this.getStatusCount=()=>{var s=this.state.classify,a=(0,c.Z)((0,c.Z)({},this.state.params),{},{classify_id:s.length?s[s.length-1]:""}),m=T.ZP.EmployeeTrain.getStatusCount();C.WY.get({url:m,params:a}).then(u=>{var U=this.props.t,te=u.data,ue=te.allCount,Q=te.effectiveCount,Ee=te.stopUsingCount,ye=te.unEffectiveCount,Ie=te.publishedCount,De=te.unpublishedCount;this.setState({selectList:[{name:"".concat(U("common.all"),"(").concat(ue,")"),value:"0"},{name:"".concat(U("study.employeeNotActived"),"(").concat(ye,")"),value:"1"},{name:"".concat(U("study.employeeActivated"),"(").concat(Q,")"),value:"2"},{name:"".concat(U("common.deactivated"),"(").concat(Ee,")"),value:"3"}],radioList:[{name:"".concat(U("common.all"),"(").concat(ue,")"),value:"all"},{name:"".concat(U("courseManage.published"),"(").concat(Ie,")"),value:"published"},{name:"".concat(U("courseManage.unPublished"),"(").concat(De,")"),value:"unpublished"}]})})},this.getEmployeeList=()=>{var s=T.ZP.EmployeeTrain.getEmployeeTrainList(),a=this.state.classify,m=(0,c.Z)((0,c.Z)({},this.state.params),{},{classify_id:a.length?a[a.length-1]:""});C.WY.get({url:s,params:m}).then(u=>{setTimeout(()=>{this.setState({isLoading:!1,employeeList:u.data.list,employeeTotal:u.data.total})},300)}),this.getStatusCount()},this.handleTreeSelectChange=s=>{this.setState(a=>({params:(0,c.Z)((0,c.Z)({},a.params),{},{departmentId:s})}),()=>{this.initData()})},this.handlePostSelectChange=s=>{this.setState(a=>({params:(0,c.Z)((0,c.Z)({},a.params),{},{postId:s})}),()=>{this.initData()})},this.handleStatus=(s,a)=>{C.WY.post({url:T.ZP.EmployeeTrain.updateStatus(),params:{trainId:a,status:s?1:2}}).then(()=>{r.default.success(this.props.t("study.updateSuccess")),this.initData()})},this.showConfirmDelete=s=>{var a=this,m=this.props.t;f.Z.confirm({title:m("study.deleteEmployeeTip"),content:"",onOk(){a.sureToDelete(s)}})},this.sureToDelete=s=>{C.WY.post({url:T.ZP.EmployeeTrain.deleteEmployeeTrain(s),params:{planId:s}}).then(()=>{r.default.success(this.props.t("personal.removeSuccess")),this.initData()})},this.handleQueryRowRadiosChange=s=>{this.resetPagination().then(()=>{this.setState(a=>({params:(0,c.Z)((0,c.Z)({},a.params),{},{planStatus:s})}),()=>{this.getEmployeeList()})})},this.handleQueryRowSelectChange=s=>{this.resetPagination().then(()=>{this.setState(a=>({params:(0,c.Z)((0,c.Z)({},a.params),{},{statusType:s})}),()=>{this.getEmployeeList()})})},this.handleQueryRowSearch=s=>{this.resetPagination().then(()=>{this.setState(a=>({params:(0,c.Z)((0,c.Z)({},a.params),{},{keyword:s})}),()=>{this.initData()})})},this.handleAssignTask=s=>{var a=s.trainId,m=s.rangeList,u=s.qyWeChatVo,U=this.props.t,te=T.ZP.EmployeeTrain.assignTask({trainId:a}),ue={group_ids:m.group.map(Q=>Q.id),user_ids:m.user.map(Q=>Q.id),department_ids:m.dept.map(Q=>Q.id),post_ids:m.post.map(Q=>Q.id),qy_we_chat_vo:u};C.WY.post({url:te,data:ue}).then(()=>{this.initData(),r.default.success(U("study.assignSuccess"))}).catch(()=>{this.initData()})},this.classifyChange=s=>{this.setState(a=>({params:(0,c.Z)((0,c.Z)({},a.params),{},{pageNumber:1}),classify:s}),()=>{this.initData()})},this.renderSelect=()=>{var s=this.props.t,a=this.state.params,m=[{name:s("common.all"),value:"all"},{name:s("workbench.myCreation"),value:"my"},{name:s("workbench.myCharge"),value:"responsible_by_me"}];return t().createElement(y.Z,{value:a.scope,style:{marginLeft:16,lineHeight:"31px",width:245},onChange:this.handleSelect},m.map(u=>t().createElement(Be,{key:u.value,value:u.value},u.name)))},this.handleSelect=s=>{this.resetPagination().then(()=>{this.setState(a=>({params:(0,c.Z)((0,c.Z)({},a.params),{},{scope:s})}),()=>{this.initData()})})},this.cancelRelease=s=>{var a=this.props.t,m=T.ZP.EmployeeEdit.cancelPublishPlan(),u={plan_id:s};C.qg.post({url:m,data:u}).then(U=>{U.data.code===0?(this.initData(),r.default.success(a("study.cancelSuccessful"))):r.default.warning(U.data.msg)}).catch(()=>{this.initData()})},this.state={classify:[],params:{departmentId:"",postId:"",keyword:"",pageNumber:1,pageSize:20,scope:"all",statusType:0},employeeList:[],employeeTotal:0,isLoading:!0,radioList:[],selectList:[]}}componentDidMount(){var E=o.parse(v.m8.location.search),s=E.fromWorkScope;s?this.setState(a=>({params:(0,c.Z)((0,c.Z)({},a.params),{},{scope:s})}),()=>{this.initData()}):this.initData()}render(){var E=this.state,s=E.radioList,a=E.isLoading,m=E.employeeList,u=E.employeeTotal,U=E.classify,te=E.selectList,ue=this.props.t;return t().createElement(Me.Z,{pageContainerParams:{header:{title:ue("leftMenuLists.studyNeo")}}},t().createElement(be.Z,{title:ue("common.newEmployeeTask")}),t().createElement("div",{className:"employee"},t().createElement("div",{className:"employee-container"},t().createElement("div",{className:"employee-container__content"},t().createElement("div",{className:"org-tree-content"},t().createElement(we.Z,{className:"cl-search-normal-width",parentId:"",checkable:!1,asyncLoad:!0,treeSelect:!0,handleTreeSelectChange:this.handleTreeSelectChange}),t().createElement(Ue.Z,{onChange:this.handlePostSelectChange,className:"cl-search-normal-width"}),t().createElement("div",{className:"employee-task-select-padding"},t().createElement(Ae.Z,{onChange:this.classifyChange,value:U,unclassified:!0,showLabel:!1,className:"cl-search-normal-width"})),this.renderSelect()),t().createElement(M.Z,{renderOther:this.renderOther,showOther:!0,showBtn:!0,selectList:te,radioList:s,onSelectChange:this.handleQueryRowSelectChange,onRadiosChange:this.handleQueryRowRadiosChange,onCheckboxChange:this.handleCheckboxChange,onSearch:this.handleQueryRowSearch,showCheckbox:!1,showRenderSelect:!0,actionText:ue("study.addEmployee"),tabLink:"/training/learning/task/employeeEdit?type=add"}),a?t().createElement(O.Z,{size:"large"}):t().createElement("div",{className:"employee-lists-container"},u===0?t().createElement(Ne.Z,null):null,t().createElement("div",{className:"employee-lists"},m.map(Q=>t().createElement(xe,{key:Q.id,data:Q,showConfirmDelete:this.showConfirmDelete,handleStatus:this.handleStatus,onAssignTask:this.handleAssignTask,cancelRelease:this.cancelRelease}))),this.renderPagination())))))}}var Ke=(0,g.Z)()(_e)},5364:function(ce,z,e){"use strict";e.d(z,{MA:function(){return K},oA:function(){return Z},Un:function(){return c}});var _=e(88986),O=e(57361),F=e(9754),f=e.n(F),S=e(37055),r=e(10237),K=y=>{var w=S.ZP.EmployeeEdit.getCoachAnalysisListUrl(y);return delete y.planId,r.WY.get({url:w,params:y})},Z=y=>{var w=S.ZP.EmployeeEdit.getCoachAnalysisDetailUrl(y);return delete y.planId,delete y.tutorialsId,r.WY.get({url:w,params:y})};function c(y){return h.apply(this,arguments)}function h(){return h=(0,O.Z)(f().mark(function y(w){var t,g,o,v;return f().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=w.id,g=w.page_number,o=w.page_size,n.next=3,r.WY.get({url:S.ZP.EmployeeTrain.getAnalysisList({id:t}),params:{page_number:g,page_size:o,is_pending:!0}});case 3:if(v=n.sent,v.status!==200){n.next=6;break}return n.abrupt("return",{data:{code:"200000",data:(0,_.Z)({},v.data)}});case 6:return n.abrupt("return",v);case 7:case"end":return n.stop()}},y)})),h.apply(this,arguments)}},31945:function(ce,z,e){"use strict";e.d(z,{Z:function(){return pe}});var _=e(88983),O=e(47933),F=e(20228),f=e(11382),S=e(62029),r=e(30887),K=e(99210),Z=e(59250),c=e(13013),h=e(57663),y=e(71577),w=e(63185),t=e(9676),g=e(71194),o=e(57016),v=e(88986),M=e(34792),n=e(48086),L=e(43358),D=e(34041),k=e(12924),P=e.n(k),de=e(28216),re=e(91768),H=e(57254),l=e(18329);class $ extends P().Component{constructor(){super(...arguments);this.onCancel=()=>{this.props.showReferenceCourseList()}}render(){var p=this.props,x=p.visible,A=p.courseList,Y=p.t;return P().createElement(l.ZP,{visible:x,title:Y("common.tip"),onCancel:this.onCancel,onOk:this.onCancel},P().createElement("div",{className:"referenceWithOtherCourses"},P().createElement("div",{className:"referenceWithOtherCourses__tip"},Y("course.deleteCourseTip")),A.map((J,W)=>P().createElement("div",{className:"referenceWithOtherCourses__item",key:W},A.length>1?"".concat(W+1,"\u3001"):null," ",J))))}}var b=(0,re.Z)()($),R=e(10237),N=e(63848),i=e(58546),d=e(30389),I=e(54792),C=e(86726),T=e(37055),B=D.Z.Option,j={setClassify:T.ZP.CourseManageList.setClassify,setScore:T.ZP.CourseManageList.setScore,setBatchEmployee:T.ZP.CourseManageList.setBatchEmployee,deleteCourse:T.ZP.CourseManageList.deleteCourse,exportCourseView:T.ZP.CourseManageList.exportCourseView,syncCourse:T.ZP.CourseManageList.syncCourse},V=oe=>({qyShield:oe.user.qyShield});class X extends P().Component{constructor(){super(...arguments);this.state={classifyProps:{visible:!1},scoreProps:{title:this.props.t("course.setCredits"),labelTxt:this.props.t("course.credit"),initialValue:"",visible:!1},employeeProps:{visible:!1,initialParams:{employeeRange:{rangeType:3,rangeList:{dept:[],post:[],group:[],user:[]}}}},asyncProps:{value:0,visible:!1},showReferenceCourseListProps:{visible:!1,courseList:[],onOk:this.showReferenceCourseList,onCancel:this.showReferenceCourseList}},this.handleChangeClassify=p=>{this.props.onClassifyChange(p)},this.handleChangeType=p=>{this.props.onTypeChange(p)},this.handleChangeCourseType=p=>{this.props.onCourseTypeChange(p)},this.actionChangeClassify=()=>{this.setState({classifyProps:{visible:!0}})},this.handleCategoryCancel=()=>{this.setState({classifyProps:{visible:!1}})},this.handleCategoryOk=p=>{var x=p.node,A=this.props,Y=A.selectedCourseIds,J=A.selectedProjectIds,W=A.onForceRender,G=A.t,ae=x.id;ae&&R.qg.post({url:j.setClassify(),data:{course_ids:Y.join(","),project_ids:J.join(","),classify_id:ae}}).then(()=>{n.default.success(G("course.setCourseClassifySuccess")),W()}),this.handleCategoryCancel()},this.actionSetScore=()=>{this.setState(p=>({scoreProps:(0,v.Z)((0,v.Z)({},p.scoreProps),{},{initialValue:"",visible:!0})}))},this.handleScoreCancel=()=>{this.setState(p=>({scoreProps:(0,v.Z)((0,v.Z)({},p.scoreProps),{},{visible:!1})}))},this.handleScoreOk=p=>{var x=p.value;if(x===0){this.handleScoreCancel();return}var A=this.props,Y=A.selectedCourseIds,J=A.selectedProjectIds,W=A.onForceRender,G=A.t;R.qg.post({url:j.setScore(),data:{course_ids:Y.join(","),project_ids:J.join(","),credit:x}}).then(()=>{n.default.success(G("course.setCourseScoreSuccess")),W()}),this.handleScoreCancel()},this.actionSetEmployeeRange=()=>{this.setState(p=>({employeeProps:(0,v.Z)((0,v.Z)({},p.employeeProps),{},{visible:!0})}))},this.handleEmployeeCancel=()=>{this.setState({employeeProps:{visible:!1,initialParams:{employeeRange:{rangeType:3,rangeList:{dept:[],post:[],group:[],user:[]}}}}})},this.handleEmployeeOk=p=>{var x=this.props,A=x.selectedCourseIds,Y=x.selectedProjectIds,J=x.onForceRender,W=x.t,G=p.isAll,ae=p.departmentIds,he=p.groupIds,le=p.postIds,me=p.userIds,ge=p.qy_we_chat_vo;R.WY.post({url:j.setBatchEmployee(),data:{course_ids:A.join(","),project_ids:Y.join(","),department_ids:ae,group_ids:he,is_all:G,post_ids:le,user_ids:me,qy_we_chat_vo:ge}}).then(()=>{n.default.success(W("personal.batchSetRangeSuccess")),J()}),this.handleEmployeeCancel()},this.showReferenceCourseList=p=>{this.setState(x=>({showReferenceCourseListProps:(0,v.Z)((0,v.Z)({},x.showReferenceCourseListProps),{},{visible:!x.showReferenceCourseListProps.visible,courseList:p||[]})}))},this.actionDelete=()=>{var p=this.props,x=p.selectedCourseIds,A=p.selectedProjectIds,Y=p.list,J=p.onForceRender,W=p.t,G=0,ae=0,he=[];if(Y.forEach(le=>{x.includes(le.course_id)&&(le.reference_plan_count>0&&(ae+=1),le.reference_plan_count>0&&he.push(le.title),le.can_delete==="true"&&(G+=1))}),ae>0)this.showReferenceCourseList(he);else if(G!==x.length)n.default.warning(W("personal.deletePlatformCourseTip"));else{if(A.length>0){n.default.warning(W("personal.deleteProjectCourseTip"));return}o.Z.confirm({title:W("common.tip"),content:W("common.confirmDeleteTitle"),onOk(){R.qg.post({url:j.deleteCourse(),data:{enterpriseId:T.ZP.enterpriseId,ids:x.join(","),project_ids:A.join(",")}}).then(le=>{var me=le.data,ge=me.code,ve=me.msg;n.default["".concat(ge===0?"success":"warning")](ve),ge===0&&J()})}})}},this.actionSyncSetting=()=>{this.setState(p=>({asyncProps:(0,v.Z)((0,v.Z)({},p.asyncProps),{},{visible:!0})}))},this.onAsyncChange=p=>{this.setState(x=>({asyncProps:(0,v.Z)((0,v.Z)({},x.asyncProps),{},{value:p.target.value})}))},this.handleSyncCancel=()=>{this.setState({asyncProps:{visible:!1,value:0}})},this.handleSyncOk=()=>{var p=this.props,x=p.selectedCourseIds,A=p.selectedProjectIds,Y=p.onForceRender,J=p.t,W=this.state.asyncProps;R.qg.post({url:j.syncCourse(),data:{course_ids:x.join(","),project_ids:A.join(","),syncProgress:W.value}}).then(G=>{var ae=G.data,he=ae.code,le=ae.msg;he===0?(n.default.success(J("setting.setUpSucceed")),Y()):n.default.warning(le)}),this.handleSyncCancel()},this.actionImportDetail=()=>{var p=this.props,x=p.selectedCourseIds,A=p.selectedProjectIds,Y=p.onForceRender,J=p.t;if(x.concat(A).length>20){n.default.warning(J("courseManage.exportMoreTip"));return}var W=j.exportCourseView(),G={course_Ids:x.join(","),project_Ids:A.join(",")};R.WY.get({url:W,params:G}).then(ae=>{ae.data.code===200&&n.default.success("\u6587\u4EF6\u751F\u6210\u4E2D\uFF0C\u8BF7\u7A0D\u540E\u5728\u6587\u4EF6\u4E0B\u8F7D\u4E2D\u4E0B\u8F7D"),Y(),this.getDownloadingNumber()})},this.getDownloadingNumber=()=>{var p=T.ZP.downLoadCenter.getDownLoadingCount();R.WY.get({url:p,params:{}}).then(x=>{sessionStorage.setItem("downloadingCount",x.data.data),this.props.dispatch({type:"download/updateDownloadingNumber",downloadingNumber:x.data.data})}).catch(()=>{sessionStorage.setItem("downloadingCount",0),this.props.dispatch({type:"download/updateDownloadingNumber",downloadingNumber:0})})},this.handleChangeCheckBox=p=>{this.props.onCheckboxChange(p.target.checked)},this.handleSharingQueryRowCheckboxChange=p=>{this.props.onSharingCheckboxChange(p.target.checked)},this.renderCondition=()=>{var p=this.props,x=p.prefixCls,A=p.params,Y=p.qyShield,J=p.t,W=A.classify_id?A.classify_id.split(","):[];return P().createElement("div",{className:"".concat(x,"__condition")},this.props.extraDom&&this.props.extraDom(),P().createElement(N.Z,{onChange:this.handleChangeClassify,className:"cl-search-normal-width",value:W,showLabel:!1,placeholder:"Please select",queryType:"course_manage",unclassified:"true"}),P().createElement(D.Z,{value:A.type,className:"cl-search-normal-width",onChange:this.handleChangeType},P().createElement(B,{value:""},this.props.t("courseManage.allOrigin")),P().createElement(B,{value:"original"},this.props.t("courseManage.originalCourse")),P().createElement(B,{value:"notOriginal"},this.props.t("courseManage.nonOriginalCourse")),P().createElement(B,{value:"platform"},this.props.t("courseManage.platformProcurement"))),this.props.courseType&&this.props.courseType=="graphic"?null:P().createElement(D.Z,{value:A.course_type,className:"cl-search-normal-width",onChange:this.handleChangeCourseType},P().createElement(B,{value:"all"},this.props.t("courseManage.allType")),P().createElement(B,{value:"course"},this.props.t("common.courseLabel")),P().createElement(B,{value:"microCourse"},this.props.t("common.microCourse")),P().createElement(B,{value:"project"},this.props.t("leftMenuLists.studyProject"))),P().createElement(t.Z,{onChange:this.handleChangeCheckBox,style:{marginRight:16}},J("common.myCreated")),this.props.courseType&&this.props.courseType==="graphic"&&Y==="false"?P().createElement(t.Z,{onChange:this.handleSharingQueryRowCheckboxChange},J("common.sharing")):null)},this.renderActions=()=>{var p=this.props,x=p.prefixCls,A=p.selectedCourseIds,Y=p.selectedProjectIds,J=p.showNum,W=J===void 0?1:J,G=this.props.allowActions,ae=(0,C.H3)("delete",G),he=(0,C.H3)("adjustment_classification",G),le=(0,C.H3)("set_visible",G),me=(0,C.H3)("export",G),ge=(0,C.H3)("set_score",G),ve=(0,C.H3)("progressSync",G),Se=[{name:this.props.t("courseManage.adjustClassification"),type:"actionChangeClassify",isShow:he},{name:this.props.t("courseManage.exportViewDetail"),type:"actionImportDetail",isShow:me},{name:this.props.t("courseManage.setCredits"),type:"actionSetScore",isShow:ge},{name:this.props.t("courseManage.setTheVisibilityed"),type:"actionSetEmployeeRange",isShow:le},{name:this.props.t("common.delete"),type:"actionDelete",isShow:ae},{name:this.props.t("common.scheduleSyncSetting"),type:"actionSyncSetting",isShow:ve}],q=Se.filter(ee=>ee.isShow),se=[],ne=[];if(q.length)W?(se=[...q.slice(0,W)],ne=[...q.slice(W)]):ne=[...q];else return null;return P().createElement("div",{className:"".concat(x,"__action")},se.map(ee=>P().createElement(y.Z,{style:{marginRight:"8px"},key:ee.type,disabled:!(A.length+Y.length),onClick:this[ee.type]},ee.name)),ne.length?P().createElement(c.Z,{disabled:!(A.length+Y.length),overlay:this.renderMoreButton({buttons:ne})},P().createElement(y.Z,{className:"cl-pointer"},"".concat(this.props.t("common.more"))," ",P().createElement(H.Z,null))):"")}}renderMoreButton(p){var x=p.buttons,A=this.props,Y=A.selectedCourseIds,J=A.selectedProjectIds;return P().createElement(K.Z,{onClick:W=>{var G=W.key;this[G]()}},x.map(W=>W.isShow?P().createElement(K.Z.Item,{key:W.type,disabled:!(Y.length+J.length)},P().createElement("span",{className:"cl-pointer"},W.name)):null))}render(){var p=this.props,x=p.prefixCls,A=p.t,Y=p.showRenderCondition,J=Y===void 0?!0:Y,W=p.showRenderActions,G=W===void 0?!0:W,ae=this.state,he=ae.classifyProps,le=ae.scoreProps,me=ae.employeeProps,ge=ae.showReferenceCourseListProps,ve=ae.asyncProps;return P().createElement("div",{className:x},J&&this.renderCondition(),G&&this.renderActions(),P().createElement(i.Z,(0,S.Z)({},he,{title:A("personal.chooseClassify"),onCancel:this.handleCategoryCancel,onOk:this.handleCategoryOk})),P().createElement(I.Z,(0,S.Z)({},le,{onCancel:this.handleScoreCancel,onCreate:this.handleScoreOk})),me.visible&&P().createElement(d.Z,(0,S.Z)({},me,{title:A("courseManage.setTheVisibility"),mode:["all","part","private"],orgProps:{title:A("component.chooseVisibleScope")},isLoading:!me.visible,onCancel:this.handleEmployeeCancel,onCreate:this.handleEmployeeOk})),ve.visible&&P().createElement(l.ZP,{wrapClassName:"cl-async-selector-modal",visible:ve.visible,title:A("common.scheduleSyncSetting"),okText:A("common.ok"),cancelText:A("common.cancel"),onCancel:this.handleSyncCancel,onOk:this.handleSyncOk},ve.visible?P().createElement("div",{className:"".concat(x,"__async")},P().createElement("p",null," ",A("common.scheduleSyncSettingTip")),P().createElement(O.ZP.Group,{onChange:this.onAsyncChange,value:ve.value},P().createElement(O.ZP,{value:0},A("common.outSync")),P().createElement(O.ZP,{value:1},A("common.synchronization")))):P().createElement(f.Z,{size:"large"})),P().createElement(b,(0,S.Z)({},ge,{showReferenceCourseList:this.showReferenceCourseList})))}}X.defaultProps={prefixCls:"resource-course-list-page__release__content__queryrow",rangeType:""};var pe=(0,re.Z)()((0,de.$j)(V)(X))},67479:function(ce,z,e){"use strict";e.d(z,{D:function(){return Z},W:function(){return h}});var _=e(57361),O=e(9754),F=e.n(O),f=e(57068),S=e(31916),r=e(38642),K=e(5430);function Z(y){return c.apply(this,arguments)}function c(){return c=(0,_.Z)(F().mark(function y(w){var t,g,o,v,M;return F().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.prev=0,L.next=3,(0,S.uH)();case 3:if(t=L.sent,t!=="old"){L.next=6;break}return L.abrupt("return",!1);case 6:return L.next=8,(0,S.fP)(w);case 8:if(g=L.sent,o=g.data,v=o.code,M=o.data,v!=="200000"){L.next=14;break}return L.abrupt("return",M.exam_type==="new");case 14:L.next=20;break;case 16:return L.prev=16,L.t0=L.catch(0),console.error("\u65B0\u65E7\u8003\u8BD5\u5224\u65AD",L.t0),L.abrupt("return",!1);case 20:case"end":return L.stop()}},y,null,[[0,16]])})),c.apply(this,arguments)}var h={examing:function(){var y=(0,_.Z)(F().mark(function t(g){var o,v,M;return F().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return o="",v=g.pageFrom==="ding_myExamTask"?(0,r.lz)(K.ZP.enterpriseId,"student"):"",L.next=4,Z(g.exam_id);case 4:return M=L.sent,M?o="".concat(v,"/training/examination/new-exam/examing?").concat(f.stringify(g)):o="".concat(v,"/training/examination/exam/personal?").concat(f.stringify(g)),L.abrupt("return",o);case 7:case"end":return L.stop()}},t)}));function w(t){return y.apply(this,arguments)}return w}(),parse:y=>"/training/examination/new-exam/parse?".concat(f.stringify(y)),examData:y=>"/training/examination/exam-data?exam_id=".concat(y.exam_id,"&task_id=").concat(y.task_id),marking:y=>"/training/examination/new-exam/marking?".concat(f.stringify(y))}},98233:function(ce,z,e){"use strict";e.d(z,{nn:function(){return K},OV:function(){return h},Md:function(){return w},uk:function(){return r}});var _=e(57361),O=e(9754),F=e.n(O),f=e(57068),S=e(67479),r={edit:g=>"/training/learning/project/add?".concat(f.stringify(g)),monitorDetail:g=>{var o=g.id,v=g.projectId,M=g.origin,n=g.tab;return"/training/trainingProject/monitor?id=".concat(o,"&projectId=").concat(v,"&origin=").concat(M,"&tab=").concat(n)},traineeView:g=>"/training/trainingProject/traineeView?".concat(f.stringify(g)),manageView:g=>"/training/trainingProject/manageView?".concat(f.stringify(g)),previewView:g=>"/training/trainingProject/previewView?".concat(f.stringify(g))};function K(g){var o=g.origin,v=g.search,M=v===void 0?"":v,n={project:"/knowledgeBase/project/examination/newPlan/detail?".concat(M),learning:"/training/learning/examination/newPlan/detail?".concat(M),employee:"/training/employee/examination/newPlan/detail?".concat(M),exam:"/training/examination/newPlan/detail?".concat(M)};return n[o]||"/training/examination/newPlan/detail?".concat(M)}function Z(g,o){if(g){var v=f.stringify({id:o.id,title:o.title,origin:o.taskType,taskId:o.projectId});return K({origin:o.taskType,search:v})}var M=f.stringify({id:o.id,taskId:o.taskId,from:o.from,taskType:o.taskType,projectId:o.projectId});return"/training/learning/project/monitor/exam?".concat(M)}function c(g,o){return g?S.W.marking({exam_id:o.id,status:o.status,markScene:"manage"}):"/training/examination/plan/testPaper?id=".concat(o.id,"&from=").concat(o.from,"&taskId=").concat(o.taskId)}function h(){return y.apply(this,arguments)}function y(){return y=(0,_.Z)(F().mark(function g(){var o,v,M,n=arguments;return F().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(o=n.length>0&&n[0]!==void 0?n[0]:"unKnow",v=n.length>1?n[1]:void 0,o!=="unKnow"){D.next=7;break}return D.next=5,(0,S.D)(v.id);case 5:return M=D.sent,D.abrupt("return",Z(M,v));case 7:return D.abrupt("return",Z(o,v));case 8:case"end":return D.stop()}},g)})),y.apply(this,arguments)}function w(){return t.apply(this,arguments)}function t(){return t=(0,_.Z)(F().mark(function g(){var o,v,M,n=arguments;return F().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(o=n.length>0&&n[0]!==void 0?n[0]:"unKnow",v=n.length>1?n[1]:void 0,o!=="unKnow"){D.next=7;break}return D.next=5,(0,S.D)(v.id);case 5:return M=D.sent,D.abrupt("return",c(M,v));case 7:return D.abrupt("return",c(o,v));case 8:case"end":return D.stop()}},g)})),t.apply(this,arguments)}}}]);
