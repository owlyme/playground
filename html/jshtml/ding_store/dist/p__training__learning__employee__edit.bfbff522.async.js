(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[1601],{53009:function(Ee,ne,n){"use strict";n.d(ne,{TD:function(){return P},$S:function(){return I},aI:function(){return ce},Bg:function(){return N},tT:function(){return te},XN:function(){return O},YK:function(){return B},$x:function(){return D}});var U=n(81211),s=n(88986),H=n(78138),g=n.n(H),ae=n(78001),L=n(76651),j=n(38642),b=n(6793),c=n(37055),u=n(75205);function T(o){return o.map(_=>({name:_.name,id:_.id,proportion:0,disabled:_.totalCount===0||_.total_count===0}))}function A(o,_){return _.map((k,h)=>(0,s.Z)((0,s.Z)({},o[h]),{},{disabled:k.total_count===0}))}var E=o=>{var _=0,k=o.checkedValue,h=o.fillBlank,l=o.shortAnswer;return k===2?h.checked&&!l.checked?_=3:!h.checked&&l.checked?_=4:_=2:_=1,_},v=o=>{for(var _ in o)o[(0,j.FI)(_)]=o[_];return o},P=(o,_,k,h,l,a)=>{var e=o.map((t,y)=>{var S=t.list.map((r,i)=>{var m,d=r.data,Z={};switch(r.componentName){case"CoursewareSelector":Z={courseId:r.id,courseSort:i,courseType:3,flag:1,mappingId:r.mappingId?r.mappingId:""};break;case"CourseSelector":Z={courseId:r.id,courseSort:i,courseType:1,flag:1,mappingId:r.mappingId?r.mappingId:""};break;case"AddExam":Z={courseSort:i,title:d.title,type:"ex",cheatFlag:d.cheatFlag.isChecked?1:0,faceRecognition:d.cheatFlag.faceRecognition,examDuration:d.examDuration,summary:d.summary,flag:2,mappingId:r.mappingId?r.mappingId:"",courseId:r.id,markType:E(d.markType),paperId:d.questionsMode===1?d.fixedQuestion.id:"",paperTitle:d.questionsMode===1?d.fixedQuestion.name:"",passLine:d.passLine,questionBankList:d.questionsMode===1?"":d.randomQuestion.bankQuesitonVoList.map(ie=>ie.id).join(","),questionMode:d.questionsMode,showKnowledge:d.knowledgePoints===1?"show":"hide",repeatExam:d.reExam.isChecked,multipleCount:d.questionsMode===1?"":d.randomQuestion.bankQuesitonInfo.multipleCount,multipleUnitScore:d.questionsMode===1?"":d.randomQuestion.bankQuesitonInfo.multipleScore,fillBlankCount:d.questionsMode===1?"":d.randomQuestion.bankQuesitonInfo.fillBlankCount,fillBlankUnitScore:d.questionsMode===1?"":d.randomQuestion.bankQuesitonInfo.fillBlankScore,fillBlankType:d.questionsMode===1?1:d.randomQuestion.bankQuesitonInfo.fillBlankType,shortAnswerCount:d.questionsMode===1?"":d.randomQuestion.bankQuesitonInfo.shortAnswerCount,shortAnswerUnitScore:d.questionsMode===1?"":d.randomQuestion.bankQuesitonInfo.shortAnswerScore,shortAnswerType:d.questionsMode===1?1:d.randomQuestion.bankQuesitonInfo.shortAnswerType,singleCount:d.questionsMode===1?"":d.randomQuestion.bankQuesitonInfo.singleCount,singleUnitScore:d.questionsMode===1?"":d.randomQuestion.bankQuesitonInfo.singleScore,trueOrFalseCount:d.questionsMode===1?"":d.randomQuestion.bankQuesitonInfo.trueOrFalseCount,trueOrFalseUnitScore:d.questionsMode===1?"":d.randomQuestion.bankQuesitonInfo.trueOrFalseScore,multipleMissedScore:d.questionsMode===1?"":d.randomQuestion.bankQuesitonInfo.multipleMissedScore,totalScore:d.questionsMode===1?d.fixedQuestion.tableList.totalScore:"",answerParsing:d.reExam.isChecked?d.reExam.allowed.end:d.reExam.notAllowed.end,passingScore:d.questionsMode===1?Number(d.fixedQuestion.tableList.totalScore*d.passLine/100).toFixed(1):60,cutScreenCount:d.cheatFlag.switchNum!==null?d.cheatFlag.switchNum:-1,reExamRule:d.reExam.allowed.reRule,reExamNumber:d.reExam.allowed.reRule===2?d.reExam.allowed.reNum:0,scoreRule:d.reExam.allowed.record,viewRule:d.reExam.allowed.viewRule,proportional:d.questionsMode===2&&d.isOpenDrawQuestions?d.proportional:[],anonymousMarking:"".concat(d.markType.anonymousMarking),show_result:d.reExam.show_result};break;case"AddNewExam":var V=r.data,W=V.paperInfo,F=V.exam_times,pe=V.cut_screen_times,oe=V.random_order,le=V.mark_setting,_e=V.result_visible,Ce=V.face_recognition,he=(0,U.Z)(V,["paperInfo","exam_times","cut_screen_times","random_order","mark_setting","result_visible","face_recognition"]);Z={courseSort:i,flag:15,courseType:15,type:"ex",courseId:r.id,mappingId:r.mappingId?r.mappingId:"",new_exam:(0,s.Z)((0,s.Z)((0,s.Z)({},he),(0,u.jJ)(Ce)),{},{paper_id:W.id,answer_rule:F.answer_rule,exam_count:F.exam_count||1,cut_screen_rule:pe.cut_screen_rule,cut_screen_count:pe.cut_screen_count||1,cut_screen_interval:pe.cut_screen_interval||0,random_question:oe.random_question,random_options:oe.random_options,mark_type:le.mark_type,mark_question_type:{fill_blank:le.mark_type===u.lt.MANUAL?le.fill_blank:!1,short_answer:le.mark_type===u.lt.MANUAL?le.short_answer:!1},anonymous_marking:le.anonymous_marking,exam_certificate_id:"",supervisor_list:[],marker_list:[...le.marker_list.map(ie=>typeof ie=="string"?ie:ie.id)],result_view_rule:_e.result_view_rule,answer_parsing:_e.answer_parsing,ranking_list_view_rule:_e.ranking_list_view_rule,show_result:_e.show_result,reward_rule:null,authority_range:null,supervisor_mark:null})};break;case"OfflineTrain":Z={courseSort:i,flag:3,id:_&&!l?r.id:"",type:"xx",mappingId:r.mappingId?r.mappingId:"",title:d.title,begin_time:g()(d.dateRange.startTime).valueOf(),end_time:g()(d.dateRange.endTime).valueOf(),attachment:d.attachment.map(ie=>ie.id),course_duration:d.course_duration||"",lecturer_id:d.teacher.id,is_lecturer_confirm:!!d.teacher.is_lecturer_confirm,is_lecturer_subsidy:!!d.teacher.is_lecturer_subsidy,address:d.address,introduction:d.introduction,is_open_offline_assessment:d.assess.is_open_offline_assessment,is_open_upload:d.other.is_open_upload,is_open_schedule:!1,remind_type:d.remind.remind_type,advance_minute:d.remind.advance_minute?Number(d.remind.advance_minute):0,is_lecturer_remind:d.remind.is_lecturer_remind,is_student_remind:d.remind.is_student_remind,is_lecturer_student_evaluate:d.evaluate.is_lecturer_student_evaluate,is_student_lecturer_evaluate:d.evaluate.is_student_lecturer_evaluate,is_student_course_evaluate:d.evaluate.is_student_course_evaluate,lecturer_student_evaluate_content:d.evaluate.lecturer_student_evaluate_content,student_lecturer_evaluate_content:d.evaluate.student_lecturer_evaluate_content,student_course_evaluate_content:d.evaluate.student_course_evaluate_content,assessment_total_score:d.assess.assessment_total_score,assessment_pass_score:d.assess.assessment_pass_score};break;case"AddInvestigate":k==="study"?Z={courseSort:i,courseType:9,flag:4,id:r.id,questionnaireId:r.questionnaire.id,title:r.name,type:"questionnaire",mappingId:r.mappingId?r.mappingId:""}:Z={courseId:r.id,courseType:9,flag:9,courseSort:i,investigate:{id:r.id,title:r.name,questionnaire_id:r.questionnaire.id}};break;case"AddPracticeTest":Z={courseType:10,courseSort:i,flag:k==="study"?5:4,type:"sc",id:r.id,title:r.data.title,content:r.data.content||r.data.address,resources:r.data.attachment.map(ie=>({resourceId:ie.id})),scoreSetting:{scoreSwitch:r.data.mark.isFull?"on":"off",score:r.data.mark.value},workflowJson:r.data.workFlowTemplateId?{}:Q(r.data.supervisor),mappingId:r.mappingId?r.mappingId:"",job_type:r.data.job_type,workFlowTemplateId:r.data.workFlowTemplateId};break;case"AddJobEvaluation":Z={courseSort:i,flag:6,title:r.data.title,productId:r.data.evaluationTools.product_id,modelId:r.data.evaluationTools.model_id,id:r.id||"",mappingId:r.mappingId?r.mappingId:""};break;case"Attendance":Z={courseSort:i,flag:13,id:_&&!l?r.id:"",type:"attendance",mappingId:r.mappingId?r.mappingId:"",title:d.title,directors:d.directors.map(ie=>typeof ie=="object"&&(ie.id||ie.user_id)?ie.id||ie.user_id:ie),name:d.name,qrcode_type:d.qrcode_type||"statics",sign_in_begin_time:d.sign_in_begin_time?g()(d.sign_in_begin_time).valueOf():"",sign_in_end_time:d.sign_in_end_time?g()(d.sign_in_end_time).valueOf():"",sign_out_begin_time:d.sign_out_begin_time?g()(d.sign_out_begin_time).valueOf():"",sign_out_end_time:d.sign_out_end_time?g()(d.sign_out_end_time).valueOf():"",relate_course:d.relate_course,relate_course_list:((m=d.relate_course_list)===null||m===void 0?void 0:m.length)>0?d.relate_course_list:[],remind_directors:d.remind_directors,advance_minute:d.advance_minute||0,qy_we_chat_vo:d.qy_we_chat_vo,address:d.address,longitude:d.longitude,latitude:d.latitude,address_detail:d.address_detail,sign_range:d.sign_range};break;case"AddAssessment":Z=(0,s.Z)((0,s.Z)({},v(r.data)),{},{tutorId:a,courseSort:i,courseType:14,flag:14});break;default:break}return h==="unlock_mode"&&d.unlockingTime&&(Z.unlockingTime=g()(d.unlockingTime).valueOf()),Z.resource_lock=r.resource_lock||!1,Z});return{content:t.desc,stageName:t.name,isOrder:t.inOrder,stageSort:y+1,stageId:_?t.stageId:"",startTime:h==="unlock_mode"&&t.studyTime?g()(t.studyTime[0]).valueOf():null,endTime:h==="unlock_mode"&&t.studyTime?g()(t.studyTime[1]).valueOf():null,course:S}});return e},I=o=>{var _=o.map((k,h)=>({content:k.desc,stage_name:k.name,is_order:k.inOrder,stage_sort:h+1,stage_id:k.stageId,resources:k.list.map((l,a)=>{var e=l.data;switch(l.componentName){case"CoursewareSelector":return{course_id:l.id,course_sort:a,course_type:3,flag:1,mappingId:l.mappingId};case"AddMentorCoaching":return{course_id:l.id,tutorials:{id:l.id,title:e.title,content:e.content,model:e.model,tutor_model:e.tutor_model,evaluation_type:e.evaluation_type,user_id:e.user_id||"",user_name:e.user_name||""},course_sort:a,course_type:12,flag:7,mappingId:l.mappingId};case"CourseSelector":return{course_id:l.id,course_sort:a,course_type:1,flag:1,mappingId:l.mappingId};case"AddExam":return{exam:{id:l.id,title:e.title,cheat_flag:e.cheatFlag.isChecked?1:0,exam_duration:e.examDuration,face_recognition:e.cheatFlag.faceRecognition,summary:e.summary,mark_type:E(e.markType),paper_id:e.questionsMode===1?e.fixedQuestion.id:"",paper_name:e.questionsMode===1?e.fixedQuestion.name:"",pass_line:e.passLine,question_banks:e.questionsMode===1?"":e.randomQuestion.bankQuesitonVoList.map(W=>W.id),question_mode:e.questionsMode,show_knowledge:e.knowledgePoints===1?"show":"hide",repeat_exam:e.reExam.isChecked,multiple_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.multipleCount,multiple_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.multipleScore,fill_blank_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.fillBlankCount,fill_blank_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.fillBlankScore,fill_blank_type:e.questionsMode===1?1:e.randomQuestion.bankQuesitonInfo.fillBlankType,short_answer_type:e.questionsMode===1?1:e.randomQuestion.bankQuesitonInfo.shortAnswerType,short_answer_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.shortAnswerCount,short_answer_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.shortAnswerScore,single_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.singleCount,single_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.singleScore,multiple_missed_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.multipleMissedScore,true_or_false_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.trueOrFalseCount,true_or_false_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.trueOrFalseScore,total_score:e.questionsMode===1?e.fixedQuestion.tableList.totalScore:"",answer_parsing:e.reExam.isChecked?e.reExam.allowed.end:e.reExam.notAllowed.end,passing_score:e.questionsMode===1?Number(e.fixedQuestion.tableList.totalScore*e.passLine/100).toFixed(1):60,cut_screen_count:e.cheatFlag.switchNum!==null?e.cheatFlag.switchNum:-1,re_exam_rule:e.reExam.allowed.reRule,re_exam_number:e.reExam.allowed.reRule===2?e.reExam.allowed.reNum:0,score_rule:e.reExam.allowed.record,view_rule:e.reExam.allowed.viewRule,proportional:e.questionsMode===2&&e.isOpenDrawQuestions?e.proportional:[],anonymous_marking:"".concat(e.markType.anonymousMarking),show_result:e.reExam.show_result},flag:2,course_sort:a,course_id:l.id,course_type:6,mappingId:l.mappingId};case"AddNewExam":var t=l.data,y=t.paperInfo,S=t.exam_times,r=t.cut_screen_times,i=t.random_order,m=t.mark_setting,d=t.result_visible,Z=t.face_recognition,V=(0,U.Z)(t,["paperInfo","exam_times","cut_screen_times","random_order","mark_setting","result_visible","face_recognition"]);return{course_sort:a,flag:15,type:"ex",course_id:l.id,course_type:15,mappingId:l.mappingId?l.mappingId:"",new_exam:(0,s.Z)((0,s.Z)((0,s.Z)({},V),(0,u.jJ)(Z)),{},{paper_id:y.id,answer_rule:S.answer_rule,exam_count:S.exam_count||1,cut_screen_rule:r.cut_screen_rule,cut_screen_count:r.cut_screen_count||1,cut_screen_interval:r.cut_screen_interval||0,random_question:i.random_question,random_options:i.random_options,mark_type:m.mark_type,mark_question_type:{fill_blank:m.mark_type===u.lt.MANUAL?m.fill_blank:!1,short_answer:m.mark_type===u.lt.MANUAL?m.short_answer:!1},anonymous_marking:m.anonymous_marking,exam_certificate_id:"",supervisor_list:[],marker_list:[...m.marker_list.map(W=>typeof W=="string"?W:W.id)],result_view_rule:d.result_view_rule,answer_parsing:d.answer_parsing,ranking_list_view_rule:d.ranking_list_view_rule,show_result:d.show_result,reward_rule:null,authority_range:null,supervisor_mark:null})};case"AddPracticeTest":return{operation:{id:l.id,title:l.data.title,content:l.data.content||l.data.address,type:"sc",resources:l.data.attachment.map(W=>({resourceId:W.id})),score_setting:{scoreSwitch:l.data.mark.isFull?"on":"off",score:l.data.mark.value},workflow_json:Q(l.data.supervisor),sort:a,job_type:l.data.job_type},course_type:10,course_sort:a,flag:5,mappingId:l.mappingId};case"AddInvestigate":return{course_id:l.id,course_type:9,flag:4,course_sort:a,investigate:{id:l.id,title:l.name,questionnaire_id:l.questionnaire.id}};default:return null}})}));return _};function Q(o){var _=[];if(o.type==="multilevel"){var k=o.multilevel;k.forEach(h=>{var l=[];h.forEach(a=>{l.push(a.id)}),_.push(l.join(","))})}else o.type==="or"?(o.or.forEach(h=>{_.push(h.id)}),_=[_.join(",")]):_=[];return{type:o.type,userIds:_}}var ce=o=>{function _(a){if(a.questionMode===1){if(a.paperVo.fillBlankCount>0||a.paperVo.shortAnswerCount>0)return!0}else if(a.fillBlankCount>0||a.shortAnswerCount>0)return!0;return!1}function k(a){if(a.questionMode===1){if(a.paperVo.fillBlankCount>0)return!0}else if(a.fillBlankCount>0)return!0;return!1}function h(a){if(a.questionMode===1){if(a.paperVo.shortAnswerCount>0)return!0}else if(a.shortAnswerCount>0)return!0;return!1}var l=o.map((a,e)=>({key:"".concat(new Date().getTime()).concat(e),desc:a.content,name:a.stageName,inOrder:a.isOrder,stageId:a.id,studyTime:a.startTime?[g()(a.startTime),g()(a.endTime)]:["",""],list:a.courseMappingList.map(t=>{var y,S,r=t.planExamVos,i={},m,d;switch(t.flag){case 1:t.contentType==="audio/mp3"||t.contentType==="audio/mpeg"||t.contentType==="audio"?(d="mp3",m="mp3"):(d=t.type,m=t.type==="imageText"?"h5":t.type),i={id:t.courseId,name:t.name,type:t.courseType===1?"course":"courseware",icon:c.e1[m],originalType:d,componentName:t.courseType===1?"CourseSelector":"CoursewareSelector",status:t.courseType===1?"0":t.status,duration:t.duration,data:t,mappingId:t.mappingId};break;case 2:i={id:t.id,name:t.name,type:"ex",icon:c.e1.ex,componentName:"AddExam",duration:r.examDuration*60,data:{title:r.title,examDuration:r.examDuration,summary:r.summary,isOpenDrawQuestions:r.proportionalExamVos&&r.proportionalExamVos.length>0,proportional:r.proportionalExamVos&&(r.proportionalExamVos.length>0?A(r.proportionalExamVos,r.bankQuesitonVoList):r.questionMode===2?T(r.bankQuesitonVoList):[])||[],cheatFlag:{isChecked:!!r.cheatFlag,switchNum:r.cutScreenCount===-1?null:r.cutScreenCount,faceRecognition:r.faceRecognition},reExam:{show_result:r.show_result,isChecked:r.repeatExam,userJoin:r.user_join==="true",notAllowed:{end:r.answerParsing},allowed:{reRule:r.reExamRule,record:r.scoreRule,end:r.answerParsing,reNum:r.reExamRule===2?r.reExamNumber:1,viewRule:r.viewRule}},markType:{checkedValue:r.markType===1?1:2,artificialDisabled:r.markType===1&&!_(r),fillBlank:{checked:(r.markType===2||r.markType===3)&&k(r),disabled:!k(r)},shortAnswer:{checked:(r.markType===2||r.markType===4)&&h(r),disabled:!h(r)},anonymousMarking:r.anonymous_marking==="true"},questionsMode:r.questionMode,knowledgePoints:r.showKnowledge==="show"?1:2,passLine:r.passLine,fixedQuestion:r.questionMode===1?{id:r.paperVo.id,name:r.paperVo.title,tableList:{fillBlankCount:r.paperVo.fillBlankCount,fillBlankScore:r.paperVo.fillBlankScore,multipleCount:r.paperVo.multipleCount,multipleScore:r.paperVo.multipleScore,shortAnswerCount:r.paperVo.shortAnswerCount,shortAnswerScore:r.paperVo.shortAnswerScore,singleCount:r.paperVo.singleCount,singleScore:r.paperVo.singleScore,totalCount:r.paperVo.totalCount,totalScore:r.paperVo.totalScore,trueOrFalseCount:r.paperVo.trueOrFalseCount,trueOrFalseScore:r.paperVo.trueOrFalseScore}}:{id:"",name:"",tableList:{fillBlankCount:0,fillBlankScore:0,multipleCount:0,multipleScore:0,shortAnswerCount:0,shortAnswerScore:0,singleCount:0,singleScore:0,totalCount:0,totalScore:0,trueOrFalseCount:0,trueOrFalseScore:0}},randomQuestion:r.questionMode===2?{bankQuesitonVoList:r.bankQuesitonVoList.map(le=>({id:le.id,name:le.name,data:le})),bankQuesitonInfo:{fillBlankCount:r.fillBlankCount,fillBlankScore:r.fillBlankUnitScore,fillBlankType:+r.fillBlankType||1,multipleCount:r.multipleCount,multipleScore:r.multipleUnitScore,shortAnswerCount:r.shortAnswerCount,shortAnswerScore:r.shortAnswerUnitScore,shortAnswerType:+r.shortAnswerType||1,singleCount:r.singleCount,singleScore:r.singleUnitScore,trueOrFalseCount:r.trueOrFalseCount,trueOrFalseScore:r.trueOrFalseUnitScore,multipleMissedScore:r.multipleMissedScore}}:{bankQuesitonVoList:[],bankQuesitonInfo:{fillBlankCount:0,fillBlankScore:0,fillBlankType:1,multipleCount:0,multipleScore:0,shortAnswerCount:0,shortAnswerScore:0,shortAnswerType:1,singleCount:0,singleScore:0,trueOrFalseCount:0,trueOrFalseScore:0,multipleMissedScore:0}}},mappingId:t.mappingId,isExamEdit:t.isExamEdit};break;case 3:var Z=t.offline_course_vo;i={id:t.id,name:t.name,type:"xx",componentName:"OfflineTrain",icon:c.e1.xx,data:(0,s.Z)({},ue(Z)),mappingId:t.mappingId};break;case 4:case 5:if(t.type==="sc"||t.type==="operation"){i={id:t.id,name:t.title,type:"sc",icon:c.e1.sc,componentName:"AddPracticeTest",data:(0,j.UI)("PRIVACY_HLS_APPROVAL_MANAGE")?re(t):R(t),mappingId:t.mappingId};break}i={id:t.courseId,name:t.title||t.name,type:"investigate",icon:c.e1.questionnaire,componentName:"AddInvestigate",data:t,mappingId:t.mappingId,questionnaire:{id:t.questionnaireId,name:t.name}};break;case 6:i={id:t.evaluation.id,name:t.evaluation.title,productId:t.evaluation.product_id,modelId:t.evaluation.model_id,type:"jobEvaluation",icon:c.e1.jobEvaluation,componentName:"AddJobEvaluation",data:{title:t.evaluation.title,evaluationTools:{product_id:t.evaluation.product_id,model_id:t.evaluation.model_id}},mappingId:t.mappingId};break;case 7:i={id:t.id,name:t.tutorials.title,type:"tutor",icon:c.e1.tutor,componentName:"AddMentorCoaching",data:(0,s.Z)((0,s.Z)({},t.tutorials),{},{tutor_model:t.tutorials.tutorModel,evaluation_type:t.tutorials.evaluationType,user_id:t.tutorials.userId,user_name:t.tutorials.userName}),mappingId:t.mappingId};break;case 9:i={id:t.courseId,name:t.title,type:"investigate",icon:c.e1.questionnaire,componentName:"AddInvestigate",data:t,questionnaire:{id:t.questionnaireId,name:t.name}};break;case 13:var V=t.course_sign_vo;i={id:t.id,name:t.name,type:"attendance",componentName:"Attendance",icon:c.e1.attendance,data:(0,s.Z)({},me(V)),mappingId:t.mappingId};break;case 14:i={id:(t==null||(y=t.evaluate)===null||y===void 0?void 0:y.id)||"",name:(t==null||(S=t.evaluate)===null||S===void 0?void 0:S.name)||"",type:"assess",componentName:"AddAssessment",icon:c.e1.assess,data:(0,s.Z)({},z(t.evaluate)),resource_lock:t.resource_lock};break;case 15:{var W=(0,L.Qm)()._store,F=W.getState(),pe=F.user,oe=(0,u.AC)({data:t.exam_plan_detail_v1,user:{id:pe.id,name:pe.name,creator:!0}});i={id:t.exam_plan_detail_v1.id,name:t.exam_plan_detail_v1.title,type:"ex",icon:c.e1.ex,componentName:"AddNewExam",duration:t.exam_plan_detail_v1.exam_duration*60,data:oe,mappingId:t.mappingId,isExamEdit:t.isExamEdit}}default:break}return i.data&&(i.data.unlockingTime=t.unlockingTime?g()(t.unlockingTime):""),i.resource_lock=t.resource_lock,i})}));return l};function re(o){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"resources";return o.supervisor={lead:"",multilevel:[],or:[],type:"or"},o.mark={isFull:o.scoreSetting.score_switch==="on",value:o.scoreSetting.score_switch==="on"?o.scoreSetting.score:100},o.attachment=o[_],o}function R(o){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"resources",k=[],h=[];return o.workflowJson.type==="or"?o.workflowJson.nodeList[0].forEach(l=>{k.push({type:2,id:l.id,name:l.name,show:!0,unionid:l.unionid,user_id:l.sync_user_id,source_type:l.source_type||l.sourceType})}):o.workflowJson.type==="multilevel"&&o.workflowJson.nodeList.forEach(l=>{l.forEach(a=>{a.user_id=a.sync_user_id}),h.push(l)}),o.supervisor={or:k,multilevel:h,lead:"",type:o.workflowJson.type},o.mark={isFull:o.scoreSetting.score_switch==="on",value:o.scoreSetting.score_switch==="on"?o.scoreSetting.score:100},o.attachment=o[_],o}var N=(o,_)=>{var k=o.map((h,l)=>({id:h.id?h.id:"",content:h.desc,stage_name:h.name,is_order:_==="free_mode"?!1:h.inOrder,sort:l+1,progress:h.Standard.progressCheck?h.Standard.progress:"",exam_times:h.Standard.examCheck?h.Standard.examNum:"",practice_times:h.Standard.bankCheck?h.Standard.bankNum:"",operation_times:h.Standard.practiceCheck?h.Standard.practiceNum:"",finish_evaluation:h.Standard.jobEvaluationCheck?"true":"false",is_get_score:h.reward.getScoreChecked?h.reward.getScore:"",certificate_id:h.reward.certificateChecked?h.reward.certificateId:"",resources:h.list.map((a,e)=>{var t=a.data;switch(a.componentName){case"CoursewareSelector":return{course_id:a.id,replaced_old_id:a.replaced_old_id===a.id?"":a.replaced_old_id,sort:e,type:3,lab_resource_id:a.lab_resource_id,lab_resource_name:a.lab_resource_name,resource_lock:a.resource_lock||!1,unlocking_time:_==="unlock_mode"?null:g()(a.unlocking_time).valueOf()};case"ClNewUpload":case"CourseSelector":return{course_id:a.id,replaced_old_id:a.replaced_old_id||"",sort:e,type:1,lab_resource_id:a.lab_resource_id,lab_resource_name:a.lab_resource_name,resource_lock:a.resource_lock||!1,unlocking_time:_==="unlock_mode"?null:g()(a.unlocking_time).valueOf()};case"LiveClass":return{course_id:a.id,replaced_old_id:a.replaced_old_id||"",sort:e,type:16,lab_resource_id:a.lab_resource_id,lab_resource_name:a.lab_resource_name,resource_lock:a.resource_lock||!1,unlocking_time:_==="unlock_mode"?null:g()(a.unlocking_time).valueOf()};case"AddExam":return{type:6,sort:e,course_id:a.id,exam:{title:t.title,cheat_flag:t.cheatFlag.isChecked?1:0,exam_duration:t.examDuration,face_recognition:t.cheatFlag.faceRecognition,summary:t.summary,mark_type:E(t.markType),paper_id:t.questionsMode===1?t.fixedQuestion.id:"",pass_line:t.passLine,question_banks:t.questionsMode===1?[]:t.randomQuestion.bankQuesitonVoList.map(F=>F.id),question_mode:t.questionsMode,show_knowledge:t.knowledgePoints===1?"show":"hide",repeat_exam:t.reExam.isChecked,multiple_count:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.multipleCount,multiple_unit_score:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.multipleScore,fill_blank_count:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.fillBlankCount,fill_blank_unit_score:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.fillBlankScore,fill_blank_type:t.questionsMode===1?1:t.randomQuestion.bankQuesitonInfo.fillBlankType,short_answer_count:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.shortAnswerCount,short_answer_unit_score:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.shortAnswerScore,short_answer_type:t.questionsMode===1?1:t.randomQuestion.bankQuesitonInfo.shortAnswerType,single_count:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.singleCount,single_unit_score:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.singleScore,true_or_false_count:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.trueOrFalseCount,true_or_false_unit_score:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.trueOrFalseScore,multiple_missed_score:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.multipleMissedScore,total_score:t.questionsMode===1?t.fixedQuestion.tableList.totalScore:"",answer_parsing:t.reExam.isChecked?t.reExam.allowed.end:t.reExam.notAllowed.end,passing_score:t.questionsMode===1?Number(t.fixedQuestion.tableList.totalScore*t.passLine/100).toFixed(1):60,cut_screen_count:t.cheatFlag.switchNum!==null?t.cheatFlag.switchNum:-1,re_exam_rule:t.reExam.allowed.reRule,re_exam_number:t.reExam.allowed.reRule===2?t.reExam.allowed.reNum:0,score_rule:t.reExam.allowed.record,view_rule:t.reExam.allowed.viewRule,proportional:t.questionsMode===2&&t.isOpenDrawQuestions?t.proportional:[],anonymous_marking:"".concat(t.markType.anonymousMarking),show_result:t.reExam.show_result},resource_lock:a.resource_lock||!1,unlocking_time:_==="unlock_mode"?null:g()(a.unlocking_time).valueOf()};case"AddNewExam":var y=a.data,S=y.paperInfo,r=y.exam_times,i=y.cut_screen_times,m=y.random_order,d=y.mark_setting,Z=y.result_visible,V=y.face_recognition,W=(0,U.Z)(y,["paperInfo","exam_times","cut_screen_times","random_order","mark_setting","result_visible","face_recognition"]);return{type:15,sort:e,course_id:a.id,new_exam:(0,s.Z)((0,s.Z)((0,s.Z)({},W),(0,u.jJ)(V)),{},{paper_id:S.id,answer_rule:r.answer_rule,exam_count:r.exam_count||1,cut_screen_rule:i.cut_screen_rule,cut_screen_count:i.cut_screen_count||1,cut_screen_interval:i.cut_screen_interval||0,random_question:m.random_question,random_options:m.random_options,mark_type:d.mark_type,mark_question_type:{fill_blank:d.mark_type===u.lt.MANUAL?d.fill_blank:!1,short_answer:d.mark_type===u.lt.MANUAL?d.short_answer:!1},anonymous_marking:d.anonymous_marking,exam_certificate_id:"",supervisor_list:[],marker_list:[...d.marker_list.map(F=>typeof F=="string"?F:F.id)],result_view_rule:Z.result_view_rule,answer_parsing:Z.answer_parsing,ranking_list_view_rule:Z.ranking_list_view_rule,show_result:Z.show_result,reward_rule:null,authority_range:null,supervisor_mark:null}),resource_lock:a.resource_lock||!1,unlocking_time:_==="unlock_mode"?null:g()(a.unlocking_time).valueOf()};case"OfflineTrain":return{sort:e,type:7,course_id:a.id,offline_course:{id:t.id,title:t.title,begin_time:g()(t.dateRange.startTime).valueOf(),end_time:g()(t.dateRange.endTime).valueOf(),attachment:t.attachment.map(F=>F.id),course_duration:t.course_duration||"",lecturer_id:t.teacher.id,is_lecturer_confirm:!!t.teacher.is_lecturer_confirm,is_lecturer_subsidy:!!t.teacher.is_lecturer_subsidy,address:t.address,introduction:t.introduction,is_open_offline_assessment:t.assess.is_open_offline_assessment,is_open_upload:t.other.is_open_upload,is_open_schedule:!1,remind_type:t.remind.remind_type,advance_minute:t.remind.advance_minute?Number(t.remind.advance_minute):0,is_lecturer_remind:t.remind.is_lecturer_remind,is_student_remind:t.remind.is_student_remind,is_director_remind:t.remind.is_director_remind,is_lecturer_student_evaluate:t.evaluate.is_lecturer_student_evaluate,is_student_lecturer_evaluate:t.evaluate.is_student_lecturer_evaluate,is_student_course_evaluate:t.evaluate.is_student_course_evaluate,lecturer_student_evaluate_content:t.evaluate.lecturer_student_evaluate_content,student_lecturer_evaluate_content:t.evaluate.student_lecturer_evaluate_content,student_course_evaluate_content:t.evaluate.student_course_evaluate_content,assessment_total_score:t.assess.assessment_total_score,assessment_pass_score:t.assess.assessment_pass_score},resource_lock:a.resource_lock||!1,unlocking_time:_==="unlock_mode"?null:g()(a.unlocking_time).valueOf()};case"AddInvestigate":return{sort:e,type:9,course_id:a.id||"",questionnaire_id:a.questionnaire.id,resource_lock:a.resource_lock||!1,title:a.name,unlocking_time:_==="unlock_mode"?null:g()(a.unlocking_time).valueOf()};case"AddPracticeTest":return{type:10,courseSort:e,sort:e,flag:4,course_id:a.id,title:a.data.title,content:a.data.content||a.data.address,resources:a.data.attachment.map(F=>({resourceId:F.id})),scoreSetting:{scoreSwitch:a.data.mark.isFull?"on":"off",score:a.data.mark.value},workflowJson:Q(a.data.supervisor),job_type:a.data.job_type,resource_lock:a.resource_lock||!1,unlocking_time:_==="unlock_mode"?null:g()(a.unlocking_time).valueOf()};case"AddJobEvaluation":return{sort:e,flag:6,type:11,evaluation:{id:a.id||"",title:a.data.title,product_id:a.data.evaluationTools.product_id,model_id:a.data.evaluationTools.model_id},resource_lock:a.resource_lock||!1,unlocking_time:_==="unlock_mode"?null:g()(a.unlocking_time).valueOf()};case"Attendance":return{sort:e,type:13,course_id:a.id,sign:{id:t.id,type:13,title:t.title,directors:t.directors.map(F=>typeof F=="object"&&(F.id||F.user_id)?F.id||F.user_id:F),name:t.name||"--",qrcode_type:t.qrcode_type,sign_in_begin_time:t.sign_in_begin_time,sign_in_end_time:t.sign_in_end_time,sign_out_begin_time:t.sign_out_begin_time,sign_out_end_time:t.sign_out_end_time,relate_course:t.relate_course,relate_course_list:t.relate_course_list,remind_directors:t.remind_directors,advance_minute:t.advance_minute,qy_we_chat_vo:t.qy_we_chat_vo,address:t.address,longitude:t.longitude,latitude:t.latitude,address_detail:t.address_detail,sign_range:t.sign_range},resource_lock:a.resource_lock||!1,unlocking_time:_==="unlock_mode"?null:g()(a.unlocking_time).valueOf()};case"AddAssessment":return{sort:e,type:14,course_id:a.id,resource_lock:a.resource_lock||!1,unlocking_time:_==="unlock_mode"?null:g()(a.unlocking_time).valueOf(),evaluateVo:{id:t.id,name:t.name,requirement:t.requirement,resource_id:t.resource_id,is_lock:t.is_lock,begin_time_unlock:t.begin_time_unlock,end_time_unlock:t.end_time_unlock,is_self_evaluate:t.is_self_evaluate,questionnaire_id:t.questionnaire_id,evaluate_form_title:t.evaluate_form_title,before_start_day:t.before_start_day,before_start_repeat:t.before_start_repeat,before_start_un_remind:t.before_start_un_remind,before_end_day:t.before_end_day,before_end_repeat:t.before_end_repeat,before_end_un_remind:t.before_end_un_remind,after_end_day:t.after_end_day,after_end_repeat:t.after_end_repeat,after_end_un_remind:t.after_end_un_remind,is_passed_standards:t.is_passed_standards,is_passed_option_three:t.is_passed_option_three,pass_standard_conditions:t.pass_standard_conditions,pass_standards_number:t.pass_standards_number,creator_user:t.creator_user}};case"AddPracticeBank":return{sort:e,type:17,course_id:a.id,resource_name:a.title,resource_lock:a.resource_lock||!1,unlocking_time:_==="unlock_mode"?null:g()(a.unlocking_time).valueOf(),practice:{title:a.data.title,question_bank_list:a.data.randomQuestion.bankQuesitonVoList.map(F=>F.id),pass_line:Number(a.data.stand)}};default:return null}})}));return k},te=function(_,k){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;function l(e){return e.fill_blank_count>0||e.short_answer_count>0}var a=_.map((e,t)=>{var y=e.resources.filter(i=>i.type==6||i.type==15).length,S=e.resources.filter(i=>i.type==17).length,r=e.resources.filter(i=>i.type==10).length;return{id:e.id,key:"".concat(new Date().getTime()).concat(t),desc:e.content,name:e.stage_name,inOrder:e.is_order,Standard:{progressCheck:e.progress>0,progress:e.progress||100,examCheck:e.exam_times>0,examNum:e.exam_times||y,bankCheck:e.practice_times>0,bankNum:e.practice_times||S,practiceCheck:e.operation_times>0,practiceNum:e.operation_times||r,jobEvaluationCheck:e.finish_evaluation==="true"},reward:{getScore:e.is_get_score?e.is_get_score:"",getScoreChecked:e.is_get_score>0,certificateId:e.certificate_id||"",certificateChecked:e.certificate_id!==0,certificateName:e.certificate_name,certificateImage:e.preview_url},hourClassId:e.id,hourClassStartTime:e.start_time,hourClassEndTime:e.end_time,list:e.resources.map(i=>{var m=i.exam;switch(i.type){case 1:return{id:i.course_id,name:i.resource_name,type:h&&i.biz_type==="imageText"?"twCourse":"course",icon:i.biz_type==="imageText"?c.e1.h5:c.e1.crs,componentName:"CourseSelector",duration:i.duration,data:i,unlocking_time:i.unlocking_time,lab_resource_id:i.lab_resource_id,lab_resource_name:i.lab_resource_name,lab_selected_id:i.lab_resource_id,resource_lock:i.resource_lock};case 3:{var d;return i.content_type==="article"||i.content_type==="link"?d=c.e1.h5:d=c.e1[i.contentType]||c.e1[i.content_type],{id:i.course_id,name:i.resource_name,type:"courseware",icon:d,componentName:"CoursewareSelector",duration:i.duration,status:i.resource_status,originalType:i.content_type==="article"||i.content_type==="link"?"h5":i.content_type||i.contentType,data:i,unlocking_time:i.unlocking_time,lab_resource_id:i.lab_resource_id,lab_resource_name:i.lab_resource_name,lab_selected_id:i.lab_resource_id,resource_lock:i.resource_lock}}case 6:return{id:i.course_id,name:m.title,type:"ex",icon:c.e1.ex,componentName:"AddExam",duration:m.exam_duration*60,data:{id:m.id,title:m.title,examDuration:m.exam_duration,summary:m.summary,isOpenDrawQuestions:m.proportionalExamVos&&m.proportionalExamVos.length>0,proportional:m.proportionalExamVos&&(m.proportionalExamVos.length>0?A(m.proportionalExamVos,m.question_bank_vos):m.question_mode===2?T(m.question_bank_vos):[])||[],cheatFlag:{isChecked:!!m.cheat_flag,switchNum:m.cut_screen_count===-1?null:m.cut_screen_count,faceRecognition:m.face_recognition},reExam:{show_result:m.show_result,isChecked:m.repeat_exam,userJoin:k?!1:m.user_join==="true",notAllowed:{end:m.answer_parsing},allowed:{reRule:m.re_exam_rule,record:m.score_rule,end:m.answer_parsing,reNum:m.re_exam_rule===2?m.re_exam_number:1,viewRule:m.view_rule}},markType:{checkedValue:m.mark_type===1?1:2,artificialDisabled:m.mark_type===1&&!l(m),fillBlank:{checked:(m.mark_type===2||m.mark_type===3)&&m.fill_blank_count,disabled:!m.fill_blank_count},shortAnswer:{checked:(m.mark_type===2||m.mark_type===4)&&m.short_answer_count,disabled:!m.short_answer_count},anonymousMarking:m.anonymous_marking==="true"},questionsMode:m.question_mode,knowledgePoints:m.show_knowledge==="show"?1:2,passLine:m.pass_line,fixedQuestion:m.question_mode===1?{id:m.paper_id,name:m.paper_name,tableList:{fillBlankCount:m.fill_blank_count,fillBlankScore:m.fill_blank_unit_score,multipleCount:m.multiple_count,multipleScore:m.multiple_unit_score,shortAnswerCount:m.short_answer_count,shortAnswerScore:m.short_answer_unit_score,singleCount:m.single_count,singleScore:m.single_unit_score,totalCount:m.total_count,totalScore:m.total_score,trueOrFalseCount:m.true_or_false_count,trueOrFalseScore:m.true_or_false_unit_score}}:{id:"",name:"",tableList:{fillBlankCount:0,fillBlankScore:0,multipleCount:0,multipleScore:0,shortAnswerCount:0,shortAnswerScore:0,singleCount:0,singleScore:0,totalCount:0,totalScore:0,trueOrFalseCount:0,trueOrFalseScore:0}},randomQuestion:m.question_mode===2?{bankQuesitonVoList:m.question_bank_vos.map(oe=>{var le=oe.fill_blank_count,_e=oe.multiple_count,Ce=oe.short_answer_count,he=oe.single_count,ie=oe.total_count,ye=oe.true_or_false_count,Oe={fillBlankCount:le,shortAnswerCount:Ce,multipleCount:_e,singleCount:he,totalCount:ie,trueOrFalseCount:ye};return{id:oe.id,name:oe.name,data:Object.assign(oe,Oe),fillBlankCount:le,shortAnswerCount:Ce,multipleCount:_e,singleCount:he,totalCount:ie,trueOrFalseCount:ye}}),bankQuesitonInfo:{fillBlankCount:m.fill_blank_count,fillBlankScore:m.fill_blank_unit_score,fillBlankType:+m.fillBlankType,multipleCount:m.multiple_count,multipleScore:m.multiple_unit_score,shortAnswerCount:m.short_answer_count,shortAnswerScore:m.short_answer_unit_score,shortAnswerType:+m.shortAnswerType,singleCount:m.single_count,singleScore:m.single_unit_score,trueOrFalseCount:m.true_or_false_count,trueOrFalseScore:m.true_or_false_unit_score,multipleMissedScore:m.multiple_missed_score}}:{bankQuesitonVoList:[],bankQuesitonInfo:{fillBlankCount:0,fillBlankScore:0,fillBlankType:1,multipleCount:0,multipleScore:0,shortAnswerCount:0,shortAnswerScore:0,shortAnswerType:1,singleCount:0,singleScore:0,trueOrFalseCount:0,trueOrFalseScore:0,multipleMissedScore:0}}},unlocking_time:i.unlocking_time,resource_lock:i.resource_lock};case 7:return{id:k?"":i.offlineCourseEditVo.id,name:i.offlineCourseEditVo.title,key:i.offlineCourseEditVo.id,type:"xx",componentName:"OfflineTrain",icon:c.e1.xx,data:(0,s.Z)({},ue(i.offlineCourseEditVo,k)),unlocking_time:i.unlocking_time,resource_lock:i.resource_lock};case 9:return{id:i.course_id,name:i.title||i.resource_name,type:"investigate",icon:c.e1.questionnaire,componentName:"AddInvestigate",data:i,questionnaire:{id:i.questionnaire_id,name:i.resource_name},unlocking_time:i.unlocking_time,resource_lock:i.resource_lock};case 10:return{id:i.course_id,name:i.title,type:"sc",icon:c.e1.sc,componentName:"AddPracticeTest",data:R(i,"operationResources"),unlocking_time:i.unlocking_time,resource_lock:i.resource_lock};case 11:return{id:i.evaluation.id,name:i.evaluation.title,productId:i.evaluation.product_id,modelId:i.evaluation.model_id,type:"jobEvaluation",icon:c.e1.jobEvaluation,componentName:"AddJobEvaluation",data:{title:i.evaluation.title,evaluationTools:{product_id:i.evaluation.product_id,model_id:i.evaluation.model_id}},unlocking_time:i.unlocking_time,resource_lock:i.resource_lock};case 13:return{id:i.course_sign_vo.id,name:i.course_sign_vo.name,type:"attendance",componentName:"Attendance",icon:c.e1.attendance,data:(0,s.Z)({},me(i.course_sign_vo,k)),unlocking_time:i.unlocking_time,resource_lock:i.resource_lock};case 14:return{id:i.evaluate?i.evaluate.id:"",name:i.evaluate?i.evaluate.name:"",type:"assess",componentName:"AddAssessment",icon:c.e1.assess,data:(0,s.Z)({},z(i.evaluate)),resource_lock:i.resource_lock,unlocking_time:i.unlocking_time};case 15:{var Z=(0,L.Qm)()._store,V=Z.getState(),W=V.user,F=(0,u.AC)({data:i.exam_plan_detail_v1,user:{id:W.id,name:W.name,creator:!0}});return{id:i.exam_plan_detail_v1.id,name:i.exam_plan_detail_v1.title,type:"ex",icon:c.e1.ex,componentName:"AddNewExam",unlocking_time:i.unlocking_time,resource_lock:i.resource_lock,duration:i.exam_plan_detail_v1.exam_duration*60,data:F}}case 16:return{id:k?"":i.course_id,name:i.title,key:i.course_id,type:"liveClass",componentName:"LiveClass",icon:c.e1.liveClass,data:(0,s.Z)({},J(i)),unlocking_time:i.unlocking_time,resource_lock:i.resource_lock};case 17:var pe=(0,u.S8)(i.practice);return{id:i.course_id,name:i.resource_name,type:"practice",componentName:"AddPracticeBank",unlocking_time:i.unlocking_time,resource_lock:i.resource_lock,data:pe};default:return null}})}});return a},O=o=>{var _=o.map((k,h)=>({content:k.desc,stage_name:k.name,order:"".concat(k.inOrder),sort:h+1,course:k.list.map((l,a)=>{var e=l.data;switch(l.componentName){case"CoursewareSelector":return{course_id:l.id,course_sort:a,course_type:3,flag:1};case"CourseSelector":return{course_id:l.id,course_sort:a,course_type:1,flag:1};case"AddExam":return{flag:2,type:"ex",course_sort:a,course_id:l.id,title:e.title,cheat_flag:e.cheatFlag.isChecked?1:0,exam_duration:e.examDuration,face_recognition:e.cheatFlag.faceRecognition,summary:e.summary,mark_type:E(e.markType),paper_id:e.questionsMode===1?e.fixedQuestion.id:"",paper_title:e.questionsMode===1?e.fixedQuestion.name:"",pass_line:e.passLine,question_bank_list:e.questionsMode===1?"":e.randomQuestion.bankQuesitonVoList.map(W=>W.id).join(","),question_mode:e.questionsMode,show_knowledge:e.knowledgePoints===1?"show":"hide",s_repeat_exam:"".concat(e.reExam.isChecked),multiple_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.multipleCount,multiple_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.multipleScore,fill_blank_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.fillBlankCount,fill_blank_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.fillBlankScore,fill_blank_type:e.questionsMode===1?1:e.randomQuestion.bankQuesitonInfo.fillBlankType,short_answer_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.shortAnswerCount,short_answer_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.shortAnswerScore,short_answer_type:e.questionsMode===1?1:e.randomQuestion.bankQuesitonInfo.shortAnswerType,single_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.singleCount,single_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.singleScore,true_or_false_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.trueOrFalseCount,true_or_false_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.trueOrFalseScore,multiple_missed_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.multipleMissedScore,total_score:e.questionsMode===1?e.fixedQuestion.tableList.totalScore:"",answer_parsing:e.reExam.isChecked?e.reExam.allowed.end:e.reExam.notAllowed.end,passing_score:e.questionsMode===1?Number(e.fixedQuestion.tableList.totalScore*e.passLine/100).toFixed(1):60,cut_screen_count:e.cheatFlag.switchNum!==null?e.cheatFlag.switchNum:-1,re_exam_rule:e.reExam.allowed.reRule,re_exam_number:e.reExam.allowed.reRule===2?e.reExam.allowed.reNum:0,score_rule:e.reExam.allowed.record,view_rule:e.reExam.allowed.viewRule,proportional:e.questionsMode===2&&e.isOpenDrawQuestions?e.proportional:[],anonymous_marking:"".concat(e.markType.anonymousMarking),show_result:e.reExam.show_result};case"AddNewExam":var t=l.data,y=t.paperInfo,S=t.exam_times,r=t.cut_screen_times,i=t.random_order,m=t.mark_setting,d=t.result_visible,Z=t.face_recognition,V=(0,U.Z)(t,["paperInfo","exam_times","cut_screen_times","random_order","mark_setting","result_visible","face_recognition"]);return{course_type:15,flag:15,type:"ex",course_sort:a,course_id:l.id,new_exam:(0,s.Z)((0,s.Z)((0,s.Z)({},V),(0,u.jJ)(Z)),{},{paper_id:y.id,answer_rule:S.answer_rule,exam_count:S.exam_count||1,cut_screen_rule:r.cut_screen_rule,cut_screen_count:r.cut_screen_count||1,cut_screen_interval:r.cut_screen_interval||0,random_question:i.random_question,random_options:i.random_options,mark_type:m.mark_type,mark_question_type:{fill_blank:m.mark_type===u.lt.MANUAL?m.fill_blank:!1,short_answer:m.mark_type===u.lt.MANUAL?m.short_answer:!1},anonymous_marking:m.anonymous_marking,exam_certificate_id:"",supervisor_list:[],marker_list:[...m.marker_list.map(W=>typeof W=="string"?W:W.id)],result_view_rule:d.result_view_rule,answer_parsing:d.answer_parsing,ranking_list_view_rule:d.ranking_list_view_rule,show_result:d.show_result,reward_rule:null,authority_range:null,supervisor_mark:null})};case"AddInvestigate":return{course_id:l.id,course_type:9,flag:9,course_sort:a,investigate:{id:l.id,title:l.name,questionnaire_id:l.questionnaire.id}};default:return null}})}));return _},B=o=>{function _(h){return h.fill_blank_count>0||h.short_answer_count>0}var k=o.map((h,l)=>({key:"".concat(new Date().getTime()).concat(l),desc:h.content,name:h.stage_name,inOrder:h.is_order,list:h.course_mapping_list.map(a=>{var e=a;switch(a.flag){case 1:return{id:a.course_id,name:a.name,type:a.course_type===1?"course":"courseware",icon:c.e1[a.type==="imageText"?"h5":a.contentType==="audio/mp3"?"mp3":a.type],originalType:a.type,componentName:a.course_type===1?"CourseSelector":"CoursewareSelector",status:a.course_type===1?"":a.status,duration:a.duration,data:a};case 2:return{id:a.course_id,name:e.title,type:"ex",icon:c.e1.ex,componentName:"AddExam",duration:e.exam_duration*60,data:{title:e.title,examDuration:e.exam_duration,summary:e.summary,isOpenDrawQuestions:e.proportionalExamVos&&e.proportionalExamVos.length>0,proportional:e.proportionalExamVos&&(e.proportionalExamVos.length>0?A(e.proportionalExamVos,e.bank_quesiton_list):e.question_mode===2?T(e.bank_quesiton_list):[])||[],cheatFlag:{isChecked:!!e.cheat_flag,switchNum:e.cut_screen_count===-1?null:e.cut_screen_count,faceRecognition:e.face_recognition},reExam:{show_result:e.show_result,isChecked:e.s_repeat_exam==="true",notAllowed:{end:e.answer_parsing},allowed:{reRule:e.re_exam_rule,record:e.score_rule,end:e.answer_parsing,reNum:e.re_exam_rule===2?e.re_exam_number:1,viewRule:e.view_rule}},markType:{checkedValue:e.mark_type===1?1:2,artificialDisabled:e.mark_type===1&&!_(e),fillBlank:{checked:(e.mark_type===2||e.mark_type===3)&&e.fill_blank_count,disabled:!e.fill_blank_count},shortAnswer:{checked:(e.mark_type===2||e.mark_type===4)&&e.short_answer_count,disabled:!e.short_answer_count},anonymousMarking:e.anonymous_marking==="true"},questionsMode:e.question_mode,knowledgePoints:e.show_knowledge==="show"?1:2,passLine:e.pass_line,fixedQuestion:e.question_mode===1?{id:e.paper_id,name:e.paper_title,tableList:{fillBlankCount:e.fill_blank_count,fillBlankScore:e.fill_blank_unit_score,multipleCount:e.multiple_count,multipleScore:e.multiple_unit_score,shortAnswerCount:e.short_answer_count,shortAnswerScore:e.short_answer_unit_score,singleCount:e.single_count,singleScore:e.single_unit_score,totalCount:e.paper_question_numbers,totalScore:e.total_score,trueOrFalseCount:e.true_or_false_count,trueOrFalseScore:e.true_or_false_unit_score}}:{id:"",name:"",tableList:{fillBlankCount:0,fillBlankScore:0,multipleCount:0,multipleScore:0,shortAnswerCount:0,shortAnswerScore:0,singleCount:0,singleScore:0,totalCount:0,totalScore:0,trueOrFalseCount:0,trueOrFalseScore:0}},randomQuestion:e.question_mode===2?{bankQuesitonVoList:e.bank_quesiton_list.map(i=>{var m=i.fill_blank_count,d=i.multiple_count,Z=i.short_answer_count,V=i.single_count,W=i.total_count,F=i.true_or_false_count,pe={fillBlankCount:m,shortAnswerCount:Z,multipleCount:d,singleCount:V,totalCount:W,trueOrFalseCount:F};return{id:i.id,name:i.name,data:Object.assign(i,pe),fillBlankCount:m,shortAnswerCount:Z,multipleCount:d,singleCount:V,totalCount:W,trueOrFalseCount:F}}),bankQuesitonInfo:{fillBlankCount:e.fill_blank_count,fillBlankScore:e.fill_blank_unit_score,fillBlankType:+e.fill_blank_type||1,multipleCount:e.multiple_count,multipleScore:e.multiple_unit_score,shortAnswerCount:e.short_answer_count,shortAnswerScore:e.short_answer_unit_score,shortAnswerType:+e.short_answer_type||1,singleCount:e.single_count,singleScore:e.single_unit_score,trueOrFalseCount:e.true_or_false_count,trueOrFalseScore:e.true_or_false_unit_score,multipleMissedScore:e.multiple_missed_score}}:{bankQuesitonVoList:[],bankQuesitonInfo:{fillBlankCount:0,fillBlankScore:0,multipleCount:0,multipleScore:0,shortAnswerCount:0,shortAnswerScore:0,singleCount:0,singleScore:0,trueOrFalseCount:0,trueOrFalseScore:0,multipleMissedScore:0}}}};case 9:return{id:a.course_id,name:a.title,type:"investigate",icon:c.e1.questionnaire,componentName:"AddInvestigate",data:a,questionnaire:{id:a.questionnaire_id,name:a.name}};case 15:{var t=(0,L.Qm)()._store,y=t.getState(),S=y.user,r=(0,u.AC)({data:a.exam_plan_detail_v1,user:{id:S.id,name:S.name,creator:!0}});return{id:a.exam_plan_detail_v1.id,name:a.exam_plan_detail_v1.title,type:"ex",icon:c.e1.ex,componentName:"AddNewExam",duration:a.exam_plan_detail_v1.exam_duration*60,data:r}}default:return null}})}));return k},D=function(_){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return _.map((h,l)=>{var a=k.find(e=>e.stage_index-1===l);return h.list.map((e,t)=>{var y;a&&(y=a.resource_error_vos.find(r=>r.resource_index===t));var S=e.type;if(e.resource_type)switch(e.resource_type){case 1:S="course";break;case 2:case 3:S="courseware";break;case 6:case 15:S="ex";break;case 7:S="xx";break;case 9:S="questionnaire";break;case 13:S="attendance";break;case 14:S="assess";break;default:break}if(e.componentName)switch(e.componentName){case"CourseSelector":S="course";break;case"CoursewareSelector":S="courseware";break;case"AddNewExam":case"AddExam":S="ex";break;case"OfflineTrain":S="xx";break;case"Attendance":S="attendance";break;case"QuestionnaireSelector":case"AddInvestigate":S="questionnaire";break;case"AddPracticeTest":S="practicalIndustry";break;case"AddAssessment":S="assess";break;default:break}switch(S){case"course":e.resourceErrTip=y?y.resource_status==="deleted"?"\u5F15\u7528\u7684\u8BFE\u7A0B\u88AB\u5220\u9664":y.resource_status==="un_released"?"\u5F15\u7528\u7684\u8BFE\u7A0B\u300A".concat(y.resource_name,"\u300B\u672A\u53D1\u5E03\uFF0C\u8BF7\u542F\u7528\u540E\u518D\u7F16\u8F91"):"":"";break;case"courseware":e.resourceErrTip=y&&y.resource_status==="deleted"?"\u5F15\u7528\u7684\u8BFE\u4EF6\u88AB\u5220\u9664":"";break;case"ex":e.resourceErrTip=y?y.resource_status==="bank_deleted"?"\u5F15\u7528\u7684\u9898\u5E93\u88AB\u5220\u9664":y.resource_status==="paper_deleted"?"\u5F15\u7528\u7684\u8BD5\u5377\u88AB\u5220\u9664":y.resource_status==="bank_missing"?"\u5F15\u7528\u7684\u9898\u5E93\u8BD5\u9898\u4E0D\u8DB3":"":"";break;case"xx":e.resourceErrTip=y&&y.resource_status==="time_expired"?"\u7EBF\u4E0B\u8BFE\u5DF2\u8FC7\u671F":"";break;case"questionnaire":e.resourceErrTip=y?y.resource_status==="deleted"?"\u5F15\u7528\u7684\u95EE\u5377\u88AB\u5220\u9664":y.resource_status==="un_released"?"\u5F15\u7528\u7684\u95EE\u5377\u672A\u53D1\u5E03":"":"";break;case"practicalIndustry":e.resourceErrTip=y&&y.resource_status==="operation_resource_deleted"?ae.Z.t("component.practicalDeleteTip"):"";break;default:break}return null}),null}),_},ue=(o,_)=>({id:_?"":o.id,title:o.title,edit_status:o.edit_status,status:o.status,department_id:o.department_id||"",dateRange:{startTime:o.begin_time,endTime:o.end_time},address:o.address,course_duration:o.course_duration,has_lecturer_student_data:_?!1:o.has_lecturer_student_data,has_student_lecturer_data:_?!1:o.has_student_lecturer_data,has_student_course_data:_?!1:o.has_student_course_data,has_lecturer_assess_student_data:_?!1:o.has_lecturer_assess_student_data,teacher:{id:o.lecturer_id,name:o.lecturer_name,is_lecturer_confirm:o.is_lecturer_confirm,is_lecturer_subsidy:o.is_lecturer_subsidy,teacher_sync_user_id:o.teacher_sync_user_id,lecturer_name:o.lecturer_name,teacher_sync_source_type:o.teacher_sync_source_type,type:o.teacher_sync_type,teacher_sync_type:o.teacher_sync_type},introduction:o.introduction,attachment:o.attachment||[],other:{is_open_schedule:o.is_open_schedule,is_open_upload:o.is_open_upload},remind:{remind_type:o.remind_type||"offline_course",advance_minute:o.advance_minute,is_lecturer_remind:o.is_lecturer_remind,is_student_remind:o.is_student_remind,is_director_remind:o.is_director_remind},evaluate:{is_lecturer_student_evaluate:o.is_lecturer_student_evaluate,is_student_lecturer_evaluate:o.is_student_lecturer_evaluate,is_student_course_evaluate:o.is_student_course_evaluate,lecturer_student_evaluate_content:o.lecturer_student_evaluate_content?(0,s.Z)((0,s.Z)({},o.lecturer_student_evaluate_content),{},{passing_score:Number(o.lecturer_student_evaluate_content.passing_score),total_score:Number(o.lecturer_student_evaluate_content.total_score)}):{evaluate_type:"score",questionnaire_id:"",questionnaire_name:"",total_score:"",passing_score:""},student_lecturer_evaluate_content:o.student_lecturer_evaluate_content||{evaluate_type:"star",questionnaire_id:"",questionnaire_name:"",total_score:"",passing_score:""},student_course_evaluate_content:o.student_course_evaluate_content||{evaluate_type:"star",questionnaire_id:"",questionnaire_name:"",total_score:"",passing_score:""}},assess:{is_open_offline_assessment:o.is_open_offline_assessment,assessment_total_score:o.assessment_total_score,assessment_pass_score:o.assessment_pass_score},user_has_attendanted:_?!1:o.user_has_attendanted}),me=(o,_)=>{var k=[];return _?o.attendance_course_vo.forEach(h=>{k.push((0,s.Z)((0,s.Z)({},h),{},{course_id:"",course_key:h.course_id}))}):k=o.attendance_course_vo,{courseId:o.courseId,directors:o.director?o.director.map(h=>h):o.directors,id:_?"":o.id,name:o.name,qrcode_type:o.qrcode_type,relate_course_list:k,sign_in_begin_time:o.sign_in_begin_time?(0,b.p6)(o.sign_in_begin_time,"yyyy-MM-dd hh:mm:ss"):"",sign_in_end_time:o.sign_in_end_time?(0,b.p6)(o.sign_in_end_time,"yyyy-MM-dd hh:mm:ss"):"",sign_out_begin_time:o.sign_out_begin_time?(0,b.p6)(o.sign_out_begin_time,"yyyy-MM-dd hh:mm:ss"):"",sign_out_end_time:o.sign_out_end_time?(0,b.p6)(o.sign_out_end_time,"yyyy-MM-dd hh:mm:ss"):"",source_type:o.source_type,remind_directors:o.remind_directors,advance_minute:o.advance_minute,user_has_attendanted:_?!1:o.user_has_attendanted,relate_course:o.relate_course,address:o.address,longitude:o.longitude,latitude:o.latitude,address_detail:o.address_detail,sign_range:o.sign_range}};function X(o){return Object.prototype.toString.call(o)==="[object Object]"}function $(o){return o.replace(/[A-Z]/g,_=>"_".concat(_.toLowerCase()))}function K(o){if(!X(o))return o;for(var _={},k=Object.keys(o),h=0,l=k;h<l.length;h++){var a=l[h],e=o[a];a=$(a),_[a]=X(e)?K(e):e}return _}var z=o=>{var _=K(o),k=_.id,h=_.name,l=_.requirement,a=_.resource_id,e=_.is_self_evaluate,t=_.is_lock,y=_.begin_time_unlock,S=_.end_time_unlock,r=_.questionnaire_id,i=_.evaluate_form_title,m=_.before_start_day,d=_.before_start_repeat,Z=_.before_start_un_remind,V=_.before_end_day,W=_.before_end_repeat,F=_.before_end_un_remind,pe=_.after_end_day,oe=_.after_end_repeat,le=_.after_end_un_remind,_e=_.is_passed_standards,Ce=_.is_passed_option_three,he=_.pass_standard_conditions,ie=_.pass_standards_number,ye=_.creator_user;return{id:k,name:h,requirement:l,resource_id:a,is_lock:t,begin_time_unlock:y,end_time_unlock:S,is_self_evaluate:e,questionnaire_id:r,evaluate_form_title:i,before_start_day:m,before_start_repeat:d,before_start_un_remind:Z,before_end_day:V,before_end_repeat:W,before_end_un_remind:F,after_end_day:pe,after_end_repeat:oe,after_end_un_remind:le,is_passed_standards:_e,is_passed_option_three:Ce,pass_standard_conditions:he,pass_standards_number:ie,creator_user:ye}},J=o=>({courseId:o.course_id,duration:o.duration,teacherName:o.live_lesson.teacher_name,startTime:o.live_lesson.live_start_time,endTime:o.live_lesson.live_end_time})},11449:function(Ee,ne,n){"use strict";n.d(ne,{Z:function(){return X}});var U=n(88986),s=n(33565),H=n(12924),g=n.n(H),ae=n(3115),L=n(49111),j=n(19650),b=n(62029),c=n(57663),u=n(71577),T=n(91768),A=n(28216),E=n(37055),v=n(10237);function P($){var K=E.ZP.getHelpContentByMenuKey(),z={key:$};return v.WY.get({url:K,params:z})}var I=n(74228),Q=n.n(I),ce=n(1164),re=n(76466),R=n(38642);class N extends g().Component{constructor(K){var z;super(K);z=this,this.getHelpContentByMenuKey=()=>{var J=this.props.defaultMenuKey;P(J).then(o=>{var _=o.data,k=_.help_url,h=_.video_url;this.setState({videoUrl:h,helpUrl:k})})},this.handleOpenHelpUrl=J=>{if((0,R.ve)()){window.open(J,"_blank");return}ce.Z.targetTo({path:J,isExternalLink:!0})},this.handleOpenVideo=function(J){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:z.props.t("helpCenter.video");z.setState(_=>({resourcePlayInfo:(0,U.Z)((0,U.Z)({},_.resourcePlayInfo),{},{resourceInfo:{originUrl:J,source:{FD:J,OD:J},contentType:"mp4"}}),previewInfo:(0,U.Z)((0,U.Z)({},_.previewInfo),{},{title:o,visible:!0,onCancel:z.handleCancelPreview})}))},this.handleCancelPreview=()=>{var J=this.state.previewInfo;this.setState({resourcePlayInfo:{mode:"preview",watchType:"video",resourceInfo:{}},previewInfo:(0,U.Z)((0,U.Z)({},J),{},{visible:!1})})},this.state={helpUrl:"",videoUrl:"",resourcePlayInfo:{autoPlay:!0,draggable:!0,mode:"preview",resourceInfo:{},watchType:"video"},previewInfo:{visible:!1,destroyOnClose:!0,title:K.t("helpCenter.video")||"\u89C6\u9891\u6307\u5BFC",onCancel:()=>{}}}}componentDidMount(){this.getHelpContentByMenuKey()}render(){var K=this.state,z=K.helpUrl,J=K.resourcePlayInfo,o=K.previewInfo,_=K.videoUrl,k=this.props.t;return g().createElement("div",{className:Q().helpCenter},_&&g().createElement(u.Z,{type:"link",className:Q()["video-btn"],style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenVideo(_)},k("helpCenter.video")),z&&g().createElement(u.Z,{type:"link",style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenHelpUrl(z)},k("helpCenter.tutorial")),g().createElement(re.Z,(0,b.Z)({},J,{previewInfo:o})))}}var te=$=>({defaultMenuKey:$.currentRoute.menuKey});N.defaultProps={defaultMenuKey:""};var O=(0,A.$j)(te)((0,T.Z)()(N));function B($){var K=$.extra,z=localStorage.getItem("dingPersonnel"),J=sessionStorage.getItem("dingPersonnel");return g().createElement(j.Z,null,K,z!=="dingPersonnel"&&J!=="dingPersonnel"&&(0,R.eY)("COMMONEXTRA_HELP_CENTER")&&g().createElement(O,null))}var D=B,ue=n(4408);function me($){var K=(0,H.useState)({helpCenter:(0,R.eY)("HEAD_HELP_CENTER_BUT")}),z=(0,s.Z)(K,1),J=z[0],o=$.pageContainerParams,_=o===void 0?{}:o,k=$.noPadding,h=k===void 0?!1:k,l=$.isPersonal,a=l===void 0?!1:l,e=$.pageTitle,t=$.className,y=t===void 0?"":t,S={extra:J.helpCenter?g().createElement(D,{extra:_.extra}):_.extra},r=(0,U.Z)((0,U.Z)({},_),S);return g().createElement("div",{className:"page-container-content ".concat(h?"page-container-noPadding":""," ").concat(a?"page-container-content_personal_background":""," ").concat(y)},e&&g().createElement(ue.Z,{title:e}),a?g().createElement(ae.Z,null,$.children):g().createElement(ae.Z,r,$.children))}var X=me},21063:function(Ee,ne,n){"use strict";var U=n(62029),s=n(63185),H=n(9676),g=n(57663),ae=n(71577),L=n(49111),j=n(19650),b=n(22385),c=n(31097),u=n(88983),T=n(47933),A=n(88986),E=n(12924),v=n.n(E),P=n(91768),I=n(28216),Q=n(96486),ce=n.n(Q),re=n(80991),R=n(68628),N=n(49101),te=n(57119),O=n(43859),B=n(37055),D=n(10237),ue=n(84874),me=n(88311),X=n(8908),$=n(60667),K=n(26885),z=_=>{var k=_.advancedSetting,h=_.user;return{user:h,themeColor:k.themeColor}},J=()=>{};class o extends v().Component{constructor(k){var h;super(k);h=this,this.getUserManageRange=()=>{var l=B.ZP.Role.getUserManageRange();D.WY.get({url:l}).then(function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=a.data,t=e===void 0?{}:e,y=t.range_type;h.setState({userManageType:y})})},this.handleChange=l=>{var a=l.target.value;this.setState({rangeType:a}),this.triggerChange({rangeType:a,rangeList:this.state.rangeList})},this.triggerChange=l=>{var a=l.rangeType,e=l.rangeList,t=this.props,y=t.isPkGroupSetting,S=t.onPkGroupOk;if(y){S({rangeType:a,rangeList:e});return}var r=this.props.from,i={rangeType:a,rangeList:e},m=localStorage.getItem("authorityType"),d=this.props.user.loginMode;r!=="employees"&&d==="WE_COM"&&m==="1"&&(i.qyWeChatVo=this.state.qyWeChatVo),r!=="employees"&&d==="WE_COM"&&m==="0"&&(i.qyWeChatVo=JSON.stringify({userList:e.user,departmentList:e.dept})),this.props.formik.setFieldValue("employeeRange",i)},this.handleOk=l=>{this.setRangeList(l)},this.setRangeList=l=>{var a=l.dept,e=l.group,t=l.post,y=l.user,S={dept:a,post:t,group:e,user:y};this.setState({rangeList:S,visible:!1}),this.triggerChange({rangeType:this.state.rangeType,rangeList:S})},this.importModalVisibility=function(l){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:J;h.setState({importVisible:l,rangeType:2},()=>{a()})},this.handleImportOk=l=>{var a=this.state.rangeList,e=a.user,t=e===void 0?[]:e,y=[...l,...t],S=(0,Q.uniqBy)(y,"id");this.setState({rangeList:(0,A.Z)((0,A.Z)({},a),{},{user:S})},()=>{this.triggerChange({rangeType:this.state.rangeType,rangeList:this.state.rangeList}),this.importModalVisibility(!1)})},this.handleImportCancel=()=>{this.importModalVisibility(!1)},this.handleCancel=()=>{this.setOrgModalVisibility(!1)},this.handleDeleteItem=l=>{var a=(0,A.Z)({},this.state.rangeList),e,t;for(var y in a)if(e=a[y].findIndex(r=>r.id===l),e>-1){t=y;break}var S=[...a[t]];S.splice(e,1),a[t]=S,this.setState({rangeList:a}),this.triggerChange({rangeType:this.state.rangeType,rangeList:a})},this.handleSelectWx=()=>{var l=this.props.user,a=this.state.rangeList.user.map(e=>e.unionid||e.user_id||e.userId);(0,K.Sk)({userIds:a}).then(e=>{(0,K.$f)({result:e,user:l}).then(t=>{var y=t.qyWeChatVo,S=t.rangeList;this.setState({qyWeChatVo:y},()=>{this.handleOk(S)})})}).catch(()=>{this.handleCancel()})},this.setOrgModalVisibility=function(l){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:J,e=localStorage.getItem("authorityType"),t=h.props.user.loginMode,y=h.props.from;y!=="employees"&&l&&h.props.qwTicketShow&&t==="WE_COM"&&e==="1"?(h.handleSelectWx(),h.setState({rangeType:2})):h.setState({visible:l,rangeType:2},()=>{a()})},this.renderRadioGroup=()=>{var l=this.props,a=l.prefixCls,e=l.t,t=l.showSectitle,y=l.secTitle,S=y===void 0?e("common.assignRange"):y,r=l.secTitleInfoTip,i=r===void 0?"":r;return t?v().createElement("div",{className:"".concat(a,"__radios")},v().createElement("div",{className:"cl-form__sectitle"},S,i&&v().createElement("span",{className:"cl-form__sectitle__infotip"},i),this.renderRadios())):this.renderRadios()},this.handleVisibleType=l=>{var a=this.state.rangeType,e=l.target.value;this.setState({visibleType:e,rangeType:e==="follow"?0:a||3},()=>{this.triggerChange({rangeType:e==="follow"?0:a||3,rangeList:this.state.rangeList})})},this.renderRadios=()=>{var l=this.props,a=l.mode,e=l.t,t=l.prefixCls,y=l.rangeAuth,S=l.disabledAdd,r=l.themeColor,i=l.onlyDept,m=l.rangeType,d=l.handleStudentList,Z=l.isShowPkStudentList,V=this.props.partLabel,W=V===void 0?e("common.deptAndStu"):V,F=this.state,pe=F.resourceViewRange,oe=F.visibleType,le=F.userManageType,_e=!!(m&&m!==2);return S?null:v().createElement("div",{className:"visible-range-setting"},a.includes("follow")&&v().createElement(T.ZP.Group,{name:"visibleType",value:oe,onChange:this.handleVisibleType},v().createElement(T.ZP,{value:"follow"},e("course.followClassify")),v().createElement(T.ZP,{value:"define"},e("course.customRange"))),(this.state.rangeType>0||a.length===1||!a.includes("follow"))&&v().createElement("div",{className:"custom-range-setting"},v().createElement(T.ZP.Group,{name:"rangeGroup",value:this.state.rangeType,disabled:this.props.disabled,onChange:this.handleChange},a.includes("all")&&v().createElement(T.ZP,{value:1,disabled:le!=="all"},e("common.allCompany"),y&&pe&&v().createElement(c.Z,{title:e("setting.selectPeopleTip")},v().createElement("span",null,v().createElement(R.Z,null)))),a.includes("under")&&v().createElement(T.ZP,{value:4},v().createElement(j.Z,null,e("setting.jurisdictionAndSubordinate"),v().createElement(c.Z,{title:e("setting.underTip")},v().createElement("span",null,v().createElement(R.Z,null))))),a.includes("private")&&v().createElement(T.ZP,{value:3},e("common.onlySelf")),a.includes("part")&&a.length>1&&v().createElement(T.ZP,{value:2},W),v().createElement(j.Z,null,!i&&v().createElement(ae.Z,{className:"qa-assign-employee-selector",style:_e?{}:{color:r,border:"1px solid ".concat(r)},icon:v().createElement(N.Z,null),disabled:_e,onClick:()=>this.importModalVisibility(!0)},e("component.importPerson")),v().createElement(ae.Z,{style:_e?{}:{color:r,border:"1px solid ".concat(r)},className:"".concat(t,"__addbtn qa-assign-employee-selector"),icon:v().createElement(N.Z,null),disabled:_e,onClick:()=>this.setOrgModalVisibility(!0)},e("common.select")),Z?v().createElement(ae.Z,{style:_e?{}:{color:r,border:"1px solid ".concat(r)},onClick:d,disabled:_e},e("pk.viewStudents")):""))))},this.renderGallery=()=>{var l=this.props.prefixCls,a=this.state.rangeType;return a!==2?null:v().createElement("div",{className:"".concat(l,"__gallery")},this.renderGropuGallery(),this.renderUserGallery())},this.renderGropuGallery=()=>{var l=this.props,a=l.prefixCls,e=l.t,t=this.state.rangeList,y=t.dept,S=t.group,r=t.post,i=[...y,...S,...r];return i.length?v().createElement("div",{className:"".concat(a,"__gallery__row cl-clearfix")},v().createElement("span",{className:"".concat(a,"__gallery__row__title")},e("common.selectedGroups"),"\uFF1A"),v().createElement("div",{className:"".concat(a,"__gallery__row__container cl-clearfix")},i.map(m=>this.renderGalleryItem(m,"dept")))):null},this.renderUserGallery=()=>{var l=this.props,a=l.prefixCls,e=l.t,t=this.state.rangeList.user,y=[...t];return y.length?v().createElement("div",{className:"".concat(a,"__gallery__row cl-clearfix")},v().createElement("span",{className:"".concat(a,"__gallery__row__title")},e("common.selectedUsers"),"\uFF1A"),v().createElement("div",{className:"".concat(a,"__gallery__row__container cl-clearfix")},y.map(S=>this.renderGalleryItem(S,"user")))):null},this.renderGalleryItem=(l,a)=>{var e=this.props,t=e.prefixCls,y=e.disabled,S=e.qwTicketShow,r=e.from,i="".concat(t,"__gallery__row__item"),m=this.props.user.loginMode,d=localStorage.getItem("authorityType"),Z=r!=="employees"&&S&&d==="1"?l.unionid||l.userId||l.user_id||l.id:l.unionid||l.user_id,V=l.source_type||l.sourceType,W={user:"userName",dept:"departmentName"}[a]||"",F={user:Z,dept:l.id}[a]||l.id;return v().createElement("span",{className:i,key:l.id},v().createElement($.Z,{dataType:W,value:F,name:l.name,type:V}),y||r!=="employees"&&d==="1"&&S&&m==="WE_COM"?null:v().createElement("span",{className:"item-icon",onClick:()=>this.handleDeleteItem(l.id)},v().createElement(ue.Z,{iconClass:"icon-guanbi",size:"12px"})))},this.state={rangeType:k.defaultFieldList.rangeType,rangeList:k.defaultFieldList.rangeList||{},visible:!1,visibleType:k.defaultFieldList.rangeType===0?"follow":"define",userManageType:"all",importVisible:!1,qyWeChatVo:""}}componentDidMount(){this.getUserManageRange()}renderTransfer(){var k=y=>{this.props.formik.setFieldValue("open_transfer_student",y.target.checked)},h=this.props,l=h.prefixCls,a=h.t,e=h.formik.values.open_transfer_student,t=e===void 0?!1:e;return v().createElement("div",{className:"".concat(l,"__transfer")},v().createElement(H.Z,{onChange:k,checked:t},a("course.transferJoin")),v().createElement(c.Z,{title:a("course.transferJoin")},v().createElement(te.Z,null)))}render(){var k=this.props,h=k.prefixCls,l=k.orgProps,a=k.onlyDept,e=a===void 0?!1:a,t=k.onlyPost,y=t===void 0?!1:t,S=k.onlyChooseDept,r=S===void 0?!1:S,i=k.t,m=k.isAssignRange,d=k.noBorder,Z=k.transferVisible,V=Z===void 0?!1:Z,W=this.state,F=W.rangeList,pe=W.visible,oe=W.importVisible;return v().createElement("div",{className:d?"":"visible-range-out"},d?null:v().createElement("div",{className:"visible-range-out-title"},i(m?"common.assignRange":"learning.learnUpgrade.visibleRange")),v().createElement("div",{className:"visible-range-out-inner".concat(d?"-no":"")},v().createElement("section",{className:"".concat(h)},this.renderRadioGroup(),this.renderGallery(),v().createElement(me.Z,(0,U.Z)({},l,{visible:pe,initData:F,displayType:r?["dept"]:e&&y?["dept","post"]:["dept","group","post"],onlyDept:e,onlyPost:y,onOk:this.handleOk,onCancel:this.handleCancel})),v().createElement(X.Z,{visible:oe,onOk:this.handleImportOk,onCancel:this.handleImportCancel})),V&&v().createElement("section",{className:"".concat(h)},this.renderTransfer())))}}o.defaultProps={prefixCls:"cl-employee-selector",showSectitle:!0,mode:["all","part"],orgProps:{},resourceViewRange:!1},ne.Z=(0,I.$j)(z)((0,re.$j)((0,O.Z)((0,P.Z)()(o))))},16084:function(Ee,ne,n){"use strict";var U=n(77883),s=n(21888),H=n(63185),g=n(9676),ae=n(12924),L=n.n(ae),j=n(91768),b=n(28216),c=n(80991),u=n(38642),T=n(43859);class A extends L().Component{constructor(){super(...arguments);this.state={blackList:{JobEvaluationBut:(0,u.eY)("MANAGEMENT_JOBEVALUATION_BUT")}},this.checkProgress=P=>{var I=P.target.checked,Q=this.props.value;Q.progress.isChecked=I,this.props.onFieldChange(Q)},this.inputProgress=P=>{var I=this.props.value;I.progress.progress=P,this.props.onFieldChange(I)},this.checkExam=P=>{var I=P.target.checked,Q=this.props.value;Q.exam.isChecked=I,this.props.onFieldChange(Q)},this.inputTimes=P=>{var I=this.props.value;I.exam.times=P,this.props.onFieldChange(I)},this.checkOperation=P=>{var I=P.target.checked,Q=this.props.value;Q.operation.isChecked=I,this.props.onFieldChange(Q)},this.inputOperationTimes=P=>{var I=this.props.value;I.operation.times=P,this.props.onFieldChange(I)},this.checkJobEvaluation=P=>{var I=P.target.checked,Q=this.props.value;Q.jobEvaluation.isChecked=I,this.props.onFieldChange(Q)}}UNSAFE_componentWillReceiveProps(P){if(this.props.jobEvaluationCount!==P.jobEvaluationCount&&P.jobEvaluationCount>0){var I=P.value;I.jobEvaluation.isChecked=!0,P.onFieldChange(I)}}render(){var P=this.props,I=P.value,Q=P.examCount,ce=P.courseCount,re=P.operationCount,R=P.isPreview,N=P.t,te=P.shouldRenderedOperationCount,O=P.jobEvaluationCount,B=P.completeJobEvaluation,D=P.qyShield,ue=I.progress,me=I.exam,X=I.operation,$=I.jobEvaluation,K=this.state.blackList;return L().createElement("div",{className:"qualified-standard"},L().createElement("div",{className:"qualified-standard-title"},N("learning.learningAddSecPassTitle"),L().createElement("span",{className:"qualified-standard-sub"},N("learning.learningAddSecPassTitleTip"))),L().createElement("div",{className:"qualified-standard-item"},L().createElement(g.Z,{disabled:ce<1||R,className:"qualified-standard-checkbox",checked:ce<1?!1:ue.isChecked,onChange:this.checkProgress},N("learning.learningAddProgressRequire")),L().createElement(s.Z,{value:ue.progress,disabled:!ue.isChecked||ce<1||R,onChange:this.inputProgress,className:"qualified-standard-number",min:1,max:100,precision:0}),L().createElement("span",{className:"qualified-standard-tip"},N("learning.learningAddProgressRequireTip"))),L().createElement("div",{className:"qualified-standard-item"},L().createElement(g.Z,{className:"qualified-standard-checkbox",disabled:Q<1||R,checked:Q<1?!1:me.isChecked,onChange:this.checkExam},N("learning.learningAddPassRequire")),L().createElement(s.Z,{value:me.times,disabled:!me.isChecked||Q<1||R,className:"qualified-standard-number",onChange:this.inputTimes,min:1,max:Q>0?Q:999,precision:0}),L().createElement("span",{className:"qualified-standard-tip"},N("learning.learningAddPassRequireTip"))),te&&L().createElement("div",{className:"qualified-standard-item"},L().createElement(g.Z,{className:"qualified-standard-checkbox",disabled:re<1||R,checked:re<1?!1:X.isChecked,onChange:this.checkOperation},N("learning.learningAddOperationRequire")),L().createElement(s.Z,{value:X.times,disabled:!X.isChecked||re<1||R,className:"qualified-standard-number",onChange:this.inputOperationTimes,min:1,max:re>0?re:999,precision:0}),L().createElement("span",{className:"qualified-standard-tip"},N("learning.learningAddOperationRequireTip"))),K.JobEvaluationBut&&B&&D==="false"&&L().createElement("div",{className:"qualified-standard-item"},L().createElement(g.Z,{className:"qualified-standard-checkbox",disabled:O<1||R,checked:O>0?$.isChecked:!1,onChange:this.checkJobEvaluation},N("learning.completeJobEvaluation"))))}}var E=v=>{var P=v.user;return{user:P,qyShield:P.qyShield}};ne.Z=(0,b.$j)(E)((0,T.Z)((0,c.$j)((0,j.Z)()(A))))},69069:function(Ee,ne,n){"use strict";var U=n(77883),s=n(21888),H=n(57663),g=n(71577),ae=n(47673),L=n(4107),j=n(63185),b=n(9676),c=n(12924),u=n.n(c),T=n(91768),A=n(28216),E=n(80991),v=n(49101),P=n(43859),I=n(93117),Q=n(10237),ce=n(37055),re=N=>({qyShield:N.user.qyShield});class R extends u().Component{constructor(te){super(te);this.getScoreRule=()=>{var O=ce.ZP.EditStudyTask.getScoreRule(),B=this.props.value;Q.WY.get({url:O}).then(D=>{if(D.data.data.hasRule){var ue=D.data.data.studyScore,me=ue[0],X=me.finishScore,$=me.unFinishScore;B.score.reward=X,B.score.deduction=$,this.props.onFieldChange(B)}})},this.handleSelectCertificate=()=>{var O=this.state.certificateConfig,B=this.props.value;O.visible=!0,O.defaultChecked=[{id:B.certificate.id,name:B.certificate.name}],this.setState({certificateConfig:O})},this.cancelSelectCertificate=()=>{var O=this.state.certificateConfig;O.visible=!1,this.setState({certificateConfig:O})},this.sureSelectCertificate=O=>{this.cancelSelectCertificate();var B=this.props.value;B.certificate.id=O[0].id,B.certificate.name=O[0].name,this.props.onFieldChange(B)},this.checkScoreReward=O=>{var B=O.target.checked,D=this.props.value;D.score.isCheckedReward=B,this.props.onFieldChange(D)},this.checkScoreDeduction=O=>{var B=O.target.checked,D=this.props.value;D.score.isCheckedDeduction=B,this.props.onFieldChange(D)},this.checkCerti=O=>{var B=O.target.checked,D=this.props.value;D.certificate.isChecked=B,this.props.onFieldChange(D)},this.inputReward=O=>{var B=this.props.value;B.score.reward=O,this.props.onFieldChange(B)},this.inputDeduction=O=>{var B=this.props.value;B.score.deduction=O,this.props.onFieldChange(B)},this.state={certificateConfig:{visible:!1,defaultChecked:[],onCancel:this.cancelSelectCertificate,onOk:this.sureSelectCertificate}}}componentDidMount(){var te=this.props.value;!te.score.isCheckedReward&&!te.score.isCheckedDeduction&&this.getScoreRule()}render(){var te=this.state.certificateConfig,O=this.props,B=O.value,D=O.isPreview,ue=O.tipType,me=ue===void 0?"":ue,X=O.t,$=O.formik,K=$.errors,z=$.touched,J=B.certificate,o=B.score;return u().createElement("div",{className:"study-reward task"},u().createElement("div",{className:"study-reward-title"},X("learning.learningAddSecRewardTitle"),u().createElement("span",{className:"study-reward-sub"},X("learning.learningAddSecRewardTitleTip"))),u().createElement("div",{className:"study-reward-item"},u().createElement(b.Z,{className:"study-reward-checkbox",disabled:D,checked:J.isChecked,onChange:this.checkCerti},X("learning.learningAddRewardCert")),u().createElement(L.Z,{value:J.name,disabled:!0,className:z.reward&&K.reward&&K.reward.certificateChecked?"status-error study-reward-number":"study-reward-number"}),u().createElement(g.Z,{type:"link",icon:u().createElement(v.Z,null),disabled:!J.isChecked||D,onClick:this.handleSelectCertificate},X("learning.learningAddRewardCertSelect"))),u().createElement("div",{className:"study-reward-item"},u().createElement(b.Z,{className:"study-reward-checkbox",checked:o.isCheckedReward,disabled:D,onChange:this.checkScoreReward},X("learning.learningAddRewardPassScore")),u().createElement(s.Z,{value:o.reward,disabled:!o.isCheckedReward||D,onChange:this.inputReward,min:0,max:999,precision:0,className:z.reward&&K.reward&&K.reward.scoreRewardChecked?"status-error":""}),u().createElement("span",{className:"study-reward-tip"},X(me==="project"?"learning.learningAddRewardPassScoreProjectTip":"learning.learningAddRewardPassScoreTip"))),u().createElement("div",{className:"study-reward-item"},u().createElement(b.Z,{className:"study-reward-checkbox",disabled:D,checked:o.isCheckedDeduction,onChange:this.checkScoreDeduction},X("learning.learningAddRewardunPassScore")),u().createElement(s.Z,{value:o.deduction,disabled:!o.isCheckedDeduction||D,onChange:this.inputDeduction,min:0,max:999,precision:0,className:z.reward&&K.reward&&K.reward.scoreDeductionChecked?"status-error":""}),u().createElement("span",{className:"study-reward-tip"},X(me==="project"?"learning.learningAddRewardunPassScoreProjectTip":"learning.learningAddRewardunPassScoreTip"))),z.reward&&K.reward&&u().createElement("span",{style:{paddingLeft:"16px"},className:"tip_error_msg"},K.reward.msg),u().createElement(I.Z,te))}}ne.Z=(0,P.Z)((0,E.$j)((0,A.$j)(re)((0,T.Z)()(R))))},44659:function(Ee,ne,n){"use strict";var U=n(77576),s=n(59314),H=n(22385),g=n(31097),ae=n(77883),L=n(21888),j=n(63185),b=n(9676),c=n(12924),u=n.n(c),T=n(28216),A=n(91768),E=n(17780),v=n(43859),P=n(16239),I=n(84874),Q=n(38642);class ce extends u().Component{constructor(){super(...arguments);this.state={blackList:{jobEvaluationSwitch:(0,Q.eY)("STUDYTIME_JOBEVALUATION_SWITCH"),faceKnowTipFlag:(0,Q.eY)("STUDYTIMELIMT_EXAM_FACE_KNOW")},whiteList:{faceVideoSourceFlag:(0,Q.UI)("STUDYTIMELIMT_VIDEO_FACE_KNOW")}},this.renderText=()=>{var R=this.props.t;return u().createElement("div",null,u().createElement("p",{className:"title"},R("course.documentStudyLimitTip1")),u().createElement("p",{className:"title"},R("course.documentStudyLimitTip2")))},this.handleCheck=R=>{var N=R.target.checked,te=this.props.value;te.isChecked=N,this.props.onFieldChange(te)},this.handleInput=R=>{var N=this.props.value;N.limit=R,this.props.onFieldChange(N)},this.handleSwitch=R=>{var N=this.props.value;N.faceRecognition=R,this.props.onFieldChange(N)},this.handleMediaSwitch=R=>{var N=this.props.value;N.videoFaceRecognition=R,this.props.onFieldChange(N)},this.handleJobSwitch=R=>{var N=this.props.value;N.jobEvaluationResults=R,this.props.onFieldChange(N)}}render(){var R=this.props,N=R.value,te=R.isPreview,O=R.t,B=R.appType,D=R.isShowJobInput,ue=R.jobEvaluationCount,me=R.componentType,X=R.isEdit,$=R.qyShield,K=this.state,z=K.blackList,J=K.whiteList;return u().createElement("div",{className:"study-time-limit"},u().createElement("div",{className:"study-time-limit-title"},O("learning.learningAddSecSetTitle"),u().createElement("span",{className:"study-time-limit-sub"},O("learning.learningAddSecSetTitleTip"))),u().createElement("div",{className:"study-time-limit-input"},u().createElement(b.Z,{checked:N.isChecked,onChange:this.handleCheck,disabled:te||X,className:N.isChecked?"study-time-limit-checked":""},O("learning.learningAddSecSetTitleInfo")),u().createElement(L.Z,{size:"middle",value:N.limit,disabled:!N.isChecked||te,onChange:this.handleInput,className:"study-time-limit-number",min:1,max:9999,precision:0}),u().createElement("span",{className:"study-time-limit-standard"}),O("course.secByPage"),u().createElement(g.Z,{placement:"top",title:this.renderText},u().createElement("span",null,u().createElement(I.Z,{iconClass:"icon-f-tipe"}))),N.isChecked?null:u().createElement("span",{className:"study-time-limit-tip"},O("course.documentStudyLimitTip"))),z.jobEvaluationSwitch&&D&&$==="false"&&u().createElement("div",{className:"study-time-limit-jobInput"},ue<1?u().createElement(s.Z,{defaultChecked:!1,checked:!1,disabled:!0,id:1}):u().createElement(s.Z,{checked:N.jobEvaluationResults,onChange:this.handleJobSwitch,disabled:te,id:2}),u().createElement("span",{className:"item-margin"}," ",O("learning.openJobEvaluationResults")," "),u().createElement("span",{className:"study-time-limit-tip"},O("learning.jobEvaluationResultsTip"))),(0,E.xX)()||B==="wx_app"||B==="fs_app"||!P.Z[(0,P.c)()].showCl||me==="authentication"||!z.faceKnowTipFlag?null:u().createElement("div",{className:"study-time-limit-input"},u().createElement(s.Z,{defaultChecked:N.faceRecognition,onChange:this.handleSwitch,disabled:te}),u().createElement("span",{className:"item-margin"}," ",O("exam.faceKnow")," "),u().createElement("span",{className:"study-time-limit-tip"},O("exam.faceKnowTip"))),J.faceVideoSourceFlag?u().createElement("div",{className:"study-time-limit-input"},u().createElement(s.Z,{defaultChecked:N.videoFaceRecognition,onChange:this.handleMediaSwitch,disabled:te}),u().createElement("span",{className:"item-margin"}," ",O("exam.faceVideoSource")," "),u().createElement("span",{className:"study-time-limit-tip"},O("exam.faceVideoSourceTip"))):null)}}ne.Z=(0,T.$j)(re=>({appType:re.user.appType,themeColor:re.advancedSetting.themeColor,qyShield:re.user.qyShield}))((0,v.Z)((0,A.Z)()(ce)))},82224:function(Ee,ne,n){"use strict";var U=n(22385),s=n(31097),H=n(63185),g=n(9676),ae=n(88986),L=n(12924),j=n.n(L),b=n(91768),c=n(80991),u=n(84387);class T extends j().Component{constructor(E){super(E);this.handleChangeSubDept=v=>{var P=v.target.checked;this.props.formik.setFieldValue("target",(0,ae.Z)((0,ae.Z)({},this.props.defaultFieldList),{},{checkedSubDept:P}))},this.handleChangeNewEmployee=v=>{var P=v.target.checked;this.props.formik.setFieldValue("target",(0,ae.Z)((0,ae.Z)({},this.props.defaultFieldList),{},{checkedNewEmployee:P}))},this.state={visible:!1}}render(){var E=this.props,v=E.defaultFieldList,P=E.isPreview,I=E.t;return j().createElement("section",null,j().createElement("div",{className:"cl-form__secbox__content"},j().createElement(g.Z,{checked:v.checkedSubDept,onChange:this.handleChangeSubDept,disabled:P},I("learning.learningEmployeeAddSecAssignmentLabel")),j().createElement(s.Z,{title:I("learning.learningEmployeeAddSecAssignmentTip")},j().createElement(u.Z,null)),j().createElement(g.Z,{checked:v.checkedNewEmployee,onChange:this.handleChangeNewEmployee,disabled:P},I("learning.learningEmployeeAddSecOtherAssignmentLabel")),j().createElement(s.Z,{title:I("learning.learningEmployeeAddSecOtherAssignmentTip")},j().createElement(u.Z,null))))}}T.defaultProps={prefixCls:"employee-target-formitem"},ne.Z=(0,c.$j)((0,b.Z)()(T))},2881:function(Ee,ne,n){"use strict";var U=n(77883),s=n(21888),H=n(12924),g=n.n(H),ae=n(91768),L=n(80991),j=n(43859);class b extends g().Component{constructor(){super(...arguments);this.handleChange=u=>{this.props.formik.setFieldValue("term",{number:u})}}render(){var u=this.props.t;return g().createElement(g().Fragment,null,g().createElement(s.Z,{precision:0,min:1,max:9999,disabled:this.props.isPreview,value:this.props.defaultFieldList.number,onChange:this.handleChange}),g().createElement("span",{style:{marginLeft:"10px"}},u("learning.learningEmployeeAddTermUnit")),g().createElement("span",{className:"infotext"},u("learning.learningEmployeeAddTermTip")))}}ne.Z=(0,L.$j)((0,j.Z)((0,ae.Z)()(b)))},6998:function(Ee,ne,n){"use strict";var U=n(47673),s=n(4107),H=n(12924),g=n.n(H),ae=n(43859),L=n(80991),j=n(10237),b=n(37055);class c extends g().Component{constructor(){var T;super(...arguments);T=this,this.handleChange=A=>{var E=A.target.value;this.props.onChange(E)},this.handleBlur=()=>{var A=this.props.formType;switch(A){case"task":this.checkTaskName();break;case"project":this.checkProjectName();break;case"employee":this.checkTaskName(2);break;default:break}},this.checkTaskName=function(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,E=b.ZP.EditStudyTask.checkTaskTitle(),v=T.props,P=v.value,I=v.formik,Q=v.t,ce={edit:A,trainName:P};j.WY.get({url:E,params:ce}).then(re=>{re.data.code!==0&&(I.setFieldError("title",Q("learning.learningAddTitleRepeatTip")),I.setFieldTouched("title",!0,!1))})},this.checkProjectName=()=>{var A=b.ZP.EditStudyProject.checkProjectName(),E=this.props,v=E.value,P=E.formik,I=E.t,Q={title:v};j.WY.post({url:A,data:Q}).then(ce=>{ce.data.checked!=="true"&&(P.setFieldError("title",I("learning.learningAddTitleRepeatTip")),P.setFieldTouched("title",!0,!1))}).catch(ce=>{ce.response.data.code==="enterpriseapi.542001"&&(P.setFieldError("title",I("learning.learningAddTitleRepeatTip")),P.setFieldTouched("title",!0,!1))})}}render(){var T=this.props,A=T.value,E=T.isPreview,v=T.placeholder;return g().createElement(s.Z,{style:{width:"350px"},value:A,disabled:E,placeholder:v,onChange:this.handleChange})}}ne.Z=(0,ae.Z)((0,L.$j)(c))},40767:function(Ee,ne,n){"use strict";n.d(ne,{g:function(){return U},c:function(){return s}});var U={labelCol:{xs:{span:24},sm:{span:3}},wrapperCol:{xs:{span:24},sm:{span:21}}},s={labelCol:{xs:{span:24},sm:{span:3}},wrapperCol:{xs:{span:24},sm:{span:20}}}},89135:function(Ee,ne,n){"use strict";var U=n(88986),s=n(78138),H=n.n(s),g=n(6793),ae=n(2396),L=n(3407),j=(0,g.me)(),b=L.Z[j].learning.validation;ne.Z={multiText:c=>{var u;return(0,ae.$s)((0,g.fy)(c))>256&&(u=b.multiTextTip),u},title:c=>((0,g.fy)(c)?"":b.learningAddItemTitleNull)||((0,g.fy)(c).length>60?b.learningAddItemTitleLimit:""),dateRange:(c,u,T)=>{var A;if((!c.startTime||!c.endTime)&&(A=b.learningAddItemDateRangeNull),!T){var E="YYYY-MM-DD HH:mm";u.forEach(v=>{(H()(H()(v.data.dateRange.startTime).format(E)).valueOf()<(0,g.jZ)(H()(c.startTime).format(E))||H()(H()(v.data.dateRange.startTime).format("YYYY-MM-DD HH:mm")).valueOf()>(0,g.jZ)(H()(c.endTime).format(E))||H()(H()(v.data.dateRange.endTime).format(E)).valueOf()<=(0,g.jZ)(H()(c.startTime).format(E))||H()(H()(v.data.dateRange.endTime).format(E)).valueOf()>(0,g.jZ)(H()(c.endTime).format(E)))&&(A=b.learningAddItemDateRangeOnsite)})}return A},qualifiedStandardExceptWork:(c,u,T)=>{var A;return c&&(T===0&&u===0||!c.progress.isChecked&&!c.exam.isChecked||T===0&&!c.exam.isChecked)&&(A=b.learningAddItemPass),A},qualifiedStandardInOperation:(c,u,T,A,E)=>{var v;return c&&(T===0&&u===0&&A===0&&E===0||!c.progress.isChecked&&!c.exam.isChecked&&!c.operation.isChecked&&c.jobEvaluation&&!c.jobEvaluation.isChecked)&&(v=b.learningAddItemPass),v},checkStandardInOperation:(c,u,T,A)=>{var E;return c&&(T===0&&u===0&&A===0||!c.progress.isChecked&&!c.exam.isChecked&&!c.operation.isChecked||c.progress.isChecked&&!c.progress.progress||u!==0&&c.exam.isChecked&&!c.exam.times||A!==0&&c.operation.isChecked&&!c.operation.times)&&(E=b.learningAddItemPass),E},qualifiedStandard:(c,u,T,A,E)=>{var v;return c&&(T===0&&u===0&&A===0&&E===0||!c.progress.isChecked&&!c.exam.isChecked&&!c.operation.isChecked&&!c.jobEvaluation.isChecked||c.progress.isChecked&&!c.progress.progress||u!==0&&!c.exam.isChecked||u!==0&&c.exam.isChecked&&!c.exam.times||A!==0&&!c.operation.isChecked||A!==0&&c.operation.isChecked&&!c.operation.times)&&(v=b.learningAddItemPass),v},reward:c=>{var u={};return(!c||c.certificate.isChecked&&!c.certificate.id)&&(u=(0,U.Z)((0,U.Z)({},u),{},{certificateChecked:!0,msg:b.learningAddItemRewardCert})),c.score.isCheckedDeduction&&!c.score.deduction&&(u=(0,U.Z)((0,U.Z)({},u),{},{scoreDeductionChecked:!0,msg:b.learningAddItemRewardunPass})),c.score.isCheckedReward&&!c.score.reward&&(u=(0,U.Z)((0,U.Z)({},u),{},{scoreRewardChecked:!0,msg:b.learningAddItemRewardPass})),Object.keys(u).length?u:""},checkTerm:c=>{var u=c.number,T;return(!ae.fA.positiveInteger.test(u)||u<1||u>100)&&(T=b.learningAddItemTerm),T},studyLimit:c=>{var u;return c.isChecked&&!c.limit?u=b.learningTimeTip:c.limit>9999&&(u=b.learningTimeBeyondTip),u},originPrice:c=>{var u;return parseFloat(c)===0?u=b.originalPriceTip:parseFloat(c)>99999&&(u=b.maxOriginPriceTip),u},discountPrice:(c,u)=>{var T;return c===""||parseFloat(c)===0?T=b.discountPriceTip:parseFloat(c)>99999?T=b.maxDiscountPriceTip:parseFloat(u)<=parseFloat(c)&&(T=b.diffPriceTip),T},registerRange:c=>{var u;return(!c.startTime||!c.endTime)&&(u=b.learningAddItemDateRangeNull),(0,g.jZ)(c.startTime)>=(0,g.jZ)(c.endTime)&&(u=b.learningAddItemDateRangeLimit),u},dateValidateCourse:(c,u)=>{var T;return(!c.startTime||!c.endTime)&&(T=b.learningAddItemDateRangeNull),(0,g.jZ)(c.startTime)>=(0,g.jZ)(c.endTime)&&(T=b.learningAddItemDateRangeLimit),(0,g.jZ)(c.startTime)<(0,g.jZ)(u.endTime)&&(T=b.learningCourseTime),T},inputValidateNumber:(c,u)=>{var T="";return(0,g.fy)(c)?(u&&Number(c)>=Number(u)&&(T=L.Z[j].learning.validation.priceLimit),Number(c)>99999&&(T=L.Z[j].validation.maxNum99999),Number(c)<.01&&(T=L.Z[j].validation.minNum),T):(T=L.Z[j].validation.pleaseEnter,T)},applyTip:c=>{var u;return c.isNeedApply==="need"&&c.enrollAudit==="automatic_audit"&&c.enrollLimit&&c.limitCount===""&&(u=b.applyPeopleTip),u},taskPrice:c=>{var u=c.price,T=c.isPaid,A;return T&&(u===""||parseFloat(u)===0?A=b.taskPriceTip:parseFloat(u)>99999&&(A=b.maxPriceTip)),A}}},99218:function(Ee,ne,n){"use strict";n.r(ne),n.d(ne,{default:function(){return He}});var U=n(12924),s=n.n(U),H=n(13062),g=n(71230),ae=n(18106),L=n(88108),j=n(20136),b=n(55241),c=n(22385),u=n(31097),T=n(62029),A=n(89032),E=n(15746),v=n(57361),P=n(57663),I=n(71577),Q=n(34792),ce=n(48086),re=n(88986),R=n(9754),N=n.n(R),te=n(28216),O=n(91768),B=n(76651),D=n(80991),ue=n(57068),me=n(40847),X=n(6998),$=n(44659),K=n(69069),z=n(21063),J=n(16084),o=n(2881),_=n(82224),k=n(89135),h=n(40767),l=n(41222),a=n(71153),e=n(60331),t=n(17780),y=n(84874),S=n(6793),r=n(56130),i=n(60667),m=ge=>({opearateStage:ge.employee.opearateStage});class d extends s().Component{constructor(q){super(q);this.digui=ee=>{for(var C=0;C<ee.length;C++){if(ee[C].id===this.props.previewInfo.classify){this.classifyName=ee[C].label;return}ee[C].children&&this.digui(ee[C].children)}},this.renderPreview=()=>{var ee=this.props,C=ee.opearateStage,p=ee.t,f=ee.previewInfo;if(C==="1")return s().createElement("div",{className:"stage-preview-content"},s().createElement("div",{className:"stage-preview-content-top"},p("learning.learnUpgrade.bascInfo")),s().createElement(g.Z,{className:"stage-preview-content-row"},s().createElement(E.Z,{className:"stage-preview-content-row-label"},p("exam.taskName"),"\uFF1A"),s().createElement(E.Z,{className:"stage-preview-content-row-con"},f.title)),s().createElement(g.Z,{className:"stage-preview-content-row"},s().createElement(E.Z,{className:"stage-preview-content-row-label"},p("learning.learningEmployeeAddTerm"),"\uFF1A"),s().createElement(E.Z,{className:"stage-preview-content-row-con"},f.term.number)),s().createElement(g.Z,{className:"stage-preview-content-row"},s().createElement(E.Z,{className:"stage-preview-content-row-label"},p("learning.learningEmployeeAddValidity"),"\uFF1A"),s().createElement(E.Z,{className:"stage-preview-content-row-con"},(0,S.p6)(f.datePicker,"yyyy-MM-dd hh:mm"))),s().createElement(g.Z,{className:"stage-preview-content-row"},s().createElement(E.Z,{className:"stage-preview-content-row-label"},p("learning.learningProjectAddCategory"),"\uFF1A"),s().createElement(E.Z,{className:"stage-preview-content-row-con"},this.classifyName)),s().createElement(g.Z,{className:"stage-preview-content-row"},s().createElement(E.Z,{className:"stage-preview-content-row-label"},p("learning.taskSummary"),"\uFF1A"),s().createElement(E.Z,{className:"stage-preview-content-row-con"},f.summary)));if(C==="2")return s().createElement("div",{className:"stage-preview-content"},s().createElement("div",{className:"stage-preview-content-top"},p("learning.learnUpgrade.studyContent")),f.stages.map((M,x)=>s().createElement("div",{className:"stage-preview-content-steps",key:M.key},s().createElement("div",{className:"stage-preview-content-steps-head"},p("formItem.stageTaskPanelTitle"),x+1,"\uFF1A ",M.name),s().createElement("div",{className:"stage-preview-content-steps-body"},s().createElement("div",{className:"stage-preview-content-steps-body-title"},p("learning.learnUpgrade.studyContent")),s().createElement("div",{className:"stage-preview-content-steps-body-inner"},M.list.map(w=>s().createElement(g.Z,{align:"top",key:w.id,className:"stage-preview-content-steps-body-resource"},s().createElement(E.Z,{className:"stage-preview-content-steps-body-resource-icon"},s().createElement(y.Z,{iconClass:w.icon})),s().createElement(E.Z,{flex:"1",className:"stage-preview-content-steps-body-resource-info"},w.name))))))));if(C==="3")return s().createElement("div",{className:"stage-preview-content"},s().createElement("div",{className:"stage-preview-content-top"},p("learning.learnUpgrade.setUp")),s().createElement(g.Z,{className:"stage-preview-content-row"},s().createElement(E.Z,{className:"stage-preview-content-row-label stage-preview-content-row-large"},p("course.documentLearningTime"),"\uFF1A"),s().createElement(E.Z,{className:"stage-preview-content-row-con"},f.studyLimit.isChecked?f.studyLimit.limit+p("course.secByPage"):p("common.none"))),!(0,t.xX)()&&s().createElement(g.Z,{className:"stage-preview-content-row"},s().createElement(E.Z,{className:"stage-preview-content-row-label stage-preview-content-row-large"},p("exam.faceKnow"),"\uFF1A"),s().createElement(E.Z,{className:"stage-preview-content-row-con"},f.studyLimit.faceRecognition?p("learning.learnUpgrade.open"):p("learning.learnUpgrade.close"))),s().createElement(g.Z,{className:"stage-preview-content-row"},s().createElement(E.Z,{className:"stage-preview-content-row-label stage-preview-content-row-large"},p("learning.learningAddProgressRequire"),"\uFF1A"),s().createElement(E.Z,{className:"stage-preview-content-row-con"},f.qualifiedStandard.progress.isChecked?"".concat(f.qualifiedStandard.progress.progress,"%"):p("common.none"))),s().createElement(g.Z,{className:"stage-preview-content-row"},s().createElement(E.Z,{className:"stage-preview-content-row-label stage-preview-content-row-large"},p("learning.learningAddPassRequire"),"\uFF1A"),s().createElement(E.Z,{className:"stage-preview-content-row-con"},f.qualifiedStandard.exam.isChecked?f.qualifiedStandard.exam.times:p("common.none"))),s().createElement(g.Z,{className:"stage-preview-content-row"},s().createElement(E.Z,{className:"stage-preview-content-row-label stage-preview-content-row-large"},p("learning.learningAddOperationRequire"),"\uFF1A"),s().createElement(E.Z,{className:"stage-preview-content-row-con"},f.qualifiedStandard.operation.isChecked?f.qualifiedStandard.operation.times:p("common.none"))),s().createElement(g.Z,{className:"stage-preview-content-row"},s().createElement(E.Z,{className:"stage-preview-content-row-label stage-preview-content-row-large"},p("learning.learningAddRewardCert"),"\uFF1A"),s().createElement(E.Z,{className:"stage-preview-content-row-con"},f.reward.certificate.isChecked?f.reward.certificate.name:p("common.none"))),s().createElement(g.Z,{className:"stage-preview-content-row"},s().createElement(E.Z,{className:"stage-preview-content-row-label stage-preview-content-row-large"},p("learning.learningAddRewardPassScore"),"\uFF1A"),s().createElement(E.Z,{className:"stage-preview-content-row-con"},f.reward.score.isCheckedReward?f.reward.score.reward:p("common.none"))),s().createElement(g.Z,{className:"stage-preview-content-row"},s().createElement(E.Z,{className:"stage-preview-content-row-label stage-preview-content-row-large"},p("learning.learningAddRewardunPassScore"),"\uFF1A"),s().createElement(E.Z,{className:"stage-preview-content-row-con"},f.reward.score.isCheckedDeduction?f.reward.score.deduction:p("common.none"))),s().createElement(g.Z,{className:"stage-preview-content-row"},s().createElement(E.Z,{className:"stage-preview-content-row-label stage-preview-content-row-large"},p("learning.learningEmployeeAddSecAssignment"),"\uFF1A"),s().createElement(E.Z,{className:"stage-preview-content-row-con"},this.renderRange(f.employeeRange))),s().createElement(g.Z,{className:"stage-preview-content-row"},s().createElement(E.Z,{className:"stage-preview-content-row-label stage-preview-content-row-large"},p("learning.learnUpgrade.coordinator"),"\uFF1A"),s().createElement(E.Z,{className:"stage-preview-content-row-con"},f.supervisor.supervisorUserList.map((M,x)=>s().createElement(e.Z,{key:"supervisorUserList".concat(x)},s().createElement(i.Z,{dataType:"userName",value:M.unionid||M.user_id,name:M.name,type:M.source_type||M.sourceType}))))))},this.renderRange=ee=>{var C=this.props.t,p=ee.rangeType,f=ee.rangeList;if(p===1)return C("common.allCompany");if(p===3)return C("common.onlySelf");if(p===2){var M=[...f.dept,...f.group,...f.post];return s().createElement(U.Fragment,null,s().createElement("div",{className:"stage-preview-content-row-con-tags"},s().createElement("sapn",null,C("common.selectedGroups")," : "),M.length?M.map((x,w)=>s().createElement(e.Z,{key:"tag".concat(w)},s().createElement(i.Z,{dataType:"departmentName",value:x.id,name:x.name,type:x.source_type||x.sourceType}))):C("common.none")))}},this.classifyName=""}componentDidMount(){var q=this.props.dispatch;q({type:"employee/updateOpearateStage",opearateStage:"1"}),this.digui(this.props.classify)}render(){var q=this.props.t;return s().createElement("div",{className:"stage-preview"},s().createElement("div",{className:"stage-preview-title"},q("component.preview")),this.renderPreview())}}var Z=(0,te.$j)(m)((0,r.Z)((0,O.Z)()(d)));class V extends s().Component{componentDidUpdate(q){var ee=q.formik,C=ee.isSubmitting,p=ee.isValidating,f=ee.errors,M=Object.keys(f);M.length>0&&C&&!p&&(q.showError(f),W(M[0]))}render(){return null}}var W=ge=>{var q='[class*="$$CL-FORM-ERROR__'.concat(ge,'"]'),ee=document.querySelector(q);ee&&ee.scrollIntoView()},F=(0,D.$j)(V);F.scrollTo=W;var pe=F,oe=n(70075),le=n(86726),_e=n(53009),Ce=n(52670),he=n(62615),ie=n(11449),ye=n(37055),Oe=n(10237),qe=n(4408),Qe=n(38642),$e=n(84717),Je=ge=>({documentStudyLimit:ge.advancedSetting.documentStudyLimit,opearateStage:ge.employee.opearateStage,settingStep:ge.employee.settingStep,employeeId:ge.employee.employeeId,nowStage:ge.employee.nowStage,preview:ge.employee.preview,user:ge.user});class We extends s().Component{constructor(q){var ee;super(q);ee=this,this.getTaskInfo=()=>{var C=ue.parse(B.m8.location.search),p=C.editTaskId,f=ye.ZP.EmployeeEdit.getTaskInfo(),M={id:this.state.pageParams.editTaskId||p};Oe.WY.get({url:f,params:M}).then(x=>{var w=x.data,de=w.supervisorId?w.supervisorId.split(","):[],se=this.props.user.loginMode;if(se==="WE_COM"&&w.supervisor_list)de=w.supervisor_list.map(fe=>(0,re.Z)((0,re.Z)({},fe),{},{type:2,show:!0}));else{var G=w.supervisorUserName.split(",");de=de.map((fe,we)=>({type:2,id:fe,name:G[we],show:!0}))}this.changeStage("2"),this.changeNowStage(w.savedStep===3?"3":"2");var ve={title:w.trainName,term:{number:w.trainLimit},createUserId:w.createUser,datePicker:(0,S.k7)(w.effectTime),summary:w.summary,classify:w.classify_id,classifyName:w.classify_name,syncProgress:w.syncProgress,stages:(0,_e.aI)(w.stageList),employeeRange:{rangeType:!w.departmentList||!w.departmentList.length?"":w.departmentList[0].id==="1"?1:2,rangeList:{dept:w.departmentList||[],post:w.postList||[],group:w.groupList||[],user:w.userList||[]}},studyLimit:{isChecked:w.studyTimeLimit!=0,limit:w.studyTimeLimit!=0?w.studyTimeLimit:1,faceRecognition:w.faceRecognition==="on"},qualifiedStandard:{progress:{isChecked:w.progress!==0,progress:w.progress!==0?w.progress:100},exam:{isChecked:w.times!==0,times:w.times!==0?w.times:1},operation:{isChecked:w.operationTimes!==0,times:w.operationTimes!==0?w.operationTimes:1}},reward:{certificate:{isChecked:w.certificateId!==0,id:w.certificateId!==0?w.certificateId:"",name:w.certificateId!==0?w.certificateName:""},score:{isCheckedReward:!!(w.planStudyScore&&w.planStudyScore.finishScore),reward:w.planStudyScore&&w.planStudyScore.finishScore?w.planStudyScore.finishScore:0,isCheckedDeduction:!!(w.planStudyScore&&w.planStudyScore.unFinishScore),deduction:w.planStudyScore&&w.planStudyScore.unFinishScore?w.planStudyScore.unFinishScore:0}},target:{checkedSubDept:w.overrideSubDept===1,checkedNewEmployee:w.newEmployee},supervisor:{supervisorUserList:de,isChecked:w.supervisorPaper},stagePass:w.stagePass};this.setState({requested:!0,initialValues:ve})})},this.initRef=C=>{this.formRef=C},this.saveData=(C,p)=>{var f=C.values,M=C.actions,x=C.save_step,w=this.props,de=w.t,se=w.opearateStage,G=w.nowStage,ve=w.preview,fe=this.state,we=fe.addPlanId,Ae=fe.pageParams,Me=fe.saveUrl,Ne=Ae.editTaskId,Y=Ae.editPlanId,ke=ve==="true"?Me.settings:Me[x],ze=f.title,Xe=f.summary,Le=f.datePicker,De=f.stages,Re=f.studyLimit,Te=f.qualifiedStandard,Pe=f.reward,be=f.supervisor,et=f.term,Ke=f.target,Ie=f.employeeRange,tt=f.stagePass,at=f.classify,nt=f.syncProgress,st=(0,l.Qz)(De),Ze=(0,l.z2)(De),Fe=(0,l.GM)(De),Be=Y||we,xe;if(se==="1"&&ve==="false"){var rt=Le instanceof Object?Le.valueOf():Date.parse(Le.replace(/\-/g,"/"));xe={plan_id:Be,train_name:(0,S.fy)(ze),train_limit:et.number,summary:Xe,classify_id:at,effect_time:rt}}if(se==="2"&&ve==="false"&&(xe={plan_id:Be,stage_json:(0,_e.$S)(De),stage_pass:tt,sync_progress:nt}),se==="3"||ve==="true"){var Ue="",je=localStorage.getItem("authorityType"),it=this.props.user.loginMode;it==="WE_COM"&&!be.qyWeChatVo&&(je==="0"?Ue=JSON.stringify({userList:be.supervisorUserList,departmentList:[]}):je==="1"&&(Ue=JSON.stringify({userList:be.supervisorUserList,selectedUserCount:1,selectedTicket:"0"}))),xe={plan_id:Be,save_step:3,override_sub_dept:Ke.checkedSubDept?1:0,is_new_employee:Ke.checkedNewEmployee,department_ids:Ie.rangeType===1?"1":Ie.rangeList.dept.map(Se=>Se.id).join(","),post_ids:Ie.rangeType===1?"":Ie.rangeList.post.map(Se=>Se.id).join(","),study_time_limit:Re.isChecked?Re.limit:0,face_recognition:Re.faceRecognition===!0?"on":"off",progress:st>0&&Te.progress.isChecked?Te.progress.progress:0,times:Ze>0&&Te.exam.isChecked?Te.exam.times>Ze?Ze:Te.exam.times:"",operation_times:Fe>0&&Te.operation.isChecked?Te.operation.times>Fe?Fe:Te.operation.times:"",certificate_id:Pe.certificate.isChecked?Pe.certificate.id:"",study_score:JSON.stringify({finishScore:Pe.score.isCheckedReward?Pe.score.reward:0,unFinishScore:Pe.score.isCheckedDeduction?Pe.score.deduction:0}),supervisor_id:be.supervisorUserList.map(Se=>Se.id).join(","),supervisor_paper:be.isChecked,is_get_score:!0,qy_we_chat_vo:Ie.qyWeChatVo,qy_we_supe_vo:be.qyWeChatVo||Ue}}Oe.WY.post({url:ke,data:xe}).then(Se=>{var Ve=Se.data;if(M&&M.setSubmitting(!1),Ve.code===0){if(p)return;se==="1"&&ve==="false"&&(this.setState({addPlanId:Ve.data}),this.changeStage("2"),(!Ne||Number(se)+1>G)&&G<=2&&this.changeNowStage("2")),se==="2"&&ve==="false"&&(this.changeStage("3"),(!Ne||Number(se)+1>G)&&this.changeNowStage("3")),(se==="3"||ve==="true")&&(ce.default.success(de(x==="settings"||ve==="true"?"common.releaseSuccess":"common.saveSuccess")),this.linkToList())}}).catch(()=>{M.setSubmitting(!1)})},this.submit=(C,p)=>{var f=this.props.opearateStage,M=this.state.settings;p.setSubmitting(!0),f==="1"?this.saveData({values:C,actions:p,save_step:"base_info"}):f==="2"?this.saveData({values:C,actions:p,save_step:M?"stage_content":"stage_content_draft"}):this.saveData({values:C,actions:p,save_step:"settings"})},this.handleCancelEdit=()=>{this.linkToList()},this.handleSaveDraft=()=>{var C=this.formRef.state.values,p=this.formRef;p.validateForm().then(f=>{JSON.stringify(f)==="{}"?this.saveData({values:C,actions:p,save_step:"settings_draft"}):this.dealError(f)})},this.linkToList=()=>{localStorage.getItem("dingPersonnel")==="dingPersonnel"&&this.changeStage("1"),B.m8.push("/training/learning/task/employee")},this.leftClick=C=>{var p=this.props,f=p.opearateStage,M=p.preview;M==="true"?this.changeStage(C):C<f?this.changeStage(C):this.leftValidateForm(C)},this.leftValidateForm=C=>{var p=this.props.opearateStage,f=this.state.settings;this.formRef.validateForm().then(M=>{if(Object.keys(M).length===0){var x;p==="1"?x="base_info":f?x=p==="2"?"stage_content":"settings":x=p==="2"?"stage_content_draft":"settings_draft",this.saveData({values:this.formRef.state.values,clickStep:C,save_step:x},!0),this.changeStage(C)}else this.dealNormalError(M)})},this.dealNormalError=C=>{for(var p in C)if(C[p]){this.formRef.setFieldTouched(p,!0);return}},this.changeStage=C=>{var p=this.props.dispatch;p({type:"employee/updateOpearateStage",opearateStage:C})},this.handleChangeStep=C=>{var p=this.props.dispatch;p({type:"employee/updateSettingStep",settingStep:C})},this.handleLike=(0,S.E5)((C,p)=>{this.submit(C,p)},500),this.changeNowStage=C=>{var p=this.props.dispatch;p({type:"employee/updateNowStage",nowStage:C})},this.changePreview=C=>{var p=this.props.dispatch;p({type:"employee/updatePreview",preview:C})},this.handlePreview=()=>{this.formRef.validateForm().then(C=>{Object.keys(C).length===0?this.setState({previewInfo:this.formRef.state.values},()=>this.changePreview("true")):this.dealError(C)})},this.dealError=C=>{var p=this.state.position;for(var f in C)if(C[f]){this.handleChangeStep(p[f]||"1"),this.formRef.setFieldTouched(f,!0);return}},this.changeQualifiedStandard=C=>{var p=this.state.initialValues,f=!1,M=!1,x=!1;C.forEach(w=>{w.list.forEach(de=>{de.type==="ex"&&(f=!0),de.type==="sc"&&(M=!0),(de.componentName==="CoursewareSelector"||de.componentName==="CourseSelector"||de.type==="course"||de.type==="courseware")&&(x=!0)})}),f||(p.qualifiedStandard.exam.isChecked=!1),M||(p.qualifiedStandard.operation.isChecked=!1),x||(p.qualifiedStandard.progress.isChecked=!1),this.setState({initialValues:p})},this.renderButton=C=>{var p=this.props,f=p.isPreview,M=p.t,x=p.opearateStage,w=p.preview;return s().createElement("div",{className:"cl-form-footer-button"},f?null:s().createElement(I.Z,{className:"form-page-container-bottom-btn",loading:C.isSubmitting,type:"primary",htmlType:"submit"},M(x==="3"||w==="true"?"common.release":"learning.learnUpgrade.saveAndNext")),x==="3"&&w!=="true"?s().createElement(I.Z,{className:"form-page-container-bottom-btn",onClick:this.handleSaveDraft},M("common.draft")):null,w==="true"?s().createElement(U.Fragment,null,s().createElement(I.Z,{className:"form-page-container-bottom-btn",onClick:()=>{this.changePreview("false"),this.changeStage("3")}},M("common.return"))):s().createElement(U.Fragment,null,x==="3"&&s().createElement(I.Z,{className:"form-page-container-bottom-btn",onClick:this.handlePreview},M("component.preview")),s().createElement(I.Z,{className:"form-page-container-bottom-btn",onClick:this.handleCancelEdit},M("common.cancel"))))},this.getTotalHour=C=>{var p=0,f="--";return C&&C.forEach(M=>{M.list.forEach(x=>{x.duration&&(x.type==="course"||(x.originalType==="mp4"||x.originalType==="mp3")&&x.status===3||x.type==="ex")&&(p+=Number(x.duration))})}),p<60&&p>0?f="".concat(p,"\u79D2"):p>60&&(f="".concat(Math.ceil(p/60),"\u5206\u949F")),f},this.tip=()=>s().createElement("div",null,s().createElement("p",null,this.props.t("courseManage.estimatedStandard")),s().createElement("p",null,this.props.t("courseManage.estimatedStandard1")),s().createElement("p",null,this.props.t("courseManage.estimatedStandard2")),s().createElement("p",null,this.props.t("courseManage.estimatedStandard3")),s().createElement("p",null,this.props.t("courseManage.estimatedStandard4"))),this.getVersionStatus=(0,v.Z)(N().mark(function C(){var p,f;return N().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,(0,$e.UE)();case 2:p=x.sent,f=p.data,f.code===2e5&&ee.setState({isFree:f.data.isFree==="true"});case 5:case"end":return x.stop()}},C)})),this.getResourceType=C=>{var p=this.state.isFree,f=C.resourceType?["courseware","course","exam"]:["courseware","course","exam","practice","tutor","imageTextCourse","investigate"],M=new Set(["imageTextCourse","investigate","practice","tutor"]);return p&&(f=f.filter(x=>!M.has(x))),f},this.checkTerm=C=>{var p=this.props.t,f,M=C.number;return(!/^[1-9]\d*$/.test(M)||M<1||M>9999)&&(f=p("learning.validation.trainingPeriodVerify")),f},this.state={allowActions:(0,le.V9)("classify",JSON.parse(localStorage.getItem("modules"))),pageParams:{type:"add",departmentId:"",departmentName:"",editTaskId:"",planId:""},requested:!1,opearateStageList:[{key:"1",name:q.t("learning.learnUpgrade.bascInfo")},{key:"2",name:q.t("learning.learnUpgrade.studyContent")},{key:"3",name:q.t("learning.learnUpgrade.setUp")}],position:{studyLimit:"1",qualifiedStandard:"1",reward:"1",employeeRange:"2",supervisor:"3"},previewInfo:{},saveUrl:{base_info:ye.ZP.EmployeeEdit.saveBaseInfo(),stage_content:ye.ZP.EmployeeEdit.saveStageContent(),stage_content_draft:ye.ZP.EmployeeEdit.saveStageContent(),settings_draft:ye.ZP.EmployeeEdit.saveSettingsDraft(),settings:ye.ZP.EmployeeEdit.saveSetting()},initialValues:{departmentName:"",title:"",term:{number:1},datePicker:"",summary:"",syncProgress:"false",classify:"",createUserId:"",stages:[{key:"".concat(new Date().getTime()),name:"".concat(this.props.t("formItem.stageTaskPanelTitle"),"1"),desc:"",list:[],inOrder:!1}],studyLimit:{isChecked:this.props.documentStudyLimit!="0",limit:this.props.documentStudyLimit=="0"?"1":this.props.documentStudyLimit,faceRecognition:!!this.props.faceRecognition},qualifiedStandard:{progress:{isChecked:!0,progress:100},exam:{isChecked:!1,times:1},operation:{isChecked:!1,times:1}},reward:{certificate:{isChecked:!1,id:"",name:""},score:{isCheckedReward:!1,isCheckedDeduction:!1,reward:0,deduction:0}},target:{checkedSubDept:!0,checkedNewEmployee:!1},employeeRange:{rangeType:"",rangeList:{dept:[],post:[],group:[],user:[]}},supervisor:{supervisorUserList:[],isChecked:!0},stagePass:!1},whiteList:{resourceType:(0,Qe.UI)("EMPLOYEE_STEP_RESOURCE_TYPE"),qualifiedStandard:(0,Qe.UI)("EMPLOYEE_STEP_QUALIFIEDSTANDARD")},isFree:!1}}componentDidMount(){this.getVersionStatus(),this.clearStateSetting().then(()=>{this.addOrUpdate()})}clearStateSetting(){var q=this.props.dispatch;return q({type:"employee/resetSettings"})}addOrUpdate(){var q=ue.parse(B.m8.location.search),ee=q.editTaskId,C=q.type,p=C===void 0?"add":C,f=q.departmentId,M=q.departmentName,x=q.planId;p==="edit"?this.setState({pageParams:{type:p,departmentId:f,departmentName:M,editTaskId:ee,editPlanId:x}},this.getTaskInfo()):this.setState({pageParams:{type:p,departmentId:f,departmentName:M,editTaskId:ee,addPlanId:x}},()=>{this.setState({requested:!0})})}render(){var q=this.state,ee=q.requested,C=q.pageParams,p=q.opearateStageList,f=q.previewInfo,M=q.initialValues,x=q.allowActions,w=q.whiteList,de=this.props,se=de.isPreview,G=de.t,ve=de.nowStage,fe=de.opearateStage,we=de.preview,Ae=de.settingStep,Me=se?"".concat(G("common.preview")).concat(G("learning.learningEmployeeAddTitle")):C.editTaskId?"".concat(G("common.edit")).concat(G("learning.learningEmployeeAddTitle")):"".concat(G("common.editnew")),Ne=C.editTaskId?s().createElement("div",null,s().createElement("p",null,G("study.studyContentChangeTip")),s().createElement("p",null,G("study.studyContentChangeTip1")),s().createElement("p",null,G("study.studyContentChangeTip2")),s().createElement("p",null,G("study.studyContentChangeTip3"))):null;return s().createElement(ie.Z,{pageContainerParams:{header:{title:G("leftMenuLists.studyNeoed")}}},s().createElement(qe.Z,{title:Me}),s().createElement("div",{className:"employeetask-edit"},s().createElement("div",{className:"form-page-container"},s().createElement(g.Z,{className:"form-page-container-row",justify:"space-between"},s().createElement(E.Z,{className:"form-page-aside form-page-left"},s().createElement("h1",{className:"form-page-left-title"},Me),s().createElement("div",{className:"form-page-left-step"},p.map(Y=>s().createElement("div",{onClick:()=>{Y.key<=ve&&Y.key!==fe&&this.leftClick(Y.key)},key:Y.key,className:fe===Y.key?"form-page-left-step-item form-page-left-step-active":Y.key<=ve?"form-page-left-step-item form-page-left-step-success":"form-page-left-step-item form-page-left-step-noallow"},s().createElement("div",{className:"form-page-left-step-item-number"},Y.key),s().createElement("div",{className:"form-page-left-step-item-name"},Y.name))))),s().createElement(E.Z,{className:"form-page-aside form-page-right"},ee?s().createElement(D.J9,{ref:this.initRef,initialValues:M,onSubmit:this.handleLike,render:Y=>s().createElement(D.l0,{className:"cl-form"},fe==="1"&&we==="false"&&s().createElement(U.Fragment,null,s().createElement("div",{className:"cl-form__sectitle"},G("learning.basicInformation")),s().createElement("div",{className:"form-page-bg"},s().createElement(D.gN,(0,T.Z)({name:"title",label:G("exam.taskName"),required:!0,defaultValue:Y.values.title,validate:ke=>k.Z.title(ke),component:X.Z,isPreview:se,formType:"employee",placeholder:G("learning.learningEmployeeAddNamePlaceholder")},h.g)),s().createElement(D.gN,(0,T.Z)({component:o.Z,displayType:"Custom",name:"term",label:G("learning.learningEmployeeAddTerm"),required:!0,defaultFieldList:Y.values.term,validate:this.checkTerm,isPreview:se},h.g)),s().createElement(D.gN,(0,T.Z)({component:he.Mt,name:"datePicker",displayType:"Custom",label:G("learning.learningEmployeeAddValidity"),required:!0,defaultFieldList:Y.values.datePicker,validate:Ce.Pe,isPreview:se},h.g)),s().createElement(D.gN,(0,T.Z)({name:"classify",label:G("learning.learningProjectAddCategoryer"),displayType:"Custom",defaultValue:Y.values.classify,classifyName:Y.values.classifyName,component:he.O,unclassified:!0,showAdd:(0,le.H3)("add",x)},h.g)),s().createElement(D.gN,(0,T.Z)({name:"summary",label:G("learning.taskSummary"),component:oe.Z,rows:5,placeholder:G("learning.validation.contentLimitTip"),style:{width:"550px"},LimitLength:1e3,char:!0,type:"text"},h.g)))),fe==="2"&&we==="false"&&s().createElement(U.Fragment,null,s().createElement("div",{className:"cl-form__sectitle"},G("learning.learnUpgrade.studyContent"),C.editTaskId?s().createElement(u.Z,{placement:"right",title:Ne},s().createElement("span",null,s().createElement(y.Z,{iconClass:"icon-f-tipe",color:"#9C9C9F"}))):null),s().createElement("div",{className:"form-page-bg"},s().createElement(D.gN,{component:he.Vi,displayType:"Custom",from:"employees",name:"stages",isHasTutor:!0,required:!0,validate:Ce.NW,isPreview:se,resourceType:this.getResourceType(w),defaultFieldList:Y.values.stages,courseSelectorFilterQuota:!0,showChangeBtn:!0,deleteModal:!!C.editTaskId,onChangeQualifiedStandard:ke=>this.changeQualifiedStandard(ke),anonymousMarking:!0,multipleMissedScore:!0,taskType:"1"}),s().createElement(D.gN,{component:he._e,name:"stagePass",isPreview:se}),s().createElement(D.gN,{component:he.Pk,name:"syncProgress",isPreview:se}),s().createElement("div",{className:"estimated-hour"},this.props.t("courseManage.estimatedHours"),"\uFF1A",this.getTotalHour(Y.values.stages),s().createElement(b.Z,{placement:"top",content:()=>this.tip()},s().createElement(me.Z,{className:"estimated-icon"}))))),fe==="3"&&we==="false"&&s().createElement(U.Fragment,null,s().createElement(L.Z,{activeKey:Ae,onChange:this.handleChangeStep,className:"cl-form-tabs"},s().createElement(L.Z.TabPane,{tab:G("learning.learnUpgrade.learnToSet"),key:"1"},s().createElement(D.gN,{component:$.Z,displayType:"Custom",name:"studyLimit",isPreview:se,validate:ke=>k.Z.studyLimit(ke),isEdit:C.editTaskId}),s().createElement(D.gN,{component:J.Z,displayType:"Custom",examCount:(0,l.z2)(Y.values.stages),courseCount:(0,l.Qz)(Y.values.stages),operationCount:(0,l.GM)(Y.values.stages),name:"qualifiedStandard",shouldRenderedOperationCount:!0,isPreview:se,validate:ke=>k.Z.checkStandardInOperation(ke,(0,l.z2)(Y.values.stages),(0,l.Qz)(Y.values.stages),(0,l.GM)(Y.values.stages))}),s().createElement(D.gN,{component:K.Z,displayType:"Custom",name:"reward",validate:k.Z.reward,isPreview:se,customError:!0})),s().createElement(L.Z.TabPane,{tab:G("learning.learningEmployeeAddSecAssignment1"),key:"2",forceRender:!0},s().createElement(D.gN,{component:z.Z,displayType:"Custom",name:"employeeRange",from:"employees",mode:["all","part"],label:"",onlyDept:!0,onlyPost:!0,partLabel:G("common.deptAndPost"),showSectitle:!1,qwTicketShow:!0,defaultFieldList:Y.values.employeeRange,validate:Ce.FI,disabled:se,isAssignRange:!0}),s().createElement(D.gN,(0,T.Z)({component:_.Z,displayType:"Custom",name:"target",required:!0,defaultFieldList:Y.values.target,isPreview:se},h.g))),s().createElement(L.Z.TabPane,{tab:G("learning.learnUpgrade.collaborate"),key:"3",forceRender:!0},s().createElement(D.gN,{component:he.i0,displayType:"Custom",name:"supervisor",disabled:se,defaultFieldList:Y.values.supervisor,createUserId:Y.values.createUserId,qwTicketShow:!0})))),we==="true"&&s().createElement(Z,{previewInfo:f}),s().createElement(pe,{showError:this.dealError}),this.renderButton(Y))}):null)))))}}We.defaultProps={isPreview:!1};var Ge=(0,te.$j)(Je)((0,O.Z)()(We));class Ye extends s().Component{render(){return s().createElement(Ge,{isPreview:!1})}}var He=Ye}}]);
