(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[6600],{30311:function(xe,re,e){"use strict";var se=e(22385),J=e(31097),Y=e(12924),a=e.n(Y),N=e(8812),F=e(28216),L=C=>{var R=(0,F.v9)(m=>{var Z=m.advancedSetting;return{themeColor:Z.themeColor}}),z=R.themeColor;return a().createElement(J.Z,{placement:"top",title:C.name},a().createElement("span",{className:"cl-table__cell-arrow",onClick:C.onClick},a().createElement("span",{style:{color:z}},C.name),a().createElement("span",{className:"cl-table__cell-arrow-icon"},a().createElement(N.Z,null))))};re.Z=L},30389:function(xe,re,e){"use strict";e.d(re,{Z:function(){return D}});var se=e(62029),J=e(20228),Y=e(11382),a=e(12924),N=e.n(a),F=e(91768),L=e(80991),C={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},R=e(62615),z=e(52670);class m extends N().Component{render(){var c=this.props,s=c.values,g=c.mode,i=c.onlyChooseDept,r=c.reserveUser,T=c.t,v=c.orgProps,S=c.rangeAuth,E=c.projectId,B=c.onCancel,Q=c.onlyCreateUser;return N().createElement(L.l0,{className:"cl-form"},N().createElement(L.gN,(0,se.Z)({component:R.ww,displayType:"Custom",showSectitle:!1,name:"employeeRange",label:T("common.visibleRange"),defaultFieldList:s.employeeRange,validate:z.FI,mode:g,rangeAuth:S,onlyChooseDept:i,onlyCreateUser:Q,orgProps:v,reserveUser:r,projectId:E,onCancel:B,qwTicketShow:!0},C)))}}var Z=(0,F.Z)()(m),x=e(18329),b=e(34773);class _ extends N().Component{constructor(){super(...arguments);this.initRefFormik=c=>{this.refFormik=c},this.handleBeforeCreate=()=>{var c=this.refFormik;c.submitForm(),c.runValidations().then(s=>{if(!Object.keys(s).length){var g=c.state.values.employeeRange,i=(0,b.b)(g.rangeList),r={qyWeChatVo:g.qyWeChatVo,id:this.props.actionId,isAll:g.rangeType,groupIds:g.rangeType===2?i.groupIds.join(","):"",departmentIds:g.rangeType===2?i.deptIds.join(","):"",userIds:g.rangeType===2?i.userIds.join(","):"",postIds:g.rangeType===2?i.postIds.join(","):"",clusterIds:g.rangeType===2?i.clusterIds.join(","):"",qy_we_chat_vo:g.qyWeChatVo};this.props.onCreate(r)}})},this.handleBeforeCancel=()=>{var c=this.props.onCancel;c()}}render(){var c=this.props,s=c.visible,g=c.initialParams,i=c.isLoading,r=c.tipInfo,T=c.mode,v=c.onlyChooseDept,S=c.reserveUser,E=S===void 0?[]:S,B=c.t,Q=c.title,y=c.orgProps,w=c.rangeAuth,A=c.projectId,M=c.onCancel,H=c.onlyCreateUser,ee=c.size;return i?N().createElement(Y.Z,{size:"large"}):N().createElement(x.ZP,{wrapClassName:"cl-employee-selector-modal",visible:s,title:Q||B("component.changeUser"),okText:B("common.ok"),cancelText:B("common.cancel"),size:ee,onCancel:this.handleBeforeCancel,onOk:this.handleBeforeCreate},i?N().createElement(Y.Z,{size:"large"}):N().createElement(L.J9,{ref:this.initRefFormik,initialValues:g,render:q=>N().createElement(Z,(0,se.Z)({},q,{mode:T,rangeAuth:w,orgProps:y,onlyChooseDept:v,onlyCreateUser:H,reserveUser:E,projectId:A,onCancel:M}))}),r&&N().createElement("p",{style:{padding:"0 24px",wordBreak:"break-all",whiteSpace:"normal"}},r))}}_.defaultProps={visible:!1,initialParams:{employeeRange:{rangeType:1,rangeList:{dept:[],post:[],group:[],user:[],cluster:[]}}},tipInfo:"",isLoading:!1,mode:["all","part"],onlyChooseDept:!1,onlyCreateUser:!1,orgProps:{},onCancel:()=>{},onCreate:()=>{},size:"middle"};var D=(0,F.Z)()(_)},74525:function(xe,re,e){"use strict";var se=e(57361),J=e(34792),Y=e(48086),a=e(9754),N=e.n(a),F=e(12924),L=e.n(F),C=e(91768),R=e(28216),z=e(92592),m=e(5430),Z=e(10237),x=e(84874),b=e(16239),_=e(38642),D=e(28963);class t extends L().Component{constructor(s){var g;super(s);g=this,this.appId=sessionStorage.getItem("CL_E_APP_ID"),this.miniAppId=sessionStorage.getItem("CL_MINI_APP_ID"),this.initCode=()=>{var i=this.props,r=i.type,T=i.isProjectShare,v=i.isCommodityExchange,S=i.userInfo;["wx","weixin"].includes(r)?r==="weixin"&&S.appId==="9005"?this.initOtherCode():this.initWXCode():T&&r==="ding"?this.getProjectShareUrl():v&&r==="ding"?this.getCommodityExchangeUrl():r==="fullWebLink"?this.initOtherCode(this.props.option.scene):this.initOtherCode()},this.getCommodityExchangeUrl=()=>{var i=this.props,r=i.t,T=i.appType,v=i.orderId,S=this.props.option.scene,E=localStorage.getItem("uid");if(!b.Z[(0,b.c)()].showCl||T!=="e_app"){var B={deliverUserId:E,orderId:v,flag:"exchange"};z.toDataURL(JSON.stringify(B),{width:500}).then(A=>{this.setState({img:A})}).catch(()=>{Y.default.error(r("integralMall.qrCodeFailed"))})}else{var Q="/pages/messageRedirect/messageRedirect?".concat(S),y=encodeURIComponent(Q),w="dingtalk://dingtalkclient/action/open_micro_app/=questionMark=/appId=".concat(this.appId,"&pVersion=1&miniAppId=").concat(this.miniAppId,"&packageType=1&page=").concat(y,"&corpId=").concat(this.props.userInfo.corpId);this.getShortLink(w).then(A=>{z.toDataURL(A.data.short_link,{width:500}).then(M=>{this.setState({img:M})}).catch(()=>{Y.default.error(r("integralMall.qrCodeFailed"))})})}},this.getProjectShareUrl=()=>{var i=this.props.option.scene,r=encodeURIComponent("/pages/messageRedirect/messageRedirect?".concat(i)),T="dingtalk://dingtalkclient/action/open_micro_app/=questionMark=/corpId=".concat(this.props.userInfo.corpId,"&appId=").concat(this.appId,"&miniAppId=").concat(this.miniAppId,"&page=").concat(r);this.getShortLink(T).then(v=>{this.initOtherCode(v.data.short_link)})},this.getShortLink=i=>Z.WY.post({url:m.ZP.Common.getQrUrl(),data:{link:i}}),this.initWXCode=(0,se.Z)(N().mark(function i(){var r,T,v,S;return N().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return r=g.props.option,T=r.scene,v=r.flag,B.next=3,Z.WY.post({url:m.ZP.createWxCode(),data:{flag:v,scene:"".concat(T,"&enterpriseId=").concat(m.ZP.enterpriseId),enterprise_id:m.ZP.enterpriseId}});case 3:S=B.sent,g.setState({img:S.data.wx_code,linkUrl:"data:image/png;base64,".concat(S.data.wx_code)});case 5:case"end":return B.stop()}},i)})),this.initOtherCode=function(){var i=(0,se.Z)(N().mark(function r(T){var v,S,E,B;return N().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(v=g.props,S=v.type,E=v.fsUrl,y.t0=T,y.t0){y.next=6;break}return y.next=5,g.handleScanCode();case 5:y.t0=y.sent;case 6:B=y.t0,S==="fs"&&E&&(B=E),g.setState({linkUrl:B}),z.toDataURL(B,{width:500}).then(w=>{g.setState({img:w})}).catch(()=>{Y.default.error(g.props.t("personal.failedGenerateCode"))});case 10:case"end":return y.stop()}},r)}));return function(r){return i.apply(this,arguments)}}(),this.handleScanCode=(0,se.Z)(N().mark(function i(){var r,T,v,S,E,B,Q,y,w,A,M,H,ee,q,u,U,k,G;return N().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:if(r=g.props,T=r.type,v=r.userInfo,S=r.universalFn,E=g.state.wxH5Url,B=g.props.option,Q=B.scene,y=B.pc_url,w=y===void 0?"":y,A=B.mobile_url,M=A===void 0?"":A,H=B.pc_type,ee=H===void 0?"":H,q=B.mobile_type,u=q===void 0?"":q,U=encodeURIComponent("/pages/messageRedirect/messageRedirect?"),k=encodeURIComponent(Q),!S){X.next=12;break}return X.next=8,g.getShortLink((0,_.jr)({pc_url:w,mobile_url:M,pc_type:ee,mobile_type:u}));case 8:return G=X.sent,X.abrupt("return",(0,D.fZ)(G.data.short_link));case 12:X.t0=T,X.next=X.t0==="app"?15:X.t0==="ding"?16:X.t0==="fs"?17:X.t0==="weixin"?18:19;break;case 15:return X.abrupt("return","".concat(Q,"&fromApp=true"));case 16:return X.abrupt("return","dingtalk://dingtalkclient/action/open_micro_app?corpId=".concat(v.corpId,"&appId=").concat(g.appId,"&miniAppId=").concat(g.miniAppId,"&packageType=1&pVersion=1&page=").concat(U+k));case 17:return X.abrupt("return","https://applink.feishu.cn/client/web_app/open?appId=".concat("cli_a0aa5e0fe5f8500d","&path=").concat(encodeURIComponent("/index.html"),"&").concat(Q,"&appType=lark"));case 18:return X.abrupt("return","".concat(E,"/#/pages/login/login-we-com/index?appType=weCom&corp=").concat(v.corpId,"&").concat(Q));case 19:return X.abrupt("return","");case 20:case"end":return X.stop()}},i)})),this.saveQrcode=()=>{var i=this.state.img,r=this.props,T=r.type,v=r.t,S=r.userInfo,E=document.createElement("a");E.download=v("setting.Qrcode")+new Date().getTime(),E.href=T==="wx"||T==="weixin"&&S.appId!=="9005"?"data:image/png;base64,".concat(i):i,document.body.appendChild(E),E.click(),document.body.removeChild(E)},this.generatePoster=i=>{var r=i.linkUrl,T=i.type,v=i.activeKey,S=i.option,E=this.props.universalFn;typeof E=="function"&&E({linkUrl:r,type:T,activeKey:v,option:S})},this.state={img:"",linkUrl:"",wxH5Url:"https://mobile.coolcollege.cn"}}componentDidMount(){this.initCode()}componentDidUpdate(s){s.option.scene!==this.props.option.scene&&this.initCode()}render(){var s=this.props,g=s.type,i=s.tip,r=s.extraTip,T=s.t,v=s.canSave,S=s.refreshQrCode,E=s.label,B=s.saveText,Q=B===void 0?"":B,y=s.downloadAsBtn,w=s.userInfo,A=s.universalFn,M=s.activeKey,H=s.option,ee=this.state,q=ee.img,u=ee.linkUrl,U=localStorage.getItem("themeColor")||"#465dcd";return q?L().createElement("div",{className:"qr-code-content"},E?L().createElement("div",{className:"label-text"},E,":"):null,L().createElement("div",{className:"qr-code-div ".concat(E?"left":"")},g==="wx"||g==="weixin"&&w.appId!=="9005"?L().createElement("img",{src:"data:image/png;base64,".concat(q),alt:""}):L().createElement("img",{src:q,alt:""}),i?L().createElement("div",{className:"tip-text"},i):null,r?L().createElement("div",{className:"tip-text"},r):null,v?L().createElement("div",{className:"save_qrcode ".concat(y?"save-btn":""),style:{color:U},onClick:()=>this.saveQrcode()},y?null:L().createElement(x.Z,{iconClass:"icon-f-download",size:"14px"}),Q||T("personal.saveCode")):null,A&&!S?L().createElement("div",{className:"save_qrcode",style:{color:U},onClick:()=>this.generatePoster({linkUrl:u,type:g,activeKey:M,option:H})},T("personal.saveCodePoster")):null,S?L().createElement("div",{className:"save_qrcode",style:{color:U},onClick:()=>S()},L().createElement(x.Z,{iconClass:"iconf-switch",size:"14px"}),T("personal.refreshCodeTip")):null)):L().createElement("div",{className:"qr-code-placeholder"})}}re.Z=(0,R.$j)(c=>{var s=c.user;return{userInfo:s,appType:s.appType,corpId:s.corpId}})((0,C.Z)()(t))},66708:function(xe,re,e){"use strict";var se=e(93485),J=e(33565),Y=e(57361),a=e(18106),N=e(88108),F=e(9754),L=e.n(F),C=e(12924),R=e.n(C),z=e(91768),m=e(28216),Z=e(89366),x=e(48194),b=e(74525),_=e(77779),D=e.n(_),t=e(6793),c=N.Z.TabPane;class s extends R().Component{constructor(r){var T;super(r);T=this,this.initAppTypeScan=(0,Y.Z)(L().mark(function S(){var E,B,Q,y,w,A,M,H,ee,q,u;return L().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.next=2,Promise.all([(0,x.q)(),(0,x.$)()]);case 2:E=k.sent,B=(0,J.Z)(E,2),Q=B[0],y=B[1],w=Q.data.sync_organizes,A=y.data.list,M=!1,H=(0,se.Z)(A),k.prev=10,H.s();case 12:if((ee=H.n()).done){k.next=19;break}if(q=ee.value,q.type!=="wechat_applet_setting"){k.next=17;break}return M=q.switch_status==="OPEN",k.abrupt("break",19);case 17:k.next=12;break;case 19:k.next=24;break;case 21:k.prev=21,k.t0=k.catch(10),H.e(k.t0);case 24:return k.prev=24,H.f(),k.finish(24);case 27:u=T.props.universalFn?T.filterOrganizes(w):T.filterCode(w),M&&u.push("wx"),T.setState({scanTypes:u});case 30:case"end":return k.stop()}},S,null,[[10,21,24,27]])})),this.filterCode=S=>{var E=[...S],B=this.props.option;return E=E.map(Q=>["third_oa_app","seeyon_app"].includes(Q)?"ding":Q),B&&B.flag==="exam_task"?[...new Set([...E])].filter(Q=>Q==="fs"):[...new Set([...E,"app"])]},this.filterOrganizes=S=>{var E=[...S],B=this.props.option;E=E.map(y=>["third_oa_app","seeyon_app"].includes(y)?"ding":y);var Q=new Set([...E]);return Q.size===1&&Q.has("app")?B&&B.flag==="exam_task"?[...Q].filter(y=>y==="fs"):[...Q]:(Q.delete("app"),B&&B.flag==="exam_task"?[...Q].filter(y=>y==="fs"):[...Q])};var v=r.t;this.state={scanTypes:[],commonTitle:{ding:v("common.sanCodeCommon"),fs:v("common.sanCodeCommon"),weixin:v("common.sanCodeCommon"),app:v("common.sanCodeCommon"),wx:v("common.weChatApplets")},tabTitle:{ding:v("common.dingDingSanCode"),fs:v("common.fsScanCode"),weixin:v("common.WeComSanCode"),app:v("common.appScanCode"),wx:v("common.wxScanCode")}}}componentDidMount(){this.initAppTypeScan()}UNSAFE_componentWillReceiveProps(){this.initAppTypeScan()}render(){var r=this.state,T=r.tabTitle,v=r.commonTitle,S=r.scanTypes,E=this.props,B=E.option,Q=E.tip,y=E.t,w=E.extraTip,A=E.canSave,M=E.refreshQrCode,H=E.isCommodityExchange,ee=E.type,q=E.center,u=q===void 0?!0:q,U=E.label,k=U===void 0?"":U,G=E.saveText,le=E.downloadAsBtn,X=le===void 0?!1:le,O=E.transfer,ae=O===void 0?!1:O,$=E.source_type,de=E.universalFn,he=E.activeKey;return R().createElement("div",{className:"".concat(D()["scan-code-box"]," ").concat(ee==="card"?D()["card-tabs"]:"")},S.length===1?R().createElement(b.Z,{universalFn:de,activeKey:he,type:S[0],option:B,tip:(0,t.ZT)(y(Q),de?v[S[0]]:T[S[0]]),extraTip:w,canSave:A,fsUrl:B.fsUrl,refreshQrCode:M,isCommodityExchange:H,label:k,saveText:G,downloadAsBtn:X}):R().createElement(N.Z,{defaultActiveKey:"1",centered:u,type:ee},S.map((oe,ve)=>{var _e=ve+1;return R().createElement(c,{tab:de?v[oe]:T[oe],key:_e},ae&&R().createElement("div",{className:D()["scan-code-transfer"]},R().createElement(Z.Z,null),R().createElement("span",null,y("course.onlyScope",{source_type:y($==="study_project"?"lineClass.project":"lineClass.task")}))),R().createElement(b.Z,{universalFn:de,activeKey:he,type:oe,option:B,tip:(0,t.ZT)(y(Q),de?v[oe]:T[oe]),extraTip:w,canSave:A,fsUrl:B.fsUrl,refreshQrCode:M,isCommodityExchange:H,label:k,saveText:G,downloadAsBtn:X}))})))}}s.defaultProps={option:{flag:"",scene:""},tip:"",extraTip:"",canSave:!0,refreshQrCode:null};var g=i=>({appType:i.user.appType});re.Z=(0,m.$j)(g)((0,z.Z)()(s))},27763:function(xe,re,e){"use strict";e.d(re,{Z:function(){return _e}});var se=e(57338),J=e(83107),Y=e(22385),a=e(31097),N=e(66456),F=e(55313),L=e(62029),C=e(20228),R=e(11382),z=e(57663),m=e(71577),Z=e(34792),x=e(48086),b=e(34669),_=e(82833),D=e(12924),t=e.n(D),c=e(91768),s=e(54549),g=e(90631),i=e(8812),r=e(28216),T=e(27361),v=e.n(T),S=e(78138),E=e.n(S);function B(pe){return pe.some(W=>{if(W.courseInfo&&W.courseInfo.length>0){var d=W.type&&W.type.toLowerCase();return d&&d.match(/\b(mp4)|(mp3)|(m3u8)\b/)?!0:W.courseInfo.some(l=>{var p=l.type&&l.type.toLowerCase();return p&&p.match(/\b(mp4)|(mp3)|(m3u8)\b/)?!0:l.courseInfo.some(I=>{var P=I.type&&I.type.toLowerCase();if(P&&P.match(/\b(mp4)|(mp3)|(m3u8)\b/))return!0})})}})}function Q(pe){var W=pe.type,d=pe.content_type,l=pe.biz_type;switch(W){case 1:return l==="micro_course"?"wei":"crs";case 2:return d;case 3:return d;case 6:return"ex";case 7:return"xx";case 9:return"questionnaire";case 17:return"practice"}}function y(pe){var W=pe.type;switch(W){case 1:return"icon-kecheng2";case 2:case 3:return"icon-sucai";case 6:return"icon-kaoshi2";case 7:return"icon-xianxiake1";case 9:return"icon-tiaoyan";case 10:return"icon-shicaozuoye";case 11:return"icon-gangweiceping1";case 12:return"icon-fudao";case 13:return"icon-kaoqin";case 15:return"icon-kaoshi2";case 16:return"icon-zhiboke";case 17:return"icon-lianxi1";default:return"icon-kecheng2"}}function w(pe){return pe.map(W=>({stageName:W.stage_name,courseInfo:W.resources.map(d=>({type:Q(d),iconType:y(d),title:d.resource_name,biz_type:d.biz_type||"",studyProgress:d.study_progress,updateTime:d.update_time,address:d.type===7?d.latoja&&d.latoja.address:"",signInTime:d.type===7?d.latoja&&d.latoja.clock_times[0].clock_time:"",resource_quiz_vo:{},courseInfo:d.type===1&&d.biz_type!=="micro_course"?d.resources.map(l=>({type:Q(l),iconType:y(l),title:l.resource_name,studyProgress:l.study_progress,resource_quiz_vo:l.resource_quiz_vo||{}})):[]}))}))}var A=e(10237),M=e(37055),H=e(6793);function ee(pe,W){var d=M.ZP.TaskStudyRecord.getRandomPopupRecord(pe),l={user_id:W};return A.WY.get({url:d,params:l}).then(p=>{var I=p.data.data;return p.data.data?!I.list||I.list&&I.list.length===0?I.list=[{key:"getPopWindowVerificationInfos_null",check_time:"-",confirm_result:"-",course_name:"-"}]:I.list.forEach(P=>{P.key=P.check_time}):p.data.data={popup_times:"0",confirm_times:"0",unconfirm_times:"0",time_out_times:"0",list:[{key:"getPopWindowVerificationInfos_err",check_time:"-",confirm_result:"-",course_name:"-"}]},p})}function q(pe,W,d){var l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"",p=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"",I=p==="exportPdf"?M.ZP.TaskStudyRecord.studyRecordExportPdf(W):M.ZP.TaskStudyRecord.getLookStudyRecordDetail(W),P=d?{user_id:pe,stage_id:l,plan_type:d}:{user_id:pe,stage_id:l};return A.WY.get({url:I,params:P}).then(V=>{var j=V.data.stage_list;return j.forEach(ie=>{ie.course_list.forEach(ue=>{ue.course_type===1||ue.course_type==="1"?ue.resource_list.map(ge=>{ge.study_records.length===0?ge.study_records=[{key:"resource_list_study_records_null",end_time:"-",start_time:"-",study_duration:"-"}]:ge.study_records.map(ce=>{ce.key=ce.start_time,ce.start_time=(0,H.p6)(ce.start_time,"yyyy-MM-dd hh:mm:ss"),ce.end_time=(0,H.p6)(ce.end_time,"yyyy-MM-dd hh:mm:ss")})}):ue.study_records.length===0?ue.study_records=[{key:"course_list_study_records_null",end_time:"-",start_time:"-",study_duration:"-"}]:ue.study_records.map(ge=>{ge.key=ge.start_time,ge.start_time=(0,H.p6)(ge.start_time,"yyyy-MM-dd hh:mm:ss"),ge.end_time=(0,H.p6)(ge.end_time,"yyyy-MM-dd hh:mm:ss")})})}),V})}function u(){var pe=M.ZP.advancedSetting.getSetting(),W={page_size:9999,page_number:1},d=!1;return A.WY.get({url:pe,params:W}).then(l=>(l.data.list.forEach(p=>{if(p.type==="document_duration_limit"){var I=p.action_list,P=I.find(j=>j.type==="random_popup_verification"),V;P?V=P.param.checked==="true"?"OPEN":"CLOSE":V="CLOSE",d=V!=="CLOSE"}}),d))}var U=e(84874),k=e(87312),G=e(31457),le=e(27326),X=e.n(le),O=e(61120),ae=e.n(O);class $ extends t().Component{constructor(W){super(W);this.getTaskInfo=()=>{var d=this.props,l=d.userId,p=d.taskId,I=d.studyType,P=I===void 0?"":I,V=P==="project"?M.ZP.StudyProjectList.studyRecord(p):M.ZP.TaskStudyRecord.getTaskInfo(p),j={user_id:l};A.WY.get({url:V,params:j}).then(ie=>{this.setState({taskInfo:P==="project"?this.compileData(ie.data):ie.data.data},()=>{var ue=this.props.record;setTimeout(()=>{this.exportPdf(ue)},100)})})},this.compileData=d=>d.map(l=>({stageName:l.stage_name,courseInfo:l.resources.map(p=>({type:this.getResourceType(p),title:p.resource_name,biz_type:p.biz_type||"",studyProgress:p.study_progress,updateTime:p.update_time,address:p.type===7?p.latoja.address:"",signInTime:p.type===7?p.latoja.clock_times[0].clock_time:"",resource_quiz_vo:{},courseInfo:p.type===1&&p.biz_type!=="micro_course"?p.resources.map(I=>({type:this.getResourceType(I),title:I.resource_name,studyProgress:I.study_progress,resource_quiz_vo:I.resource_quiz_vo||{}})):[]}))})),this.getResourceType=d=>{var l=d.type,p=d.content_type,I=d.biz_type;switch(l){case 1:return I==="micro_course"?"wei":"crs";case 2:return p;case 3:return p;case 6:return"ex";case 7:return"xx";case 9:return"questionnaire"}},this.onCancel=()=>{var d=this.props.onCancel;d&&this.props.onCancel()},this.renderResourceItem=(d,l,p)=>{var I=this.props,P=I.t,V=I.studyRecordDetailTableColumns;return d.type==="tutor"?null:t().createElement("div",{className:"stage-item-resource",key:l},t().createElement("span",{className:"stage-item-resource-icon"},t().createElement(U.Z,{iconClass:d.type==="imageText"||d.biz_type==="imageText"?M.e1.h5:M.e1[d.type],size:"16px"})),t().createElement("span",{className:"stage-item-resource-title"},d.type==="xx"?v()(d.offLineCourseSingVo,"title",""):d.title,d.studyProgress>0?t().createElement("span",{className:"stage-item-resource-time"},"(",(0,H.p6)(d.updateTime,"yyyy.MM.dd hh:mm"),P("component.update"),")"):null),t().createElement("span",{className:"stage-item-resource-progress"},t().createElement(_.Z,{format:j=>"".concat(j,"%"),percent:+d.studyProgress,size:"small",status:d.studyProgress>=100?"success":"normal",strokeColor:d.studyProgress>=100?"#58D28B":""})),d.type!=="imageText"||d.biz_type==="imageText"&&d.courseInfo&&d.courseInfo.length>0?t().createElement("div",{className:"stage-item-resource-course course-resource"},d.courseInfo.map((j,ie)=>{if(!p)return null;var ue=p.resource_list[ie];return t().createElement("div",{className:"course-resource-item",key:ie},t().createElement("span",{className:"course-resource-item-title"},j.title),t().createElement("span",{className:"course-resource-item-progress"},t().createElement(_.Z,{format:ge=>"".concat(ge,"%"),percent:+j.studyProgress,size:"small",status:j.studyProgress>=100?"success":"normal",strokeColor:j.studyProgress>=100?"#58D28B":""})),j.resource_quiz_vo.question_count>0?t().createElement("div",{className:"course-resource-item-test"},P("component.InClassTest"),t().createElement("span",null,j.resource_quiz_vo.answer_record_count>0?P("component.tookPart"):P("component.NotAttending"))):null,t().createElement("div",{className:"course-resource-item-table"},ue.study_records.length&&t().createElement(F.Z,{columns:V,dataSource:ue.study_records,bordered:!0,pagination:!1,size:"small"})))})):null,d.type==="xx"?t().createElement("div",{className:"stage-item-resource-offline"},t().createElement("div",{className:"offline-info-item"},P("component.offlineAddress"),"\uFF1A",v()(d.offLineCourseSingVo,"address","")||P("component.noLabel")),v()(d.offLineCourseSingVo,"signRecordDetailList",[]).map((j,ie)=>t().createElement("div",{className:"offline-record-info-item-row",key:ie},t().createElement("div",null,t().createElement("span",null,P("lineClass.attendanceName"),"\uFF1A"),t().createElement("span",null,j.signName)),t().createElement("div",null,t().createElement("span",null,P("personal.checkInTime"),"\uFF1A"),t().createElement("span",null,"".concat(j.signInTime?E()(j.signInTime).format("YYYY-MM-DD HH:mm"):"--"," ").concat(j.signInStatusDesc||""))),j.signOutConfigExist?t().createElement("div",null,t().createElement("span",null,P("lineClass.signBack"),"\uFF1A"),t().createElement("span",null,"".concat(j.signOutTime?E()(j.signOutTime).format("YYYY-MM-DD HH:mm"):"--"," ").concat(j.signOutStatusDesc||""))):t().createElement("div",null)))):null,t().createElement("div",{className:"stage-item-resource-table"},p&&p.course_type!==1&&t().createElement("div",{key:p.id},t().createElement(F.Z,{columns:V,dataSource:p.study_records,bordered:!0,pagination:!1,size:"small"}))))},this.changeStyle=(d,l,p)=>{d&&d.length!==0&&d.forEach(I=>{I.style[l]=p})},this.exportPdf=d=>{var l=this.props,p=l.mainTaskInfo,I=l.studyType,P=document.getElementsByClassName("extra-pdf-no-style")[0];P.scrollTop=0;var V=P.querySelectorAll(".taskpdf-record-item"),j=this.getLastElementChild(V[V.length-1]);j.style.paddingBottom="90px";var ie=P.getElementsByClassName("ant-progress-inner"),ue=P.getElementsByClassName("ant-progress-text");this.changeStyle(ie,"background","#ebebeb"),this.changeStyle(ue,"color","#000000");var ge=P.querySelectorAll("svg");ge.length>0&&ge.forEach(ce=>{ce.style.display="none"}),ae()(P,{allowTaint:!0,scale:3}).then(ce=>{for(var ye=new(X())("p","mm","a4"),be=ce.getContext("2d"),Ie=190,Re=277,Ne=Math.floor(Re*ce.width/Ie),Se=0;Se<ce.height;){var Te=document.createElement("canvas");Te.width=ce.width,Te.height=Math.min(Ne,ce.height-Se),Te.getContext("2d").putImageData(be.getImageData(0,Se,ce.width,Math.min(Ne,ce.height-Se)),0,0),ye.addImage(Te.toDataURL("image/jpeg",1),"JPEG",10,10,Ie,Math.min(Re,Ie*Te.height/Te.width)),Se+=Ne,Se<ce.height&&ye.addPage()}ye.save("".concat(this.props.studyType==="project"?d.user_name||"\u59D3\u540D":d.userName||"\u59D3\u540D","_").concat(I==="project"?p.title||"\u540D\u79F0":p.trainName||"\u540D\u79F0","_\u5B66\u4E60\u8BB0\u5F55.pdf")),this.props.onPdfCancel()})},this.compileRecord=d=>({userName:d.user_name,departName:d.department_name,postNameList:[]}),this.getLastElementChild=d=>{if(d.lastElementChild!==void 0)return d.lastElementChild;for(var l=d.lastChild;l&&l.nodeType!==1;)l=l.previousSibling;return l},this.dealDuration=()=>{var d=this.props,l=d.mainTaskInfo,p=d.t,I=d.studyType;return I==="project"?p("component.noLabel"):I==="newEmployee"?l.trainLimit+p("common.day"):"".concat((0,H.p6)(l.beginTime,"yyyy-MM-dd hh:mm")," ~ ").concat((0,H.p6)(l.endTime,"yyyy-MM-dd hh:mm"))},this.dealCreateTime=()=>{var d=this.props,l=d.mainTaskInfo,p=d.studyType;return p==="project"?(0,H.p6)(l.update_time,"yyyy-MM-dd hh:mm"):p==="newEmployee"?(0,H.p6)(l.effectTime,"yyyy-MM-dd hh:mm"):(0,H.p6)(l.createTime,"yyyy-MM-dd hh:mm")},this.state={taskInfo:[],operateTime:(0,H.p6)(new Date,"yyyy-MM-dd hh:mm:ss")}}componentDidUpdate(W){W.pdfVisible!==this.props.pdfVisible&&this.props.pdfVisible&&this.getTaskInfo()}render(){var W=this.state,d=W.taskInfo,l=W.operateTime,p=this.props,I=p.record,P=p.pdfVisible,V=p.mainTaskInfo,j=p.t,ie=p.taskStudyRecordDetail,ue=p.studyType,ge=ue==="project"?this.compileRecord(I):I;return t().createElement(D.Fragment,null,P&&t().createElement("div",{className:"taskpdf-record extra-pdf-record"},t().createElement("div",{className:"extra-pdf-no-style"},t().createElement("table",{className:"stage-item-table"},t().createElement("tbody",null,t().createElement("tr",null,t().createElement("td",{colSpan:"6"},window.localStorage.getItem("enterpriseName"))),t().createElement("tr",null,t().createElement("td",null,j("study.taskName")),t().createElement("td",null,ue==="project"?V.title:V.trainName||""),t().createElement("td",null,j(ue==="newEmployee"?"learning.learningEmployeeAddValidity":"common.createTime")),t().createElement("td",null,this.dealCreateTime()),t().createElement("td",null,j("study.duration")),t().createElement("td",null,this.dealDuration())),t().createElement("tr",null,t().createElement("td",null,j("common.userName")),t().createElement("td",null,ge.userName||""),t().createElement("td",null,j("common.department")),t().createElement("td",null,ge.departName.replace(/,/g," | ")||""),t().createElement("td",null,j("questionn.position")),t().createElement("td",null,ge.postNameList?ge.postNameList.join(" | "):"")))),d.map((ce,ye)=>{if(!ce.courseInfo||ce.courseInfo.length===0)return null;var be=ie[ye].course_list;return t().createElement("div",{key:ye,className:"taskpdf-record-item stage-item"},t().createElement("div",{className:"stage-item-title"},ce.stageName),ce.courseInfo.map((Ie,Re)=>{var Ne=be[Re];return this.renderResourceItem(Ie,Re,Ne)}))}),t().createElement("div",{className:"stage-item-bottom"},t().createElement("div",{className:"item-bottom-left"},j("study.operator"),"\uFF1A",window.localStorage.getItem("name")),t().createElement("div",{className:"item-bottom-right"},t().createElement("span",null,j("study.exportProject")," \uFF1A",j("common.studyRecord")),t().createElement("span",null,j("study.exportTime"),"\uFF1A",l))))))}}$.defaultProps={pdfVisible:!1,userId:"",taskId:"",studyType:"",onPdfCancel:()=>{}};var de=(0,c.Z)()($),he=e(38642),oe=pe=>{var W=pe.user;return{enterpriseId:W.enterpriseId}};class ve extends t().Component{constructor(W){var d;super(W);d=this,this.getDocumentDurationLimitSetting=()=>{u().then(l=>{this.setState({})}).catch(()=>{this.setState({})})},this.getPopWindowVerificationInfos=()=>{var l=this.props,p=l.userId,I=l.taskId;ee(I,p).then(P=>{var V=P.data.data;this.setState({popWindowVerificationInfos:V,isPopWindowVerificationInfosLoading:!1})}).catch(()=>{this.setState({isPopWindowVerificationInfosLoading:!1})})},this.getTaskInfo=()=>{var l=this.props,p=l.userId,I=l.taskId,P=l.studyType,V=P===void 0?"":P,j=V==="project"?M.ZP.StudyProjectList.studyRecord(I):M.ZP.TaskStudyRecord.getTaskInfo(I),ie={user_id:p};A.WY.get({url:j,params:ie}).then(ue=>{var ge=V==="project"?w(ue.data):ue.data.data;this.setState({taskInfo:ge,isTaskInfoLoading:!1})})},this.handleCancel=()=>{var l=this.props.onCancel;l&&this.props.onCancel(),this.setState({drawerType:"default",drawerTabs:[{key:1,name:this.props.t?this.props.t("common.studyRecord"):"\u5B66\u4E60\u8BB0\u5F55",checked:!0},{key:2,name:this.props.t?this.props.t("study.randomPopWindowVerification"):"\u968F\u673A\u5F39\u7A97\u6821\u9A8C",checked:!1}]})},this.renderTutorStatus=l=>{var p=this.props.t;return l.tutorialsStatus==="no_tutor"?p("tutorial.noSelectTutor"):l.tutorialsStatus==="to_be_submitted"?p("tutorial.waitSubmitTutor"):l.tutorialsStatus==="to_be_evaluated"?p("tutorial.waitEvaluate"):l.tutorialsStatus==="evaluated"?"".concat(p("tutorial.haveEvaluation")," ").concat(l.score).concat(p("common.examScoreUnit")):null},this.renderTitle=l=>l.type==="tutor"?l.courseName:l.type==="xx"?v()(l.offLineCourseSingVo,"title",""):l.title,this.renderResourceItem=(l,p)=>{var I=this.props.t;return l.type==="practice"?null:t().createElement("div",{className:"stage-item-resource",key:p},t().createElement("div",{className:"stage-item-container"},t().createElement("div",{className:"stage-item-resource_title_container"},t().createElement("span",{className:"stage-item-resource-icon"},t().createElement(U.Z,{iconClass:l.iconType,size:"16px"})),t().createElement("p",{className:"stage-item-resource-title"},this.renderTitle(l),l.studyProgress>0?t().createElement("span",{className:"stage-item-resource-time"},"(",(0,H.p6)(l.updateTime,"yyyy.MM.dd hh:mm"),I("component.update"),")"):null)),t().createElement("div",{className:"stage-item-resource-progress"},l.type==="tutor"?this.renderTutorStatus(l):t().createElement(_.Z,{percent:+l.studyProgress,size:"small",status:l.studyProgress>=100?"success":"normal",strokeColor:l.studyProgress>=100?"#58D28B":""}))),l.type!=="imageText"||l.biz_type==="imageText"&&l.courseInfo&&l.courseInfo.length>0?t().createElement("div",{className:"stage-item-resource-course course-resource"},l.courseInfo.map(P=>t().createElement("div",{className:"course-resource-item",key:P.id},t().createElement("div",{className:"course-resource-item_title_container"},t().createElement("span",{className:"course-resource-item-icon"}),t().createElement("p",{className:"course-resource-item-title"},P.title)),t().createElement("div",{className:"course-resource-item-progress"},t().createElement(_.Z,{percent:+P.studyProgress,size:"small",status:P.studyProgress>=100?"success":"normal",strokeColor:P.studyProgress>=100?"#58D28B":""})),P.resource_quiz_vo.question_count>0?t().createElement("div",{className:"course-resource-item-test"},I("component.InClassTest"),t().createElement("span",null,P.resource_quiz_vo.answer_record_count>0?I("component.tookPart"):I("component.NotAttending"))):null))):null,l.type==="xx"?t().createElement("div",{className:"stage-item-resource-offline"},t().createElement("div",{className:"offline-info-item"},I("component.offlineAddress"),"\uFF1A",v()(l.offLineCourseSingVo,"address","")||I("component.noLabel")),v()(l.offLineCourseSingVo,"signRecordDetailList",[]).map((P,V)=>t().createElement("div",{className:"offline-record-info-item-row",key:V},t().createElement("div",null,t().createElement("span",null,I("lineClass.attendanceName"),"\uFF1A"),t().createElement("span",null,P.signName)),t().createElement("div",null,t().createElement("span",null,I("personal.checkInTime"),"\uFF1A"),t().createElement("span",null,"".concat(P.signInTime?E()(P.signInTime).format("YYYY-MM-DD HH:mm"):"--"," ").concat(P.signInStatusDesc||""))),P.signOutConfigExist?t().createElement("div",null,t().createElement("span",null,I("lineClass.signBack"),"\uFF1A"),t().createElement("span",null,"".concat(P.signOutTime?E()(P.signOutTime).format("YYYY-MM-DD HH:mm"):"--"," ").concat(P.signOutStatusDesc||""))):t().createElement("div",null)))):null,l.courseType===13?t().createElement("div",{className:"stage-item-resource-offline"},v()(l.offLineCourseSingVo,"signRecordDetailList",[]).map((P,V)=>t().createElement("div",{className:"offline-record-info-item-row",key:V},t().createElement("div",null,t().createElement("span",null,I("lineClass.attendanceName"),"\uFF1A"),t().createElement("span",null,P.signName)),P.signInConfigExist?t().createElement("div",null,t().createElement("span",null,I("personal.checkInTime"),"\uFF1A"),t().createElement("span",null,"".concat(P.signInTime?E()(P.signInTime).format("YYYY-MM-DD HH:mm"):"--"," ").concat(P.signInStatusDesc||""))):null,P.signOutConfigExist?t().createElement("div",null,t().createElement("span",null,I("lineClass.signBack"),"\uFF1A"),t().createElement("span",null,"".concat(P.signOutTime?E()(P.signOutTime).format("YYYY-MM-DD HH:mm"):"--"," ").concat(P.signOutStatusDesc||""))):t().createElement("div",null)))):null)},this.exportPdf=()=>{x.default.warn(this.props.t("common.pdfDowning")),this.lookStudyRecord("exportPdf")},this.exportFile=()=>{var l=this.props,p=l.taskId,I=l.userId,P=M.ZP.StudyProjectList.getExportRecord(p);this.setState({download:!0});var V={user_id:I};A.WY.get({url:P,params:V}).then(j=>{this.setState({download:!1}),j.data.code===200&&((0,G.Pp)(this.props),x.default.success(this.props.t("study.compoundSucceed")))}).catch(()=>{this.setState({download:!1})})},this.handleDrawerTabItemClick=l=>{var p=this.state,I=p.drawerTabs,P=p.drawerType,V=P;l===2&&(V="default",this.getPopWindowVerificationInfos());var j=I,ie=j.map(ue=>(ue.key===l?ue.checked=!0:ue.checked=!1,ue));this.setState({drawerTabs:ie,drawerType:V})},this.renderDrawerTabHeader=()=>{var l=this.state.drawerTabs,p=localStorage.getItem("themeColor")||"#516ae6";return t().createElement("div",{className:"drawerTabHeader"},l.map(I=>I.checked?t().createElement("span",{className:"tab-item tab-item-border-checked",style:{color:p,borderColor:p},key:I.key,onClick:this.handleDrawerTabItemClick.bind(this,I.key)},I.name):t().createElement("span",{className:"tab-item tab-item-border",key:I.key,onClick:this.handleDrawerTabItemClick.bind(this,I.key)},I.name)))},this.renderDrawerTitle=function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"default",p=d.state.drawerWidth,I=d.props.t;if(l==="default")return t().createElement("div",{className:"TaskStudyRecord_drawer_title_container default_title "},d.renderDrawerTabHeader(),t().createElement(s.Z,{className:"TaskStudyRecord_drawer_closeBtn",onClick:d.handleCancel}));var P={width:p-48};return t().createElement("div",{className:"TaskStudyRecordDrawer_drawerTitle_extension"},t().createElement("div",{className:"TaskStudyRecord_drawer_title_container default_title_whenExtension1",style:P},d.renderDrawerTabHeader(),t().createElement(s.Z,{className:"TaskStudyRecord_drawer_closeBtn",onClick:d.handleCancel})),t().createElement("div",{className:"TaskStudyRecord_drawer_title_container extension1_title "},t().createElement("span",{className:"extension1_title_value"}," ",I("study.studyRecordDetail")),t().createElement(s.Z,{className:"TaskStudyRecord_drawer_closeBtn",onClick:d.handleChangeDrawerType.bind(d,"default")})))},this.handleChangeDrawerType=l=>{var p=this.state.drawerType;p==="default"&&this.lookStudyRecord(),this.setState({drawerType:l})},this.lookStudyRecord=l=>{var p=this.props,I=p.userId,P=p.taskId,V=p.planType;q(I,P,V,"",l).then(j=>{var ie=j.data.stage_list;this.setState({taskStudyRecordDetail:ie,isTaskStudyRecordDetailLoading:!1},()=>{l==="exportPdf"&&this.setState({downloadPdf:!0})})}).catch(()=>{this.setState({isTaskStudyRecordDetailLoading:!1,downloadPdf:!1})})},this.handleClosePDFPreviewWindow=()=>{this.setState({downloadPdf:!1})},this.generateButton=()=>{var l=this.props,p=l.t,I=l.record,P=l.studyType,V=this.state.whiteList,j=V.generatePdf;return j?t().createElement(D.Fragment,null,t().createElement(m.Z,{type:"primary",className:"generate-pdf-btn",loading:this.state.downloadPdf,icon:t().createElement(g.Z,null),onClick:()=>this.exportPdf(I)},p("common.generatePdf")),P!=="project"&&t().createElement(m.Z,{type:"primary",loading:this.state.download,icon:t().createElement(g.Z,null),onClick:()=>this.exportFile(I)},p("exam.exportQuestion"),"EXCEL")):P!=="project"?t().createElement(m.Z,{type:"primary",loading:this.state.download,icon:t().createElement(g.Z,null),onClick:()=>this.exportFile(I)},p("exam.exportQuestion"),"EXCEL"):null},this.renderTaskStudyRecord=()=>{var l=this.state,p=l.taskInfo,I=l.isTaskInfoLoading,P=l.taskStudyRecordDetail,V=l.downloadPdf,j=this.props,ie=j.generatePdf,ue=j.t,ge=j.mainTaskInfo;return t().createElement("div",{className:"TaskStudyRecord_tab_container"},t().createElement(R.Z,{spinning:I},t().createElement("div",{className:"TaskStudyRecord_tab_header"},t().createElement("div",{className:"tab_header_right",onClick:this.handleChangeDrawerType.bind(this,"extension1")},t().createElement("span",{className:"look_recordDetail_title"},ue("study.lookStudyRecord")),t().createElement(i.Z,null))),t().createElement("div",{className:"TaskStudyRecord_tab_content"},t().createElement("div",{className:"TaskStudyRecord_content"},p.map((ce,ye)=>!ce.courseInfo||ce.courseInfo.length===0?null:t().createElement("div",{key:ye,className:"taskstudy-record-item stage-item"},t().createElement("div",{className:"stage-item-title"},ce.stageName),ce.courseInfo.map((be,Ie)=>this.renderResourceItem(be,Ie)))))),ie?t().createElement("div",{className:"TaskStudyRecord_tab_footer"},this.generateButton()):null),t().createElement(de,(0,L.Z)({pdfVisible:V,onPdfCancel:this.handleClosePDFPreviewWindow},this.props,{mainTaskInfo:ge,taskStudyRecordDetail:P,studyRecordDetailTableColumns:this.studyRecordDetailTableColumns})))},this.renderRandomPopWindow=()=>{var l=this.state,p=l.popWindowVerificationInfos,I=l.isPopWindowVerificationInfosLoading,P=this.props.t,V=window.screen.availHeight-250;return t().createElement("div",{className:"RandomPopWindow_tab_container"},I?t().createElement("div",{className:"RandomPopWindow_content_null"},t().createElement(R.Z,{spinning:I})):p&&p.list[0].check_time!=="-"?t().createElement("div",{className:"RandomPopWindow_content"},t().createElement(R.Z,{spinning:I},t().createElement("div",{className:"pop_confirm_times"},t().createElement("span",{className:"confirm_times_label"},P("study.popWindowVerificationTimes"),":"),t().createElement("span",null,p.popup_times)),t().createElement("div",{className:"pop_confirm_detail"},t().createElement("div",{className:"pop_confirm_item pop_confirm_confirmed"},t().createElement("span",{className:"confirm_item_label"},P("study.confirmed"),":"),t().createElement("span",null,p.confirm_times)),t().createElement("div",{className:"pop_confirm_item pop_confirm_unconfirm"},t().createElement("span",{className:"confirm_item_label"},P("study.unConfirm"),":"),t().createElement("span",null,p.unconfirm_times)),t().createElement("div",{className:"pop_confirm_item pop_confirm_time_out"},t().createElement("span",{className:"confirm_item_label"},P("study.confirmedOverTime"),":"),t().createElement("span",null,p.time_out_times))),t().createElement("div",{className:"RandomPopWindow_table"},t().createElement(F.Z,{columns:this.popWindowTableColumns,dataSource:p.list,bordered:!0,pagination:!1,size:"small",scroll:{y:V}})))):t().createElement("div",{className:"RandomPopWindow_content_null"},t().createElement("span",{className:"null_tip"},t().createElement(k.Z,null))))},this.renderTaskStudyRecordDetail=()=>{var l=this.state,p=l.taskStudyRecordDetail,I=l.isTaskStudyRecordDetailLoading;return t().createElement(R.Z,{spinning:I},t().createElement("div",{className:"TaskStudyRecordDetail_content_container"},p&&p.map(P=>t().createElement("div",{className:"stage_list_item",key:P.stage_id},t().createElement("div",{className:"stage-item-title"},P.stage_name),P.course_list&&P.course_list.map(V=>t().createElement("div",{className:"course_container",key:V.id},t().createElement("div",{className:"course_list_title"},t().createElement("span",{className:"course_item_resource_icon"},t().createElement(U.Z,{iconClass:V.iconType,size:"16px"})),t().createElement("p",{className:"course_item_title"},V.name)),V.course_type===1||V.course_type==="1"?t().createElement("div",null,V.resource_list.map(j=>t().createElement("div",{className:"course_resource_container",key:j.id},V.type!=="imageText"&&t().createElement("div",{className:"course_resource_title"},t().createElement("span",{className:"resource_item_resource_icon"},t().createElement(U.Z,{iconClass:j.iconType,size:"16px"})),t().createElement("p",{className:"resource_item_title"},j.name)),t().createElement(F.Z,{columns:this.studyRecordDetailTableColumns,dataSource:j.study_records,bordered:!0,pagination:!1,size:"small"})))):t().createElement("div",{key:V.id},t().createElement(F.Z,{columns:this.studyRecordDetailTableColumns,dataSource:V.study_records,bordered:!0,pagination:!1,size:"small"}))))))))},this.state={download:!1,downloadPdf:!1,drawerWidth:this.props.width?this.props.width:700,drawerType:"default",drawerTabs:[{key:1,name:this.props.t?this.props.t("common.studyRecord"):"\u5B66\u4E60\u8BB0\u5F55",checked:!0},{key:2,name:this.props.t?this.props.t("study.randomPopWindowVerification"):"\u968F\u673A\u5F39\u7A97\u6821\u9A8C",checked:!1}],taskInfo:[],popWindowVerificationInfos:null,taskStudyRecordDetail:null,isPopWindowVerificationInfosLoading:!0,isTaskInfoLoading:!0,isTaskStudyRecordDetailLoading:!0,whiteList:{generatePdf:(0,he.UI)("GENERATE_PDF")}},this.popWindowTableColumns=[{title:"\u6821\u9A8C\u573A\u666F",dataIndex:"course_name",ellipsis:{showTitle:!1},render:l=>t().createElement(a.Z,{placement:"topLeft",title:l},l)},{title:this.props.t?this.props.t("study.verificationTime"):"\u6821\u9A8C\u65F6\u95F4",dataIndex:"check_time"},{title:this.props.t?this.props.t("study.result"):"\u7ED3\u679C",dataIndex:"confirm_result"}],this.studyRecordDetailTableColumns=[{title:this.props.t?this.props.t("study.learningStart"):"\u5B66\u4E60(\u8D77)",dataIndex:"start_time"},{title:this.props.t?this.props.t("study.learningEnd"):"\u5B66\u4E60(\u6B62)",dataIndex:"end_time"},{title:this.props.t?this.props.t("study.learningTime"):"\u5B66\u4E60\u65F6\u95F4(\u5206\u949F)",dataIndex:"study_duration"}]}componentDidUpdate(W){if(W.visible!==this.props.visible&&this.props.visible){this.getDocumentDurationLimitSetting();var d=this.state.drawerTabs,l=d.find(p=>p.checked);l.key===1?this.getTaskInfo():this.getPopWindowVerificationInfos()}}render(){var W=this.state,d=W.drawerWidth,l=W.drawerType,p=W.drawerTabs,I=p.find(ie=>ie.checked),P=l==="default"?d:d+561,V={border:"none",padding:"0px 24px"},j={padding:"0px 24px"};return t().createElement(J.Z,{title:this.renderDrawerTitle(l),width:P,onClose:this.handleCancel,visible:this.props.visible,headerStyle:V,bodyStyle:j,closable:!1},l==="default"?t().createElement("div",{className:"TaskStudyRecord_content_default"},I.key===1?this.renderTaskStudyRecord():this.renderRandomPopWindow()):t().createElement("div",{className:"TaskStudyRecordDrawer-body_content"},t().createElement("div",{className:"TaskStudyRecord_content"},I.key===1?this.renderTaskStudyRecord():this.renderRandomPopWindow()),t().createElement("div",{className:"TaskStudyRecord_detail"},this.renderTaskStudyRecordDetail())))}}var _e=(0,r.$j)(oe)((0,c.Z)()(ve))},98417:function(xe,re,e){"use strict";var se=e(62029),J=e(57663),Y=e(71577),a=e(34792),N=e(48086),F=e(34669),L=e(82833),C=e(22385),R=e(31097),z=e(12924),m=e.n(z),Z=e(91768),x=e(90631),b=e(28216),_=e(27361),D=e.n(_),t=e(78138),c=e.n(t),s=e(27326),g=e.n(s),i=e(61120),r=e.n(i),T=e(18329),v=e(38642),S=e(31457),E=e(6793),B=e(37055),Q=e(5430),y=e(10237),w=e(84874),A=ee=>{var q=ee.user;return{enterpriseId:q.enterpriseId}},M={size:"medium",destroyOnClose:!0,bodyStyle:{overflowY:"auto",padding:0},maskClosable:!1};class H extends m().Component{constructor(q){super(q);this.getTaskInfo=()=>{var u=this.props,U=u.userId,k=u.taskId,G=u.studyType,le=G===void 0?"":G,X=this.state.whiteList,O=X.zaraFlag?B.ZP.TaskStudyRecord.getCustomTaskInfo(k):B.ZP.TaskStudyRecord.getTaskInfo(k),ae=X.zaraFlag?B.ZP.StudyProjectList.studyCustomRecord(k):B.ZP.StudyProjectList.studyRecord(k),$=le==="project"?ae:O,de={user_id:U};y.WY.get({url:$,params:de}).then(he=>{this.setState({taskInfo:le==="project"?this.compileData(he.data):he.data.data})})},this.compileData=u=>{var U=this.props.from,k=U===void 0?"":U;return u.map(G=>{var le=G.resources.map(X=>k==="self_study"&&X.type===14?{}:{type:this.getResourceType(X),iconType:this.getResourceIcon(X),title:String(X.type)!=="14"&&String(X.courseType)!=="14"?X.resource_name:X.evaluate.name,courseType:X.courseType,studyProgress:X.study_progress,biz_type:X.biz_type||"",updateTime:X.update_time,resource_quiz_vo:{},live_lesson:X.type===16?X.live_lesson:{},offLineCourseSingVo:X.type===7||X.type===13?X.offLineCourseSingVo:{},courseInfo:X.type===1&&X.biz_type!=="micro_course"?X.resources.map(O=>({type:this.getResourceType(O),iconType:this.getResourceIcon(X),title:O.resource_name,studyProgress:O.study_progress,resource_quiz_vo:O.resource_quiz_vo||{}})):[]});return{stageName:G.stage_name,courseInfo:le.filter(X=>Object.keys(X).length>0)}})},this.getResourceIcon=u=>{var U=u.type;switch(U){case 1:return"icon-kecheng2";case 2:case 3:return"icon-sucai";case 6:return"icon-kaoshi2";case 7:return"icon-xianxiake1";case 9:return"icon-tiaoyan";case 10:return"icon-shicaozuoye";case 11:return"icon-gangweiceping1";case 12:return"icon-fudao";case 13:return"icon-kaoqin";case 14:return"icon-tuiguang";case 15:return"icon-kaoshi2";case 16:return"icon-zhiboke";case 17:return"icon-lianxi1";default:return"icon-kecheng2"}},this.getResourceType=u=>{var U=u.type,k=u.content_type,G=u.biz_type;switch(U){case 1:return G==="micro_course"?"wei":"crs";case 2:return k;case 3:return k;case 6:return"ex";case 7:return"xx";case 9:return"questionnaire";case 13:return"attendance";case 15:return"ex";case 16:return"liveClass";case 17:return"practice";default:return k}},this.handleCancel=()=>{var u=this.props.onCancel;u&&this.props.onCancel()},this.renderTutorStatus=u=>{var U=this.props.t;return u.tutorialsStatus==="no_tutor"?U("tutorial.noSelectTutor"):u.tutorialsStatus==="to_be_submitted"?U("tutorial.waitSubmitTutor"):u.tutorialsStatus==="to_be_evaluated"?U("tutorial.waitEvaluate"):u.tutorialsStatus==="evaluated"?"".concat(U("tutorial.haveEvaluation")," ").concat(u.score).concat(U("common.examScoreUnit")):""},this.renderTitle=u=>u.type==="tutor"?u.courseName:u.type==="xx"?D()(u.offLineCourseSingVo,"title",""):u.title,this.renderResourceItem=(u,U)=>{var k=this.props.t;return u.type==="practice"?null:m().createElement("div",{className:"stage-item-resource",key:U},m().createElement("span",{className:"stage-item-resource-icon"},m().createElement(w.Z,{iconClass:u.iconType,size:"16px"})),m().createElement("span",{className:"stage-item-resource-title"},m().createElement("span",{className:"stage-item-resource-title-name"},m().createElement(R.Z,{title:this.renderTitle(u)},this.renderTitle(u))),u.studyProgress>0?m().createElement("span",{className:"stage-item-resource-time"},"(",(0,E.p6)(u.updateTime,"yyyy.MM.dd hh:mm"),k("component.update"),")"):null),m().createElement("span",{className:"stage-item-resource-progress"},u.type==="tutor"?this.renderTutorStatus(u):m().createElement(L.Z,{percent:+u.studyProgress,size:"small",status:u.studyProgress>=100?"success":"normal",strokeColor:u.studyProgress>=100?"#58D28B":""})),u.courseInfo&&u.courseInfo.length>0?m().createElement("div",{className:"stage-item-resource-course course-resource"},u.courseInfo.map((G,le)=>m().createElement("div",{className:"course-resource-item",key:le},m().createElement("span",{className:"course-resource-item-icon"}),m().createElement("span",{className:"course-resource-item-title"},G.title),m().createElement("span",{className:"course-resource-item-progress"},m().createElement(L.Z,{percent:+G.studyProgress,size:"small",status:G.studyProgress>=100?"success":"normal",strokeColor:G.studyProgress>=100?"#58D28B":""})),G.resource_quiz_vo.question_count>0?m().createElement("div",{className:"course-resource-item-test"},k("component.InClassTest"),m().createElement("span",null,G.resource_quiz_vo.answer_record_count>0?k("component.tookPart"):k("component.NotAttending"))):null))):null,u.courseType===7?m().createElement("div",{className:"stage-item-resource-offline"},m().createElement("div",{className:"offline-info-item"},k("component.offlineAddress"),"\uFF1A",D()(u.offLineCourseSingVo,"address","")||k("component.noLabel")),D()(u.offLineCourseSingVo,"signRecordDetailList",[]).map((G,le)=>m().createElement("div",{className:"offline-record-info-item-row",key:le},m().createElement("div",null,m().createElement("span",null,k("lineClass.attendanceName"),"\uFF1A"),m().createElement("span",null,G.signName)),G.signInConfigExist?m().createElement("div",null,m().createElement("span",null,k("personal.checkInTime"),"\uFF1A"),m().createElement("span",null,"".concat(G.signInTime?c()(G.signInTime).format("YYYY-MM-DD HH:mm"):"--"," ").concat(G.signInStatusDesc||""))):null,G.signOutConfigExist?m().createElement("div",null,m().createElement("span",null,k("lineClass.signBack"),"\uFF1A"),m().createElement("span",null,"".concat(G.signOutTime?c()(G.signOutTime).format("YYYY-MM-DD HH:mm"):"--"," ").concat(G.signOutStatusDesc||""))):m().createElement("div",null)))):null,u.courseType===13?m().createElement("div",{className:"stage-item-resource-offline"},D()(u.offLineCourseSingVo,"signRecordDetailList",[]).map((G,le)=>m().createElement("div",{className:"offline-record-info-item-row",key:le},m().createElement("div",null,m().createElement("span",null,k("lineClass.attendanceName"),"\uFF1A"),m().createElement("span",null,G.signName)),G.signInConfigExist?m().createElement("div",null,m().createElement("span",null,k("personal.checkInTime"),"\uFF1A"),m().createElement("span",null,"".concat(G.signInTime?c()(G.signInTime).format("YYYY-MM-DD HH:mm"):"--"," ").concat(G.signInStatusDesc||""))):null,G.signOutConfigExist?m().createElement("div",null,m().createElement("span",null,k("lineClass.signBack"),"\uFF1A"),m().createElement("span",null,"".concat(G.signOutTime?c()(G.signOutTime).format("YYYY-MM-DD HH:mm"):"--"," ").concat(G.signOutStatusDesc||""))):m().createElement("div",null)))):null,u.courseType===16?m().createElement("div",{className:"stage-item-resource-offline"},m().createElement("div",{className:"liveClass-record-info-item-row",key:U},m().createElement("div",null,m().createElement("span",null,k("component.lecturer"),"\uFF1A"),m().createElement("span",null,u.live_lesson.teacher_name)),u.live_lesson.live_start_time?m().createElement("div",null,m().createElement("span",null,k("live.liveTime"),"\uFF1A"),m().createElement("span",null,u.live_lesson.live_start_time&&u.live_lesson.live_end_time===0?c()(u.live_lesson.live_start_time*1).format("YYYY-MM-DD HH:mm"):""),m().createElement("span",null,u.live_lesson.live_start_time&&u.live_lesson.live_end_time!==0?(0,v.yM)(u.live_lesson.live_start_time,u.live_lesson.live_end_time):"")):"--")):null)},this.changeProgressSvg=u=>{u.length>0&&u.forEach(U=>{var k=U.getElementsByTagName("svg")[0];k&&(k.parentNode.display="none",k.parentNode.innerHTML='<span class="item-right-complete">100%</span>')})},this.changeStyle=(u,U,k)=>{u&&u.length!==0&&u.forEach(G=>{G.style[U]=k})},this.exportFile=()=>{var u=this.props,U=u.taskId,k=u.userId,G=u.studyType,le=B.ZP.StudyProjectList.getExportRecord(U),X=Q.lk.getExportRecord(U),O=G==="project"?X:le;this.setState({download:!0});var ae={user_id:k};y.WY.get({url:O,params:ae}).then($=>{this.setState({download:!1}),$.data.code===200&&((0,S.Pp)(this.props),N.default.success(this.props.t("study.compoundSucceed")))}).catch(()=>{this.setState({download:!1})})},this.getFirstElementChild=u=>{if(u.firstElementChild!==void 0)return u.firstElementChild;for(var U=u.firstChild;U&&U.nodeType!==1;)U=U.nextSibling;return U},this.getLastElementChild=u=>{if(u.lastElementChild!==void 0)return u.lastElementChild;for(var U=u.lastChild;U&&U.nodeType!==1;)U=U.previousSibling;return U},this.exportPdf=u=>{var U=this.props,k=U.mainTaskInfo,G=U.studyType;this.setState({downloadPdf:!0}),N.default.warn(this.props.t("common.pdfDowning"));var le=(0,E.p6)(new Date,"yyyy-MM-dd hh:mm:ss"),X=document.getElementsByClassName("ant-modal-content")[0];X.style.overflowX="hidden";var O=document.createElement("div");O.className="taskstudy-record extra-record",O.scrollTop=0;var ae=document.getElementsByClassName("taskstudy-record")[0],$;ae?($=ae.cloneNode(!0),$.className="extra-no-style"):($=document.createElement("div"),$.className="extra-no-style");var de=$.getElementsByClassName("taskstudy-record-item");this.changeStyle(de,"borderTop",0);var he=$.getElementsByClassName("stage-item-title");this.changeStyle(he,"fontSize","13px");var oe=$.getElementsByClassName("stage-item-resource-icon"),ve=$.getElementsByClassName("course-resource-item-icon");this.changeStyle(oe,"marginRight","0"),this.changeStyle(ve,"marginRight","0");var _e=$.getElementsByClassName("stage-item-resource-title"),pe=$.getElementsByClassName("course-resource-item-title");this.changeStyle(_e,"fontSize","13px"),this.changeStyle(pe,"fontSize","13px");var W=$.getElementsByClassName("stage-item-resource");this.changeStyle(W,"padding","20px 0"),this.changeStyle(W,"borderBottom","0.5px solid #8C8C8C");var d=$.getElementsByClassName("stage-item-resource-offline");this.changeStyle(d,"paddingTop","10px");var l=this.getLastElementChild(this.getLastElementChild($));l.style.paddingBottom="90px";var p=this.getFirstElementChild($),I=document.createElement("h1");I.innerHTML=window.localStorage.getItem("enterpriseName"),$.insertBefore(I,p);var P=document.createElement("table");P.className="stage-item-table",P.innerHTML=`<tbody>
      <tr>
        <td>\u59D3\u540D</td>
        <td colspan="3">`.concat(u.userName||"",`</td>
      </tr>
      <tr>
        <td>\u6240\u5C5E\u90E8\u95E8</td>
        <td> `).concat(u.departName.replace(/,/g," | ")||"",`</td>
        <td>\u6240\u5C5E\u5C97\u4F4D</td>
        <td>`).concat(u.postNameList?u.postNameList.join(" | "):"",`</td>
      </tr>
    </tbody>`),$.insertBefore(P,p);var V=document.createElement("div");V.className="stage-item-bottom",V.innerHTML=`<div class="item-bottom-left">
        \u64CD\u4F5C\u4EBA\uFF1A`.concat(window.localStorage.getItem("name"),`
    </div>
    <div class="item-bottom-right">
      <span>
          \u5BFC\u51FA\u9879\u76EE\uFF1A\u5B66\u4E60\u8BB0\u5F55
      </span>
      <span>
          \u5BFC\u51FA\u65F6\u95F4\uFF1A`).concat(le,`
      </span>
    </div>`),$.appendChild(V);var j=$.getElementsByClassName("stage-item-resource-progress"),ie=$.getElementsByClassName("course-resource-item-progress"),ue=$.getElementsByClassName("ant-progress-inner"),ge=$.getElementsByClassName("ant-progress-text");this.changeStyle(j,"width","230px"),this.changeStyle(ie,"width","230px"),this.changeStyle(ue,"background","#ebebeb"),this.changeStyle(ge,"color","#000000"),this.changeProgressSvg(j),this.changeProgressSvg(ie);var ce=$.querySelectorAll("svg");ce.length>0&&ce.forEach(ye=>{ye.style.display="none"}),O.appendChild($),X.appendChild(O),r()($,{allowTaint:!0,scale:3}).then(ye=>{for(var be=new(g())("p","mm","a4"),Ie=ye.getContext("2d"),Re=190,Ne=277,Se=Math.floor(Ne*ye.width/Re),Te=0;Te<ye.height;){var De=document.createElement("canvas");De.width=ye.width,De.height=Math.min(Se,ye.height-Te),De.getContext("2d").putImageData(Ie.getImageData(0,Te,ye.width,Math.min(Se,ye.height-Te)),0,0),be.addImage(De.toDataURL("image/jpeg",1),"JPEG",10,10,Re,Math.min(Ne,Re*De.height/De.width)),Te+=Se,Te<ye.height&&be.addPage()}be.save("".concat(u.userName||"\u59D3\u540D","_").concat(G==="project"?k.title:k.trainName||"\u540D\u79F0","_\u5B66\u4E60\u8BB0\u5F55.pdf")),X.removeChild(O),this.setState({downloadPdf:!1})})},this.compileRecord=u=>({userName:u.user_name,departName:u.department_name,postNameList:[]}),this.generateButton=()=>{var u=this.props,U=u.t,k=u.record,G=u.studyType,le=this.state.whiteList,X=le.generatePdf,O=G==="project"?this.compileRecord(k):k;return X?m().createElement(z.Fragment,null,m().createElement(Y.Z,{type:"primary",loading:this.state.downloadPdf,icon:m().createElement(x.Z,null),onClick:()=>this.exportPdf(O)},U("common.generatePdf")),G!=="project"&&m().createElement(Y.Z,{type:"primary",loading:this.state.download,icon:m().createElement(x.Z,null),onClick:()=>this.exportFile()},U("exam.exportQuestion"),"EXCEL")):m().createElement(Y.Z,{type:"primary",loading:this.state.download,icon:m().createElement(x.Z,null),onClick:()=>this.exportFile()},U("exam.exportQuestion"),"EXCEL")},this.footerButton=()=>m().createElement(Y.Z,{onClick:()=>this.handleCancel()},this.props.t("common.unactivated")),this.state={taskInfo:[],download:!1,whiteList:{generatePdf:(0,v.UI)("GENERATE_PDF"),zaraFlag:(0,v.UI)("ZARA_H5")}}}componentDidUpdate(q){q.visible!==this.props.visible&&this.props.visible&&this.getTaskInfo()}render(){var q=this.state.taskInfo,u=this.props,U=u.t,k=u.generatePdf;return m().createElement(T.ZP,(0,se.Z)({},M,{footer:k?this.generateButton():this.footerButton(),visible:this.props.visible,title:U("common.studyRecord"),onCancel:this.handleCancel}),m().createElement("div",{className:"taskstudy-record"},q.map((G,le)=>!G.courseInfo||G.courseInfo.length===0?null:m().createElement("div",{key:le,className:"taskstudy-record-item stage-item"},m().createElement("div",{className:"stage-item-title"},G.stageName),G.courseInfo.map((X,O)=>this.renderResourceItem(X,O))))))}}H.defaultProps={visible:!1,userId:"",taskId:"",studyType:"",onCancel:()=>{}},re.Z=(0,b.$j)(A)((0,Z.Z)()(H))},63848:function(xe,re,e){"use strict";var se=e(36877),J=e(32969),Y=e(12924),a=e.n(Y),N=e(91768),F=e(56130);class L extends a().PureComponent{constructor(){super(...arguments);this.onChange=(R,z)=>{this.props.onChange(R,z)}}render(){var R=this.props,z=R.value,m=R.classify,Z=R.showLabel,x=R.className,b=R.t,_=R.style;return a().createElement("div",{className:"classify-cascader ".concat(x)},Z?a().createElement("span",{className:"classify-cascader-label"},b("component.selectClassifyLabel")):null,a().createElement(J.Z,{changeOnSelect:this.props.changeOnSelect,className:"classify-cascader-select ".concat(x),options:m,onChange:this.onChange,placeholder:b("component.selectClassifyLabel"),value:z,style:_,loadData:this.props.loadData}))}}L.defaultProps={showLabel:!0,changeOnSelect:!0,onChange:()=>{}},re.Z=(0,F.Z)((0,N.Z)()(L))},51697:function(xe,re,e){"use strict";var se=e(22385),J=e(31097),Y=e(33565),a=e(12924),N=e.n(a),F=e(28216),L=e(84874),C=z=>{var m=z.title,Z=z.visible,x=z.placement,b=x===void 0?"top":x,_=z.children,D=_===void 0?null:_,t=z.isNewUser,c=t===void 0?"":t,s=z.closeGuide,g=z.guideStatus,i=(0,a.useState)(!1),r=(0,Y.Z)(i,2),T=r[0],v=r[1],S=Q=>N().createElement("div",{className:"guide-tooltip-title"},Q,N().createElement("span",{onClick:E},N().createElement(L.Z,{iconClass:"icon-f-close",size:"12px",color:"#fff"})));(0,a.useEffect)(()=>{v(Z)},[Z]);var E=Q=>{if(Q.stopPropagation(),Q.preventDefault(),v(!1),s){s();return}c==="true"&&z.dispatch({type:"shouldRenderHeaderGuide",payload:{headerGuideStatus:!0}}),B()},B=()=>{localStorage.setItem("guideStatus","false"),z.dispatch({type:"updateGuideStatus",payload:{guideStatus:"false"}})};return N().createElement(J.Z,{title:S(m),placement:b,visible:T&&g==="true"&&m},D)},R=z=>({guideStatus:z.advancedSetting.guideStatus,isNewUser:z.advancedSetting.isNewUser});re.Z=(0,F.$j)(R)(C)},64630:function(xe,re,e){"use strict";var se=e(62029),J=e(62999),Y=e(85733),a=e(12924),N=e.n(a),F=e(91768),L=e(10237),C=e(37055),R=e(25547),z=Y.Z.TreeNode;class m extends N().Component{constructor(x){super(x);this.getPostTree=()=>{var b=C.ZP.OrgTree.getPostTree();L.WY.get({url:b}).then(_=>{var D=(0,R.NP)(_.data.posts,{id:"value",post_name:"postName"});this.setState({treeData:D})})},this.handleChange=(b,_,D)=>{this.props.onChange(typeof b=="undefined"?"":b,_,D)},this.renderTreeNodes=b=>b.map(_=>{var D=!0;return this.props.noChildSelect&&(D=_.post_type==="post"),_.children?N().createElement(z,{selectable:!this.props.noChildSelect,title:_.postName,key:_.id,value:_.id,isLeaf:!1,dataRef:_},this.renderTreeNodes(_.children)):N().createElement(z,{selectable:D,title:_.postName,dataRef:_,value:_.id,key:_.id,isLeaf:!0})}),this.renderTreeSelect=()=>{var b=this.props,_=b.t,D=b.defaultValue,t=D===void 0?[]:D,c=b.multiple,s=c===void 0?!1:c,g=b.width,i=g===void 0?180:g,r={showSearch:!1,style:{width:i},defaultValue:t,multiple:s,dropdownStyle:{maxHeight:300,overflow:"auto"},placeholder:_("component.choosePostTip"),allowClear:!0,disabled:this.props.disabled};return this.state.treeData.length>0?N().createElement(Y.Z,(0,se.Z)({},r,{onChange:this.handleChange,className:this.props.className}),this.renderTreeNodes(this.state.treeData)):N().createElement("div",{style:{textAlign:"center"}})},this.state={treeData:[]}}componentDidMount(){this.getPostTree()}render(){return N().createElement("div",{className:"org-tree-container ".concat(this.props.className)},this.renderTreeSelect())}}m.defaultProps={disabled:!1,onChange:()=>{}},re.Z=(0,F.Z)()(m)},54792:function(xe,re,e){"use strict";var se=e(62029),J=e(63185),Y=e(9676),a=e(47673),N=e(4107),F=e(88986),L=e(12924),C=e.n(L),R=e(91768),z=e(59239),m=e(55446),Z=e.n(m),x=e(18329),b=e(2396);class _ extends C().Component{constructor(){super(...arguments);this.state={isChecked:!1},this.handleBeforeCreate=()=>{var c=this.props,s=c.form,g=c.id,i=c.onCreate,r=this.state.isChecked;s.validateFields((T,v)=>{if(!T){var S=(0,F.Z)({},v);r||(S.value=0);var E=(0,F.Z)((0,F.Z)({},S),{},{id:g});i(E),setTimeout(()=>{s.resetFields()},100)}})},this.handleBeforeCancel=()=>{var c=this.props,s=c.form,g=c.onCancel;g(),setTimeout(()=>{s.resetFields()},100)},this.checkScore=(c,s,g)=>{var i=this.props.t,r=this.state.isChecked;if(r&&(0,b.kh)(s)){g(i("component.setScoreRuleTip"));return}g()},this.handleCheckChange=c=>{this.setState({isChecked:c.target.checked})},this.renderItem=()=>{var c=this.props,s=c.form,g=c.initialValue,i=c.labelTxt,r=this.state.isChecked,T=s.getFieldDecorator,v={labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:18}}},S=r?T("value",{initialValue:g,rules:[{validator:this.checkScore}]})(C().createElement(N.Z,{maxLength:30,placeholder:""})):null,E=C().createElement(C().Fragment,null,C().createElement(Y.Z,{checked:r,onChange:this.handleCheckChange},i));return C().createElement(z.Z.Item,(0,se.Z)({label:E},v),S)}}componentDidUpdate(c){this.props.visible&&this.props.visible!==c.visible&&this.setState({isChecked:!!this.props.initialValue})}render(){var c=this.props,s=c.visible,g=c.title,i=c.prefixCls;return C().createElement(x.ZP,{size:"small",visible:s,title:g,onCancel:this.handleBeforeCancel,onOk:this.handleBeforeCreate},C().createElement(z.Z,{className:"".concat(i),layout:"horizontal",colon:!1},this.renderItem(),C().createElement("div",{className:"".concat(i,"__children")},this.props.children)))}}_.defaultProps={prefixCls:"cl-setscore",id:"",visible:!1,title:"SetScore",labelTxt:"",initialValue:"",onCancel:()=>{},onCreate:()=>{}};var D=z.Z.create({name:"ClSetupBoxInModal"})(_);re.Z=(0,R.Z)()(D)},18884:function(xe,re,e){"use strict";var se=e(57338),J=e(83107),Y=e(57663),a=e(71577),N=e(47673),F=e(4107),L=e(62029),C=e(81211),R=e(34792),z=e(48086),m=e(57361),Z=e(18106),x=e(88108),b=e(9754),_=e.n(b),D=e(12924),t=e.n(D),c=e(91768),s=e(40847),g=e(99946),i=e(70548),r=e.n(i),T=e(79),v=e(66708),S=e(38642),E=x.Z.TabPane;class B extends t().Component{constructor(y){var w;super(y);w=this,this.onFormMounted=A=>{this.AddFormInstance=A},this.handleCancelShare=()=>{var A=this.props.onCancel;A&&A()},this.getVisitorConfig=(0,m.Z)(_().mark(function A(){var M,H,ee;return _().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,T.L)(localStorage.getItem("enterpriseId"));case 2:M=u.sent,H=M.data,ee=M.status,ee===200&&(H.open_visitor_page==="true"?w.setState({visitorIsOpen:!0,pcDomain:H.pc_domain||""}):w.setState({visitorIsOpen:!1}));case 6:case"end":return u.stop()}},A)})),this.handleCopy=()=>{var A=document.getElementById("share-link");A.select(),document.execCommand("Copy"),z.default.success(this.props.t("live.copySuccess"))},this.renderContent=()=>{var A=this.props,M=A.t,H=A.tabsTitle,ee=A.isProjectShare,q=(0,C.Z)(A,["t","tabsTitle","isProjectShare"]),u=this.state,U=u.active,k=u.visitorIsOpen,G=u.pcDomain,le=u.shareUrl;return k?t().createElement(x.Z,{defaultActiveKey:U,onChange:this.handleTabs},t().createElement(E,{tab:H[0]||M("tutorial.student"),key:"0"},t().createElement("p",{className:r()["share-tip"]},t().createElement(s.Z,{className:r()["info-icon"]}),M("common.traineeShareTip")),t().createElement(v.Z,(0,L.Z)({type:"card",center:!1,label:M("setting.Qrcode"),saveText:M("shareInfo.downloadCode"),downloadAsBtn:!0},q)),le&&!ee&&t().createElement("div",{className:r()["url-share"]},t().createElement("label",null,M("common.urlAddress"),":"),t().createElement("div",{className:r()["right-content"]},t().createElement(F.Z,{className:r()["share-url-input"],readOnly:!0,value:le,id:"share-link"}),t().createElement(a.Z,{type:"primary",className:r()["copy-btn"],onClick:this.handleCopy},M("registerLogin.copyLink")),t().createElement("span",{className:r()["share-tip"]},M("common.shareTip"))))),q.option&&q.option.flag==="exam_task"?null:t().createElement(E,{tab:H[1]||M("common.tourist"),key:"1"},t().createElement(g.Z,(0,L.Z)({onFormMounted:this.onFormMounted,handleVisitorTabs:this.visitorTabs,pcDomain:G},q)))):t().createElement(D.Fragment,null,t().createElement("p",{className:r()["share-tip"]},t().createElement(s.Z,{className:r()["info-icon"]}),M("common.traineeShareTip")),t().createElement(v.Z,(0,L.Z)({type:"card",center:!1,label:M("setting.Qrcode"),saveText:M("shareInfo.downloadCode"),downloadAsBtn:!0},q)),le&&!ee&&t().createElement("div",{className:r()["url-share"]},t().createElement("label",null,M("common.urlAddress"),":"),t().createElement("div",{className:r()["right-content"]},t().createElement(F.Z,{className:r()["share-url-input"],readOnly:!0,value:le,id:"share-link"}),t().createElement(a.Z,{type:"primary",className:r()["copy-btn"],onClick:this.handleCopy},M("registerLogin.copyLink")),t().createElement("span",{className:r()["share-tip"]},M("common.shareTip")))))},this.state={active:0,visitorIsOpen:!1,pcDomain:"",shareUrl:""}}componentDidMount(){this.getVisitorConfig()}componentDidUpdate(y){var w=this.props.option;if(y.option.flag!==w.flag&&w.flag==="share_course_enterprise"){var A=(0,S.dU)(),M=localStorage.getItem("enterpriseId");this.setState({shareUrl:"".concat("https://mobile.coolcollege.cn","/assets-share-link.html?env=").concat(A,"&eid=").concat(M,"&").concat(w.scene,"&msgSource=shareLink")})}}render(){var y=this.props,w=y.title,A=y.visible;return t().createElement(J.Z,{title:w,className:r()["share-modal"],width:560,onClose:this.handleCancelShare,visible:A,destroyOnClose:!0,footerStyle:{textAlign:"right"},bodyStyle:{paddingTop:10,paddingLeft:30,paddingRight:30}},this.renderContent())}}B.defaultProps={visible:!0,title:"",onCancel:()=>{},tip:"",record:{},option:{flag:"",scene:""},tabsTitle:["",""]},re.Z=(0,c.Z)()(B)},41194:function(xe,re,e){"use strict";var se=e(47673),J=e(4107),Y=e(57663),a=e(71577),N=e(34792),F=e(48086),L=e(12924),C=e.n(L),R=e(91768),z=e(92592),m=e(87797),Z=e.n(m);class x extends C().Component{constructor(_){super(_);this.handleDownload=()=>{var D=document.getElementById("code_canvas"),t=this.state.codeUrl,c=new Image;c.crossOrigin="anonymous",c.src=t,c.onload=()=>{var s=D.getContext("2d");s.textAlign="center",s.fillStyle="#fff",s.fillRect(0,0,750,886),s.drawImage(c,185,217,381,381),s.font="42px bold serif",s.fillStyle="#4F4F4F";var g=D.toDataURL("image/jpeg"),i=document.createElement("a");i.setAttribute("href",g),i.setAttribute("download","".concat(this.props.t("setting.Qrcode"),".jpg")),document.body.insertAdjacentElement("beforeend",i),i.click(),i.remove()}},this.handleCopy=()=>{var D=this.props.id,t=document.getElementById(D||"visitor-link");t.select(),document.execCommand("Copy"),F.default.success(this.props.t("live.copySuccess"))},this.state={codeUrl:""}}componentDidMount(){this.props.shareUrl&&z.toDataURL(this.props.shareUrl,{width:500}).then(_=>{this.setState({codeUrl:_})}).catch(()=>{F.default.error(this.props.t("integralMall.qrCodeFailed"))})}componentDidUpdate(_){_.shareUrl!==this.props.shareUrl&&this.props.shareUrl&&z.toDataURL(this.props.shareUrl,{width:500}).then(D=>{this.setState({codeUrl:D})}).catch(()=>{F.default.error(this.props.t("integralMall.qrCodeFailed"))})}render(){var _=this.props,D=_.shareUrl,t=_.t,c=_.notShowQrCode,s=_.urlLabel,g=_.id,i=this.state.codeUrl;return C().createElement(L.Fragment,null,c?null:C().createElement("div",{className:Z()["visitor-qrCode-share"]},C().createElement("label",null,t("setting.Qrcode"),":"),C().createElement("div",{className:Z()["qrCode-section"]},C().createElement("img",{className:Z()["qrCode-img"],src:i,alt:""}),C().createElement("canvas",{className:Z()["code-canvas"],id:"code_canvas",width:750,height:886}),C().createElement(a.Z,{type:"primary",className:Z()["download-btn"],onClick:this.handleDownload},t("shareInfo.downloadCode")))),C().createElement("div",{className:Z()["visitor-url-share"]},C().createElement("label",null,s||t("common.urlAddress"),":"),C().createElement("div",{className:Z()["right-content"]},C().createElement(J.Z,{className:Z()["share-url-input"],readOnly:!0,value:D,id:g||"visitor-link"}),C().createElement(a.Z,{type:"primary",className:Z()["copy-btn"],onClick:this.handleCopy},t("registerLogin.copyLink")),C().createElement("span",{className:Z()["share-tip"]},t("common.shareTip")))))}}x.defaultProps={shareUrl:"",notShowQrCode:!1,urlLabel:"",id:"visitor-link"},re.Z=(0,R.Z)()(x)},79:function(xe,re,e){"use strict";e.d(re,{L:function(){return Y}});var se=e(5430),J=e(10237);function Y(a){var N=se.ZP.visitors.getVisitorSetting(a);return J.WY.get({url:N})}},99946:function(xe,re,e){"use strict";var se=e(12924),J=e.n(se),Y=e(91768),a=e(40847),N=e(41194),F=e(51431),L=e.n(F);class C extends J().Component{constructor(z){super(z);this.handleVisitorTabs=m=>{var Z=this.props.handleVisitorTabs;Z&&Z(m)},this.state={shareUrl:"",excludeDomains:["localhost","127.0.0.1"]}}componentDidMount(){var z=this.state.excludeDomains,m=this.props,Z=m.option,x=m.pcDomain,b=x||window.location.hostname||document.domain||"",_=window.location.port,D=localStorage.getItem("enterpriseId");b&&z.indexOf(b)<0?this.setState({shareUrl:"https://".concat(b,"/#/visitor?").concat(Z.scene,"&enterpriseId=").concat(D)}):this.setState({shareUrl:"http://".concat(b,":").concat(_,"/#/visitor?").concat(Z.scene,"&enterpriseId=").concat(D)})}render(){var z=this.props,m=z.t,Z=z.tip,x=z.onlyUrl,b=z.urlLabel,_=z.id,D=this.state.shareUrl;return J().createElement("div",{className:L()["visitor-share-content"]},J().createElement("p",{className:L()["share-tip"]},J().createElement(a.Z,{className:L()["info-icon"]}),Z||m("common.visitorShareTip")),J().createElement(N.Z,{id:_,shareUrl:x||D,urlLabel:b}))}}C.defaultProps={record:{},shareUrl:"",tip:"",urlLabel:"",id:""},re.Z=(0,Y.Z)()(C)},11449:function(xe,re,e){"use strict";e.d(re,{Z:function(){return Q}});var se=e(88986),J=e(33565),Y=e(12924),a=e.n(Y),N=e(3115),F=e(49111),L=e(19650),C=e(62029),R=e(57663),z=e(71577),m=e(91768),Z=e(28216),x=e(37055),b=e(10237);function _(y){var w=x.ZP.getHelpContentByMenuKey(),A={key:y};return b.WY.get({url:w,params:A})}var D=e(74228),t=e.n(D),c=e(1164),s=e(76466),g=e(38642);class i extends a().Component{constructor(w){var A;super(w);A=this,this.getHelpContentByMenuKey=()=>{var M=this.props.defaultMenuKey;_(M).then(H=>{var ee=H.data,q=ee.help_url,u=ee.video_url;this.setState({videoUrl:u,helpUrl:q})})},this.handleOpenHelpUrl=M=>{if((0,g.ve)()){window.open(M,"_blank");return}c.Z.targetTo({path:M,isExternalLink:!0})},this.handleOpenVideo=function(M){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:A.props.t("helpCenter.video");A.setState(ee=>({resourcePlayInfo:(0,se.Z)((0,se.Z)({},ee.resourcePlayInfo),{},{resourceInfo:{originUrl:M,source:{FD:M,OD:M},contentType:"mp4"}}),previewInfo:(0,se.Z)((0,se.Z)({},ee.previewInfo),{},{title:H,visible:!0,onCancel:A.handleCancelPreview})}))},this.handleCancelPreview=()=>{var M=this.state.previewInfo;this.setState({resourcePlayInfo:{mode:"preview",watchType:"video",resourceInfo:{}},previewInfo:(0,se.Z)((0,se.Z)({},M),{},{visible:!1})})},this.state={helpUrl:"",videoUrl:"",resourcePlayInfo:{autoPlay:!0,draggable:!0,mode:"preview",resourceInfo:{},watchType:"video"},previewInfo:{visible:!1,destroyOnClose:!0,title:w.t("helpCenter.video")||"\u89C6\u9891\u6307\u5BFC",onCancel:()=>{}}}}componentDidMount(){this.getHelpContentByMenuKey()}render(){var w=this.state,A=w.helpUrl,M=w.resourcePlayInfo,H=w.previewInfo,ee=w.videoUrl,q=this.props.t;return a().createElement("div",{className:t().helpCenter},ee&&a().createElement(z.Z,{type:"link",className:t()["video-btn"],style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenVideo(ee)},q("helpCenter.video")),A&&a().createElement(z.Z,{type:"link",style:{borderWidth:"0px",padding:"0"},onClick:()=>this.handleOpenHelpUrl(A)},q("helpCenter.tutorial")),a().createElement(s.Z,(0,C.Z)({},M,{previewInfo:H})))}}var r=y=>({defaultMenuKey:y.currentRoute.menuKey});i.defaultProps={defaultMenuKey:""};var T=(0,Z.$j)(r)((0,m.Z)()(i));function v(y){var w=y.extra,A=localStorage.getItem("dingPersonnel"),M=sessionStorage.getItem("dingPersonnel");return a().createElement(L.Z,null,w,A!=="dingPersonnel"&&M!=="dingPersonnel"&&(0,g.eY)("COMMONEXTRA_HELP_CENTER")&&a().createElement(T,null))}var S=v,E=e(4408);function B(y){var w=(0,Y.useState)({helpCenter:(0,g.eY)("HEAD_HELP_CENTER_BUT")}),A=(0,J.Z)(w,1),M=A[0],H=y.pageContainerParams,ee=H===void 0?{}:H,q=y.noPadding,u=q===void 0?!1:q,U=y.isPersonal,k=U===void 0?!1:U,G=y.pageTitle,le=y.className,X=le===void 0?"":le,O={extra:M.helpCenter?a().createElement(S,{extra:ee.extra}):ee.extra},ae=(0,se.Z)((0,se.Z)({},ee),O);return a().createElement("div",{className:"page-container-content ".concat(u?"page-container-noPadding":""," ").concat(k?"page-container-content_personal_background":""," ").concat(X)},G&&a().createElement(E.Z,{title:G}),k?a().createElement(N.Z,null,y.children):a().createElement(N.Z,ae,y.children))}var Q=B},47745:function(xe,re,e){"use strict";e.d(re,{Z:function(){return E}});var se=e(34792),J=e(48086),Y=e(88986),a=e(57663),N=e(71577),F=e(71153),L=e(60331),C=e(12924),R=e.n(C),z=e(91768),m=e(76651),Z=e(87722);class x extends R().Component{constructor(){super(...arguments);this.handleTimeRange=Q=>{var y=Q.startTime,w=Q.endTime,A=Q.dateStrings;if(!A.filter(H=>H).length){this.props.handleChangeDataRange({startTime:"",endTime:""});return}var M={startTime:y,endTime:w};this.props.handleChangeDataRange(M)}}render(){return R().createElement("div",{className:"exam-grades__query"},R().createElement(Z.Z,{timestamp:!0,showTime:!0,format:"YYYY-MM-DD HH:mm",onCustomChange:this.handleTimeRange}))}}var b=(0,z.Z)()(x),_=e(84391),D=B=>{var Q=B.t,y=B.shouldRenderExport;return R().createElement("div",{className:"exam-grades__query"},y&&R().createElement(N.Z,{type:"primary",onClick:B.handleExport},R().createElement(_.Z,null),Q("common.exportData")))},t=(0,z.Z)()(D),c=e(38642),s=e(10237),g=e(37055),i=e(6793),r=e(18329),T=e(95664),v=e(36202);class S extends R().Component{constructor(Q){super(Q);this.getTableColumns=()=>{var y=[{title:this.props.t("personal.submitTime"),dataIndex:"planId",key:"planId",width:160,render:(H,ee)=>R().createElement("span",{className:"exam-grades__table__cell"},(0,i.p6)(ee.commit_time,"yyyy-MM-dd hh:mm:ss"),ee.score_rule===1?R().createElement(L.Z,{color:"#CF3C3C"},this.props.t("myExamTask.highest")):null,ee.score_rule===2?R().createElement(L.Z,{color:"#FFA000"},this.props.t("myExamTask.newest")):null)},{title:this.props.t("examing.examTotalScore"),dataIndex:"total_score",key:"total_score",width:100},{title:this.props.t("myExamTask.score"),dataIndex:"score",key:"score",width:100,render:(H,ee)=>ee.status===5?"--":H},{title:this.props.t("exam.examTime"),dataIndex:"duration",key:"duration",width:100,render:H=>(0,i.xj)(H)},{title:this.props.t("exam.examResult"),dataIndex:"result",key:"result",width:120},{title:this.props.t("common.operate"),width:100,key:"operate",render:H=>this.props.type==="user"?this.userOperation(H):this.adminOperation(H)}],w={title:this.props.t("exam.marker"),width:100,dataIndex:"marker_name",key:"marker_name"},A=this.props.type,M=A===void 0?"admin":A;return M==="admin"&&y.splice(4,0,w),y},this.userOperation=y=>R().createElement(C.Fragment,null,y.view_rule===0&&R().createElement(N.Z,{type:"link",size:"small",disabled:!0},this.props.t("common.viewDetails")),y.view_rule===1&&R().createElement(N.Z,{type:"link",size:"small",onClick:()=>this.viewDetails(y)},this.props.t("myExamTask.answerAnalytics")),y.view_rule===2&&R().createElement(N.Z,{type:"link",size:"small",onClick:()=>this.viewDetails(y)},this.props.t("exam.viewRightAndWrong"))),this.adminOperation=y=>R().createElement(C.Fragment,null,y.status===5?R().createElement("div",{className:"cl-table__cell-action"},R().createElement("span",{className:"cl-pointer cl-disabled"}," ",this.props.t("common.viewDetails"))):R().createElement("div",{className:"cl-table__cell-action",onClick:()=>this.viewDetails(y)},R().createElement("span",{className:"cl-pointer"}," ",this.props.t("common.viewDetails")))),this.viewDetails=y=>{var w=y.user_id,A=y.plan_id,M=y.makeup_count,H=this.props,ee=H.pageFrom,q=H.taskId,u=H.type,U=u===void 0?"admin":u,k="";U==="admin"?k="/training/examination/result?pageFrom=examMonitor&id=".concat(A,"&userId=").concat(w,"&makeupCount=").concat(M):ee==="myObligatoryTask"?k="/training/examination/result/personal?fromPage=myObligatoryTask&id=".concat(A,"&userId=").concat(w,"&taskId=").concat(q,"&makeupCount=").concat(M):ee==="myExamTask"?k="/training/examination/result/personal?pageFrom=myExamTask&id=".concat(A,"&userId=").concat(w,"&makeupCount=").concat(M):k="/training/examination/result/personal?id=".concat(A,"&userId=").concat(w,"&makeupCount=").concat(M),U==="admin"?m.m8.push(k):(0,c.eJ)({url:k})},this.initTableList=()=>{var y=this.props.planId;s.WY.get({url:g.ZP.ExaminationPlanMonitor.getExamAllGrades(y),params:(0,Y.Z)({},this.state.params)}).then(w=>{setTimeout(()=>{this.setState({showList:!0,loading:!1,tableList:w.data.list,tableTotal:Number(w.data.total),tableTotalPages:w.data.pages})},300)}).catch(()=>{this.setState({showList:!1,loading:!1}),this.props.hideEveryExamGrade()})},this.handleTableChange=y=>{var w=this.state.params;w.page_number=y,this.setState({params:w},()=>{this.initTableList()})},this.handleChangeDataRange=y=>{this.setState(w=>({params:(0,Y.Z)((0,Y.Z)({},w.params),{},{commit_time_start:y.startTime,commit_time_end:y.endTime})}),()=>{this.initTableList()})},this.handleExport=()=>{var y=this.props,w=y.t,A=y.planId,M=g.ZP.ExaminationPlanMonitor.exportExamAllGrades(A),H=this.state.params,ee=H.commit_time_start,q=H.commit_time_end,u=H.user_id;M+="?access_token=".concat(window.localStorage.getItem("token"),"&commit_time_start=").concat(ee,"&commit_time_end=").concat(q)+"&user_id=".concat(u),window.location.href=M,J.default.success(w("study.exportSucceed"))},this.onCancel=()=>{this.props.hideEveryExamGrade()},this.renderFooter=()=>{var y=this.props.t;return R().createElement(N.Z,{type:"primary",onClick:this.onCancel},y("common.cancel"))},this.renderLeftRow=()=>R().createElement(b,{handleChangeDataRange:this.handleChangeDataRange}),this.renderRightRow=()=>{var y=this.props.type,w=y===void 0?"admin":y;return R().createElement(t,{shouldRenderExport:w==="admin",handleExport:this.handleExport})},this.state={loading:!0,params:{commit_time_start:"",commit_time_end:"",user_id:"",page_number:1,page_size:10},tableList:[],tableTotal:0,tableTotalPages:0,showList:!1}}componentDidUpdate(Q){this.props.visible&&this.props.visible!==Q.visible&&this.props.userId&&this.setState({params:{commit_time_start:"",commit_time_end:"",user_id:this.props.userId,page_number:1,page_size:10,task_id:this.props.taskId},tableList:[],tableTotal:0,tableTotalPages:0},()=>{this.initTableList()})}render(){var Q=this.props,y=Q.visible,w=Q.t,A=Q.planTitle,M=this.state,H=M.showList,ee=M.loading,q=M.params,u=M.tableList,U=M.tableTotal,k=M.tableTotalPages;return R().createElement("div",null,y&&H?R().createElement(r.ZP,{size:"large",visible:y,title:w("exam.examDetails"),onCancel:this.onCancel,onOk:this.onCancel,footer:this.renderFooter()},R().createElement("div",{className:"exam-grades"},R().createElement("div",{className:"exam-grades__title"},A),R().createElement(v.f,{bordered:!0,columns:this.getTableColumns(),rowKey:"makeup_count",dataSource:u,pagination:!1,loading:ee,headerTitle:this.renderLeftRow(),toolBarRender:this.renderRightRow,tableUUID:"a7d5cb8a-163d-4795-953e-ae47d83ee50d"}),R().createElement(T.Z,{defaultPageSize:10,totalNum:U,totalPage:k,current:q.page_number,showRenderRefresh:!1,onChange:this.handleTableChange}))):null)}}var E=(0,z.Z)()(S)},72456:function(xe,re,e){"use strict";var se=e(49111),J=e(19650),Y=e(57663),a=e(71577),N=e(12924),F=e.n(N),L=e(28216),C=e(91768),R=e(84391),z=e(90631),m=e(49101),Z=e(76651),x=e(31945),b=e(1164),_=e(51697),D=c=>{var s=c.user,g=c.currentRoute,i=c.advancedSetting;return{currentPath:g.path,allAuthRoutes:g.allAuthRoutes,userLng:s.lng,themeColor:i.themeColor,qyShield:s.qyShield}};class t extends F().Component{constructor(){super(...arguments);this.handleDownload=()=>{this.props.onDownload()},this.handleImport=()=>{this.props.onImport()},this.handleCreate=()=>{var s=this.props.tabLink;Z.m8.push(s)},this.renderActionBtn=()=>{var s=this.props,g=s.prefixCls,i=s.actionText,r=s.t,T=s.tabLink,v=s.showBtn,S=s.renderActionBtn,E=s.newPage,B=s.popOverProps,Q=B===void 0?[]:B,y=s.renderGuide,w=y===void 0?!1:y,A=s.showDownloadBtn,M=A===void 0?!1:A,H=s.showImportBtn,ee=H===void 0?!1:H,q=s.showCreateBtn,u=q===void 0?!0:q,U=s.rowReverse,k=U===void 0?!1:U,G="".concat(g,"__action");if(!v&&S&&typeof S=="function")return F().createElement("div",{className:G},S());if(!v||!i)return null;var le=Q.length?Q[0].contentText:"";return F().createElement("div",{className:"".concat(G," ").concat(k&&"row-reverse")},F().createElement(J.Z,{size:16},M&&F().createElement(a.Z,{icon:F().createElement(R.Z,null),onClick:this.handleDownload},r("common.exportData")),ee&&F().createElement(a.Z,{icon:F().createElement(z.Z,null),onClick:this.handleImport},r("exam.importTemplate")),u&&E&&F().createElement(b.Z,{to:T},F().createElement(_.Z,{visible:le&&w,placement:"topLeft",title:le},F().createElement(a.Z,{type:"primary",id:"create-project-button",icon:F().createElement(m.Z,null)},i))),u&&!E&&F().createElement(a.Z,{type:"primary",id:"create-project-button",icon:F().createElement(m.Z,null),onClick:this.handleCreate},i)))},this.renderQueryRow=()=>{var s=this.props,g=s.queryRowParams,i=s.queryRowList,r=s.queryRowSelectedCourseIds,T=s.queryRowSelectedProjectIds,v=s.queryRowOnForceRender,S=s.queryRowOnClassifyChange,E=s.queryRowOnTypeChange,B=s.queryRowOnCourseTypeChange,Q=s.queryRowAllowActions,y=s.showNum,w=y===void 0?1:y;return F().createElement(x.Z,{params:g,list:i,selectedCourseIds:r,selectedProjectIds:T,onForceRender:v,onClassifyChange:S,onTypeChange:E,onCourseTypeChange:B,allowActions:Q,showNum:w,showRenderCondition:!1})},this.rendeExtraBtn=()=>{var s=this.props,g=s.t,i=s.extraBtnSelectedRowKeys,r=s.extraBtnHandleMultiVisibleRange;return F().createElement(a.Z,{disabled:i.length===0,onClick:r},g("courseManage.setTheVisibility"))}}render(){var s=this.props,g=s.prefixCls,i=s.wrapCls,r=s.showRenderQueryRow,T=s.showRendeExtraBtn;return F().createElement(F().Fragment,null,F().createElement("div",{className:"render_other"},F().createElement("header",{className:"".concat(g," ").concat(i)},F().createElement("section",{className:"".concat(g,"__radiocol")},this.renderActionBtn(),r&&this.renderQueryRow(),T&&this.rendeExtraBtn()))))}}t.defaultProps={prefixCls:"cl-listQueryRow",wrapCls:"",label:"",actionText:"add",showSearch:!0,showBtn:!0,newPage:!0,searchStylesProps:{},selectList:[],renderActionBtn:()=>null},re.Z=(0,L.$j)(D)((0,C.Z)()(t))},62117:function(xe,re,e){"use strict";var se=e(63185),J=e(9676),Y=e(43358),a=e(34041),N=e(88983),F=e(47933),L=e(12924),C=e.n(L),R=e(28216),z=e(91768),m=e(48479),Z=e(2971),x=e(45601),b=e(7249),_=t=>{var c=t.user,s=t.currentRoute,g=t.advancedSetting;return{currentPath:s.path,allAuthRoutes:s.allAuthRoutes,userLng:c.lng,themeColor:g.themeColor,appType:c.appType,appId:c.appId}};class D extends C().Component{constructor(c){super(c);this.setPlaceholder=()=>{var s=this.props,g=s.currentPath,i=s.allAuthRoutes,r=s.userLng,T=this.state.language,v=i[g],S=this.props,E=S.appType,B=S.appId,Q=localStorage.getItem("qyWechatBook"),y=E==="wx_app"&&Q==="true"&&B==="9005";if(!!v){var w=T[r].searchInputPlaceholder,A="";v.menuKey==="studyTemplate"||v.menuKey==="examTemplate"?A=w.template:v.menuKey==="employee"||v.menuKey==="obligatory"||v.menuKey==="elective"||v.menuKey==="plan"||v.menuKey==="evaluation"||v.menuKey==="myEvaluationPlan"?A=w.task:v.menuKey==="studyProject"?A=y?w.byProjectName:w.byProjectNameOrCreator:v.menuKey==="management"?A=y?w.byTaskName:w.byTaskNameOrCreator:A=w[v.menuKey],this.setState({currentPlaceholder:A})}},this.handleRadiosChange=s=>{this.props.onRadiosChange(s.target.value)},this.handleSelectChange=s=>{this.props.onSelectChange(s)},this.handleSearch=(s,g)=>{this.props.onSearch(s,g)},this.handleChange=s=>{this.props.onCheckboxChange(s.target.checked)},this.renderRadios=()=>{var s=this.props,g=s.prefixCls,i=s.radioList,r=s.defaultRadioValue,T=s.radioValue;if(!i.length)return null;var v=r||i[0].value,S="".concat(g,"__radios");return C().createElement("div",{className:S},typeof T!="undefined"?C().createElement(F.ZP.Group,{defaultValue:v,value:T,onChange:this.handleRadiosChange},i.map(E=>C().createElement(F.ZP.Button,{key:E.value,value:E.value},E.name))):C().createElement(F.ZP.Group,{defaultValue:v,onChange:this.handleRadiosChange},i.map(E=>C().createElement(F.ZP.Button,{key:E.value,value:E.value},E.name))))},this.renderSelect=()=>{var s=this.props,g=s.prefixCls,i=s.selectList,r=s.defaultSelectValue;if(!i.length)return null;var T=r||i[0].value,v="".concat(g,"__select");return C().createElement("div",{className:v},C().createElement(a.Z,{defaultValue:T,onChange:this.handleSelectChange,style:{minWidth:100}},i.map(S=>C().createElement(a.Z.Option,{key:S.value,value:S.value},S.name))))},this.renderOther=()=>{var s=this.props,g=s.prefixCls,i=s.renderOther,r=s.showOther,T="".concat(g,"__other");if(r&&i&&typeof i=="function")return C().createElement("div",{className:T},i())},this.renderCheckbox=()=>{var s=this.props,g=s.prefixCls,i=s.t,r=s.label,T=s.showCheckbox,v=s.renderActionSelect,S="".concat(g,"__checkbox");return!T&&v&&typeof v=="function"?C().createElement("div",{className:S},v()):T?C().createElement("div",{className:S},C().createElement(J.Z,{onChange:this.handleChange},r||i("common.myCreated"))):null},this.renderSearch=()=>{var s=this.props,g=s.prefixCls,i=s.showSearch,r=s.inputPlaceholder,T=s.maxLength,v=T===void 0?400:T,S=s.value,E="".concat(g,"__search");if(!i)return null;var B=this.state.currentPlaceholder;return r?C().createElement("div",{className:E},C().createElement(m.Z,{onSearch:this.handleSearch,placeholder:r,width:272,maxLength:v})):C().createElement("div",{className:E},C().createElement(m.Z,{onSearch:this.handleSearch,placeholder:B,width:272,maxLength:v,value:S}))},this.renderSearchOther=()=>{var s=this.props.renderSearchOther;return s?s():null},this.state={language:{zh_cn:x.Z,en_us:Z.Z,zh_hk:b.Z},currentPlaceholder:""}}componentDidMount(){this.setPlaceholder()}componentDidUpdate(c){c.userLng!==this.props.userLng&&this.setPlaceholder()}render(){var c=this.props,s=c.prefixCls,g=c.wrapCls,i=c.showRenderRadios,r=i===void 0?!0:i,T=c.showRenderSelect;return C().createElement(C().Fragment,null,C().createElement("div",{className:"render_other"},this.renderOther(),C().createElement("header",{className:"".concat(s," ").concat(g)},C().createElement("section",{className:"".concat(s,"__searchcol")},this.renderSearchOther(),this.renderCheckbox(),r&&this.renderRadios(),T&&this.renderSelect(),this.renderSearch()))))}}D.defaultProps={prefixCls:"cl-listQueryRow",wrapCls:"",label:"",showRadioList:!0,showCheckbox:!0,showSearch:!0,inputPlaceholder:"",defaultRadioValue:"",radioList:[],searchStylesProps:{},showRenderSelect:!1,selectList:[],renderActionBtn:()=>null,onRadiosChange:()=>{},onSearch:()=>{},onCheckboxChange:()=>{},renderSearchOther:()=>{}},re.Z=(0,R.$j)(_)((0,z.Z)()(D))},410:function(xe,re,e){"use strict";e.d(re,{Z:function(){return pe}});var se=e(62029),J=e(22385),Y=e(31097),a=e(54029),N=e(62529),F=e(57663),L=e(71577),C=e(88986),R=e(33565),z=e(18106),m=e(88108),Z=e(12924),x=e.n(Z),b=e(91768),_=e(54549),D=e(78138),t=e.n(D),c=e(28216),s=e(57068),g=e(70018),i=e(20228),r=e(11382),T=e(76586),v=e.n(T),S=e(6793),E=window.Plots.Line,B=W=>{var d=W.params,l=W.height,p=W.t,I=(0,Z.useRef)(),P=(0,Z.useState)(null),V=(0,R.Z)(P,2),j=V[0],ie=V[1],ue=(0,Z.useState)(!0),ge=(0,R.Z)(ue,2),ce=ge[0],ye=ge[1];(0,Z.useEffect)(()=>{(0,g.yZ)((0,C.Z)((0,C.Z)({},d),{},{page_number:1,page_size:30})).then(Ie=>{if(Ie.data.code&&Ie.data.code==="200000"){var Re=(Ie.data.data.list||[]).reverse(),Ne=Re.map(Te=>{var De=Te.total_score;return De}),Se={height:220,data:Re,xField:"submit_time",yField:"score",point:{size:4,shape:"circle",color:"#516AE6"},yAxis:{tickCount:5,min:0,max:Math.max(...Ne)},xAxis:{tickCount:Re.length<=7?Re.length:7,label:{formatter:Te=>(0,S.p6)(+Te,new Date(+Te).getFullYear()===new Date().getFullYear()?"MM/dd":"yyyy/MM/dd")}},tooltip:{customContent:(Te,De)=>{var Pe=De.length>0&&"<div class=".concat(v()["custom-content-container"],`>
                  <div class=`).concat(v().top,`>
                    <span class=`).concat(v().score,">").concat(De[0].data.score," ").concat(p("common.examScoreUnit"),`</span>
                    `).concat(De[0].data.score_record_type==="latest"||De[0].data.score_record_type==="highest"?"<span class=".concat(v()["custom-content-flag"],">").concat(De[0].data.score_record_type==="latest"?p("myExamTask.newest"):p("myExamTask.highest"),"</span>"):"",`
                  </div>
                  <div class=`).concat(v().bottom,">").concat((0,S.p6)(+De[0].data.submit_time,new Date(+De[0].data.submit_time).getFullYear()===new Date().getFullYear()?"MM/dd hh:mm":"yyyy/MM/dd hh:mm"),`</div>
                </div>`);return Pe}},smooth:!0};ie(Se)}}).finally(()=>{ye(!1)})},[d,p]);var be=()=>{var Ie=I.current.chart.filteredData,Re=Ie.find(De=>{var Pe=De.score_record_type;if(Pe==="latest"||Pe==="highest")return De});if(Re){var Ne=I.current.chart.getXY(Re),Se=Ne.x,Te=Ne.y;I.current.chart.showTooltip({x:Se,y:Te})}};return x().createElement(r.Z,{spinning:ce},x().createElement("div",{className:v()["record-chart-container"],style:{maxHeight:"".concat(l,"px")}},j&&!ce&&x().createElement(E,(0,se.Z)({},j,{height:l-32,onReady:Ie=>{I.current=Ie,be(),Ie.on("mouseout",()=>{be()})}}))))},Q=(0,b.Z)()(B),y=e(9121),w=e.n(y),A=e(99367),M=e(38642),H=e(67479),ee=e(1164),q=e(97593),u=e(57338),U=e(83107),k=e(8965),G=e.n(k),le=e(12968),X=e(44208),O=e(44963),ae=e.n(O);function $(W){var d=W.t,l=W.examId,p=W.submitId,I=W.userId,P=(0,Z.useRef)(),V=(0,c.I0)(),j=(0,Z.useState)({status:"",examId:l,userId:I,submitId:p}),ie=(0,R.Z)(j,1),ue=ie[0],ge=(0,Z.useState)({total_count:0,success_count:0,fail_count:0}),ce=(0,R.Z)(ge,2),ye=ce[0],be=ce[1];(0,Z.useEffect)(()=>{(0,g.wg)({examId:l,submitId:p,userId:I}).then(Pe=>{var Ke=Pe.data,Be=Ke.code,$e=Ke.data;if(Be==="200000"){var Ue=$e.fail_count,Fe=Ue===void 0?0:Ue,Ye=$e.success_count,He=Ye===void 0?0:Ye,Ge=$e.total_count,Je=Ge===void 0?0:Ge;be({total_count:Je,success_count:He,fail_count:Fe})}})},[l,p,I]);function Ie(Pe){var Ke=(0,C.Z)({},Pe);return(0,g.G2)(Ke)}var Re=()=>x().createElement(L.Z,{type:"primary",onClick:Se},d("common.exportData")),Ne=()=>{var Pe=W.t,Ke=[{key:"total",name:Pe("examination.faceRecognitionInExam.verifyCount"),num:ye.total_count,color:"rgb(0, 0, 0, 0.45)",backgroundColor:"#F8F9FB"},{key:"passed",name:Pe("examination.faceRecognitionInExam.verifySuccess"),num:ye.success_count,color:"rgb(139, 191, 100)",backgroundColor:"rgb(139, 191, 100,0.2)"},{key:"failed",name:Pe("examination.faceRecognitionInExam.verifyFailed"),num:ye.fail_count,color:"rgb(207, 60, 60)",backgroundColor:"rgb(207, 60, 60,0.2)"}];return Ke.map(Be=>{var $e=Be.name,Ue=Be.num,Fe=Be.color,Ye=Be.backgroundColor,He=Be.key;return x().createElement("span",{className:ae()["type-item"],style:{backgroundColor:Ye,color:Fe},key:He},"".concat($e," : ").concat(Ue))})};function Se(){(0,q.N)({page:"exportFaceRecognitionRecord",props:{dispatch:V,t:d},rest:{userId:I,examId:l,submitId:p},query:"?".concat(s.stringify(ue)),sendType:"get"})}var Te=(0,Z.useMemo)(()=>({success:{text:d("examination.faceRecognitionInExam.verifySuccess"),color:"#52C41A"},failed:{text:d("examination.faceRecognitionInExam.verifyFailed"),color:"#F5222D"}}),[d]),De=[{title:d("examination.faceRecognitionInExam.verifyTime"),key:"check_time",render:Pe=>(0,S.p6)(+Pe,"yyyy-MM-dd hh:mm")},{title:d("examination.faceRecognitionInExam.verifyImg"),key:"snapshot_url",render:Pe=>x().createElement(X.Z,{className:ae()["snapshot-container"],width:28,height:28,src:Pe})},{title:d("examination.faceRecognitionInExam.verifyResult"),key:"result",render:Pe=>x().createElement("div",{className:ae()["status-container"]},x().createElement("span",{className:ae().status,style:{backgroundColor:Te[Pe].color}}),Te[Pe].text)}];return x().createElement("div",{className:ae()["face-recognition-record-container"],style:W.style},x().createElement(A.Z,{ref:P,uuid:"22A4178B-6803-9BC5-DFDB-F6CD6A90C4C8",queryParams:{columns:De,query:Ie},queryParam:ue,pagination:!0,options:!1,scroll:{x:"max-content",y:"calc(100vh - 300px)"},tableAlertRender:()=>!1,headerTitle:Ne(),toolBarRender:Re}))}var de=(0,b.Z)()($);function he(W){var d=W.t,l=W.drawerTitle,p=W.onCloseDrawer,I=W.examId,P=W.submitId,V=W.userId,j=()=>x().createElement("div",{className:G()["footer-container"]},x().createElement(L.Z,{type:"primary",onClick:p},d("common.close")));return x().createElement(U.Z,(0,se.Z)({title:l,placement:"right",width:716,bodyStyle:{padding:"0 24px 16px 24px"},onClose:p,footer:j()},W),x().createElement("div",null,W.visible&&x().createElement(de,{examId:I,submitId:P,userId:V})))}var oe=(0,b.Z)()(he),ve=m.Z.TabPane;function _e(W){var d=W.t,l=W.examId,p=W.taskId,I=W.userId,P=W.from,V=P===void 0?"user":P,j=W.taskType,ie=j===void 0?"all":j,ue=W.renderExamRecordTabBarExtraContent,ge=W.examRecordTabTitle,ce=W.onCancel,ye=localStorage.getItem("themeColor")||"#465dcd",be=(0,Z.useRef)(),Ie=(0,c.I0)(),Re=(0,Z.useState)({task_type:ie,scene:V,examId:l,task_id:p,userId:I}),Ne=(0,R.Z)(Re,1),Se=Ne[0],Te=(0,Z.useState)("examRecord"),De=(0,R.Z)(Te,2),Pe=De[0],Ke=De[1],Be=(0,Z.useState)(0),$e=(0,R.Z)(Be,2),Ue=$e[0],Fe=$e[1],Ye=(0,Z.useState)({examId:l,userId:I,submitId:"",visible:!1}),He=(0,R.Z)(Ye,2),Ge=He[0],Je=He[1],at=(0,Z.useState)(!1),st=(0,R.Z)(at,2),et=st[0],nt=st[1];(0,Z.useEffect)(()=>{(0,g.et)({examId:l}).then(Ce=>{var fe=Ce.data,We=fe.data,ke=fe.code;ke==="200000"&&nt(We==="true")})},[l]);var rt={pending:{text:d("myExamTask.marking"),color:"#FFB56F"},passed:{text:d("myExamTask.qualified"),color:"#52C41A"},failed:{text:d("myExamTask.unqualified"),color:"#F5222D"},full:{text:d("examination.resultStatus.full"),color:"#417DC2"}};function ot(Ce){var fe=(0,C.Z)({},Ce);return(0,g.yZ)(fe)}var dt=()=>x().createElement(L.Z,{type:"primary",onClick:ct},d("common.exportData"));function ct(){(0,q.N)({page:"exportSubmitList",props:{dispatch:Ie,t:d},rest:{planId:l,userId:I},query:"?".concat(s.stringify(Se)),sendType:"get"})}function mt(Ce){var fe=Ce.exam_result,We=Ce.show_record,ke=Ce.task_id,Qe=Ce.submit_id;We==="true"&&fe!=="pending"&&ee.Z.targetTo({path:H.W.parse({exam_id:l,user_id:V==="manage"?I:"",task_id:ke,submit_id:Qe,scene:"manage"}),projectType:"student"})}var Ct={size:"small",showSizeChanger:!1,showTotal:Ce=>d("examination.allTotal",{total:Ce})},Xe=[{title:d("examing.handoverTime"),width:"240px",key:"submit_time",render:(Ce,fe)=>x().createElement(x().Fragment,null,x().createElement("span",null,t()(Ce*1).format(d("examination.dateFormate"))),(fe.score_record_type==="latest"||fe.score_record_type==="highest")&&x().createElement("span",{className:w()["latest-flag"]},fe.score_record_type==="latest"?d("myExamTask.newest"):d("myExamTask.highest")))},{title:d("exam.examTime"),width:"100px",key:"answer_duration",render:Ce=>x().createElement("span",null,Ce?(0,M.xj)(Ce):"")},{title:d("examination.scoreAll"),width:"100px",key:"total_score",render:(Ce,fe)=>x().createElement("span",null,fe.total_score,"/",fe.score)},{title:d("examination.scoringRate"),key:"score_rate",width:"80px",render:(Ce,fe)=>x().createElement("span",null,fe.score_rate)},{title:d("exam.examResult"),key:"exam_result",width:"100px",render:(Ce,fe)=>{var We=Ce;return fe.total_score===fe.score&&(We="full"),x().createElement("div",null,x().createElement(N.Z,{color:rt[We].color,text:rt[We].text}))}}];V==="manage"&&Xe.splice(4,0,{title:d("common.marker"),width:"100px",key:"mark_name",render:Ce=>{var fe=Ce;return Ce==="\u7CFB\u7EDF"&&(fe=d("personal.system")),x().createElement(Y.Z,{title:fe},x().createElement("div",{className:"cl-text-ellipsis",style:{width:100}},fe||"--"))}}),Xe.push({title:d("common.operate"),width:80,fixed:"right",key:"submit_id",render:(Ce,fe)=>{var We=[{style:{color:fe.show_record==="true"&&fe.exam_result!=="pending"?ye:"#ccc",cursor:fe.show_record==="true"&&fe.exam_result!=="pending"?"pointer":"not-allowed"},visible:!0,label:d("examination.viewAnswerDetail"),onClick:ke=>{mt(ke)}},{label:d("examination.face_recognition"),style:{color:et?ye:"#c0c4cc",cursor:et?"pointer":"not-allowed"},visible:!0,onClick:(ke,Qe)=>{var tt=ke.submit_id;Qe||Je(qe=>(0,C.Z)((0,C.Z)({},qe),{},{submitId:tt,visible:!0}))},disabled:!et,disabledTip:d("examination.recordCharts.notFaceRecognitionTip")}];return x().createElement("div",{className:w()["exam-record-operate"]},We.map(ke=>{var Qe=ke.visible,tt=ke.label,qe=ke.style,vt=ke.disabledTip,lt=ke.disabled,yt=ke.onClick;if(Qe)return x().createElement(Y.Z,{title:lt?vt:""},x().createElement("span",{className:"".concat(qe.btns),style:qe,onClick:()=>{yt(fe,lt)}},tt))}))}});var it=()=>{Je(Ce=>(0,C.Z)((0,C.Z)({},Ce),{},{visible:!1}))},ut=Ce=>{var fe=Ce.data.total*1;Fe(fe)},pt=(0,Z.useMemo)(()=>x().createElement(Q,{className:w()["record-chart-container"],params:Se,height:450}),[Se]),ht=Ce=>{Ke(Ce)},gt=()=>{if(V!=="manage"&&Pe==="examRecord")return ue&&ue();if(V==="manage")return x().createElement("span",{onClick:ce,style:{cursor:"pointer"}},x().createElement(_.Z,null))};return x().createElement("div",null,x().createElement(m.Z,{onChange:ht,activeKey:Pe,tabBarExtraContent:gt()},x().createElement(ve,{tab:ge||d("common.examRecord"),key:"examRecord"},Pe==="examRecord"&&x().createElement("div",{className:w()["exam-record-wrap"]},x().createElement(A.Z,{ref:be,uuid:"0bbb3a01-9767-491d-8948-f9befe6f81ce",queryParams:{columns:Xe,query:ot},queryParam:Se,pagination:Ct,options:!1,tableAlertRender:()=>!1,scroll:{x:"max-content",y:"330px"},loadComplete:ut,toolBarRender:V==="manage"?dt:null}))),Ue>=3&&x().createElement(ve,{tab:d("examination.recordCharts.title"),key:"recordChart"},Pe==="recordChart"&&pt)),x().createElement(oe,(0,se.Z)({drawerTitle:d("exam.faceKnow")},Ge,{onCloseDrawer:it})))}var pe=(0,b.Z)()(_e)},70018:function(xe,re,e){"use strict";e.d(re,{TM:function(){return a},Ty:function(){return N},me:function(){return F},vU:function(){return L},NZ:function(){return C},C0:function(){return R},r7:function(){return z},lc:function(){return m},lq:function(){return Z},P8:function(){return x},yZ:function(){return b},rh:function(){return _},li:function(){return D},i3:function(){return t},G2:function(){return c},wg:function(){return s},et:function(){return g}});var se=e(81211),J=e(10237),Y=e(5430);function a(i,r){var T=Y.OB.examing.load(i,r);return J.WY.post({url:T})}function N(i,r){var T=Y.OB.examing.save(i);return J.WY.post({url:T,data:r})}function F(i,r){var T=Y.OB.examing.submit(i);return J.WY.post({url:T,data:r})}function L(i,r){var T=Y.OB.examing.saveCut(i);return J.WY.post({url:T,data:r})}function C(i,r){var T=i.examId,v=i.submitId,S=i.userId,E=Y.OB.parse.list({examId:T,submitId:v,userId:S});return J.WY.get({url:E,params:r})}function R(i,r){var T=i.examId,v=i.userId,S=Y.OB.parse.info({examId:T,userId:v},r);return J.WY.get({url:S,params:r})}function z(i){var r=i.key,T=r===void 0?"":r,v=i.msg,S=v===void 0?"":v,E=i.data,B=E===void 0?{}:E;J.WY.logger({keyword:T,moduleName:"".concat(T,"-examing"),msg:S,data:B})}function m(i){var r=i.examId,T=i.page_size,v=i.page_number,S=i.type,E=Y.OB.examData.rankingList(r);return J.WY.get({url:E,params:{page_size:T,page_number:v,type:S}})}function Z(i){var r=i.examId,T=i.task_id,v=i.submit_id,S=v===void 0?"":v,E=Y.OB.examData.examsResult(r);return J.WY.get({url:E,params:{task_id:T,submit_id:S}})}function x(i){var r=Y.OB.examData.certificateImage(i);return J.WY.get({url:r})}function b(i){var r=i.task_type,T=i.task_id,v=i.page_number,S=i.page_size,E=i.examId,B=i.userId,Q=i.scene,y=Y.OB.examData.getRecordInfo(E,B);return J.WY.get({url:y,params:{task_type:r,task_id:T,page_number:v,page_size:S,scene:Q}})}function _(i){var r=i.status,T=i.scene,v=i.page_number,S=i.page_size,E=i.examId,B=Y.OB.examMarking.getMarkUser(E);return J.WY.get({url:B,params:{status:r,scene:T,page_number:v,page_size:S}})}function D(i,r){var T=Y.OB.examMarking.submitMarking(i);return J.WY.post({url:T,data:r})}function t(i,r,T){var v=Y.lk.getExamFromProject(i,r);return J.WY.get({url:v,params:T})}function c(i){var r=i.examId,T=i.submitId,v=i.userId,S=(0,se.Z)(i,["examId","submitId","userId"]),E=Y.OB.examData.faceRecognitionRecord({examId:r,submitId:T,userId:v});return J.WY.get({url:E,params:S})}function s(i){var r=i.examId,T=i.submitId,v=i.userId,S=Y.OB.examData.faceRecognitionRecordStatistics({examId:r,submitId:T,userId:v});return J.WY.get({url:S})}function g(i){var r=i.examId,T=Y.OB.examData.hasFaceSnapshot({examId:r});return J.WY.get({url:T})}},18815:function(xe,re,e){"use strict";e.r(re),e.d(re,{default:function(){return Pt}});var se=e(18106),J=e(88108),Y=e(12924),a=e.n(Y),N=e(91768),F=e(28216),L=e(76651),C=e(57068),R=e(60667);class z extends a().Component{render(){var h=this.props,n=h.trainTask,o=h.t;return a().createElement("div",{className:"employee-monitor-info task-info"},a().createElement("div",{className:"task-info-sub"},a().createElement("span",{className:"task-info-sub-item"},a().createElement("span",{className:"task-info-sub-item-bold"},o("learning.learningEmployeeAddTerm")),"\uFF1A",n.trainLimit,o("common.day")),a().createElement("span",{className:"task-info-sub-item"},a().createElement("span",{className:"task-info-sub-item-bold"},o("common.creator")),"\uFF1A",a().createElement(R.Z,{dataType:"userName",value:n.creator_sync_user_id,name:n.createUserName,type:n.creator_source_type}))),a().createElement("div",{className:"task-info-sub",style:{marginTop:8}},a().createElement("span",{className:"task-info-sub-item"},a().createElement("span",{className:"task-info-sub-item-bold"},o("learning.learningEmployeeAddSecAssignment")),"\uFF1A",n.trainObjectName),a().createElement("span",{className:"task-info-sub-item"},a().createElement("span",{className:"task-info-sub-item-bold"},o("common.passingCriteria")),"\uFF1A",n.progress>0?a().createElement("span",{className:"task-info-sub-item-standard"},"".concat(o("learning.employeePassingCriteriaStudy")).concat(n.progress,"%")):null,n.times>0?a().createElement("span",{className:"task-info-sub-item-standard"},"".concat(o("learning.employeePassingCriteriaExam")).concat(n.times).concat(o("common.examUnit"))):null,n.operationTimes>0?a().createElement("span",{className:"task-info-sub-item-standard"},"".concat(o("learning.learningProjectOperationProgress")).concat(n.operationTimes).concat(o("common.examUnit"))):null)))}}var m=(0,N.Z)()(z),Z=e(62029),x=e(57663),b=e(71577),_=e(34792),D=e(48086),t=e(71194),c=e(57016),s=e(88986),g=e(84391),i=e(10237),r=e(37055),T=e(98417),v=e(27763),S=e(97593),E=e(38642),B=e(72456),Q=e(62117),y=e(47673),w=e(4107),A=e(43358),M=e(34041),H=e(14965),ee=e(11448),q=e(59239),u=e(55446),U=e(18329),k=e(64262),G=e(64630),le=e(2396),X=q.Z.Item,O=ee.Z.RangePicker,ae=M.Z.Option;class $ extends a().Component{constructor(){super(...arguments);this.state={typeOptions:[{id:"0",name:this.props.t("common.all")},{id:"1",name:this.props.t("study.employeePass")},{id:"2",name:this.props.t("study.employeeUnPass")}],visible:!1,days:""},this.onDeptSelectChange=h=>{var n=this.props.onDeptSelectChange;n&&n(h)},this.onPostSelectChange=h=>{var n=this.props.onPostSelectChange;n&&n(h)},this.onTypeSelectChange=h=>{var n=this.props.onTypeSelectChange;n&&n(h)},this.onDeleteUsers=()=>{var h=this.props.onDeleteUsers;h&&h()},this.onShowDelay=()=>{this.setState({visible:!this.state.visible})},this.onSubmit=h=>{h.preventDefault();var n=this.props,o=n.form,f=n.onDelay;o.validateFields((K,te)=>{K||(f&&f(te),this.onShowDelay())})},this.onChangeJoinTime=h=>{var n=this.props.onChangeJoinTime;n&&n(h)},this.checkPostponeDays=(h,n,o)=>{var f=this.props.t;if(n<1||n>30||isNaN(n)||!le.fA.positiveInteger.test(n)){o(f("learning.employeePostponeTip"));return}o()}}render(){var h=this.props.t,n={okText:h("common.ok"),cancelText:h("common.cancel"),size:"small",destroyOnClose:!0,bodyStyle:{padding:"20px"},maskClosable:!1},o={labelCol:{span:5},wrapperCol:{span:15}},f=this.props.form.getFieldDecorator,K=this.state,te=K.typeOptions,ne=K.visible,me=K.days;return a().createElement("header",{className:"query-row"},a().createElement("section",{className:"query-row__query"},a().createElement(k.Z,{className:"cl-search-normal-width",parentId:"",checkable:!1,asyncLoad:!0,treeSelect:!0,onTreeSelectChange:this.onDeptSelectChange}),a().createElement(G.Z,{onChange:this.onPostSelectChange,className:"cl-search-normal-width"}),a().createElement(M.Z,{defaultValue:te[0].id,className:"cl-search-normal-width",onChange:this.onTypeSelectChange},te.map(Ee=>a().createElement(ae,{value:Ee.id,key:Ee.id},Ee.name))),a().createElement(O,{className:"join_time",onChange:this.onChangeJoinTime})),a().createElement(U.ZP,(0,Z.Z)({},n,{visible:ne,title:h("common.postpone"),onCancel:this.onShowDelay,onOk:this.onSubmit}),a().createElement("div",{className:"employee-delay"},a().createElement(q.Z,{layout:"vertical"},a().createElement(X,(0,Z.Z)({},o,{label:h("common.postpone")}),f("delayDay",{rules:[{validator:this.checkPostponeDays}],initialValue:me})(a().createElement("span",null,a().createElement(w.Z,{placeholder:"\u9650\u523630",style:{width:200}}),h("common.day"))))))))}}$.defaultProps={};var de=(0,N.Z)()(q.Z.create()($)),he=e(34669),oe=e(82833),ve=e(47745),_e=e(59250),pe=e(13013),W=e(48736),d=e(27049),l=e(30887),p=e(99210),I=e(57254),P=e(67479),V=e(1164),j=Le=>({qyShield:Le.user.qyShield});class ie extends a().PureComponent{constructor(h){super(h);this.onShowStudyRecord=()=>{var n=this.props.record;n.studyCount<=0||this.props.onShowStudyRecord(n.userId,n)},this.onLinkToExam=()=>{var n=this.props.record;if(n.examCount>0&&n.examJoinCount>0){var o=!1;n.stage_train_vo_list.forEach(f=>{f.courseInfo.forEach(K=>{K.courseType===15&&(K.status===2||K.status===3)&&(o=!0)})}),o?V.Z.targetTo({path:P.W.parse({user_id:n.userId,projectId:n.planId,scene:"manage",from:"employee_task"})}):this.props.onLinkToExamRecord(n)}},this.onLinkToOperationRecord=()=>{var n=this.props.record;n.totalOperationCount<=0||V.Z.targetTo({path:"/training/operation/info?taskId=".concat(n.planId,"&userId=").concat(n.userId,"&taskType=study&renderList=true&page=monitor")})},this.moreOperate=()=>{var n=this.props,o=n.record,f=n.enterpriseId,K=n.t,te=n.qyShield;return a().createElement(p.Z,null,te==="false"&&a().createElement(p.Z.Item,{disabled:!(o.examCount>0&&o.examJoinCount>0&&o.examGetScoreCount>0),key:"assigned"},a().createElement("p",{className:"cl-dropdown-menuitem",onClick:this.onLinkToExam},K("common.examRecord"))),a().createElement(p.Z.Item,{disabled:o.totalOperationCount<=0},a().createElement("p",{className:"cl-dropdown-menuitem",onClick:this.onLinkToOperationRecord},K(f==="1074539867477774379"?"leftMenuLists.operationRecord2":"leftMenuLists.operationRecord"))))},this.state={}}render(){var h=this.props,n=h.record,o=h.t;return a().createElement("div",{className:"cl-table__cell-action"},a().createElement("a",{className:"cl-pointer ".concat(n.studyCount>0?"":"cl-disabled"),onClick:this.onShowStudyRecord},o("common.studyRecord")),a().createElement(d.Z,{type:"vertical"}),a().createElement(pe.Z,{overlay:this.moreOperate()},a().createElement("span",{className:"cl-pointer"},this.props.t("common.more")," ",a().createElement(I.Z,null))))}}ie.defaultProps={record:{},onShowStudyRecord:()=>{},onLinkToExamRecord:()=>{}};var ue=(0,F.$j)(j)((0,N.Z)()(ie)),ge=e(410),ce=e(55285),ye=e(6793),be=e(30311);class Ie extends a().Component{constructor(){super(...arguments);this.state={autoWith:"auto",getExamAllGradesProps:{visible:!1,planId:"",userId:"",planTitle:""},recordInfo:{visible:!1,taskId:"",examId:"",userId:""}},this.onSelectChange=h=>{this.props.onSelectChange(h)},this.showEveryExamGrade=h=>{var n=h.courseId,o=h.userId,f=h.title,K=h.courseType,te=h.exam_task_id;if(K===15){this.setState({recordInfo:{visible:!0,taskId:te,examId:n,userId:o}});return}this.setState(ne=>({getExamAllGradesProps:(0,s.Z)((0,s.Z)({},ne.getExamAllGradesProps),{},{visible:!0,planId:n,userId:o,planTitle:f})}))},this.hideEveryExamGrade=()=>{this.setState(h=>({getExamAllGradesProps:(0,s.Z)((0,s.Z)({},h.getExamAllGradesProps),{},{visible:!1,planId:"",userId:"",planTitle:""})}))},this.cancelEveryExamGrade=()=>{this.setState({recordInfo:{visible:!1,taskId:"",examId:"",userId:""}})},this.getTableColumn=()=>{var h=this.props,n=h.list,o=n===void 0?[]:n,f=h.t,K=[];o[0]&&(K=o[0].stage_train_vo_list.map((ne,me)=>{var Ee=[{title:f("study.stageProgress"),width:115,dataIndex:["stage_train_vo_list",me,"stageProgress"],key:"stageProgress",render:Ze=>"".concat(Ze,"%")}];return{title:ne.stageName,children:Ee.concat(ne.courseInfo.map((Ze,Ae)=>({title:Ze.title,dataIndex:["stage_train_vo_list",me,"courseInfo",Ae],key:"courseInfo",width:150,render:Oe=>{if(Oe.notStudyTask==="true")return a().createElement("span",null,f("study.notStudyTask"));if(Oe.courseType===12){if(Oe.tutorialsStatus==="no_tutor")return f("tutorial.noSelectTutor");if(Oe.tutorialsStatus==="to_be_submitted")return f("tutorial.waitSubmitTutor");if(Oe.tutorialsStatus==="to_be_evaluated")return f("tutorial.waitEvaluate");if(Oe.tutorialsStatus==="evaluated")return"".concat(f("tutorial.haveEvaluation")," ").concat(Oe.score).concat(f("common.examScoreUnit"))}if(Oe.courseType===6||Oe.courseType===15){var we=this.props.t,Me=Oe.status;if(Me===1)return we("common.ongoing");if(Me===5)return we("study.absent");if(Me===0)return we("myExamTask.absent");if(Me===4)return we("myExamTask.marking");if(Me===2||Me===3){var ze=we(Me===2?"myExamTask.qualified":"myExamTask.unqualified"),Ve="".concat(Oe.score," ").concat(we("common.minute"),"(").concat(ze,")");return Oe.makeupCount>1?a().createElement(be.Z,{name:Ve,onClick:()=>this.showEveryExamGrade(Oe)}):Ve}}else return a().createElement("span",null,Oe.studyProgress,"%");return null}})))}}));var te=[{title:f("learning.learningEmployeeAddTerm"),dataIndex:"taskBeginTime",key:"taskBeginTime",width:306,render:(ne,me)=>{var Ee=me.taskBeginTime,Ze=me.taskEndTime;return"".concat((0,ye.p6)(Ee),"~").concat((0,ye.p6)(Ze))}},{title:f("study.passedOrNoted"),dataIndex:"qualifiedStatusName",key:"qualifiedStatusName",width:this.props.lng==="en_us"?120:88},{title:f("common.status"),dataIndex:"taskStatusName",key:"taskStatusName",width:88},{title:f("study.trainingProgress"),dataIndex:"process",key:"process",width:150,render:(ne,me)=>{var Ee=me.process;return a().createElement("span",null,a().createElement(oe.Z,{percent:Ee}))}},{title:f("study.studyCompleted"),dataIndex:"studyProgress",key:"studyProgress",width:this.props.lng==="en_us"?130:88,render:(ne,me)=>{var Ee=me.studyProgress;return"".concat(Ee,"%")}},{title:f("study.passedTime"),dataIndex:"examPassCount",key:"examPassCount",width:this.props.lng==="en_us"?120:88},{title:f("employeeSummary.getScores"),width:this.props.lng==="en_us"?120:88,dataIndex:"credits",key:"credits",render:(ne,me)=>{var Ee=me.credits;return Ee||"--"}},{title:f("personal.getCerti"),width:this.props.lng==="en_us"?120:88,dataIndex:"certificateName",key:"certificateName",render:(ne,me)=>{var Ee=me.certificateName;return Ee||"--"}},{title:this.props.t("common.studyDuration"),dataIndex:"studyDurationStr",key:"studyDurationStr",width:110,render:(ne,me)=>{var Ee=me.studyDurationStr;return Ee||"--"}},{title:this.props.t("common.examDuration"),dataIndex:"examDurationStr",key:"examDurationStr",width:90,render:ne=>ne||"--"}];return te.splice(11,0,...K),[...te,{title:f("common.operate"),width:this.props.lng==="en_us"?190:145,key:"operate",fixed:"right",render:ne=>a().createElement(ue,{record:ne,onShowStudyRecord:this.props.onShowStudyRecord,onLinkToExamRecord:this.props.onLinkToExamRecord})}]},this.handleTableChange=h=>{this.props.onTableChange(h)}}componentDidUpdate(){var h=document.querySelector(".ant-table"),n=document.querySelector(".ant-table-tbody"),o=h.getBoundingClientRect().width,f=n.getBoundingClientRect().width;this.hasComputed||f-o>10&&(this.hasComputed=!0,this.setState({autoWith:240}))}render(){var h={onChange:this.onSelectChange},n=this.props,o=n.prefixCls,f=n.list,K=f===void 0?[]:f,te=n.loading,ne=n.paginationParams,me=ne===void 0?{}:ne,Ee=n.headerTitle,Ze=n.toolBarRender,Ae=n.t,Oe=this.state,we=Oe.getExamAllGradesProps,Me=Oe.recordInfo,ze=(0,s.Z)((0,s.Z)({},r.XE.INITIAL_PAGINATION),me),Ve=this.getTableColumn(this.state.autoWith);return a().createElement("section",{className:o},a().createElement(ce.Z,{columns:Ve,rowKey:"userId",dataSource:K,pagination:ze,loading:te,onChange:this.handleTableChange,rowSelection:h,headerTitle:Ee,toolBarRender:Ze,tableUUID:"d977381d-2b4d-47cf-8bc1-c5026c454dfd"}),a().createElement(ve.Z,(0,Z.Z)({},we,{hideEveryExamGrade:this.hideEveryExamGrade})),Me.visible&&a().createElement(U.ZP,{width:860,footer:null,closable:!1,visible:Me.visible,bodyStyle:{padding:"0 16px 16px 16px"},onOk:this.cancelEveryExamGrade},a().createElement(ge.Z,{onCancel:this.cancelEveryExamGrade,from:"manage",taskType:"normal",taskId:Me.taskId,examId:Me.examId,userId:Me.userId})))}}Ie.defaultProps={prefixCls:"employee-monitor__persontab__table__content"};var Re=(0,N.Z)()(Ie),Ne=Le=>({userLng:Le.user});class Se extends a().Component{constructor(h){super(h);this.onShowStudyRecord=(n,o)=>{var f=this.state.taskStudyRecordConfig;f.visible=!0,f.userId=n,f.record=o,this.setState({taskStudyRecordConfig:f})},this.onHiddenTaskStudyRecord=()=>{var n=this.state.taskStudyRecordConfig;n.visible=!1,this.setState({taskStudyRecordConfig:n})},this.onSelectChange=n=>{this.setState({selectedRowKeys:n})},this.onLinkToExamRecord=n=>{L.m8.push({pathname:"/training/examination/result",search:C.stringify({userId:n.userId,planId:C.parse(L.m8.location.search).id,pageFrom:"examMonitor",repeatMarking:!0})})},this.initTableList=()=>{var n=this.props.t,o=C.parse(L.m8.location.search),f=o.id;this.setState({tableLoading:!0}),i.WY.get({url:r.ZP.EmployeeTrain.getMonitorList(f),params:this.state.params}).then(K=>{var te=K.data.data,ne=te.totalCount,me=te.underwayCount,Ee=te.completeCount,Ze=te.overdueCount;this.setState({tableLoading:!1,tableList:K.data.data.voList.list,tableTotal:K.data.data.voList.total,radioList:[{name:"".concat(n("common.all"),"(").concat(ne,")"),value:"0"},{name:"".concat(n("common.ongoing"),"(").concat(me,")"),value:"1"},{name:"".concat(n("common.completed"),"(").concat(Ee,")"),value:"2"},{name:"".concat(n("common.overdue"),"(").concat(Ze,")"),value:"3"}]})})},this.handleQueryRowRadiosChange=n=>{this.resetPagination().then(()=>{this.setState(o=>({params:(0,s.Z)((0,s.Z)({},o.params),{},{taskStatus:n})}),()=>{this.initTableList()})})},this.handleQueryRowSearch=n=>{this.resetPagination().then(()=>{this.setState(o=>({params:(0,s.Z)((0,s.Z)({},o.params),{},{keyword:n})}),()=>{this.initTableList()})})},this.handleTreeSelectChange=n=>{this.resetPagination().then(()=>{this.setState(o=>({params:(0,s.Z)((0,s.Z)({},o.params),{},{departmentId:n})}),()=>{this.initTableList()})})},this.handleTypeSelectChange=n=>{this.resetPagination().then(()=>{this.setState(o=>({params:(0,s.Z)((0,s.Z)({},o.params),{},{qualifiedStatus:n})}),()=>{this.initTableList()})})},this.handlePostSelectChange=n=>{this.resetPagination().then(()=>{this.setState(o=>({params:(0,s.Z)((0,s.Z)({},o.params),{},{postId:n})}),()=>{this.initTableList()})})},this.handleJoinTime=n=>{n?this.resetPagination().then(()=>{this.setState(o=>({params:(0,s.Z)((0,s.Z)({},o.params),{},{start_time:n[0].valueOf(),end_time:n[1].valueOf()})}),()=>{this.initTableList()})}):this.resetPagination().then(()=>{this.setState(o=>({params:(0,s.Z)((0,s.Z)({},o.params),{},{start_time:"",end_time:""})}),()=>{this.initTableList()})})},this.handleChangePagination=n=>{var o=n.current,f=n.pageSize;this.setState(K=>({params:(0,s.Z)((0,s.Z)({},K.params),{},{pageNumber:o,pageSize:f})}),()=>{this.initTableList()})},this.resetPagination=()=>new Promise(n=>{this.setState(o=>({params:(0,s.Z)((0,s.Z)({},o.params),{},{pageNumber:1,pageSize:20})}),()=>{n()})}),this.handleDeleteConfirm=()=>{var n=this.props.t;c.Z.confirm({title:n("study.moveUserFromEmployeeTip"),content:"",onOk:()=>{this.confirmDelete()}})},this.confirmDelete=()=>{var n=C.parse(L.m8.location.search),o=n.id;i.WY.post({url:r.ZP.EmployeeTrain.deleteUsers(o),data:{user_ids:this.state.selectedRowKeys}}).then(f=>{f.data.deleted==="true"&&(D.default.success(this.props.t("common.deleteSuccess")),this.initTableList())})},this.handleDelay=n=>{var o=C.parse(L.m8.location.search),f=o.id;i.WY.post({url:r.ZP.EmployeeTrain.delayTrain(),params:{planId:f,userIds:this.state.selectedRowKeys.join(","),delayDay:n.delayDay}}).then(K=>{K.data.code===0?(D.default.success(this.props.t("study.updateSuccess")),this.initTableList()):D.default.error(K.data.msg)})},this.handleExport=()=>{var n=this.props.t,o=this.state.params;c.Z.confirm({title:n("common.tip"),content:n("study.confirmToExport"),onOk:()=>{var f="";Object.keys(o).forEach(te=>{f+="".concat(te,"=").concat(o[te],"&")});var K="?".concat(f);(0,S.N)({page:"employeeResult",props:this.props,query:K})}})},this.renderLeftRow=()=>{var n=this.props.t,o=this.state.selectedRowKeys;return a().createElement(B.Z,{showBtn:!1,renderActionBtn:()=>a().createElement("div",{className:"cl-listQueryRow__action"},a().createElement(b.Z,{type:"primary",onClick:this.handleExport},a().createElement(g.Z,null),this.props.t("common.exportData")),a().createElement(b.Z,{disabled:o.length===0,style:{marginLeft:8},onClick:this.handleDeleteConfirm},n("study.batchDelete")),a().createElement(b.Z,{disabled:o.length===0,style:{marginLeft:8},onClick:()=>this.myRef.current&&this.myRef.current.onShowDelay()},n("common.postpone")))})},this.renderRightRow=()=>{var n=this.props.t,o=this.state.radioList;return a().createElement(Q.Z,{showCheckbox:!1,radioList:o,onRadiosChange:this.handleQueryRowRadiosChange,onSearch:this.handleQueryRowSearch,inputPlaceholder:n("searchInputPlaceholder.userName")})},this.state={params:{qualifiedStatus:"",queryTaskInfo:"true",keyword:"",pageNumber:1,pageSize:20,taskStatus:"0",departmentId:"",postId:"",planId:C.parse(L.m8.location.search).id,start_time:"",end_time:""},radioList:[],tableLoading:!0,tableList:[],tableTotal:0,taskStudyRecordConfig:{visible:!1,userId:"",studyType:"newEmployee"},selectedRowKeys:[],whiteList:{randomPopup:(0,E.UI)("RANDOM_POPUP_VERIFY")}},this.myRef=a().createRef()}componentDidMount(){this.initTableList()}render(){var h=this.state,n=h.tableTotal,o=h.tableList,f=h.tableLoading,K=h.params,te=h.taskStudyRecordConfig,ne=h.selectedRowKeys,me=h.whiteList,Ee=me.randomPopup,Ze={total:n,current:K.pageNumber,pageSize:K.pageSize},Ae=this.props,Oe=Ae.userLng,we=Ae.prefixCls,Me=Ae.trainTask;return a().createElement("div",{className:we},a().createElement("div",{className:"".concat(we,"__header")},a().createElement(de,{wrappedComponentRef:this.myRef,selectedRowKeys:ne,onDeptSelectChange:this.handleTreeSelectChange,onTypeSelectChange:this.handleTypeSelectChange,onPostSelectChange:this.handlePostSelectChange,onDeleteUsers:this.handleDeleteConfirm,onDelay:this.handleDelay,onChangeJoinTime:this.handleJoinTime})),a().createElement("div",{className:"".concat(we,"__table")},a().createElement(Re,{lng:Oe.lng,loading:f,paginationParams:Ze,list:o,onTableChange:this.handleChangePagination,onSelectChange:this.onSelectChange,onShowStudyRecord:this.onShowStudyRecord,onLinkToExamRecord:this.onLinkToExamRecord,headerTitle:this.renderLeftRow(),toolBarRender:this.renderRightRow}),Ee?a().createElement(v.Z,(0,Z.Z)({generatePdf:!0,mainTaskInfo:Me},te,{onCancel:this.onHiddenTaskStudyRecord,taskId:C.parse(L.m8.location.search).id})):a().createElement(T.Z,(0,Z.Z)({generatePdf:!0},te,{mainTaskInfo:Me,onCancel:this.onHiddenTaskStudyRecord,taskId:C.parse(L.m8.location.search).id}))))}}Se.defaultProps={prefixCls:"employee-monitor__persontab"};var Te=(0,F.$j)(Ne)((0,N.Z)()(Se)),De=e(22385),Pe=e(31097),Ke=e(33565),Be=e(57361),$e=e(9754),Ue=e.n($e),Fe=e(36202),Ye=e(18884),He=e(98233),Ge=e(35085),Je=localStorage.getItem("themeColor");class at extends a().Component{constructor(){var h;super(...arguments);h=this,this.state={qrCodeConfig:{title:this.props.t("common.share"),isProjectShare:!1,tip:""},option:{scene:"",flag:"exam_task"},modalVisible:!1,whiteList:{examShareFlag:(0,E.UI)("EXAM_TASK_SHARE_BUT")}},this.onHandleQrShare=n=>{var o=n.record,f=this.state.option;this.setState({option:(0,s.Z)((0,s.Z)({},f),{},{scene:"&flag=exam&planId=".concat(o.id)}),modalVisible:!0})},this.onExamShare=function(){var n=(0,Be.Z)(Ue().mark(function o(f){var K,te,ne,me,Ee,Ze,Ae,Oe,we,Me,ze,Ve,Tt,Et,ft;return Ue().wrap(function(je){for(;;)switch(je.prev=je.next){case 0:if(K=f.record,te=f.customization,!te){je.next=4;break}return h.onHandleQrShare({record:K}),je.abrupt("return");case 4:return ne=K.title,me=K.id,Ee=L.m8.location.query.id,Ze=C.stringify({source:"newEmployeeTask",type:"exam",id:Ee,course_id:me}),Ae={title:ne,from:"exam",path:(0,E.jr)({pc_url:"/share-transit?".concat(Ze),mobile_url:"/share-transit?".concat(Ze),pc_type:"student",mobile_type:"h5"})},je.next=10,(0,E.Kb)((0,Ge.Wl)({planId:me}));case 10:if(Oe=je.sent,we=(0,Ke.Z)(Oe,2),Me=we[1],!Me){je.next=20;break}if(ze=Me.data,Ve=ze.code,Tt=ze.data,Et=Tt.exam_duration,ft=h.props.t,!(Ve==="200000"&&Et)){je.next=20;break}return a().$share.show({detail:(0,s.Z)((0,s.Z)({},Ae),{},{site1:{label:ft("exam.examTime"),value:"".concat(Et).concat(ft("pk.min"))}})}),je.abrupt("return");case 20:a().$share.show({detail:Ae});case 21:case"end":return je.stop()}},o)}));return function(o){return n.apply(this,arguments)}}(),this.handleHiddenQrCode=()=>{this.setState({modalVisible:!1})},this.columns=[{title:this.props.t("exam.testName"),dataIndex:"title",width:300,key:"id",render:(n,o)=>a().createElement(Pe.Z,{title:o.title},a().createElement("div",{style:{color:Je,width:300},className:"cl-text-ellipsis cl-pointer",onClick:()=>{this.linkToExamMonitor(o)}},o.title))},{title:"".concat(this.props.t("exam.examinee"),"/").concat(this.props.t("exam.passed"),"/").concat(this.props.t("exam.failed")),dataIndex:"exam_num",key:"exam_num",width:180,render:(n,o)=>{var f="".concat(o.exam_num,"/").concat(o.qualified_num,"/").concat(o.unqualified_num);return a().createElement(be.Z,{name:f,onClick:()=>this.linkToExamMonitor(o)})}},{title:this.props.t("exam.absent"),width:130,dataIndex:"un_exam_num",key:"un_exam_num"},{title:this.props.t("exam.toBeGraded"),width:120,dataIndex:"pending_count",key:"pending_count",render:(n,o)=>o.pending_count>0?a().createElement(be.Z,{name:o.pending_count,onClick:()=>this.linkToMarkPaper(o)}):o.pending_count},{title:"".concat(this.props.t("common.joinRate"),"/").concat(this.props.t("common.examPassRate"),"/").concat(this.props.t("common.missRate")),dataIndex:"participation_rate",key:"participation_rate",width:240,render:(n,o)=>a().createElement("div",null,a().createElement("span",null,o.join_rate),"/",a().createElement("span",null,o.qualified_rate),"/",a().createElement("span",null,o.un_exam_rate))},{title:this.props.t("exam.operate"),key:"operate",width:150,fixed:"right",render:(n,o)=>this.renderAction({record:o})}],this.linkToExamMonitor=n=>{var o=n.id,f=n.new_exam,K=n.title,te=this.props.taskId;if(f==="true"){L.m8.push({pathname:"/training/employee/examination/newPlan/detail",search:C.stringify({id:o,taskId:te,title:K,origin:"employee"})});return}L.m8.push({pathname:"/training/learning/task/employeeResult/exam",search:C.stringify({id:o,taskId:te,taskType:"employee"})})},this.linkToMarkPaper=function(){var n=(0,Be.Z)(Ue().mark(function o(f){var K;return Ue().wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:if(!(f.pending_count>0&&f.reading_operation==="has_operation")){ne.next=5;break}return ne.next=3,(0,He.Md)(f.new_exam==="true",{id:f.id,taskId:h.props.taskId,status:"pending",from:"projectNew"});case 3:K=ne.sent,f.new_exam==="true"?V.Z.targetTo({path:K}):L.m8.push(K);case 5:case"end":return ne.stop()}},o)}));return function(o){return n.apply(this,arguments)}}(),this.handleTableChange=n=>{this.props.onTableChange(n)},this.renderShareButton=n=>{var o=this.state.whiteList,f=this.props.t,K=o.examShareFlag,te=C.parse(L.m8.location.search);if(K)return a().createElement(a().Fragment,null,a().createElement(d.Z,{type:"vertical"}),a().createElement("span",null,a().createElement("span",{className:"cl-pointer ",onClick:()=>{this.onExamShare({record:n,customization:K})}},f("common.share"))));if(te.planStatus==="published"&&(n.new_exam==="true"||n.new_exam===!0))return a().createElement(a().Fragment,null,a().createElement(d.Z,{type:"vertical"}),a().createElement("span",null,a().createElement("span",{className:"cl-pointer ",onClick:()=>{this.onExamShare({record:n,customization:K})}},f("common.share"))))},this.renderAction=n=>{var o=n.record,f=this.state,K=f.qrCodeConfig,te=f.modalVisible,ne=f.option,me=f.whiteList;return a().createElement("div",{className:"cl-table__cell-action"},a().createElement("a",{className:"cl-pointer",onClick:()=>this.linkToExamMonitor(o)},this.props.t("common.monitor")),a().createElement(d.Z,{type:"vertical"}),a().createElement("span",{className:"".concat(o.pending_count>0&&o.reading_operation==="has_operation"?"cl-pointer":"cl-disabled"),onClick:()=>this.linkToMarkPaper(o)},this.props.t("trainingProject.markingPapers")),this.renderShareButton(o),me.examShareFlag&&a().createElement(Ye.Z,(0,Z.Z)({onCancel:this.handleHiddenQrCode,visible:te,option:ne},K)))}}render(){var h=this.props,n=h.prefixCls,o=h.list,f=o===void 0?[]:o,K=h.loading,te=h.paginationParams,ne=te===void 0?{}:te,me=(0,s.Z)((0,s.Z)({},r.XE.INITIAL_PAGINATION),ne);return a().createElement("section",{className:n},a().createElement(Fe.f,{style:{height:"100%",overflow:"hidden"},scroll:{y:"100%"},columns:this.columns,rowKey:"id",dataSource:f,pagination:me,loading:K,onChange:this.handleTableChange,tableUUID:"02a32a74-dcdc-4ca8-aafd-588356e59dae"}))}}at.defaultProps={prefixCls:"employee-monitor__analysistab__table"};var st=(0,N.Z)()(at),et={getAnalysisList:r.ZP.EmployeeTrain.getAnalysisList};class nt extends a().Component{constructor(){super(...arguments);this.state={params:{planId:"",type:"",keyword:"",pageNumber:1,pageSize:20},tableLoading:!1,tableList:[],tableTotal:0},this.handleChangePagination=h=>{this.setState(n=>({params:(0,s.Z)((0,s.Z)({},n.params),{},{pageNumber:h.current,pageSize:h.pageSize})}),()=>{this.initTableList()})},this.initTableList=()=>{this.setState({tableLoading:!0});var h=C.parse(L.m8.location.search),n=h.id;i.WY.get({url:et.getAnalysisList({id:n}),params:(0,s.Z)((0,s.Z)({},this.state.params),{},{page_number:this.state.params.pageNumber,page_size:this.state.params.pageSize})}).then(o=>{setTimeout(()=>{this.setState({tableLoading:!1,tableList:o.data.list,tableTotal:+o.data.total})},300)})}}componentDidMount(){this.initTableList()}render(){var h=this.props.prefixCls,n=this.state,o=n.tableTotal,f=n.tableList,K=n.tableLoading,te=n.params,ne=C.parse(L.m8.location.search),me=ne.id,Ee={total:o,current:te.pageNumber,pageSize:te.pageSize};return a().createElement("div",{className:h},a().createElement(st,{taskId:me,loading:K,paginationParams:Ee,list:f,onTableChange:this.handleChangePagination}))}}nt.defaultProps={prefixCls:"employee-monitor__analysistab"};var rt=nt;class ot extends a().Component{constructor(){super(...arguments);this.getTableColumn=()=>{var h=[{title:this.props.t("practiceOperation.workTitle"),dataIndex:"title",key:"title"},{title:this.props.t("practiceOperation.shouldSubmit"),dataIndex:"total_count",key:"total_count",width:90},{title:this.props.t("practiceOperation.unsubmitted"),width:90,dataIndex:"not_submit_count",key:"not_submit_count"},{title:this.props.t("practiceOperation.submitted"),width:90,dataIndex:"already_submit_count",key:"already_submit_count"},{title:this.props.t("common.approved"),width:90,dataIndex:"pass_count",key:"pass_count"},{title:this.props.t("practiceOperation.fail"),width:90,dataIndex:"reject_count",key:"reject_count"},{title:this.props.t("personal.underReview"),width:90,dataIndex:"waiting_count",key:"waiting_count"},{title:this.props.t("common.operate"),width:120,fixed:"right",key:"operate",render:(n,o)=>this.renderActions({record:o})}];return h},this.renderActions=h=>{var n=h.record,o=this.props,f=o.t,K=o.taskId,te=o.taskType,ne=o.id;return a().createElement("div",{className:"cl-table__cell-action"},a().createElement(V.Z,{to:"/training/learning/management/monitor/work?id=".concat(ne,"&taskId=").concat(K,"&taskType=").concat(te,"&operationId=").concat(n.id,"&title=").concat(n.title)},a().createElement("span",{className:"cl-pointer"},f("common.viewDetails"))))}}render(){var h=this.props,n=h.isLoading,o=h.list,f=h.prefixCls,K=this.getTableColumn();return a().createElement("section",{className:f},a().createElement(Fe.f,{loading:n,dataSource:o,columns:K,rowKey:te=>te.id,pagination:!1,tableUUID:"550e15f5-94d6-4d01-bad8-c91635dabaea"}))}}ot.defaultProps={prefixCls:"offline-panel__table"};var dt=(0,N.Z)()(ot);class ct extends a().Component{constructor(h){super(h);this.state={}}render(){var h=this.props,n=h.workInfo,o=h.isLoading,f=h.taskId,K=h.taskType,te=h.id,ne=te===void 0?"":te;return a().createElement("div",{className:"offline-panel"},a().createElement("div",{className:"offline-panel-list"},a().createElement("div",{className:"offline-panel-list-table"},a().createElement(dt,{isLoading:o,list:n.list,id:ne,taskId:f,taskType:K}))))}}var mt=ct,Ct=e(14781),Xe=e(53431);class it extends a().PureComponent{constructor(h){super(h);this.linkToDetail=()=>{var n=this.props,o=n.record,f=n.taskId;o.investigate_count<=0||L.m8.push("/training/learning/task/employeeResult/questionnairePaper?id=".concat(o.id,"&from=employeeMonitor&planId=").concat(f,"&type=new_employee"))},this.state={}}render(){var h=this.props.record;return a().createElement("div",{className:"cl-table__cell-action"},a().createElement("a",{onClick:this.linkToDetail,className:"cl-pointer ".concat(h.investigate_count>0?"":"disabled")},this.props.t("study.viewStatistics")))}}it.defaultProps={record:{}};var ut=(0,N.Z)()(it);class pt extends a().Component{constructor(){super(...arguments);this.getTableColumn=()=>{var h=[{title:this.props.t("study.surveyName"),dataIndex:"title",key:"id",ellipsis:"true",render:(n,o)=>{var f=o.title;return a().createElement(Pe.Z,{placement:"topLeft",title:f},a().createElement("div",{className:"cl-text-ellipsis"},f))}},{title:this.props.t("study.collectingResearch"),dataIndex:"investigate_count",key:"investigate_count",width:215,render:(n,o)=>o.investigate_count>0?a().createElement(be.Z,{name:o.investigate_count,onClick:()=>this.linkToDetail(o)}):o.investigate_count},{title:this.props.t("common.creator"),width:106,dataIndex:"create_user",key:"create_user"},{title:this.props.t("study.releaseTime"),width:164,dataIndex:"update_time",key:"update_time",render:(n,o)=>{var f=o.update_time;return(0,ye.p6)(f,"yyyy-MM-dd hh:mm")}},{title:this.props.t("common.operate"),width:100,key:"operate",render:(n,o)=>a().createElement(ut,{record:o,taskId:this.props.taskId})}];return h},this.linkToDetail=h=>{this.props.linkToDetail(h.id)}}render(){var h=this.props,n=h.isLoading,o=h.list,f=this.getTableColumn();return a().createElement(Fe.f,{style:{height:"100%",overflow:"hidden"},loading:n,dataSource:o,columns:f,rowKey:K=>K.id,pagination:!1,tableUUID:"c09edddf-a7e2-49b9-9bc7-894d94a7985a"})}}var ht=(0,N.Z)()(pt);class gt extends a().Component{constructor(h){super(h);this.linkToDetail=n=>{var o=this.props.taskId;L.m8.push({pathname:"/training/learning/task/employeeResult/questionnaire",search:C.stringify({taskId:o,questionnaireId:n,from:"employee"})})},this.state={}}render(){var h=this.props,n=h.questionnaireInfo,o=h.pageSize,f=h.pageNumber,K=h.isLoading,te=h.taskId,ne=(0,s.Z)((0,s.Z)({},r.XE.INITIAL_PAGINATION),{},{defaultPageSize:o,current:f,total:n.total,onChange:this.props.pageChange,onShowSizeChange:this.props.pageSizeChange});return a().createElement("div",{className:"questionnaire-panel-tab"},a().createElement("div",{className:"questionnaire-panel-tab-list"},a().createElement("div",{className:"questionnaire-panel-tab-list-table"},a().createElement(ht,{isLoading:K,list:n.list,linkToDetail:this.linkToDetail,taskId:te})),n.total>o||!ne.hideOnSinglePage?a().createElement("div",{className:"questionnaire-panel-tab-list-pagination"},a().createElement(Xe.Z,ne)):null))}}var Ce=gt,fe=e(48479),We=e(5364);class ke extends Y.Component{constructor(h){super(h);this.onPaginationChange=(n,o)=>{var f=this.state.pagination;this.setState({pagination:(0,s.Z)((0,s.Z)({},f),{},{pageNumber:n,pageSize:o})},()=>{this.getDataList()})},this.tableColumns=[{title:this.props.t("coachAnalysis.tutorialsName"),width:120,dataIndex:"tutorials_name",ellipsis:!0},{title:this.props.t("coachAnalysis.shouldTutorialsNum"),width:120,dataIndex:"should_tutorials",ellipsis:!0,renderText:(n,o)=>[o.need_tutorials==="false"?"-":o.should_tutorials]},{title:this.props.t("coachAnalysis.overTutorialsNum"),width:120,dataIndex:"over_tutorials",ellipsis:!0,renderText:(n,o)=>[o.need_tutorials==="false"?"-":o.over_tutorials]},{title:this.props.t("coachAnalysis.overEvaluation"),width:120,dataIndex:"over_evaluation",ellipsis:!0},{title:this.props.t("coachAnalysis.nonEvaluation"),width:120,dataIndex:"non_evaluation",ellipsis:!0},{title:this.props.t("common.operate"),width:120,dataIndex:"tutorials_id",valueType:"option",renderText:(n,o)=>[a().createElement("a",{key:"view",onClick:()=>this.handleViewClick(o)},this.props.t("common.preview"))]}],this.handleSearch=n=>{this.setState({keyword:n},this.getDataList)},this.handleViewClick=n=>{var o=this.props.planId;this.setState({selectAnalysis:(0,s.Z)((0,s.Z)({},n),{},{planId:o})},()=>{var f=this.state.selectAnalysis;L.m8.push({pathname:"/training/learning/task/coach-analysis-detail",query:f})})},this.getDataList=()=>{var n=this.state,o=n.keyword,f=n.pagination,K=this.props,te=K.planId,ne=K.t;this.setState({isLoading:!0},()=>{(0,We.MA)({planId:te,keyword:o,page_number:f.pageNumber,page_size:f.pageSize}).then(me=>{var Ee=me.data.data;this.setState({list:Ee.list,pagination:Object.assign(f,{total:Number(Ee.total)}),isLoading:!1})}).catch(()=>{D.default.error(ne("coachAnalysis.getCoachAnalysisListError")),this.setState({isLoading:!1})})})},this.state={isLoading:!1,list:[],keyword:"",selectAnalysis:{},pagination:{pageSize:20,pageNumber:1,total:0}}}componentDidMount(){this.getDataList()}render(){var h=this.state,n=h.isLoading,o=h.list,f=h.pagination,K=this.props.t;return a().createElement("div",{className:"component-coach-analysis-list"},a().createElement(Fe.f,{loading:n,scroll:{x:"max-content",y:"100%"},dataSource:o,columns:this.tableColumns,rowKey:te=>te.tutorials_id,pagination:!1,toolBarRender:()=>[a().createElement(fe.Z,{placeholder:K("coachAnalysis.searchCoachAnalysisListPlaceholder"),onSearch:this.handleSearch,width:"300px",key:"three"})],tableUUID:"f7b6be07-d32a-483c-aa74-5da7ddbbd05c"}),a().createElement(Xe.Z,{className:"pagination-custom",current:f.pageNumber,defaultCurrent:f.pageNumber,defaultPageSize:f.pageSize,total:f.total,showTotal:te=>(0,ye.ZT)("".concat(K("course.totalCount")),te),showSizeChanger:!0,onChange:this.onPaginationChange}))}}var Qe=Le=>(0,s.Z)({},Le),tt=Le=>(0,s.Z)({},Le),qe=(0,F.$j)(Qe,tt)((0,N.Z)()(ke)),vt=e(4408),lt=e(11449),yt=Le=>({userLng:Le.user});class _t extends a().Component{constructor(){super(...arguments);this.state={activeTabKey:"0",params:{qualifiedStatus:"",queryTaskInfo:"true",keyword:"",pageNumber:1,pageSize:20,taskStatus:"0",departmentId:"",postId:"",planId:C.parse(L.m8.location.search).id,start_time:"",end_time:""},isLoading:!0,trainTask:{},workInfo:{},loadingWork:!1,loadingQuestionnaire:!1,questionnaireInfo:{},questionnairePageConfig:{pageSize:20,pageNumber:1},blackList:{workAnalysisFlag:(0,E.eY)("EMPLOYEE_MONITOR_WORK_ANALYSIS")}},this.initTableList=()=>{var h=C.parse(L.m8.location.search),n=h.id;i.WY.get({url:r.ZP.EmployeeTrain.getMonitorList(n),params:this.state.params}).then(o=>{this.setState({isLoading:!1,trainTask:o.data.data.trainTask})})},this.handleChangeTab=h=>{this.setState({activeTabKey:h});var n=this.state,o=n.workInfo,f=n.questionnaireInfo;h==="2"?o.list||this.getWorksData():h==="3"&&(f.list||this.getQuestionnaireData())},this.getWorksData=()=>{var h=this.state.taskId,n=r.ZP.StudyTaskMonitor.getWorksData(),o={entity_type:"study",entity_id:h};this.setState({loadingWork:!0}),i.WY.post({url:n,data:o}).then(f=>{this.setState({loadingWork:!1,workInfo:{list:f.data.operations}})})},this.getQuestionnaireData=()=>{var h=this.state,n=h.taskId,o=h.questionnairePageConfig,f=o.pageNumber,K=o.pageSize,te=r.ZP.StudyTaskMonitor.getQuestionnaireData(n),ne={page_number:f,page_size:K};this.setState({loadingQuestionnaire:!0}),i.WY.get({url:te,params:ne}).then(me=>{this.setState({loadingQuestionnaire:!1,questionnaireInfo:{total:me.data.total,list:me.data.list}})})},this.questionnairePageChange=h=>{var n=this.state.questionnairePageConfig;n.pageNumber=h,this.setState({questionnairePageConfig:n},()=>{this.getQuestionnaireData()})},this.questionnairePageSizeChange=(h,n)=>{var o=this.state.questionnairePageConfig;o.pageSize=n,this.setState({questionnairePageConfig:o},()=>{this.getQuestionnaireData()})}}componentDidMount(){var h=C.parse(L.m8.location.search);this.setState({taskId:h.id}),this.initTableList()}render(){var h=this.props,n=h.prefixCls,o=h.t,f=h.userLng,K=this.state,te=K.trainTask,ne=K.activeTabKey,me=K.isLoading,Ee=K.workInfo,Ze=K.loadingWork,Ae=K.taskId,Oe=K.loadingQuestionnaire,we=K.questionnaireInfo,Me=K.questionnairePageConfig,ze=K.params,Ve=K.blackList;return a().createElement(lt.Z,{noPadding:!0,pageContainerParams:{header:{title:te.trainName}}},a().createElement(vt.Z,{title:o("documentTitle.newEmployeeTaskMonitoring")}),a().createElement("div",{className:n},a().createElement(m,{trainTask:te}),!me&&a().createElement("div",{className:"".concat(n,"__content")},a().createElement(J.Z,{activeKey:ne,animated:!1,onChange:this.handleChangeTab},a().createElement(J.Z.TabPane,{tab:o("study.monitoring"),key:"0"},a().createElement("div",{className:"tab-content"},a().createElement(Te,{trainTask:te}))),f.qyShield==="false"&&a().createElement(J.Z.TabPane,{tab:o("study.examAnalysis"),key:"1"},a().createElement("div",{className:"tab-content"},a().createElement(rt,null))),Ve.workAnalysisFlag&&f.qyShield==="false"&&a().createElement(J.Z.TabPane,{tab:o("study.workAnalysis"),key:"2"},a().createElement("div",{className:"tab-content"},a().createElement(mt,{taskId:Ae,taskType:"study",isLoading:Ze,workInfo:Ee}))),f.qyShield==="false"&&a().createElement(J.Z.TabPane,{tab:o("study.survey"),key:"3"},a().createElement("div",{className:"tab-content"},a().createElement("div",null,a().createElement(Ce,{taskId:Ae,isLoading:Oe,questionnaireInfo:we,pageNumber:Me.pageNumber,pageSize:Me.pageSize,pageChange:this.questionnairePageChange,pageSizeChange:this.questionnairePageSizeChange})))),f.qyShield==="false"&&a().createElement(J.Z.TabPane,{tab:o("coachAnalysis.tutorialsAnalysis"),key:"4"},a().createElement(qe,{planId:ze.planId}))))))}}_t.defaultProps={prefixCls:"employee-monitor"};var Pt=(0,F.$j)(yt)((0,N.Z)()(_t))},5364:function(xe,re,e){"use strict";e.d(re,{MA:function(){return L},oA:function(){return C},Un:function(){return R}});var se=e(88986),J=e(57361),Y=e(9754),a=e.n(Y),N=e(37055),F=e(10237),L=m=>{var Z=N.ZP.EmployeeEdit.getCoachAnalysisListUrl(m);return delete m.planId,F.WY.get({url:Z,params:m})},C=m=>{var Z=N.ZP.EmployeeEdit.getCoachAnalysisDetailUrl(m);return delete m.planId,delete m.tutorialsId,F.WY.get({url:Z,params:m})};function R(m){return z.apply(this,arguments)}function z(){return z=(0,J.Z)(a().mark(function m(Z){var x,b,_,D;return a().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return x=Z.id,b=Z.page_number,_=Z.page_size,c.next=3,F.WY.get({url:N.ZP.EmployeeTrain.getAnalysisList({id:x}),params:{page_number:b,page_size:_,is_pending:!0}});case 3:if(D=c.sent,D.status!==200){c.next=6;break}return c.abrupt("return",{data:{code:"200000",data:(0,se.Z)({},D.data)}});case 6:return c.abrupt("return",D);case 7:case"end":return c.stop()}},m)})),z.apply(this,arguments)}},31945:function(xe,re,e){"use strict";e.d(re,{Z:function(){return le}});var se=e(88983),J=e(47933),Y=e(20228),a=e(11382),N=e(62029),F=e(30887),L=e(99210),C=e(59250),R=e(13013),z=e(57663),m=e(71577),Z=e(63185),x=e(9676),b=e(71194),_=e(57016),D=e(88986),t=e(34792),c=e(48086),s=e(43358),g=e(34041),i=e(12924),r=e.n(i),T=e(28216),v=e(91768),S=e(57254),E=e(18329);class B extends r().Component{constructor(){super(...arguments);this.onCancel=()=>{this.props.showReferenceCourseList()}}render(){var O=this.props,ae=O.visible,$=O.courseList,de=O.t;return r().createElement(E.ZP,{visible:ae,title:de("common.tip"),onCancel:this.onCancel,onOk:this.onCancel},r().createElement("div",{className:"referenceWithOtherCourses"},r().createElement("div",{className:"referenceWithOtherCourses__tip"},de("course.deleteCourseTip")),$.map((he,oe)=>r().createElement("div",{className:"referenceWithOtherCourses__item",key:oe},$.length>1?"".concat(oe+1,"\u3001"):null," ",he))))}}var Q=(0,v.Z)()(B),y=e(10237),w=e(63848),A=e(58546),M=e(30389),H=e(54792),ee=e(86726),q=e(37055),u=g.Z.Option,U={setClassify:q.ZP.CourseManageList.setClassify,setScore:q.ZP.CourseManageList.setScore,setBatchEmployee:q.ZP.CourseManageList.setBatchEmployee,deleteCourse:q.ZP.CourseManageList.deleteCourse,exportCourseView:q.ZP.CourseManageList.exportCourseView,syncCourse:q.ZP.CourseManageList.syncCourse},k=X=>({qyShield:X.user.qyShield});class G extends r().Component{constructor(){super(...arguments);this.state={classifyProps:{visible:!1},scoreProps:{title:this.props.t("course.setCredits"),labelTxt:this.props.t("course.credit"),initialValue:"",visible:!1},employeeProps:{visible:!1,initialParams:{employeeRange:{rangeType:3,rangeList:{dept:[],post:[],group:[],user:[]}}}},asyncProps:{value:0,visible:!1},showReferenceCourseListProps:{visible:!1,courseList:[],onOk:this.showReferenceCourseList,onCancel:this.showReferenceCourseList}},this.handleChangeClassify=O=>{this.props.onClassifyChange(O)},this.handleChangeType=O=>{this.props.onTypeChange(O)},this.handleChangeCourseType=O=>{this.props.onCourseTypeChange(O)},this.actionChangeClassify=()=>{this.setState({classifyProps:{visible:!0}})},this.handleCategoryCancel=()=>{this.setState({classifyProps:{visible:!1}})},this.handleCategoryOk=O=>{var ae=O.node,$=this.props,de=$.selectedCourseIds,he=$.selectedProjectIds,oe=$.onForceRender,ve=$.t,_e=ae.id;_e&&y.qg.post({url:U.setClassify(),data:{course_ids:de.join(","),project_ids:he.join(","),classify_id:_e}}).then(()=>{c.default.success(ve("course.setCourseClassifySuccess")),oe()}),this.handleCategoryCancel()},this.actionSetScore=()=>{this.setState(O=>({scoreProps:(0,D.Z)((0,D.Z)({},O.scoreProps),{},{initialValue:"",visible:!0})}))},this.handleScoreCancel=()=>{this.setState(O=>({scoreProps:(0,D.Z)((0,D.Z)({},O.scoreProps),{},{visible:!1})}))},this.handleScoreOk=O=>{var ae=O.value;if(ae===0){this.handleScoreCancel();return}var $=this.props,de=$.selectedCourseIds,he=$.selectedProjectIds,oe=$.onForceRender,ve=$.t;y.qg.post({url:U.setScore(),data:{course_ids:de.join(","),project_ids:he.join(","),credit:ae}}).then(()=>{c.default.success(ve("course.setCourseScoreSuccess")),oe()}),this.handleScoreCancel()},this.actionSetEmployeeRange=()=>{this.setState(O=>({employeeProps:(0,D.Z)((0,D.Z)({},O.employeeProps),{},{visible:!0})}))},this.handleEmployeeCancel=()=>{this.setState({employeeProps:{visible:!1,initialParams:{employeeRange:{rangeType:3,rangeList:{dept:[],post:[],group:[],user:[]}}}}})},this.handleEmployeeOk=O=>{var ae=this.props,$=ae.selectedCourseIds,de=ae.selectedProjectIds,he=ae.onForceRender,oe=ae.t,ve=O.isAll,_e=O.departmentIds,pe=O.groupIds,W=O.postIds,d=O.userIds,l=O.qy_we_chat_vo;y.WY.post({url:U.setBatchEmployee(),data:{course_ids:$.join(","),project_ids:de.join(","),department_ids:_e,group_ids:pe,is_all:ve,post_ids:W,user_ids:d,qy_we_chat_vo:l}}).then(()=>{c.default.success(oe("personal.batchSetRangeSuccess")),he()}),this.handleEmployeeCancel()},this.showReferenceCourseList=O=>{this.setState(ae=>({showReferenceCourseListProps:(0,D.Z)((0,D.Z)({},ae.showReferenceCourseListProps),{},{visible:!ae.showReferenceCourseListProps.visible,courseList:O||[]})}))},this.actionDelete=()=>{var O=this.props,ae=O.selectedCourseIds,$=O.selectedProjectIds,de=O.list,he=O.onForceRender,oe=O.t,ve=0,_e=0,pe=[];if(de.forEach(W=>{ae.includes(W.course_id)&&(W.reference_plan_count>0&&(_e+=1),W.reference_plan_count>0&&pe.push(W.title),W.can_delete==="true"&&(ve+=1))}),_e>0)this.showReferenceCourseList(pe);else if(ve!==ae.length)c.default.warning(oe("personal.deletePlatformCourseTip"));else{if($.length>0){c.default.warning(oe("personal.deleteProjectCourseTip"));return}_.Z.confirm({title:oe("common.tip"),content:oe("common.confirmDeleteTitle"),onOk(){y.qg.post({url:U.deleteCourse(),data:{enterpriseId:q.ZP.enterpriseId,ids:ae.join(","),project_ids:$.join(",")}}).then(W=>{var d=W.data,l=d.code,p=d.msg;c.default["".concat(l===0?"success":"warning")](p),l===0&&he()})}})}},this.actionSyncSetting=()=>{this.setState(O=>({asyncProps:(0,D.Z)((0,D.Z)({},O.asyncProps),{},{visible:!0})}))},this.onAsyncChange=O=>{this.setState(ae=>({asyncProps:(0,D.Z)((0,D.Z)({},ae.asyncProps),{},{value:O.target.value})}))},this.handleSyncCancel=()=>{this.setState({asyncProps:{visible:!1,value:0}})},this.handleSyncOk=()=>{var O=this.props,ae=O.selectedCourseIds,$=O.selectedProjectIds,de=O.onForceRender,he=O.t,oe=this.state.asyncProps;y.qg.post({url:U.syncCourse(),data:{course_ids:ae.join(","),project_ids:$.join(","),syncProgress:oe.value}}).then(ve=>{var _e=ve.data,pe=_e.code,W=_e.msg;pe===0?(c.default.success(he("setting.setUpSucceed")),de()):c.default.warning(W)}),this.handleSyncCancel()},this.actionImportDetail=()=>{var O=this.props,ae=O.selectedCourseIds,$=O.selectedProjectIds,de=O.onForceRender,he=O.t;if(ae.concat($).length>20){c.default.warning(he("courseManage.exportMoreTip"));return}var oe=U.exportCourseView(),ve={course_Ids:ae.join(","),project_Ids:$.join(",")};y.WY.get({url:oe,params:ve}).then(_e=>{_e.data.code===200&&c.default.success("\u6587\u4EF6\u751F\u6210\u4E2D\uFF0C\u8BF7\u7A0D\u540E\u5728\u6587\u4EF6\u4E0B\u8F7D\u4E2D\u4E0B\u8F7D"),de(),this.getDownloadingNumber()})},this.getDownloadingNumber=()=>{var O=q.ZP.downLoadCenter.getDownLoadingCount();y.WY.get({url:O,params:{}}).then(ae=>{sessionStorage.setItem("downloadingCount",ae.data.data),this.props.dispatch({type:"download/updateDownloadingNumber",downloadingNumber:ae.data.data})}).catch(()=>{sessionStorage.setItem("downloadingCount",0),this.props.dispatch({type:"download/updateDownloadingNumber",downloadingNumber:0})})},this.handleChangeCheckBox=O=>{this.props.onCheckboxChange(O.target.checked)},this.handleSharingQueryRowCheckboxChange=O=>{this.props.onSharingCheckboxChange(O.target.checked)},this.renderCondition=()=>{var O=this.props,ae=O.prefixCls,$=O.params,de=O.qyShield,he=O.t,oe=$.classify_id?$.classify_id.split(","):[];return r().createElement("div",{className:"".concat(ae,"__condition")},this.props.extraDom&&this.props.extraDom(),r().createElement(w.Z,{onChange:this.handleChangeClassify,className:"cl-search-normal-width",value:oe,showLabel:!1,placeholder:"Please select",queryType:"course_manage",unclassified:"true"}),r().createElement(g.Z,{value:$.type,className:"cl-search-normal-width",onChange:this.handleChangeType},r().createElement(u,{value:""},this.props.t("courseManage.allOrigin")),r().createElement(u,{value:"original"},this.props.t("courseManage.originalCourse")),r().createElement(u,{value:"notOriginal"},this.props.t("courseManage.nonOriginalCourse")),r().createElement(u,{value:"platform"},this.props.t("courseManage.platformProcurement"))),this.props.courseType&&this.props.courseType=="graphic"?null:r().createElement(g.Z,{value:$.course_type,className:"cl-search-normal-width",onChange:this.handleChangeCourseType},r().createElement(u,{value:"all"},this.props.t("courseManage.allType")),r().createElement(u,{value:"course"},this.props.t("common.courseLabel")),r().createElement(u,{value:"microCourse"},this.props.t("common.microCourse")),r().createElement(u,{value:"project"},this.props.t("leftMenuLists.studyProject"))),r().createElement(x.Z,{onChange:this.handleChangeCheckBox,style:{marginRight:16}},he("common.myCreated")),this.props.courseType&&this.props.courseType==="graphic"&&de==="false"?r().createElement(x.Z,{onChange:this.handleSharingQueryRowCheckboxChange},he("common.sharing")):null)},this.renderActions=()=>{var O=this.props,ae=O.prefixCls,$=O.selectedCourseIds,de=O.selectedProjectIds,he=O.showNum,oe=he===void 0?1:he,ve=this.props.allowActions,_e=(0,ee.H3)("delete",ve),pe=(0,ee.H3)("adjustment_classification",ve),W=(0,ee.H3)("set_visible",ve),d=(0,ee.H3)("export",ve),l=(0,ee.H3)("set_score",ve),p=(0,ee.H3)("progressSync",ve),I=[{name:this.props.t("courseManage.adjustClassification"),type:"actionChangeClassify",isShow:pe},{name:this.props.t("courseManage.exportViewDetail"),type:"actionImportDetail",isShow:d},{name:this.props.t("courseManage.setCredits"),type:"actionSetScore",isShow:l},{name:this.props.t("courseManage.setTheVisibilityed"),type:"actionSetEmployeeRange",isShow:W},{name:this.props.t("common.delete"),type:"actionDelete",isShow:_e},{name:this.props.t("common.scheduleSyncSetting"),type:"actionSyncSetting",isShow:p}],P=I.filter(ie=>ie.isShow),V=[],j=[];if(P.length)oe?(V=[...P.slice(0,oe)],j=[...P.slice(oe)]):j=[...P];else return null;return r().createElement("div",{className:"".concat(ae,"__action")},V.map(ie=>r().createElement(m.Z,{style:{marginRight:"8px"},key:ie.type,disabled:!($.length+de.length),onClick:this[ie.type]},ie.name)),j.length?r().createElement(R.Z,{disabled:!($.length+de.length),overlay:this.renderMoreButton({buttons:j})},r().createElement(m.Z,{className:"cl-pointer"},"".concat(this.props.t("common.more"))," ",r().createElement(S.Z,null))):"")}}renderMoreButton(O){var ae=O.buttons,$=this.props,de=$.selectedCourseIds,he=$.selectedProjectIds;return r().createElement(L.Z,{onClick:oe=>{var ve=oe.key;this[ve]()}},ae.map(oe=>oe.isShow?r().createElement(L.Z.Item,{key:oe.type,disabled:!(de.length+he.length)},r().createElement("span",{className:"cl-pointer"},oe.name)):null))}render(){var O=this.props,ae=O.prefixCls,$=O.t,de=O.showRenderCondition,he=de===void 0?!0:de,oe=O.showRenderActions,ve=oe===void 0?!0:oe,_e=this.state,pe=_e.classifyProps,W=_e.scoreProps,d=_e.employeeProps,l=_e.showReferenceCourseListProps,p=_e.asyncProps;return r().createElement("div",{className:ae},he&&this.renderCondition(),ve&&this.renderActions(),r().createElement(A.Z,(0,N.Z)({},pe,{title:$("personal.chooseClassify"),onCancel:this.handleCategoryCancel,onOk:this.handleCategoryOk})),r().createElement(H.Z,(0,N.Z)({},W,{onCancel:this.handleScoreCancel,onCreate:this.handleScoreOk})),d.visible&&r().createElement(M.Z,(0,N.Z)({},d,{title:$("courseManage.setTheVisibility"),mode:["all","part","private"],orgProps:{title:$("component.chooseVisibleScope")},isLoading:!d.visible,onCancel:this.handleEmployeeCancel,onCreate:this.handleEmployeeOk})),p.visible&&r().createElement(E.ZP,{wrapClassName:"cl-async-selector-modal",visible:p.visible,title:$("common.scheduleSyncSetting"),okText:$("common.ok"),cancelText:$("common.cancel"),onCancel:this.handleSyncCancel,onOk:this.handleSyncOk},p.visible?r().createElement("div",{className:"".concat(ae,"__async")},r().createElement("p",null," ",$("common.scheduleSyncSettingTip")),r().createElement(J.ZP.Group,{onChange:this.onAsyncChange,value:p.value},r().createElement(J.ZP,{value:0},$("common.outSync")),r().createElement(J.ZP,{value:1},$("common.synchronization")))):r().createElement(a.Z,{size:"large"})),r().createElement(Q,(0,N.Z)({},l,{showReferenceCourseList:this.showReferenceCourseList})))}}G.defaultProps={prefixCls:"resource-course-list-page__release__content__queryrow",rangeType:""};var le=(0,v.Z)()((0,T.$j)(k)(G))},67479:function(xe,re,e){"use strict";e.d(re,{D:function(){return C},W:function(){return z}});var se=e(57361),J=e(9754),Y=e.n(J),a=e(57068),N=e(31916),F=e(38642),L=e(5430);function C(m){return R.apply(this,arguments)}function R(){return R=(0,se.Z)(Y().mark(function m(Z){var x,b,_,D,t;return Y().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,(0,N.uH)();case 3:if(x=s.sent,x!=="old"){s.next=6;break}return s.abrupt("return",!1);case 6:return s.next=8,(0,N.fP)(Z);case 8:if(b=s.sent,_=b.data,D=_.code,t=_.data,D!=="200000"){s.next=14;break}return s.abrupt("return",t.exam_type==="new");case 14:s.next=20;break;case 16:return s.prev=16,s.t0=s.catch(0),console.error("\u65B0\u65E7\u8003\u8BD5\u5224\u65AD",s.t0),s.abrupt("return",!1);case 20:case"end":return s.stop()}},m,null,[[0,16]])})),R.apply(this,arguments)}var z={examing:function(){var m=(0,se.Z)(Y().mark(function x(b){var _,D,t;return Y().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return _="",D=b.pageFrom==="ding_myExamTask"?(0,F.lz)(L.ZP.enterpriseId,"student"):"",s.next=4,C(b.exam_id);case 4:return t=s.sent,t?_="".concat(D,"/training/examination/new-exam/examing?").concat(a.stringify(b)):_="".concat(D,"/training/examination/exam/personal?").concat(a.stringify(b)),s.abrupt("return",_);case 7:case"end":return s.stop()}},x)}));function Z(x){return m.apply(this,arguments)}return Z}(),parse:m=>"/training/examination/new-exam/parse?".concat(a.stringify(m)),examData:m=>"/training/examination/exam-data?exam_id=".concat(m.exam_id,"&task_id=").concat(m.task_id),marking:m=>"/training/examination/new-exam/marking?".concat(a.stringify(m))}},98233:function(xe,re,e){"use strict";e.d(re,{nn:function(){return L},OV:function(){return z},Md:function(){return Z},uk:function(){return F}});var se=e(57361),J=e(9754),Y=e.n(J),a=e(57068),N=e(67479),F={edit:b=>"/training/learning/project/add?".concat(a.stringify(b)),monitorDetail:b=>{var _=b.id,D=b.projectId,t=b.origin,c=b.tab;return"/training/trainingProject/monitor?id=".concat(_,"&projectId=").concat(D,"&origin=").concat(t,"&tab=").concat(c)},traineeView:b=>"/training/trainingProject/traineeView?".concat(a.stringify(b)),manageView:b=>"/training/trainingProject/manageView?".concat(a.stringify(b)),previewView:b=>"/training/trainingProject/previewView?".concat(a.stringify(b))};function L(b){var _=b.origin,D=b.search,t=D===void 0?"":D,c={project:"/knowledgeBase/project/examination/newPlan/detail?".concat(t),learning:"/training/learning/examination/newPlan/detail?".concat(t),employee:"/training/employee/examination/newPlan/detail?".concat(t),exam:"/training/examination/newPlan/detail?".concat(t)};return c[_]||"/training/examination/newPlan/detail?".concat(t)}function C(b,_){if(b){var D=a.stringify({id:_.id,title:_.title,origin:_.taskType,taskId:_.projectId});return L({origin:_.taskType,search:D})}var t=a.stringify({id:_.id,taskId:_.taskId,from:_.from,taskType:_.taskType,projectId:_.projectId});return"/training/learning/project/monitor/exam?".concat(t)}function R(b,_){return b?N.W.marking({exam_id:_.id,status:_.status,markScene:"manage"}):"/training/examination/plan/testPaper?id=".concat(_.id,"&from=").concat(_.from,"&taskId=").concat(_.taskId)}function z(){return m.apply(this,arguments)}function m(){return m=(0,se.Z)(Y().mark(function b(){var _,D,t,c=arguments;return Y().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(_=c.length>0&&c[0]!==void 0?c[0]:"unKnow",D=c.length>1?c[1]:void 0,_!=="unKnow"){g.next=7;break}return g.next=5,(0,N.D)(D.id);case 5:return t=g.sent,g.abrupt("return",C(t,D));case 7:return g.abrupt("return",C(_,D));case 8:case"end":return g.stop()}},b)})),m.apply(this,arguments)}function Z(){return x.apply(this,arguments)}function x(){return x=(0,se.Z)(Y().mark(function b(){var _,D,t,c=arguments;return Y().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(_=c.length>0&&c[0]!==void 0?c[0]:"unKnow",D=c.length>1?c[1]:void 0,_!=="unKnow"){g.next=7;break}return g.next=5,(0,N.D)(D.id);case 5:return t=g.sent,g.abrupt("return",R(t,D));case 7:return g.abrupt("return",R(_,D));case 8:case"end":return g.stop()}},b)})),x.apply(this,arguments)}}}]);
