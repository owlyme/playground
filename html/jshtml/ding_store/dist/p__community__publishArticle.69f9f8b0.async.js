(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[1327],{27114:function(ce,K,e){"use strict";var J=e(62029),I=e(12924),y=e.n(I),R=e(38642),m=t=>{var E=()=>{(0,R.eJ)({url:"".concat(t.to)})};return y().createElement("a",(0,J.Z)({onClick:()=>E()},t),t.children)};K.Z=m},84493:function(ce,K,e){"use strict";e.d(K,{Z:function(){return Pe}});var J=e(57663),I=e(71577),y=e(62029),R=e(88986),m=e(12924),t=e.n(m),E=e(80991),A=e(91768),q=e(62615),ee=e(7584),te=e(2396),G=e(3407),Y=e(6793),ae=(0,Y.me)(),U=G.Z[ae].community,z=p=>{var a=p.trim(),n;if(a.length!==0){var u=JSON.parse(a).blocks,l=u.reduce((i,g)=>i+=g.text.length,0);return l>5e3&&(n="\u9650\u5236\u8F93\u5165\u5B57\u7B265000\u5185"),n}},Q=p=>{var a=p.trim(),n;if(a.length!==0){var u=JSON.parse(a).blocks,l=u.reduce((i,g)=>i+=g.text.length,0);return l>1e3&&(n=U.limit1000ErrTips),n}},re=p=>{var a,n=p.trim();return n||(a=U.inputTitleTips),n.length>100&&(a=U.limit100ErrTips),a},W=p=>{var a;return p||(a=U.selectCircle),a},oe=p=>{var a;return a},x=e(76651),j=e(43358),D=e(34041),M=D.Z.Option;class S extends t().Component{constructor(){super(...arguments);this.onChange=a=>{var n=this.props.onHandleChange;n(a)}}render(){var a=this.props,n=a.t,u=a.options;return t().createElement(D.Z,{placeholder:n("community.selectCircle"),allowClear:!0,onChange:this.onChange},u.map(l=>t().createElement(M,{key:l.id,value:l.id},l.name)))}}var Z=(0,A.Z)()(S),T=e(71194),H=e(57016),L=e(54421),X=e(38272),ne=e(47673),b=e(4107),ge=e(49111),f=e(19650),Je=e(71153),ue=e(60331),k=e(57361),He=e(34792),B=e(48086),F=e(33565),ye=e(9754),N=e.n(ye),le=e(10237),se=e(37055),Ce=e(84874),Oe=e(27114);function Te(p){var a=(0,m.useState)(!1),n=(0,F.Z)(a,2),u=n[0],l=n[1],i=(0,m.useState)([]),g=(0,F.Z)(i,2),c=g[0],V=g[1],Ae=(0,m.useState)([]),de=(0,F.Z)(Ae,2),Me=de[0],Ne=de[1],Ie=(0,m.useState)(""),ve=(0,F.Z)(Ie,2),P=ve[0],w=ve[1],Re=(0,m.useState)([]),pe=(0,F.Z)(Re,2),he=pe[0],We=pe[1],d=p.t,ie=5,be=()=>{if(c.length>5){B.default.info(d("community.addTopicLimit"));return}l(!1)},Be=()=>{V([]),l(!1),w("")},Ee=r=>{c.splice(r,1),V([...c])},$e=function(){var r=(0,k.Z)(N().mark(function s(){var C,O,h;return N().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(P!==""){v.next=2;break}return v.abrupt("return");case 2:return C=se.ZP.community.getLikeSearchTopic(P),v.next=5,le.WY.get({url:C,params:{tagName:P}});case 5:O=v.sent,h=O.data,h.code===0?We(h.data):B.default.error(h.msg||d("community.isError"));case 8:case"end":return v.stop()}},s)}));return function(){return r.apply(this,arguments)}}();(0,m.useEffect)(()=>{var r=p.onHandleChange;r(c)},[c]),(0,m.useEffect)(()=>{function r(){var s=null;return function(){s&&clearTimeout(s),s=setTimeout($e,100)}}r()()},[P]),(0,m.useEffect)(()=>{Ke()},[]);var Ke=function(){var r=(0,k.Z)(N().mark(function s(){var C,O,h;return N().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return C=se.ZP.community.getAllTopic(),v.next=3,le.WY.get({url:C});case 3:O=v.sent,h=O.data,h.code===0?Ne(h.data.slice(0,20)):B.default.error(h.msg||d("community.isError"));case 6:case"end":return v.stop()}},s)}));return function(){return r.apply(this,arguments)}}(),Ue=function(){var r=(0,k.Z)(N().mark(function s(C){var O,h,o;return N().wrap(function($){for(;;)switch($.prev=$.next){case 0:return O=se.ZP.community.getTopicStatus(),$.next=3,le.WY.get({url:O,params:{tagName:C}});case 3:if(h=$.sent,o=h.data,o.code!==0){$.next=7;break}return $.abrupt("return",o.data);case 7:B.default.error(d("community.isError"));case 8:case"end":return $.stop()}},s)}));return function(C){return r.apply(this,arguments)}}(),je=function(){var r=(0,k.Z)(N().mark(function s(){var C,O;return N().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(P){o.next=2;break}return o.abrupt("return",B.default.info(d("community.pleaseInputTag")));case 2:if(!(P.length>10)){o.next=4;break}return o.abrupt("return",B.default.warning(d("community.inputRules")));case 4:return o.next=6,Ue(P);case 6:if(C=o.sent,!C){o.next=10;break}return B.default.info(d("community.tagHadDisabled")),o.abrupt("return");case 10:O=Array.from(new Set([...c,P])),V(O),w("");case 13:case"end":return o.stop()}},s)}));return function(){return r.apply(this,arguments)}}(),fe=r=>{c.includes(r)||(V([...c,r]),w(""))},Ve=r=>{w(r.target.value.trim())};return t().createElement("div",{className:"topic-modal-list-container"},t().createElement(f.Z,{wrap:!0},c.map((r,s)=>t().createElement(ue.Z,{key:s,closable:!0,onClose:()=>Ee(s)},t().createElement(Oe.Z,{to:"/community"},"#",r,"#"))),t().createElement("div",{className:"topic-add-btn",onClick:()=>l(!0)},t().createElement(Ce.Z,{iconClass:"icon-icon_addx",size:"10px",color:"#465DCD"}),t().createElement("span",null,d("community.topic")))),t().createElement(H.Z,{title:d("community.addTopic"),visible:u,onOk:be,onCancel:Be},t().createElement("header",{className:"topic-modal-header"},d("community.hadAddTopic"),"(",c.length,"/",ie,")"),t().createElement("div",{className:"topic-modal-topic"},t().createElement("span",null,c.map((r,s)=>t().createElement(ue.Z,{key:s,className:"topic-modal-tag",closable:!0,onClose:()=>Ee(s)},"#",r,"#")))),t().createElement(f.Z,null,t().createElement("span",{className:"topic-modal-name"},d("community.topicName"),":"),t().createElement(b.Z,{value:P,onChange:Ve,className:"topic-modal-create",placeholder:d("community.pleaseInput")}),t().createElement(I.Z,{type:"default",disabled:ie<=c.length,onClick:je,className:"topic-modal-button"},d("community.createTopic"))),he.length>0&&t().createElement("ul",{className:"topic-modal-ul"},he.map((r,s)=>t().createElement("li",{key:s,onClick:()=>fe(r)},r))),t().createElement("div",{className:"topic-modal-list"},t().createElement(X.ZP,{header:null,footer:null,bordered:!0,dataSource:Me,className:"topic-modal-list-body",renderItem:r=>t().createElement("div",{className:"topic-modal-list-item"},t().createElement("div",null,"#",r,"#"),t().createElement(I.Z,{disabled:ie<=c.length,className:"topic-modal-list-btn",onClick:()=>fe(r)},d("common.addSome")))}))))}var De=(0,A.Z)()(Te),me=e(43859),Se=(0,me.Z)(Z),Ze=(0,me.Z)(De),_={labelCol:{xs:{span:24},sm:{span:3}},wrapperCol:{xs:{span:24},sm:{span:21}}};class Le extends m.Component{constructor(a){super(a);this.handleSure=n=>{var u=this.state.initialValues,l=this.props.handleSubject,i=(0,R.Z)((0,R.Z)({},n),{},{circle:u.circle,content:JSON.stringify({type:"pc",content:n.h5Article}),topic:u.topic});delete i.h5Article,l(i)},this.handleCancel=()=>{x.m8.goBack()},this.handleSelect=n=>{var u=this.state.initialValues,l=JSON.parse(JSON.stringify(u));l.circle=n,this.setState({initialValues:l})},this.handleCreateTopic=n=>{var u=this.state.initialValues,l=JSON.parse(JSON.stringify(u));l.topic=n,this.setState({initialValues:l})},this.state={initialValues:{title:"",h5Article:"",circle:"",topic:""}}}render(){var a=this.props,n=a.title,u=a.circleList,l=a.isArticle,i=a.t,g=this.state.initialValues;return t().createElement("div",{className:"form_common"},n&&t().createElement("h2",null,n),t().createElement("div",null,t().createElement(E.J9,{ref:c=>{this.initRef=c},initialValues:g,onSubmit:c=>this.handleSure(c),render:c=>t().createElement(E.l0,{className:"cl-form cl-notice-form"},t().createElement(E.gN,(0,y.Z)({component:ee.Z,name:"title",label:i(l?"h5Article.formRowName":"community.problem"),required:!0,type:"text",maxLength:100,placeholder:i("community.inputTitleTips"),defaultValue:g.title,validate:V=>(0,te.QK)(V,i("community.inputTitleTips"))},_)),t().createElement(E.gN,(0,y.Z)({component:Ze,name:"topic",label:i("community.addTopic"),type:"button",defaultValue:g.topic,isArticle:l,onHandleChange:this.handleCreateTopic},_)),t().createElement(E.gN,(0,y.Z)({label:i("community.addDescription"),component:q.h,displayType:"Custom",showPrivate:!1,name:"h5Article",defaultFieldList:g.h5Article,scrollDOMSelector:".h5-article-page",topHeight:128,validate:l?z:Q},_)),t().createElement(E.gN,(0,y.Z)({component:Se,name:"circle",label:i("community.selectSpace"),type:"select",defaultValue:g.circle,required:!0,onHandleChange:this.handleSelect,options:u},_)),t().createElement("div",{className:"form-common-option-btn"},t().createElement(I.Z,{htmlType:"submit",type:"primary"},i("common.release")),t().createElement(I.Z,{type:"default",onClick:this.handleCancel,style:{marginLeft:"20px"}},i("common.cancel"))))})))}}var Pe=(0,E.$j)((0,A.Z)()(Le))},59302:function(ce,K,e){"use strict";e.r(K);var J=e(88986),I=e(34792),y=e(48086),R=e(57361),m=e(9754),t=e.n(m),E=e(12924),A=e.n(E),q=e(91768),ee=e(84493),te=e(4408),G=e(10237),Y=e(37055),ae=e(69164),U=e(28216),z,Q,re,W,oe=(z=(0,U.$j)(x=>{var j=x.community;return{}}),Q=Reflect.metadata("design:type",Function),re=Reflect.metadata("design:paramtypes",[void 0]),z(W=Q(W=re(W=class extends E.Component{constructor(j){var D;super(j);D=this,this.getCircleType=(0,R.Z)(t().mark(function M(){var S,Z,T;return t().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return S=Y.ZP.community.getGroups(0),L.next=3,G.WY.get({url:S});case 3:Z=L.sent,T=Z.data,T.code===0?D.setState({circleList:T.data.content}):y.default.error(T.msg);case 6:case"end":return L.stop()}},M)})),this.handleSubject=function(){var M=(0,R.Z)(t().mark(function S(Z){var T,H,L,X,ne,b;return t().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(T=D.props.t,Z.circle){f.next=4;break}return y.default.info(T("community.selectCircle")),f.abrupt("return");case 4:if(!(Z.topic.length>5)){f.next=7;break}return y.default.info(T("community.addTopicLimit")),f.abrupt("return");case 7:return H=Y.ZP.community.publishArticle(Z.circle),L=localStorage.getItem("uid"),X=localStorage.getItem("name"),f.next=12,G.WY.post({url:H,data:(0,J.Z)((0,J.Z)({},Z),{},{userId:L,userName:X})});case 12:ne=f.sent,b=ne.data,b.code===0?(D.props.dispatch({type:"community/saveCreateCenterTab",payload:{activeMyTab:"article"}}),studentRouteJump({url:"/community/articleDetail?id=".concat(b.data.id)}),(0,ae.Z)(b.data.integralInfo)):y.default.error(b.msg||T("community.isError"));case 15:case"end":return f.stop()}},S)}));return function(S){return M.apply(this,arguments)}}(),this.state={circleList:[]}}componentDidMount(){this.getCircleType()}render(){var j=this.state.circleList,D=j===void 0?[]:j,M=this.props.t;return A().createElement("div",{className:"article_container h5-article-page"},A().createElement(te.Z,{title:M("community.addArticle")}),A().createElement("div",{className:"article_content"},A().createElement(ee.Z,{title:M("community.addArticle"),handleSubject:S=>this.handleSubject(S),circleList:D,isArticle:!0})))}})||W)||W)||W);K.default=(0,q.Z)()(oe)}}]);
