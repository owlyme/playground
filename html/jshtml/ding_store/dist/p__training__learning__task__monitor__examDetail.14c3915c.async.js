(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[3894,8185],{77217:function(Ee,H,e){"use strict";var oe=e(12924),f=e.n(oe),j=a=>f().createElement("div",{className:"cl-breadcrumb-container"},a.children);H.Z=j},30311:function(Ee,H,e){"use strict";var oe=e(22385),f=e(31097),j=e(12924),a=e.n(j),I=e(8812),o=e(28216),R=Z=>{var v=(0,o.v9)(U=>{var z=U.advancedSetting;return{themeColor:z.themeColor}}),C=v.themeColor;return a().createElement(f.Z,{placement:"top",title:Z.name},a().createElement("span",{className:"cl-table__cell-arrow",onClick:Z.onClick},a().createElement("span",{style:{color:C}},Z.name),a().createElement("span",{className:"cl-table__cell-arrow-icon"},a().createElement(I.Z,null))))};H.Z=R},30389:function(Ee,H,e){"use strict";e.d(H,{Z:function(){return i}});var oe=e(62029),f=e(20228),j=e(11382),a=e(12924),I=e.n(a),o=e(91768),R=e(80991),Z={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},v=e(62615),C=e(52670);class U extends I().Component{render(){var d=this.props,N=d.values,P=d.mode,W=d.onlyChooseDept,y=d.reserveUser,re=d.t,se=d.orgProps,K=d.rangeAuth,p=d.projectId,_=d.onCancel,E=d.onlyCreateUser;return I().createElement(R.l0,{className:"cl-form"},I().createElement(R.gN,(0,oe.Z)({component:v.ww,displayType:"Custom",showSectitle:!1,name:"employeeRange",label:re("common.visibleRange"),defaultFieldList:N.employeeRange,validate:C.FI,mode:P,rangeAuth:K,onlyChooseDept:W,onlyCreateUser:E,orgProps:se,reserveUser:y,projectId:p,onCancel:_,qwTicketShow:!0},Z)))}}var z=(0,o.Z)()(U),$=e(18329),B=e(34773);class x extends I().Component{constructor(){super(...arguments);this.initRefFormik=d=>{this.refFormik=d},this.handleBeforeCreate=()=>{var d=this.refFormik;d.submitForm(),d.runValidations().then(N=>{if(!Object.keys(N).length){var P=d.state.values.employeeRange,W=(0,B.b)(P.rangeList),y={qyWeChatVo:P.qyWeChatVo,id:this.props.actionId,isAll:P.rangeType,groupIds:P.rangeType===2?W.groupIds.join(","):"",departmentIds:P.rangeType===2?W.deptIds.join(","):"",userIds:P.rangeType===2?W.userIds.join(","):"",postIds:P.rangeType===2?W.postIds.join(","):"",clusterIds:P.rangeType===2?W.clusterIds.join(","):"",qy_we_chat_vo:P.qyWeChatVo};this.props.onCreate(y)}})},this.handleBeforeCancel=()=>{var d=this.props.onCancel;d()}}render(){var d=this.props,N=d.visible,P=d.initialParams,W=d.isLoading,y=d.tipInfo,re=d.mode,se=d.onlyChooseDept,K=d.reserveUser,p=K===void 0?[]:K,_=d.t,E=d.title,g=d.orgProps,b=d.rangeAuth,S=d.projectId,D=d.onCancel,L=d.onlyCreateUser,G=d.size;return W?I().createElement(j.Z,{size:"large"}):I().createElement($.ZP,{wrapClassName:"cl-employee-selector-modal",visible:N,title:E||_("component.changeUser"),okText:_("common.ok"),cancelText:_("common.cancel"),size:G,onCancel:this.handleBeforeCancel,onOk:this.handleBeforeCreate},W?I().createElement(j.Z,{size:"large"}):I().createElement(R.J9,{ref:this.initRefFormik,initialValues:P,render:ae=>I().createElement(z,(0,oe.Z)({},ae,{mode:re,rangeAuth:b,orgProps:g,onlyChooseDept:se,onlyCreateUser:L,reserveUser:p,projectId:S,onCancel:D}))}),y&&I().createElement("p",{style:{padding:"0 24px",wordBreak:"break-all",whiteSpace:"normal"}},y))}}x.defaultProps={visible:!1,initialParams:{employeeRange:{rangeType:1,rangeList:{dept:[],post:[],group:[],user:[],cluster:[]}}},tipInfo:"",isLoading:!1,mode:["all","part"],onlyChooseDept:!1,onlyCreateUser:!1,orgProps:{},onCancel:()=>{},onCreate:()=>{},size:"middle"};var i=(0,o.Z)()(x)},64549:function(Ee,H,e){"use strict";var oe=e(12924),f=e.n(oe),j=e(28216),a=e(84874),I=R=>({guideStatus:R.advancedSetting.guideStatus,isNewUser:R.advancedSetting.isNewUser});class o extends f().Component{constructor(){super(...arguments);this.state={guideIndex:0,showGuide:this.props.renderGuide},this.onNextStep=()=>{var Z=this.state.guideIndex,v=this.props.guidePageProps;if(Z>=v.length-1){this.onCloseGuide();return}this.setState({guideIndex:Z+1})},this.onCloseGuide=()=>{this.setState({showGuide:!1},()=>{this.props.closeGuide&&this.props.closeGuide()}),this.props.isNewUser==="true"&&this.props.dispatch({type:"shouldRenderHeaderGuide",payload:{headerGuideStatus:!0}}),this.updateAllStatus()},this.updateAllStatus=()=>{localStorage.setItem("guideStatus","false"),this.props.dispatch({type:"updateGuideStatus",payload:{guideStatus:"false"}})},this.renderRightItem=Z=>f().createElement(f().Fragment,null,f().createElement("div",{className:"clguide-popover__content"},f().createElement("span",{onClick:this.onCloseGuide},f().createElement(a.Z,{iconClass:"icon-f-close",size:"12px",color:"#fff"})),f().createElement("div",{className:"clguide-popover__content__text"},Z.contentText),f().createElement("div",{className:"clguide-popover__content__button",onClick:this.onNextStep},Z.buttonText)),f().createElement("div",{className:"clguide-popover__righttriangle"}),Z.typeText&&f().createElement("div",{className:" clguide-popover__circle"},Z.typeText)),this.renderLeftItem=Z=>f().createElement(f().Fragment,null,f().createElement("div",{className:" clguide-popover__circle"},Z.typeText),f().createElement("div",{className:"clguide-popover__lefttriangle"}),f().createElement("div",{className:"clguide-popover__content"},f().createElement("span",{onClick:this.onCloseGuide},f().createElement(a.Z,{iconClass:"icon-f-close",size:"12px",color:"#fff"})),f().createElement("div",{className:"clguide-popover__content__text"},Z.contentText),f().createElement("div",{className:"clguide-popover__content__button",onClick:this.onNextStep},Z.buttonText)))}render(){var Z=this.state,v=Z.guideIndex,C=Z.showGuide,U=this.props,z=U.className,$=U.guideStatus,B=U.guidePageProps,x=B===void 0?[]:B,i=U.direction,ie=i===void 0?"right":i,d=U.showDownloadBtn;return!C&&!$?null:f().createElement("div",{className:"clguide-popover-container"},C&&$==="true"&&f().createElement("div",{className:"clguide-popover-mask"}),C&&$==="true"&&v===0&&x.length?f().createElement("div",{className:"".concat(z,"_next clguide-popover ").concat(d?"":"right")},ie==="left"?this.renderLeftItem(x[0]):this.renderRightItem(x[0])):null,C&&$==="true"&&v===1&&x.length?f().createElement("div",{className:"".concat(z,"_know clguide-popover")},ie==="left"?this.renderLeftItem(x[1]):this.renderRightItem(x[1])):null)}}H.Z=(0,j.$j)(I)(o)},63848:function(Ee,H,e){"use strict";var oe=e(36877),f=e(32969),j=e(12924),a=e.n(j),I=e(91768),o=e(56130);class R extends a().PureComponent{constructor(){super(...arguments);this.onChange=(v,C)=>{this.props.onChange(v,C)}}render(){var v=this.props,C=v.value,U=v.classify,z=v.showLabel,$=v.className,B=v.t,x=v.style;return a().createElement("div",{className:"classify-cascader ".concat($)},z?a().createElement("span",{className:"classify-cascader-label"},B("component.selectClassifyLabel")):null,a().createElement(f.Z,{changeOnSelect:this.props.changeOnSelect,className:"classify-cascader-select ".concat($),options:U,onChange:this.onChange,placeholder:B("component.selectClassifyLabel"),value:C,style:x,loadData:this.props.loadData}))}}R.defaultProps={showLabel:!0,changeOnSelect:!0,onChange:()=>{}},H.Z=(0,o.Z)((0,I.Z)()(R))},64630:function(Ee,H,e){"use strict";var oe=e(62029),f=e(62999),j=e(85733),a=e(12924),I=e.n(a),o=e(91768),R=e(10237),Z=e(37055),v=e(25547),C=j.Z.TreeNode;class U extends I().Component{constructor($){super($);this.getPostTree=()=>{var B=Z.ZP.OrgTree.getPostTree();R.WY.get({url:B}).then(x=>{var i=(0,v.NP)(x.data.posts,{id:"value",post_name:"postName"});this.setState({treeData:i})})},this.handleChange=(B,x,i)=>{this.props.onChange(typeof B=="undefined"?"":B,x,i)},this.renderTreeNodes=B=>B.map(x=>{var i=!0;return this.props.noChildSelect&&(i=x.post_type==="post"),x.children?I().createElement(C,{selectable:!this.props.noChildSelect,title:x.postName,key:x.id,value:x.id,isLeaf:!1,dataRef:x},this.renderTreeNodes(x.children)):I().createElement(C,{selectable:i,title:x.postName,dataRef:x,value:x.id,key:x.id,isLeaf:!0})}),this.renderTreeSelect=()=>{var B=this.props,x=B.t,i=B.defaultValue,ie=i===void 0?[]:i,d=B.multiple,N=d===void 0?!1:d,P=B.width,W=P===void 0?180:P,y={showSearch:!1,style:{width:W},defaultValue:ie,multiple:N,dropdownStyle:{maxHeight:300,overflow:"auto"},placeholder:x("component.choosePostTip"),allowClear:!0,disabled:this.props.disabled};return this.state.treeData.length>0?I().createElement(j.Z,(0,oe.Z)({},y,{onChange:this.handleChange,className:this.props.className}),this.renderTreeNodes(this.state.treeData)):I().createElement("div",{style:{textAlign:"center"}})},this.state={treeData:[]}}componentDidMount(){this.getPostTree()}render(){return I().createElement("div",{className:"org-tree-container ".concat(this.props.className)},this.renderTreeSelect())}}U.defaultProps={disabled:!1,onChange:()=>{}},H.Z=(0,o.Z)()(U)},54792:function(Ee,H,e){"use strict";var oe=e(62029),f=e(63185),j=e(9676),a=e(47673),I=e(4107),o=e(88986),R=e(12924),Z=e.n(R),v=e(91768),C=e(59239),U=e(55446),z=e.n(U),$=e(18329),B=e(2396);class x extends Z().Component{constructor(){super(...arguments);this.state={isChecked:!1},this.handleBeforeCreate=()=>{var d=this.props,N=d.form,P=d.id,W=d.onCreate,y=this.state.isChecked;N.validateFields((re,se)=>{if(!re){var K=(0,o.Z)({},se);y||(K.value=0);var p=(0,o.Z)((0,o.Z)({},K),{},{id:P});W(p),setTimeout(()=>{N.resetFields()},100)}})},this.handleBeforeCancel=()=>{var d=this.props,N=d.form,P=d.onCancel;P(),setTimeout(()=>{N.resetFields()},100)},this.checkScore=(d,N,P)=>{var W=this.props.t,y=this.state.isChecked;if(y&&(0,B.kh)(N)){P(W("component.setScoreRuleTip"));return}P()},this.handleCheckChange=d=>{this.setState({isChecked:d.target.checked})},this.renderItem=()=>{var d=this.props,N=d.form,P=d.initialValue,W=d.labelTxt,y=this.state.isChecked,re=N.getFieldDecorator,se={labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:18}}},K=y?re("value",{initialValue:P,rules:[{validator:this.checkScore}]})(Z().createElement(I.Z,{maxLength:30,placeholder:""})):null,p=Z().createElement(Z().Fragment,null,Z().createElement(j.Z,{checked:y,onChange:this.handleCheckChange},W));return Z().createElement(C.Z.Item,(0,oe.Z)({label:p},se),K)}}componentDidUpdate(d){this.props.visible&&this.props.visible!==d.visible&&this.setState({isChecked:!!this.props.initialValue})}render(){var d=this.props,N=d.visible,P=d.title,W=d.prefixCls;return Z().createElement($.ZP,{size:"small",visible:N,title:P,onCancel:this.handleBeforeCancel,onOk:this.handleBeforeCreate},Z().createElement(C.Z,{className:"".concat(W),layout:"horizontal",colon:!1},this.renderItem(),Z().createElement("div",{className:"".concat(W,"__children")},this.props.children)))}}x.defaultProps={prefixCls:"cl-setscore",id:"",visible:!1,title:"SetScore",labelTxt:"",initialValue:"",onCancel:()=>{},onCreate:()=>{}};var i=C.Z.create({name:"ClSetupBoxInModal"})(x);H.Z=(0,v.Z)()(i)},47745:function(Ee,H,e){"use strict";e.d(H,{Z:function(){return p}});var oe=e(34792),f=e(48086),j=e(88986),a=e(57663),I=e(71577),o=e(71153),R=e(60331),Z=e(12924),v=e.n(Z),C=e(91768),U=e(76651),z=e(87722);class $ extends v().Component{constructor(){super(...arguments);this.handleTimeRange=E=>{var g=E.startTime,b=E.endTime,S=E.dateStrings;if(!S.filter(L=>L).length){this.props.handleChangeDataRange({startTime:"",endTime:""});return}var D={startTime:g,endTime:b};this.props.handleChangeDataRange(D)}}render(){return v().createElement("div",{className:"exam-grades__query"},v().createElement(z.Z,{timestamp:!0,showTime:!0,format:"YYYY-MM-DD HH:mm",onCustomChange:this.handleTimeRange}))}}var B=(0,C.Z)()($),x=e(84391),i=_=>{var E=_.t,g=_.shouldRenderExport;return v().createElement("div",{className:"exam-grades__query"},g&&v().createElement(I.Z,{type:"primary",onClick:_.handleExport},v().createElement(x.Z,null),E("common.exportData")))},ie=(0,C.Z)()(i),d=e(38642),N=e(10237),P=e(37055),W=e(6793),y=e(18329),re=e(95664),se=e(36202);class K extends v().Component{constructor(E){super(E);this.getTableColumns=()=>{var g=[{title:this.props.t("personal.submitTime"),dataIndex:"planId",key:"planId",width:160,render:(L,G)=>v().createElement("span",{className:"exam-grades__table__cell"},(0,W.p6)(G.commit_time,"yyyy-MM-dd hh:mm:ss"),G.score_rule===1?v().createElement(R.Z,{color:"#CF3C3C"},this.props.t("myExamTask.highest")):null,G.score_rule===2?v().createElement(R.Z,{color:"#FFA000"},this.props.t("myExamTask.newest")):null)},{title:this.props.t("examing.examTotalScore"),dataIndex:"total_score",key:"total_score",width:100},{title:this.props.t("myExamTask.score"),dataIndex:"score",key:"score",width:100,render:(L,G)=>G.status===5?"--":L},{title:this.props.t("exam.examTime"),dataIndex:"duration",key:"duration",width:100,render:L=>(0,W.xj)(L)},{title:this.props.t("exam.examResult"),dataIndex:"result",key:"result",width:120},{title:this.props.t("common.operate"),width:100,key:"operate",render:L=>this.props.type==="user"?this.userOperation(L):this.adminOperation(L)}],b={title:this.props.t("exam.marker"),width:100,dataIndex:"marker_name",key:"marker_name"},S=this.props.type,D=S===void 0?"admin":S;return D==="admin"&&g.splice(4,0,b),g},this.userOperation=g=>v().createElement(Z.Fragment,null,g.view_rule===0&&v().createElement(I.Z,{type:"link",size:"small",disabled:!0},this.props.t("common.viewDetails")),g.view_rule===1&&v().createElement(I.Z,{type:"link",size:"small",onClick:()=>this.viewDetails(g)},this.props.t("myExamTask.answerAnalytics")),g.view_rule===2&&v().createElement(I.Z,{type:"link",size:"small",onClick:()=>this.viewDetails(g)},this.props.t("exam.viewRightAndWrong"))),this.adminOperation=g=>v().createElement(Z.Fragment,null,g.status===5?v().createElement("div",{className:"cl-table__cell-action"},v().createElement("span",{className:"cl-pointer cl-disabled"}," ",this.props.t("common.viewDetails"))):v().createElement("div",{className:"cl-table__cell-action",onClick:()=>this.viewDetails(g)},v().createElement("span",{className:"cl-pointer"}," ",this.props.t("common.viewDetails")))),this.viewDetails=g=>{var b=g.user_id,S=g.plan_id,D=g.makeup_count,L=this.props,G=L.pageFrom,ae=L.taskId,de=L.type,le=de===void 0?"admin":de,ce="";le==="admin"?ce="/training/examination/result?pageFrom=examMonitor&id=".concat(S,"&userId=").concat(b,"&makeupCount=").concat(D):G==="myObligatoryTask"?ce="/training/examination/result/personal?fromPage=myObligatoryTask&id=".concat(S,"&userId=").concat(b,"&taskId=").concat(ae,"&makeupCount=").concat(D):G==="myExamTask"?ce="/training/examination/result/personal?pageFrom=myExamTask&id=".concat(S,"&userId=").concat(b,"&makeupCount=").concat(D):ce="/training/examination/result/personal?id=".concat(S,"&userId=").concat(b,"&makeupCount=").concat(D),le==="admin"?U.m8.push(ce):(0,d.eJ)({url:ce})},this.initTableList=()=>{var g=this.props.planId;N.WY.get({url:P.ZP.ExaminationPlanMonitor.getExamAllGrades(g),params:(0,j.Z)({},this.state.params)}).then(b=>{setTimeout(()=>{this.setState({showList:!0,loading:!1,tableList:b.data.list,tableTotal:Number(b.data.total),tableTotalPages:b.data.pages})},300)}).catch(()=>{this.setState({showList:!1,loading:!1}),this.props.hideEveryExamGrade()})},this.handleTableChange=g=>{var b=this.state.params;b.page_number=g,this.setState({params:b},()=>{this.initTableList()})},this.handleChangeDataRange=g=>{this.setState(b=>({params:(0,j.Z)((0,j.Z)({},b.params),{},{commit_time_start:g.startTime,commit_time_end:g.endTime})}),()=>{this.initTableList()})},this.handleExport=()=>{var g=this.props,b=g.t,S=g.planId,D=P.ZP.ExaminationPlanMonitor.exportExamAllGrades(S),L=this.state.params,G=L.commit_time_start,ae=L.commit_time_end,de=L.user_id;D+="?access_token=".concat(window.localStorage.getItem("token"),"&commit_time_start=").concat(G,"&commit_time_end=").concat(ae)+"&user_id=".concat(de),window.location.href=D,f.default.success(b("study.exportSucceed"))},this.onCancel=()=>{this.props.hideEveryExamGrade()},this.renderFooter=()=>{var g=this.props.t;return v().createElement(I.Z,{type:"primary",onClick:this.onCancel},g("common.cancel"))},this.renderLeftRow=()=>v().createElement(B,{handleChangeDataRange:this.handleChangeDataRange}),this.renderRightRow=()=>{var g=this.props.type,b=g===void 0?"admin":g;return v().createElement(ie,{shouldRenderExport:b==="admin",handleExport:this.handleExport})},this.state={loading:!0,params:{commit_time_start:"",commit_time_end:"",user_id:"",page_number:1,page_size:10},tableList:[],tableTotal:0,tableTotalPages:0,showList:!1}}componentDidUpdate(E){this.props.visible&&this.props.visible!==E.visible&&this.props.userId&&this.setState({params:{commit_time_start:"",commit_time_end:"",user_id:this.props.userId,page_number:1,page_size:10,task_id:this.props.taskId},tableList:[],tableTotal:0,tableTotalPages:0},()=>{this.initTableList()})}render(){var E=this.props,g=E.visible,b=E.t,S=E.planTitle,D=this.state,L=D.showList,G=D.loading,ae=D.params,de=D.tableList,le=D.tableTotal,ce=D.tableTotalPages;return v().createElement("div",null,g&&L?v().createElement(y.ZP,{size:"large",visible:g,title:b("exam.examDetails"),onCancel:this.onCancel,onOk:this.onCancel,footer:this.renderFooter()},v().createElement("div",{className:"exam-grades"},v().createElement("div",{className:"exam-grades__title"},S),v().createElement(se.f,{bordered:!0,columns:this.getTableColumns(),rowKey:"makeup_count",dataSource:de,pagination:!1,loading:G,headerTitle:this.renderLeftRow(),toolBarRender:this.renderRightRow,tableUUID:"a7d5cb8a-163d-4795-953e-ae47d83ee50d"}),v().createElement(re.Z,{defaultPageSize:10,totalNum:le,totalPage:ce,current:ae.page_number,showRenderRefresh:!1,onChange:this.handleTableChange}))):null)}}var p=(0,C.Z)()(K)},27550:function(Ee,H,e){"use strict";var oe=e(57663),f=e(71577),j=e(63185),a=e(9676),I=e(43358),o=e(34041),R=e(88983),Z=e(47933),v=e(12924),C=e.n(v),U=e(28216),z=e(91768),$=e(49101),B=e(84391),x=e(1164),i=e(48479),ie=e(2971),d=e(45601),N=e(7249),P=e(64549),W=e(31945),y=se=>{var K=se.user,p=se.currentRoute,_=se.advancedSetting;return{currentPath:p.path,allAuthRoutes:p.allAuthRoutes,userLng:K.lng,themeColor:_.themeColor}};class re extends C().Component{constructor(K){super(K);this.setPlaceholder=()=>{var p=this.props,_=p.currentPath,E=p.allAuthRoutes,g=p.userLng,b=this.state.language,S=E[_];if(!!S){var D=b[g].searchInputPlaceholder,L="";S.menuKey==="studyTemplate"||S.menuKey==="examTemplate"?L=D.template:S.menuKey==="management"||S.menuKey==="employee"||S.menuKey==="obligatory"||S.menuKey==="elective"||S.menuKey==="plan"||S.menuKey==="evaluation"||S.menuKey==="myEvaluationPlan"?L=D.task:L=D[S.menuKey],this.setState({currentPlaceholder:L})}},this.handleRadiosChange=p=>{this.props.onRadiosChange(p.target.value)},this.handleSelectChange=p=>{this.props.onSelectChange(p)},this.handleSearch=p=>{this.props.onSearch(p)},this.handleChange=p=>{this.props.onCheckboxChange(p.target.checked)},this.handleDownload=()=>{this.props.onDownload()},this.renderRadios=()=>{var p=this.props,_=p.prefixCls,E=p.radioList,g=p.defaultRadioValue,b=p.radioValue;if(!E.length)return null;var S=g||E[0].value,D="".concat(_,"__radios");return C().createElement("div",{className:D},typeof b!="undefined"?C().createElement(Z.ZP.Group,{defaultValue:S,value:b,onChange:this.handleRadiosChange},E.map(L=>C().createElement(Z.ZP.Button,{key:L.value,value:L.value},L.name))):C().createElement(Z.ZP.Group,{defaultValue:S,onChange:this.handleRadiosChange},E.map(L=>C().createElement(Z.ZP.Button,{key:L.value,value:L.value},L.name))))},this.renderSelect=()=>{var p=this.props,_=p.prefixCls,E=p.selectList,g=p.defaultSelectValue;if(!E.length)return null;var b=g||E[0].value,S="".concat(_,"__select");return C().createElement("div",{className:S},C().createElement(o.Z,{defaultValue:b,onChange:this.handleSelectChange,getPopupContainer:()=>document.getElementsByClassName("cl-listQueryRow__select")[0],style:{minWidth:100}},E.map(D=>C().createElement(o.Z.Option,{key:D.value,value:D.value},D.name))))},this.renderOther=()=>{var p=this.props,_=p.prefixCls,E=p.renderOther,g=p.showOther,b="".concat(_,"__other");if(g&&E&&typeof E=="function")return C().createElement("div",{className:b},E())},this.renderCheckbox=()=>{var p=this.props,_=p.prefixCls,E=p.t,g=p.label,b=p.showCheckbox,S=p.renderActionSelect,D="".concat(_,"__checkbox");return!b&&S&&typeof S=="function"?C().createElement("div",{className:D},S()):b?C().createElement("div",{className:D},C().createElement(a.Z,{onChange:this.handleChange},g||E("common.myCreated"))):null},this.renderSearch=()=>{var p=this.props,_=p.prefixCls,E=p.showSearch,g=p.inputPlaceholder,b=p.maxLength,S=b===void 0?400:b,D="".concat(_,"__search");if(!E)return null;var L=this.state.currentPlaceholder;return g?C().createElement("div",{className:D},C().createElement(i.Z,{onSearch:this.handleSearch,placeholder:g,width:272,maxLength:S})):C().createElement("div",{className:D},C().createElement(i.Z,{onSearch:this.handleSearch,placeholder:L,width:272,maxLength:S}))},this.renderActionBtn=()=>{var p=this.props,_=p.prefixCls,E=p.actionText,g=p.t,b=p.tabLink,S=p.showBtn,D=p.renderActionBtn,L=p.popOverProps,G=L===void 0?[]:L,ae=p.renderGuide,de=ae===void 0?!1:ae,le=p.showDownloadBtn,ce=le===void 0?!1:le,fe=p.guideClassName,be=fe===void 0?"guide-popover":fe,xe=p.themeColor,m="".concat(_,"__action");return!S&&D&&typeof D=="function"?C().createElement("div",{className:m},D()):!S||!E?null:C().createElement("div",{className:m},C().createElement(x.Z,{to:b},C().createElement(f.Z,{type:"primary",icon:C().createElement($.Z,null)},E)),C().createElement(P.Z,{className:be,renderGuide:de,guidePageProps:G,direction:"left",showDownloadBtn:ce}),ce&&C().createElement(f.Z,{style:{marginLeft:"8px",color:xe,border:"1px solid ".concat(xe)},icon:C().createElement(B.Z,null),onClick:this.handleDownload},g("common.exportData")))},this.renderQueryRow=()=>{var p=this.props,_=p.queryRowParams,E=p.queryRowList,g=p.queryRowSelectedCourseIds,b=p.queryRowSelectedProjectIds,S=p.queryRowOnForceRender,D=p.queryRowOnClassifyChange,L=p.queryRowOnTypeChange,G=p.queryRowOnCourseTypeChange,ae=p.queryRowAllowActions;return C().createElement(W.Z,{params:_,list:E,selectedCourseIds:g,selectedProjectIds:b,onForceRender:S,onClassifyChange:D,onTypeChange:L,onCourseTypeChange:G,allowActions:ae,showRenderCondition:!1})},this.rendeExtraBtn=()=>{var p=this.props,_=p.t,E=p.extraBtnSelectedRowKeys,g=p.extraBtnHandleMultiVisibleRange;return C().createElement(f.Z,{disabled:E.length===0,onClick:g},_("courseManage.setTheVisibility"))},this.state={language:{zh_cn:d.Z,en_us:ie.Z,zh_hk:N.Z},currentPlaceholder:""}}componentDidMount(){this.setPlaceholder()}componentDidUpdate(K){K.userLng!==this.props.userLng&&this.setPlaceholder()}render(){var K=this.props,p=K.prefixCls,_=K.wrapCls,E=K.showRenderRadios,g=E===void 0?!0:E,b=K.showRenderQueryRow,S=K.showRendeExtraBtn,D=K.showRenderSelect;return C().createElement(C().Fragment,null,C().createElement("div",{className:"render_other"},this.renderOther(),C().createElement("header",{className:"".concat(p," ").concat(_)},C().createElement("section",{className:"".concat(p,"__radiocol")},this.renderActionBtn(),b&&this.renderQueryRow(),S&&this.rendeExtraBtn()),C().createElement("section",{className:"".concat(p,"__searchcol")},this.renderCheckbox(),g&&this.renderRadios(),D&&this.renderSelect(),this.renderSearch()))))}}re.defaultProps={prefixCls:"cl-listQueryRow",wrapCls:"",label:"",actionText:"add",showRadioList:!0,showCheckbox:!0,showSearch:!0,showBtn:!0,inputPlaceholder:"",defaultRadioValue:"",radioList:[],searchStylesProps:{},showRenderSelect:!1,selectList:[],renderActionBtn:()=>null,onRadiosChange:()=>{},onSearch:()=>{},onCheckboxChange:()=>{}},H.Z=(0,U.$j)(y)((0,z.Z)()(re))},83431:function(Ee,H,e){"use strict";var oe=e(30887),f=e(99210),j=e(22385),a=e(31097),I=e(12924),o=e.n(I),R=e(91768),Z=e(57119),v=e(28216),C=z=>{var $=z.user;return{loginMode:$.loginMode}};function U(z){var $=z.onUrge,B=z.onDing,x=z.t,i=localStorage,ie=i.appType,d=x(ie==="wx_app"?"component.ordinaryUrgingWxTips":ie==="fs_app"?"component.ordinaryUrgingFsTips":"component.ordinaryUrgingTips");return o().createElement(f.Z,null,o().createElement(f.Z.Item,{key:"1"},o().createElement(a.Z,{title:d},o().createElement("div",{className:"urge-menu-item",onClick:$},o().createElement("span",{className:"urge-menu-item__text"},x("component.ordinaryUrging")),o().createElement(Z.Z,null)))),ie==="e_app"?o().createElement(f.Z.Item,{key:"2"},o().createElement(a.Z,{title:x("component.dingStudentsTips")},dd.version?o().createElement("div",{className:"urge-menu-item",onClick:B},o().createElement("span",{className:"urge-menu-item__text"},x("component.dingStudents")),o().createElement(Z.Z,null)):o().createElement("div",{className:"urge-menu-item__forbidden"},o().createElement("span",{className:"urge-menu-item__text"},x("component.dingStudents")),o().createElement(Z.Z,null)))):null)}H.Z=(0,v.$j)(C)((0,R.Z)()(U))},50997:function(Ee,H,e){"use strict";e.d(H,{Z:function(){return at}});var oe=e(81211),f=e(57663),j=e(71577),a=e(88986),I=e(12924),o=e.n(I),R=e(91768),Z=e(18329),v=e(51975),C="WORKFLOW_STATUS_CHOOSE",U="WORKFLOW_STATUS_ORIGINAL",z="WORKFLOW_STATUS_CUSTOM",$="WORKFLOW_STATUS_CUSTOM_CONFIRM",B="ACTION_TYPE_ORIGINAL",x="ACTION_TYPE _CUSTOM",i="CUSTOM_QUERY_FLUNK",ie="CUSTOM_QUERY_MISS",d={footer:null,workflowStatus:C,actionType:B,refOriginal:null,refCustom:null,customSelectedRows:[],customDateRange:{startTime:"",endTime:""},changeworkflowStatus:()=>{},changeActionType:()=>{},initRefOriginal:()=>{},initRefCustom:()=>{},changeSelectedRows:()=>{},changeCustomDateRange:()=>{}},N=o().createContext(d),P=e(80991),W=e(62029),y=e(88983),re=e(47933),se=e(43859);class K extends o().Component{constructor(){super(...arguments);this.handleChange=n=>{var l=n.target.value;this.context.changeActionType(l),this.props.formik.setFieldValue("actionType",l)}}render(){var n=this.props,l=n.defaultFieldList,u=n.t;return o().createElement(re.ZP.Group,{value:l,onChange:this.handleChange},o().createElement(re.ZP,{value:B},u("exam.supplementActionOriginal")),o().createElement(re.ZP,{value:x},u("exam.supplementActionCustom")))}}K.contextType=N;var p=(0,v.l)(N,K),_=(0,R.Z)()((0,se.Z)((0,P.$j)(p))),E={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}};class g extends o().Component{render(){var n=this.props,l=n.values,u=n.t;return o().createElement(P.l0,{className:"cl-form"},o().createElement(P.gN,(0,W.Z)({component:_,displayType:"Custom",name:"actionType",label:u("exam.makeupUsers"),required:!0,defaultFieldList:l.actionType},E)))}}var b=(0,R.Z)()(g);class S extends o().Component{constructor(n){super(n);this.state={initialParams:{actionType:n.contextData.actionType}}}render(){var n=this.props.prefixCls,l=this.context.initChooseFormik,u=this.state.initialParams;return o().createElement("div",{className:n},o().createElement(P.J9,{ref:l,initialValues:u,render:A=>o().createElement(b,A)}))}}S.contextType=N,S.defaultProps={prefixCls:"cl-supplement-workflow__choose"};var D=(0,R.Z)()(S),L=e(62615),G=e(52670),ae=e(63185),de=e(9676);class le extends o().Component{constructor(){super(...arguments);this.handleChange=n=>{this.props.formik.setFieldValue("person",n)}}render(){var n=this.props.t,l=[{label:n("exam.unqualified"),value:1},{label:n("exam.missTest"),value:2}];return o().createElement(de.Z.Group,{options:l,defaultValue:this.props.defaultFieldList,onChange:this.handleChange})}}var ce=(0,R.Z)()((0,se.Z)((0,P.$j)(le))),fe=e(3407),be=e(6793),xe=(0,be.me)(),m=fe.Z[xe].exam.validation,M=ue=>{var n;return ue.length||(n=m.checkSupplementPerson),n},w={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}};class X extends o().Component{render(){var n=this.props,l=n.values,u=n.t;return o().createElement(P.l0,{className:"cl-form"},o().createElement(P.gN,(0,W.Z)({component:ce,displayType:"Custom",name:"person",label:u("exam.makeupUsers"),required:!0,defaultFieldList:l.person,validate:M},w)),o().createElement(P.gN,(0,W.Z)({component:L.C0,displayType:"Custom",name:"dateRange",label:u("exam.makeupTime"),required:!0,defaultFieldList:l.dateRange,validate:G.V5},w)))}}var q=(0,R.Z)()(X),k={person:[1],dateRange:{startTime:"",endTime:""}};class Q extends o().Component{constructor(){super(...arguments);this.initRefFormik=n=>{this.context.initRefOriginal(n)}}render(){var n=this.props.cellType,l=n===void 0?"unqualifiedNum":n,u=(0,a.Z)((0,a.Z)({},k),{},{person:l==="unqualifiedNum"?[1]:[2]});return o().createElement(P.J9,{ref:this.initRefFormik,initialValues:u,render:A=>o().createElement(q,A)})}}Q.contextType=N;var ee=(0,R.Z)()(Q),pe=e(10237),he=e(37055),ve=e(27550),Te=e(66456),Pe=e(55313),Me=e(22385),Le=e(31097),_e=e(95664),De=e(60667),Re=e(80430);class Ue extends o().Component{constructor(){super(...arguments);this.columns=[{title:this.props.t("exam.thNumber"),dataIndex:"userId",width:30,render:(n,l,u)=>u+1},{title:this.props.t("exam.thUserName"),dataIndex:"name",className:"".concat(this.props.prefixCls,"__namecell"),style:{whiteSpace:"normal"},render:(n,l)=>o().createElement(De.Z,{dataType:"userName",value:l.user_info.userId||l.user_info.user_id,name:n,type:l.user_info.sourceType||l.user_info.source_type})},{title:this.props.t("exam.thSubordinate"),dataIndex:"departmentName",width:this.props.showScoreColumns?300:500,render:(n,l)=>{var u=this.props.showScoreColumns,A=u?"314px":"480px";return o().createElement(Le.Z,{title:o().createElement(Re.Z,{list:l.user_info.department_info,displayAll:!0})},o().createElement("div",{className:"cl-text-ellipsis",style:{width:A}},o().createElement(Re.Z,{list:l.user_info.department_info,displayAll:!0})))}}],this.columnsWithScore=[{title:this.props.t("exam.thExamTimes"),width:60,dataIndex:"makeUpCount"},{title:this.props.t("exam.thExamScore"),dataIndex:"score"}],this.handleTableChange=n=>{this.props.onTableChange(n)},this.handleSelectChange=(n,l)=>{var u=this.context,A=u.customSelectedRows,Y=u.changeSelectedRows,V=[...A];l?V.push(n):V.splice(V.findIndex(ne=>ne.userId===n.userId),1),Y(V)},this.handleSelectAllChange=(n,l)=>{var u=this.context,A=u.customSelectedRows,Y=u.changeSelectedRows,V=[...A],ne=[];if(n)ne=[...(0,be.Cj)(V.concat(l),"userId")];else{var Ie=l.map(Se=>Se.userId);V.forEach(Se=>{Ie.includes(Se.userId)&&ne.push(Se)})}Y(ne)}}render(){var n=this.props,l=n.prefixCls,u=n.list,A=u===void 0?[]:u,Y=n.loading,V=n.paginationParams,ne=V===void 0?{}:V,Ie=n.showScoreColumns,Se=this.context.customSelectedRows,Qe={selectedRowKeys:Se.map(st=>st.userId),onSelect:this.handleSelectChange,onSelectAll:this.handleSelectAllChange};return o().createElement("section",{className:l},o().createElement(Pe.Z,{bordered:!0,size:"middle",columns:Ie?this.columns.concat(this.columnsWithScore):this.columns,rowKey:"userId",rowSelection:Qe,dataSource:A,pagination:!1,loading:Y}),o().createElement(_e.Z,{showRenderRefresh:!1,totalNum:ne.total,totalPage:ne.totalPage,current:ne.current,defaultPageSize:ne.pageSize,onChange:this.handleTableChange}))}}Ue.defaultProps={prefixCls:"cl-supplement-workflow__customtable__content__table"},Ue.contextType=N;var Ye=(0,v.l)(N,Ue),Ae=(0,R.Z)()(Ye),rt={getTableList:he.ZP.ExaminationPlanList.getPlanExamInfoByPlanId};class Oe extends o().Component{constructor(n){super(n);this.initTableList=()=>{this.setState({tableLoading:!0}),pe.WY.get({url:rt.getTableList(),params:this.state.params}).then(l=>{var u=l.data.data.pageInfo;setTimeout(()=>{this.setState({tableLoading:!1,tableList:u.list,tableTotal:u.total,tablePageTotal:u.pages})},300)})},this.handleQueryRowRadiosChange=l=>{this.resetPagination().then(()=>{this.setState(u=>({params:(0,a.Z)((0,a.Z)({},u.params),{},{type:l})}),()=>{this.initTableList()})})},this.handleQueryRowSearch=l=>{this.resetPagination().then(()=>{this.setState(u=>({params:(0,a.Z)((0,a.Z)({},u.params),{},{keyword:l})}),()=>{this.initTableList()})})},this.handleChangePagination=l=>{this.setState(u=>({params:(0,a.Z)((0,a.Z)({},u.params),{},{pageNumber:l})}),()=>{this.initTableList()})},this.resetPagination=()=>new Promise(l=>{this.setState(u=>({params:(0,a.Z)((0,a.Z)({},u.params),{},{pageNumber:1,pageSize:5})}),()=>{l()})}),this.state={params:{planId:this.props.actionId,keyword:"",type:1,pageNumber:1,pageSize:5},radioList:[{name:this.props.t("exam.failed"),value:1},{name:this.props.t("exam.absent"),value:2}],tableLoading:!0,tableList:[],tableTotal:0,tablePageTotal:0}}componentDidMount(){this.initTableList()}render(){var n=this.props.prefixCls,l=this.state,u=l.radioList,A=l.tableTotal,Y=l.tablePageTotal,V=l.tableList,ne=l.tableLoading,Ie=l.params,Se={total:A,totalPage:Y,current:Ie.pageNumber,pageSize:Ie.pageSize};return o().createElement("div",{className:n},o().createElement(ve.Z,{showCheckbox:!1,showBtn:!1,radioList:u,defaultRadioValue:0,searchStylesProps:{width:238},onRadiosChange:this.handleQueryRowRadiosChange,onSearch:this.handleQueryRowSearch}),o().createElement("div",{className:"".concat(n,"__content")},o().createElement(Ae,{showScoreColumns:Ie.type===1,loading:ne,paginationParams:Se,list:V,onTableChange:this.handleChangePagination})))}}Oe.contextType=N,Oe.defaultProps={prefixCls:"cl-supplement-workflow__customtable"};var He=(0,R.Z)()(Oe),Je=e(84874);class ke extends o().Component{constructor(){var n;super(...arguments);n=this,this.handleChange=l=>{this.props.formik.setFieldValue("person",l)},this.renderFlunkPerson=()=>{var l=this.props.defaultFieldList.filter(u=>u.type===1);return this.renderPersonWrapper(l)},this.renderMissPerson=()=>{var l=this.props.defaultFieldList.filter(u=>u.type===2);return this.renderPersonWrapper(l,"miss")},this.renderPersonWrapper=function(l){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"flunk";if(!l.length)return null;var A=n.props,Y=A.prefixCls,V=A.t,ne="".concat(Y,"__person");return o().createElement("section",{className:ne},o().createElement("header",{className:"".concat(ne,"__header")},V(u==="flunk"?"exam.unqualified":"exam.missTest")),n.renderPersonList(l))},this.renderPersonList=l=>{var u=this.props.prefixCls,A="".concat(u,"__gallery cl-clearfix");return o().createElement("div",{className:A},l.map(Y=>this.renderGalleryItem(Y)))},this.handleDeleteItem=l=>{var u=this.props,A=u.formik,Y=u.defaultFieldList,V=[...Y],ne=V.findIndex(Ie=>Ie.userId===l);V.splice(ne,1),this.context.changeSelectedRows(V),A.setFieldValue("person",V)},this.renderGalleryItem=l=>{var u=this.props.prefixCls,A="".concat(u,"__gallery__item"),Y=l.user_info;return o().createElement("span",{className:A,key:l.userId},o().createElement(De.Z,{dataType:"userName",value:Y.userId,name:Y.name,type:Y.sourceType}),o().createElement("span",{onClick:()=>this.handleDeleteItem(l.userId)},o().createElement(Je.Z,{iconClass:"icon-guanbi",size:"12px"})))}}render(){var n=this.props.prefixCls;return o().createElement("div",{className:n},this.renderFlunkPerson(),this.renderMissPerson())}}ke.contextType=N,ke.defaultProps={prefixCls:"cl-supplement-workflow__customform"};var $e=(0,v.l)(N,ke),Be=(0,R.Z)()((0,se.Z)((0,P.$j)($e))),We=(0,be.me)(),we=fe.Z[We].exam.validation,Xe=ue=>{var n;return ue.length||(n=we.checkSupplementPerson),n};class qe extends o().Component{render(){var n=this.props,l=n.values,u=n.onAfterChangeDate,A=n.t;return o().createElement(P.l0,{className:"cl-form"},o().createElement(P.gN,{component:Be,displayType:"Custom",name:"person",label:A("exam.makeupUsers"),required:!0,defaultFieldList:l.person,validate:Xe}),o().createElement(P.gN,{component:L.C0,displayType:"Custom",name:"dateRange",label:A("exam.makeupTime"),required:!0,defaultFieldList:l.dateRange,validate:G.V5,onAfterChange:u}))}}var Fe=(0,R.Z)()(qe),et={person:[],dateRange:{startTime:"",endTime:""}};class Ke extends o().Component{constructor(){super(...arguments);this.initRefFormik=n=>{this.context.initRefCustom(n)},this.handleChangeDateRange=n=>{var l=n.startTime,u=n.endTime;this.context.changeCustomDateRange({startTime:l,endTime:u})}}render(){var n=this.context,l=n.customSelectedRows,u=n.customDateRange,A=(0,a.Z)((0,a.Z)({},et),{},{person:l,dateRange:u});return o().createElement(P.J9,{ref:this.initRefFormik,initialValues:A,render:Y=>o().createElement(Fe,(0,W.Z)({},Y,{onAfterChangeDate:this.handleChangeDateRange}))})}}Ke.contextType=N;var je=(0,R.Z)()(Ke);class Ge extends o().Component{constructor(){super(...arguments);this.state={contextData:(0,a.Z)({},d)},this.initRefOriginal=n=>{this.setState(l=>({contextData:(0,a.Z)((0,a.Z)({},l.contextData),{},{refOriginal:n})}))},this.initRefCustom=n=>{this.setState(l=>({contextData:(0,a.Z)((0,a.Z)({},l.contextData),{},{refCustom:n})}))},this.handleChangeworkflowStatus=n=>{this.setState(l=>({contextData:(0,a.Z)((0,a.Z)({},l.contextData),{},{workflowStatus:n})}))},this.handleChangeActionType=n=>{this.setState(l=>({contextData:(0,a.Z)((0,a.Z)({},l.contextData),{},{actionType:n})}))},this.handleChangeSelectedRows=n=>{this.setState(l=>({contextData:(0,a.Z)((0,a.Z)({},l.contextData),{},{customSelectedRows:n})}))},this.handleChangeCustomDateRange=n=>{this.setState(l=>({contextData:(0,a.Z)((0,a.Z)({},l.contextData),{},{customDateRange:n})}))},this.handleOk=()=>{var n=this.state.contextData,l=n.workflowStatus,u=n.actionType;l===C?this.handleChangeworkflowStatus(u===B?U:z):l===U?this.handleValidateOriginal():this.handleValidateCustom()},this.handleValidateOriginal=()=>{var n=this.state.contextData.refOriginal;n.submitForm(),n.runValidations().then(l=>{if(!Object.keys(l).length){var u=n.state.values,A=u.dateRange,Y=u.person,V={id:this.props.actionId,dateRange:A,type:Y.length===2?3:Y[0],makeupUserIds:""};this.props.onCreate(V)}})},this.handleValidateCustom=()=>{var n=this.state.contextData.refCustom;n.submitForm(),n.runValidations().then(l=>{if(!Object.keys(l).length){var u=n.state.values,A=u.dateRange,Y=u.person,V={id:this.props.actionId,dateRange:A,type:4,makeupUserIds:Y.map(ne=>ne.userId).join(",")};this.props.onCreate(V)}})},this.renderFooter=()=>{var n=this.state.contextData,l=n.workflowStatus,u=null;switch(l){case C:case U:case $:u=this.renderCombinatorialFooter();break;case z:u=this.renderDismissedFooter();break;default:break}return u},this.handleCancel=()=>{var n=this.state.contextData.workflowStatus;n===C?this.props.onCancel():n===U||n===z?(this.handleChangeworkflowStatus(C),this.handleChangeSelectedRows([])):n===$&&this.handleChangeworkflowStatus(z)},this.renderCombinatorialFooter=()=>{var n=this.props.t,l=this.state.contextData,u=l.workflowStatus,A=l.customSelectedRows,Y=u===$?"(".concat(A.length,")\u4EBA"):null;return o().createElement(o().Fragment,null,o().createElement(j.Z,{key:"dismiss",onClick:this.handleCancel},n("common.cancel")),o().createElement(j.Z,{key:"confirm",type:"primary",onClick:this.handleOk},n(u===C?"common.nextStep":"common.ok"),Y))},this.renderDismissedFooter=()=>{var n=this.props.t;return o().createElement(o().Fragment,null,o().createElement(j.Z,{key:"dismiss",onClick:this.handleCancel},n("common.cancel")),o().createElement(j.Z,{key:"confirm",type:"primary",onClick:()=>this.handleChangeworkflowStatus($)},n("common.nextStep")))},this.renderTitle=()=>{var n=this.props.t,l=this.state.contextData.workflowStatus,u="";return l===z?u=n("exam.supplementCustomizer"):u=n("exam.supplement"),o().createElement(o().Fragment,null,u)}}componentDidUpdate(n){n.visible!==this.props.visible&&this.props.visible&&this.setState({contextData:(0,a.Z)((0,a.Z)({},d),{},{changeworkflowStatus:this.handleChangeworkflowStatus,changeActionType:this.handleChangeActionType,initRefOriginal:this.initRefOriginal,initRefCustom:this.initRefCustom,changeSelectedRows:this.handleChangeSelectedRows,changeCustomDateRange:this.handleChangeCustomDateRange})})}render(){var n=this.props,l=n.visible,u=n.isLoading,A=(0,oe.Z)(n,["visible","isLoading"]),Y=this.state.contextData,V=Y.workflowStatus;return u?null:o().createElement(Z.ZP,{visible:l,title:this.renderTitle(),footer:this.renderFooter(),onCancel:this.handleCancel},o().createElement(N.Provider,{value:Y},V===C&&o().createElement(Ve,null),V===U&&o().createElement(ze,A),V===z&&o().createElement(Ne,A),V===$&&o().createElement(tt,A)))}}var Ve=(0,v.l)(N,D),ze=(0,v.l)(N,ee),Ne=(0,v.l)(N,He),tt=(0,v.l)(N,je),at=(0,R.Z)()(Ge)},1465:function(Ee,H,e){"use strict";e.r(H),e.d(H,{default:function(){return ot}});var oe=e(18106),f=e(88108),j=e(12924),a=e.n(j),I=e(91768),o=e(57068),R=e(76651),Z=e(4408),v=e(62029),C=e(22385),U=e(31097),z=e(59250),$=e(13013),B=e(57663),x=e(71577),i=e(88986),ie=e(34792),d=e(48086),N=e(71194),P=e(57016),W=e(45697),y=e.n(W),re=e(57254),se=e(50997);class K extends a().Component{constructor(){super(...arguments);this.renderSubTitles=()=>{var s=this.props,t=s.prefixCls,r=s.subTitles,c="".concat(t,"__main__subs");return r.length?a().createElement("div",{className:c},r.filter(h=>h).map((h,T)=>this.renderSubItem(h,T))):null},this.renderSubItem=(s,t)=>{var r=this.props.prefixCls,c="".concat(r,"__main__subs__item");return a().createElement("span",{className:c,key:t},s)}}render(){var s=this.props,t=s.prefixCls,r=s.title,c=s.authScope,h=c===void 0?{}:c,T=s.t,O=s.summary,F=h.visible,te=F===void 0?!1:F;return a().createElement("div",{className:"".concat(t)},a().createElement("section",null,a().createElement("div",{className:"".concat(t,"__main")},a().createElement("h1",{className:"".concat(t,"__main__title")},r,te&&a().createElement("span",{className:"".concat(t,"__main__title__auth")},T("common.authScopeTip"))),this.renderSubTitles()),a().createElement("div",{className:"".concat(t,"__children")},this.props.children)),O?a().createElement("div",{className:"".concat(t,"__summary")},T("learning.taskSummary"),"\uFF1A",O):null)}}K.defaultProps={prefixCls:"cl-monitor-title",title:"",subTitles:[],authScope:{visible:!1},summary:""},K.propsTypes={prefixCls:y().string,title:y().string.isRequired,subTitles:y().array.isRequired,authScope:y().object,summary:y().string};var p=(0,I.Z)()(K),_=e(10237),E=e(37055),g=e(54531),b=e(6793),S=e(83431),D=e(60667),L={getExamResult:E.ZP.ExaminationPlanMonitor.getExamResult,urgeExam:E.ZP.ExaminationPlanList.urgeExam,supplementExam:E.ZP.ExaminationPlanList.supplementExam};class G extends a().Component{constructor(){super(...arguments);this.state={planExam:{},status:"",title:"",subTitles:[],supplementProps:{visible:!1,actionId:""},dingUserIds:[]},this.appId=sessionStorage.getItem("CL_E_APP_ID"),this.miniAppId=sessionStorage.getItem("CL_MINI_APP_ID"),this.onHandleUrge=()=>{var s=this.props,t=s.actionId,r=s.t;P.Z.confirm({title:r("exam.urge"),content:r("exam.urgeTip"),onOk(){_.qg.get({url:L.urgeExam(),params:{planId:t,noticeType:3}}).then(c=>{var h=c.data,T=h.code,O=h.msg;T!==1&&d.default["".concat(T===0?"success":"warning")](O)})}})},this.onHandleDing=()=>{var s=this.state,t=s.dingUserIds,r=s.title,c=encodeURIComponent("/pages/messageRedirect/messageRedirect?flag=exam&planId=".concat(this.props.actionId)),h="dingtalk://dingtalkclient/action/open_micro_app?&appId=".concat(this.appId,"&miniAppId=").concat(this.miniAppId,"&page=").concat(c,"&corpId=$CORPID$"),T={users:t,attachmentTitle:r,text:(0,b.ZT)(this.props.t("exam.dingTips"),r),mobileUrl:h};(0,g.nb)(T)},this.getInfo=()=>{_.WY.get({url:L.getExamResult(),params:{planId:this.props.actionId,tabId:0,status:"",departmentId:"",keyword:"",pageNumber:1,pageSize:20}}).then(s=>{var t=this.props.t,r=s.data.data,c=r.status,h=r.planExam,T=h===void 0?{}:h,O=r.dingUserIds,F=O===void 0?[]:O,te=J=>a().createElement("span",null,t("common.creator"),"\uFF1A",a().createElement(D.Z,{dataType:"userName",value:J.creator_sync_user_id,name:J.creatorName,type:J.creator_source_type}));this.setState({planExam:T,status:c,dingUserIds:F,title:T.title,subTitles:[te(T),"".concat(t("common.passingLine"),"\uFF1A ").concat(T.passLine,"%")]})})},this.handleSupplement=()=>{this.setState(s=>({supplementProps:(0,i.Z)((0,i.Z)({},s.supplementProps),{},{visible:!0,actionId:this.props.actionId})}))},this.handleSupplementOk=s=>{var t=s.id,r=s.type,c=s.dateRange,h=s.makeupUserIds;_.qg.post({url:L.supplementExam(),data:{examPlanId:t,startTime:c.startTime,endTime:c.endTime,type:r,makeupUserIds:h}}).then(T=>{var O=T.data,F=O.code,te=O.msg;if(d.default[F===0?"success":"warning"](te),F===0){var J=this.props.onOk;this.handleSupplementCancel(),J&&J()}})},this.handleSupplementCancel=()=>{this.setState(s=>({supplementProps:(0,i.Z)((0,i.Z)({},s.supplementProps),{},{visible:!1,actionId:""})}))},this.urgeButton=()=>{var s=this.props.t,t=this.state.planExam,r=t.publishStatus==="unpublished";return r?a().createElement(U.Z,{title:s("study.cantPushMsg")},a().createElement(x.Z,{type:"primary",disabled:!0},s("exam.urge")," ",a().createElement(re.Z,null))):a().createElement($.Z,{overlay:a().createElement(S.Z,{onUrge:this.onHandleUrge,onDing:this.onHandleDing})},a().createElement(x.Z,null,s("exam.urge")," ",a().createElement(re.Z,null)))},this.renderBtns=()=>{var s=this.state,t=s.status,r=s.planExam,c=this.props.t,h=r.publishStatus==="unpublished",T=o.parse(R.m8.location.search),O=T.taskType;return a().createElement(a().Fragment,null,t==="end"&&a().createElement(U.Z,{title:c(h?"study.cantPushMsg":"exam.supplementTip"),placement:"topRight"},a().createElement(x.Z,{disabled:h,onClick:this.handleSupplement},c("exam.supplement"))),t==="on_going"&&O!=="employee"&&O!=="project"&&this.urgeButton())}}componentDidMount(){this.getInfo(),(0,g.TN)()}render(){var s=this.state,t=s.title,r=s.subTitles,c=s.supplementProps,h=this.props.authScope;return a().createElement("div",null,a().createElement(p,{title:t,subTitles:r,authScope:h},this.renderBtns()),a().createElement(se.Z,(0,v.Z)({},c,{isLoading:!c.visible,onCancel:this.handleSupplementCancel,onCreate:this.handleSupplementOk})))}}G.defaultProps={authScope:{visible:!1}},G.propsTypes={authScope:y().object};var ae=(0,I.Z)()(G),de=e(30887),le=e(99210),ce=e(28216),fe=e(84391),be=e(47745),xe=e(55285),m=e(30311),M={WAIT:5};class w extends a().Component{constructor(){super(...arguments);this.state={getExamAllGradesProps:{visible:!1,planId:"",userId:"",planTitle:""}},this.columns=[{title:this.props.t("exam.examResult"),width:120,dataIndex:"statusName",key:"statusName",onCell:()=>({style:{minWidth:80}})},{title:this.props.t("exam.examItems"),width:120,dataIndex:"makeupCount",key:"makeupCount",render:(s,t)=>t.makeupCount>1?a().createElement(m.Z,{name:t.makeupCount,onClick:()=>this.showEveryExamGrade(t.planId,t.userId)}):t.makeupCount,onCell:()=>({style:{minWidth:80}})},{title:this.props.t("examing.examTotalScore"),width:100,key:"examTotalScore",render:(s,t)=>t.questionMode===2&&!t.totalScore?"--":"".concat(t.totalScore),onCell:()=>({style:{minWidth:80}})},{title:this.props.t("exam.examScore"),width:100,key:"examScore",render:(s,t)=>t.status!==M.WAIT?"".concat(t.score):"--",onCell:()=>({style:{minWidth:80}})},{title:this.props.t("exam.marker"),width:100,dataIndex:"markerName",key:"markerName",render:(s,t)=>a().createElement(D.Z,{dataType:"userName",value:t.marker_sync_user_id,name:s,type:t.marker_source_type})},{title:this.props.t("exam.examTime"),dataIndex:"examDuration",key:"examDuration",width:100,onCell:()=>({style:{minWidth:80}})},{title:this.props.t("common.operate"),width:100,key:"operate",fixed:"right",render:s=>this.renderActions({record:s})}],this.showEveryExamGrade=(s,t)=>{var r=this.props.planTitle;this.setState(c=>({getExamAllGradesProps:(0,i.Z)((0,i.Z)({},c.getExamAllGradesProps),{},{visible:!0,planId:s,userId:t,planTitle:r})}))},this.hideEveryExamGrade=()=>{this.setState(s=>({getExamAllGradesProps:(0,i.Z)((0,i.Z)({},s.getExamAllGradesProps),{},{visible:!1,planId:"",userId:"",planTitle:""})}))},this.handleTableChange=s=>{this.props.onTableChange(s)},this.handleGotoExam=s=>{var t=s.record;R.m8.push({pathname:"/training/examination/result",search:o.stringify({pageFrom:"examMonitor",userId:t.userId,id:t.planId,repeatMarking:!0})})},this.renderActions=s=>{var t=s.record,r=t.makeupCount,c=t.status;return r&&c!==M.WAIT?a().createElement("div",{className:"cl-table__cell-action"},a().createElement("span",{className:"cl-pointer",onClick:()=>this.handleGotoExam({record:t})},this.props.t("common.viewDetails"))):a().createElement("div",{className:"cl-table__cell-action"},a().createElement("span",{className:"cl-pointer cl-disabled"}," ",this.props.t("common.viewDetails")))}}render(){var s=this.props,t=s.prefixCls,r=s.list,c=r===void 0?[]:r,h=s.loading,T=s.paginationParams,O=T===void 0?{}:T,F=s.toolBarRender,te=s.headerTitle,J=(0,i.Z)((0,i.Z)({},E.XE.INITIAL_PAGINATION),O),me=this.state.getExamAllGradesProps;return a().createElement("section",{className:t},a().createElement(xe.Z,{withLoginPhoneNumber:!0,columns:this.columns,rowKey:"id",dataSource:c,pagination:J,loading:h,onChange:this.handleTableChange,toolBarRender:F,headerTitle:te,tableUUID:"33cbc5d8-ba9b-4933-832c-dd5568bfcb3b"}),a().createElement(be.Z,(0,v.Z)({},me,{hideEveryExamGrade:this.hideEveryExamGrade})))}}w.defaultProps={prefixCls:"plan-monitor__persontab__table"};var X=(0,I.Z)()(w),q=e(64262),k=e(64630),Q=e(48479),ee=e(27550),pe=e(97593),he={getExamResult:E.ZP.ExaminationPlanMonitor.getExamResult,exportExamResult:E.ZP.ExaminationPlanMonitor.exportExamResult,exportAnswerList:E.ZP.ExaminationPlanMonitor.exportAnswerList,exportAnswerDetails:E.ZP.ExaminationPlanMonitor.exportAnswerDetails};class ve extends a().Component{constructor(){super(...arguments);this.state={params:{planId:"",tabId:0,status:"",departmentId:"",postId:"",keyword:"",pageNumber:1,pageSize:20},planTitle:"",radioList:[],tableLoading:!1,tableList:[],tableTotal:0},this.initTableList=()=>{var s=this.props.t;this.setState({tableLoading:!0}),_.WY.get({url:he.getExamResult(),params:(0,i.Z)((0,i.Z)({},this.state.params),{},{planId:this.props.actionId})}).then(t=>{setTimeout(()=>{this.setState({planTitle:t.data.data.planExam.title,tableLoading:!1,tableList:t.data.data.planUser.list,tableTotal:t.data.data.planUser.total,radioList:[{name:"".concat(s("exam.all"),"(").concat(t.data.data.tabId0count,")"),value:0},{name:"".concat(s("exam.qualified"),"(").concat(t.data.data.tabId2count,")"),value:2},{name:"".concat(s("exam.unqualified"),"(").concat(t.data.data.tabId1count,")"),value:1},{name:"".concat(s("exam.notTest"),"(").concat(t.data.data.tabId3count,")"),value:3}]});var r=this.props.changeAuthScope;r&&r(t.data.data.planExam.authorityRange==="true")},300)})},this.handleQueryRowRadiosChange=s=>{this.resetPagination().then(()=>{this.setState(t=>({params:(0,i.Z)((0,i.Z)({},t.params),{},{pageNumber:1,tabId:s})}),()=>{this.initTableList()})})},this.handleQueryRowSearch=s=>{this.resetPagination().then(()=>{this.setState(t=>({params:(0,i.Z)((0,i.Z)({},t.params),{},{pageNumber:1,keyword:s})}),()=>{this.initTableList()})})},this.handleChangePagination=s=>{var t=s.current,r=s.pageSize;this.setState(c=>({params:(0,i.Z)((0,i.Z)({},c.params),{},{pageNumber:t,pageSize:r})}),()=>{this.initTableList()})},this.resetPagination=()=>new Promise(s=>{this.setState(t=>({params:(0,i.Z)((0,i.Z)({},t.params),{},{pageNumber:1,pageSize:20})}),()=>{s()})}),this.handleTreeSelectChange=s=>{this.setState(t=>({params:(0,i.Z)((0,i.Z)({},t.params),{},{pageNumber:1,departmentId:s})}),()=>{this.initTableList()})},this.handlePostSelectChange=s=>{this.setState(t=>({params:(0,i.Z)((0,i.Z)({},t.params),{},{pageNumber:1,postId:s})}),()=>{this.initTableList()})},this.handleSearch=(s,t)=>{this.setState(r=>({params:(0,i.Z)((0,i.Z)({},r.params),{},{pageNumber:1,keyword:t===""?s:"",userIds:t})}),()=>{this.initTableList()})},this.handleMenuClick=s=>{var t=s.key,r=this.state.params,c=r.keyword,h=r.departmentId,T=r.tabId,O=r.postId,F=o.parse(R.m8.location.search),te=F.taskType,J=F.taskId,me=F.projectId,ge="export_type_01",ye=J;switch(te){case"project":ge="export_type_02",ye=me;break;case"task":case"employee":ge="export_type_01";break;case"exam":ge="export_type_03",ye="";break;default:}var Ze="";switch(t){case"exportExamResult":Ze="&planId=".concat(this.props.actionId,"&keyword=").concat(c,"&departmentId=").concat(h,"&tabId=").concat(T,"&postId=").concat(O,"&exportExamType=").concat(ge,"&sourceId=").concat(ye),(0,pe.N)({page:"exportExamResult",props:this.props,query:Ze});break;case"exportAnswerList":Ze="&keyword=".concat(c,"&departmentId=").concat(h,"&tabId=").concat(T,"&postId=").concat(O,"&exportExamType=").concat(ge,"&sourceId=").concat(ye),(0,pe.N)({page:"exportAnswerList",props:this.props,query:Ze,rest:{examId:this.props.actionId}});break;case"exportAnswerDetails":if(T===3){d.default.warning("\u672A\u8003\u5B66\u5458\u8BD5\u9898\u4F5C\u7B54\u660E\u7EC6\u4E0D\u652F\u6301\u5BFC\u51FA\u3002");return}Ze="&keyword=".concat(c,"&departmentId=").concat(h,"&tabId=").concat(T,"&postId=").concat(O,"&exportExamType=").concat(ge,"&sourceId=").concat(ye),(0,pe.N)({page:"exportAnswerDetails",props:this.props,query:Ze,rest:{examId:this.props.actionId}});break;default:break}},this.renderSearchRow=()=>{var s=this.props,t=s.prefixCls,r=s.t,c=a().createElement(le.Z,{onClick:this.handleMenuClick},a().createElement(le.Z.Item,{key:"exportExamResult"},r("exam.userExamResult")),a().createElement(le.Z.Item,{key:"exportAnswerList"},r("exam.userAnswerDetails")),a().createElement(le.Z.Item,{key:"exportAnswerDetails"},r("exam.questionAnswerDetails")));return a().createElement("div",{className:"".concat(t,"__searchrow")},a().createElement($.Z,{overlay:c},a().createElement(x.Z,{type:"primary"},a().createElement(fe.Z,null)," ",r("common.exportData"))))},this.renderRightRow=()=>{var s=this.props,t=s.prefixCls,r=s.t,c=this.state.radioList;return a().createElement("div",{className:"".concat(t,"__header-container__between")},a().createElement(ee.Z,{showCheckbox:!1,showSearch:!1,showBtn:!1,radioList:c,defaultRadioValue:0,onRadiosChange:this.handleQueryRowRadiosChange}),a().createElement(Q.Z,{onSearch:this.handleSearch,width:"272px",placeholder:r("searchInputPlaceholder.userName")}))}}componentDidMount(){this.initTableList()}render(){var s=this.props.prefixCls,t=this.state,r=t.tableTotal,c=t.tableList,h=t.tableLoading,T=t.params,O=t.planTitle,F={total:r,current:T.pageNumber,pageSize:T.pageSize};return a().createElement("div",{className:s},a().createElement("div",{className:"".concat(s,"__header")},a().createElement("div",{className:"".concat(s,"__header-flex")},a().createElement(q.Z,{parentId:"",checkable:!1,asyncLoad:!0,treeSelect:!0,className:"".concat(s,"__header__selectrow cl-search-normal-width"),onTreeSelectChange:this.handleTreeSelectChange}),a().createElement(k.Z,{className:"".concat(s,"__header__selectrow cl-search-normal-width"),onChange:this.handlePostSelectChange}))),a().createElement(X,{loading:h,paginationParams:F,list:c,planTitle:O,onTableChange:this.handleChangePagination,headerTitle:this.renderSearchRow(),toolBarRender:this.renderRightRow}))}}ve.defaultProps={prefixCls:"plan-monitor__persontab"};var Te=(0,ce.$j)()((0,I.Z)()(ve)),Pe=e(43358),Me=e(34041),Le=e(36202),_e=e(95664);class De extends a().Component{constructor(){super(...arguments);this.columns=[{title:this.props.t("common.number"),width:55,dataIndex:"id",key:"id",fixed:"left",render:(s,t,r)=>r+1}],this.handleTableChange=s=>{this.props.onTableChange(s)}}render(){var s=this.props,t=s.list,r=t===void 0?[]:t,c=s.loading,h=s.paginationParams,T=h===void 0?{}:h,O=s.toolBarRender,F=s.headerTitle,te=T.total,J=T.totalPage,me=T.current;return a().createElement("section",{className:"employee-people__content__table"},a().createElement(xe.Z,{withLoginPhoneNumber:!0,bordered:!0,headExtra:this.columns,rowKey:"userId",dataSource:r,pagination:!1,loading:c,headerTitle:F,toolBarRender:O,tableUUID:"2dd174cb-9e6d-4032-90bc-e5a9a9acf4f4"}),a().createElement(_e.Z,{totalNum:te,totalPage:J,current:me,defaultPageSize:10,showRenderRefresh:!1,onChange:this.handleTableChange}))}}var Re=(0,I.Z)()(De),Ue=e(47673),Ye=e(4107),Ae=e(59239),rt=e(55446),Oe=e(18329),He=Ae.Z.Item;class Je extends a().Component{constructor(){super(...arguments);this.state={visible:!1,days:""},this.onSearch=(s,t)=>{this.props.onSearch(s,t)},this.onUrgeUserStudy=()=>{var s=this.props.t;P.Z.confirm({title:s("study.remind"),content:s("study.urgeTip"),zIndex:99999,onOk:()=>{var t=E.ZP.EmployeeTrain.urgeUsers(),r={planId:this.props.planId};_.WY.get({url:t,params:r}).then(c=>{c.data.code===0&&d.default.success(c.data.msg)})}})},this.handleShowDelay=()=>{this.setState({visible:!this.state.visible})},this.handleSubmit=s=>{s.preventDefault(),this.props.form.validateFields((t,r)=>{t||(this.props.handleDelay(r),this.handleShowDelay())})},this.renderOngoingBtn=()=>a().createElement("div",{className:"employee-people__queryrow__action"},a().createElement($.Z,{overlay:a().createElement(S.Z,{onUrge:this.onUrgeUserStudy,onDing:this.props.onDing})},a().createElement(x.Z,{type:"primary"},this.props.t("study.remind")," ",a().createElement(re.Z,null)))),this.renderOverdueBtn=()=>{var s=this.props.selectedRowKeys,t=s.length;return a().createElement("div",{className:"employee-people__queryrow__action"},a().createElement(x.Z,{type:"primary",className:"ongoing-user-top-btn",onClick:this.handleShowDelay,disabled:t<=0},this.props.t("common.postpone")))},this.renderActionBtn=()=>{var s=this.props.status;return s==="3"?a().createElement("div",null,this.renderOverdueBtn()):s==="1"?a().createElement("div",null,this.renderOngoingBtn()):null}}render(){var s=this.props.t,t={okText:s("common.ok"),cancelText:s("common.cancel"),size:"small",destroyOnClose:!0,bodyStyle:{padding:"20px"},maskClosable:!1},r={labelCol:{span:5},wrapperCol:{span:15}},c=this.props.form.getFieldDecorator,h=this.state,T=h.visible,O=h.days;return a().createElement("header",{className:"employee-people__queryrow"},a().createElement("section",null,a().createElement(Q.Z,{onSearch:this.onSearch,width:"260px",placeholder:s("searchInputPlaceholder.userName")}),this.renderActionBtn()),a().createElement(Oe.ZP,(0,v.Z)({},t,{visible:T,title:s("common.postpone"),onCancel:this.handleShowDelay,onOk:this.handleSubmit}),a().createElement("div",{className:"employee-delay"},a().createElement(Ae.Z,{layout:"vertical"},a().createElement(He,(0,v.Z)({},r,{label:s("common.postpone")}),c("delayDay",{rules:[{validator:this.checkPostponeDays}],initialValue:O})(a().createElement("span",null,a().createElement(Ye.Z,{placeholder:"\u9650\u523630",style:{width:200}}),s("common.day"))))))))}}var ke=(0,I.Z)()(Ae.Z.create()(Je)),$e,Be,We,we,Xe=($e=(0,ce.$j)(Ce=>{var s=Ce.user;return{enterpriseName:s.enterpriseName}}),Be=Reflect.metadata("design:type",Function),We=Reflect.metadata("design:paramtypes",[void 0]),$e(we=Be(we=We(we=class extends a().Component{constructor(s){super(s);this.onCancel=()=>{this.props.onCancel()},this.handleChangPagination=t=>{this.setState(r=>({params:(0,i.Z)((0,i.Z)({},r.params),{},{page_number:t})}),()=>{this.initTableList()})},this.resetPagination=()=>new Promise(t=>{this.setState(r=>({params:(0,i.Z)((0,i.Z)({},r.params),{},{pageNumber:1,pageSize:20})}),()=>{t()})}),this.handleSearch=(t,r)=>{this.resetPagination().then(()=>{this.setState(c=>({params:(0,i.Z)((0,i.Z)({},c.params),{},{keyword:t,userIds:r})}),()=>{this.initTableList()})})},this.initTableList=()=>{this.setState({tableLoading:!0});var t=this.state.params,r=t.userIds,c=t.keyword;_.WY.get({url:E.ZP.ExaminationPlanMonitor.getRateUer(),params:(0,i.Z)((0,i.Z)({},this.state.params),{},{keyword:r?"":c})}).then(h=>{setTimeout(()=>{this.setState({tableLoading:!1,tableList:h.data.data.list,tableTotal:h.data.data.total,tableTotalPages:h.data.data.pages})},300)})},this.renderRightRow=()=>a().createElement(ke,{onSearch:this.handleSearch}),this.handleExport=()=>{var t=this.state.params,r=t.plan_id,c=t.question_id,h=t.rate_type,T=t.keyword,O="?".concat(o.stringify({plan_id:r,question_id:c,rate_type:h,keyword:T}));(0,pe.N)({page:"learningRateUser",props:this.props,query:O})},this.renderLeftRow=()=>{var t=this.props.t;return a().createElement(x.Z,{type:"primary",onClick:this.handleExport},a().createElement(fe.Z,null)," ",t("common.exportData"))},this.state={params:{plan_id:s.planId,question_id:s.questionId,rate_type:s.rateType,keyword:"",page_number:1,page_size:10,userIds:""},tableLoading:!0,tableList:[],tableTotal:0,tableTotalPages:0}}componentDidMount(){this.initTableList()}componentDidUpdate(s){if(this.props.visible&&this.props.visible!==s.visible&&this.props.planId){var t=this.props,r=t.planId,c=t.questionId,h=t.rateType;this.setState({params:{plan_id:r,question_id:c,rate_type:h,keyword:"",page_number:1,page_size:10},tableList:[],tableTotal:0},()=>{this.initTableList()})}}render(){var s=this.props,t=s.visible,r=s.t,c=s.rateType,h=s.questionType,T=this.state,O=T.tableTotal,F=T.tableList,te=T.tableLoading,J=T.tableTotalPages,me=T.params,ge={total:O,current:me.page_number,totalPage:J},ye;h===1?ye=r("common.single"):h===2?ye=r("common.multiple"):ye=r("common.tof");var Ze="".concat(ye).concat(r(c?"libraryPractice.accuracy":"libraryPractice.errorRate")).concat(r("examing.analyzeDetails"));return a().createElement(Oe.ZP,{visible:t,title:Ze,onCancel:this.onCancel,onOk:this.onCancel,size:"middle"},t?a().createElement("div",{className:"employee-people"},a().createElement("div",{className:"employee-people__content"},a().createElement(Re,{loading:te,paginationParams:ge,list:F,onTableChange:this.handleChangPagination,headerTitle:this.renderLeftRow(),toolBarRender:this.renderRightRow}))):null)}})||we)||we)||we),qe=(0,I.Z)()(Xe);class Fe extends a().Component{constructor(s){super(s);this.onCloseUserInfo=()=>{this.setState({resultUserProps:{visible:!1,planId:"",questionId:"",rateType:!1,questionType:0}})},this.showUserInfo=(t,r)=>{this.setState({resultUserProps:{visible:!0,planId:this.props.planId,questionId:t.id,rateType:r==="accuracy",questionType:t.type}})},this.handleTableChange=t=>{this.props.onTableChange(t)},this.state={resultUserProps:{visible:!1,planId:"",questionId:"",rateType:""}},this.columns=[{title:this.props.t("common.number"),width:80,dataIndex:"orderId",key:"orderId"},{title:this.props.t("exam.paperAddthType"),width:120,dataIndex:"typeName",key:"typeName"},{title:this.props.t("exam.paperBank"),width:120,dataIndex:"questionBankName",key:"questionBankName",render:(t,r)=>{var c=r.questionBankName;return c||"--"}},{title:this.props.t("exam.paperAddthName"),dataIndex:"title",key:"title"},{title:this.props.t("exam.knowledgePoint"),dataIndex:"knowledgePoint",key:"knowledgePoint",width:200,render:(t,r)=>{var c=r.knowledgePoint;return c?c.map(h=>a().createElement("div",{className:"question-knowledge-point",key:h.knowledgeId,title:h.title},h.title)):""}},{title:this.props.t("learning.questionAddOptionSubName"),width:120,dataIndex:"answer",key:"answer"},{title:this.props.t("libraryPractice.accuracy"),width:120,dataIndex:"accuracy",key:"accuracy",render:(t,r)=>a().createElement(m.Z,{name:r.accuracy,onClick:()=>this.showUserInfo(r,"accuracy")})},{title:this.props.t("libraryPractice.errorRate"),width:120,dataIndex:"errorRate",key:"errorRate",render:(t,r)=>a().createElement(m.Z,{name:r.errorRate,onClick:()=>this.showUserInfo(r,"errorRate")})}]}render(){var s=this.props,t=s.prefixCls,r=s.list,c=r===void 0?[]:r,h=s.loading,T=s.paginationParams,O=T===void 0?{}:T,F=s.toolBarRender,te=s.headerTitle,J=this.state.resultUserProps,me=J.visible,ge=(0,i.Z)((0,i.Z)({},E.XE.INITIAL_PAGINATION),O);return a().createElement("section",{className:t},a().createElement(Le.f,{scroll:{y:"100%"},columns:this.columns,rowKey:"id",dataSource:c,pagination:ge,loading:h,onChange:this.handleTableChange,toolBarRender:F,headerTitle:te,tableUUID:"e6af70c4-6816-4b03-b4cb-9ba19f061975"}),me&&a().createElement(qe,(0,v.Z)({},J,{onCancel:this.onCloseUserInfo})))}}Fe.defaultProps={prefixCls:"plan-monitor__analysistab__table"};var et=(0,I.Z)()(Fe),Ke=e(38642),je,Ge,Ve,ze,Ne=Me.Z.Option,tt={getAnalysisList:E.ZP.ExaminationPlanMonitor.getAnalysisList,exportQuestionAnalysis:E.ZP.ExaminationPlanMonitor.exportQuestionAnalysis},at=(je=(0,ce.$j)(Ce=>{var s=Ce.user;return{enterpriseName:s.enterpriseName}}),je(Ge=(ze=Ve=class extends a().Component{constructor(){super(...arguments);this.state={params:{planId:"",type:"",keyword:"",pageNumber:1,pageSize:20},tableLoading:!1,tableList:[],tableTotal:0},this.initTableList=()=>{this.setState({tableLoading:!0}),_.WY.get({url:tt.getAnalysisList(),params:(0,i.Z)((0,i.Z)({},this.state.params),{},{planId:this.props.actionId})}).then(s=>{setTimeout(()=>{this.setState({tableLoading:!1,tableList:s.data.data.list,tableTotal:s.data.data.total})},300)})},this.handleChangePagination=s=>{var t=s.current,r=s.pageSize;this.setState(c=>({params:(0,i.Z)((0,i.Z)({},c.params),{},{pageNumber:t,pageSize:r})}),()=>{this.initTableList()})},this.resetPagination=()=>new Promise(s=>{this.setState(t=>({params:(0,i.Z)((0,i.Z)({},t.params),{},{pageNumber:1,pageSize:20})}),()=>{s()})}),this.handleSearch=s=>{this.setState(t=>({params:(0,i.Z)((0,i.Z)({},t.params),{},{keyword:s})}),()=>{this.initTableList()})},this.handleSelectChange=s=>{this.setState(t=>({params:(0,i.Z)((0,i.Z)({},t.params),{},{type:s})}),()=>{this.initTableList()})},this.handleExport=()=>{var s=o.parse(R.m8.location.search),t=s.taskType,r=s.taskId,c=s.projectId,h="export_type_01",T=r;switch(t){case"project":h="export_type_02",T=c;break;case"task":case"employee":h="export_type_01";break;case"exam":h="export_type_03",T="";break;default:}var O="";(0,Ke.UI)("EXAM_BANK_CONFIG")&&(O=2e4);var F="&planId=".concat(this.props.actionId,"&type=").concat(this.state.params.type,"&keyword=").concat(this.state.params.keyword,"&exportExamType=").concat(h,"&sourceId=").concat(T,"&exportCount=").concat(O);(0,pe.N)({page:"exportQuestionAnalysis",props:this.props,query:F})},this.renderSearchRow=()=>{var s=this.props.t;return a().createElement(x.Z,{type:"primary",onClick:this.handleExport},a().createElement(fe.Z,null)," ",s("common.exportData"))},this.renderRight=()=>{var s=this.props.t;return a().createElement(Q.Z,{onSearch:this.handleSearch,width:"282px",placeholder:s("searchInputPlaceholder.question")})},this.renderSelectRow=()=>{var s=this.props,t=s.prefixCls,r=s.t;return a().createElement("div",{className:"".concat(t,"__selectrow"),style:{marginBottom:"24px"}},a().createElement(Me.Z,{defaultValue:"",className:"cl-search-normal-width",onChange:this.handleSelectChange},a().createElement(Ne,{value:""},r("courseManage.allType")),a().createElement(Ne,{value:"1"},r("common.single")),a().createElement(Ne,{value:"2"},r("common.multiple")),a().createElement(Ne,{value:"3"},r("common.tof"))))}}componentDidMount(){this.initTableList()}render(){var s=this.props,t=s.prefixCls,r=s.actionId,c=this.state,h=c.tableTotal,T=c.tableList,O=c.tableLoading,F=c.params,te={total:h,current:F.pageNumber,pageSize:F.pageSize};return a().createElement("div",{className:t},this.renderSelectRow(),a().createElement(et,{loading:O,planId:r,paginationParams:te,list:T,onTableChange:this.handleChangePagination,headerTitle:this.renderSearchRow(),toolBarRender:this.renderRight}))}},Ve.defaultProps={prefixCls:"plan-monitor__analysistab"},ze))||Ge),ue=(0,ce.$j)()((0,I.Z)()(at)),n=e(9715),l=e(86585),u=e(14965),A=e(11448),Y=e(78138),V=e.n(Y);class ne extends a().Component{constructor(){super(...arguments);this.columns=[{title:this.props.t("exam.makeupDuration"),width:250,dataIndex:"makeupExamRangeTime",key:"makeupExamRangeTime"},{title:this.props.t("exam.examResult"),width:120,dataIndex:"statusName",key:"statusName",onCell:()=>({style:{minWidth:80}})},{title:this.props.t("exam.examItems"),width:120,dataIndex:"makeupCount",key:"makeupCount",onCell:()=>({style:{minWidth:80}})},{title:this.props.t("exam.examScore"),width:120,dataIndex:"score",key:"score",onCell:()=>({style:{minWidth:80}})},{title:this.props.t("exam.marker"),width:100,dataIndex:"markerName",key:"markerName",render:(s,t)=>a().createElement(D.Z,{dataType:"userName",value:t.marker_sync_user_id,name:s,type:t.marker_source_type})},{title:this.props.t("exam.examTime"),dataIndex:"examDuration",key:"examDuration",width:100,onCell:()=>({style:{minWidth:80}})},{title:this.props.t("common.operate"),width:100,key:"operate",fixed:"right",render:s=>this.renderActions({record:s})}],this.handleTableChange=s=>{this.props.onTableChange(s)},this.handleGotoExam=s=>{var t=s.record;R.m8.push({pathname:"/training/examination/result",search:o.stringify({pageFrom:"examMonitor",userId:t.userId,id:t.planId})})},this.renderActions=s=>{var t=s.record,r=t.makeupCount;return r?a().createElement("div",{className:"cl-table__cell-action"},a().createElement("span",{className:"cl-pointer",onClick:()=>this.handleGotoExam({record:t})},this.props.t("common.viewDetails"))):a().createElement("div",{className:"cl-table__cell-action"},a().createElement("span",{className:"cl-pointer cl-disabled"},this.props.t("common.viewDetails")))}}render(){var s=this.props,t=s.selectedRowKeys,r=s.prefixCls,c=s.list,h=c===void 0?[]:c,T=s.loading,O=s.paginationParams,F=O===void 0?{}:O,te=s.toolBarRender,J=s.headerTitle,me=(0,i.Z)((0,i.Z)({},E.XE.INITIAL_PAGINATION),F),ge={selectedRowKeys:t,onChange:(ye,Ze)=>{this.props.selectTableData(ye,Ze)}};return a().createElement("section",{className:r},a().createElement(xe.Z,{withLoginPhoneNumber:!0,columns:this.columns,rowKey:"id",dataSource:h,pagination:me,loading:T,onChange:this.handleTableChange,rowSelection:(0,i.Z)({},ge),toolBarRender:te,headerTitle:J,tableUUID:"cf3a3b69-e7ac-48f9-b570-043bae605d6f"}))}}ne.defaultProps={prefixCls:"plan-monitor__persontab__table"};var Ie=(0,I.Z)()(ne),Se={getMakeupExamMonitors:E.ZP.ExaminationPlanMonitor.getMakeupExamMonitors,exportMakeupExamMonitors:E.ZP.ExaminationPlanMonitor.exportMakeupExamMonitors,setExamDelay:E.ZP.QuestionManager.setExamDelay};class Qe extends a().Component{constructor(s){super(s);this.initTableList=()=>{this.setState({tableLoading:!0}),_.WY.get({url:Se.getMakeupExamMonitors({examId:this.props.actionId}),params:(0,i.Z)((0,i.Z)({},this.state.params),{},{planId:this.props.actionId})}).then(t=>{var r=this.props.t;setTimeout(()=>{this.setState({tableLoading:!1,tableList:t.data.data.planUser.list,tableTotal:t.data.data.planUser.total,radioList:[{name:"".concat(r("exam.all"),"(").concat(t.data.data.tabId0count,")"),value:0},{name:"".concat(r("exam.qualified"),"(").concat(t.data.data.tabId2count,")"),value:2},{name:"".concat(r("exam.unqualified"),"(").concat(t.data.data.tabId1count,")"),value:1},{name:"".concat(r("exam.notTest"),"(").concat(t.data.data.tabId3count,")"),value:3}]})},300)})},this.handleQueryRowRadiosChange=t=>{this.resetPagination().then(()=>{this.setState(r=>({params:(0,i.Z)((0,i.Z)({},r.params),{},{tabId:t})}),()=>{this.initTableList()})})},this.handleQueryRowSearch=t=>{this.resetPagination().then(()=>{this.setState(r=>({params:(0,i.Z)((0,i.Z)({},r.params),{},{keyword:t})}),()=>{this.initTableList()})})},this.handleChangePagination=t=>{var r=t.current,c=t.pageSize;this.setState(h=>({params:(0,i.Z)((0,i.Z)({},h.params),{},{pageNumber:r,pageSize:c})}),()=>{this.initTableList()})},this.selectTableData=(t,r)=>{var c=r.map(h=>h.userId);this.setState({userIds:c,selectedRowKeys:t}),r&&r.length>0?this.setState({isDisabled:!1}):this.setState({isDisabled:!0})},this.resetPagination=()=>new Promise(t=>{this.setState(r=>({params:(0,i.Z)((0,i.Z)({},r.params),{},{pageNumber:1,pageSize:20})}),()=>{t()})}),this.handleTreeSelectChange=t=>{this.setState(r=>({params:(0,i.Z)((0,i.Z)({},r.params),{},{departmentId:t})}),()=>{this.initTableList()})},this.handlePostSelectChange=t=>{this.setState(r=>({params:(0,i.Z)((0,i.Z)({},r.params),{},{postId:t})}),()=>{this.initTableList()})},this.handleSearch=(t,r)=>{var c={keyword:r===""?t:"",userIds:r};this.setState(h=>({params:(0,i.Z)((0,i.Z)({},h.params),c)}),()=>{this.initTableList()})},this.handleExport=()=>{var t=this.state.params,r=t.keyword,c=t.departmentId,h=t.tabId,T=t.postId,O=o.parse(R.m8.location.search),F=O.taskType,te=O.taskId,J=O.projectId,me="export_type_01",ge=te;switch(F){case"project":me="export_type_02",ge=J;break;case"task":case"employee":me="export_type_01";break;case"exam":me="export_type_03",ge="";break;default:}var ye="&keyword=".concat(r,"&departmentId=").concat(c,"&tabId=").concat(h,"&postId=").concat(T,"&exportExamType=").concat(me,"&sourceId=").concat(ge);(0,pe.N)({page:"exportMakeupExamMonitors",props:this.props,query:ye,rest:{examId:this.props.actionId}})},this.renderSearchRow=()=>{var t=this.props,r=t.prefixCls,c=t.t,h=this.state.isDisabled;return a().createElement("div",{className:"".concat(r,"__searchrow")},a().createElement(x.Z,{type:"primary",onClick:this.handleExport},a().createElement(fe.Z,null),c("common.exportData")),a().createElement(x.Z,{disabled:h,style:{marginLeft:8},onClick:()=>{this.batchDelay(!0)}},this.props.t("exam.batchDelay")))},this.cancelDelay=()=>{this.batchDelay(!1)},this.okDelay=()=>{var t=this.props.t,r=this.state,c=r.userIds,h=r.delayTimeVal;this.form&&this.form.current&&this.form.current.validateFields().then(()=>{_.WY.post({url:Se.setExamDelay({examId:this.props.actionId}),data:{makeupExamEndTime:h,userIds:c}}).then(()=>{d.default.success(t("myExamTask.postponeSuccess")),this.setState({selectedRowKeys:[]}),this.initTableList(),this.batchDelay(!1)})}).catch(()=>{})},this.batchDelay=t=>{this.form&&this.form.current&&this.form.current.resetFields(),this.setState({showBatchDelay:t})},this.disabledDate=t=>t&&t<V()(new Date).add(-1,"days"),this.handleChange=(t,r)=>{this.setState({delayTimeVal:V()(r).valueOf()})},this.renderRightRow=()=>{var t=this.props,r=t.prefixCls,c=t.t,h=this.state.radioList;return a().createElement("div",{className:"".concat(r,"__header-container__between")},a().createElement(ee.Z,{showCheckbox:!1,showSearch:!1,showBtn:!1,radioList:h,defaultRadioValue:0,onRadiosChange:this.handleQueryRowRadiosChange}),a().createElement(Q.Z,{onSearch:this.handleSearch,width:"272px",placeholder:c("searchInputPlaceholder.userName")}))},this.renderModalFooter=()=>a().createElement("div",{style:{textAlign:"center"}},a().createElement(x.Z,{key:"back",onClick:()=>this.cancelDelay(),style:{width:136}},this.props.t("common.cancel")),a().createElement(x.Z,{key:"submit",type:"primary",onClick:()=>this.okDelay(),style:{width:136}},this.props.t("common.ok"))),this.form=a().createRef(),this.state={params:{planId:"",tabId:0,status:"",departmentId:"",postId:"",keyword:"",pageNumber:1,pageSize:20},radioList:[],tableLoading:!1,tableList:[],tableTotal:0,isDisabled:!0,showBatchDelay:!1,delayTimeVal:null,userIds:[],selectedRowKeys:[]}}componentDidMount(){this.initTableList()}render(){var s=this.props,t=s.prefixCls,r=s.t,c=this.state,h=c.tableTotal,T=c.tableList,O=c.tableLoading,F=c.params,te=c.showBatchDelay,J=c.selectedRowKeys,me={total:h,current:F.pageNumber,pageSize:F.pageSize};return a().createElement("div",{className:t},a().createElement(P.Z,{title:this.props.t("common.postpone"),centered:!0,visible:te,onCancel:()=>this.cancelDelay(),footer:this.renderModalFooter()},a().createElement(l.Z,{name:"time_related_controls",ref:this.form,layout:"vertical"},a().createElement(l.Z.Item,{label:this.props.t("common.endTime"),name:"end_time",rules:[{required:!0,message:r("common.messagePlaceholder")}]},a().createElement(A.Z,{style:{width:"100%"},format:"YYYY-MM-DD HH:mm",disabledDate:this.disabledDate,onChange:this.handleChange,showTime:!0})))),a().createElement("div",{className:"".concat(t,"__header")},a().createElement("div",{className:"".concat(t,"__header-flex")},a().createElement(q.Z,{parentId:"",checkable:!1,asyncLoad:!0,treeSelect:!0,className:"".concat(t,"__header__selectrow cl-search-normal-width"),onTreeSelectChange:this.handleTreeSelectChange}),a().createElement(k.Z,{className:"".concat(t,"__header__selectrow cl-search-normal-width"),onChange:this.handlePostSelectChange}))),a().createElement(Ie,{loading:O,paginationParams:me,list:T,selectedRowKeys:J,onTableChange:this.handleChangePagination,selectTableData:this.selectTableData,headerTitle:this.renderSearchRow(),toolBarRender:this.renderRightRow}))}}Qe.defaultProps={prefixCls:"plan-monitor__detailtab"};var st=(0,ce.$j)()((0,I.Z)()(Qe));class nt extends a().Component{constructor(){super(...arguments);this.state={activeTabKey:"0",authScope:{visible:!1}},this.handleChangeTab=s=>{this.setState({activeTabKey:s})},this.changeAuthScope=s=>{this.setState({authScope:{visible:s}})}}render(){var s=this.props,t=s.prefixCls,r=s.showDetail,c=r===void 0?!0:r,h=s.t,T=this.state,O=T.activeTabKey,F=T.authScope,te=o.parse(R.m8.location.search),J=te.id;return J?a().createElement("div",{className:t},a().createElement(Z.Z,{title:h("documentTitle.employeeMonitoring")}),a().createElement(ae,{actionId:J,authScope:F}),a().createElement("div",{className:"".concat(t,"__content")},a().createElement(f.Z,{activeKey:O,animated:!1,onChange:this.handleChangeTab},a().createElement(f.Z.TabPane,{tab:h("study.monitoring"),key:"0"},a().createElement("div",{className:"".concat(t,"__content-tab_container")},a().createElement("div",null,a().createElement(Te,{actionId:J,changeAuthScope:this.changeAuthScope})))),a().createElement(f.Z.TabPane,{tab:h("study.questionAnalysis"),key:"1"},a().createElement("div",{className:"".concat(t,"__content-tab_container")},a().createElement("div",null,a().createElement(ue,{actionId:J})))),c?a().createElement(f.Z.TabPane,{tab:h("study.reTestDetails"),key:"2"},a().createElement("div",{className:"".concat(t,"__content-tab_container")},a().createElement("div",null,a().createElement(st,{actionId:J})))):null))):null}}nt.defaultProps={prefixCls:"plan-monitor"};var ot=(0,I.Z)()(nt)},34494:function(Ee,H,e){"use strict";e.r(H),e.d(H,{default:function(){return B}});var oe=e(12924),f=e.n(oe),j=e(91768),a=e(1465),I=e(4408),o=e(36017),R=e(35247),Z=e(76651),v=e(57068),C=e(77217);class U extends f().Component{render(){var i=this.props.t,ie=v.parse(Z.m8.location.search),d=ie.taskId,N=ie.from,P=N===void 0?"":N;return f().createElement(C.Z,null,f().createElement(R.Z,null,f().createElement(R.Z.Item,null,i("leftMenuLists.training")),f().createElement(R.Z.Item,null,i("leftMenuLists.studyManagement")),f().createElement(R.Z.Item,{href:P==="project"?"#/knowledgeBase/learningResources/studyProject":"#/training/learning/task/management"},i(P==="project"?"leftMenuLists.studyProject":"leftMenuLists.studyTasks")),f().createElement(R.Z.Item,{href:P==="project"?"#/training/learning/project/monitor?id=".concat(d):"#/training/learning/management/monitor?id=".concat(d)},i("common.monitor")),f().createElement(R.Z.Item,{className:"ant-breadcrumb-link-active"},this.props.t("exam.questionMonitor"))))}}var z=(0,j.Z)()(U);class $ extends f().Component{render(){var i=(window.location.hash||"").includes("/training/learning/project/monitor/exam")?this.props.t("documentTitle.projectExamMonitoring"):this.props.t("documentTitle.planExamMonitoring");return f().createElement(f().Fragment,null,f().createElement(I.Z,{title:i}),f().createElement(a.default,{TBreadcrumb:z,showDetail:!0}))}}var B=(0,j.Z)()($)},31945:function(Ee,H,e){"use strict";e.d(H,{Z:function(){return be}});var oe=e(88983),f=e(47933),j=e(20228),a=e(11382),I=e(62029),o=e(30887),R=e(99210),Z=e(59250),v=e(13013),C=e(57663),U=e(71577),z=e(63185),$=e(9676),B=e(71194),x=e(57016),i=e(88986),ie=e(34792),d=e(48086),N=e(43358),P=e(34041),W=e(12924),y=e.n(W),re=e(28216),se=e(91768),K=e(57254),p=e(18329);class _ extends y().Component{constructor(){super(...arguments);this.onCancel=()=>{this.props.showReferenceCourseList()}}render(){var m=this.props,M=m.visible,w=m.courseList,X=m.t;return y().createElement(p.ZP,{visible:M,title:X("common.tip"),onCancel:this.onCancel,onOk:this.onCancel},y().createElement("div",{className:"referenceWithOtherCourses"},y().createElement("div",{className:"referenceWithOtherCourses__tip"},X("course.deleteCourseTip")),w.map((q,k)=>y().createElement("div",{className:"referenceWithOtherCourses__item",key:k},w.length>1?"".concat(k+1,"\u3001"):null," ",q))))}}var E=(0,se.Z)()(_),g=e(10237),b=e(63848),S=e(58546),D=e(30389),L=e(54792),G=e(86726),ae=e(37055),de=P.Z.Option,le={setClassify:ae.ZP.CourseManageList.setClassify,setScore:ae.ZP.CourseManageList.setScore,setBatchEmployee:ae.ZP.CourseManageList.setBatchEmployee,deleteCourse:ae.ZP.CourseManageList.deleteCourse,exportCourseView:ae.ZP.CourseManageList.exportCourseView,syncCourse:ae.ZP.CourseManageList.syncCourse},ce=xe=>({qyShield:xe.user.qyShield});class fe extends y().Component{constructor(){super(...arguments);this.state={classifyProps:{visible:!1},scoreProps:{title:this.props.t("course.setCredits"),labelTxt:this.props.t("course.credit"),initialValue:"",visible:!1},employeeProps:{visible:!1,initialParams:{employeeRange:{rangeType:3,rangeList:{dept:[],post:[],group:[],user:[]}}}},asyncProps:{value:0,visible:!1},showReferenceCourseListProps:{visible:!1,courseList:[],onOk:this.showReferenceCourseList,onCancel:this.showReferenceCourseList}},this.handleChangeClassify=m=>{this.props.onClassifyChange(m)},this.handleChangeType=m=>{this.props.onTypeChange(m)},this.handleChangeCourseType=m=>{this.props.onCourseTypeChange(m)},this.actionChangeClassify=()=>{this.setState({classifyProps:{visible:!0}})},this.handleCategoryCancel=()=>{this.setState({classifyProps:{visible:!1}})},this.handleCategoryOk=m=>{var M=m.node,w=this.props,X=w.selectedCourseIds,q=w.selectedProjectIds,k=w.onForceRender,Q=w.t,ee=M.id;ee&&g.qg.post({url:le.setClassify(),data:{course_ids:X.join(","),project_ids:q.join(","),classify_id:ee}}).then(()=>{d.default.success(Q("course.setCourseClassifySuccess")),k()}),this.handleCategoryCancel()},this.actionSetScore=()=>{this.setState(m=>({scoreProps:(0,i.Z)((0,i.Z)({},m.scoreProps),{},{initialValue:"",visible:!0})}))},this.handleScoreCancel=()=>{this.setState(m=>({scoreProps:(0,i.Z)((0,i.Z)({},m.scoreProps),{},{visible:!1})}))},this.handleScoreOk=m=>{var M=m.value;if(M===0){this.handleScoreCancel();return}var w=this.props,X=w.selectedCourseIds,q=w.selectedProjectIds,k=w.onForceRender,Q=w.t;g.qg.post({url:le.setScore(),data:{course_ids:X.join(","),project_ids:q.join(","),credit:M}}).then(()=>{d.default.success(Q("course.setCourseScoreSuccess")),k()}),this.handleScoreCancel()},this.actionSetEmployeeRange=()=>{this.setState(m=>({employeeProps:(0,i.Z)((0,i.Z)({},m.employeeProps),{},{visible:!0})}))},this.handleEmployeeCancel=()=>{this.setState({employeeProps:{visible:!1,initialParams:{employeeRange:{rangeType:3,rangeList:{dept:[],post:[],group:[],user:[]}}}}})},this.handleEmployeeOk=m=>{var M=this.props,w=M.selectedCourseIds,X=M.selectedProjectIds,q=M.onForceRender,k=M.t,Q=m.isAll,ee=m.departmentIds,pe=m.groupIds,he=m.postIds,ve=m.userIds,Te=m.qy_we_chat_vo;g.WY.post({url:le.setBatchEmployee(),data:{course_ids:w.join(","),project_ids:X.join(","),department_ids:ee,group_ids:pe,is_all:Q,post_ids:he,user_ids:ve,qy_we_chat_vo:Te}}).then(()=>{d.default.success(k("personal.batchSetRangeSuccess")),q()}),this.handleEmployeeCancel()},this.showReferenceCourseList=m=>{this.setState(M=>({showReferenceCourseListProps:(0,i.Z)((0,i.Z)({},M.showReferenceCourseListProps),{},{visible:!M.showReferenceCourseListProps.visible,courseList:m||[]})}))},this.actionDelete=()=>{var m=this.props,M=m.selectedCourseIds,w=m.selectedProjectIds,X=m.list,q=m.onForceRender,k=m.t,Q=0,ee=0,pe=[];if(X.forEach(he=>{M.includes(he.course_id)&&(he.reference_plan_count>0&&(ee+=1),he.reference_plan_count>0&&pe.push(he.title),he.can_delete==="true"&&(Q+=1))}),ee>0)this.showReferenceCourseList(pe);else if(Q!==M.length)d.default.warning(k("personal.deletePlatformCourseTip"));else{if(w.length>0){d.default.warning(k("personal.deleteProjectCourseTip"));return}x.Z.confirm({title:k("common.tip"),content:k("common.confirmDeleteTitle"),onOk(){g.qg.post({url:le.deleteCourse(),data:{enterpriseId:ae.ZP.enterpriseId,ids:M.join(","),project_ids:w.join(",")}}).then(he=>{var ve=he.data,Te=ve.code,Pe=ve.msg;d.default["".concat(Te===0?"success":"warning")](Pe),Te===0&&q()})}})}},this.actionSyncSetting=()=>{this.setState(m=>({asyncProps:(0,i.Z)((0,i.Z)({},m.asyncProps),{},{visible:!0})}))},this.onAsyncChange=m=>{this.setState(M=>({asyncProps:(0,i.Z)((0,i.Z)({},M.asyncProps),{},{value:m.target.value})}))},this.handleSyncCancel=()=>{this.setState({asyncProps:{visible:!1,value:0}})},this.handleSyncOk=()=>{var m=this.props,M=m.selectedCourseIds,w=m.selectedProjectIds,X=m.onForceRender,q=m.t,k=this.state.asyncProps;g.qg.post({url:le.syncCourse(),data:{course_ids:M.join(","),project_ids:w.join(","),syncProgress:k.value}}).then(Q=>{var ee=Q.data,pe=ee.code,he=ee.msg;pe===0?(d.default.success(q("setting.setUpSucceed")),X()):d.default.warning(he)}),this.handleSyncCancel()},this.actionImportDetail=()=>{var m=this.props,M=m.selectedCourseIds,w=m.selectedProjectIds,X=m.onForceRender,q=m.t;if(M.concat(w).length>20){d.default.warning(q("courseManage.exportMoreTip"));return}var k=le.exportCourseView(),Q={course_Ids:M.join(","),project_Ids:w.join(",")};g.WY.get({url:k,params:Q}).then(ee=>{ee.data.code===200&&d.default.success("\u6587\u4EF6\u751F\u6210\u4E2D\uFF0C\u8BF7\u7A0D\u540E\u5728\u6587\u4EF6\u4E0B\u8F7D\u4E2D\u4E0B\u8F7D"),X(),this.getDownloadingNumber()})},this.getDownloadingNumber=()=>{var m=ae.ZP.downLoadCenter.getDownLoadingCount();g.WY.get({url:m,params:{}}).then(M=>{sessionStorage.setItem("downloadingCount",M.data.data),this.props.dispatch({type:"download/updateDownloadingNumber",downloadingNumber:M.data.data})}).catch(()=>{sessionStorage.setItem("downloadingCount",0),this.props.dispatch({type:"download/updateDownloadingNumber",downloadingNumber:0})})},this.handleChangeCheckBox=m=>{this.props.onCheckboxChange(m.target.checked)},this.handleSharingQueryRowCheckboxChange=m=>{this.props.onSharingCheckboxChange(m.target.checked)},this.renderCondition=()=>{var m=this.props,M=m.prefixCls,w=m.params,X=m.qyShield,q=m.t,k=w.classify_id?w.classify_id.split(","):[];return y().createElement("div",{className:"".concat(M,"__condition")},this.props.extraDom&&this.props.extraDom(),y().createElement(b.Z,{onChange:this.handleChangeClassify,className:"cl-search-normal-width",value:k,showLabel:!1,placeholder:"Please select",queryType:"course_manage",unclassified:"true"}),y().createElement(P.Z,{value:w.type,className:"cl-search-normal-width",onChange:this.handleChangeType},y().createElement(de,{value:""},this.props.t("courseManage.allOrigin")),y().createElement(de,{value:"original"},this.props.t("courseManage.originalCourse")),y().createElement(de,{value:"notOriginal"},this.props.t("courseManage.nonOriginalCourse")),y().createElement(de,{value:"platform"},this.props.t("courseManage.platformProcurement"))),this.props.courseType&&this.props.courseType=="graphic"?null:y().createElement(P.Z,{value:w.course_type,className:"cl-search-normal-width",onChange:this.handleChangeCourseType},y().createElement(de,{value:"all"},this.props.t("courseManage.allType")),y().createElement(de,{value:"course"},this.props.t("common.courseLabel")),y().createElement(de,{value:"microCourse"},this.props.t("common.microCourse")),y().createElement(de,{value:"project"},this.props.t("leftMenuLists.studyProject"))),y().createElement($.Z,{onChange:this.handleChangeCheckBox,style:{marginRight:16}},q("common.myCreated")),this.props.courseType&&this.props.courseType==="graphic"&&X==="false"?y().createElement($.Z,{onChange:this.handleSharingQueryRowCheckboxChange},q("common.sharing")):null)},this.renderActions=()=>{var m=this.props,M=m.prefixCls,w=m.selectedCourseIds,X=m.selectedProjectIds,q=m.showNum,k=q===void 0?1:q,Q=this.props.allowActions,ee=(0,G.H3)("delete",Q),pe=(0,G.H3)("adjustment_classification",Q),he=(0,G.H3)("set_visible",Q),ve=(0,G.H3)("export",Q),Te=(0,G.H3)("set_score",Q),Pe=(0,G.H3)("progressSync",Q),Me=[{name:this.props.t("courseManage.adjustClassification"),type:"actionChangeClassify",isShow:pe},{name:this.props.t("courseManage.exportViewDetail"),type:"actionImportDetail",isShow:ve},{name:this.props.t("courseManage.setCredits"),type:"actionSetScore",isShow:Te},{name:this.props.t("courseManage.setTheVisibilityed"),type:"actionSetEmployeeRange",isShow:he},{name:this.props.t("common.delete"),type:"actionDelete",isShow:ee},{name:this.props.t("common.scheduleSyncSetting"),type:"actionSyncSetting",isShow:Pe}],Le=Me.filter(Re=>Re.isShow),_e=[],De=[];if(Le.length)k?(_e=[...Le.slice(0,k)],De=[...Le.slice(k)]):De=[...Le];else return null;return y().createElement("div",{className:"".concat(M,"__action")},_e.map(Re=>y().createElement(U.Z,{style:{marginRight:"8px"},key:Re.type,disabled:!(w.length+X.length),onClick:this[Re.type]},Re.name)),De.length?y().createElement(v.Z,{disabled:!(w.length+X.length),overlay:this.renderMoreButton({buttons:De})},y().createElement(U.Z,{className:"cl-pointer"},"".concat(this.props.t("common.more"))," ",y().createElement(K.Z,null))):"")}}renderMoreButton(m){var M=m.buttons,w=this.props,X=w.selectedCourseIds,q=w.selectedProjectIds;return y().createElement(R.Z,{onClick:k=>{var Q=k.key;this[Q]()}},M.map(k=>k.isShow?y().createElement(R.Z.Item,{key:k.type,disabled:!(X.length+q.length)},y().createElement("span",{className:"cl-pointer"},k.name)):null))}render(){var m=this.props,M=m.prefixCls,w=m.t,X=m.showRenderCondition,q=X===void 0?!0:X,k=m.showRenderActions,Q=k===void 0?!0:k,ee=this.state,pe=ee.classifyProps,he=ee.scoreProps,ve=ee.employeeProps,Te=ee.showReferenceCourseListProps,Pe=ee.asyncProps;return y().createElement("div",{className:M},q&&this.renderCondition(),Q&&this.renderActions(),y().createElement(S.Z,(0,I.Z)({},pe,{title:w("personal.chooseClassify"),onCancel:this.handleCategoryCancel,onOk:this.handleCategoryOk})),y().createElement(L.Z,(0,I.Z)({},he,{onCancel:this.handleScoreCancel,onCreate:this.handleScoreOk})),ve.visible&&y().createElement(D.Z,(0,I.Z)({},ve,{title:w("courseManage.setTheVisibility"),mode:["all","part","private"],orgProps:{title:w("component.chooseVisibleScope")},isLoading:!ve.visible,onCancel:this.handleEmployeeCancel,onCreate:this.handleEmployeeOk})),Pe.visible&&y().createElement(p.ZP,{wrapClassName:"cl-async-selector-modal",visible:Pe.visible,title:w("common.scheduleSyncSetting"),okText:w("common.ok"),cancelText:w("common.cancel"),onCancel:this.handleSyncCancel,onOk:this.handleSyncOk},Pe.visible?y().createElement("div",{className:"".concat(M,"__async")},y().createElement("p",null," ",w("common.scheduleSyncSettingTip")),y().createElement(f.ZP.Group,{onChange:this.onAsyncChange,value:Pe.value},y().createElement(f.ZP,{value:0},w("common.outSync")),y().createElement(f.ZP,{value:1},w("common.synchronization")))):y().createElement(a.Z,{size:"large"})),y().createElement(E,(0,I.Z)({},Te,{showReferenceCourseList:this.showReferenceCourseList})))}}fe.defaultProps={prefixCls:"resource-course-list-page__release__content__queryrow",rangeType:""};var be=(0,se.Z)()((0,re.$j)(ce)(fe))}}]);
