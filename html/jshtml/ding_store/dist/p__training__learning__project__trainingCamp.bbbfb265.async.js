(self.webpackChunkkuxueyuan_manage=self.webpackChunkkuxueyuan_manage||[]).push([[547],{53009:function(ae,$,_){"use strict";_.d($,{TD:function(){return H},$S:function(){return G},aI:function(){return T},Bg:function(){return P},tT:function(){return D},XN:function(){return N},YK:function(){return Z},$x:function(){return B}});var L=_(81211),c=_(88986),R=_(78138),C=_.n(R),F=_(78001),J=_(76651),x=_(38642),b=_(6793),o=_(37055),d=_(75205);function y(s){return s.map(u=>({name:u.name,id:u.id,proportion:0,disabled:u.totalCount===0||u.total_count===0}))}function g(s,u){return u.map((E,h)=>(0,c.Z)((0,c.Z)({},s[h]),{},{disabled:E.total_count===0}))}var S=s=>{var u=0,E=s.checkedValue,h=s.fillBlank,p=s.shortAnswer;return E===2?h.checked&&!p.checked?u=3:!h.checked&&p.checked?u=4:u=2:u=1,u},Q=s=>{for(var u in s)s[(0,x.FI)(u)]=s[u];return s},H=(s,u,E,h,p,a)=>{var e=s.map((t,I)=>{var A=t.list.map((i,n)=>{var l,r=i.data,k={};switch(i.componentName){case"CoursewareSelector":k={courseId:i.id,courseSort:n,courseType:3,flag:1,mappingId:i.mappingId?i.mappingId:""};break;case"CourseSelector":k={courseId:i.id,courseSort:n,courseType:1,flag:1,mappingId:i.mappingId?i.mappingId:""};break;case"AddExam":k={courseSort:n,title:r.title,type:"ex",cheatFlag:r.cheatFlag.isChecked?1:0,faceRecognition:r.cheatFlag.faceRecognition,examDuration:r.examDuration,summary:r.summary,flag:2,mappingId:i.mappingId?i.mappingId:"",courseId:i.id,markType:S(r.markType),paperId:r.questionsMode===1?r.fixedQuestion.id:"",paperTitle:r.questionsMode===1?r.fixedQuestion.name:"",passLine:r.passLine,questionBankList:r.questionsMode===1?"":r.randomQuestion.bankQuesitonVoList.map(K=>K.id).join(","),questionMode:r.questionsMode,showKnowledge:r.knowledgePoints===1?"show":"hide",repeatExam:r.reExam.isChecked,multipleCount:r.questionsMode===1?"":r.randomQuestion.bankQuesitonInfo.multipleCount,multipleUnitScore:r.questionsMode===1?"":r.randomQuestion.bankQuesitonInfo.multipleScore,fillBlankCount:r.questionsMode===1?"":r.randomQuestion.bankQuesitonInfo.fillBlankCount,fillBlankUnitScore:r.questionsMode===1?"":r.randomQuestion.bankQuesitonInfo.fillBlankScore,fillBlankType:r.questionsMode===1?1:r.randomQuestion.bankQuesitonInfo.fillBlankType,shortAnswerCount:r.questionsMode===1?"":r.randomQuestion.bankQuesitonInfo.shortAnswerCount,shortAnswerUnitScore:r.questionsMode===1?"":r.randomQuestion.bankQuesitonInfo.shortAnswerScore,shortAnswerType:r.questionsMode===1?1:r.randomQuestion.bankQuesitonInfo.shortAnswerType,singleCount:r.questionsMode===1?"":r.randomQuestion.bankQuesitonInfo.singleCount,singleUnitScore:r.questionsMode===1?"":r.randomQuestion.bankQuesitonInfo.singleScore,trueOrFalseCount:r.questionsMode===1?"":r.randomQuestion.bankQuesitonInfo.trueOrFalseCount,trueOrFalseUnitScore:r.questionsMode===1?"":r.randomQuestion.bankQuesitonInfo.trueOrFalseScore,multipleMissedScore:r.questionsMode===1?"":r.randomQuestion.bankQuesitonInfo.multipleMissedScore,totalScore:r.questionsMode===1?r.fixedQuestion.tableList.totalScore:"",answerParsing:r.reExam.isChecked?r.reExam.allowed.end:r.reExam.notAllowed.end,passingScore:r.questionsMode===1?Number(r.fixedQuestion.tableList.totalScore*r.passLine/100).toFixed(1):60,cutScreenCount:r.cheatFlag.switchNum!==null?r.cheatFlag.switchNum:-1,reExamRule:r.reExam.allowed.reRule,reExamNumber:r.reExam.allowed.reRule===2?r.reExam.allowed.reNum:0,scoreRule:r.reExam.allowed.record,viewRule:r.reExam.allowed.viewRule,proportional:r.questionsMode===2&&r.isOpenDrawQuestions?r.proportional:[],anonymousMarking:"".concat(r.markType.anonymousMarking),show_result:r.reExam.show_result};break;case"AddNewExam":var f=i.data,v=f.paperInfo,m=f.exam_times,M=f.cut_screen_times,w=f.random_order,W=f.mark_setting,O=f.result_visible,ne=f.face_recognition,re=(0,L.Z)(f,["paperInfo","exam_times","cut_screen_times","random_order","mark_setting","result_visible","face_recognition"]);k={courseSort:n,flag:15,courseType:15,type:"ex",courseId:i.id,mappingId:i.mappingId?i.mappingId:"",new_exam:(0,c.Z)((0,c.Z)((0,c.Z)({},re),(0,d.jJ)(ne)),{},{paper_id:v.id,answer_rule:m.answer_rule,exam_count:m.exam_count||1,cut_screen_rule:M.cut_screen_rule,cut_screen_count:M.cut_screen_count||1,cut_screen_interval:M.cut_screen_interval||0,random_question:w.random_question,random_options:w.random_options,mark_type:W.mark_type,mark_question_type:{fill_blank:W.mark_type===d.lt.MANUAL?W.fill_blank:!1,short_answer:W.mark_type===d.lt.MANUAL?W.short_answer:!1},anonymous_marking:W.anonymous_marking,exam_certificate_id:"",supervisor_list:[],marker_list:[...W.marker_list.map(K=>typeof K=="string"?K:K.id)],result_view_rule:O.result_view_rule,answer_parsing:O.answer_parsing,ranking_list_view_rule:O.ranking_list_view_rule,show_result:O.show_result,reward_rule:null,authority_range:null,supervisor_mark:null})};break;case"OfflineTrain":k={courseSort:n,flag:3,id:u&&!p?i.id:"",type:"xx",mappingId:i.mappingId?i.mappingId:"",title:r.title,begin_time:C()(r.dateRange.startTime).valueOf(),end_time:C()(r.dateRange.endTime).valueOf(),attachment:r.attachment.map(K=>K.id),course_duration:r.course_duration||"",lecturer_id:r.teacher.id,is_lecturer_confirm:!!r.teacher.is_lecturer_confirm,is_lecturer_subsidy:!!r.teacher.is_lecturer_subsidy,address:r.address,introduction:r.introduction,is_open_offline_assessment:r.assess.is_open_offline_assessment,is_open_upload:r.other.is_open_upload,is_open_schedule:!1,remind_type:r.remind.remind_type,advance_minute:r.remind.advance_minute?Number(r.remind.advance_minute):0,is_lecturer_remind:r.remind.is_lecturer_remind,is_student_remind:r.remind.is_student_remind,is_lecturer_student_evaluate:r.evaluate.is_lecturer_student_evaluate,is_student_lecturer_evaluate:r.evaluate.is_student_lecturer_evaluate,is_student_course_evaluate:r.evaluate.is_student_course_evaluate,lecturer_student_evaluate_content:r.evaluate.lecturer_student_evaluate_content,student_lecturer_evaluate_content:r.evaluate.student_lecturer_evaluate_content,student_course_evaluate_content:r.evaluate.student_course_evaluate_content,assessment_total_score:r.assess.assessment_total_score,assessment_pass_score:r.assess.assessment_pass_score};break;case"AddInvestigate":E==="study"?k={courseSort:n,courseType:9,flag:4,id:i.id,questionnaireId:i.questionnaire.id,title:i.name,type:"questionnaire",mappingId:i.mappingId?i.mappingId:""}:k={courseId:i.id,courseType:9,flag:9,courseSort:n,investigate:{id:i.id,title:i.name,questionnaire_id:i.questionnaire.id}};break;case"AddPracticeTest":k={courseType:10,courseSort:n,flag:E==="study"?5:4,type:"sc",id:i.id,title:i.data.title,content:i.data.content||i.data.address,resources:i.data.attachment.map(K=>({resourceId:K.id})),scoreSetting:{scoreSwitch:i.data.mark.isFull?"on":"off",score:i.data.mark.value},workflowJson:i.data.workFlowTemplateId?{}:X(i.data.supervisor),mappingId:i.mappingId?i.mappingId:"",job_type:i.data.job_type,workFlowTemplateId:i.data.workFlowTemplateId};break;case"AddJobEvaluation":k={courseSort:n,flag:6,title:i.data.title,productId:i.data.evaluationTools.product_id,modelId:i.data.evaluationTools.model_id,id:i.id||"",mappingId:i.mappingId?i.mappingId:""};break;case"Attendance":k={courseSort:n,flag:13,id:u&&!p?i.id:"",type:"attendance",mappingId:i.mappingId?i.mappingId:"",title:r.title,directors:r.directors.map(K=>typeof K=="object"&&(K.id||K.user_id)?K.id||K.user_id:K),name:r.name,qrcode_type:r.qrcode_type||"statics",sign_in_begin_time:r.sign_in_begin_time?C()(r.sign_in_begin_time).valueOf():"",sign_in_end_time:r.sign_in_end_time?C()(r.sign_in_end_time).valueOf():"",sign_out_begin_time:r.sign_out_begin_time?C()(r.sign_out_begin_time).valueOf():"",sign_out_end_time:r.sign_out_end_time?C()(r.sign_out_end_time).valueOf():"",relate_course:r.relate_course,relate_course_list:((l=r.relate_course_list)===null||l===void 0?void 0:l.length)>0?r.relate_course_list:[],remind_directors:r.remind_directors,advance_minute:r.advance_minute||0,qy_we_chat_vo:r.qy_we_chat_vo,address:r.address,longitude:r.longitude,latitude:r.latitude,address_detail:r.address_detail,sign_range:r.sign_range};break;case"AddAssessment":k=(0,c.Z)((0,c.Z)({},Q(i.data)),{},{tutorId:a,courseSort:n,courseType:14,flag:14});break;default:break}return h==="unlock_mode"&&r.unlockingTime&&(k.unlockingTime=C()(r.unlockingTime).valueOf()),k.resource_lock=i.resource_lock||!1,k});return{content:t.desc,stageName:t.name,isOrder:t.inOrder,stageSort:I+1,stageId:u?t.stageId:"",startTime:h==="unlock_mode"&&t.studyTime?C()(t.studyTime[0]).valueOf():null,endTime:h==="unlock_mode"&&t.studyTime?C()(t.studyTime[1]).valueOf():null,course:A}});return e},G=s=>{var u=s.map((E,h)=>({content:E.desc,stage_name:E.name,is_order:E.inOrder,stage_sort:h+1,stage_id:E.stageId,resources:E.list.map((p,a)=>{var e=p.data;switch(p.componentName){case"CoursewareSelector":return{course_id:p.id,course_sort:a,course_type:3,flag:1,mappingId:p.mappingId};case"AddMentorCoaching":return{course_id:p.id,tutorials:{id:p.id,title:e.title,content:e.content,model:e.model,tutor_model:e.tutor_model,evaluation_type:e.evaluation_type,user_id:e.user_id||"",user_name:e.user_name||""},course_sort:a,course_type:12,flag:7,mappingId:p.mappingId};case"CourseSelector":return{course_id:p.id,course_sort:a,course_type:1,flag:1,mappingId:p.mappingId};case"AddExam":return{exam:{id:p.id,title:e.title,cheat_flag:e.cheatFlag.isChecked?1:0,exam_duration:e.examDuration,face_recognition:e.cheatFlag.faceRecognition,summary:e.summary,mark_type:S(e.markType),paper_id:e.questionsMode===1?e.fixedQuestion.id:"",paper_name:e.questionsMode===1?e.fixedQuestion.name:"",pass_line:e.passLine,question_banks:e.questionsMode===1?"":e.randomQuestion.bankQuesitonVoList.map(v=>v.id),question_mode:e.questionsMode,show_knowledge:e.knowledgePoints===1?"show":"hide",repeat_exam:e.reExam.isChecked,multiple_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.multipleCount,multiple_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.multipleScore,fill_blank_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.fillBlankCount,fill_blank_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.fillBlankScore,fill_blank_type:e.questionsMode===1?1:e.randomQuestion.bankQuesitonInfo.fillBlankType,short_answer_type:e.questionsMode===1?1:e.randomQuestion.bankQuesitonInfo.shortAnswerType,short_answer_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.shortAnswerCount,short_answer_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.shortAnswerScore,single_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.singleCount,single_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.singleScore,multiple_missed_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.multipleMissedScore,true_or_false_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.trueOrFalseCount,true_or_false_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.trueOrFalseScore,total_score:e.questionsMode===1?e.fixedQuestion.tableList.totalScore:"",answer_parsing:e.reExam.isChecked?e.reExam.allowed.end:e.reExam.notAllowed.end,passing_score:e.questionsMode===1?Number(e.fixedQuestion.tableList.totalScore*e.passLine/100).toFixed(1):60,cut_screen_count:e.cheatFlag.switchNum!==null?e.cheatFlag.switchNum:-1,re_exam_rule:e.reExam.allowed.reRule,re_exam_number:e.reExam.allowed.reRule===2?e.reExam.allowed.reNum:0,score_rule:e.reExam.allowed.record,view_rule:e.reExam.allowed.viewRule,proportional:e.questionsMode===2&&e.isOpenDrawQuestions?e.proportional:[],anonymous_marking:"".concat(e.markType.anonymousMarking),show_result:e.reExam.show_result},flag:2,course_sort:a,course_id:p.id,course_type:6,mappingId:p.mappingId};case"AddNewExam":var t=p.data,I=t.paperInfo,A=t.exam_times,i=t.cut_screen_times,n=t.random_order,l=t.mark_setting,r=t.result_visible,k=t.face_recognition,f=(0,L.Z)(t,["paperInfo","exam_times","cut_screen_times","random_order","mark_setting","result_visible","face_recognition"]);return{course_sort:a,flag:15,type:"ex",course_id:p.id,course_type:15,mappingId:p.mappingId?p.mappingId:"",new_exam:(0,c.Z)((0,c.Z)((0,c.Z)({},f),(0,d.jJ)(k)),{},{paper_id:I.id,answer_rule:A.answer_rule,exam_count:A.exam_count||1,cut_screen_rule:i.cut_screen_rule,cut_screen_count:i.cut_screen_count||1,cut_screen_interval:i.cut_screen_interval||0,random_question:n.random_question,random_options:n.random_options,mark_type:l.mark_type,mark_question_type:{fill_blank:l.mark_type===d.lt.MANUAL?l.fill_blank:!1,short_answer:l.mark_type===d.lt.MANUAL?l.short_answer:!1},anonymous_marking:l.anonymous_marking,exam_certificate_id:"",supervisor_list:[],marker_list:[...l.marker_list.map(v=>typeof v=="string"?v:v.id)],result_view_rule:r.result_view_rule,answer_parsing:r.answer_parsing,ranking_list_view_rule:r.ranking_list_view_rule,show_result:r.show_result,reward_rule:null,authority_range:null,supervisor_mark:null})};case"AddPracticeTest":return{operation:{id:p.id,title:p.data.title,content:p.data.content||p.data.address,type:"sc",resources:p.data.attachment.map(v=>({resourceId:v.id})),score_setting:{scoreSwitch:p.data.mark.isFull?"on":"off",score:p.data.mark.value},workflow_json:X(p.data.supervisor),sort:a,job_type:p.data.job_type},course_type:10,course_sort:a,flag:5,mappingId:p.mappingId};case"AddInvestigate":return{course_id:p.id,course_type:9,flag:4,course_sort:a,investigate:{id:p.id,title:p.name,questionnaire_id:p.questionnaire.id}};default:return null}})}));return u};function X(s){var u=[];if(s.type==="multilevel"){var E=s.multilevel;E.forEach(h=>{var p=[];h.forEach(a=>{p.push(a.id)}),u.push(p.join(","))})}else s.type==="or"?(s.or.forEach(h=>{u.push(h.id)}),u=[u.join(",")]):u=[];return{type:s.type,userIds:u}}var T=s=>{function u(a){if(a.questionMode===1){if(a.paperVo.fillBlankCount>0||a.paperVo.shortAnswerCount>0)return!0}else if(a.fillBlankCount>0||a.shortAnswerCount>0)return!0;return!1}function E(a){if(a.questionMode===1){if(a.paperVo.fillBlankCount>0)return!0}else if(a.fillBlankCount>0)return!0;return!1}function h(a){if(a.questionMode===1){if(a.paperVo.shortAnswerCount>0)return!0}else if(a.shortAnswerCount>0)return!0;return!1}var p=s.map((a,e)=>({key:"".concat(new Date().getTime()).concat(e),desc:a.content,name:a.stageName,inOrder:a.isOrder,stageId:a.id,studyTime:a.startTime?[C()(a.startTime),C()(a.endTime)]:["",""],list:a.courseMappingList.map(t=>{var I,A,i=t.planExamVos,n={},l,r;switch(t.flag){case 1:t.contentType==="audio/mp3"||t.contentType==="audio/mpeg"||t.contentType==="audio"?(r="mp3",l="mp3"):(r=t.type,l=t.type==="imageText"?"h5":t.type),n={id:t.courseId,name:t.name,type:t.courseType===1?"course":"courseware",icon:o.e1[l],originalType:r,componentName:t.courseType===1?"CourseSelector":"CoursewareSelector",status:t.courseType===1?"0":t.status,duration:t.duration,data:t,mappingId:t.mappingId};break;case 2:n={id:t.id,name:t.name,type:"ex",icon:o.e1.ex,componentName:"AddExam",duration:i.examDuration*60,data:{title:i.title,examDuration:i.examDuration,summary:i.summary,isOpenDrawQuestions:i.proportionalExamVos&&i.proportionalExamVos.length>0,proportional:i.proportionalExamVos&&(i.proportionalExamVos.length>0?g(i.proportionalExamVos,i.bankQuesitonVoList):i.questionMode===2?y(i.bankQuesitonVoList):[])||[],cheatFlag:{isChecked:!!i.cheatFlag,switchNum:i.cutScreenCount===-1?null:i.cutScreenCount,faceRecognition:i.faceRecognition},reExam:{show_result:i.show_result,isChecked:i.repeatExam,userJoin:i.user_join==="true",notAllowed:{end:i.answerParsing},allowed:{reRule:i.reExamRule,record:i.scoreRule,end:i.answerParsing,reNum:i.reExamRule===2?i.reExamNumber:1,viewRule:i.viewRule}},markType:{checkedValue:i.markType===1?1:2,artificialDisabled:i.markType===1&&!u(i),fillBlank:{checked:(i.markType===2||i.markType===3)&&E(i),disabled:!E(i)},shortAnswer:{checked:(i.markType===2||i.markType===4)&&h(i),disabled:!h(i)},anonymousMarking:i.anonymous_marking==="true"},questionsMode:i.questionMode,knowledgePoints:i.showKnowledge==="show"?1:2,passLine:i.passLine,fixedQuestion:i.questionMode===1?{id:i.paperVo.id,name:i.paperVo.title,tableList:{fillBlankCount:i.paperVo.fillBlankCount,fillBlankScore:i.paperVo.fillBlankScore,multipleCount:i.paperVo.multipleCount,multipleScore:i.paperVo.multipleScore,shortAnswerCount:i.paperVo.shortAnswerCount,shortAnswerScore:i.paperVo.shortAnswerScore,singleCount:i.paperVo.singleCount,singleScore:i.paperVo.singleScore,totalCount:i.paperVo.totalCount,totalScore:i.paperVo.totalScore,trueOrFalseCount:i.paperVo.trueOrFalseCount,trueOrFalseScore:i.paperVo.trueOrFalseScore}}:{id:"",name:"",tableList:{fillBlankCount:0,fillBlankScore:0,multipleCount:0,multipleScore:0,shortAnswerCount:0,shortAnswerScore:0,singleCount:0,singleScore:0,totalCount:0,totalScore:0,trueOrFalseCount:0,trueOrFalseScore:0}},randomQuestion:i.questionMode===2?{bankQuesitonVoList:i.bankQuesitonVoList.map(W=>({id:W.id,name:W.name,data:W})),bankQuesitonInfo:{fillBlankCount:i.fillBlankCount,fillBlankScore:i.fillBlankUnitScore,fillBlankType:+i.fillBlankType||1,multipleCount:i.multipleCount,multipleScore:i.multipleUnitScore,shortAnswerCount:i.shortAnswerCount,shortAnswerScore:i.shortAnswerUnitScore,shortAnswerType:+i.shortAnswerType||1,singleCount:i.singleCount,singleScore:i.singleUnitScore,trueOrFalseCount:i.trueOrFalseCount,trueOrFalseScore:i.trueOrFalseUnitScore,multipleMissedScore:i.multipleMissedScore}}:{bankQuesitonVoList:[],bankQuesitonInfo:{fillBlankCount:0,fillBlankScore:0,fillBlankType:1,multipleCount:0,multipleScore:0,shortAnswerCount:0,shortAnswerScore:0,shortAnswerType:1,singleCount:0,singleScore:0,trueOrFalseCount:0,trueOrFalseScore:0,multipleMissedScore:0}}},mappingId:t.mappingId,isExamEdit:t.isExamEdit};break;case 3:var k=t.offline_course_vo;n={id:t.id,name:t.name,type:"xx",componentName:"OfflineTrain",icon:o.e1.xx,data:(0,c.Z)({},V(k)),mappingId:t.mappingId};break;case 4:case 5:if(t.type==="sc"||t.type==="operation"){n={id:t.id,name:t.title,type:"sc",icon:o.e1.sc,componentName:"AddPracticeTest",data:(0,x.UI)("PRIVACY_HLS_APPROVAL_MANAGE")?U(t):q(t),mappingId:t.mappingId};break}n={id:t.courseId,name:t.title||t.name,type:"investigate",icon:o.e1.questionnaire,componentName:"AddInvestigate",data:t,mappingId:t.mappingId,questionnaire:{id:t.questionnaireId,name:t.name}};break;case 6:n={id:t.evaluation.id,name:t.evaluation.title,productId:t.evaluation.product_id,modelId:t.evaluation.model_id,type:"jobEvaluation",icon:o.e1.jobEvaluation,componentName:"AddJobEvaluation",data:{title:t.evaluation.title,evaluationTools:{product_id:t.evaluation.product_id,model_id:t.evaluation.model_id}},mappingId:t.mappingId};break;case 7:n={id:t.id,name:t.tutorials.title,type:"tutor",icon:o.e1.tutor,componentName:"AddMentorCoaching",data:(0,c.Z)((0,c.Z)({},t.tutorials),{},{tutor_model:t.tutorials.tutorModel,evaluation_type:t.tutorials.evaluationType,user_id:t.tutorials.userId,user_name:t.tutorials.userName}),mappingId:t.mappingId};break;case 9:n={id:t.courseId,name:t.title,type:"investigate",icon:o.e1.questionnaire,componentName:"AddInvestigate",data:t,questionnaire:{id:t.questionnaireId,name:t.name}};break;case 13:var f=t.course_sign_vo;n={id:t.id,name:t.name,type:"attendance",componentName:"Attendance",icon:o.e1.attendance,data:(0,c.Z)({},j(f)),mappingId:t.mappingId};break;case 14:n={id:(t==null||(I=t.evaluate)===null||I===void 0?void 0:I.id)||"",name:(t==null||(A=t.evaluate)===null||A===void 0?void 0:A.name)||"",type:"assess",componentName:"AddAssessment",icon:o.e1.assess,data:(0,c.Z)({},z(t.evaluate)),resource_lock:t.resource_lock};break;case 15:{var v=(0,J.Qm)()._store,m=v.getState(),M=m.user,w=(0,d.AC)({data:t.exam_plan_detail_v1,user:{id:M.id,name:M.name,creator:!0}});n={id:t.exam_plan_detail_v1.id,name:t.exam_plan_detail_v1.title,type:"ex",icon:o.e1.ex,componentName:"AddNewExam",duration:t.exam_plan_detail_v1.exam_duration*60,data:w,mappingId:t.mappingId,isExamEdit:t.isExamEdit}}default:break}return n.data&&(n.data.unlockingTime=t.unlockingTime?C()(t.unlockingTime):""),n.resource_lock=t.resource_lock,n})}));return p};function U(s){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"resources";return s.supervisor={lead:"",multilevel:[],or:[],type:"or"},s.mark={isFull:s.scoreSetting.score_switch==="on",value:s.scoreSetting.score_switch==="on"?s.scoreSetting.score:100},s.attachment=s[u],s}function q(s){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"resources",E=[],h=[];return s.workflowJson.type==="or"?s.workflowJson.nodeList[0].forEach(p=>{E.push({type:2,id:p.id,name:p.name,show:!0,unionid:p.unionid,user_id:p.sync_user_id,source_type:p.source_type||p.sourceType})}):s.workflowJson.type==="multilevel"&&s.workflowJson.nodeList.forEach(p=>{p.forEach(a=>{a.user_id=a.sync_user_id}),h.push(p)}),s.supervisor={or:E,multilevel:h,lead:"",type:s.workflowJson.type},s.mark={isFull:s.scoreSetting.score_switch==="on",value:s.scoreSetting.score_switch==="on"?s.scoreSetting.score:100},s.attachment=s[u],s}var P=(s,u)=>{var E=s.map((h,p)=>({id:h.id?h.id:"",content:h.desc,stage_name:h.name,is_order:u==="free_mode"?!1:h.inOrder,sort:p+1,progress:h.Standard.progressCheck?h.Standard.progress:"",exam_times:h.Standard.examCheck?h.Standard.examNum:"",practice_times:h.Standard.bankCheck?h.Standard.bankNum:"",operation_times:h.Standard.practiceCheck?h.Standard.practiceNum:"",finish_evaluation:h.Standard.jobEvaluationCheck?"true":"false",is_get_score:h.reward.getScoreChecked?h.reward.getScore:"",certificate_id:h.reward.certificateChecked?h.reward.certificateId:"",resources:h.list.map((a,e)=>{var t=a.data;switch(a.componentName){case"CoursewareSelector":return{course_id:a.id,replaced_old_id:a.replaced_old_id===a.id?"":a.replaced_old_id,sort:e,type:3,lab_resource_id:a.lab_resource_id,lab_resource_name:a.lab_resource_name,resource_lock:a.resource_lock||!1,unlocking_time:u==="unlock_mode"?null:C()(a.unlocking_time).valueOf()};case"ClNewUpload":case"CourseSelector":return{course_id:a.id,replaced_old_id:a.replaced_old_id||"",sort:e,type:1,lab_resource_id:a.lab_resource_id,lab_resource_name:a.lab_resource_name,resource_lock:a.resource_lock||!1,unlocking_time:u==="unlock_mode"?null:C()(a.unlocking_time).valueOf()};case"LiveClass":return{course_id:a.id,replaced_old_id:a.replaced_old_id||"",sort:e,type:16,lab_resource_id:a.lab_resource_id,lab_resource_name:a.lab_resource_name,resource_lock:a.resource_lock||!1,unlocking_time:u==="unlock_mode"?null:C()(a.unlocking_time).valueOf()};case"AddExam":return{type:6,sort:e,course_id:a.id,exam:{title:t.title,cheat_flag:t.cheatFlag.isChecked?1:0,exam_duration:t.examDuration,face_recognition:t.cheatFlag.faceRecognition,summary:t.summary,mark_type:S(t.markType),paper_id:t.questionsMode===1?t.fixedQuestion.id:"",pass_line:t.passLine,question_banks:t.questionsMode===1?[]:t.randomQuestion.bankQuesitonVoList.map(m=>m.id),question_mode:t.questionsMode,show_knowledge:t.knowledgePoints===1?"show":"hide",repeat_exam:t.reExam.isChecked,multiple_count:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.multipleCount,multiple_unit_score:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.multipleScore,fill_blank_count:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.fillBlankCount,fill_blank_unit_score:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.fillBlankScore,fill_blank_type:t.questionsMode===1?1:t.randomQuestion.bankQuesitonInfo.fillBlankType,short_answer_count:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.shortAnswerCount,short_answer_unit_score:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.shortAnswerScore,short_answer_type:t.questionsMode===1?1:t.randomQuestion.bankQuesitonInfo.shortAnswerType,single_count:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.singleCount,single_unit_score:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.singleScore,true_or_false_count:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.trueOrFalseCount,true_or_false_unit_score:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.trueOrFalseScore,multiple_missed_score:t.questionsMode===1?"":t.randomQuestion.bankQuesitonInfo.multipleMissedScore,total_score:t.questionsMode===1?t.fixedQuestion.tableList.totalScore:"",answer_parsing:t.reExam.isChecked?t.reExam.allowed.end:t.reExam.notAllowed.end,passing_score:t.questionsMode===1?Number(t.fixedQuestion.tableList.totalScore*t.passLine/100).toFixed(1):60,cut_screen_count:t.cheatFlag.switchNum!==null?t.cheatFlag.switchNum:-1,re_exam_rule:t.reExam.allowed.reRule,re_exam_number:t.reExam.allowed.reRule===2?t.reExam.allowed.reNum:0,score_rule:t.reExam.allowed.record,view_rule:t.reExam.allowed.viewRule,proportional:t.questionsMode===2&&t.isOpenDrawQuestions?t.proportional:[],anonymous_marking:"".concat(t.markType.anonymousMarking),show_result:t.reExam.show_result},resource_lock:a.resource_lock||!1,unlocking_time:u==="unlock_mode"?null:C()(a.unlocking_time).valueOf()};case"AddNewExam":var I=a.data,A=I.paperInfo,i=I.exam_times,n=I.cut_screen_times,l=I.random_order,r=I.mark_setting,k=I.result_visible,f=I.face_recognition,v=(0,L.Z)(I,["paperInfo","exam_times","cut_screen_times","random_order","mark_setting","result_visible","face_recognition"]);return{type:15,sort:e,course_id:a.id,new_exam:(0,c.Z)((0,c.Z)((0,c.Z)({},v),(0,d.jJ)(f)),{},{paper_id:A.id,answer_rule:i.answer_rule,exam_count:i.exam_count||1,cut_screen_rule:n.cut_screen_rule,cut_screen_count:n.cut_screen_count||1,cut_screen_interval:n.cut_screen_interval||0,random_question:l.random_question,random_options:l.random_options,mark_type:r.mark_type,mark_question_type:{fill_blank:r.mark_type===d.lt.MANUAL?r.fill_blank:!1,short_answer:r.mark_type===d.lt.MANUAL?r.short_answer:!1},anonymous_marking:r.anonymous_marking,exam_certificate_id:"",supervisor_list:[],marker_list:[...r.marker_list.map(m=>typeof m=="string"?m:m.id)],result_view_rule:k.result_view_rule,answer_parsing:k.answer_parsing,ranking_list_view_rule:k.ranking_list_view_rule,show_result:k.show_result,reward_rule:null,authority_range:null,supervisor_mark:null}),resource_lock:a.resource_lock||!1,unlocking_time:u==="unlock_mode"?null:C()(a.unlocking_time).valueOf()};case"OfflineTrain":return{sort:e,type:7,course_id:a.id,offline_course:{id:t.id,title:t.title,begin_time:C()(t.dateRange.startTime).valueOf(),end_time:C()(t.dateRange.endTime).valueOf(),attachment:t.attachment.map(m=>m.id),course_duration:t.course_duration||"",lecturer_id:t.teacher.id,is_lecturer_confirm:!!t.teacher.is_lecturer_confirm,is_lecturer_subsidy:!!t.teacher.is_lecturer_subsidy,address:t.address,introduction:t.introduction,is_open_offline_assessment:t.assess.is_open_offline_assessment,is_open_upload:t.other.is_open_upload,is_open_schedule:!1,remind_type:t.remind.remind_type,advance_minute:t.remind.advance_minute?Number(t.remind.advance_minute):0,is_lecturer_remind:t.remind.is_lecturer_remind,is_student_remind:t.remind.is_student_remind,is_director_remind:t.remind.is_director_remind,is_lecturer_student_evaluate:t.evaluate.is_lecturer_student_evaluate,is_student_lecturer_evaluate:t.evaluate.is_student_lecturer_evaluate,is_student_course_evaluate:t.evaluate.is_student_course_evaluate,lecturer_student_evaluate_content:t.evaluate.lecturer_student_evaluate_content,student_lecturer_evaluate_content:t.evaluate.student_lecturer_evaluate_content,student_course_evaluate_content:t.evaluate.student_course_evaluate_content,assessment_total_score:t.assess.assessment_total_score,assessment_pass_score:t.assess.assessment_pass_score},resource_lock:a.resource_lock||!1,unlocking_time:u==="unlock_mode"?null:C()(a.unlocking_time).valueOf()};case"AddInvestigate":return{sort:e,type:9,course_id:a.id||"",questionnaire_id:a.questionnaire.id,resource_lock:a.resource_lock||!1,title:a.name,unlocking_time:u==="unlock_mode"?null:C()(a.unlocking_time).valueOf()};case"AddPracticeTest":return{type:10,courseSort:e,sort:e,flag:4,course_id:a.id,title:a.data.title,content:a.data.content||a.data.address,resources:a.data.attachment.map(m=>({resourceId:m.id})),scoreSetting:{scoreSwitch:a.data.mark.isFull?"on":"off",score:a.data.mark.value},workflowJson:X(a.data.supervisor),job_type:a.data.job_type,resource_lock:a.resource_lock||!1,unlocking_time:u==="unlock_mode"?null:C()(a.unlocking_time).valueOf()};case"AddJobEvaluation":return{sort:e,flag:6,type:11,evaluation:{id:a.id||"",title:a.data.title,product_id:a.data.evaluationTools.product_id,model_id:a.data.evaluationTools.model_id},resource_lock:a.resource_lock||!1,unlocking_time:u==="unlock_mode"?null:C()(a.unlocking_time).valueOf()};case"Attendance":return{sort:e,type:13,course_id:a.id,sign:{id:t.id,type:13,title:t.title,directors:t.directors.map(m=>typeof m=="object"&&(m.id||m.user_id)?m.id||m.user_id:m),name:t.name||"--",qrcode_type:t.qrcode_type,sign_in_begin_time:t.sign_in_begin_time,sign_in_end_time:t.sign_in_end_time,sign_out_begin_time:t.sign_out_begin_time,sign_out_end_time:t.sign_out_end_time,relate_course:t.relate_course,relate_course_list:t.relate_course_list,remind_directors:t.remind_directors,advance_minute:t.advance_minute,qy_we_chat_vo:t.qy_we_chat_vo,address:t.address,longitude:t.longitude,latitude:t.latitude,address_detail:t.address_detail,sign_range:t.sign_range},resource_lock:a.resource_lock||!1,unlocking_time:u==="unlock_mode"?null:C()(a.unlocking_time).valueOf()};case"AddAssessment":return{sort:e,type:14,course_id:a.id,resource_lock:a.resource_lock||!1,unlocking_time:u==="unlock_mode"?null:C()(a.unlocking_time).valueOf(),evaluateVo:{id:t.id,name:t.name,requirement:t.requirement,resource_id:t.resource_id,is_lock:t.is_lock,begin_time_unlock:t.begin_time_unlock,end_time_unlock:t.end_time_unlock,is_self_evaluate:t.is_self_evaluate,questionnaire_id:t.questionnaire_id,evaluate_form_title:t.evaluate_form_title,before_start_day:t.before_start_day,before_start_repeat:t.before_start_repeat,before_start_un_remind:t.before_start_un_remind,before_end_day:t.before_end_day,before_end_repeat:t.before_end_repeat,before_end_un_remind:t.before_end_un_remind,after_end_day:t.after_end_day,after_end_repeat:t.after_end_repeat,after_end_un_remind:t.after_end_un_remind,is_passed_standards:t.is_passed_standards,is_passed_option_three:t.is_passed_option_three,pass_standard_conditions:t.pass_standard_conditions,pass_standards_number:t.pass_standards_number,creator_user:t.creator_user}};case"AddPracticeBank":return{sort:e,type:17,course_id:a.id,resource_name:a.title,resource_lock:a.resource_lock||!1,unlocking_time:u==="unlock_mode"?null:C()(a.unlocking_time).valueOf(),practice:{title:a.data.title,question_bank_list:a.data.randomQuestion.bankQuesitonVoList.map(m=>m.id),pass_line:Number(a.data.stand)}};default:return null}})}));return E},D=function(u,E){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;function p(e){return e.fill_blank_count>0||e.short_answer_count>0}var a=u.map((e,t)=>{var I=e.resources.filter(n=>n.type==6||n.type==15).length,A=e.resources.filter(n=>n.type==17).length,i=e.resources.filter(n=>n.type==10).length;return{id:e.id,key:"".concat(new Date().getTime()).concat(t),desc:e.content,name:e.stage_name,inOrder:e.is_order,Standard:{progressCheck:e.progress>0,progress:e.progress||100,examCheck:e.exam_times>0,examNum:e.exam_times||I,bankCheck:e.practice_times>0,bankNum:e.practice_times||A,practiceCheck:e.operation_times>0,practiceNum:e.operation_times||i,jobEvaluationCheck:e.finish_evaluation==="true"},reward:{getScore:e.is_get_score?e.is_get_score:"",getScoreChecked:e.is_get_score>0,certificateId:e.certificate_id||"",certificateChecked:e.certificate_id!==0,certificateName:e.certificate_name,certificateImage:e.preview_url},hourClassId:e.id,hourClassStartTime:e.start_time,hourClassEndTime:e.end_time,list:e.resources.map(n=>{var l=n.exam;switch(n.type){case 1:return{id:n.course_id,name:n.resource_name,type:h&&n.biz_type==="imageText"?"twCourse":"course",icon:n.biz_type==="imageText"?o.e1.h5:o.e1.crs,componentName:"CourseSelector",duration:n.duration,data:n,unlocking_time:n.unlocking_time,lab_resource_id:n.lab_resource_id,lab_resource_name:n.lab_resource_name,lab_selected_id:n.lab_resource_id,resource_lock:n.resource_lock};case 3:{var r;return n.content_type==="article"||n.content_type==="link"?r=o.e1.h5:r=o.e1[n.contentType]||o.e1[n.content_type],{id:n.course_id,name:n.resource_name,type:"courseware",icon:r,componentName:"CoursewareSelector",duration:n.duration,status:n.resource_status,originalType:n.content_type==="article"||n.content_type==="link"?"h5":n.content_type||n.contentType,data:n,unlocking_time:n.unlocking_time,lab_resource_id:n.lab_resource_id,lab_resource_name:n.lab_resource_name,lab_selected_id:n.lab_resource_id,resource_lock:n.resource_lock}}case 6:return{id:n.course_id,name:l.title,type:"ex",icon:o.e1.ex,componentName:"AddExam",duration:l.exam_duration*60,data:{id:l.id,title:l.title,examDuration:l.exam_duration,summary:l.summary,isOpenDrawQuestions:l.proportionalExamVos&&l.proportionalExamVos.length>0,proportional:l.proportionalExamVos&&(l.proportionalExamVos.length>0?g(l.proportionalExamVos,l.question_bank_vos):l.question_mode===2?y(l.question_bank_vos):[])||[],cheatFlag:{isChecked:!!l.cheat_flag,switchNum:l.cut_screen_count===-1?null:l.cut_screen_count,faceRecognition:l.face_recognition},reExam:{show_result:l.show_result,isChecked:l.repeat_exam,userJoin:E?!1:l.user_join==="true",notAllowed:{end:l.answer_parsing},allowed:{reRule:l.re_exam_rule,record:l.score_rule,end:l.answer_parsing,reNum:l.re_exam_rule===2?l.re_exam_number:1,viewRule:l.view_rule}},markType:{checkedValue:l.mark_type===1?1:2,artificialDisabled:l.mark_type===1&&!p(l),fillBlank:{checked:(l.mark_type===2||l.mark_type===3)&&l.fill_blank_count,disabled:!l.fill_blank_count},shortAnswer:{checked:(l.mark_type===2||l.mark_type===4)&&l.short_answer_count,disabled:!l.short_answer_count},anonymousMarking:l.anonymous_marking==="true"},questionsMode:l.question_mode,knowledgePoints:l.show_knowledge==="show"?1:2,passLine:l.pass_line,fixedQuestion:l.question_mode===1?{id:l.paper_id,name:l.paper_name,tableList:{fillBlankCount:l.fill_blank_count,fillBlankScore:l.fill_blank_unit_score,multipleCount:l.multiple_count,multipleScore:l.multiple_unit_score,shortAnswerCount:l.short_answer_count,shortAnswerScore:l.short_answer_unit_score,singleCount:l.single_count,singleScore:l.single_unit_score,totalCount:l.total_count,totalScore:l.total_score,trueOrFalseCount:l.true_or_false_count,trueOrFalseScore:l.true_or_false_unit_score}}:{id:"",name:"",tableList:{fillBlankCount:0,fillBlankScore:0,multipleCount:0,multipleScore:0,shortAnswerCount:0,shortAnswerScore:0,singleCount:0,singleScore:0,totalCount:0,totalScore:0,trueOrFalseCount:0,trueOrFalseScore:0}},randomQuestion:l.question_mode===2?{bankQuesitonVoList:l.question_bank_vos.map(w=>{var W=w.fill_blank_count,O=w.multiple_count,ne=w.short_answer_count,re=w.single_count,K=w.total_count,se=w.true_or_false_count,oe={fillBlankCount:W,shortAnswerCount:ne,multipleCount:O,singleCount:re,totalCount:K,trueOrFalseCount:se};return{id:w.id,name:w.name,data:Object.assign(w,oe),fillBlankCount:W,shortAnswerCount:ne,multipleCount:O,singleCount:re,totalCount:K,trueOrFalseCount:se}}),bankQuesitonInfo:{fillBlankCount:l.fill_blank_count,fillBlankScore:l.fill_blank_unit_score,fillBlankType:+l.fillBlankType,multipleCount:l.multiple_count,multipleScore:l.multiple_unit_score,shortAnswerCount:l.short_answer_count,shortAnswerScore:l.short_answer_unit_score,shortAnswerType:+l.shortAnswerType,singleCount:l.single_count,singleScore:l.single_unit_score,trueOrFalseCount:l.true_or_false_count,trueOrFalseScore:l.true_or_false_unit_score,multipleMissedScore:l.multiple_missed_score}}:{bankQuesitonVoList:[],bankQuesitonInfo:{fillBlankCount:0,fillBlankScore:0,fillBlankType:1,multipleCount:0,multipleScore:0,shortAnswerCount:0,shortAnswerScore:0,shortAnswerType:1,singleCount:0,singleScore:0,trueOrFalseCount:0,trueOrFalseScore:0,multipleMissedScore:0}}},unlocking_time:n.unlocking_time,resource_lock:n.resource_lock};case 7:return{id:E?"":n.offlineCourseEditVo.id,name:n.offlineCourseEditVo.title,key:n.offlineCourseEditVo.id,type:"xx",componentName:"OfflineTrain",icon:o.e1.xx,data:(0,c.Z)({},V(n.offlineCourseEditVo,E)),unlocking_time:n.unlocking_time,resource_lock:n.resource_lock};case 9:return{id:n.course_id,name:n.title||n.resource_name,type:"investigate",icon:o.e1.questionnaire,componentName:"AddInvestigate",data:n,questionnaire:{id:n.questionnaire_id,name:n.resource_name},unlocking_time:n.unlocking_time,resource_lock:n.resource_lock};case 10:return{id:n.course_id,name:n.title,type:"sc",icon:o.e1.sc,componentName:"AddPracticeTest",data:q(n,"operationResources"),unlocking_time:n.unlocking_time,resource_lock:n.resource_lock};case 11:return{id:n.evaluation.id,name:n.evaluation.title,productId:n.evaluation.product_id,modelId:n.evaluation.model_id,type:"jobEvaluation",icon:o.e1.jobEvaluation,componentName:"AddJobEvaluation",data:{title:n.evaluation.title,evaluationTools:{product_id:n.evaluation.product_id,model_id:n.evaluation.model_id}},unlocking_time:n.unlocking_time,resource_lock:n.resource_lock};case 13:return{id:n.course_sign_vo.id,name:n.course_sign_vo.name,type:"attendance",componentName:"Attendance",icon:o.e1.attendance,data:(0,c.Z)({},j(n.course_sign_vo,E)),unlocking_time:n.unlocking_time,resource_lock:n.resource_lock};case 14:return{id:n.evaluate?n.evaluate.id:"",name:n.evaluate?n.evaluate.name:"",type:"assess",componentName:"AddAssessment",icon:o.e1.assess,data:(0,c.Z)({},z(n.evaluate)),resource_lock:n.resource_lock,unlocking_time:n.unlocking_time};case 15:{var k=(0,J.Qm)()._store,f=k.getState(),v=f.user,m=(0,d.AC)({data:n.exam_plan_detail_v1,user:{id:v.id,name:v.name,creator:!0}});return{id:n.exam_plan_detail_v1.id,name:n.exam_plan_detail_v1.title,type:"ex",icon:o.e1.ex,componentName:"AddNewExam",unlocking_time:n.unlocking_time,resource_lock:n.resource_lock,duration:n.exam_plan_detail_v1.exam_duration*60,data:m}}case 16:return{id:E?"":n.course_id,name:n.title,key:n.course_id,type:"liveClass",componentName:"LiveClass",icon:o.e1.liveClass,data:(0,c.Z)({},ie(n)),unlocking_time:n.unlocking_time,resource_lock:n.resource_lock};case 17:var M=(0,d.S8)(n.practice);return{id:n.course_id,name:n.resource_name,type:"practice",componentName:"AddPracticeBank",unlocking_time:n.unlocking_time,resource_lock:n.resource_lock,data:M};default:return null}})}});return a},N=s=>{var u=s.map((E,h)=>({content:E.desc,stage_name:E.name,order:"".concat(E.inOrder),sort:h+1,course:E.list.map((p,a)=>{var e=p.data;switch(p.componentName){case"CoursewareSelector":return{course_id:p.id,course_sort:a,course_type:3,flag:1};case"CourseSelector":return{course_id:p.id,course_sort:a,course_type:1,flag:1};case"AddExam":return{flag:2,type:"ex",course_sort:a,course_id:p.id,title:e.title,cheat_flag:e.cheatFlag.isChecked?1:0,exam_duration:e.examDuration,face_recognition:e.cheatFlag.faceRecognition,summary:e.summary,mark_type:S(e.markType),paper_id:e.questionsMode===1?e.fixedQuestion.id:"",paper_title:e.questionsMode===1?e.fixedQuestion.name:"",pass_line:e.passLine,question_bank_list:e.questionsMode===1?"":e.randomQuestion.bankQuesitonVoList.map(v=>v.id).join(","),question_mode:e.questionsMode,show_knowledge:e.knowledgePoints===1?"show":"hide",s_repeat_exam:"".concat(e.reExam.isChecked),multiple_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.multipleCount,multiple_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.multipleScore,fill_blank_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.fillBlankCount,fill_blank_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.fillBlankScore,fill_blank_type:e.questionsMode===1?1:e.randomQuestion.bankQuesitonInfo.fillBlankType,short_answer_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.shortAnswerCount,short_answer_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.shortAnswerScore,short_answer_type:e.questionsMode===1?1:e.randomQuestion.bankQuesitonInfo.shortAnswerType,single_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.singleCount,single_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.singleScore,true_or_false_count:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.trueOrFalseCount,true_or_false_unit_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.trueOrFalseScore,multiple_missed_score:e.questionsMode===1?"":e.randomQuestion.bankQuesitonInfo.multipleMissedScore,total_score:e.questionsMode===1?e.fixedQuestion.tableList.totalScore:"",answer_parsing:e.reExam.isChecked?e.reExam.allowed.end:e.reExam.notAllowed.end,passing_score:e.questionsMode===1?Number(e.fixedQuestion.tableList.totalScore*e.passLine/100).toFixed(1):60,cut_screen_count:e.cheatFlag.switchNum!==null?e.cheatFlag.switchNum:-1,re_exam_rule:e.reExam.allowed.reRule,re_exam_number:e.reExam.allowed.reRule===2?e.reExam.allowed.reNum:0,score_rule:e.reExam.allowed.record,view_rule:e.reExam.allowed.viewRule,proportional:e.questionsMode===2&&e.isOpenDrawQuestions?e.proportional:[],anonymous_marking:"".concat(e.markType.anonymousMarking),show_result:e.reExam.show_result};case"AddNewExam":var t=p.data,I=t.paperInfo,A=t.exam_times,i=t.cut_screen_times,n=t.random_order,l=t.mark_setting,r=t.result_visible,k=t.face_recognition,f=(0,L.Z)(t,["paperInfo","exam_times","cut_screen_times","random_order","mark_setting","result_visible","face_recognition"]);return{course_type:15,flag:15,type:"ex",course_sort:a,course_id:p.id,new_exam:(0,c.Z)((0,c.Z)((0,c.Z)({},f),(0,d.jJ)(k)),{},{paper_id:I.id,answer_rule:A.answer_rule,exam_count:A.exam_count||1,cut_screen_rule:i.cut_screen_rule,cut_screen_count:i.cut_screen_count||1,cut_screen_interval:i.cut_screen_interval||0,random_question:n.random_question,random_options:n.random_options,mark_type:l.mark_type,mark_question_type:{fill_blank:l.mark_type===d.lt.MANUAL?l.fill_blank:!1,short_answer:l.mark_type===d.lt.MANUAL?l.short_answer:!1},anonymous_marking:l.anonymous_marking,exam_certificate_id:"",supervisor_list:[],marker_list:[...l.marker_list.map(v=>typeof v=="string"?v:v.id)],result_view_rule:r.result_view_rule,answer_parsing:r.answer_parsing,ranking_list_view_rule:r.ranking_list_view_rule,show_result:r.show_result,reward_rule:null,authority_range:null,supervisor_mark:null})};case"AddInvestigate":return{course_id:p.id,course_type:9,flag:9,course_sort:a,investigate:{id:p.id,title:p.name,questionnaire_id:p.questionnaire.id}};default:return null}})}));return u},Z=s=>{function u(h){return h.fill_blank_count>0||h.short_answer_count>0}var E=s.map((h,p)=>({key:"".concat(new Date().getTime()).concat(p),desc:h.content,name:h.stage_name,inOrder:h.is_order,list:h.course_mapping_list.map(a=>{var e=a;switch(a.flag){case 1:return{id:a.course_id,name:a.name,type:a.course_type===1?"course":"courseware",icon:o.e1[a.type==="imageText"?"h5":a.contentType==="audio/mp3"?"mp3":a.type],originalType:a.type,componentName:a.course_type===1?"CourseSelector":"CoursewareSelector",status:a.course_type===1?"":a.status,duration:a.duration,data:a};case 2:return{id:a.course_id,name:e.title,type:"ex",icon:o.e1.ex,componentName:"AddExam",duration:e.exam_duration*60,data:{title:e.title,examDuration:e.exam_duration,summary:e.summary,isOpenDrawQuestions:e.proportionalExamVos&&e.proportionalExamVos.length>0,proportional:e.proportionalExamVos&&(e.proportionalExamVos.length>0?g(e.proportionalExamVos,e.bank_quesiton_list):e.question_mode===2?y(e.bank_quesiton_list):[])||[],cheatFlag:{isChecked:!!e.cheat_flag,switchNum:e.cut_screen_count===-1?null:e.cut_screen_count,faceRecognition:e.face_recognition},reExam:{show_result:e.show_result,isChecked:e.s_repeat_exam==="true",notAllowed:{end:e.answer_parsing},allowed:{reRule:e.re_exam_rule,record:e.score_rule,end:e.answer_parsing,reNum:e.re_exam_rule===2?e.re_exam_number:1,viewRule:e.view_rule}},markType:{checkedValue:e.mark_type===1?1:2,artificialDisabled:e.mark_type===1&&!u(e),fillBlank:{checked:(e.mark_type===2||e.mark_type===3)&&e.fill_blank_count,disabled:!e.fill_blank_count},shortAnswer:{checked:(e.mark_type===2||e.mark_type===4)&&e.short_answer_count,disabled:!e.short_answer_count},anonymousMarking:e.anonymous_marking==="true"},questionsMode:e.question_mode,knowledgePoints:e.show_knowledge==="show"?1:2,passLine:e.pass_line,fixedQuestion:e.question_mode===1?{id:e.paper_id,name:e.paper_title,tableList:{fillBlankCount:e.fill_blank_count,fillBlankScore:e.fill_blank_unit_score,multipleCount:e.multiple_count,multipleScore:e.multiple_unit_score,shortAnswerCount:e.short_answer_count,shortAnswerScore:e.short_answer_unit_score,singleCount:e.single_count,singleScore:e.single_unit_score,totalCount:e.paper_question_numbers,totalScore:e.total_score,trueOrFalseCount:e.true_or_false_count,trueOrFalseScore:e.true_or_false_unit_score}}:{id:"",name:"",tableList:{fillBlankCount:0,fillBlankScore:0,multipleCount:0,multipleScore:0,shortAnswerCount:0,shortAnswerScore:0,singleCount:0,singleScore:0,totalCount:0,totalScore:0,trueOrFalseCount:0,trueOrFalseScore:0}},randomQuestion:e.question_mode===2?{bankQuesitonVoList:e.bank_quesiton_list.map(n=>{var l=n.fill_blank_count,r=n.multiple_count,k=n.short_answer_count,f=n.single_count,v=n.total_count,m=n.true_or_false_count,M={fillBlankCount:l,shortAnswerCount:k,multipleCount:r,singleCount:f,totalCount:v,trueOrFalseCount:m};return{id:n.id,name:n.name,data:Object.assign(n,M),fillBlankCount:l,shortAnswerCount:k,multipleCount:r,singleCount:f,totalCount:v,trueOrFalseCount:m}}),bankQuesitonInfo:{fillBlankCount:e.fill_blank_count,fillBlankScore:e.fill_blank_unit_score,fillBlankType:+e.fill_blank_type||1,multipleCount:e.multiple_count,multipleScore:e.multiple_unit_score,shortAnswerCount:e.short_answer_count,shortAnswerScore:e.short_answer_unit_score,shortAnswerType:+e.short_answer_type||1,singleCount:e.single_count,singleScore:e.single_unit_score,trueOrFalseCount:e.true_or_false_count,trueOrFalseScore:e.true_or_false_unit_score,multipleMissedScore:e.multiple_missed_score}}:{bankQuesitonVoList:[],bankQuesitonInfo:{fillBlankCount:0,fillBlankScore:0,multipleCount:0,multipleScore:0,shortAnswerCount:0,shortAnswerScore:0,singleCount:0,singleScore:0,trueOrFalseCount:0,trueOrFalseScore:0,multipleMissedScore:0}}}};case 9:return{id:a.course_id,name:a.title,type:"investigate",icon:o.e1.questionnaire,componentName:"AddInvestigate",data:a,questionnaire:{id:a.questionnaire_id,name:a.name}};case 15:{var t=(0,J.Qm)()._store,I=t.getState(),A=I.user,i=(0,d.AC)({data:a.exam_plan_detail_v1,user:{id:A.id,name:A.name,creator:!0}});return{id:a.exam_plan_detail_v1.id,name:a.exam_plan_detail_v1.title,type:"ex",icon:o.e1.ex,componentName:"AddNewExam",duration:a.exam_plan_detail_v1.exam_duration*60,data:i}}default:return null}})}));return E},B=function(u){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return u.map((h,p)=>{var a=E.find(e=>e.stage_index-1===p);return h.list.map((e,t)=>{var I;a&&(I=a.resource_error_vos.find(i=>i.resource_index===t));var A=e.type;if(e.resource_type)switch(e.resource_type){case 1:A="course";break;case 2:case 3:A="courseware";break;case 6:case 15:A="ex";break;case 7:A="xx";break;case 9:A="questionnaire";break;case 13:A="attendance";break;case 14:A="assess";break;default:break}if(e.componentName)switch(e.componentName){case"CourseSelector":A="course";break;case"CoursewareSelector":A="courseware";break;case"AddNewExam":case"AddExam":A="ex";break;case"OfflineTrain":A="xx";break;case"Attendance":A="attendance";break;case"QuestionnaireSelector":case"AddInvestigate":A="questionnaire";break;case"AddPracticeTest":A="practicalIndustry";break;case"AddAssessment":A="assess";break;default:break}switch(A){case"course":e.resourceErrTip=I?I.resource_status==="deleted"?"\u5F15\u7528\u7684\u8BFE\u7A0B\u88AB\u5220\u9664":I.resource_status==="un_released"?"\u5F15\u7528\u7684\u8BFE\u7A0B\u300A".concat(I.resource_name,"\u300B\u672A\u53D1\u5E03\uFF0C\u8BF7\u542F\u7528\u540E\u518D\u7F16\u8F91"):"":"";break;case"courseware":e.resourceErrTip=I&&I.resource_status==="deleted"?"\u5F15\u7528\u7684\u8BFE\u4EF6\u88AB\u5220\u9664":"";break;case"ex":e.resourceErrTip=I?I.resource_status==="bank_deleted"?"\u5F15\u7528\u7684\u9898\u5E93\u88AB\u5220\u9664":I.resource_status==="paper_deleted"?"\u5F15\u7528\u7684\u8BD5\u5377\u88AB\u5220\u9664":I.resource_status==="bank_missing"?"\u5F15\u7528\u7684\u9898\u5E93\u8BD5\u9898\u4E0D\u8DB3":"":"";break;case"xx":e.resourceErrTip=I&&I.resource_status==="time_expired"?"\u7EBF\u4E0B\u8BFE\u5DF2\u8FC7\u671F":"";break;case"questionnaire":e.resourceErrTip=I?I.resource_status==="deleted"?"\u5F15\u7528\u7684\u95EE\u5377\u88AB\u5220\u9664":I.resource_status==="un_released"?"\u5F15\u7528\u7684\u95EE\u5377\u672A\u53D1\u5E03":"":"";break;case"practicalIndustry":e.resourceErrTip=I&&I.resource_status==="operation_resource_deleted"?F.Z.t("component.practicalDeleteTip"):"";break;default:break}return null}),null}),u},V=(s,u)=>({id:u?"":s.id,title:s.title,edit_status:s.edit_status,status:s.status,department_id:s.department_id||"",dateRange:{startTime:s.begin_time,endTime:s.end_time},address:s.address,course_duration:s.course_duration,has_lecturer_student_data:u?!1:s.has_lecturer_student_data,has_student_lecturer_data:u?!1:s.has_student_lecturer_data,has_student_course_data:u?!1:s.has_student_course_data,has_lecturer_assess_student_data:u?!1:s.has_lecturer_assess_student_data,teacher:{id:s.lecturer_id,name:s.lecturer_name,is_lecturer_confirm:s.is_lecturer_confirm,is_lecturer_subsidy:s.is_lecturer_subsidy,teacher_sync_user_id:s.teacher_sync_user_id,lecturer_name:s.lecturer_name,teacher_sync_source_type:s.teacher_sync_source_type,type:s.teacher_sync_type,teacher_sync_type:s.teacher_sync_type},introduction:s.introduction,attachment:s.attachment||[],other:{is_open_schedule:s.is_open_schedule,is_open_upload:s.is_open_upload},remind:{remind_type:s.remind_type||"offline_course",advance_minute:s.advance_minute,is_lecturer_remind:s.is_lecturer_remind,is_student_remind:s.is_student_remind,is_director_remind:s.is_director_remind},evaluate:{is_lecturer_student_evaluate:s.is_lecturer_student_evaluate,is_student_lecturer_evaluate:s.is_student_lecturer_evaluate,is_student_course_evaluate:s.is_student_course_evaluate,lecturer_student_evaluate_content:s.lecturer_student_evaluate_content?(0,c.Z)((0,c.Z)({},s.lecturer_student_evaluate_content),{},{passing_score:Number(s.lecturer_student_evaluate_content.passing_score),total_score:Number(s.lecturer_student_evaluate_content.total_score)}):{evaluate_type:"score",questionnaire_id:"",questionnaire_name:"",total_score:"",passing_score:""},student_lecturer_evaluate_content:s.student_lecturer_evaluate_content||{evaluate_type:"star",questionnaire_id:"",questionnaire_name:"",total_score:"",passing_score:""},student_course_evaluate_content:s.student_course_evaluate_content||{evaluate_type:"star",questionnaire_id:"",questionnaire_name:"",total_score:"",passing_score:""}},assess:{is_open_offline_assessment:s.is_open_offline_assessment,assessment_total_score:s.assessment_total_score,assessment_pass_score:s.assessment_pass_score},user_has_attendanted:u?!1:s.user_has_attendanted}),j=(s,u)=>{var E=[];return u?s.attendance_course_vo.forEach(h=>{E.push((0,c.Z)((0,c.Z)({},h),{},{course_id:"",course_key:h.course_id}))}):E=s.attendance_course_vo,{courseId:s.courseId,directors:s.director?s.director.map(h=>h):s.directors,id:u?"":s.id,name:s.name,qrcode_type:s.qrcode_type,relate_course_list:E,sign_in_begin_time:s.sign_in_begin_time?(0,b.p6)(s.sign_in_begin_time,"yyyy-MM-dd hh:mm:ss"):"",sign_in_end_time:s.sign_in_end_time?(0,b.p6)(s.sign_in_end_time,"yyyy-MM-dd hh:mm:ss"):"",sign_out_begin_time:s.sign_out_begin_time?(0,b.p6)(s.sign_out_begin_time,"yyyy-MM-dd hh:mm:ss"):"",sign_out_end_time:s.sign_out_end_time?(0,b.p6)(s.sign_out_end_time,"yyyy-MM-dd hh:mm:ss"):"",source_type:s.source_type,remind_directors:s.remind_directors,advance_minute:s.advance_minute,user_has_attendanted:u?!1:s.user_has_attendanted,relate_course:s.relate_course,address:s.address,longitude:s.longitude,latitude:s.latitude,address_detail:s.address_detail,sign_range:s.sign_range}};function Y(s){return Object.prototype.toString.call(s)==="[object Object]"}function ee(s){return s.replace(/[A-Z]/g,u=>"_".concat(u.toLowerCase()))}function te(s){if(!Y(s))return s;for(var u={},E=Object.keys(s),h=0,p=E;h<p.length;h++){var a=p[h],e=s[a];a=ee(a),u[a]=Y(e)?te(e):e}return u}var z=s=>{var u=te(s),E=u.id,h=u.name,p=u.requirement,a=u.resource_id,e=u.is_self_evaluate,t=u.is_lock,I=u.begin_time_unlock,A=u.end_time_unlock,i=u.questionnaire_id,n=u.evaluate_form_title,l=u.before_start_day,r=u.before_start_repeat,k=u.before_start_un_remind,f=u.before_end_day,v=u.before_end_repeat,m=u.before_end_un_remind,M=u.after_end_day,w=u.after_end_repeat,W=u.after_end_un_remind,O=u.is_passed_standards,ne=u.is_passed_option_three,re=u.pass_standard_conditions,K=u.pass_standards_number,se=u.creator_user;return{id:E,name:h,requirement:p,resource_id:a,is_lock:t,begin_time_unlock:I,end_time_unlock:A,is_self_evaluate:e,questionnaire_id:i,evaluate_form_title:n,before_start_day:l,before_start_repeat:r,before_start_un_remind:k,before_end_day:f,before_end_repeat:v,before_end_un_remind:m,after_end_day:M,after_end_repeat:w,after_end_un_remind:W,is_passed_standards:O,is_passed_option_three:ne,pass_standard_conditions:re,pass_standards_number:K,creator_user:se}},ie=s=>({courseId:s.course_id,duration:s.duration,teacherName:s.live_lesson.teacher_name,startTime:s.live_lesson.live_start_time,endTime:s.live_lesson.live_end_time})},82416:function(ae,$,_){"use strict";_.d($,{fn:function(){return R},Iw:function(){return C},dw:function(){return F},aF:function(){return J},Pe:function(){return x},v7:function(){return b},dt:function(){return o},gx:function(){return d}});var L=_(37055),c=_(10237);function R(){var y=L.ZP.AccountSetting.getAccountInfo();return c.WY.get({url:y})}function C(y){var g=L.ZP.AccountSetting.bindAccount();return c.WY.post({url:g,data:y})}function F(y){var g=L.ZP.AccountSetting.goodsOrder();return c.WY.get({url:g,params:y})}function J(y){var g=L.ZP.AccountSetting.getGoodsOrderExport();return c.WY.get({url:g,params:y})}function x(){var y=L.ZP.AccountSetting.getWxAccountInfo();return c.WY.get({url:y})}function b(y){var g=L.ZP.AccountSetting.getWxAccountInfo();return c.WY.post({url:g,data:y})}function o(){var y=L.ZP.StudyProjectList.getAccountInfo();return c.WY.get({url:y})}function d(y){var g=L.ZP.StudyProjectList.verifyAccountInformation();return c.WY.post({url:g,data:y})}},85424:function(ae,$,_){"use strict";var L=_(57361),c=_(14965),R=_(11448),C=_(9754),F=_.n(C),J=_(12924),x=_.n(J),b=_(91768),o=_(80991),d=_(84874),y=_(37055),g=_(10237),S=_(78138),Q=_.n(S),H=_(53009),G=R.Z.RangePicker;class X extends x().Component{constructor(U){var q;super(U);q=this,this.getHourClass=function(){var P=(0,L.Z)(F().mark(function D(N){var Z,B,V,j,Y,ee;return F().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if(!(q.props.formik.values.stages&&q.props.formik.values.stages.length>0)){z.next=3;break}return q.setState({stages:q.props.formik.values.stages}),z.abrupt("return");case 3:if(N){z.next=5;break}return z.abrupt("return");case 5:return Z=y.ZP.EditStudyProject.getProjectInfo(N),z.next=8,g.WY.get({url:Z});case 8:B=z.sent,V=B.data,j=V.stages,Y=V.stage_error_list,j=(0,H.$x)((0,H.tT)(j),Y.length>0?Y:[]),ee=q.handleStages(j),q.props.formik.setFieldValue("stages",ee,!1),q.setState({stages:ee});case 14:case"end":return z.stop()}},D)}));return function(D){return P.apply(this,arguments)}}(),this.handleStages=P=>{var D=P.map(N=>({id:N.hourClassId,stage_name:N.name,studyTime:[N.hourClassStartTime?Q()(N.hourClassStartTime):null,N.hourClassEndTime?Q()(N.hourClassEndTime):null],resources:N.list.map(Z=>({course_id:Z.id,resource_name:Z.name,content_type:Z.icon,unlockTime:Z.unlocking_time?Q()(Z.unlocking_time):null,type:Z.type}))}));return D},this.changeTime=(P,D,N)=>{this.state.stages.length!==0&&(this.state.stages[N].studyTime=P||["",""],this.setState({stages:this.state.stages},()=>{this.props.formik.setFieldValue("stages",this.state.stages),this.props.formik.setFieldTouched("stages",!0)}))},this.changeDate=(P,D,N,Z)=>{this.state.stages.length!==0&&(this.state.stages[N].resources[Z].unlockTime=P||"",this.setState({stages:this.state.stages},()=>{this.props.formik.setFieldValue("stages",this.state.stages),this.props.formik.setFieldTouched("stages",!0)}))},this.disabledDateStage=P=>{var D=this.props.formik.values.dateRange,N=D.startTime,Z=D.endTime;return P&&P<Q()(Q()(N).format("YYYY-MM-DD 00:00:00"))||P<Q()().subtract("day",1)||P>Q()(Q()(Z).format("YYYY-MM-DD 23:59:59"))},this.disabledDateResource=(P,D)=>{var N=D[0],Z=D[1];return P&&P<Q()(Q()(N).format("YYYY-MM-DD 00:00:00"))||P<Q()().subtract("day",1)||P>Q()(Q()(Z).format("YYYY-MM-DD 23:59:59"))},this.state={stages:[]}}componentDidMount(){this.getHourClass(this.props.Id)}render(){var U=this.props,q=U.formik,P=q.errors,D=q.touched,N=U.t,Z=this.state.stages;return x().createElement("div",{style:{marginBottom:"10px"}},Z.map((B,V)=>!B.resources.every(j=>j.type==="xx"||j.type==="jobEvaluation")&&x().createElement("div",{className:"hour",key:B.id},x().createElement("div",{className:"hour-title"},x().createElement("span",null,B.stage_name,"\uFF1A"),x().createElement("div",{className:"".concat(D.stages&&P.stages&&P.stages[B.id]?"StageHourClassError":"")},x().createElement("span",null,N("assgin.learnTime"),"\uFF1A"),x().createElement(G,{className:"stage_hour",format:"YYYY-MM-DD HH:mm",disabledDate:this.disabledDateStage,disabled:this.props.disabled,value:B.studyTime,onChange:(j,Y)=>this.changeTime(j,Y,V),showTime:!0,style:{width:"350px"}}))),x().createElement("div",{className:"table"},x().createElement("p",{className:"table-title"},N("learning.learningElectiveAddContent")),x().createElement("div",{className:"table-content"},B.resources&&B.resources.map((j,Y)=>j.type!=="xx"&&j.type!=="jobEvaluation"&&x().createElement("div",{key:j.course_id,className:"table-row ".concat(D.stages&&P.stages&&P.stages[j.course_id]?"HourClassError":""),style:Y===B.resources.length-1?{}:{borderBottom:"1px solid #EBECF3"}},x().createElement("div",{className:"table-label"},x().createElement("span",{className:"courseware__right__list__icon"},x().createElement(d.Z,{iconClass:j.content_type})),j.resource_name),x().createElement(R.Z,{className:"unlock_Hour",showTime:!0,disabledDate:ee=>this.disabledDateResource(ee,B.studyTime),size:"small",showNow:!1,value:j.unlockTime,disabled:this.props.disabled,format:"YYYY-MM-DD HH:mm",placeholder:N("assgin.unLockTimeLabel"),onChange:(ee,te)=>this.changeDate(ee,te,V,Y),style:{width:"224px"}}))))),D.stages&&P.stages&&P.stages[V]&&x().createElement("p",{className:"error_tips_red"},P.stages[V]))))}}$.Z=(0,o.$j)((0,b.Z)()(X))},62821:function(ae,$,_){"use strict";_.d($,{C:function(){return b}});var L=_(93485),c=_(33565),R=_(78138),C=_.n(R),F=_(3407),J=_(6793),x=(0,J.me)(),b=(d,y,g)=>{var S={},Q=y.dateRange,H=Q.startTime,G=Q.endTime,X=(0,L.Z)(y.stages.entries()),T;try{for(X.s();!(T=X.n()).done;){var U=T.value,q=(0,c.Z)(U,2),P=q[0],D=q[1];if(!D.resources.every(V=>V.type==="xx"||V.type==="jobEvaluation")){if(!D.studyTime[0]||!D.studyTime[1]){S[P]=F.Z[x].assgin.selectStudyTime,S[D.id]=!0;continue}if(D.studyTime[0].valueOf()==D.studyTime[1].valueOf()){S[P]=F.Z[x].assgin.startEquality,S[D.id]=!0;continue}if((H||G)&&(D.studyTime[0]&&D.studyTime[0]<C()(o(H,"start"))||D.studyTime[1]>C()(o(G,"end")))){S[P]=g=="study"?F.Z[x].assgin.studyTimeRangeStudy:F.Z[x].assgin.selectStudyTimeRange,S[D.id]=!0;continue}var N=(0,L.Z)(D.resources),Z;try{for(N.s();!(Z=N.n()).done;){var B=Z.value;if(!(B.type==="xx"||B.type==="jobEvaluation")){if(!B.unlockTime){S[P]=F.Z[x].assgin.unLockTime,S[B.course_id]=!0;continue}if(B.unlockTime<C()(o(D.studyTime[0],"start"))||B.unlockTime>C()(o(D.studyTime[1],"end"))){S[P]=F.Z[x].assgin.unLockRange,S[B.course_id]=!0;continue}}}}catch(V){N.e(V)}finally{N.f()}}}}catch(V){X.e(V)}finally{X.f()}return Object.keys(S).length?S:""},o=(d,y)=>C()(d).format("YYYY-MM-DD HH:mm:".concat(y==="start"?"00":"59"))},89135:function(ae,$,_){"use strict";var L=_(88986),c=_(78138),R=_.n(c),C=_(6793),F=_(2396),J=_(3407),x=(0,C.me)(),b=J.Z[x].learning.validation;$.Z={multiText:o=>{var d;return(0,F.$s)((0,C.fy)(o))>256&&(d=b.multiTextTip),d},title:o=>((0,C.fy)(o)?"":b.learningAddItemTitleNull)||((0,C.fy)(o).length>60?b.learningAddItemTitleLimit:""),dateRange:(o,d,y)=>{var g;if((!o.startTime||!o.endTime)&&(g=b.learningAddItemDateRangeNull),!y){var S="YYYY-MM-DD HH:mm";d.forEach(Q=>{(R()(R()(Q.data.dateRange.startTime).format(S)).valueOf()<(0,C.jZ)(R()(o.startTime).format(S))||R()(R()(Q.data.dateRange.startTime).format("YYYY-MM-DD HH:mm")).valueOf()>(0,C.jZ)(R()(o.endTime).format(S))||R()(R()(Q.data.dateRange.endTime).format(S)).valueOf()<=(0,C.jZ)(R()(o.startTime).format(S))||R()(R()(Q.data.dateRange.endTime).format(S)).valueOf()>(0,C.jZ)(R()(o.endTime).format(S)))&&(g=b.learningAddItemDateRangeOnsite)})}return g},qualifiedStandardExceptWork:(o,d,y)=>{var g;return o&&(y===0&&d===0||!o.progress.isChecked&&!o.exam.isChecked||y===0&&!o.exam.isChecked)&&(g=b.learningAddItemPass),g},qualifiedStandardInOperation:(o,d,y,g,S)=>{var Q;return o&&(y===0&&d===0&&g===0&&S===0||!o.progress.isChecked&&!o.exam.isChecked&&!o.operation.isChecked&&o.jobEvaluation&&!o.jobEvaluation.isChecked)&&(Q=b.learningAddItemPass),Q},checkStandardInOperation:(o,d,y,g)=>{var S;return o&&(y===0&&d===0&&g===0||!o.progress.isChecked&&!o.exam.isChecked&&!o.operation.isChecked||o.progress.isChecked&&!o.progress.progress||d!==0&&o.exam.isChecked&&!o.exam.times||g!==0&&o.operation.isChecked&&!o.operation.times)&&(S=b.learningAddItemPass),S},qualifiedStandard:(o,d,y,g,S)=>{var Q;return o&&(y===0&&d===0&&g===0&&S===0||!o.progress.isChecked&&!o.exam.isChecked&&!o.operation.isChecked&&!o.jobEvaluation.isChecked||o.progress.isChecked&&!o.progress.progress||d!==0&&!o.exam.isChecked||d!==0&&o.exam.isChecked&&!o.exam.times||g!==0&&!o.operation.isChecked||g!==0&&o.operation.isChecked&&!o.operation.times)&&(Q=b.learningAddItemPass),Q},reward:o=>{var d={};return(!o||o.certificate.isChecked&&!o.certificate.id)&&(d=(0,L.Z)((0,L.Z)({},d),{},{certificateChecked:!0,msg:b.learningAddItemRewardCert})),o.score.isCheckedDeduction&&!o.score.deduction&&(d=(0,L.Z)((0,L.Z)({},d),{},{scoreDeductionChecked:!0,msg:b.learningAddItemRewardunPass})),o.score.isCheckedReward&&!o.score.reward&&(d=(0,L.Z)((0,L.Z)({},d),{},{scoreRewardChecked:!0,msg:b.learningAddItemRewardPass})),Object.keys(d).length?d:""},checkTerm:o=>{var d=o.number,y;return(!F.fA.positiveInteger.test(d)||d<1||d>100)&&(y=b.learningAddItemTerm),y},studyLimit:o=>{var d;return o.isChecked&&!o.limit?d=b.learningTimeTip:o.limit>9999&&(d=b.learningTimeBeyondTip),d},originPrice:o=>{var d;return parseFloat(o)===0?d=b.originalPriceTip:parseFloat(o)>99999&&(d=b.maxOriginPriceTip),d},discountPrice:(o,d)=>{var y;return o===""||parseFloat(o)===0?y=b.discountPriceTip:parseFloat(o)>99999?y=b.maxDiscountPriceTip:parseFloat(d)<=parseFloat(o)&&(y=b.diffPriceTip),y},registerRange:o=>{var d;return(!o.startTime||!o.endTime)&&(d=b.learningAddItemDateRangeNull),(0,C.jZ)(o.startTime)>=(0,C.jZ)(o.endTime)&&(d=b.learningAddItemDateRangeLimit),d},dateValidateCourse:(o,d)=>{var y;return(!o.startTime||!o.endTime)&&(y=b.learningAddItemDateRangeNull),(0,C.jZ)(o.startTime)>=(0,C.jZ)(o.endTime)&&(y=b.learningAddItemDateRangeLimit),(0,C.jZ)(o.startTime)<(0,C.jZ)(d.endTime)&&(y=b.learningCourseTime),y},inputValidateNumber:(o,d)=>{var y="";return(0,C.fy)(o)?(d&&Number(o)>=Number(d)&&(y=J.Z[x].learning.validation.priceLimit),Number(o)>99999&&(y=J.Z[x].validation.maxNum99999),Number(o)<.01&&(y=J.Z[x].validation.minNum),y):(y=J.Z[x].validation.pleaseEnter,y)},applyTip:o=>{var d;return o.isNeedApply==="need"&&o.enrollAudit==="automatic_audit"&&o.enrollLimit&&o.limitCount===""&&(d=b.applyPeopleTip),d},taskPrice:o=>{var d=o.price,y=o.isPaid,g;return y&&(d===""||parseFloat(d)===0?g=b.taskPriceTip:parseFloat(d)>99999&&(g=b.maxPriceTip)),g}}},92333:function(ae,$,_){"use strict";_.d($,{WZ:function(){return x},tx:function(){return b},en:function(){return o},wv:function(){return d},a1:function(){return y},eP:function(){return g},IO:function(){return S}});var L=_(88986),c=_(37055),R=_(10237),C=_(38642),F={zaraFlag:(0,C.UI)("ZARA_H5")};function J(T){var U=T.sign,q=U===void 0?!1:U,P=T.id,D=T.save_step,N=T.base_info,Z=T.stages,B=T.stage_content,V=T.settings,j=q?CONFIG.EditStudyProject.editProjectUpgrade(q):CONFIG.EditStudyProject.addProjectUpgrade();F.zaraFlag&&(j=q?CONFIG.StudyProjectWithAssessment.editProject(q):CONFIG.StudyProjectWithAssessment.addProject());var Y={save_step:D};return P&&(Y.id=P),N&&(Y.base_info=N),B&&(Y.stage_content=B),Z&&(Y.stages=Z),V&&(Y.settings=V),request.post({url:j,data:Y})}function x(T,U){var q=c.ZP.StudyProjectList.assignProject(U);return R.WY.post({url:q,data:T})}function b(T,U,q){return R.WY.get({url:c.ZP.aiTrain.camp_periods(),params:(0,L.Z)((0,L.Z)({project_id:T},U),q)})}function o(T){return R.WY.post({url:c.ZP.aiTrain.delete(T)})}function d(T,U){return R.WY.post({url:c.ZP.aiTrain.change_status(T),data:{status:U}})}function y(T,U){return R.WY.post({url:c.ZP.aiTrain.save(),data:(0,L.Z)({project_id:T},U)})}function g(T,U,q){return R.WY.post({url:c.ZP.aiTrain.edit(U),data:(0,L.Z)({project_id:T},q)})}function S(T){return R.WY.get({url:c.ZP.aiTrain.query(T)})}function Q(T){return request.post({url:CONFIG.aiTrain.apply(T)})}function H(){return request.get({url:CONFIG.ahLaboratory.getLaboratoryList()})}function G(T){return request.post({url:CONFIG.ahLaboratory.addLabSelectList(),data:{project_lab_mapping_list:T}})}function X(T){var U=T.project_id;return request.get({url:CONFIG.ahLaboratory.getLabSelectList(),params:{project_id:U}})}},43795:function(ae,$,_){"use strict";_.r($),_.d($,{default:function(){return l}});var L=_(12924),c=_.n(L),R=_(57663),C=_(71577),F=_(62029),J=_(34792),x=_(48086),b=_(57361),o=_(9754),d=_.n(o),y=_(28216),g=_(76651),S=_(91768),Q=_(62615),H=_(6793),G=_(80991),X=_(78138),T=_.n(X),U=_(3407),q=_(53009),P=_(4408),D=_(38642),N=_(7584),Z=_(2396),B=_(85424),V=_(88983),j=_(47933),Y=_(43859),ee=_(82416);class te extends c().Component{constructor(){var k;super(...arguments);k=this,this.state={paidStatus:!1,appType:localStorage.appType},this.onChange=f=>{this.props.onChange(f.target.value),this.props.formik.setFieldValue("originalPrice",""),this.props.formik.setFieldValue("preferentialPrice","")},this.getUserAliPayStatus=(0,b.Z)(d().mark(function f(){var v,m;return d().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,(0,ee.fn)();case 2:v=w.sent,m=v.data,k.setState({paidStatus:m.status!=="SUCCESS"});case 5:case"end":return w.stop()}},f)}))}componentDidMount(){this.getUserAliPayStatus()}render(){var k=this.props.value,f=this.state,v=f.paidStatus,m=f.appType;return c().createElement(j.ZP.Group,(0,F.Z)({},this.props,{onChange:this.onChange,value:k}),c().createElement(j.ZP,{value:"true"},this.props.t("course.free")),m==="e_app"?c().createElement(j.ZP,{disabled:v,value:"false"},this.props.t("learning.learnUpgrade.paid")):null,c().createElement("span",{style:{color:"#ccc"}},this.props.t("learning.learnUpgrade.priceTip")))}}var z=(0,Y.Z)((0,G.$j)((0,S.Z)()(te))),ie=_(47673),s=_(4107);class u extends c().Component{constructor(){super(...arguments);this.dealValue=k=>{var f=k.target.value;f=f.replace(/[^\d.]/g,""),f=f.replace(/\.{2,}/g,"."),f=f.replace(".","$#$").replace(/\./g,"").replace("$#$","."),f=f.replace(/^(\-)*(\d+)\.(\d\d).*$/,"$1$2.$3"),this.props.formik.setFieldValue(this.props.name,f)}}render(){var k=this.props,f=k.defaultValue,v=k.t;return c().createElement("div",{className:"price-form-content"},c().createElement(s.Z,(0,F.Z)({},this.props,{size:"middle",value:f,onChange:this.dealValue,className:"payment-inner-inputNumber",style:{width:"180px"},placeholder:v("learning.learnUpgrade.pleaseEnter")})),c().createElement("span",{style:{marginLeft:"10px"}},v("payment.moneyUnit")))}}var E=(0,Y.Z)((0,G.$j)((0,S.Z)()(u))),h=_(92333),p=_(89135),a=_(62821),e=r=>{var k=r.user;return{user:k}},t={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},I={labelCol:{xs:{span:24},sm:{span:0}},wrapperCol:{xs:{span:24},sm:{span:24}}};class A extends c().Component{constructor(k){var f;super(k);f=this,this.query=(0,b.Z)(d().mark(function v(){var m;return d().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,(0,h.IO)(g.m8.location.query.campId);case 2:m=w.sent,Object.keys(f.initialValues).forEach(W=>{f.initialValues[W]=m.data[W]}),f.initialValues.title=g.m8.location.query.type?m.data.title+T()().format("HH-mm-ss"):m.data.title,f.initialValues.is_free=String(m.data.is_free),f.initialValues.official_price=m.data.is_free?"":m.data.official_price_str,f.initialValues.preferential_price=m.data.is_free?"":m.data.preferential_price_str,f.initialValues.registerRange={startTime:g.m8.location.query.type?"":(0,H.p6)(m.data.registration_start_time),endTime:g.m8.location.query.type?"":(0,H.p6)(m.data.registration_end_time)},f.initialValues.dateRange={startTime:g.m8.location.query.type?"":(0,H.p6)(m.data.start_time),endTime:g.m8.location.query.type?"":(0,H.p6)(m.data.end_time)},f.initialValues.stages=f.handleStages((0,q.$x)((0,q.tT)(m.data.stages),m.data.stage_error_list)),f.disabledEnd=g.m8.location.query.campId&&!g.m8.location.query.type&&f.timeNow>(0,H.jZ)(f.initialValues.registerRange.endTime),f.disabledStart=g.m8.location.query.campId&&!g.m8.location.query.type&&f.timeNow>(0,H.jZ)(f.initialValues.registerRange.startTime),f.setState({formFlag:!0});case 14:case"end":return w.stop()}},v)})),this.handleStages=v=>{var m=v.map(M=>({id:M.hourClassId,stage_name:M.name,studyTime:[M.hourClassStartTime?T()(M.hourClassStartTime):null,M.hourClassEndTime?T()(M.hourClassEndTime):null],resources:M.list.map(w=>({course_id:w.id,resource_name:w.name,content_type:w.icon,unlockTime:w.unlocking_time?T()(w.unlocking_time):null,type:w.type}))}));return m},this.handleSubmit=function(){var v=(0,b.Z)(d().mark(function m(M,w){return d().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(f.dealData(M),g.m8.location.query.type!=="copy"){O.next=4;break}return f.save(w),O.abrupt("return");case 4:if(!g.m8.location.query.campId){O.next=7;break}return f.edit(w),O.abrupt("return");case 7:f.save(w);case 8:case"end":return O.stop()}},m)}));return function(m,M){return v.apply(this,arguments)}}(),this.save=function(){var v=(0,b.Z)(d().mark(function m(M){var w;return d().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.prev=0,O.next=3,(0,h.a1)(g.m8.location.query.type==="copy"?g.m8.location.query.campId:g.m8.location.query.projectId,f.formdata);case 3:w=O.sent,M.setSubmitting(!1),w.data&&(x.default.success(f.props.t("common.saveSuccess")),g.m8.push("/knowledgeBase/learningResources/studyProject/aiTrain?projectId=".concat(g.m8.location.query.projectId))),O.next=11;break;case 8:O.prev=8,O.t0=O.catch(0),M.setSubmitting(!1);case 11:case"end":return O.stop()}},m,null,[[0,8]])}));return function(m){return v.apply(this,arguments)}}(),this.edit=function(){var v=(0,b.Z)(d().mark(function m(M){var w;return d().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.prev=0,O.next=3,(0,h.eP)(g.m8.location.query.projectId,g.m8.location.query.campId,f.formdata);case 3:w=O.sent,M.setSubmitting(!1),w.data&&(x.default.success(f.props.t("common.editSuccess")),g.m8.push("/knowledgeBase/learningResources/studyProject/aiTrain?projectId=".concat(g.m8.location.query.projectId))),O.next=11;break;case 8:O.prev=8,O.t0=O.catch(0),M.setSubmitting(!1);case 11:case"end":return O.stop()}},m,null,[[0,8]])}));return function(m){return v.apply(this,arguments)}}(),this.dealData=v=>{Object.keys(this.formdata).forEach(m=>{m!=="schedule_settings"&&(this.formdata[m]=v[m])}),this.formdata.registration_start_time=T()(v.registerRange.startTime).valueOf(),this.formdata.registration_end_time=T()(v.registerRange.endTime).valueOf(),this.formdata.start_time=T()(v.dateRange.startTime).valueOf(),this.formdata.end_time=T()(v.dateRange.endTime).valueOf(),this.formdata.schedule_settings=v.stages.map(m=>{var M={};return M.id=m.id,M.start_time=T()(m.studyTime[0]).valueOf(),M.end_time=T()(m.studyTime[1]).valueOf(),M.resources=m.resources.map(w=>{var W={};return W.course_id=w.course_id,W.unlocking_time=T()(w.unlockTime).valueOf(),W}),M})},this.inputValidate=v=>{var m=(0,H.me)(),M=U.Z[m].validation.pleaseEnter;return(0,H.fy)(v)?(0,H.fy)(v).length>30?U.Z[m].validation.limitedThirty:"":M},this.handleCancelEdit=()=>{g.m8.push("/knowledgeBase/learningResources/studyProject/aiTrain?projectId=".concat(g.m8.location.query.projectId))},this.handleMethod=(0,H.E5)((v,m)=>{this.handleSubmit(v,m)},500),this.trainFormRef=c().createRef(),this.state={formFlag:!1},this.initialValues={title:"",registerRange:{startTime:"",endTime:""},dateRange:{startTime:"",endTime:""},stages:[],is_free:"true",official_price:"",preferential_price:""},this.formdata={title:"",registration_start_time:"",registration_end_time:"",start_time:"",end_time:"",schedule_settings:[],is_free:"",official_price:"",preferential_price:""},this.timeNow=new Date().getTime(),this.disabledEnd=!1,this.disabledStart=!1}componentDidMount(){g.m8.location.query.campId?this.query():this.setState({formFlag:!0})}render(){var k=this.props.t,f=g.m8.location.query.campId&&!g.m8.location.query.type?k("learning.editAiTrain"):k("learning.addAiTrain");return c().createElement("div",{className:"assgin-edit"},c().createElement(P.Z,{title:f}),c().createElement("div",{className:"form-page-container"},c().createElement("p",{className:"form-text"},g.m8.location.query.campId&&!g.m8.location.query.type?k("learning.editAiTrain"):k("learning.addAiTrain")),c().createElement("div",{className:"form-content"},this.state.formFlag?c().createElement(G.J9,{ref:this.trainFormRef,initialValues:this.initialValues,onSubmit:this.handleMethod,render:v=>c().createElement(G.l0,null,c().createElement("div",{className:"cl-form__sectitle in_margin"},k("exam.basicInformation")),c().createElement(G.gN,(0,F.Z)({},t,{required:!0,name:"title",type:"text",validate:m=>(0,Z.QK)(m,k("validation.pleaseEnter")+k("assgin.campName")),label:k("assgin.campName"),maxLength:30,component:N.Z,placeholder:k("validation.pleaseEnter")})),c().createElement(G.gN,(0,F.Z)({},t,{required:!0,displayType:"Custom",name:"registerRange",className:"dateRange",fieldName:"registerRange",label:k("learning.registrationTime"),component:Q.C0,defaultFieldList:v.values.registerRange,validate:m=>p.Z.registerRange(m),disabled:this.disabledStart})),c().createElement(G.gN,(0,F.Z)({},t,{required:!0,displayType:"Custom",name:"dateRange",className:"dateRange",validate:m=>p.Z.dateValidateCourse(m,v.values.registerRange),label:k("learning.aiTrainTime"),defaultFieldList:v.values.dateRange,component:Q.C0,disabled:this.disabledEnd})),c().createElement("div",{className:"cl-form__sectitle in_margin",style:{marginTop:"44px"}},k("assgin.curriculumSetting"),c().createElement("span",{style:{color:"#ccc","font-weight":"normal","margin-left":"30px"}},k("assgin.tipOfflineTraining"))),c().createElement(G.gN,(0,F.Z)({},I,{required:!0,name:"stages",label:"",displayType:"Custom",component:B.Z,Id:g.m8.location.query.projectId,validate:m=>(0,a.C)(m,v.values),disabled:this.disabledEnd})),(0,D.eY)("DINGTALK_ENTERPRISE_LOCK")&&c().createElement(L.Fragment,null,c().createElement("div",{className:"cl-form__sectitle in_margin"},k("learning.learnUpgrade.paymentSettings")),c().createElement(G.gN,(0,F.Z)({},t,{required:!1,name:"is_free",label:k("learning.learnUpgrade.pricing"),component:z,disabled:this.disabledEnd})),v.values.is_free!=="true"?c().createElement(G.gN,(0,F.Z)({},t,{required:!0,name:"official_price",label:k("learning.learnUpgrade.originalPrice"),validate:m=>p.Z.inputValidateNumber(m),placeholder:k("validation.pleaseEnter"),defaultValue:v.values.official_price,component:E,displayType:"Custom",disabled:this.disabledEnd})):null,v.values.is_free!=="true"?c().createElement(G.gN,(0,F.Z)({},t,{required:!0,name:"preferential_price",label:k("learning.learnUpgrade.discountPrice"),validate:m=>p.Z.inputValidateNumber(m,v.values.official_price),placeholder:k("validation.pleaseEnter"),defaultValue:v.values.preferential_price,component:E,displayType:"Custom",disabled:this.disabledEnd})):null),c().createElement("div",{className:"cl-form-fixed-footer"},c().createElement("div",{className:"cl-form-fixed-footer__container"},c().createElement(C.Z,{className:"form-page-container-bottom-btn",loading:v.isSubmitting,type:"primary",htmlType:"submit"},k("common.save")),c().createElement(C.Z,{className:"form-page-container-bottom-btn",onClick:this.handleCancelEdit},k("common.cancel")))))}):null)))}}var i=(0,y.$j)(e)((0,G.$j)((0,S.Z)()(A))),n=c().memo(()=>c().createElement(i,null)),l=n}}]);
