"use strict";(self.webpackChunkvue_h5_template=self.webpackChunkvue_h5_template||[]).push([[568],{96622:(t,e,s)=>{s.r(e),s.d(e,{default:()=>a});var a=(0,s(1001).Z)({},(function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)}),[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"about"},[s("h1",[t._v("This is an about page")])])}],!1,null,null,null).exports},31560:(t,e,s)=>{s.r(e),s.d(e,{default:()=>S});var a=s(95082),i=(s(86039),s(20495)),o=(s(71322),s(85471)),r=(s(73474),s(74755)),n=(s(20581),s(50914)),c=(s(47601),s(44951)),l=(s(23307),s(81392)),u=(s(49153),s(5944)),d=(s(69710),s(57609)),h=(s(25773),s(35791)),p=(s(33948),s(57658),s(26294)),m=s(22648),g=s(28387),v=s(52835),f=(s(70885),s(6458)),y=(s(18144),s(65641)),_={components:{[h.Z.name]:h.Z,[y.Z.name]:y.Z,[l.Z.name]:l.Z,[f.Z.name]:f.Z},props:{type:{type:String,default:""},status:{type:String,default:""},bizType:{type:String,default:""}},data(){return{formData:{status:this.status,bizType:this.bizType},statusList:[{id:"",lang:"common.all"},{id:"approval_complete",lang:"approvals.complete"},{id:"approval_going",lang:"approvals.going"},{id:"approval_revoked",lang:"approvals.revoked"}],bizTypeList:[]}},computed:(0,a.Z)({},(0,p.mapGetters)({primaryColor:"getPrimaryColor"})),created(){},mounted(){this.businessTypes()},methods:{async businessTypes(){const{data:t}=await g.Z.approvalsApi.getTypeList();this.bizTypeList=[{bizType:"",bizName:this.$t("common.all")},...t.data]},onReset(){this.formData={status:"",bizType:""}},onSubmit(){localStorage.setItem("approvalStatus",this.formData.status),localStorage.setItem("approvalBizType",this.formData.bizType),this.$emit("onConfirm")}}},C=s(1001),I=(0,C.Z)(_,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"approval-filter"},[s("div",{staticClass:"header"},[s("van-icon",{staticClass:"closeBtn",attrs:{name:"arrow-down",size:"20"},on:{click:function(e){return t.$emit("hidePopup")}}}),t._v(" "+t._s(t.$t("course.filter"))+" ")],1),s("div",{staticClass:"main-form"},["pending"!==t.type?[s("h5",[t._v(t._s(t.$t("approvals.state")))]),s("van-row",{staticClass:"pstatus",attrs:{gutter:"16"}},t._l(t.statusList,(function(e,a){return s("van-col",{key:a,class:{singular:(a+1)%2==0},attrs:{span:"8"},on:{click:function(s){t.formData.status=e.id}}},[s("van-button",{attrs:{type:"default",color:e.id===t.formData.status?t.primaryColor:null,block:"",size:"mini"}},[t._v(t._s(t.$t(e.lang)))])],1)})),1)]:t._e(),s("h5",[t._v(t._s(t.$t("approvals.businessType")))]),s("van-row",{staticClass:"btype",attrs:{gutter:"16"}},t._l(t.bizTypeList,(function(e,a){return s("van-col",{key:e.bizType,class:{singular:a%2==0},attrs:{span:"12"},on:{click:function(s){t.formData.bizType=e.bizType}}},[s("van-button",{attrs:{type:"default",color:e.bizType===t.formData.bizType?t.primaryColor:null,block:"",size:"mini"}},[t._v(t._s(e.bizName))])],1)})),1)],2),s("van-row",{staticClass:"footer",attrs:{gutter:"8"}},[s("van-col",{attrs:{span:"12"}},[s("van-button",{attrs:{type:"default",block:"",size:"small"},on:{click:t.onReset}},[t._v(t._s(t.$t("buttons.reset")))])],1),s("van-col",{attrs:{span:"12"}},[s("van-button",{attrs:{type:"primary",block:"",size:"small",color:t.primaryColor},on:{click:t.onSubmit}},[t._v(t._s(t.$t("buttons.confirm")))])],1)],1)],1)}),[],!1,null,"93d2190e",null).exports,b=s(76953),w=s(78368),$={components:{[h.Z.name]:h.Z,[d.Z.name]:d.Z,[u.Z.name]:u.Z,[l.Z.name]:l.Z,[c.Z.name]:c.Z,[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,ApprovalFilter:I,clChooseUser:b.Z},filters:{formatDate:function(t){return(0,m.p6)(t,"yyyy.MM.dd hh:mm")}},beforeRouteLeave(t,e,s){"approvals"===t.name&&"approvalList"===e.name&&(localStorage.setItem("approvalStatus",""),localStorage.setItem("approvalBizType","")),s()},data:function(){return{showPopover:!1,actions:[{id:0,text:this.$t("approvals.title")},{id:1,text:this.$t("approvals.initiator")}],activeAction:0,showCompany:!1,config:{multiple:!1,pickedUsers:[],pickedDepartments:[],disabledUsers:[],disabledDepartments:[],requiredUsers:[],requiredDepartments:[],responseUserOnly:!0,maxUsers:1,filterAuth:!1},show:!1,list:[],loading:!1,finished:!1,type:"",params:{pageNumber:0,pageSize:10,status:"",bizType:"",title:"",createUserId:"",keyword:""},defaultAvatar:w,approvalStatusTab:v.t,bizTypeList:[]}},computed:(0,a.Z)({},(0,p.mapGetters)({primaryColor:"getPrimaryColor"})),mounted(){this.businessTypes();const{type:t}=this.$route.query;localStorage.getItem("approvalStatus")?this.params.status=localStorage.getItem("approvalStatus"):localStorage.getItem("approvalBizType")&&(this.params.bizType=localStorage.getItem("approvalBizType")),this.type=t},methods:{async businessTypes(){const{data:t}=await g.Z.approvalsApi.getTypeList();this.bizTypeList=t.data},formatType(t){if(t.bizName)return t.bizName;for(let e=0;e<this.bizTypeList.length;e++){const s=this.bizTypeList[e];if(s.bizType===t.businessType)return s.bizName}return"--"},onSelect(t){this.activeAction=t.id,this.params.keyword="",this.params.createUserId="",this.params.title=""},showPopup(){this.show=!0},handelOk(t){this.showCompany=!1,this.params.keyword=t.users.user_name,this.params.createUserId=t.users.id,this.onRefresh()},onTabChange(){this.onRefresh()},onFocus(){this.activeAction&&(this.params.createUserId&&(this.config.pickedUsers=[{id:this.params.createUserId}]),this.showCompany=!0)},onConfirm(){this.show=!1,this.params.status=localStorage.getItem("approvalStatus"),this.params.bizType=localStorage.getItem("approvalBizType"),this.onRefresh()},onClear(){this.params.keyword="",this.params.createUserId="",this.config.pickedUsers=[],this.onRefresh()},onRefresh(){this.params=(0,a.Z)((0,a.Z)({},this.params),{},{pageNumber:0}),this.loading=!0,this.finished=!1,this.list=[],this.loading&&this.onLoad()},async onLoad(){if(this.params.pageNumber+=1,this.activeAction||(this.params.title=this.params.keyword),"me"===this.type){const{data:t}=await g.Z.approvalsApi.getWorkflowList(this.params),{list:e,total:s}=t.data;this.list=[...this.list,...e],this.loading=!1,this.list.length>=s&&(this.finished=!0)}else{const{data:t}=await g.Z.approvalsApi.getWorkflowListWaitDone((0,a.Z)((0,a.Z)({},this.params),{},{status:"approval_complete"===this.params.status?"finish":"approval_revoked"===this.params.status?"abolish":"approval_going"===this.params.status?"underway":"",type:"pending"===this.type?"wait":"done"})),{list:e,total:s}=t.data;this.list=[...this.list,...e],this.loading=!1,this.list.length>=s&&(this.finished=!0)}},toApproval(t){this.$router.push({path:"/approved-process",query:{instanceId:t.instanceId,approvalType:this.type}})}}},k=$,S=(0,C.Z)(k,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"approval-list"},[s("van-search",{attrs:{readonly:1===t.activeAction&&t.showCompany,"show-action":"","clear-trigger":"always",placeholder:t.$t("approvals.searchName")},on:{search:t.onRefresh,clear:t.onClear,focus:t.onFocus},scopedSlots:t._u([{key:"label",fn:function(){return[s("div",[s("van-popover",{attrs:{trigger:"click",actions:t.actions},on:{select:t.onSelect},scopedSlots:t._u([{key:"reference",fn:function(){return[s("div",{staticClass:"searchPop"},[t._v(" "+t._s(t.actions[t.activeAction].text)+" "),s("van-icon",{staticClass:"aicon",attrs:{name:"arrow-down"}})],1)]},proxy:!0}]),model:{value:t.showPopover,callback:function(e){t.showPopover=e},expression:"showPopover"}})],1)]},proxy:!0},{key:"left-icon",fn:function(){return[s("div",{staticStyle:{height:"100%",borderLeft:"1px solid #ebedf0"}})]},proxy:!0},{key:"action",fn:function(){return[s("van-button",{attrs:{icon:"filter-o",type:"default",size:"small"},on:{click:function(e){return t.showPopup()}}},[t._v(t._s(t.$t("course.filter")))])]},proxy:!0}]),model:{value:t.params.keyword,callback:function(e){t.$set(t.params,"keyword",e)},expression:"params.keyword"}}),s("van-list",{staticClass:"alist",attrs:{"loading-text":t.$t("common.loading"),finished:t.finished,"finished-text":t.finished&&0===t.list.length?"":t.$t("common.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[t._l(t.list,(function(e){return s("div",{key:e.id,staticClass:"aitem",on:{click:function(s){return t.toApproval(e)}}},[s("div",{staticClass:"item-info"},[s("p",{staticClass:"title"},[s("span",[t._v(t._s(t.formatType(e))+" ")]),s("span",{staticClass:"address"},[t._v(t._s(t._f("formatDate")(e.updateTime)))])]),s("p",{staticClass:"address"},[t._v(t._s("me"===t.type?e.title:e.taskName))])]),s("van-divider",{staticStyle:{marginBottom:"12px"}}),s("div",{staticClass:"item-tool"},[s("div",{staticClass:"free"},[s("van-image",{staticClass:"avatar",attrs:{src:e.avatar||t.defaultAvatar,fit:"fill"}}),s("span",{staticClass:"user"},[t._v(t._s(t.$t("approvals.bySubmit",{params:e.createUser})))])],1),e.status||e.fStatus?s("span",{style:{color:t.approvalStatusTab[e.status?e.status:"finish"===e.fStatus?JSON.parse(e.taskContent).operation_type:e.fStatus].color}},[t._v(t._s(t.$t(t.approvalStatusTab[e.status?e.status:"finish"===e.fStatus?JSON.parse(e.taskContent).operation_type:e.fStatus].lang)))]):t._e()])],1)})),t.finished&&0===t.list.length?s("van-empty",{attrs:{description:t.$t("approvals.noDataTextTip")}}):t._e()],2),s("van-popup",{style:{height:"90%"},attrs:{round:"",position:"bottom","safe-area-inset-bottom":""},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[t.show?s("approval-filter",{attrs:{type:t.type,status:t.params.status,"biz-type":t.params.bizType},on:{hidePopup:function(e){t.show=!1},onConfirm:t.onConfirm}}):t._e()],1),s("van-popup",{style:{height:"80%"},attrs:{position:"bottom"},model:{value:t.showCompany,callback:function(e){t.showCompany=e},expression:"showCompany"}},[t.showCompany?s("cl-choose-user",{attrs:{config:t.config},on:{onSuccess:t.handelOk,cancel:function(e){t.showCompany=!1}}}):t._e()],1)],1)}),[],!1,null,"088514cf",null).exports},88095:(t,e,s)=>{s.r(e),s.d(e,{default:()=>Z});var a=s(95082),i=(s(76424),s(41942)),o=(s(71404),s(57141)),r=(s(73474),s(74755)),n=(s(22894),s(83608)),c=(s(93787),s(20090)),l=(s(29941),s(64168)),u=(s(52355),s(29233)),d=(s(25773),s(35791)),h=(s(33948),s(26294)),p=s(28387),m=s(32900),g=s(74022),v=s(76953),f=(s(47601),s(44951)),y=(s(31930),s(94907)),_=(s(48444),s(84014)),C=(s(30033),s(87837)),I=s(78368),b={name:"AddressBook",components:{[C.Z.name]:C.Z,[_.Z.name]:_.Z,[y.Z.name]:y.Z,[c.Z.name]:c.Z,[f.Z.name]:f.Z,[d.Z.name]:d.Z},props:{config:{default:()=>({limitTips:"",pickedUsers:[],asyncLoad:!0,maxUsers:20}),type:Object},templateId:{type:String,default:""},version:{type:Number,default:0},nodeNo:{type:String,default:""}},data(){return{loadUser:!1,isCheckAll:!1,checkedUser:this.config.pickedUsers,checkedUserCount:this.config.pickedUsers.length,showCheckedDisplay:!1,userList:[],avatar:I}},computed:(0,a.Z)({},(0,h.mapGetters)({primaryColor:"getPrimaryColor"})),watch:{checkedUserCount(t){this.isCheckAll=t===this.userList.length}},mounted(){this.getUsersList()},methods:{async getUsersList(){this.loadUser=!0,this.showLoading();let{data:t}=await p.Z.approvalsApi.getNodeUsers({templateId:this.templateId,version:this.version,nodeNo:this.nodeNo});const e=t.data;e&&e.length&&(this.loadUser=!1,this.hideLoading(),e.forEach((t=>{t.isChecked=this.checkedUser.some((e=>t.id===e.id))})),e.length===this.checkedUser.length&&(this.checkedUserCount=e.length),this.userList=e)},toggleCheckedAll(){let{isCheckAll:t}=this;if(!t&&this.userList.length>this.config.maxUsers)return this.$toast(this.config.limitTips||this.$t("chooseUser.limitTips",{maxUsers:this.config.maxUsers})),!1;this.userList.forEach((e=>{e.isChecked=!t})),t?(this.checkedUserCount=0,this.checkedUser=[]):(this.checkedUserCount=this.userList.length,this.checkedUser=this.userList)},toggleCheckUser(t){let e=this.userList[t];if(e.isChecked){if(!this.isCheckAll&&this.checkedUserCount-1>this.config.maxUsers)return this.$toast(this.config.limitTips||this.$t("chooseUser.limitTips",{maxUsers:this.config.maxUsers})),!1;this.checkedUserCount--}else{if(1===this.config.maxUsers)this.checkedUserCount=0,this.isCheckAll=!1,this.userList.forEach((t=>{t.isChecked=!1}));else if(!this.isCheckAll&&this.checkedUserCount+1>this.config.maxUsers)return this.$toast(this.config.limitTips||this.$t("chooseUser.limitTips",{maxUsers:this.config.maxUsers})),!1;this.checkedUserCount++}this.userList[t].isChecked=!e.isChecked},handleSubmit(){0!==this.checkedUserCount?this.$emit("onSuccess",{selectedCount:this.checkedUserCount,users:this.userList.filter((t=>t.isChecked))}):this.$toast(this.$t("chooseUser.noOnlySelTips"))},showLoading(){this.$toast.loading({forbidClick:!0,duration:0})},hideLoading(){this.loadUser||this.$toast.clear()}}},w=s(1001),$=(0,w.Z)(b,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"address-book-single"},[s("div",{staticClass:"list-wrap"},[t.config.maxUsers>1?s("div",{staticClass:"check-all"},[s("van-checkbox",{attrs:{value:t.isCheckAll,name:"isCheckAll","checked-color":t.primaryColor,"icon-size":"23px"},on:{click:t.toggleCheckedAll}},[t._v(t._s(t.$t("chooseUser.checkAll")))])],1):t._e(),s("div",{staticClass:"user-list"},t._l(t.userList,(function(e,a){return s("div",{key:e.id,staticClass:"list-item",on:{click:function(e){return t.toggleCheckUser(a)}}},[s("van-checkbox",{attrs:{value:e.isChecked,name:e.id,"checked-color":t.primaryColor,"icon-size":"23px"}}),s("div",{staticClass:"user-img-name"},[s("van-image",{attrs:{src:e.avator||t.avatar,width:"32",height:"32",fit:"cover",round:""}}),s("span",{staticClass:"names cl-ellipsis"},[t._v(t._s(e.name))])],1)],1)})),0)]),s("div",{staticClass:"bottom-btn"},[s("span",{staticClass:"bottom-left"},[s("span",{staticClass:"selected-tip"},[t._v(t._s(t.$t("chooseUser.selected"))+"：")]),t.checkedUserCount>0?s("span",{staticClass:"dept-person",style:{color:t.primaryColor}},[s("div",[t._v(t._s(t.checkedUserCount)+" "+t._s(t.$t("chooseUser.personCount")))])]):t._e()]),s("span",[s("span",{staticClass:"btns cancel",on:{click:function(e){return e.stopPropagation(),t.$emit("onCancel")}}},[t._v(t._s(t.$t("common.cancel")))]),s("van-button",{attrs:{size:"small",color:t.primaryColor},on:{click:function(e){return e.stopPropagation(),t.handleSubmit.apply(null,arguments)}}},[t._v(t._s(t.$t("common.confirm"))+"("+t._s(t.checkedUserCount)+t._s(t.config.maxUsers?"/"+t.config.maxUsers:"")+")")])],1)])])}),[],!1,null,"0173d4af",null).exports,k=s(52835);const S=[{name:"1",lang:"approvals.specifiedMember"},{name:"2",lang:"approvals.multistageDirector"},{name:"3",lang:"approvals.departmentManager"},{name:"4",lang:"approvals.roles"},{name:"5",lang:"approvals.byMyself"}];var T={components:{[d.Z.name]:d.Z,[u.Z.name]:u.Z,[l.Z.name]:l.Z,[c.Z.name]:c.Z,[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,Approver:g.Z,clChooseUser:v.Z,clChooseUserSingle:$},props:{bizType:{type:String,default:""},businessId:{type:String,default:""},title:{type:String,default:""},content:{type:String,default:""},templates:{type:String,default:""},versions:{type:Number,default:0}},data:()=>({showPicker:!1,templateList:[],currentTemplateObj:{templateId:"",version:"",name:""},flowList:[],currentFlowObj:{},showAll:!1,showAddUsers:!1,showAddUser:!1,config:{multiple:!0,limitTips:"",pickedUsers:[],pickedDepartments:[],disabledUsers:[],disabledDepartments:[],requiredUsers:[],requiredDepartments:[],responseUserOnly:!0,startWithDepartmentId:"",asyncLoad:!0,filterAuth:!1,maxUsers:20},version:"",nodeNo:"",showDepartmentPicker:!1,departmentList:[],currentDepartment:{deptId:"",deptName:""}}),computed:(0,a.Z)({},(0,h.mapGetters)({primaryColor:"getPrimaryColor"})),created(){},async mounted(){await this.getDepartments(),this.getTemplates()},methods:{async getTemplates(){if(this.templates&&this.versions)this.currentTemplateObj={templateId:this.templates,version:this.versions},this.getFlowList();else{const{data:t}=await p.Z.approvalsApi.getTemplatesList({bizType:this.bizType});this.templateList=t.data,this.currentTemplateObj=this.templateList[0]||{},this.getFlowList()}},async getFlowList(){const{data:t}=await p.Z.approvalsApi.previewTemplates({templateId:this.currentTemplateObj.templateId,version:this.currentTemplateObj.version,deptId:this.currentDepartment.deptId});this.flowList=t.data.map((t=>("2"===t.approvalType?t.approvers=[{id:t.node_id,name:this.$t("approvals.multistageDirector")}]:"3"===t.approvalType&&(t.approvers=[{id:t.node_id,name:this.$t("approvals.departmentManager")}]),t)))},getApprovalTypeName(t,e){return 0===e?this.$t("approvals.initiator"):this.$t(S.filter((e=>e.name===t))[0].lang)},getSignTypeDesc(t,e,s){if(!(s>0))return"";for(let a of k.H)if(a.name===t)return"1"===e||"5"===e?this.$t(a.lang,{param:s}):this.$t(a.moreLang)},onShowPicker(){this.showPicker=!0},handleAdd(t){this.currentFlowObj=t,"one"===t.submitAssignType?this.config.maxUsers=1:this.config.maxUsers=20,this.config.pickedUsers=t.approvers,"true"===t.isAllCompany?this.showAddUsers=!0:this.showAddUser=!0},handleAll(t){this.currentFlowObj=t,this.showAll=!0},hanleRemove(t,e){const s=this.flowList.findIndex((e=>e.nodeNo===t.nodeNo));this.flowList[s].approvers.splice(e,1)},onConfirm(t){this.showPicker=!1,this.currentTemplateObj=t,this.getFlowList()},handelOk(t){"true"===this.currentFlowObj.isAllCompany?(this.flowList.forEach((e=>{e.nodeId===this.currentFlowObj.nodeId&&(e.approvers=t.users.map((t=>(0,a.Z)((0,a.Z)({},t),{},{name:t.name||t.user_name}))))})),this.showAddUsers=!1):(this.flowList.forEach((e=>{e.nodeId===this.currentFlowObj.nodeId&&(e.approvers=t.users)})),this.showAddUser=!1)},async onSubmit(){const t=this.flowList.filter((t=>"5"===t.approvalType));if(t.length>0&&t.every((t=>0===t.approvers.length)))return this.$toast.fail(this.$t("approvals.approverTip")),!1;try{await p.Z.approvalsApi.submitWorkflow({templateId:this.currentTemplateObj.templateId,version:this.currentTemplateObj.version,title:this.title,assignNodeList:t.map((t=>({node_id:t.nodeId,user_list:t.approvers.map((t=>t.id))}))),dataId:this.businessId,content:this.content,deptId:this.currentDepartment.deptId}),this.$toast.success(this.$t("common.submitSuccess")),this.$emit("onSuccess")}catch(t){console.error(t)}},async getDepartments(){const{data:t}=await m.Z.getUserDepartmentNodes();"200000"===t.code&&(this.departmentList=t.data,this.currentDepartment={deptId:t.data[0].id,deptName:t.data[0].name})},onDepartmentConfirm(t){this.currentDepartment={deptId:t.id,deptName:t.name},this.showDepartmentPicker=!1,this.getFlowList()}}},Z=(0,w.Z)(T,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"approval-process"},[s("div",{staticClass:"my-flow"},[s("h5",[t._v(t._s(t.$t("approval.initiateApproval")))]),s("div",{staticClass:"my-flow-select"},[s("van-field",{attrs:{"is-link":"",required:"",readonly:"",name:"picker",label:t.$t("approvals.approvalDepartment")},on:{click:function(e){t.showDepartmentPicker=!0}},model:{value:t.currentDepartment.deptName,callback:function(e){t.$set(t.currentDepartment,"deptName",e)},expression:"currentDepartment.deptName"}}),t.templates&&t.versions?t._e():s("van-field",{attrs:{readonly:"",clickable:"",label:"",value:t.currentTemplateObj.name,placeholder:t.$t("approvals.templatePlaceholder"),"is-link":t.templateList.length>1},on:{click:function(e){return t.onShowPicker()}}})],1),s("van-popup",{attrs:{round:"",position:"bottom"},model:{value:t.showPicker,callback:function(e){t.showPicker=e},expression:"showPicker"}},[s("van-picker",{attrs:{"show-toolbar":"",columns:t.templateList,"value-key":"name","cancel-button-text":t.$t("common.cancel"),"confirm-button-text":t.$t("common.confirm")},on:{cancel:function(e){t.showPicker=!1},confirm:t.onConfirm}})],1),s("van-steps",{attrs:{direction:"vertical",active:t.flowList.length}},t._l(t.flowList,(function(e,a){return s("van-step",{key:e.id,staticClass:"flow-step"},[s("div",[s("p",{staticClass:"title"},[t._v(t._s(t.getApprovalTypeName(e.approvalType,a)))]),s("p",{staticClass:"name"},[t._v(t._s(t.getSignTypeDesc(e.signType,e.approvalType,e.approvers.length)))])]),s("div",[s("Approver",{attrs:{"is-fold":!0,users:e.approvers,"sign-type":e.signType,edit:"5"===e.approvalType},on:{onAll:function(s){return t.handleAll(e)},onAdd:function(s){return t.handleAdd(e)},onRemove:function(s){return t.hanleRemove(e,s)}}})],1)])})),1)],1),s("div",{staticClass:"footer"},[s("van-button",{attrs:{type:"primary",plain:"",color:t.primaryColor},on:{click:function(e){return t.$emit("onCancel")}}},[t._v(t._s(t.$t("common.cancel")))]),s("van-button",{attrs:{type:"primary",color:t.primaryColor},on:{click:t.onSubmit}},[t._v(t._s(t.$t("common.submit")))])],1),s("van-popup",{staticClass:"my-popup-all",style:{height:"80%"},attrs:{position:"bottom"},model:{value:t.showAll,callback:function(e){t.showAll=e},expression:"showAll"}},[s("Approver",{attrs:{"is-fold":!1,users:t.currentFlowObj.approvers,"sign-type":t.currentFlowObj.signType,edit:"5"===t.currentFlowObj.approvalType},on:{onAdd:function(e){return t.handleAdd(t.currentFlowObj)},onRemove:function(e){return t.hanleRemove(t.currentFlowObj,e)}}})],1),s("van-popup",{style:{height:"80%"},attrs:{position:"bottom"},model:{value:t.showAddUsers,callback:function(e){t.showAddUsers=e},expression:"showAddUsers"}},[t.showAddUsers?s("cl-choose-user",{attrs:{config:t.config},on:{onSuccess:t.handelOk,cancel:function(e){t.showAddUsers=!1}}}):t._e()],1),s("van-popup",{style:{height:"80%"},attrs:{position:"bottom"},model:{value:t.showAddUser,callback:function(e){t.showAddUser=e},expression:"showAddUser"}},[t.showAddUser?s("cl-choose-user-single",{attrs:{config:t.config,"template-id":t.currentTemplateObj.templateId,version:t.currentTemplateObj.version,"node-no":t.currentFlowObj.nodeNo},on:{onSuccess:t.handelOk,onCancel:function(e){t.showAddUser=!1}}}):t._e()],1),s("van-popup",{attrs:{position:"bottom"},model:{value:t.showDepartmentPicker,callback:function(e){t.showDepartmentPicker=e},expression:"showDepartmentPicker"}},[s("van-picker",{attrs:{columns:t.departmentList,"value-key":"name","show-toolbar":"","cancel-button-text":t.$t("common.cancel"),"confirm-button-text":t.$t("common.confirm")},on:{confirm:t.onDepartmentConfirm,cancel:function(e){t.showDepartmentPicker=!1}}})],1)],1)}),[],!1,null,"460363c0",null).exports},56069:(t,e,s)=>{s.r(e),s.d(e,{default:()=>st});var a=s(95082),i=(s(76424),s(41942)),o=(s(71404),s(57141)),r=(s(73474),s(74755)),n=(s(93787),s(20090)),c=(s(47601),s(44951)),l=(s(23307),s(81392)),u=(s(25773),s(35791)),d=(s(38862),s(33948),s(74916),s(15306),s(26294)),h=s(28387),p=s(22648),m=s(52835),g=(s(21790),s(24031)),v=(s(91058),s(26699),s(57658),s(27484)),f=s.n(v),y=s(57969);const _=[{key:"bizType",dataIndex:"bizType",title:`${y.Z.t("training.type")}:`},{key:"name",dataIndex:"name",title:`${y.Z.t("training.name")}:`},{key:"create_user_name",dataIndex:"create_user_name",title:`${y.Z.t("training.submitOne")}:`},{key:"create_time",dataIndex:"create_time",title:`${y.Z.t("training.submitTime")}:`}],C=[{key:"bizType",dataIndex:"bizType",title:`${y.Z.t("training.type")}:`},{key:"create_user_name",dataIndex:"create_user_name",title:`${y.Z.t("training.submitOne")}:`},{key:"create_time",dataIndex:"create_time",title:`${y.Z.t("training.submitTime")}:`}],I={training_temp_plan:y.Z.t("training.trainingTempPlan"),training_month_plan:y.Z.t("training.trainingMonthPlan"),training_annual_plan:y.Z.t("training.trainingAnnualPlan"),training_demand:y.Z.t("training.trainingDemand")},b={online:y.Z.t("training.online"),offline:y.Z.t("training.offline"),blend:y.Z.t("training.hybrid"),other:y.Z.t("training.other")};s(70934);var w=s(84649),$=s.n(w),k=s(18715),S=s(68092),T=s(91555),Z={name:"TrainingDetailTemplate",components:{[u.Z.name]:u.Z,[c.Z.name]:c.Z},props:{instanceId:{type:String,default:""},workflowInfo:{type:Object,default:()=>{}}},data:()=>({operationImg:T,operationId:"",operationUserId:"",isViewOperation:!0,operationContent:""}),watch:{instanceId:{handler(t){this.getCustomOperationId(t)},deep:!0,immediate:!0}},mounted(){this.setOperationContent()},methods:{setOperationContent(){try{let t=this.workflowInfo.content?JSON.parse(this.workflowInfo.content):{};this.operationContent="object"==typeof t&&t?t.operation_content:""}catch(t){this.operationContent=this.workflowInfo.content||""}},getCustomOperationId(t){t&&k.Z.getCustomOperationId(t).then((t=>{t.data&&"0"===String(t.data.code)?(this.operationId=t.data.data.operation_id,this.operationUserId=t.data.data.user_id,this.isViewOperation=!1):this.isViewOperation=!0}))},onViewOperationClick(){this.$router.push({path:`study-resource/operation/view?id=${this.operationId}&operationSource=qualification&mapId=&viewFlag=true&userId=${this.operationUserId}`})}}},x=s(1001),P=(0,x.Z)(Z,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.isViewOperation?t._e():s("div",{staticClass:"operation-main"},[s("div",{staticClass:"content operation"},[s("div",{staticClass:"title"},[s("span",{staticClass:"title-name"},[t._v(" "+t._s(t.$t("training.associatedOperation"))+" ")]),s("div",{staticClass:"title-button"},[s("van-button",{staticClass:"task-btn",attrs:{disabled:t.isViewOperation,type:"info",size:"small",icon:"todo-list-o",plain:"",hairline:"",round:""},on:{click:t.onViewOperationClick}},[t._v(t._s(t.$t("training.preview"))+" ")])],1)]),s("div",{staticClass:"main"},[s("div",{staticClass:"main-icon"},[s("van-image",{attrs:{src:t.operationImg,fit:"cover",width:"48",height:"48"}})],1),s("div",{staticClass:"right-text"},[s("span",{staticClass:"top-text"},[t._v(" "+t._s(t.$t("training.operationName")+"："+(t.workflowInfo.bizTitle||""))+" ")]),s("span",{staticClass:"bottom-text"},[t._v(" "+t._s(t.$t("training.operationRequirement")+"："+(t.operationContent||""))+" ")])])])])])])}),[],!1,null,"1af96540",null).exports,D={name:"TrainingDetailTemplate",components:{[g.Z.name]:g.Z,VeTable:$(),[c.Z.name]:c.Z,[u.Z.name]:u.Z,[c.Z.name]:c.Z,OperationTemplate:P},props:{id:{type:String,default:""},bizType:{type:String,default:""},content:{type:String,default:""},instanceId:{type:String,default:""},workflowInfo:{type:Object,default:()=>{}}},data(){const t=this.$createElement;return{fieldsMap:_,huaFieldsMap:C,titleMap:I,trainingData:{},taskDetail:{},tableColumns:[{title:"training_demand"===this.bizType?this.$t("training.trainingDemand"):this.$t("training.trainingContent"),field:"name",key:"name",fixed:"left",width:120,align:"center",renderBodyCell:({row:e})=>t("div",{class:"center-space"},[e.name||"-"])},{title:this.$t("training.type"),field:"category",key:"category",width:120,align:"center",renderBodyCell:({row:e})=>t("div",{class:"center-space"},[e.category||"-"])},{title:this.$t("training.form"),field:"form",key:"form",width:100,align:"center",renderBodyCell:({row:e})=>t("div",{class:"small-space"},[e.form?b[e.form]:"-"])},{title:this.$t("training.trainingObject"),field:"training_object",key:"training_object",width:100,align:"center",renderBodyCell:({row:e})=>t("div",{class:"center-space"},[e.training_object||"-"])},{title:this.$t("training.target"),field:"target",key:"target",width:100,align:"center",renderBodyCell:({row:e})=>t("div",{class:"small-space"},[e.target||"-"])},{title:this.$t("training.address"),field:"address",key:"address",width:100,align:"center",renderBodyCell:({row:e})=>t("div",{class:"small-space"},[e.address||"-"])},{title:this.$t("training.sessionQuantity"),field:"session_quantity",key:"session_quantity",width:100,align:"center",renderBodyCell:({row:e})=>{const s=e.session_quantity||0===e.session_quantity?e.session_quantity:"-";return t("div",{class:"small-space"},[s])}},{title:this.$t("training.classHours"),field:"class_hours",key:"class_hours",width:100,align:"center",renderBodyCell:({row:e})=>{const s=e.class_hours||0===e.class_hours?e.class_hours:"-";return t("div",{class:"small-space"},[s])}},{title:this.$t("training.estimatedCost"),field:"estimated_cost",key:"estimated_cost",width:100,align:"center",renderBodyCell:({row:e})=>{const s=e.estimated_cost||0===e.estimated_cost?e.estimated_cost:"-";return t("div",{class:"small-space"},[s])}},{title:this.$t("training.planUserQuantity"),field:"plan_user_quantity",key:"plan_user_quantity",width:100,align:"center",renderBodyCell:({row:e})=>{const s=0===e.plan_user_quantity||e.plan_user_quantity?e.plan_user_quantity:"-";return t("div",{class:"small-space"},[s])}},{title:this.$t("training.departmentName"),field:"department_name",key:"department_name",width:100,align:"center",renderBodyCell:({row:e})=>t("div",{class:"small-space"},[e.department_name||"-"])},{title:this.$t("training.directors"),field:"directors",key:"directors",width:100,align:"center",renderBodyCell:({row:e})=>{const s=e.directors.length>0?e.directors.map((t=>t.name)).join(","):"-";return t("div",{class:"small-space"},[s])}},{title:this.$t("training.executors"),field:"executors",key:"executors",width:100,align:"center",renderBodyCell:({row:e})=>{const s=e.executors.length>0?e.executors.map((t=>t.name)).join(","):"-";return t("div",{class:"small-space"},[s])}},{title:this.$t("training.trainingMonth"),field:"training_month",key:"training_month",width:120,align:"center",renderBodyCell:({row:e})=>t("div",{class:"center-space"},[e.training_month||"-"])},{title:this.$t("training.createUserName"),field:"create_user_name",key:"create_user_name",width:100,align:"center",renderBodyCell:({row:e})=>t("div",{class:"small-space"},[e.create_user_name?e.create_user_name:"-"])},{title:this.$t("training.createTime"),field:"create_time",key:"create_time",width:150,align:"center",renderBodyCell:({row:e})=>{const s=e.create_time?f()(parseInt(e.create_time)).format("YYYY-MM-DD HH:mm"):"-";return t("div",{class:"big-space"},[s])}}],isHuaLaiShi:(0,S.UI)("PRIVACY_HLS_APPROVAL_MANAGE")}},mounted(){["training_temp_plan","training_month_plan"].includes(this.bizType)&&this.queryStudyTask();const t=this.content?JSON.parse(this.content):{};this.trainingData=this.content?t:{}},methods:{queryStudyTask(){const t=this.content?JSON.parse(this.content):{};Object.keys(t).length>0&&t.plan_id&&k.Z.getTrainingToTaskDetail({planId:t.plan_id}).then((t=>{if("200000"===t.data.code&&t.data.data.length>0){const e=t.data.data;this.taskDetail=(0,a.Z)((0,a.Z)({},e[0]),{},{beginTime:f()(e[0].begin_time).format("YYYY.MM.DD"),endTime:f()(e[0].end_time).format("YYYY.MM.DD")})}}))},handleToStudyDetail(){this.$router.push({path:`/training/study-detail?planId=${this.taskDetail.task_id}`})},getTableDataSource(t){return{training_annual_plan:t.content_list&&t.content_list.length>0?t.content_list:[],training_demand:[t],training_temp_plan:[t],training_month_plan:[t]}[this.bizType]},getStringTime:t=>t?f()(parseInt(t)).format("YYYY-MM-DD HH:mm"):"-",getTableColumns(){let t=[];return["training_temp_plan","training_month_plan"].includes(this.bizType)?this.tableColumns.forEach((e=>{"session_quantity"!==e.key&&t.push(e)})):t=this.tableColumns,t},getTrainingTitle(){return{training_annual_plan:this.$t("training.planDetail"),training_demand:this.$t("training.trainingDetail"),training_temp_plan:this.$t("training.planDetail"),training_month_plan:this.$t("training.planDetail")}[this.bizType]}}},L=(0,x.Z)(D,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.isHuaLaiShi?t._e():s("div",{staticClass:"detail"},[s("div",{staticClass:"detail-info"},[s("h4",{staticClass:"detail-info-name"},[t._v(t._s(t.trainingData.training_year||t.trainingData.plan_year)+t._s(t.$t("training.annual"))+t._s(t.titleMap[t.bizType]))]),s("div",{staticClass:"detail-info-map"},t._l(t.fieldsMap,(function(e){return s("div",{key:e.dataIndex,staticClass:"detail-info-item"},[s("p",{class:e.key+" detail-info-title"},[t._v(t._s(e.title))]),"bizType"===e.key?s("p",{staticClass:"detail-info-title detail-info-field"},[t._v(t._s(t.titleMap[t.bizType]))]):s("p",{staticClass:"detail-info-title detail-info-field"},[t._v(t._s("create_time"===e.key?t.getStringTime(t.trainingData[e.key]):t.trainingData[e.key]))])])})),0)])]),t.isHuaLaiShi?s("div",{staticClass:"detail"},[s("div",{staticClass:"detail-info"},[s("h4",{staticClass:"detail-info-name"},[t._v(t._s(t.workflowInfo.bizTitle))]),s("div",{staticClass:"detail-info-map"},t._l(t.huaFieldsMap,(function(e){return s("div",{key:e.dataIndex,staticClass:"detail-info-item"},[s("p",{class:e.key+" detail-info-title"},[t._v(t._s(e.title))]),"bizType"===e.key?s("p",{staticClass:"detail-info-title detail-info-field"},[t._v(" "+t._s(t.workflowInfo.bizName)+" ")]):"create_time"===e.key?s("p",{staticClass:"detail-info-title detail-info-field detail-info-time"},[t._v(" "+t._s(t.getStringTime(t.workflowInfo.createTime))+" ")]):"name"===e.key?s("p",{staticClass:"detail-info-title detail-info-field"},[t._v(" "+t._s(t.workflowInfo.bizTitle)+" ")]):"create_user_name"===e.key?s("p",{staticClass:"detail-info-title detail-info-field"},[t._v(" "+t._s(t.workflowInfo.userName)+" ")]):t._e()])})),0)])]):t._e(),t.isHuaLaiShi?s("OperationTemplate",{attrs:{"instance-id":t.instanceId,"workflow-info":t.workflowInfo}}):t._e(),t.isHuaLaiShi?t._e():s("div",{staticClass:"training"},[s("div",{staticClass:"training-content"},[s("h4",{staticClass:"training-name"},[t._v(t._s(t.getTrainingTitle()))]),s("div",{staticClass:"training-table"},[s("ve-table",{attrs:{"scroll-width":600,columns:t.getTableColumns(),"table-data":t.getTableDataSource(t.trainingData),"fixed-header":!0,"max-height":"150","row-style":t.training-t.item-t.line}}),s("div",{directives:[{name:"show",rawName:"v-show",value:0===t.getTableDataSource(t.trainingData).length,expression:"getTableDataSource(trainingData).length === 0"}],staticClass:"empty-data"},[t._v(t._s(t.$t("training.noData")))])],1)])]),["training_temp_plan","training_month_plan"].includes(t.bizType)&&Object.keys(t.taskDetail).length>0?s("div",{staticClass:"task"},[s("div",{staticClass:"task-content"},[s("h4",{staticClass:"task-name"},[t._v(t._s(t.$t("training.associated")))]),s("div",{staticClass:"task-preview"},[s("van-image",{staticClass:"task-image",attrs:{width:"50",height:"50",src:"https://gsdn.coolcollege.cn/assets/kuxueyuan/img/icon_preview.png"}}),s("div",{staticClass:"task-detail"},[s("p",{staticClass:"task-text task-title"},[t._v(t._s(t.$t("training.taskName"))+": "+t._s(t.taskDetail.title||"-"))]),s("p",{staticClass:"task-text"},[t._v(t._s(t.$t("training.validity"))+"："+t._s(t.taskDetail.beginTime||"-")+"-"+t._s(t.taskDetail.endTime||"-"))])]),s("van-button",{staticClass:"task-btn",attrs:{type:"info",size:"small",icon:"todo-list-o",plain:"",hairline:"",round:""},on:{click:t.handleToStudyDetail}},[t._v(t._s(t.$t("training.preview")))])],1)])]):t._e()],1)}),[],!1,null,"097f3f64",null).exports,A=s(55733),E=(s(29941),s(64168)),R=(s(52355),s(29233)),F=s(56955),q=s(32900),N=s(69119),O=s(83913),M=s(95084),B=s(39819),V={components:{[u.Z.name]:u.Z,[R.Z.name]:R.Z,[E.Z.name]:E.Z,[c.Z.name]:c.Z,[g.Z.name]:g.Z,ClFold:O.Z,ClAttachment:M.Z,Preview:B.Z},filters:{courseFilters(t,e){var s;return null===(s=e.find((e=>e.value===t)))||void 0===s?void 0:s.text},formatDate:function(t){return(0,p.p6)(t,"yyyy.MM.dd hh:mm")}},props:{content:{type:String,default:""},workflowInfo:{type:Object,default:()=>({})}},data:function(){return{courseId:"",classifyType:"",courseDetails:{},fullDeptPath:"",COURSE_ORIGINAL:N.ci,COURSE_STUDY_TYPE:N.rG,COURSE_DOWNLOAD:N.Fq,COURSE_COMMENT_SWITCH:N.J_,COURSE_FINISH_STANDARD:N.Bn,COURSE_SYNC_PROGRESS:N.Pk,COURSE_IS_All:N.Uw}},computed:{isAllList(){const t=this.courseDetails.departmentList||[],e=this.courseDetails.userList||[];return t.concat(e)}},mounted(){const t=JSON.parse(this.content),{courseId:e,classifyType:s}=t;this.courseId=e,this.classifyType=s,this.getCourseDetailsData(),this.getUserFullDeptPath()},methods:{async getCourseDetailsData(){let t=await F.Z.getCourseApprovalInfo({id:this.courseId,classifyType:this.classifyType});if(this.$toast.clear(),0===t.code)this.courseDetails=t.data;else{const{data:e}=t.message;"enterpriseapi.4003"===e.code?this.$dialog.confirm({title:this.$t("promptMessage.warmTips"),message:this.$t("course.courseVisibleTips"),showCancelButton:!1,confirmButtonText:this.$t("common.iKnow")}).then((()=>{this.$router.go(-1)})):"enterpriseapi.4001"!==e.code&&"enterpriseapi.503006"!==e.code||this.$dialog.confirm({title:this.$t("course.resourceNotFound"),showCancelButton:!1,confirmButtonText:this.$t("common.iKnow"),confirmButtonColor:this.primaryColor}).then((()=>{this.$router.go(-1)}))}},async getUserFullDeptPath(){const{data:t}=await q.Z.getUserFullDeptPath(this.workflowInfo.list[0].users[0].userId);"200000"===t.code&&(this.fullDeptPath=t.data)}}},U=(0,x.Z)(V,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"course-approval-details"},[s("van-cell-group",[s("van-cell",{staticClass:"approval-info",attrs:{size:"large"},scopedSlots:t._u([{key:"title",fn:function(){return[s("h4",{staticClass:"approval-info-title"},[s("span",[t._v(t._s(t.$t("approvals.approvalCode"))+": "+t._s(t.workflowInfo.instanceId))]),"approval_going"===t.workflowInfo.status?s("van-tag",{staticClass:"approval-btn",attrs:{type:"primary",color:"#E7FDF6","text-color":"#27CE94",size:"medium"}},[t._v(t._s(t.$t("approvals.going")))]):t._e()],1),s("p",[t._v(t._s(t.$t("minePoints.type"))+": "+t._s(t.workflowInfo.bizName))]),s("p",[t._v(t._s(t.$t("training.submitOne"))+": "+t._s(t.workflowInfo.list[0]&&t.workflowInfo.list[0].users[0].userName)+" "),t.fullDeptPath?s("span",[t._v("("+t._s(t.fullDeptPath)+")")]):t._e()]),s("p",[t._v(t._s(t.$t("approval.submitTime"))+": "+t._s(t._f("formatDate")(t.workflowInfo.list[0]&&t.workflowInfo.list[0].users[0].approvalTime)))])]},proxy:!0}])})],1),s("van-cell-group",[s("van-cell",{staticClass:"course-title",attrs:{size:"large"},scopedSlots:t._u([{key:"title",fn:function(){return[s("h4",[t._v(t._s(t.courseDetails.title))])]},proxy:!0}])}),t.courseDetails.resourceList&&t.courseDetails.resourceList.length>0&&("course"===t.classifyType||"imageText"===t.classifyType&&"true"===t.courseDetails.link_switch||"micro_course"===t.classifyType)?s("van-cell",{staticClass:"course-resource",attrs:{title:"true"===t.courseDetails.link_switch?t.$t("course.externalLink"):t.$t("micro_course"===t.classifyType?"micro.microCourseResources":"pageTitle.discoveryCourseList")},scopedSlots:t._u([{key:"label",fn:function(){return[t.courseDetails.resourceList&&t.courseDetails.resourceList.length>0?s("cl-fold",{attrs:{"limit-height":236}},[s("cl-attachment",{attrs:{"attachment-list":t.courseDetails.resourceList,"is-delete":!1}})],1):t._e()]},proxy:!0}],null,!1,2957376421)}):"imageText"===t.classifyType&&"false"===t.courseDetails.link_switch?s("van-cell",{staticClass:"course-resource",attrs:{title:t.$t("course.courseDetailContent")},scopedSlots:t._u([{key:"label",fn:function(){return[t.courseDetails.contentJson?s("cl-fold",{attrs:{"limit-height":236}},[s("Preview",{attrs:{data:t.courseDetails.contentJson}})],1):t._e()]},proxy:!0}])}):t._e(),s("van-cell",{staticClass:"course-cover",attrs:{title:"micro_course"===t.classifyType?t.$t("micro.microDesc"):t.$t("course.courseDetailCover")},scopedSlots:t._u(["micro_course"===t.classifyType?{key:"label",fn:function(){return[t._v(" "+t._s(t.courseDetails.summary)+" ")]},proxy:!0}:null,{key:"extra",fn:function(){return[s("van-image",{attrs:{src:t.courseDetails.cover,height:"100%",radius:"4"}})]},proxy:!0}],null,!0)}),s("van-cell",{attrs:{title:"micro_course"===t.classifyType?t.$t("micro.knowledgeClassify"):t.$t("course.courseDetailCategory"),value:t.courseDetails.courseClassifyName}}),s("van-cell",{attrs:{title:t.$t("lecturer.Lecturer"),value:t.courseDetails.teacherName||"-"}}),"course"===t.classifyType||"imageText"===t.classifyType?s("van-cell",{attrs:{title:t.$t("course.courseDetailOriginal"),value:t._f("courseFilters")(t.courseDetails.original,t.COURSE_ORIGINAL)}}):t._e(),"course"===t.classifyType?s("van-cell",{attrs:{title:t.$t("course.courseStudyType"),value:t._f("courseFilters")(t.courseDetails.studyType,t.COURSE_STUDY_TYPE)}}):t._e(),"course"===t.classifyType||"imageText"===t.classifyType?s("van-cell",{attrs:{title:t.$t("course.label"),value:t.courseDetails.tags||"-"}}):t._e(),"course"===t.classifyType?s("van-cell",{staticClass:"course-introduction",attrs:{title:t.$t("course.courseDetailIntro"),value:t.courseDetails.introduction?null:"-"},scopedSlots:t._u([t.courseDetails.introduction?{key:"label",fn:function(){return[s("div",{staticClass:"text_play",domProps:{innerHTML:t.xss(t._s(t.courseDetails.introduction))}})]},proxy:!0}:null],null,!0)}):t._e(),"course"===t.classifyType?s("van-cell",{attrs:{title:t.$t("course.selfStudyRequirements"),value:t.courseDetails.studyTimeLimit?t.$t("course.documentLearningTime",{time:t.courseDetails.studyTimeLimit}):"-"}}):t._e(),"course"===t.classifyType||"imageText"===t.classifyType?s("van-cell",{attrs:{title:t.$t("course.courseDetailRewardScore"),value:t.courseDetails.credit?t.$t("course.credit",{credit:t.courseDetails.credit}):"-"}}):t._e(),"course"===t.classifyType?s("van-cell",{attrs:{title:t.$t("course.courseDetailDownload"),value:t._f("courseFilters")(t.courseDetails.download,t.COURSE_DOWNLOAD)}}):t._e(),"course"===t.classifyType||"imageText"===t.classifyType?s("van-cell",{attrs:{title:t.$t("course.courseCommentTitle"),value:t._f("courseFilters")(t.courseDetails.commentSwitch,t.COURSE_COMMENT_SWITCH)}}):t._e(),"course"===t.classifyType?s("van-cell",{attrs:{title:t.$t("course.courseDetailComplete"),value:t._f("courseFilters")(t.courseDetails.finishStandard,t.COURSE_FINISH_STANDARD)}}):t._e(),s("van-cell",{attrs:{title:t.$t("course.scheduleSync"),value:t._f("courseFilters")(t.courseDetails.syncProgress,t.COURSE_SYNC_PROGRESS)}}),"micro_course"===t.classifyType&&2===t.courseDetails.isAll?s("van-cell",{attrs:{title:t.$t("course.courseCreatePanelFTRange"),value:t.$t("micro.visibleCount",{count:t.courseDetails.visibleCount})}}):s("van-cell",{attrs:{title:t.$t("course.courseCreatePanelFTRange"),value:t._f("courseFilters")(t.courseDetails.isAll,t.COURSE_IS_All)}}),"course"!==t.classifyType&&"imageText"!==t.classifyType||2!==t.courseDetails.isAll?t._e():s("van-cell",{staticClass:"course-is-all"},[t.isAllList&&t.isAllList.length>0?s("cl-fold",{attrs:{"limit-height":87}},t._l(t.isAllList,(function(e,a){return s("van-tag",{key:a,attrs:{size:"large",color:"#F2F3F5","text-color":"#171A1D"}},[t._v(t._s(e.name))])})),1):t._e()],1)],1)],1)}),[],!1,null,"ebda67d6",null).exports,j={components:{TrainingDetailTemplate:L,TrainingTaskDetail:A.default,CourseApprovalDetails:U},props:{id:{type:String,default:""},bizType:{type:String,default:""},content:{type:String,default:""},instanceId:{type:String,default:""},workflowInfo:{type:Object,default:()=>{}}}},z=(0,x.Z)(j,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[["training_temp_plan","training_month_plan","training_annual_plan","training_demand","hands_on_approval"].includes(t.bizType)?s("TrainingDetailTemplate",{attrs:{"instance-id":t.instanceId,"workflow-info":t.workflowInfo,"biz-type":t.bizType,content:t.content}}):"training_task"===t.bizType?s("TrainingTaskDetail",{attrs:{type:"handle","plan-id":(t.content,JSON.parse(t.content).length>0?JSON.parse(t.content)[0].task_id:"")}}):"course_task"===t.bizType?s("course-approval-details",{attrs:{content:t.content,"workflow-info":t.workflowInfo}}):t._e()],1)}),[],!1,null,"4487e20a",null).exports,H=(s(37254),s(58086)),G=(s(77141),s(30960)),Q=(s(73210),s(77601),s(39145));const{noop:W}=Q.Y;var K={components:{[u.Z.name]:u.Z,[G.Z.name]:G.Z,[n.Z.name]:n.Z,[H.Z.name]:H.Z},props:{approvalName:{type:String,default:""},defaultFormData:{type:Object,default:()=>({status:1})},onSubmit:{type:Function,default:W},workflowInfo:{type:Object,default:()=>({})}},data(){return{formData:this.defaultFormData,pStatus:1,pattern:/^(?:(?![\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF])[\s\S])*$/,isHuaLaiShi:(0,S.UI)("PRIVACY_HLS_APPROVAL_MANAGE"),scoreSetting:{scoreSwitch:!1,score:0}}},computed:(0,a.Z)((0,a.Z)({},(0,d.mapGetters)({primaryColor:"getPrimaryColor"})),{},{scoreShow(){return this.isHuaLaiShi&&"true"===String(this.scoreSetting.scoreSwitch)}}),mounted(){this.isHuaLaiShi&&this.initScoreData()},methods:{initScoreData(){let t=this.workflowInfo.content?JSON.parse(this.workflowInfo.content):{};"object"==typeof t&&t&&(this.scoreSetting={scoreSwitch:t.score_switch,score:t.score_limit})},formatter:t=>t.trim(),validatorSuggest:t=>!(!t||/\uD83C[\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F]/g.test(t))}},J=(0,x.Z)(K,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"approval-comment",class:["approvalCourse"===t.approvalName?"padding-bottom-0":"padding-bottom-53"]},[s("van-form",{ref:"myForm",staticClass:"approval-form",on:{submit:function(e){return t.onSubmit(t.formData)}}},[t.scoreShow?s("van-field",{staticClass:"qScore",attrs:{"label-align":"top",name:"score",label:t.$t("approvals.gradeStudents")},scopedSlots:t._u([{key:"input",fn:function(){return[s("div",{staticClass:"scoreBox",style:{color:"#465DCD"}},[t._v(" "+t._s(t.formData.score)),s("span",{staticClass:"point"},[t._v(t._s(t.$t("myRating.point")))])]),s("van-slider",{attrs:{"bar-height":"5px","active-color":"#465DCD",max:t.scoreSetting.score},model:{value:t.formData.score,callback:function(e){t.$set(t.formData,"score",e)},expression:"formData.score"}}),s("div",{staticClass:"scoreLine"},[s("span",[t._v("0"+t._s(t.$t("myRating.point")))]),s("span",[t._v(t._s(t.scoreSetting.score/2)+t._s(t.$t("myRating.point")))]),s("span",[t._v(t._s(t.scoreSetting.score)+t._s(t.$t("myRating.point")))])])]},proxy:!0}],null,!1,3954074337)}):t._e(),s("van-field",{class:{"field-show-score":t.scoreShow},attrs:{"label-align":"top",rows:t.scoreShow?"4":"7",autosize:"",name:"suggest",maxlength:100,type:"textarea",placeholder:t.$t("approvals.textAreaTips"),"show-word-limit":"",formatter:t.formatter,rules:[{validator:t.validatorSuggest,message:t.$t("common.requiredFieldsTip")}]},model:{value:t.formData.suggest,callback:function(e){t.$set(t.formData,"suggest",e)},expression:"formData.suggest"}}),s("div",{staticClass:"footer"},[1===t.formData.status?s("van-button",{attrs:{type:"primary",block:"",color:t.primaryColor,"native-type":"submit"},on:{click:function(e){t.formData.status=1}}},[t._v(" "+t._s(t.$t("buttons.confirmAgree"))+" ")]):s("van-button",{attrs:{type:"primary",block:"",color:"#D64F4F","native-type":"submit"},on:{click:function(e){t.formData.status=2}}},[t._v(" "+t._s(t.$t("buttons.confirmRefused"))+" ")])],1)],1)],1)}),[],!1,null,"1c604d86",null).exports,Y=s(74022),X=s(78368),tt=s(78551),et={components:{[u.Z.name]:u.Z,[l.Z.name]:l.Z,[c.Z.name]:c.Z,[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,ApprovalTemplate:z,ApprovalComment:J,Approver:Y.Z,SvgIcon:tt.Z},filters:{formatDate:function(t){return(0,p.p6)(t,"yyyy.MM.dd hh:mm")}},data:()=>({content:"",instanceId:"",bizType:"",status:"",approvalType:"",defaultAvatar:X,workflowInfo:{status:"",list:[]},showPopup:!1,formData:{status:1,suggest:"",score:0},valueWithdraw:"",approvalStatus:m.t,showAll:!1,currentFlowObj:{},isHuaLaiShi:(0,S.UI)("PRIVACY_HLS_APPROVAL_MANAGE"),scoreSetting:{scoreSwitch:!1,score:0}}),computed:(0,a.Z)({},(0,d.mapGetters)({primaryColor:"getPrimaryColor"})),created(){},mounted(){const{approvalType:t,instanceId:e}=this.$route.query;this.instanceId=e,this.approvalType=t,this.getWorkflowInfo(e)},methods:{initScoreData(){let t=this.workflowInfo.content?JSON.parse(this.workflowInfo.content):{};"object"==typeof t&&t&&(this.scoreSetting={scoreSwitch:t.score_switch,score:t.score_limit})},async getWorkflowInfo(t){this.$toast.loading({duration:0,forbidClick:!0,message:this.$t("common.loading")});const{data:e}=await h.Z.approvalsApi.getWorkflowInfo(t);this.workflowInfo=e.data,this.status=this.workflowInfo.status,this.bizType=this.workflowInfo.bizType,this.content=this.isHuaLaiShi?JSON.stringify({}):this.workflowInfo.content,this.isHuaLaiShi&&this.initScoreData(),this.$toast.clear()},getSignTypeDesc(t,e){if(e>0)for(const s of m.H)if(s.name===t)return this.$t(s.lang,{param:e});return""},hidePopup(){this.show=!1},onApproval(t){this.onApprovalStatus=t,"withdraw"===t?this.$dialog.confirm({title:"",message:this.$t("approvals.revokedTip"),confirmButtonText:this.$t("common.confirm"),cancelButtonText:this.$t("common.cancel"),confirmButtonColor:this.primaryColor}).then((()=>{this.onSubmit()})).catch((()=>{})):(this.showPopup=!0,"pass"===t?this.formData={status:1,suggest:"",score:0}:"refuse"===t&&(this.formData={status:2,suggest:"",score:0}))},handleAll(t){this.currentFlowObj=t,this.showAll=!0},async onSubmit(t){const{onApprovalStatus:e}=this;if("withdraw"===e)await h.Z.approvalsApi.submitApprovalWithdraw(this.instanceId);else{let s=await h.Z.approvalsApi.executeApproval({taskId:this.workflowInfo.list[this.workflowInfo.list.length-1].taskId,formMsg:t.suggest,personnelId:this.workflowInfo.personnelId,type:"pass"===e?"agree":"refuse",extendInfo:{score:t.score},scoreSetting:this.scoreSetting});if("400005"===s.data.code)return void this.$toast({message:this.$t("approvals.specialText")});if("200000"!==s.data.code)return void this.$toast({message:s.data.msg});this.showPopup=!1}const{showHomeLink:s}=this.$store.state;s&&((0,p.o2)(),this.$router.replace({path:"/home-module"})),this.$router.go(-1)}}},st=(0,x.Z)(et,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"approved-process cl-page-container"},[t.bizType?s("approval-template",{attrs:{content:t.content,"biz-type":t.bizType,"instance-id":t.instanceId,"workflow-info":t.workflowInfo}}):t._e(),s("div",{staticClass:"my-flow"},[s("h5",[t._v(t._s(t.$t("approvals.flow")))]),s("div",{staticClass:"my-steps"},[s("van-steps",{attrs:{direction:"vertical",active:t.workflowInfo.list.length-1}},t._l(t.workflowInfo.list,(function(e,a){return s("van-step",{key:e.id,staticClass:"flow-step",scopedSlots:t._u([{key:"active-icon",fn:function(){return[s("div",{staticClass:"step-icon"},[s("van-image",{attrs:{round:"",src:e.users&&1===e.users.length&&e.users[0].avatar?e.users[0].avatar:t.defaultAvatar,fit:"fill",width:"100%",height:"100%"}})],1)]},proxy:!0},{key:"inactive-icon",fn:function(){return[s("div",{staticClass:"step-icon"},[s("van-image",{attrs:{round:"",src:e.users&&1===e.users.length&&e.users[0].avatar?e.users[0].avatar:t.defaultAvatar,fit:"fill",width:"100%",height:"100%"}})],1)]},proxy:!0}],null,!0)},[s("div",{staticStyle:{flex:"1"}},[s("p",{staticClass:"title"},[t._v(t._s("approval_revoked"===e.status?t.$t("approvals.revoked"):a>0?t.$t("approvals.approver"):t.$t("approvals.apply")))]),"true"!==e.autoPass&&e.users&&1===e.users.length?[s("p",{staticClass:"name"},[t._v(" "+t._s(e.users[0].userName)+" "),0!==a?s("span",{style:{color:t.approvalStatus[e.status].color}},[t._v("("+t._s(t.$t(t.approvalStatus[e.status].otherLang))+")")]):t._e(),"true"===String(t.scoreSetting.scoreSwitch)&&e.users[0].extendInfo&&String(e.users[0].extendInfo.score)?s("span",[s("span",{staticClass:"score",domProps:{textContent:t._s(e.users[0].extendInfo&&e.users[0].extendInfo.score)}}),s("span",{domProps:{textContent:t._s(t.$t("myRating.point"))}})]):t._e()]),e.users[0].formMsg?s("p",{staticClass:"text"},[t._v(t._s(e.users[0].formMsg))]):t._e()]:t._e(),"true"!==e.autoPass&&e.users&&e.users.length>1?s("p",{staticClass:"name"},[t._v(t._s(t.getSignTypeDesc(e.signType,e.users.length)))]):t._e(),"true"===e.autoPass?s("p",{staticClass:"name"},[t._v(t._s(t.$t("approvals.autoPass")))]):t._e(),e.users&&e.users.length>1?s("div",{staticClass:"user"},[s("Approver",{attrs:{"is-fold":!0,users:e.users&&e.users.map((function(t){return Object.assign({},t,{id:t.userId,name:t.userName})})),"sign-type":e.signType,edit:!1,max:4},on:{onAll:function(s){return t.handleAll(e)}}})],1):t._e()],2),e.users&&e.users.length>0&&0!==e.users[0].approvalTime?s("span",{staticClass:"time"},[t._v(t._s(t._f("formatDate")(e.users[0].approvalTime)))]):t._e()])})),1)],1)]),"approval_going"===t.status?["pending"===t.approvalType&&"true"===t.workflowInfo.approvalUser?s("div",{staticClass:"footer"},[s("van-button",{staticStyle:{width:"45%"},attrs:{type:"default",size:"small"},on:{click:function(e){return t.onApproval("refuse")}}},[t._v(t._s(t.$t("buttons.refuse")))]),s("van-button",{staticStyle:{width:"45%"},attrs:{type:"primary",color:t.primaryColor,size:"small"},on:{click:function(e){return t.onApproval("pass")}}},[t._v(t._s(t.$t("buttons.agree")))])],1):"me"===t.approvalType?s("div",{staticClass:"footer"},[s("van-button",{staticStyle:{width:"100%"},attrs:{plain:"",type:"default",size:"small"},on:{click:function(e){return t.onApproval("withdraw")}}},[t._v(t._s(t.$t("buttons.withdraw")))])],1):t._e()]:t._e(),s("van-popup",{style:{height:"372px"},attrs:{closeable:"",round:"",position:"bottom","close-on-click-overlay":!1,"lock-scroll":!1},model:{value:t.showPopup,callback:function(e){t.showPopup=e},expression:"showPopup"}},[t.showPopup?s("approval-comment",{attrs:{"workflow-info":t.workflowInfo,"approval-name":t.bizType,"on-submit":t.onSubmit,"default-form-data":t.formData}}):t._e()],1),""!==t.workflowInfo.status&&"approval_going"!==t.workflowInfo.status?s("svg-icon",{staticClass:"iconfont",class:{"icon-hua-lai-shi":t.isHuaLaiShi},attrs:{"icon-class":t.approvalStatus[t.workflowInfo.status].icon,size:80}}):t._e(),s("van-popup",{staticClass:"my-popup-all",style:{height:"80%"},attrs:{position:"bottom"},model:{value:t.showAll,callback:function(e){t.showAll=e},expression:"showAll"}},[s("Approver",{attrs:{"is-fold":!1,users:t.currentFlowObj.users&&t.currentFlowObj.users.map((function(t){return Object.assign({},t,{id:t.userId,name:t.userName})})),"sign-type":t.currentFlowObj.signType,edit:!1,joint:!1}})],1)],2)}),[],!1,null,"fe7daa22",null).exports},55733:(t,e,s)=>{s.r(e),s.d(e,{default:()=>S});var a={};s.r(a),s.d(a,{getType:()=>p});var i=s(18715),o=(s(52355),s(29233)),r=(s(57658),s(45877)),n={name:"DetailTop",components:{Cell:o.Z,ClCustomUser:r.Z},props:{data:{type:Object,default:()=>({})}},data:function(){return{standered:[],tip:""}},computed:{themeColor(){return this.$store.state.themeColor}},watch:{data(t){this.getLabel(t)}},methods:{getLabel(t){let e=[],s=`${this.$t("common.passingCriteria")}: `;t.study_progress_standard>0&&(s+=`${this.$t("training.studyTip",{progress:t.study_progress_standard})} `),t.exam_times>0&&(s+=`${this.$t("training.examTip",{examCount:t.exam_times})}`,e.push({title:this.$t("common.examPassed"),value:`${t.exam_pass_count||0}/${t.exam_times+this.$t("common.times")} `})),t.operation_times>0&&(s+=`${this.$t("training.operationTip",{operationCount:t.operation_times})} `,e.push({title:this.$t("attestation.practicalExams"),value:`${t.pass_operation_count||0}/${t.operation_times+this.$t("common.times")}`})),"true"===t.finish_evaluation&&(s+=`${this.$t("common.completeJobEvaluation")}`,e.push({title:this.$t("common.postEvaluation"),value:`${0===t.status?this.$t("common.unfinished"):this.$t("common.finished")}`})),this.tip=s,this.standered=e}}},c=s(1001),l=(0,c.Z)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"study-detail-top"},[s("div",{staticClass:"top-progress"},[s("span",{staticClass:"study-progress-title"},[t._v(t._s(t.$t("common.taskProgress")))]),s("span",{staticClass:"study-progress-info"},[t._v(t._s(t.data.progress)+"%")])]),s("div",{staticClass:"top-other-info"},[s("Cell",{attrs:{center:"",title:t.$t("common.assignor"),value:""},scopedSlots:t._u([{key:"label",fn:function(){return[s("cl-custom-user",{attrs:{type:t.data.assignor_sync_source_type,"data-type":"userName",value:t.data.assignor_sync_user_id,name:t.data.assignor_name}})]},proxy:!0}])}),s("Cell",{attrs:{center:"",title:t.$t("common.learningProgress"),value:"",label:t.data.study_progress+"%"}}),t._l(t.standered,(function(t){return s("Cell",{key:t.title,attrs:{center:"",value:"",title:t.title,label:t.value}})}))],2),t.data.type&&"course"!==t.data.type?s("div",{staticClass:"top-info-tip"},[t._v(t._s(t.tip))]):t._e()])}),[],!1,null,"e7a0131c",null).exports,u=s(22648),d=s(95082),h=(s(33948),s(57969));const p=t=>{let e="";switch(t){case"exam":e=h.Z.t("training.exam");break;case"neo":e=h.Z.t("training.newEmployee");break;case"online":e=h.Z.t("training.online");break;case"offline":e=h.Z.t("training.offline");break;case"mix":e=h.Z.t("training.hybrid");break;case"course":e=h.Z.t("training.course")}return e},m=a,g=t=>{let e=[];return t.length>0&&(e=t.map((t=>{const{flag:e,contentType:s,type:a}=t,i={};for(const[e,s]of Object.entries(t))i[(0,u.rT)(e)]=s;switch(e){case 1:"audio/mp3"===s||"audio/mpeg"===s||"audio"===s?(i.type="mp3",i.original_type=""):"doc"===s?i.type="doc":"picture"===s?i.type="picture":"crs"===a?i.type="course":"imageText"===a?i.type="imageText":"video"===s&&(i.type="mp4");break;case 2:i.type="exam";break;case 3:i.type="latoja";break;case 4:case 9:i.type="investigate";break;case 5:"operation"===a&&(i.type="operation");break;case 6:i.type="evaluation";break;case 7:i.type="tutor"}return i.contentType="",i}))),e};var v={name:"DetailTitle",components:{},filters:{formatDate:t=>(0,u.p6)(t,"yyyy.MM.dd hh:mm")},props:{studyInfo:{type:Object,default:()=>({})},type:{type:String,default:""}},computed:{themeColor(){return this.$store.state.themeColor}},methods:{getType:t=>m.getType(t)}},f=(0,c.Z)(v,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"detail-title-section"},[s("div",{staticClass:"title van-ellipsis"},[t._v(t._s(t.studyInfo.title))]),s("div",{staticClass:"other-info"},[s("div",{staticClass:"study-time"},["true"===t.studyInfo.show_score?s("span",{staticClass:"score"},[t._v(" "+t._s(t.studyInfo.award_score+t.$t("pointsMall.credits"))+" ")]):t._e(),t._v(" "+t._s(t._f("formatDate")(t.studyInfo.begin_time))+" ~ "+t._s(t._f("formatDate")(t.studyInfo.end_time))+" ")]),s("div",{class:["study-type",""+t.studyInfo.type]},[t._v(t._s(t.getType(t.studyInfo.type)))])]),t.studyInfo.summary?s("div",{staticClass:"summary"},[t._v(" "+t._s(t.$t("training.missionStatement"))+": "+t._s(t.studyInfo.summary)+" ")]):t._e()])}),[],!1,null,"d6b54476",null).exports,y=(s(69710),s(57609)),_=(s(47601),s(44951)),C={name:"StudyType",components:{SvgIcon:s(78551).Z},filters:{formatDate:t=>(0,u.p6)(t,"yyyy.MM.dd hh:mm")},props:{item:{type:Object,default:()=>({})}},data:function(){return{labelInfo:{icon:"",color:"",tipsText:"",showCount:!1}}},computed:{themeColor(){return this.$store.state.themeColor},studyTypeList(){return{exam:{ViewClass:"exam-label",icon:"icon-kaoshirenwu",iconColor:"#D8403D",tipsText:this.$t("training.exam")},course:{ViewClass:"course-label",icon:"icon-lesson",iconColor:"#465dcd",tipsText:this.$t("training.course")},imageText:{ViewClass:"course-label",icon:"icon-lesson",iconColor:"#465dcd",tipsText:this.$t("training.imageTest")},mp4:{ViewClass:"",icon:"icon-play",iconColor:"#465dcd",tipsText:this.$t("training.video")},mp3:{ViewClass:"",icon:"icon-music",iconColor:"#ff5e94",tipsText:this.$t("training.audio")},ppt:{ViewClass:"",icon:"icon-ppt1",iconColor:"#fc8033",tipsText:"PPT"},pptx:{ViewClass:"",icon:"icon-ppt1",iconColor:"#fc8033",tipsText:"PPT"},pdf:{ViewClass:"",icon:"icon-pdf1",iconColor:"#d64f4f",tipsText:"PDF"},doc:{ViewClass:"",icon:"icon-word",iconColor:"#008BFF",tipsText:"WORD"},docx:{ViewClass:"",icon:"icon-word",iconColor:"#008BFF",tipsText:"WORD"},xls:{ViewClass:"",icon:"icon-excel",iconColor:"#70B78E",tipsText:"EXCEL"},xlsx:{ViewClass:"",icon:"icon-excel",iconColor:"#70B78E",tipsText:"EXCEL"},latoja:{ViewClass:"offline",icon:"icon-downline",iconColor:"#465dcd",tipsText:this.$t("training.offline")},investigate:{ViewClass:"",icon:"icon-tiaoyanrenwu",iconColor:"#3AC4CC",tipsText:this.$t("training.research")},evaluation:{ViewClass:"",icon:"icon-gangweiceping",iconColor:"#5dbd66",tipsText:this.$t("training.postEvaluation")},micro_course:{ViewClass:"",icon:"icon-weik",iconColor:"#465dcd",tipsText:this.$t("training.microCourse")},txt:{ViewClass:"",icon:"icon-ematter-txt",iconColor:"#727896",tipsText:this.$t("training.txt")},article:{ViewClass:"",icon:"icon-Ekejian1",iconColor:"#88A3CB",tipsText:this.$t("training.article")},link:{ViewClass:"",icon:"icon-Ekejian1",iconColor:"#88A3CB",tipsText:this.$t("training.article")},operation:{ViewClass:"",icon:"icon-shicaokaohexin",iconColor:"#D64F4F",tipsText:this.$t("training.practicalExams")},tutorials:{ViewClass:"",icon:"icon-fudaorenwu",iconColor:"#F5A422",tipsText:this.$t("training.counselingTask")},other:{ViewClass:"",icon:"icon-file",iconColor:"#727896",tipsText:this.$t("training.other")},picture:{ViewClass:"",icon:"icon-tupian",iconColor:"#97C7F0",tipsText:this.$t("training.image")},html:{ViewClass:"",icon:"icon-HTML",iconColor:"#65A6F3",tipsText:"HTML"},scorm:{ViewClass:"",icon:"icon-scorm",iconColor:"#5ACC9B",tipsText:"SCORM"},png:{ViewClass:"",icon:"icon-tupian",iconColor:"#97C7F0",tipsText:this.$t("training.image")},jpg:{ViewClass:"",icon:"icon-tupian",iconColor:"#97C7F0",tipsText:this.$t("training.image")}}}},mounted(){this.renderResourceLabel(this.item)},methods:{renderResourceLabel(t){let e={};const s="picture"===t.contentType||"html"===t.contentType||"scorm"===t.contentType?this.studyTypeList[t.contentType]:this.studyTypeList[t.type];t.type&&"mpa3"!==t.type&&"mp4"!==t.type?e={icon:s.icon,color:s.iconColor,tipsText:s.tipsText,showCount:!0}:"mp3"!==t.type&&"mp4"!==t.type||"mp3"!==t.original_type?"mp4"===t.type&&"mp3"!==t.original_type&&(e={icon:"icon-play",color:"#465dcd",tipsText:this.$t("training.video"),showCount:!1}):e={icon:"icon-music",color:"#ff5e94",tipsText:this.$t("study.audio"),showCount:!1},this.labelInfo=e}}},I=(0,c.Z)(C,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"course-type"},[s("SvgIcon",{staticClass:"exam-lable-icon",attrs:{"icon-class":t.labelInfo.icon,color:t.labelInfo.color}}),t._v(" "+t._s(t.labelInfo.tipsText)+" "+t._s(t.labelInfo.showCount&&"course"===t.item.type?t.item.resource_count:"")+" "),"false"===t.item.can_start_study&&t.item.unlocking_time?s("div",{staticClass:"unlocking-time"},[t._v(" "+t._s(t.$t("training.unlockedTime"))+":"+t._s(t._f("formatDate")(t.item.unlocking_time))+" ")]):t._e()],1)}),[],!1,null,"165b2f4c",null).exports,b=(s(47238),{name:"StudyList",components:{Progress:s(75167).Z},props:{item:{type:Object,default:()=>({})}},computed:{themeColor(){return this.$store.state.themeColor},examTypeList(){return{unfinished:{iconColor:"#7F849A",examTips:this.$t("training.unfinished")},passed:{iconColor:"#5DBD66",examTips:this.$t("training.passed")},failed:{iconColor:"#D8403D",examTips:this.$t("training.failed")},perfect:{iconColor:"#FFA000",examTips:this.$t("training.perfect")},absence:{iconColor:"#7F849A",examTips:this.$t("training.absence")},scoring:{iconColor:"#7F849A",examTips:this.$t("training.scoring")}}},tutorialsTypeList(){return{no_tutor:{viewClass:"status-tutorials-ing",examTips:this.$t("training.chooseTutor")},to_be_submitted:{viewClass:"status-tutorials-ing-disabled",examTips:this.$t("training.subByTutor")},to_be_evaluated:{viewClass:"status-tutorials-ing",examTips:this.$t("training.startEvaluation")},evaluated:{viewClass:"status-tutorials-ing",examTips:this.$t("signIn.details")}}},operationTypeLlist(){return{0:{viewClass:"status-pass-ing",examTips:this.$t("training.unfinished")},1:{viewClass:"status-pass-ing",examTips:this.$t("training.inReview")},2:{viewClass:"status-pass-ing-red",examTips:this.$t("training.reject")},3:{viewClass:"status-pass",examTips:this.$t("training.pass")}}}},mounted(){},methods:{}}),w=(0,c.Z)(b,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"study-detail-status"},[t.item.canStudy?"transcoding"===t.item.status?s("span",{staticClass:"transcoding"},[t._v(t._s(t.$t("attestation.transcoding")))]):t.item.progress>=0&&t.item.progress<100&&"exam"!==t.item.type&&"investigate"!==t.item.type&&"evaluation"!==t.item.type&&"operation"!==t.item.type&&"tutorials"!==t.item.type?s("div",{staticClass:"course-progress"},[s("Progress",{attrs:{color:t.themeColor.primaryColor,percentage:t.item.progress,"show-pivot":!1}}),s("span",{style:{color:t.themeColor.primaryColor}},[t._v(t._s(t.item.progress)+"%")])],1):"exam"===t.item.type?s("span",{staticClass:"score-status",style:{color:t.examTypeList[t.item.status].iconColor}},[t._v(" "+t._s(t.examTypeList[t.item.status].examTips)+" ")]):"operation"===t.item.type?s("span",{class:["progress-reject","reject-status",""+t.operationTypeLlist[t.item.status].viewClass]},[t._v(" "+t._s(t.operationTypeLlist[t.item.status].examTips)+" ")]):"tutorials"===t.item.type?s("span",{class:["tutorials-reject reject-status",""+t.tutorialsTypeList[t.item.status].viewClass]},[t._v(" "+t._s(t.tutorialsTypeList[t.item.status].examTips)+" ")]):"investigate"===t.item.type||"evaluation"===t.item.type?s("div",{staticClass:"investigate-info"},[100===t.item.progress?s("span",{staticClass:"completed"},[t._v(" "+t._s(t.$t("training.finished")))]):s("span",[t._v(" "+t._s(t.$t("training.unfinished")))])]):t.item.progress>=100?s("span",{staticClass:"progress-over"},[t._v(t._s(t.$t("training.finished")))]):t._e():s("SvgIcon",{staticClass:"icon-lock",attrs:{color:t.labelInfo.color}})],1)}),[],!1,null,"57a8fa4d",null).exports,$={name:"StudyList",components:{VanImage:_.Z,Divider:y.Z,StudyType:I,StudyStatus:w},props:{studyInfo:{type:Object,default:()=>({})},itemClick:{type:Function,default:()=>{}},type:{type:String,default:""}},data:function(){return{showStageTag:!0,showExamResult:!0}},computed:{themeColor(){return this.$store.state.themeColor}},methods:{getTag(t){return t.course_list.find((t=>"false"===t.can_start_study))?t.course_list.find((t=>t.unlocking_time))?this.$t("training.unlockMode"):this.$t("training.recruitModel"):""},onPreviewExchangeGroup(){}}},k={name:"StudyList",components:{DetailTop:l,DetailTitle:f,DetailList:(0,c.Z)($,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"stage-container"},[t._l(t.studyInfo.stages,(function(e){return s("div",{key:e.id,staticClass:"stage"},[s("div",{staticClass:"stage-title van-ellipsis"},[t._v(t._s(e.stage_name))]),t.showStageTag?s("div",{staticClass:"stage-tag"},[t._v(t._s(t.getTag(e)))]):t._e(),s("div",{staticClass:"stage-desc"},[t._v(t._s(e.content))]),s("div",{staticClass:"course-container"},t._l(e.course_list,(function(e){return s("div",{key:e.id,staticClass:"course-item"},[s("StudyType",{attrs:{item:e}}),s("div",{staticClass:"course-info"},[s("div",{staticClass:"title"},[t._v(t._s(e.title))]),s("StudyStatus",{attrs:{item:e}})],1),t.showExamResult?s("div",{staticClass:"exam-info"},[e.show_result?s("div",{staticClass:"score"},[t._v(t._s(t.$t("myRating.points"))+":"+t._s(e.score))]):t._e(),"true"===e.show_repeat_exam?s("div",{staticClass:"opt"},[t._v(" "+t._s(t.$t("training.retake")))]):t._e()]):t._e()],1)})),0)])})),t.studyInfo.ding_img_url?s("div",{staticClass:"exchange-group"},[s("VanImage",{staticClass:"exchange-group-qrcode",attrs:{src:t.studyInfo.ding_img_url,fit:"fill"},on:{click:t.onPreviewExchangeGroup}}),s("div",{staticClass:"exchange-group-tip"},[t._v(t._s(t.$t("training.joinTaskGroup")))])],1):t._e(),"handle"!==t.type?s("div",{staticClass:"end"},[s("Divider",[t._v("END")])],1):t._e()],2)}),[],!1,null,"53274da0",null).exports},props:{type:{type:String,default:""},planId:{type:String,default:""}},data:function(){return{state:{studyInfo:{},studyId:"",studyStatus:"unfinished",isPreview:!0,hasSetFace:!1,student_id:"",isShowPreventHangModal:!1,unpaidCharge:!1,startTime:"",endTime:"",isFaceRecognition:!1,checkFaceStatus:"idle",tutorsList:[],showtutorsModal:!1,checkedId:"",tutorialsId:"",tutorials_model:""}}},mounted(){this.getStudyPreviewData()},methods:{getStudyPreviewData(){const{query:t}=this.$route,e={planId:this.type&&"handle"===this.type?this.planId:t.planId};i.Z.getPreviewStudyTaskData(e).then((async t=>{if(t&&t.data){const e=await(t=>{const{bizPlanVo:e,stageList:s}=t,a={studyInfo:t,startTime:(0,u.p6)(e.beginTime,"yyyy-MM-dd hh:mm"),endTime:(0,u.p6)(e.endTime,"yyyy-MM-dd hh:mm")};new Date(e.endTime).getFullYear()===new Date(e.beginTim).getFullYear()&&(a.endTime=(0,u.p6)(e.endTime,"MM-dd hh:mm")),a.isFaceRecognition="on"===a.studyInfo.faceRecognition,a.studyInfo.stageList.forEach((t=>{let e=-1;t.courseMappingList.forEach(((s,a)=>{"course"===s.type&&(s.resource_count=h.Z.t("training.chapters",{params:s.resource_count})),s.formatDuration="",0!==s.duration&&(s.formatDuration=(0,u.WJ)(s.duration)),s.canStudy="true"===s.canStartStudy,"true"===t.in_order&&("latoja"===s.type?0===a&&(e=a):s.progress>=100?e=a:0!==a&&e!==a||(e=a))})),t.canStudyIndex=e}));const i={};for(const[e,s]of Object.entries(t))i[(0,u.rT)(e)]=s;const o=[];return s.length>0&&s.forEach((async t=>{let e={};for(const[s,a]of Object.entries(t))e[(0,u.rT)(s)]=a;o.push((0,d.Z)((0,d.Z)((0,d.Z)({},s),e),{},{course_list:await g(t.courseMappingList)}))})),(0,d.Z)((0,d.Z)({},a),{},{studyInfo:(0,d.Z)((0,d.Z)((0,d.Z)({},e),i),{},{progress:0,assignor_name:t.supervisorUserName,study_progress:0,study_progress_standard:0!==t.progress?t.progress:100,exam_times:t.times,operation_times:t.operationTimes,status:0,free:e.free,official_price:"0.00"===e.official_price_str?"":e.official_price_str,show_score:`${t.planStudyScore&&""!==t.planStudyScore.finishScore}`,award_score:t.planStudyScore&&t.planStudyScore.finishScore?t.planStudyScore.finishScore:0,stages:o})})})(t.data);this.state=e}}))}}},S=(0,c.Z)(k,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:("handle"!==t.type?"study-detail":"study-task")+" study-common"},["handle"!==t.type?s("DetailTop",{attrs:{data:t.state.studyInfo}}):t._e(),s("DetailTitle",{attrs:{"study-info":t.state.studyInfo}}),"true"===t.state.studyInfo.sync_progress?s("div",{staticClass:"sync-tip"},[t._v(t._s(t.$t("common.openSync")))]):t._e(),s("DetailList",{attrs:{"study-info":t.state.studyInfo,type:t.type}})],1)}),[],!1,null,"500e1092",null).exports},49450:(t,e,s)=>{s.r(e),s.d(e,{default:()=>n});s(29941);var a=s(64168),i=(s(52355),s(29233)),o=s(78551),r={name:"ApprovalList",components:{[i.Z.name]:i.Z,[a.Z.name]:a.Z,SvgIcon:o.Z},data:()=>({list:[{name:"pending",lang:"approvals.pending",count:0,icon:"icon-shicaozuoyeshenpi",color:"#a16ede"},{name:"processed",lang:"approvals.done",count:0,icon:"icon-baomingshenpi1",color:"#55a1fe"},{name:"me",lang:"approvals.iInitiated",count:0,icon:"icon-tibaoshenpi",color:"#e07a5f"}]}),mounted(){},methods:{}},n=(0,s(1001).Z)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"approval"},t._l(t.list,(function(e){return s("van-cell-group",{key:e.name,staticClass:"list-group"},[s("van-cell",{attrs:{size:"large","is-link":"",to:{path:"/approval-list",query:{type:e.name}}},scopedSlots:t._u([{key:"title",fn:function(){return[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":e.icon,color:e.color,size:17}}),t._v(" "+t._s(t.$t(e.lang))+" ")]},proxy:!0}],null,!0)})],1)})),1)}),[],!1,null,"3433fe36",null).exports},39361:(t,e,s)=>{s.r(e),s.d(e,{default:()=>d});var a=s(95082),i=(s(74916),s(15306),s(26294)),o=s(27632),r=s(22950),n=s(95902),c=s(77217);let l="";var u={components:{ClLaunchImage:r.Z,HomeSkeleton:n.Z,InterceptPage:c.Z},data:()=>({native:o.Z,toPath:""}),computed:(0,a.Z)((0,a.Z)({},(0,i.mapGetters)({commonParams:"getCommonParams",isLogin:"isLogin",enableIntercept:"getEnableIntercept",pageFrom:"getPageFrom"})),(0,i.mapState)(["parentEnv"])),watch:{isLogin:function(t){t&&(this.$i18n.locale=this.$store.state.language,this.gotoNextPage())}},beforeCreate:function(){const{query:t}=this.$route;l=t.accessToken||t.access_token||"",l&&localStorage.setItem("access_token",l),t.showHomeLink&&localStorage.setItem("showHomeLink",t.showHomeLink),t.ddVersion&&localStorage.setItem("ddVersion",t.ddVersion),t.corpId&&localStorage.setItem("corpId",t.corpId),t.env&&localStorage.setItem("env",t.env),t.isPure&&localStorage.setItem("isPure",t.isPure),t.appType&&localStorage.setItem("appTypeVue",t.appType),t.enterpriseId&&localStorage.setItem("enterpriseId",t.enterpriseId),t.sensorsPlatform&&localStorage.setItem("sensorsPlatform",t.sensorsPlatform||"H5"),window.sensors&&window.sensors.registerPage({platform:t.sensorsPlatform||"H5",common_enterprise_id:t.enterpriseId,environment:window.COOL_ENV}),t.env&&this.$store.commit("saveParentEnv",{env:t.env||"",isPure:t.isPure||"false",appType:t.appType||"",pageFrom:t.pageFrom||""}),o.Z.init(),this.$store.commit("toggleShowHomeLink",{showHomeLink:"true"===t.showHomeLink})},created:function(){l||this.commonParams.accessToken?(console.warn("使用token登录"),this.$store.commit("saveUserInfo",{accessToken:l||this.commonParams.accessToken}),this.loginByToken(l||this.commonParams.accessToken,this.commonParams.corpId)):this.goToTaroLoginPage()},mounted:function(){console.warn("去登陆");const t=localStorage.getItem("toPath")?JSON.parse(localStorage.getItem("toPath")):{path:"/home-module"};this.toPath=t.path},destroyed:function(){localStorage.removeItem("toPath"),this.$refs.launchImage&&this.$refs.launchImage.closeImg(),this.$refs.homeSkeleton&&this.$refs.homeSkeleton.closeSkeleton(),o.Z.hideLoading()},methods:{gotoNextPage:function(){const t=localStorage.getItem("toPath")?JSON.parse(localStorage.getItem("toPath")):{path:"/home-module"};this.$router.replace({path:t.path,query:t.query,params:t.params})},async loginByToken(t,e){try{await this.$store.dispatch("getUserInfoAndLoginToken",{token:t,corpId:e});let s=this.$route.query.language?this.$route.query.language.replace("_","-"):"zh-cn";"app"===o.Z.env&&(this.$root.$i18n.locale=s)}catch(t){this.$toast(this.$t("common.getUserInfoFail")),console.error("获取用户信息失败",t),this.goToTaroLoginPage()}},goToTaroLoginPage:function(){if(console.warn("跳转登录页"),"h5"===o.Z.env)if("weCom"===this.parentEnv.appType)o.Z.redirectTo({url:"/pages/login/login-we-com/index"});else o.Z.redirectTo({url:"/pages/login/login-account/index"})}}},d=(0,s(1001).Z)(u,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.enableIntercept?s("InterceptPage"):[s("div",{staticClass:"login-container"}),s("ClLaunchImage",{ref:"launchImage"}),"dingTalk"!==t.native.env&&"/home-module"===t.toPath?s("HomeSkeleton",{ref:"homeSkeleton"}):t._e()]],2)}),[],!1,null,"4b67dc81",null).exports},20993:(t,e,s)=>{s.r(e),s.d(e,{default:()=>h});s(31146);var a=s(41610),i=(s(47601),s(44951)),o=(s(25773),s(35791)),r=(s(93787),s(20090)),n=(s(77141),s(30960)),c=s(32900),l=s(11046),u=s(22648);var d={components:{[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z},data:()=>({telephone:"",captcha:"",name:"",password:"",rePassword:"",timeout:60,intervalId:0,isRegistered:!0,isJoinEnterprise:!0,logoUrl:"",enterpriseName:""}),computed:{isProcess(){return 60-this.timeout>0},isBind(){return!0===this.isRegistered&&!1===this.isJoinEnterprise}},watch:{isBind(t){return t&&this.enterpriseName?a.Z.alert({message:this.$t("register.bindTips",{enterpriseName:this.enterpriseName})}):""}},created(){this.getEnterpriseLogo()},destroyed(){clearInterval(this.intervalId)},methods:{handleGetCaptcha(){this.$refs.form.validate("telephone").then((()=>{c.Z.postSendCaptcha({action_type:"join_enterprise",enterprise_id:this.$route.query.enterpriseId,login_mobile:this.telephone}).then((t=>{const{data:e}=t;"true"===e.result&&(this.timeout--,clearInterval(this.intervalId),this.intervalId=setInterval((()=>{this.timeout>1?this.timeout--:(clearInterval(this.intervalId),this.timeout=60)}),1e3)),"true"===e.is_join_enterprise&&"true"===e.is_register?a.Z.confirm({title:this.$t("common.reminder"),message:this.$t("register.joined"),confirmButtonText:this.$t("register.gotoLogin")}).then((()=>{this.gotoLogin("auto")})).catch((()=>{})):(this.isJoinEnterprise="true"===e.is_join_enterprise,this.isRegistered="true"===e.is_register)})).catch((t=>{console.error(t),this.timeout=60}))}))},onSubmit(){c.Z.postUserRegister({department_id:"9223372036854775807",enterprise_id:this.$route.query.enterpriseId,login_mobile:this.telephone,verification_code:this.captcha,user_name:this.name,password:this.password}).then((()=>{a.Z.confirm({title:this.$t("common.reminder"),message:this.$t("register.success"),confirmButtonText:this.$t("register.gotoLogin")}).then((()=>{this.gotoLogin("auto")})).catch((()=>{}))})).catch((t=>{console.error(t)}))},gotoLogin(){(0,l.rf)({flag:""})},getEnterpriseLogo(){c.Z.getEnterpriseLogoRequeset({enterprise_id:this.$route.query.enterpriseId,domain:(0,u.kE)()||""}).then((t=>{var e,s,a,i;this.logoUrl=(null==t||null===(e=t.data)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.logo)||"",this.enterpriseName=(null==t||null===(a=t.data)||void 0===a||null===(i=a.data)||void 0===i?void 0:i.enterprise_name)||""}))}}},h=(0,s(1001).Z)(d,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"component-register"},[s("div",{staticClass:"component-register-logo"},[s("van-image",{attrs:{width:"168",height:"40",fit:"contain","show-error":!1,src:t.logoUrl}})],1),s("div",{staticClass:"component-register-header"},[s("div",{staticClass:"component-register-header-title"},[t._v(t._s(t.$t("register.title")))]),s("div",{staticClass:"component-register-header-tips"},[t._v(t._s(t.$t("register.subscription")))])]),s("van-form",{ref:"form",staticClass:"component-register-content",attrs:{"validate-trigger":"onSubmit"},on:{submit:t.onSubmit}},[s("van-field",{staticClass:"component-register-content-telephone",attrs:{name:"telephone",label:"+86",placeholder:t.$t("common.input",{name:t.$t("common.telephone")}),maxlength:11,clearable:"",rules:[{required:!0,message:t.$t("common.input",{name:t.$t("common.telephone")})},{pattern:/^(0|86|17951)?(1[3456789])[0-9]{9}$/,message:t.$t("common.validateError",{name:t.$t("common.telephone")})}]},model:{value:t.telephone,callback:function(e){t.telephone=e},expression:"telephone"}}),s("van-field",{attrs:{name:"captcha",label:"",placeholder:t.$t("common.input",{name:t.$t("common.captcha")}),maxlength:6,clearable:"",rules:[{required:!0,message:t.$t("common.input",{name:t.$t("common.captcha")})}]},scopedSlots:t._u([{key:"button",fn:function(){return[s("a",{staticClass:"get-captcha",attrs:{disabled:t.isProcess,size:"small",type:"primary"},on:{click:t.handleGetCaptcha}},[t._v(t._s(t.isProcess?t.timeout:t.$t("common.get",{name:t.$t("common.captcha")})))])]},proxy:!0}]),model:{value:t.captcha,callback:function(e){t.captcha=e},expression:"captcha"}}),t.isRegistered?t.isJoinEnterprise?t._e():[s("van-field",{attrs:{name:"name",label:"",placeholder:t.$t("common.input",{name:t.$t("common.name")}),clearable:"",maxlength:20,rules:[{required:!0,message:t.$t("common.input",{name:t.$t("common.name")})}]},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})]:[s("van-field",{attrs:{name:"name",label:"",placeholder:t.$t("common.input",{name:t.$t("common.name")}),clearable:"",maxlength:20,rules:[{required:!0,message:t.$t("common.input",{name:t.$t("common.name")})}]},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}}),s("van-field",{attrs:{type:"password",name:"password",label:"",placeholder:t.$t("common.input",{name:t.$t("common.password")}),clearable:"",maxlength:20,rules:[{required:!0,message:t.$t("common.input",{name:t.$t("common.password")})},{pattern:/^[A-Z]+[a-z]+[0-9]+$/,message:t.$t("register.passwordError1")},{pattern:/^\w{6,}$/,message:t.$t("register.passwordError2")}]},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),s("van-field",{attrs:{type:"password",name:"rePassword",label:"",placeholder:t.$t("common.reInput",{name:t.$t("common.password")}),clearable:"",maxlength:20,rules:[{required:!0,message:t.$t("common.reInput",{name:t.$t("common.password")})},{pattern:/^[A-Za-z0-9]+$/,message:t.$t("register.passwordError1")},{pattern:/^\w{6,}$/,message:t.$t("register.passwordError2")},{validator:function(e){return t.password===e},message:t.$t("register.passwordNotEqual")}]},model:{value:t.rePassword,callback:function(e){t.rePassword=e},expression:"rePassword"}})],s("van-button",{staticStyle:{margin:"32px 0"},attrs:{block:"",type:"primary","native-type":"submit"}},[t._v(t._s(t.isBind?t.$t("register.bind"):t.$t("register.register")))]),s("a",{staticClass:"component-register-content-action",on:{click:t.gotoLogin}},[t._v(t._s(t.$t("register.gotoLogin")))])],2)],1)}),[],!1,null,"218db814",null).exports},94360:(t,e,s)=>{s.r(e),s.d(e,{default:()=>S});var a=s(95082),i=(s(23307),s(81392)),o=(s(85827),s(57658),s(33948),s(38862),s(27632)),r=s(51527),n=s(98512);const c={homePage:"homePage",course:"course",discover:"discover",mine:"me"};var l=s(43195),u=s(27361),d=s.n(u),h=s(50361),p=s.n(h),m=s(54061),g=s.n(m),v=s(10928),f=s.n(v),y=s(84486),_=s.n(y);class C{constructor(t){this.targetId=t,this.timer=null,this.height=0}end(){clearInterval(this.timer)}timerFn(t,{timeout:e}){this.timer&&clearInterval(this.timer),this.timer=setInterval(t,e||10)}up(){const t=document.getElementById(this.targetId);this.timerFn((()=>{t.scrollTop>0&&(t.scrollTop-=2)}),{timeout:10})}setContainerHeight(t){this.height=t}down(){const t=document.getElementById(this.targetId);this.timerFn((()=>{t.scrollTop<this.height&&(t.scrollTop+=2)}),{timeout:10})}}const I={namespace:t=>{if(t)return I[t]||(I[t]=new C(t)),I[t]}};class b{constructor(t,e){this.correction=I.namespace(e),this.type=t||"insertBox",this.correction=I[e],this.dom=null;this.config={insertBox:{element:"div",style:{width:"100%",height:"50px",background:"lightblue",opacity:.7,display:"none"}},transBox:{element:"div",style:{width:"100%",height:"3px",background:"red",display:"none"}}}[t]}generateBox(){if(this.dom=document.querySelector(`#${this.type}`),!this.dom){if(!this.config)return;const{element:t,style:e}=this.config;this.dom=document.createElement(t),this.dom.id=this.type,_()(e,((t,e)=>this.dom.style[e]=t))}}getBox(){return this.dom}setContainerHeight(t){this.correction.setContainerHeight(t)}setVisible({targetNode:t,direction:e}){this.dom||this.generateBox(),this.dom.style.display="block","down"===e?(t.parentNode.insertBefore(this.getBox(),t.nextSibling),this.correction.down()):(t.parentNode.insertBefore(this.getBox(),t),this.correction.up())}setHidden(){this.dom||this.generateBox(),this.dom.style.display="none",this.correction.end()}}const w=new b("insertBox","scrollContent"),$=new b("transBox","scrollContent");var k={name:"CommonComponent",components:{[i.Z.name]:i.Z,BottomTarbar:r.Z},data:()=>({isRender:!0,pageData:[],selectCode:"",isLoader:!0,isActive:"",oldValue:"",newOldValue:"",active:"study",isPreview:!1,scrollConfig:{height:0,list:[],scrollTop:0,hoverClientY:0}}),async created(){const t=this.$route.query;await this.$store.dispatch("setting/getHomePageDetail",{template_id:t.templateId,type:t.renderType}),await this.$store.dispatch("getThemeColor",{template_id:t.templateId,corp_id:t.corpId,type:t.renderType})},mounted(){const t=(0,n.DP)();if("homePage"!==t.renderType&&"visitor"!==t.renderType||(this.active="homePage"),"editor"===t.category)this.init(),this.active=(()=>{const t=(0,n.DP)();return c[t.type]})();else if("preview"===t.category){this.isPreview=!0;const t=JSON.parse(localStorage.getItem("component-data"));this.handleComponentData(t)}t.qyShield&&this.$store.commit("setting/setQySwitch",{qyShield:t.qyShield})},updated(){0===this.scrollConfig.height&&(this.scrollConfig.height=document.getElementById("common-container").offsetHeight),this.$nextTick((()=>{this.scrollConfig.list=this.computeScrollList();const t=this.scrollConfig.list.reduce(((t,e)=>t+=e.offsetHeight),0);w.setContainerHeight(t),$.setContainerHeight(t)}))},methods:{handleScroll(t){this.scrollConfig.scrollTop=t.target.scrollTop},computeScrollList(){return g()(this.pageData,((t,e)=>{const{code:s}=e,a=this.$refs[s];return a[0]?(t.push({name:s,offsetHeight:a[0].offsetHeight}),t):t}),[])},computeIndex(){const{list:t}=this.scrollConfig;let e=0;for(let s=0;s<t.length;s++){if(t[s].offsetHeight+e>this.scrollConfig.scrollTop+this.scrollConfig.hoverClientY)return s;e+=t[s].offsetHeight}return-1},computeDirection:(t,e)=>t-e>0?"down":"up",init(){this.isLoader&&(o.Z.getComponentData(),window.addEventListener("message",(t=>{if(t&&t.data&&t.data.res&&Object.keys(t.data.res).length>0){if(t.data.res.firstLoader&&"component"===t.data.res.type)this.handleComponentData(t.data.res.data||[]);else{if("component"===t.data.res.type){const e=t.data.res.data,s=(0,a.Z)((0,a.Z)({},e),{},{app:l.Z[e.id]}),i=w.getBox()&&w.getBox().nextSibling;if(i){const t=this.pageData.findIndex((t=>t.code===i.id));this.pageData.splice(t,0,s)}else this.pageData.push(s);w.setHidden(),this.syncToParentSelectCode(s.code)}else{if("update_data"===t.data.res.type){const e=this.pageData.findIndex((e=>e.code===t.data.res.selectCode)),s=JSON.parse(t.data.res.data);return this.pageData.splice(e,1,(0,a.Z)((0,a.Z)({},s),{},{app:l.Z[s.id]})),void this.setLocalStorage()}if("update_position"===t.data.res.type){const{hoverClientY:e}=t.data.res.data;if(e===this.scrollConfig.hoverClientY)return;if(0===e)return void w.setHidden();const s=this.scrollConfig.hoverClientY;this.scrollConfig.hoverClientY=e;const a=this.computeDirection(e,s),i=this.computeIndex(),o=d()(this.scrollConfig,`list.${i}.name`)||d()(f()(this.scrollConfig.list),"name"),r=d()(this.$refs,`${o}.0`);if(!r)return;return void w.setVisible({targetNode:r,direction:a})}if("clear_selectCode"===t.data.res.type)return void(this.selectCode="")}this.syncToParentData()}this.selectCode=t.data.res.selectCode}}),!1),this.isLoader=!1)},handleComponentData(t){const e=[];t.forEach((t=>{e.push((0,a.Z)((0,a.Z)({},t),{},{app:l.Z[t.id]}))})),this.pageData=e,this.setLocalStorage()},handleSelectCode(t,e){t.stopPropagation(),e.code!==this.selectCode&&(this.selectCode=e.code,this.syncToParentSelectCode(e.code))},handleDeleteComponent(t,e){if(t.stopPropagation(),e.code!==this.selectCode)return;const s=this.pageData.findIndex((t=>t.code===e.code)),a=(i=s,!((o=p()(this.pageData)).length<2)&&(0===i?o[i+1].code:o[i-1].code));var i,o;this.selectCode=a||"",this.pageData.splice(s,1),this.syncToParentData(),this.syncToParentDelete(e),this.syncToParentSelectCode(a)},handleDragstart(t){$.setHidden(),t.code===this.selectCode&&(this.oldValue=t.code,this.isActive=t.code)},handleDragend(){if($.setHidden(),this.oldValue&&this.oldValue!==this.newOldValue&&this.oldValue===this.selectCode){const t=this.pageData.findIndex((t=>t.code===this.oldValue)),e=this.pageData[t],s=this.pageData.findIndex((t=>t.code===this.newOldValue)),a=[...this.pageData];a.splice(t,1),a.splice(s,0,e),this.pageData=[...a],this.syncToParentData()}this.isActive=-1},handleDragenter(t){if(this.newOldValue=t.code,t.code&&this.newOldValue!==this.selectCode&&this.selectCode&&this.oldValue===this.selectCode){const e=this.pageData.findIndex((e=>e.code===t.code)),s=this.pageData.findIndex((t=>t.code===this.oldValue)),a=document.getElementById(t.code),i=e>s?"down":"up";$.setVisible({targetNode:a,direction:i})}},syncToParentData(){o.Z.updateComponent({data:JSON.stringify(this.pageData),type:"updateMaterialKeys"}),this.setLocalStorage()},setLocalStorage(){localStorage.setItem("component-data",JSON.stringify(this.pageData))},syncToParentSelectCode(t){o.Z.updateComponent({selectCode:t,type:"selectCode"})},syncToParentDelete(t){o.Z.updateComponent({deleteItem:JSON.stringify(t),type:"delete"})}}},S=(0,s(1001).Z)(k,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container",attrs:{id:"common-container"}},[t.isPreview?s("div",[t._l(t.pageData,(function(e){return s("div",{key:e.code,ref:"li",refInFor:!0,attrs:{id:""+e.code}},[s(e.app,{key:e.code,tag:"component",staticClass:"disabled",attrs:{models:e.models||{},params:e.params||{},"css-obj":e.cssObj||{},"is-render":t.isRender,"is-old":!1}})],1)})),s("BottomTarbar",{attrs:{active:t.active,disable:!0}})],2):s("div",{staticClass:"scroll-container",attrs:{id:"scrollContent"},on:{"&scroll":function(e){return t.handleScroll.apply(null,arguments)}}},[s("transition-group",{staticClass:"box",attrs:{tag:"div",name:"pageData"}},t._l(t.pageData,(function(e,a){return s("div",{key:e.code,ref:e.code,refInFor:!0,class:{active:t.oldValue===e.code&&t.isActive===e.code},attrs:{id:""+e.code,draggable:""},on:{dragenter:function(){!t.isPreview&&t.handleDragenter(e)},dragend:function(){!t.isPreview&&t.handleDragend(e)},dragstart:function(){!t.isPreview&&t.handleDragstart(e)}}},[s("div",{class:"\n            "+(t.selectCode===e.code&&"selected")+"\n            "+(a===t.pageData.length-1&&"lastChild")+"\n            common",on:{click:function(s){t.handleSelectCode(s,e)}}},[s(e.app,{key:e.code,tag:"component",staticClass:"disabled",attrs:{models:e.models||{},params:e.params||{},"css-obj":e.cssObj||{},"is-render":!t.isRender,"is-old":!1}}),e.code===t.selectCode?s("div",{staticClass:"dragAction"},[s("van-icon",{staticClass:"delete",attrs:{name:"delete-o",size:"15"},on:{click:function(s){t.handleDeleteComponent(s,e)}}})],1):t._e()],1)])})),0),s("BottomTarbar",{attrs:{active:t.active,disable:!0}})],1)])}),[],!1,null,"5eae533e",null).exports},28497:(t,e,s)=>{s.d(e,{Z:()=>c});var a=s(95082),i=(s(57658),s(26294)),o=s(51527),r=s(43195),n={name:"CommonRender",components:{BottomTarbar:o.Z},props:{data:{type:Array,default:()=>[]},templateContext:{type:String,default:""},type:{type:String,default:"homePage"},isRender:{type:Boolean,default:!1}},data:()=>({pageData:[]}),computed:(0,a.Z)((0,a.Z)({},(0,i.mapGetters)({pageFrom:"getPageFrom"})),{},{showTabBar(){return"visitor"!==this.type}}),watch:{data(t){this.init(t)}},mounted(){this.init()},methods:{init(t){const e=t||this.data;let s=[];0!==e.length&&(e.forEach((t=>{s.push((0,a.Z)((0,a.Z)({},t),{},{app:r.Z[t.componentType]}))})),this.pageData=s)}}},c=(0,s(1001).Z)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"container"}},[t._l(t.pageData,(function(e){return s(e.app,{key:e.code,tag:"component",attrs:{models:e.models||{},params:e.params||{},"css-obj":e.cssObj||{},"is-render":t.isRender,"is-old":!1,"page-id":e.pageId,"page-position":e.pagePosition}})})),t.showTabBar?s("BottomTarbar",{attrs:{active:t.type}}):t._e()],2)}),[],!1,null,null,null).exports},56042:(t,e,s)=>{s.r(e),s.d(e,{default:()=>o});s(57658);var a=s(22648),i={name:"MineAnnuals",data(){return{iframeUrl:decodeURIComponent(this.$route.query.iframeUrl)}},mounted(){const{type:t,title:e}=this.$route.query;if(t){const e=`mine.${t}`;(0,a.Td)(this.$t(e))}else e&&(0,a.Td)(e);window.addEventListener("message",(t=>{if(t.data&&"certificationDetail"===t.data.type){const{url:e}=t.data;this.$router.push(e)}else"setTitle"===t.data.msg&&(0,a.Td)(t.data.title)}),!1)}},o=(0,s(1001).Z)(i,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"common-iframe-container"},[s("iframe",{style:{width:"100%",height:"100%"},attrs:{allowFullScreen:"",frameBorder:"0",src:t.iframeUrl}})])}),[],!1,null,"2f7395e7",null).exports},47854:(t,e,s)=>{s.r(e),s.d(e,{default:()=>p});s(57658);var a=s(27632),i=s(25295),o=s(6106),r=s(56955),n=s(94864),c=s(95969),l=s(98512),u=s(63874),d={components:{ClResult:s(77522).Z},data:()=>({type:"",isShowResult:!1,resultParams:{}}),created(){this.funParams()},mounted(){},methods:{funParams(){const{businessType:t,params:e}=this.$route.query;this.type=t,this.funBusinessMatch(t,e)},funBusinessMatch(t,e){const s=(0,l.dL)(e);switch(t){case"dingLive":this.getDingLive(s.courseId);break;case"graphicLesson":this.funCourseStatus(s.courseId)}},getDingLive(t){o.Z.getLiveDetailUrl(t).then((t=>{if(50001==t.data.code)this.resultParams={type:"404",title:this.$t("dingTalk"===a.Z.env?"course.resourceNotFound":"promptMessage.onlyDingTalk")},this.isShowResult=!0;else{const{jumpUrl:e}=t.data.data;if("dingTalk"===a.Z.env){if("unreleased"===t.data.data.courseStatus)return this.resultParams={type:"404",title:this.$t("share.withdrawn")},this.isShowResult=!0,!1;if("deleted"===t.data.data.courseStatus)return this.resultParams={type:"404",title:this.$t("share.resourceNotFound")},this.isShowResult=!0,!1;(0,u.N8)({url:e})}else this.resultParams={type:"404",description:this.$t("promptMessage.onlyDingTalk")},this.isShowResult=!0}})).catch((t=>{console.warn(t);const{code:e}=t.response.data;if("50001"===e)this.resultParams={type:"404",title:this.$t("course.resourceNotFound")};else this.resultParams={type:"error",description:this.$t("promptMessage.systemError")};this.isShowResult=!0}))},funCourseStatus(t){n.Z.enterprise.getEnterpriseCourseDetail({courseId:t,source:"share"}).then((e=>{if(0===e.code)this.funGraphicLesson(t);else{const{code:t}=e.message.data;switch(t){case"enterpriseapi.4003":this.resultParams={type:"403",title:this.$t("share.noPermission"),description:this.$t("share.noPermissionTip")};break;case"enterpriseapi.4001":this.resultParams={type:"404",title:this.$t("course.resourceNotFound")};break;case"enterpriseapi.503010":this.resultParams={type:"404",title:this.$t("share.courseRemoved")};break;default:this.resultParams={type:"error",description:this.$t("promptMessage.systemError")}}this.isShowResult=!0}}))},funGraphicLesson(t){i.Z.getImageTextResource({courseId:t,useType:"release",source:"share"}).then((async e=>{let{resourceId:s,url:a,linkSwitch:i}=e.data.data;"true"===i?(await r.Z.saveProgress("enterprise",{resourceId:s,courseId:t},{progress:100},null,!1),(0,u.N8)({url:a})):this.$router.push({path:c.Z.resource.toImageTextCourse({from:"course",courseId:t,resourceId:s})})})).catch((()=>{this.resultParams={type:"error",description:this.$t("promptMessage.systemError")},this.isShowResult=!0}))}}},h=d,p=(0,s(1001).Z)(h,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"business-transit"},[t.isShowResult?s("cl-result",{attrs:{title:t.resultParams.title,description:t.resultParams.description}}):t._e()],1)}),[],!1,null,null,null).exports},9083:(t,e,s)=>{s.r(e),s.d(e,{default:()=>S});var a=s(95082),i=(s(20581),s(50914)),o=(s(23307),s(81392)),r=s(49213),n=s(75230),c=s(56469),l=s(32352),u=(s(47601),s(44951)),d=(s(57658),s(78551)),h=s(13365),p=s(22648),m=s(98446),g=s(72525),v={components:{[u.Z.name]:u.Z,SvgIcon:d.Z,ListItem:m.Z},props:{detail:{type:Object,default:()=>{}}},data:()=>({avatar:h}),computed:{isMobile(){const{type:t}=this.detail.content?JSON.parse(this.detail.content):{};return"mobile"===t},handelOrigin(){return(0,g.G)(JSON.parse(this.detail.content))},getMobileImgs(){const{type:t,content:e}=JSON.parse(this.detail.content);return"mobile"===t?e.imgs:[]}},methods:{changeTimeAgoLabel(t){return t?(0,p.TC)(t,this):""},linkTo(t,e){e?this.$router.push({path:`/community/group-detail?id=${t.space.id}&name=${t.space.name}`}):this.$router.push({path:`/community/question-detail?questionId=${t.id}`})}}},f=s(1001),y=(0,f.Z)(v,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"question-article-item"},[s("div",{staticClass:"header flex"},[s("span",[s("van-image",{attrs:{width:"18",height:"18",round:"",fit:"cover",src:t.detail.author&&t.detail.author.avatar||t.avatar}}),s("span",{staticClass:"names"},[t._v(t._s(t.detail.author&&t.detail.author.name))])],1),s("span",{staticClass:"right-space",on:{click:function(e){return e.stopPropagation(),t.linkTo(t.detail,!0)}}},[t._v(t._s(t.detail.space&&t.detail.space.name))])]),s("div",{staticClass:"question-article-title",on:{click:function(e){return t.linkTo(t.detail)}}},[t._v(t._s(t.detail.title))]),s("div",{staticClass:"topic-question-list-item",on:{click:function(e){return t.linkTo(t.detail)}}},[s("ListItem",{attrs:{list:t.handelOrigin,"is-mobile":t.isMobile,imgs:t.getMobileImgs,detail:t.detail.content}})],1),s("div",{staticClass:"time-answerCount flex"},[s("span",[t._v(t._s(t.changeTimeAgoLabel(t.detail.lastDate)))]),s("span",[s("SvgIcon",{staticStyle:{"margin-right":"5px"},attrs:{color:"#c0c2cb",size:14,"icon-class":"icon-huidashu "}}),t._v(t._s(t.detail.answerCount||0))],1)])])}),[],!1,null,"4b7c5688",null).exports,_=(s(21790),s(24031)),C={components:{[u.Z.name]:u.Z,SvgIcon:d.Z,Tag:_.Z,ListItem:m.Z},props:{detail:{type:Object,default:()=>{}}},data:()=>({avatar:h}),computed:{isMobile(){const{type:t}=this.detail.content?JSON.parse(this.detail.content):{};return"mobile"===t},handelOrigin(){return(0,g.G)(JSON.parse(this.detail.content))},getMobileImgs(){const{type:t,content:e}=JSON.parse(this.detail.content);return"mobile"===t?e.imgs:[]}},methods:{changeTimeAgoLabel(t){return t?(0,p.TC)(t,this):""},linkTo(t,e){e?this.$router.push({path:`/community/group-detail?id=${t.space.id}&name=${t.space.name}`}):this.$router.push({path:`/community/article-detail?articleId=${t.id}`})}}},I=(0,f.Z)(C,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"question-article-item"},[s("div",{staticClass:"header flex"},[s("span",[s("van-image",{attrs:{width:"18",height:"18",round:"",fit:"cover",src:t.detail.author&&t.detail.author.avatar||t.avatar}}),s("span",{staticClass:"names"},[t._v(t._s(t.detail.author&&t.detail.author.name))])],1),s("span",{staticClass:"right-space",on:{click:function(e){return t.linkTo(t.detail,!0)}}},[t._v(t._s(t.detail.space&&t.detail.space.name))])]),s("div",{staticClass:"question-article-title",on:{click:function(e){return t.linkTo(t.detail)}}},[1===t.detail.isTop?s("Tag",{attrs:{"text-color":"#1890FF",color:"#91D5FF",plain:""}},[t._v(t._s(t.$t("community.isTop")))]):t._e(),t._v(" "+t._s(t.detail.title))],1),s("div",{staticClass:"topic-article-list-item",on:{click:function(e){return t.linkTo(t.detail)}}},[s("ListItem",{attrs:{list:t.handelOrigin,"is-mobile":t.isMobile,imgs:t.getMobileImgs,detail:t.detail.content}})],1),s("div",{staticClass:"time-answerCount flex"},[s("span",[t._v(t._s(t.changeTimeAgoLabel(t.detail.lastDate)))]),s("span",[s("span",[s("SvgIcon",{staticStyle:{"margin-right":"5px"},attrs:{color:"#c0c2cb",size:14,"icon-class":"icon-pinglun"}}),t._v(" "+t._s(t.detail.commentCount))],1),s("span",{staticStyle:{"margin-left":"12px"}},[s("SvgIcon",{staticStyle:{"margin-right":"5px"},attrs:{color:"#c0c2cb",size:14,"icon-class":"icon-zan2"}}),t._v(t._s(t.detail.stars||0))],1)])])])}),[],!1,null,"841dc56e",null).exports,b=s(55602),w=s(27632),$=s(28787),k={components:{Tabs:c.Z,noData:n.Z,addBtn:l.Z,questionItem:y,articleItem:I,Icon:o.Z,[i.Z.name]:i.Z},data(){return{loading:!1,finished:!1,tabs:[{lable:this.$t("community.answers"),value:"answer"},{lable:this.$t("community.article"),value:"article"}],tabType:"answer",params:{page:0,size:10},topicName:"",questionList:[],articleList:[]}},computed:{isApp:()=>"app"===w.Z.env},mounted(){this.topicName=this.$route.query.id||this.$route.query.topic,Array.isArray(this.$route.query.id)&&(this.topicName=this.$route.query.id[0]),this.searchTopicQuestion(),"wechat"!==w.Z.env&&"dingTalk"!==w.Z.env&&"wechat_h5"!==w.Z.env||(0,b.vD)({shareInfo:{title:this.topicName,desc:this.topicName,path:"dingTalk"===w.Z.env?`/pages/messageRedirect/messageRedirect?flag=groupTopic&id=${encodeURIComponent(encodeURI(this.topicName))}`:`/pages/login/login?flag=groupTopic&enterpriseId=${this.$store.state.commonParams.enterpriseId}&id=${this.topicName}&shareType=wxGroupShare`}})},methods:{changeTabs(t){switch(this.params.page=0,this.tabType=t,t){case"answer":default:this.searchTopicQuestion();break;case"article":this.searchTopicArticle()}},handleLoad(){switch(this.params.page+=1,this.tabType){case"answer":this.searchTopicQuestion();break;case"article":this.searchTopicArticle()}},async searchTopicQuestion(){this.loading=!0;let{data:t}=await r.Z.searchTopicQuestion((0,a.Z)((0,a.Z)({},this.params),{},{tagName:this.topicName}));0===t.code&&(this.loading=!1,this.questionList=0===this.params.page?t.data.content:this.questionList.concat(t.data.content),this.finished=this.questionList.length===t.data.totalElements)},async searchTopicArticle(){this.loading=!0;let{data:t}=await r.Z.searchTopicArticle((0,a.Z)((0,a.Z)({},this.params),{},{tagName:this.topicName}));0===t.code&&(this.loading=!1,this.articleList=0===this.params.page?t.data.content:this.articleList.concat(t.data.content),this.finished=this.articleList.length===t.data.totalElements)},handleShare(){if("wechat"!==w.Z.env&&"dingTalk"!==w.Z.env){const{accessToken:t}=$.Z.state.commonParams;(0,b.vD)({shareInfo:{title:this.topicName,desc:this.topicName,path:`${VUE_H5}#/community/about-topic-list?msgSource=emailMessage&flag=groupTopic&id=${this.topicName}&access_token=${t}`}})}}}},S=(0,f.Z)(k,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"about-topic-list"},[s("Icon",{directives:[{name:"show",rawName:"v-show",value:t.isApp,expression:"isApp"}],staticClass:"share_icon",attrs:{size:"24px",name:"share-o"},on:{click:t.handleShare}}),s("Tabs",{attrs:{tabs:t.tabs},on:{changeTabs:t.changeTabs}}),s("div",{staticClass:"main-content"},["answer"===t.tabType&&t.questionList.length?s("div",{key:"answer"},[s("van-list",{attrs:{finished:t.finished,"finished-text":t.$t("community.isBottom")},on:{load:t.handleLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.questionList,(function(t){return s("questionItem",{key:t.id,attrs:{detail:t}})})),1)],1):t._e(),"article"===t.tabType&&t.articleList.length?s("div",{key:"article"},[s("van-list",{attrs:{finished:t.finished,"finished-text":t.$t("community.isBottom")},on:{load:t.handleLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.articleList,(function(t){return s("articleItem",{key:t.id,attrs:{detail:t}})})),1)],1):t._e()]),s("div",{directives:[{name:"show",rawName:"v-show",value:"answer"===t.tabType&&!t.questionList.length||"article"===t.tabType&&!t.articleList.length,expression:"(tabType === 'answer' && !questionList.length) || (tabType === 'article' && !articleList.length)"}]},[s("noData",{attrs:{"tip-text":t.$t("community.noData")}})],1),s("addBtn")],1)}),[],!1,null,"6311a4c2",null).exports},7172:(t,e,s)=>{s.r(e),s.d(e,{default:()=>c});var a=s(95082),i=(s(20581),s(50914)),o=(s(57658),s(49213)),r=s(75230),n={components:{questionItem:s(59326).Z,[i.Z.name]:i.Z,noData:r.Z},data:()=>({showNoData:!1,questionList:[],finished:!1,loading:!1,params:{page:0,size:10,total:0}}),mounted(){this.funSearch()},methods:{funLoadMore(){this.params.page+=1,this.funSearch()},async funSearch(){this.loading=!0;const{data:t}=await o.Z.getGroupQuestion((0,a.Z)({},this.params));0===t.code&&(this.loading=!1,this.questionList=0===this.params.page?t.data.content:this.questionList.concat(t.data.content),this.finished=this.questionList.length===t.data.totalElements,this.showNoData=0===this.questionList.length)},hanldeQuestionDetail({id:t}){this.$router.push({path:`/community/question-detail?questionId=${t}`})}}},c=(0,s(1001).Z)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"answer-question-list"},[t.questionList.length?s("van-list",{attrs:{"finished-text":t.$t("common.noMore"),finished:t.finished},on:{load:t.funLoadMore},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.questionList,(function(e){return s("div",{key:e.id,on:{click:function(s){return s.stopPropagation(),t.hanldeQuestionDetail(e)}}},[s("questionItem",{attrs:{detail:e}})],1)})),0):t._e(),t.showNoData?s("noData",{attrs:{"tip-text":t.$t("community.noData")}}):t._e()],1)}),[],!1,null,null,null).exports},3058:(t,e,s)=>{s.r(e),s.d(e,{default:()=>P});s(31146);var a=s(41610),i=(s(34837),s(39146)),o=s(95082),r=(s(73474),s(74755)),n=(s(20581),s(50914)),c=(s(31960),s(10993)),l=(s(47601),s(44951)),u=(s(23307),s(81392)),d=(s(57658),s(13365)),h=s(81245),p=s(75230),m=s(49213),g=s(78551),v=s(29588),f=s(64534),y=s(22648),_=s(57969),C=s(27632),I=s(75748),b=s(26294),w=s(55602),$=s(28787),k=s(39819),S=s(22126),T=s(24357),Z=s(72525),x={name:"TopicTag",components:{comment:h.Z,noData:p.Z,topicItem:I.Z,replyMe:f.Z,SvgIcon:g.Z,Icon:u.Z,[l.Z.name]:l.Z,[c.Z.Component.name]:c.Z.Component,[n.Z.name]:n.Z,[r.Z.name]:r.Z,DescList:S.Z,Preview:k.Z,ClWaterMark:T.Z},props:{topicName:{type:String,default:""}},data(){return{userId:this.$store.state.commonParams.userId,avatar:d,detail:{author:{}},articleId:"",params:{page:0,size:10,total:0},showComment:!1,commentList:[],loading:!1,finished:!1,content:{},commitLoading:!1}},computed:(0,o.Z)((0,o.Z)({},(0,b.mapGetters)({primaryColor:"getPrimaryColor",access_token:"getToken"})),{},{primaryColor(){return this.$store.state.themeColor.primaryColor},isApp:()=>"app"===C.Z.env,getColor(){return this.detail.stared?"blue":"#c0c2cb"},isMobile(){const{type:t}=this.detail.content?JSON.parse(this.detail.content):{};return"mobile"===t},handelOrigin(){return(0,Z.G)(JSON.parse(this.detail.content))},getMobileImgs(){const{type:t,content:e}=JSON.parse(this.detail.content);return"mobile"===t?e.imgs:[]}}),mounted(){this.articleId=this.$route.query.id||this.$route.query.articleId,Array.isArray(this.$route.query.id)&&(this.articleId=this.$route.query.id[0]),this.getarticleDetail(),"wechat"!==C.Z.env&&"dingTalk"!==C.Z.env&&"wechat_h5"!==C.Z.env||(0,w.vD)({shareInfo:{title:this.detail.title,desc:this.detail.title,path:"dingTalk"===C.Z.env?`/pages/messageRedirect/messageRedirect?flag=groupArticle&id=${this.articleId}`:`/pages/login/login?flag=groupArticle&enterpriseId=${this.$store.state.commonParams.enterpriseId}&id=${this.articleId}&shareType=wxGroupShare`}})},methods:{changeTimeAgoLabel(t){return t?(0,y.TC)(t,this):""},async getarticleDetail(){let{data:t}=await m.Z.articleDetail(this.articleId);const{code:e}=t;0===e?(this.detail=t.data,this.content=JSON.parse(t.data.content).content,this.detail.commentCount>0&&this.handleGetComment()):v.Z[e]&&v.Z[e].showErrorMessage&&(0,i.Z)(v.Z[e].content[_.Z.locale])},async handleGetComment(){this.loading=!0;let{data:t}=await m.Z.getArticleAnswer(this.articleId,this.params);if(0===t.code&&t.data){const{totalElements:e,content:s}=t.data;this.params.total=e,this.loading=!1,this.commentList=0===this.params.page?s:this.commentList.concat(s),this.finished=this.commentList.length===e}},handleGetCommentLoad(){this.params.page+=1,this.handleGetComment()},handleKeyBoard(){this.showComment=!0},handleDelete(){a.Z.confirm({message:this.$t("community.confirmDelArticle"),confirmButtonText:this.$t("community.confirm"),cancelButtonText:this.$t("common.cancel"),confirmButtonColor:this.primaryColor}).then((()=>{this.funDelarticle()})).catch((()=>{}))},async funDelarticle(){let{data:t}=await m.Z.deleteArticle(this.articleId);0===t.code&&((0,i.Z)(this.$t("community.deleteSuccessTips")),history.go(-1))},aboutTopicList(t){this.$router.push({path:`/community/about-topic-list?topic=${t}`})},async handleComment(t){this.commitLoading=!0;const{userId:e}=this.$store.state.commonParams;let{data:s}=await m.Z.handleComment(this.articleId,{content:t,userId:e});const{code:a}=s;0===a?(this.showComment=!1,this.handleGetComment(),this.commitLoading=!1):v.Z[a]&&v.Z[a].showErrorMessage&&((0,i.Z)(v.Z[a].content[_.Z.locale]),this.commitLoading=!1)},async commentFinished(t,e,s){let{data:a}=await m.Z.replyComment(this.detail.id,e.id,{content:t,userId:s?s.author.id:e.author.id,userName:s?s.author.name:e.author.name});0===a.code&&(this.showComment=!1,this.params.page=0,this.handleGetComment())},async deleteReply(t,e){let{data:s}=await m.Z.deleteReply(this.detail.id,e.id,t.id);0===s.code&&this.handleGetComment()},async deleteComment(t){let{data:e}=await m.Z.deleteComment(this.detail.id,t.id);0===e.code&&this.handleGetComment()},async handleClickStar(){if(this.detail.stared){const{data:t}=await m.Z.getArticleUnStar(this.articleId);0===t.code&&this.getarticleDetail()}else{const{data:t}=await m.Z.getArticleStar(this.articleId);0===t.code&&this.getarticleDetail()}},handleShare(){if("wechat"!==C.Z.env&&"dingTalk"!==C.Z.env){const{accessToken:t}=$.Z.state.commonParams;(0,w.vD)({shareInfo:{title:this.detail.title,desc:this.detail.title,path:`${VUE_H5}#/community/article-detail?msgSource=emailMessage&flag=groupArticle&id=${this.articleId}&access_token=${t}`}})}},getImg(t){"dingTalk"!==C.Z.env?(0,c.Z)({images:this.getMobileImgs,showIndex:!0,loop:!1,startPosition:t,closeable:!0}):C.Z.previewImage({urls:this.getMobileImgs,current:t})}}},P=(0,s(1001).Z)(x,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"article-detail-wrap"},[s("div",{staticClass:"contet-wrap"},[s("div",{staticClass:"detail-wrap"},[s("div",{staticClass:"author flex"},[s("span",[s("van-image",{staticStyle:{"margin-right":"8px"},attrs:{src:t.detail.author&&t.detail.author.avatar||t.avatar,width:"18",height:"18",round:"",fit:"cover"}}),s("span",[t._v(t._s(t.detail.author?t.detail.author.name:""))])],1),s("span",{directives:[{name:"show",rawName:"v-show",value:t.detail.author.id===t.userId,expression:"detail.author.id === userId"}],on:{click:function(e){return e.stopPropagation(),t.handleDelete.apply(null,arguments)}}},[t._v(t._s(t.$t("micro.delete")))]),s("Icon",{directives:[{name:"show",rawName:"v-show",value:t.isApp,expression:"isApp"}],staticClass:"share_icon",attrs:{size:"24px",name:"share-o"},on:{click:t.handleShare}})],1),s("div",{staticClass:"title"},[t._v(t._s(t.detail.title))]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.detail.topic&&t.detail.topic.length,expression:"detail.topic && detail.topic.length"}]},t._l(t.detail.topic,(function(e,a){return s("topicItem",{key:a,attrs:{"topic-name":e,"no-close":!0},on:{clickDetail:t.aboutTopicList}})})),1),s("div",{staticClass:"explain"},[t.isMobile?s("div",[s("DescList",{attrs:{list:t.handelOrigin}}),s("div",{staticClass:"img-list"},t._l(t.getMobileImgs,(function(e,a){return s("van-image",{key:a,staticStyle:{"margin-bottom":"8px"},attrs:{src:e,width:"48%",height:"160",fit:"contain",radius:"5"},on:{click:function(e){return t.getImg(a)}}})})),1)],1):s("Preview",{attrs:{data:t.content}})],1),s("div",{staticClass:"time-answerCount flex"},[s("span",[t._v(t._s(t.changeTimeAgoLabel(t.detail.createAt)))]),s("span",{staticStyle:{"margin-left":"12px"},on:{click:t.handleClickStar}},[s("SvgIcon",{staticStyle:{"margin-right":"5px"},attrs:{color:t.getColor,size:14,"icon-class":"icon-zan2"}}),t._v(t._s(t.detail.stars||0))],1)])]),s("div",{staticClass:"comment-list"},[s("div",{staticClass:"comment-num"},[t._v(" "+t._s(t.$t("micro.comment"))+" ("+t._s(t.params.total)+") ")]),t.commentList.length?s("div",[s("van-list",{attrs:{finished:t.finished,"finished-text":t.$t("community.noneCommentsTips")},on:{load:t.handleGetCommentLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.commentList,(function(e,a){return s("comment",{key:a,attrs:{"comment-obj":e,"is-author":t.detail.author.id===t.userId},on:{commentFinished:t.commentFinished,deleteReply:t.deleteReply,deleteComment:t.deleteComment}})})),1)],1):s("div",[s("noData",{attrs:{"tip-text":t.$t("community.noComments")}})],1)])]),s("div",{staticClass:"bottom-btn-wrap"},[s("div",{staticClass:"btn",on:{click:function(e){return e.stopPropagation(),t.handleKeyBoard.apply(null,arguments)}}},[s("SvgIcon",{staticStyle:{"margin-right":"5px"},attrs:{color:"#7f849a",size:14,"icon-class":"icon-morecopy"}}),s("span",[t._v(t._s(t.$t("micro.comment"))+"...")])],1)]),s("van-popup",{attrs:{position:"bottom","get-container":"body","safe-area-inset-bottom":""},model:{value:t.showComment,callback:function(e){t.showComment=e},expression:"showComment"}},[s("div",{staticClass:"common-popup-content"},[s("replyMe",{attrs:{"show-comment":t.showComment,"article-id":t.articleId,"commit-loading":t.commitLoading},on:{comment:t.handleComment}})],1)]),s("cl-water-mark",{attrs:{scenes:"community"}})],1)}),[],!1,null,"55ac4872",null).exports},39842:(t,e,s)=>{s.r(e),s.d(e,{default:()=>d});s(21920);var a=s(58280),i=(s(49902),s(62094)),o=(s(52355),s(29233)),r=(s(47601),s(44951)),n=(s(45172),s(76475)),c=s(28514),l=s(49213),u={name:"MoreGroups",components:{Search:c.Z,[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,[a.Z.name]:a.Z},props:{selectCircleList:{type:String,default:""}},data:()=>({selCircleVal:"",groupLists:[],loading:!1,params:{page:0,size:15,text:"",t:"space",loading:!0}}),computed:{primaryColor(){return this.$store.state.themeColor.primaryColor}},mounted(){this.selCircleVal=this.selectCircleList},created(){this.getgroups()},methods:{async getgroups(){this.loading=!0;const{data:t}=await l.Z.searchGroups(this.params);0===t.code&&t.data&&(this.groupLists=t.data.content,this.loading=!1)},handleSearch(t){this.params.text=t,this.getgroups()},handleOk(){if(this.selCircleVal)for(let t=0;t<this.groupLists.length;t++){const e=this.groupLists[t];if(e.id===this.selCircleVal)return void this.$emit("select",e)}}}},d=(0,s(1001).Z)(u,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"more-groups"},[s("div",{staticClass:"top-search"},[s("Search",{attrs:{placeholder:t.$t("community.searchCircle")},on:{search:t.handleSearch}})],1),s("div",{staticClass:"more-groups-action"},[s("van-skeleton",{attrs:{title:"",avatar:"",row:1,loading:t.loading}},[s("van-radio-group",{model:{value:t.selCircleVal,callback:function(e){t.selCircleVal=e},expression:"selCircleVal"}},t._l(t.groupLists,(function(e){return s("van-cell",{key:e.id,scopedSlots:t._u([{key:"title",fn:function(){return[s("van-radio",{attrs:{name:e.id,"checked-color":t.primaryColor}},[s("div",{staticClass:"group-item"},[s("van-image",{attrs:{src:e.awatar,width:"40",height:"40",fit:"cover",round:""}}),s("div",{staticClass:"group-item-desc"},[s("div",{staticClass:"group-item-desc-name"},[t._v(t._s(e.name))]),s("div",{staticClass:"group-item-desc-count"},[s("span",[t._v(t._s(t.$t("community.article"))+"："+t._s(e.articleCount||0))]),s("span",[t._v(t._s(t.$t("community.answers"))+"："+t._s(e.answerCount||0))])])])],1)])]},proxy:!0}],null,!0)})})),1)],1)],1),s("div",{staticClass:"bottom-btn"},[s("div",{staticClass:"en-sure",style:{color:t.selCircleVal?"#fff":t.primaryColor,"background-color":t.selCircleVal?t.primaryColor:"#fff","border-color":t.primaryColor},on:{click:t.handleOk}},[t._v(t._s(t.$t("community.confirm")))])])])}),[],!1,null,"5ca89a33",null).exports},12429:(t,e,s)=>{s.r(e),s.d(e,{default:()=>$});s(34837);var a=s(39146),i=(s(23307),s(81392)),o=(s(39610),s(2163)),r=(s(47601),s(44951)),n=s(49213),c=s(56469),l=s(95082),u=(s(49153),s(5944)),d=(s(20581),s(50914)),h=(s(21790),s(24031)),p=(s(26699),s(32023),s(57658),s(78551)),m=s(22648),g={name:"ViewItem",components:{[r.Z.name]:r.Z,SvgIcon:p.Z,Tag:h.Z},props:{dataItem:{type:Object,default:()=>{}},listType:{type:String,default:""}},data:()=>({}),computed:{formatDate(){let t="";return t="groupQuestion"===this.listType?this.dataItem.lastDate:this.dataItem.createAt,(0,m.TC)(t,this)},groupType(){return this.listType.toLowerCase().includes("article")}},created(){},methods:{groupDetailLink(t){const e="groupQuestion"===this.listType?"question-detail":"article-detail",s="groupQuestion"===this.listType?"questionId":"articleId";this.$router.push({path:`/community/${e}?${s}=${t.id}`})}}},v=s(1001),f=(0,v.Z)(g,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"question-item"},[s("div",{staticClass:"question-item-top"},[s("van-image",{attrs:{round:"",fit:"cover",width:"25",height:"25",src:t.dataItem.author.avatar||"https://oss.coolcollege.cn/1790708689137700864.png"}}),s("span",{staticClass:"question-item-top-name"},[t._v(t._s(t.dataItem.author.name))])],1),s("div",{staticClass:"question-item-content",on:{click:function(e){return t.groupDetailLink(t.dataItem)}}},[1===t.dataItem.isTop?s("Tag",{attrs:{"text-color":"#1890FF",color:"#91D5FF",plain:""}},[t._v(t._s(t.$t("community.isTop")))]):t._e(),t._v(" "+t._s(t.dataItem.title))],1),s("div",{staticClass:"question-item-bottom"},[s("div",{staticClass:"question-item-bottom-time"},[t._v(t._s(t.formatDate))]),t.listType.toLowerCase().includes("question")?s("div",{staticClass:"question-item-bottom-count"},[s("div",{staticClass:"answer-count"},[s("SvgIcon",{attrs:{"icon-class":"icon-huidashu",color:"#c0c2cb",size:14}}),t._v(" "+t._s(t.dataItem.answerCount)+" ")],1)]):s("div",{staticClass:"question-item-bottom-count"},[s("div",{staticClass:"comment-count"},[s("SvgIcon",{attrs:{"icon-class":"icon-pinglun",color:"#c0c2cb",size:14}}),t._v(" "+t._s(t.dataItem.commentCount)+" ")],1),s("div",{staticClass:"like-count"},[s("SvgIcon",{attrs:{"icon-class":"icon-zan2",color:"#c0c2cb",size:14}}),t._v(" "+t._s(t.dataItem.stars)+" ")],1)])])])}),[],!1,null,"6132f5d5",null).exports,y={name:"ViewList",components:{[d.Z.name]:d.Z,[u.Z.name]:u.Z,ViewItem:f},props:{listType:{type:String,default:""},spaceId:{type:String,default:""}},data:()=>({loading:!1,finished:!0,error:!1,list:[],total:0,pageParams:{size:15,page:0}}),computed:{requestAction(){switch(this.listType){case"groupArticle":return"getGroupArticle";case"groupQuestion":return"getGroupQuestion";default:return""}},params(){switch(this.listType){case"groupArticle":case"groupQuestion":return(0,l.Z)((0,l.Z)({},this.pageParams),{},{spaceId:this.spaceId});case"hotquestion":return"getGroupQuestion";default:return this.pageParams}}},created(){this.getList()},methods:{async getList(){if(this.requestAction){this.loading=!0;const{data:t}=await n.Z[this.requestAction](this.params);if(0===t.code&&t.data){this.loading=!1;const{content:e=[],totalElements:s,totalPages:a}=t.data;this.total=s,this.list=0===this.pageParams.page?e:this.list.concat(e),this.finished=this.pageParams.page>=a}else this.loading=!1,this.error=!0}},onLoad(){this.pageParams.page+=1,this.getList()}}},_=(0,v.Z)(y,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"view-list"},[t.total?s("van-list",{attrs:{finished:t.finished,"finished-text":t.$t("common.noMore"),error:t.error,"error-text":t.$t("common.failLoading")},on:{"update:error":function(e){t.error=e},load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e,a){return s("ViewItem",{key:e.id+a,attrs:{"list-type":t.listType,"data-item":e}})})),1):s("van-empty",{attrs:{description:t.$t("community.noData")}})],1)}),[],!1,null,"c4851534",null).exports,C=s(55602),I=s(27632),b=s(28787),w={name:"GroupDetail",components:{[r.Z.name]:r.Z,[o.Z.name]:o.Z,Tabs:c.Z,ViewList:_,Icon:i.Z},data:()=>({id:"",detail:{},tabs:[{lable:"问答",value:"groupQuestion"},{lable:"文章",value:"groupArticle"}]}),computed:{isApp:()=>"app"===I.Z.env},created(){const{id:t=""}=this.$route.query;this.id=t,Array.isArray(t)&&t.length>0&&(this.id=t[0]),this.getGroupDetail()},mounted(){const{name:t=""}=this.$route.query;t&&(document.title=t,"wechat"!==I.Z.env&&"dingTalk"!==I.Z.env&&"wechat_h5"!==I.Z.env||(0,C.vD)({shareInfo:{title:t,desc:t,path:"dingTalk"===I.Z.env?`/pages/messageRedirect/messageRedirect?flag=groupSpace&id=${this.id}`:`/pages/login/login?flag=groupSpace&enterpriseId=${this.$store.state.commonParams.enterpriseId}&id=${this.id}&shareType=wxGroupShare`}}))},methods:{async getGroupDetail(){if(!this.id)return;const{data:t}=await n.Z.getGroupDetail(this.id);0===t.code&&t.data?this.detail=t.data:(0,a.Z)(this.$t("community.getGroupDetailError"))},handleShare(){if("wechat"!==I.Z.env&&"dingTalk"!==I.Z.env){const{accessToken:t}=b.Z.state.commonParams;(0,C.vD)({shareInfo:{title:this.detail.name,desc:this.detail.name,path:`${VUE_H5}#/community/group-detail?msgSource=emailMessage&flag=groupSpace&id=${this.id}&access_token=${t}`}})}}}},$=(0,v.Z)(w,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"group-detail"},[s("div",{staticClass:"group-detail-top"},[s("Icon",{directives:[{name:"show",rawName:"v-show",value:t.isApp,expression:"isApp"}],staticClass:"share_icon",attrs:{size:"24px",name:"share-o"},on:{click:t.handleShare}}),s("div",{staticClass:"group-detail-top-name"},[s("van-image",{attrs:{src:t.detail.awatar,width:"50",height:"50",round:"",fit:"cover"}}),s("span",{staticClass:"group-name"},[t._v(t._s(t.detail.name))])],1),t.detail.description?s("div",{staticClass:"group-detail-top-desc"},[t._v(t._s(t.detail.description))]):t._e()],1),s("div",{staticClass:"group-detail-bottom"},[s("Tabs",{attrs:{sticky:"",tabs:t.tabs}},t._l(t.tabs,(function(e){return s("div",{key:e.value,attrs:{slot:e.value},slot:e.value},[s("ViewList",{attrs:{"list-type":e.value,"space-id":t.id}})],1)})),0)],1)])}),[],!1,null,"1df9c4d8",null).exports},90096:(t,e,s)=>{s.r(e),s.d(e,{default:()=>A});s(57658);var a=s(28514),i=s(56469),o=s(95082),r=(s(20581),s(50914)),n=s(49213),c=s(75230),l=(s(47601),s(44951)),u=s(78551),d=s(13365),h=s(22648),p=s(26294),m=s(98446),g=s(72525),v={components:{[l.Z.name]:l.Z,SvgIcon:u.Z,ListItem:m.Z},props:{detail:{type:Object,default:()=>{}},index:{type:Number,default:0}},data:()=>({avatar:d}),computed:(0,o.Z)((0,o.Z)({},(0,p.mapGetters)({primaryColor:"getPrimaryColor",access_token:"getToken"})),{},{isMobile(){var t,e;const{type:s}=null!==(t=this.detail)&&void 0!==t&&t.content?JSON.parse(null===(e=this.detail)||void 0===e?void 0:e.content):{};return"mobile"===s},handelOrigin(){var t;return(0,g.G)(JSON.parse(null===(t=this.detail)||void 0===t?void 0:t.content))},getMobileImgs(){var t;const{type:e,content:s}=JSON.parse(null===(t=this.detail)||void 0===t?void 0:t.content);return"mobile"===e?s.imgs:[]}}),mounted(){},methods:{handleSpace(){this.$router.push({path:`/community/group-detail?id=${this.detail.space.id}&name=${this.detail.space.name}`})},changeTimeAgoLabel(t){return t?(0,h.TC)(t,this):""}}},f=s(1001),y=(0,f.Z)(v,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"question-article-item"},[s("div",{staticClass:"header flex"},[s("span",[s("van-image",{attrs:{width:"18",height:"18",round:"",fit:"cover",src:t.detail.author&&t.detail.author.avatar||t.avatar}}),s("span",{staticClass:"names"},[t._v(t._s(t.detail.author&&t.detail.author.name))])],1),s("span",{staticClass:"right-space",on:{click:function(e){return e.stopPropagation(),t.handleSpace.apply(null,arguments)}}},[t._v(t._s(t.detail.space&&t.detail.space.name))])]),s("div",{staticClass:"question-article-title"},[t._v(t._s(t.detail.title))]),s("div",[s("div",{staticClass:"home-question-content"},[s("ListItem",{attrs:{list:t.handelOrigin,"is-mobile":t.isMobile,imgs:t.getMobileImgs,detail:t.detail.content}})],1)]),s("div",{staticClass:"time-answerCount flex"},[s("span",[t._v(t._s(t.changeTimeAgoLabel(t.detail.createTime)))]),s("span",[s("SvgIcon",{staticStyle:{"margin-right":"5px"},attrs:{color:"#c0c2cb",size:14,"icon-class":"icon-zan2"}}),t._v(t._s(t.detail.stars||0)+" ")],1)])])}),[],!1,null,"5ac3980b",null).exports,_=(s(21790),s(24031)),C={components:{[l.Z.name]:l.Z,SvgIcon:u.Z,Tag:_.Z,ListItem:m.Z},props:{detail:{type:Object,default:()=>{}},index:{type:Number,default:0}},data:()=>({avatar:d}),computed:(0,o.Z)((0,o.Z)({},(0,p.mapGetters)({primaryColor:"getPrimaryColor",access_token:"getToken"})),{},{isMobile(){const{type:t}=this.detail.content?JSON.parse(this.detail.content):{};return"mobile"===t},handelOrigin(){return(0,g.G)(JSON.parse(this.detail.content))},getMobileImgs(){const{type:t,content:e}=JSON.parse(this.detail.content);return"mobile"===t?e.imgs:[]}}),mounted(){},unmounted(){},methods:{handleSpace(){this.$router.push({path:`/community/group-detail?id=${this.detail.space.id}&name=${this.detail.space.name}`})},changeTimeAgoLabel(t){return t?(0,h.TC)(t,this):""}}},I={name:"HomeList",components:{questionItem:y,articleItem:(0,f.Z)(C,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"question-article-item"},[s("div",{staticClass:"header flex"},[s("span",[s("van-image",{attrs:{width:"18",height:"18",round:"",fit:"cover",src:t.detail.author&&t.detail.author.avatar||t.avatar}}),s("span",{staticClass:"names"},[t._v(t._s(t.detail.author&&t.detail.author.name))])],1),s("span",{staticClass:"right-space",on:{click:function(e){return e.stopPropagation(),t.handleSpace.apply(null,arguments)}}},[t._v(t._s(t.detail.space&&t.detail.space.name))])]),s("div",{staticClass:"question-article-title"},[1===t.detail.isTop?s("Tag",{attrs:{"text-color":"#1890FF",color:"#91D5FF",plain:""}},[t._v(t._s(t.$t("community.isTop")))]):t._e(),t._v(" "+t._s(t.detail.title)+" ")],1),s("div",[s("div",{staticClass:"question-article-content"},[s("ListItem",{attrs:{list:t.handelOrigin,"is-mobile":t.isMobile,imgs:t.getMobileImgs,detail:t.detail.content}})],1)]),s("div",{staticClass:"time-answerCount flex"},[s("span",[t._v(t._s(t.changeTimeAgoLabel(t.detail.createTime)))]),s("span",[s("span",[s("SvgIcon",{staticStyle:{"margin-right":"5px"},attrs:{color:"#c0c2cb",size:14,"icon-class":"icon-liuyan"}}),t._v(" "+t._s(t.detail.commentCount)+" ")],1),s("span",{staticStyle:{"margin-left":"12px"}},[s("SvgIcon",{staticStyle:{"margin-right":"5px"},attrs:{color:"#c0c2cb",size:14,"icon-class":"icon-zan2"}}),t._v(t._s(t.detail.stars||0)+" ")],1)])])])}),[],!1,null,"a53783d4",null).exports,[r.Z.name]:r.Z,noData:c.Z},props:{tabVal:{type:String,default:"hot"}},data:()=>({showNoData:!1,loading:!1,finished:!1,hotList:[],params:{page:0,size:10,total:0}}),watch:{tabVal(){this.params.page=0,this.funGetHotList()}},mounted(){this.funGetHotList()},methods:{funLoadMore(){this.params.page+=1,this.funGetHotList()},async funGetHotList(){let t="";switch(this.tabVal.toLowerCase()){case"article":t="ARTICLE";break;case"question":t="QUESTION"}this.loading=!0;let{data:e}=await n.Z.getHotList((0,o.Z)((0,o.Z)({},this.params),{},{type:t}));0===e.code&&(this.loading=!1,this.hotList=0===this.params.page?e.data.content:this.hotList.concat(e.data.content),this.finished=this.hotList.length===e.data.totalElements,this.showNoData=0===this.hotList.length)},handleDetail(t){const{refType:e,refId:s}=t;switch(e.toLowerCase()){case"article":this.$router.push({path:`/community/article-detail?articleId=${s}`});break;case"answer":case"question":this.$router.push({path:`/community/question-detail?questionId=${s}`})}}}},b=(0,f.Z)(I,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"home-list"},[t.hotList.length?s("van-list",{directives:[{name:"show",rawName:"v-show",value:t.hotList.length,expression:"hotList.length"}],attrs:{"finished-text":t.$t("community.isBottom"),finished:t.finished},on:{load:t.funLoadMore},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.hotList,(function(e,a){return s("div",{key:e.id,on:{click:function(s){return t.handleDetail(e)}}},["QUESTION"===e.refType?s("questionItem",{attrs:{detail:e,index:a}}):t._e(),"ARTICLE"===e.refType?s("articleItem",{attrs:{detail:e,index:a}}):t._e()],1)})),0):t._e(),t.showNoData?s("noData",{attrs:{"tip-text":t.$t("community.noData")}}):t._e()],1)}),[],!1,null,null,null).exports,w=(s(23307),s(81392)),$=(s(53743),s(59978)),k=(s(629),s(67763)),S={name:"HomeGroups",components:{[k.Z.name]:k.Z,[$.Z.name]:$.Z,[l.Z.name]:l.Z,[w.Z.name]:w.Z},props:{prefixCls:{type:String,default:""}},data:()=>({groups:[]}),computed:{themeColor(){return this.$store.state.themeColor}},created(){this.getgroups()},methods:{async getgroups(){const{data:t}=await n.Z.getGroups(1,{page:0,size:4});0===t.code&&t.data&&(this.groups=t.data.content)},handleSpace(t){this.$router.push({path:`/community/group-detail?id=${t.id}&name=${t.name}`})},handleMoreGroups(){this.$router.push({path:"/community/more-groups"})}}},T=(0,f.Z)(S,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"home-groups"},[s("van-grid",{attrs:{border:!1,"column-num":"5"}},[t._l(t.groups,(function(e){return s("van-grid-item",{key:e.id,attrs:{text:e.name},on:{click:function(s){return t.handleSpace(e)}},scopedSlots:t._u([{key:"icon",fn:function(){return[s("van-image",{attrs:{src:e.awatar,width:"45",height:"45",round:"",fit:"cover"}})]},proxy:!0},{key:"text",fn:function(){return[s("div",{staticClass:"home-groups-name"},[t._v(t._s(e.name))])]},proxy:!0}],null,!0)})})),t.groups.length?s("van-grid-item",{attrs:{text:t.$t("community.more")},on:{click:t.handleMoreGroups},scopedSlots:t._u([{key:"icon",fn:function(){return[s("van-icon",{attrs:{name:"more-o",size:"40"}})]},proxy:!0}],null,!1,2744530935)}):t._e()],2)],1)}),[],!1,null,"26630b0a",null).exports,Z={name:"CommunityHomeBtns",components:{SvgIcon:u.Z},filters:{formateCounts:t=>t<100?t:"99+"},data(){return{mentionCounts:0,btnList:[{text:this.$t("community.publish"),icon:"icon-fabu",type:"publish"},{text:this.$t("community.news"),icon:"icon-xiaoxi",type:"news"},{text:this.$t("community.writingCenter"),icon:"icon-chuangzuozhongxin",type:"writingCenter"}]}},mounted(){this.mentionCount()},methods:{handleBtn(t){this.$emit("clickBtnType",t)},async mentionCount(){let{data:t}=await n.Z.mentionCount();0===t.code&&(this.mentionCounts=t.data||0)}}},x=(0,f.Z)(Z,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"community-home-btn"},t._l(t.btnList,(function(e){return s("div",{key:e.type,staticClass:"community-home-btn-item",on:{click:function(s){return s.stopPropagation(),t.handleBtn(e.type)}}},[s("SvgIcon",{attrs:{color:"#7f849a",size:20,"icon-class":e.icon}}),s("span",{staticClass:"names"},[t._v(t._s(e.text))]),s("span",{directives:[{name:"show",rawName:"v-show",value:"news"===e.type&&t.mentionCounts,expression:"item.type === 'news' && mentionCounts"}],staticClass:"message-count-tips"},[t._v(t._s(t._f("formateCounts")(t.mentionCounts)))])],1)})),0)}),[],!1,null,"098fb060",null).exports,P={name:"CommunityHomeBtnsPublish",components:{SvgIcon:u.Z},data(){return{btnList:[{text:this.$t("community.askQuestion"),icon:"icon-tigewenti",color:"#C0E0FE",iconColor:"#1890FF",type:"askQuestion"},{text:this.$t("community.answer"),icon:"icon-huidawenti",color:"#FEE5C2",iconColor:"#FFA000",type:"answer"},{text:this.$t("community.publishArticle"),icon:"icon-fabiaowenzhang",color:"#CCEDEF",iconColor:"#2EB8BD",type:"publishArticle"}]}},mounted(){},methods:{handleBtn(t){switch(t){case"askQuestion":this.$router.push({path:"/community/ask-question"});break;case"answer":this.$router.push({path:"/community/answer-question-list"});break;case"publishArticle":this.$router.push({path:"/community/add-article"})}},handleClose(){this.$emit("close")}}},D=(0,f.Z)(P,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"community-home-btn-publish"},[s("div",{staticClass:"community-wrap"},[s("div",{staticClass:"community-wrap-btn"},t._l(t.btnList,(function(e){return s("div",{key:e.type,staticClass:"community-wrap-btn-item",on:{click:function(s){return s.stopPropagation(),t.handleBtn(e.type)}}},[s("span",{staticClass:"icon-wrap",style:{backgroundColor:e.color}},[s("SvgIcon",{attrs:{color:e.iconColor,size:20,"icon-class":e.icon}})],1),s("span",{staticClass:"names"},[t._v(t._s(e.text))])])})),0),s("div",{staticClass:"close-btn",on:{click:function(e){return e.stopPropagation(),t.handleClose.apply(null,arguments)}}},[s("SvgIcon",{attrs:{color:"#7f849a",size:34,"icon-class":"icon-guanbichuangjianweike"}})],1)])])}),[],!1,null,"02c6172e",null).exports,L={name:"CommunityHome",components:{Search:a.Z,Tabs:i.Z,HomeList:b,HomeGroups:T,HomeBtns:x,HomeBtnsPublish:D},data(){return{tabs:[{lable:this.$t("community.hot"),value:"hot"},{lable:this.$t("community.answers"),value:"question"},{lable:this.$t("community.article"),value:"article"}],tabVal:"hot",puhlishVisiable:!1}},created(){},methods:{changeTabs(t){this.tabVal=t},handleClickBtn(t){switch(t){case"publish":this.puhlishVisiable=!0;break;case"news":this.$router.push({path:"/community/news-list"});break;case"writingCenter":this.$router.push({path:"/community/create-center"})}},searchAll(t){this.$router.push({path:`/community/home-search?val=${t}`})}}},A=(0,f.Z)(L,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"community-home"},[s("div",{staticClass:"top"},[s("Search",{attrs:{tabs:""},on:{search:t.searchAll}}),s("Tabs",{attrs:{tabs:t.tabs},on:{changeTabs:t.changeTabs}})],1),s("div",{staticClass:"home-content"},[s("HomeGroups"),s("HomeList",{attrs:{"tab-val":t.tabVal}})],1),s("HomeBtns",{on:{clickBtnType:t.handleClickBtn}}),t.puhlishVisiable?s("HomeBtnsPublish",{on:{close:function(e){t.puhlishVisiable=!1}}}):t._e()],1)}),[],!1,null,"3233b6aa",null).exports},34731:(t,e,s)=>{s.r(e),s.d(e,{default:()=>h});s(45172);var a=s(76475),i=s(28514),o=s(49213),r=(s(52355),s(29233)),n=(s(47601),s(44951)),c={name:"GroupItem",components:{[n.Z.name]:n.Z,[r.Z.name]:r.Z},props:{groupItem:{type:Object,default:()=>{}}},data:()=>({}),created(){},methods:{}},l=s(1001),u=(0,l.Z)(c,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("van-cell",{attrs:{value:"",to:"/community/group-detail?id="+t.groupItem.id+"&name="+t.groupItem.name},scopedSlots:t._u([{key:"title",fn:function(){return[s("div",{staticClass:"group-item"},[s("van-image",{attrs:{src:t.groupItem.awatar,width:"40",height:"40",fit:"cover",round:""}}),s("div",{staticClass:"group-item-desc"},[s("div",{staticClass:"group-item-desc-name"},[t._v(t._s(t.groupItem.name))]),s("div",{staticClass:"group-item-desc-count"},[s("span",[t._v(t._s(t.$t("community.article"))+"："+t._s(t.groupItem.articleCount||0))]),s("span",[t._v(t._s(t.$t("community.answers"))+"："+t._s(t.groupItem.answerCount||0))])])])],1)]},proxy:!0}])})}),[],!1,null,"a7852728",null).exports,d={name:"MoreGroups",components:{Search:i.Z,GroupItem:u,[a.Z.name]:a.Z},data:()=>({groups:[],params:{page:0,size:15,text:"",t:"space",loading:!0}}),created(){this.getgroups()},methods:{async getgroups(){const{data:t}=await o.Z.searchGroups(this.params);0===t.code&&t.data&&(this.groups=t.data.content,this.loading=!1)},handleSearch(t){this.params.text=t,this.getgroups()}}},h=(0,l.Z)(d,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"more-groups"},[s("div",{staticClass:"top-search"},[s("Search",{attrs:{placeholder:t.$t("community.searchCircle")},on:{search:t.handleSearch}})],1),s("van-skeleton",{attrs:{title:"",avatar:"",row:1,loading:t.loading}},[s("div",{staticClass:"more-groups-action"},t._l(t.groups,(function(e){return s("GroupItem",{key:e.id,attrs:{"group-item":e}},[t._v(t._s(e.name))])})),1)])],1)}),[],!1,null,"18997664",null).exports},76154:(t,e,s)=>{s.r(e),s.d(e,{default:()=>y});s(34837);var a=s(39146),i=s(95082),o=(s(93787),s(20090)),r=(s(57658),s(33948),s(74916),s(15306),s(38862),s(78551)),n=s(49213),c=s(56709),l=s(39842),u=s(828),d=s(94386),h=s(75748),p=s(26294),m=s(23279),g=s.n(m),v={name:"AskQuestion",components:{[o.Z.name]:o.Z,SvgIcon:r.Z,imgList:c.Z,circleCom:l.default,topicCom:u.default,topicItem:h.Z,ClUpload:d.Z},data:()=>({topicComType:"",articleForm:{title:"",topic:[],content:"",imgs:[],circle:{}},commitLoading:!1}),computed:(0,i.Z)((0,i.Z)({},(0,p.mapGetters)({access_token:"getToken"})),{},{primaryColor(){return this.$store.state.themeColor.primaryColor},publishStyle(){return this.commitLoading?{backgroundColor:"#b7bac8",borderColor:"#b7bac8",color:"#999"}:{"background-color":this.primaryColor,"border-color":this.primaryColor}}}),mounted(){},methods:{onSuccess(t){t.forEach((t=>{this.articleForm.imgs.push(t.url)}))},handleDeleteImg(t){this.articleForm.imgs.splice(t,1)},handleSelectTopic(t){this.topicComType="",this.articleForm.topic=[...t]},handleDeleteTopic(t){this.articleForm.topic.splice(this.articleForm.topic.indexOf(t),1)},handleSelectCircle(t){this.topicComType="",this.articleForm.circle=(0,i.Z)({},t)},handleCancel(){history.go(-1)},handlePublish(){this.articleForm.title?this.articleForm.circle.name?(this.commitLoading=!0,this.toPublish()):(0,a.Z)(this.$t("community.circleTips")):(0,a.Z)(this.$t("community.questionTips"))},toPublish:g()((async function(){let t={type:"mobile",content:{content:this.articleForm.content.replace(/\n/g,"<br/>"),imgs:this.articleForm.imgs}},{data:e}=await n.Z.addArticle(this.articleForm.circle.id,{title:this.articleForm.title,topic:this.articleForm.topic,circle:this.articleForm.circle.id,content:JSON.stringify(t)});0===e.code&&(this.$router.push({path:`/community/article-detail?articleId=${e.data.id}`}),this.commitLoading=!1),this.commitLoading=!1}),300)}},f=v,y=(0,s(1001).Z)(f,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ask-question"},[s("div",{staticClass:"form-content"},[s("div",{staticClass:"form-item"},[s("div",{staticClass:"labels"},[t._v(t._s(t.$t("community.articleTitle")))]),s("van-field",{attrs:{maxlength:"1000",clearable:"",placeholder:t.$t("community.placeholderInput")},model:{value:t.articleForm.title,callback:function(e){t.$set(t.articleForm,"title","string"==typeof e?e.trim():e)},expression:"articleForm.title"}})],1),s("div",{staticClass:"form-item",on:{click:function(e){e.stopPropagation(),t.topicComType="topic"}}},[s("div",{staticClass:"flex"},[s("div",{staticClass:"labels"},[t._v(t._s(t.$t("community.topic"))+"("+t._s(t.articleForm.topic.length)+"/5)")]),s("SvgIcon",{attrs:{color:"#111f2c",size:18,"icon-class":"icon-tianjia"}})],1),s("div",{directives:[{name:"show",rawName:"v-show",value:t.articleForm.topic.length,expression:"articleForm.topic.length"}],staticStyle:{"padding-top":"15px"}},t._l(t.articleForm.topic,(function(e,a){return s("topicItem",{key:a,attrs:{"topic-name":e},on:{delete:t.handleDeleteTopic}})})),1)]),s("div",{staticClass:"form-item"},[s("div",{staticClass:"labels"},[t._v(" "+t._s(t.$t("community.textContent"))),s("span",{staticClass:"optional"},[t._v("（"+t._s(t.$t("community.optional"))+"）")])]),s("van-field",{attrs:{type:"textarea",rows:"9",maxlength:"5000","show-word-limit":"",clearable:"",placeholder:t.$t("community.placeholderInput")},model:{value:t.articleForm.content,callback:function(e){t.$set(t.articleForm,"content","string"==typeof e?e.trim():e)},expression:"articleForm.content"}})],1),s("div",{staticClass:"form-item"},[s("cl-upload",{on:{onSuccess:t.onSuccess}}),s("div",{directives:[{name:"show",rawName:"v-show",value:t.articleForm.imgs.length,expression:"articleForm.imgs.length"}],staticStyle:{"padding-top":"15px"}},[s("imgList",{attrs:{"img-list":t.articleForm.imgs},on:{delete:t.handleDeleteImg}})],1)],1),s("div",{staticClass:"form-item flex",on:{click:function(e){e.stopPropagation(),t.topicComType="circle"}}},[s("div",{staticClass:"labels"},[t._v(t._s(t.$t("community.selCircle")))]),s("span",[t._v(t._s(t.articleForm.circle.name)),s("SvgIcon",{attrs:{color:"#111f2c",size:18,"icon-class":"icon-arrow-r"}})],1)])]),s("div",{staticClass:"bottom-btn-wrap flex-around"},[s("span",{staticClass:"cancel",style:{color:t.primaryColor,"border-color":t.primaryColor},on:{click:function(e){return e.stopPropagation(),t.handleCancel.apply(null,arguments)}}},[t._v(t._s(t.$t("common.cancel")))]),s("span",{staticClass:"publish",style:t.publishStyle,attrs:{disabled:t.commitLoading},on:{click:function(e){return e.stopPropagation(),t.handlePublish.apply(null,arguments)}}},[t._v(t._s(t.$t("community.publish")))])]),""!==t.topicComType?s("div",{staticClass:"topic-Com"},[s("topicCom",{directives:[{name:"show",rawName:"v-show",value:"topic"===t.topicComType,expression:"topicComType === 'topic'"}],attrs:{"select-topic-list":t.articleForm.topic||[]},on:{select:t.handleSelectTopic}}),s("circleCom",{directives:[{name:"show",rawName:"v-show",value:"circle"===t.topicComType,expression:"topicComType === 'circle'"}],attrs:{"select-circle-list":t.articleForm.circle.id||""},on:{select:t.handleSelectCircle}})],1):t._e()])}),[],!1,null,"2e4ff9ae",null).exports},74204:(t,e,s)=>{s.r(e),s.d(e,{default:()=>y});s(34837);var a=s(39146),i=s(95082),o=(s(93787),s(20090)),r=(s(57658),s(33948),s(74916),s(15306),s(38862),s(78551)),n=s(49213),c=s(56709),l=s(39842),u=s(828),d=s(94386),h=s(75748),p=s(26294),m=s(23279),g=s.n(m),v={name:"AskQuestion",components:{[o.Z.name]:o.Z,SvgIcon:r.Z,imgList:c.Z,circleCom:l.default,topicCom:u.default,topicItem:h.Z,ClUpload:d.Z},data:()=>({topicComType:"",questionForm:{title:"",topic:[],content:"",imgs:[],circle:{}},commitLoading:!1}),computed:(0,i.Z)((0,i.Z)({},(0,p.mapGetters)({access_token:"getToken"})),{},{primaryColor(){return this.$store.state.themeColor.primaryColor}}),mounted(){},methods:{onSuccess(t){t.forEach((t=>{this.questionForm.imgs.push(t.url)}))},handleDeleteImg(t){this.questionForm.imgs.splice(t,1)},handleSelectTopic(t){this.topicComType="",this.questionForm.topic=[...t]},handleDeleteTopic(t){this.questionForm.topic.splice(this.questionForm.topic.indexOf(t),1)},handleSelectCircle(t){this.topicComType="",this.questionForm.circle=(0,i.Z)({},t)},handleCancel(){history.go(-1)},handlePublish(){this.questionForm.title?this.questionForm.circle.name?(this.commitLoading=!0,this.publishInfo()):(0,a.Z)(this.$t("community.circleTips")):(0,a.Z)(this.$t("community.questionTips"))},publishInfo:g()((async function(){let t={type:"mobile",content:{content:this.questionForm.content.replace(/\n/g,"<br/>"),imgs:this.questionForm.imgs}},{data:e}=await n.Z.publishQuestion({title:this.questionForm.title,topic:this.questionForm.topic,circle:this.questionForm.circle.id,content:JSON.stringify(t)});0===e.code&&(this.$router.push({path:`/community/question-detail?questionId=${e.data.id}`}),this.commitLoading=!1),this.commitLoading=!1}),500)}},f=v,y=(0,s(1001).Z)(f,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ask-question"},[s("div",{staticClass:"form-content"},[s("div",{staticClass:"form-item"},[s("div",{staticClass:"labels"},[t._v(t._s(t.$t("community.question")))]),s("van-field",{attrs:{maxlength:"1000",clearable:"",placeholder:t.$t("community.placeholderInput")},model:{value:t.questionForm.title,callback:function(e){t.$set(t.questionForm,"title","string"==typeof e?e.trim():e)},expression:"questionForm.title"}})],1),s("div",{staticClass:"form-item",on:{click:function(e){e.stopPropagation(),t.topicComType="topic"}}},[s("div",{staticClass:"flex"},[s("div",{staticClass:"labels"},[t._v(t._s(t.$t("community.topic"))+"("+t._s(t.questionForm.topic.length)+"/5)")]),s("SvgIcon",{attrs:{color:"#111f2c",size:18,"icon-class":"icon-tianjia"}})],1),s("div",{directives:[{name:"show",rawName:"v-show",value:t.questionForm.topic.length,expression:"questionForm.topic.length"}],staticStyle:{"padding-top":"15px"}},t._l(t.questionForm.topic,(function(e,a){return s("topicItem",{key:a,attrs:{"topic-name":e},on:{delete:t.handleDeleteTopic}})})),1)]),s("div",{staticClass:"form-item"},[s("div",{staticClass:"labels"},[t._v(" "+t._s(t.$t("community.tips"))),s("span",{staticClass:"optional"},[t._v("（"+t._s(t.$t("community.optional"))+"）")])]),s("van-field",{attrs:{type:"textarea",rows:"9",maxlength:"5000","show-word-limit":"",clearable:"",placeholder:t.$t("community.placeholderInput")},model:{value:t.questionForm.content,callback:function(e){t.$set(t.questionForm,"content","string"==typeof e?e.trim():e)},expression:"questionForm.content"}})],1),s("div",{staticClass:"form-item"},[s("cl-upload",{on:{onSuccess:t.onSuccess}}),s("div",{directives:[{name:"show",rawName:"v-show",value:t.questionForm.imgs.length,expression:"questionForm.imgs.length"}],staticStyle:{"padding-top":"15px"}},[s("imgList",{attrs:{"img-list":t.questionForm.imgs},on:{delete:t.handleDeleteImg}})],1)],1),s("div",{staticClass:"form-item flex",on:{click:function(e){e.stopPropagation(),t.topicComType="circle"}}},[s("div",{staticClass:"labels"},[t._v(t._s(t.$t("community.selCircle")))]),s("span",[t._v(t._s(t.questionForm.circle.name)),s("SvgIcon",{attrs:{color:"#111f2c",size:18,"icon-class":"icon-arrow-r"}})],1)])]),s("div",{staticClass:"bottom-btn-wrap flex-around"},[s("span",{staticClass:"cancel",style:{color:t.primaryColor,"border-color":t.primaryColor},on:{click:function(e){return e.stopPropagation(),t.handleCancel.apply(null,arguments)}}},[t._v(t._s(t.$t("common.cancel")))]),s("span",{staticClass:"publish",attrs:{disabled:t.commitLoading},on:{click:function(e){return e.stopPropagation(),t.handlePublish.apply(null,arguments)}}},[t._v(t._s(t.$t("community.publish")))])]),""!==t.topicComType?s("div",{staticClass:"topic-Com"},[s("topicCom",{directives:[{name:"show",rawName:"v-show",value:"topic"===t.topicComType,expression:"topicComType === 'topic'"}],attrs:{"select-topic-list":t.questionForm.topic||[]},on:{select:t.handleSelectTopic}}),s("circleCom",{directives:[{name:"show",rawName:"v-show",value:"circle"===t.topicComType,expression:"topicComType === 'circle'"}],attrs:{"select-circle-list":t.questionForm.circle.id||""},on:{select:t.handleSelectCircle}})],1):t._e()])}),[],!1,null,"58cb7c32",null).exports},75748:(t,e,s)=>{s.d(e,{Z:()=>i});s(57658);var a={name:"TopicTag",components:{SvgIcon:s(78551).Z},props:{topicName:{type:String,default:""},noClose:{type:Boolean,default:!1}},data:()=>({}),computed:{primaryColor(){return this.$store.state.themeColor.primaryColor}},mounted(){},methods:{deleteTag(){this.$emit("delete",this.topicName)},aboutList(){this.$router.push({path:`/community/about-topic-list?topic=${this.topicName}`})}}},i=(0,s(1001).Z)(a,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"topic-tag-wrap",on:{click:t.aboutList}},[s("div",[s("SvgIcon",{attrs:{color:"#1890ff",size:18,"icon-class":"icon-quanzi"}}),s("span",{staticClass:"topic-name"},[t._v(t._s(t.topicName))])],1),s("span",{directives:[{name:"show",rawName:"v-show",value:!t.noClose,expression:"!noClose"}],staticClass:"close-btn",on:{click:function(e){return e.stopPropagation(),t.deleteTag.apply(null,arguments)}}},[s("SvgIcon",{attrs:{color:"#ccc",size:14,"icon-class":"icon-icon_close"}})],1)])}),[],!1,null,"48ac4756",null).exports},32352:(t,e,s)=>{s.d(e,{Z:()=>i});s(57658);var a={name:"CommunityHomeBtns",components:{SvgIcon:s(78551).Z},filters:{formateCounts:t=>t<100?t:"99+"},data(){return{btnList:[{text:this.$t("community.askQuestion"),icon:"icon-tigewenti",type:"publish"},{text:this.$t("community.publishArticle"),icon:"icon-fabiaowenzhang",type:"publishArticle"}]}},mounted(){},methods:{handleBtn(t){switch(t){case"publish":this.$router.push({path:"/community/ask-question"});break;case"publishArticle":this.$router.push({path:"/community/add-article"})}}}},i=(0,s(1001).Z)(a,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"community-home-btn"},t._l(t.btnList,(function(e){return s("div",{key:e.type,staticClass:"community-home-btn-item",on:{click:function(s){return s.stopPropagation(),t.handleBtn(e.type)}}},[s("SvgIcon",{attrs:{color:"#7f849a",size:20,"icon-class":e.icon}}),s("span",{staticClass:"names"},[t._v(t._s(e.text))])],1)})),0)}),[],!1,null,"04aff310",null).exports},98446:(t,e,s)=>{s.d(e,{Z:()=>m});s(47601);var a=s(44951),i=(s(33948),s(57658),s(31960),s(10993)),o=s(82482),r=s(67294),n=s(85589),c=s.n(n),l=s(27632);class u extends r.Component{constructor(t){super(t),(0,o.Z)(this,"previewImg",((t,e)=>{"dingTalk"!==l.Z.env?(0,i.Z)({images:t,startPosition:e,closeable:!0}):l.Z.previewImage({urls:t,current:e})})),(0,o.Z)(this,"renderImgAction",(()=>{var{imgUrls:t}=this.state,{show:e=!1}=this.props;if(1===t.length)return r.createElement("div",{className:"image-one"},r.createElement("img",{src:t[0],className:"img-item",onClick:()=>this.previewImg(t,0)}));if(t.length>1&&t.length<6){var s=e?[...t]:[...t].splice(0,3);return r.createElement("div",{className:"image-multiple"},s.map(((t,e)=>r.createElement("img",{src:t,className:"img-item",key:e,onClick:()=>this.previewImg(s,e)}))))}if(t.length>=6){var a=e?[...t]:[...t].splice(0,6);return r.createElement("div",{className:"image-multiple"},a.map(((t,e)=>r.createElement("img",{src:t,className:"img-item",key:e,onClick:()=>this.previewImg(a,e)}))))}})),this.state={imgUrls:[],text:""}}componentDidMount(){this.handleContent()}componentDidUpdate(t){this.props.data!==t.data&&this.handleContent()}handleContent(){var{data:t}=this.props;if(t){var{content:e}=JSON.parse(t),s=c().createEditorState(e).toHTML(),a=document.createElement("div");a.innerHTML=s;for(var i=a.getElementsByTagName("img"),o=[],r=0;r<i.length;r++)o.push(i[r].src);this.setState({imgUrls:o,text:a.innerText})}}render(){var{imgUrls:t,text:e}=this.state,{prefixCls:s,show:a=!1}=this.props;return r.createElement("div",{className:"".concat(s)},r.createElement("div",{className:"".concat(s,"-text ").concat(a?"":"hidden-text")},r.createElement("div",null,e)),t.length>0&&this.renderImgAction())}}u.defaultProps={prefixCls:"cl-display-content"};var d=u,h=s(22126),p={name:"ListItem",components:{[a.Z.name]:a.Z,BraftEditorVue:d,DescList:h.Z},props:{list:{type:Array,default:()=>[]},isMobile:{type:Boolean,default:!1},imgs:{type:Array,default:()=>[]},detail:{type:String,default:""},show:{type:Boolean,default:!1}},data:()=>({}),computed:{imgList:function(){return this.imgs.length>6?this.imgs.slice(0,6):this.imgs}},mounted(){},methods:{}},m=(0,s(1001).Z)(p,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"list-item-half"},[t.isMobile?s("div",[s("DescList",{class:t.show?"":"desc",attrs:{list:t.list}}),s("div",{staticClass:"img-list"},t._l(t.imgList,(function(t,e){return s("van-image",{key:e,staticClass:"img",attrs:{src:t,width:"32%",height:"100",fit:"cover",radius:"5"}})})),1)],1):s("BraftEditorVue",{attrs:{data:t.detail,show:t.show}})],1)}),[],!1,null,"24e775ba",null).exports},56469:(t,e,s)=>{s.d(e,{Z:()=>r});s(82500);var a=s(49414),i=(s(82522),s(10342)),o={name:"Tabs",components:{[i.Z.name]:i.Z,[a.Z.name]:a.Z},props:{tabs:{type:Array,default:()=>[]},sticky:{type:Boolean,default:!0},prefixCls:{type:String,default:""}},data(){return{value:"",active:this.tabs[0].value||"0"}},computed:{themeColor(){return this.$store.state.themeColor}},methods:{changeTabs(){this.$emit("changeTabs",this.active)}}},r=(0,s(1001).Z)(o,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:"cool-tabs "+t.prefixCls},[s("van-tabs",{attrs:{sticky:t.sticky,color:t.themeColor.primaryColor},on:{change:t.changeTabs},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},t._l(t.tabs,(function(e,a){return s("van-tab",{key:a,attrs:{title:e.lable,name:e.value}},[t._t(e.value)],2)})),1)],1)}),[],!1,null,"6f8b7d14",null).exports},22126:(t,e,s)=>{s.d(e,{Z:()=>i});var a={name:"DescList",components:{},props:{list:{type:Array,default:()=>[]}},data:()=>({}),mounted(){},methods:{}},i=(0,s(1001).Z)(a,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"desc-list"},t._l(t.list,(function(e,a){return s("div",{key:a,staticClass:"desc-list-item"},[t._v(t._s(e))])})),0)}),[],!1,null,"450d7ca0",null).exports},56709:(t,e,s)=>{s.d(e,{Z:()=>n});s(31960);var a=s(10993),i=(s(47601),s(44951)),o=s(78551),r={components:{[i.Z.name]:i.Z,[a.Z.Component.name]:a.Z.Component,SvgIcon:o.Z},props:{delBtnVisiable:{type:Boolean,default:!0},imgList:{type:Array,default:()=>{}},imgWidth:{type:String,default:"60px"},imgHeight:{type:String,default:"60px"}},data:()=>({}),mounted(){},methods:{handleDel(t){this.$emit("delete",t)},handlePreview(t){(0,a.Z)({images:this.imgList,startPosition:t})}}},n=(0,s(1001).Z)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"img-list"},t._l(t.imgList,(function(e,a){return s("div",{key:a,staticClass:"imgs"},[s("van-image",{attrs:{fit:"cover",width:t.imgWidth,height:t.imgHeight,radius:"6px",src:e},on:{click:function(e){return t.handlePreview(a)}}}),s("span",{directives:[{name:"show",rawName:"v-show",value:t.delBtnVisiable,expression:"delBtnVisiable"}],on:{click:function(e){return e.stopPropagation(),t.handleDel(a)}}},[s("SvgIcon",{staticClass:"close-btn",attrs:{color:"#666",size:15,"icon-class":"icon-icon_close"}})],1)],1)})),0)}),[],!1,null,"32d6573c",null).exports},59326:(t,e,s)=>{s.d(e,{Z:()=>p});var a=s(95082),i=(s(21790),s(24031)),o=(s(47601),s(44951)),r=(s(57658),s(78551)),n=s(13365),c=s(22648),l=s(26294),u=s(98446),d=s(72525),h={components:{[o.Z.name]:o.Z,SvgIcon:r.Z,Tag:i.Z,ListItem:u.Z},props:{detail:{type:Object,default:()=>{}}},data:()=>({avatar:n}),computed:(0,a.Z)((0,a.Z)({},(0,l.mapGetters)({primaryColor:"getPrimaryColor",access_token:"getToken"})),{},{isMobile(){const{type:t}=this.detail.content?JSON.parse(this.detail.content):{};return"mobile"===t},handelOrigin(){return(0,d.G)(JSON.parse(this.detail.content))},getMobileImgs(){const{type:t,content:e}=JSON.parse(this.detail.content);return"mobile"===t?e.imgs:[]}}),methods:{handleSpace(){this.$router.push({path:`/community/group-detail?id=${this.detail.space.id}&name=${this.detail.space.name}`})},changeTimeAgoLabel(t){return t?(0,c.TC)(t,this):""}}},p=(0,s(1001).Z)(h,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"question-article-item"},[s("div",{staticClass:"header flex"},[s("span",[s("van-image",{attrs:{width:"18",height:"18",round:"",fit:"cover",src:t.detail.author&&t.detail.author.avatar||t.avatar}}),s("span",{staticClass:"names"},[t._v(t._s(t.detail.author&&t.detail.author.name))])],1),s("span",{staticClass:"right-space",on:{click:function(e){return e.stopPropagation(),t.handleSpace.apply(null,arguments)}}},[t._v(t._s(t.detail.space&&t.detail.space.name))])]),s("div",{staticClass:"question-article-title"},[1===t.detail.isTop?s("Tag",{attrs:{"text-color":"#1890FF",color:"#91D5FF",plain:""}},[t._v(t._s(t.$t("community.isTop")))]):t._e(),t._v(" "+t._s(t.detail.title)+" ")],1),s("div",{staticClass:"question-article-content"},[s("ListItem",{attrs:{list:t.handelOrigin,"is-mobile":t.isMobile,imgs:t.getMobileImgs,detail:t.detail.content}})],1),s("div",{staticClass:"time-answerCount flex"},[s("span",[t._v(t._s(t.changeTimeAgoLabel(t.detail.lastDate)))]),s("span",[s("SvgIcon",{staticStyle:{"margin-right":"5px"},attrs:{color:"#c0c2cb",size:14,"icon-class":"icon-huidashu "}}),t._v(t._s(t.detail.answerCount||0))],1)])])}),[],!1,null,"360ddd83",null).exports},94386:(t,e,s)=>{s.d(e,{Z:()=>n});var a=s(78551),i=s(39145),o=s(5141),r={components:{SvgIcon:a.Z},data:()=>({}),methods:{handleSelImg(){i.w.chooseImage({count:9,sourceType:["camera","album"]},(async t=>{this.$toast.loading({duration:0,message:this.$t("common.uploading"),loadingType:"spinner",forbidClick:!0});try{const e=await o.Z.uploadFileIsImage(t);this.$toast.clear(),this.$emit("onSuccess",e)}catch(t){this.$toast.clear()}}))}}},n=(0,s(1001).Z)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"img-sel-field",on:{click:t.handleSelImg}},[s("div",{staticClass:"labels"},[t._v(t._s(t.$t("community.picture")))]),s("SvgIcon",{attrs:{color:"#111f2c",size:18,"icon-class":"icon-tupian1"}})],1)}),[],!1,null,"0c8e1f13",null).exports},17558:(t,e,s)=>{s.r(e),s.d(e,{default:()=>T});s(20581);var a=s(50914),i=(s(57658),s(49213)),o=s(75230),r={props:{countList:{type:Array,default:()=>{}}},data(){return{actionsList:[{title:this.$t("community.myQuestion"),count:0},{title:this.$t("community.myAnswer"),count:0},{title:this.$t("community.myArticle"),count:0}]}}},n=s(1001),c=(0,n.Z)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"top-count"},t._l(t.countList,(function(e,a){return s("div",{key:a,staticClass:"action-item"},[s("div",{staticClass:"action-item-count"},[t._v(t._s(e.count))]),s("div",[t._v(t._s(e.title))])])})),0)}),[],!1,null,"ccc064c0",null).exports,l=s(56469),u=s(95082),d=(s(47601),s(44951)),h=s(78551),p=s(13365),m=s(22648),g=s(26294),v=s(98446),f=s(72525),y={components:{[d.Z.name]:d.Z,SvgIcon:h.Z,ListItem:v.Z},props:{detail:{type:Object,default:()=>{}}},data:()=>({avatar:p}),computed:(0,u.Z)((0,u.Z)({},(0,g.mapGetters)({primaryColor:"getPrimaryColor",access_token:"getToken"})),{},{isMobile(){const{type:t}=this.detail.content?JSON.parse(this.detail.content):{};return"mobile"===t},handelOrigin(){return(0,f.G)(JSON.parse(this.detail.content))},getMobileImgs(){const{type:t,content:e}=JSON.parse(this.detail.content);return"mobile"===t?e.imgs:[]}}),methods:{changeTimeAgoLabel(t){return t?(0,m.TC)(t,this):""}}},_=(0,n.Z)(y,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"question-article-item"},[s("div",{staticClass:"header flex"},[s("span",{staticClass:"titles"},[t._v(t._s(t.detail.title))]),s("span",{staticClass:"right-space"},[t._v(t._s(t.detail.space&&t.detail.space.name))])]),s("div",{staticClass:"question-content-center"},[s("ListItem",{attrs:{list:t.handelOrigin,"is-mobile":t.isMobile,imgs:t.getMobileImgs,detail:t.detail.content}})],1),s("div",{staticClass:"time-answerCount flex no-border"},[s("span",[t._v(t._s(t.changeTimeAgoLabel(t.detail.lastDate)))]),s("span",[s("SvgIcon",{staticStyle:{"margin-right":"5px"},attrs:{color:"#c0c2cb",size:14,"icon-class":"icon-huidashu "}}),t._v(t._s(t.detail.answerCount||0))],1)])])}),[],!1,null,"700f68b4",null).exports,C=(s(21790),s(24031)),I={components:{[d.Z.name]:d.Z,SvgIcon:h.Z,Tag:C.Z,ListItem:v.Z},props:{detail:{type:Object,default:()=>{}}},data:()=>({avatar:p}),computed:(0,u.Z)((0,u.Z)({},(0,g.mapGetters)({primaryColor:"getPrimaryColor",access_token:"getToken"})),{},{isMobile(){const{type:t}=this.detail.content?JSON.parse(this.detail.content):{};return"mobile"===t},handelOrigin(){return(0,f.G)(JSON.parse(this.detail.content))},getMobileImgs(){const{type:t,content:e}=JSON.parse(this.detail.content);return"mobile"===t?e.imgs:[]}}),methods:{changeTimeAgoLabel(t){return t?(0,m.TC)(t,this):""}}},b=(0,n.Z)(I,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"question-article-item"},[s("div",{staticClass:"header flex"},[s("span",{staticClass:"titles"},[1===t.detail.isTop?s("Tag",{attrs:{"text-color":"#1890FF",color:"#91D5FF",plain:""}},[t._v(t._s(t.$t("community.isTop")))]):t._e(),t._v(" "+t._s(t.detail.title))],1),s("span",{staticClass:"right-space"},[t._v(t._s(t.detail.space&&t.detail.space.name))])]),s("div",{staticClass:"article-content-center"},[s("ListItem",{attrs:{list:t.handelOrigin,"is-mobile":t.isMobile,imgs:t.getMobileImgs,detail:t.detail.content}})],1),s("div",{staticClass:"time-answerCount flex no-border"},[s("span",[t._v(t._s(t.changeTimeAgoLabel(t.detail.lastDate)))]),s("span",[s("span",[s("SvgIcon",{staticStyle:{"margin-right":"5px"},attrs:{color:"#c0c2cb",size:14,"icon-class":"icon-pinglun"}}),t._v(t._s(t.detail.commentCount||0))],1),s("span",{staticStyle:{"margin-left":"24px"}},[s("SvgIcon",{staticStyle:{"margin-right":"5px"},attrs:{color:"#c0c2cb",size:14,"icon-class":"icon-zan2"}}),t._v(t._s(t.detail.stars||0))],1)])])])}),[],!1,null,"6e78c8af",null).exports,w={components:{[d.Z.name]:d.Z,SvgIcon:h.Z,Tag:C.Z,ListItem:v.Z},props:{detail:{type:Object,default:()=>{}}},data:()=>({avatar:p}),computed:(0,u.Z)((0,u.Z)({},(0,g.mapGetters)({primaryColor:"getPrimaryColor",access_token:"getToken"})),{},{isMobile(){var t,e,s,a;const{type:i}=null!==(t=this.detail)&&void 0!==t&&null!==(e=t.answer)&&void 0!==e&&e.content?JSON.parse(null===(s=this.detail)||void 0===s||null===(a=s.answer)||void 0===a?void 0:a.content):{};return"mobile"===i},handelOrigin(){var t,e;return(0,f.G)(JSON.parse(null===(t=this.detail)||void 0===t||null===(e=t.answer)||void 0===e?void 0:e.content))},getMobileImgs(){var t,e;const{type:s,content:a}=JSON.parse(null===(t=this.detail)||void 0===t||null===(e=t.answer)||void 0===e?void 0:e.content);return"mobile"===s?a.imgs:[]}}),methods:{changeTimeAgoLabel(t){return t?(0,m.TC)(t,this):""}}},$=(0,n.Z)(w,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"question-article-item"},[s("div",{staticClass:"header flex"},[s("span",{staticClass:"titles"},[1===t.detail.isTop?s("Tag",{attrs:{"text-color":"#1890FF",color:"#91D5FF",plain:""}},[t._v(t._s(t.$t("community.isTop")))]):t._e(),t._v(" "+t._s(t.detail.title))],1),s("span",{staticClass:"right-space"},[t._v(t._s(t.detail.space&&t.detail.space.name))])]),s("div",{staticClass:"answer-content-center"},[s("ListItem",{attrs:{list:t.handelOrigin,"is-mobile":t.isMobile,imgs:t.getMobileImgs,detail:t.detail.answer.content}})],1),s("div",{staticClass:"time-answerCount flex no-border"},[s("span",[t._v(t._s(t.changeTimeAgoLabel(t.detail.lastDate)))]),s("span",[s("SvgIcon",{staticStyle:{"margin-right":"5px"},attrs:{color:"#c0c2cb",size:14,"icon-class":"icon-zan2"}}),t._v(t._s(t.detail.stars||0))],1)])])}),[],!1,null,"5d6cbc78",null).exports,k=s(32352),S={components:{topCount:c,Tabs:l.Z,addBtn:k.Z,questionItem:_,answerItem:$,articleItem:b,[a.Z.name]:a.Z,noData:o.Z},data(){return{showNoData:!1,params:{page:0,size:15},loading:!1,finished:!1,list:[],countList:[{title:this.$t("community.myQuestion"),count:0},{title:this.$t("community.myAnswer"),count:0},{title:this.$t("community.myArticle"),count:0}],tabVal:"question",tabs:[{lable:this.$t("community.askQquestion"),value:"question"},{lable:this.$t("community.answers"),value:"answer"},{lable:this.$t("community.article"),value:"article"}]}},mounted(){this.getMyCreation(),this.getQuestion()},methods:{changeTabs(t){switch(this.tabVal=t,this.params.page=0,t){case"question":this.getQuestion();break;case"answer":this.getAnswer();break;case"article":this.getArticle()}},async getMyCreation(){let{data:t}=await i.Z.myCreation();const{answers:e=0,articles:s=0,questions:a=0}=t.data;this.countList=[{title:this.$t("community.myQuestion"),count:a},{title:this.$t("community.myAnswer"),count:e},{title:this.$t("community.myArticle"),count:s}]},funLoadMore(){switch(this.params.page+=1,this.tabVal){case"question":this.getQuestion();break;case"answer":this.getAnswer();break;case"article":this.getArticle()}},async getQuestion(){this.loading=!0;const{userId:t}=this.$store.state.commonParams;let{data:e}=await i.Z.myCreationQuestions(t,this.params);0===e.code&&(this.loading=!1,this.list=0===this.params.page?e.data.content:this.list.concat(e.data.content),this.finished=this.list.length===e.data.totalElements,this.showNoData=0===this.list.length)},async getAnswer(){this.loading=!0;const{userId:t}=this.$store.state.commonParams;let{data:e}=await i.Z.myCreationAnswers(t,this.params);0===e.code&&(this.loading=!1,this.list=0===this.params.page?e.data.content:this.list.concat(e.data.content),this.finished=this.list.length===e.data.totalElements,this.showNoData=0===this.list.length)},async getArticle(){this.loading=!0;const{userId:t}=this.$store.state.commonParams;let{data:e}=await i.Z.myCreationArticles(t,this.params);0===e.code&&(this.loading=!1,this.list=0===this.params.page?e.data.content:this.list.concat(e.data.content),this.finished=this.list.length===e.data.totalElements,this.showNoData=0===this.list.length)},handleDetail(t){switch(this.tabVal){case"question":case"answer":this.$router.push({path:`/community/question-detail?questionId=${t.id}`});break;case"article":this.$router.push({path:`/community/article-detail?articleId=${t.id}`})}}}},T=(0,n.Z)(S,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"create-center"},[s("topCount",{attrs:{"count-list":t.countList}}),s("Tabs",{attrs:{tabs:t.tabs},on:{changeTabs:t.changeTabs}}),s("div",{directives:[{name:"show",rawName:"v-show",value:t.list.length,expression:"list.length"}],staticClass:"lists"},[s("van-list",{attrs:{"finished-text":t.$t("common.noMore"),finished:t.finished},on:{load:t.funLoadMore},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e,a){return s("div",{key:a,staticStyle:{"margin-bottom":"6px"},on:{click:function(s){return s.stopPropagation(),t.handleDetail(e)}}},["question"===t.tabVal?s("questionItem",{attrs:{detail:e}}):t._e(),"answer"===t.tabVal?s("answerItem",{attrs:{detail:e}}):t._e(),"article"===t.tabVal?s("articleItem",{attrs:{detail:e}}):t._e()],1)})),0)],1),t.showNoData?s("noData",{attrs:{"tip-text":t.$t("community.noData")}}):t._e(),s("addBtn")],1)}),[],!1,null,"a193041a",null).exports},23934:(t,e,s)=>{s.r(e),s.d(e,{default:()=>C});var a=s(95082),i=(s(20581),s(50914)),o=(s(74916),s(64765),s(57658),s(28514)),r=s(78551),n=s(49213),c=s(59326),l=(s(47601),s(44951)),u=s(13365),d=s(22648),h=s(26294),p=s(98446),m=s(72525),g={components:{[l.Z.name]:l.Z,SvgIcon:r.Z,ListItem:p.Z},props:{detail:{type:Object,default:()=>{}}},data:()=>({avatar:u}),computed:(0,a.Z)((0,a.Z)({},(0,h.mapGetters)({primaryColor:"getPrimaryColor",access_token:"getToken"})),{},{isMobile(){const{type:t}=this.detail.content?JSON.parse(this.detail.content):{};return"mobile"===t},handelOrigin(){return(0,m.G)(JSON.parse(this.detail.content))},getMobileImgs(){const{type:t,content:e}=JSON.parse(this.detail.content);return"mobile"===t?e.imgs:[]}}),mounted(){},methods:{handleSpace(){this.$router.push({path:`/community/group-detail?id=${this.detail.space.id}&name=${this.detail.space.name}`})},changeTimeAgoLabel(t){return t?(0,d.TC)(t,this):""}}},v=s(1001),f=(0,v.Z)(g,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"question-article-item"},[s("div",{staticClass:"header flex"},[s("span",[s("van-image",{attrs:{width:"18",height:"18",round:"",fit:"cover",src:t.detail.author&&t.detail.author.avatar||t.avatar}}),s("span",{staticClass:"names"},[t._v(t._s(t.detail.author&&t.detail.author.name))])],1),s("span",{staticClass:"right-space",on:{click:function(e){return e.stopPropagation(),t.handleSpace.apply(null,arguments)}}},[t._v(t._s(t.detail.space&&t.detail.space.name))])]),s("div",{staticClass:"question-article-title"},[t._v(t._s(t.detail.title))]),s("div",{staticClass:"question-article-content"},[s("ListItem",{attrs:{list:t.handelOrigin,"is-mobile":t.isMobile,imgs:t.getMobileImgs,detail:t.detail.content}})],1),s("div",{staticClass:"time-answerCount flex"},[s("span",[t._v(t._s(t.changeTimeAgoLabel(t.detail.lastDate)))]),s("span",[s("span",[s("SvgIcon",{staticStyle:{"margin-right":"5px"},attrs:{color:"#c0c2cb",size:14,"icon-class":"icon-pinglun"}}),t._v(" "+t._s(t.detail.commentCount))],1),s("span",{staticStyle:{"margin-left":"12px"}},[s("SvgIcon",{staticStyle:{"margin-right":"5px"},attrs:{color:"#c0c2cb",size:14,"icon-class":"icon-zan2"}}),t._v(t._s(t.detail.stars||0))],1)])])])}),[],!1,null,"65abe536",null).exports,y=s(75230),_={components:{SvgIcon:r.Z,Search:o.Z,questionItem:c.Z,articleItem:f,[i.Z.name]:i.Z,noData:y.Z},data:()=>({loading:!1,finished:!1,params:{text:"",page:0,size:3},articleList:[],articleTotal:0,questionList:[],questionTotal:0,isMore:""}),computed:{primaryColor(){return this.$store.state.themeColor.primaryColor}},created(){this.params.text=this.$route.query.val},mounted(){this.handleSearch(this.params.text)},methods:{handleSearch(t){this.isMore="",this.params.page=0,this.params.size=3,this.params.text=t,this.search("question"),this.search("article")},funMore(t){this.isMore=t,this.params.page=0,this.params.size=10,this.search(t)},funLoadMore(){this.params.page+=1,this.search(this.isMore)},async search(t){this.loading=!0;const{data:e}=await n.Z.searchGroups((0,a.Z)((0,a.Z)({},this.params),{},{t}));if(0===e.code&&e.data)switch(this.loading=!1,t){case"question":this.questionList=0===this.params.page?e.data.content:this.questionList.concat(e.data.content),this.finished=this.isMore&&this.questionList.length===e.data.totalElements,this.questionTotal=e.data.totalElements||0;break;case"article":this.articleList=0===this.params.page?e.data.content:this.articleList.concat(e.data.content),this.finished=this.isMore&&this.questionList.length===e.data.totalElements,this.articleTotal=e.data.totalElements||0}},hanldeQuestionDetail({id:t}){this.$router.push({path:`/community/question-detail?questionId=${t}`})},hanldeArticleDetail({id:t}){this.$router.push({path:`/community/article-detail?articleId=${t}`})}}},C=(0,v.Z)(_,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"home-search"},[s("div",{staticClass:"top-search"},[s("Search",{attrs:{text:t.params.text,placeholder:t.$t("common.search")},on:{search:t.handleSearch}})],1),s("div",{staticClass:"content-list"},[s("div",{directives:[{name:"show",rawName:"v-show",value:(""===t.isMore||"question"===t.isMore)&&t.questionList.length>0,expression:"(isMore === '' || isMore === 'question') && questionList.length > 0"}],staticClass:"question-list"},[s("div",{staticClass:"title flex"},[s("span",[s("SvgIcon",{attrs:{color:t.primaryColor,size:18,"icon-class":"icon-huidashu"}}),s("span",{staticClass:"types"},[t._v(t._s(t.$t("community.answers")))])],1),s("span",{directives:[{name:"show",rawName:"v-show",value:t.questionList.length<t.questionTotal,expression:"questionList.length < questionTotal"}],on:{click:function(e){return e.stopPropagation(),t.funMore("question")}}},[s("span",{staticClass:"more-btn"},[t._v(t._s(t.$t("community.more")))]),s("SvgIcon",{attrs:{color:"#7F849A",size:12,"icon-class":"icon-right"}})],1)]),s("van-list",{directives:[{name:"show",rawName:"v-show",value:t.questionList.length,expression:"questionList.length"}],attrs:{"finished-text":t.$t("common.noMore"),finished:t.finished},on:{load:t.funLoadMore},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.questionList,(function(e){return s("div",{key:e.id,on:{click:function(s){return s.stopPropagation(),t.hanldeQuestionDetail(e)}}},[s("questionItem",{attrs:{detail:e}})],1)})),0)],1),s("div",{directives:[{name:"show",rawName:"v-show",value:(""===t.isMore||"article"===t.isMore)&&t.articleList.length>0,expression:"(isMore === '' || isMore === 'article') && articleList.length > 0"}],staticClass:"article-list"},[s("div",{staticClass:"title flex"},[s("span",[s("SvgIcon",{attrs:{color:t.primaryColor,size:18,"icon-class":"icon-fabiaowenzhang"}}),s("span",{staticClass:"types"},[t._v(t._s(t.$t("community.article")))])],1),s("span",{directives:[{name:"show",rawName:"v-show",value:t.articleList.length<t.articleTotal,expression:"articleList.length < articleTotal"}],on:{click:function(e){return e.stopPropagation(),t.funMore("article")}}},[s("span",{staticClass:"more-btn"},[t._v(t._s(t.$t("community.more")))]),s("SvgIcon",{attrs:{color:"#7F849A",size:12,"icon-class":"icon-right"}})],1)]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.articleList.length,expression:"articleList.length"}],attrs:{"finished-text":t.$t("common.noMore"),finished:t.finished},on:{load:t.funLoadMore}},[t._l(t.articleList,(function(e){return s("div",{key:e.id,on:{click:function(s){return s.stopPropagation(),t.hanldeArticleDetail(e)}}},[s("articleItem",{attrs:{detail:e}})],1)})),s("van-list",{directives:[{name:"show",rawName:"v-show",value:t.articleList.length,expression:"articleList.length"}],attrs:{"finished-text":t.$t("common.noMore"),finished:t.finished},on:{load:t.funLoadMore},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.articleList,(function(e){return s("div",{key:e.id,on:{click:function(s){return s.stopPropagation(),t.hanldeArticleDetail(e)}}},[s("articleItem",{attrs:{detail:e}})],1)})),0)],2)]),0===t.articleTotal&&0===t.questionTotal?s("noData",{attrs:{"tip-text":t.$t("common.noDataTextTip")}}):t._e()],1)])}),[],!1,null,"3b99ae04",null).exports},61771:(t,e,s)=>{s.r(e),s.d(e,{default:()=>h});s(20581);var a=s(50914),i=s(49213),o=s(75230),r=(s(47601),s(44951)),n=(s(57658),s(13365)),c=s(22648),l={components:{[r.Z.name]:r.Z},props:{dataItem:{type:Object,default:()=>{}}},data:()=>({avatar:n,tips:"",origin:"",link:""}),mounted(){this.formateContent()},methods:{changeTimeAgoLabel(t){return t?(0,c.TC)(t,this):""},formateContent(){let{dataItem:t}=this;const{type:e,refId:s}=t;let a="",i=t.refContent||"",o=`/community/article-detail?articleId=${s}`;switch(e){case"comment-replied":a=this.$t("community.replyMe");break;case"article-commented":a=this.$t("community.commentMe");break;case"article-stared":a=this.$t("community.staredArticle");break;case"answer-stared":a=this.$t("community.staredAnswer"),i=this.handelOrigin(i),o=`/community/question-detail?questionId=${s}`;break;case"question-answered":a=this.$t("community.answerYou"),o=`/community/question-detail?questionId=${s}`;break;default:a=this.$t("community.inviteYou"),o=`/community/question-detail?questionId=${s}`}this.tips=a,this.origin=i,this.link=o},handelOrigin(t){const{type:e,content:s}=JSON.parse(t);return"pc"===e?s:s.content},handleDetail(){this.$router.push({path:this.link})}}},u=s(1001),d={components:{newsItem:(0,u.Z)(l,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"news-item",on:{click:function(e){return e.stopPropagation(),t.handleDetail.apply(null,arguments)}}},[s("div",{staticClass:"header flex"},[s("span",[s("van-image",{attrs:{width:"18",height:"18",round:"",fit:"cover",src:t.dataItem.origin?t.dataItem.origin.avatar:t.avatar}}),s("span",{staticClass:"names"},[t._v(t._s(t.dataItem.origin?t.dataItem.origin.name:""))])],1)]),s("div",{staticClass:"news-title"},[t._v(t._s(t.tips))]),s("div",{staticClass:"news-content"},[t._v(" "+t._s(t.origin)+" ")]),s("div",{staticClass:"time-answerCount flex"},[s("span",[t._v(t._s(t.changeTimeAgoLabel(t.dataItem.time)))])])])}),[],!1,null,"765a49de",null).exports,[a.Z.name]:a.Z,noData:o.Z},data:()=>({showNoData:!1,params:{page:0,size:10},list:[],loading:!1,finished:!1}),mounted(){this.funGetList(),this.setDoneRead()},methods:{async funGetList(){let{data:t}=await i.Z.getMessageList(this.params);this.loading=!1,this.list=0===this.params.page?t.data.content:this.list.concat(t.data.content),this.finished=this.list.length===t.data.totalElements,this.showNoData=0===this.list.length},funLoadMore(){this.params.page+=1,this.funGetList()},async setDoneRead(){const{userId:t}=this.$store.state.commonParams,{data:e}=await i.Z.setDoneRead(t);e.code}}},h=(0,u.Z)(d,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"news-list"},[t.list.length?s("van-list",{attrs:{"finished-text":t.$t("common.noMore"),finished:t.finished},on:{load:t.funLoadMore},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(t){return s("div",{key:t.id},[s("newsItem",{attrs:{"data-item":t}})],1)})),0):t._e(),t.showNoData?s("noData",{attrs:{"tip-text":t.$t("community.noData")}}):t._e()],1)}),[],!1,null,"2b3ae2bd",null).exports},77434:(t,e,s)=>{s.r(e),s.d(e,{default:()=>D});s(31146);var a=s(41610),i=(s(34837),s(39146)),o=s(95082),r=(s(20581),s(50914)),n=(s(31960),s(10993)),c=(s(47601),s(44951)),l=(s(23307),s(81392)),u=(s(57658),s(13365)),d=(s(21790),s(24031)),h=s(49213),p=s(78551),m=s(22648),g=s(26294),v=s(39819),f=s(22126),y=s(72525),_={components:{SvgIcon:p.Z,[c.Z.name]:c.Z,Tag:d.Z,Preview:v.Z,DescList:f.Z},props:{commentObj:{type:Object,default:()=>{}},index:{type:Number,default:0}},data(){return{avatar:u,commentList:[],userId:this.$store.state.commonParams.userId,params:{page:0,size:10},questionId:""}},computed:(0,o.Z)((0,o.Z)({},(0,g.mapGetters)({primaryColor:"getPrimaryColor",access_token:"getToken"})),{},{primaryColor(){return this.$store.state.themeColor.primaryColor},content(){return this.commentObj.content?JSON.parse(this.commentObj.content).content:{}},isMobile(){const{type:t}=this.commentObj.content?JSON.parse(this.commentObj.content):{};return"mobile"===t},handelOrigin(){return(0,y.G)(JSON.parse(this.commentObj.content))},getMobileImgs(){const{type:t,content:e}=JSON.parse(this.commentObj.content);return"mobile"===t?e.imgs:[]}}),mounted(){const{questionId:t,id:e}=this.$route.query;this.questionId=t||e},methods:{changeTimeAgoLabel(t){return t?(0,m.TC)(t,this):""},async handleStart(){if(this.commentObj.stared){const{data:t}=await h.Z.postUnStarCount({questionId:this.questionId,answerId:this.commentObj.id});0===t.code?this.$emit("change"):(0,i.Z)(this.$t("community.isError"))}else{const{data:t}=await await h.Z.postStarCount({questionId:this.questionId,answerId:this.commentObj.id});0===t.code?this.$emit("change"):(0,i.Z)(this.$t("community.isError"))}},deleteAnswer(){a.Z.confirm({message:this.$t("community.confirmDelAnswer"),confirmButtonText:this.$t("community.confirm"),cancelButtonText:this.$t("common.cancel"),confirmButtonColor:this.primaryColor}).then((()=>{this.funDelAnswer()})).catch((()=>{}))},async funDelAnswer(){let{data:t}=await h.Z.deleteAnswer({questionId:this.questionId,answerId:this.commentObj.id});0===t.code&&this.$emit("change")}}},C=s(1001),I=(0,C.Z)(_,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"comment-wrap"},[s("div",{staticClass:"author flex"},[s("span",[s("van-image",{staticStyle:{"margin-right":"8px"},attrs:{src:t.commentObj.author.avatar||t.avatar,width:"18",height:"18",round:"",fit:"cover"}}),s("span",[t._v(t._s(t.commentObj.author.name))])],1),s("span",{directives:[{name:"show",rawName:"v-show",value:1===t.commentObj.isTop,expression:"commentObj.isTop === 1"}],staticClass:"toTop-btn"},[1===t.commentObj.isTop?s("Tag",{attrs:{"text-color":"#1890FF",color:"#91D5FF",plain:""}},[t._v(t._s(t.$t("community.isTop")))]):t._e()],1),s("span",{directives:[{name:"show",rawName:"v-show",value:t.commentObj.author.id===t.userId,expression:"commentObj.author.id === userId"}],staticClass:"delete-btn",on:{click:function(e){return e.stopPropagation(),t.deleteAnswer.apply(null,arguments)}}},[t._v(t._s(t.$t("micro.delete")))])]),s("div",{staticClass:"content-comment"},[t.isMobile?s("div",[s("DescList",{attrs:{list:t.handelOrigin}}),s("div",{staticClass:"img-list"},t._l(t.getMobileImgs,(function(t,e){return s("van-image",{key:e,staticClass:"img",attrs:{src:t,width:"32%",height:"100",fit:"cover",radius:"5"}})})),1)],1):s("Preview",{attrs:{data:t.content}})],1),s("div",{staticClass:"time-answerCount flex"},[s("span",[t._v(t._s(t.changeTimeAgoLabel(t.commentObj.lastDate)))]),s("span",{on:{click:function(e){return e.stopPropagation(),t.handleStart.apply(null,arguments)}}},[s("SvgIcon",{staticStyle:{"margin-right":"5px"},attrs:{color:t.commentObj.stared?t.primaryColor:"#c0c2cb",size:14,"icon-class":"icon-zan2"}}),t._v(t._s(t.commentObj.stars||0))],1)])])}),[],!1,null,"4e3a9029",null).exports,b=s(75230),w=s(29588),$=s(57969),k=s(27632),S=s(75748),T=s(55602),Z=s(28787),x=s(24357),P={name:"TopicTag",components:{comment:I,noData:b.Z,topicItem:S.Z,SvgIcon:p.Z,Icon:l.Z,[c.Z.name]:c.Z,[n.Z.Component.name]:n.Z.Component,[r.Z.name]:r.Z,Preview:v.Z,DescList:f.Z,ClWaterMark:x.Z},props:{topicName:{type:String,default:""}},data(){return{userId:this.$store.state.commonParams.userId,avatar:u,detail:{author:{}},questionId:"",params:{page:0,size:10},answerList:[],loading:!1,finished:!1,content:{}}},computed:(0,o.Z)((0,o.Z)({},(0,g.mapGetters)({primaryColor:"getPrimaryColor",access_token:"getToken"})),{},{primaryColor(){return this.$store.state.themeColor.primaryColor},isApp:()=>"app"===k.Z.env,isMobile(){const{type:t}=this.detail.content?JSON.parse(this.detail.content):{};return"mobile"===t},handelOrigin(){return(0,y.G)(JSON.parse(this.detail.content))},getMobileImgs(){const{type:t,content:e}=JSON.parse(this.detail.content);return"mobile"===t?e.imgs:[]}}),mounted(){this.questionId=this.$route.query.id||this.$route.query.questionId,Array.isArray(this.$route.query.id)&&(this.questionId=this.$route.query.id[0]),this.getQuestionDetail(),"wechat"!==k.Z.env&&"dingTalk"!==k.Z.env&&"wechat_h5"!==k.Z.env||(0,T.vD)({shareInfo:{title:this.detail.title,desc:this.detail.title,path:"dingTalk"===k.Z.env?`/pages/messageRedirect/messageRedirect?flag=groupQa&id=${this.questionId}`:`/pages/login/login?flag=groupQa&enterpriseId=${this.$store.state.commonParams.enterpriseId}&id=${this.questionId}&shareType=wxGroupShare`}})},methods:{changeTimeAgoLabel(t){return t?(0,m.TC)(t,this):""},async getQuestionDetail(){let{data:t}=await h.Z.getQuestionDetail(this.questionId);const{code:e}=t;0===e?(this.detail=t.data,this.content=JSON.parse(t.data.content).content,this.handleGetComment()):w.Z[e]&&w.Z[e].showErrorMessage&&i.Z.fail(w.Z[e].content[$.Z.locale])},async handleGetComment(){this.loading=!0;let{data:t}=await h.Z.getQuestionAnswer(this.questionId,this.params);if(0===t.code&&t.data){const{totalElements:e,content:s}=t.data;this.loading=!1,this.answerList=s,this.finished=this.answerList.length===e}},handleGetCommentLoad(){this.params.size+=10,this.handleGetComment()},handleInvited(){this.$router.push({path:`/community/invite?problemId=${this.questionId}`})},handleToAnswer(){this.$router.push({path:`/community/to-answer?problemId=${this.questionId}`})},handleDelete(){a.Z.confirm({message:this.$t("community.confirmDelQuestion"),confirmButtonText:this.$t("community.confirm"),cancelButtonText:this.$t("common.cancel"),confirmButtonColor:this.primaryColor}).then((()=>{this.funDelQuestion()})).catch((()=>{}))},async funDelQuestion(){let{data:t}=await h.Z.deleteQuestion(this.questionId);0===t.code&&((0,i.Z)(this.$t("community.deleteSuccessTips")),history.go(-1))},aboutTopicList(t){this.$router.push({path:`/community/about-topic-list?topic=${t}`})},handleShare(){if("wechat"!==k.Z.env&&"dingTalk"!==k.Z.env){const{accessToken:t}=Z.Z.state.commonParams;(0,T.vD)({shareInfo:{title:this.detail.title,desc:this.detail.title,path:`${VUE_H5}#/community/question-detail?msgSource=emailMessage&flag=groupQa&id=${this.questionId}&access_token=${t}`}})}},getImg(t){"dingTalk"!==k.Z.env?(0,n.Z)({images:this.getMobileImgs,showIndex:!0,loop:!1,startPosition:t,closeable:!0}):k.Z.previewImage({urls:this.getMobileImgs,current:t})}}},D=(0,C.Z)(P,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"question-detail-wrap"},[s("div",{staticClass:"contet-wrap"},[s("div",{staticClass:"detail-wrap"},[s("div",{staticClass:"author flex"},[s("span",[s("van-image",{staticStyle:{"margin-right":"8px"},attrs:{src:t.detail.author&&t.detail.author.avatar||t.avatar,width:"18",height:"18",round:"",fit:"cover"}}),s("span",[t._v(t._s(t.detail.author?t.detail.author.name:""))])],1),s("span",{directives:[{name:"show",rawName:"v-show",value:t.detail.author.id===t.userId,expression:"detail.author.id === userId"}],on:{click:function(e){return e.stopPropagation(),t.handleDelete.apply(null,arguments)}}},[t._v(t._s(t.$t("micro.delete")))]),s("Icon",{directives:[{name:"show",rawName:"v-show",value:t.isApp,expression:"isApp"}],staticClass:"share_icon",attrs:{size:"24px",name:"share-o"},on:{click:t.handleShare}})],1),s("div",{staticClass:"title"},[t._v(t._s(t.detail.title))]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.detail.topic&&t.detail.topic.length,expression:"detail.topic && detail.topic.length"}]},t._l(t.detail.topic,(function(e,a){return s("topicItem",{key:a,attrs:{"topic-name":e,"no-close":!0},on:{clickDetail:t.aboutTopicList}})})),1),s("div",{staticClass:"explain"},[t.isMobile?s("div",[s("DescList",{attrs:{list:t.handelOrigin}}),s("div",{staticClass:"img-list"},t._l(t.getMobileImgs,(function(e,a){return s("van-image",{key:a,staticStyle:{"margin-bottom":"8px"},attrs:{src:e,width:"48%",height:"160",fit:"contain",radius:"5"},on:{click:function(e){return t.getImg(a)}}})})),1)],1):s("Preview",{attrs:{data:t.content}})],1),s("div",{staticClass:"time-answerCount flex"},[s("span",[t._v(t._s(t.changeTimeAgoLabel(t.detail.lastDate)))]),s("span",[s("SvgIcon",{staticStyle:{"margin-right":"5px"},attrs:{color:"#c0c2cb",size:14,"icon-class":"icon-huidashu"}}),t._v(t._s(t.detail.answerCount||0))],1)])]),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.answerList.length,expression:"!answerList.length"}]},[s("noData",{attrs:{"tip-text":t.$t("community.noAnswer")}})],1),s("van-list",{directives:[{name:"show",rawName:"v-show",value:t.answerList.length,expression:"answerList.length"}],attrs:{finished:t.finished,"finished-text":t.$t("community.isBottom")},on:{load:t.handleGetCommentLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.answerList,(function(e,a){return s("comment",{key:a,attrs:{"comment-obj":e,index:a},on:{change:t.getQuestionDetail}})})),1)],1),s("div",{staticClass:"bottom-btn-wrap flex-around"},[s("span",{staticClass:"cancel",style:{color:t.primaryColor,"border-color":t.primaryColor},on:{click:function(e){return e.stopPropagation(),t.handleInvited.apply(null,arguments)}}},[t._v(t._s(t.$t("community.invitedAnswer")))]),s("span",{staticClass:"publish",style:{backgroundColor:t.primaryColor,"border-color":t.primaryColor},on:{click:function(e){return e.stopPropagation(),t.handleToAnswer.apply(null,arguments)}}},[t._v(t._s(t.$t("community.toAnswer")))])]),s("cl-water-mark",{attrs:{scenes:"community"}})],1)}),[],!1,null,"04a6e3c8",null).exports},5203:(t,e,s)=>{s.r(e),s.d(e,{default:()=>n});s(34837);var a=s(39146),i=(s(57658),s(76953)),o=s(49213),r={components:{ClChooseUser:i.Z},data(){return{pickedUsers:[],problemId:"",config:{multiple:!0,limitTips:this.$t("community.limitTips"),pickedUsers:[],pickedDepartments:[],disabledUsers:[],disabledDepartments:[],requiredUsers:[],requiredDepartments:[],responseUserOnly:!1,startWithDepartmentId:"",asyncLoad:!0,filterAuth:!1}}},mounted(){this.problemId=this.$route.query.problemId},methods:{async handeOk(t){this.config.multiple?(this.config.pickedUsers=t.users||[],this.config.pickedDepartments=t.departments||[]):this.config.pickedUsers.push(t.users);let e=[],s=[];this.config.pickedDepartments.forEach((t=>{e.push(t.id)})),this.config.pickedUsers.forEach((t=>{s.push(t.id)}));let{data:i}=await o.Z.inviteToAnswer({departIds:e,problemId:this.problemId,userIds:s});0!==i.code?(0,a.Z)(this.$t("community.isError")):history.go(-1)},handleCancel(){history.go(-1)}}},n=(0,s(1001).Z)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"sel-user"},[s("ClChooseUser",{attrs:{config:t.config},on:{onSuccess:t.handeOk,cancel:t.handleCancel}})],1)}),[],!1,null,"27857a19",null).exports},13439:(t,e,s)=>{s.r(e),s.d(e,{default:()=>p});s(34837);var a=s(39146),i=s(95082),o=(s(93787),s(20090)),r=(s(57658),s(38862),s(74916),s(15306),s(49213)),n=s(26294),c=s(56709),l=s(94386),u=s(23279),d=s.n(u),h={components:{[o.Z.name]:o.Z,imgList:c.Z,ClUpload:l.Z},data:()=>({answerForm:{problemId:"",content:"",imgs:[]},commitLoading:!1}),computed:(0,i.Z)((0,i.Z)({},(0,n.mapGetters)({access_token:"getToken"})),{},{primaryColor(){return this.$store.state.themeColor.primaryColor},submitStyle(){return this.commitLoading?{backgroundColor:"#b7bac8",borderColor:"#b7bac8",color:"#999"}:{color:this.answerForm.content?"#fff":this.primaryColor,"border-color":this.primaryColor,background:this.answerForm.content?this.primaryColor:"#fff"}}}),mounted(){this.problemId=this.$route.query.problemId},methods:{onSuccess(t){t.forEach((t=>{this.answerForm.imgs.push(t.url)}))},handleDeleteImg(t){this.answerForm.imgs.splice(t,1)},handleAnswer(){this.answerForm.content?(this.commitLoading=!0,this.toAnswer()):(0,a.Z)(this.$t("community.inputAnswer"))},toAnswer:d()((async function(){const{userId:t}=this.$store.state.commonParams,e={userId:t,content:JSON.stringify({type:"mobile",content:{content:this.answerForm.content.replace(/\n/g,"<br/>"),imgs:this.answerForm.imgs},d:t})};let{data:s}=await r.Z.toAnswer(this.problemId,e);if(0===s.code)return history.go(-1),void(this.commitLoading=!1);this.commitLoading=!1,(0,a.Z)(this.$t("community.isError"))}),300)}},p=(0,s(1001).Z)(h,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"to-answer"},[s("div",{staticClass:"form-item"},[s("van-field",{attrs:{type:"textarea",rows:"4",maxlength:"5000","show-word-limit":"",clearable:"",placeholder:t.$t("community.placeholderInput")},model:{value:t.answerForm.content,callback:function(e){t.$set(t.answerForm,"content","string"==typeof e?e.trim():e)},expression:"answerForm.content"}})],1),s("div",{staticClass:"form-item"},[s("cl-upload",{on:{onSuccess:t.onSuccess}}),s("div",{directives:[{name:"show",rawName:"v-show",value:t.answerForm.imgs.length,expression:"answerForm.imgs.length"}],staticStyle:{"padding-top":"15px"}},[s("imgList",{attrs:{"img-list":t.answerForm.imgs},on:{delete:t.handleDeleteImg}})],1)],1),s("div",{staticClass:"bottom-btn-wrap"},[s("span",{staticClass:"submit",style:t.submitStyle,attrs:{disabled:t.commitLoading},on:{click:function(e){return e.stopPropagation(),t.handleAnswer.apply(null,arguments)}}},[t._v(t._s(t.$t("community.submitAnswer")))])])])}),[],!1,null,"83f78e66",null).exports},828:(t,e,s)=>{s.r(e),s.d(e,{default:()=>h});s(34837);var a=s(39146),i=(s(93787),s(20090)),o=(s(45172),s(76475)),r=(s(31930),s(94907)),n=(s(48444),s(84014)),c=(s(30033),s(87837)),l=(s(33948),s(78551)),u=s(49213),d={name:"Topic",components:{Search:s(28514).Z,SvgIcon:l.Z,[c.Z.name]:c.Z,[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z},props:{maxNum:{type:Number,default:5},selectTopicList:{type:Array,default:()=>[]}},data:()=>({loading:!1,showAction:!1,searchResultList:[],topicList:[],selTopicList:[],topicName:"",createVisiable:!1}),computed:{primaryColor(){return this.$store.state.themeColor.primaryColor}},mounted(){this.funGetTopicList(),this.selTopicList=this.selectTopicList},methods:{async funGetTopicList(){this.loading=!0;const{data:t}=await u.Z.getTopicList();0===t.code&&t.data&&(this.loading=!1,this.topicList=t.data)},handleChangeSel(t){0!==this.maxNum&&t.length>this.maxNum&&this.selTopicList.splice(0,1)},async searchTopicList(t){if(""===t)return;let{data:e}=await u.Z.searchTopicList(t);0===e.code&&e.data&&(this.searchResultList=e.data)},handleCreate(){5!==this.selTopicList.length?(this.topicName="",this.createVisiable=!0):(0,a.Z)(this.$t("community.fiveTopicLimit"))},async handleCheckTopicDisabled(){if(!this.topicName)return void(0,a.Z)(this.$t("community.createTopicLabelTips"));let{data:t}=await u.Z.checkTopicDisabled({tagName:this.topicName});if(0===t.code){if(t.data)return void(0,a.Z)(this.$t("community.disabledTopicTips"));this.createVisiable=!1,this.$emit("select",[this.topicName,...this.selTopicList])}else(0,a.Z)(this.$t("community.createErr"))},handleOk(){this.selTopicList.length&&this.$emit("select",this.selTopicList)}}},h=(0,s(1001).Z)(d,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"topic-wrap"},[s("div",{staticClass:"top-search"},[s("Search",{attrs:{placeholder:t.$t("community.searchTopic")},on:{search:t.searchTopicList}})],1),s("div",{staticClass:"create-topic-btn",on:{click:function(e){return e.stopPropagation(),t.handleCreate.apply(null,arguments)}}},[s("SvgIcon",{attrs:{color:"#2d3040",size:36,"icon-class":"icon-tianjia1"}}),s("span",{staticClass:"labels"},[t._v(t._s(t.$t("community.createTopic")))])],1),s("div",{directives:[{name:"show",rawName:"v-show",value:t.searchResultList.length,expression:"searchResultList.length"}],staticClass:"sel-result topic-list"},[s("div",[s("van-checkbox-group",{on:{change:t.handleChangeSel},model:{value:t.selTopicList,callback:function(e){t.selTopicList=e},expression:"selTopicList"}},t._l(t.searchResultList,(function(e,a){return s("div",{key:a,staticClass:"topic-item"},[s("van-checkbox",{attrs:{name:e,shape:"square","checked-color":t.primaryColor,"icon-size":"16px"}},[t._v(t._s(e))])],1)})),0)],1)]),s("div",{staticClass:"topic-list"},[s("div",{staticClass:"labels"},[t._v(t._s(t.$t("community.hotTopic"))+"：")]),s("div",[s("van-skeleton",{staticStyle:{"padding-top":"10px"},attrs:{loading:t.loading,row:"3"}},[s("van-checkbox-group",{on:{change:t.handleChangeSel},model:{value:t.selTopicList,callback:function(e){t.selTopicList=e},expression:"selTopicList"}},t._l(t.topicList,(function(e,a){return s("div",{key:a,staticClass:"topic-item"},[s("van-checkbox",{attrs:{name:e,shape:"square","checked-color":t.primaryColor,"icon-size":"16px"}},[t._v(t._s(e))])],1)})),0)],1)],1)]),s("div",{staticClass:"bottom-btn"},[s("div",{staticClass:"en-sure",style:{color:0!==t.selTopicList.length?"#fff":t.primaryColor,"background-color":0!==t.selTopicList.length?t.primaryColor:"#fff","border-color":t.primaryColor},on:{click:function(e){return e.stopPropagation(),t.handleOk.apply(null,arguments)}}},[t._v(t._s(t.$t("community.confirm"))+" "+t._s(t.selTopicList.length)+"/"+t._s(t.maxNum))])]),s("van-overlay",{attrs:{show:t.createVisiable,"z-index":"999","class-name":"mask"},on:{click:function(e){t.createVisiable=!1}}},[s("div",{staticClass:"dialog-wrap",on:{click:function(t){t.stopPropagation()}}},[s("div",{staticClass:"content"},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("community.createTopic")))]),s("div",{staticClass:"tip"},[t._v(t._s(t.$t("community.createTopicLabel")))]),s("van-field",{attrs:{maxlength:"50",clearable:"",placeholder:t.$t("community.placeholderInput")},model:{value:t.topicName,callback:function(e){t.topicName="string"==typeof e?e.trim():e},expression:"topicName"}})],1),s("div",{staticClass:"btns"},[s("span",{staticClass:"cancel",on:{click:function(e){e.stopPropagation(),t.createVisiable=!1}}},[t._v(t._s(t.$t("common.cancel")))]),s("span",{staticClass:"create",style:{color:t.primaryColor},on:{click:function(e){return e.stopPropagation(),t.handleCheckTopicDisabled.apply(null,arguments)}}},[t._v(t._s(t.$t("community.create")))])])])])],1)}),[],!1,null,"7c4dd3ca",null).exports},35109:(t,e,s)=>{s.r(e),s.d(e,{default:()=>d});s(20581);var a=s(50914),i=(s(73210),s(94864)),o=s(4852),r=s(81533),n=s(22648),c=s(27479),l=s(45877),u={name:"StudyList",components:{EmptyBox:c.Z,Avatar:o.Z,commentTextarea:r.Z,ClCustomUser:l.Z,[a.Z.name]:a.Z},data:function(){return{courseId:"",dataList:[],scrollHeight:0,loading:!1,hasNextPage:!1,pageSize:10,pageNumber:1,showLoading:!0,courseResource:"",isInputTextarea:!1,hasTriggerOnHide:!1,operateStatus:"",showOperateTip:!1,errTip:""}},computed:{themeColor(){return this.$store.state.themeColor.primaryColor}},mounted(){const{courseId:t,courseResource:e}=this.$route.query;this.courseId=t,this.courseResource=e,this.loadData()},methods:{loadData(){this.loadStudyData()},loadStudyData(){this.loading=!0;const{courseId:t,courseResource:e,pageSize:s,pageNumber:a}=this,o={page_size:s,page_number:a};this.$toast.loading({message:this.$t("minePoints.isLoading")}),i.Z.loadComments(e,t,o).then((t=>{this.$toast.clear(),t.data.list.forEach((t=>{t.timeAgoLabel=(0,n.TC)(t.create_time,this)})),this.dataList=this.dataList.concat(t.data.list),this.finished="false"===t.data.has_next_page,this.loading=!1,this.pageNumber+=1}))},onLoad(){this.loadStudyData()},showTextarea(t){t.disabled=!0,this.isInputTextarea=!0},async editValueCbk(t,e){this.isInputTextarea=!1;const{courseResource:s,courseId:a}=this;if(t){if(0===e.trim().length)return void this.$toast.fail(this.$t("promptMessage.emptyComments"));await i.Z.commitComment(s,a,e),this.dataList=[],this.pageNumber=1,this.showOperateTip=!0,this.loadData()}}}},d=(0,s(1001).Z)(u,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"commentList_container cl-page-container"},[t.dataList.length<=0?s("EmptyBox"):[s("van-list",{attrs:{finished:t.finished,"finished-text":t.$t("mine.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.dataList,(function(e){return s("div",{key:e.id,staticClass:"info"},[s("Avatar",{staticClass:"avatar",attrs:{width:"32",height:"32",src:e.avatar}}),s("div",[s("div",{staticClass:"comment_top"},[s("span",{staticClass:"name"},[s("cl-custom-user",{attrs:{"data-type":"userName",value:e.sync_user_id,name:e.name,type:e.sync_source_type}})],1),s("span",{staticClass:"times"},[t._v(t._s(e.timeAgoLabel))])]),s("div",{staticClass:"content"},[t._v(t._s(e.comment))])])],1)})),0)],s("div",{staticClass:"comment_area"},[t.isInputTextarea?s("comment-textarea",{attrs:{value:"",placeholder:"",char:"","max-length":2e3},on:{onUpdate:t.editValueCbk}}):t._e(),s("div",{staticClass:"typing",on:{click:t.showTextarea}},[s("SvgIcon",{attrs:{"icon-class":"icon-morecopy",color:"#7F849A"}}),s("input",{staticClass:"bottom-input",attrs:{placeholder:t.$t("micro.comment")+"...",disabled:""}})],1)],1)],2)}),[],!1,null,"791fbd80",null).exports},99803:(t,e,s)=>{s.d(e,{Z:()=>h});s(47601);var a=s(44951),i=(s(57658),s(22648)),o=s(78368),r=s(78551),n=s(81533),c=s(95969),l=s(45877),u=s(45879),d={name:"CourseComment",components:{VanImage:a.Z,SvgIcon:r.Z,commentTextarea:n.Z,ClCustomUser:l.Z,CommentForbiddenPlaceholder:u.Z},props:{commentInfo:{type:Object,default:()=>({})},courseId:{type:String,default:""},courseSource:{type:String,default:""},submitComment:{type:Function,default:()=>{}},commentSwitch:{type:Boolean,default:!0}},data:function(){return{defaultAvatar:o,showCommentModal:!1}},mounted(){},methods:{changeTimeAgoLabel:function(t){return t?(0,i.TC)(t,this):""},show(){this.showCommentModal=!this.showCommentModal},allComments(){this.$router.push(c.Z.course.allComment({courseId:this.courseId,courseResource:this.courseSource}))},editValueCbk(t,e){this.show(),t&&this.submitComment(e)}}},h=(0,s(1001).Z)(d,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"course-comment"},[s("div",{staticClass:"headline"},[s("span",[t._v(t._s(t.$t("course.latestComments")))]),t.commentInfo.total>0&&t.commentSwitch?s("div",{on:{click:t.allComments}},[t._v(t._s(t.$t("course.allComments"))+"("+t._s(t.commentInfo.total)+")")]):t._e()]),t.commentSwitch?t._e():s("div",[s("comment-forbidden-placeholder")],1),t.commentSwitch?s("div",{staticClass:"typing"},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-morecopy",size:14,color:"#7F849A"}}),s("span",{staticClass:"placeholderClass",on:{click:t.show}},[t._v(t._s(t.$t("course.comment"))+"...")])],1):t._e(),0===t.commentInfo.total&&t.commentSwitch?s("div",{staticClass:"no-comment"},[t._v(" "+t._s(t.$t("course.noComment"))+" ")]):[t.commentSwitch?s("div",t._l(t.commentInfo.list,(function(e,a){return s("div",{key:a,staticClass:"infos"},[s("van-image",{staticClass:"avatar",attrs:{fit:"aspectFill",src:e.avatar||t.defaultAvatar}}),s("div",[s("div",{staticClass:"commentTop"},[s("span",{staticClass:"name"},[s("cl-custom-user",{attrs:{type:e.syncSourceType,"data-type":"userName",value:e.syncUserId,name:e.name}})],1),s("span",{staticClass:"times"},[t._v(t._s(t.changeTimeAgoLabel(e.createTime))+" ")])]),s("div",{staticClass:"content"},[t._v(t._s(e.comment))])])],1)})),0):t._e()],t.showCommentModal?s("comment-textarea",{attrs:{value:"",placeholder:"",char:"","max-length":2e3},on:{onUpdate:t.editValueCbk}}):t._e()],2)}),[],!1,null,"4b46c0a6",null).exports},27098:(t,e,s)=>{s.d(e,{Z:()=>i});var a={name:"CourseEnd"},i=(0,s(1001).Z)(a,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"course-end"},[t._v(" END ")])}),[],!1,null,"1a4e9ae6",null).exports},12596:(t,e,s)=>{s.d(e,{Z:()=>i});var a={name:"CourseIntroduce",props:{introduction:{type:String,default:""},summary:{type:String,default:""},bizType:{type:Number,default:0}}},i=(0,s(1001).Z)(a,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"course-introduce"},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("course.detailDesc")))]),8===t.bizType?[t.introduction||t.summary?s("div",{staticClass:"text_play"},[s("p",[t._v(t._s(t.summary))]),t.introduction?s("img",{attrs:{src:t.introduction}}):t._e()]):s("div",{staticClass:"introduce-tip"},[t._v(t._s(t.$t("course.emptyDetail")))])]:[t.introduction?s("div",{staticClass:"text_play",domProps:{innerHTML:t.xss(t._s(t.introduction))}}):s("div",{staticClass:"introduce-tip"},[t._v(t._s(t.$t("course.emptyDetail")))])]],2)}),[],!1,null,"8659520e",null).exports},67185:(t,e,s)=>{s.d(e,{Z:()=>I});var a=s(95082),i=(s(47601),s(44951)),o=(s(23307),s(81392)),r=(s(25773),s(35791)),n=s(25934),c=s(26294),l=s(27632),u=s(89811),d={name:"FaceCompareDialog",props:{hasSetFace:{type:String,default:"false"},requestParam:{type:Object,default:()=>{}}},data:()=>({imageSrc:""}),methods:{chooseImage(){this.$emit("pause");l.Z.chooseImage({count:1,sourceType:["camera"],compressed:!0,percent:80},(t=>{this.uploadImg(t.filePaths[0])}))},uploadImg(t){let e={access_token:this.$store.state.commonParams.accessToken};this.$toast.loading({duration:0,forbidClick:!0,message:this.$t("faceCompare.uploading")}),l.Z.uploadFile({url:`${CL_API}/customize-api/v3/upload/face`,fileName:"file",fileType:"image",formData:e,filePath:t},(({data:t})=>{const{server:e,fileNewName:s,fileThumbName:a}=t.data,i=`${e}${s}`;this.imgThumbSrc=`${e}${a}`,this.imageSrc=i,this.doFaceCompare(i)}),(()=>{this.$toast.clear()}))},doFaceCompare(t){"true"===this.hasSetFace?this.faceCompare(t):(this.checkFace(t),this.faceSave(t))},checkFace(t){u.Z.checkFace({image_url:t}).then((t=>{this.$toast.clear(),"true"===t.data.result&&this.saveFacePicture()}))},faceSave(t){u.Z.faceSave({image_url:t}).then((t=>{this.$toast.clear(),"true"===t.data.result&&this.$toast(this.$t("faceCompare.checkFaceSuc"))}))},faceCompare(t){u.Z.faceCompare({image_url:t}).then((t=>{this.$toast.clear(),"true"===t.data.result?(this.$toast(this.$t("faceCompare.comparePassTip")),this.saveFacePicture()):this.$toast(this.$t("faceCompare.compareFailTip"))})).catch((()=>{this.$toast(this.$t("faceCompare.compareFailTip"))}))},saveFacePicture(){const t=Object.assign(this.requestParam,{face_recognition_picture:this.imgThumbSrc,sign_date:(new Date).getTime(),sign_result:"true"});u.Z.saveFacePicture(t).then((t=>{2e5===t.data.code?(this.$emit("hide"),this.$emit("play")):this.$toast(this.$t("faceCompare.saveFacePictureTip"))})).catch((()=>{this.$toast(this.$t("faceCompare.saveFacePictureTip"))}))}}},h=s(1001),p=(0,h.Z)(d,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"dialog-form"},[s("div",{staticClass:"dialog-form-item"},[t._v(t._s("true"===t.hasSetFace?t.$t("faceCompare.taskFaceKnowTip"):t.$t("faceCompare.taskFaceKnowTip2")))])])}),[],!1,null,"2e6b367c",null).exports,m=s(96838),g=s(94864),v=s(14790),f=s(22648),y=s(11651),_=s(68092),C={name:"CoursePlayer",components:{[r.Z.name]:r.Z,[o.Z.name]:o.Z,VanImage:i.Z,PrivateFaceCompare:p},props:{enterType:{type:String,default:""},isPaused:{type:Boolean,default:!1},playingVideo:{type:Object,default:()=>({id:"",recentStart:0,duration:0,auditionLength:0,auditionType:-1,url:"",contentType:"video",isMediaNext:!1})},timerInterval:{type:Number,default:2e4},courseInfo:{type:Object,default:()=>{}},draggable:{type:Boolean,default:!0},preventHangFlag:{type:Boolean,default:!1},showRandomWindow:{type:Boolean,default:!1},controls:{type:Boolean,default:!0},loop:{type:Boolean,default:!1},autoplay:{type:Boolean,default:!1},cover:{type:String,default:""},isPlayingVideo:{type:Boolean,default:!1},isFixed:{type:Boolean,default:!0},height:{type:Number,default:211},isShare:{type:Boolean,default:!1}},data:()=>({playerUrl:"",preventHangFlagConfig:{oneTime:0,popupWindowCount:0},player:null,playerCurrentTime:0,canAutoSeek:!1,currentTime:0,isShowFaceCompare:!1,firstFaceRecognition:!0,isFullScreen:!1,isReady:!1}),computed:(0,a.Z)((0,a.Z)({},(0,c.mapState)("setting",["speedPlaySwitch"])),{},{videoHeight(){return(0,y.W)(this.height)},requestParam(){return{course_id:this.playingVideo.courseId,plan_id:this.playingVideo.studyId,user_id:this.$store.state.commonParams.userId}},isSpeedPlay(){return this.playingVideo.speedPlaySwitch?"true"===this.playingVideo.speedPlaySwitch:this.speedPlaySwitch}}),watch:{"playingVideo.url":{handler(){this.initVideo()},deep:!0,immediate:!0}},beforeDestroy(){this.timer&&clearInterval(this.timer)},methods:(0,a.Z)((0,a.Z)({},(0,c.mapActions)("setting",["fetchWaterSetting"])),{},{async initVideo(){const{storageType:t,videoId:e,url:s,needVideoFaceRecognition:a,isCourse:i}=this.playingVideo;this.playerUrl="LOCAL"===t?await(0,v.m)(s,e):s,"true"===a&&i&&(this.firstFaceRecognition=!0),this.canAutoSeek=!0,this.$nextTick((()=>{this.$refs.video&&(this.player=this.getCommonVideoPlayer())}))},onVideoReady(){this.isReady=!0},onPlayerPlay(){const{timerInterval:t}=this,e=(0,_.UI)("MOBILE_PLAYER_1MIN_SAVE_PROGRESS")?6e4:t;this.$emit("onCSCECPlay"),this.$emit("onPlay"),e>0&&!this.timer&&(this.timer=setInterval((()=>{this.timerEvent()}),e))},onPlayerPause(){if(this.timer&&(clearInterval(this.timer),this.timer=null),this.isShowFaceCompare)return;let{duration:t}=this.playingVideo;const{currentTime:e}=this;if("number"==typeof e){t=Number(t);let s=e/t*100>98?Math.ceil(e/t*100):Math.round(e/t*100),a=(0,n.Z)();this.logEvent({currentTime:e,duration:t,progress:s,type:"pause"}),s=s>=100?100:s,s<100&&this.$emit("onPause",{currentTime:Math.ceil(e),progress:s,id:this.playingVideo.id,requestId:a})}},onPlayerEnded(){const{id:t}=this.playingVideo,{currentTime:e,playerCurrentTime:s}=this;this.timer&&(clearInterval(this.timer),this.timer=null),this.$emit("onEnded"),!this.draggable&&"ios"===(0,f.Os)()&&e-s>2||this.$emit("onTimerEvent",{currentTime:Math.ceil(e),progress:100,requestId:(0,n.Z)(),id:t})},onPlayerSeeking(){this.logEvent({currentTime:this.currentTime,duration:this.playingVideo.duration,progress:this.playingVideo.progress,type:"player-seeking"})},async onPlayerError(){const{storageType:t,videoId:e,url:s}=this.playingVideo,{currentTime:a}=this;if("LOCAL"===t){let t=s.indexOf("expire_time")>-1?s.split("&")[1].split("=")[1]:"";if(!t||Number(t)>(new Date).getTime())return void this.$toast.fail(this.$t("course.playTips"));this.playerUrl=await(0,v.m)(s,e)}else if("ALIBABA_PRIVATE"===t){if(!e)return;const{data:t}=await g.Z.privateVodDownloadUrl({videoId:e});0===t.code&&(this.playerUrl=t.data.videoPlayInfo)}this.logEvent({currentTime:this.currentTime,duration:this.playingVideo.duration,progress:this.playingVideo.progress,type:"player-error"}),a&&(this.getCommonVideoPlayer().currentTime(Number(a)),this.getCommonVideoPlayer().play())},timerEvent(){let{duration:t,id:e}=this.playingVideo,{currentTime:s}=this;if(s){s=Number(s),t=Number(t);let a=s/t*100>98?Math.ceil(s/t*100):Math.round(s/t*100),i=(0,n.Z)();this.$emit("onTimerEvent",{currentTime:Math.ceil(s),progress:a,id:e,requestId:i})}},logEvent({currentTime:t,duration:e,progress:s,type:a}){const i=(0,n.Z)();m.Z.logger({moduleName:"video-play",currentTime:t,duration:e,progress:s,type:a},i)},videoTimeUpdate(){if(!this.player)return;const{duration:t,progress:e}=this.playingVideo,s=this.getCommonVideoPlayer().currentTime();if(this.currentTime=s,this.$emit("onCurrentTimeUp",s),s>0&&this.canAutoSeek){this.canAutoSeek=!1;const s=e>=100?0:Math.ceil(e*t/100),a=()=>{s&&s>0&&(this.getCommonVideoPlayer().currentTime(s),this.playerCurrentTime=s),this.getCommonVideoPlayer().play()};(this.showRandomWindow||this.preventHangFlag)&&e<100?(this.getCommonVideoPlayer().pause(),this.playerShowPreventHang(),this.$dialog.confirm({title:this.$t("common.reminder"),showCancelButton:!1,confirmButtonText:this.$t("subsidy.gotIt"),className:this.isFullScreen?"cl-full-page":"",message:this.showRandomWindow?this.$t("component.preventAlertTip"):this.$t("component.pauseAlertTip")}).then((t=>{"confirm"===t&&(a(),this.$dialog.close())}))):a()}else this.onDraggableSetting(),this.onAuditionSetting(),this.preventHangFlagSwitch(),"on"===this.playingVideo.videoFaceRecognition&&s>.01*t&&"true"===this.playingVideo.needVideoFaceRecognition&&this.firstFaceRecognition&&(this.firstFaceRecognition=!1,this.isShowFaceCompare=!0,this.getCommonVideoPlayer().pause())},onDraggableSetting(){const{currentTime:t}=this,e="ios"===(0,f.Os)();if(!this.draggable&&e){if(t-this.playerCurrentTime>2)return void this.getCommonVideoPlayer().currentTime(this.playerCurrentTime);this.playerCurrentTime=t}},onAuditionSetting(){const{auditionLength:t,auditionType:e}=this.playingVideo;t>0&&2===e&&this.currentTime>t&&(this.getCommonVideoPlayer().pause(),this.getCommonVideoPlayer().currentTime(t),this.$toast(this.$t("course.haveALookOverTip")))},preventHangFlagSwitch(){let{duration:t}=this.playingVideo;const{currentTime:e}=this;let{popupWindowCount:s,oneTime:a}=this.preventHangFlagConfig;if((this.showRandomWindow||this.preventHangFlag)&&s>0){const i=t-a*s;s>0&&e>i&&(this.getCommonVideoPlayer().pause(),this.showRandomWindow&&this.setRandomWindow("popup_start"),this.$dialog.confirm({title:this.$t("common.reminder"),showCancelButton:!1,className:this.isFullScreen?"cl-full-page":"",message:this.showRandomWindow?this.$t("component.randomAlertTip"):this.$t("component.hangUpTriggerTip")}).then((()=>{this.showRandomWindow&&this.setRandomWindow("popup_end"),this.$dialog.close(),this.getCommonVideoPlayer().play()})),s-=1,this.preventHangFlagConfig.popupWindowCount=s)}},setRandomWindow(t){let e="popup_start"===t?(new Date).getTime():"";const{playingVideo:s,courseInfo:a,enterType:i}=this,o=s.id,r="project"===i?a.studyId:s.planId;g.Z.setRandomAlert(r,{terminal_type:"DING_MINA",popup_id:e,courseId:o,type:t})},playerShowPreventHang(){const{duration:t,recentStart:e}=this.playingVideo;let s=0,a={};t>0&&t<180?(s=t/2,a.oneTime=s,a.popupWindowCount=e>=s?0:1):t>=180&&t<600?(s=t/3,a.oneTime=s,a.popupWindowCount=e>=2*s?0:e>=s?1:2):(s=t/4,a.oneTime=s,a.popupWindowCount=e>=3*s?0:e>=2*s?1:e>=s?2:3),this.preventHangFlagConfig=a},onFullscreenChange(t){this.isFullScreen=t,this.$emit("onFullscreenChange",t)},onVideoInstance(){this.$emit("onVideoInstance")},onNextPlayCourseware(){this.$emit("onNextPlayCourseware")},seek(t){this.getCommonVideoPlayer().currentTime(t)},play(){this.isReady&&this.getCommonVideoPlayer().play()},pause(){this.isReady&&this.getCommonVideoPlayer().pause()},onBeforeClose:(t,e)=>"confirm"===t?e(!1):e(),doFaceCompareConfirm(){this.$refs.faceCompare.chooseImage()},doFaceCompareCancel(){this.firstFaceRecognition=!0,this.playingVideo.isCourse||history.go(-1)},getCommonVideoPlayer(){return this.$refs.video.getPlayer()}})},I=(0,h.Z)(C,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"player-cover",class:[t.isPlayingVideo&&t.isFixed?"fixed":""],style:{height:t.videoHeight}},[t.isPlayingVideo&&t.playerUrl?s("div",{staticClass:"course-player"},[s("cool-video",{ref:"video",attrs:{height:t.videoHeight,"player-id":"course-player",autoplay:t.autoplay,src:t.playerUrl,controls:t.controls,"content-type":t.playingVideo.contentType,"is-media-next":t.playingVideo.isMediaNext,"can-draggable":t.draggable,"show-water-mark":!0,"show-speed-button":t.isSpeedPlay,"show-fullscreen-btn":!0,"enable-progress-gesture":!0},on:{onPlayerEnded:t.onPlayerEnded,onPlay:t.onPlayerPlay,onPause:t.onPlayerPause,onClick:function(){},refreshProgress:t.videoTimeUpdate,onError:t.onPlayerError,onFullscreenChange:t.onFullscreenChange,seeking:t.onPlayerSeeking,onNextPlayCourseware:t.onNextPlayCourseware,ready:t.onVideoReady}}),s("van-dialog",{attrs:{"confirm-button-text":"true"===t.playingVideo.hasSetFace?t.$t("faceCompare.gotoKnow"):t.$t("faceCompare.gotoUpload"),title:t.$t("common.reminder"),"confirm-button-color":"#4b80d1","cancel-button-color":"#4b80d1","show-cancel-button":"","before-close":t.onBeforeClose},on:{confirm:t.doFaceCompareConfirm,cancel:t.doFaceCompareCancel},model:{value:t.isShowFaceCompare,callback:function(e){t.isShowFaceCompare=e},expression:"isShowFaceCompare"}},[s("PrivateFaceCompare",{ref:"faceCompare",attrs:{"has-set-face":t.playingVideo.hasSetFace,"request-param":t.requestParam},on:{play:t.play,pause:t.pause,hide:function(e){t.isShowFaceCompare=!1}}})],1)],1):s("div",{staticClass:"image-cover"},[s("van-image",{attrs:{fit:"fill",src:t.cover,height:"100%"}}),t.isShare?s("van-button",{staticClass:"share-btn",attrs:{icon:"share",round:"",size:"mini",color:"rgba(0, 0, 0, .46)"},on:{click:function(e){return t.$emit("onShowShare")}}},[t._v(t._s(t.$t("pkGame.share")))]):t._e()],1)])}),[],!1,null,"7827bf53",null).exports},80251:(t,e,s)=>{s.d(e,{Z:()=>l});s(84352);var a=s(4321),i=(s(26699),s(32023),s(74916),s(15306),s(27632)),o=s(72244),r=s(71522),n=s(94864),c={name:"CourseWareShare",components:{[a.Z.name]:a.Z},props:{isShow:{type:Boolean,default:!1},currentItem:{type:Object,default:()=>({})}},data:()=>({showSheet:!1}),watch:{isShow:{handler(){this.showSheet=this.isShow}}},methods:{async onSelect(){const{path:t,url:e,type:s,storageType:a,videoId:c,name:l,id:u}=this.currentItem,d=o.pe.includes(s),h=o.Wb.includes(s);let p;if("ALIBABA_PRIVATE"===a){if(d||h){const{data:t}=await r.Z.getPrivateImgUrl(c);0===t.code&&(p=t.data.docResourceDownloadUrl)}else if("mp4"===s){const{data:t}=await n.Z.privateVodDownloadUrl({videoId:c,params:{type:"source"}});0===t.code&&(p=t.data.videoPlayInfo)}}else if("html"===s||"scorm"===s)p=t;else if("mp4"===s){const{data:t}=await r.Z.getDownloadUrl(u);if("true"!==t.success)return this.$toast.fail(this.$t("course.fileNoDown"));p=t.data}else p=e;p?(p.indexOf("http://")>-1&&(p=p.replace("http://","https://")),i.Z.copy({text:p}),this.$toast.success(this.$t("course.copySucceed")),this.$emit("closeCourseWareShare"),await r.Z.addDownloadLog(l)):(this.$toast.fail(this.$t("course.fileNoDown")),this.$emit("closeCourseWareShare"))},onClose(){this.$emit("closeCourseWareShare")}}},l=(0,s(1001).Z)(c,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"course-ware-share-sheet",on:{click:function(t){return t.stopPropagation(),function(){}.apply(null,arguments)}}},[s("van-share-sheet",{staticClass:"download-share-sheet",attrs:{options:[{name:t.$t("course.copyLink"),icon:"link"}],"cancel-text":t.$t("common.cancel")},on:{select:t.onSelect,cancel:t.onClose,"click-overlay":t.onClose},scopedSlots:t._u([{key:"title",fn:function(){return[s("div",{staticClass:"download-share-title"},[t._v(" "+t._s(t.$t("course.downloadSharePiece1"))+" "),s("span",{staticClass:"key-point"},[t._v(t._s(t.$t("course.downloadSharePiece2")))]),t._v(" "+t._s(t.$t("course.downloadSharePiece3"))+" ")])]},proxy:!0}]),model:{value:t.showSheet,callback:function(e){t.showSheet=e},expression:"showSheet"}})],1)}),[],!1,null,"c68ef350",null).exports},19499:(t,e,s)=>{s.d(e,{Z:()=>l});s(47238);var a=s(75167),i=(s(26699),s(84533)),o=s(22648),r=s(78551),n=s(80251),c={name:"CourseWare",components:{SvgIcon:r.Z,CourseWareShare:n.Z,[a.Z.name]:a.Z},props:{resources:{type:Array,default:()=>[]},isFree:{type:String,default:""},showStatus:{type:String,default:""},currentPlay:{type:Number,default:-1},isOutCourse:{type:Boolean,default:!1},download:{type:Boolean,default:!1}},data:()=>({showDownload:!1,currentItem:{}}),computed:{getIconAndColor:()=>t=>{if("mp4"===t.type&&"mp3"!==t.originalType)return i.e.mp4;if("mp4"===t.type&&"mp3"===t.originalType)return i.e.mp3;if(["ppt","pptx","doc","docx","pdf","xls","xlsx","txt","article","link","h5","ddi","mp3"].includes(t.type))return i.e[t.type];return["html","picture","scorm"].includes(t.contentType)?i.e[t.contentType]:i.e.others},hasAnswered:()=>t=>t.answerRecordCount>0||!!(t.resourceQuizVo&&t.resourceQuizVo.questionCount>0&&t.resourceQuizVo.answerRecordCount===t.resourceQuizVo.questionCount),disallowPlay(){return"false"===this.isFree&&"buy"===this.showStatus},isShowImportant(){return t=>{const{resourceIds:e,all_checked:s}=this.$route.query,a=e&&-1!==e.indexOf(t.id);return"true"===s||a}}},methods:{playResource(t,e){this.$emit("onPlayResource",{can:t.canStudy,type:t.type,index:e,play:t.play,auditionType:t.auditionType})},durationFormat(t){return(0,o.WJ)(t,this)},courseTest(t){this.$emit("onCourseTest",{resourceId:t.id,hasAnswered:this.hasAnswered(t)})},downloadResource(t){this.showDownload=!0,this.currentItem=t},closeCourseWareShare(){this.showDownload=!1,this.currentItem={}}}},l=(0,s(1001).Z)(c,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"cl-courseware-list"},[t.resources.length?t._e():s("div",{staticClass:"resources-tip"},[t._v(t._s(t.$t("course.emptyCourse")))]),t._l(t.resources,(function(e,a){return s("div",{key:a,staticClass:"courseware",class:[t.currentPlay===a?"active":"",t.isOutCourse?"course-out-some":""]},[s("div",{staticClass:"courseware-top",on:{click:function(){return t.playResource(e,a)}}},[e.canStudy||void 0===e.canStudy?t._e():s("div",{staticClass:"not-study"}),t.isOutCourse?t._e():s("div",{staticClass:"resource-icon"},[s("div",{staticClass:"icon-label",style:{color:t.disallowPlay&&0===e.auditionType?"#B7BAC8":t.getIconAndColor(e).color}},[s("SvgIcon",{attrs:{"icon-class":t.getIconAndColor(e).type,size:16,color:t.disallowPlay&&0===e.auditionType?"#B7BAC8":t.getIconAndColor(e).color}}),s("span",{staticClass:"icon-label-name"},[t._v(t._s(t.getIconAndColor(e).typeName))])],1),s("div",{staticClass:"resource-duration"},[t._v(t._s("mp4"===e.type||"mp3"===e.type?t.durationFormat(e.duration):null))]),t.isShowImportant(e)?s("span",{staticClass:"knowledge-point"},[t._v(t._s(t.$t("course.importantCourse")))]):t._e(),"mp4"===e.type&&"finish"===e.aiUpgradeStatus?s("span",{staticClass:"knowledge-point"},[t._v(t._s(t.$t("aiStudy.knowledgePoints")))]):t._e(),s("div",{staticClass:"courseware-top-right"},[!t.disallowPlay||1!==e.auditionType&&2!==e.auditionType?t._e():s("div",{staticClass:"audition"},[s("SvgIcon",{staticClass:"iconfont",attrs:{"icon-class":"icon-shiting",color:"#465dcd",size:12,"track-color":"#EBEBEB"}}),t._v(" "+t._s(t.$t("course.tryListen"))+" ")],1),!t.download||"h5"===e.type||"LOCAL"===e.storageType||"true"!==e.play&&"3"!==e.play?t._e():s("div",{staticClass:"download-icon",on:{click:function(s){return s.stopPropagation(),t.downloadResource(e)}}},[s("SvgIcon",{attrs:{"icon-class":"icon-xiazai",size:16,color:"rgba(0, 0, 0, 0.25)"}})],1)])]),t.isOutCourse?t._e():s("div",{staticClass:"resource-title",class:[t.disallowPlay?"disallowPlay":""]},[s("div",{staticClass:"resource-title-info "},[t._v(t._s(e.title))]),e.progress<100?s("div",{staticClass:"percent"},[s("van-progress",{attrs:{"show-pivot":!1,percentage:+e.progress,"stroke-width":"4",color:"#465dcd"}}),s("div",{staticClass:"resource-progress"},[t._v(" "+t._s(+e.progress+"%")+" ")])],1):s("div",{staticClass:"percent complete"},[s("div",{staticClass:"completeTips"},[t._v(t._s(t.$t("course.finished")))])])]),t.isOutCourse?s("div",{staticClass:"resource-title-outs resource-title",class:[t.disallowPlay?"disallowPlay":""]},[s("div",{staticClass:"icon-label",style:{color:t.disallowPlay&&0===e.auditionType?"#B7BAC8":t.getIconAndColor(e).color}},[s("SvgIcon",{attrs:{"icon-class":""+t.getIconAndColor(e).type,size:16,color:t.disallowPlay&&0===e.auditionType?"#B7BAC8":t.getIconAndColor(e).color}})],1),s("div",{staticClass:"resource-title-info resource-title-outs-info"},[t._v(t._s(e.title))])]):t._e(),e.questionCount>0||e.resourceQuizVo&&e.resourceQuizVo.questionCount>0?s("div",{staticClass:"test",on:{click:function(s){return t.courseTest(e)}}},[s("div",{staticClass:"real"},[s("SvgIcon",{attrs:{"icon-class":"icon-text",size:14,color:"#7F849A"}}),t.hasAnswered(e)?s("div",{staticClass:"tested"},[s("SvgIcon",{attrs:{"icon-class":"icon-done",size:16,color:"#FFFFFF"}})],1):t._e(),s("span",{staticClass:"test_text"},[t._v(t._s(t.$t("course.test")))])],1)]):t._e()])])})),s("course-ware-share",{attrs:{"is-show":t.showDownload,"current-item":t.currentItem},on:{closeCourseWareShare:t.closeCourseWareShare}})],2)}),[],!1,null,"513ce500",null).exports},13710:(t,e,s)=>{s.r(e),s.d(e,{default:()=>d});s(34837);var a=s(39146),i=s(95082),o=(s(70885),s(6458)),r=(s(18144),s(65641)),n=(s(52355),s(29233)),c=(s(20581),s(50914)),l=s(94864),u={name:"Interactive",components:{[c.Z.name]:c.Z,[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z},data:()=>({interactiveInfo:{},loading:!0,finished:!1,imgBg:"https://oss.coolcollege.cn/1828155960422699008.png"}),computed:{},mounted(){this.getSelfModelReport()},methods:{getSelfModelReport(){const{courseId:t}=this.$route.query;l.Z.getInteractiveList({courseId:t}).then((t=>{this.interactiveInfo=(0,i.Z)({},t.data.data),this.loading=!1,this.finished=!0,a.Z.clear()})).catch((()=>{a.Z.clear()}))},ranking(t){let e="";switch(t){case 1:e="1790751727201423360";break;case 2:e="1790751728975613952";break;case 3:e="1790751730716250112";break;default:e=""}return-1===t?"--":""===e?`${t}`:`<img width='20' src='https://oss.coolcollege.cn/${e}.png' />`},getCorrectRateColor(t){const e=Number(t);return e<=40?"#FF4D4F":e>40&&e<=70?"#FAAD14":e>70?"#52C41A":""}}},d=(0,s(1001).Z)(u,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"interactiveWrap"},[s("div",{staticClass:"top-img"},[s("img",{attrs:{src:t.imgBg}})]),s("van-row",{staticClass:"basic-info"},[s("span",{staticClass:"title"},[t._v(t._s(t.$t("course.interactiveQuiz")))]),s("span",{staticClass:"split-icon"},[t._v("|")]),s("span",{staticClass:"time"},[t._v(t._s(t.$t("course.listUpdateText"))+" ")])]),s("div",{staticClass:"bottom-table"},[s("van-list",{attrs:{finished:t.finished,"finished-text":"本次排名只显示前20名"},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[s("van-row",{staticClass:"tHead",attrs:{type:"flex"}},[s("van-col",{attrs:{span:"4"}},[t._v(t._s(t.$t("course.ranking")))]),s("van-col",{attrs:{span:"4"}},[t._v(t._s(t.$t("common.name")))]),s("van-col",{attrs:{span:"6"}},[t._v(t._s(t.$t("course.correctTotalTimes")))]),s("van-col",{attrs:{span:"4"}},[t._v(t._s(t.$t("course.correctRate")))]),s("van-col",{attrs:{span:"6"}},[t._v(t._s(t.$t("course.averageTime")))])],1),s("van-row",{staticClass:"mBody",attrs:{type:"flex"}},[s("van-col",{attrs:{span:"4"}},[s("div",[t._v("--")])]),s("van-col",{staticClass:"blackText",attrs:{span:"4"}},[t._v(t._s(t.interactiveInfo.my_info.user_name))]),s("van-col",{attrs:{span:"6"}},[t._v(t._s(t.interactiveInfo.my_info.answer_correct_num)+" / "+t._s(t.interactiveInfo.my_info.answer_num))]),s("van-col",{staticClass:"redText",style:{color:t.getCorrectRateColor(t.interactiveInfo.my_info.average_accuracy)},attrs:{span:"4"}},[t._v(t._s(t.interactiveInfo.my_info.average_accuracy?t.interactiveInfo.my_info.average_accuracy+"%":"--"))]),s("van-col",{attrs:{span:"6"}},[t._v(t._s(t.interactiveInfo.my_info.average_duration?t.interactiveInfo.my_info.average_duration:"--"))])],1),t._l(t.interactiveInfo.top_list,(function(e){return s("van-row",{key:e.user_id,staticClass:"tBody",attrs:{type:"flex"}},[s("van-col",{attrs:{span:"4"}},[s("div",{domProps:{innerHTML:t.xss(t._s(t.ranking(e.sort)))}})]),s("van-col",{staticClass:"name",attrs:{span:"4"}},[t._v(t._s(e.user_name))]),s("van-col",{attrs:{span:"6"}},[t._v(t._s(e.answer_correct_num)+" / "+t._s(e.answer_num))]),s("van-col",{style:{color:t.getCorrectRateColor(e.average_accuracy)},attrs:{span:"4"}},[t._v(t._s(e.average_accuracy?e.average_accuracy+"%":"--"))]),s("van-col",{attrs:{span:"6"}},[t._v(t._s(e.average_duration))])],1)}))],2)],1)],1)}),[],!1,null,"2b6ab6da",null).exports},53134:(t,e,s)=>{s.r(e),s.d(e,{default:()=>n});var a=s(95082),i=s(26294),o=s(22648),r={name:"Interactive",components:{ClWaterMark:s(24357).Z},data:()=>({iframeSrc:""}),computed:(0,a.Z)((0,a.Z)({},(0,i.mapGetters)({userInfo:"user/getUserInfo"})),{},{viewSrc:()=>`/coolcollege-interactive-video/${(0,o.bz)()}/mobile/index.html`}),mounted(){this.getIframeSrc()},methods:{getIframeSrc(){const t=localStorage.getItem("enterpriseId"),{courseId:e,resourceId:s}=this.$route.query,{userId:a}=this.userInfo,i=localStorage.getItem("access_token"),r=`&enterprise_api=${CL_API}&enterprise_id=${t}&course_id=${e}&user_id=${a}&access_token=${i}&language=${(0,o.me)()}`;this.iframeSrc=`${ASSETS_SDN_HOST}${this.viewSrc}?loglvl=0&video_id=${s}${r}`}}},n=(0,s(1001).Z)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("iframe",{style:{width:"100%",height:"100%",overflow:"visible"},attrs:{className:"interfaceEditor",src:t.iframeSrc,scrolling:"no",frameBorder:"0"}}),s("cl-water-mark",{attrs:{scenes:"video",rotate:"55"}})],1)}),[],!1,null,null,null).exports},28512:(t,e,s)=>{s.d(e,{Z:()=>x});var a=s(95082),i=(s(47601),s(44951)),o=(s(57658),s(91058),s(2707),s(26699),s(32023),s(25934)),r=(s(3791),s(93432)),n=s(27632),c=s(18621),l={name:"FaceCompareDialog",components:{VanImage:i.Z,[r.Z.name]:r.Z},props:{isBeginning:{type:Boolean,default:!1},requestParam:{type:Object,default:()=>{}}},data:()=>({imageSrc:"",loading:!1}),mounted(){setTimeout((()=>{this.$emit("pause")}),600)},methods:{doFaceCompare(){const t=this.imageSrc;if(0===t.length)return void this.$toast(this.$t("subsidy.takePhoto"));const{requestParam:e}=this;this.$toast.loading({duration:0,forbidClick:!0,message:this.$t("subsidy.processing")}),c.Z.getFaceCompareToken({userId:e.userId,courseId:e.courseId,enterpriseId:e.enterpriseId,studyProjectId:e.studyProjectId,resourceId:e.resourceId,deviceId:e.deviceId,deviceType:e.deviceType,timestamp:(new Date).getTime()}).then((s=>{"0"===s.data.returnCode?c.Z.postFaceCompare({deviceType:e.deviceType,timestamp:(new Date).getTime(),deviceId:e.deviceId,target:t.split(",")[1],compareMode:"2",studyProjectId:e.studyProjectId,courseId:e.courseId,resourceId:e.resourceId,bizCode:s.data.returnData.bizCode,userId:e.userId,enterpriseId:e.enterpriseId,videoStudyTime:`${e.currentTime}`,firstFaceCompare:!1}).then((t=>{this.imageSrc="",this.$toast.clear(),"0"===t.data.returnCode&&1===t.data.returnData.result?(this.$emit("hide"),this.$emit("play")):this.$toast({duration:5e3,forbidClick:!0,message:"success"===t.data.returnMsg?t.data.returnData.msg:t.data.returnMsg||this.$t("subsidy.recognitionFailed")})})).catch((()=>{this.imageSrc="",this.$toast.clear()})):"11015"===s.data.returnCode&&(this.$emit("hide"),this.$emit("play"))})).catch((()=>{this.$toast.clear()}))},chooseImage(){this.$emit("pause");n.Z.chooseImage({count:1,sourceType:["camera","album"],compressed:!0,percent:80},(t=>{this.uploadImg(t.filePaths[0])}))},uploadImg(t){let e={access_token:this.$store.state.commonParams.accessToken};this.loading=!0,n.Z.uploadFile({url:`${CL_API}/knowledge-api/common/upload`,fileName:"file",fileType:"image",formData:e,filePath:t},(({data:t})=>{const{server:e,fileNewName:s}=t.data;fetch(new Request(`${e}/${s}`)).then((t=>t.blob())).then((t=>{let e=new FileReader;e.readAsDataURL(t),e.onloadend=t=>{this.imageSrc=t.target.result}})).catch((t=>{console.error(t)})),this.loading=!1}),(t=>{console.error("上传失败：",t),this.loading=!1}))}}},u=s(1001),d=(0,u.Z)(l,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"dialog-form"},[s("div",{staticClass:"dialog-form-item"},[t._v(t._s(t.isBeginning?t.$t("subsidy.recognitionNeeded"):"")+" "+t._s(t.$t("subsidy.recognitionIn5Min")))]),s("div",{staticClass:"face-content"},[t.imageSrc?s("van-image",{staticClass:"dialog-form-preview",attrs:{src:t.imageSrc,fit:"contain"}}):t._e(),t.imageSrc||!1!==t.loading?t._e():s("div",{staticClass:"dialog-form-image",on:{click:t.chooseImage}}),t.loading?s("van-loading",{staticClass:"face-loading",attrs:{size:"24"}}):t._e()],1)])}),[],!1,null,"5c21ff0e",null).exports,h=(s(29941),s(64168)),p=(s(52355),s(29233)),m=(s(93787),s(20090)),g=s(95969),v={name:"IdentifyVerify",components:{VanField:m.Z,[p.Z.name]:p.Z,[h.Z.name]:h.Z},props:{requestParam:{type:Object,default:()=>{}}},data:()=>({identifyNo:"",identifyName:""}),mounted(){setTimeout((()=>{this.$emit("pause")}),600)},methods:{onConfirm(){const{identifyName:t,identifyNo:e,requestParam:s}=this;delete s.accessToken,""!==t&&e&&18===e.length?c.Z.postIdentifyVerify((0,a.Z)((0,a.Z)({},s),{},{timestamp:(new Date).getTime(),cardNo:e,name:t})).then((t=>{"0"===t.data.returnCode?(this.$emit("play"),this.$emit("hide")):this.$toast(t.data.returnMsg)})):this.$toast(this.$t("subsidy.inputError"))},onCancel(){const{requestParam:t}=this;this.$router.push({path:g.Z.studyProject.toStudyProject({studyProjectId:t.studyProjectId})})}}},f=(0,u.Z)(v,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"dialog-form"},[s("van-cell-group",[s("van-field",{attrs:{label:t.$t("subsidy.name"),placeholder:t.$t("subsidy.placeholder",{input:t.$t("subsidy.name")})},model:{value:t.identifyName,callback:function(e){t.identifyName=e},expression:"identifyName"}}),s("van-field",{attrs:{label:t.$t("subsidy.idcardNo"),placeholder:t.$t("subsidy.placeholder",{input:t.$t("subsidy.idcardNo")}),"max-length":18},model:{value:t.identifyNo,callback:function(e){t.identifyNo=e},expression:"identifyNo"}})],1)],1)}),[],!1,null,"5cd058bc",null).exports,y={name:"CaptchaDialog",components:{VanField:m.Z,VanImage:i.Z},props:{requestParam:{type:Object,default:()=>{}}},data:()=>({bizCode:"",captcha:"",imageUrl:""}),beforeDestroy(){setTimeout((()=>{this.$emit("pause")}),600),this.getCaptchaImage()},methods:{getCaptchaImage(){const{requestParam:t}=this;c.Z.getCaptcha((0,a.Z)((0,a.Z)({},t),{},{timestamp:(new Date).getTime()})).then((t=>{"0"===t.data.returnCode&&(this.imageUrl=t.data.returnData.verificationImagePath,this.bizCode=t.data.returnData.bizCode)}))},onConfirm(){const{requestParam:t,bizCode:e,captcha:s}=this;s?c.Z.postVerifyCaptcha({bizCode:e,verificationCode:s,videoStudyTime:`${t.currentTime}`,deviceType:t.deviceType,deviceId:t.deviceId,enterpriseId:t.enterpriseId,courseId:t.courseId,resourceId:t.resourceId,userId:t.userId,studyProjectId:t.studyProjectId,timestamp:(new Date).getTime()}).then((t=>{"0"===t.data.returnCode?(this.$emit("hide"),this.$emit("play")):this.$toast(t.data.returnMsg)})):this.$toast(this.$t("subsidy.placeholder",{input:this.$t("subsidy.captcha")}))}}},_=y,C=(0,u.Z)(_,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"dialog-form"},[s("div",{staticClass:"dialog-form-item"},[s("span",[t._v(t._s(t.$t("subsidy.captcha")))])]),s("div",{staticClass:"dialog-form-item captcha-form-item"},[s("van-field",{staticClass:"captcha-field",attrs:{label:"",placeholder:t.$t("subsidy.placeholder",{input:t.$t("subsidy.captcha")}),"max-length":4},model:{value:t.captcha,callback:function(e){t.captcha=e},expression:"captcha"}}),s("van-image",{staticClass:"captcha-image",attrs:{fit:"aspectFill",src:t.imageUrl,alt:"captcha"},on:{click:t.getCaptchaImage}})],1)])}),[],!1,null,"157c4a70",null).exports,I=s(5141),b=s(22648),w={name:"VideoCapture",components:{},props:{duration:{type:String,default:"0"},videoCaptureUrl:{type:String,default:""},requestParam:{type:Object,default:()=>{}}},data:()=>({intervalId:null,videoSrc:"",reupload:!1,videoSrcOnline:""}),computed:{autoplay:()=>"ios"!==(0,b.Os)()},mounted(){setTimeout((()=>{this.$emit("pause")}),600)},methods:{chooseVideo(){const t={dingTalk:["camera","album"],app:["camera","album"]}[n.Z.env]||[];n.Z.chooseVideo({count:1,sourceType:t,maxDuration:10,compressed:!0},(t=>{const{filePath:e}=t;this.videoSrc=[e],this.$nextTick((()=>{this.$refs.commonVideo.on("loadedmetadata",(()=>{const t=this.$refs.commonVideo.duration();Math.round(t)>=parseInt(this.duration,10)?this.uploadVideo(this.videoSrc):(this.$toast(this.$t("subsidy.captureVideoTips"),{duration:this.duration}),this.videoSrc="")}))}))}),(t=>{console.error("视频选择失败：",t)}))},uploadVideo(t){this.reupload=!1,I.Z.uploadFileIsVideo({filePath:t}).then((t=>{let{data:e}=JSON.parse(t.data);this.videoSrcOnline=`${e.server}/${e.fileNewName}`})).catch((()=>{this.$toast(this.$t("subsidy.uploadFailed")),this.reupload=!0}))},doVideoCompare(){clearInterval(this.intervalId),this.videoSrcOnline?c.Z.postVideoCompare((0,a.Z)((0,a.Z)({},this.requestParam),{},{timestamp:(new Date).getTime(),recordVideoUrl:this.videoSrcOnline})).then((t=>{"0"===t.data.returnCode&&(this.$emit("hide"),this.$emit("play"))})).catch((t=>{console.error(t)})):this.$toast(this.$t("subsidy.captureVideoFirst"))}}},$=(0,u.Z)(w,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"dialog-form"},[s("div",{staticClass:"dialog-form-item"},[t._v(t._s(t.$t("subsidy.captureVideoTips",{duration:t.duration})))]),t.videoSrc?s("div",[t.reupload?s("button",{staticClass:"dialog-form-preview-video-btn",attrs:{size:"mini",type:"default"},on:{click:t.uploadVideo}},[t._v(t._s(t.$t("subsidy.reupload")))]):t._e(),s("cool-video",{ref:"commonVideo",attrs:{muted:!0,controls:!1,autoplay:t.autoplay,src:t.videoSrc}})],1):t._e(),s("div",{staticClass:"dialog-form-image dialog-form-video",on:{click:t.chooseVideo}})])}),[],!1,null,"5a0e7fde",null).exports,k=s(96838),S=s(94864),T=s(11651),Z={name:"SubsidyPlayer",components:{FaceCompare:d,IdentifyVerify:f,Captcha:C,VideoCapture:$,VanImage:i.Z},props:{enterType:{type:String,default:""},isPlayingVideo:{type:Boolean,default:!1},isPaused:{type:Boolean,default:!1},courseInfo:{type:Object,default:()=>{}},preventHangFlag:{type:Boolean,default:!1},showRandomWindow:{type:Boolean,default:!1},customStyle:{type:Object,default:()=>{}},playingVideo:{type:Object,default:()=>({id:"",recentStart:0,duration:0,auditionLength:0,auditionType:-1,url:"",contentType:"video"})},videoCaptureUrl:{type:String,default:""},cover:{type:String,default:""},isFixed:{type:Boolean,default:!0}},data(){return{lastReportTime:0,currentTime:0,canDrag:!1,progress:0,lastVideoId:this.playingVideo.id,isShowIdentifyVerify:!1,isShowAntiHang:!1,isShowFaceCompareAtFirst:!1,isShowVideosDialog:!1,antiHangType:0,triggerTime:[],videoTriggerTime:[],authentication:!1,triggerSuccessSize:0,timeoutId:0,playerUrl:"",deviceType:"TYPE_H5",height:211,timer:null}},computed:{antiHangTitle(){return"1"===this.antiHangType?this.$t("subsidy.antiHangCaptcha"):this.$t("subsidy.antiHangRecognition")},userInfo(){return this.$store.state.commonParams},rulesInfo(){const{courseInfo:t}=this;let e=[];"1"===t.realNameAuthentication&&e.push(this.$t("subsidy.realNameAuthentication")),"1"===t.videoOnHook?e.push(this.$t("subsidy.antiHangCaptcha")):"2"===t.videoOnHook&&e.push(this.$t("subsidy.antiHangRecognition")),"1"===t.videoStartFace&&e.push(this.$t("subsidy.startRecognition")),"1"===t.videoPlayRecord&&e.push(this.$t("subsidy.captureVideo"));let s=`${e.length>0?this.$t("subsidy.rulesText",{rules:e.join("、")}):""}${parseInt(this.courseInfo.studyHourLimit,10)>0?`，${this.$t("subsidy.studyTimeoutWarming",{limit:this.courseInfo.studyHourLimit})}`:""}`;return{rules:e,tips:s}},videoHeight(){return(0,T.W)(this.height)},requestParam(){return{deviceType:this.deviceType,deviceId:(0,o.Z)(),courseId:this.courseInfo.courseId,enterpriseId:this.$store.state.commonParams.enterpriseId,userId:this.$store.state.commonParams.userId,studyProjectId:this.courseInfo.project_id,resourceId:this.playingVideo.id,accessToken:this.$store.state.commonParams.access_token,currentTime:this.currentTime}},autoplay:()=>"ios"!==(0,b.Os)()},mounted(){this.initVideo()},beforeDestroy(){clearTimeout(this.timer)},methods:{initVideo(){this.logEvent({log:"补贴播放器加载"}),this.playerUrl=this.playingVideo.url,parseInt(this.courseInfo.studyHourLimit,10)>0&&this.rulesInfo.rules.length>0&&this.showTipsDialog()},onPlay(){this.setCourseProcess(),this.progress>=100&&(this.timer=setTimeout((()=>{this.setCourseProcess()}),1e3))},async reportStudyStatus(){if(this.canDrag)return;let{playingVideo:t,courseInfo:e,userInfo:s}=this,a=this.currentTime-this.lastReportTime,i={playTime:this.currentTime,progressTime:a>0?a:60,timestamp:(new Date).getTime(),deviceType:this.deviceType,deviceId:(0,o.Z)(),userId:s.userId,enterpriseId:s.enterpriseId,studyProjectId:e.project_id,courseId:e.courseId,resourceId:t.id};try{const t=await S.Z.task.postStudyStatus(i);this.logEvent({title:"进度上报成功",data:t}),"gz-subsidy-api.404007"===t.data.code?(this.pause(),this.showStudyTimeOut()):0!==t.data.code&&this.showError(),this.lastReportTime=this.currentTime}catch(t){this.logEvent({title:"进度上报",data:t}),406===t.status?(this.pause(),this.showStudyTimeOut()):this.showError()}},reportStartStudy(){if(this.canDrag)return;let{playingVideo:t,courseInfo:e,userInfo:s}=this;S.Z.task.postStartStatus({deviceType:this.deviceType,timestamp:(new Date).getTime(),deviceId:(0,o.Z)(),enterpriseId:s.enterpriseId,userId:s.userId,StudyProjectId:e.project_id,resourceId:t.id,courseId:e.courseId}).then((t=>{this.logEvent({title:"开始学习",data:t}),"0"===t.data.returnCode&&("1"!==e.realNameAuthentication||this.authentication?"1"===e.videoStartFace&&0===this.triggerSuccessSize&&(this.isShowFaceCompareAtFirst=!this.canDrag):this.isShowIdentifyVerify=!this.canDrag)})).catch((t=>{this.logEvent({title:"开始学习",data:t})}))},reportEndStudy(){if(this.canDrag)return;let{playingVideo:t,courseInfo:e,userInfo:s}=this;S.Z.task.postEndStatus({deviceType:this.deviceType,timestamp:(new Date).getTime(),deviceId:(0,o.Z)(),courseId:e.courseId,enterpriseId:s.enterpriseId,userId:s.userId,StudyProjectId:e.project_id,resourceId:t.id}).then((t=>{this.logEvent({title:"结束学习",data:t}),"0"===t.data.returnCode||console.error(t.data)}))},setCourseProcess(){let{playingVideo:t,courseInfo:e,userInfo:s}=this;clearTimeout(this.timeoutId),this.lastReportTime=t.recentStart||0,this.currentTime=t.recentStart||0,this.lastVideoId=t.id,this.isShowVideosDialog=!1,S.Z.task.getCourseProcess({enterpriseId:s.enterpriseId,projectId:e.project_id,userId:s.userId,resourceId:t.id,courseId:e.courseId}).then((s=>{if(this.logEvent({title:"获取监管平台课程进度",data:s}),s.data&&s.data.process>-1){if(Math.abs(parseInt(t.duration,10)-s.data.process)<5)return this.canDrag=!0,void(this.progress=t.progress);this.$emit("update:playingVideo",(0,a.Z)((0,a.Z)({},this.playingVideo),{},{recentStart:s.data.process}));let i=this.getAntiHangTriggerTime(),o=0===s.data.isSubmitVideoPlayRecord?this.getVideoTriggerTime():[],{triggerSuccessSize:r}=s.data;this.triggerSuccessSize=r,this.authentication=s.data.authentication,this.progress=Math.floor(s.data.process/parseInt(t.duration,10)*100),this.canDrag=!1,this.triggerTime=i.sort(((t,e)=>t-e)).slice(r>0?r-1:0),this.videoTriggerTime=o,this.antiHangType=e.videoOnHook,this.currentTime=s.data.process,this.$nextTick((()=>{s.data.process<1&&this.reportStartStudy(),this.$refs.video.seek(s.data.process+1),this.$refs.video.play()}))}}))},showError(){this.$refs.video.pause(),this.$dialog.confirm({title:this.$t("subsidy.tips"),showCancelButton:!1,confirmButtonText:this.$t("subsidy.gotIt"),message:this.$t("subsidy.reportError")}).then((()=>{this.play()}))},async onEnded(){this.saveProgress(),await this.reportStudyStatus(),this.reportEndStudy()},onPause(){this.saveProgress()},onTimerEvent(){let t=this.$refs.video.getPlayer().currentTime(),e=this.$refs.video.getPlayer().duration();this.currentTime=Math.floor(t),e=Math.floor(e),this.progress=Math.floor(t/e*100),this.$nextTick((()=>{this.triggerTime.includes(this.currentTime+1)?this.timeoutId=setTimeout((()=>{this.isShowAntiHang=!this.canDrag}),1600):this.videoTriggerTime.includes(this.currentTime+1)&&(this.timeoutId=setTimeout((()=>{this.isShowVideosDialog=!this.canDrag}),2600)),!this.triggerTime.includes(this.currentTime)&&this.currentTime>0&&this.currentTime%60==0&&this.reportStudyStatus(),this.currentTime%20==0&&this.saveProgress()}))},saveProgress(){this.progress&&this.$emit("handleSaveProgress",{currentTime:this.currentTime,progress:this.progress,id:this.playingVideo.id,requestId:(0,o.Z)()})},getAntiHangTriggerTime(){const{courseInfo:t,playingVideo:e}=this;let s=[],a=parseInt(e.duration,10),i=0,o=1,r=parseInt(t.triggerValue,10);switch(t.triggerType){case"0":let t=r+1;for(i=Math.floor(a/t);--t>0;)s.push(t*i);break;case"1":for(;(i=r*o*60)<a;)s.push(i),o++;break;case"2":for(o=2;(i=60*r*o*(o-1)/2)<a;)s.push(i),o++}return s},getVideoTriggerTime(){const{courseInfo:t,playingVideo:e}=this;let s=[],a=parseInt(e.duration,10);if("1"===t.videoPlayRecord)switch(parseInt(t.recordVideoState,10)){case 1:s.push(3);break;case 2:s.push(Math.floor(a/4));break;case 3:s.push(Math.floor(a/3));break;case 4:s.push(Math.floor(a/2))}return s},logEvent(t){k.Z.logger((0,a.Z)({moduleName:"subsidy-video-play"},t))},onIdentifyVerifyDialogHide(){this.isShowIdentifyVerify=!1,"1"===this.courseInfo.videoStartFace&&0===this.triggerSuccessSize&&(this.isShowFaceCompareAtFirst=!this.canDrag)},onCaptchaDialogHide(){this.isShowAntiHang=!1,this.$nextTick((()=>{this.currentTime%60==0&&this.videoTriggerTime.includes(this.currentTime)&&(this.reportStudyStatus(),this.isShowVideosDialog=!this.canDrag)}))},showStudyTimeOut(){this.$dialog.confirm({title:this.$t("subsidy.tips"),showCancelButton:!1,confirmButtonText:this.$t("subsidy.gotIt"),message:this.$t("subsidy.studyTimeoutError",{limit:this.courseInfo.studyHourLimit})}).then((()=>{this.onStudyTimeOutConfirm()}))},onStudyTimeOutConfirm(){this.play()},showTipsDialog(){this.$dialog.confirm({title:this.$t("subsidy.tips"),showCancelButton:!1,confirmButtonText:this.$t("subsidy.study"),message:this.rulesInfo.tips})},identifyVerifyConfirm(){this.$refs.identifyVerify.onConfirm()},identifyVerifyCancel(){this.$refs.identifyVerify.onCancel()},doVideoCompareConfirm(){this.$refs.videoCapture.doVideoCompare()},doFaceCompareConfirm(){this.$refs.faceCompare.doFaceCompare()},antiHangConfirm(){"1"===this.antiHangType?this.$refs.captcha.onConfirm():this.$refs.faceCompare.doFaceCompare()},onBeforeClose:(t,e)=>"confirm"===t?e(!1):e(),onFullscreenChange(t){this.$emit("onFullscreenChange",t)},pause(){this.$refs.video.pause()},play(){this.$refs.video.play()}}},x=(0,u.Z)(Z,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"player-cover",style:{height:t.videoHeight}},[t.isPlayingVideo&&t.playingVideo.url?s("div",{staticClass:"course-player"},[s("cool-video",{ref:"video",attrs:{"player-id":"subsidy-player",src:t.playingVideo.url,controls:!0,height:t.height,"content-type":t.playingVideo.contentType,"playback-rates":[],"is-drag":t.canDrag,autoplay:t.autoplay,"show-fullscreen-btn":!0},on:{onPlayerEnded:t.onEnded,onPlay:t.onPlay,onPause:t.onPause,refreshProgress:t.onTimerEvent,onFullscreenChange:t.onFullscreenChange}}),s("van-dialog",{attrs:{"confirm-button-text":t.$t("subsidy.confirm"),title:t.$t("subsidy.captureVideo"),"before-close":t.onBeforeClose},on:{confirm:t.doVideoCompareConfirm},model:{value:t.isShowVideosDialog,callback:function(e){t.isShowVideosDialog=e},expression:"isShowVideosDialog"}},[s("VideoCapture",{ref:"videoCapture",attrs:{"request-param":t.requestParam,duration:t.courseInfo.recordVideoTime,"video-capture-url":t.videoCaptureUrl},on:{play:t.play,pause:t.pause,hide:function(e){t.isShowVideosDialog=!1}}})],1),s("van-dialog",{attrs:{"show-cancel-button":"","confirm-button-text":t.$t("subsidy.confirm"),"cancel-button-text":t.$t("subsidy.cancel"),title:t.$t("subsidy.realNameAuthentication"),"before-close":t.onBeforeClose},on:{confirm:t.identifyVerifyConfirm,cancel:t.identifyVerifyCancel},model:{value:t.isShowIdentifyVerify,callback:function(e){t.isShowIdentifyVerify=e},expression:"isShowIdentifyVerify"}},[s("IdentifyVerify",{ref:"identifyVerify",attrs:{"request-param":t.requestParam},on:{play:t.play,pause:t.pause,hide:t.onIdentifyVerifyDialogHide}})],1),s("van-dialog",{attrs:{"confirm-button-text":t.$t("subsidy.doRecognition"),title:t.$t("subsidy.recognition"),"before-close":t.onBeforeClose},on:{confirm:t.doFaceCompareConfirm},model:{value:t.isShowFaceCompareAtFirst,callback:function(e){t.isShowFaceCompareAtFirst=e},expression:"isShowFaceCompareAtFirst"}},[s("FaceCompare",{ref:"faceCompare",attrs:{"request-param":t.requestParam,"is-beginning":!0},on:{play:t.play,pause:t.pause,hide:function(e){t.isShowFaceCompareAtFirst=!1}}})],1),s("van-dialog",{attrs:{"confirm-button-text":"1"===t.antiHangType?t.$t("subsidy.confirm"):t.$t("subsidy.doRecognition"),title:t.antiHangTitle,"before-close":t.onBeforeClose},on:{confirm:t.antiHangConfirm},model:{value:t.isShowAntiHang,callback:function(e){t.isShowAntiHang=e},expression:"isShowAntiHang"}},["1"===t.antiHangType?s("Captcha",{ref:"captcha",attrs:{"request-param":t.requestParam},on:{play:t.play,pause:t.pause,hide:t.onCaptchaDialogHide}}):"2"===t.antiHangType?s("FaceCompare",{ref:"faceCompare",attrs:{"request-param":t.requestParam},on:{play:t.play,pause:t.pause,hide:function(e){t.isShowAntiHang=!1}}}):t._e()],1)],1):s("div",{staticClass:"image-cover"},[s("van-image",{attrs:{fit:"fill",src:t.cover,height:"100%",width:"100%"}})],1)])}),[],!1,null,"33320611",null).exports},16018:(t,e,s)=>{s.r(e),s.d(e,{default:()=>p});s(82500);var a=s(49414),i=(s(82522),s(10342)),o=(s(20581),s(50914)),r=s(94864),n=s(27479),c=s(4852),l=s(78551),u=s(45877),d={name:"AssignList",components:{List:o.Z,Tab:i.Z,Tabs:a.Z,EmptyBox:n.Z,Avatar:c.Z,SvgIcon:l.Z,ClCustomUser:u.Z},data:function(){return{courseId:"",tabArr:[],dataList:[],activeTab:"all",loading:!1,hasNextPage:"false",pageSize:15,pageNumber:1}},computed:{themeColor(){return this.$store.state.themeColor.primaryColor}},mounted(){this.tabArr=[{title:this.$t("project.all"),status:"all"},{title:this.$t("course.unfinished"),status:"unfinished"},{title:this.$t("course.finished"),status:"finished"},{title:this.$t("course.overdue"),status:"overdue"}];const{courseId:t}=this.$route.query;this.courseId=t,this.loading=!0,this.loadData()},methods:{onTabChange(t){this.activeTab=t,this.pageNumber=1,this.hasNextPage=!0,this.dataList=[],this.loadData()},loadData(){this.loadStudyData()},loadStudyData(){const{pageNumber:t,pageSize:e}=this;this.loading=!0;const s={status:this.activeTab,page_size:e,page_number:t};r.Z.courseAssignedTrack(this.courseId,s).then((t=>{this.dataList=this.dataList.concat(t.data.list),this.hasNextPage="true"===t.data.has_next_page,this.loading=!1}))},onLoad(){if(!1===this.hasNextPage)return!1;this.pageNumber+=1,this.loading=!0,this.loadData()}}},h=(0,s(1001).Z)(d,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"project-assign-list cl-page-container"},[s("Tabs",{attrs:{"line-width":24,color:"white","title-active-color":t.themeColor,sticky:""},on:{change:t.onTabChange},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},t._l(t.tabArr,(function(e){return s("Tab",{key:e.title,attrs:{title:e.title,name:e.status}},[t.loading||0!==t.dataList.length?s("div",{staticClass:"list-container"},[s("List",{attrs:{finished:!t.hasNextPage,"immediate-check":!1,"finished-text":t.$t("common.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.dataList,(function(e){return s("div",{key:e.id,staticClass:"item-one"},[s("div",{staticClass:"user-img"},[s("Avatar",{attrs:{src:e.avatar,width:"40",height:"40"}})],1),s("div",{staticClass:"user-info"},[s("div",{staticClass:"user-name"},[s("cl-custom-user",{attrs:{type:e.sourceType,"data-type":"userName",value:e.unionid||e.userId,name:e.name}})],1),s("div",{staticClass:"user-department"},t._l(e.departments,(function(a,i){return s("span",{key:i},[t._v(" "+t._s(a)+" "),i!==e.departments.length-1?s("span",[t._v(" / ")]):t._e()])})),0)]),s("div",{staticClass:"status"},["overdue"===e.status?s("div",{staticClass:"overdue"},[t._v(" "+t._s(t.$t("course.overdue"))+" ")]):e.progress<100?s("div",{staticClass:"progress"},[s("div",{staticClass:"progress-info",style:"color: "+t.themeColor.primaryColor},[s("div",{staticClass:"progress-count"},[t._v(" "+t._s(e.progress)+" ")]),s("div",{staticClass:"percentage"},[t._v(" % ")])])]):s("div",{staticClass:"done"},[s("SvgIcon",{attrs:{color:"#d9dbe4",size:20,"icon-class":"icon-done"}})],1)])])})),0)],1):s("EmptyBox")],1)})),1)],1)}),[],!1,null,"eccf015e",null),p=h.exports},28414:(t,e,s)=>{s.r(e),s.d(e,{default:()=>M});var a=s(95082),i=(s(3791),s(93432)),o=(s(38862),s(26699),s(32023),s(57658),s(30541),s(26294)),r=s(25934),n=s(69119),c=s(63874),l=s(95969),u=s(7294),d=s(22648),h=s(94864),p=s(56955),m=s(58227),g=s(78368),v=s(77522),f=s(62501),y=s(67185),_=(s(31968),s(3809)),C=(s(47601),s(44951)),I=(s(56977),s(78551)),b=s(62527),w=s(49642),$=s(45877),k={components:{VanImage:C.Z,SvgIcon:I.Z,RatingModal:b.Z,privateRatingModal:w.Z,[_.Z.name]:_.Z,ClCustomUser:$.Z},props:{courseDetails:{type:Object,default:function(){return{awardScore:0,assign:"",graded:"",learners:null,lecturer:null,resourceCount:0,score:0,showScore:"",teacherAvatar:"",teacherName:"",title:"",track:""}}},enterpriseId:{type:String,default:""},courseId:{type:String,default:""}},data:()=>({defaultUserImg:g,appraiseFlag:!1,isWuhan:["medu.wuhanrt.com"].includes(location.host),canShowWuhanModal:!1}),mounted(){console.warn(this.courseDetails,"courseDetails")},computed:(0,a.Z)((0,a.Z)((0,a.Z)({},(0,o.mapGetters)({primaryColor:"getPrimaryColor"})),(0,o.mapState)(["commonParams"])),{},{isToStudyList(){return"1012529708090396676"!==this.commonParams.enterpriseId},renderAssignBtn(){return"true"===this.courseDetails.assign},rateNumber(){return this.isWuhan?(this.courseDetails.score/100).toFixed()/2:0===this.courseDetails.score?5:this.courseDetails.score},wuhanScore(){return(this.courseDetails.score/100).toFixed(2)}}),methods:{toStudyingPeopleList(){this.$router.push(l.Z.studyProject.studyingPeopleList({courseId:this.courseId}))},toInteractiveList(){this.$router.push({path:"/course-interactive",query:{courseId:this.courseId}})},getCourseIntro(){this.$router.push({path:l.Z.home.lecturerDetail(this.courseDetails.lecturer.id)})},assignPeople(){this.$router.push(l.Z.studyProject.taskAssign({courseId:this.courseId,queryType:"course"}))},assignedList(){this.$router.push(l.Z.course.assignData({courseId:this.courseId}))},judgeIsInteract(t){let e=!1;return Array.isArray(t)&&t.forEach((t=>{t.isInteract&&(e=!0)})),e},async submitStar(t){await h.Z.enterprise.comment({courseId:this.courseId,score:this.isWuhan?200*t:t}),this.$emit("getCourseDetails"),this.appraiseFlag=!1},toRate(){this.isWuhan?this.canShowWuhanModal=!0:this.appraiseFlag=!0}}},S=s(1001),T=(0,S.Z)(k,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"course-info"},[s("div",{staticClass:"title"},[t._v(" "+t._s(t.courseDetails.title)+" ")]),s("div",{staticClass:"appraise"},[t.courseDetails.score>=0?s("div",{staticClass:"appraise-score"},[s("van-rate",{attrs:{"allow-half":"",size:"15",color:t.isWuhan?"#ffa818":t.primaryColor,"void-icon":"star","void-color":"#C0C2CB",readonly:""},model:{value:t.rateNumber,callback:function(e){t.rateNumber=e},expression:"rateNumber"}})],1):t._e(),t.isWuhan?s("div",{staticClass:"appraise-rate-text"},[t._v(" "+t._s(t.wuhanScore)+" "+t._s(t.$t("studyProject.score"))+" ")]):t._e(),"false"===t.courseDetails.graded?s("div",{staticClass:"appraise-text",on:{click:t.toRate}},[t._v(" "+t._s(t.$t("course.toRate"))+" "),s("svg-icon",{attrs:{"icon-class":"icon-chakanpaiming",color:"#D9DBE4",size:10}})],1):t._e()]),s("div",{staticClass:"free"},[t.courseDetails.lecturer||""===t.courseDetails.teacherName?t._e():s("div",{staticClass:"name"},[s("van-image",{staticClass:"avatar",attrs:{fit:"fill",src:t.courseDetails.teacherAvatar||t.defaultUserImg}}),s("span",{staticClass:"teacher"},[t._v(t._s(t.courseDetails.teacherName))])],1),s("div",{staticClass:"courseware-count"},[t._v(" "+t._s(t.$t("course.courseware"))+" "),s("span",[t._v(t._s(t.courseDetails.resourceCount))])]),s("div",{staticClass:"studying",on:{click:function(e){t.isToStudyList&&t.toStudyingPeopleList()}}},[s("span",[t._v(t._s(t.courseDetails.learners&&t.courseDetails.learners.count)+t._s(t.$t("course.peopleLearning")))]),t.isToStudyList?s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-chakanpaiming",color:"#D9DBE4",size:10}}):t._e()],1),t.judgeIsInteract(t.courseDetails.resources)?s("div",{staticClass:"interactive",on:{click:function(e){return t.toInteractiveList()}}},[s("span",[t._v(t._s(t.$t("course.interactive")))]),s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-chakanpaiming",color:"#516AE6",size:10}})],1):t._e(),"true"===t.courseDetails.showScore?s("span",{staticClass:"awardScore"},[t._v(" "+t._s(t.courseDetails.awardScore)+t._s(t.$t("pointsMall.credits"))+" ")]):t._e()]),t.courseDetails.lecturer?s("div",{staticClass:"lecturer",on:{click:t.getCourseIntro}},[s("div",{staticClass:"name"},[s("van-image",{staticClass:"avatar",attrs:{fit:"aspectFill",src:t.courseDetails.teacherAvatar||t.defaultUserImg}}),"inside"===t.courseDetails.lecturer.teacherSyncType?s("span",{staticClass:"teacher"},[s("cl-custom-user",{attrs:{type:t.courseDetails.lecturer.teacherSyncSourceType,"data-type":"userName",value:t.courseDetails.lecturer.teacherSyncUserId,name:t.courseDetails.lecturer.lecturerName}})],1):s("span",{staticClass:"teacher"},[t._v(t._s(t.courseDetails.lecturer.lecturerName))])],1),s("div",{staticClass:"toinfo"},[s("span",[t._v(t._s(t.$t("course.lecturerDetails")))]),s("svg-icon",{attrs:{"icon-class":"icon-chakanpaiming",color:"#D9DBE4",size:10}})],1)]):t._e(),"true"!==t.courseDetails.assign&&"true"!==t.courseDetails.track||9===t.courseDetails.bizType?t._e():s("div",{staticClass:"course-track-assign"},[t.renderAssignBtn?s("div",{staticClass:"assign",on:{click:t.assignPeople}},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-track",color:"#7F849A",size:14}}),s("span",[t._v(t._s(t.$t("course.assign")))])],1):t._e(),"true"===t.courseDetails.track?s("div",{staticClass:"track",on:{click:t.assignedList}},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-doning2",color:"#7F849A",size:14}}),s("span",[t._v(t._s(t.$t("course.track")))])],1):t._e()]),t.appraiseFlag?s("rating-modal",{attrs:{star:5,edit:"false"===t.courseDetails.graded},on:{onSubmit:t.submitStar,cancelModal:function(e){t.appraiseFlag=!1}}}):t._e(),t.canShowWuhanModal?s("private-rating-modal",{attrs:{edit:"false"===t.courseDetails.graded},on:{onSubmit:t.submitStar,cancelModal:function(e){t.canShowWuhanModal=!1}}}):t._e()],1)}),[],!1,null,"b46a59ac",null).exports,Z=s(19499),x=s(12596),P={props:{classifyName:{type:String,default:""}},data:()=>({isOpen:!0}),computed:(0,a.Z)({},(0,o.mapGetters)({primaryColor:"getPrimaryColor"})),watch:{classifyName(t){t&&this.$nextTick((()=>{this.getClassifyHeight()}))}},mounted(){this.$nextTick((()=>{this.getClassifyHeight()}))},methods:{getClassifyHeight(){const{node:t}=this.$refs;if(t){const e=t.offsetHeight;this.isOpen=e<=22,this.$forceUpdate()}},changeOpen(){this.isOpen=!this.isOpen}}},D=(0,S.Z)(P,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"course-classify"},[s("div",{ref:"node",staticClass:"classify-name",class:t.isOpen?null:"open"},[t._v(t._s(t.$t("course.courseCategory"))+"："+t._s(t.classifyName))]),t.isOpen?t._e():s("div",{staticClass:"classify-btn",style:{color:t.primaryColor},on:{click:t.changeOpen}},[t._v(t._s(t.$t("attestation.open")))])])}),[],!1,null,"d87b390a",null).exports,L=s(99803),A=s(27098),E=(s(25773),s(35791)),R={components:{SvgIcon:I.Z,VanButton:E.Z},props:{courseSource:{type:String,default:""},courseDetails:{type:Object,default:function(){return{}}},courseInfo:{type:Object,default:function(){return{}}},isOutCourse:{type:Boolean,default:!1},approvalId:{type:String,default:""}},computed:(0,a.Z)({},(0,o.mapGetters)({primaryColor:"getPrimaryColor"})),methods:(0,a.Z)((0,a.Z)({},(0,o.mapActions)("course/enterprise",["changePraise"])),{},{handleApproval(t){this.$router.push({path:l.Z.course.courseApproval(),query:{type:t,operationId:this.approvalId}})},praise(){let t="";t="like"===this.courseDetails.likeStatus?"unlike":"like",this.changePraise({courseId:this.courseInfo.courseId,status:t})},async goToDDI(){const{courseId:t,planId:e,purchased:s}=this.courseInfo,a={courseId:t,isPreview:"false",isPersonPurchase:"true"===s?"true":"false",planId:e},{courseInfo:i}=this,o=await h.Z.getDDICourseUrl(a),{learningUrl:r}=o.data;l.Z.course.toDDI({learningUrl:r,courseInfo:i})}})},F=(0,S.Z)(R,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"course-action"},["approvalList"===t.courseSource?s("div",{staticClass:"approval"},[s("van-button",{attrs:{color:"#d64f4f",type:"primary",block:""},on:{click:function(e){return t.handleApproval("deny")}}},[t._v(" "+t._s(t.$t("course.reject"))+" ")]),s("van-button",{attrs:{color:t.primaryColor,type:"primary",block:""},on:{click:function(e){return t.handleApproval("pass")}}},[t._v(" "+t._s(t.$t("course.pass"))+" ")])],1):s("div",{staticClass:"course-action-more"},[s("div",{staticClass:"evaluate",on:{click:function(e){return t.$emit("scrollToComment")}}},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-talk",color:"#7F849A",size:18}}),t.courseDetails.commentCount>0?s("span",{staticClass:"num"},[t._v(t._s(t.courseDetails.commentCount))]):t._e()],1),s("div",{staticClass:"evaluate",class:t.isOutCourse?"praise-more":"",on:{click:t.praise}},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-zan",color:"like"===t.courseDetails.likeStatus?"#df6666":"#7F849A",size:21}}),t.courseDetails.likeCount>0?s("span",{staticClass:"num"},[t._v(t._s(t.courseDetails.likeCount))]):t._e()],1),s("div",{staticClass:"progress",class:t.isOutCourse?"progress-more":""},[s("span",{staticClass:"text"},[t._v(t._s(t.$t("attestation.progress"))+"：")]),s("span",[t._v(t._s(t.courseDetails.progress)+"%")])]),t.isOutCourse?s("van-button",{staticClass:"ddi-study-btn",attrs:{color:t.primaryColor,type:"primary",size:"mini"},on:{click:t.goToDDI}},[t._v(" "+t._s(t.$t("project.startStudy"))+" ")]):t._e()],1)])}),[],!1,null,"b98483d8",null).exports,q=s(60233),N=s(68728),O={name:"EnterpriseDetail",components:{[i.Z.name]:i.Z,CoursePlayer:y.Z,CourseInfo:T,CourseWare:Z.Z,CourseIntroduce:x.Z,CourseClassify:D,CourseComment:L.Z,CourseEnd:A.Z,CourseAction:F,MemberAuth:m.Z,ClShare:f.Z,ClResult:v.Z},props:[],data:function(){return{courseInfo:{},commentInfo:{list:[],total:0},currentPlay:-1,isDrag:!0,playingVideo:{},isPlayingVideo:!1,isFullScreen:!1,hasTipPreventHangModal:!1,csceTimeInterval:null,currentCSCECItem:{},currentSourceItem:null,learningTimer:null,batchNumber:"",ua:(0,d.ij)(),autoplay:!1,showShare:!1,defaultUserImg:g,isShowResult:!1,resultParams:{},loading:!0,shareFrom:N.VH}},computed:(0,a.Z)((0,a.Z)((0,a.Z)((0,a.Z)((0,a.Z)({},(0,o.mapState)("course/enterprise",["courseDetails","topThreeComment","totalComments"])),(0,o.mapState)("setting",["dragSwitch","preventHangSwitch"])),(0,o.mapState)(["commonParams"])),(0,o.mapGetters)({primaryColor:"getPrimaryColor",fresh:"microCourse/getFreshStatus"})),{},{isOutCourse(){return(0,u.ZG)(this.courseDetails.source)},draggable(){return this.playingVideo.progress>=100||this.isDrag}}),watch:{fresh(t){t&&(this.refresh(),this.$store.commit("microCourse/updateFresh",!1))}},mounted(){this.init()},beforeDestroy(){clearInterval(this.csceTimeInterval),clearInterval(this.learningTimer),this.learningTimer=null,this.currentPlay>-1&&this.$refs.coursePlayerRef&&this.$refs.coursePlayerRef.getCommonVideoPlayer().isPlaying&&this.recordLearningTime()},methods:(0,a.Z)((0,a.Z)((0,a.Z)({},(0,o.mapActions)("course/enterprise",["initCourseDetails"])),(0,o.mapActions)("course",["saveCoursewareProgress"])),{},{init(){const{query:t}=this.$route;this.courseInfo=t,this.isDrag=!this.dragSwitch,this.refresh()},refresh(){this.getCourseDetails(),this.initTopThreeComment()},async getCourseDetails(){try{await this.initCourseDetails({courseSource:this.courseInfo.courseResource,courseId:this.courseInfo.courseId,source:this.courseInfo.source||"course_center"}),this.loading=!1;const{title:t="",liveStatus:e}=this.courseDetails;(0,q.A)()&&(0,q.q)(t),this.initExtraData(),"remarking"===e&&this.$dialog.alert({title:this.$t("ddLive.courseTip"),showCancelButton:!1,confirmButtonText:this.$t("subsidy.gotIt"),message:this.$t("ddLive.courseTipContent")})}catch(t){this.loading=!1,this.isShowResult=!0,"enterpriseapi.4003"===t.data.code?this.resultParams={type:"403",title:this.$t("share.noPermission"),description:this.$t("share.noPermissionTip")}:"enterpriseapi.4001"===t.data.code?this.resultParams={type:"404",title:this.$t("course.resourceNotFound"),buttons:[{type:"text",text:this.$t("common.back"),callBack:()=>{this.$router.go(-1)}}]}:"enterpriseapi.503010"===t.data.code?this.resultParams={type:"404",title:this.$t("share.courseRemoved")}:this.resultParams={type:"error",title:this.$t("promptMessage.systemError"),description:t.data.message}}},initExtraData(){this.onCSCECUrlExpired(),this.courseInfo.approvalId||window.localStorage.setItem("showCourseDetail",JSON.stringify({courseTitle:this.courseDetails.title,courseId:this.courseDetails.id,courseCover:this.courseDetails.cover,courseSource:this.courseDetails.courseSource,enterpriseId:this.$store.state.commonParams.enterpriseId})),this.showPreventHangModal(),this.getEnterpriseDrag()},showPreventHangModal(){"true"===this.courseDetails.includeAudio&&this.preventHangSwitch&&!this.hasTipPreventHangModal&&(this.hasTipPreventHangModal=!0,this.$dialog.alert({title:this.$t("promptMessage.warmTips"),showCancelButton:!1,confirmButtonText:this.$t("promptMessage.roger"),confirmButtonColor:this.primaryColor,message:this.$t("promptMessage.preventHangTips")}))},async handleSaveProgress({currentTime:t,progress:e,id:s,requestId:a}){await this.saveCoursewareProgress({data:{id:s,recentStart:t||this.currentSourceItem.recentStart,progress:e||this.currentSourceItem.progress,courseId:this.courseInfo.courseId,resourceId:s,progressType:"enterprise"},requestId:a,courseResource:"enterprise"})},onFullscreenChange(t){this.isFullScreen=t},async playing({index:t}){if(this.learningTimer&&(clearInterval(this.learningTimer),this.learningTimer=null,this.currentPlay>-1&&this.$refs.coursePlayerRef&&this.$refs.coursePlayerRef.getCommonVideoPlayer().isPlaying&&this.recordLearningTime()),this.isOutCourse)return;let e=!1;if(this.courseDetails.resources.length>1&&t<this.courseDetails.resources.length-1){const s=this.courseDetails.resources[t+1];e="mp4"===s.type||"mp3"===s.type,this.nextResourceIndex=t+1}if(this.currentSourceItem=this.courseDetails.resources[t],this.currentSourceItem.contentType.includes("video")&&this.currentSourceItem.isInteract&&100!==this.currentSourceItem.progress)return void this.$router.push({path:"course-interactive-view",query:{courseId:this.courseInfo.courseId,resourceId:this.currentSourceItem.id}});const s=this.currentSourceItem.maxProgress||{};this.currentSourceItem=(0,a.Z)((0,a.Z)({},this.currentSourceItem),s),await h.Z.enterprise.addPlayCount({courseId:this.courseInfo.courseId}),"false"!==this.currentSourceItem.play?"ZHONG_JIAN"!==this.courseDetails.source||"mp4"!==this.currentSourceItem.type?"mp4"!==this.currentSourceItem.type||"true"!==this.courseDetails.existAiResource?this.onCourseTypeHandle(t,e):this.$router.push({path:"/watch-video",query:{courseResource:this.courseInfo.courseResource,courseId:this.courseInfo.courseId,resourceId:this.currentSourceItem.id,id:this.courseInfo.courseId,progressType:"enterprise",url:this.currentSourceItem.url,recentStart:this.currentSourceItem.recentStart,duration:this.currentSourceItem.duration,progress:this.currentSourceItem.progress,videoId:this.currentSourceItem.videoId,storageType:this.currentSourceItem.storageType,cover:this.currentSourceItem.cover,path:this.currentSourceItem.path}}):this.getCSCECCourseFun(t):this.$toast(this.$t("promptMessage.transcode"))},async onCourseTypeHandle(t,e=!1){const s=this.currentSourceItem.type,i=this.currentSourceItem.contentType,o={isSaveProgress:!0,progressType:"enterprise",resourceId:this.currentSourceItem.id,courseId:this.courseInfo.courseId,studyId:this.courseInfo.studyId,title:this.currentSourceItem.title,storageType:this.currentSourceItem.storageType,videoId:this.currentSourceItem.videoId,url:this.currentSourceItem.url,studyTime:this.currentSourceItem.recentStart,type:this.currentSourceItem.type,from:"course"};switch(s){case"mp4":case"mp3":let s="";if("ALIBABA_PRIVATE"===this.currentSourceItem.storageType){const{data:t}=await h.Z.privateVodDownloadUrl({videoId:this.currentSourceItem.videoId});0===t.code&&(s=t.data.videoPlayInfo)}this.currentPlay=t,this.playingVideo={id:this.currentSourceItem.id,url:"ALIBABA_PRIVATE"===this.currentSourceItem.storageType?s:this.currentSourceItem.url,recentStart:this.currentSourceItem.recentStart,duration:this.currentSourceItem.duration,progress:this.currentSourceItem.progress,storageType:this.currentSourceItem.storageType,videoId:this.currentSourceItem.videoId,contentType:this.currentSourceItem.contentType,isMediaNext:e},this.isPlayingVideo=!0,this.$nextTick((()=>{this.$refs.coursePlayerRef.play(),this.handleSaveProgress({currentTime:this.currentSourceItem.recentStart,progress:this.currentSourceItem.progress,id:this.currentSourceItem.id,requestId:(0,r.Z)()})}));break;case"scorm":l.Z.course.toCourseReader((0,a.Z)((0,a.Z)({},o),{},{readerType:"scorm"}));break;case"link":l.Z.course.toCourseReader((0,a.Z)((0,a.Z)({},o),{},{readerType:"html"}));break;case"article":"true"===this.currentSourceItem.linkSwitch&&this.currentSourceItem.url?(0,c.N8)({url:this.currentSourceItem.url}):l.Z.course.toCourseReader((0,a.Z)((0,a.Z)({},o),{},{readerType:"article",isSaveRecord:!0}));break;default:switch(i){case"html":l.Z.course.toCourseReader((0,a.Z)((0,a.Z)({},o),{},{readerType:"html"}));break;case"picture":l.Z.course.toCourseReader((0,a.Z)((0,a.Z)({},o),{},{readerType:"image",showWatermark:!0}));break;default:l.Z.course.toCourseReader((0,a.Z)((0,a.Z)({},o),{},{path:this.currentSourceItem.path,url:encodeURIComponent(this.currentSourceItem.url),progress:this.currentSourceItem.progress,studyTimeLimit:this.currentSourceItem.studyTimeLimit,readerType:"doc"}))}}},async getEnterpriseDrag(){try{const t=await h.Z.enterprise.queryEnterpriseVideoDrag();if(0===t.code){const{enterpriseId:e}=this.commonParams;t.data.indexOf(e)>-1&&(this.isDrag=!0)}}catch(t){console.error(t)}},toCourseTest({hasAnswered:t,resourceId:e}){const{courseInfo:s}=this,{courseResource:a,hotIndex:i,originType:o,courseId:r}=s,n=t?"courseTestParse":"courseTest";l.Z.course[n]({type:a,hotIndex:i,originType:o,courseId:r,resourceId:e})},async initTopThreeComment(){try{let t=await h.Z.enterprise.getEnterpriseCourseCommentList({courseId:this.courseInfo.courseId,pageNumber:1,pageSize:3});this.commentInfo={list:t.data.list,total:t.data.total}}catch(t){console.error(t)}},scrollToComment(){this.$refs.myCourseComment.$el.scrollIntoView({behavior:"smooth"})},async submitComment(t){try{let e=await h.Z.enterprise.enterpriseCourseCommentSubmit({courseId:this.courseInfo.courseId,comment:t});const s=this.commentInfo.list.length;s>=3&&this.commentInfo.list.splice(s-1,1);const i=(0,a.Z)((0,a.Z)({},e.data),{},{syncSourceType:e.data.sync_source_type,syncUserId:e.data.sync_user_id||""});this.commentInfo.list.unshift(i),this.commentInfo.total=1+this.commentInfo.total,this.courseDetails.commentCount=1+this.courseDetails.commentCount,this.$toast.success(this.$t("promptMessage.sendSuccessfully"))}catch(t){this.$toast.fail(this.$t("promptMessage.sendFailed"))}},onCSCECUrlExpired(){"ZHONG_JIAN"===this.courseDetails.source&&(this.csceTimeInterval=setInterval((()=>{new Date>new Date(this.currentCSCECItem.expireTime)&&this.onCSCECPlay()}),1e3))},onEnded(){this.learningTimer&&(clearInterval(this.learningTimer),this.learningTimer=null),this.recordLearningTime()},handlePlayerPause({currentTime:t,progress:e,id:s,requestId:a}){this.handleSaveProgress({currentTime:t,progress:e,id:s,requestId:a}),this.learningTimer&&(clearInterval(this.learningTimer),this.learningTimer=null),this.recordLearningTime()},onCSCECPlayFunc(){const{courseDetails:t,currentCSCECItem:e}=this;if("ZHONG_JIAN"===t.source&&new Date>new Date(e.expireTime)&&this.onCSCECPlay(),!this.learningTimer){this.batchNumber=(0,r.Z)(),this.recordLearningTime();const t=this;clearInterval(t.learningTimer),t.learningTimer=setInterval((()=>{t.recordLearningTime()}),n.If)}},async onCSCECPlay(){let t={courseSource:this.courseInfo.courseResource,courseId:this.courseInfo.courseId,source:this.courseInfo.source||"course_center",self:this};await this.initCourseDetails(t);let e=this.courseDetails.resources[this.currentPlay];const s=await h.Z.getCSCECCourse({courseId:this.courseInfo.courseId,thirdResourceId:e.videoId}),{learningUrl:i,expireTime:o}=s.data;e=(0,a.Z)((0,a.Z)({},e),{},{url:i,expireTime:o}),setTimeout((()=>{this.isPlayingVideo=!0,this.playingVideo={id:e.id,url:i,recentStart:e.recentStart,duration:e.duration,progress:e.progress,contentType:e.contentType},this.currentCSCECItem=e,this.$nextTick((()=>{this.$refs.coursePlayerRef.initPlayer()}))}),100)},async getCSCECCourseFun(t){const e=this.currentSourceItem;let s={};if(e.url&&100!==e.progress)setTimeout((()=>{this.currentCSCECItem=s,this.currentPlay=t,this.isPlayingVideo=!0,this.playingVideo={id:s.id,url:s.url,recentStart:s.recentStart,duration:s.duration,progress:s.progress,contentType:s.contentType}}),100);else{const i=await h.Z.getCSCECCourse({courseId:this.courseInfo.courseId,thirdResourceId:e.videoId}),{learningUrl:o,expireTime:r}=i.data;s=(0,a.Z)((0,a.Z)({},e),{},{url:o,expireTime:r}),setTimeout((()=>{this.currentCSCECItem=s,this.currentPlay=t,this.isPlayingVideo=!0,this.playingVideo={id:s.id,url:s.url,recentStart:s.recentStart,duration:s.duration,progress:s.progress,contentType:s.contentType}}),100)}},onNextPlayCourseware(){this.playing({index:this.nextResourceIndex})},async recordLearningTime(){const t={courseId:this.courseInfo.courseId,resourceId:this.playingVideo.id},e={batchNumber:this.batchNumber};try{await p.Z.postClassHourTiming("enterprise",t,e)}catch(t){console.warn(t)}},onShowShare(){this.showShare=!0},onCloseShareSheet(){this.showShare=!1}})},M=(0,S.Z)(O,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"cl-page-container enterprise_course_details_container"},[t.loading?s("van-loading",{staticClass:"cl-page-container-loading",attrs:{size:"36"}}):[t.isShowResult?s("cl-result",{attrs:{title:t.resultParams.title,description:t.resultParams.description,buttons:t.resultParams.buttons}}):[s("MemberAuth"),s("div",{staticClass:"course_details_container",class:{"full-screen":t.isFullScreen}},[s("course-player",{ref:"coursePlayerRef",attrs:{"enter-type":"project",cover:t.courseDetails.cover,autoplay:t.autoplay,"playing-video":t.playingVideo,"is-playing-video":t.isPlayingVideo,"course-info":t.courseInfo,"prevent-hang-flag":t.preventHangSwitch,"show-random-window":!1,draggable:t.draggable,"is-share":!0},on:{onPause:t.handlePlayerPause,onTimerEvent:t.handleSaveProgress,onFullscreenChange:t.onFullscreenChange,onCSCECPlay:t.onCSCECPlayFunc,onNextPlayCourseware:t.onNextPlayCourseware,onEnded:t.onEnded,onShowShare:t.onShowShare}}),s("course-info",{attrs:{"course-id":t.courseInfo.courseId,"course-details":t.courseDetails},on:{getCourseDetails:t.getCourseDetails}}),"true"===t.courseDetails.syncProgress?s("div",{staticClass:"sync-tip"},[t._v(t._s(t.$t("common.openSync")))]):t._e(),"approvalList"===t.courseInfo.courseResource&&t.courseDetails.classifyName?s("course-classify",{attrs:{"classify-name":t.courseDetails.classifyName}}):t._e(),s("div",{staticClass:"courseware-list"},[s("div",{staticClass:"title"},[t._v(" "+t._s(t.$t("course.courseCatalog"))+" "),"onlyOne"===t.courseDetails.finishStandardStr?s("span",{staticClass:"finish-only",style:{}},[s("SvgIcon",{attrs:{"icon-class":"icon-tips",color:"#D5D8DE",size:14}}),t._v(t._s(t.$t("course.finishStandard")))],1):t._e()]),s("course-ware",{attrs:{resources:t.courseDetails.resources,"is-free":t.courseDetails.free,"show-status":t.courseDetails.showStatus,"is-out-course":t.isOutCourse,"current-play":t.currentPlay,download:t.courseDetails.download},on:{onCourseTest:t.toCourseTest,onPlayResource:t.playing}})],1),s("course-introduce",{attrs:{introduction:t.courseDetails.introduction,summary:t.courseDetails.summary,"biz-type":t.courseDetails.bizType}}),s("course-comment",{ref:"myCourseComment",attrs:{"comment-info":t.commentInfo,"comment-switch":t.courseDetails.commentSwitch,"course-id":t.courseInfo.courseId,"course-source":t.courseInfo.courseResource,"submit-comment":t.submitComment}}),s("course-end"),s("course-action",{attrs:{"course-source":t.courseInfo.courseResource,"approval-id":t.courseInfo.approvalId,"course-details":t.courseDetails,"course-info":t.courseInfo,"is-out-course":t.isOutCourse},on:{scrollToComment:t.scrollToComment}}),s("cl-share",{attrs:{from:t.shareFrom,show:t.showShare,"share-params":{pc_url:"/course/enterpriseCourse?courseId="+t.courseInfo.courseId,mobile_url:"/course-enterprise-detail?courseResource="+t.courseInfo.courseResource+"&courseId="+t.courseInfo.courseId+"&originType="+(t.courseInfo.source||"course_center"),pc_type:"student",mobile_type:"h5",is_auth_enterprise:!0},title:t.courseDetails.title,site1:{type:"resource_count",label:t.$t("course.courseware"),value:t.courseDetails.resourceCount},lecturer:t.courseDetails.lecturer?{avatar:t.courseDetails.lecturer.avatar||t.defaultUserImg,name:t.courseDetails.lecturer.lecturerName,id:t.courseDetails.lecturer.id,source_type:t.courseDetails.lecturer.teacherSyncSourceType}:{},"image-url":t.courseDetails.cover,isShareMsg:!0},on:{closeShareSheet:t.onCloseShareSheet}})],1)]]],2)}),[],!1,null,"797ad8ab",null).exports},72245:(t,e,s)=>{s.r(e),s.d(e,{default:()=>Z});var a=s(95082),i=(s(3791),s(93432)),o=(s(30541),s(26294)),r={components:{},props:{info:{type:Object,default:function(){return{title:"",createTime:""}}},countAccessRecord:{type:Number,default:0}},computed:(0,a.Z)({},(0,o.mapGetters)({primaryColor:"getPrimaryColor"}))},n=s(1001),c=(0,n.Z)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"course-info"},[s("div",{staticClass:"title"},[t._v(t._s(t.info.title))]),s("div",{staticClass:"subTitle"},[s("span",{staticClass:"time"},[t._v(t._s(t.info.createTime))]),s("span",{staticClass:"user"},[t._v(" "+t._s(t.countAccessRecord)+" "+t._s(t.$t("course.scan"))+" ")])]),"true"===t.info.syncProgress?s("div",{staticClass:"sync-progress"},[t._v(t._s(t.$t("common.openSync")))]):t._e()])}),[],!1,null,"2a9c8d44",null).exports,l=s(24357),u=s(25295),d=s(56955),h=s(94864),p=s(39819),m=s(99803),g=s(77522),v=s(62501),f=(s(23307),s(81392)),y={components:{SvgIcon:s(78551).Z,[f.Z.name]:f.Z},props:{courseDetails:{type:Object,default:function(){return{}}},commentInfo:{type:Object,default:function(){return{}}},courseInfo:{type:Object,default:function(){return{}}},isShare:{type:Boolean,default:!1}},computed:(0,a.Z)({},(0,o.mapGetters)({primaryColor:"getPrimaryColor"})),methods:(0,a.Z)((0,a.Z)({},(0,o.mapActions)("course/imageText",["changePraise"])),{},{praise(){let t="";t="like"===this.courseDetails.likeStatus?"unlike":"like",this.changePraise({courseId:this.courseInfo.courseId,status:t})}})},_=(0,n.Z)(y,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"course-action"},[s("div",{staticClass:"course-action-more"},[s("div",{staticClass:"evaluate",on:{click:function(e){return t.$emit("scrollToComment")}}},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-talk",color:"#7F849A",size:18}}),t.commentInfo.total>0?s("span",{staticClass:"num"},[t._v(t._s(t.commentInfo.total))]):t._e()],1),s("div",{staticClass:"evaluate",on:{click:t.praise}},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-zan",color:"like"===t.courseDetails.likeStatus?"#df6666":"#7F849A",size:21}}),t.courseDetails.likeCount>0?s("span",{staticClass:"num"},[t._v(t._s(t.courseDetails.likeCount))]):t._e()],1),t.isShare?s("div",{staticClass:"evaluate",on:{click:function(e){return t.$emit("onShowShare")}}},[s("van-icon",{staticClass:"iconfont",attrs:{name:"share",color:"#7F849A",size:21}})],1):t._e()])])}),[],!1,null,"60eaf295",null).exports,C=s(27098),I=s(78368),b=s(68728),w=s(71522);const $="study",k="project",S=({type:t,planId:e,courseId:s,planType:a,resourceId:i,isInterval:o=!1})=>w.Z.saveStudyRecords(t,e,s,a,i).then((()=>{let r=null;return o&&(r=setInterval((()=>{w.Z.saveStudyRecords(t,e,s,a,i).then((()=>{})).catch((t=>{console.error(t)}))}),3e4)),r})).catch((()=>{let r=null;return o&&(r=setInterval((()=>{w.Z.saveStudyRecords(t,e,s,a,i).then((()=>{})).catch((t=>{console.error(t)}))}),3e4)),r}));var T={name:"ImageTextDetail",components:{[i.Z.name]:i.Z,CourseInfo:c,ClWaterMark:l.Z,BraftEditPreview:p.Z,CourseComment:m.Z,ClResult:g.Z,ClShare:v.Z,CourseEnd:C.Z,CourseAction:_},data:()=>({fullLoading:!0,countAccessRecord:0,commentInfo:{list:[],total:0},courseInfo:{},showShare:!1,defaultUserImg:I,isShare:!1,isShowResult:!1,resultParams:{},shareFrom:b.If}),computed:(0,a.Z)((0,a.Z)({},(0,o.mapState)("course/imageText",["courseDetails"])),(0,o.mapGetters)({fresh:"microCourse/getFreshStatus"})),watch:{fresh(t){t&&(this.refresh(),this.$store.commit("microCourse/updateFresh",!1))}},mounted(){this.init()},beforeDestroy(){const{planId:t,courseId:e,planType:s,resourceId:a}=this.courseInfo;s!==$&&s!==k||S({resourceId:a,planId:t,courseId:e,type:"stop",planType:s,isInterval:!1}),clearInterval(this.timerId)},methods:(0,a.Z)((0,a.Z)({},(0,o.mapActions)("course/imageText",["initCourseDetails"])),{},{init(){const{query:t}=this.$route;this.courseInfo=t;const{resourceId:e,isSaveRecord:s}=t;this.isShare=!t.studyType,this.refresh(),"true"===s&&this.handleSaveStudyRecord(),this.handleSaveProgress(),this.addAccessRecord(e)},refresh(){this.getArticleDetail(),this.initTopThreeComment()},async getArticleDetail(){try{await this.initCourseDetails({courseId:this.courseInfo.courseId,resourceId:this.courseInfo.resourceId,studyId:this.courseInfo.studyId,studyType:this.courseInfo.studyType}),this.fullLoading=!1}catch(t){this.fullLoading=!1;const{code:e}=t.data;switch(e){case"enterpriseapi.4003":this.resultParams={type:"403",title:this.$t("share.noPermission"),description:this.$t("share.noPermissionTip")};break;case"enterpriseapi.4001":this.resultParams={type:"404",title:this.$t("course.resourceNotFound")};break;case"enterpriseapi.503010":this.resultParams={type:"404",title:this.$t("share.courseRemoved")};break;default:this.resultParams={type:"error",description:this.$t("promptMessage.systemError")}}this.isShowResult=!0}},handleSaveStudyRecord(){const{resourceId:t,planId:e,courseId:s,planType:a}=this.courseInfo;a!==$&&a!==k||S({planId:e,courseId:s,resourceId:t,type:$,planType:a,isInterval:!0}).then((t=>{this.timerId=t}))},async handleSaveProgress(){const{studyId:t,courseId:e,resourceId:s,progressType:a,progress:i,isSaveProgress:o,mapId:r}=this.courseInfo;if("true"!==o)return;const n={studyId:t,courseId:e,resourceId:s,mapId:r},c={progress:i?Number(i):100};await d.Z.saveProgress(a,n,c,null,!0)},async initTopThreeComment(){try{let t=await h.Z.enterprise.getEnterpriseCourseCommentList({courseId:this.courseInfo.courseId,pageNumber:1,pageSize:3});this.commentInfo={list:t.data.list,total:t.data.total}}catch(t){console.error(t)}},scrollToComment(){this.$refs.myCourseComment.$el.scrollIntoView({behavior:"smooth"})},async submitComment(t){try{let e=await h.Z.enterprise.enterpriseCourseCommentSubmit({courseId:this.courseInfo.courseId,comment:t});const s=this.commentInfo.list.length;s>=3&&this.commentInfo.list.splice(s-1,1);const i=(0,a.Z)((0,a.Z)({},e.data),{},{syncSourceType:e.data.sync_source_type,syncUserId:e.data.sync_user_id||""});this.commentInfo.list.unshift(i),this.commentInfo.total=1+this.commentInfo.total,this.courseDetails.commentCount=1+this.courseDetails.commentCount,this.$toast.success(this.$t("promptMessage.sendSuccessfully"))}catch(t){this.$toast.fail(this.$t("promptMessage.sendFailed"))}},async addAccessRecord(t){const e=await u.Z.addAccessRecord(t);this.countAccessRecord=e.data.data},onShowShare(){this.showShare=!0},onCloseShareSheet(){this.showShare=!1}})},Z=(0,n.Z)(T,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"cl-page-container image-text-detail"},[t.fullLoading?s("van-loading",{staticClass:"image-text-detail-loading"}):[t.isShowResult?s("cl-result",{attrs:{title:t.resultParams.title,description:t.resultParams.description,buttons:t.resultParams.buttons}}):[s("course-info",{attrs:{info:t.courseDetails,"count-access-record":t.countAccessRecord}}),s("div",{staticClass:"image-text-braft-container"},[s("BraftEditPreview",{attrs:{data:t.courseDetails.content}})],1),s("course-comment",{ref:"myCourseComment",attrs:{"comment-info":t.commentInfo,"comment-switch":t.courseDetails.commentSwitch,"course-id":t.courseInfo.courseId,"course-source":t.courseDetails.courseSource,"submit-comment":t.submitComment}}),s("course-end"),s("course-action",{attrs:{"comment-info":t.commentInfo,"course-details":t.courseDetails,"course-info":t.courseInfo,"is-share":t.isShare},on:{onShowShare:t.onShowShare,scrollToComment:t.scrollToComment}}),s("cl-share",{attrs:{show:t.showShare,"share-params":{pc_url:"course/watch?courseId="+t.courseInfo.courseId+"&exitAiUpdate=false&source=enterprise&courseType=imageText&courseName=",mobile_url:"/business-transit?businessType=graphicLesson&params="+encodeURIComponent("courseId="+t.courseInfo.courseId),pc_type:"student",mobile_type:"h5",is_auth_enterprise:!0},from:t.shareFrom,"is-share-msg":t.isShare,title:t.courseDetails.title,lecturer:t.courseDetails.lecturer?{avatar:t.courseDetails.lecturer.avatar||t.defaultUserImg,name:t.courseDetails.lecturer.lecturerName,id:t.courseDetails.lecturer.id,source_type:t.courseDetails.lecturer.lecturerSourceType}:{},"image-url":t.courseDetails.cover},on:{closeShareSheet:t.onCloseShareSheet}})]],s("cl-water-mark",{attrs:{scenes:"image"}})],2)}),[],!1,null,"23db1412",null).exports},36245:(t,e,s)=>{s.r(e),s.d(e,{default:()=>D});var a=s(95082),i=(s(3791),s(93432)),o=(s(38862),s(30541),s(25934)),r=s(26294),n=s(94864),c=s(7294),l=s(95969),u=s(22648),d=s(78368),h=s(77522),p=s(62501),m=s(67185),g=(s(47601),s(44951)),v=(s(91058),s(39714),{components:{VanImage:g.Z},props:{courseDetails:{type:Object,default:function(){return{awardScore:0,free:"",learners:null,officialPrice:"",preferentialPrice:"",resourceCount:"",showScore:"",teacherAvatar:"",teacherName:"",title:"",validity:""}}}},data:function(){return{defaultUserImg:d,equitiesTags:[]}},computed:(0,a.Z)((0,a.Z)({},(0,r.mapGetters)({primaryColor:"getPrimaryColor"})),{},{intPrice(){return parseInt(this.courseDetails.preferentialPrice/100)},decimalPrice(){let t=this.courseDetails.preferentialPrice%100;return t<10&&(t=`0${t}`),t},officialPrice(){const{integer:t,decimal:e}=(0,u.T4)(this.courseDetails.officialPrice);return`${t}.${e}`},limitCopiesTips(){return this.courseDetails.quantity&&this.courseDetails.quantity>-1?this.$t("course.limitCopies",{quantity:this.courseDetails.quantity.toString()}):this.$t("pointsMall.unlimited")}}),mounted(){this.getEquitiesTags()},methods:{getEquitiesTags(){let{equitiesTags:t,isEquitiesCourse:e}=this.courseDetails,s=[];!e&&"string"==typeof t&&t.length>0&&(s=t.split(",").map(((t,e)=>({name:t,id:e})))),s.forEach((t=>{t.backgroundStyle="平台版"===t?"#FF7C7C linear-gradient(153deg,#9B8BF8 0%,#7E66F8 100%)":"领航版"===t?"#D8D8D8 linear-gradient(159deg,#56588E 0%,#1A1D3B 100%)":"linear-gradient(330deg,#4278FF 0%,#76A0FF 100%)"})),this.equitiesTags=s}}}),f=s(1001),y=(0,f.Z)(v,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"course-info"},[s("div",{staticClass:"title"},["true"===t.courseDetails.showScore?s("span",{staticClass:"awardScore"},[t._v(" "+t._s(t.courseDetails.awardScore)+t._s(t.$t("pointsMall.credits"))+" ")]):t._e(),t._v(" "+t._s(t.courseDetails.title)+" ")]),s("div",{staticClass:"pay"},[s("div",{staticClass:"price"},[t.courseDetails.isEquitiesCourse?s("div",{staticStyle:{display:"flex","align-items":"baseline"}},[s("span",{staticClass:"equities-course van-ellipsis"},[t._v(t._s(t.courseDetails.equitiesName))]),s("span",{staticClass:"equities-dollar"},[t._v("￥")]),t._m(0),s("span",{staticClass:"real"},[t._v("￥"+t._s(t.officialPrice))])]):"true"!==t.courseDetails.free?[s("span",{staticClass:"dollar"},[t._v("￥")]),s("div",{staticClass:"discount"},[s("span",[t._v(t._s(t.intPrice))]),s("span",{staticClass:"twoDecimal"},[t._v("."+t._s(t.decimalPrice))])]),s("span",{staticClass:"real"},[t._v("￥"+t._s(t.officialPrice))])]:s("div",{staticClass:"discount forFree"},[t._v(t._s(t.$t("course.free")))])],2),s("span",{staticClass:"indate"},[t._v(t._s("true"!==t.courseDetails.free?t.$t("course.validPeriod",{period:t.courseDetails.validity}):t.$t("course.permanent")))])]),s("div",{staticClass:"free"},[t.courseDetails.isEquitiesCourse?[s("span",{staticClass:"courseware-count"},[t._v(t._s(t.$t("course.copies"))+":"+t._s(t.limitCopiesTips))]),s("span",{staticClass:"courseware-count"},[t._v(t._s(t.$t("course.courseware"))+" "+t._s(t.courseDetails.resourceCount))]),s("span",{staticClass:"studying"},[t._v(t._s(t.$t("course.scanCount",{scanCount:t.courseDetails.scanCount})))])]:[""!==t.courseDetails.teacherName?s("div",{staticClass:"name"},[s("van-image",{staticClass:"avatar",attrs:{fit:"fill",src:t.courseDetails.teacherAvatar||t.defaultUserImg}}),s("div",{staticClass:"teacher"},[t._v(t._s(t.courseDetails.teacherName))])],1):t._e(),s("span",{staticClass:"courseware-count"},[t._v(t._s(t.$t("course.courseware"))+" "+t._s(t.courseDetails.resourceCount))]),s("span",{staticClass:"studying"},[t._v(t._s(t.$t("course.scanCount",{scanCount:t.courseDetails.scanCount})))])]],2),t.equitiesTags.length>0?s("div",{staticClass:"tag-container"},t._l(t.equitiesTags,(function(e){return s("div",{key:e.id,staticClass:"tag",style:{background:e.backgroundStyle}},[t._v(" "+t._s(e.name)+" ")])})),0):t._e()])}),[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"discount"},[s("span",[t._v("0")]),s("span",{staticClass:"twoDecimal"},[t._v(".00")])])}],!1,null,"2840f504",null).exports,_=s(19499),C=s(12596),I=s(99803),b=s(27098),w=(s(31146),s(41610)),$=(s(25773),s(35791)),k=s(27632),S=s(26513),T={components:{SvgIcon:s(78551).Z,VanButton:$.Z},props:{courseSource:{type:String,default:""},courseDetails:{type:Object,default:function(){return{}}},courseInfo:{type:Object,default:function(){return{}}},isOutCourse:{type:Boolean,default:!1},approvalId:{type:String,default:""}},data:()=>({ua:(0,u.ij)()}),computed:(0,a.Z)({},(0,r.mapGetters)({primaryColor:"getPrimaryColor"})),methods:(0,a.Z)((0,a.Z)({},(0,r.mapActions)("course/platform",["initCourseDetails","changePraise"])),{},{praise(){let t="";t="like"===this.courseDetails.likeStatus?"unlike":"like",this.changePraise({courseId:this.courseInfo.courseId,status:t})},async goToDDI(){const{courseId:t,planId:e,purchased:s}=this.courseInfo,a={courseId:t,planId:e,isPreview:"buyed"===this.courseDetails.showStatus?"false":"true",isPersonPurchase:"true"===s?"true":"false"},{courseInfo:i}=this,o=await n.Z.getDDICourseUrl(a),{learningUrl:r}=o.data;l.Z.course.toDDI({learningUrl:r,courseInfo:i})},contactService(){if("dingTalk"===k.Z.env){const t="https://h5.dingtalk.com/appcenter/detail.html?showmenu=false&dd_share=false&articleCode=FW_GOODS-1000651011&goodsCode=FW_GOODS-1000651011";k.Z.openLink({url:t})}else this.$dialog({title:this.$t("promptMessage.warmTips"),message:this.$t("discovery.updateMessage"),confirmButtonText:this.$t("promptMessage.roger"),confirmButtonColor:this.$store.state.themeColor.primaryColor})},coursesAddLibrary(){n.Z.platform.addCoursesLibrary({courseId:this.courseInfo.courseId}).then((()=>{const t={courseSource:"platform",courseId:this.courseInfo.courseId};this.initCourseDetails(t),this.$toast({type:"success",message:this.$t("promptMessage.successfullyAddEnterprise"),duration:3e3})})).catch((t=>{console.error(t)}))},handleAddToEnterpriseLibrary(){const t=this.$t("course.settingCourseHintText",{name:this.courseDetails.title});w.Z.confirm({message:t,confirmButtonText:this.$t("community.confirm"),cancelButtonText:this.$t("common.cancel"),confirmButtonColor:this.primaryColor}).then((()=>{this.courseDetails.isEquitiesCourse&&this.AddToEnterpriseLibrary(this.courseInfo.courseId)})).catch((()=>{}))},AddToEnterpriseLibrary(t){let e={import_type:"select",resource_id_list:[t]};S.Z.AddToEnterpriseLibrary(e).then((t=>{if("true"===t.data.success){const t={courseSource:"platform",courseId:this.courseInfo.courseId};setTimeout((()=>{this.initCourseDetails(t)}),3e3),this.$toast({type:"success",message:this.$t("common.operateSuccess"),duration:3e3})}else this.$toast({message:this.$t("common.operateErrorWithRepeat")})}))}})},Z=(0,f.Z)(T,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"course-action"},[s("div",{staticClass:"course-action-bar"},["true"===t.courseDetails.likeComment?[s("div",{staticClass:"evaluate",on:{click:function(e){return t.$emit("scrollToComment")}}},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-talk",color:"#7F849A",size:18}}),t.courseDetails.commentCount>0?s("span",{staticClass:"num"},[t._v(t._s(t.courseDetails.commentCount))]):t._e()],1),s("div",{staticClass:"evaluate praise",on:{click:t.praise}},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-zan",color:"like"===t.courseDetails.likeStatus?"#df6666":"#7F849A",size:21}}),t.courseDetails.likeCount>0?s("span",{staticClass:"num"},[t._v(t._s(t.courseDetails.likeCount))]):t._e()],1),""!==t.courseDetails.showStatus?s("div",{staticClass:"show-status"},[s("svg-icon",{attrs:{"icon-class":"icon-done",color:"#b7bac8",size:14}}),"already_add_enterprise"===t.courseDetails.showStatus?s("span",{staticClass:"status-text"},[t._v(t._s(t.$t("course.coursesAdded")))]):t._e(),"buyed"===t.courseDetails.showStatus?s("span",{staticClass:"status-text"},[t._v(t._s(t.$t("course.purchased")))]):t._e()],1):t._e(),t.isOutCourse?s("van-button",{staticClass:"ddi-study-btn",attrs:{color:t.primaryColor,type:"primary",size:"mini"},on:{click:t.goToDDI}},["buyed"===t.courseDetails.showStatus?s("span",[t._v(t._s(t.$t("project.startStudy")))]):t._e(),t.courseDetails.isPreview?s("span",[t._v(t._s(t.$t("discovery.tryToLearn")))]):t._e()]):t._e()]:t.courseDetails.isEquitiesCourse?[t.courseDetails.enterpriseBought?s("div",{staticClass:"enterpriseBought-button"},[t._v(" "+t._s(t.$t("course.enterpriseBought"))+" ")]):s("van-button",{staticClass:"upgrade-button",attrs:{block:"",color:t.primaryColor},on:{click:t.handleAddToEnterpriseLibrary}},[t._v(" "+t._s(t.$t("course.settingCourseFree"))+" ")])]:"false"===t.courseDetails.free&&"buy"===t.courseDetails.showStatus?s("van-button",{style:{backgroundColor:t.primaryColor,borderColor:t.primaryColor},attrs:{type:"primary",block:""},on:{click:t.contactService}},[t._v(" "+t._s(t.$t("course.upgradeVersion"))+" ")]):"true"===t.courseDetails.free&&"add_enterprise"===t.courseDetails.showStatus?s("van-button",{style:{backgroundColor:t.primaryColor,borderColor:t.primaryColor},attrs:{type:"primary",block:""},on:{click:t.coursesAddLibrary}},[t._v(" "+t._s(t.$t("course.addToCourseLibrary"))+" ")]):t._e()],2)])}),[],!1,null,"066d0cd4",null).exports,x=s(68728),P={name:"PlatformDetail",components:{[i.Z.name]:i.Z,CoursePlayer:m.Z,CourseInfo:y,CourseWare:_.Z,CourseIntroduce:C.Z,CourseComment:I.Z,CourseEnd:b.Z,CourseAction:Z,ClShare:p.Z,ClResult:h.Z},data:()=>({courseInfo:{},commentInfo:{list:[],total:0},currentPlay:-1,hasTest:"",publishCommentUrl:"",playId:"",introduction:{},playingVideo:{},isPlayingVideo:!1,pausePlay:!1,isFullScreen:!1,csceTimeInterval:null,currentCSCECItem:{},currentSourceItem:null,showShare:!1,defaultUserImg:d,isShowResult:!1,resultParams:{},loading:!0,shareFrom:x.VH}),computed:(0,a.Z)((0,a.Z)((0,a.Z)((0,a.Z)({},(0,r.mapState)("course/platform",["courseDetails","topThreeComment","totalComments"])),(0,r.mapState)(["commonParams"])),(0,r.mapGetters)({primaryColor:"getPrimaryColor",fresh:"microCourse/getFreshStatus"})),{},{isOutCourse(){return(0,c.ZG)(this.courseDetails.source)},autoplay:()=>"ios"!==(0,u.Os)()}),watch:{fresh(t){t&&(this.refresh(),this.$store.commit("microCourse/updateFresh",!1))}},mounted(){this.init()},beforeDestroy(){clearInterval(this.csceTimeInterval)},methods:(0,a.Z)((0,a.Z)((0,a.Z)({},(0,r.mapActions)("course/platform",["initCourseDetails"])),(0,r.mapActions)("course",["saveCoursewareProgress"])),{},{init(){this.courseInfo=this.$route.query,this.isDrag=!0,this.refresh(),this.clickCount("click")},refresh(){this.getCourseDetails(),this.initTopThreeComment()},async getCourseDetails(){try{await this.initCourseDetails({courseSource:"platform",courseId:this.courseInfo.courseId}),this.loading=!1,this.onCSCECUrlExpired(),this.courseInfo.approvalId||window.localStorage.setItem("showCourseDetail",JSON.stringify({courseTitle:this.courseDetails.title,courseId:this.courseDetails.id,courseCover:this.courseDetails.cover,courseSource:this.courseDetails.courseSource,enterpriseId:this.$store.state.commonParams.enterpriseId}));for(let t=0;t<this.courseDetails.resources.length;t++)this.courseDetails.resources[t].question_count>0&&(this.hasTest="true");this.courseInfo.listenResource&&this.playing({index:this.courseDetails.resources.findIndex((t=>t.id===this.courseInfo.listenResource))})}catch(t){console.error(t),this.loading=!1,this.isShowResult=!0,"enterpriseapi.4003"===t.data.code?this.resultParams={type:"403",title:this.$t("share.noPermission"),description:this.$t("share.noPermissionTip")}:"enterpriseapi.4001"===t.data.code?this.resultParams={type:"404",title:this.$t("course.resourceNotFound"),buttons:[{type:"text",text:this.$t("common.back"),callBack:()=>{this.$router.go(-1)}}]}:"enterpriseapi.503010"===t.data.code?this.resultParams={type:"404",description:this.$t("share.courseRemoved")}:this.resultParams={type:"error",title:this.$t("promptMessage.systemError"),description:t.data.message}}},getCourseIntro(){this.courseDetails&&l.Z.course.lecturerDetail(this.courseDetails.lecturer.id)},async playing({index:t}){const{courseInfo:e,courseDetails:s}=this;this.currentSourceItem=s.resources[t];let{auditionType:a}=this.currentSourceItem;if(this.isOutCourse)return;if(!1===s.isEquitiesCourse&&"false"===s.free&&"buy"===s.showStatus&&0===a)return void this.$toast(this.$t("promptMessage.purchaseTips"));await n.Z.platform.addPlayCount({courseId:e.courseId}),"false"===this.currentSourceItem.play&&this.$toast(this.$t("promptMessage.transcode"));let{type:i}=this.currentSourceItem;if("ZHONG_JIAN"===s.source&&"mp4"===i&&this.getCSCECCourseFun(t),""===this.playId&&this.clickCount("play"),"mp4"===i||"mp3"===i){let e="";const{storageType:s}=this.currentSourceItem;if("ALIBABA_PRIVATE"===s){const{data:t}=await n.Z.privateVodDownloadUrl({videoId:this.currentSourceItem.videoId});0===t.code&&(e=t.data.videoPlayInfo)}this.pausePlay=!0,setTimeout((()=>{this.currentPlay=t,this.pausePlay=!1,this.isPlayingVideo=!0,this.playingVideo={id:this.currentSourceItem.id,url:"ALIBABA_PRIVATE"===s?e:this.currentSourceItem.url,recentStart:this.currentSourceItem.recentStart,duration:this.currentSourceItem.duration,progress:this.currentSourceItem.progress,storageType:this.currentSourceItem.storageType,videoId:this.currentSourceItem.videoId,auditionLength:this.currentSourceItem.auditionLength,auditionType:this.currentSourceItem.auditionType,contentType:this.currentSourceItem.contentType},this.handleSaveProgress({currentTime:this.currentSourceItem.recentStart,progress:this.currentSourceItem.progress,id:this.currentSourceItem.id,requestId:(0,o.Z)()})}),100)}else this.isPlayingVideo=!1,this.currentPlay=-1,setTimeout((()=>{const{currentSourceItem:t}=this;l.Z.course.toCourseReader({path:t.path,url:encodeURIComponent(t.url),title:t.title,type:t.type,progress:t.progress,isSaveProgress:!0,studyId:e.studyId,resourceId:t.id,storageType:t.storageType,videoId:t.videoId,studyTimeLimit:t.studyTimeLimit,studyTime:t.recentStart,courseId:e.courseId,progressType:"platform",readerType:"doc"})}),200)},async clickCount(t){let{pushId:e="",courseId:s,shareId:a=""}=this.courseInfo;try{const i=await n.Z.platform.platformCourseEventsData({courseId:s,pushId:e,shareId:a,eventType:t});this.playId=i.data.id}catch(t){console.error(t)}},handleSaveProgress({currentTime:t,progress:e,id:s,requestId:a}){this.saveCoursewareProgress({data:{recentStart:t||this.currentSourceItem.recentStart,progress:e||this.currentSourceItem.progress,courseId:this.courseInfo.courseId,resourceId:s,progressType:"platform"},requestId:a,courseResource:"platform"})},async goToDDI(){const t=await n.Z.getDDICourseUrl({courseId:this.courseInfo.courseId,isPreview:"true"}),{learningUrl:e}=t.data;l.Z.course.toDDI({learningUrl:e,courseInfo:this.courseInfo})},onFullscreenChange(t){this.isFullScreen=t},async initTopThreeComment(){let t=await n.Z.platform.getPlatformCourseCommentList({courseId:this.courseInfo.courseId,pageNumber:1,pageSize:3});this.commentInfo={list:t.data.list,total:t.data.total}},scrollToComment(){this.$refs.myCourseComment.$el.scrollIntoView({behavior:"smooth"})},async submitComment(t){try{let e=await n.Z.platform.platformCourseCommentSubmit({courseId:this.courseInfo.courseId,comment:t});const s=this.commentInfo.list.length;s>=3&&this.commentInfo.list.splice(s-1,1);const i=(0,a.Z)((0,a.Z)({},e.data),{},{syncSourceType:e.data.sync_source_type,syncUserId:e.data.sync_user_id||""});this.commentInfo.list.unshift(i),this.commentInfo.total=1+this.commentInfo.total,this.courseDetails.commentCount=1+this.courseDetails.commentCount,this.$toast.success(this.$t("promptMessage.sendSuccessfully"))}catch(t){this.$toast.fail(this.$t("promptMessage.sendFailed"))}},toCourseTest({hasAnswered:t,resourceId:e}){const{originType:s,courseId:a,hotIndex:i}=this.courseInfo,o=t?"courseTestParse":"courseTest";l.Z.course[o]({type:"platform",courseId:a,resourceId:e,originType:s,hotIndex:i})},onCSCECUrlExpired(){"ZHONG_JIAN"===this.courseDetails.source&&(this.csceTimeInterval=setInterval((()=>{new Date>new Date(this.currentCSCECItem.expireTime)&&this.onCSCECPlay()}),1e3))},onCSCECPlayFunc(){const{courseDetails:t,currentCSCECItem:e}=this;"ZHONG_JIAN"===t.source&&new Date>new Date(e.expireTime)&&this.onCSCECPlay()},async onCSCECPlay(){let t={courseSource:this.courseInfo.courseResource,courseId:this.courseInfo.courseId,source:this.courseInfo.source||"course_center",self:this};await this.initCourseDetails(t);let e=this.courseDetails.resources[this.currentPlay];const s=await n.Z.getCSCECCourse({courseId:this.courseInfo.courseId,thirdResourceId:e.videoId}),{learningUrl:i,expireTime:o}=s.data;e=(0,a.Z)((0,a.Z)({},e),{},{url:i,expireTime:o}),this.pausePlay=!0,setTimeout((()=>{this.pausePlay=!1,this.isPlayingVideo=!0,this.playingVideo={id:e.id,url:i,recentStart:e.recentStart,duration:e.duration,progress:e.progress,contentType:e.contentType},this.currentCSCECItem=e,this.$nextTick((()=>{this.$refs.coursePlayerRef.initPlayer()}))}),100)},async getCSCECCourseFun(t){const e=this.currentSourceItem;let s={};if(e.url&&100!==e.progress)this.pausePlay=!0,setTimeout((()=>{this.currentCSCECItem=s,this.currentPlay=t,this.pausePlay=!1,this.isPlayingVideo=!0,this.playingVideo={id:s.id,url:s.url,recentStart:s.recentStart,duration:s.duration,progress:s.progress,contentType:s.contentType}}),100);else{const i=await n.Z.getCSCECCourse({courseId:this.courseInfo.courseId,thirdResourceId:e.videoId}),{learningUrl:o,expireTime:r}=i.data;s=(0,a.Z)((0,a.Z)({},e),{},{url:o,expireTime:r}),setTimeout((()=>{this.pausePlay=!0,this.currentCSCECItem=s,this.currentPlay=t,this.pausePlay=!1,this.isPlayingVideo=!0,this.playingVideo={id:s.id,url:s.url,recentStart:s.recentStart,duration:s.duration,progress:s.progress,contentType:s.contentType}}),100)}},onShowShare(){this.showShare=!0},onCloseShareSheet(){this.showShare=!1}})},D=(0,f.Z)(P,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"platform_course_details_container"},[t.loading?s("van-loading",{staticClass:"cl-page-container-loading",attrs:{size:"36"}}):[t.isShowResult?s("cl-result",{attrs:{title:t.resultParams.title,description:t.resultParams.description,buttons:t.resultParams.buttons}}):[s("div",{staticClass:"course_details_container",class:{"full-screen":t.isFullScreen}},[s("course-player",{attrs:{"enter-type":"project",cover:t.courseDetails.cover,"playing-video":t.playingVideo,"is-playing-video":t.isPlayingVideo,"is-paused":t.pausePlay,draggable:!0,autoplay:t.autoplay,"is-share":!0},on:{onPause:t.handleSaveProgress,onTimerEvent:t.handleSaveProgress,onFullscreenChange:t.onFullscreenChange,onCSCECPlay:t.onCSCECPlayFunc,onShowShare:t.onShowShare}}),s("course-info",{attrs:{"course-details":t.courseDetails}}),s("div",{staticClass:"courseware-list"},[s("div",{staticClass:"title"},[t._v(" "+t._s(t.$t("course.courseCatalog"))+" "),"onlyOne"===t.courseDetails.finishStandardStr?s("span",[s("SvgIcon",{attrs:{"icon-class":"icon-tips",color:"#D5D8DE",size:14}}),t._v(t._s(t.$t("course.finishStandard")))],1):t._e()]),s("course-ware",{attrs:{resources:t.courseDetails.resources,"is-free":t.courseDetails.free,"show-status":t.courseDetails.showStatus,"has-test":t.hasTest,"is-out-course":t.isOutCourse,"current-play":t.currentPlay},on:{onCourseTest:t.toCourseTest,onPlayResource:t.playing}})],1),s("course-introduce",{attrs:{introduction:t.courseDetails.introduction}}),s("course-comment",{ref:"myCourseComment",attrs:{"comment-info":t.commentInfo,"course-id":t.courseInfo.courseId,"course-source":t.courseInfo.courseResource,"submit-comment":t.submitComment}}),s("course-end"),s("course-action",{attrs:{"course-source":t.courseInfo.courseResource,"course-details":t.courseDetails,"course-info":t.courseInfo,"is-out-course":t.isOutCourse},on:{scrollToComment:t.scrollToComment}}),s("cl-share",{attrs:{from:t.shareFrom,show:t.showShare,"share-params":{pc_url:"/course/enterpriseCourse?courseId="+t.courseInfo.courseId,mobile_url:"/course-platform-detail?courseResource="+t.courseInfo.courseResource+"&courseId="+t.courseInfo.courseId,pc_type:"student",mobile_type:"h5",is_auth_enterprise:!0},title:t.courseDetails.title,site1:{type:"resource_count",label:t.$t("course.courseware"),value:t.courseDetails.resourceCount},lecturer:t.courseDetails.teacherName?{avatar:t.courseDetails.teacherAvatar||t.defaultUserImg,name:t.courseDetails.teacherName,id:t.courseDetails.teacherId,source_type:t.courseDetails.teacherSyncSourceType}:{},"image-url":t.courseDetails.cover,"is-share-msg":!0},on:{closeShareSheet:t.onCloseShareSheet}})],1)]]],2)}),[],!1,null,"3c3b087e",null).exports},9623:(t,e,s)=>{s.r(e),s.d(e,{default:()=>P});var a=s(95082),i=(s(57658),s(30541),s(26294)),o=s(25934),r=s(27632),n=s(69119),c=s(95969),l=s(55602),u=s(22648),d=s(7294),h=s(63874),p=s(94864),m=s(56955),g=s(52196),v=s(67185),f=s(28512),y=s(78551),_={components:{SvgIcon:y.Z},props:{title:{type:String,default:""},score:{type:Number,default:0},resourceCount:{type:Number,default:0}},computed:(0,a.Z)({},(0,i.mapGetters)({primaryColor:"getPrimaryColor"}))},C=s(1001),I=(0,C.Z)(_,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"course-info"},[s("div",{staticClass:"title"},[t._v(t._s(t.title))]),s("div",{staticClass:"appraise"},[t.score>=0?s("div",{staticClass:"appraise-score"},t._l(Object.keys(Array.from({length:5})),(function(e){return s("svg-icon",{key:e,staticClass:"iconfont",attrs:{"icon-class":"icon-xingxingchengcopy",size:12,color:e<(0===t.score?5:t.score)?t.primaryColor:"#C0C2CB"}})})),1):t._e()]),s("div",{staticClass:"free"},[s("span",{staticClass:"courseware-count"},[t._v(t._s(t.$t("course.courseware"))+" "+t._s(t.resourceCount))])])])}),[],!1,null,"346b4ec2",null).exports,b=s(19499),w=s(12596),$=s(99803),k=s(27098),S=(s(25773),s(35791)),T={components:{SvgIcon:y.Z,VanButton:S.Z},props:{courseSource:{type:String,default:""},courseDetails:{type:Object,default:function(){return{}}},courseInfo:{type:Object,default:function(){return{}}},isOutCourse:{type:Boolean,default:!1},approvalId:{type:String,default:""}},computed:(0,a.Z)({},(0,i.mapGetters)({primaryColor:"getPrimaryColor"})),methods:(0,a.Z)((0,a.Z)({},(0,i.mapActions)("course/task",["changePraise"])),{},{praise(){let t="";t="like"===this.courseDetails.likeStatus?"unlike":"like",this.changePraise({courseId:this.courseInfo.courseId,status:t})},async goToDDI(){const{courseId:t,studyId:e,purchased:s}=this.courseInfo,a={courseId:t,isPreview:"false",isPersonPurchase:"true"===s?"true":"false",planId:e},{courseInfo:i}=this,o=await p.Z.getDDICourseUrl(a),{learningUrl:r}=o.data;c.Z.course.toDDI({learningUrl:r,courseInfo:i})}})},Z=(0,C.Z)(T,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"course-action"},[s("div",{staticClass:"course-action-more"},[s("div",{staticClass:"evaluate",on:{click:function(e){return t.$emit("scrollToComment")}}},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-talk",color:"#7F849A",size:18}}),t.courseDetails.commentCount>0?s("span",{staticClass:"num"},[t._v(t._s(t.courseDetails.commentCount))]):t._e()],1),s("div",{staticClass:"evaluate",class:t.isOutCourse?"praise-more":"",on:{click:t.praise}},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-zan",color:"like"===t.courseDetails.likeStatus?"#df6666":"#7F849A",size:21}}),t.courseDetails.likeCount>0?s("span",{staticClass:"num"},[t._v(t._s(t.courseDetails.likeCount))]):t._e()],1),s("div",{staticClass:"progress",class:t.isOutCourse?"progress-more":""},[s("span",{staticClass:"text"},[t._v(t._s(t.$t("attestation.progress"))+"：")]),s("span",[t._v(t._s(t.courseDetails.progress)+"%")])]),t.isOutCourse?s("van-button",{staticClass:"ddi-study-btn",attrs:{color:t.primaryColor,type:"primary",size:"mini"},on:{click:t.goToDDI}},[t._v(" "+t._s(t.$t("project.startStudy"))+" ")]):t._e()],1)])}),[],!1,null,"6c97bcfe",null).exports,x={name:"TaskDetail",components:{CoursePlayer:v.Z,CourseInfo:I,CourseWare:b.Z,CourseIntroduce:w.Z,CourseComment:$.Z,CourseEnd:k.Z,CourseAction:Z,SubsidyPlayer:f.Z},props:[],data:function(){return{commentInfo:{list:[],total:0},currentPlay:-1,isDrag:!0,playingVideo:{},isPlayingVideo:!1,isFullScreen:!1,videoCaptureUrl:"",courseInfo:{},download:!1,studyTimeOut:null,csceTimeInterval:null,currentCSCECItem:{},currentSourceItem:null,learningTimer:null,batchNumber:"",isPreventHangSwitch:""}},computed:(0,a.Z)((0,a.Z)((0,a.Z)((0,a.Z)((0,a.Z)({},(0,i.mapState)("course/task",["courseDetails","topThreeComment","totalComments"])),(0,i.mapState)("setting",["showRandomWindow","dragSwitch","preventHangSwitch"])),(0,i.mapState)(["commonParams"])),(0,i.mapGetters)({fresh:"microCourse/getFreshStatus"})),{},{isOutCourse(){return(0,d.ZG)(this.courseDetails.source)},draggable(){return this.playingVideo.progress>=100||this.isDrag},autoplay:()=>"ios"!==(0,u.Os)()}),watch:{fresh(t){t&&(this.refresh(),this.$store.commit("microCourse/updateFresh",!1))}},mounted(){this.init()},beforeDestroy(){clearTimeout(this.studyTimeOut),clearInterval(this.csceTimeInterval),"dingTalk"===r.Z.env&&(0,l.vD)({shareInfo:{}}),clearInterval(this.learningTimer),this.learningTimer=null,this.currentPlay>-1&&this.$refs.coursePlayerRef&&this.$refs.coursePlayerRef.getCommonVideoPlayer().isPlaying&&this.recordLearningTime()},methods:(0,a.Z)((0,a.Z)((0,a.Z)({},(0,i.mapActions)("course/task",["initCourseDetails"])),(0,i.mapActions)("course",["saveCoursewareProgress"])),{},{init(){const{query:t}=this.$route;this.isDrag="true"===t.draggable,this.isPreventHangSwitch=t.preventHangSwitch?"true"===t.preventHangSwitch:this.preventHangSwitch,this.courseInfo=t,this.getEnterpriseDrag(),this.refresh()},refresh(){this.getCourseDetails(),this.initTopThreeComment()},async getCourseDetails(){this.$toast.loading({duration:0,forbidClick:!0,message:this.$t("common.loading")}),await this.initCourseDetails({studyId:this.courseInfo.studyId,inOrder:"true"===this.courseInfo.inOrder,courseId:this.courseInfo.courseId,studyType:this.courseInfo.studyType,self:this}),this.onCSCECUrlExpired(),this.$toast.clear();const{id:t,title:e="",cover:s="",studyType:a="",liveStatus:i}=this.courseDetails;"study_project"===this.courseInfo.studyType&&(0,g.h2)({flag:"share_course_enterprise",courseId:t,studyType:a,imageUrl:s,title:"",desc:e}),"remarking"===i&&this.$dialog.alert({title:this.$t("ddLive.courseTip"),showCancelButton:!1,confirmButtonText:this.$t("subsidy.gotIt"),message:this.$t("ddLive.courseTipContent")})},setRecord(t){clearTimeout(this.studyTimeOut),"evaluation"!==this.courseInfo.studyType&&(p.Z.task.setStudyRecord({actionType:t,planId:this.courseInfo.studyId,courseId:this.courseInfo.courseId,resourceId:this.playingVideo.id,planType:"study_project"===this.courseInfo.studyType?"project":"study"}),"study"===t&&(this.studyTimeOut=setTimeout((()=>{this.setRecord(t)}),3e4)))},async getSyncRecourse(t){const e=(0,u.Tq)(t);if("true"===this.courseDetails.syncProgress){const t=await p.Z.task.getSingleResource({planId:this.courseInfo.studyId,courseId:this.courseInfo.courseId,resourceId:e.id,studyType:this.courseInfo.studyType});return 0===t.code&&t.data?(0,a.Z)((0,a.Z)({},e),{},{recentStart:t.data.recentStart,progress:t.data.progress,studyTimeLimit:t.data.studyTimeLimit}):e}return e},async playing({index:t}){if(Object.keys(this.playingVideo).length&&this.setRecord("stop"),this.currentSourceItem=this.courseDetails.resources[t],!this.isOutCourse&&this.currentSourceItem.canStudy)if("false"!==this.currentSourceItem.play){if("ZHONG_JIAN"!==this.courseDetails.source||"mp4"!==this.currentSourceItem.type)return"study_project"===this.courseInfo.studyType&&"mp4"===this.currentSourceItem.type&&"true"===this.courseDetails.existAiResource?(this.currentSourceItem=await this.getSyncRecourse(this.currentSourceItem),void this.$router.push({path:"/watch-video",query:{courseResource:this.courseInfo.courseResource,courseId:this.courseInfo.courseId,resourceId:this.currentSourceItem.id,id:"study_project"===this.courseInfo.studyType?this.courseInfo.studyId:this.courseInfo.courseId,studyId:this.courseInfo.studyId,progressType:this.getProgressType(),url:this.currentSourceItem.url,recentStart:this.currentSourceItem.recentStart,duration:this.currentSourceItem.duration,progress:this.currentSourceItem.progress}})):void this.onCourseTypeHandle(t);this.getCSCECCourseFun(t)}else this.$toast(this.$t("promptMessage.transcode"))},async onCourseTypeHandle(t){const e=this.currentSourceItem.type,s=this.currentSourceItem.contentType,i={isSaveProgress:!0,progressType:this.getProgressType(),resourceId:this.currentSourceItem.id,courseId:this.courseInfo.courseId,studyId:this.courseInfo.studyId,title:this.currentSourceItem.title,storageType:this.currentSourceItem.storageType,videoId:this.currentSourceItem.videoId,url:this.currentSourceItem.url,type:this.currentSourceItem.type,studyTime:this.currentSourceItem.recentStart,progress:100,from:"course"};switch(e){case"mp4":case"mp3":let e="";if("ALIBABA_PRIVATE"===this.currentSourceItem.storageType){const{data:t}=await p.Z.privateVodDownloadUrl({videoId:this.currentSourceItem.videoId});0===t.code&&(e=t.data.videoPlayInfo)}let r="false";if("on"===this.courseInfo.videoFaceRecognition){r=2e5===(await p.Z.task.hasVideoFaceRecognition(this.currentSourceItem.id,this.courseInfo.studyId)).data.code?"true":"false"}this.currentSourceItem=await this.getSyncRecourse(this.currentSourceItem),this.currentPlay=t,this.isPlayingVideo=!0,this.playingVideo={id:this.currentSourceItem.id,url:"ALIBABA_PRIVATE"===this.currentSourceItem.storageType?e:this.currentSourceItem.url,recentStart:this.currentSourceItem.recentStart,duration:this.currentSourceItem.duration,progress:this.currentSourceItem.progress,storageType:this.currentSourceItem.storageType,videoId:this.currentSourceItem.videoId,contentType:this.currentSourceItem.contentType,videoFaceRecognition:this.courseInfo.videoFaceRecognition,hasSetFace:this.courseInfo.hasSetFace,needVideoFaceRecognition:r,studyId:this.courseInfo.studyId,courseId:this.currentSourceItem.id,isCourse:!0,speedPlaySwitch:this.$route.query.speedPlaySwitch},this.setRecord("study"),this.handleSaveProgress({currentTime:this.currentSourceItem.recentStart,progress:this.currentSourceItem.progress,id:this.currentSourceItem.id,requestId:(0,o.Z)()});break;case"article":if("true"===this.currentSourceItem.linkSwitch&&this.currentSourceItem.url)(0,h.N8)({url:this.currentSourceItem.url});else{const t="certificationDetails"===this.courseInfo.originType?"certi":"study",e="certificationDetails"===this.courseInfo.originType?"certificate":this.courseInfo.studyType;c.Z.course.toCourseReader((0,a.Z)((0,a.Z)({},i),{},{isSaveRecord:!0,readerType:"article",studyType:e,from:t}))}break;case"scorm":this.currentSourceItem=await this.getSyncRecourse(this.currentSourceItem),c.Z.course.toCourseReader((0,a.Z)((0,a.Z)({},i),{},{readerType:"scorm"}));break;case"link":this.currentSourceItem=await this.getSyncRecourse(this.currentSourceItem),c.Z.course.toCourseReader((0,a.Z)((0,a.Z)({},i),{},{readerType:"html"}));break;default:switch(this.currentSourceItem=await this.getSyncRecourse(this.currentSourceItem),s){case"html":c.Z.course.toCourseReader((0,a.Z)((0,a.Z)({},i),{},{readerType:"html"}));break;case"picture":c.Z.course.toCourseReader((0,a.Z)((0,a.Z)({},i),{},{readerType:"image",showWatermark:!0}));break;default:c.Z.course.toCourseReader((0,a.Z)((0,a.Z)({},i),{},{path:this.currentSourceItem.path,url:encodeURIComponent(this.currentSourceItem.url),progress:this.currentSourceItem.progress,studyTimeLimit:this.currentSourceItem.studyTimeLimit,readerType:"doc"}))}}},getProgressType(){const{studyType:t,live_class:e}=this.courseInfo;let s="";switch(t){case"study_project":s=e?"enterprise":"studyProject";break;case"evaluation":s="evaluation";break;default:s=""}return s},handleSaveProgress({currentTime:t,progress:e,id:s,requestId:a}){const{studyId:i,courseId:o,studyType:r}=this.courseInfo;this.saveCoursewareProgress({data:{studyId:i,courseId:o,studyType:r,recentStart:t||this.currentSourceItem.recentStart,progress:e||this.currentSourceItem.progress,resourceId:s,mapId:this.courseInfo.mapId,progressType:this.getProgressType()},courseResource:"task",requestId:a})},async getEnterpriseDrag(){try{const t=await p.Z.enterprise.queryEnterpriseVideoDrag();if(0===t.code){const{enterpriseId:e}=this.commonParams;t.data.indexOf(e)>-1&&(this.isDrag=!0)}}catch(t){console.error(t)}},onFullscreenChange(t){this.isFullScreen=t},toCourseTest({hasAnswered:t,resourceId:e}){const{courseInfo:s}=this,{courseResource:a,hotIndex:i,originType:o,courseId:r}=s,n=t?"courseTestParse":"courseTest";c.Z.course[n]({type:a,hotIndex:i,originType:o,courseId:r,resourceId:e})},async initTopThreeComment(){let t=await p.Z.enterprise.getEnterpriseCourseCommentList({courseId:this.courseInfo.courseId,pageNumber:1,pageSize:3});this.commentInfo={list:t.data.list,total:t.data.total}},scrollToComment(){this.$refs.myCourseComment.$el.scrollIntoView({behavior:"smooth"})},async submitComment(t){try{let e=await p.Z.enterprise.enterpriseCourseCommentSubmit({courseId:this.courseInfo.courseId,comment:t});const s=this.commentInfo.list.length;s>=3&&this.commentInfo.list.splice(s-1,1);const i=(0,a.Z)((0,a.Z)({},e.data),{},{syncSourceType:e.data.sync_source_type,syncUserId:e.data.sync_user_id||""});this.commentInfo.list.unshift(i),this.commentInfo.total=1+this.commentInfo.total,this.courseDetails.commentCount=1+this.courseDetails.commentCount,this.$toast.success(this.$t("promptMessage.sendSuccessfully"))}catch(t){this.$toast.fail(this.$t("promptMessage.sendFailed"))}},onCSCECUrlExpired(){"ZHONG_JIAN"===this.courseDetails.source&&(this.csceTimeInterval=setInterval((()=>{new Date>new Date(this.currentCSCECItem.expireTime)&&this.onCSCECPlay()}),1e3))},handlePlayerPause({currentTime:t,progress:e,id:s,requestId:a}){this.handleSaveProgress({currentTime:t,progress:e,id:s,requestId:a}),this.learningTimer&&(clearInterval(this.learningTimer),this.learningTimer=null),this.recordLearningTime()},onCSCECPlayFunc(){const{courseDetails:t,currentCSCECItem:e}=this;if("ZHONG_JIAN"===t.source&&new Date>new Date(e.expireTime)&&this.onCSCECPlay(),!this.learningTimer){this.batchNumber=(0,o.Z)(),this.recordLearningTime();const t=this;clearInterval(t.learningTimer),t.learningTimer=setInterval((()=>{t.recordLearningTime()}),n.If)}},async onCSCECPlay(){let t={courseSource:this.courseInfo.courseResource,courseId:this.courseInfo.courseId,source:this.courseInfo.source||"course_center",self:this};await this.initCourseDetails(t);let e=this.courseDetails.resources[this.currentPlay];const s=await p.Z.getCSCECCourse({courseId:this.courseInfo.courseId,thirdResourceId:e.videoId}),{learningUrl:i,expireTime:o}=s.data;e=(0,a.Z)((0,a.Z)({},e),{},{url:i,expireTime:o}),this.isPlayingVideo=!0,this.playingVideo={id:e.id,url:i,recentStart:e.recentStart,duration:e.duration,progress:e.progress,contentType:e.contentType},this.currentCSCECItem=e,this.$nextTick((()=>{this.$refs.coursePlayerRef.initPlayer()}))},async getCSCECCourseFun(t){const e=this.currentSourceItem;let s={};if(e.url&&100!==e.progress)this.currentCSCECItem=s,this.currentPlay=t,this.isPlayingVideo=!0,this.playingVideo={id:s.id,url:s.url,recentStart:s.recentStart,duration:s.duration,progress:s.progress,contentType:s.contentType};else{const i=await p.Z.getCSCECCourse({courseId:this.courseInfo.courseId,thirdResourceId:e.videoId}),{learningUrl:o,expireTime:r}=i.data;s=(0,a.Z)((0,a.Z)({},e),{},{url:o,expireTime:r}),this.currentCSCECItem=s,this.currentPlay=t,this.isPlayingVideo=!0,this.playingVideo={id:s.id,url:s.url,recentStart:s.recentStart,duration:s.duration,progress:s.progress,contentType:s.contentType}}},async recordLearningTime(){const t=this.getProgressType(),e={studyId:this.courseInfo.studyId,courseId:this.courseInfo.courseId,resourceId:this.playingVideo.id},s={batchNumber:this.batchNumber};try{await m.Z.postClassHourTiming(t,e,s)}catch(t){}}})},P=(0,C.Z)(x,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"enterprise_course_details_container"},[s("div",{staticClass:"course_details_container",class:{"full-screen":t.isFullScreen}},["true"===t.courseInfo.is_subsidy_course?s("subsidy-player",{attrs:{"is-playing-video":t.isPlayingVideo,"enter-type":"project",autoplay:t.autoplay,cover:t.courseDetails.cover,"is-paused":!1,"playing-video":t.playingVideo,"course-info":t.courseInfo,"prevent-hang-flag":!1,"show-random-window":!1,"video-capture-url":t.videoCaptureUrl},on:{"update:playingVideo":function(e){t.playingVideo=e},"update:playing-video":function(e){t.playingVideo=e},handleSaveProgress:t.handleSaveProgress,onFullscreenChange:t.onFullscreenChange}}):s("course-player",{ref:"coursePlayerRef",attrs:{"enter-type":"project",cover:t.courseDetails.cover,autoplay:t.autoplay,"playing-video":t.playingVideo,"is-paused":!1,"course-info":t.courseInfo,"is-playing-video":t.isPlayingVideo,"prevent-hang-flag":t.isPreventHangSwitch,"show-random-window":t.showRandomWindow,draggable:t.draggable},on:{onVideoInstance:function(){},onEnded:function(){},onPause:t.handlePlayerPause,onTimerEvent:t.handleSaveProgress,onFullscreenChange:t.onFullscreenChange,onCSCECPlay:t.onCSCECPlayFunc}}),s("course-info",{attrs:{title:t.courseDetails.title,score:t.courseDetails.score,"resource-count":t.courseDetails.resourceCount}}),s("div",{staticClass:"courseware-list"},[s("div",{staticClass:"title"},[t._v(" "+t._s(t.$t("course.courseCatalog"))+" "),"onlyOne"===t.courseDetails.finishStandardStr?s("span",[s("SvgIcon",{attrs:{"icon-class":"icon-tips",color:"#D5D8DE",size:14}}),t._v(t._s(t.$t("course.finishStandard")))],1):t._e()]),s("course-ware",{attrs:{resources:t.courseDetails.resources,"is-free":t.courseDetails.free,"show-status":t.courseDetails.showStatus,"is-out-course":t.isOutCourse,"current-play":t.currentPlay,download:"true"===t.courseInfo.courseDownload&&"1"!==t.courseInfo.scope},on:{onCourseTest:t.toCourseTest,onPlayResource:t.playing}})],1),s("course-introduce",{attrs:{introduction:t.courseDetails.introduction}}),s("course-comment",{ref:"myCourseComment",attrs:{"comment-info":t.commentInfo,"course-id":t.courseInfo.courseId,"course-source":t.courseInfo.courseResource,"submit-comment":t.submitComment,"comment-switch":!0===t.courseDetails.commentSwitch}}),s("course-end"),s("course-action",{attrs:{"course-source":t.courseInfo.courseResource,"course-details":t.courseDetails,"course-info":t.courseInfo,"is-out-course":t.isOutCourse},on:{scrollToComment:t.scrollToComment}})],1)])}),[],!1,null,"31d73768",null).exports},5859:(t,e,s)=>{s.r(e),s.d(e,{default:()=>y});var a=s(95082),i=(s(57658),s(25934)),o=s(26294),r=s(69119),n=s(22648),c=s(42292),l=s(56955),u=s(17266),d={name:"VoiceKnow",props:{knowledgeInfo:{type:Object,default:()=>({textList:[]})}},data:()=>({index:0,scrollTop:0,every:[],isScroll:!1,timer:null}),computed:{currentTime(){return this.$store.state.watchVideo.currentTime}},watch:{currentTime(t){this.setIndex(t)}},mounted(){this.$nextTick((()=>{const t=this.$el.querySelectorAll(".knowledge__voice__item"),e=[];t.forEach((t=>{const{top:s}=t.getBoundingClientRect();e.push(s-293)})),this.every=e}))},methods:{playSeek(t){this.$emit("onPlaySeek",t)},onTouchStart(){clearTimeout(this.timer),this.isScroll=!0},onTouchEnd(){this.timer=setTimeout((()=>{this.isScroll=!1}),8e3)},onTouchMove(){clearTimeout(this.timer),this.isScroll=!0},onScroll(){this.isScroll&&(this.scrollTop=0)},setIndex(t){let e=0;const{textList:s}=this.knowledgeInfo;for(let a=0;a<this.every.length;a++){const i=s[a].startTime,o=s[a].endTime,r=s[a+1]?s[a+1].startTime:o;if(Math.floor(t)>=i&&Math.floor(t)<=o){e=a;break}if(Math.floor(t)>o&&Math.floor(t)<r){e=a;break}}this.index=e,this.isScroll||this.$nextTick((()=>{this.$refs.scrollRef.scrollTop=this.every[e]}))}}},h=s(1001),p=(0,h.Z)(d,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"scrollRef",staticClass:"watch__video__scroll",style:{background:"#000",overflowY:"scroll"}},[s("div",{staticClass:"knowledge__voice__content",on:{touchstart:t.onTouchStart,touchmove:t.onTouchMove,touchend:t.onTouchEnd}},t._l(t.knowledgeInfo.textList,(function(e,a){return s("div",{key:"voiceknow"+a,staticClass:"knowledge__voice__item",class:[t.index===a?"knowledge__voice__item__active":""],on:{click:function(){return t.playSeek(e.startTime)}}},[s("div",{staticClass:"knowledge__voice__step"}),s("div",{staticClass:"knowledge__voice__line"}),s("div",[s("span",[t._v(t._s(Math.floor(e.startTime/60/60)>9?Math.floor(e.startTime/60/60):"0"+Math.floor(e.startTime/60/60)))]),t._v(" : "),s("span",[t._v(t._s(Math.floor(e.startTime/60%60)>9?Math.floor(e.startTime/60%60):"0"+Math.floor(e.startTime/60%60)))]),t._v(" : "),s("span",[t._v(t._s(Math.floor(e.startTime%60)>9?Math.floor(e.startTime%60):"0"+Math.floor(e.startTime%60)))]),s("span",{style:{margin:"0 10px"}},[t._v("--")]),s("span",[t._v(t._s(Math.floor(e.endTime/60/60)>9?Math.floor(e.endTime/60/60):"0"+Math.floor(e.endTime/60/60)))]),t._v(": "),s("span",[t._v(t._s(Math.floor(e.endTime/60%60)>9?Math.floor(e.endTime/60%60):"0"+Math.floor(e.endTime/60%60)))]),t._v(": "),s("span",[t._v(t._s(Math.floor(e.endTime%60)>9?Math.floor(e.endTime%60):"0"+Math.floor(e.endTime%60)))])]),s("div",{staticClass:"knowledge__voice__text"},[t._v(t._s(e.content))])])})),0)])}),[],!1,null,"7132a0f5",null).exports,m={name:"GraphView",props:{knowledgeInfo:{type:Object,default:()=>({knowledgeGraphs:[]})},statusList:{type:Array,default:()=>[]}},data:()=>({})},g=(0,h.Z)(m,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"watch__video__scroll",style:{background:"#000",overflowY:"scroll"}},[s("div",{staticClass:"knowledge__graph__content"},[s("div",{staticClass:"knowledge__graph_backImg"}),s("div",{staticClass:"knowledge__graph__title"},[t._v(t._s(t.$t("course.courseKnowledgeHead")))]),s("div",{staticClass:"knowledge__graph__statusList"},t._l(t.statusList,(function(e){return s("div",{key:e.value},[s("div",{staticClass:"status__points",class:[1==e.value?"finished":"",2==e.value?"progressing":"",3==e.value?"noStart":""]}),s("span",[t._v(t._s(e.label))])])})),0),s("div",{staticClass:"knowledge__graph__list"},t._l(t.knowledgeInfo.knowledgeGraphs,(function(e,a){return s("div",{key:a,class:["list__item","finished"==e.studyStatus?"finished":"","unfinished"==e.studyStatus?"progressing":"","unstarted"==e.studyStatus?"noStart":""]},[t._v(" "+t._s(e.tag)+" ")])})),0),s("div",{staticClass:"knowledge__graph__head"}),s("div",{staticClass:"knowledge__graph__bottom"})])])}),[],!1,null,"7177099b",null).exports,v={name:"KnowPoint",props:{knowledgeInfo:{type:Object,default:()=>({knowledgeGraphs:[],segmentationList:[]})}},data:()=>({}),methods:{addClickCounts(t){this.$emit("onAddClickCounts",t)}}},f={name:"WatchVideo",components:{VoiceKnow:p,GraphView:g,KnowPoint:(0,h.Z)(v,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"watch__video__scroll",style:{background:"#F2F2F2",overflowY:"scroll"}},[s("div",{staticClass:"knowledge__point__content"},t._l(t.knowledgeInfo.segmentationList,(function(e,a){return s("div",{key:"segmentationList"+a,staticClass:"knowledge__point__item",on:{click:function(){return t.addClickCounts(e)}}},[s("img",{staticClass:"knowledge__point__item__img",attrs:{src:e.snapshotUrl,alt:""}}),s("div",{staticClass:"knowledge__point__item__title"},[t._v(" "+t._s(e.name)+" ")]),s("div",{staticClass:"knowledge__point__tag_box"},t._l(e.tags,(function(e,a){return s("div",{key:e+a,staticClass:"knowledge__point__tags"},[t._v(" "+t._s(e)+" ")])})),0)])})),0)])}),[],!1,null,"8c86acd0",null).exports,CoursePlayer:s(67185).Z},data(){return{pausePlay:!1,isPlayingVideo:!0,courseInfo:{},activeTab:"",knowledgeInfo:{knowledgeGraphs:[],segmentationList:[],textList:[]},statusList:[{value:1,label:this.$t("aiStudy.studied")},{value:2,label:this.$t("aiStudy.studying")},{value:3,label:this.$t("aiStudy.noStudy")}],tabList:[],timerId:null,learningTimer:null,batchNumber:""}},computed:(0,a.Z)((0,a.Z)((0,a.Z)((0,a.Z)((0,a.Z)({},(0,o.mapState)("setting",["showRandomWindow","dragSwitch","preventHangSwitch"])),(0,o.mapState)(["commonParams","themeColor"])),(0,o.mapState)("watchVideo",["courseDetails","watchVideo"])),(0,o.mapGetters)({fresh:"microCourse/getFreshStatus"})),{},{draggable(){const{progress:t}=this.courseInfo;return t>=100||!this.dragSwitch},autoplay:()=>"ios"!==(0,n.Os)()}),watch:{fresh(t){t&&(this.getCourseDetails(),this.$store.commit("microCourse/updateFresh",!1))}},mounted(){this.init()},beforeDestroy(){this.courseInfo.studyType!==u.Si&&this.courseInfo.studyType!==u.z5||(0,u.qJ)({resourceId:this.courseInfo.resourceId,planId:this.courseInfo.studyId,courseId:this.courseInfo.courseId,planType:this.courseInfo.recordType,type:"stop",isInterval:!1}),clearInterval(this.timerId),clearInterval(this.learningTimer),this.learningTimer=null,this.$refs.coursePlayerRef&&this.$refs.coursePlayerRef.getCommonVideoPlayer().isPlaying&&this.recordLearningTime()},methods:(0,a.Z)((0,a.Z)({},(0,o.mapActions)("watchVideo",["initCourseDetails"])),{},{init(){document.title=this.$t("course.aiLearning"),this.courseInfo=this.$route.query,this.courseInfo.url=this.courseInfo.url&&decodeURIComponent(this.courseInfo.url),this.$nextTick((()=>{this.watchVideoHanlder()}))},watchVideoHanlder(){this.getCourseDetails(),this.getAiLearning(),this.courseInfo.recentStart&&this.playSeek(Number(this.courseInfo.recentStart)),this.handleSaveStudyRecord();const{recentStart:t,progress:e}=this.courseInfo;t&&e&&this.handleSaveProgress({currentTime:t,progress:e})},onPause(t){this.handleSaveProgress(t),this.timerId&&clearInterval(this.timerId),this.learningTimer&&(clearInterval(this.learningTimer),this.learningTimer=null),this.recordLearningTime()},handleSaveStudyRecord(){this.courseInfo.recordType!==u.Si&&this.courseInfo.recordType!==u.z5||(0,u.qJ)({resourceId:this.courseInfo.resourceId,courseId:this.courseInfo.courseId,planType:this.courseInfo.recordType,planId:this.courseInfo.studyId,type:u.Si,isInterval:!0}).then((t=>{this.timerId=t}))},setActiveTab(t){this.activeTab=t.value},getCourseDetails(){const t={courseSource:this.courseInfo.courseResource,courseId:this.courseInfo.id,source:"course_center",self:this};this.initCourseDetails(t)},async getAiLearning(){const t=await c.Z.ai.aiLearning({id:this.courseInfo.id,resourceId:this.courseInfo.resourceId}),{knowledgeGraphs:e,segmentationList:s,textList:a}=t.data;let i="";0!==e.length&&this.tabList.push({value:1,label:this.$t("aiStudy.knowledgeGraph")}),0!==s.length&&this.tabList.push({value:2,label:this.$t("aiStudy.knowledgePoints")}),0!==a.length&&this.tabList.push({value:3,label:this.$t("aiStudy.speechRecognition")}),0!==e.length?i=1:0!==s.length?i=2:0!==a.length&&(i=3),this.knowledgeInfo=t.data,this.activeTab=i},playSeek(t){this.$refs.coursePlayerRef&&t&&(this.$refs.coursePlayerRef.seek(t),setTimeout((()=>{this.$refs.coursePlayerRef.play()}),0))},async addClickCounts(t){await c.Z.ai.addClickCount({segmentationId:t.id}),this.playSeek(t.startTime)},handleSaveProgress({currentTime:t,progress:e}){const{resourceId:s,courseId:a,progressType:i,mapId:o,studyId:r}=this.courseInfo;l.Z.saveProgress(i,{courseId:a,resourceId:s,studyId:r,mapId:o},{progress:e,recent_start:t},null,!1)},onCurrentTimeUp(t){this.$store.commit("watchVideo/setCurrent",{currentTime:t})},async recordLearningTime(){const{progressType:t,courseId:e,resourceId:s,studyId:a}=this.courseInfo,i={courseId:e,resourceId:s,studyId:a},o={batchNumber:this.batchNumber,pageCount:this.pageCount};try{await l.Z.postClassHourTiming(t,i,o)}catch(t){console.warn(t)}},onPlay(){this.timerId&&clearInterval(this.timerId),this.handleSaveStudyRecord(),this.learningTimer||(this.batchNumber=(0,i.Z)(),this.recordLearningTime(),clearInterval(this.learningTimer),this.learningTimer=setInterval((()=>{this.recordLearningTime()}),r.If))}})},y=(0,h.Z)(f,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"watch__video__container",style:{background:""===t.activeTab?"#fff":2===t.activeTab?"#F2F2F2":"#000"}},[s("div",{staticClass:"watch__video__container__CoursePlayer"},[s("course-player",{ref:"coursePlayerRef",attrs:{"enter-type":"project",cover:t.watchVideo.cover,autoplay:t.autoplay,height:211,"is-playing-video":t.isPlayingVideo,"playing-video":t.courseInfo,"is-paused":t.pausePlay,"prevent-hang-flag":t.preventHangSwitch,draggable:t.draggable},on:{onPause:t.onPause,onPlay:t.onPlay,onTimerEvent:t.handleSaveProgress,onCurrentTimeUp:t.onCurrentTimeUp}})],1),s("div",{staticClass:"watch__video__tabs"},t._l(t.tabList,(function(e){return s("div",{key:e.value,class:[t.activeTab===e.value?"watch__video__tabs__inner active":"watch__video__tabs__inner"],on:{click:function(){return t.setActiveTab(e)}}},[t._v(" "+t._s(e.label)+" "),t.activeTab===e.value?s("div",{staticClass:"active-bar",style:{background:t.themeColor.primaryColor}}):t._e()])})),0),1===t.activeTab&&0!==t.knowledgeInfo.knowledgeGraphs.length?s("GraphView",{attrs:{"knowledge-info":t.knowledgeInfo,"status-list":t.statusList}}):t._e(),2===t.activeTab&&0!==t.knowledgeInfo.segmentationList.length?s("KnowPoint",{attrs:{"knowledge-info":t.knowledgeInfo},on:{onAddClickCounts:t.addClickCounts}}):t._e(),3===t.activeTab&&0!==t.knowledgeInfo.textList.length?s("VoiceKnow",{attrs:{"knowledge-info":t.knowledgeInfo},on:{onPlaySeek:t.playSeek}}):t._e()],1)}),[],!1,null,"755af28c",null).exports},52415:(t,e,s)=>{s.d(e,{Z:()=>_});var a=s(95082),i=(s(3791),s(93432)),o=(s(39610),s(2163)),r=(s(47601),s(44951)),n=(s(49153),s(5944)),c=(s(20581),s(50914)),l=(s(57658),s(26513)),u=s(78551),d={components:{SvgIcon:u.Z},props:{filterTab:{type:Array,default:()=>[]}},methods:{handleToFilter(t){const e=this.$route.query.type;this.$router.push({path:`/discovery/course-filter?filterType=${t.type}&initId=${t.id}&originType=${e}`})}}},h=s(1001),p=(0,h.Z)(d,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"filter-tab-container"},t._l(t.filterTab,(function(e,a){return s("div",{key:e.title+a,staticClass:"filter-tab-item",on:{click:function(s){return t.handleToFilter(e)}}},[s("span",{staticClass:"filter-tab-title van-ellipsis"},[t._v(t._s(e.title))]),s("svg-icon",{attrs:{"icon-class":"icon-shaixuanjiantouzhankai",size:12,color:"#2D3040"}})],1)})),0)}),[],!1,null,"1587773c",null).exports,m={data:()=>({fieldTabs:[],activeTab:0}),mounted(){this.$route.query.id&&this.getFields(this.$route.query.id)},methods:{async getFields(t){const{status:e,data:s}=await l.Z.getFields({id:t});if(200===e){const e=[{id:t,name:"全部"}];this.fieldTabs=e.concat(s.fields)}},handleTabClick(t,e){this.activeTab=t,this.$emit("click",e)}}},g=(0,h.Z)(m,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"field-tab-container"},[s("div",{staticClass:"field-tab-content"},t._l(t.fieldTabs,(function(e,a){return s("div",{key:e.id,staticClass:"field-tab-item",class:a===t.activeTab?"field-tab-active-item":"",on:{click:function(s){return t.handleTabClick(a,e.id)}}},[a===t.activeTab?s("div",{staticClass:"field-tab-item-line"}):t._e(),s("div",[t._v(" "+t._s(e.name)+" ")])])})),0)])}),[],!1,null,"10767e03",null).exports,v=s(22648),f={components:{SvgIcon:u.Z,[r.Z.name]:r.Z},props:{cardData:{type:Object,default:()=>({cover:"",title:"",free:!1,resource_type:"",course_count:0,like_count:0,preferential_price:0,official_price:0,equitiesCourse:!1})}},computed:{price(){const{integer:t,decimal:e}=(0,v.T4)(this.cardData.preferential_price);return{integer:t,decimal:e}},savePrice(){const{integer:t,decimal:e}=(0,v.T4)(this.cardData.official_price-this.cardData.preferential_price);return{integer:t,decimal:e}},officialPrice(){const{integer:t,decimal:e}=(0,v.T4)(this.cardData.official_price);return`${t}.${e}`}},methods:{onClick(){this.$emit("click")}}},y={components:{FilterTab:p,CourseCard:(0,h.Z)(f,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"course-list-card",on:{click:t.onClick}},[s("div",{staticClass:"course-cover"},[s("van-image",{staticClass:"course-item-image",attrs:{"lazy-load":"",src:t.cardData.cover.ossimg(),radius:4}}),t.cardData.equitiesCourse?s("div",{staticClass:"equities-course van-ellipsis"},[t._v(t._s(t.cardData.equitiesName))]):t._e(),"package"===t.cardData.resource_type?s("div",{staticClass:"course-item-packagecard"},[t._v(t._s(t.$t("discovery.coursePackage")))]):t._e()],1),s("div",{staticClass:"course-item-info"},[s("div",{staticClass:"course-item-info-title van-ellipsis"},[t._v(t._s(t.cardData.title))]),s("div",{staticClass:"course-item-info-price"},[t.cardData.equitiesCourse?s("div",{staticClass:"equities-price"},[s("span",{staticClass:"text-normal"},[t._v("￥")]),s("span",{staticClass:"text-large"},[t._v("0")]),s("span",{staticClass:"text-small"},[t._v(".00")]),t.officialPrice>0?s("span",{staticClass:"text-delete"},[t._v("￥"+t._s(t.officialPrice))]):t._e()]):"true"===t.cardData.free?s("div",[t._v(" "+t._s(t.$t("discovery.free"))+" ")]):s("div",[s("span",[t._v("￥")]),s("span",{staticClass:"price-integer"},[t._v(t._s(t.price.integer))]),s("span",[t._v("."+t._s(t.price.decimal))])]),(t.savePrice.integer>0||t.savePrice.decimal>0)&&"package"===t.cardData.resource_type&&!t.cardData.equitiesCourse?s("div",{staticClass:"item-info-save-price van-ellipsis"},[t._v(" "+t._s(t.$t("discovery.saveMoney",{price:t.savePrice.integer+(t.savePrice.decimal>0?"."+t.savePrice.decimal:"")}))+" ")]):t._e()]),s("div",{staticClass:"course-item-info-tip"},["package"===t.cardData.resource_type?s("div",[s("svg-icon",{staticClass:"icon-font",attrs:{"icon-class":"icon-jingpinkecheng",size:12,color:"#C0C2CB"}}),s("span",[t._v(t._s(t.cardData.course_count))])],1):s("div",[s("svg-icon",{staticClass:"icon-font",attrs:{"icon-class":"icon-zan",size:12,color:"#C0C2CB"}}),s("span",[t._v(t._s(t.cardData.like_count))])],1)])])])}),[],!1,null,"4d5f6ce4",null).exports,FieldTab:g,[c.Z.name]:c.Z,[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z},props:{tabType:{type:String,default:"filter"},offsetTop:{type:Number,default:0}},data:()=>({dataLoading:!0,courseList:[],fieldList:[],loading:!1,finished:!0,page:{page_number:1,page_size:20},fieldId:""}),computed:{storeFilter(){return this.$store.state.discoveryFilter},urlQuery(){return this.$route.query},couresIds(){const{resourceType:t}=this.urlQuery;let e="";switch(t){case"coursePackage":e="package";break;case"course":e="course"}return{resource_type:this.storeFilter.resourceType.update?this.storeFilter.resourceType.id:e,field_id:this.storeFilter.field.id,post_id:this.storeFilter.post.id}},filterTab(){const t=[this.storeFilter.resourceType,this.storeFilter.field,this.storeFilter.post];if(!t[0].update){const{resourceType:e}=this.urlQuery;"coursePackage"===e&&(t[0]={title:this.$t("discovery.coursePackage"),id:"package",type:"resourceType"}),"course"===e&&(t[0]={title:this.$t("common.course"),id:"course",type:"resourceType"})}return t}},mounted(){this.fieldId=this.urlQuery.id,this.getCourses()},methods:{async getCourses(){let t={};t="field"===this.tabType?(0,a.Z)({field_id:this.fieldId},this.page):(0,a.Z)((0,a.Z)({keyword:this.storeFilter.keyword},this.page),this.couresIds);const{status:e,data:s}=await l.Z.getCourses(t);200===e&&(this.courseList=this.courseList.concat(s.list),this.finished="false"===s.has_next_page),this.dataLoading=!1,this.loading=!1},searchClick(){this.dataLoading=!0,this.page.page_number=1,this.courseList=[],this.getCourses()},onLoadMore(){this.page.page_number+=1,this.loading=!0,this.getCourses()},onFieldTabClick(t){this.dataLoading=!0,this.page.page_number=1,this.courseList=[],this.fieldId=t,this.getCourses()},handleToCourseDetail(t){"package"===t.resource_type?this.$router.push({path:`/discovery/course-package-detail?coursepackageId=${t.id}`}):this.$router.push({path:`/course-platform-detail?courseResource=platform&courseId=${t.id}&originType=${this.urlQuery.originType}`})}}},_=(0,h.Z)(y,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"course-list-container",class:t.offsetTop?"":"container-min-height"},["field"===t.tabType?s("van-sticky",[s("field-tab",{on:{click:t.onFieldTabClick}})],1):s("van-sticky",{attrs:{"offset-top":t._f("pxTransToVw")(t.offsetTop)}},[s("filter-tab",{attrs:{"filter-tab":t.filterTab}})],1),s("van-loading",{directives:[{name:"show",rawName:"v-show",value:t.dataLoading,expression:"dataLoading"}],staticClass:"course-list-center"}),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.dataLoading,expression:"!dataLoading"}]},[t.courseList.length?s("van-list",{staticClass:"course-list-content",attrs:{finished:t.finished,"finished-text":t.$t("promptMessage.expectTips")},on:{load:t.onLoadMore},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.courseList,(function(e){return s("course-card",{key:e.id,attrs:{"card-data":e},on:{click:function(s){return t.handleToCourseDetail(e)}}})})),1):s("van-empty",{staticClass:"course-list-center",attrs:{description:t.$t("common.noDataTextTip")}})],1)],1)}),[],!1,null,null,null).exports},9978:(t,e,s)=>{s.r(e),s.d(e,{default:()=>et});s(23307);var a=s(81392),i=(s(3791),s(93432)),o=(s(39610),s(2163)),r=(s(86039),s(20495)),n=(s(57658),s(34246)),c=s(26513),l=s(27632),u=s(51527),d=s(76710),h=(s(47601),s(44951)),p=(s(72975),s(98655)),m=(s(11155),s(91391)),g=s(63874),v={name:"DiscoverySwiper",components:{[m.Z.name]:m.Z,[p.Z.name]:p.Z,[h.Z.name]:h.Z},props:{data:{type:Array,default:()=>[]}},data:()=>({}),mounted(){},methods:{bannerJump(t){const{url:e,url_type:s}=t;switch(s){case"course":this.$router.push({path:`/course-platform-detail?courseResource=platform&courseId=${e}`});break;case"course_pack":this.$router.push({path:`/discovery/course-package-detail?coursepackageId=${e}`});break;case"micro_page":this.$router.push({path:`/discovery-mall/micro-page?id=${e}`});break;case"http":(0,g.N8)({url:e})}}}},f=s(1001),y=(0,f.Z)(v,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"discovery-swiper"},[s("van-swipe",{attrs:{autoplay:2e3,"indicator-color":"white"}},t._l(t.data,(function(e){return s("van-swipe-item",{key:e.id,on:{click:function(s){return t.bannerJump(e)}}},[s("van-image",{staticClass:"swiper-image",attrs:{src:e.image.ossimg(),radius:"8","lazy-load":""}})],1)})),1)],1)}),[],!1,null,"0b36ea6a",null).exports,_={name:"QuickEntry",components:{[h.Z.name]:h.Z},props:{data:{type:Array,default:()=>[]}},data:()=>({}),mounted(){},methods:{quickJump(t){const{url_type:e,url:s}=t;switch(e){case"all":this.$store.commit("discoveryFilter/resetFilter"),this.$router.push({path:"/discovery/discovery-courselist?type=allCourse"});break;case"course":this.$store.commit("discoveryFilter/resetFilter"),this.$router.push({path:"/discovery/discovery-courselist?type=allCourse&resourceType=course"});break;case"course_pack":this.$store.commit("discoveryFilter/resetFilter"),this.$router.push({path:"/discovery/discovery-courselist?type=allCourse&resourceType=coursePackage"});break;case"post":default:break;case"classify":{let t=s?s.split(",")[0]:"";this.$router.push({path:`/discovery/discovery-courselist?type=fieldCourse&id=${t}`})}break;case"micro_page":this.$router.push({path:`/discovery-mall/micro-page?id=${s}`});break;case"http":(0,g.N8)({url:s})}}}},C=(0,f.Z)(_,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},t._l(t.data,(function(e){return s("div",{key:e.id,staticClass:"item",on:{click:function(s){return t.quickJump(e)}}},[s("van-image",{staticClass:"icon",attrs:{src:e.image,radius:"8"}}),s("div",{staticClass:"title"},[t._v(t._s(e.title))])],1)})),0)}),[],!1,null,"50c7d61b",null).exports,I={name:"QuickEntry",components:{[h.Z.name]:h.Z},props:{data:{type:Array,default:()=>[]}},data:()=>({}),mounted(){},methods:{handleToCourseDetail(t){const{mobile_router_url:e}=t;if(e){const t=JSON.parse(e);t&&"微页面"===t.url_type&&this.$router.push({path:`/discovery-mall/micro-page?id=${t.url}`})}}}},b=(0,f.Z)(I,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},[s("div",{staticClass:"item"},[s("van-image",{staticClass:"icon2",attrs:{src:t.data[0].mobile_cover_url.ossimg(),radius:"8"},on:{click:function(e){return t.handleToCourseDetail(t.data[0])}}}),s("van-image",{staticClass:"icon2",attrs:{src:t.data[1].mobile_cover_url.ossimg(),radius:"8"},on:{click:function(e){return t.handleToCourseDetail(t.data[1])}}})],1),s("div",{staticClass:"item"},[s("van-image",{staticClass:"icon1",attrs:{src:t.data[2].mobile_cover_url.ossimg(),radius:"8"},on:{click:function(e){return t.handleToCourseDetail(t.data[2])}}})],1)])}),[],!1,null,"0b0da2b4",null).exports,w={name:"DiscoveryTitle",components:{[a.Z.name]:a.Z},props:{title:{type:String,default:""},showButton:{type:Boolean,require:!1,default:!1}},data:()=>({}),mounted(){},methods:{}},$=(0,f.Z)(w,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"title-container"},[s("div",{staticClass:"title"},[t._v(" "+t._s(t.title)+" ")]),t.showButton?s("div",{staticClass:"right"},[t._t("button")],2):t._e()])}),[],!1,null,"c46e1c58",null).exports,k=s(95082),S=s(22648);const T=t=>{const{equitiesTags:e,isEquitiesCourse:s,equitiesName:a}=t;let i="",o="",r="",n=[];return"string"==typeof e&&e.length>0&&(n=e.split(",")),s?(r=a,i="linear-gradient(330deg,#4278FF 0%,#76A0FF 100%)",o="#ffffff"):n.length>0&&(r="VIP免费",i="linear-gradient(180deg,#FFE7AF,#F2CA58)",o="#6B4500"),{courseMarkName:r,color:o,backgroundColor:i}};var Z={name:"CoursePackage",components:{[h.Z.name]:h.Z},props:{data:{type:Object,default:()=>{}}},data:()=>({course:null,markInfo:{}}),mounted(){this.initData()},methods:{initData(){const t=this.data,{integer:e,decimal:s}=(0,S.T4)(t.preferentialPrice);t.integer=e,t.decimal=s;const{integer:a,decimal:i}=(0,S.T4)(t.officialPrice);t.officialInteger=a,t.officialDecimal=i,this.markInfo=T(this.data),this.course=(0,k.Z)((0,k.Z)({},this.data),t)},handleToCoursePackDetail(t){this.$router.push({path:`/discovery/course-package-detail?coursepackageId=${t.id}`})}}},x=Z,P=(0,f.Z)(x,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.course?s("div",{staticClass:"package-course-item",on:{click:function(e){return t.handleToCoursePackDetail(t.course)}}},[s("div",{staticClass:"cover-container"},[s("div",{staticClass:"tag"},[t._v(" "+t._s(t.$t("course.coursePackage"))+" ")]),t.markInfo.courseMarkName?s("div",{staticClass:"mark",style:{color:t.markInfo.color,background:t.markInfo.backgroundColor}},[t._v(" "+t._s(t.markInfo.courseMarkName)+" ")]):t._e(),s("van-image",{staticClass:"package-item-image",attrs:{"lazy-load":"",src:t.course.cover.ossimg(),radius:8}})],1),s("div",{staticClass:"package-item-title van-ellipsis"},[t._v(t._s(t.course.title))]),s("div",{staticClass:"package-item-msg"},[s("div",{staticClass:"package-item-price"},[t.course.equitiesCourse?s("div",{staticClass:"package-item-price-sale"},[s("span",{staticClass:"text-large"},[t._v("￥0")]),s("span",{staticClass:"text-small"},[t._v(".00")]),t.officialPrice>0?s("span",{staticClass:"text-delete"},[t._v("￥"+t._s(t.course.officialInteger)+"."+t._s(t.course.officialDecimal))]):t._e()]):"true"===t.course.free?s("div",{staticClass:"package-item-price-sale"},[t._v(" "+t._s(t.$t("discovery.free"))+" ")]):s("div",{staticClass:"package-item-price-sale"},[s("span",{staticClass:"text-large"},[t._v("￥"+t._s(t.course.integer))]),s("span",{staticClass:"text-small"},[t._v("."+t._s(t.course.decimal))]),t.course.officialPrice>t.course.preferentialPrice?s("span",{staticClass:"text-delete"},[t._v("￥"+t._s(t.course.officialInteger)+"."+t._s(t.course.officialDecimal))]):t._e()])])])]):t._e()}),[],!1,null,"7a92ec18",null).exports,D={name:"RecommendCoursePack",components:{[a.Z.name]:a.Z,DiscoveryTitle:$,CoursePack:P},props:{data:{type:Object,required:!0,default:()=>{}},showNumber:{type:Number,require:!0,default:0}},data:()=>({loading:!1,list:[]}),mounted(){this.initData()},methods:{initData(){this.data.value&&this.data.value.url&&this.getCourseList(this.data.value.url,this.showNumber)},getCourseList(t,e){const s={pageNumber:1,pageSize:e,courseOrPackIds:t};n.Z.getCourseList(s).then((t=>{const{list:e=[]}=t.data;this.list=e}))},handleToMore(){this.$store.commit("discoveryFilter/resetFilter"),this.$router.push({path:"/discovery/discovery-courselist?type=allCourse&resourceType=coursePackage"})}}},L=(0,f.Z)(D,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.list&&t.list.length>0?s("div",{staticClass:"out-container"},[s("discovery-title",{attrs:{title:t.$t("discovery.boutiquePackage"),"show-button":!0}},[s("template",{slot:"button"},[s("span",{staticClass:"button",on:{click:t.handleToMore}},[t._v(t._s(t.$t("discovery.more")))])])],2),s("div",{staticClass:"course-list"},t._l(t.list,(function(t,e){return s("course-pack",{key:e,attrs:{data:t}})})),1)],1):t._e()}),[],!1,null,"9a9ec3fa",null).exports,A={name:"CoursePackage",components:{[h.Z.name]:h.Z},props:{data:{type:Object,default:()=>{}}},data:()=>({course:null,markInfo:{}}),mounted(){this.initData()},methods:{initData(){const t=this.data,{integer:e,decimal:s}=(0,S.T4)(t.preferentialPrice);t.integer=e,t.decimal=s;const{integer:a,decimal:i}=(0,S.T4)(t.officialPrice);t.officialInteger=a,t.officialDecimal=i,this.markInfo=T(this.data),this.course=(0,k.Z)((0,k.Z)({},this.data),t)},handleToCourseDetail(t){this.$router.push({path:`/course-platform-detail?courseResource=platform&courseId=${t.id}`})}}},E=A,R=(0,f.Z)(E,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.course?s("div",{staticClass:"course-item",on:{click:function(e){return t.handleToCourseDetail(t.course)}}},[s("div",{staticClass:"cover-container"},[s("van-image",{staticClass:"course-item-image",attrs:{"lazy-load":"",src:t.course.cover.ossimg(),radius:8}}),t.markInfo.courseMarkName?s("div",{staticClass:"mark",style:{color:t.markInfo.color,background:t.markInfo.backgroundColor}},[t._v(" "+t._s(t.markInfo.courseMarkName)+" ")]):t._e()],1),s("div",{staticClass:"course-item-info"},[s("div",[s("div",{staticClass:"course-item-title van-ellipsis"},[t._v(t._s(t.course.title))]),t.course.teacherName?s("div",{staticClass:"course-item-info-body"},[t._v(" "+t._s(t.course.teacherName)+" "),s("span",{staticClass:"course-split"},[t._v("|")]),t._v(" "+t._s(t.$t("course.scanCount",{scanCount:t.course.scanCount}))+" ")]):t._e()]),s("div",{staticClass:"course-item-price"},[t.course.equitiesCourse?s("div",{staticClass:"course-item-price-sale"},[s("span",{staticClass:"text-large"},[t._v("￥0")]),s("span",{staticClass:"text-small"},[t._v(".00")]),t.officialPrice>0?s("span",{staticClass:"text-delete"},[t._v("￥"+t._s(t.course.officialInteger)+"."+t._s(t.course.officialDecimal))]):t._e()]):"true"===t.course.free?s("div",{staticClass:"course-item-price-sale"},[t._v(" "+t._s(t.$t("discovery.free"))+" ")]):s("div",{staticClass:"course-item-price-sale"},[s("span",{staticClass:"text-large"},[t._v("￥"+t._s(t.course.integer))]),s("span",{staticClass:"text-small"},[t._v("."+t._s(t.course.decimal))]),t.course.officialPrice>t.course.preferentialPrice?s("span",{staticClass:"text-delete"},[t._v("￥"+t._s(t.course.officialInteger)+"."+t._s(t.course.officialDecimal))]):t._e()])])])]):t._e()}),[],!1,null,"742d5f51",null).exports,F={name:"RecommendCoursePack",components:{[a.Z.name]:a.Z,DiscoveryTitle:$,Course:R},props:{data:{type:String,required:!0,default:""},showNumber:{type:Number,require:!0,default:0}},data:()=>({loading:!1,list:[]}),mounted(){this.getCourseList()},methods:{getCourseList(){const t={pageNumber:1,pageSize:this.showNumber,courseOrPackIds:this.data};n.Z.getCourseList(t).then((t=>{const{list:e=[]}=t.data;this.list=e}))},handleToMore(){this.$store.commit("discoveryFilter/resetFilter"),this.$router.push({path:"/discovery/discovery-courselist?type=allCourse&resourceType=course"})}}},q=(0,f.Z)(F,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"out-container"},[s("discovery-title",{attrs:{title:t.$t("discovery.recommendCourse"),"show-button":!0}},[s("template",{slot:"button"},[s("span",{staticClass:"button",on:{click:t.handleToMore}},[t._v(t._s(t.$t("discovery.more")))])])],2),s("div",{staticClass:"course-list"},t._l(t.list,(function(t){return s("course",{key:t.id,attrs:{data:t}})})),1)],1)}),[],!1,null,"3533f72e",null).exports,N={name:"HotRankItem",components:{[h.Z.name]:h.Z},props:{data:{type:Object,require:!0,default:()=>{}}},data:()=>({}),mounted(){},methods:{handleToCourseDetail(t){this.$router.push({path:`/course-platform-detail?courseResource=platform&courseId=${t.id}`})}}},O=N,M=(0,f.Z)(O,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"hot-list-item",on:{click:function(e){return t.handleToCourseDetail(t.data)}}},[s("div",{staticClass:"item-right"},[s("div",{staticClass:"top"},[s("span",{staticClass:"index",style:"color: "+t.data.itemNoColor},[t._v(" "+t._s(""+(t.data.index+1))+" ")]),s("span",{staticClass:"title van-ellipsis"},[t._v(" "+t._s(t.data.title)+" ")])]),s("div",{staticClass:"bottom"},[s("img",{staticClass:"icon",attrs:{src:"https://oss.coolcollege.cn/2289865054675406848.png"}}),t._v(" "+t._s(t.data.scan_count)+" ")])]),s("van-image",{staticClass:"cover",attrs:{src:t.data.cover.ossimg(),"lazy-load":"",radius:4}})],1)}),[],!1,null,"837b0448",null).exports,B={name:"RecommendCoursePack",components:{[a.Z.name]:a.Z,DiscoveryTitle:$,HotRankItem:M},data:()=>({loading:!1,list:[]}),mounted(){this.getTopList()},methods:{async getTopList(){this.list=[];const t=await c.Z.getTopList(),{code:e,data:s}=t.data;"200000"===e&&(this.list=s.map(((t,e)=>(t.itemNoColor=0===e?"#F13655":1===e?"#FD7100":2===e?"#FFA602":"#B6BCC9",t.index=e,t))))}}},V=(0,f.Z)(B,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.list&&t.list.length>0?s("div",{staticClass:"hot-rank-container"},[s("discovery-title",{attrs:{title:t.$t("discovery.hotCourse")}}),s("div",{staticClass:"course-list"},t._l(t.list,(function(t,e){return s("hot-rank-item",{key:e,attrs:{data:t}})})),1)],1):t._e()}),[],!1,null,"d471d0de",null).exports,U={name:"ProjectItem",components:{[h.Z.name]:h.Z},props:{data:{type:Object,default:()=>{}}},mounted(){},methods:{handleToCourseDetail(t){"course_pack"===t.url_type?this.$router.push({path:`/discovery/course-package-detail?coursepackageId=${t.url}`}):"micro_page"===t.url_type&&this.$router.push({path:`/discovery-mall/micro-page?id=${t.url}`})}}},j=U,z=(0,f.Z)(j,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"project-item",on:{click:function(e){return t.handleToCourseDetail(t.data)}}},[s("van-image",{staticClass:"project-item-image",attrs:{"lazy-load":"",src:t.data.image.ossimg()}}),s("div",{staticClass:"project-item-info"},[s("div",{staticClass:"project-item-title van-ellipsis"},[t._v(t._s(t.data.title))]),s("div",{staticClass:"project-item-desc van-ellipsis"},[t._v(" "+t._s(t.data.description)+" ")])])],1)}),[],!1,null,"d0e3cdd0",null).exports,H={name:"EnterpriseStudyProject",components:{[a.Z.name]:a.Z,DiscoveryTitle:$,ProjectItem:z},props:{data:{type:Array,required:!0,default:()=>[]}},data:()=>({}),mounted(){},methods:{}},G=(0,f.Z)(H,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.data&&t.data.length>0?s("div",{staticClass:"out-container"},[s("discovery-title",{attrs:{title:t.$t("discovery.enterpriseStudyProject")}}),s("div",{staticClass:"course-container"},[s("div",{staticClass:"course-list"},t._l(t.data,(function(t,e){return s("project-item",{key:e,attrs:{data:t}})})),1)])],1):t._e()}),[],!1,null,"123d4b30",null).exports,Q=s(27484),W=s.n(Q),K=(s(73474),{name:"DiscoverySkeleton",components:{VanPopup:s(74755).Z},data:function(){return{show:!0}},computed:{},mounted(){},methods:{closeSkeleton(){this.show&&(this.show=!1)}}}),J=(0,f.Z)(K,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("van-popup",{style:{height:"100%",overflowY:"hidden"},attrs:{duration:0,"close-on-click-overlay":!1},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[s("div",{staticClass:"skeleton-content"},[s("div",{staticClass:"skeleton-header"},[s("div",{staticClass:"skeleton-header-search"})]),s("div",{staticClass:"skeleton-banner"},[s("div",{staticClass:"sub-banner"}),s("div",{staticClass:"main-banner"}),s("div",{staticClass:"sub-banner"})]),s("div",{staticClass:"row-space"},[s("div",{staticClass:"row-main"}),s("div",{staticClass:"row-sub"})]),s("div",{staticClass:"row-width-content"},[s("div",{staticClass:"row-width"})]),s("div",{staticClass:"row-flex"},t._l(new Array(4).fill("test"),(function(t,e){return s("div",{key:e,staticClass:"row-item"},[s("div",{staticClass:"item-main"}),s("div",{staticClass:"item-title"}),s("div",{staticClass:"item-subTitle"})])})),0)]),s("BottomTarbar",{attrs:{active:"discover"}})],1)}),[],!1,null,"73c7bd72",null).exports,Y={name:"Recommend",components:{DiscoveryTitle:$,[h.Z.name]:h.Z},data:()=>({pageNumber:1,courses:[]}),mounted(){this.getRecommendCourses()},methods:{async getRecommendCourses(){const t={page_number:this.pageNumber,page_size:6,position:"discovery"},e=await c.Z.getRecommendCourses(t),{status:s,data:a}=e;200===s&&(this.courses=a.courses)},handleChange(){this.pageNumber+=1,this.getRecommendCourses()},handleToCourseDetail(t){this.$router.push({path:`/course-platform-detail?courseResource=platform&courseId=${t}`})}}},X=(0,f.Z)(Y,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"guess-like"},[s("discovery-title",{attrs:{title:t.$t("discovery.guessYouLike"),"show-button":!0}},[s("template",{slot:"button"},[s("span",{staticClass:"button",on:{click:t.handleChange}},[t._v(" "+t._s(t.$t("course.change"))+" ")])])],2),s("div",{staticClass:"course-list"},t._l(t.courses,(function(e){return s("van-image",{key:e.id,staticClass:"course-cover",attrs:{"lazy-load":"",src:e.cover.ossimg(),radius:8},on:{click:function(s){return t.handleToCourseDetail(e.id)}}})})),1)],1)}),[],!1,null,"9b32001c",null).exports,tt={name:"DiscoveryMall",components:{[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,[a.Z.name]:a.Z,BottomTabbar:u.Z,DiscoverySwiper:y,QuickEntry:C,Combo:b,RecommendCoursePack:L,RecommendCourse:q,HotRank:V,EnterpriseStudyProject:G,Find:d.default,DiscoverySkeleton:J,GuessLike:X},data:()=>({dataLoading:!0,isOpen:"false",scopeId:0,configData:{}}),computed:{isDingTalk:()=>"dingTalk"===l.Z.env},mounted(){this.judgeDiscover()},methods:{closeLoadingSkeleton(){this.$refs.discoverSkeleton&&this.$refs.discoverSkeleton.closeSkeleton()},judgeDiscover(){c.Z.checkFindOpen().then((t=>{if(200===t.data.code)if(t.data.data){const{scope_id:e,open_find_page:s}=t.data.data;this.isOpen=s,this.scopeId=e,this.$store.commit("updateRouteStack",{query:{scopeId:e}}),this.queryMainData()}else this.getDiscoveryConfigAll()})).catch((()=>{this.$nextTick((()=>{this.closeLoadingSkeleton()}))}))},queryMainData(){const t={scope:1,businessType:"mobile-find",scopeId:this.scopeId,tiemtemp:W()().valueOf()};n.Z.getMainData(t).then((t=>{if(2e5===t.data.code){const{componentList:e,pageTemplateContext:s}=t.data.data,a=s?JSON.parse(s):{};!s||a.firstTime||e.length<=0?(this.isOpen="false",this.getDiscoveryConfigAll()):this.dataLoading=!1}else this.isOpen="false",this.getDiscoveryConfigAll()})).catch((()=>{this.isOpen="false",this.getDiscoveryConfigAll()}))},getDiscoveryConfigAll(){this.getConfigData()},onSearch(){this.$store.commit("discoveryFilter/resetFilter"),this.$router.push({path:"/discovery/discovery-search"})},handleViewAll(){this.$store.commit("discoveryFilter/resetFilter"),this.$router.push({path:"/discovery/discovery-courselist?type=allCourse"})},async getConfigData(){const t=await c.Z.getConfigData({terminal:"app"}),{code:e,data:s}=t.data;this.dataLoading=!1,"200000"===e&&(this.configData=s,this.$nextTick((()=>{this.closeLoadingSkeleton()})))}}},et=(0,f.Z)(tt,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"discovery-out"},["false"===t.isOpen?s("div",{staticClass:"discovery-container"},[s("van-sticky",[s("van-search",{staticClass:"search",attrs:{disabled:"",placeholder:t.$t("discovery.searchPlaceholder")},on:{click:t.onSearch}})],1),t.dataLoading?s("van-loading",{staticClass:"discovery-loading-center"}):s("div",[t.configData.banners&&t.configData.banners.value?s("discovery-swiper",{attrs:{data:t.configData.banners.value}}):t._e(),t.configData.quick_entry&&t.configData.quick_entry.value?s("quick-entry",{attrs:{data:t.configData.quick_entry.value}}):t._e(),t.configData.combos&&t.configData.combos.value?s("combo",{attrs:{data:t.configData.combos.value}}):t._e(),t.configData.recommend_course_pack?s("recommend-course-pack",{attrs:{data:t.configData.recommend_course_pack,"show-number":6}}):t._e(),t.configData.recommend_course&&t.configData.recommend_course.value&&t.configData.recommend_course.value.url?s("recommend-course",{attrs:{data:t.configData.recommend_course.value.url,"show-number":6}}):t._e(),s("hot-rank"),t.configData.enterprise_study_projects&&t.configData.enterprise_study_projects.value.length>0?s("enterprise-study-project",{attrs:{data:t.configData.enterprise_study_projects.value}}):t._e(),s("guess-like"),s("div",{staticClass:"all-course"},[s("div",{staticClass:"all-course-button",on:{click:t.handleViewAll}},[t._v(t._s(t.$t("discovery.viewAllCourses")))])])],1),s("bottom-tabbar",{attrs:{active:"discover"}})],1):s("Find",{attrs:{"scope-id":t.scopeId},on:{closeLoading:t.closeLoadingSkeleton}}),s("DiscoverySkeleton",{ref:"discoverSkeleton"})],1)}),[],!1,null,"d99eaaa8",null).exports},64932:(t,e,s)=>{s.r(e),s.d(e,{default:()=>c});s(25773);var a=s(35791),i=(s(47601),s(44951)),o=(s(57658),s(26513)),r=s(32900),n={components:{[i.Z.name]:i.Z,[a.Z.name]:a.Z},data:()=>({microPage:{}}),mounted(){const{query:t}=this.$route;this.id=t.id,this.id&&this.getMicroDetail(this.id)},methods:{getMicroDetail(t){this.$toast.loading({duration:0,forbidClick:!0}),o.Z.queryMicroDetail(t).then((t=>{const{data:e}=t.data;e&&e.mobile_image_list&&(this.$toast.clear(),this.microPage=e)}))},onContactService(){this.$router.push({path:"/online-service"})},onTapBuy(){this.$dialog({title:this.$t("promptMessage.warmTips"),message:this.$t("promptMessage.notAdmin"),confirmButtonColor:this.$store.state.themeColor.primaryColor})},async getGoodsUrl(t){const{status:e,data:s}=await o.Z.getGoodsUrl(this.corpId,t);200===e&&(this.goodsUrl=s.result)},async getCurrentUserInfo(){const{status:t,data:e}=await r.Z.getUserGoodsInfo();200===t&&(this.isDDAdmin=e.isAdmin)}}},c=(0,s(1001).Z)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"micro-page-container"},[t._l(t.microPage.mobile_image_list,(function(t,e){return s("van-image",{key:e,staticClass:"image",attrs:{"lazy-load":"",src:t.ossimg()}})})),s("div",{staticClass:"footer"},[s("van-button",{staticClass:"micro-footer-button buy-btn",on:{click:t.onContactService}},[t._v(" "+t._s(t.$t("discovery.onlineConsultation"))+" ")])],1)],2)}),[],!1,null,"30387706",null).exports},99430:(t,e,s)=>{s.r(e),s.d(e,{default:()=>l});s(3791);var a=s(93432),i=(s(25773),s(35791)),o=(s(49153),s(5944)),r=(s(19465),s(74912)),n=s(26513),c={components:{[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,[a.Z.name]:a.Z},data:()=>({dataLoading:!0,filterLists:[],firstActiveIndex:0,firstActiveId:"",secondActiveIndex:0,secondActiveId:"",currentItem:{}}),computed:{filterType(){return this.$route.query.filterType},initId(){return this.$route.query.initId},allItem(){return{text:this.$t("common.all"),id:""}},selectedItem(){return this.currentItem.id?this.currentItem:this.secondActiveIndex?this.filterLists[this.firstActiveIndex].children[this.secondActiveIndex]:this.filterLists[this.firstActiveIndex]}},mounted(){this.getData()},methods:{async getData(){if("resourceType"===this.filterType){this.filterLists=this.getResourceTypeData();const t=this.filterLists.findIndex((t=>t.id===this.initId));return this.firstActiveIndex=t>-1?t:0,void(this.dataLoading=!1)}"post"===this.filterType?this.filterLists=await n.Z.courseFilterPost():"field"===this.filterType&&(this.filterLists=await n.Z.courseFilterField()),this.dataLoading=!1},getResourceTypeData(){return[{text:this.$t("discovery.allType"),id:""},{text:this.$t("common.course"),id:"course",children:[this.allItem]},{text:this.$t("discovery.coursePackage"),id:"package",children:[this.allItem]}]},onFirstNavClick(t){this.firstActiveIndex=t,this.firstActiveId="",this.secondActiveIndex=0,this.currentItem={}},onSecondNavClick(t){this.secondActiveIndex=t,this.secondActiveId="",this.currentItem={}},handleResetFilter(){this.firstActiveIndex=0,this.firstActiveId="",this.secondActiveIndex=0,this.secondActiveId=""},handleSureFilter(){const t={title:this.selectedItem.text,id:this.selectedItem.id,type:this.filterType,update:!0};this.$store.commit("discoveryFilter/setFilter",t),this.$router.go(-1)},onSetItem(t){this.currentItem=t}}},l=(0,s(1001).Z)(c,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"course-filter-container"},[t.dataLoading?s("van-loading",{staticClass:"course-filter-loading-center"}):s("van-tree-select",{staticClass:"course-filter-tree",attrs:{height:"100vh",items:t.filterLists,"main-active-index":t.firstActiveIndex,"active-id":t.firstActiveId},on:{"update:mainActiveIndex":function(e){t.firstActiveIndex=e},"update:main-active-index":function(e){t.firstActiveIndex=e},"update:activeId":function(e){t.firstActiveId=e},"update:active-id":function(e){t.firstActiveId=e},"click-nav":t.onFirstNavClick,"click-item":t.onSetItem},scopedSlots:t._u(["post"!==t.filterType&&t.firstActiveIndex?null:{key:"content",fn:function(){return[t.firstActiveIndex?t._e():s("van-empty",{attrs:{description:t.$t("discovery.selectedAll")}}),"post"===t.filterType&&t.firstActiveIndex?s("div",[s("van-tree-select",{staticClass:"course-filter-second-tree",attrs:{items:t.filterLists[t.firstActiveIndex].children,"main-active-index":t.secondActiveIndex,"active-id":t.secondActiveId},on:{"update:mainActiveIndex":function(e){t.secondActiveIndex=e},"update:main-active-index":function(e){t.secondActiveIndex=e},"update:activeId":function(e){t.secondActiveId=e},"update:active-id":function(e){t.secondActiveId=e},"click-nav":t.onSecondNavClick,"click-item":t.onSetItem}})],1):t._e()]},proxy:!0}],null,!0)}),s("div",{staticClass:"course-filter-btn"},[s("van-button",{staticClass:"filter-btn",on:{click:t.handleResetFilter}},[t._v(" "+t._s(t.$t("buttons.reset")))]),s("van-button",{staticClass:"filter-btn primary-btn",on:{click:t.handleSureFilter}},[t._v(" "+t._s(t.$t("common.confirm")))])],1)],1)}),[],!1,null,"791a391b",null).exports},38291:(t,e,s)=>{s.r(e),s.d(e,{default:()=>f});s(31146);var a=s(41610),i=s(95082),o=(s(39610),s(2163)),r=(s(25773),s(35791)),n=(s(82500),s(49414)),c=(s(82522),s(10342)),l=(s(47601),s(44951)),u=(s(57658),s(26513)),d=s(22648),h=s(27632),p=s(85384),m=s(78551),g=s(26294),v={components:{OverlayLoading:p.Z,SvgIcon:m.Z,[l.Z.name]:l.Z,[c.Z.name]:c.Z,[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z},data:()=>({coursepackageId:"",loading:!0,detailData:{},tabsActive:0,equitiesTags:[]}),computed:(0,i.Z)({primaryColor(){return this.$store.state.themeColor.primaryColor},discountPrice(){const{integer:t,decimal:e}=(0,d.T4)(this.detailData.preferentialPrice);return{integer:t,decimal:e}},realPrice(){const{integer:t,decimal:e}=(0,d.T4)(this.detailData.officialPrice);return{integer:t,decimal:e}},savePrice(){const{integer:t,decimal:e}=(0,d.T4)(this.detailData.officialPrice-this.detailData.preferentialPrice);return{integer:t,decimal:e}}},(0,g.mapGetters)({primaryColor:"getPrimaryColor"})),mounted(){this.coursepackageId=this.$route.query.coursepackageId,this.loadDetails()},methods:{async loadDetails(){const t={id:this.coursepackageId};this.loading=!0;try{const e=await u.Z.loadCoursepackageDetails(t);this.detailData=e.data,this.getEquitiesTags(),this.loading=!1}catch(t){this.loading=!1}},toFormatPrice:t=>(0,d.T4)(t),handletoCourseDetails(t){this.$router.push({path:`/course-platform-detail?courseId=${t}&courseResource=platform`})},handleLinkToListen(t,e){this.$router.push({path:`/course-platform-detail?courseId=${t}&courseResource=platform&listenResource=${e}`})},contactService(){if("dingTalk"===h.Z.env){const t="https://h5.dingtalk.com/appcenter/detail.html?showmenu=false&dd_share=false&articleCode=FW_GOODS-1000651011&goodsCode=FW_GOODS-1000651011";h.Z.openLink({url:t})}else this.$dialog({title:this.$t("promptMessage.warmTips"),message:this.$t("discovery.updateMessage"),confirmButtonText:this.$t("promptMessage.roger"),confirmButtonColor:this.$store.state.themeColor.primaryColor})},handleAddToEnterpriseLibrary(){const t=this.$t("course.settingCourseHintText",{name:this.detailData.packName});a.Z.confirm({message:t,confirmButtonText:this.$t("community.confirm"),cancelButtonText:this.$t("common.cancel"),confirmButtonColor:this.primaryColor}).then((()=>{this.detailData.isEquitiesCourse&&this.AddToEnterpriseLibrary(this.detailData.id)})).catch((()=>{}))},AddToEnterpriseLibrary(t){let e={import_type:"select",resource_id_list:[t]};u.Z.AddToEnterpriseLibrary(e).then((t=>{"true"===t.data.success?(this.$toast({type:"success",message:this.$t("common.operateSuccess"),duration:3e3}),this.detailData.enterpriseBought=!0):this.$toast({message:this.$t("common.operateErrorWithRepeat"),duration:3e3})}))},getEquitiesTags(){let{equitiesTags:t,isEquitiesCourse:e}=this.detailData,s=[];!e&&"string"==typeof t&&t.length>0&&(s=t.split(",").map(((t,e)=>({name:t,id:e})))),s.forEach((t=>{t.backgroundStyle="平台版"===t?"#FF7C7C linear-gradient(153deg,#9B8BF8 0%,#7E66F8 100%)":"领航版"===t?"#D8D8D8 linear-gradient(159deg,#56588E 0%,#1A1D3B 100%)":"linear-gradient(330deg,#4278FF 0%,#76A0FF 100%)"})),this.equitiesTags=s}}},f=(0,s(1001).Z)(v,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"package-detail-container"},[s("overlay-loading",{attrs:{show:t.loading}}),t.loading?t._e():s("div",[s("van-image",{staticClass:"package-detail-image",attrs:{"lazy-load":"",src:t.detailData.cover}}),s("van-tabs",{attrs:{sticky:"",color:t.primaryColor},model:{value:t.tabsActive,callback:function(e){t.tabsActive=e},expression:"tabsActive"}},[s("van-tab",{staticClass:"package-detail-tab",attrs:{title:t.$t("course.coursePackageDesc")}},[s("div",{staticClass:"package-detail-info"},[s("div",{staticClass:"info-title"},[t._v(t._s(t.detailData.packName))]),s("div",{staticClass:"info-price"},[s("div",[t.detailData.isEquitiesCourse?s("div",{staticClass:"info-price-value"},[s("div",{staticClass:"equities-course van-ellipsis"},[t._v(t._s(t.detailData.equitiesName))]),s("div",{style:{color:t.primaryColor}},[s("span",[t._v("￥")]),s("span",{staticClass:"text-large"},[t._v("0")]),s("span",[t._v(".00")])]),s("div",{staticClass:"real-price"},[t._v(" ￥"+t._s(t.realPrice.integer+"."+t.realPrice.decimal)+" ")])]):t.detailData.free?s("div",{staticClass:"price-free"},[t._v(t._s(t.$t("discovery.free")))]):s("div",{staticClass:"info-price-value"},[s("div",{style:{color:t.primaryColor}},[s("span",[t._v("￥")]),s("span",{staticClass:"text-large"},[t._v(t._s(t.discountPrice.integer))]),s("span",[t._v("."+t._s(t.discountPrice.decimal))])]),s("div",{staticClass:"real-price"},[t._v(" ￥"+t._s(t.realPrice.integer+"."+t.realPrice.decimal)+" ")]),(t.savePrice.integer>0||t.savePrice.decimal>0)&&!t.detailData.isEquitiesCourse?s("div",{staticClass:"save-price"},[t._v(" "+t._s(t.$t("discovery.saveMoney",{price:t.savePrice.integer+(t.savePrice.decimal>0?"."+t.savePrice.decimal:"")}))+" ")]):t._e()])]),s("div",[s("svg-icon",{attrs:{"icon-class":"icon-datishichang",size:12,color:"#2D3040"}}),t._v(" "+t._s(t.detailData.free?t.$t("course.permanent"):t.$t("course.validPeriod",{period:t.detailData.validity}))+" ")],1)]),s("div",{staticClass:"info-tip"},[t.detailData.isEquitiesCourse?s("div",{staticClass:"info-tip-courses",staticStyle:{"margin-right":"20px"}},[t._v(" "+t._s(t.$t("course.copies"))+":"+t._s(t.$t("pointsMall.unlimited"))+" ")]):t._e(),s("div",{staticClass:"info-tip-courses"},[s("svg-icon",{staticClass:"icon-font",attrs:{"icon-class":"icon-jingpinkecheng",size:12,color:"#7F849A"}}),s("span",[t._v(t._s(t.$t("course.featuredCourses"))+" "+t._s(t.detailData.courseCount))])],1),s("div",{staticClass:"info-tip-view"},[t._v(" "+t._s(t.detailData.scanCount)+" "+t._s(t.$t("discovery.peopleLearning"))+" ")])]),t.equitiesTags.length>0?s("div",{staticClass:"tag-container"},t._l(t.equitiesTags,(function(e){return s("div",{key:e.id,staticClass:"tag",style:{background:e.backgroundStyle}},[t._v(" "+t._s(e.name)+" ")])})),0):t._e()]),s("div",{staticClass:"package-detail-introduce"},[s("div",{staticClass:"introduce-title"},[t._v(" "+t._s(t.$t("discovery.detailDesc")))]),s("div",{staticClass:"introduce-html",domProps:{innerHTML:t.xss(t._s(t.detailData.intro))}})])]),s("van-tab",{staticClass:"package-detail-tab",attrs:{title:t.$t("course.coursePackageCate")}},t._l(t.detailData.chapterList,(function(e,a){return s("div",{key:e.id},[s("div",{staticClass:"package-detail-chapter-item"},[s("div",{staticClass:"chapter-item-title"},[t._v(" "+t._s(t.$t("discovery.chapter",{idx:a+1}))+" "+t._s(e.chapterName)+" ")]),t._l(e.courseList,(function(e){return s("div",{key:e.id,staticClass:"course-item",on:{click:function(s){return t.handletoCourseDetails(e.id)}}},[s("van-image",{staticClass:"course-item-image",attrs:{"lazy-load":"",src:e.cover,radius:4}}),s("div",{staticClass:"course-item-info"},[s("div",{staticClass:"course-item-info-title van-ellipsis"},[t._v(" "+t._s(e.title)+" ")]),s("div",{staticClass:"course-item-info-price"},[s("span",[t._v("￥")]),s("span",{staticClass:"price-integer"},[t._v(t._s(t.toFormatPrice(e.officialPrice).integer))]),s("span",[t._v("."+t._s(t.toFormatPrice(e.officialPrice).decimal))])]),s("div",{staticClass:"course-item-info-tip"},[s("div",{staticClass:"course-item-info-tip-name van-ellipsis"},[s("span",{staticClass:"course-item-info-tip-teacher"},[s("svg-icon",{staticClass:"icon-font",attrs:{"icon-class":"icon-Eren",size:12,color:"#C0C2CB"}}),t._v(" "+t._s(e.teacherName)+" ")],1),s("span",[s("svg-icon",{staticClass:"icon-font",attrs:{"icon-class":"icon-e-view",size:12,color:"#C0C2CB"}}),t._v(" "+t._s(e.scanCount)+" ")],1)]),e.listenTestCount?s("div",{staticClass:"course-item-info-tip-listen",on:{click:function(s){return s.stopPropagation(),t.handleLinkToListen(e.id,e.listenSourceId)}}},[s("svg-icon",{staticClass:"icon-font",attrs:{"icon-class":"icon-shiting",size:12,color:t.primaryColor}}),t._v(" "+t._s(t.$t("course.tryListen"))+" ")],1):t._e()])])],1)}))],2),s("div",{staticClass:"package-detail-course-bottom"})])})),0)],1),s("div",{staticClass:"package-detail-button"},[t.detailData.userBought?s("div",{staticClass:"bought-button"},[s("svg-icon",{staticClass:"icon-font",attrs:{"icon-class":"icon-duigou",size:12,color:t.primaryColor}}),t._v(" "+t._s(t.$t("course.purchased"))+" ")],1):t.detailData.isEquitiesCourse?s("div",{staticStyle:{width:"100%"}},[t.detailData.enterpriseBought?s("div",{staticClass:"enterpriseBought-button"},[t._v(" "+t._s(t.$t("course.enterpriseBought"))+" ")]):s("van-button",{staticClass:"upgrade-button",attrs:{block:"",color:t.primaryColor},on:{click:t.handleAddToEnterpriseLibrary}},[t._v(" "+t._s(t.$t("course.settingCourseFree"))+" ")])],1):s("van-button",{staticClass:"upgrade-button",attrs:{block:"",color:t.primaryColor},on:{click:t.contactService}},[t._v(" "+t._s(t.$t("course.upgradeVersion"))+" ")])],1)],1)],1)}),[],!1,null,null,null).exports},54040:(t,e,s)=>{s.r(e),s.d(e,{default:()=>r});s(39610);var a=s(2163),i=(s(86039),s(20495)),o={components:{CourseList:s(52415).Z,[i.Z.name]:i.Z,[a.Z.name]:a.Z},data:()=>({value:""}),computed:{tabType(){return"fieldCourse"===this.$route.query.type?"field":"filter"},showAction(){return Boolean(this.value)}},methods:{onSearch(t){this.$store.commit("discoveryFilter/setKeyword",t),this.$refs.courseList.searchClick()},onClearSearch(){this.$store.commit("discoveryFilter/resetFilter")},onInput(t){t||this.onClearSearch()}}},r=(0,s(1001).Z)(o,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},["field"!==t.tabType?s("van-sticky",[s("van-search",{staticClass:"discovery-search-search",attrs:{"show-action":t.showAction,placeholder:"请输入要搜索的课程名称"},on:{search:t.onSearch,clear:t.onClearSearch,input:t.onInput},scopedSlots:t._u([{key:"action",fn:function(){return[s("div",{on:{click:function(e){return t.onSearch(t.value)}}},[t._v("搜索")])]},proxy:!0}],null,!1,2717908368),model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1):t._e(),s("course-list",{ref:"courseList",attrs:{"tab-type":t.tabType,"offset-top":54}})],1)}),[],!1,null,"3b6acb86",null).exports},33544:(t,e,s)=>{s.r(e),s.d(e,{default:()=>c});s(39610);var a=s(2163),i=(s(86039),s(20495)),o=(s(26699),s(32023),s(30541),s(38862),{props:{historySearch:{type:Array,default:()=>[]}},computed:{hotSearch(){return[this.$t("course.sales"),this.$t("course.management"),this.$t("course.market"),this.$t("course.production"),this.$t("course.enterprise"),this.$t("course.purchase"),this.$t("course.restaurant"),this.$t("course.hotel"),this.$t("course.financial")]}}}),r=s(1001),n={name:"DiscoverySearch",components:{SearchList:(0,r.Z)(o,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"discovery-search-list"},[s("div",{staticClass:"discovery-search-hot"},[s("div",{staticClass:"discovery-search-list-title"},[s("span",[t._v(" "+t._s(t.$t("discovery.hotSearch")))])]),s("div",{staticClass:"hot-search-content"},t._l(t.hotSearch,(function(e){return s("span",{key:e,staticClass:"hot-search-tab",on:{click:function(s){return t.$emit("clickTab",e)}}},[t._v(t._s(e))])})),0)]),t.historySearch.length?s("div",{staticClass:"discovery-search-history"},[s("div",{staticClass:"discovery-search-list-title"},[s("span",[t._v(" "+t._s(t.$t("discovery.historySearch")))]),s("span",{staticClass:"search-clear",on:{click:function(e){return t.$emit("clearHistory")}}},[t._v(" "+t._s(t.$t("discovery.clearHistorySearch")))])]),s("div",{staticClass:"history-search-content"},t._l(t.historySearch,(function(e){return s("div",{key:e,staticClass:"history-search-tab",on:{click:function(s){return t.$emit("clickTab",e)}}},[t._v(t._s(e))])})),0)]):t._e()])}),[],!1,null,"55b588d4",null).exports,CourseList:s(52415).Z,[i.Z.name]:i.Z,[a.Z.name]:a.Z},data:()=>({value:"",historySearch:[]}),computed:{showAction(){return Boolean(this.value)},keyword(){return this.$store.state.discoveryFilter.keyword}},mounted(){this.value=this.keyword,this.getHistorySearch()},methods:{onSearch(t){this.saveHistorySearch(t),this.$store.commit("discoveryFilter/setKeyword",t),this.$refs.courseList.searchClick()},onClearSearch(){this.$store.commit("discoveryFilter/resetFilter")},onInput(t){t||this.onClearSearch()},getHistorySearch(){try{const t=localStorage.getItem("historySearch");t&&(this.historySearch=JSON.parse(t))}catch(t){this.historySearch=[]}},saveHistorySearch(t){this.historySearch.includes(t)||(this.historySearch.unshift(t),this.historySearch.length>15&&this.historySearch.splice(15),localStorage.setItem("historySearch",JSON.stringify(this.historySearch)))},tabSearch(t){this.saveHistorySearch(t),this.$store.commit("discoveryFilter/setKeyword",t),this.value=t},clearHistory(){localStorage.removeItem("historySearch"),this.historySearch=[]}}},c=(0,r.Z)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"discovery-search-container"},[s("van-sticky",[s("van-search",{staticClass:"discovery-search-search",attrs:{"show-action":t.showAction,placeholder:"请输入要搜索的课程名称"},on:{search:t.onSearch,clear:t.onClearSearch,input:t.onInput},scopedSlots:t._u([{key:"action",fn:function(){return[s("div",{on:{click:function(e){return t.onSearch(t.value)}}},[t._v("搜索")])]},proxy:!0}]),model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1),s("div",[t.keyword?s("course-list",{ref:"courseList",attrs:{"tab-type":"filter","offset-top":54}}):s("search-list",{attrs:{"history-search":t.historySearch},on:{clearHistory:t.clearHistory,clickTab:t.tabSearch}})],1)],1)}),[],!1,null,"9b241d5e",null).exports},22255:(t,e,s)=>{s.r(e),s.d(e,{default:()=>u});s(25773);var a=s(35791),i=(s(47601),s(44951)),o=(s(57658),s(26513)),r=s(32900),n=s(27632),c=s(68092),l={components:{[i.Z.name]:i.Z,[a.Z.name]:a.Z},data:()=>({courseData:{deluke:{title:"德鲁克管理系列课程",url:"https://oss.coolcollege.cn/1794902132504268800.png",goods_code:"DT_GOODS_881614396335082",goods_code_test:"DT_GOODS_881614933814394"},ddi:{title:"新晋管理者领导力导航",url:"https://oss.coolcollege.cn/1794902132542017536.png",goods_code:"DT_GOODS_881614396916583",goods_code_test:"DT_GOODS_881614933876526"},newEmployee:{title:"新员工跑步上岗运营交付版",url:"https://oss.coolcollege.cn/1794902132516851712.png",goods_code:"DT_GOODS_881614397108430",goods_code_test:"DT_GOODS_881614933913819"}},goodsUrl:"",isDDAdmin:!1}),computed:{type(){return this.$route.query.type},blackList:()=>({DINGTALK_ENTERPRISE_LOCK:(0,c.eY)("DINGTALK_ENTERPRISE_LOCK")}),corpId(){return this.$store.state.commonParams.corpId}},mounted(){document.title=this.courseData[this.type].title,this.getGoodsUrl(),this.getCurrentUserInfo()},methods:{onContactService(){this.$router.push({path:"/online-service"})},onTapBuy(){this.isDDAdmin?n.Z.openLink({url:this.goodsUrl}):this.$dialog({title:this.$t("promptMessage.warmTips"),message:this.$t("promptMessage.notAdmin"),confirmButtonColor:this.$store.state.themeColor.primaryColor})},async getGoodsUrl(){const t=this.courseData[this.type].goods_code,{status:e,data:s}=await o.Z.getGoodsUrl(this.corpId,t);200===e&&(this.goodsUrl=s.result)},async getCurrentUserInfo(){const{status:t,data:e}=await r.Z.getUserGoodsInfo();200===t&&(this.isDDAdmin=e.isAdmin)}}},u=(0,s(1001).Z)(l,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"gold-course-detail-container"},[s("div",{staticClass:"gold-course-content"},[t.type?s("van-image",{staticClass:"gold-course-image",attrs:{"lazy-load":"",src:t.courseData[t.type].url}}):t._e(),s("div",{staticClass:"gold-course-btn"},[t.blackList.DINGTALK_ENTERPRISE_LOCK?s("van-button",{staticClass:"gold-course-btn-item",on:{click:t.onContactService}},[t._v(" "+t._s(t.$t("discovery.onlineConsultation"))+" ")]):t._e(),s("van-button",{staticClass:"gold-course-btn-item buy-btn",on:{click:t.onTapBuy}},[t._v(" "+t._s(t.$t("discovery.buyNow"))+" ")])],1)],1)])}),[],!1,null,"bf686976",null).exports},76338:(t,e,s)=>{s.r(e),s.d(e,{default:()=>u});var a=s(95082),i=(s(47601),s(44951)),o=(s(49153),s(5944)),r=(s(20581),s(50914)),n=(s(57658),s(26513)),c=s(22648),l={name:"HotCourseList",components:{OverlayLoading:s(85384).Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z},data:()=>({dataLoading:!0,courseList:[],loading:!1,finished:!1,page:{page_number:1,page_size:20}}),mounted(){this.getHotCourses()},methods:{async getHotCourses(){const t=(0,a.Z)({},this.page),e=await n.Z.getHotCourses(t),{status:s,data:i}=e;200===s&&(this.courseList=this.courseList.concat(i.list),this.finished="false"===i.has_next_page),this.dataLoading=!1,this.loading=!1},onLoadMore(){this.page.page_number+=1,this.loading=!0,this.getHotCourses()},toFormatPrice:t=>(0,c.T4)(t),handleToCourseDetail(t){this.$router.push({path:`/course-platform-detail?courseResource=platform&courseId=${t}&originType=hotCourse`})}}},u=(0,s(1001).Z)(l,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"hot-course-list-container"},[s("overlay-loading",{attrs:{show:t.dataLoading}}),t.dataLoading?t._e():s("div",[s("van-list",{attrs:{finished:t.finished,"finished-text":t.$t("promptMessage.expectTips")},on:{load:t.onLoadMore},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.courseList,(function(e){return s("div",{key:e.id,staticClass:"hot-course-list-item",on:{click:function(s){return t.handleToCourseDetail(e.course_id)}}},[s("van-image",{staticClass:"course-item-image",attrs:{"lazy-load":"",src:e.image,radius:4}}),s("div",{staticClass:"course-item-info"},[s("div",{staticClass:"course-item-info-title van-ellipsis"},[t._v(t._s(e.title))]),s("div",{staticClass:"course-item-info-price"},["true"===e.is_free?s("div",{staticClass:"item-info-free"},[t._v(" "+t._s(t.$t("discovery.free"))+" ")]):s("div",[s("span",[t._v("￥")]),s("span",{staticClass:"price-integer"},[t._v(t._s(t.toFormatPrice(e.preferential_price).integer))]),s("span",[t._v("."+t._s(t.toFormatPrice(e.preferential_price).decimal))])])])])],1)})),0),t.courseList.length?t._e():s("van-empty",{style:{height:"100vh"},attrs:{description:t.$t("common.noDataTextTip")}})],1)],1)}),[],!1,null,"ecfcb366",null).exports},85293:(t,e,s)=>{s.r(e),s.d(e,{default:()=>d});s(3791);var a=s(93432),i=(s(30033),s(87837)),o=(s(49153),s(5944)),r=(s(25773),s(35791)),n=(s(47601),s(44951)),c=(s(57658),s(26513)),l=s(27632),u={components:{SvgIcon:s(78551).Z,[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,[a.Z.name]:a.Z},data:()=>({postList:[],currentJobIds:"",courseList:[],canClickBtn:!1,chooseJob:[],dataLoading:!0}),computed:{primaryColor(){return this.$store.state.themeColor.primaryColor},img(){return"en-us"===this.$store.state.language?"https://oss.coolcollege.cn/1799495570633658368.png":"https://oss.coolcollege.cn/1799495579827572736.png"},fromPage(){return this.$route.query.fromPage},courseNum(){let t=0;return this.chooseJob.forEach((e=>{t+=e.course_count})),t},jobIds(){return this.chooseJob.map((t=>t.post_id))}},mounted(){this.getPostList(),this.isOpenStatusModal()},methods:{async isOpenStatusModal(){const t=await c.Z.getOpenStatus();this.canClickBtn="true"===t.data.pop},async getPostList(){const{status:t,data:e}=await c.Z.getPostListInitCourse();if(200===t&&!e.code){let t="";e.data&&e.data.length>0&&(t=e.data[0].post_id),this.postList=e.data,this.currentJobIds=t,t&&this.getCourseListByPostId()}},async getCourseListByPostId(){const{status:t,data:e}=await c.Z.getCourseListByPostId([this.currentJobIds]);this.dataLoading=!1,200!==t||e.code||(this.courseList=e.data)},chooseJobItem(t){const e=this.chooseJob.findIndex((e=>e.post_id===t.post_id));e>-1?this.chooseJob.splice(e,1):this.chooseJob.length<5?this.chooseJob.push(t):this.$toast(this.$t("initCourse.ChoosePositions"))},selectCourseByIds(t){this.currentJobIds=t,this.getCourseListByPostId()},onClickSkip(){l.Z.navigateTo({url:"/pages/home-modules/receive/serve-page/index"})},async selectCourseImport(){if(!this.canClickBtn)return void this.$toast(this.$t("initCourse.importDisabled"));if(!this.chooseJob.length||!this.courseNum)return void this.$toast(this.$t("initCourse.chooseCourse"));this.dataLoading=!0;const{data:t}=await c.Z.importCourse(this.jobIds);this.dataLoading=!1;let e=!0,s=this.$t("initCourse.importSuccess"),a="";t.code&&(e=!1,s=this.$t("initCourse.importError"),a=t.msg||this.$t("initCourse.importErrorTip"));const i="tryout"===this.fromPage?this.$t("buttons.confirm"):this.$t("initCourse.viewRepository");this.$dialog.confirm({title:s,message:e?this.$t("initCourse.tip"):a,showCancelButton:!(!e||"tryout"===this.fromPage),confirmButtonText:e?i:this.$t("initCourse.tryAgain"),confirmButtonColor:this.primaryColor}).then((()=>{this.confirmSuccess(e)})).catch((()=>{this.onCancel(e)}))},onCancel(t){t&&this.$router.go(-1)},confirmSuccess(t){t&&("tryout"===this.fromPage?l.Z.navigateTo({url:"/pages/home-modules/receive/serve-page/index"}):this.$router.push({path:"/home-module?fromPage=initCourse"}))}}},d=(0,s(1001).Z)(u,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"init-detail-container"},[s("div",{staticClass:"init-detail-bg"},[s("van-image",{staticClass:"init-detail-bg-image",attrs:{src:t.img}}),s("div",{staticClass:"init-detail-title-content"},[s("span",{staticClass:"init-title-text"},[t._v(" "+t._s(t.$t("initCourse.chooseJob")))]),s("span",{staticClass:"init-title-text-sub"},[t._v(" （"+t._s(t.$t("initCourse.ChoosePositions"))+"）")])])],1),s("div",{staticClass:"init-detail-content"},[t.dataLoading?s("van-loading",{staticClass:"init-detail-loading",attrs:{type:"spinner",color:"#fff"}}):t._e(),s("div",{staticClass:"init-detail-data-content"},[s("div",{staticClass:"init-detail-job"},t._l(t.postList,(function(e){return s("div",{key:e.post_id,staticClass:"init-course-list-post-item",class:t.currentJobIds===e.post_id?"init-course-list-post-item-bg":""},[s("div",{staticClass:"init-course-list-post-item-check",on:{click:function(s){return s.stopPropagation(),t.chooseJobItem(e)}}},[s("div",{staticClass:"init-course-item-post-checkbox",class:t.jobIds.includes(e.post_id)?"item-post-active":""},[t.jobIds.includes(e.post_id)?s("svg-icon",{staticClass:"icon-font",attrs:{"icon-class":"icon-duigou",size:14,color:"#fff"}}):t._e()],1)]),s("div",{staticClass:"init-course-list-post-item-bottom",on:{click:function(s){return s.stopPropagation(),t.selectCourseByIds(e.post_id)}}},[s("span",{staticClass:"init-course-list-post-item-text",class:[t.currentJobIds===e.post_id||t.jobIds.includes(e.post_id)?"init-course-list-post-item-text-active":"",t.jobIds.includes(e.post_id)?"init-course-list-post-item-text-active-bold":""]},[t._v(t._s(e.post_name))])])])})),0),s("div",{staticClass:"init-detail-course"},[t.courseList.length?s("div",t._l(t.courseList,(function(e){return s("div",{key:e.post_id,staticClass:"init-course-list-item"},[s("van-image",{staticClass:"init-course-img",attrs:{"lazy-load":"",radius:4,src:e.cover}}),s("div",{staticClass:"init-course-list-text-container"},[s("span",{staticClass:"text-title"},[t._v(t._s(e.title))]),s("span",{staticClass:"text-teacher"},[t._v(t._s(t.$t("initCourse.lecturer"))+"："+t._s(e.teacher_name))])])],1)})),0):s("van-empty",{attrs:{description:t.$t("common.noDataTextTip")}})],1)])],1),s("div",{staticClass:"init-detail-btn-container"},["tryout"===t.fromPage?s("van-button",{staticClass:"init-detail-btn init-detail-btn-skip",attrs:{plain:"",block:"",color:t.primaryColor},on:{click:t.onClickSkip}},[t._v(" "+t._s(t.$t("initCourse.skipBtn"))+" ")]):t._e(),s("van-button",{staticClass:"init-detail-btn init-detail-btn-skip",attrs:{block:"",disabled:!t.courseNum||!t.canClickBtn,color:t.primaryColor},on:{click:t.selectCourseImport}},[t._v(" "+t._s(t.$t("initCourse.importCourse"))+t._s(t.courseNum?"("+t.courseNum+")":"")+" ")])],1)])}),[],!1,null,"2a418803",null).exports},89550:(t,e,s)=>{s.r(e),s.d(e,{default:()=>S});var a=s(95082),i=(s(31146),s(41610)),o=(s(33948),s(57658),s(74916),s(15306),s(78551)),r=s(26294),n=s(95969),c=s(68593),l={components:{SvgIcon:o.Z},props:{abilityList:{type:Array,default:()=>[]},userList:{type:Array,default:()=>[]}},data:()=>({show:!1}),computed:(0,a.Z)((0,a.Z)({},(0,r.mapState)("personnelDevelopment",["abilityIndex","userCheck","isVerify","showHeadPopup","batchProgress","currentAbilityInfo"])),(0,r.mapState)("user",["userId"])),methods:(0,a.Z)((0,a.Z)({},(0,r.mapActions)({setValue:"personnelDevelopment/setState"})),{},{showAbilityModal(){this.$emit("onShowAbilityPopUP")},verify({isPosition:t=!1,isToast:e=!0,isVerify:s=!0}){const{userCheck:a,userList:i}=this;let o=new Array(i.length).fill(!1),r="";for(let t=0;t<a.length;t++)if(""===a[t].level_id){r=t;break}if(""!==r){if(s&&(o[r]=!0),this.setValue({key:"isVerify",value:o}),t){const t=document.querySelector(`.user-item-${r}`);document.querySelector(".bath-evaluation-content").scrollTo(0,t.offsetTop-60)}return e&&this.$toast(this.$t("evaluation.completeEvaluationTip")),!1}return!0},verifyProgress(){const{batchProgress:t,abilityList:e}=this;if(1===e.length)return!0;let s=[];for(let e=0;e<t.length;e++)t[e]<100&&s.push(e+1);return!s.length||(this.$toast(this.$t("evaluation.whichNotEvaluationTip",{key:s.join("/")})),!1)},endEvaluation(){this.verify({isPosition:!0,isToast:!0})&&this.verifyProgress()&&this.submitEnd()},async submitEnd(){try{const{userCheck:t,userId:e,batchProgress:s,abilityIndex:a,currentAbilityInfo:i}=this,{evaluationId:o}=this.$route.query,{cacheUserCheck:r,bathEvaluationSubmit:l}=c.Z;await r({userCheckInfo:{relation:t,assessed:e,progress:s[a]},planId:o,abilityId:i.ability_id}),0===(await l(o)).data.code&&(this.$toast(this.$t("personnelDevelope.evaluationSuccess")),setTimeout((()=>{this.$router.replace({path:n.Z.message.evaluationSupDetail({taskId:o,isAlert:!0})})}),500))}catch(t){this.$toast(this.$t("common.submitFailure"))}},gotoNext(){const{abilityList:t,abilityIndex:e,userList:s}=this;this.verify({isPosition:!0,isToast:!0})&&(this.$emit("nextStep",e+1),this.setValue({key:"currentAbilityInfo",value:t[e+1]}),this.setValue({key:"abilityIndex",value:e+1}),this.setValue({key:"userCheck",value:s.map((()=>({level_id:"",id:"",level_title:"",type:"",user_id:""})))}),this.setValue({key:"isVerify",value:new Array(s.length).fill(!1)}),this.setValue({key:"showHeadPopup",value:!0}))},gotoPrev(){const{abilityList:t,abilityIndex:e}=this;if(0===e)return!1;this.$emit("nextStep",e-1),this.setValue({key:"currentAbilityInfo",value:t[e-1]}),this.setValue({key:"abilityIndex",value:e-1})}})},u=s(1001),d=(0,u.Z)(l,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"action-bar-content"},[t.abilityList.length>1?s("div",{staticClass:"action-collapse",on:{click:t.showAbilityModal}},[s("span",{staticClass:"current-ability"},[t._v(t._s(t.abilityIndex+1))]),t._v("/"+t._s(t.abilityList.length)+" "),s("span",{staticClass:"up-icon"},[s("SvgIcon",{attrs:{color:"rgba(0, 0, 0, 0.85)",size:10,"icon-class":"icon-datiqiashouqi"}})],1)]):t._e(),s("div",{class:[1===t.abilityList.length?"action-btn-group active":"action-btn-group"]},[t.abilityList.length>1?s("div",{class:[0==t.abilityIndex?"btn-up active":"btn-up"],on:{click:t.gotoPrev}},[s("SvgIcon",{attrs:{color:0===t.abilityIndex?"rgba(0, 0, 0, 0.25)":"rgba(0, 0, 0, 0.85)",size:12,"icon-class":"icon-arrow-l1"}}),s("span",{staticClass:"option-up page-btn"},[t._v(t._s(t.$t("evaluation.prevItem")))])],1):t._e(),t.abilityIndex!==t.abilityList.length-1&&t.abilityList.length>1?s("div",{staticClass:"btn-down",on:{click:t.gotoNext}},[s("span",{staticClass:"option-down page-btn"},[t._v(t._s(t.$t("evaluation.nextItem")))]),s("SvgIcon",{attrs:{color:"rgba(0, 0, 0, 0.85)",size:12,"icon-class":"icon-arrow-r"}})],1):t._e(),t.abilityIndex==t.abilityList.length-1?s("div",{class:[1===t.abilityList.length?"btn-finish active":"btn-finish"],on:{click:t.endEvaluation}},[t._v(t._s(t.$t("evaluation.completeEvaluation")))]):t._e()])])}),[],!1,null,"9ae2afdc",null).exports,h=(s(73474),s(74755)),p=s(22648),m={components:{[h.Z.name]:h.Z},props:{show:{type:Boolean,default:!1},abilityList:{type:Array,default:()=>{}},userList:{type:Array,default:()=>[]}},data:()=>({showPopUp:!1}),computed:(0,a.Z)((0,a.Z)((0,a.Z)({themeColor(){return this.$store.state.themeColor.primaryColor}},(0,r.mapState)("personnelDevelopment",["userCheck","batchProgress","abilityIndex","currentAbilityInfo","batchProgress"])),(0,r.mapState)("user",["userId"])),{},{renderClassStyle(){return t=>{let e={name:"ability-item",style:""};return this.abilityIndex===t&&(e={name:"ability-item active",style:`background:${(0,p.a7)(this.themeColor,.05)}`}),e}},renderProgress:()=>(t,e)=>{let s=["progress"];return 100===t?s.push("full"):t>0&&t<100&&(s.push("in-progress"),e&&s.push("active")),s.join(" "),s}}),watch:{show(){this.showPopUp=this.show}},methods:(0,a.Z)((0,a.Z)({},(0,r.mapActions)({setValue:"personnelDevelopment/setState"})),{},{hidePopUP(){this.$emit("hideAbilityPopUp")},async changeAbility({index:t,isFirst:e=!1}){if(t===this.abilityIndex)return!1;await this.cacheUserCheck(),this.setValue({key:"currentAbilityInfo",value:this.abilityList[t]}),this.setValue({key:"abilityIndex",value:t}),this.hidePopUP(),await this.getAbilityGetUserInfo({index:t,isFirst:e})},async cacheUserCheck(){const{userCheck:t,userId:e,batchProgress:s,abilityIndex:a,currentAbilityInfo:i}=this,{evaluationId:o}=this.$route.query,{cacheUserCheck:r}=c.Z;await r({userCheckInfo:{relation:t,assessed:e,progress:s[a]},planId:o,abilityId:i.ability_id})},async getAbilityGetUserInfo({index:t,isFirst:e=!1}){const{evaluationId:s}=this.$route.query,{abilityList:a,userList:i,batchProgress:o}=this,{getAbilityGetUserInfo:r}=c.Z;let n=o.slice(),l=await r({planId:s,abilityId:a[t].ability_id}),u="",d=0;if(l.data.data){const{progress:t,relation:e}=JSON.parse(l.data.data);d=t,u=e}else u=i.map((()=>({level_id:"",id:"",level_title:"",type:"",user_id:""})));n[t]=d,this.setValue({key:"batchProgress",value:n}),this.setValue({key:"userCheck",value:u}),this.$emit("verifyCheck",e)}})},g=(0,u.Z)(m,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("van-popup",{style:{maxHeight:"60%"},attrs:{position:"bottom",round:!0},on:{closed:t.hidePopUP},model:{value:t.showPopUp,callback:function(e){t.showPopUp=e},expression:"showPopUp"}},[s("div",{staticClass:"ability-title"},[t._v(t._s(t.$t("pageTitle.capabilityItem"))+"("+t._s(t.abilityList.length)+")")]),s("div",{staticClass:"ability-content"},t._l(t.abilityList,(function(e,a){return s("div",{key:a,class:t.renderClassStyle(a).name,style:t.renderClassStyle(a).style,on:{click:function(e){return t.changeAbility({index:a})}}},[s("span",{staticClass:"ability-name"},[t._v(t._s(e.ability_title))]),s("span",{class:t.renderProgress(t.batchProgress[a],t.abilityIndex===a)},[t._v(t._s(t.batchProgress[a]+"%"))])])})),0),s("div",{staticClass:"ability-less",on:{click:t.hidePopUP}},[s("span",[t._v(t._s(t.$t("attestation.retract")))])])])],1)}),[],!1,null,"cf762040",null).exports,v=(s(91058),{components:{[h.Z.name]:h.Z,SvgIcon:o.Z},props:{show:{type:Boolean,default:!1},userList:{type:Array,default:()=>[]}},data:()=>({showPopUp:!1,answerPopIndex:0}),computed:(0,a.Z)((0,a.Z)({},(0,r.mapState)("personnelDevelopment",["currentAbilityInfo","userCheck","answerIndex","isVerify","batchProgress","abilityIndex"])),{},{themeColor(){return this.$store.state.themeColor}}),watch:{show(){this.showPopUp=this.show}},methods:(0,a.Z)((0,a.Z)({},(0,r.mapActions)({setValue:"personnelDevelopment/setState"})),{},{calcProgress(t){let e=t.filter((t=>t.level_id)).length/t.length*100;return parseInt(e,10)},chooseAnswer(t){const{isVerify:e,answerIndex:s,userList:i,abilityIndex:o,batchProgress:r}=this;let n=e.slice(),c=this.userCheck.map(((e,o)=>s===o?(0,a.Z)((0,a.Z)({},e),{},{id:this.currentAbilityInfo.ability_id,level_id:t.level_id,level_title:t.level_title,type:i[s].relation,user_id:i[s].user_id}):e)),l=r.slice();l[o]=this.calcProgress(c),this.setValue({key:"batchProgress",value:l}),this.setValue({key:"userCheck",value:c}),n[s]=!1,this.setValue({key:"isVerify",value:n}),this.hidePopup()},hidePopup(){this.$emit("hideAnswerPopUp")}})}),f=(0,u.Z)(v,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("van-popup",{style:{maxHeight:"60%",minHeight:"60%"},attrs:{closeable:!0,position:"bottom",round:!0},on:{closed:t.hidePopup},model:{value:t.showPopUp,callback:function(e){t.showPopUp=e},expression:"showPopUp"}},[s("div",{staticClass:"ability-title"},[t._v(t._s(t.$t("evaluation.abilityLevel")))]),s("div",{staticClass:"ability-content"},t._l(t.currentAbilityInfo.level_list,(function(e,a){return s("div",{key:a,staticClass:"ability-item",on:{click:function(s){return t.chooseAnswer(e,a)}}},[s("span",{class:[t.userCheck[t.answerIndex].level_id===e.level_id?"ability-name active":"ability-name"]},[t._v(t._s(e.level_title))]),t.userCheck.length&&t.userCheck[t.answerIndex].level_id===e.level_id?s("span",[s("SvgIcon",{attrs:{size:14,color:t.themeColor.primaryColor,"icon-class":"icon-done1"}})],1):t._e()])})),0)])],1)}),[],!1,null,"6a873fda",null).exports,y=s(4852),_={components:{SvgIcon:o.Z,Avatar:y.Z},props:{abilityList:{type:Array,default:()=>{}},userList:{type:Array,default:()=>{}},currentAbilityInfo:{type:Object,default:()=>{}}},computed:(0,a.Z)((0,a.Z)({},(0,r.mapState)("personnelDevelopment",["abilityIndex","isVerify","userCheck"])),{},{dimensional(){return t=>t[this.abilityIndex].result}}),methods:(0,a.Z)((0,a.Z)({},(0,r.mapActions)({setValue:"personnelDevelopment/setState"})),{},{showAnswerPopup(t){this.setValue({key:"answerIndex",value:t}),this.$emit("showAnswerPopup")}})},C=(0,u.Z)(_,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"user-choose-content"},t._l(t.userList,(function(e,a){return s("div",{key:a.toString(),class:"user-item user-item-"+a},[s("div",{staticClass:"user-top"},[s("div",{staticClass:"user-info"},[s("Avatar",{staticClass:"avatar",attrs:{src:e.user.avatar,width:"40",height:"40"}}),s("div",{staticClass:"user-info-name"},[t._v(t._s(e.user_name))])],1),s("div",{staticClass:"choose-answer",on:{click:function(e){return t.showAnswerPopup(a)}}},[t.userCheck.length&&t.userCheck[a].level_title?s("span",{staticClass:"choose-name"},[t._v(t._s(t.userCheck[a].level_title))]):s("span",{class:[t.isVerify[a]?"choose-name active":"choose-name"]},[t._v(t._s(t.$t("evaluation.pleaseChoose")))]),s("span",{staticClass:"choose-icon"},[s("SvgIcon",{attrs:{color:"#B0B4C8",size:10,"icon-class":"icon-arrow-r1"}})],1)])]),0!==e.dimensional_result.length?s("div",{staticClass:"user-bottom"},[t.dimensional(e.dimensional_result).subordinate?s("div",{staticClass:"ability-result-info"},[s("strong",[t._v(t._s(t.$t("evaluation.subEvaluationResult"))+"：")]),s("span",[t._v(t._s(t.dimensional(e.dimensional_result).subordinate))])]):t._e(),t.dimensional(e.dimensional_result).sameLevel?s("div",{staticClass:"ability-result-info"},[s("strong",[t._v(t._s(t.$t("evaluation.peerEvaluationResult"))+"：")]),s("span",[t._v(t._s(t.dimensional(e.dimensional_result).sameLevel))])]):t._e(),t.dimensional(e.dimensional_result).self?s("div",{staticClass:"ability-result-info"},[s("strong",[t._v(t._s(t.$t("evaluation.selfEvaluationResult"))+"：")]),s("span",[t._v(t._s(t.dimensional(e.dimensional_result).self))])]):t._e()]):t._e()])})),0)}),[],!1,null,"3b3c5f41",null).exports,I={components:{LevelDescPanel:s(41097).Z,[h.Z.name]:h.Z},props:{isShowHeader:{type:Boolean,default:!0}},data:()=>({isOpen:!1}),computed:(0,a.Z)({renderStyle:()=>({fontSize:14/3.75+"vw",color:"#969799"})},(0,r.mapState)("personnelDevelopment",["abilityIndex","currentAbilityInfo","showHeadPopup"])),methods:(0,a.Z)((0,a.Z)({},(0,r.mapActions)({setValue:"personnelDevelopment/setState"})),{},{hidePopUP(){this.isOpen=!1,this.setValue({key:"showHeadPopup",value:!this.showHeadPopup})},openPopup(){this.isOpen=!0,document.querySelector(".bath-header-content .van-popup").scrollTo(0,0)}})},b=(0,u.Z)(I,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"bath-header-content"},[s("div",{class:[t.isShowHeader?"bath-header":"bath-header active"]},[s("div",{staticClass:"ability-name"},[t._v(t._s(t.currentAbilityInfo.ability_title))]),s("div",{staticClass:"expend",on:{click:t.hidePopUP}},[s("span",{staticClass:"expend-name"},[t._v(t._s(t.showHeadPopup?t.$t("attestation.retract"):t.$t("attestation.open")))]),s("svg",{class:[t.showHeadPopup?"expend-icon active":"expend-icon"],style:t.renderStyle,attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#icon-datiqiazhankai1"}})])])]),s("van-popup",{style:{maxHeight:"70%"},attrs:{position:"top"},on:{"click-overlay":t.hidePopUP,opened:t.openPopup},model:{value:t.showHeadPopup,callback:function(e){t.showHeadPopup=e},expression:"showHeadPopup"}},[s("div",{class:[t.isOpen?"ability-info-content active":"ability-info-content"]},[s("div",{staticClass:"ability-desc"},[t._v(t._s(t.currentAbilityInfo.ability_description))]),s("div",{staticClass:"ability-level-content"},t._l(t.currentAbilityInfo.level_list,(function(e,a){return s("div",{key:a,staticClass:"ability-level-item"},[s("div",{staticClass:"ability-name"},[t._v(t._s(e.level_title))]),s("LevelDescPanel",{attrs:{"page-source":"bath",desc:e.level_description,behavior:e.behavior_desc}})],1)})),0)])])],1)}),[],!1,null,"7a80693b",null).exports,w=s(6106),$=s(61378),k={components:{ActionBar:d,AbilityPopUp:g,AnswerPopup:f,Header:b,SelectAnswerPanel:C},beforeRouteLeave(t,e,s){const{deleteCacheUserCheck:a}=c.Z,{evaluationId:o}=this.$route.query;if(this.isIntroJS&&this.introJsFn().exit(),t.query.isAlert)return s(),!1;const{userCheck:r,batchProgress:n}=this;let l=!1,u=!1;for(let t=0;t<r.length;t++)if(""!==r[t].level_id){l=!0;break}for(let t=0;t<n.length;t++)if(0!==n[t]){u=!0;break}l||u?i.Z.confirm({message:this.$t("evaluation.exitTip"),closeOnPopstate:!1,cancelButtonText:this.$t("buttons.cancel"),confirmButtonText:this.$t("buttons.confirm")}).then((()=>{a(o).then((t=>{0===t.data.code&&(this.setValue({key:"abilityIndex",value:0}),s())}))})).catch((()=>{s(!1),this.$dialog.close()})):(this.setValue({key:"abilityIndex",value:0}),s())},data:()=>({actionBarShow:!1,answerShow:!1,userList:[],abilityList:[],answerIndex:"",showHead:!1,isIntroJS:!1,introJsFn:$.Z}),computed:(0,a.Z)((0,a.Z)((0,a.Z)({},(0,r.mapState)("personnelDevelopment",["abilityIndex","userCheck","currentAbilityInfo","showHeadPopup","batchProgress"])),(0,r.mapGetters)({userInfo:"user/getUserInfo"})),{},{themeColor(){return this.$store.state.themeColor.primaryColor},isShowHeader(){const{actionBarShow:t,answerShow:e}=this;return!t&&!e}}),mounted(){const{title:t}=this.$route.query;(0,p.Td)(t),this.initGetInfo()},methods:(0,a.Z)((0,a.Z)({},(0,r.mapActions)({setValue:"personnelDevelopment/setState"})),{},{verifyCheck(t){this.$refs.actionBarRef.verify({isPosition:!this.showHeadPopup,isToast:!1,isVerify:!t})},nextStep(t){this.$refs.abilityPopUp.changeAbility({index:t,isFirst:!0})},showHeadPop(t){this.showHead=t},async handleIntroJS(){const t=await this.judgeShowFirstGuide();if(this.isIntroJS=t,t||this.setValue({key:"showHeadPopup",value:!0}),t){document.documentElement.style.setProperty("--mainColor",this.themeColor);const t=`<span style="font-size: 3.7vw;color: rgba(0, 0, 0, 0.45);line-height: 22px;">${this.$t("evaluation.bathNewTitleTip")}</span>`,e=`<span style="font-size: 3.7vw;color: rgba(0, 0, 0, 0.45);line-height: 22px;">${this.$t("evaluation.bathNewDescTip")}</span>`,s=`<span style="font-size: 3.7vw;color: rgba(0, 0, 0, 0.45);line-height: 22px;">${this.$t("evaluation.bathNewChooseAbilityTip")}</span>`;(0,$.Z)().setOptions({prevLabel:`<span style='color:${this.themeColor}'>${this.$t("evaluation.prev")}</span>`,nextLabel:`<span style='color:${this.themeColor}'>${this.$t("evaluation.next")}</span>`,doneLabel:`<span style='color:${this.themeColor}'>${this.$t("practice.gotIt")}</span>`,exitOnOverlayClick:!1,disableInteraction:!0,tooltipClass:"bath-evaluation-intro",hidePrev:!0,steps:[{title:this.$t("evaluation.abilityDetail"),element:document.querySelector(".expend-name"),intro:t,position:"bottom"},{title:this.$t("evaluation.chooseLevel"),element:document.querySelectorAll(".user-item")[1],intro:s,position:"top"},{title:this.$t("pageTitle.capabilityItem"),element:document.querySelector(".action-collapse"),intro:e,position:"top"}]}).start()}},async judgeShowFirstGuide(){try{const{userId:t}=this.userInfo,e={userId:t,type:35},s=await w.Z.getUserGuideCheck(e),{guide_view:a}=s.data.data;return a}catch(t){return console.error(t),!1}},initGetInfo(){const{abilityIndex:t}=this,{evaluationId:e}=this.$route.query;Promise.all([c.Z.getAbilityInfo({planId:e}),c.Z.getUserInfo({planId:e})]).then((e=>{const s=e[0],a=e[1];if(0===a.data.code){const{answer_vos:e}=s.data;this.abilityList=e,this.userList=a.data.data,this.setValue({key:"currentAbilityInfo",value:e[this.abilityIndex]}),this.setValue({key:"isVerify",value:new Array(a.data.data.length).fill(!1)}),this.setValue({key:"batchProgress",value:new Array(e.length).fill(0)}),this.$nextTick((()=>{this.$refs.abilityPopUp.getAbilityGetUserInfo({index:t,isFirst:!0}),this.handleIntroJS()}))}}))},showAbilityModal(){this.actionBarShow=!0},hideAbilityPopUp(){this.actionBarShow=!1},showAnswerPopup(t){this.answerShow=!0,this.answerIndex=t},hideAnswerPopUp(){this.answerShow=!1}})},S=(0,u.Z)(k,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"bath-evaluation-content"},[s("Header",{attrs:{"is-show-header":t.isShowHeader,"current-ability-info":t.currentAbilityInfo,"show-head":t.showHead}}),s("SelectAnswerPanel",{attrs:{"ability-list":t.abilityList,"current-ability-info":t.currentAbilityInfo,"user-list":t.userList},on:{showAnswerPopup:t.showAnswerPopup}}),s("ActionBar",{ref:"actionBarRef",attrs:{"ability-list":t.abilityList,"user-list":t.userList},on:{nextStep:t.nextStep,onShowAbilityPopUP:t.showAbilityModal,showHeadPop:t.showHeadPop}}),s("AbilityPopUp",{ref:"abilityPopUp",attrs:{show:t.actionBarShow,"ability-list":t.abilityList,"user-list":t.userList},on:{verifyCheck:t.verifyCheck,hideAbilityPopUp:t.hideAbilityPopUp}}),s("AnswerPopup",{attrs:{show:t.answerShow,"current-ability-info":t.currentAbilityInfo,"answer-index":t.answerIndex,"user-list":t.userList},on:{hideAnswerPopUp:t.hideAnswerPopUp}})],1)}),[],!1,null,null,null).exports},38174:(t,e,s)=>{s.d(e,{Z:()=>r});s(37138);var a=s(2113),i=(s(74268),s(55948)),o=(s(57658),{name:"AbilityScoreList",components:{[i.Z.name]:i.Z,[a.Z.name]:a.Z},props:{reportInfo:{type:Object,required:!0,default:()=>({})}},data:()=>({activeNameList:[],resType:[]}),computed:{jobRequirementsVisible(){return Boolean(this.reportInfo.list.length>0&&this.reportInfo.list[0].post_res)}},created(){const{self_res:t,superior_res:e,subordinate_res:s,sameLevel_res:a}=this.reportInfo.list[0];t&&this.resType.push({name:this.$t("evaluation.self"),type:"self_res"}),e&&this.resType.push({name:this.$t("common.superior"),type:"superior_res"}),s&&this.resType.push({name:this.$t("evaluation.subordinat"),type:"subordinate_res"}),a&&this.resType.push({name:this.$t("evaluation.same"),type:"sameLevel_res"})},methods:{postScroe:t=>t.post_res?`${t.post_res.level_title}(${t.post_score})`:"--",finalScroe:t=>t.final_res&&t.final_res.level_title&&"-1"!==t.final_res.level_title?`${t.final_res.level_title}(${t.final_result_score})`:"--",getRes(t,e){return this.reportInfo.list[t][e]&&this.reportInfo.list[t][e].level_title&&"-1"!==this.reportInfo.list[t][e].level_title?this.reportInfo.list[t][e].level_title:"--"}}}),r=(0,s(1001).Z)(o,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ability-score-container"},[s("div",{staticClass:"table-head"},[s("div",{staticClass:"head-item"},[t._v(t._s(t.$t("evaluation.abilityOptionName")))])]),s("div",{staticClass:"table-header"},[s("div",{staticClass:"item"},[t._v(t._s(t.$t("pageTitle.capabilityItem")))]),t.jobRequirementsVisible?s("div",{staticClass:"item"},[t._v(t._s(t.$t("evaluation.jobRequirements")))]):t._e(),s("div",{staticClass:"item"},[t._v(t._s(t.$t("evaluation.result")))])]),t.reportInfo.list.length>0?s("div",t._l(t.reportInfo.list,(function(e,a){return s("div",{key:e.ability_id,staticClass:"table-body"},[s("van-collapse",{staticClass:"collapse-box",model:{value:t.activeNameList,callback:function(e){t.activeNameList=e},expression:"activeNameList"}},[s("van-collapse-item",{attrs:{name:a},scopedSlots:t._u([{key:"title",fn:function(){return[s("div",{staticClass:"power-body-top"},[s("div",{staticClass:"item van-multi-ellipsis--l2"},[t._v(t._s(e.ability_title))]),t.jobRequirementsVisible?s("div",{staticClass:"item"},[t._v(t._s(t.postScroe(e)))]):t._e(),s("div",{staticClass:"item"},[t._v(t._s(t.finalScroe(e)))])])]},proxy:!0}],null,!0)},[s("div",{staticClass:"power-body-bottom"},t._l(t.resType,(function(e,i){return s("div",{key:i.toString(),staticClass:"item"},[s("div",{staticClass:"title"},[t._v(t._s(e.name))]),s("div",{staticClass:"desc"},[t._v(t._s(t.getRes(a,e.type)))])])})),0)])],1)],1)})),0):t._e()])}),[],!1,null,"6da0ed8d",null).exports},41097:(t,e,s)=>{s.d(e,{Z:()=>i});var a={props:{desc:{type:String,default:""},behavior:{type:String,default:""},pageSource:{type:String,default:"single"}}},i=(0,s(1001).Z)(a,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:["single"===t.pageSource?"behavior-desc-content":"behavior-desc-content active"]},[s("div",{staticClass:"desc-content"},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("personnelDevelope.levelDesc")))]),s("div",{staticClass:"desc"},[t._v(t._s(t.desc))])]),s("div",{staticClass:"behavior-content"},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("personnelDevelope.behaviorDesc")))]),s("div",{staticClass:"desc"},[t._v(t._s(t.behavior))])])])}),[],!1,null,"627277a7",null).exports},24004:(t,e,s)=>{s.d(e,{Z:()=>c});s(30033);var a=s(87837),i=(s(74916),s(15306),s(57658),s(33948),s(70492)),o=s.n(i),r=(s(48927),s(78511),s(22648)),n={name:"Radar",components:{[a.Z.name]:a.Z},filters:{formatDate:function(t){return(0,r.p6)(t,"yyyy-MM-dd  hh:mm")}},props:{reportInfo:{type:Object,required:!0,default:()=>({})}},data(){return{self:!0,other:!0,option:{legend:{data:[this.$t("evaluation.self"),this.$t("common.superior"),this.$t("evaluation.subordinat"),this.$t("evaluation.same"),this.$t("evaluation.result"),this.$t("evaluation.jobRequirements")],bottom:0,icon:"circle"},radar:{shape:"circle",splitArea:{show:!0,areaStyle:{color:["#fafafa"]}},name:{textStyle:{color:"#2D3040"},formatter:t=>t.length>11?`${(t=t.slice(0,11)).replace(/\S{6}/g,(t=>`${t}\n`))}...`:t.replace(/\S{6}/g,(t=>`${t}\n`))},radius:70,indicator:[]},series:[{type:"radar",data:[]}]},seriesData:[],showList:[]}},mounted(){const t=document.getElementById("radar"),e=o().init(t);this.reportInfo.list.length>10?this.showList=this.reportInfo.list.slice(0,10):this.showList=this.reportInfo.list;const s=this.showList.map((t=>({name:t.ability_title,max:5})));let a=[],i=[],r=[],n=[],c=[],l=[];this.showList.forEach((t=>{t.self_res&&a.push(t.self_res.level_score),t.superior_res&&i.push(t.superior_res.level_score),t.subordinate_res&&r.push(t.subordinate_res.level_score),t.sameLevel_res&&n.push(t.sameLevel_res.level_score),t.final_res&&c.push(t.final_res.level_score),t.post_res&&l.push(t.post_res.level_score)})),this.seriesData=[{name:this.$t("evaluation.self"),value:a},{name:this.$t("common.superior"),value:i},{name:this.$t("evaluation.subordinat"),value:r},{name:this.$t("evaluation.same"),value:n},{name:this.$t("evaluation.result"),value:c},{name:this.$t("evaluation.jobRequirements"),value:l}].filter((t=>t.value.length>0)),this.option.series[0].data=[...this.seriesData],this.option.radar.indicator=s,e.setOption(this.option)}},c=(0,s(1001).Z)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"report-top-container"},[s("div",{staticClass:"title"},[t._v(" "+t._s(t.reportInfo.title)+" ")]),s("div",{staticClass:"user-name"},[t._v(t._s(t.$t("evaluation.evaluationReports"))+"："+t._s(t.reportInfo.user_name))]),s("div",{staticClass:"report-time"},[t._v(t._s(t.$t("evaluation.reportTime"))+"："+t._s(t._f("formatDate")(t.reportInfo.report_time)))]),t._m(0)])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"radar-container"},[e("div",{attrs:{id:"radar"}})])}],!1,null,"91e51ca4",null).exports},39476:(t,e,s)=>{s.d(e,{Z:()=>o});var a=s(22648),i={filters:{formatDate:function(t){return(0,a.p6)(t,"yyyy-MM-dd  hh:mm")}},props:{evaluationInfo:{type:Object,required:!0,default:()=>({})},category:{type:String,default:""}},data:()=>({})},o=(0,s(1001).Z)(i,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"task-info"},[s("div",{staticClass:"top-info"},[s("div",{staticClass:"progress-container"},[s("div",{staticClass:"progress-title"},[t._v(t._s(t.$t("common.taskProgress")))]),s("div",{staticClass:"progress-info"},[t._v(" "+t._s(t.evaluationInfo.evaluation_process)+"% ")])]),s("div",{staticClass:"assignor-info"},[s("div",{staticClass:"info-one-cell"},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("common.assignor")))]),s("div",{staticClass:"value"},[t._v(t._s(t.evaluationInfo.create_user_name))])]),s("div",{staticClass:"info-one-cell"},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("common.learningProgress")))]),s("div",{staticClass:"value"},[t._v(t._s(t.evaluationInfo.evaluation_process)+"%")])])]),t.category?t._e():s("div",{staticClass:"qualified-tip"},[t._v(" "+t._s(t.$t("common.passingCriteria"))+": "),t._v(" "+t._s("false"===t.evaluationInfo.finish_promote?t.$t("common.completeJobEvaluation"):t.$t("evaluation.completeCaseStudy"))+" ")])]),s("div",{staticClass:"bottom-info"},[s("div",{staticClass:"task-title"},[t._v(" "+t._s(t.evaluationInfo.title)+" ")]),s("div",{staticClass:"task-time"},["permanent"===t.evaluationInfo.term_type?s("div",{staticClass:"time"},[t._v(" "+t._s(t.$t("evaluation.permanent"))+" ")]):s("div",{staticClass:"time"},[t._v(" "+t._s(t._f("formatDate")(t.evaluationInfo.start_time))+"~"+t._s(t._f("formatDate")(t.evaluationInfo.end_time))+" ")])])])])}),[],!1,null,"33c2f70a",null).exports},42623:(t,e,s)=>{s.r(e),s.d(e,{default:()=>v});s(34837);var a=s(39146),i=(s(3791),s(93432)),o=(s(25773),s(35791)),r=(s(47238),s(75167)),n=(s(57658),s(68593)),c=s(22648),l=s(39476),u=s(78551),d={name:"CoursesList",components:{[r.Z.name]:r.Z,SvgIcon:u.Z},props:{studyResources:{type:Array,required:!0,default:()=>[]}},data:()=>({}),computed:{themeColor(){return this.$store.state.themeColor}},methods:{handleToCourse(t){this.$emit("onHandleToCourseDetail",t)}}},h=s(1001),p=(0,h.Z)(d,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"courses-container"},t._l(t.studyResources,(function(e){return s("div",{key:e.resource_id,staticClass:"course-item",on:{click:function(s){return t.handleToCourse(e)}}},[s("div",{staticClass:"course-top-info"},[s("div",{staticClass:"resource-type-icon"},[s("SvgIcon",{attrs:{"icon-class":"icon-lesson",color:"#465dcd",size:16}})],1),s("div",{staticClass:"resource-type-label"},[t._v(t._s(t.$t("common.course")))])]),s("div",{staticClass:"course-bottom-info"},[s("div",{staticClass:"course-title"},[t._v(t._s(e.resource_name))]),s("div",{staticClass:"course-progress"},[s("van-progress",{attrs:{"show-pivot":!1,color:t.themeColor.primaryColor,percentage:e.study_progress}}),s("div",{staticClass:"progress",style:{color:t.themeColor.primaryColor}},[t._v(" "+t._s(e.study_progress)+"% ")])],1)])])})),0)}),[],!1,null,"413dd11c",null).exports,m={name:"EvaluationDetail",components:{TaskInfo:l.Z,CoursesList:p,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z},filters:{formatDate:function(t){return(0,c.p6)(t,"yyyy-MM-dd  hh:mm")}},data:()=>({evaluationInfo:{},isOverdue:!1,isNotStarted:!1}),computed:{themeColor(){return this.$store.state.themeColor}},created(){const{taskId:t}=this.$route.query;a.Z.loading({duration:0,forbidClick:!0,message:this.$t("common.loading")}),this.getMyEvaluationTaskDetail(t)},mounted(){const{isGo:t}=this.$route.query;"1"===t&&history.go(-3)},methods:{jurisdiction(t){const{evaluation_process:e,status:s,self:a,self_completed:i,evaluation_tool_type:o}=this.evaluationInfo;let r={startAssessment:!1,superiorsReview:!1,evaluationReport:!1};return 100===e&&1===s?(r.evaluationReport=!0,r[t]):"tool"===o?e<100&&2===s?(r.superiorsReview=!0,r[t]):(r.startAssessment=!0,r[t]):("true"===a?"true"===i?r.superiorsReview=!0:r.startAssessment=!0:r.superiorsReview=!0,r[t])},getMyEvaluationTaskDetail(t){n.Z.getMyEvaluationTaskDetail({evaluationId:t}).then((t=>{this.evaluationInfo=t.data;const{term_type:e,start_time:s,end_time:i}=t.data,o=Date.now();this.isNotStarted="custom"===e&&o<s,this.isOverdue="custom"===e&&o>i,a.Z.clear()})).catch((()=>{a.Z.clear()}))},handleStartTask(){if(this.isOverdue)return void(0,a.Z)(this.$t("common.beginStudyOverdue"));if(this.isNotStarted)return void(0,a.Z)(this.$t("common.beginStudyNotStarted"));const{evaluation_tool_type:t,title:e}=this.evaluationInfo;"model"===t||"post_model"===t?this.$router.push({path:"/single-evaluation",query:{evaluationId:this.evaluationInfo.evaluation_id,type:"self",title:e}}):n.Z.getEvaluationUrl({evaluationId:this.evaluationInfo.evaluation_id}).then((t=>{const e=t.data.auto_login_url;this.$router.push({path:"/evaluation-tool",query:{evaluationId:this.evaluationInfo.evaluation_id,taskId:this.$route.query.taskId,sourceType:"evaluation",evaluationUrl:e}})}))},async handleViewReport(){if("false"===this.evaluationInfo.open_result)return void(0,a.Z)(this.$t("evaluation.viewEvaluationReportTips"));const{evaluation_tool_type:t,evaluation_id:e}=this.evaluationInfo;if("tool"===t){if("true"!==(await this.shouldViewReport(e)).data.look)return void(0,a.Z)(this.$t("evaluation.viewReportTips"))}this.$router.push({path:"/evaluation-report",query:{evaluationId:e,type:t}})},handleToCourseDetail(t){const{evaluation_id:e,finish_promote:s}=this.evaluationInfo;if(this.isOverdue&&"true"===s)return this.$toast(this.$t("common.beginStudyOverdue")),!1;this.$router.push({path:"/course-task-detail",query:{courseId:t.resource_id,courseResource:"task",studyId:e,studyType:"evaluation",syncProgress:t.sync_progress}})},shouldViewReport:t=>n.Z.shouldViewReport({evaluationId:t})}},g=m,v=(0,h.Z)(g,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.evaluationInfo.evaluation_id?s("div",{staticClass:"tranining-detail"},[s("task-info",{attrs:{"evaluation-info":t.evaluationInfo}}),s("div",{staticClass:"evaluation-task"},[s("div",{staticClass:"evaluation-task-header"},[t._v(" "+t._s(t.$t("evaluation.evaluationTask"))+" ")]),s("div",{staticClass:"evaluation-task-info"},[s("div",{staticClass:"evaluation-task-title"},[t._v(" "+t._s(t.evaluationInfo.product_name)+" ")]),s("div",{staticClass:"evaluation-task-bottom"},[t.jurisdiction("startAssessment")?s("van-button",{class:[t.isOverdue||t.isNotStarted?"operate-disabled-button":""],attrs:{size:"mini",color:t.themeColor.primaryColor,plain:""},on:{click:t.handleStartTask}},[t._v(t._s(t.$t("evaluation.startAssessment")))]):t._e(),t.jurisdiction("superiorsReview")?s("van-button",{staticClass:"operate-disabled-button",attrs:{size:"mini",color:t.themeColor.primaryColor,plain:"",disabled:""}},[t._v(t._s(t.$t("evaluation.superiorsReview")))]):t._e(),t.jurisdiction("evaluationReport")?s("van-button",{class:["false"===t.evaluationInfo.open_result?"operate-disabled-button":""],attrs:{color:t.themeColor.primaryColor,size:"mini",plain:""},on:{click:t.handleViewReport}},[t._v(t._s(t.$t("evaluation.evaluationReport")))]):t._e(),t.evaluationInfo.evaluation_process<100?s("div",{staticClass:"evaluation-task-progress-container"},[s("van-progress",{attrs:{"show-pivot":!1,color:t.themeColor.primaryColor,percentage:t.evaluationInfo.evaluation_process}}),s("div",{staticClass:"evaluation-task-progress"},[t._v(" "+t._s(t.evaluationInfo.evaluation_process+"%")+" ")])],1):s("div",{staticClass:"evaluation-task-status"},[t._v(" "+t._s(t.$t("common.finished"))+" ")])],1)])]),t.evaluationInfo.study_resources&&t.evaluationInfo.study_resources.length?s("div",{staticClass:"course-scheme"},[s("div",{staticClass:"scheme-title"},[t._v(t._s(t.$t("evaluation.trainingCase")))]),s("courses-list",{attrs:{"study-resources":t.evaluationInfo.study_resources},on:{onHandleToCourseDetail:t.handleToCourseDetail}})],1):t._e()],1):t._e()}),[],!1,null,"4ebefa7f",null).exports},85054:(t,e,s)=>{s.r(e),s.d(e,{default:()=>f});s(34837);var a=s(39146),i=(s(49153),s(5944)),o=(s(82522),s(10342)),r=(s(82500),s(49414)),n=(s(20581),s(50914)),c=(s(57658),s(95969)),l=s(68593),u=(s(47238),s(75167)),d=s(78368),h=s(22648),p={name:"TaskCard",components:{[u.Z.name]:u.Z},filters:{formatDate:function(t){return(0,h.p6)(t,"yyyy-MM-dd  hh:mm")}},props:{taskInfo:{type:Object,required:!0,default:()=>({})}},data:()=>({defaultAvatar:d}),computed:{themeColor(){return this.$store.state.themeColor}}},m=s(1001),g=(0,m.Z)(p,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"task-card"},[s("div",{staticClass:"task-card-header"},[s("div",{class:["dot",t.taskInfo.category]}),"self"===t.taskInfo.category?s("div",{staticClass:"category"},[t._v(" "+t._s(t.$t("evaluation.self"))+" ")]):"superior"===t.taskInfo.category?s("div",{staticClass:"category"},[t._v(" "+t._s(t.$t("evaluation.other"))+" ")]):s("div",{staticClass:"category"},[t._v(t._s(t.$t("evaluation.tool")))])]),s("div",{staticClass:"task-card-body"},[s("div",{staticClass:"title"},[t._v(" "+t._s(t.taskInfo.title)+" ")]),"permanent"===t.taskInfo.term_type?s("div",{staticClass:"time"},[t._v(" "+t._s(t.$t("evaluation.permanent"))+" ")]):s("div",{staticClass:"time"},[t._v(" "+t._s(t.$t("common.deadline"))+": "+t._s(t._f("formatDate")(t.taskInfo.end_time))+" ")])]),s("div",{staticClass:"task-card-footer"},[s("div",{staticClass:"task-card-footer-left"},[s("img",{staticClass:"avatar",attrs:{src:t.taskInfo.creator_avatar||t.defaultAvatar}}),s("div",{staticClass:"user-name"},[t._v(t._s(t.taskInfo.appoint_user_name))]),t.taskInfo.departments&&t.taskInfo.departments.length>0?s("div",{staticClass:"department"},[s("div",{staticClass:"department-name"},[t._v(" ("+t._s(t.taskInfo.departments.join("/"))+" ")]),s("div",{staticClass:"single-symbol"},[t._v(")")])]):t._e(),s("div",{staticClass:"assign"},[t._v(t._s(t.$t("common.assign")))])]),s("div",{staticClass:"task-card-footer-right"},[s("van-progress",{attrs:{"show-pivot":!1,color:t.themeColor.primaryColor,percentage:t.taskInfo.process}}),s("div",{staticClass:"progress",style:{color:t.themeColor.primaryColor}},[t._v(" "+t._s(t.taskInfo.process)+"% ")])],1)])])}),[],!1,null,"91a2db36",null).exports,v={name:"EvaluationList",components:{[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,TaskCard:g},data:()=>({tabs:[],params:{status:"unfinished",page_number:1},evaluationList:[],loading:!0,finished:!1}),computed:{themeColor(){return this.$store.state.themeColor}},created(){this.tabs=[{name:this.$t("common.unfinished"),status:"unfinished"},{name:this.$t("common.finished"),status:"finished"},{name:this.$t("common.overdue"),status:"overdue"}],this.getMyEvaluationList()},methods:{onLoad(){this.loading=!0,this.params.page_number+=1,this.getMyEvaluationList()},getMyEvaluationList(){1===this.params.page_number&&(this.evaluationList=[]),l.Z.getMyEvaluationList(this.params).then((t=>{this.evaluationList=this.evaluationList.concat(t.data.list),this.finished=!t.data.has_next_page,this.loading=!1})).catch((()=>{this.loading=!1,this.finished=!0}))},changeTab(t){this.params.status=t,this.params.page_number=1,this.finished=!1,this.getMyEvaluationList()},handleToDetail(t){const e=Date.now();if("custom"===t.term_type&&e<t.start_time)return void(0,a.Z)(this.$t("common.beginStudyNotStarted"));const{id:s,category:i}=t;"self"===i||"tool"===i?this.$router.push({path:"/evaluation-detail",query:{taskId:s}}):this.$router.push({path:c.Z.message.evaluationSupDetail({taskId:s})})}}},f=(0,m.Z)(v,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tranining-list"},[s("van-tabs",{attrs:{sticky:"",color:t.themeColor.primaryColor},on:{click:t.changeTab},model:{value:t.params.status,callback:function(e){t.$set(t.params,"status",e)},expression:"params.status"}},t._l(t.tabs,(function(e){return s("van-tab",{key:e.status,attrs:{name:e.status,title:e.name}},[t.loading||0!==t.evaluationList.length?s("van-list",{attrs:{finished:t.finished,"finished-text":t.$t("common.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.evaluationList,(function(e,a){return s("task-card",{key:e.id+""+a,attrs:{"task-info":e},nativeOn:{click:function(s){return t.handleToDetail(e)}}})})),1):s("van-empty",{attrs:{description:t.$t("common.noDataTextTip")}})],1)})),1)],1)}),[],!1,null,"b1289044",null).exports},37707:(t,e,s)=>{s.r(e),s.d(e,{default:()=>p});s(34837);var a=s(39146),i=s(95082),o=(s(25773),s(35791)),r=s(26294),n=s(68593),c=(s(49902),s(62094)),l=(s(21920),s(58280)),u={name:"Question",components:{[l.Z.name]:l.Z,[c.Z.name]:c.Z},props:{questionInfo:{type:Object,default:()=>({}),required:!0},index:{type:Number,default:1},answerType:{type:String,default:""}},data(){return{levelId:"trainee"===this.answerType?this.questionInfo.trainee_level_id:this.questionInfo.superior_level_id}},computed:{themeColor(){return this.$store.state.themeColor}},mounted(){},methods:{handleChooseAnswer(t){const e=(0,i.Z)({},this.questionInfo);"trainee"===this.answerType?e.trainee_level_id=t:e.superior_level_id=t,this.$emit("onChange",{questionInfo:e})}}},d=s(1001),h={components:{Question:(0,d.Z)(u,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"question-container"},[s("div",{staticClass:"question-title"},[t._v(" "+t._s(t.index)+"."+t._s(t.questionInfo.ability_title)+" ")]),s("div",{staticClass:"question-description"},[t._v(" "+t._s(t.questionInfo.ability_description)+" ")]),s("div",{staticClass:"answer"},[s("van-radio-group",{on:{change:t.handleChooseAnswer},model:{value:t.levelId,callback:function(e){t.levelId=e},expression:"levelId"}},t._l(t.questionInfo.level_list,(function(e){return s("div",{key:e.level_id,staticClass:"level-item"},[s("van-radio",{attrs:{"checked-color":t.themeColor.primaryColor,"icon-size":16,name:e.level_id}},[s("div",{staticClass:"level-title"},[t._v(" "+t._s(e.level_title)+" ")])]),s("div",{staticClass:"level-description"},[t._v(" "+t._s(t.$t("personnelDevelope.levelDesc"))+"："+t._s(e.level_description)+" ")]),s("div",{staticClass:"level-description"},[t._v(" "+t._s(t.$t("personnelDevelope.behaviorDesc"))+"："+t._s(e.behavior_desc||"--")+" ")])],1)})),0),t.questionInfo.dimensional_result.length?t._l(t.questionInfo.dimensional_result,(function(e,a){return s("div",{key:a,staticClass:"dimensional-result"},[s("strong",[t._v(t._s(e.dimension)+"：")]),s("span",[t._v(t._s(e.result))]),a!==t.questionInfo.dimensional_result.length-1?s("span",[t._v("，")]):t._e()])})):t._e()],2)])}),[],!1,null,"5b0b8b7e",null).exports,[o.Z.name]:o.Z},data:()=>({assessmentQuestionnaire:{},questionsList:[],disabledSubmit:!0,answerType:"trainee"}),computed:(0,i.Z)({},(0,r.mapGetters)({primaryColor:"getPrimaryColor",userInfo:"user/getUserInfo"})),created(){const{traineeId:t}=this.$route.query;a.Z.loading({duration:0,forbidClick:!0,message:this.$t("common.loading")}),this.answerType=t?"superior":"trainee",t?this.getOtherQuestionnaire():this.getSelfQuestionnaire()},methods:{getSelfQuestionnaire(){const{evaluationId:t}=this.$route.query;n.Z.getSelfQuestionnaire({evaluationId:t}).then((t=>{const e=t.data;e.list.forEach((t=>{t.trainee_level_id=t.trainee_level_id||"",t.superior_level_id=t.superior_level_id||""})),this.assessmentQuestionnaire=e,this.questionsList=e.list||[],a.Z.clear()})).catch((()=>{a.Z.clear()}))},getOtherQuestionnaire(){const{evaluationId:t,traineeId:e}=this.$route.query;n.Z.getOtherQuestionnaire({evaluationId:t,userId:e}).then((t=>{const e=t.data;e.list.forEach((t=>{t.trainee_level_id=t.trainee_level_id||"",t.superior_level_id=t.superior_level_id||""})),this.assessmentQuestionnaire=e,this.questionsList=e.list||[],a.Z.clear()})).catch((()=>{a.Z.clear()}))},handleChooseAnswer({questionInfo:t}){const{traineeId:e}=this.$route.query,s=this.questionsList.findIndex((e=>e.ability_id===t.ability_id));this.questionsList[s]=t,this.disabledSubmit=e?this.questionsList.some((t=>!t.superior_level_id)):this.questionsList.some((t=>!t.trainee_level_id))},handleSubmit(){const{evaluationId:t,type:e}=this.$route.query;let{traineeId:s}=this.$route.query;"self"===e&&(s=this.userInfo.userId);const i=this.questionsList.map((t=>({id:t.ability_id,level_id:"self"===e?t.trainee_level_id:t.superior_level_id})));n.Z.traineeSubmit({submitList:i,evaluationId:t,assessed:s,type:e}).then((()=>{a.Z.success(this.$t("common.submitSuccess")),this.$router.go(-1)})).catch((()=>{a.Z.fail(this.$t("common.submitFailure"))}))}}},p=(0,d.Z)(h,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.assessmentQuestionnaire.id?s("div",{staticClass:"assessment-questionnaire"},[s("div",{staticClass:"title"},[t._v(" "+t._s(t.assessmentQuestionnaire.title)+" ")]),t._l(t.questionsList,(function(e,a){return s("question",{key:e.ability_id,attrs:{"question-info":e,index:a+1,"answer-type":t.answerType},on:{onChange:t.handleChooseAnswer}})})),s("div",{staticClass:"submit-button"},[s("van-button",{attrs:{type:"primary",color:t.primaryColor,size:"small",block:"",disabled:t.disabledSubmit},on:{click:t.handleSubmit}},[t._v(t._s(t.$t("common.submit"))+" ")])],1)],2):t._e()}),[],!1,null,"0086ae0d",null).exports},96274:(t,e,s)=>{s.r(e),s.d(e,{default:()=>x});var a=s(95082),i=(s(34837),s(39146)),o=s(68593),r=s(24004),n=s(38174),c=s(62078);s(33948);const l="https://gsdn.coolcollege.cn/assets/evaluation-tool/bigpsa.png",u="https://gsdn.coolcollege.cn/assets/evaluation-tool/salesbg.png",d="https://gsdn.coolcollege.cn/assets/evaluation-tool/T5bg.png";var h={name:"ReportCover",components:{},props:{reportCover:{type:Object,required:!0,default:()=>({})}},data:()=>({psa:"https://gsdn.coolcollege.cn/assets/evaluation-tool/psa.png",bigpsa:l,sales:"https://gsdn.coolcollege.cn/assets/evaluation-tool/sales.png",salesbg:u,T5:"https://gsdn.coolcollege.cn/assets/evaluation-tool/T5.png",T5bg:d,bg:"",lineColor:"",reportCode:""}),created(){const{reportCode:t}=this.reportCover;this.reportCode=t,this.bg="psa"===t?l:"sales-assessment"===t?u:d,this.lineColor="psa"===t?"#456AEF":"sales-assessment"===t?"#7567D6":"#3652B5"}},p=s(1001),m=(0,p.Z)(h,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"common-evaluationReport-content_container_cover"},[s("div",{staticClass:"common-evaluationReport-content_container_cover__theme",style:{backgroundImage:"url("+t.bg+")"}},[s("img",{attrs:{src:"psa"==t.reportCode?t.psa:"sales-assessment"==t.reportCode?t.sales:t.T5}})]),s("div",[s("div",{staticClass:"common-evaluationReport-content_container_cover__info"},[s("h1",[s("div",{staticStyle:{"margin-bottom":"6px"}},[t._v(t._s(t.reportCover.reportName))]),"psa"==t.reportCode?s("span",[s("i",{staticStyle:{background:"#466AF4",width:"25%"}}),s("i",{staticStyle:{background:"#6F8EFF",width:"25%"}}),s("i",{staticStyle:{background:"#F4BB11",width:"25%"}}),s("i",{staticStyle:{background:"#F7CB43",width:"25%"}})]):"sales-assessment"==t.reportCode?s("span",[s("i",{staticStyle:{background:"#8866E2",width:"25%"}}),s("i",{staticStyle:{background:"#9B80DD",width:"25%"}}),s("i",{staticStyle:{background:"#DF5A5F",width:"25%"}}),s("i",{staticStyle:{background:"#F47E7C",width:"25%"}})]):s("span",[s("i",{staticStyle:{background:"#C35982",width:"20%"}}),s("i",{staticStyle:{background:"#985CAE",width:"20%"}}),s("i",{staticStyle:{background:"#02B4C8",width:"20%"}}),s("i",{staticStyle:{background:"#FF7B3B",width:"20%"}}),s("i",{staticStyle:{background:"#F24340",width:"20%"}})])]),"sales-assessment"!=t.reportCode?[s("h2",[t._v(t._s(t.reportCover.reportCoverName))])]:t._e(),s("p",[s("span",{staticStyle:{"margin-right":"23px"}},[t._v("测评语言："+t._s(t.reportCover.testLanguage))]),s("span",[t._v("报告语言："+t._s(t.reportCover.reportLanguage))])]),s("dl",[s("dt",[t._v(t._s(t.reportCover.dReportUser.name))]),s("dd",[s("div",[t._v("报告时间："+t._s(t.reportCover.dReportUser.compileDate))])])])],2)]),s("div",{staticClass:"common-evaluationReport-content_container_cover__foot",style:{background:t.lineColor}},[s("img",{attrs:{src:"https://oss.coolcollege.cn/1799469675302752256.png"}})])])}),[],!1,null,"496f142c",null).exports,g=(s(65069),{name:"AppraisalMenu",props:{appraisalData:{type:Object,required:!0,default:()=>({})},reportUser:{type:Object,required:!0,default:()=>({})}},created(){}}),v=(0,p.Z)(g,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"common-evaluationReport-content_container_portion"},[s("div",{staticClass:"portion__title"},[s("span",[t._v(t._s(t.appraisalData.title))])]),s("div",{staticClass:"portion__intro"},[s("p",[t._v(t._s(t.appraisalData.intro))])]),s("div",{staticClass:"appendix"},[s("div",{staticClass:"appendix__item"},[t.appraisalData.cList.content&&"appendixInformation"==t.appraisalData.cList.component?[t._l(t.appraisalData.cList.content,(function(e,a){return[s("div",{key:"appendix__item_"+a,staticClass:"appendix__item"},[s("div",{staticClass:"appendix__tit"},[t._v(t._s(e.title))]),s("div",{staticClass:"appendix__des"},[t._v(t._s(e.intro))]),s("div",{staticClass:"appendix__data com-table"},[e.cList&&"comparisonOfNorm"===e.cList.component?[s("table",[t._m(0,!0),t._l(e.cList.content,(function(e,a){return[s("tr",{key:a},[s("td",[t._v(t._s(e.toolName))]),s("td",[t._v(t._s(e.comparisonGroup))])])]}))],2)]:t._e(),e.cList&&"answerParameterInformation"===e.cList.component?[t._l(e.cList.content,(function(e,a){return[s("table",{key:a},[s("tr",[s("th",{attrs:{width:"100"}},[t._v(t._s(e.title)+"答题参数")]),s("th",{attrs:{width:"56"}},[t._v("得分")]),s("th",[t._v("描述")])]),t._l(e.paramMessages,(function(e,a){return s("tr",{key:a},[s("td",[t._v(t._s(e.paramName))]),s("td",[t._v(t._s(e.score))]),s("td",{style:{padding:"8px 10px",textAlign:"left"}},[t._v(t._s(e.description))])])}))],2)]}))]:t._e(),e.cList&&"processInformation"===e.cList.component?[s("table",[s("tr",{staticClass:"crowd"},[s("th",{attrs:{width:"136"}},[t._v("测评工具名称")]),s("th",{attrs:{width:"68"}},[t._v("作答状态")]),s("th",{attrs:{width:"100"}},[t._v("异常原因")]),s("th",{attrs:{width:"80"}},[t._v("中断次数 "),s("br",{style:{lineHeight:"normal"}}),t._v("（次） ")]),s("th",{attrs:{width:"80"}},[t._v(t._s(t.reportUser.name)+" "),s("br",{style:{lineHeight:"normal"}}),t._v("作答时间 "),s("br",{style:{lineHeight:"normal"}}),t._v("（分钟） ")]),s("th",{attrs:{width:"80"}},[t._v("大多数人 "),s("br",{style:{lineHeight:"normal"}}),t._v("答题时间 "),s("br",{style:{lineHeight:"normal"}}),t._v("（分钟） ")]),s("th",[t._v("答题数 "),s("br",{style:{lineHeight:"normal"}}),t._v("（题） ")]),s("th",{attrs:{width:"80"}},[t._v("总题量 "),s("br",{style:{lineHeight:"normal"}}),t._v("（题） ")])]),t._l(e.cList.content,(function(e,a){return s("tr",{key:a},[s("td",[t._v(t._s(e.toolName))]),s("td",[t._v(t._s(e.status))]),s("td",[t._v(t._s(e.exceptionReason))]),s("td",[t._v(t._s(e.interruptedNum))]),s("td",[t._v(t._s(e.answerTime))]),s("td",[t._v(t._s(e.mostAnswerTime))]),s("td",[t._v(t._s(e.answerQuestionNum))]),s("td",[t._v(t._s(e.allQuestionNum))])])}))],2)]:t._e()],2)])]}))]:t._e()],2)])])}),[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",[s("th",[t._v("测评工具名称")]),s("th",[t._v("比较组")])])}],!1,null,"7e7c49ee",null).exports,f={name:"PsaAssessment",components:{AppraisalMenu:v},props:{reportData:{type:Array,required:!0,default:()=>[]},reportUser:{type:String,required:!0,default:()=>""}},data:()=>({appraisalData:[],reportDataBackup:[]}),created(){const[t,...e]=[...this.reportData].reverse();this.reportDataBackup=e.reverse(),this.appraisalData=t}},y=(0,p.Z)(f,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"sales-evaluationReport-content"},[s("div",{staticClass:"sales-evaluationReport-content_container"},[t._l(t.reportDataBackup,(function(e,a){return[s("div",{key:"portion_"+a,staticClass:"common-evaluationReport-content_container_portion"},[s("div",{class:1==e.type?"portion__title portion__title--big":"portion__title"},[s("span",[t._v(t._s(e.title))])]),s("div",{staticClass:"portion__intro"},[s("p",{domProps:{innerHTML:t.xss(t._s(e.intro))}})]),e.cList&&"PSAComprehensiveDescriptionComponent"===e.cList.component?[s("div",{staticClass:"PSA-comprehensive-description"},[t._l(e.cList.content,(function(e,a){return[s("div",{key:a,staticClass:"total-points"},[s("div",{staticClass:"total-points-head clearfix"},[s("span",{staticStyle:{"font-weight":"800"}},[t._v(t._s(e.title))]),s("strong",[t._v(t._s(e.totalScore)+"分")]),s("span",[t._v("，处于")]),s("strong",[t._v(t._s(e.scoreLevel))]),s("span",[t._v(" 水平")])]),s("div",{staticClass:"total-points-body"},[s("div",{staticStyle:{position:"relative"}},[s("div",{staticClass:"total-bar"},[s("div",{staticStyle:{height:"10px"}}),s("div",{staticClass:"total-bar-scale"},[t._l(10,(function(e){return s("div",{key:e},[s("div",{staticClass:"item"},[e<10?s("span",[t._v(t._s(e))]):t._e()])])})),s("div",{staticClass:"after"},[t._v("10")]),s("div",{staticClass:"cur",style:{width:10*e.score+"%",background:"rgb(54, 82, 180)"}},[s("span",{staticStyle:{background:"rgba(0, 0, 0, 0.15)"}})])],2)])])])]),s("div",{key:a,staticClass:"dimension-data",staticStyle:{"margin-top":"-1px",width:"100%","padding-left":"0"}},[s("table",{staticStyle:{width:"100%"}},[t._m(0,!0),t._l(e.items,(function(a,i){return[i<=e.items.length-1?s("tr",{key:i},[s("td",{staticClass:"td-padding"},[s("strong",[t._v(t._s(a.indexName))])]),s("td",{staticClass:"td-padding"},[t._v(t._s(a.comment))]),s("td",{staticStyle:{padding:"5px 10px"},attrs:{colSpan:"3"}},[s("div",{staticStyle:{position:"relative"}},[s("div",{staticClass:"total-bar"},[s("div",{staticStyle:{height:"10px"}}),s("div",{staticClass:"total-bar-scale"},[t._l(10,(function(e){return s("div",{key:e},[s("div",{staticClass:"item"},[e<10?s("span",[t._v(t._s(e))]):t._e()])])})),s("div",{staticClass:"after"},[t._v("10")]),s("div",{staticClass:"cur",style:{width:10*a.score+"%",background:"rgb(54, 82, 180)"}},[s("span",{staticStyle:{background:"rgba(0, 0, 0, 0.15)"}})])],2)])])]),s("td",{staticClass:"td-padding"},[s("p",{staticClass:"center"},[t._v(t._s(a.score))])])]):t._e()]})),t._m(1,!0)],2)])]}))],2)]:t._e(),e.cList&&"PSADetailedDescriptionComponent"===e.cList.component?[s("div",{staticClass:"PSA-detailed-description"},[t._l(e.cList.content,(function(e,a){return[s("div",{key:a,staticClass:"item-wrap"},[s("h3",[t._v(t._s(e.title))]),s("span",{staticClass:"desc",domProps:{innerHTML:t.xss(t._s(e.description))}}),s("div",{staticClass:"dimension-data",staticStyle:{"margin-top":"10px"}},[s("table",{staticStyle:{width:"100%"}},[s("tr",{staticClass:"table-head"},[t._l(e.levelIntervals,(function(e,a){return s("th",{key:a,attrs:{width:e.length/10*100+"%"}},[t._v(t._s(e.title))])})),s("th",{attrs:{width:"10%"}},[t._v("得分")])],2),s("tr",[s("td",{attrs:{colSpan:e.levelIntervals.length}},[s("div",{staticStyle:{position:"relative"}},[s("div",{staticClass:"total-bar"},[s("div",{staticStyle:{height:"10px"}}),s("div",{staticClass:"total-bar-scale"},[t._l(10,(function(e){return s("div",{key:e},[s("div",{staticClass:"item"},[e<10?s("span",[t._v(t._s(e))]):t._e()])])})),s("div",{staticClass:"after"},[t._v("10")]),s("div",{staticClass:"cur",style:{width:10*e.score+"%",background:"rgb(54, 82, 180)"}},[s("span",{staticStyle:{background:"rgba(0, 0, 0, 0.15)"}})])],2)])])]),s("td",[s("p",{staticClass:"center"},[t._v(t._s(e.score))])])]),s("tr",{staticClass:"tr-border2"},[s("td",{attrs:{colSpan:"100"}},t._l(e.entrys,(function(e,a){return s("div",{key:a,staticClass:"entrys-block"},[s("span",{staticStyle:{display:"inline-block","font-weight":"800","margin-bottom":"10px"}},[t._v(t._s(e.title)+"：")]),t._l(e.contents,(function(e,a){return s("ul",{key:a,staticClass:"com-list clearcom-bottom"},[s("li",[t._v(t._s(e))])])}))],2)})),0)])])])])]}))],2)]:t._e()],2)]})),s("appraisal-menu",{attrs:{"appraisal-data":t.appraisalData,"report-user":t.reportUser}})],2),s("AppraisalMenu",{attrs:{"appraisal-data":t.appraisalData,"report-user":t.reportUser}})],1)}),[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",{staticClass:"table-head"},[s("th",{attrs:{width:"10%"}},[t._v("指标")]),s("th",{attrs:{width:"30%"}},[t._v("定义")]),s("th",{attrs:{width:"16%"}},[t._v("待发展")]),s("th",{attrs:{width:"8%"}},[t._v("中等")]),s("th",{attrs:{width:"16%"}},[t._v("优势")]),s("th",{attrs:{width:"10%"}},[t._v("得分")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",[s("td",{staticStyle:{"text-align":"left"},attrs:{colSpan:"6"}},[s("span",[s("span",{staticClass:"mark",staticStyle:{"background-color":"rgb(54, 82, 180)",border:"1px solid rgb(54, 82, 180)"}}),s("span",{staticClass:"label"},[t._v("个人得分")])]),s("span",[t._v("注：将得分按以下标准划分为三个等级：[0, 4]为待发展 ， (4, 6]为中等，(6, 10]为优势")])])])}],!1,null,null,null).exports,_={name:"SalesAssessmentReport",components:{AppraisalMenu:v},props:{reportData:{type:Array,required:!0,default:()=>[]},reportUser:{type:Object,required:!0,default:()=>({})}},data:()=>({appraisalData:[],reportDataBackup:[]}),created(){const[t,...e]=[...this.reportData].reverse();this.reportDataBackup=e.reverse(),this.appraisalData=t}},C=(0,p.Z)(_,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"sales-evaluationReport-content"},[s("div",{staticClass:"sales-evaluationReport-content_container"},[t._l(t.reportDataBackup,(function(e,a){return[s("div",{key:"portion_"+a,staticClass:"common-evaluationReport-content_container_portion"},[s("div",{class:1==e.type?"portion__title portion__title--big":"portion__title"},[s("span",[t._v(t._s(e.title))])]),s("div",{staticClass:"portion__intro"},[s("p",{domProps:{innerHTML:t.xss(t._s(e.intro))}})]),e.cList&&"comprehensiveAnalysisOfPersonnelComponent"===e.cList.component?[s("div",{staticClass:"dimension"},[t._l(e.cList.content,(function(a,i){return[s("div",{key:i,staticClass:"summ"},[s("span",[t._v(t._s(a.name))]),s("strong",[t._v(t._s(a.score))]),s("b",[t._v("（"+t._s(a.level)+"）")])]),s("div",{key:i,staticClass:"dimension-data sale-dimension-data"},[s("table",[t._m(0,!0),t._l(a.datas,(function(e,a){return[s("tr",{key:a},[s("td",[s("p",{staticClass:"center"},[s("strong",[t._v(t._s(e.indexName))])])]),s("td",[s("p",{staticClass:"center"},[t._v(t._s(e.score))])]),s("td",{staticClass:"score-td"},[s("div",{staticClass:"score-bg",staticStyle:{left:"0"}}),s("div",{staticClass:"score-bg",staticStyle:{left:"20%"}}),s("div",{staticClass:"score-bg",staticStyle:{left:"40%"}}),s("div",{staticClass:"score-bg",staticStyle:{left:"60%"}}),s("div",{staticClass:"score-bg",staticStyle:{left:"80%",borderRight:"0"}}),s("div",{staticClass:"score-bar",style:{width:e.score/10*100+"%"}})])])]})),i===e.cList.content.length-1?s("tr",[s("td",{staticClass:"desc",attrs:{colSpan:"3"}},[t._v("注：将得分按以下标准划分为三个等级：[0, 4]为待发展 ， (4, 6]为中等，(6, 10]为优势")])]):t._e()],2)])]}))],2)]:t._e(),e.cList&&"salesCharacteristicsComponent"===e.cList.component?[s("div",{staticClass:"dimension-wrap"},t._l(e.cList.content,(function(e,a){return s("div",{key:a,staticClass:"dimension"},[s("div",{staticClass:"total-points"},[s("div",{staticClass:"total-points-head clearfix"},[s("div",{staticClass:"total-points-head-left"},[s("span",[t._v(t._s(e.title))]),s("strong",[t._v(t._s(e.score))]),s("b",[t._v("（"+t._s(e.level)+"）")])])]),s("div",{staticClass:"total-points-body"},[s("div",{staticClass:"total-bar total-bar-benchmarking"},[s("div",{staticClass:"total-bar-sum",staticStyle:{color:"rgb(255, 102, 102)",display:"none"}},[t._v(t._s(e.score))]),s("div",{staticStyle:{height:"10px"}}),s("div",{staticClass:"total-bar-scale"},[t._l(10,(function(e){return[s("div",{key:e,staticClass:"item"},[s("span",[t._v(t._s(e-1))])])]})),s("div",{staticClass:"after"},[t._v("10")]),s("div",{staticClass:"cur",style:{width:10*e.score+"%",background:"rgb(255, 102, 102)"}},[s("span",{staticStyle:{background:"rgba(218, 87, 87)"}})])],2)])])]),s("div",{staticClass:"dimension-data sale-dimension-data-single"},[s("table",[t._m(1,!0),t._l(e.dataItems,(function(a,i){return[s("tr",{key:i},[s("td",[s("p",{staticClass:"center"},[s("strong",[t._v(t._s(a.indexName))])])]),s("td",[s("p",[t._v(t._s(a.comment))])]),s("td",{attrs:{colSpan:"3"}},[s("div",{staticClass:"total-bar total-bar-benchmarking"},[s("div",{staticClass:"total-bar-sum",staticStyle:{color:"rgb(255, 102, 102)",display:"none"}},[t._v(t._s(a.score))]),s("div",{staticStyle:{height:"10px"}}),s("div",{staticClass:"total-bar-scale"},[t._l(10,(function(e){return[s("div",{key:e,staticClass:"item"},[s("span",[t._v(t._s(e-1))])])]})),s("div",{staticClass:"after"},[t._v("10")]),s("div",{staticClass:"cur",style:{width:10*a.score+"%",background:"rgb(255, 102, 102)"}},[s("span",{staticStyle:{background:"rgba(218, 87, 87)"}})])],2)])]),s("td",[s("p",{staticClass:"center"},[t._v(t._s(a.score))])])]),s("tr",{key:i},[s("td",{attrs:{colSpan:"6"}},[s("p",[t._v(t._s(t.reportUser.name+"可能表现为："))]),t._l(a.performances,(function(e,a){return[s("ul",{key:a,staticClass:"com-list"},[s("li",[t._v(t._s(e))])])]}))],2)]),i===e.dataItems.length-1?s("tr",{key:i},[t._m(2,!0)]):t._e()]}))],2)])])})),0)]:t._e(),e.cList&&"salesBehaviorAwarenessComponent"===e.cList.component?[s("div",{staticClass:"dimension-wrap"},t._l(e.cList.content,(function(e,a){return s("div",{key:a,staticClass:"dimension"},[s("div",{staticClass:"total-points"},[s("div",{staticClass:"total-points-head clearfix"},[s("div",{staticClass:"total-points-head-left"},[s("span",[t._v(t._s(e.title))]),s("strong",[t._v(t._s(e.totalScore))]),s("b",[t._v("（"+t._s(e.scoreLevel)+"）")])])]),s("div",{staticClass:"total-points-body"},[s("div",{staticClass:"total-bar total-bar-benchmarking"},[s("div",{staticClass:"total-bar-sum",staticStyle:{color:"rgb(255, 102, 102)",display:"none"}},[t._v(t._s(e.totalScore))]),s("div",{staticStyle:{height:"10px"}}),s("div",{staticClass:"total-bar-scale"},[t._l(10,(function(e){return[s("div",{key:e,staticClass:"item"},[s("span",[t._v(t._s(e-1))])])]})),s("div",{staticClass:"after"},[t._v("10")]),s("div",{staticClass:"cur",style:{width:10*e.totalScore+"%",background:"rgb(255, 102, 102)"}},[s("span",{staticStyle:{background:"rgba(218, 87, 87)"}})])],2)])])]),s("div",{staticClass:"dimension-data sale-dimension-data-single"},[s("table",[t._m(3,!0),t._l(e.items,(function(a,i){return[s("tr",{key:i},[s("td",[s("p",{staticClass:"center"},[s("strong",[t._v(t._s(a.indexName))])])]),s("td",[s("p",[t._v(t._s(a.comment))])]),s("td",{attrs:{colSpan:"3"}},[s("div",{staticClass:"total-bar total-bar-benchmarking"},[s("div",{staticClass:"total-bar-sum",staticStyle:{color:"rgb(255, 102, 102)",display:"none"}},[t._v(t._s(a.score))]),s("div",{staticStyle:{height:"10px"}}),s("div",{staticClass:"total-bar-scale"},[t._l(10,(function(e){return[s("div",{key:e,staticClass:"item"},[s("span",[t._v(t._s(e-1))])])]})),s("div",{staticClass:"after"},[t._v("10")]),s("div",{staticClass:"cur",style:{width:10*a.score+"%",background:"rgb(255, 102, 102)"}},[s("span",{staticStyle:{background:"rgba(218, 87, 87)"}})])],2)])]),s("td",[s("p",{staticClass:"center"},[t._v(t._s(a.score))])])]),i==e.items.length-1?s("tr",{key:i},[t._m(4,!0)]):t._e()]}))],2)])])})),0)]:t._e(),e.cList&&"salesDrivingForceComponent"===e.cList.component?[s("div",{staticClass:"dimension-wrap"},t._l(e.cList.content,(function(e,a){return s("div",{key:a,staticClass:"dimension"},[s("div",{staticClass:"total-points"},[s("div",{staticClass:"total-points-head clearfix"},[s("div",{staticClass:"total-points-head-left"},[s("span",[t._v(t._s(e.title))]),s("strong",[t._v(t._s(e.totalScore))]),s("b",[t._v("（"+t._s(e.scoreLevel)+"）")])])]),s("div",{staticClass:"total-points-body"},[s("div",{staticClass:"total-bar total-bar-benchmarking"},[s("div",{staticClass:"total-bar-sum",staticStyle:{color:"rgb(255, 102, 102)",display:"none"}},[t._v(t._s(e.totalScore))]),s("div",{staticStyle:{height:"10px"}}),s("div",{staticClass:"total-bar-scale"},[t._l(10,(function(e){return[s("div",{key:e,staticClass:"item"},[s("span",[t._v(t._s(e-1))])])]})),s("div",{staticClass:"after"},[t._v("10")]),s("div",{staticClass:"cur",style:{width:10*e.totalScore+"%",background:"rgb(255, 102, 102)"}},[s("span",{staticStyle:{background:"rgba(218, 87, 87)"}})])],2)])])]),s("div",{staticClass:"dimension-data sale-dimension-data-single"},[s("table",[t._m(5,!0),t._l(e.items,(function(a,i){return[s("tr",{key:i},[s("td",[s("p",{staticClass:"center"},[s("strong",[t._v(t._s(a.indexName))])])]),s("td",[s("p",[t._v(t._s(a.comment))])]),s("td",{attrs:{colSpan:"5"}},[s("div",{staticClass:"bar origin-bar"},[s("div",{staticClass:"bar-tit",staticStyle:{color:"rgb(255, 102, 102)"}}),s("div",{staticClass:"bar-scale"},t._l(10,(function(e){return s("div",{key:e,staticClass:"item",style:e==a.score?{background:"rgb(255, 102, 102)",fontWeight:"bold",fontSize:"14px"}:""},[t._v(" "+t._s(e)),s("span",{style:e==a.score?{background:"rgb(218, 87, 87)"}:""})])})),0)])])]),i==e.items.length-1?s("tr",{key:i},[t._m(6,!0)]):t._e()]}))],2)])])})),0)]:t._e()],2)]})),s("appraisal-menu",{attrs:{"appraisal-data":t.appraisalData,"report-user":t.reportUser}})],2)])}),[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",{staticClass:"table-head"},[s("th",{attrs:{width:"120"}},[t._v("维度")]),s("th",[t._v("得分")]),s("th",{staticStyle:{position:"relative"},attrs:{width:"490"}},[s("div",{staticClass:"score-idc"},[s("span",[t._v("0")])]),s("div",{staticClass:"score-idc"},[s("span",[t._v("2")])]),s("div",{staticClass:"score-idc"},[s("span",[t._v("4")])]),s("div",{staticClass:"score-idc"},[s("span",[t._v("6")])]),s("div",{staticClass:"score-idc"},[s("span",[t._v("8")])]),s("div",{staticClass:"after"},[s("span",[t._v("10")])])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",{staticClass:"table-head"},[s("th",{attrs:{width:"78"}},[t._v("维度")]),s("th",[t._v("定义")]),s("th",{attrs:{width:"128"}},[t._v("待发展")]),s("th",{attrs:{width:"64"}},[t._v("中等")]),s("th",{attrs:{width:"128"}},[t._v("优势")]),s("th",{attrs:{width:"55"}},[t._v("得分")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("td",{attrs:{colSpan:"6"}},[s("div",{staticClass:"legend"},[s("div",{staticClass:"legend-item"},[s("span",{staticClass:"legend-color_sales"}),s("b",[t._v("个人得分")])])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",{staticClass:"table-head"},[s("th",{attrs:{width:"78"}},[t._v("维度")]),s("th",[t._v("定义")]),s("th",{attrs:{width:"128"}},[t._v("待发展")]),s("th",{attrs:{width:"64"}},[t._v("中等")]),s("th",{attrs:{width:"128"}},[t._v("优势")]),s("th",{attrs:{width:"55"}},[t._v("得分")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("td",{attrs:{colSpan:"6"}},[s("div",{staticClass:"legend"},[s("div",{staticClass:"legend-item"},[s("span",{staticClass:"legend-color_sales"}),s("b",[t._v("个人得分")])])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",{staticClass:"table-head"},[s("th",{attrs:{width:"78"}},[t._v("维度")]),s("th",[t._v("定义")]),s("th",{attrs:{width:"64"}},[t._v("弱激励")]),s("th",{attrs:{width:"64"}},[t._v("较弱激励")]),s("th",{attrs:{width:"64"}},[t._v("一般激励")]),s("th",{attrs:{width:"64"}},[t._v("较强激励")]),s("th",{attrs:{width:"64"}},[t._v("强激励")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("td",{staticStyle:{padding:"8px 10px"},attrs:{colSpan:"7"}},[s("div",{staticClass:"legend"},[s("div",{staticClass:"legend-item"},[s("span",{staticClass:"legend-color_sales"}),s("b",[t._v("个人得分")])])])])}],!1,null,null,null).exports,I={name:"T5Assessment",components:{AppraisalMenu:v},props:{reportData:{type:Array,required:!0,default:()=>[]},reportUser:{type:Object,required:!0,default:()=>({})}},data:()=>({appraisalData:[],reportDataBackup:[]}),created(){const[t,...e]=[...this.reportData].reverse();this.reportDataBackup=e.reverse(),this.appraisalData=t}},b=(0,p.Z)(I,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"sales-evaluationReport-content"},[s("div",{staticClass:"sales-evaluationReport-content_container"},[t._l(t.reportDataBackup,(function(e,a){return[s("div",{key:"portion_"+a,staticClass:"common-evaluationReport-content_container_portion"},[s("div",{class:1==e.type?"portion__title portion__title--big":"portion__title"},[s("span",[t._v(t._s(e.title))])]),s("div",{staticClass:"portion__intro"},[s("p",{domProps:{innerHTML:t.xss(t._s(e.intro))}})]),e.cList&&"abilityIntervalScoreComponent"===e.cList.component?[t._l(e.cList.content,(function(e,a){return[s("div",{key:a,staticClass:"ability-interval-score"},[s("div",{staticClass:"total-points"},[s("div",{staticClass:"total-points-head clearfix"},[s("span",[t._v("能力倾向")]),s("strong",[t._v(t._s(e.totalScore)+"分")]),s("span",[t._v("，处于")]),s("strong",[t._v(t._s(e.scoreLevel))]),s("span",[t._v(" 水平")])]),s("div",{staticClass:"total-points-body"},[s("div",{style:{position:"relative"}},[s("div",{staticClass:"total-bar"},[s("div",{style:{height:"10px"}}),s("div",{staticClass:"total-bar-scale"},[t._l(10,(function(e){return[s("div",{key:e,staticClass:"item"},[s("span",[t._v(t._s(e-1))])])]})),s("div",{staticClass:"after"},[t._v("10")]),s("div",{staticClass:"cur",style:{width:10*e.totalScore+"%",background:"rgb(54, 82, 180)"}},[s("span",{style:{background:"rgba(0, 0, 0, 0.15)"}})])],2)])])])]),s("div",{staticClass:"dimension-data",style:{marginTop:"-1px",width:"100%",paddingLeft:"0"}},[s("table",{style:{width:"100%"}},[t._m(0,!0),t._l(e.items,(function(a,i){return[i<=e.items.length-1?s("tr",{key:i},[s("td",[t._v(t._s(a.indexName))]),s("td",[t._v(t._s(a.comment))]),s("td",{attrs:{colSpan:"3"}},[s("div",{style:{position:"relative"}},[s("div",{staticClass:"total-bar"},[s("div",{style:{height:"10px"}}),s("div",{staticClass:"total-bar-scale"},[t._l(10,(function(e){return[s("div",{key:e,staticClass:"item"},[s("span",[t._v(t._s(e-1))])])]})),s("div",{staticClass:"after"},[t._v("10")]),s("div",{staticClass:"cur",style:{width:10*a.score+"%",background:"rgb(54, 82, 180)"}},[s("span",{style:{background:"rgba(0, 0, 0, 0.15)"}})])],2)])])]),s("td",[s("p",{staticClass:"center"},[t._v(t._s(a.score))])])]):t._e()]})),t._m(1,!0)],2)])])]}))]:t._e(),e.cList&&"abilityIntervalDetailComponent"===e.cList.component?[s("div",{staticClass:"ability-interval-detail"},[t._l(e.cList.content,(function(e,a){return[s("div",{key:a,staticClass:"item-wrap"},[s("h3",[t._v(t._s(e.title))]),s("div",{staticClass:"dimension-data",style:{marginTop:"10px"}},[s("table",[t._m(2,!0),t._l(e.items,(function(a,i){return[i<=e.items.length-1?s("tr",{key:i},[s("td",{style:{textAlign:"center"}},[s("strong",[t._v(t._s(a.name))])]),s("td",[s("p",[t._v(t._s(a.comment))])]),s("td",{attrs:{colSpan:"3"}},[s("div",{style:{position:"relative"}},[s("div",{staticClass:"total-bar"},[s("div",{style:{height:"10px"}}),s("div",{staticClass:"total-bar-scale"},[t._l(10,(function(e){return[s("div",{key:e,staticClass:"item"},[s("span",[t._v(t._s(e-1))])])]})),s("div",{staticClass:"after"},[t._v("10")]),s("div",{staticClass:"cur",style:{width:10*a.score+"%",background:"rgb(54, 82, 180)"}},[s("span",{style:{background:"rgba(0, 0, 0, 0.15)"}})])],2)])])]),s("td",[s("p",{staticClass:"center"},[t._v(t._s(a.score))])])]):t._e(),i<=e.items.length-1?s("tr",{key:i,staticClass:"tr-border2"},[s("td",{attrs:{colSpan:"6"}},[t._l(a.performances,(function(e,a){return[s("ul",{key:a,staticClass:"com-list"},[s("li",[t._v(t._s(e))])])]}))],2)]):t._e()]})),t._m(3,!0)],2)])])]}))],2)]:t._e()],2)]})),s("appraisal-menu",{attrs:{"appraisal-data":t.appraisalData,"report-user":t.reportUser}})],2)])}),[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",{staticClass:"table-head"},[s("th",{attrs:{width:"10%"}},[t._v("维度")]),s("th",{attrs:{width:"20%"}},[t._v("定义")]),s("th",{attrs:{width:"20%"}},[t._v("待发展")]),s("th",{attrs:{width:"10%"}},[t._v("中等")]),s("th",{attrs:{width:"20%"}},[t._v("优势")]),s("th",{attrs:{width:"10%"}},[t._v("得分")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",[s("td",{attrs:{colSpan:"6"}},[s("div",{staticClass:"legend"},[s("div",{staticClass:"legend-item"},[s("span",{staticClass:"legend-color"}),s("b",[t._v("个人得分")])])])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",{staticClass:"table-head"},[s("th",{attrs:{width:"80"}},[t._v("维度")]),s("th",[t._v("定义")]),s("th",{attrs:{width:"126"}},[t._v("待发展")]),s("th",{attrs:{width:"64"}},[t._v("中等")]),s("th",{attrs:{width:"128"}},[t._v("优势")]),s("th",{attrs:{width:"55"}},[t._v("得分")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",[s("td",{attrs:{colSpan:"6"}},[s("div",{staticClass:"legend"},[s("div",{staticClass:"legend-item"},[s("span",{staticClass:"legend-color"}),s("b",[t._v("个人得分")])])])])])}],!1,null,null,null).exports,w={name:"DisclaimerFooter"},$=(0,p.Z)(w,(function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)}),[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"common-evaluationReport-content_container_portion"},[s("div",{staticClass:"portion__title portion__title--big"},[s("span",[t._v("免责声明")])]),s("div",{staticClass:"portion__intro"},[s("p",[t._v("以下说明与本测评报告正文一起构成本测评报告不可分割的统一整体。")])]),s("div",{staticClass:"disclaimer"},[s("ul",{staticClass:"disclaimer__list"},[s("li",[t._v("本测评报告基于测评者的作答情况而获得，结果代表的是测评者的自我觉知。在解释这些数据时应适当考虑到问卷分值中的主观因素。")]),s("li",[t._v("本报告由系统自动生成。倍智并不保证该报告未经修改。")]),s("li",[t._v("本测评报告正文内容可能引发的与任何第三人之纠纷或冲突，本测评机构不承担任何法律责任。本测评机构亦不在此类纠纷或冲突中充当证人、调停人或其它形式之参与人。")]),s("li",[t._v("本测评报告不得用于非法之目的，本测评机构不承担任何由此而发生或可能发生之法律责任。")]),s("li",[t._v("本报告所包含的内容应为保密信息，因此应该得到妥善保存。一般情况下，本报告的有效期为18到24个月。如果测评者的生活或工作发生了重大变故，建议重新完成测评。")])]),s("div",{staticClass:"disclaimer__info"},[s("p",[t._v("当本测评报告打印、持有、出具、展示或以其它任何形式使用时，即表明本测评报告之持有人或接触人已审读、理解并同意以上各条款之规定。")]),s("p",{staticClass:"disclaimer__right"},[t._v("最终解释权归倍智所有。")])])])])}],!1,null,"9a0ec130",null).exports;const k=["reportDefinitions"];var S={name:"CommonEvaluation",components:{ReportCover:m,PsaAssessment:y,SalesAssessmentReport:C,T5Assessment:b,DisclaimerFooter:$},props:{reportData:{type:Object,required:!0,default:()=>({})}},data:()=>({reportCover:{},reportDefinitions:{}}),created(){const t=this.reportData,{reportDefinitions:e}=t,s=(0,c.Z)(t,k);this.reportCover=(0,a.Z)({},s),this.reportDefinitions=[...e]}},T=(0,p.Z)(S,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"common-evaluationReport-content"},[s("div",{staticClass:"common-evaluationReport-content_container"},[s("ReportCover",{attrs:{"report-cover":t.reportCover}}),"psa"===t.reportData.reportCode?[s("psa-assessment",{attrs:{"report-user":t.reportData.dReportUser,"report-data":t.reportDefinitions}})]:t._e(),"sales-assessment"===t.reportData.reportCode?[s("sales-assessmentReport",{attrs:{"report-user":t.reportData.dReportUser,"report-data":t.reportDefinitions}})]:t._e(),"ocean-aptitude-interval"===t.reportData.reportCode?[s("t5-assessment",{attrs:{"report-user":t.reportData.dReportUser,"report-data":t.reportDefinitions}})]:t._e(),s("DisclaimerFooter")],2)])}),[],!1,null,"3dce0898",null).exports,Z={name:"EvaluationTool",components:{Radar:r.Z,AbilityScoreList:n.Z,CommonEvaluation:T,[i.Z.name]:i.Z},data(){return{evaluationReportUrl:"",reportType:this.$route.query.type,reportInfo:{},reportTypeTool:1}},computed:{userInfo(){return this.$store.state.commonParams}},created(){i.Z.loading({duration:0,forbidClick:!0,message:this.$t("common.loading")});const{type:t,traineeId:e}=this.$route.query;"model"===t||"post_model"===t?e?this.getUserModelReport():this.getSelfModelReport():e?this.getUserToolReport():this.getSelfToolReport()},methods:{getSelfToolReport(){const{evaluationId:t}=this.$route.query;o.Z.getNewSelfToolReport({evaluationId:t}).then((t=>{if(i.Z.clear(),"tas"===t.data.data.code){this.reportTypeTool=2;const e=t.data.data.result;this.newReportData=(0,a.Z)({},e)}else"norm"===t.data.data.code&&(this.reportTypeTool=1,this.evaluationReportUrl=t.data.data.result)})).catch((()=>{i.Z.clear()}))},getUserToolReport(){const{evaluationId:t,traineeId:e}=this.$route.query;o.Z.getNewUserToolReport({userId:e,evaluationId:t}).then((t=>{if(i.Z.clear(),"tas"===t.data.data.code){this.reportTypeTool=2;const e=t.data.data.result;this.newReportData=(0,a.Z)({},e)}else"norm"===t.data.data.code&&(this.reportTypeTool=1,this.evaluationReportUrl=t.data.data.result)})).catch((()=>{i.Z.clear()}))},getSelfModelReport(){const{evaluationId:t}=this.$route.query;o.Z.getUserModelReport({userId:this.userInfo.userId,evaluationId:t}).then((t=>{this.reportInfo=t.data,i.Z.clear()})).catch((()=>{i.Z.clear()}))},getUserModelReport(){const{evaluationId:t,traineeId:e}=this.$route.query;o.Z.getUserModelReport({userId:e,evaluationId:t}).then((t=>{this.reportInfo=t.data,i.Z.clear()})).catch((()=>{i.Z.clear()}))}}},x=(0,p.Z)(Z,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"evaluation-report-container"},["tool"===t.reportType&&1===t.reportTypeTool?s("iframe",{style:{width:"100%",height:"100%"},attrs:{allowFullScreen:"",frameBorder:"0",src:t.evaluationReportUrl}}):t._e(),"tool"===t.reportType&&2===t.reportTypeTool?s("common-evaluation",{attrs:{"report-data":t.newReportData}}):s("div",{staticClass:"model-report"},[t.reportInfo.list?s("div",{staticClass:"radar-content"},[s("radar",{attrs:{"report-info":t.reportInfo}})],1):t._e(),t.reportInfo.list?s("div",{staticClass:"list-content"},[s("ability-score-list",{attrs:{"report-info":t.reportInfo}})],1):t._e()])],1)}),[],!1,null,"34978dee",null).exports},56659:(t,e,s)=>{s.r(e),s.d(e,{default:()=>h});s(34837);var a=s(39146),i=(s(25773),s(35791)),o=(s(86039),s(20495)),r=(s(82522),s(10342)),n=(s(82500),s(49414)),c=(s(20581),s(50914)),l=(s(57658),s(68593)),u=s(22648),d={name:"EvaluationDetail",components:{TaskInfo:s(39476).Z,[c.Z.name]:c.Z,[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z},filters:{formatDate:function(t){return(0,u.p6)(t,"yyyy-MM-dd  hh:mm")}},data:()=>({tabs:[],evaluationInfo:{},traineeList:[],loading:!1,finished:!1,params:{page_number:1,keyword:"",status:""},isNotStarted:!1,relation:{},isBathCompleted:!0,abilityTitle:""}),computed:{themeColor(){return this.$store.state.themeColor}},created(){this.tabs=[{name:this.$t("common.all"),status:""},{name:this.$t("common.unfinished"),status:"unfinished"},{name:this.$t("common.finished"),status:"finished"},{name:this.$t("common.overdue"),status:"overdue"}],this.relation={myself:this.$t("evaluation.startAssessment"),superior:this.$t("evaluation.superiorsAssess"),subordinate:this.$t("evaluation.subordinate"),sameLevel:this.$t("evaluation.sameLevel")},a.Z.loading({duration:0,forbidClick:!0,message:this.$t("common.loading")})},methods:{onLoad(){this.loading=!0,this.getTraineeList()},getTraineeList(){1===this.params.page_number&&(this.traineeList=[]);const t={evaluationId:this.$route.query.taskId,page_number:this.params.page_number,keyword:this.params.keyword,status:this.params.status};l.Z.getTraineeList(t).then((t=>{this.evaluationInfo=t.data;const{term_type:e,start_time:s,page_info:i,completed:o,title:r}=t.data,n=Date.now();this.isNotStarted="custom"===e&&n<s;const c=i?i.list:[];this.abilityTitle=r,this.traineeList=this.traineeList.concat(c),this.params.page_number+=1,this.isBathCompleted="true"===o,this.finished=!i.has_next_page,this.loading=!1,a.Z.clear()})).catch((()=>{this.loading=!1,this.finished=!0,a.Z.clear()}))},remindEvalution(){const t={evaluationId:this.$route.query.taskId};l.Z.remindEvalution(t).then((()=>{(0,a.Z)(this.$t("evaluation.pushForSuccess"))}))},handleOperate(t,e){this.isNotStarted?(0,a.Z)(this.$t("common.beginStudyNotStarted")):"overdue"!==e?"urge"!==e?"finished"===e?this.handleViewReport(t.user_id):this.handleStartTask(t.user_id,t.relation):this.remindEvalution():(0,a.Z)(this.$t("common.beginStudyOverdue"))},handleStartTask(t,e){this.$router.push({path:"/single-evaluation",query:{evaluationId:this.$route.query.taskId,traineeId:t,type:e,title:this.abilityTitle}})},handleViewReport(t){"false"!==this.evaluationInfo.open_result?this.$router.push({path:"/evaluation-report",query:{evaluationId:this.$route.query.taskId,type:"model",traineeId:t}}):(0,a.Z)(this.$t("evaluation.viewEvaluationReportTips"))},handleView(t){this.$router.push({path:"/evaluation-report",query:{evaluationId:this.$route.query.taskId,type:"model",traineeId:t.user_id}})},onSearch(){this.params.page_number=1,this.finished=!1,this.onLoad()},changeTab(t){this.params.status=t,this.params.page_number=1,this.finished=!1,this.onLoad()},gotoBathEvaluation(){if(!this.isBathCompleted)return!1;this.$router.push({path:"/bath-evaluation-questionnaire",query:{evaluationId:this.$route.query.taskId,title:this.abilityTitle}})}}},h=(0,s(1001).Z)(d,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tranining-detail"},[s("task-info",{attrs:{"evaluation-info":t.evaluationInfo,category:"superior"}}),s("div",{staticClass:"trainee-list-container"},[s("van-search",{attrs:{placeholder:t.$t("evaluation.searchUser")},on:{search:t.onSearch},model:{value:t.params.keyword,callback:function(e){t.$set(t.params,"keyword",e)},expression:"params.keyword"}}),s("van-tabs",{staticClass:"tabs",attrs:{sticky:"",color:t.themeColor.primaryColor},on:{click:t.changeTab},model:{value:t.params.status,callback:function(e){t.$set(t.params,"status",e)},expression:"params.status"}},t._l(t.tabs,(function(e){return s("van-tab",{key:e.status,attrs:{name:e.status,title:e.name}},[s("van-list",{attrs:{finished:t.finished,"finished-text":t.$t("common.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[s("div",{staticClass:"table-head"},[s("div",{staticClass:"item"},[t._v(t._s(t.$t("common.name")))]),s("div",{staticClass:"item"},[t._v(t._s(t.$t("evaluation.evaluationRelationship")))]),s("div",{staticClass:"item"},[t._v(t._s(t.$t("evaluation.taskState")))]),s("div",{staticClass:"time"},[t._v(t._s(t.$t("evaluation.updateTime")))]),s("div",{staticClass:"item"},[t._v(t._s(t.$t("evaluation.evaluationStatus"))+" ")])]),t._l(t.traineeList,(function(e){return s("div",{key:e.user_id,staticClass:"trainee-item"},[s("div",{staticClass:"table-body"},[s("div",{staticClass:"item"},[t._v(t._s(e.user_name))]),s("div",{staticClass:"item"},[t._v(t._s(t.relation[e.relation]))]),s("div",{staticClass:"item"},["overdue"===e.status?s("span",[t._v(t._s(t.$t("common.overdue")))]):"finished"===e.status?s("span",[t._v(t._s(t.$t("common.finished")))]):s("span",[t._v(t._s(t.$t("common.unfinished")))])]),s("div",{staticClass:"time"},[t._v(t._s(t._f("formatDate")(e.update_time)))]),"true"===e.evaluation_status?s("div",{staticClass:"item"},[t._v(t._s(t.$t("evaluation.assessed")))]):s("div",{staticClass:"item"},[t._v(t._s(t.$t("evaluation.noAssesse")))])]),s("div",{staticClass:"operate"},["superior"===e.relation&&"finished"!==e.status&&"overdue"!==e.status?s("div",{staticClass:"item"},[s("span",{style:{color:t.themeColor.primaryColor},on:{click:function(s){return t.handleView(e)}}},[t._v(" "+t._s(t.$t("micro.view"))+" ")])]):t._e(),s("div",{staticClass:"item"},["superior"===e.relation&&"finished"!==e.status&&"overdue"!==e.status&&"false"===e.other_completed?s("span",{style:{color:t.themeColor.primaryColor},on:{click:function(s){return t.handleOperate(e,"urge")}}},[t._v(" "+t._s(t.$t("evaluation.measurementUrge"))+" ")]):t._e(),"overdue"===e.status?s("span",{staticClass:"operate-disabled-button",style:{color:t.themeColor.primaryColor},on:{click:function(s){return t.handleOperate(e,"overdue")}}},[t._v(" "+t._s(t.$t("common.overdue"))+" ")]):t._e(),"finished"!==e.status&&"overdue"!==e.status&&("superior"===e.relation&&"false"!==e.other_completed&&"true"!==e.evaluation_status||"superior"!==e.relation&&"unfinished"===e.status&&"true"===e.permit)?s("span",{style:{color:t.themeColor.primaryColor},on:{click:function(s){return t.handleOperate(e,"unfinished")}}},[t._v(" "+t._s(t.$t("evaluation.startAssessment"))+" ")]):t._e(),"finished"!==e.status&&"overdue"!==e.status&&"true"===e.evaluation_status&&"finished"!==e.status?s("span",{staticClass:"operate-disabled-button",style:{color:t.themeColor.primaryColor}},[t._v(" "+t._s(t.$t("evaluation.waitingothersEvaluate"))+" ")]):t._e(),"finished"===e.status?s("span",{class:["false"===t.evaluationInfo.open_result?"operate-disabled-button":""],style:{color:t.themeColor.primaryColor},on:{click:function(s){return t.handleOperate(e,"finished")}}},[t._v(" "+t._s(t.$t("evaluation.evaluationReport"))+" ")]):t._e()])])])}))],2)],1)})),1),s("div",{staticClass:"bath-evaluation-button",on:{click:t.gotoBathEvaluation}},[s("van-button",{attrs:{color:t.themeColor.primaryColor,block:"",disabled:!t.isBathCompleted}},[t._v(t._s(t.$t("evaluation.bathEvaluation")))])],1)],1)],1)}),[],!1,null,"15002c06",null).exports},4516:(t,e,s)=>{s.r(e),s.d(e,{default:()=>c});var a=s(95082),i=(s(47601),s(44951)),o=(s(74916),s(15306),s(68593)),r=s(20125),n={name:"EvaluationTool",components:{[i.Z.name]:i.Z},beforeRouteEnter(t,e,s){s((t=>{t.fromPage=e.path,t.fromPageData=(0,a.Z)((0,a.Z)({},e.query),{},{isGo:1})}))},data:()=>({backLink:r,evaluationUrl:"",fromPage:"",fromPageData:""}),created(){this.getEvaluationUrl(),window.addEventListener("message",this.goBack,!1)},methods:{getEvaluationUrl(){const{evaluationId:t,evaluationUrl:e}=this.$route.query;e?this.evaluationUrl=e:o.Z.getEvaluationUrl({evaluationId:t}).then((t=>{this.evaluationUrl=t.data.auto_login_url}))},goBack(t){"goBack"===t.data&&"evaluation"===this.$route.query.sourceType&&this.$router.replace({path:"/evaluation-detail",query:{taskId:this.$route.query.taskId}})},linkToBack(){this.$store.commit("removeRouteStack",1),this.$router.replace({path:this.fromPage,query:this.fromPageData})}}},c=(0,s(1001).Z)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"evaluation-container"},[s("iframe",{style:{width:"100%",height:"100%"},attrs:{allowFullScreen:"",frameBorder:"0",src:t.evaluationUrl}}),s("div",{staticClass:"back-link",on:{click:t.linkToBack}},[s("van-image",{staticClass:"back-link-image",attrs:{src:t.backLink}})],1)])}),[],!1,null,"7a2eec1a",null).exports},55567:(t,e,s)=>{s.r(e),s.d(e,{default:()=>y});s(34837);var a=s(39146),i=s(95082),o=(s(31146),s(41610)),r=(s(25773),s(35791)),n=(s(49902),s(62094)),c=(s(21920),s(58280)),l=(s(91058),s(26294)),u=s(4852),d=s(68593),h=s(22648),p=s(41097),m={components:{[c.Z.name]:c.Z,[n.Z.name]:n.Z,LevelDescPanel:p.Z},props:{itemInfo:{type:Object,default:()=>{},required:!0},index:{type:Number,default:0},checkAnswer:{type:Array,default:()=>[]},errorTip:{type:Array,default:()=>[]}},data:()=>({userCheckAnswer:[],currentIndex:""}),computed:{themeColor(){return this.$store.state.themeColor.primaryColor},renderStyleClass(){return t=>{let e={name:"select-content",style:""};return t===this.currentIndex&&(e={name:"select-content active",style:`background:${(0,h.a7)(this.themeColor,.05)}`}),e}}},watch:{checkAnswer:{handler(t){this.userCheckAnswer=t},immediate:!0,deep:!0}},methods:{changeRadio(t){const{index:e}=this;this.userCheckAnswer[e].level_id=t,this.userCheckAnswer[e].id=this.itemInfo.ability_id,this.itemInfo.level_list.forEach(((e,s)=>{e.level_id===t&&(this.currentIndex=s)})),this.$emit("change",{userCheck:this.userCheckAnswer,index:e})}}},g=s(1001),v=(0,g.Z)(m,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t._l(t.itemInfo.level_list,(function(e,a){return s("div",{key:a.toString(),class:t.renderStyleClass(a).name,style:t.renderStyleClass(a).style,on:{click:function(s){return t.changeRadio(e.level_id)}}},[s("van-radio-group",{model:{value:t.userCheckAnswer[t.index].level_id,callback:function(e){t.$set(t.userCheckAnswer[t.index],"level_id",e)},expression:"userCheckAnswer[index].level_id"}},[s("van-radio",{attrs:{name:e.level_id}},[s("span",{staticClass:"level-title"},[t._v(t._s(e.level_title))])])],1),s("LevelDescPanel",{attrs:{desc:e.level_description,behavior:e.behavior_desc}})],1)})),t.errorTip[t.index]?s("div",{staticClass:"choose-tip"},[t._v(t._s(t.$t("evaluation.pleaseChoose")))]):t._e(),t.itemInfo.dimensional_result.length?s("div",{staticClass:"evaluation-result"},t._l(t.itemInfo.dimensional_result,(function(e,a){return s("div",{key:a,staticClass:"evaluation-result-item"},[s("span",{staticClass:"desc"},[t._v(t._s(e.dimension)+"：")]),s("strong",{staticClass:"result"},[t._v(t._s(e.result))])])})),0):t._e()],2)}),[],!1,null,"046aa44e",null).exports,f={components:{Avatar:u.Z,[c.Z.name]:c.Z,[n.Z.name]:n.Z,[r.Z.name]:r.Z,SingleQuestion:v},beforeRouteLeave(t,e,s){if(this.isEndSubmit)return s(),!1;if(this.checkAnswer.filter((t=>t.level_id)).length)return o.Z.confirm({message:this.$t("evaluation.exitTip"),closeOnPopstate:!1,cancelButtonText:this.$t("buttons.cancel"),confirmButtonText:this.$t("buttons.confirm")}).then((()=>{s()})).catch((()=>{s(!1),this.$dialog.close()})),!1;s()},data:()=>({assessmentQuestionnaire:{},questionsList:[],disabledSubmit:!0,answerType:"",radio:"",checkAnswer:[],errorTip:[],abilityIndex:0,isEndSubmit:!1}),computed:(0,i.Z)((0,i.Z)({},(0,l.mapGetters)({primaryColor:"getPrimaryColor",userInfo:"user/getUserInfo"})),{},{renderProgressClass:()=>t=>{let e="",s=parseInt(t,10);return e=100===s?"full":s>0&&s<100?"in-progress":"progress",e},renderProgress(){let t=this.checkAnswer.filter((t=>t.level_id)).length;return`${parseInt(""+t/this.checkAnswer.length*100,10)}%`},renderClass(){return t=>{let e="";return e=t===this.abilityIndex?`single-evaluation-item single-evaluation-item-${t} active`:`single-evaluation-item single-evaluation-item-${t}`,e}}}),created(){a.Z.loading({duration:0,forbidClick:!0,message:this.$t("common.loading")}),this.getOtherQuestionnaire()},mounted(){const{title:t}=this.$route.query;(0,h.Td)(t)},methods:{verify(t){if("submit"===t){this.errorTip=new Array(this.questionsList.length).fill(!1);let t="";for(let e=0;e<this.checkAnswer.length;e++)if(""===this.checkAnswer[e].level_id){t=e;break}return""!==t&&(this.errorTip=this.errorTip.map(((e,s)=>s===t||e))),t}this.errorTip=this.errorTip.map(((t,e)=>e!==this.abilityIndex&&t))},endFinish(){let t=this.verify("submit");if(""!==t){this.$toast(this.$t("evaluation.completeEvaluationTip"));return document.querySelector(`.single-evaluation-item-${t}`).scrollIntoView(),!1}const{evaluationId:e,type:s,traineeId:i}=this.$route.query;let o="";o="self"===s?this.userInfo.userId:i,d.Z.traineeSubmit({submitList:this.checkAnswer,evaluationId:e,assessed:o,type:s}).then((()=>{a.Z.success(this.$t("personnelDevelope.evaluationSuccess")),this.isEndSubmit=!0,setTimeout((()=>{this.$router.go(-1)}),2e3)})).catch((()=>{a.Z.fail(this.$t("evaluation.evaluationFail"))}))},changeCheckAnswer({userCheck:t,index:e}){this.checkAnswer=t,this.abilityIndex=e,this.$nextTick((()=>{this.verify("change")}))},getOtherQuestionnaire(){try{const{evaluationId:t,traineeId:e}=this.$route.query;this.answerType=e?"superior":"trainee";let s={evaluationId:t};s.userId=e||this.userInfo.userId,d.Z.getOtherQuestionnaire(s).then((t=>{const e=t.data;this.assessmentQuestionnaire=e,this.questionsList=e.list||[],this.checkAnswer=this.questionsList.map((()=>({level_id:"",id:""}))),this.errorTip=new Array(this.questionsList.length).fill(!1),a.Z.clear()})).catch((()=>{a.Z.clear()}))}catch(t){console.error(t,"eee")}}}},y=(0,g.Z)(f,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"single-evaluation-content"},[s("div",{staticClass:"single-evaluation-top"},[s("div",{staticClass:"avatar"},[s("Avatar",{attrs:{width:40,height:40,src:t.assessmentQuestionnaire.avatar}}),s("span",{staticClass:"name"},[t._v(t._s(t.assessmentQuestionnaire.user_name))])],1),t.questionsList.length?s("div",{class:t.renderProgressClass(t.renderProgress)},[t._v(t._s(t.renderProgress))]):t._e()]),s("div",{staticClass:"single-evaluation-select"},t._l(t.questionsList,(function(e,a){return s("div",{key:a.toString(),class:"single-evaluation-item single-evaluation-item-"+a},[s("div",{staticClass:"title"},[t._v(t._s(e.ability_title))]),s("div",{staticClass:"desc"},[t._v(t._s(e.ability_description))]),s("SingleQuestion",{attrs:{"item-info":e,index:a,"check-answer":t.checkAnswer,"error-tip":t.errorTip},on:{change:t.changeCheckAnswer}})],1)})),0),t.questionsList.length?s("div",{staticClass:"end-evaluation-btn",on:{click:t.endFinish}},[s("van-button",{attrs:{color:t.primaryColor,block:""}},[t._v(t._s(t.$t("evaluation.completeEvaluation")))])],1):t._e()])}),[],!1,null,"08869c3e",null).exports},39958:(t,e,s)=>{s.r(e),s.d(e,{default:()=>u});s(34837);var a=s(39146),i=s(95082),o=(s(47601),s(44951)),r=(s(74916),s(15306),s(1313)),n=s(26294),c=s(67992),l={name:"FaceRecognition",components:{VanImage:o.Z},props:{},data:()=>({operateStatus:"loading",showOperateTip:!1,examInfo:{examId:"",examType:""},studyId:"",sourceType:""}),computed:(0,i.Z)({},(0,n.mapState)("face",["url","result","successPath"])),mounted(){this.sourceType=this.$route.query.sourceType||""},methods:{save(){this.$toast.loading({duration:0,forbidClick:!0,message:"Loading"});const{sourceType:t}=this.$route.query;r.Z.faceSave({image_url:this.url.split("?")[0]}).then((e=>{"true"===e.data.result?(a.Z.clear(),this.$toast(this.$t("faceKnow.checkPass")),this.$store.commit("face/setFaceStatus","success"),t?this.handleFaceJump():setTimeout((()=>{"function"==typeof this.successPath?this.successPath():this.$router.go(-1)}),500)):(a.Z.clear(),this.$toast(this.$t("faceKnow.checkFailTip2")))}))},handleFaceJump(){const{userId:t}=this.$store.state.commonParams,{examId:e,submitId:s,studyId:a,sourceType:i}=this.$route.query;this.$router.replace({path:`/face-jump?status=success&sourceType=${i}&examId=${e}&submitId=${s}&studyId=${a}`});const o={resource_id:"exam"===i?e:a,user_id:t,source_type:i};r.Z.faceRecognition(o)},reCatchPhoto(){(0,c.RT)({hasSetFace:!1})},back(){(0,c.n)()}}},u=(0,s(1001).Z)(l,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"face-know-check"},[s("div",{staticClass:"result-img"},[s("VanImage",{attrs:{src:t.url}})],1),s("div",{class:["result-tip",t.result?"success":"error"]},[s("SvgIcon",{attrs:{"icon-class":t.result?"icon-done":"icon-fault",size:12}}),t._v(" "+t._s(t.result?t.$t("faceKnow.checkPassTip"):t.$t("faceKnow.checkFailTip2"))+" ")],1),t.result?s("div",{staticClass:"tip-text"},[s("div",{staticClass:"tip-text-title"},[t._v(t._s(t.$t("promptMessage.warmTips")))]),s("div",{staticClass:"tip-text-item no-circle"},[t._v(t._s(t.sourceType?t.$t("faceKnow.tipTextFace1"):t.$t("faceKnow.tipText1")))])]):s("div",{staticClass:"tip-text"},[s("div",{staticClass:"tip-text-title"},[t._v(t._s(t.$t("promptMessage.warmTips")))]),s("div",{staticClass:"tip-text-item"},[t._v(t._s(t.sourceType?t.$t("faceKnow.tipTextFace1"):t.$t("faceKnow.tipText1")))]),s("div",{staticClass:"tip-text-item"},[t._v(t._s(t.$t("faceKnow.tipText2")))]),s("div",{staticClass:"tip-text-item"},[t._v(t._s(t.$t("faceKnow.tipText3")))]),s("div",{staticClass:"tip-text-item"},[t._v(t._s(t.$t("faceKnow.faceKnowTip2")))]),s("div",{staticClass:"tip-text-item"},[t._v(t._s(t.$t("faceKnow.faceKnowTip3")))])]),t.result?s("div",{staticClass:"operate-btn"},[s("button",{staticClass:"reCatch",on:{click:t.reCatchPhoto}},[t._v(t._s(t.$t("faceKnow.reUploadFace")))]),s("button",{staticClass:"catch",on:{click:t.save}},[t._v(t._s(t.$t("faceKnow.confirmFace")))])]):s("div",{class:"operate-btn "+(t.sourceType?"face-btn":"")},[t.sourceType?t._e():s("button",{staticClass:"cancel",on:{click:t.back}},[t._v(t._s(t.$t("common.cancel")))]),s("button",{staticClass:"catch",on:{click:t.reCatchPhoto}},[t._v(t._s(t.$t("faceKnow.reUploadFace")))])])])}),[],!1,null,"53ab2183",null).exports},59549:(t,e,s)=>{s.r(e),s.d(e,{default:()=>p});var a=s(95082),i=(s(23307),s(81392)),o=(s(3791),s(93432)),r=(s(25773),s(35791)),n=(s(74916),s(15306),s(1313)),c=s(85566),l=s(67992),u=s(26294),d=s(27632),h={name:"Result",components:{[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z},data(){return{loading:!1,status:!1,isStudy:"study_project"===this.$route.query.sourceType||!1}},computed:(0,a.Z)({},(0,u.mapState)("face",["url","result"])),mounted(){const{status:t}=this.$route.query;this.status="success"===t},methods:{backHome(){d.Z.redirectTo({url:"/pages/common-webview/index?type=homeModule"})},handleDetail(){const{studyId:t}=this.$route.query;this.$router.replace({path:`/project-detail?studyId=${t}&from=faceJump`})},handleIdentify(){const{userId:t}=this.$store.state.commonParams,{examId:e,submitId:s,studyId:a,sourceType:i}=this.$route.query;(0,l.RT)({successPath:o=>{this.status=!0,"exam"===i&&s&&o&&c.Z.setFaceStatus({examId:e,userId:t,submitId:s,snapshotUrl:o,status:"success"});const r={resource_id:"exam"===i?e:a,user_id:t,source_type:i};n.Z.faceRecognition(r)},failRequest:a=>{this.status=!1,"exam"===i&&s&&a&&c.Z.setFaceStatus({examId:e,userId:t,submitId:s,snapshotUrl:a,status:"failed"})},hasSetFace:!0,showToast:!1})}}},p=(0,s(1001).Z)(h,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"face-know-result"},[s("van-loading",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}]}),s("div",{staticClass:"top-tip"},[t.status?s("van-icon",{attrs:{color:"#52C41A",size:"48px",name:"passed"}}):t._e(),t.status?t._e():s("van-icon",{attrs:{color:"#FA574B",size:"48px",name:"close"}}),s("div",{staticClass:"top-tip-title"},[t._v(t._s(t.status?t.$t("faceKnow.recognitionPassed"):t.$t("faceKnow.recognitionFailed")))]),s("div",{staticClass:"top-tip-sub"},[t._v(t._s(t.status?t.$t("faceKnow.recognitionPassedTip"):t.$t("faceKnow.recognitionFailedTip")))])],1),s("div",{staticClass:"start-btn"},[t.status&&t.isStudy?s("van-button",{staticClass:"btn primaryBtn",attrs:{type:"primary"},on:{click:t.handleDetail}},[t._v(t._s(t.$t("faceKnow.enterProject")))]):t._e(),t.status?t._e():s("van-button",{staticClass:"btn primaryBtn",attrs:{type:"primary"},on:{click:t.handleIdentify}},[t._v(t._s(t.$t("faceKnow.reCheck")))]),s("van-button",{staticClass:"btn",on:{click:t.backHome}},[t._v(t._s(t.$t("share.homeBack")))])],1)],1)}),[],!1,null,"b12d9d3e",null).exports},76589:(t,e,s)=>{s.r(e),s.d(e,{default:()=>m});var a=s(95082),i=(s(23307),s(81392)),o=(s(3791),s(93432)),r=(s(25773),s(35791)),n=(s(47601),s(44951)),c=(s(74916),s(15306),s(1313)),l=s(85566),u=s(67992),d=s(26294),h=s(27632),p={name:"Result",components:{VanImage:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z},data:()=>({loading:!1,sourceType:"",examId:"",submitId:"",studyId:"",isShowSave:!1,tipImg:"https://oss.coolcollege.cn/1823879276106223616.png",phoneImg:"https://oss.coolcollege.cn/1823879496894386176.png",lightImg:"https://oss.coolcollege.cn/1823879537864347648.png",faceImg:"https://oss.coolcollege.cn/1823879562325528576.png"}),computed:(0,a.Z)((0,a.Z)({},(0,d.mapState)("face",["url","result"])),{},{isValidate:()=>(0,u.i3)()}),mounted(){const{examId:t,submitId:e,studyId:s,sourceType:a}=this.$route.query;this.examId=t,this.submitId=e,this.studyId=s,this.sourceType=a,this.isValidate&&this.queryFace()},methods:{reCatchPhoto(){this.sourceType?(0,u.RT)({successPath:()=>{this.isShowSave=!0,this.$router.replace({path:`/face?sourceType=${this.sourceType}&examId=${this.examId}&submitId=${this.submitId}&studyId=${this.studyId}`})},failRequest:()=>{this.isShowSave=!1,this.$router.replace({path:`/face?sourceType=${this.sourceType}&examId=${this.examId}&submitId=${this.submitId}&studyId=${this.studyId}`})},hasSetFace:!1}):(0,u.RT)({successPath:()=>{this.isShowSave=!0},failRequest:()=>{this.isShowSave=!1},hasSetFace:!1})},handleSave(){this.$toast.loading({duration:0,forbidClick:!0,message:"Loading"}),c.Z.faceSave({image_url:this.url}).then((t=>{"true"===t.data.result?(this.$toast.clear(),this.$toast(this.$t("faceKnow.saveSuccess")),this.$store.commit("face/setFaceStatus","success")):(this.$toast.clear(),this.$toast(this.$t("faceKnow.saveFailed")))}))},queryFace(){this.loading=!0,c.Z.queryFace().then((t=>{console.warn(t,"res"),this.$store.commit("face/updateUrl",{url:t.data.face_image_url||"",result:"true"===t.data.result}),this.loading=!1})).catch((()=>{this.loading=!1}))},backHome(){h.Z.redirectTo({url:"/pages/common-webview/index?type=homeModule"})},handleIdentify(){const{userId:t}=this.$store.state.commonParams;(0,u.RT)({successPath:e=>{"exam"===this.sourceType&&this.submitId&&e&&l.Z.setFaceStatus({examId:this.examId,userId:t,submitId:this.submitId,snapshotUrl:e,status:"success"}),this.$router.replace({path:`/face-jump?status=success&sourceType=${this.sourceType}&examId=${this.examId}&submitId=${this.submitId}&studyId=${this.studyId}`});const s={resource_id:"exam"===this.sourceType?this.examId:this.studyId,user_id:t,source_type:this.sourceType};c.Z.faceRecognition(s)},failRequest:e=>{"exam"===this.sourceType&&this.submitId&&e&&l.Z.setFaceStatus({examId:this.examId,userId:t,submitId:this.submitId,snapshotUrl:e,status:"failed"}),this.$router.replace({path:`/face-jump?status=error&sourceType=${this.sourceType}&examId=${this.examId}&submitId=${this.submitId}&studyId=${this.studyId}`})},hasSetFace:!0,showToast:!1})}}},m=(0,s(1001).Z)(p,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"face-know-result"},[s("van-loading",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}]}),t.isValidate?s("div",[!t.url||t.sourceType?s("div",[s("div",{staticClass:"top-tip"},[t.sourceType&&t.url?[s("div",{staticClass:"top-tip-title"},[t._v(t._s(t.$t("faceKnow.openFaceTip")))])]:[s("div",{staticClass:"top-tip-title"},[t._v(t._s(t.$t("faceKnow.uploadFace")))]),s("div",{staticClass:"top-tip-sub"},[t._v(t._s(t.$t("faceKnow.uploadFaceTip")))])]],2),s("div",{staticClass:"tip-img"},[s("VanImage",{staticClass:"image-box",attrs:{src:t.tipImg}})],1),t.sourceType&&t.url?t._e():s("div",{staticClass:"tip-img-sub"},[s("div",{staticClass:"tip-img-sub-item"},[s("div",[s("VanImage",{staticClass:"phone",attrs:{src:t.phoneImg}})],1),s("div",{staticClass:"tip-img-sub-item-title"},[t._v(t._s(t.$t("faceKnow.facePhone")))])]),s("div",{staticClass:"tip-img-sub-item"},[s("div",[s("VanImage",{staticClass:"light",attrs:{src:t.lightImg}})],1),s("div",{staticClass:"tip-img-sub-item-title"},[t._v(t._s(t.$t("faceKnow.lightWeight")))])]),s("div",{staticClass:"tip-img-sub-item"},[s("div",[s("VanImage",{staticClass:"face",attrs:{src:t.faceImg}})],1),s("div",{staticClass:"tip-img-sub-item-title"},[t._v(t._s(t.$t("faceKnow.faceNoMask")))])])]),s("div",{staticClass:"tip-text"},[s("div",{staticClass:"tip-text-title"},[t._v(t._s(t.$t("promptMessage.warmTips")))]),t.sourceType&&t.url?t._e():s("div",{staticClass:"tip-text-item"},[t._v(t._s(t.sourceType?t.$t("faceKnow.tipTextFace1"):t.$t("faceKnow.tipText1")))]),t.sourceType&&t.url?t._e():s("div",{staticClass:"tip-text-item"},[t._v(t._s(t.$t("faceKnow.tipText2")))]),t.sourceType&&t.url?t._e():s("div",{staticClass:"tip-text-item"},[t._v(t._s(t.$t("faceKnow.tipText3")))]),s("div",{staticClass:"tip-text-item"},[t._v(t._s(t.$t("faceKnow.faceKnowTip2")))]),s("div",{staticClass:"tip-text-item"},[t._v(t._s(t.$t("faceKnow.faceKnowTip3")))])]),s("div",{class:"start-btn "+(t.sourceType?"flag-btn":"")},[t.sourceType&&t.url?[s("van-button",{staticClass:"back_home",on:{click:t.backHome}},[t._v(t._s(t.$t("share.homeBack")))]),s("van-button",{staticClass:"identify_btn primaryBtn",attrs:{type:"primary"},on:{click:t.handleIdentify}},[t._v(t._s(t.$t("faceKnow.gotoKnow")))])]:[s("van-button",{staticClass:"certification primaryBtn",attrs:{type:"primary"},on:{click:t.reCatchPhoto}},[t._v(t._s(t.$t("faceKnow.startUploadFace")))])]],2)]):s("div",[s("div",{staticClass:"result-img-box"},[s("VanImage",{staticClass:"result-img",attrs:{src:t.url}})],1),s("div",{staticClass:"result-tip"},[t._v(t._s(t.$t("faceKnow.hasFaceKnow")))]),s("div",{staticClass:"tip-text"},[s("div",{staticClass:"tip-text-title"},[t._v(t._s(t.$t("promptMessage.warmTips")))]),s("div",{staticClass:"tip-text-item no-circle"},[t._v(t._s(t.sourceType?t.$t("faceKnow.tipTextFace1"):t.$t("faceKnow.tipText1")))])]),s("div",{staticClass:"start-btn"},[s("van-button",{class:[t.isShowSave?"":"primaryBtn","certification"],attrs:{type:t.isShowSave?"":"primary"},on:{click:t.reCatchPhoto}},[t._v(t._s(t.$t("faceKnow.reUploadFace")))]),t.isShowSave?s("van-button",{staticClass:"certification primaryBtn",attrs:{type:"primary"},on:{click:t.handleSave}},[t._v(t._s(t.$t("faceKnow.confirmFace")))]):t._e()],1)])]):s("div",[s("div",{staticClass:"top-box-tip"},[s("van-icon",{attrs:{color:"#FA574B",size:"48px",name:"close"}}),s("div",{staticClass:"top-box-tip-title"},[t._v(t._s(t.$t("faceKnow.scanTip")))])],1)])],1)}),[],!1,null,"75c264e2",null).exports},76710:(t,e,s)=>{s.r(e),s.d(e,{default:()=>h});var a=s(95082),i=(s(57658),s(34246)),o=s(51527),r=s(85384),n=s(98512),c=s(27484),l=s.n(c),u=s(43195),d={name:"Find",components:{BottomTarbar:o.Z,"upgraded-version-overlay":r.Z},props:{scopeId:{type:[String,Number],default:0}},data:()=>({pageData:[],active:"discover",isRender:!0,isOverlay:!1}),watch:{$route(){this.isRender=!0,this.isOverlay=!0;const{pageId:t}=this.$route.query;t?this.queryScopeDetail():(this.queryMainData(),document.title="发现")}},mounted(){let t=(0,n.DP)();this.isOverlay=!0,t.notLogin&&(this.isRender=!1),t.pageId?this.queryScopeDetail():(this.queryMainData(),document.title="发现")},methods:{queryScopeDetail(){const t={id:(0,n.DP)().pageId,platformType:"enterprises",scopeId:this.$store.state.routeStack[0].query.scopeId};i.Z.getScopeDetail(t).then((t=>{if(2e5===t.data.code){const{componentList:e,id:s,pageTemplateContext:i}=t.data.data;if(this.isOverlay=!1,0===s)return;let o=[];(i?JSON.parse(i):{}).position.forEach((t=>{e.forEach((e=>{t===e.pagePosition&&o.push((0,a.Z)({app:u.Z[e.componentType],pageId:e.pageId,pagePosition:e.pagePosition},JSON.parse(e.feature)))}))})),this.pageData=o,this.$nextTick((()=>{this.$emit("closeLoading")}))}}))},queryMainData(){const t={scope:1,businessType:"mobile-find",scopeId:this.scopeId||this.$store.state.routeStack[0].query.scopeId,tiemtemp:l()().valueOf()};i.Z.getMainData(t).then((t=>{if(2e5===t.data.code){const{componentList:e,id:s,pageTemplateContext:i}=t.data.data;if(this.isOverlay=!1,0===s)return;let o=[];(i?JSON.parse(i):{}).position.forEach((t=>{e.forEach((e=>{t===e.pagePosition&&o.push((0,a.Z)({app:u.Z[e.componentType],pageId:e.pageId,pagePosition:e.pagePosition},JSON.parse(e.feature)))}))})),this.pageData=o,this.$nextTick((()=>{this.$emit("closeLoading")}))}}))}}},h=(0,s(1001).Z)(d,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},[s("div",{class:t.isRender?"":"disabled"},[t._l(t.pageData,(function(e){return s(e.app,{key:e.code,tag:"component",attrs:{models:e.models||{},params:e.params||{},"css-obj":e.cssObj||{},"is-render":t.isRender,"page-id":e.pageId,"page-position":e.pagePosition}})})),s("BottomTarbar",{attrs:{active:t.active}})],2),s("upgraded-version-overlay",{attrs:{show:t.isOverlay}})],1)}),[],!1,null,"3bcc4bfb",null).exports},3354:(t,e,s)=>{s.r(e),s.d(e,{default:()=>y});var a=s(95082),i=(s(20581),s(50914)),o=(s(53743),s(59978)),r=(s(629),s(67763)),n=(s(86039),s(20495)),c=(s(2707),s(57658),s(34246)),l=s(27361),u=s.n(l),d=s(8400),h=s.n(d),p=s(14884),m=s(78551),g=s(41996),v={name:"CourseList",components:{[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,SvgIcon:m.Z,Card:p.Z},data:()=>({finished:!1,canLoad:!1,error:!1,SORT_LIST:[{label:"默认",value:"default"},{label:"价格",value:"preferentialPrice",hasOrder:!0},{label:"浏览量",value:"scanCount",hasOrder:!0},{label:"销量",value:"purchaseVolume",hasOrder:!0}],sortData:{sortType:"default",order:""},searchValue:{title:"",flag:2,classifyId:"",post:""},pagination:{pageSize:10,pageNumber:0},total:0,loading:!1,keyword:"",dataSource:[],wholeList:[]}),mounted(){const{type:t,pageId:e,pagePosition:s,classKey:a,postKey:i}=this.$route.query;this.searchValue.classifyId="all"===a?"":a,this.searchValue.postKey="all"===i?"":i,"course"===t?this.getComponentDetail({pageId:e,pagePosition:s}):this.canLoad=!0},methods:{onLoad(){this.pagination.pageNumber+=1,this.getCourseList(this.getParams())},getParams(){const{scopeId:t}=this.$store.state.routeStack[0].query;return(0,a.Z)((0,a.Z)((0,a.Z)({scopeId:t},this.pagination),this.searchValue),{},{sortName:"default"===this.sortData.sortType?"":this.sortData.sortType,sortOrder:this.sortData.order})},mockFetch(t){let e=this.wholeList.filter((e=>e.title.indexOf(t.title)>=0||e.teacherName.indexOf(t.title)>=0));return"default"!==t.sortName&&(e="asc"===t.sortOrder?e.sort(((e,s)=>e[t.sortName]-s[t.sortName])):e.sort(((e,s)=>s[t.sortName]-e[t.sortName]))),{list:h()(e,this.pagination.pageSize)[this.pagination.pageNumber-1]||[],total:e.length}},getCourseList(t,e){this.loading=!0;const{type:s}=this.$route.query;if("course"===s){const{list:s=[],total:a}=this.mockFetch(t);return this.total=a,this.dataSource=e?s:this.dataSource.concat(s),this.loading=!1,this.finished=!1,void(this.dataSource.length>=this.total&&(this.finished=!0))}c.Z.getCourseList(t).then((t=>{const{list:s=[],total:a}=t.data;this.total=a,this.dataSource=e?s:this.dataSource.concat(s),this.loading=!1,this.finished=!1,this.dataSource.length>=this.total&&(this.finished=!0)})).catch((()=>{this.pageNum-=1,this.loading=!1,this.error=!0}))},batchQueryCourse(t){c.Z.batchQueryCourse({course_ids:t}).then((t=>{if(0===t.data.code){const e=u()(t.data.data,"courses",[]);this.wholeList=e,this.canLoad=!0}}))},getComponentDetail(t){c.Z.getComponentDetail(t).then((t=>{if(2e5===t.data.code){let e={models:{courseData:[]}};try{e=JSON.parse(t.data.data.feature)}catch(t){console.error(t)}const s=e.models.courseData.map((t=>({id:t.id,flag:t.flag})));this.batchQueryCourse(s)}}))},changeSort(t){const e={sortType:t.value,order:"asc"===this.sortData.order?"desc":"asc"};t.hasOrder||(e.order=""),this.sortData=e,this.pagination.pageNumber=1,this.getCourseList(this.getParams(),!0)},toDetail(t){(0,g.x)(t)},onSearch(){this.pagination.pageNumber=1,this.getCourseList(this.getParams(),!0)},hanldeLecturerClick(t){this.$router.push({path:`/find/lecturer-detail/${t}`})}}},f=v,y=(0,s(1001).Z)(f,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"course-box"},[s("van-search",{attrs:{placeholder:"请输入要搜索的课程名称"},on:{search:t.onSearch},model:{value:t.searchValue.title,callback:function(e){t.$set(t.searchValue,"title",e)},expression:"searchValue.title"}}),s("div",{staticClass:"sort_list"},t._l(t.SORT_LIST,(function(e){return s("div",{key:e.value,staticClass:"sort_list_item",style:t.sortData.sortType===e.value?{color:"#465DCD"}:{},on:{click:function(s){return t.changeSort(e)}}},[s("div",[t._v(t._s(e.label))]),e.hasOrder?s("div",{staticClass:"sort__icon"},[s("SvgIcon",{attrs:{color:e.value===t.sortData.sortType&&"asc"===t.sortData.order?"#465DCD":"#BFBFBF",size:7,"icon-class":"icon-sanjiao-copy"}}),s("SvgIcon",{attrs:{color:e.value===t.sortData.sortType&&"desc"===t.sortData.order?"#465DCD":"#BFBFBF",size:7,"icon-class":"icon-sanjiao"}})],1):t._e()])})),0),t.canLoad?s("van-list",{staticClass:"design-course-list",attrs:{finished:t.finished,error:t.error,"finished-text":"没有更多了","error-text":"请求失败，点击重新加载"},on:{"update:error":function(e){t.error=e},load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.dataSource,(function(e){return s("Card",{key:e.id,attrs:{data:e},on:{click:function(s){return t.toDetail(e)}}})})),1):t._e()],1)}),[],!1,null,"7dae2858",null).exports},3909:(t,e,s)=>{s.r(e),s.d(e,{default:()=>n});var a=s(34246),i=s(14884),o=s(41996),r={name:"Lecturer",components:{CourseCard:i.Z},data:()=>({detail:{}}),mounted(){a.Z.getLecturerDetail({id:this.$route.params.id}).then((t=>{0===t.data.code&&(this.detail=t.data.data||{})}))},methods:{toDetail(t){(0,o.x)(t)}}},n=(0,s(1001).Z)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"lecturerContentCard"},[s("div",{staticClass:"lecturerContentLeft",style:{backgroundImage:"url("+(t.detail.avatar||"https://oss.coolcollege.cn/1790708689137700864.png")+")"}}),s("div",{staticClass:"lecturerContentRight"},[s("div",{staticClass:"rightName"},[t._v(t._s(t.detail.name))]),s("div",{staticClass:"rightDescription"},[t._v(t._s(t.detail.simpleIntroduce))])])]),s("div",{staticClass:"course-list"},[s("div",{staticClass:"course-title"},[t._v("已授课程（"+t._s((t.detail.courses||[]).length)+"）")]),t.detail.courses&&0!==t.detail.courses.length?t._l(t.detail.courses||[],(function(e){return s("CourseCard",{key:e.id,attrs:{type:"medium",data:e},on:{click:function(s){return t.toDetail(e)}}})})):s("div",{staticClass:"course-placeholder"},[t._v("暂无已授课程")])],2)])}),[],!1,null,"0d2345d0",null).exports},81:(t,e,s)=>{s.r(e),s.d(e,{default:()=>n});s(20581);var a=s(50914),i=(s(86039),s(20495)),o=(s(57658),s(34246)),r={name:"Lecturer",components:{[i.Z.name]:i.Z,[a.Z.name]:a.Z},data:()=>({list:[],wholeList:[],loading:!1,finished:!1,pageType:"",total:0,pageNumber:1,pageSize:10,keyword:""}),mounted(){const{pagePosition:t,pageId:e}=this.$route.query;t&&e?(this.pageType="part",this.getLecturerBatchList(e,t)):(this.pageType="all",this.getLecturerList())},methods:{getLecturerBatchList(t,e){this.loading=!0,o.Z.getComponentDetail({pageId:t,pagePosition:e}).then((t=>{if(2e5===t.data.code){const e=JSON.parse(t.data.data.feature);o.Z.getLecturerListByIds({lecturer_ids:e.models.lecturerKeys}).then((t=>{if(0===t.data.code){const{teachers:e}=t.data.data;this.total=e.length,this.wholeList=e||[],this.loading=!1,this.total<=this.pageSize?(this.finished=!0,this.list=e||[]):(this.finished=!1,this.list=e.slice(0,this.pageSize))}}))}}))},getLecturerList(){this.loading=!0,o.Z.getLecturerListNoAuth({supplierId:this.$store.state.routeStack[0].query.scopeId,pageSize:this.pageSize,pageNumber:this.pageNumber,keyword:this.keyword}).then((t=>{this.list=this.list.concat(t.data.list||[]),this.total=t.data.total,this.loading=!1,this.list.length>=Number(this.total)&&(this.finished=!0)}))},onLoad(){"all"===this.pageType?(this.pageNumber++,this.getLecturerList()):"part"===this.pageType&&(this.pageNumber++,this.getNextPage())},getNextPage(){this.loading=!0,this.list=this.list.concat(this.wholeList.slice((this.pageNumber-1)*this.pageSize,Math.min(this.pageNumber*this.pageSize,this.total))),this.loading=!1,this.list.length>=this.total&&(this.finished=!0)},onSearch(){"part"===this.pageType?this.keyword?this.list=this.wholeList.filter((t=>-1!==t.name.indexOf(this.keyword))):this.list=this.wholeList:"all"===this.pageType&&(this.finished=!1,this.loading=!0,this.pageNumber=1,this.list=[],this.getLecturerList())},hanldeLecturerClick(t){this.$router.push({path:`/find/lecturer-detail/${t}`})}}},n=(0,s(1001).Z)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"lecturer"},[s("van-search",{attrs:{placeholder:"搜索"},on:{search:t.onSearch},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}),t.list.length>0?s("ul",{staticClass:"lecturerContent"},[s("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e){return s("li",{key:e.id,staticClass:"lecturerContentCard",on:{click:function(s){return t.hanldeLecturerClick(e.id)}}},[s("div",{staticClass:"lecturerContentLeft",style:{backgroundImage:"url("+(e.avatar||"https://oss.coolcollege.cn/1790708689137700864.png")+")"}}),s("div",{staticClass:"lecturerContentRight"},[s("div",{staticClass:"rightName"},[t._v(t._s(e.name))]),s("div",{staticClass:"rightDescription"},[t._v(t._s(e.simple_introduce))]),s("div",{staticClass:"rightCourse"},[t._v("已授课程 "+t._s(e.course_count||0))])])])})),0)],1):s("div",{staticClass:"nodata"},[s("img",{attrs:{src:"https://oss.coolcollege.cn/1789886518823882752.png"}}),s("div",[t._v("暂无讲师")])])],1)}),[],!1,null,"ca87b576",null).exports},48459:(t,e,s)=>{s.r(e),s.d(e,{default:()=>p});var a=s(95082),i=(s(23307),s(81392)),o=(s(39610),s(2163)),r=(s(74916),s(77601),s(57658),s(26294)),n=s(64508),c=s(22359),l=s(89492),u=s(41833),d=s(22648),h={name:"ClassifyCourse",components:{SearchBox:n.Z,CommonTitle:c.Z,CourseList:l.Z,PermissionClassify:u.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z},beforeRouteLeave(t,e,s){/(^\/course-reader.*)|(^\/image-text-detail.*)|(^\/project-detail.*)|(^\/course-.*-detail$)|(^\/micro-watch\/.*\/newest$)/.test(t.path)?this.$store.commit("isKeepAlive","ClassifyCourse"):this.$store.commit("noKeepAlive","ClassifyCourse"),s()},data(){return{column:2,liveList:[],maskVisible:!1,classifyData:{name:this.$route.query.classifyTitle||this.$t("course.allCourse"),id:this.$route.query.classifyId||""}}},computed:(0,a.Z)({classifyId(){const{classifyId:t}=this.$route.query;return t},sortType(){const{sortType:t}=this.$route.query;return t},showNewClassify(){let{enterpriseWhiteAndBlackList:t}=this.$store.state.setting;return!!t.KNOWLEDGE_NEW_CLASSIFY}},(0,r.mapGetters)({selectPortal:"setting/getSelectPortal",userInfo:"user/getUserInfo"})),activated(){this.$refs.scroll.scrollTop=this.$store.state.knowledge.listTop,this.$refs.scroll.addEventListener("scroll",this.recordScrollPosition)},deactivated(){this.$refs.scroll.removeEventListener("scroll",this.recordScrollPosition)},created(){let t=this.$route.params&&this.$route.params.knowledgeClassifyData||null;t?this.classifyData=t:localStorage.removeItem("knowledgeClassifyStorage"),(0,d.Td)(this.selectPortal.name||this.userInfo.enterpriseName)},methods:{toggleColumn(){this.column=1===this.column?2:1},onClassifySelect(t){this.classifyData={id:t.id||this.classifyId,name:t.name},this.$refs.scroll.scrollTop=0},handelMaskVisible(t){this.maskVisible=t},onSearch(t){this.$refs.courseModule.onSearch(t)},onClear(){this.$refs.courseModule.onClear()},recordScrollPosition(t){this.$store.commit("knowledge/setKnowLedgeListTop",t.target.scrollTop)},toClassifyPage(){let t=(0,a.Z)((0,a.Z)({},this.$route.query),{},{classifyFrom:this.$route.name});this.$router.push({path:"/knowledge/course-filter",query:t})}}},p=(0,s(1001).Z)(h,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"scroll",staticClass:"classify-course"},[s("van-sticky",[s("div",{staticClass:"sticky-content"},[s("search-box",{attrs:{placeholder:t.$t("discovery.searchPlaceholder")},on:{search:t.onSearch,clear:t.onClear}}),t.showNewClassify?s("div",{staticClass:"classify-btn",on:{click:t.toClassifyPage}},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-shaixuan",color:"#2D3040",size:16}})],1):t._e()],1),t.showNewClassify?t._e():s("permission-classify",{attrs:{"classify-id":t.classifyId},on:{select:t.onClassifySelect,visible:t.handelMaskVisible}})],1),s("div",{staticClass:"course-all-core",class:[t.maskVisible?"hidden":""]},[s("div",{staticClass:"course-list-wrapper"},[s("common-title",{attrs:{title:t.classifyData.name,"show-action-text":!1}},[s("span",{attrs:{slot:"right"},on:{click:t.toggleColumn},slot:"right"},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":2===t.column?"icon-liebiaoshitu":"icon-gonggeshitu",size:16,color:"#2D3040"}})],1)]),s("course-list",{ref:"courseModule",attrs:{column:t.column,"sort-type":t.sortType,"classify-id":t.classifyData.id}})],1)])],1)}),[],!1,null,"149d3f61",null).exports},41833:(t,e,s)=>{s.d(e,{Z:()=>d});var a=s(95082),i=(s(82500),s(49414)),o=(s(82522),s(10342)),r=(s(30541),s(26294)),n=s(50361),c=s.n(n),l=s(25295),u={name:"CourseClassify",components:{[o.Z.name]:o.Z,[i.Z.name]:i.Z},props:{classifyId:{type:String,default:""}},data:()=>({levelOneList:[],levelTwoList:[],levelThreeList:[[],[],[]],activeLevelOne:0,activeLevelTwo:0,activeLevelThree:[0,0,0],showThreeModal:!1,showTabs:!1}),computed:(0,a.Z)({},(0,r.mapGetters)({primaryColor:"getPrimaryColor"})),watch:{showThreeModal(t){this.$emit("visible",t)},activeLevelTwo(t,e){t!==e&&(this.levelThreeList=[[],[],[]],this.activeLevelThree=[0,0,0])}},mounted(){this.init()},methods:{async init(){const t=await l.Z.getPermissionClassify({parentId:this.classifyId,includeUnclassified:!0});this.showTabs=!0,this.levelOneList=this.handleAllCreate(t.data.list),this.$emit("loadEnd",!0)},async handleClickLevelOne(t){this.levelThreeList=[[],[],[]],this.levelTwoList=[],this.activeLevelTwo=0,this.activeLevelThree=[0,0,0];const e=this.levelOneList[t];if("all"===e.id)return void this.handleItemEmit(e);const s=await l.Z.getPermissionClassify({parentId:e.id,authType:"query"});this.handleItemEmit(e),this.levelTwoList=this.handleAllCreate(s.data.list)},async handleClickLevelTwo(t){this.activeLevelTwo=t;const e=this.levelTwoList[t];if("all"===e.id){const t=this.levelOneList[this.activeLevelOne];return this.activeLevelThree=[0,0,0],void this.handleItemEmit(t)}const s=await l.Z.getPermissionClassify({parentId:e.id,authType:"query"});if(this.showThreeModal=e.hasChildren,e.hasChildren){const t=this.handleAllCreate(s.data.list);this.$set(this.levelThreeList,0,t)}else this.activeLevelThree=[0,0,0],this.handleItemEmit(e)},async handleClickLevelSub(t,e,s){if(this.$set(this.activeLevelThree,t,s),"all"!==e.id){if(t<2)if(e.hasChildren){const s=await l.Z.getPermissionClassify({parentId:e.id,authType:"query"}),a=this.handleAllCreate(s.data.list);this.$set(this.levelThreeList,t+1,a)}else{const e=this.levelThreeList[t][s];this.handleItemEmit(e)}2===t&&this.handleItemEmit(e)}else{0===t&&(this.$set(this.levelThreeList,t+1,[]),this.$set(this.levelThreeList,t+2,[])),1===t&&this.$set(this.levelThreeList,t+1,[]);const e=t>0?this.levelThreeList[t-1][this.activeLevelThree[t-1]]:this.levelTwoList[this.activeLevelTwo];this.handleItemEmit(e)}},handleItemEmit(t){this.showThreeModal=!1;const e={name:"all"===t.id?this.$t("course.allCourse"):t.name,id:"all"===t.id?"":t.id};this.$emit("select",e)},handleAllCreate(t){const e=c()(t);return-1===e.findIndex((t=>"all"===t.id))&&e.unshift({name:this.$t("course.all"),id:"all"}),e}}},d=(0,s(1001).Z)(u,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.showTabs?s("div",{staticClass:"course-classify"},[s("div",{staticClass:"classify-tabs-one"},[s("van-tabs",{attrs:{"line-height":"0","line-width":"0",sticky:!0,"swipe-threshold":3},on:{click:t.handleClickLevelOne},model:{value:t.activeLevelOne,callback:function(e){t.activeLevelOne=e},expression:"activeLevelOne"}},t._l(t.levelOneList,(function(e,a){return s("van-tab",{key:e.id,attrs:{title:e.name,"title-class":t.activeLevelOne===a?"primary":"default"}})})),1)],1),t.levelTwoList.length>1?s("div",{staticClass:"classify-tabs-two"},[s("van-tabs",{attrs:{"line-height":"0","line-width":"0",sticky:!0},on:{click:t.handleClickLevelTwo},model:{value:t.activeLevelTwo,callback:function(e){t.activeLevelTwo=e},expression:"activeLevelTwo"}},t._l(t.levelTwoList,(function(e,a){return s("van-tab",{key:a,attrs:{"title-class":t.activeLevelTwo===a?"primary":"default"},scopedSlots:t._u([{key:"title",fn:function(){return[s("span",{staticClass:"tab-title"},[t._v(t._s(e.name))]),s("span",{class:[t.activeLevelTwo===a?"down":"",e.hasChildren?"triangle":"","tab-icon"]})]},proxy:!0}],null,!0)})})),1)],1):t._e(),t.showThreeModal?s("div",{staticClass:"classify-modal"},t._l(t.levelThreeList,(function(e,a){return s("div",{key:a,staticClass:"classify-column"},t._l(e,(function(e,i){return s("div",{key:i,staticClass:"column-item",class:[t.activeLevelThree[a]===i?"active":""],on:{click:function(s){return t.handleClickLevelSub(a,e,i)}}},[s("span",{staticClass:"item-name"},[t._v(t._s(e.name))]),t.activeLevelThree[a]===i?s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-duigou",color:t.primaryColor}}):t._e()],1)})),0)})),0):t._e(),t.showThreeModal?s("div",{staticClass:"classify-mask"}):t._e()]):t._e()}),[],!1,null,"c64c8574",null).exports},22359:(t,e,s)=>{s.d(e,{Z:()=>i});var a={name:"Commontitle",props:{title:{type:String,default:""},actionText:{type:String,default:""},showActionText:{type:Boolean,default:!0}},methods:{moreAction(){this.$emit("click")}}},i=(0,s(1001).Z)(a,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"common-title"},[s("span",{staticClass:"all van-ellipsis"},[t._v(t._s(t.title||""))]),t.showActionText?s("span",{staticClass:"more",on:{click:t.moreAction}},[t._v(t._s(t.actionText||t.$t("knowledge.more")))]):t._e(),t._t("right")],2)}),[],!1,null,"cb25f942",null).exports},89492:(t,e,s)=>{s.d(e,{Z:()=>p});var a=s(95082),i=(s(3791),s(93432)),o=(s(49153),s(5944)),r=(s(20581),s(50914)),n=s(50459),c=s(27479),l=s(25295),u=s(52196),d={name:"CourseSearch",components:{CourseList:n.Z,EmptyBox:c.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z},props:{emptyText:{type:String,default:""},pageSize:{type:Number,default:0},column:{type:Number,default:2},keyword:{type:String,default:""},isSearch:{type:Boolean,default:!1},classifyId:{type:String,default:""},sortType:{type:String,default:""}},data(){return{list:[],loading:!1,finished:!1,showEmpty:!0,fullLoading:!1,params:{pageNumber:1,pageSize:20,keyword:"",status:"studying",type:"normal",classifyId:this.classifyId,sortType:this.sortType}}},computed:{emptyDescription(){const{user:t}=this.$store.state;return this.isSearch?"":t.isAdmin?this.$t("setting.adminCourseNoData"):this.$t("common.noDataTip3")},linkSrc(){const{user:t}=this.$store.state;return this.isSearch?"":t.isAdmin?"https://opencoolvision.yuque.com/docs/share/b8a6f5b0-ac64-47a2-b541-00350110445a?#":""}},watch:{classifyId(t){this.params.classifyId=t,this.params.pageNumber=1,this.list=[],this.init()}},mounted(){this.isSearch||this.init()},beforeDestroy(){this.list=[],this.paramsClear(),this.$toast.clear()},methods:{async init(){this.pageSize&&(this.params.pageSize=this.pageSize);try{1===this.params.pageNumber&&(this.fullLoading=!0);const t=await l.Z.getCorpCourseLibrary(this.params);this.$emit("loadingClose");const{total:e,list:s,hasNextPage:a}=t.data;this.loading=!1,this.fullLoading=!1,this.finished=0===e||"false"===a,this.list=0===e?[]:this.list.concat(s),this.showEmpty=0===e}catch(t){this.loading=!1,this.fullLoading=!1}},onLoad(){this.pageSize?this.loading=!1:(this.params.pageNumber+=1,this.init())},paramsClear(){this.params=(0,a.Z)((0,a.Z)({},this.params),{},{keyword:"",pageSize:20,pageNumber:1})},onCourseClick(t){(0,u.f2)({courseData:t})},onSearch(t){this.params.keyword=t,this.params.pageNumber=1,this.list=[],this.$emit("afterSearch",!0),this.init()},onClear(){this.clear(),this.init()},clear(){this.paramsClear(),this.list=[]}}},h=d,p=(0,s(1001).Z)(h,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"course-module"},[t.fullLoading?s("van-loading",{staticClass:"course-loading-center"}):s("div",[t.list.length?s("div",{staticClass:"module-list"},[s("van-list",{attrs:{"immediate-check":!1,finished:t.finished,"finished-text":t.$t("common.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[s("course-list",{attrs:{column:t.column,source:t.list},on:{click:t.onCourseClick}})],1)],1):t._e(),t.showEmpty?s("div",{staticClass:"module-empty"},[s("EmptyBox",{attrs:{description:t.emptyText||t.$t("common.noDataTextTip"),"extra-text":t.emptyDescription,"link-src":t.linkSrc}})],1):t._e()])],1)}),[],!1,null,"7fbe001e",null).exports},25999:(t,e,s)=>{s.d(e,{Z:()=>o});var a=s(11651),i={name:"EmptyBox",props:{imgWidth:{type:String|Number,default:45},imgHeight:{type:String|Number,default:45},title:{type:String,default:""},imgSrc:{type:String,default:s(65859)}},data:()=>({}),computed:{width(){return"number"==typeof this.imgWidth?(0,a.W)(this.imgWidth):this.imgWidth},height(){return"number"==typeof this.imgHeight?(0,a.W)(this.imgHeight):this.imgHeight}}},o=(0,s(1001).Z)(i,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"module-empty"},[s("img",{staticClass:"empty-image",style:{width:t.width,height:t.height},attrs:{src:t.imgSrc,alt:""}}),s("span",{staticClass:"empty-text"},[t._v(" "+t._s(t.title||t.$t("common.noDataTextTip")))])])}),[],!1,null,"53499486",null).exports},70718:(t,e,s)=>{s.d(e,{Z:()=>i});s(73474);var a={name:"KnowledgeSkeleton",components:{VanPopup:s(74755).Z},data:function(){return{show:!0,active:"course"}},computed:{},mounted(){},methods:{closeSkeleton(){this.show&&(this.show=!1)}}},i=(0,s(1001).Z)(a,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("van-popup",{style:{height:"100%",overflowY:"hidden"},attrs:{duration:0,"close-on-click-overlay":!1},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[s("div",{staticClass:"skeleton-content"},[s("div",{staticClass:"skeleton-header"},[s("div",{staticClass:"skeleton-header-search"}),s("div",{staticClass:"skeleton-header-banner"})]),s("div",{staticClass:"image-row"},[s("div",{staticClass:"content-space"},[s("div",{staticClass:"content-left"}),s("div",{staticClass:"content-right"})]),s("div",{staticClass:"circle-row"},t._l(new Array(3).fill("test"),(function(t,e){return s("div",{key:e,staticClass:"item-body"},[s("div",{staticClass:"item-content"}),s("div",{staticClass:"item-footer"})])})),0)]),s("div",{staticClass:"image-row no-bottom-padding"},[s("div",{staticClass:"content-space padding-bottom"},[s("div",{staticClass:"content-left"}),s("div",{staticClass:"content-right"})]),t._l(new Array(2).fill("test"),(function(t,e){return s("div",{key:e,staticClass:"article-row"},[s("div",{staticClass:"article-row-img"}),s("div",{staticClass:"article-row-items"},[s("div",{staticClass:"article-row-title"}),s("div",{staticClass:"article-row-subtitle"})])])}))],2),s("div",{staticClass:"image-row no-bottom-padding margin-top"},[s("div",{staticClass:"content-space padding-bottom"},[s("div",{staticClass:"content-left"}),s("div",{staticClass:"content-right"})]),s("div",{staticClass:"article-row"},[s("div",{staticClass:"article-row-img"}),s("div",{staticClass:"article-row-items"},[s("div",{staticClass:"article-row-subtitle margin-bottom-12"}),s("div",{staticClass:"article-row-subtitle margin-bottom-12"}),s("div",{staticClass:"article-row-title"})])])])]),s("BottomTarbar",{attrs:{active:t.active}})],1)}),[],!1,null,"4dc9e943",null).exports},1650:(t,e,s)=>{s.d(e,{Z:()=>n});s(57658);var a=s(22359),i=s(94384),o=s(25999),r={name:"LiveLesson",components:{CommonTitle:a.Z,LiveItem:i.Z,EmptyBox:o.Z},props:{source:{type:Array,default:()=>[]},showMore:{type:Boolean,default:!1}},data:()=>({}),computed:{title(){return this.$store.state.commonParams.isDingCompany?this.$t("ddLive.liveCourse"):this.$t("ddLive.live")}},methods:{linkToMore(){this.$router.push("/live-course")}}},n=(0,s(1001).Z)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"live-lesson"},[s("common-title",{attrs:{title:t.title,"show-action-text":t.showMore},on:{click:t.linkToMore}}),t.source.length>0?s("div",{staticClass:"lesson-list"},t._l(t.source,(function(t,e){return s("live-item",{key:e,attrs:{item:t,"style-object":{paddingLeft:0,paddingRight:0}}})})),1):s("empty-box")],1)}),[],!1,null,"13596948",null).exports},92959:(t,e,s)=>{s.r(e),s.d(e,{default:()=>C});var a=s(95082),i=(s(23307),s(81392)),o=(s(39610),s(2163)),r=(s(74916),s(77601),s(57658),s(64508)),n=s(22359),c=s(89492),l=s(41833),u=s(70718),d=s(25295),h=s(1650),p=s(26294),m=s(25763),g=s(68092),v=s(27632),f=s(17780),y=s(22648),_={name:"CourseAll",components:{SearchBox:r.Z,CommonTitle:n.Z,CourseList:c.Z,PermissionClassify:l.Z,LiveLesson:h.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,KnowledgeSkeleton:u.Z,CustomBanner:m.Z},beforeRouteLeave(t,e,s){/(^\/course-reader.*)|(^\/image-text-detail.*)|(^\/project-detail.*)|(^\/course-.*-detail$)|(^\/micro-watch\/.*\/newest$)/.test(t.path)?this.$store.commit("isKeepAlive","CourseAll"):this.$store.commit("noKeepAlive","CourseAll"),s()},data(){return{column:2,liveList:[],liveParams:{pageNum:1,pageSize:2,classifyId:""},maskVisible:!1,classifyData:{name:this.$t("course.allCourse"),id:""},active:"course",isMicroApp:(0,f.xX)(),isFxktFlag:(0,g.UI)("FXKT_WHITE_FLAG")}},computed:(0,a.Z)((0,a.Z)({createProjectVisible(){const{isCorpCreator:t,isAdmin:e}=this.$store.state.user;return"dingTalk"===v.Z.env&&(t||e)},showTabBar(){return"/course-all"!==this.$route.path},classifyId(){const{classifyId:t}=this.$route.query;return t}},(0,p.mapGetters)({qyShield:"setting/getQySwitch",pageFrom:"getPageFrom",selectPortal:"setting/getSelectPortal",userInfo:"user/getUserInfo"})),{},{showNewClassify(){let{enterpriseWhiteAndBlackList:t}=this.$store.state.setting;return!!t.KNOWLEDGE_NEW_CLASSIFY}}),watch:{"classifyData.id"(t){this.liveParams.classifyId=t,this.getLiveList()}},created(){let t=this.$route.params&&this.$route.params.knowledgeClassifyData||null;t?this.classifyData=t:localStorage.removeItem("knowledgeClassifyStorage"),(0,y.Td)(this.selectPortal.name||this.userInfo.enterpriseName)},mounted(){this.getLiveList()},activated(){this.$refs.scroll.scrollTop=this.$store.state.knowledge.listTop,this.$refs.scroll.addEventListener("scroll",this.recordScrollPosition)},deactivated(){this.$refs.scroll.removeEventListener("scroll",this.recordScrollPosition)},methods:{courseListLoadingClose(){this.$refs.knowledgeSkeleton&&this.$refs.knowledgeSkeleton.closeSkeleton()},onSearchClick(){this.$router.push("/course-search")},toggleColumn(){this.column=1===this.column?2:1},async getLiveList(){const{data:t}=await d.Z.getLiveList(this.liveParams);t.data&&(this.liveList=t.data.list)},onClassifySelect(t){this.classifyData=t,this.$refs.scroll.scrollTop=0},handelMaskVisible(t){this.maskVisible=t},linkToCreateProject(){v.Z.navigateTo({url:"/pages/courseModules/create-project/add-project/index"})},recordScrollPosition(t){this.$store.commit("knowledge/setKnowLedgeListTop",t.target.scrollTop)},toClassifyPage(){let t=(0,a.Z)((0,a.Z)({},this.$route.query),{},{classifyFrom:this.$route.name});this.$router.push({path:"/knowledge/course-filter",query:t})}}},C=(0,s(1001).Z)(_,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"scroll",staticClass:"course-all"},[s("van-sticky",[s("div",{staticClass:"sticky-content"},[s("search-box",{attrs:{placeholder:t.$t("discovery.searchPlaceholder"),disabled:!0},on:{click:t.onSearchClick}}),t.showNewClassify?s("div",{staticClass:"classify-btn",on:{click:t.toClassifyPage}},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-shaixuan",color:"#2D3040",size:16}})],1):t._e()],1),t.showNewClassify?t._e():s("permission-classify",{attrs:{"classify-id":t.classifyId},on:{select:t.onClassifySelect,visible:t.handelMaskVisible}})],1),s("div",{staticClass:"course-all-core",class:[t.maskVisible?"hidden":""]},[t.isFxktFlag?s("custom-banner",{ref:"fxktRef"}):t._e(),"false"===t.qyShield&&t.liveList.length>0?s("div",{staticClass:"course-all-module"},[s("live-lesson",{attrs:{source:t.liveList,"show-more":!0}})],1):t._e(),s("div",{ref:"courseList",staticClass:"course-list-wrapper"},[s("common-title",{attrs:{title:t.classifyData.name,"show-action-text":!1}},[s("span",{attrs:{slot:"right"},on:{click:t.toggleColumn},slot:"right"},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":2===t.column?"icon-liebiaoshitu":"icon-gonggeshitu",size:16,color:"#2D3040"}})],1)]),s("course-list",{ref:"courseModule",attrs:{column:t.column,"classify-id":t.classifyData.id},on:{loadingClose:t.courseListLoadingClose}})],1)],1),t.createProjectVisible&&!t.isMicroApp?s("div",{staticClass:"create-project",on:{click:t.linkToCreateProject}},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-rukoutubiao1",size:24,color:"#FFF"}})],1):t._e(),t.showTabBar?s("BottomTarbar",{attrs:{active:t.active}}):t._e(),t.isMicroApp?t._e():s("KnowledgeSkeleton",{ref:"knowledgeSkeleton"})],1)}),[],!1,null,"3674a1ee",null).exports},17002:(t,e,s)=>{s.r(e),s.d(e,{default:()=>c});s(3791);var a=s(93432),i=(s(23307),s(81392)),o=(s(38862),s(57658),s(25295)),r=s(22648),n={components:{[i.Z.name]:i.Z,[a.Z.name]:a.Z},data:()=>({loadingFinish:!1,classifyData:[],currentActiveClassify:{},storageData:{},loading:!0}),created(){this.returnBackUrlMap={Knowledge:{path:"/knowledge",name:"Knowledge"},CourseAll:{name:"CourseAll",path:"/course-all"},ClassifyCourse:{name:"ClassifyCourse",path:"/classify-course"}}},mounted(){o.Z.getCorpClassify({parent_id:0}).then((t=>{const{classify:e}=t.data;this.classifyData=e;let s=this.getStorageData();this.currentActiveClassify=this.classifyData.find((t=>t.id===s.dataLevel1.id))||this.classifyData[0],(0,r.Td)(this.currentActiveClassify.name),this.$nextTick((()=>{this.loadingFinish=!0}))}))},methods:{setStorageData(t,e){let s={dataLevel1:{id:this.currentActiveClassify.id,name:this.currentActiveClassify.name}},a=t?{id:t.id,name:t.name}:null,i=e?{id:e.id,name:e.name}:null;a&&(s.dataLevel2=a),i&&(s.dataLevel3=i),localStorage.setItem("knowledgeClassifyStorage",JSON.stringify(s))},getStorageData(){let t=localStorage.getItem("knowledgeClassifyStorage")||"{}";if(t)try{t=JSON.parse(t)}catch(e){t={}}let{dataLevel1:e,dataLevel2:s,dataLevel3:a}=t;return this.storageData={dataLevel1:e||{},dataLevel2:s||{},dataLevel3:a||{}},this.storageData},handleClassifySelect(t,e,s){let{query:a}=this.$route,{classifyFrom:i}=a;delete a.classifyFrom,this.setStorageData(t,e);let o=null;1===s?o={id:this.currentActiveClassify.id,name:this.currentActiveClassify.name}:2===s?o={id:t.id,name:t.name}:3===s&&(o={id:e.id,name:e.name});let r=o?{knowledgeClassifyData:o}:{};this.$router.push({name:this.returnBackUrlMap[i]?this.returnBackUrlMap[i].name:"",query:a,params:r})},handleClassifyClick(t){this.$refs["section-right"].scrollTop=0,this.currentActiveClassify=t,(0,r.Td)(this.currentActiveClassify.name||"")},handleSelectAll(){this.handleClassifySelect(null,null,1)},handleClassifyItemClick(t,e,s){this.handleClassifySelect(t,e,s)}}},c=(0,s(1001).Z)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"knowledge-course-filter"},[s("div",{staticClass:"section-left"},t._l(t.classifyData,(function(e){return s("div",{key:e.id,staticClass:"classify-item",class:{active:e.id===t.currentActiveClassify.id},on:{click:function(s){return t.handleClassifyClick(e)}}},[t._v(t._s(e.name))])})),0),s("div",{ref:"section-right",staticClass:"section-right"},[t.loadingFinish?s("div",{staticClass:"classify-label",on:{click:t.handleSelectAll}},[s("span",{staticClass:"label-text"},[t._v(t._s(t.$t("course.allCourse")))]),s("span",{staticClass:"children-btn"},[s("van-icon",{attrs:{name:"arrow"}})],1)]):t._e(),t._l(t.currentActiveClassify.children,(function(e){return s("div",{key:e.id,staticClass:"classify-box"},[s("div",{staticClass:"classify-label",on:{click:function(s){return t.handleClassifyItemClick(e,null,2)}}},[s("span",{staticClass:"label-text"},[t._v(t._s(e.name))]),s("span",{staticClass:"children-btn"},[s("van-icon",{attrs:{name:"arrow"}})],1)]),e.children&&e.children.length>0?s("div",{staticClass:"classify-item"},t._l(e.children,(function(a){return s("span",{key:a.id,staticClass:"item-text",class:{active:t.storageData&&t.storageData.dataLevel3&&t.storageData.dataLevel3.id===a.id},on:{click:function(s){return t.handleClassifyItemClick(e,a,3)}}},[t._v(t._s(a.name))])})),0):t._e()])}))],2),t.loadingFinish?t._e():s("van-loading",{staticClass:"knowledge-classify-loading",attrs:{type:"spinner",size:"24"}})],1)}),[],!1,null,"6b41af66",null).exports},46571:(t,e,s)=>{s.r(e),s.d(e,{default:()=>n});s(39610);var a=s(2163),i=s(64508),o=s(89492),r={name:"CourseSearch",components:{SearchBox:i.Z,CourseList:o.Z,[a.Z.name]:a.Z},beforeRouteLeave(t,e,s){"/knowledge"!==t.path&&"/course-all"!==t.path||this.$store.commit("noKeepAlive","CourseSearch"),s()},data:()=>({keyword:"",isAfterSearch:!1}),computed:{emptyText(){return this.isAfterSearch?this.$t("common.noDataTextTip"):this.$t("course.searchTips")}},beforeDestroy(){this.isAfterSearch=!1},mounted(){this.initSearch()},methods:{initSearch(){const{keyword:t}=this.$route.query;t&&this.onSearch(t)},onSearch(t){this.keyword=t,this.$refs.courseRef.onSearch(t)},onClear(){this.$refs.courseRef.onClear()},afterSearch(t){this.isAfterSearch=t}}},n=(0,s(1001).Z)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"course-search"},[s("van-sticky",[s("search-box",{attrs:{placeholder:t.$t("discovery.searchPlaceholder")},on:{search:t.onSearch,clear:t.onClear}})],1),s("div",{staticClass:"search-content"},[s("course-list",{ref:"courseRef",attrs:{"empty-text":t.emptyText,keyword:t.keyword,"is-search":!0},on:{afterSearch:t.afterSearch}})],1)],1)}),[],!1,null,"f479da3c",null).exports},25763:(t,e,s)=>{s.d(e,{Z:()=>d});var a=s(95082),i=(s(47601),s(44951)),o=(s(72975),s(98655)),r=(s(11155),s(91391)),n=s(26294),c=s(23111),l=s(82291),u={name:"Banner",components:{Swipe:r.Z,SwipeItem:o.Z,VanImage:i.Z},data:function(){return{ASSETS_OSS_HOST,banners:[{url:`${ASSETS_OSS_HOST}/1826443516654522368.jpg`}],auth:""}},computed:(0,a.Z)((0,a.Z)({},(0,n.mapGetters)({homeBannerColor:"setting/getHomeBannerColor"})),{},{bannerBackColor(){const t=this.$store.state.setting.homeBannerColor;return(0,c.y)(t)}}),watch:{},mounted(){this.getAuthData()},methods:{async getAuthData(){this.auth=this.$store.state.knowledge.auth||await l.V.getAuthData()},handleToBannerDetail(){l.V.toPointCoursePage({type:"list",auth:this.auth,id:""})}}},d=(0,s(1001).Z)(u,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"customer-banner"},[s("div",{staticClass:"banner-swipe"},[s("Swipe",{attrs:{autoplay:3e3,"indicator-color":"white"}},t._l(t.banners,(function(e,a){return s("SwipeItem",{key:a.toString()},[s("VanImage",{staticClass:"banner-image",attrs:{src:e.url},on:{click:function(s){return t.handleToBannerDetail(e)}}})],1)})),1)],1)])}),[],!1,null,"1fc09d8a",null).exports},38995:(t,e,s)=>{s.r(e),s.d(e,{default:()=>i});var a={name:"CustomCourse",data(){return{iframeUrl:decodeURIComponent(this.$route.query.iframeUrl)}},mounted(){}},i=(0,s(1001).Z)(a,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"common-iframe-container"},[s("iframe",{ref:"iframeRef",style:{width:"100%",height:"100%"},attrs:{allowFullScreen:"",frameBorder:"0",src:t.iframeUrl}})])}),[],!1,null,"bfd01b36",null).exports},86543:(t,e,s)=>{s.r(e),s.d(e,{default:()=>p});var a=s(95082),i=(s(49153),s(5944)),o=(s(20581),s(50914)),r=(s(57658),s(26294)),n=s(25295),c=s(23493),l=s.n(c),u=s(22648),d={name:"HotPointsList",components:{[o.Z.name]:o.Z,[i.Z.name]:i.Z},data:()=>({list:[],loading:!1,finished:!1,showEmpty:!1,params:{pageNumber:1,pageSize:5,resourceId:""},currentIndex:0,currentItem:{resource:{url:""}}}),computed:(0,a.Z)((0,a.Z)({},(0,r.mapState)("setting",["speedPlaySwitch"])),{},{autoplay:()=>"ios"!==(0,u.Os)()}),mounted(){this.$refs.hotRef&&this.$refs.hotRef.addEventListener("scroll",this.handleScroll,!0),this.init()},beforeDestroy(){this.$toast.clear(),this.loading=!1,this.$refs.hotRef&&this.$refs.hotRef.removeEventListener("scroll",this.handleScroll,!0)},methods:{async init(){const{resourceId:t,segmentationId:e}=this.$route.query;t&&(this.params.resourceId=t),e&&(this.params.segmentationId=e),1===this.params.pageNumber&&this.showLoading();const s=await n.Z.getKnowledgeList(this.params),{total:a,list:i,hasNextPage:o}=s.data;this.$toast.clear(),this.loading=!1,this.finished=0===a||"false"===o,this.list=0===a?[]:this.list.concat(i),this.currentItem=this.list[0],this.showEmpty=0===a},showLoading(){this.$toast.loading({duration:0,forbidClick:!0,message:this.$t("common.loading")})},goToCourse(t){this.$router.push({path:"/course-enterprise-detail",query:{courseResource:"enterprise",courseId:t.id,originType:"corpCourse"}})},onLoad(){this.params.pageNumber+=1,this.init()},handleScroll(){l()((()=>{const{scrollTop:t}=this.$refs.hotRef,e=document.querySelector(".card");if(e){const s=e.clientHeight,a=Math.ceil(t/s);this.playVideo(a)}}),500)()},playVideo(t){this.currentIndex=t,this.currentItem=this.list[t];const e=this.$refs.video;if(e&&e.getPlayer){const t=e.getPlayer();setTimeout((()=>{t.play()}),200)}}}},h=d,p=(0,s(1001).Z)(h,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"hotRef",staticClass:"hot-points-list"},[s("div",{staticClass:"hot-points-list-content"},[t.list.length?s("div",{staticClass:"list"},[s("van-list",{attrs:{"immediate-check":!1,finished:t.finished,"finished-text":t.$t("common.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e,a){return s("div",{key:a,staticClass:"card"},[s("div",{staticClass:"card-title"},[t._v(t._s(e.title))]),s("div",{staticClass:"card-player",on:{click:function(e){return t.playVideo(a)}}},[s("img",{staticClass:"player-img",attrs:{src:e.coverUrl,alt:""}}),a===t.currentIndex?s("cool-video",{ref:"video",refInFor:!0,staticClass:"card-video",attrs:{"player-id":"card-video"+a,src:t.currentItem.resource.url,autoplay:t.autoplay,controls:!0,"show-fullscreen-btn":!0,"show-speed-button":t.speedPlaySwitch,height:"100%"}}):t._e()],1),s("div",{staticClass:"card-infos"},[s("div",{staticClass:"tags"},t._l(e.tags,(function(e,a){return s("span",{key:a,staticClass:"tags-item"},[t._v(" "+t._s(e)+" ")])})),0),e.bizCourse&&e.bizCourse.title?s("div",{staticClass:"origin",on:{click:function(s){return t.goToCourse(e.bizCourse)}}},[s("div",{staticClass:"origin-text"},[t._v(t._s(t.$t("course.originCourse"))+": "),s("span",{staticClass:"text"},[t._v(t._s(e.bizCourse.title))])])]):t._e()])])})),0)],1):t._e(),t.showEmpty?s("div",{staticClass:"content-empty"},[s("van-empty",{attrs:{description:t.$t("common.noDataTextTip")}})],1):t._e()])])}),[],!1,null,"21dd2cc1",null).exports},4888:(t,e,s)=>{s.r(e),s.d(e,{default:()=>k});var a=s(95082),i=(s(74916),s(77601),s(26294)),o=(s(39610),s(2163)),r=(s(57658),s(64508)),n=s(22359),c=s(25295),l={name:"HotPoints",components:{CommonTitle:n.Z},props:{source:{type:Array,default:()=>[]}},methods:{linkMore(t){let e={};t&&(e={resourceId:t.resource.id,segmentationId:t.segmentationId}),this.$router.push({path:"/hot-points",query:e})}}},u=s(1001),d=(0,u.Z)(l,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"hot-points"},[s("common-title",{staticClass:"hot-points-title",attrs:{title:t.$t("pageTitle.hotPoints")},on:{click:t.linkMore}}),s("div",{staticClass:"hot-points-content"},t._l(t.source,(function(e,a){return s("div",{key:a,staticClass:"hot-points-item",on:{click:function(s){return t.linkMore(e)}}},[s("div",{staticClass:"item-img"},[s("img",{attrs:{src:e.coverUrl,alt:""}})]),s("span",{staticClass:"item-name"},[t._v(t._s(e.title))])])})),0)],1)}),[],!1,null,"0d047198",null).exports,h=s(89492),p=s(70718),m=s(27632),g=s(22648),v=s(25999),f={name:"MarketingMaterial",components:{CommonTitle:n.Z,EmptyBox:v.Z},filters:{formatDate:function(t){return(0,g.p6)(t,"yyyy-MM-dd")}},props:{source:{type:Array,default:()=>[]}},data:()=>({}),computed:{userInfo(){return this.$store.state.commonParams}},methods:{linkToMarketingMaterial(){if("dingTalk"===m.Z.env){const t=`${MARKETING_H5}?r=${Math.floor(1e4*Math.random())}#/materials?access_token=${this.$store.state.commonParams.access_token}`;m.Z.openLink({url:t})}else m.Z.navigateTo({url:"/pages/marketing/list/index"})},goToArticle(t){const{enterpriseId:e,userId:s,accessToken:a}=this.userInfo,i=`/pages/marketing/detail/index?enterprise_id=${e}&source_knowledge_id=${t.source_knowledge_id}&user_id=${s}`;if("dingTalk"===m.Z.env){const i=`${SHARE_H5}?r=${Math.floor(1e4*Math.random())}#/article?enterprise_id=${e}&source_knowledge_id=${t.source_knowledge_id}&user_id=${s}&access_token=${a}`;m.Z.openLink({url:i})}else m.Z.navigateTo({url:i})}}},y=(0,u.Z)(f,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"marketing-material"},[s("common-title",{attrs:{title:t.$t("marketing.marketingMaterial")},on:{click:t.linkToMarketingMaterial}}),0===t.source.length?s("empty-box"):t._e(),t.source.length>0?s("div",{staticClass:"marketing-list"},t._l(t.source,(function(e,a){return s("div",{key:a,staticClass:"marketing-item",on:{click:function(s){return t.goToArticle(e)}}},[s("div",{staticClass:"item-img"},[s("img",{attrs:{src:e.cover,alt:""}})]),s("div",{staticClass:"item-desc"},[s("div",{staticClass:"title"},[t._v(t._s(e.title))]),s("div",{staticClass:"desc-bottom"},[s("div",{staticClass:"bottom-static"},[s("span",{staticClass:"static-one"},[t._v(t._s(t.$t("marketing.shareNumber"))+":"+t._s(e.shareCount||0))]),s("span",{staticClass:"static-two"},[t._v(t._s(t.$t("marketing.seeNumber"))+": "+t._s(e.viewCount||0)+" ")])]),s("div",{staticClass:"bottom-time"},[t._v(" "+t._s(t._f("formatDate")(1*e.lastConfigTime))+" ")])])])])})),0):t._e()],1)}),[],!1,null,"958f3ae6",null).exports,_=s(1650),C=s(17780),I=s(25763),b=s(68092),w={name:"Knowledge",components:{SearchBox:r.Z,CommonTitle:n.Z,HotPoints:d,CourseList:h.Z,MarketingMaterial:y,LiveLesson:_.Z,[o.Z.name]:o.Z,KnowledgeSkeleton:p.Z,CustomBanner:I.Z},data:()=>({knowledgeList:[],knowledgePage:{pageNumber:1,pageSize:5,resourceId:""},shareList:[],sharePage:{pageNum:1,pageSize:2},liveList:[],active:"course",isMicroApp:(0,C.xX)(),isFxktFlag:(0,b.UI)("FXKT_WHITE_FLAG")}),computed:(0,a.Z)({},(0,i.mapGetters)({qyShield:"setting/getQySwitch"})),mounted(){this.init()},activated(){this.$refs.scroll.scrollTop=this.$store.state.knowledge.listTop,this.$refs.scroll.addEventListener("scroll",this.recordScrollPosition)},deactivated(){this.$refs.scroll.removeEventListener("scroll",this.recordScrollPosition)},methods:{courseListLoadingClose(){this.$refs.knowledgeSkeleton&&this.$refs.knowledgeSkeleton.closeSkeleton()},init(){this.getKnowledgeList(),this.getLiveList(),this.getMaterialList()},async getKnowledgeList(){const t=await c.Z.getKnowledgeList(this.knowledgePage);this.knowledgeList=t.data.list||[]},async getLiveList(){const{data:t}=await c.Z.getLiveList({pageNum:1,pageSize:2});t.data&&(this.liveList=t.data.list)},async getMaterialList(){const t=await c.Z.getMarketingList(this.sharePage);t.data.data&&(this.shareList=t.data.data.list)},onSearchClick(){this.$router.push("/course-search")},linkToMore(){this.$router.push("/course-all")},recordScrollPosition(t){this.$store.commit("knowledge/setKnowLedgeListTop",t.target.scrollTop)}}},$={name:"Knowledge",components:{CourseModule:(0,u.Z)(w,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"scroll",staticClass:"knowledge"},[s("van-sticky",[s("search-box",{attrs:{placeholder:t.$t("discovery.searchPlaceholder"),disabled:!0},on:{click:t.onSearchClick}})],1),s("div",{staticClass:"knowledge-core"},[t.isFxktFlag?s("custom-banner",{ref:"fxktRef"}):t._e(),s("div",{staticClass:"knowledge-module"},[t.knowledgeList.length?s("hot-points",{attrs:{source:t.knowledgeList}}):t._e(),s("marketing-material",{attrs:{source:t.shareList}}),t.liveList.length>0?s("live-lesson",{attrs:{source:t.liveList,"show-more":!0}}):t._e()],1),s("div",{staticClass:"course-list-wrapper"},[s("common-title",{attrs:{title:t.$t("pageTitle.courseAll")},on:{click:t.linkToMore}}),s("course-list",{attrs:{"page-size":30},on:{loadingClose:t.courseListLoadingClose}})],1)],1),s("BottomTarbar",{attrs:{active:t.active}}),t.isMicroApp?t._e():s("KnowledgeSkeleton",{ref:"knowledgeSkeleton"})],1)}),[],!1,null,"611b6c39",null).exports,CourseAll:s(92959).default},beforeRouteLeave(t,e,s){/(^\/course-reader.*)|(^\/image-text-detail.*)|(^\/project-detail.*)|(^\/course-.*-detail$)|(^\/micro-watch\/.*\/newest$)/.test(t.path)?this.$store.commit("isKeepAlive","Knowledge"):this.$store.commit("noKeepAlive","Knowledge"),s()},computed:(0,a.Z)({marketOpen(){return"true"===this.$store.state.setting.marketOpen}},(0,i.mapGetters)({selectPortal:"setting/getSelectPortal",userInfo:"user/getUserInfo"})),created(){(0,g.Td)(this.selectPortal.name||this.userInfo.enterpriseName)}},k=(0,u.Z)($,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.marketOpen?s("course-module",{ref:"scroll"}):s("course-all")}),[],!1,null,"72cc653c",null).exports},94384:(t,e,s)=>{s.d(e,{Z:()=>m});var a=s(95082),i=(s(47601),s(44951)),o=(s(23307),s(81392)),r=(s(52355),s(29233)),n=(s(26699),s(22648)),c=s(78368),l=s(7294),u=s(26294),d=s(45877),h=s(27632),p={components:{ClCustomUser:d.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z},filters:{filterTimestampToTime:t=>(0,n.ZM)(t)},props:{item:{type:Object,default:()=>({})},styleObject:{type:Object,default:()=>({})}},data:()=>({liveStatus:{prepartion:{color:"#9BA2AA",lang:"attestation.notStarted"},live:{color:"#44D7B6",lang:"ddLive.living"},end:{color:"#E02020",lang:"data.over"},expired:{color:"#9BA2AA",lang:"minePoints.expiredTime"}},studyStatus:{noStudy:{color:"#E02020",lang:"aiStudy.noStudy"},studying:{color:"#6DD400",lang:"aiStudy.studying"},finished:{color:"#516AE6",lang:"aiStudy.studied"}},defaultAvatar:c}),computed:(0,a.Z)({},(0,u.mapGetters)({primaryColor:"getPrimaryColor"})),created(){},mounted(){},methods:{goToLive(){const{liveStatus:t,liveType:e,courseId:s,jumpUrl:a,bizType:i,courseBizType:o}=this.item;([8,9].includes(i)||[8,9].includes(o))&&("poly_wei"===e?(0,l.K7)(s,t):9===i||9===o?(0,l.CS)(s,t):"dingTalk"===h.Z.env?h.Z.openLink({url:a}):this.$dialog.alert({title:this.$t("promptMessage.warmTips"),showCancelButton:!1,confirmButtonText:this.$t("subsidy.gotIt"),confirmButtonColor:this.primaryColor,message:this.$t("ddLive.tip")}))}}},m=(0,s(1001).Z)(p,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("van-cell",{staticClass:"live-item",style:t.styleObject,attrs:{"title-class":"live-item-left","value-class":"live-item-right"},on:{click:function(e){return t.goToLive()}},scopedSlots:t._u([{key:"title",fn:function(){return[s("div",{staticClass:"lesson-img"},[s("img",{attrs:{src:t.item.cover,alt:""}})]),s("div",{staticClass:"lesson-status"},[s("span",{staticClass:"status-dot",style:{background:"end"===t.item.liveStatus?t.studyStatus[t.item.studyStatus].color:t.liveStatus[t.item.liveStatus||"prepartion"].color}}),s("span",{staticClass:"status-text"},[t._v(t._s("end"===t.item.liveStatus?t.$t(t.studyStatus[t.item.studyStatus].lang):t.$t(t.liveStatus[t.item.liveStatus||"prepartion"].lang)))])])]},proxy:!0},{key:"default",fn:function(){return[s("div",{staticClass:"lesson-title"},[t._v(t._s(t.item.title))]),s("div",{staticClass:"lesson-intro"},[s("div",{staticClass:"lesson-anchor"},[s("van-image",{staticClass:"avatar",attrs:{src:t.item.avatar||t.defaultAvatar,fit:"fill"}}),"inside"===t.item.teacherType?s("span",[s("ClCustomUser",{attrs:{type:t.item.teacherSourceType,"data-type":"userName",value:t.item.teacherSyncUserId,name:t.item.teacherName||"--"}})],1):t._e(),"inside"!==t.item.teacherType?s("span",[t._v(t._s(t.item.teacherName))]):t._e()],1),s("div",{staticClass:"lesson-time"},[s("span",[s("van-icon",{attrs:{name:"clock",color:"#ABB3CC",size:"10"}}),t._v(" "+t._s(t._f("filterTimestampToTime")(Number(t.item.startTime))))],1),s("span",{style:{color:"#FFA000"}},[t._v(t._s(t.item.credit)+" "+t._s(t.$t("pointsMall.credits")))])])])]},proxy:!0}])})}),[],!1,null,"3653ba0d",null).exports},32052:(t,e,s)=>{s.r(e),s.d(e,{default:()=>g});var a=s(95082),i=(s(82500),s(49414)),o=(s(82522),s(10342)),r=(s(86039),s(20495)),n=(s(20581),s(50914)),c=(s(49153),s(5944)),l=(s(69710),s(57609)),u=(s(33948),s(26294)),d=s(25295),h=s(94384),p={components:{[l.Z.name]:l.Z,[c.Z.name]:c.Z,[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,LiveItem:h.Z},beforeRouteEnter(t,e,s){"LiveCourse"===t.name&&"Knowledge"===e.name&&(localStorage.currentLiveStatus="",localStorage.currentStudyStatus=""),s()},data:()=>({activeLiveTab:"",tabs:[{name:"",lang:"common.all"},{name:"prepartion",lang:"home.notStarted"},{name:"live",lang:"ddLive.living"},{name:"end",lang:"data.over"}],activeStudyTab:"",studyTabs:[{name:"",lang:"common.all"},{name:"noStudy",lang:"aiStudy.noStudy"},{name:"studying",lang:"aiStudy.studying"},{name:"finished",lang:"aiStudy.studied"}],list:[],loading:!1,finished:!1,params:{keyword:"",liveStatus:"",studyStatus:"",classifyId:"",pageNum:0,pageSize:20}}),computed:(0,a.Z)({},(0,u.mapGetters)({primaryColor:"getPrimaryColor"})),created(){},mounted(){localStorage.currentLiveStatus&&(this.activeLiveTab=localStorage.currentLiveStatus,this.params.liveStatus=this.activeLiveTab,localStorage.currentStudyStatus&&(this.activeStudyTab=localStorage.currentStudyStatus,this.params.studyStatus=this.activeStudyTab))},methods:{onTabChange(t,e,s){"1"===s?(this.activeStudyTab="",localStorage.currentLiveStatus=t):localStorage.currentStudyStatus=t,this.resetQuery()},resetQuery(){this.params=(0,a.Z)((0,a.Z)({},this.params),{},{liveStatus:this.activeLiveTab,studyStatus:this.activeStudyTab,pageNum:0}),this.loading=!0,this.finished=!1,this.list=[],this.loading&&this.onLoad()},async onLoad(){this.params.pageNum+=1;const{data:t}=await d.Z.getLiveList(this.params),{list:e,hasNextPage:s}=t.data;this.list=[...this.list,...e],this.loading=!1,s||(this.finished=!0)}}},m=p,g=(0,s(1001).Z)(m,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"live-course"},[s("van-search",{attrs:{placeholder:t.$t("knowledge.searchPlaceholder")},on:{search:function(e){return t.resetQuery()},clear:function(e){return t.resetQuery()}},model:{value:t.params.keyword,callback:function(e){t.$set(t.params,"keyword",e)},expression:"params.keyword"}}),s("van-divider",{style:{margin:"0"}}),s("van-tabs",{attrs:{color:t.primaryColor,"line-width":24,sticky:""},on:{change:function(e,s){return t.onTabChange(e,s,"1")}},model:{value:t.activeLiveTab,callback:function(e){t.activeLiveTab=e},expression:"activeLiveTab"}},t._l(t.tabs,(function(e){return s("van-tab",{key:e.name,attrs:{title:t.$t(e.lang),name:e.name}})})),1),"end"===t.activeLiveTab?s("van-tabs",{attrs:{"title-active-color":t.primaryColor,"title-inactive-color":"#7F849A","line-width":"0","line-height":"0",sticky:""},on:{change:function(e,s){return t.onTabChange(e,s,"2")}},model:{value:t.activeStudyTab,callback:function(e){t.activeStudyTab=e},expression:"activeStudyTab"}},t._l(t.studyTabs,(function(e){return s("van-tab",{key:e.name,attrs:{title:t.$t(e.lang),name:e.name}})})),1):t._e(),s("van-divider",{style:{margin:"0"}}),s("van-list",{staticClass:"live-list",attrs:{"loading-text":t.$t("common.loading"),finished:t.finished,"finished-text":t.finished&&0===t.list.length?"":t.$t("common.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[t._l(t.list,(function(t,e){return s("live-item",{key:e,attrs:{item:t}})})),t.finished&&0===t.list.length?s("van-empty",{attrs:{description:t.$t("common.noDataTextTip")}}):t._e()],2)],1)}),[],!1,null,"3d6f5344",null).exports},92565:(t,e,s)=>{s.r(e),s.d(e,{default:()=>i});var a={created(){this.$toast.loading({forbidClick:!0,loadingType:"spinner",duration:0})},destroyed(){this.$toast.clear()}},i=(0,s(1001).Z)(a,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"container"})}),[],!1,null,"3d28b780",null).exports},52686:(t,e,s)=>{s.r(e),s.d(e,{default:()=>d});var a=s(95082),i=(s(74916),s(15306),s(26294)),o=s(27632),r=s(17780),n=s(95969),c=s(63874),l=s(69886),u={components:{},data:()=>({native:o.Z,isMicroApp:(0,r.xX)()}),computed:(0,a.Z)({},(0,i.mapGetters)({commonParams:"getCommonParams"})),created:function(){(0,r.xX)()&&this.jumpUrl()},mounted:function(){},methods:{async jumpUrl(){if("true"===this.$route.query.showHomeLink&&this.$store.commit("toggleShowHomeLink",{showHomeLink:!0}),this.$route.query.flag){let t=l.Z.redirect(this.$route.query,!0);t&&(t instanceof Promise&&(t=await t),t.isH5?t.insideJump||this.$router.replace(t.url):t.isExternalLink?(0,c.N8)({url:t.url}):o.Z.navigateTo({url:t.url}))}else this.$router.replace({path:n.Z.message.homeModule()})}}},d=(0,s(1001).Z)(u,(function(){var t=this.$createElement;return(this._self._c||t)("div")}),[],!1,null,"2826eb72",null).exports},41766:(t,e,s)=>{s.r(e),s.d(e,{default:()=>F});s(34837);var a=s(39146),i=s(95082),o=(s(73474),s(74755)),r=(s(21920),s(58280)),n=(s(49902),s(62094)),c=(s(25773),s(35791)),l=(s(70885),s(6458)),u=(s(18144),s(65641)),d=(s(47601),s(44951)),h=(s(45125),s(2282)),p=(s(93787),s(20090)),m=(s(77141),s(30960)),g=(s(57658),s(26294)),v=s(87527),f=s(78551),y=s(49017),_=(s(58247),s(85573)),C=s(55595),I=s(82820),b=s(36812),w={name:"SelectClassify",components:{CommonPopup:b.Z,[_.Z.name]:_.Z},props:{showClassify:Boolean},data:function(){return{classifyList:[],fieldNames:{text:"name",value:"id",children:"children"}}},computed:(0,i.Z)({},(0,g.mapGetters)({microInfo:"microCourse/getMicroCourseInfo",primaryColor:"getPrimaryColor"})),mounted(){this.getCategory()},methods:{getCategory(){C.Z.getCategoryList().then((t=>{this.classifyList=(0,I.b9)(t.data.classify)}))},changeClassify({selectedOptions:t}){this.$emit("select",t)},closeClassify(){this.$emit("closeClassify")}}},$=s(1001),k=(0,$.Z)(w,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"micro-select-classify"},[s("common-popup",{attrs:{show:t.showClassify},on:{closePopup:t.closeClassify},scopedSlots:t._u([{key:"content",fn:function(){return[s("van-cascader",{attrs:{title:"请选择分类","active-color":t.primaryColor,options:t.classifyList,"field-names":t.fieldNames},on:{close:t.closeClassify,change:t.changeClassify,finish:t.closeClassify},model:{value:t.microInfo.course_classify,callback:function(e){t.$set(t.microInfo,"course_classify",e)},expression:"microInfo.course_classify"}})]},proxy:!0}])})],1)}),[],!1,null,"24a528cc",null).exports,S=s(95983),T=s(10898),Z={props:{title:{type:String,default:""},tip:{type:String,default:"(必填)"},highlight:{type:Boolean,default:!0}}},x=(0,$.Z)(Z,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"label"},[s("div",[t._v(t._s(t.title))]),t._v("  "),s("div",{staticClass:"tip"},[t._v(t._s(t.tip))])])}),[],!1,null,"00496bf0",null).exports,P=s(97927),D=s(45877),L=s(5141),A=s(73306),E=s(88095),R={components:{VanForm:m.Z,VanField:p.Z,VanSwitch:h.Z,VanImage:d.Z,VanCol:u.Z,VanRow:l.Z,VanButton:c.Z,VanRadio:n.Z,VanRadioGroup:r.Z,VanPopup:o.Z,NextCard:v.Z,SvgIcon:f.Z,SelectClassify:k,SelectTeacher:S.Z,SelectUser:T.Z,CommonPopup:b.Z,CommonLabel:x,ClCustomUser:D.Z,ApprovalProcess:E.default},data:()=>({course_id:"",showPopup:!1,showClassify:!1,showVisible:!1,showTeacher:!1,coverList:y.Ns,publishButtonDisable:!0,showApprovalProcess:!1,businessId:"",title:"",templates:"",versions:""}),computed:(0,i.Z)((0,i.Z)({},(0,g.mapGetters)({primaryColor:"getPrimaryColor",aiCourseInfo:"microCourse/getAiCourseInfo"})),{},{visibleCount(){return"0"===this.aiCourseInfo.visible_count||""===this.aiCourseInfo.visible_count?"":this.$t("micro.visibleCount",{count:this.aiCourseInfo.visible_count})},classifyName(){return this.aiCourseInfo.classify_id?this.aiCourseInfo.classify_name:""}}),methods:(0,i.Z)((0,i.Z)({},(0,g.mapActions)({updateAiCourseAction:"microCourse/updateAiCourseAction",resetAiCourseAction:"microCourse/resetAiCourseAction"})),{},{async handleSubmit(){if(!P.z.call(this))return;a.Z.loading({message:this.$t("micro.publishing"),forbidClick:!0});const t=await P.K.call(this,{status:"release"});if(a.Z.clear(),t){const{state:e,course:s,approval_template:a}=t.data;"true"===e?(this.businessId=s[0].course_id,this.title=s[0].course_name,this.templates=a.template_id,this.versions=a.template_version,this.showApprovalProcess=!0,this.$toast({message:this.$t("micro.releaseSuccessful2"),position:"top",className:"top10"})):(this.resetAiCourseAction(),this.$router.push({name:"myself-micro-course"}))}else this.$toast("oops, something error")},async handleCourseSave(){if(""===this.aiCourseInfo.title)return this.$toast(this.$t("micro.aiCourse.titleRequired")),!1;if(this.aiCourseInfo.title.length>20)return this.$toast(this.$t("micro.aiCourse.titleMaxLength")),!1;await P.K.call(this,{status:"draft"})?this.$toast(this.$t("micro.saveSuccess")):this.$toast(this.$t("micro.saveFailed"))},handleShowPreview(){P.z.call(this)&&this.$router.push({name:"AICoursePreview"})},handleChooseCover(){this.showPopup=!0},closeClassify(){this.showClassify=!1},closeVisible(){this.showVisible=!1},closeTeacher(){this.showTeacher=!1},closePopup(){this.showPopup=!1},chooseImages(){A.I.call(this,(t=>{-1===t.indexOf("https://")?(this.$toast.loading({duration:0,message:this.$t("common.uploading"),loadingType:"spinner",forbidClick:!0}),L.Z.uploadImg(t).then((t=>{this.updateCover(t.url)})).finally((()=>{this.$toast.clear()}))):this.updateCover(t)}))},updateCover(t){this.showPopup=!1,this.updateAiCourseAction({cover:t})},handleClassifySelect(t){this.updateAiCourseAction({classify_name:t[0].name,classify_id:t[0].id})},handleVisibilityRangeSelect(t){this.updateAiCourseAction({visible_count:t.count,department_ids:t.selDeptIds,user_ids:t.selUserIds})},handleTeacherSelect(t){this.updateAiCourseAction({teacher_id:t.id,teacher_type:t.type,teacher_source_type:t.lecturer_source_type,teacher_sync_user_id:t.lecturer_sync_user_id,teacher_name:t.lecturer_name,teacher_avatar:t.avatar})},hideApprovalProcessPopup(){this.showApprovalProcess=!1},goBack(){this.resetAiCourseAction(),this.$router.push({name:"myself-micro-course"})}})},F=(0,$.Z)(R,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("van-form",{staticClass:"micro-create"},[s("div",{staticClass:"micro-create-row"},[s("van-field",{staticClass:"micro-create-field",attrs:{name:"title",maxlength:"20",placeholder:t.$t("micro.aiCourse.titlePlaceholder")},scopedSlots:t._u([{key:"label",fn:function(){return[s("common-label",{attrs:{title:t.$t("micro.aiCourse.title"),highlight:""===t.aiCourseInfo.title.trim()}})]},proxy:!0}]),model:{value:t.aiCourseInfo.title,callback:function(e){t.$set(t.aiCourseInfo,"title","string"==typeof e?e.trim():e)},expression:"aiCourseInfo.title"}})],1),s("div",{staticClass:"micro-create-row micro-content"},[s("van-field",{staticClass:"micro-create-field",attrs:{rows:"4",type:"textarea",placeholder:t.$t("micro.aiCourse.contentPlaceholder")},scopedSlots:t._u([{key:"label",fn:function(){return[s("common-label",{attrs:{title:t.$t("micro.aiCourse.content"),highlight:""===t.aiCourseInfo.content.trim()}})]},proxy:!0}]),model:{value:t.aiCourseInfo.content,callback:function(e){t.$set(t.aiCourseInfo,"content","string"==typeof e?e.trim():e)},expression:"aiCourseInfo.content"}}),s("div",{staticClass:"word-number"},[s("span",{class:{exceed:t.aiCourseInfo.content.length>1e3}},[t._v(t._s(t.aiCourseInfo.content.length)+" ")]),s("span",[t._v("/1000")])])],1),s("van-row",{attrs:{type:"flex"}},[s("van-col",{staticClass:"micro-create-row",attrs:{span:"16"}},[s("van-field",{staticClass:"micro-create-field",attrs:{rows:"4",autosize:"",type:"textarea",maxlength:"40",label:t.$t("micro.aiCourse.summary")},model:{value:t.aiCourseInfo.summary,callback:function(e){t.$set(t.aiCourseInfo,"summary","string"==typeof e?e.trim():e)},expression:"aiCourseInfo.summary"}})],1),s("van-col",{staticClass:"micro-create-cover",attrs:{span:"8"}},[s("div",{staticClass:"micro-create-cover-image"},[s("van-image",{attrs:{fit:"cover",src:t.aiCourseInfo.cover,height:"100%"}}),s("div",{staticClass:"micro-create-cover-image-select",on:{click:t.handleChooseCover}},[t._v(" "+t._s(t.$t("micro.selectCover"))+" ")])],1)])],1),s("div",{staticClass:"micro-create-bottom"},[s("van-field",{attrs:{placeholder:t.$t("micro.aiCourse.required"),"is-link":"",readonly:"",label:t.$t("micro.knowledgeClassify")},on:{click:function(e){t.showClassify=!0}},model:{value:t.classifyName,callback:function(e){t.classifyName=e},expression:"classifyName"}}),s("van-field",{attrs:{placeholder:t.$t("micro.aiCourse.required"),"is-link":"",readonly:"",label:t.$t("common.visible")},on:{click:function(e){t.showVisible=!0}},model:{value:t.visibleCount,callback:function(e){t.visibleCount=e},expression:"visibleCount"}}),s("van-field",{attrs:{placeholder:t.$t("micro.noLecturer"),"is-link":"",readonly:"",label:t.$t("common.teacher")},on:{click:function(e){t.showTeacher=!0}},scopedSlots:t._u([{key:"input",fn:function(){return["inside"===t.aiCourseInfo.teacher_type?s("cl-custom-user",{attrs:{type:t.aiCourseInfo.teacher_source_type,"data-type":"userName",value:t.aiCourseInfo.teacher_sync_user_id,name:t.aiCourseInfo.teacher_name}}):s("div",[t._v(t._s(t.aiCourseInfo.teacher_name))])]},proxy:!0}])}),s("div",{staticClass:"progress-item"},[s("van-field",{attrs:{readonly:"",name:"switch"},scopedSlots:t._u([{key:"label",fn:function(){return[s("div",[t._v(t._s(t.$t("micro.synchronizationProgress")))]),s("div",{staticClass:"stage-content-desc"},[t._v(t._s(t.$t("micro.aiCourse.syncTip")))])]},proxy:!0},{key:"button",fn:function(){return[s("van-switch",{attrs:{"active-value":"1","inactive-value":"0",size:"24","active-color":t.primaryColor},model:{value:t.aiCourseInfo.is_sync,callback:function(e){t.$set(t.aiCourseInfo,"is_sync",e)},expression:"aiCourseInfo.is_sync"}})]},proxy:!0}])})],1)],1),s("next-card",{scopedSlots:t._u([{key:"body",fn:function(){return[s("div",{staticClass:"bottom-button-group"},[s("div",{staticClass:"save-button",on:{click:t.handleCourseSave}},[s("svg-icon",{attrs:{"icon-class":"icon-baocun"}}),s("div",{staticClass:"text"},[t._v(t._s(t.$t("micro.aiCourse.save")))])],1),s("van-button",{staticClass:"btn",attrs:{type:"default",block:""},on:{click:t.handleShowPreview}},[t._v(t._s(t.$t("micro.aiCourse.preview")))]),s("van-button",{staticClass:"btn",attrs:{type:"primary",color:t.primaryColor,block:"",disable:t.aiCourseInfo.publishButtonDisable},on:{click:t.handleSubmit}},[t._v(t._s(t.$t("micro.aiCourse.publish")))])],1)]},proxy:!0}])})],1),s("common-popup",{attrs:{show:t.showPopup,"close-on-click-overlay":!1,"over-height":320},on:{closePopup:t.closePopup},scopedSlots:t._u([{key:"content",fn:function(){return[s("div",{staticClass:"micro-create-popup-content"},[s("div",{staticClass:"micro-create-popup-title"},[t._v(" "+t._s(t.$t("micro.selectModel"))+" ")]),s("div",{staticClass:"micro-create-popup-cover"},[s("van-radio-group",{attrs:{direction:"horizontal"},on:{change:t.updateCover},model:{value:t.aiCourseInfo.cover,callback:function(e){t.$set(t.aiCourseInfo,"cover",e)},expression:"aiCourseInfo.cover"}},t._l(t.coverList,(function(e){return s("van-radio",{key:e.id,attrs:{name:e.cover,"label-position":"left","checked-color":t.primaryColor}},[s("div",{staticClass:"micro-create-popup-cover-image"},[s("van-image",{attrs:{height:"100%",width:"100%",fit:"cover",src:e.cover}})],1)])})),1),s("div",{staticClass:"micro-create-popup-cover-tip"},[t._v(" "+t._s(t.$t("micro.imageSizeTip"))+" ")])],1),s("div",{staticClass:"micro-create-popup-button",on:{click:function(e){return e.stopPropagation(),function(){return t.chooseImages()}.apply(null,arguments)}}},[t._v(" "+t._s(t.$t("micro.albumSelect"))+" ")]),s("div",{staticClass:"micro-create-popup-cancel",on:{click:function(e){t.showPopup=!1}}},[t._v(" "+t._s(t.$t("common.cancel"))+" ")])])]},proxy:!0}])}),s("select-classify",{attrs:{"show-classify":t.showClassify},on:{select:t.handleClassifySelect,closeClassify:t.closeClassify}}),s("select-user",{attrs:{"show-visible":t.showVisible},on:{select:t.handleVisibilityRangeSelect,closeVisible:t.closeVisible}}),s("select-teacher",{attrs:{show:t.showTeacher},on:{select:t.handleTeacherSelect,closeTeacher:t.closeTeacher}}),s("van-popup",{style:{height:"80%"},attrs:{position:"bottom","close-on-click-overlay":!1},model:{value:t.showApprovalProcess,callback:function(e){t.showApprovalProcess=e},expression:"showApprovalProcess"}},[t.showApprovalProcess?s("approval-process",{attrs:{"biz-type":"course_task","business-id":t.businessId,title:t.title,content:JSON.stringify({courseId:t.businessId,classifyType:"micro_course",isAICourse:!0}),templates:t.templates,versions:t.versions},on:{onCancel:t.hideApprovalProcessPopup,onSuccess:t.goBack}}):t._e()],1)],1)}),[],!1,null,"0d149d90",null).exports},97216:(t,e,s)=>{s.r(e),s.d(e,{default:()=>p});s(34837);var a=s(39146),i=s(95082),o=(s(73474),s(74755)),r=(s(25773),s(35791)),n=(s(57658),s(4782)),c=s(26294),l=s(87527),u=s(97927),d=s(88095),h={components:{AiCover:n.Z,NextCard:l.Z,VanButton:r.Z,ApprovalProcess:d.default,VanPopup:o.Z},data:()=>({showApprovalProcess:!1,businessId:"",title:"",templates:"",versions:""}),computed:(0,i.Z)({},(0,c.mapGetters)({primaryColor:"getPrimaryColor",aiCourseInfo:"microCourse/getAiCourseInfo"})),methods:(0,i.Z)((0,i.Z)({},(0,c.mapActions)({updateAiCourseAction:"microCourse/updateAiCourseAction",resetAiCourseAction:"microCourse/resetAiCourseAction"})),{},{async handlePublish(){if(u.z.call(this)){a.Z.loading({message:this.$t("micro.publishing"),forbidClick:!0});const t=await u.K.call(this,{status:"release"});if(a.Z.clear(),t){const{state:e,course:s,approval_template:a}=t.data;"true"===e?(this.businessId=s[0].course_id,this.title=s[0].course_name,this.templates=a.template_id,this.versions=a.template_version,this.showApprovalProcess=!0,this.$toast({message:this.$t("micro.releaseSuccessful2"),position:"top",className:"top10"})):(this.resetAiCourseAction(),this.$router.push({name:"myself-micro-course"}))}else this.$toast("oops, something error")}},hideApprovalProcessPopup(){this.showApprovalProcess=!1},goBack(){this.resetAiCourseAction(),this.$router.push({name:"myself-micro-course"})}})},p=(0,s(1001).Z)(h,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"preview"},[s("ai-cover"),s("div",{staticClass:"body"},[s("div",{staticClass:"item"},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("micro.aiCourse.title")))]),s("div",[t._v(t._s(t.aiCourseInfo.title))])]),s("div",{staticClass:"item"},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("micro.aiCourse.content")))]),s("div",{staticClass:"micro-content"},[t._v(t._s(t.aiCourseInfo.content))])]),s("div",{staticClass:"item"},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("micro.aiCourse.summary")))]),s("div",[t._v(t._s(t.aiCourseInfo.summary))])]),s("div",{staticClass:"item"},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("micro.knowledgeClassify")))]),s("div",{staticClass:"content"},[t._v(t._s(t.aiCourseInfo.classify_name))])]),s("div",{staticClass:"h-item"},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("common.visible")))]),s("div",{staticClass:"content"},[t._v(t._s(t.$t("micro.visibleCount",{count:""===t.aiCourseInfo.visible_count?0:t.aiCourseInfo.visible_count})))])]),s("div",{staticClass:"h-item"},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("common.teacher")))]),s("div",{staticClass:"content"},[t._v(t._s(t.aiCourseInfo.teacher_name))])])]),s("next-card",{scopedSlots:t._u([{key:"body",fn:function(){return[s("van-button",{staticClass:"btn",attrs:{type:"primary",block:"",color:t.primaryColor,disable:t.aiCourseInfo.publishButtonDisable},on:{click:t.handlePublish}},[t._v("发布")])]},proxy:!0}])}),s("van-popup",{style:{height:"80%"},attrs:{position:"bottom","close-on-click-overlay":!1},model:{value:t.showApprovalProcess,callback:function(e){t.showApprovalProcess=e},expression:"showApprovalProcess"}},[t.showApprovalProcess?s("approval-process",{attrs:{"biz-type":"course_task","business-id":t.businessId,title:t.title,content:JSON.stringify({courseId:t.businessId,classifyType:"micro_course"}),templates:t.templates,versions:t.versions},on:{onCancel:t.hideApprovalProcessPopup,onSuccess:t.goBack}}):t._e()],1)],1)}),[],!1,null,"6fe91940",null).exports},98196:(t,e,s)=>{s.r(e),s.d(e,{default:()=>I});var a=s(95082),i=(s(31146),s(41610)),o=(s(3791),s(93432)),r=(s(71322),s(85471)),n=(s(25773),s(35791)),c=(s(82522),s(10342)),l=(s(82500),s(49414)),u=(s(57658),s(49017)),d=s(78551),h=s(79649),p=s(82642),m=s(28288),g=s(18939),v=s(87527),f=s(26294),y=s(4782),_={components:{SvgIcon:d.Z,VanTabs:l.Z,VanTab:c.Z,VanButton:n.Z,VanPopover:r.Z,VanLoading:o.Z,PortraitStyles:p.default,BackgroundScreens:h.default,FontStyles:m.default,NextCard:v.Z,SpeakerVoice:g.default,AiCover:y.Z},beforeRouteLeave(t,e,s){const a=document.querySelector(".van-dialog");a&&a.remove(),"microCourseList"===t.name||"myself-micro-course"===t.name?i.Z.confirm({title:this.$t("micro.aiCourse.confirmQuit")}).then((()=>{this.resetAiCourseAction(),s()})).catch((()=>{s(!1)})):"myself-micro-course-drafts"===t.name?(this.resetAiCourseAction(),s()):s()},data:()=>({AI_COURSE_CORE_ID:u.eM,tabs:u.lI,showPopover:!1,confirmDialogShow:!1}),computed:(0,a.Z)({},(0,f.mapGetters)({primaryColor:"getPrimaryColor",aiCourseInfo:"microCourse/getAiCourseInfo"})),async mounted(){this.aiCourseInfo[u.eM.background]&&this.aiCourseInfo[u.eM.portrait]&&this.aiCourseInfo[u.eM.voice]||await this.initialAiCourseResourceAction(),this.$route.params.id&&await this.getAiCourseDetail({id:this.$route.params.id})},methods:(0,a.Z)((0,a.Z)({},(0,f.mapActions)({initialAiCourseResourceAction:"microCourse/initialAiCourseResourceAction",getAiCourseDetail:"microCourse/getAiCourseDetail",resetAiCourseAction:"microCourse/resetAiCourseAction",resetOnlyAiTabAction:"microCourse/resetOnlyAiTabAction"})),{},{handleOnPopoverSelect(t){if(t.id===u.Gw.reset.id)this.resetOnlyAiTabAction();else if(t.id===u.Gw.manageBackground.id){if(!this.aiCourseInfo[u.eM.background].some((t=>!t.is_default)))return void this.$toast(this.$t("micro.aiCourse.noBackgroundToast"));this.$router.push({name:"AIBackgroundManage"})}else if(t.id===u.Gw.managePortraitStyle.id){if(!this.aiCourseInfo[u.eM.portrait].some((t=>!t.is_default)))return void this.$toast(this.$t("micro.aiCourse.noPortraitToast"));this.$router.push({name:"AIPortraitManage"})}},handleNext(){this.$router.push({name:"AIContentInfo"})}})},C=(0,s(1001).Z)(_,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"cover-panel"},[s("div",{staticClass:"top-panel"},[s("ai-cover"),s("div",{staticClass:"tabs-container"},[s("van-tabs",{attrs:{animated:"",swipeable:"",color:t.primaryColor,"line-width":24},model:{value:t.aiCourseInfo.activeTabIndex,callback:function(e){t.$set(t.aiCourseInfo,"activeTabIndex",e)},expression:"aiCourseInfo.activeTabIndex"}},t._l(t.tabs,(function(e){return s("van-tab",{key:e.id,attrs:{title:t.$t(e.lang)}})})),1),s("div",{staticStyle:{flex:"1"}}),s("van-popover",{attrs:{trigger:"click",actions:t.aiCourseInfo.manageButtonStatus,placement:"left-start"},on:{select:t.handleOnPopoverSelect},scopedSlots:t._u([{key:"reference",fn:function(){return[s("div",{staticClass:"more"},[s("svg-icon",{attrs:{"icon-class":"icon-more"}})],1)]},proxy:!0}]),model:{value:t.showPopover,callback:function(e){t.showPopover=e},expression:"showPopover"}})],1)],1),s("div",{staticClass:"main-content"},[t.aiCourseInfo.showLoading?s("div",{staticClass:"main-content-loading"},[s("van-loading")],1):s("div",[t.tabs[t.aiCourseInfo.activeTabIndex].id===t.AI_COURSE_CORE_ID.background?s("background-screens"):t.tabs[t.aiCourseInfo.activeTabIndex].id===t.AI_COURSE_CORE_ID.portrait?s("portrait-styles"):t.tabs[t.aiCourseInfo.activeTabIndex].id===t.AI_COURSE_CORE_ID.voice?s("speaker-voice"):s("font-styles")],1)]),s("next-card",{scopedSlots:t._u([{key:"body",fn:function(){return[s("van-button",{staticClass:"btn",attrs:{type:"primary",block:"",color:t.primaryColor},on:{click:t.handleNext}},[t._v("下一步")])]},proxy:!0}])})],1)}),[],!1,null,"4f4e64a1",null),I=C.exports},4782:(t,e,s)=>{s.d(e,{Z:()=>n});var a=s(95082),i=(s(47601),s(44951)),o=s(26294),r={components:{VanImage:i.Z},computed:(0,a.Z)((0,a.Z)({},(0,o.mapGetters)({primaryColor:"getPrimaryColor",aiCourseInfo:"microCourse/getAiCourseInfo"})),{},{fontsize(){return[18,20,22,24,27,29][this.aiCourseInfo.font_size_index]}})},n=(0,s(1001).Z)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"cover-image"},[s("van-image",{attrs:{src:t._f("toHttps")(t.aiCourseInfo.currentBackground.url)}}),s("van-image",{staticClass:"person-avatar",attrs:{src:t._f("toHttps")(t.aiCourseInfo.currentPortrait.url)}}),s("div",{staticClass:"example-text",style:{fontFamily:t.aiCourseInfo.font_name,fontSize:t.fontsize+"px",color:t.aiCourseInfo.font_color}},[t.aiCourseInfo.content?s("div",{staticClass:"content"},[t._v(t._s(t.aiCourseInfo.content))]):s("div",{staticClass:"demo-text"},[s("div",[t._v("示例：既然选择了远方")]),s("div",[t._v("就要风雨兼程，跨过星河，迈过月亮")]),s("div",[t._v("去努力迎接更好的自己")])])])],1)])}),[],!1,null,"39f72cec",null).exports},25165:(t,e,s)=>{s.r(e),s.d(e,{default:()=>c});var a=s(95082),i=s(73434),o=s(26294),r=s(49017),n={components:{BaseBackground:i.Z},data:()=>({AI_COURSE_CORE_ID:r.eM}),computed:(0,a.Z)({},(0,o.mapGetters)({primaryColor:"getPrimaryColor",aiCourseInfo:"microCourse/getAiCourseInfo"}))},c=(0,s(1001).Z)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},[s("base-background",{attrs:{backgrounds:t.aiCourseInfo[t.AI_COURSE_CORE_ID.background].filter((function(t){return!t.is_default})),"can-delete":!0}})],1)}),[],!1,null,"06cba863",null).exports},73434:(t,e,s)=>{s.d(e,{Z:()=>v});s(31146);var a=s(41610),i=s(95082),o=(s(47601),s(44951)),r=s(78551),n=(s(25773),s(35791)),c=(s(33948),s(60285),s(41637),s(30541),s(26294)),l=s(49017),u=s(94862),d=s(73306),h={components:{VanButton:n.Z,VueCropper:u.VueCropper},props:{sourceUrl:{type:String,default:()=>""}},data:()=>({confirmDisabled:!1,croppedResult:null}),computed:(0,i.Z)({},(0,c.mapGetters)({primaryColor:"getPrimaryColor",aiCourseInfo:"microCourse/getAiCourseInfo"})),methods:(0,i.Z)((0,i.Z)({},(0,c.mapActions)({updateAiCourseAction:"microCourse/updateAiCourseAction",updateManageButtonAction:"microCourse/updateManageButtonAction"})),{},{handleCroppedImageUpdate(t){this.croppedResult=t},cancel(){URL.revokeObjectURL(this.sourceUrl),this.$emit("remove")},confirm(){d.P.call(this,"background",(t=>{const e=t;let s=this.aiCourseInfo[l.eM.background];s.unshift(e),this.updateAiCourseAction({currentBackground:e,[l.eM.background]:s})}))}})},p=s(1001),m=(0,p.Z)(h,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"cropper-container"},[s("div",{staticClass:"header"}),s("div",{staticClass:"content"},[s("vue-cropper",{ref:"cropper",staticClass:"cropper",attrs:{"fixed-number":[4,3],"auto-crop":"",info:!1,"can-move-box":!1,"center-box":!0,"fixed-box":!0,fixed:!0,img:t.sourceUrl}})],1),s("div",{staticClass:"footer"},[s("div",{staticClass:"cancel",on:{click:t.cancel}},[t._v(t._s(t.$t("micro.aiCourse.cancel")))]),s("van-button",{staticClass:"small-btn",attrs:{type:"primary",disabled:t.confirmDisabled,color:t.primaryColor},on:{click:t.confirm}},[t._v(t._s(t.$t("micro.aiCourse.confirm")))])],1)])}),[],!1,null,"1743a31e",null).exports,g={components:{VanImage:o.Z,SvgIcon:r.Z,BackgroundCropper:m},props:{backgrounds:{type:Array,default:()=>[]},canDelete:{type:Boolean,default:()=>!1}},data:()=>({AI_COURSE_CORE_ID:l.eM,cropperShow:!1,cropperSourceUrl:"",showActiveBorder:!1}),computed:(0,i.Z)((0,i.Z)({},(0,c.mapGetters)({aiCourseInfo:"microCourse/getAiCourseInfo"})),{},{canUploadCount(){const t=l.yq-this.aiCourseInfo[l.eM.background].length;return t>0?t:0}}),methods:(0,i.Z)((0,i.Z)({},(0,c.mapActions)({getBackgroundsAction:"microCourse/getBackgroundsAction",updateAiCourseAction:"microCourse/updateAiCourseAction",deleteAiCourseResourceAction:"microCourse/deleteAiCourseResourceAction"})),{},{isGif:function(t){return t.url.indexOf(".gif")>-1},handleImageClick(t){this.updateAiCourseAction({currentBackground:t})},handleChooseImage(){this.canUploadCount<=0?this.$toast(this.$t("micro.aiCourse.forbidUploadTip",{count:l.yq-8})):d.I.call(this,(t=>{this.cropperSourceUrl=t,this.cropperShow=!0}))},handleRemoveCropper(){this.cropperShow=!1},handleConfirmCropper(){this.cropperShow=!1},handleBackgroundDelete(t){const e=(0,i.Z)({},this.aiCourseInfo.currentBackground);this.updateAiCourseAction({currentBackground:t}),this.showActiveBorder=!0,a.Z.confirm({message:this.$t("micro.aiCourse.confirmDelete")}).then((()=>{this.deleteAiCourseResourceAction({config_type:"background",id_list:[t.id]}),this.showActiveBorder=!1})).catch((()=>{this.showActiveBorder=!1,this.updateAiCourseAction({currentPortrait:e})}))}})},v=(0,p.Z)(g,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"bg-screen"},[t.cropperShow?s("background-cropper",{attrs:{"source-url":t.cropperSourceUrl},on:{remove:t.handleRemoveCropper,confirm:t.handleConfirmCropper}}):t._e(),s("div",{staticClass:"bg-screen-upload-item",on:{click:t.handleChooseImage}},[s("label",{attrs:{for:"image-upload"}},[s("div",{staticClass:"uploader"},[s("svg-icon",{attrs:{"icon-class":"icon-icon-add",size:16,color:"rgba(0, 0, 0, 0.25)"}}),t.canDelete?s("i18n",{staticClass:"uploader-tip",attrs:{path:"micro.aiCourse.canUploadCount"}},[s("span",{staticClass:"count"},[t._v(t._s(t.canUploadCount))])]):t._e()],1)])]),t._l(t.backgrounds,(function(e){return s("div",{key:e.index,staticClass:"bg-screen-item",class:{"bg-screen-item-active":e===t.aiCourseInfo.currentBackground&&(!t.canDelete||t.showActiveBorder)}},[t.isGif(e)?s("div",{staticClass:"format-tip"},[t._v(t._s(t.$t("micro.aiCourse.dynamic")))]):t._e(),s("van-image",{attrs:{src:t._f("toHttps")(e.url),radius:"5"},on:{click:function(s){return t.handleImageClick(e)}}}),t.canDelete?s("div",{staticClass:"delete-marker",on:{click:function(s){return t.handleBackgroundDelete(e)}}},[s("svg-icon",{attrs:{"icon-class":"icon-guanbi",color:"white"}})],1):t._e()],1)}))],2)}),[],!1,null,"0985977c",null).exports},79649:(t,e,s)=>{s.r(e),s.d(e,{default:()=>c});var a=s(95082),i=s(73434),o=s(26294),r=s(49017),n={components:{BaseBackground:i.Z},data:()=>({AI_COURSE_CORE_ID:r.eM}),computed:(0,a.Z)({},(0,o.mapGetters)({primaryColor:"getPrimaryColor",aiCourseInfo:"microCourse/getAiCourseInfo"}))},c=(0,s(1001).Z)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"backgroundContent",attrs:{id:"backgroundContent"}},[s("base-background",{attrs:{backgrounds:t.aiCourseInfo[t.AI_COURSE_CORE_ID.background]}})],1)}),[],!1,null,"dbd5b752",null).exports},28288:(t,e,s)=>{s.r(e),s.d(e,{default:()=>h});var a=s(95082),i=s(26294),o=(s(39714),s(74916),s(91058),{props:{color:{type:String,default:""}},data:()=>({currentColor:"red"}),mounted(){if(this.color){const t=this.hexToRgb(this.color),e=360*this.rgbToHsl(t.r,t.g,t.b)[0];this.$refs.hueSlider.value=e}this.setHue()},methods:{setHue(){const t=this.$refs.hueSlider.value;this.$refs.hueMarker.style.left=t/360*100+"%",this.currentColor=`hsl(${t}, 100%, 50%)`;const e=this.hslToRgb(t/360,1,.5);this.currentColor=this.RGBAToHex({r:e[0],g:e[1],b:e[2]}),this.$emit("select",this.currentColor)},hslToRgb(t,e,s){let a,i,o;if(0===e)o=i=a=s;else{let r=function(t,e,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?t+6*(e-t)*s:s<.5?e:s<2/3?t+(e-t)*(2/3-s)*6:t},n=s<.5?s*(1+e):s+e-s*e,c=2*s-n;o=r(c,n,t+1/3),i=r(c,n,t),a=r(c,n,t-1/3)}return[Math.round(255*o),Math.round(255*i),Math.round(255*a)]},rgbToHsl(t,e,s){t/=255,e/=255,s/=255;let a,i,o=Math.max(t,e,s),r=Math.min(t,e,s),n=(o+r)/2;if(o===r)a=i=0;else{let c=o-r;switch(i=n>.5?c/(2-o-r):c/(o+r),o){case t:a=(e-s)/c+(e<s?6:0);break;case e:a=(s-t)/c+2;break;case s:a=(t-e)/c+4}a/=6}return[a,i,n]},RGBAToHex(t){let e=t.r.toString(16),s=t.g.toString(16),a=t.b.toString(16);return t.r<16&&(e=`0${e}`),t.g<16&&(s=`0${s}`),t.b<16&&(a=`0${a}`),`#${e}${s}${a}`},hexToRgb(t){let e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}}}),r=s(1001),n=(0,r.Z)(o,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"colorBar",staticClass:"color-bar",style:{color:t.currentColor}},[s("input",{ref:"hueSlider",attrs:{type:"range",min:"0",max:"360",step:"1"},on:{input:t.setHue}}),s("div",{ref:"hueMarker",staticClass:"color-bar-marker"})])}),[],!1,null,"33abac9a",null).exports,c={props:{selectIndex:{type:Number,default:1},items:{type:Array,default:()=>[]}},data:()=>({width:0,step:20}),computed:{currentValue(){return this.selectIndex*this.step},textLeft(){return(this.width-6)/(this.items.length-1)*1-8+"px"}},mounted(){this.width=this.$refs.slider.clientWidth},methods:{leftPos(t){return(this.width-6)/(this.items.length-1)*(t-1)},change(){const t=this.$refs.slider.value/20;this.$emit("select",t)}}},l=(0,r.Z)(c,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"font-size-panel"},[t._m(0),s("div",[s("div",{staticClass:"slidecontainer"},[s("input",{ref:"slider",staticClass:"slider",attrs:{type:"range",min:"0",max:"100",step:t.step},domProps:{value:t.currentValue},on:{change:t.change}}),t._l(t.items.length,(function(e){return s("div",{key:e,staticClass:"dot",style:{left:t.leftPos(e)+"px"}})})),s("div",{staticClass:"text",style:{left:t.textLeft}},[t._v(t._s(t.items[1].name))])],2)])])}),[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"font-tip"},[s("div",{staticClass:"font-tip-left"},[t._v("A")]),s("div",{staticClass:"font-tip-right"},[t._v("A")])])}],!1,null,"4211d672",null).exports,u=s(49017),d={components:{ColorPicker:n,FontsizePicker:l},props:{fontFamilies:{type:Array,default:()=>[{font_name:"font1",name:"思源黑体",label:"micro.aiCourse.sourceHanSans"},{font_name:"font2",name:"叶根友微典",label:"micro.aiCourse.yGYweiDian"},{font_name:"font4",name:"站酷文艺体",label:"micro.aiCourse.zCoolWenYiTi"},{font_name:"font5",name:"站酷高端黑",label:"micro.aiCourse.zCoolGaoDuanHei"},{font_name:"font3",name:"站酷庆科黄油体",label:"micro.aiCourse.zCoolQingKe"},{font_name:"阿里巴巴普惠体",name:"阿里巴巴普惠体",label:"micro.aiCourse.alibabaPuHuiTi"}]},fontColors:{type:Array,default:()=>[{value:"#000000"},{value:"#ffffff"},{value:"#3277FF"},{value:"#34C759"},{value:"#FF3B30"},{value:"#FF9500"},{value:"#5856D6"},{value:"#AF52DE"},{value:"#816540"},{value:"#fff",icon_url:"https://oss.coolcollege.cn/1835270161435856896.png",type:"image"}]}},data:()=>({AI_COURSE_FONT_SIZE_DATA:u.fP,showFontSizePicker:!0}),computed:(0,a.Z)({},(0,i.mapGetters)({primaryColor:"getPrimaryColor",aiCourseInfo:"microCourse/getAiCourseInfo"})),mounted(){},methods:(0,a.Z)((0,a.Z)({},(0,i.mapActions)({updateAiCourseAction:"microCourse/updateAiCourseAction"})),{},{handleFontFamilyClick(t){this.updateAiCourseAction({font_name:t.font_name,font_family:t.name})},handleFontColorClick(t){"image"===t.type?this.updateAiCourseAction({isPure:!1}):this.notifyColorChanged(t.value)},handleColorBarSelected(t){this.notifyColorChanged(t,!1)},handleFontSizeChange(t){this.updateAiCourseAction({font_size_index:t})},notifyColorChanged(t,e=!0){this.updateAiCourseAction({font_color:t,isPure:e}),e||this.$refs.fontColorList.scrollIntoView()}})},h=(0,r.Z)(d,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"fontPanel",staticClass:"font-panel"},[s("div",{staticClass:"font-family-title"},[t._v(t._s(t.$t("micro.aiCourse.fontStyle")))]),s("div",{staticClass:"font-family-list"},t._l(t.fontFamilies,(function(e){return s("div",{key:e.name,staticClass:"font-family-list-item",class:{"item-active":e.name===(t.aiCourseInfo.font_family||t.aiCourseInfo.default_font_family)},on:{click:function(s){return t.handleFontFamilyClick(e)}}},[s("div",{staticClass:"text",style:{fontFamily:e.font_name}},[t._v(t._s(t.$t(e.label)))])])})),0),s("div",{staticClass:"font-size-title"},[t._v(t._s(t.$t("micro.aiCourse.fontSize")))]),s("div",[s("fontsize-picker",{attrs:{"select-index":t.aiCourseInfo.font_size_index,items:t.AI_COURSE_FONT_SIZE_DATA},on:{select:t.handleFontSizeChange}})],1),s("div",{staticClass:"font-color-title"},[t._v(t._s(t.$t("micro.aiCourse.fontColor")))]),s("div",{ref:"fontColorList",staticClass:"font-color-list"},[t._l(t.fontColors,(function(e){return s("div",{key:e.value,staticClass:"font-color-list-item",class:{"item-active":e.icon_url?!t.aiCourseInfo.isPure:e.value===t.aiCourseInfo.font_color},on:{click:function(s){return t.handleFontColorClick(e)}}},["image"===e.type?s("img",{attrs:{src:e.icon_url}}):s("div",{staticClass:"real-item",class:{"item-with-border":"image"!==e.type},style:{background:e.value}})])})),t.aiCourseInfo.isPure?t._e():s("color-picker",{staticClass:"color-picker",attrs:{id:"colorPicker",color:t.aiCourseInfo.font_color},on:{select:t.handleColorBarSelected}})],2)])}),[],!1,null,"4a68e6e8",null).exports},42765:(t,e,s)=>{s.d(e,{Z:()=>L});var a=s(95082),i=(s(33948),s(57658),s(53743),s(59978)),o=(s(629),s(67763)),r=s(78551),n=s(26294),c={name:"CommonOperate",components:{[o.Z.name]:o.Z,[i.Z.name]:i.Z,SvgIcon:r.Z},props:{customItem:{type:Array,default:()=>[]},iconSize:{type:Number,default:14},iconColor:{type:String,default:""},badge:{type:[Number,String],default:""},gutter:{type:[Number,String],default:0}},computed:(0,a.Z)({},(0,n.mapGetters)({primaryColor:"getPrimaryColor"})),methods:{onClick(t){this.$emit("doSomething",t)}}},l=s(1001),u=(0,l.Z)(c,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"common-operate"},[s("van-grid",{attrs:{clickable:"",border:!1,"column-num":t.customItem.length,gutter:t.gutter}},t._l(t.customItem,(function(e){return s("van-grid-item",{key:e.index,staticStyle:{"flex-basis":"auto","padding-right":"15px"},attrs:{text:t.$t(e.lang),badge:e.badge},on:{click:function(s){return t.onClick(e)}},scopedSlots:t._u([{key:"icon",fn:function(){return[s("svg-icon",{attrs:{size:t.iconSize,"icon-class":e.iconClass,color:t.iconColor}})]},proxy:!0}],null,!0)})})),1)],1)}),[],!1,null,"ca225e56",null).exports,d=(s(34837),s(39146)),h=(s(23307),s(81392)),p=(s(31930),s(94907)),m=(s(26699),s(32023),s(5141)),g=s(39145),v=s(27632),f=s(72244),y=s(22648),_=s(68092),C=s(56767),I=s(71522),b={name:"CommonOverlay",components:{[p.Z.name]:p.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,[h.Z.name]:h.Z},props:{show:{type:Boolean,default:!1},operateList:{type:Array,default:()=>[]},showInput:{type:Boolean,default:!1}},data:function(){return{ua:(0,y.ij)(),system:(0,y.Os)(),fileNumber:0,isXSF:(0,_.UI)("IS_XIONG_SHI_FU"),uploader:null,uploaderObj:null,fileList:[],currentUploadType:"",currentUploadVideoDuration:0,storageConfig:{storageType:"PUBLIC_CLOUD",id:"public"}}},computed:(0,a.Z)({filterOperateList(){const t=this.operateList,e="dingtalk_browser"===this.ua&&"android"===this.system,s="dingTalk_h5"===v.Z.specialEnv,a="lark"===this.ua&&"android"===this.system,i="wechat_qy"===this.ua&&"android"===this.system,o="android_app"===this.ua;return e||a||i||o||s?t.filter((t=>"shoot"!==t.id)):t}},(0,n.mapGetters)({microCourseInfo:"microCourse/getMicroCourseInfo"})),mounted(){this.$store.commit("microCourse/resetMicroInfo"),this.funInitStorage(),this.uploader=(0,C.x)({onUpdateSuccess:this.onUpdateSuccess,onUploadFailed:this.onUploadFailed}),this.uploader.initUploader()},methods:{async funInitStorage(){const t=await m.Z.getStorageSet();this.uploaderObj=(0,C.x)({onUpdateSuccess:this.onUpdateSuccessFile,onUploadWarning:this.onUploadFailedFile,onUploadFailed:this.onUploadFailedFile}),t&&!0===t.isDefault?(this.storageConfig=(0,a.Z)({},t),"ALIBABA_PRIVATE"===t.storageType?this.uploaderObj.initUploader({type:"ALIBABA_PRIVATE",id:t.id}):this.uploaderObj.initUploader()):this.uploaderObj.initUploader()},onClick(){this.$emit("closeOverlay")},appChooseFile(t){const e={voice:{method:"chooseImage",params:{compressed:!0,count:8,sourceType:["album","camera"]}},video:{method:"chooseVideo",params:{compressed:!0,count:1,sourceType:["album"],maxDuration:this.isXSF?300:60}},shoot:{method:"chooseVideo",params:{compressed:!0,count:1,sourceType:["camera"],maxDuration:this.isXSF?300:60}}};v.Z[e[t].method](e[t].params,(e=>{"success"===e.status&&(this.currentUploadType=t,this.uploadFile("voice"===t?e.filePaths:[e],t))}),(t=>{console.error(t,"选择文件失败")}))},judgeField(t,e){const s="android_app"===this.ua||"ios_app"===this.ua,{length:a}=t;if(0===a)return!1;if("voice"===e&&a>8)return this.$toast(this.$t("micro.uploadVoiceTip")),!1;if("voice"!==e&&a>1)return this.$toast(this.$t("micro.videoNumberTip")),!1;if("voice"===e)for(let e=0;e<t.length;e++){let a="";a=s?t[e].path:t[e].name;const i=a.split("."),o=i[i.length-1].toLowerCase();if(!f.Wb.includes(o))return this.$toast(this.$t("micro.notSupportImageType")),!1}else{const e=s?t[0].path.split("."):t[0].name.split("."),a=e[e.length-1].toLowerCase(),i=t[0].size/1024/1024,o=this.isXSF?500:200;if(i>o)return this.$toast(this.$t("micro.videoLimit",{num:o})),!1;if(!f.Bg.includes(a))return this.$toast(this.$t("micro.notSupportVideoType")),!1}return!0},uploadChangeInput(t){if(!this.showInput)return;const{id:e}=t;this.currentUploadType=e,"voice"===e?this.funChooseImage():this.funChooseVideo(e)},funChooseImage(){g.w.chooseImageByInput({count:8,sourceType:["camera","album"],success:t=>{const{files:e}=t;this.judgeField(e,"voice")&&(d.Z.loading({duration:0,forbidClick:!0,message:this.$t("common.uploading")}),this.fileList=e,this.uploaderObj.chooseFiles({choosedFiles:e,notLibrary:!1}))},fail:({message:t})=>{d.Z.clear(),this.$toast({message:t})}})},funChooseVideo(t){g.w.chooseVideoByInput({sourceType:"video"===t?["camera","album"]:["camera"],sizeLimit:this.isXSF?500:200,success:t=>{d.Z.loading({duration:0,forbidClick:!0,message:this.$t("common.uploading")});const{file:e}=t;this.judgeField([e],"video")&&this.uploaderObj.chooseFiles({choosedFiles:[e],notLibrary:!1})},fail:({message:t})=>{d.Z.clear(),this.$toast({message:t})}})},uploadChange(t,e){this.currentUploadType=e.id,this.$store.commit("microCourse/resetMicroInfo");this.judgeField(t.target.files,e.id)&&(d.Z.loading({duration:0,forbidClick:!0,message:this.$t("common.uploading")}),"voice"!==e.id&&this.uploadVideo(t,e))},updateVoice(t,e){const s=this.microCourseInfo.resources.find((t=>t.index===this.fileNumber));s.cover=t,s.isError=e,delete s.index;return{index:this.fileNumber,resource:s}},uploadVideo(t){const e=t.target.files[0],s={choosedFiles:[e],notLibrary:!1};this.uploader.chooseFiles(s),(0,C.M)(e).then((t=>{this.currentUploadVideoDuration=t}))},uploadFile(t,e){this.$store.commit("microCourse/resetMicroInfo");"ios_app"===this.ua||d.Z.loading({duration:0,forbidClick:!0,message:this.$t("common.uploading")}),"voice"===e?this.appUploadVoice(t,e):this.appUploadVideo(t,e)},appUploadVoice(t,e){this.$store.commit("microCourse/addOneResource",{cover:"",duration:0,audios:[],index:this.fileNumber});const s=t[this.fileNumber];m.Z.appUploadFile(s,e,(async s=>{const a=s.data;console.warn(a,"response");const i=`${a.data.server}/${a.data.fileNewName}`,o=this.updateVoice(i,!1);await this.$store.dispatch("microCourse/updateOneResource",{payload:o}),this.fileNumber++,this.fileNumber===t.length?(this.fileNumber=0,this.$emit("dealOperate",e),d.Z.clear()):this.appUploadVoice(t,e)}),(()=>{d.Z.clear(),this.$toast(this.$t("common.uploadFail"));const t=this.updateVoice("",!0);this.$store.dispatch("microCourse/updateOneResource",{payload:t})}))},async appUploadVideo(t){try{const e=t[0],s=await m.Z.uploadFileIsVideoApp(e),i=(0,a.Z)((0,a.Z)({},s[0]),{},{filename:s[0].path,video_id:s[0].videoId});this.finishUploadInfo(e,i)}catch(t){console.error("上传失败：",t),d.Z.clear(),this.$toast(this.$t("common.uploadFail"))}},finishUploadInfo(t,e){this.$store.commit("microCourse/addOneResource",{index:0,cover:"https://oss.coolcollege.cn/1789887486743416832.png",parameter:"1920,1080",size:t.size,id:t.id,url:"",name:t.name,video_id:t.videoId,resource_id:e.resource_id,duration:Math.round(this.currentUploadVideoDuration||t.duration,0),audios:[],storageType:this.storageConfig.storageType,privatization:this.storageConfig.id}),setTimeout((()=>{this.$emit("dealOperate",this.currentUploadType),d.Z.clear()}),0)},onUpdateSuccess(t,e){const s={filename:t.name,video_id:t.videoId,resource_id:t.id};this.finishUploadInfo(e[0],s)},onUploadFailed(){d.Z.clear(),d.Z.fail({duration:2e3,message:this.$t("common.uploadFail")})},onUpdateSuccessFile(t,e){d.Z.clear();const{videoId:s,url:a,id:i}=t;"voice"!==this.currentUploadType&&(0,C.M)(e).then((t=>{this.currentUploadVideoDuration=t}));let o="";setTimeout((async()=>{if("ALIBABA_PRIVATE"===this.storageConfig.storageType){const{data:t}=await I.Z.getPrivateImgUrl(s);0===t.code&&(o=t.data.docResourceDownloadUrl)}else o=a;"voice"===this.currentUploadType?(await this.$store.commit("microCourse/addOneResource",{cover:o,duration:0,audios:[],resourceId:s?i:"",storageType:this.storageConfig.storageType,privatization:this.storageConfig.id,index:this.microCourseInfo.resources.length}),this.funImageUploadDone()):this.finishUploadInfo(t,{resource_id:t.id})}),1e3)},onUploadFailedFile(){d.Z.clear(),this.funImageUploadDone()},funImageUploadDone(){this.fileNumber++,this.fileNumber===this.fileList.length&&(this.fileNumber=0,this.$emit("dealOperate",this.currentUploadType),d.Z.clear())}}},w=(0,l.Z)(b,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"common-overlay"},[s("van-overlay",{attrs:{"z-index":"2","class-name":"common-overlay-custom",show:t.show}},[s("div",{staticClass:"common-overlay-group"},t._l(t.filterOperateList,(function(e){return s("div",{key:e.id,staticClass:"common-overlay-group-item",on:{click:function(s){!t.showInput&&t.appChooseFile(e.id)}}},[s("img",{staticClass:"common-overlay-group-item-image",attrs:{src:e.icon},on:{click:function(s){return t.uploadChangeInput(e)}}}),s("p",{staticClass:"common-overlay-group-item-text"},[t._v(t._s(t.$t(e.lang)))])])})),0),s("van-icon",{staticClass:"common-overlay-icon",attrs:{name:"close",size:"35px"},on:{click:t.onClick}})],1)],1)}),[],!1,null,"54defbb2",null).exports,$=s(49017),k=(s(25773),s(35791)),S=(s(30033),{components:{VanCheckbox:s(87837).Z,VanButton:k.Z},data:()=>({checked:!1}),computed:(0,a.Z)({},(0,n.mapGetters)({primaryColor:"getPrimaryColor"})),methods:{handleConfirm(){this.checked?this.$emit("confirm"):this.$toast(this.$t("micro.aiCourse.uncheckUserAgreement"))}}}),T=(0,l.Z)(S,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"agreement"},[s("div",{staticClass:"alert"},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("micro.aiCourse.agreementTitle")))]),s("i18n",{staticClass:"content",attrs:{path:"micro.aiCourse.agreementMessage"}},[s("router-link",{attrs:{to:"/ai-micro-course-user-agreement"}},[t._v(t._s(t.$t("micro.aiCourse.userAgreementTitle")))])],1),s("div",{staticClass:"option"},[s("van-checkbox",{attrs:{"icon-size":16},model:{value:t.checked,callback:function(e){t.checked=e},expression:"checked"}},[t._v(t._s(t.$t("micro.aiCourse.agreementOption")))])],1),s("div",{staticClass:"confirm"},[s("van-button",{staticClass:"btn",attrs:{type:"primary",color:t.primaryColor,block:""},on:{click:t.handleConfirm}},[t._v(t._s(t.$t("micro.aiCourse.agreementConfirm")))])],1),s("div",{staticClass:"cancel",on:{click:function(e){return t.$emit("close")}}},[t._v(t._s(t.$t("micro.aiCourse.agreementCancel")))])],1)])}),[],!1,null,"76d9446c",null).exports,Z={data:()=>({showPopover:!0}),mounted(){let t=this.$refs.arrow.getContext("2d");const e=function(t){let e=t.backingStorePixelRatio||t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return(window.devicePixelRatio||1)/e}(t);t.scale(e,e),t.beginPath(),t.moveTo(0,0),t.lineTo(20,20),t.lineTo(40,0),t.fillStyle="#fff",t.fill()}},x=(0,l.Z)(Z,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"user-guide"},[s("div",{staticClass:"panel"},[s("div",[s("canvas",{ref:"arrow",staticClass:"arrow"})]),s("div",{staticClass:"dialog"},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("micro.aiCourse.aiMicroCourse")))]),s("div",{staticClass:"content"},[t._v(t._s(t.$t("micro.aiCourse.clickAiCourseTip")))]),s("div",{staticClass:"confirm",on:{click:function(e){return t.$emit("confirm")}}},[t._v(t._s(t.$t("micro.aiCourse.knowIt")))])]),t._m(0)])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"new-icon"},[e("img",{attrs:{src:"https://oss.coolcollege.cn/1835271359391993856.png"}})])}],!1,null,"8efc16fc",null).exports,P=s(54304),D={components:{CommonOperate:u,CommonOverlay:w,UserAgreement:T,AiNewGuide:x},data:()=>({AI_COURSE_GUIDE_FLAG:$.qQ,showUserAgreement:!1,operate:$.eg,MICRO_OPERATE_ENTER:$.MS,AI_MICRO_OPERATE_ENTER:$.YA,showOverlay:!1,hideAiCourse:!0}),computed:(0,a.Z)((0,a.Z)({},(0,n.mapGetters)({primaryColor:"getPrimaryColor",access_token:"getToken",env:"getEnv",isPure:"getIsPure",aiCourseNewFlag:"microCourse/getAiCourseNewFlag",versionType:"getVersionType"})),{},{agentEnv:()=>(0,P.xc)()}),async mounted(){await Promise.all([this.getAiCourseNewFlagAction({type:$.qQ.firstShow}),this.getAiCourseNewFlagAction({type:$.qQ.showUserAgreement})]),this.updateOperateEnter()},methods:(0,a.Z)((0,a.Z)({},(0,n.mapActions)({updateAiCourseNewFlagAction:"microCourse/updateAiCourseNewFlagAction",postAiCourseNewFlagAction:"microCourse/postAiCourseNewFlagAction",getAiCourseNewFlagAction:"microCourse/getAiCourseNewFlagAction"})),{},{updateOperateEnter(){this.operateEnter=this.AI_MICRO_OPERATE_ENTER.map((t=>("micro.aiCourse.aiMicroCourse"===t.lang&&this.aiCourseNewFlag.firstShow?t.badge=this.$t("micro.aiCourse.new"):t.badge="",t)))},closeOverlay(){this.showOverlay=!1},dealOperate(t){this.closeOverlay(),this.$router.push({path:"/micro-create",query:{origin:"microEnter",type:t}})},doSomething(t){"release"===t.id?this.showOverlay=!0:"ai"===t.id&&(this.aiCourseNewFlag.showUserAgreement?this.showUserAgreement=!0:this.$router.push({name:"AICoverInfo"}))},handleUserAgreementClose(){this.showUserAgreement=!1},async handleUserAgreementConfirm(){await this.postAiCourseNewFlagAction({type:$.qQ.showUserAgreement}),this.showUserAgreement=!1,this.$router.push({name:"AICoverInfo"})},async handleNewGuideConfirm(){await this.postAiCourseNewFlagAction({type:$.qQ.firstShow}),this.updateOperateEnter()}})},L=(0,l.Z)(D,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",[t.showUserAgreement?s("user-agreement",{on:{close:t.handleUserAgreementClose,confirm:t.handleUserAgreementConfirm}}):t._e(),t.aiCourseNewFlag.firstShow?s("ai-new-guide",{on:{confirm:t.handleNewGuideConfirm}}):t._e(),s("common-operate",{attrs:{"custom-item":t.AI_MICRO_OPERATE_ENTER,"icon-size":20,"icon-color":"rgba(127, 132, 154, 1)",gutter:20},on:{doSomething:t.doSomething}})],1),s("common-overlay",{attrs:{show:t.showOverlay,"show-input":"app"!==t.agentEnv,"operate-list":t.operate},on:{closeOverlay:t.closeOverlay,dealOperate:t.dealOperate}})],1)}),[],!1,null,null,null).exports},87527:(t,e,s)=>{s.d(e,{Z:()=>a});var a=(0,s(1001).Z)({},(function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"bottom-panel"},[t._t("body")],2)}),[],!1,null,"6dd81ffe",null).exports},36812:(t,e,s)=>{s.d(e,{Z:()=>r});s(73474);var a=s(74755),i=s(11651),o={name:"CommonPopup",components:{[a.Z.name]:a.Z},props:{show:{type:Boolean,default:!1},overHeight:{type:Number,default:300},closeOnClickOverlay:{type:Boolean,default:!0}},data:function(){return{showPopup:!1}},computed:{getHeight(){return(0,i.W)(this.overHeight)}},watch:{show:function(t){this.showPopup=t}},methods:{closePopup(){this.$emit("closePopup")}}},r=(0,s(1001).Z)(o,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"common-popup"},[s("van-popup",{style:{height:t.getHeight},attrs:{"close-on-click-overlay":t.closeOnClickOverlay,position:"bottom"},on:{close:t.closePopup},model:{value:t.showPopup,callback:function(e){t.showPopup=e},expression:"showPopup"}},[s("div",{staticClass:"common-popup-content"},[t._t("content")],2)])],1)}),[],!1,null,"1bd01a01",null).exports},52619:(t,e,s)=>{s.d(e,{Z:()=>C});s(31146);var a=s(41610),i=s(95082),o=(s(73474),s(74755)),r=(s(47601),s(44951)),n=s(26294),c=(s(25773),s(35791)),l=(s(33948),s(60285),s(41637),s(30541),s(78551)),u=s(87527),d={components:{VanButton:c.Z,NextCard:u.Z,VanImage:r.Z},computed:(0,i.Z)({},(0,n.mapGetters)({primaryColor:"getPrimaryColor"})),methods:{handleConfirm(){this.$emit("confirm")}}},h=s(1001),p=(0,h.Z)(d,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"guide-panel"},[s("div",{staticClass:"guide-panel-body"},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("micro.aiCourse.guidePanelTitle")))]),s("div",{staticClass:"desc"},[t._v(t._s(t.$t("micro.aiCourse.guidePanelDesc")))]),s("van-image",{staticClass:"personImage",attrs:{src:"https://oss.coolcollege.cn/1835269576082984960.png"}}),s("div",{staticClass:"warning"},[s("div",{staticClass:"warning-title"},[t._v(t._s(t.$t("micro.aiCourse.guidePanelWarningTitle")))]),s("div",{staticClass:"warning-text"},[t._v(t._s(t.$t("micro.aiCourse.guidePanelWarning")))])])],1),s("next-card",{scopedSlots:t._u([{key:"body",fn:function(){return[s("van-button",{staticClass:"btn",attrs:{type:"primary",block:"",color:t.primaryColor},on:{click:t.handleConfirm}},[t._v(t._s(t.$t("micro.aiCourse.knowIt")))])]},proxy:!0}])})],1)}),[],!1,null,"653e292e",null).exports,m=s(49017),g=s(94862),v=s(73306),f={name:"AvatarCropper",components:{VueCropper:g.VueCropper,VanButton:c.Z,SvgIcon:l.Z,GuidePanel:p,VanPopup:o.Z},props:{sourceUrl:{type:String,default:()=>""}},data:()=>({showPopover:!1,confirmDisabled:!1}),computed:(0,i.Z)({},(0,n.mapGetters)({primaryColor:"getPrimaryColor",aiCourseInfo:"microCourse/getAiCourseInfo"})),methods:(0,i.Z)((0,i.Z)({},(0,n.mapActions)({updateAiCourseAction:"microCourse/updateAiCourseAction",updateManageButtonAction:"microCourse/updateManageButtonAction"})),{},{handleCroppedImageUpdate(t){this.croppedResult=t},cancel(){URL.revokeObjectURL(this.sourceUrl),this.$emit("remove")},confirm(){v.P.call(this,"portrait",(t=>{const e=t;let s=this.aiCourseInfo[m.eM.portrait];s.unshift(e),this.updateAiCourseAction({currentPortrait:e,[m.eM.portrait]:s})}))}})},y=(0,h.Z)(f,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"avatar-cropper"},[s("van-popup",{style:{height:"560px"},attrs:{position:"bottom",closeable:"",round:"","lock-scroll":!1},model:{value:t.showPopover,callback:function(e){t.showPopover=e},expression:"showPopover"}},[s("guide-panel",{on:{confirm:function(e){t.showPopover=!1}}})],1),s("div",{staticClass:"header"},[s("div",{staticClass:"mark-container",on:{click:function(e){t.showPopover=!0}}},[s("svg-icon",{attrs:{color:"#ddd",size:13,"icon-class":"icon-tips"}}),s("span",{staticClass:"text-tip"},[t._v(t._s(t.$t("micro.aiCourse.createInstruction")))])],1)]),s("div",{staticClass:"content"},[s("vue-cropper",{ref:"cropper",staticClass:"cropper",attrs:{"auto-crop":"",info:!1,"fixed-box":!0,"can-move-box":!1,"center-box":!0,fixed:!0,img:t.sourceUrl}})],1),s("div",{staticClass:"footer"},[s("div",{staticClass:"cancel",on:{click:t.cancel}},[t._v(t._s(t.$t("micro.aiCourse.cancel")))]),s("van-button",{staticClass:"small-btn",attrs:{type:"primary",disabled:t.confirmDisabled,color:t.primaryColor},on:{click:t.confirm}},[t._v(t._s(t.$t("micro.aiCourse.confirm")))])],1)],1)}),[],!1,null,"759719b4",null).exports,_={components:{VanImage:r.Z,AvatarCropper:y,SvgIcon:l.Z,GuidePanel:p,VanPopup:o.Z},props:{portraitStyles:{type:Array,default:()=>[]},canDelete:{type:Boolean,default:()=>!1}},data:()=>({AI_COURSE_CORE_ID:m.eM,cropperShow:!1,cropperSourceUrl:"",showActiveBorder:!1,showGuidePanel:!1}),computed:(0,i.Z)((0,i.Z)({},(0,n.mapGetters)({primaryColor:"getPrimaryColor",aiCourseInfo:"microCourse/getAiCourseInfo",aiCourseNewFlag:"microCourse/getAiCourseNewFlag"})),{},{canUploadCount(){const t=m.yq-this.aiCourseInfo[m.eM.portrait].length;return t>0?t:0}}),mounted(){this.getAiCourseNewFlagAction({type:m.qQ.firstShowPersonSelectGuide})},methods:(0,i.Z)((0,i.Z)({},(0,n.mapActions)({getPortraitStylesAction:"microCourse/getPortraitStylesAction",updateAiCourseAction:"microCourse/updateAiCourseAction",deleteAiCourseResourceAction:"microCourse/deleteAiCourseResourceAction",postAiCourseNewFlagAction:"microCourse/postAiCourseNewFlagAction",getAiCourseNewFlagAction:"microCourse/getAiCourseNewFlagAction"})),{},{handlePortraitClick(t){!this.canDelete&&this.updateAiCourseAction({currentPortrait:t})},handleUploadClick(){this.canUploadCount<=0?this.$toast(this.$t("micro.aiCourse.forbidUploadTip",{count:m.yq-4})):this.aiCourseNewFlag.firstShowPersonSelectGuide?this.showGuidePanel=!0:this.handleChooseImage()},handleGuidePanelConfirm(){this.showGuidePanel=!1},handlePopupClose(){this.postAiCourseNewFlagAction({type:m.qQ.firstShowPersonSelectGuide})},handleChooseImage(){v.I.call(this,(t=>{this.cropperSourceUrl=t,this.cropperShow=!0}))},handleRemoveCropper(){this.cropperShow=!1},handleConfirmCropper(){this.cropperShow=!1},handlePortraitDelete(t){const e=(0,i.Z)({},this.aiCourseInfo.currentPortrait);this.updateAiCourseAction({currentPortrait:t}),this.showActiveBorder=!0,a.Z.confirm({message:this.$t("micro.aiCourse.confirmDelete")}).then((()=>{this.deleteAiCourseResourceAction({config_type:"portrait",id_list:[t.id]}),this.showActiveBorder=!1})).catch((()=>{this.showActiveBorder=!1,this.updateAiCourseAction({currentPortrait:e})}))}})},C=(0,h.Z)(_,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"portrait-styles"},[s("van-popup",{style:{height:"560px"},attrs:{position:"bottom",closeable:"",round:"","lock-scroll":!1},on:{close:t.handlePopupClose},model:{value:t.showGuidePanel,callback:function(e){t.showGuidePanel=e},expression:"showGuidePanel"}},[s("guide-panel",{on:{confirm:t.handleGuidePanelConfirm}})],1),t.cropperShow?s("avatar-cropper",{staticClass:"avatar-cropper",attrs:{"source-url":t.cropperSourceUrl},on:{remove:t.handleRemoveCropper,confirm:t.handleConfirmCropper}}):t._e(),s("div",{staticClass:"portrait-styles-upload-item"},[s("label",[s("div",{staticClass:"uploader",on:{click:t.handleUploadClick}},[s("svg-icon",{attrs:{"icon-class":"icon-icon-add",size:16,color:"rgba(0, 0, 0, 0.25)"}}),t.canDelete?s("i18n",{staticClass:"uploader-tip",attrs:{path:"micro.aiCourse.canUploadCount"}},[s("span",{staticClass:"count"},[t._v(t._s(t.canUploadCount))])]):t._e()],1)])]),t._l(t.portraitStyles,(function(e){return s("div",{key:e.index,staticClass:"portrait-styles-item",class:{"portrait-styles-item-active":e===t.aiCourseInfo.currentPortrait&&(!t.canDelete||t.showActiveBorder)}},[s("van-image",{staticClass:"portrait-image",attrs:{src:t._f("toHttps")(e.url),radius:"5"},on:{click:function(s){return t.handlePortraitClick(e)}}}),t.canDelete?s("div",{staticClass:"delete-marker",on:{click:function(s){return t.handlePortraitDelete(e)}}},[s("svg-icon",{attrs:{"icon-class":"icon-guanbi",color:"white"}})],1):t._e()],1)}))],2)}),[],!1,null,"85aeea44",null).exports},82642:(t,e,s)=>{s.r(e),s.d(e,{default:()=>c});var a=s(95082),i=s(52619),o=s(26294),r=s(49017),n={components:{BasePerson:i.Z},data:()=>({AI_COURSE_CORE_ID:r.eM}),computed:(0,a.Z)({},(0,o.mapGetters)({primaryColor:"getPrimaryColor",aiCourseInfo:"microCourse/getAiCourseInfo"}))},c=(0,s(1001).Z)(n,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("base-person",{attrs:{"portrait-styles":t.aiCourseInfo[t.AI_COURSE_CORE_ID.portrait]}})}),[],!1,null,"9efbf6d8",null).exports},25882:(t,e,s)=>{s.r(e),s.d(e,{default:()=>c});var a=s(95082),i=s(52619),o=s(26294),r=s(49017),n={components:{BasePerson:i.Z},data:()=>({AI_COURSE_CORE_ID:r.eM}),computed:(0,a.Z)({},(0,o.mapGetters)({primaryColor:"getPrimaryColor",aiCourseInfo:"microCourse/getAiCourseInfo"}))},c=(0,s(1001).Z)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},[s("base-person",{attrs:{"portrait-styles":t.aiCourseInfo[t.AI_COURSE_CORE_ID.portrait].filter((function(t){return!t.is_default})),"can-delete":!0}})],1)}),[],!1,null,"4970ad58",null).exports},95983:(t,e,s)=>{s.d(e,{Z:()=>b});var a=s(95082),i=(s(47601),s(44951)),o=(s(70885),s(6458)),r=(s(18144),s(65641)),n=(s(3791),s(93432)),c=(s(29941),s(64168)),l=(s(52355),s(29233)),u=(s(49902),s(62094)),d=(s(21920),s(58280)),h=(s(19465),s(74912)),p=s(55595),m=s(82820),g=s(78368),v=s(74612),f=s(57020),y=s(26294),_=s(36812),C=s(45877),I={name:"SelectTeacher",components:{CommonPopup:_.Z,[h.Z.name]:h.Z,[d.Z.name]:d.Z,[u.Z.name]:u.Z,[l.Z.name]:l.Z,[c.Z.name]:c.Z,[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,ClCustomUser:C.Z},props:{show:Boolean},data:function(){return{man:v,woman:f,defaultAvatar:g,active:0,loading:!1,levelList:[],teacherList:[]}},computed:(0,a.Z)({},(0,y.mapGetters)({microInfo:"microCourse/getMicroCourseInfo",primaryColor:"getPrimaryColor"})),mounted(){this.getTeacherLevel()},methods:{getTeacherLevel(){p.Z.getTeacherLevel().then((t=>{this.levelList=(0,m.IL)(t.data.list),this.getTeacherList("")}))},getTeacherList(t){this.loading=!0,this.teacherList=[],p.Z.getTeacherList({level:t}).then((t=>{this.teacherList=t.data.list,this.loading=!1}))},closeTeacher(){this.$emit("closeTeacher")},clickNav(t){const e=this.levelList[t].id;this.getTeacherList(e)},changeLecture(t){this.$emit("select",t),this.closeTeacher()}}},b=(0,s(1001).Z)(I,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"micro-select-teacher"},[s("common-popup",{attrs:{show:t.show,"over-height":400},on:{closePopup:t.closeTeacher},scopedSlots:t._u([{key:"content",fn:function(){return[s("van-tree-select",{attrs:{height:"100%",items:t.levelList,"main-active-index":t.active},on:{"update:mainActiveIndex":function(e){t.active=e},"update:main-active-index":function(e){t.active=e},"click-nav":t.clickNav},scopedSlots:t._u([{key:"content",fn:function(){return[s("van-radio-group",{model:{value:t.microInfo.teacher_id,callback:function(e){t.$set(t.microInfo,"teacher_id",e)},expression:"microInfo.teacher_id"}},[s("van-cell-group",t._l(t.teacherList,(function(e){return s("van-cell",{key:e.id,attrs:{value:e.lecturer_name,clickable:""},on:{click:function(s){return t.changeLecture(e)}},scopedSlots:t._u([{key:"icon",fn:function(){return[s("van-radio",{attrs:{"icon-size":16,name:e.id}})]},proxy:!0},{key:"default",fn:function(){return[s("van-row",{staticClass:"micro-select-teacher-row",attrs:{gutter:"10"}},[s("van-col",{attrs:{span:"8"}},[s("div",{staticClass:"micro-select-teacher-avatar"},[s("van-image",{attrs:{height:"100%",width:"100%",radius:"4px",fit:"cover",src:""===e.avatar?t.defaultAvatar:e.avatar}}),s("div",{staticClass:"micro-select-teacher-avatar-sex"},[s("van-image",{attrs:{height:"100%",width:"100%",fit:"cover",src:0===e.sex?t.man:t.woman}})],1)],1)]),s("van-col",{attrs:{span:"16"}},[s("p",{staticClass:"micro-select-teacher-name"},["inside"===e.type?s("cl-custom-user",{attrs:{type:e.lecturer_source_type,"data-type":"userName",value:e.lecturer_sync_user_id,name:e.lecturer_name}}):s("span",[t._v(t._s(e.lecturer_name))])],1),s("p",{staticClass:"micro-select-teacher-count"},[t._v(t._s(t.$t("micro.taught"))+"："+t._s(e.course_count))])])],1)]},proxy:!0},{key:"extra",fn:function(){return[s("div",{staticClass:"micro-select-teacher-lecturer"},[t._v(" "+t._s(e.level_name?e.level_name:t.$t("micro.noLecturer"))+" ")])]},proxy:!0}],null,!0)})})),1)],1)]},proxy:!0}])}),t.loading?s("div",{staticClass:"micro-select-teacher-loading"},[s("van-loading",{attrs:{color:t.primaryColor}})],1):t._e()]},proxy:!0}])})],1)}),[],!1,null,"04a9dae9",null).exports},10898:(t,e,s)=>{s.d(e,{Z:()=>c});var a=s(95082),i=(s(33948),s(57658),s(76953)),o=s(36812),r=s(55595),n={name:"SelectClassify",components:{CommonPopup:o.Z,ClChooseUser:i.Z},props:{showVisible:Boolean,courseInfo:{type:Object,default:()=>({id:"",type:"",visible_count:0})}},data:function(){return{config:{multiple:!0,limitTips:"",pickedUsers:[],pickedDepartments:[],disabledUsers:[],disabledDepartments:[],requiredUsers:[],requiredDepartments:[],responseUserOnly:!1,startWithDepartmentId:"",asyncLoad:!0,filterAuth:!0},visible:!1}},watch:{showVisible(t){t&&this.getCourseVisibleRange()}},mounted(){},methods:{async getCourseVisibleRange(){const{id:t,visible_count:e}=this.courseInfo;if(!t||!e)return void(this.visible=!0);const[s,i]=await r.Z.getMicroVisibleRange(t);if(!s){const t={pickedUsers:i.data.users||[],pickedDepartments:i.data.departments||[]};this.config=(0,a.Z)((0,a.Z)({},this.config),t)}this.visible=!0},handleOk(t){this.config.multiple?(this.config.pickedUsers=t.users||[],this.config.pickedDepartments=t.departments||[]):this.config.pickedUsers.push(t.users);let e=[],s=[];this.config.pickedDepartments.forEach((t=>{e.push(t.id)})),this.config.pickedUsers.forEach((t=>{s.push(t.id)})),this.$emit("select",{count:t.selectedCount,selDeptIds:e,selUserIds:s}),this.$emit("closeVisible")},handleCancel(){this.$emit("closeVisible")},closeVisible(){this.$emit("closeVisible")}}},c=(0,s(1001).Z)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"micro-select-classify"},[s("common-popup",{attrs:{show:t.showVisible,"over-height":600},on:{closePopup:t.closeVisible},scopedSlots:t._u([{key:"content",fn:function(){return[t.visible?s("ClChooseUser",{attrs:{config:t.config},on:{onSuccess:t.handleOk,cancel:t.handleCancel}}):t._e()]},proxy:!0}])})],1)}),[],!1,null,"ee537874",null).exports},18939:(t,e,s)=>{s.r(e),s.d(e,{default:()=>c});var a=s(95082),i=(s(47601),s(44951)),o=s(26294),r=s(49017),n={components:{VanImage:i.Z},props:{},data:()=>({AI_COURSE_CORE_ID:r.eM,audio:null}),computed:(0,a.Z)({},(0,o.mapGetters)({primaryColor:"getPrimaryColor",aiCourseInfo:"microCourse/getAiCourseInfo"})),destroyed(){this.audio&&this.audio.pause()},methods:(0,a.Z)((0,a.Z)({},(0,o.mapActions)({updateAiCourseAction:"microCourse/updateAiCourseAction"})),{},{handleVoiceClick(t){this.audio&&this.audio.pause(),this.audio=new Audio(t.url),this.audio.play(),this.updateAiCourseAction({currentVoice:t})}})},c=(0,s(1001).Z)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"voice-styles"},t._l(t.aiCourseInfo[t.AI_COURSE_CORE_ID.voice],(function(e){return s("div",{key:e.url,staticClass:"voice-styles-item",class:{"voice-styles-item-active":e===t.aiCourseInfo.currentVoice},on:{click:function(s){return t.handleVoiceClick(e)}}},[s("div",{staticClass:"voice-container"},[s("van-image",{staticClass:"avatar",attrs:{src:e.icon}}),s("div",{staticClass:"info"},[s("div",{staticClass:"name"},[t._v(t._s(e.name))])]),s("div",{staticClass:"sound",class:{"sound-active":e===t.aiCourseInfo.currentVoice}},[e===t.aiCourseInfo.currentVoice?s("svg-icon",{attrs:{"icon-class":"icon-shengyinbofang",color:"rgba(81, 106, 230, 1)",size:12}}):s("svg-icon",{attrs:{"icon-class":"icon-shengyin",color:"rgba(45, 48, 64, 0.65)",size:12}})],1)],1)])})),0)}),[],!1,null,"07e3e9d9",null).exports},29037:(t,e,s)=>{s.r(e),s.d(e,{default:()=>i});var a={data:()=>({})},i=(0,s(1001).Z)(a,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},["en"===t.$i18n.locale?s("div",[t._v("EN")]):"zh-hk"===t.$i18n.locale?s("div",[t._v("HK")]):s("div",{staticClass:"item"},[s("p",{staticClass:"title"},[t._v("「课件开发工具」用户协议")]),s("p",[t._v(" 欢迎你使用本课件开发工具（以下简称「本工具」）。本工具由酷渲（北京）科技有限公司（以下简称「酷渲」）开发，为酷渲用户（以下可能称为「用户」或「你」）提供制作音视频课件的服务。")]),s("p",[t._v(" 为使用本工具，你应当阅读并遵守《「课件开发工具」用户协议》（以下简称「本协议」）》、《酷渲隐私协议》等与本工具或酷渲相关的各项平台/工具规范。")]),s("p",[t._v(" 请你务必审慎阅读、充分理解本协议各条款内容，特别是免除或限制责任的相应条款。限制、免责条款可能以加粗形式提示你注意。未成年人应在法定监护人的陪同下阅读本协议。")]),s("p",[t._v(" 你以任何形式使用本工具，都将视为你已阅读并同意接受本协议的约束。如果你对本协议的任何条款表示异议，你可以选择不使用本工具。酷渲有权在必要时单方修改本协议，相关内容变更后，如果你继续使用本工具，即视为你已接受修改后的相关内容。如果你不接受修改后的相关内容，应当停止使用本工具。")]),s("p",{staticClass:"title"},[t._v(" 1.关于本工具")]),s("p",[t._v(" 1.1本工具旨在使用户更加方便快捷地将用户已上传、发布的素材内容、课程制作转换成视频内容、将个人形象制作成模拟讲师授课视频内容，用户可选择发布在酷渲平台，也可选择不发布。")]),s("p",[t._v(" 1.2为促进文化交流和传播、提高用户创作的积极性，本工具为用户提供了部分视频创作中可能会使用的素材，具体类型包括：图片、字体、表情包、GIF动图、背景音乐等。用户可使用的素材类型以本工具在不同时期具体展示的为准。")]),s("p",{staticClass:"title"},[t._v(" 2.使用说明")]),s("p",[t._v(" 2.1如你需要使用本工具，你的酷渲帐户[请确认是否涉及，如不涉及请删除][保留条款]或你发布的内容需满足一定的使用条件，具体以本工具实时要求的为准。")]),s("p",[t._v(" 2.2你可免费使用本工具提供的创作素材，用于制作视频课件。但你无权将本工具提供的素材用于其他目的或其他平台，且你无权将制作完成的视频直接发布在除酷渲之外的其他平台（酷渲本身允许用户分享、转发的平台除外）。")]),s("p",[t._v(" 2.3本工具将陆续推出「声音采集与复刻」、「AI配音」等语音定制功能。前述功能实际上线后可能会改变名称，但具体功能名称的改变不影响功能的实际使用。")]),s("p",[t._v(" 2.3.1自定义形象功能")]),s("p",[t._v(" （1）本工具开通「自定义形象」功能的，则届时在你使用本功能时，本工具将根据你上传的人物图片，通过技术分析，加工合成为视频课件中展示的虚拟讲师形象。你在制作视频过程中，可以使用该形象模型进行授课。")]),s("p",[t._v(" （2）该功能需要你本人确认将合法照片上传，仅用作虚拟讲师形象功能，除非你主动分享，否则仅供你个人可用。我们将按业界成熟的安全标准，采取安全保护措施以保障你的信息安全。")]),s("p",[t._v(" （3）请你知悉，每位用户生成的专属语音模型仅限该用户使用，其他任何用户均无法使用。未经用户同意，酷渲也不会将用户的专属语音模型授予任何第三方使用。")]),s("p",[t._v(" （4）请你知悉，您所使用的讲师形象必须以合法为前提，任何未经授权的他人形象或不符合3.1条款的形象，将视为您个人违约行为，酷渲不承担任何法律责任。未经用户同意，酷渲也不会将用户的专属形象模型授予任何第三方使用。")]),s("p",[t._v(" 2.3.2录音功能")]),s("p",[t._v(" （1）如本工具开通「录音」功能的，则届时你可通过本功能直接录制音频、旁白等，这需要你开通录音权限（麦克风权限），酷渲将在获取你的明确同意后使用此权限。")]),s("p",[t._v(" （2）你需根据该功能指引操作。录音完成后，你可对形成的音频文件在音色、语速、语调、音量等方面进行个性化设置，并可删除或重新录音。")]),s("p",[t._v(" 2.3.3声音复刻功能")]),s("p",[t._v(" （1）如本工具开通「声音复刻」功能的，则届时在你使用本功能时，本工具将根据你已录制完毕的音频文件，通过技术分析，加工合成你的专属语音。你在制作视频过程中，可以使用该语音模型进行配音。")]),s("p",[t._v(" （2）该功能需要你本人朗读并录制特定篇幅的话术（话术内容由本工具提供），录制完成后将进行技术加工。该功能需获取你的麦克风权限并进行环境噪音检测，权限获取将仅用作录制、不做他用。已录制的话术，仅用作声音复刻功能，除非你主动分享，否则仅供你个人可用。我们将按业界成熟的安全标准，采取安全保护措施以保障你的信息安全。（3）请你知悉，每位用户生成的专属语音模型仅限该用户使用，其他任何用户均无法使用。未经用户同意，酷渲也不会将用户的专属语音模型授予任何第三方使用。")]),s("p",{staticClass:"title"},[t._v(" 3.用户行为规范")]),s("p",[t._v(" 3.1用户使用本工具及相关工具应自觉遵守宪法、法律、法规、遵守公共秩序，尊重社会公德、社会主义制度、国家利益、公民合法权益、道德风尚和信息真实性等要求。用户不得使用本工具及相关工具录制、制作、发布、传播含有下列内容的信息：")]),s("p",[t._v(" （1）反对宪法确定的基本原则的；")]),s("p",[t._v(" （2）危害国家安全，泄露国家秘密的；")]),s("p",[t._v(" （3）颠覆国家政权，推翻社会主义制度、煽动分裂国家、破坏国家统一的；")]),s("p",[t._v(" （4）损害国家荣誉和利益的；")]),s("p",[t._v(" （5）宣扬恐怖主义、极端主义的；")]),s("p",[t._v(" （6）宣扬民族仇恨、民族歧视，破坏民族团结的；")]),s("p",[t._v(" （7）煽动地域歧视、地域仇恨的；")]),s("p",[t._v(" （8）破坏国家宗教政策，宣扬邪教和迷信的；")]),s("p",[t._v(" （9）编造、散布谣言、虚假信息，扰乱经济秩序和社会秩序、破坏社会稳定的；")]),s("p",[t._v(" （10）散布、传播暴力、淫秽、色情、赌博、凶杀、恐怖或者教唆犯罪的；")]),s("p",[t._v(" （11）侵害未成年人合法权益或者损害未成年人身心健康的；")]),s("p",[t._v(" （12）未获他人允许，偷拍、偷录他人，侵害他人合法权利的；")]),s("p",[t._v(" （13）包含恐怖、暴力血腥、高危险性、危害他人身心健康内容的；")]),s("p",[t._v(" （14）危害网络安全、利用网络从事危害国家安全、荣誉和利益的；")]),s("p",[t._v(" （15）侮辱或者诽谤他人，侵害他人合法权益的；")]),s("p",[t._v(" （16）对他人进行暴力恐吓、威胁，实施人肉搜索的；")]),s("p",[t._v(" （17）涉及他人隐私、个人信息或资料的；")]),s("p",[t._v(" （18）散布污言秽语，损害社会公序良俗的；")]),s("p",[t._v(" （19）侵犯他人隐私权、名誉权、肖像权、知识产权等合法权益内容的；")]),s("p",[t._v(" （20）散布商业广告，或类似的商业招揽信息、过度营销信息及垃圾信息；")]),s("p",[t._v(" （21）其他违反法律法规、政策及公序良俗、干扰酷渲正常运营或侵犯其他用户或第三方合法权益内容的其他信息。")]),s("p",[t._v(" 3.2为营造文明健康、规范有序的网络环境，你应遵循本协议和酷渲的相关平台规则，守法、友善地使用本功能。酷渲有权依据站内的各项规则对你发布的内容进行审核、处理。")]),s("p",[t._v(" 3.3如你发布的内容被酷渲其他用户抄袭或未授权使用的，你可以通过酷渲站内的投诉规则和流程进行投诉，酷渲将按照站内规则及时处理。")]),s("p",{staticClass:"title"},[t._v(" 4.知识产权约定")]),s("p",[t._v(" 4.1酷渲在本工具中提供的素材内容，用户均可使用[提示：我们要确保提供内容不侵权][肯定，在提供的素材都是有版权或者我们独立设计授权用户使用的。]。酷渲保证用户依据本协议使用该素材的行为不会使用户招致任何第三方的权利主张。")]),s("p",[t._v(" 4.2本工具的软件著作权、专利权及其他知识产权均归酷渲所有。未经酷渲许可，任何人不得擅自使用（包括但不限于通过任何机器人、“蜘蛛”等程序或设备监视、复制、传播、展示、镜像、上载、下载）本工具及相关工具中的内容。")]),s("p",[t._v(" 4.3你理解并承诺，你在使用本工具及相关工具时发布、上传的内容（包括但不限于文字、图片、视频、音频等各种形式的内容及其中包含的音乐、声音、台词、视觉设计等所有组成部分）均由你原创或已获合法授权（且含转授权）。你通过本工具上传、发布所产生内容的知识产权归属你或原始著作权人所有，并且该内容不会侵犯任何第三方的合法权益。如你违反世界版权公约、中华人民共和国著作权法、商标法、专利法、反不正当竞争法及其他与知识产权方面相关的法律法规或本协议约定，你应自行承担因此而给他人（包括酷渲）造成的损害，承担相应的法律责任。")]),s("p",[t._v(" 4.4你知悉、理解并同意，为使作品得到更好的分享及推广，提高其传播价值及影响力，你通过本工具及相关工具上传、发布或传输的内容（包括但不限于文字、图像、音频、视频等各种形式的内容及其中包括的音乐、声音、台词、视觉设计、对话等所有组成部分），你授予酷渲及其关联方、控制公司、继承公司一项全球范围内、免费、非独家、可再许可（通过多层次）的权利（包括但不限于复制权、翻译权、汇编权、信息网络传播权、改编权及制作衍生品、表演和展示的权利等），上述权利的使用范围包括但不限于在当前或其他网站、应用程序、产品或终端设备等使用。你在此确认并同意，酷渲有权自行或许可第三方在与上述内容、本工具及相关工具、酷渲和/或酷渲品牌有关的任何宣传、推广、广告、营销和/或研究中使用和以其他方式开发内容（全部或部分），以及出于保护你个人信息或隐私安全的目的将上述内容署名为酷渲用户。[请确认是否涉及，如不涉及可删除][涉及]为避免疑义，你理解并同意，上述授予的权利包括使用、复制和展示你拥有或被许可使用并植入内容中的个人形象、肖像、姓名、商标、工具标志、品牌、名称、标识和公司标记（如有）以及任何其他品牌、营销或推广资产、物料、素材等的权利和许可。")]),s("p",[t._v(" 4.5你理解并同意，基于本工具的特性，你通过本工具及相关工具发布的内容（包括但不限于内容中包含的声音、音频或对话等），你有权将你在本工具发布的内容授权给他人使用。酷渲欢迎你优先选择酷渲就相关内容进行合作。")]),s("p",[t._v(" 4.6你确认并同意授权酷渲以自己的名义或委托专业第三方对侵犯你上传发布的享有知识产权的内容进行代维权，维权形式包括但不限于：监测侵权行为、发送维权函、提起诉讼或仲裁、调解、和解等，酷渲有权对维权事宜做出决策并独立实施。")]),s("p",[t._v(" 4.7请你在任何情况下都不要私自使用酷渲的任何商标、工具标记、商号、域名、网站名称或其他显著品牌特征等（以下统称为“标识”）。未经酷渲事先书面同意，你不得将本条款前述标识以单独或结合任何方式展示、使用或申请注册商标、进行域名注册等，也不得实施向他人明示或暗示有权展示、使用、或其他有权处理该些标识的行为。由于你违反本协议使用酷渲上述商标、标识等给酷渲或他人造成损失的，由你承担全部法律责任。")]),s("p",{staticClass:"title"},[t._v(" 5.未成年人使用条款")]),s("p",[t._v(" 如你是未满18周岁的未成年用户，在使用酷渲的产品或服务前，你应在监护人的监护、指导下阅读本协议，并在征得你的监护人对本协议的同意后，使用酷渲的产品或服务，你及你的监护人应按照法律及本协议规定承担责任。如果你是未成年用户的监护人，请你仔细阅读和审慎选择是否同意本协议。")]),s("p",{staticClass:"title"},[t._v(" 6.其他约定")]),s("p",[t._v(" 6.1酷渲在目前技术水平下将尽力确保本工具的连贯性和安全性，最大程度地保障本工具的正常运行。但由于不可抗力、病毒、木马、黑客攻击、系统不稳定、通信线路故障、第三方工具瑕疵、政府行为等原因可能导致的运行中断、数据丢失以及其他的损失和风险，是当时行业技术水平所无法避免的且酷渲无法控制的，由此给你造成的延迟和暂缓、数据或信息丢失等损失，酷渲不承担赔偿或补偿责任。")]),s("p",[t._v(" 6.2本协议的订立、效力、解释、适用、争议解决等一切事宜，均适用中华人民共和国大陆地区法律。因本协议存在任何争议的，双方应友好协商解决；协商不成的，任何一方均有权将争议提交至北京市朝阳区人民法院审理解决。")]),s("p",[t._v(" 6.3关于本工具的各种规则、通知、提示等信息，酷渲可能会以网页公告、网页提示、电子邮箱、手机短信、用户注册的酷渲帐户的管理系统内发送站内信等方式中的一种或多种，向你送达。该等信息一经酷渲采取前述任何一种方式公布或发送，即视为你已经接受并同意，对你产生约束力。若你不接受的，你可以立即停止使用本工具。")]),s("p",[t._v(" 6.4国际使用之特别告知：你已了解互联网的无国界性，同意遵守当地所有关于网上行为及内容之法律法规。你特别同意遵守有关从中国或你所在国家或地区输出信息之传输的所有适用法律法规。")]),s("p",[t._v(" 6.5酷渲未行使或执行本使用协议任何权利或规定，不构成对前述权利或权利之放弃。")]),s("p",[t._v(" 6.6你有权就使用本工具时产生的问题向酷渲提出意见，酷渲会尽快响应。如该问题能及时解决的，酷渲将及时协助你解决相应问题。")]),s("p",[t._v(" 6.7本使用协议之标题仅供方便而设，不具任何法律或契约效果。")]),s("p",{staticClass:"title"},[t._v(" 7.联系方式")]),s("p",[t._v(" 可以通过客服热线400-837-0888与我们联系，您也可以选择通过邮件的方式联系我们，联系信息及地址如下：")]),s("p",[t._v(" 酷渲（北京）科技有限公司")]),s("p",[t._v(" 联系部门：客服部[联系客服]")]),s("p",[t._v(" 电子邮箱：support@coolcollege.cn[确认邮箱]")]),s("p",[t._v(" 联系地址：北京市朝阳区太阳宫中路12号冠城大厦1201室")]),s("p",[t._v(" 最新更新时间：2022年4月19日")])])])}),[],!1,null,"87951a36",null).exports},45693:(t,e,s)=>{s.r(e),s.d(e,{default:()=>Q});s(31146);var a=s(41610),i=(s(34837),s(39146)),o=s(95082),r=(s(45125),s(2282)),n=(s(25773),s(35791)),c=(s(49902),s(62094)),l=(s(21920),s(58280)),u=(s(73474),s(74755)),d=(s(22894),s(83608)),h=(s(47601),s(44951)),p=(s(18144),s(65641)),m=(s(70885),s(6458)),g=(s(93787),s(20090)),v=(s(77141),s(30960)),f=(s(26699),s(33948),s(32023),s(57658),s(74916),s(15306),s(26294)),y=s(27632),_=s(22648),C=s(68092),I=s(70315),b=s(49017),w=s(72244),$=s(5141),k=s(55595),S=s(88095),T=s(36812),Z=(s(58247),s(85573)),x={name:"SelectClassify",components:{Classify:s(45494).Z,CommonPopup:T.Z,[Z.Z.name]:Z.Z},props:{showClassify:Boolean},data:function(){return{classifyList:[],visible:!1,fieldNames:{text:"name",value:"id",children:"children"},selectOption:{}}},computed:(0,o.Z)({},(0,f.mapGetters)({microInfo:"microCourse/getMicroCourseInfo",primaryColor:"getPrimaryColor"})),watch:{showClassify(t){t||(this.selectOption={})}},mounted(){},methods:{handleChange(t){this.result=[...t],this.result.length>0?this.selectOption=t[t.length-1]:this.selectOption={}},handleOk(){this.selectOption.id&&this.$emit("select",this.selectOption),this.closeClassify()},closeClassify(){this.$emit("closeClassify")}}},P=s(1001),D=(0,P.Z)(x,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"micro-select-classify"},[s("common-popup",{attrs:{show:t.showClassify,"over-height":400},on:{closePopup:t.closeClassify},scopedSlots:t._u([{key:"content",fn:function(){return[s("classify",{attrs:{"show-all":!1,auth_type:"edit"},on:{change:t.handleChange}}),s("div",{staticClass:"classify-footer"},[s("div",{staticClass:"cancel-btn",on:{click:t.closeClassify}},[t._v(t._s(t.$t("common.cancel")))]),s("div",{staticClass:"confirm-btn",on:{click:t.handleOk}},[t._v(t._s(t.$t("common.confirm")))])])]},proxy:!0}])})],1)}),[],!1,null,"471de85a",null).exports,L=s(95983),A=s(10898),E=(s(23307),s(81392)),R={name:"VideoCard",components:{[h.Z.name]:h.Z,Icon:E.Z},props:{cover:{type:String,default:""},duration:{type:String,default:"00:00:00"}},data:()=>({defaultCover:"https://oss.coolcollege.cn/1789887486743416832.png"}),computed:(0,o.Z)({},(0,f.mapGetters)({microInfo:"microCourse/getMicroCourseInfo",primaryColor:"getPrimaryColor"})),mounted(){},methods:{handleDel(){this.$emit("onDelete")},handlePlay(){const t=this.microInfo.resources[0].resource_id||this.microInfo.resources[0].id;this.getResourceStatusVideo(t)},getResourceStatusVideo(t){k.Z.getResourceStatusVideo(t).then((t=>{const{status:e}=t.data;"Running"!==e?"Finished"!==e?(0,i.Z)(this.$t("attestation.transcodingFailure")):this.$router.push("/micro-watch/0/newest?studyType=preview&currentType=video"):(0,i.Z)(this.$t("upload.transcodingPlayerTip"))}))}}},F=(0,P.Z)(R,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"cl-video-card"},[s("van-image",{staticClass:"cl-video-card__cover",attrs:{radius:"8",src:t.cover||t.defaultCover,fit:"cover"}}),s("Icon",{staticClass:"cl-video-card__close",attrs:{name:"cross",size:"20",color:"#B7BAC8"},on:{click:t.handleDel}}),s("Icon",{staticClass:"cl-video-card__play",attrs:{name:"play-circle",size:"40"},on:{click:t.handlePlay}}),s("span",{staticClass:"cl-video-card__duration"},[t._v(t._s(t.duration))])],1)}),[],!1,null,"20886769",null).exports,q={name:"MicroAddResource",components:{Icon:E.Z},data:()=>({isXSF:(0,C.UI)("IS_XIONG_SHI_FU")&&"app"===y.Z.env}),methods:{handleUpload(){this.$emit("onUploadResources")}}},N=(0,P.Z)(q,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"micro-add-recources"},[s("div",{staticClass:"plus-btn",on:{click:t.handleUpload}},[s("Icon",{attrs:{name:"plus",size:"16",color:"#A9A9A9"}})],1),s("div",{staticClass:"warm-tip"},[s("div",[t._v(t._s(t.$t("common.reminder"))+"：")]),s("div",[t._v(t._s(t.$t("micro.saveTipContent",{num:t.isXSF?500:200})))]),s("div",[t._v(t._s(t.$t("micro.saveTipContentTwo")))])])])}),[],!1,null,"5b27742a",null).exports,O=s(78551),M={components:{[h.Z.name]:h.Z,Icon:E.Z,SvgIcon:O.Z},props:{showVoiceDelete:{type:Boolean,default:!1},cover:{type:String,default:"https://oss.coolcollege.cn/1799458672905162752.jpg"},index:{type:Number,default:0},duration:{type:String,default:"00:00:00"}},data:()=>({checked:!1}),methods:{handleSelDelImg(){this.$emit("deleteImg",this.index),this.checked=!this.checked},handleDetail(){this.$emit("detailImg",this.index)}}},B=(0,P.Z)(M,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"voice-img-card"},[s("van-image",{staticClass:"cl-video-card__cover",attrs:{radius:"8",src:t.cover,fit:"cover"},on:{click:t.handleDetail}}),s("div",{staticClass:"record-status"},[t.duration?s("SvgIcon",{staticClass:"img-attention",attrs:{color:"#fff","icon-class":"icon-icon-m1"}}):s("van-image",{staticClass:"img-attention",attrs:{src:"https://oss.coolcollege.cn/1797333027379089408.png"}}),s("span",{staticClass:"tx"},[t._v(t._s(t.duration?t.duration:t.$t("micro.noAudio")))])],1),s("div"),t.showVoiceDelete?s("span",[t.checked?s("Icon",{staticClass:"select-btn active",attrs:{name:"success",size:"16",color:"#fff"},on:{click:t.handleSelDelImg}}):s("span",{staticClass:"select-btn",on:{click:t.handleSelDelImg}})],1):t._e()],1)}),[],!1,null,"0413194d",null).exports,V={components:{Icon:E.Z,ImgCard:B},props:{showVoiceDelete:{type:Boolean,default:!1}},data:()=>({deleteList:[]}),computed:(0,o.Z)({},(0,f.mapGetters)({microInfo:"microCourse/getMicroCourseInfo",primaryColor:"getPrimaryColor"})),watch:{showVoiceDelete(t){t&&(this.deleteList=[])}},methods:{funDurationFormat(t){let e=0;return t.forEach((t=>{t.duration&&(e+=Number(t.duration))})),(0,_.WJ)(e,this)},funChooseImg(){this.$emit("chooseImages",30-this.microInfo.resources.length,"","voice")},deleteImg(t){-1===this.deleteList.indexOf(t)?this.deleteList.push(t):this.deleteList.splice(this.deleteList.indexOf(t),1),this.$emit("deleteVoice",this.deleteList)},detailImg(t){this.$router.push({path:"/micro-edit-voice",query:{index:t}})}}},U=(0,P.Z)(V,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"voice-resources"},[t._l(t.microInfo.resources,(function(e,a){return s("ImgCard",{key:a+"_"+(new Date).getTime(),attrs:{index:a,cover:e.cover,duration:t.funDurationFormat(e.audios),"show-voice-delete":t.showVoiceDelete},on:{deleteImg:t.deleteImg,detailImg:t.detailImg}})})),t.microInfo.resources.length<30?s("div",{staticClass:"plus-btn",on:{click:t.funChooseImg}},[s("Icon",{attrs:{name:"plus",size:"16",color:"#A9A9A9"}})],1):t._e()],2)}),[],!1,null,"0e90c0d0",null).exports,j=s(39145),z=s(56767),H=s(71522),G={name:"MicroCreate",components:{[v.Z.name]:v.Z,[g.Z.name]:g.Z,[m.Z.name]:m.Z,[p.Z.name]:p.Z,[h.Z.name]:h.Z,[d.Z.name]:d.Z,[u.Z.name]:u.Z,[l.Z.name]:l.Z,[c.Z.name]:c.Z,[n.Z.name]:n.Z,[r.Z.name]:r.Z,ApprovalProcess:S.default,CommonPopup:T.Z,SelectClassify:D,SelectTeacher:L.Z,SelectUser:A.Z,VideoCard:F,AddResources:N,VoiceResources:U},beforeRouteEnter(t,e,s){s((t=>{["MicroOwn","microCourseList","myself-micro-course","myself-micro-course-drafts"].includes(e.name)&&(t.initFlag=!0),t.$nextTick((()=>{t.initData()}))}))},data:()=>({showVoiceDelete:!1,voiceDeleteList:[],operateType:"",isTranscoding:!1,isSaveContent:!1,saveBtn:0,releaseBtn:0,sync_progress:!1,showPopup:!1,showClassify:!1,showVisible:!1,showTeacher:!1,coverList:b.Ns,fileNumber:0,editType:"add",initFlag:!1,isXSF:(0,C.UI)("IS_XIONG_SHI_FU")&&"app"===y.Z.env,uploader:null,currentUploadVideoDuration:0,storageConfig:{storageType:"PUBLIC_CLOUD",id:"public"},fileImages:[],fileList:[],showApprovalProcess:!1}),computed:(0,o.Z)((0,o.Z)({},(0,f.mapGetters)({userInfo:"user/getUserInfo",microInfo:"microCourse/getMicroCourseInfo",primaryColor:"getPrimaryColor"})),{},{visibleCount(){return this.microInfo.is_all&&!Number(this.microInfo.visible_count)?"全公司":this.microInfo.visible_count?this.microInfo.visible_count+this.$t("micro.peopleVisible"):""},verifyRes(){const{microInfo:t}=this;let e=0!==Number(t.visible_count);return t.is_all&&!Number(t.visible_count)&&(e=!0),!!(t.title&&t.course_classify_name&&e&&t.resources.length)},showPreview(){return!this.showVoiceDelete&&"voice"===this.operateType},showRelease(){return!this.showVoiceDelete&&("video"===this.operateType||"shoot"===this.operateType)},isDefaultAllVisible:()=>(0,C.UI)("MICRO_COMPANY_WIDE_IS_ALL")}),mounted(){this.funInitStorage();const{origin:t,type:e,status:s="add"}=this.$route.query;this.from=t,this.operateType=e,this.editType=s},destroyed(){i.Z.clear()},methods:{async funInitStorage(){const t=await $.Z.getStorageSet();this.uploader=(0,z.x)({onUpdateSuccess:this.onUpdateSuccessFile,onUploadWarning:this.onUploadFailedFile,onUploadFailed:this.onUploadFailedFile}),t&&!0===t.isDefault?(this.storageConfig=(0,o.Z)({},t),"ALIBABA_PRIVATE"===t.storageType?this.uploader.initUploader({type:"ALIBABA_PRIVATE",id:t.id}):this.uploader.initUploader()):this.uploader.initUploader()},handleSelectUser(){"wx_app"===this.userInfo.appType&&"1"===this.userInfo.authorityType?this.handleSelectWx():this.showVisible=!0},async initData(){if(this.initFlag)if("edit"===this.editType){const{id:t}=this.$route.query;await this.$store.commit("microCourse/resetMicroInfo"),await this.getCourseInfo(t)}else await this.$store.dispatch("microCourse/initialMicroCourseInfo",{is_all:this.isDefaultAllVisible?1:null})},async getCourseInfo(t){if(!t)return;const[e,s]=await k.Z.getMicroDetail({id:t});e||this.initMicroData(s.data)},initMicroData(t){t.resources.forEach((e=>{"ALIBABA_PRIVATE"===e.storage_type&&"image"===t.resource_type&&H.Z.getPrivateImgUrl(e.video_id).then((({data:t})=>{0===t.code&&(e.cover=t.data.docResourceDownloadUrl)}))})),this.$store.dispatch("microCourse/initialMicroCourseInfo",(0,o.Z)({},t))},handleClassifySelect(t){this.$store.commit("microCourse/updateMicroCourse",{course_classify_name:t.name,course_classify:t.id})},handleTeacherSelect(t){this.$store.commit("microCourse/updateMicroCourse",{teacher_id:t.id,teacher_name:t.lecturer_name,teacher_avatar:t.avatar})},handleSelectWx(){const t=(this.microInfo.user_ids||[]).map((t=>t.unionid));I.Z.chooseUserByWx({userIds:t}).then((t=>{I.Z.userHandler(t).then((t=>{const e={count:t.selectedCount,selDeptIds:t.departments.map((t=>t.id)),selUserIds:t.users.map((t=>t.id)),qy_we_chat_vo:t.qyWeChatVo,user_list:t.users.map((t=>({unionid:t.unionid,openUserId:t.openUserId})))};this.handleUserSelect(e)}))}))},handleUserSelect(t){this.$store.commit("microCourse/updateMicroCourse",{visible_count:t.count,department_ids:t.selDeptIds,user_ids:t.selUserIds,is_all:null,qy_we_chat_vo:t.qy_we_chat_vo||"",user_list:t.user_list||[]})},funDurationFormat(t){return(0,_.WJ)(t,this)},closeClassify(){this.showClassify=!1},closeVisible(){this.showVisible=!1},closeTeacher(){this.showTeacher=!1},onSubmit(t){console.error("submit",t)},selectCover(){this.showPopup=!0},closePopup(){this.showPopup=!1},updateCover(t){this.showPopup=!1,this.$store.commit("microCourse/updateCover",t)},chooseImages(t){["app"].includes(y.Z.env)?this.chooseImagesApp(t):j.w.chooseImageByInput({count:t,sourceType:["camera","album"],success:t=>{i.Z.loading({duration:0,forbidClick:!0,message:this.$t("common.uploading")}),this.fileList=t.files,this.uploader.chooseFiles({choosedFiles:t.files,notLibrary:!1})},fail:({message:t})=>{i.Z.clear(),this.$toast({message:t})}})},chooseImageCover(t=1,e="cover",s=""){const a={count:t,sourceType:["album","camera"],compressed:!0,percent:80};y.Z.chooseImage(a,(t=>{if("success"===t.status){const a=t.filePaths;this.uploadFile({data:a,origin:e,type:s})}}))},chooseImagesApp(t,e=""){const s={count:t,sourceType:["album","camera"],compressed:!0,percent:80};y.Z.chooseImage(s,(t=>{if("success"===t.status){const s=t.filePaths;this.uploadFile({data:s,origin:e,type:"voice"})}}))},chooseVideos(){["app"].includes(y.Z.env)?y.Z.chooseVideo({count:1,sourceType:["album","camera"],maxDuration:this.isXSF?300:60,compressed:"app"===y.Z.env},(t=>{"success"===t.status&&this.uploadFile({data:[t],origin:"",type:"video"})}),(()=>{i.Z.loading({duration:0,forbidClick:!0,message:this.$t("common.uploadFail")})})):this.handleChooseVideoInput()},handleChooseVideoInput(){j.w.chooseVideoByInput({sizeLimit:this.isXSF?500:200,success:t=>{const{file:e}=t;i.Z.loading({duration:0,forbidClick:!0,message:this.$t("common.uploading")}),this.uploader.chooseFiles({choosedFiles:[e],notLibrary:!1})},fail:({message:t})=>{this.$toast({message:t})}})},onUpdateSuccess(t,e){const s={filename:t.name,video_id:t.videoId,resource_id:t.id};this.addVideoResource(s,e[0],this.currentUploadVideoDuration)},onUploadFailed(){i.Z.clear(),i.Z.fail({duration:2e3,message:this.$t("common.uploadFail")})},judgeVideoField(t,e){const s="h5"===y.Z.env?t[0].file:t[0],{length:a}=t;if(0===a)return!1;if("voice"!==e&&a>1)return this.$toast(this.$t("micro.videoNumberTip")),!1;const i=(s.path||s.filePath||s.name).split("."),o=i[i.length-1].toLowerCase(),r=s.size/1024/1024,n=this.isXSF?500:200;return r>n?(this.$toast(this.$t("micro.videoLimit",{num:n})),!1):!!w.Bg.includes(o)||(this.$toast(this.$t("micro.notSupportVideoType")),!1)},uploadFile({data:t,origin:e="",type:s=""}){const a=this.microInfo.resources.length;"app"===y.Z.env&&"ios"===y.Z.system||i.Z.loading({duration:0,forbidClick:!0,message:this.$t("common.uploading")}),"cover"!==e?"voice"!==s?this.handleUploadVideo(t,s):this.uploadVoiceResource(t,s,a):this.uploadCover(t)},handleUploadVideo(t,e){this.judgeVideoField(t,e)&&this.dealAppVideoUpload(t,e)},getVoiceData(t,e,s){const a=this.microInfo.resources.find((t=>t.index===this.fileNumber));a.cover=t;const i=s+a.index;delete a.index,a.isError=e;return{index:i,resource:a}},uploadVoiceResource(t,e,s){this.$store.commit("microCourse/addOneResource",{cover:"",duration:0,audios:[],index:this.fileNumber});const a=t[this.fileNumber];$.Z.appUploadFile(a,e,(async a=>{const o=a.data,r=`${o.data.server}/${o.data.fileNewName}`,n=this.getVoiceData(r,!1,s);await this.$store.dispatch("microCourse/updateOneResource",{payload:n}),this.fileNumber++,this.fileNumber===t.length?(this.fileNumber=0,i.Z.clear()):this.uploadVoiceResource(t,e,s)}),(()=>{i.Z.clear(),this.$toast(this.$t("common.uploadFail"));const t=this.getVoiceData("",!0,s);this.$store.dispatch("microCourse/updateOneResource",{payload:t})}))},async onUpdateSuccessFile(t){const{videoId:e,url:s,size:a,id:o,name:r,duration:n}=t;let c="";if("voice"===this.operateType){if("ALIBABA_PRIVATE"===this.storageConfig.storageType){const{data:t}=await H.Z.getPrivateImgUrl(e);0===t.code&&(c=t.data.docResourceDownloadUrl)}else c=s;await this.$store.commit("microCourse/addOneResource",{cover:c,duration:0,audios:[],resourceId:e?o:"",storageType:this.storageConfig.storageType,privatization:this.storageConfig.id,index:this.microInfo.resources.length}),this.funImageUploadDone()}else this.$store.commit("microCourse/addOneResource",{index:0,cover:"https://oss.coolcollege.cn/1789887486743416832.png",parameter:"1920,1080",size:a,id:o,url:"",name:r,video_id:e,resource_id:o,duration:Math.round(n,0),audios:[],storageType:this.storageConfig.storageType,privatization:this.storageConfig.id});i.Z.clear()},onUploadFailedFile(){this.funImageUploadDone()},funImageUploadDone(){this.fileNumber++,this.fileNumber===this.fileList.length&&(this.fileNumber=0,i.Z.clear())},async dealAppVideoUpload(t,e){const s=t[0];console.warn(s,e,"fileData, type");try{let t=await $.Z.uploadFileIsVideoApp(s);t=t[0],this.addVideoResource(t,s)}catch(t){console.warn(t),i.Z.clear(),this.$toast(this.$t("common.uploadFail"))}},addVideoResource(t,e,s){console.warn(t,e,s),i.Z.clear(),this.$store.commit("microCourse/addOneResource",{index:0,cover:"https://oss.coolcollege.cn/1789887486743416832.png",parameter:"1920,1080",size:e.size,id:t.resource_id,url:"",name:t.filename,video_id:t.video_id,resource_id:t.resource_id,duration:Math.round(s||e.duration,0),audios:[],storageType:this.storageConfig.storageType,privatization:this.storageConfig.id})},async realUploadVideo(t,e,s){const a=await $.Z.inputUploadImg(t,e),{data:o}=a;this.$store.commit("microCourse/addOneResource",{index:0,cover:"https://oss.coolcollege.cn/1789887486743416832.png",parameter:"1920,1080",size:t.size,id:o.resource_id,url:"",name:o.filename,video_id:o.video_id,resource_id:o.resource_id,duration:Math.round(s||o.duration,0),audios:[]}),i.Z.clear()},uploadCover(t){const e=t[0];$.Z.appUploadFile(e,"voice",(t=>{const e=t.data,s=`${e.data.server}/${e.data.fileNewName}`;this.$store.commit("microCourse/updateCover",s),i.Z.clear(),this.showPopup=!1}),(()=>{i.Z.clear(),this.$toast(this.$t("common.uploadFail"))}))},onDelete(){a.Z.confirm({title:this.$t("common.reminder"),message:this.$t("micro.deleteVideoTips"),confirmButtonText:this.$t("buttons.delete"),cancelButtonText:this.$t("common.cancel")}).then((()=>{this.$store.commit("microCourse/updateMicroCourse",{resources:[]})}))},deleteVoice(t){this.voiceDeleteList=t},async handleRelease(){if(!this.verifyRes)return;await this.handleValidateSource()&&(this.releaseBtn+=1,1===this.releaseBtn&&this.saveConfig("release"))},async handleSave(){if(!this.verifyRes)return;await this.handleValidateSource()&&(this.isSaveContent||(this.isSaveContent=!0),this.saveBtn+=1,1===this.saveBtn&&this.saveConfig("draft"))},async handlePreview(){if(!this.verifyRes)return;await this.handleValidateSource()&&this.$router.push({path:"/micro-watch/0/newest",query:{studyType:"preview",currentType:"image"}})},async handleValidateSource(){if("voice"===this.operateType){if(!this.microInfo.resources.filter((t=>t.audios.length>0)).length)return this.$toast(this.$t("micro.noAudio")),!1}else{const t=this.microInfo.resources[0]||{},e=t.id||t.resource_id;if(!this.isTranscoding){const s=await this.getResourceStatusVideo(e),{cover:a,duration:i,parameter:r,url:n,status:c}=s;if("Running"===c)return this.$toast(this.$t("upload.transcodingPlayerTip")),!1;{const e=(0,o.Z)((0,o.Z)({},t),{},{cover:a,parameter:r,url:n,duration:Number(i)});return await this.$store.dispatch("microCourse/updateOneResource",{payload:{index:0,resource:e}}),this.isTranscoding=!0,!0}}}return!0},getResourceStatusVideo(t){return new Promise((e=>{k.Z.getResourceStatusVideo(t).then((t=>{const{data:s}=t,{status:a}=t.data;"Finished"===a||"Running"===a?(s.status=a,e(s)):((0,i.Z)(this.$t("attestation.transcodingFailure")),e({}))}))}))},async saveConfig(t){i.Z.loading({duration:0,forbidClick:!0,message:this.$t("common.loading"),overlay:!0});let e=[],{microInfo:s}=this;if("voice"===this.operateType){if(e=this.microInfo.resources.filter((t=>t.audios.length>0)),!e.length)return void this.$toast(this.$t("micro.noAudio"));s.resources=e}try{const{data:e}=await k.Z.publishMicroCourse({editType:this.editType,editStatus:t,courseInfo:s,courseId:s.id,operateType:this.operateType});if(i.Z.clear(),"draft"===t)this.$toast(this.$t("attestation.saveSuccess")),this.$router.replace({path:"/micro-own",query:{}});else{const{state:t,course:s,approval_template:a}=e.data;"true"===t?(this.businessId=s[0].course_id,this.title=s[0].course_name,this.templates=a.template_id,this.versions=a.template_version,this.showApprovalProcess=!0,this.$toast({message:this.$t("micro.releaseSuccessful2"),position:"top",className:"top10"}),this.releaseBtn=0,"add"===this.editType&&(this.microInfo.id=s[0].course_id,this.editType="edit")):(this.$toast(this.$t("common.releaseSuccess")),this.$router.go(-1),this.$store.commit("microCourse/resetMicroInfo"))}}catch(t){i.Z.clear()}},handleDelResurces(){this.$store.dispatch("microCourse/updateOneResource",{type:"REMOVE_MUL_RESOURCE",payload:{indexs:this.voiceDeleteList}}),this.voiceDeleteList=[],this.showVoiceDelete=!1},hideApprovalProcessPopup(){this.showApprovalProcess=!1},goBack(){this.$router.go(-1)}}},Q=(0,P.Z)(G,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"micro-create"},[s("van-form",{attrs:{"scroll-to-error":""},on:{submit:t.onSubmit}},[s("div",{staticClass:"micro-create-top6"},[s("van-field",{staticClass:"micro-create-field",attrs:{required:"",name:"title",maxlength:"20",label:t.$t("micro.microTitle"),placeholder:t.$t("micro.microTitlePlaceholder")},model:{value:t.microInfo.title,callback:function(e){t.$set(t.microInfo,"title","string"==typeof e?e.trim():e)},expression:"microInfo.title"}})],1),s("van-row",{staticClass:"micro-create-row micro-create-top6",attrs:{type:"flex",justify:"space-between"}},[s("van-col",{attrs:{span:"16"}},[s("van-field",{staticClass:"micro-create-field",attrs:{rows:"4",autosize:"",label:t.$t("micro.microDesc"),type:"textarea",maxlength:"40",placeholder:t.$t("micro.microDescPlaceholder")},model:{value:t.microInfo.summary,callback:function(e){t.$set(t.microInfo,"summary","string"==typeof e?e.trim():e)},expression:"microInfo.summary"}})],1),s("van-col",{staticClass:"micro-create-cover",attrs:{span:"8"}},[s("div",{staticClass:"micro-create-cover-image"},[s("van-image",{attrs:{height:"100%",width:"100%",fit:"cover",src:t.microInfo.cover}}),s("div",{staticClass:"micro-create-cover-image-select",on:{click:t.selectCover}},[t._v(" "+t._s(t.$t("micro.selectCover"))+" ")])],1)])],1),s("div",{staticClass:"micro-create-top6"},[s("van-field",{attrs:{required:"","is-link":"",readonly:"",label:t.$t("micro.knowledgeClassify")},on:{click:function(e){t.showClassify=!0}},model:{value:t.microInfo.course_classify_name,callback:function(e){t.$set(t.microInfo,"course_classify_name",e)},expression:"microInfo.course_classify_name"}}),s("van-field",{attrs:{required:"","is-link":"",readonly:"",label:t.$t("common.visible")},on:{click:t.handleSelectUser},model:{value:t.visibleCount,callback:function(e){t.visibleCount=e},expression:"visibleCount"}}),s("van-field",{attrs:{"is-link":"",readonly:"",label:t.$t("common.teacher")},on:{click:function(e){t.showTeacher=!0}},model:{value:t.microInfo.teacher_name,callback:function(e){t.$set(t.microInfo,"teacher_name",e)},expression:"microInfo.teacher_name"}}),s("div",[s("van-field",{attrs:{readonly:"",name:"switch",label:t.$t("micro.synchronizationProgress")},scopedSlots:t._u([{key:"button",fn:function(){return[s("van-switch",{attrs:{"active-value":1,"inactive-value":0,size:"24","active-color":t.primaryColor},model:{value:t.microInfo.sync_progress,callback:function(e){t.$set(t.microInfo,"sync_progress",e)},expression:"microInfo.sync_progress"}})]},proxy:!0}])})],1),s("div",{staticClass:"stage-content-desc"},[t._v(t._s(t.$t("micro.syncTip")))]),s("div",{staticClass:"micro-create-top6"},[s("van-field",{attrs:{required:"",readonly:"",label:t.$t("micro.microCourseResources")},scopedSlots:t._u(["voice"===t.operateType&&t.microInfo.resources.length?{key:"button",fn:function(){return[s("span",{on:{click:function(e){t.showVoiceDelete=!t.showVoiceDelete}}},[t._v(t._s(t.showVoiceDelete?t.$t("buttons.cancel"):t.$t("buttons.delete")))])]},proxy:!0}:null],null,!0)})],1),"video"===t.operateType||"shoot"===t.operateType?s("div",{staticClass:"micro-create-video"},[t.microInfo.resources.length?s("VideoCard",{attrs:{cover:"ALIBABA_PRIVATE"!=t.microInfo.resources[0].storage_type?t.microInfo.resources[0].cover:"",duration:t.funDurationFormat(t.microInfo.resources[0].duration),"storage-type":t.microInfo.resources[0].storageType},on:{onDelete:t.onDelete}}):s("AddResources",{on:{onUploadResources:function(){return t.chooseVideos()}}})],1):t._e(),"voice"===t.operateType?s("div",{staticClass:"micro-create-video"},[s("VoiceResources",{attrs:{"show-voice-delete":t.showVoiceDelete},on:{chooseImages:t.chooseImages,deleteVoice:t.deleteVoice}})],1):t._e()],1)],1),s("div",{staticClass:"footer-btn_container"},[t.showVoiceDelete?t._e():s("div",{staticClass:"sub-btn",style:{color:t.verifyRes?"#4d536e":"#b7bac8"},on:{click:t.handleSave}},[t._v(t._s(t.$t("buttons.save")))]),t.showRelease?s("div",{staticClass:"sub-btn bor",style:{color:t.verifyRes?t.primaryColor:"#b7bac8"},on:{click:t.handleRelease}},[t._v(t._s(t.$t("buttons.release")))]):t._e(),t.showPreview?s("div",{staticClass:"sub-btn bor",style:{color:t.verifyRes?t.primaryColor:"#b7bac8"},on:{click:t.handlePreview}},[t._v(t._s(t.$t("buttons.preview")))]):t._e(),"voice"===t.operateType&&t.showVoiceDelete?s("div",{staticClass:"delete-btn",on:{click:t.handleDelResurces}},[t._v(" "+t._s(t.$t("buttons.delete"))+" ")]):t._e()]),s("common-popup",{attrs:{show:t.showPopup,"close-on-click-overlay":!1,"over-height":320},on:{closePopup:t.closePopup},scopedSlots:t._u([{key:"content",fn:function(){return[s("div",{staticClass:"micro-create-popup-content"},[s("div",{staticClass:"micro-create-popup-title"},[t._v(" "+t._s(t.$t("micro.selectModel"))+" ")]),s("div",{staticClass:"micro-create-popup-cover"},[s("van-radio-group",{attrs:{direction:"horizontal"},on:{change:t.updateCover},model:{value:t.microInfo.cover,callback:function(e){t.$set(t.microInfo,"cover",e)},expression:"microInfo.cover"}},t._l(t.coverList,(function(e){return s("van-radio",{key:e.id,attrs:{name:e.cover,"label-position":"left","checked-color":t.primaryColor}},[s("div",{staticClass:"micro-create-popup-cover-image"},[s("van-image",{attrs:{height:"100%",width:"100%",fit:"cover",src:e.cover}})],1)])})),1),s("div",{staticClass:"micro-create-popup-cover-tip"},[t._v(" "+t._s(t.$t("micro.imageSizeTip"))+" ")])],1),s("div",{staticClass:"micro-create-popup-button",on:{click:function(e){return e.stopPropagation(),function(){return t.chooseImageCover()}.apply(null,arguments)}}},[t._v(" "+t._s(t.$t("micro.albumSelect"))+" ")]),s("div",{staticClass:"micro-create-popup-cancel",on:{click:function(e){t.showPopup=!1}}},[t._v(" "+t._s(t.$t("common.cancel"))+" ")])])]},proxy:!0}])}),s("select-classify",{attrs:{"show-classify":t.showClassify},on:{closeClassify:t.closeClassify,select:t.handleClassifySelect}}),s("select-user",{attrs:{"show-visible":t.showVisible,"course-info":{id:t.microInfo.id,type:"micro",visible_count:t.microInfo.visible_count}},on:{closeVisible:t.closeVisible,select:t.handleUserSelect}}),s("select-teacher",{attrs:{show:t.showTeacher},on:{closeTeacher:t.closeTeacher,select:t.handleTeacherSelect}}),s("van-popup",{style:{height:"80%"},attrs:{position:"bottom","close-on-click-overlay":!1},model:{value:t.showApprovalProcess,callback:function(e){t.showApprovalProcess=e},expression:"showApprovalProcess"}},[t.showApprovalProcess?s("approval-process",{attrs:{"biz-type":"course_task","business-id":t.businessId,title:t.title,content:JSON.stringify({courseId:t.businessId,classifyType:"micro_course"}),templates:t.templates,versions:t.versions},on:{onCancel:t.hideApprovalProcessPopup,onSuccess:t.goBack}}):t._e()],1)],1)}),[],!1,null,"1fd7e278",null).exports},48767:(t,e,s)=>{s.r(e),s.d(e,{default:()=>x});s(31146);var a=s(41610),i=(s(34837),s(39146)),o=s(95082),r=(s(23307),s(81392)),n=(s(73474),s(74755)),c=(s(72975),s(98655)),l=(s(11155),s(91391)),u=(s(47601),s(44951)),d=(s(26699),s(39145)),h=s(5141),p=s(27632),m=s(55595),g=s(78551),v=s(26294),f=(s(57658),s(57584)),y=s.n(f),_=(s(14074),s(65129),s(22648)),C=s(56767),I={props:{activeIndex:{type:Number,default:0},visible:{type:Boolean,default:!1}},data:()=>({recordContent:null,remainTime:0,maxRecodingTime:60,nowAudioList:[],timer:null,wave:null,showRecord:"app"!==p.Z.env,uploader:null,currentUploadAudioDuration:0,storageConfig:{storageType:"PUBLIC_CLOUD",id:"public"}}),computed:(0,o.Z)({},(0,v.mapGetters)({microInfo:"microCourse/getMicroCourseInfo"})),mounted(){this.funInitStorage()},destroyed(){clearInterval(this.timer)},methods:{async funInitStorage(){const t=await h.Z.getStorageSet();this.uploader=(0,C.x)({onUpdateSuccess:this.onUpdateSuccess,onUploadFailed:this.onUploadFailed}),t&&!0===t.isDefault?(this.storageConfig=(0,o.Z)({},t),"ALIBABA_PRIVATE"===t.storageType?this.uploader.initUploader({type:"ALIBABA_PRIVATE",id:t.id}):this.uploader.initUploader()):this.uploader.initUploader()},stopRecord(){clearInterval(this.timer),"app"!==p.Z.env&&this.recordContent.stop(((t,e)=>{this.uploadVoiceH5(t,e),this.recordContent.close(),this.recordContent=null}),(t=>{console.error(t),this.recordContent.close(),this.recordContent=null})),this.$emit("cancel")},startRemainTime(){this.remainTime=this.maxRecodingTime,this.timer=setInterval((()=>{this.remainTime-=1,this.remainTime<=0&&this.stopRecord()}),1e3)},async startRecord(){if("app"===p.Z.env)p.Z.startAudioRecord({maxDuration:this.maxRecodingTime},(t=>{const{path:e,duration:s}=t.data;this.uploadAudio(e,s),this.stopRecord()}),(t=>{console.error(t)}));else{await this.recordH5()&&y().IsOpen&&(this.recordContent.start(),this.startRemainTime())}},recordH5(){let t=this,e=y()({type:"mp3",sampleRate:16e3,bitRate:16,onProcess:()=>{}});return this.recordContent=e,new Promise((s=>{e.open((()=>{s(!0)}),((a,o)=>{(0,i.Z)(a),t.$emit("cancel"),console.warn("授权",a,o),s(!1),e.close()}))}))},async uploadAudio(t,e){"ios_app"!==(0,_.ij)()&&i.Z.loading({mask:!0,message:this.$t("common.loading")});const s=e||this.maxRecodingTime-this.remainTime;if(s<3)(0,i.Z)(this.$t("micro.tooShort"));else{try{let e=await h.Z.uploadFileIsVideoApp({filePath:t});e=e[0],this.funUpdateResource(e,s)}catch(t){(0,i.Z)(this.$t("micro.audioStopTip"))}i.Z.clear()}},uploadVoiceH5(t,e){i.Z.loading({mask:!0,message:this.$t("common.uploading")});const s=Math.round(e/1e3,0);if(s<3)return void(0,i.Z)(this.$t("micro.tooShort"));const a={choosedFiles:[new File([t],`${Math.floor(1e6*Math.random())}.mp3`,{type:t.type})],notLibrary:!1};this.uploader.chooseFiles(a),this.currentUploadAudioDuration=s},onUpdateSuccess(t){this.funUpdateResource({resource_id:t.id},this.currentUploadAudioDuration)},onUploadFailed(){this.currentUploadAudioDuration=0},funUpdateResource(t,e){const s=this.microInfo.resources[this.activeIndex];s.audios.push({duration:Number(e),resource_id:t.resource_id,state:"true",sub_id:t.resource_id,is_new:!0,storageType:this.storageConfig.storageType,privatization:this.storageConfig.id}),s.duration=Number(s.duration)+Number(e),this.$store.dispatch("microCourse/updateOneResource",{payload:{index:this.activeIndex,resource:s}}),this.$forceUpdate(),this.$emit("audioUploadSuccess"),this.currentUploadAudioDuration=0}}},b=s(1001),w=(0,b.Z)(I,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.visible&&t.showRecord?s("div",[s("div",{staticClass:"recoding-status-container"},[s("div",{staticClass:"bottom-time-tip"},[s("div",{staticClass:"remain-time"},[s("span",{staticClass:"remain-time-num"},[t._v(t._s(t.remainTime))]),t._v("S ")]),s("div",{staticClass:"stop-record"},[s("div",{staticClass:"stop-record-btn",on:{click:t.stopRecord}},[s("div",{staticClass:"stop-icon"})])])])])]):t._e()}),[],!1,null,"1667f7e3",null).exports,$=(s(3791),s(93432)),k={components:{Icon:r.Z,[$.Z.name]:$.Z},props:{progress:{type:[Number,String],default:3},type:{type:String,default:"record"},listIndex:{type:Number,default:0},loading:{type:Boolean,default:!1},isPlaying:{type:Boolean,default:!1}},data:()=>({}),methods:{handlePlayRecord(){this.$emit("playRecords",this.listIndex)},handleDeleteRecord(){this.$emit("onDelete",this.listIndex)}}},S=(0,b.Z)(k,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"recording-progress"},[s("div",{staticClass:"progress",style:{width:t.progress/60*100+"%"},on:{click:t.handlePlayRecord}},[s("div",{class:{"green-bg":!0,"animation-progress":t.isPlaying}},[t._m(0),"record"===t.type?s("span",{staticClass:"second"},[t._v(t._s(t.progress))]):t._e(),"preview"===t.type?s("div",{staticClass:"in-play-mode"}):t._e()])]),"record"!==t.type||t.loading?t._e():s("div",{staticClass:"handle"},[s("Icon",{attrs:{name:"cross",size:"16",color:"#fff"},on:{click:t.handleDeleteRecord}})],1),"record"===t.type&&t.loading?s("div",{staticClass:"handle"},[s("van-loading",{attrs:{color:"#fff",size:"16",type:"spinner"}})],1):t._e()])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"animation-box"},[e("div",{staticClass:"circle first"}),e("div",{staticClass:"circle second"}),e("div",{staticClass:"circle third"})])}],!1,null,"16511190",null).exports,T=s(71522),Z={components:{[u.Z.name]:u.Z,[l.Z.name]:l.Z,[c.Z.name]:c.Z,[n.Z.name]:n.Z,Icon:r.Z,AddVoice:w,RecordingProgress:S,SvgIcon:g.Z},data:()=>({maxImgCount:30,maxAudioCount:5,isRecording:!1,showMorePop:!1,activeIndex:0,nowAudioList:[],isPlaying:!1,isPlayEnd:!0,currentPlayIndex:"",isNewVersion:"true",audioContent:null,storageConfig:{},fileNumber:0,imageFileList:[],operateType:""}),computed:(0,o.Z)({},(0,v.mapGetters)({microInfo:"microCourse/getMicroCourseInfo"})),mounted(){this.funInitStorage(),this.activeIndex=Number(this.$route.query.index||0),this.funInitData()},methods:{async funInitStorage(){const t=await h.Z.getStorageSet();this.uploaderImage=(0,C.x)({onUpdateSuccess:this.onUpdateSuccessImage,onUploadWarning:this.onUploadFailedImage,onUploadFailed:this.onUploadFailedImage}),t&&!0===t.isDefault?("ALIBABA_PRIVATE"===t.storageType?this.uploaderImage.initUploader({type:"ALIBABA_PRIVATE",id:t.id}):this.uploaderImage.initUploader(),this.storageConfig=(0,o.Z)({},t)):this.uploaderImage.initUploader()},onUpdateSuccessImage(t){const{videoId:e,url:s,id:a}=t;let i="";setTimeout((async()=>{if("ALIBABA_PRIVATE"===this.storageConfig.storageType){const{data:t}=await T.Z.getPrivateImgUrl(e);0===t.code&&(i=t.data.docResourceDownloadUrl)}else i=s;"replace"===this.operateType?(await this.$store.dispatch("microCourse/updateOneResource",{payload:{index:this.activeIndex,resource:(0,o.Z)((0,o.Z)({},this.microInfo.resources[this.activeIndex]),{},{cover:i})}}),this.showMorePop=!1):(await this.$store.commit("microCourse/addOneResource",{cover:i,duration:0,resourceId:e?a:"",audios:[],index:this.microInfo.resources.length,storageType:this.storageConfig.storageType,privatization:this.storageConfig.id}),this.activeIndex=this.microInfo.resources.length-1,this.nowAudioList=this.microInfo.resources[this.activeIndex].audios,this.funScrollImg()),this.funImageUploadDone(!0)}),1e3)},onUploadFailedImage(){this.funImageUploadDone()},funImageUploadDone(){this.fileNumber++,this.fileNumber===this.imageFileList.length&&(this.fileNumber=0,i.Z.clear())},funInitData(){this.microInfo.resources.length&&this.microInfo.resources[this.activeIndex]&&this.microInfo.resources[this.activeIndex].audios&&(this.nowAudioList=this.microInfo.resources[this.activeIndex].audios)},handleBackRecord(){this.stopPlay(),window.sessionStorage.setItem("addVoiceBack",!0),this.$router.back(-1)},funChooseImg(t){this.operateType=t,"replace"!==t&&this.stopPlay();const e="replace"===t?1:this.maxImgCount-this.microInfo.resources.length;["app"].includes(p.Z.env)?this.chooseImagesApp(e):d.w.chooseImageByInput({count:e,sourceType:["camera","album"],success:t=>{"ios_app"!==(0,_.ij)()&&i.Z.loading({message:this.$t("common.uploading"),forbidClick:!0,loadingType:"spinner",duration:0}),this.imageFileList=t.files,this.uploaderImage.chooseFiles({choosedFiles:t.files,notLibrary:!1})},fail:({message:t})=>{this.$toast({message:t})}})},chooseImagesApp(t,e=""){const s={count:t,sourceType:["album","camera"],compressed:!0,percent:80};p.Z.chooseImage(s,(t=>{if("success"===t.status){const s=t.filePaths;this.uploadAppFile({data:s,origin:e,type:"voice"})}}))},uploadAppFile({data:t,origin:e="",type:s}){const a=this.microInfo.resources.length;"app"===p.Z.env&&"ios"===p.Z.system||i.Z.loading({duration:0,forbidClick:!0,message:this.$t("common.uploading")}),this.uploadVoiceResourceApp(t,s,a)},uploadVoiceResourceApp(t,e,s){this.$store.commit("microCourse/addOneResource",{cover:"",duration:0,audios:[],index:this.fileNumber});const a=t[this.fileNumber];h.Z.appUploadFile(a,e,(async a=>{const o=a.data,r=`${o.data.server}/${o.data.fileNewName}`,n=this.getVoiceData(r,!1,s);await this.$store.dispatch("microCourse/updateOneResource",{payload:n}),this.fileNumber++,this.fileNumber===t.length?(this.fileNumber=0,i.Z.clear()):this.uploadVoiceResourceApp(t,e,s)}),(()=>{i.Z.clear(),this.$toast(this.$t("common.uploadFail"));const t=this.getVoiceData("",!0,s);this.$store.dispatch("microCourse/updateOneResource",{payload:t})}))},getVoiceData(t,e,s){const a=this.microInfo.resources.find((t=>t.index===this.fileNumber));a.cover=t;const i=s+a.index;delete a.index,a.isError=e;return{index:i,resource:a}},handleSwitchImg(t){this.microInfo.resources.length&&(this.stopPlay(),this.activeIndex=t,this.nowAudioList=this.microInfo.resources[this.activeIndex].audios,this.funScrollImg())},onSlide(t){this.stopPlay(),this.microInfo.resources.length&&(this.activeIndex=t,this.nowAudioList=this.microInfo.resources[this.activeIndex].audios,this.funScrollImg())},funScrollImg(){this.$refs.topImg.scrollLeft=50*this.activeIndex},funSlideTo(t){if(this.microInfo.resources.length){if(this.stopPlay(),"prev"===t){if(0===this.activeIndex)return;this.activeIndex-=1}else{if(this.activeIndex===this.microInfo.resources.length-1)return;this.activeIndex+=1}this.nowAudioList=this.microInfo.resources[this.activeIndex].audios,this.funScrollImg()}},handleStartRecord(){!this.microInfo.resources.length||this.microInfo.resources[this.activeIndex].audios.length>=this.maxAudioCount||(this.stopPlay(),this.isRecording=!0,this.$refs.recordRef.startRecord())},handleMore(){this.microInfo.resources.length&&(this.showMorePop=!0)},handleDelImg(){this.microInfo.resources.length&&a.Z.confirm({title:this.$t("common.reminder"),message:this.$t("micro.deletePageMaterialTips"),confirmButtonText:this.$t("buttons.delete"),cancelButtonText:this.$t("common.cancel")}).then((()=>{this.stopPlay(),this.$store.dispatch("microCourse/updateOneResource",{type:"REMOVE_ONE_RESOURCE",payload:{index:this.activeIndex}}),this.activeIndex=this.activeIndex>=this.microInfo.resources.length-1?this.microInfo.resources.length-1:this.activeIndex,this.nowAudioList=this.microInfo.resources[this.activeIndex].audios}))},handleReplaceImg(){this.funChooseImg("replace")},funAudioUploadSuccess(){this.nowAudioList=this.microInfo.resources[this.activeIndex].audios},onDelete(t){const e=this.microInfo.resources[this.activeIndex];e.duration=Number(e.duration)-e.audios[t].duration,e.audios.splice(t,1),this.$store.dispatch("microCourse/updateOneResource",{payload:{index:this.activeIndex,resource:e}}),this.$forceUpdate(),this.currentPlayIndex===`${this.activeIndex}-${t}`&&(this.stopPlay(),this.currentPlayIndex="")},playRecords(t){const{activeIndex:e,currentPlayIndex:s,isPlayEnd:a}=this,{resources:i}=this.microInfo,{audios:o}=i[e];o[t].sub_id&&this.onResourceStatus(o[t].resource_id||o[t].sub_id).then((e=>{const{url:i}=e.resources[0];s||!a?("dingTalk"===p.Z.env&&p.Z.getBackgroundAudioManager({funType:"stop"}),this.startPlay(t,i)):this.startPlay(t,i)}))},startPlay(t,e){const{activeIndex:s}=this,{resources:a}=this.microInfo,{audios:i}=a[s];i[t].sub_id&&(this.isPlaying=!0,this.currentPlayIndex=`${s}-${t}`,this.isPlayEnd=!1,"dingTalk"===p.Z.env?this.startDingPlay(a[s].cover,e):this.startH5Play(e))},startDingPlay(t,e){p.Z.getBackgroundAudioManager({funType:"play",coverImgUrl:t,src:e},(t=>{"onEnded"===t.type&&(this.isPlaying=!1,this.isPlayEnd=!0,this.currentPlayIndex="")}))},startH5Play(t){this.audioContent=new Audio,this.audioContent.src=t,this.audioContent.addEventListener("loadedmetadata",(()=>{this.audioContent.play()}))},onResourceStatus(t){return new Promise((e=>{m.Z.getResourceStatus({resourceId:t}).then((t=>{const{data:s}=t,{transcoding_result:a}=s;"true"===a?e(s):(0,i.Z)(this.$t("micro.audioTranscodeTip"))}))}))},stopPlay(){""!==this.currentPlayIndex&&("dingTalk"===p.Z.env?(p.Z.getBackgroundAudioManager({funType:"stop"}),this.isPlaying=!1,this.isPlayEnd=!0,this.currentPlayIndex=""):this.audioContent&&(this.audioContent.pause(),this.audioContent=null))}}},x=(0,b.Z)(Z,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"slide-container"},[s("div",{ref:"topImg",staticClass:"item-index-container"},[t._l(t.microInfo.resources,(function(e,a){return s("div",{key:a+"_"+(new Date).getTime(),class:{"item-index-one":!0,"image-error":!0,active:t.activeIndex===a},on:{click:function(e){return t.handleSwitchImg(a)}}},[s("van-image",{staticClass:"cl-video-card__cover",attrs:{radius:"8",src:e.cover,fit:"cover"}}),s("div",{staticClass:"duration-label"},[s("SvgIcon",{attrs:{color:"#fff","icon-class":"icon-icon-m1"}}),t._v(" "+t._s(e.duration)+" ")],1)],1)})),t.microInfo.resources.length<t.maxImgCount?s("div",{staticClass:"item-index-one add-btn",on:{click:t.funChooseImg}},[s("Icon",{attrs:{name:"plus",size:"16",color:"#A9A9A9"}})],1):t._e()],2),s("div",{staticClass:"finish-btn-container",on:{click:t.handleBackRecord}},[s("div",{staticClass:"finish-btn"},[s("Icon",{attrs:{name:"success",size:"30",color:"#A9A9A9"}})],1)]),s("van-swipe",{staticClass:"micro-voice-swipe",attrs:{width:"100%",height:"100%","indicator-color":"white","initial-swipe":t.activeIndex,"show-indicators":!1,loop:!1},on:{change:t.onSlide}},t._l(t.microInfo.resources,(function(t){return s("van-swipe-item",{key:t.index},[s("van-image",{attrs:{src:t.cover,fit:"cover"}}),s("div",{staticClass:"cover"},[s("div",{staticClass:"bg-color"}),s("van-image",{staticClass:"bg-img bg-blur",attrs:{src:t.cover,fit:"cover"}}),s("div",{staticClass:"cover-img-container"},[s("img",{staticClass:"img",attrs:{src:t.cover,mode:"widthFix"}})])],1)],1)})),1),s("div",{staticClass:"bottom-info-display"},[t.nowAudioList.length?s("div",{staticClass:"recording-list"},t._l(t.nowAudioList,(function(e,a){return s("div",{key:e.id},[s("RecordingProgress",{attrs:{resource:e,progress:e.duration,"list-index":a,"is-playing":t.isPlaying&&t.activeIndex+"-"+a===t.currentPlayIndex,loading:"true"===t.isNewVersion||e.is_new?!e.sub_id:!e.url},on:{onDelete:t.onDelete,playRecords:t.playRecords,onResourceStatus:t.onResourceStatus}})],1)})),0):t._e(),t.microInfo.resources.length&&!t.microInfo.resources[t.activeIndex].audios.length?s("div",{staticClass:"no-record-tip"},[t._v(t._s(t.$t("micro.microCourseTips")))]):t._e(),s("div",{staticClass:"btn-operate-container"},[s("div",{class:{btn:!0,prev:!0,disabled:t.activeIndex<1},on:{click:function(e){return t.funSlideTo("prev")}}},[s("Icon",{attrs:{name:"arrow-left",size:"30",color:"#A9A9A9"}})],1),s("div",{staticClass:"btn delete",on:{click:t.handleDelImg}},[s("Icon",{attrs:{name:"delete",size:"30",color:"#A9A9A9"}})],1),s("div",{staticClass:"btn recording",on:{click:t.handleStartRecord}},[t._m(0)]),s("div",{staticClass:"btn more-operate",on:{click:t.handleMore}},[s("Icon",{attrs:{name:"ellipsis",size:"30",color:"#A9A9A9"}})],1),s("div",{class:{btn:!0,next:!0,disabled:!t.microInfo.resources.length||t.activeIndex===t.microInfo.resources.length-1},on:{click:function(e){return t.funSlideTo("next")}}},[s("Icon",{attrs:{name:"arrow",size:"30",color:"#A9A9A9"}})],1)])]),s("van-popup",{attrs:{position:"bottom","get-container":"body","safe-area-inset-bottom":""},model:{value:t.showMorePop,callback:function(e){t.showMorePop=e},expression:"showMorePop"}},[s("div",{staticClass:"common-popup-content"},[s("div"),s("div",{staticClass:"action-one",on:{click:t.handleReplaceImg}},[t._v(t._s(t.$t("micro.replaceImage")))]),s("div",{staticClass:"action-one action-cancel",on:{click:function(e){t.showMorePop=!1}}},[t._v(t._s(t.$t("common.cancel")))])])]),s("AddVoice",{ref:"recordRef",attrs:{visible:t.isRecording,"active-index":t.activeIndex},on:{cancel:function(e){t.isRecording=!1},audioUploadSuccess:t.funAudioUploadSuccess}})],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"record-btn"},[e("div",{staticClass:"recoding-bg"})])}],!1,null,"ff4e2d1a",null).exports},26820:(t,e,s)=>{s.r(e),s.d(e,{default:()=>b});var a=s(95082),i=(s(58052),s(68286)),o=(s(52355),s(29233)),r=(s(47601),s(44951)),n=(s(53743),s(59978)),c=(s(629),s(67763)),l=(s(20581),s(50914)),u=(s(82522),s(10342)),d=(s(82500),s(49414)),h=(s(86039),s(20495)),p=(s(2707),s(33948),s(57658),s(26294)),m=s(98512),g=s(22648),v=s(49017),f=s(55595),y=s(78368),_=s(45877),C=s(42765),I={name:"MicroList",components:{[h.Z.name]:h.Z,[d.Z.name]:d.Z,[u.Z.name]:u.Z,[l.Z.name]:l.Z,[c.Z.name]:c.Z,[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,ClCustomUser:_.Z,MicroEnter:C.Z},beforeRouteLeave(t,e,s){if(e.meta.keepAlive){const t=document.querySelector("#micro-list-container"),s=t?t.scrollTop:0;e.meta.scrollTop=s}s()},data:function(){return{showUserAgreement:!1,AI_COURSE_GUIDE_FLAG:v.qQ,defaultAvatar:y,tabs:v.MB,operateEnter:v.MS,operate:v.eg,microList:[],microCoursesParams:{keyword:"",sort:"newest",page_number:1,page_size:20},loading:!1,finished:!1,refreshing:!1,showOverlay:!1,system:(0,g.Os)()}},computed:(0,a.Z)({},(0,p.mapGetters)({primaryColor:"getPrimaryColor",access_token:"getToken",env:"getEnv",isPure:"getIsPure",aiCourseNewFlag:"microCourse/getAiCourseNewFlag"})),mounted(){this.getMicroList()},activated(){this.$nextTick((()=>{const{scrollTop:t}=this.$route.meta,e=document.querySelector("#micro-list-container");t&&e&&(e.scrollTop=t)}))},methods:{onLoad(){this.refreshing?(this.microList=[],this.refreshing=!1,this.microCoursesParams.page_number=1):this.microCoursesParams.page_number+=1,this.getMicroList()},onRefresh(){this.finished=!1,this.loading=!0,setTimeout((()=>{this.onLoad()}),100)},async getMicroList(){const{sort:t}=this.$route.params;t&&(this.microCoursesParams.sort=t);const{getMicroCoursesList:e}=f.Z,s=await e(this.microCoursesParams);this.microList=[...this.microList,...s.data.list],this.loading=!1,this.finished="false"===s.data.has_next_page},commonGet(){this.microCoursesParams.page_number=1,this.loading=!0,this.microList=[],this.getMicroList()},goToMicroDetail(t){"h5"===this.env&&this.isPure&&"ios"===this.system?this.$router.push(`/micro-watch/${t.id}/${this.microCoursesParams.sort}?studyType=list`):this.$router.push(`/micro-watch/${t.id}/${this.microCoursesParams.sort}?${(0,m.WZ)()}`)},onFocus(){this.$router.push(`/micro-search?${(0,m.WZ)()}`)}}},b=(0,s(1001).Z)(I,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"micro-list"},[s("div",{staticClass:"micro-list-top"},[s("van-search",{attrs:{readonly:"","show-action":""!==t.microCoursesParams.keyword,placeholder:t.$t("micro.pleaseEnterMicro")},on:{focus:t.onFocus},model:{value:t.microCoursesParams.keyword,callback:function(e){t.$set(t.microCoursesParams,"keyword",e)},expression:"microCoursesParams.keyword"}}),s("div",{staticClass:"micro-list-top-out"},[s("div",{staticClass:"micro-list-top-tap"},[s("van-tabs",{attrs:{color:t.primaryColor,"line-width":24},on:{change:t.commonGet},model:{value:t.microCoursesParams.sort,callback:function(e){t.$set(t.microCoursesParams,"sort",e)},expression:"microCoursesParams.sort"}},t._l(t.tabs,(function(e){return s("van-tab",{key:e.id,attrs:{name:e.id,"title-class":"micro-list-top-tap-tab",title:t.$t(e.lang)}})})),1)],1)])],1),s("div",{staticClass:"micro-list-bottom",attrs:{id:"micro-list-container"}},[s("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[s("van-list",{attrs:{"immediate-check":!1,finished:t.finished,"finished-text":t.$t("micro.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[s("van-grid",{attrs:{border:!1,"column-num":2,gutter:4}},t._l(t.microList,(function(e){return s("van-grid-item",{key:e.id,staticClass:"micro-list-item",on:{click:function(s){return t.goToMicroDetail(e)}}},[s("div",{staticClass:"micro-list-item-content"},[s("van-image",{staticClass:"micro-list-bottom-img",attrs:{height:"244px",fit:"cover",src:e.cover}}),"true"===e.is_ai_course?s("div",{staticClass:"image-tag-box"},[s("span",{staticClass:"image-tag"},[t._v(t._s(t.$t("micro.AIMicroCourse")))])]):t._e(),s("van-cell",{attrs:{center:"",border:!1},scopedSlots:t._u([{key:"default",fn:function(){return[s("cl-custom-user",{attrs:{type:e.update_user_source_type,"data-type":"userName",value:e.update_user_sync_user_id,name:e.update_user_name||t.$t("common.no")}})]},proxy:!0},{key:"icon",fn:function(){return[s("van-image",{staticClass:"micro-list-bottom-icon",attrs:{round:"",fit:"cover",height:t._f("pxTransToVw")(20),width:t._f("pxTransToVw")(20),src:e.update_user_avatar||t.defaultAvatar}})]},proxy:!0}],null,!0)}),s("van-cell",{attrs:{center:"",border:!1,value:e.title}})],1)])})),1)],1)],1)],1),s("micro-enter")],1)}),[],!1,null,"6e791f76",null).exports},39302:(t,e,s)=>{s.r(e),s.d(e,{default:()=>$});s(49153);var a=s(5944),i=(s(86039),s(20495)),o=(s(33948),s(30541),s(55595)),r=s(95082),n=(s(47601),s(44951)),c=(s(20581),s(50914)),l=(s(71322),s(85471)),u=(s(53743),s(59978)),d=(s(629),s(67763)),h=(s(52355),s(29233)),p=(s(70885),s(6458)),m=(s(18144),s(65641)),g=(s(57658),s(98512)),v=s(78551),f=s(45877),y=s(26294),_=s(78368),C={name:"SearchResult",components:{SvgIcon:v.Z,[m.Z.name]:m.Z,[p.Z.name]:p.Z,[h.Z.name]:h.Z,[d.Z.name]:d.Z,[u.Z.name]:u.Z,[l.Z.name]:l.Z,[c.Z.name]:c.Z,[n.Z.name]:n.Z,ClCustomUser:f.Z},props:{micro:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},finished:{type:Boolean,default:!1},keyword:{type:String,default:""}},data:()=>({defaultAvatar:_,load:!1}),computed:(0,r.Z)({},(0,y.mapGetters)({access_token:"getToken"})),watch:{loading(t){this.load=t},load(t){this.$emit("loading",t)}},methods:{onLoad(){this.$emit("load")},goToWatch(t){this.$router.push(`/micro-watch/${t.id}/all?${(0,g.WZ)()}&keyword=${this.keyword}`)}}},I=s(1001),b=(0,I.Z)(C,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("van-list",{staticClass:"micro-search",attrs:{"immediate-check":!1,offset:500,finished:t.finished,"finished-text":t.$t("micro.noMore")},on:{load:t.onLoad},model:{value:t.load,callback:function(e){t.load=e},expression:"load"}},t._l(t.micro,(function(e){return s("van-cell",{key:e.id,on:{click:function(s){return t.goToWatch(e)}}},[s("p",{staticClass:"teacher"},[s("van-image",{attrs:{round:"",width:"30px",height:"30px",src:e.update_user_avatar||t.defaultAvatar,fit:"cover"}}),s("span",[s("cl-custom-user",{attrs:{type:e.update_user_source_type,"data-type":"userName",value:e.update_user_sync_user_id,name:e.update_user_name||t.$t("common.no")}})],1)],1),s("p",{staticClass:"title"},[t._v(t._s(e.title))]),s("p",{staticClass:"classify"},[s("span",[t._v(t._s(e.summary))]),s("span",{staticClass:"classifyName"},[t._v(" #"+t._s(e.classify_name))])]),s("van-image",{staticClass:"thumbnail",attrs:{src:e.cover,width:"100%",fit:"cover"}}),s("van-grid",{attrs:{direction:"horizontal","column-num":3,border:!1,center:!1}},[s("van-grid-item",[s("svg-icon",{attrs:{size:16,"icon-class":"icon-pinglun",color:"#C0C2CB"}}),s("span",{staticClass:"num"},[t._v(t._s(e.comment_count))])],1),s("van-grid-item",[s("svg-icon",{attrs:{size:16,"icon-class":"icon-zan2",color:"#C0C2CB"}}),s("span",{staticClass:"num"},[t._v(t._s(e.like_count))])],1)],1)],1)})),1)}),[],!1,null,"67355c84",null).exports,w={name:"SearchHistory",components:{[i.Z.name]:i.Z,[a.Z.name]:a.Z,searchResult:b},beforeRouteLeave(t,e,s){if(e.meta.keepAlive){const t=document.querySelector("#micro-search-container"),s=t?t.scrollTop:0;e.meta.scrollTop=s}s()},data:()=>({loading:!1,finish:!1,showKeyword:!0,params:{keyword:"",page_number:1,page_size:20},microList:[],history:"",keyNum:9}),mounted(){this.params={keyword:"",page_number:1,page_size:20},this.showKeyword=!0,this.getHistory()},activated(){this.$nextTick((()=>{const{scrollTop:t}=this.$route.meta,e=document.querySelector("#micro-search-container");t&&e&&(e.scrollTop=t)}))},methods:{reloadData(){this.params.page_number+=1,this.getMicroList()},changeLoading(t){this.loading=t},async getMicroList(){const{getMicroCoursesList:t}=o.Z,e=await t(this.params);this.showKeyword=!1,e.data.list.forEach((t=>{t.showPopover=!1})),this.microList=[...this.microList,...e.data.list],this.loading=!1,this.finish="false"===e.data.has_next_page,this.history=localStorage.getItem("search")?localStorage.getItem("search").split(","):[]},onSearch(){if(""!==this.params.keyword){let t=localStorage.getItem("search")?localStorage.getItem("search").split(","):[],e=t.indexOf(this.params.keyword);-1!==e&&t.splice(e,1),t.unshift(this.params.keyword),localStorage.setItem("search",t.slice(0,this.keyNum+1))}this.microList=[],this.loading=!0,this.getMicroList()},clickKeyword(t){this.params.keyword=t,this.onSearch()},onClear(){this.params.keyword="",this.showKeyword=!0},getHistory(){this.showKeyword=!0,this.history=localStorage.getItem("search")?localStorage.getItem("search").split(","):[]}}},$=(0,I.Z)(w,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"search-wrap"},[s("van-search",{attrs:{maxlength:20,"show-action":"",autofocus:"",placeholder:t.$t("micro.pleaseEnterMicro")},on:{search:t.onSearch,clear:t.onClear,focus:t.getHistory},scopedSlots:t._u([{key:"action",fn:function(){return[t.showKeyword?s("div",{on:{click:t.onSearch}},[t._v(t._s(t.$t("common.search")))]):s("div",{on:{click:t.onClear}},[t._v(t._s(t.$t("common.cancel")))])]},proxy:!0}]),model:{value:t.params.keyword,callback:function(e){t.$set(t.params,"keyword",e)},expression:"params.keyword"}}),t.showKeyword?s("div",{staticClass:"history-wrap"},[s("p",{staticClass:"title"},[t._v(t._s(t.$t("micro.searchHistory")))]),t.history.length>0?s("ul",{staticClass:"content"},t._l(t.history,(function(e,a){return s("li",{key:a,on:{click:function(s){return t.clickKeyword(e)}}},[t._v(" "+t._s(e)+" ")])})),0):s("van-empty",{attrs:{description:t.$t("micro.noKeyWord")}})],1):s("div",{staticClass:"search-wrap-thing",attrs:{id:"micro-search-container"}},[t.microList.length>0?s("search-result",{attrs:{keyword:t.params.keyword,micro:t.microList,loading:t.loading,finished:t.finish},on:{load:t.reloadData,loading:t.changeLoading}}):s("van-empty",{attrs:{description:t.$t("common.noDataTextTip")}})],1)],1)}),[],!1,null,"83113aa4",null).exports},96711:(t,e,s)=>{s.r(e),s.d(e,{default:()=>f});var a=s(95082),i=(s(20581),s(50914)),o=(s(47601),s(44951)),r=(s(70885),s(6458)),n=(s(18144),s(65641)),c=(s(33948),s(57658),s(78551)),l=s(78368),u=s(55595),d=s(45877),h=s(67875),p=s(32900),m=s(26294),g=s(98512),v={name:"MicroSomeone",components:{SvgIcon:c.Z,[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,ClCustomUser:d.Z,ClCustomDepartment:h.Z},data:()=>({userInfo:{photo:"",name:"",orgName:""},microList:[],params:{keyword:"",sort:"newest",page_number:1,page_size:20,creator:""},loading:!1,finished:!1,defaultAvatar:l}),computed:(0,a.Z)({},(0,m.mapGetters)({access_token:"getToken"})),mounted(){const{avatar:t}=(0,g.DP)();this.userInfo.photo=decodeURIComponent(t),this.getUser(),this.getMicroList()},methods:{onLoad(){this.params.page_number+=1,this.getMicroList()},async getMicroList(){this.loading=!0,this.params.creator=this.$route.params.id;const{getMicroCoursesList:t}=u.Z,e=await t(this.params);this.loading=!1,this.finished="false"===e.data.has_next_page,this.microList=[...this.microList,...e.data.list]},async getUser(){const{getUserById:t}=p.Z,e=await t({user_ids:[this.$route.params.id]}),s=Array.isArray(e.data)?e.data[0]:{};this.userInfo=(0,a.Z)((0,a.Z)({},this.userInfo),{},{name:s.user_name,orgName:s.departments,sync_source_type:"",sync_user_id:"",dept_sync_names:"",dept_sync_source_type:"",department_ids:""},s)},jumpDetail(t){this.$router.push(`/micro-watch/${t}/newest?access_token=${this.access_token}&creator=${this.$route.params.id}`)}}},f=(0,s(1001).Z)(v,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"someone-wrap"},[s("van-row",{staticClass:"userInfo"},[s("van-image",{attrs:{round:"",width:"64px",height:"64px",src:t.userInfo.photo||t.defaultAvatar,fit:"cover"}}),s("p",{staticClass:"person"},[s("span",{staticClass:"name cl-ellipsis"},[s("cl-custom-user",{attrs:{type:t.userInfo.sync_source_type,"data-type":"userName",value:t.userInfo.sync_user_id,name:t.userInfo.name}})],1),s("span",{staticClass:"orgName cl-ellipsis"},[s("cl-custom-department",{attrs:{"name-list":t.userInfo.dept_sync_names,"source-type":t.userInfo.dept_sync_source_type,list:t.userInfo.department_ids}})],1)])],1),s("div",{staticClass:"someone-wrap-list"},[s("van-list",{attrs:{"immediate-check":!1,finished:t.finished,"finished-text":t.$t("micro.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[s("van-row",{staticClass:"microList",attrs:{type:"flex",gutter:5,justify:"space-around"}},t._l(t.microList,(function(e){return s("van-col",{key:e.id,staticClass:"microList-every",attrs:{span:8},on:{click:function(s){return t.jumpDetail(e.id)}}},[s("van-image",{staticClass:"microList-thumbnail",attrs:{src:e.cover,width:"100%",height:"161px",fit:"cover"}}),s("p",{staticClass:"title"},[t._v(t._s(e.title))]),s("p",{staticClass:"oprate"},[s("svg-icon",{attrs:{size:12,"icon-class":"icon-zan2",color:"#C0C2CB"}}),s("span",{staticClass:"num"},[t._v(t._s(e.like_count))])],1)],1)})),1)],1)],1)],1)}),[],!1,null,"b5a0d37a",null).exports},7059:(t,e,s)=>{s.r(e),s.d(e,{default:()=>ut});s(34837);var a=s(39146),i=s(95082),o=s(62078),r=(s(73474),s(74755)),n=(s(47601),s(44951)),c=(s(72975),s(98655)),l=(s(11155),s(91391)),u=(s(47238),s(75167)),d=(s(3791),s(93432)),h=(s(25773),s(35791)),p=(s(2707),s(33948),s(74916),s(15306),s(56977),s(91058),s(56369)),m=s(26294),g=s(25934),v=s(27632),f=s(69119),y=s(98512),_=s(82820),C=s(22648),I=s(55595),b=s(56955),w=s(86722),$=s(24357),k=s(77522),S=s(62501),T=(s(23307),s(81392)),Z=(s(18144),s(65641)),x=(s(70885),s(6458)),P=(s(57658),s(78368)),D=(s(31146),s(41610)),L=(s(20581),s(50914)),A=(s(93787),s(20090)),E=(s(29941),s(64168)),R=(s(52355),s(29233)),F=s(78551),q=(s(73210),s(45877)),N={name:"Replay",components:{[r.Z.name]:r.Z,[A.Z.name]:A.Z,[Z.Z.name]:Z.Z,[x.Z.name]:x.Z,[h.Z.name]:h.Z,ClCustomUser:q.Z},props:{commentDialogShow:{type:Boolean,default:()=>!1},replayDialogShow:{type:Boolean,default:()=>!1},commentItem:{type:Object,default:()=>{}},courseInfo:{type:Object,default:()=>{}}},data:()=>({commentField:"",replayField:"",isDisabled:!0}),computed:{themeColor(){return this.$store.state.themeColor}},methods:{closeDialog(t){this.$emit("closeDialg",t)},saveComment(){if(!this.commentField.trim().length)return;const{saveCommentary:t}=I.Z;t({resource_id:this.courseInfo.id,content:this.commentField}).then((t=>{"true"===t.data.result&&(this.$emit("closeDialg","comment"),this.$emit("refresh"),this.commentField="")}))},saveReplay(){if(!this.replayField.trim().length)return;const{getReply:t}=I.Z;t({comment_id:this.commentItem.id,resource_id:this.courseInfo.id,content:this.replayField,target_user:this.commentItem.author}).then((t=>{"true"===t.data.result&&(this.$emit("closeDialg","replay"),this.$emit("refresh"),this.replayField="")}))}}},O=s(1001),M=(0,O.Z)(N,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("van-popup",{staticClass:"commentDialog",attrs:{value:t.commentDialogShow,"safe-area-inset-bottom":"",round:"",position:"bottom","get-container":"body","close-on-click-overlay":""},on:{"click-overlay":function(e){return t.closeDialog("comment")}}},[s("van-row",{staticClass:"description"},[s("van-col",{staticClass:"title",attrs:{span:"8"}},[t._v(" "+t._s(t.$t("micro.reply")+t.$t("micro.author"))+" ")]),s("van-col",{staticClass:"submit",attrs:{span:"8",offset:"8"}},[s("van-button",{staticClass:"releaseButton",style:{color:t.themeColor.primaryColor},attrs:{disabled:!t.commentField},on:{click:t.saveComment}},[t._v(" "+t._s(t.$t("common.release"))+" ")])],1)],1),s("van-field",{ref:"commentFieldRef",staticClass:"feileTextarea",attrs:{autofocus:"",autosize:{maxHeight:240,minHeight:180},type:"textarea"},model:{value:t.commentField,callback:function(e){t.commentField=e},expression:"commentField"}})],1),s("van-popup",{staticClass:"replayDialog",attrs:{value:t.replayDialogShow,"safe-area-inset-bottom":"",round:"",position:"bottom","get-container":"body","close-on-click-overlay":""},on:{"click-overlay":function(e){return t.closeDialog("replay")}}},[s("van-row",{staticClass:"description"},[s("van-col",{staticClass:"title",attrs:{span:"8"}},[t._v(" "+t._s(t.$t("micro.reply"))+" "),s("cl-custom-user",{attrs:{type:t.commentItem.author.source_type,"data-type":"userName",value:t.commentItem.author.user_id,name:t.commentItem.author.name}})],1),s("van-col",{staticClass:"submit",style:{color:t.replayField.trim().length?t.themeColor.primaryColor:"#7f849a"},attrs:{span:"8",offset:"8"},on:{click:t.saveReplay}},[t._v(" "+t._s(t.$t("common.release"))+" ")])],1),s("van-field",{ref:"replay",staticClass:"feileTextarea",attrs:{autofocus:"",autosize:{maxHeight:240,minHeight:180},type:"textarea"},model:{value:t.replayField,callback:function(e){t.replayField=e},expression:"replayField"}})],1)],1)}),[],!1,null,"3f955e7f",null).exports,B=s(67875),V={name:"Commentary",components:{SvgIcon:F.Z,replayPopup:M,[Z.Z.name]:Z.Z,[x.Z.name]:x.Z,[R.Z.name]:R.Z,[E.Z.name]:E.Z,[r.Z.name]:r.Z,[A.Z.name]:A.Z,[n.Z.name]:n.Z,[L.Z.name]:L.Z,[D.Z.Component.name]:D.Z.Component,ClCustomUser:q.Z,ClCustomDepartment:B.Z},props:{showComment:{type:Boolean,default:!1},courseInfo:{type:Object,default:()=>{}}},data:()=>({defaultAvatar:P,commentVal:"",deleteDialogShow:!1,dialogShow:{comment:!1,replay:!1},loading:!1,finished:!1,commentItem:{author:{name:""}},deleteTyle:"comment",replayId:"",params:{page_number:"1",page_size:"10"},commentArray:[],commentCount:0}),computed:(0,i.Z)({},(0,m.mapGetters)({userId:"getUserId",primaryColor:"getPrimaryColor"})),watch:{showComment:function(t){t&&this.getCommentaryCount()},commentCount:{handler(){this.$emit("updataCommentNum")}}},methods:{closeComment(){this.$emit("close")},closeDialg(t){this.dialogShow[t]=!1},getCommentaryCount(){const{getCommentaryCount:t}=I.Z;t({resource_id:this.courseInfo.id}).then((t=>{this.commentCount=t.data.count}))},getComment(t){t||(this.params.page_number="1");let e=Object.assign(this.params,{resource_id:this.courseInfo.id});I.Z.getCommentary(e).then((e=>{this.params.page_number++,this.finished="false"===e.data.has_next_page,this.getCommentaryCount(),t?(this.loading=!1,this.commentArray=[...this.commentArray,...e.data.list]):this.commentArray=[].concat(e.data.list)}))},getReplyId(t,e,s){this.commentItem=t,e&&(this.commentItem.id=s),this.$set(this.dialogShow,"replay",!0)},getCommentId(){this.$refs.commentTemp.blur(),this.$set(this.dialogShow,"comment",!0)},getDeleteId(t,e,s){this.deleteTyle=s,this.deleteDialogShow=!0,this.commentId=t,this.replayId=e},deleteItem(){"comment"===this.deleteTyle?I.Z.removeCommentary({comment_id:this.commentId}).then((t=>{"true"===t.data.result&&this.getComment()})):I.Z.removeReplay({commentId:this.commentId,reply_id:this.replayId}).then((t=>{"true"===t.data.result&&this.getComment()}))}}},U=(0,O.Z)(V,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("van-popup",{staticClass:"comment-popup",style:{height:"60%"},attrs:{value:t.showComment,"safe-area-inset-bottom":"",round:"",position:"bottom","get-container":"body","close-on-click-overlay":!1,closeable:""},on:{"click-close-icon":t.closeComment}},[s("p",{staticClass:"title"},[t._v(t._s(t.$t("micro.comment")+"("+t.commentCount+t.$t("micro.item")+")"))]),s("div",{staticClass:"commentListWrap"},[s("van-list",{attrs:{finished:t.finished,"loading-text":t.$t("common.loading"),"finished-text":t.$t("micro.noMore")},on:{load:function(e){return t.getComment("next")}},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.commentArray,(function(e){return s("van-cell",{key:e.id},[s("p",{staticClass:"avatar"},[s("van-image",{attrs:{round:"",width:"30px",height:"30px",src:e.author.avatar||t.defaultAvatar,fit:"cover"}}),s("span",{staticClass:"name"},[s("cl-custom-user",{attrs:{type:e.author.source_type,"data-type":"userName",value:e.author.user_id,name:e.author.name}})],1),s("span",{staticClass:"orgName"},[e.author.user_info&&e.author.user_info.department_info?s("cl-custom-department",{attrs:{"display-all":!0,list:e.author.user_info.department_info}}):t._e(),s("span",[t._v("("+t._s(e.author.department)+")")])],1)],1),s("p",{staticClass:"commentContent"},[t._v(" "+t._s(e.content)+" ")]),s("van-row",{attrs:{type:"flex",justify:"space-between"}},[s("van-col",{attrs:{span:12}},[t._v(t._s(e.date_str))]),t.userId===e.author.id?s("van-col",{staticClass:"operate-delete",attrs:{span:6},on:{click:function(s){return t.getDeleteId(e.id,"","comment")}}},[s("svg-icon",{attrs:{size:16,"icon-class":"icon-icon_delex",color:"#C0C2CB"}}),t._v(t._s(t.$t("micro.delete")))],1):t._e(),s("van-col",{staticClass:"operate-reply",attrs:{span:6},on:{click:function(s){return t.getReplyId(e)}}},[s("svg-icon",{attrs:{size:16,"icon-class":"icon-huifu",color:"#C0C2CB"}}),t._v(t._s(t.$t("micro.reply")))],1)],1),e.reply&&e.reply.length?s("div",{staticClass:"secondCommentWrap"},t._l(e.reply,(function(a){return s("div",{key:a.id,staticClass:"secondComment"},[s("p",{staticClass:"avatar"},[s("van-image",{attrs:{round:"",width:"20px",height:"20px",src:a.author.avatar||t.defaultAvatar,fit:"cover"}}),s("span",{staticClass:"name"},[s("cl-custom-user",{attrs:{type:a.author.source_type,"data-type":"userName",value:a.author.user_id,name:a.author.name}})],1),s("span",{staticClass:"right"},[s("svg-icon",{attrs:{size:16,"icon-class":"icon-right",color:"#C0C2CB"}})],1),s("van-image",{attrs:{round:"",width:"20px",height:"20px",src:a.target.avatar||t.defaultAvatar,fit:"cover"}}),s("span",{staticClass:"name"},[s("cl-custom-user",{attrs:{type:a.target.source_type,"data-type":"userName",value:a.target.user_id,name:a.target.name}})],1)],1),s("p",{staticClass:"commentContent"},[t._v(t._s(a.content))]),s("van-row",{attrs:{type:"flex",justify:"space-between"}},[s("van-col",{attrs:{span:12}},[t._v(t._s(a.date_str))]),t.userId===a.author.id?s("van-col",{staticClass:"operate-reply",attrs:{span:6},on:{click:function(s){return t.getDeleteId(e.id,a.id,"replay")}}},[s("svg-icon",{attrs:{size:16,"icon-class":"icon-icon_delex",color:"#C0C2CB"}}),t._v(t._s(t.$t("micro.delete")))],1):t._e(),s("van-col",{staticClass:"operate-reply",attrs:{span:6},on:{click:function(s){return t.getReplyId(a,!0,e.id)}}},[s("svg-icon",{attrs:{size:16,"icon-class":"icon-huifu",color:"#C0C2CB"}}),t._v(t._s(t.$t("micro.reply")))],1)],1)],1)})),0):t._e()],1)})),1)],1),s("van-cell-group",{staticClass:"commentInputWrap"},[s("van-field",{ref:"commentTemp",attrs:{placeholder:t.$t("micro.comment")+"…"},on:{click:t.getCommentId},model:{value:t.commentVal,callback:function(e){t.commentVal=e},expression:"commentVal"}},[s("template",{slot:"left-icon"},[s("svg-icon",{attrs:{size:16,"icon-class":"icon-morecopy",color:"#7F849A"}})],1)],2)],1),s("van-dialog",{attrs:{"get-container":"body",title:t.$t("micro.deleteComment"),message:t.$t("micro.deleteSure"),"show-cancel-button":"","confirm-button-text":t.$t("common.confirm"),"cancel-button-text":t.$t("common.close"),"confirm-button-color":t.primaryColor,"cancel-button-color":"#000000"},on:{confirm:t.deleteItem},model:{value:t.deleteDialogShow,callback:function(e){t.deleteDialogShow=e},expression:"deleteDialogShow"}}),s("replay-popup",{attrs:{"course-info":t.courseInfo,"comment-dialog-show":t.dialogShow.comment,"replay-dialog-show":t.dialogShow.replay,"comment-item":t.commentItem},on:{closeDialg:t.closeDialg,refresh:t.getComment}})],1)}),[],!1,null,"66cc4748",null).exports,j=s(95969),z={name:"MicroWatchInfo",components:{[x.Z.name]:x.Z,[Z.Z.name]:Z.Z,[T.Z.name]:T.Z,[n.Z.name]:n.Z,commentary:U,SvgIcon:F.Z,ClCustomUser:q.Z},props:{courseInfo:{type:Object,default:()=>({})},info:{type:Object,default:()=>({})},studyType:{type:String,default:""}},data:function(){return{commonClass:"micro-watch-info",showComment:!1,resourceId:"",defaultAvatar:P,change:!0,isOpen:!0}},computed:(0,i.Z)((0,i.Z)({},(0,m.mapGetters)({primaryColor:"getPrimaryColor",access_token:"getToken"})),{},{dealLearnCount(){return this.courseInfo.learners&&this.courseInfo.learners.count||0},getColor(){return"like"===this.courseInfo.has_praised?this.primaryColor:"#FFFFFF"},isTask(){return"study_project"===this.studyType||"study"===this.studyType||"certification"===this.studyType||"review"===this.studyType}}),watch:{courseInfo(t,e){t.id!==e.id&&(this.change=!1,setTimeout((()=>{this.change=!0,this.getClassifyHeight()}),20))}},mounted(){this.$nextTick((()=>{this.getClassifyHeight()}))},methods:{async onPraise(){const t="like"===this.courseInfo.has_praised,{enterpriseCourseCommentPraise:e}=I.Z;await e({courseId:this.courseInfo.id,status:t}),this.$emit("getOneCourse",{courseId:this.courseInfo.id,resourceType:this.info.resource_type,onlyUpdate:!0})},onComment(t){"true"===this.info.is_new_version?this.showComment=t:(this.$emit("onStopPlay"),v.Z.navigateTo({url:`/pages/courseModules/course/study-project/comment-list/index?courseId=${this.courseInfo.id}&courseResource=enterprise&originPage=previewMicocourse`}))},toStudyingPeopleList(){this.$emit("onStopPlay"),this.$router.push(j.Z.studyProject.studyingPeopleList({courseId:this.courseInfo.id}))},toSomeone(){this.$router.push(`/micro-someone/${this.courseInfo.update_user}?access_token=${this.access_token}&avatar=${this.courseInfo.update_user_avatar}`)},updataCommentNum(){this.$emit("getOneCourse",{courseId:this.courseInfo.id,resourceType:this.info.resource_type,onlyUpdate:!0})},getClassifyHeight(){const{node:t}=this.$refs;if(t){const e=t.offsetHeight;this.isOpen=e<=20,this.$forceUpdate()}},changeOpen(){this.isOpen=!this.isOpen}}},H=(0,O.Z)(z,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:"review"===t.studyType?t.commonClass+" micro-watch-reviews":t.commonClass},[t.isTask?t._e():s("div",{class:t.commonClass+"-study",style:{backgroundColor:t.primaryColor},on:{click:t.toStudyingPeopleList}},[t._v(" "+t._s(t.dealLearnCount)+t._s(t.$t("micro.learnNumber"))+" "),s("svg-icon",{attrs:{size:12,"icon-class":"icon-right",color:"#FFFFFF"}})],1),s("div",{class:t.commonClass+"-desc"},[s("span",[t._v(" "+t._s(t.courseInfo.summary))]),"review"!==t.studyType?[t._v(" # "),s("span",[t._v(t._s(t.courseInfo.course_classify_name))])]:t._e()],2),s("div",{class:t.commonClass+"-title"},[t._v(" "+t._s(t.courseInfo.title)+" ")]),"review"===t.studyType&&t.courseInfo.classify_name?s("div",{class:t.commonClass+"-classify"},[s("div",{ref:"node",class:t.commonClass+"-classify-name "+(t.isOpen?null:"open")},[t._v("# "+t._s(t.courseInfo.classify_name))]),t.isOpen?t._e():s("div",{class:t.commonClass+"-classify-btn",style:{color:t.primaryColor},on:{click:t.changeOpen}},[t._v(t._s(t.$t("attestation.open")))])]):t._e(),s("van-row",{class:t.commonClass+"-bottom"},[s("van-col",{class:t.commonClass+"-bottom-left",attrs:{span:"16"}},[s("van-image",{class:t.commonClass+"-bottom-left-icon",attrs:{round:"",fit:"cover",height:t._f("pxTransToVw")(40),width:t._f("pxTransToVw")(40),src:t.courseInfo.update_user_avatar||t.defaultAvatar},on:{click:t.toSomeone}}),s("span",{class:t.commonClass+"-bottom-name",on:{click:t.toSomeone}},[t.change?s("cl-custom-user",{attrs:{type:t.courseInfo.update_user_source_type,"data-type":"userName",value:t.courseInfo.update_user_sync_user_id,name:t.courseInfo.update_user_name||t.$t("common.no")}}):t._e()],1)],1),s("van-col",{class:t.commonClass+"-bottom-right",attrs:{span:"8"}},["review"!==t.studyType?s("div",{class:t.commonClass+"-bottom-right-some",on:{click:t.onPraise}},[s("div",{class:t.commonClass+"-bottom-right-some-icons"},[s("svg-icon",{attrs:{size:26,"icon-class":"icon-zan2",color:t.getColor}})],1),s("p",[t._v(t._s(t.courseInfo.like_count))])]):t._e(),"review"!==t.studyType?s("div",{class:t.commonClass+"-bottom-right-some",on:{click:function(e){return t.onComment(!0)}}},[s("div",{class:t.commonClass+"-bottom-right-some-icons"},[s("svg-icon",{attrs:{size:26,"icon-class":"icon-pinglun",color:"#FFFFFF"}})],1),s("p",[t._v(t._s(t.courseInfo.comment_count))])]):t._e(),"list"===t.studyType||"my_course"===t.studyType||"other"===t.studyType||"scanCode"===t.studyType?s("div",{class:t.commonClass+"-bottom-right-some",on:{click:function(e){return t.$emit("onShowShare")}}},[s("div",{class:t.commonClass+"-bottom-right-some-icons"},[s("van-icon",{staticClass:"iconfont",attrs:{name:"share",color:"#FFFFFF",size:28}})],1)]):t._e()])],1),s("commentary",{attrs:{"show-comment":t.showComment,"course-info":t.courseInfo},on:{close:function(e){return t.onComment(!1)},updataCommentNum:t.updataCommentNum}})],1)}),[],!1,null,"22e157ad",null).exports,G=s(35093),Q={name:"CoverPlay",components:{[n.Z.name]:n.Z},props:{info:{type:Object,default:()=>{}},showCover:{type:Boolean,default:!1},showPlay:{type:Boolean,default:!1},resourceType:{type:String,default:""}},data:function(){return{playIcon:G}},methods:{timeOutPause(){this.$emit("timeOutPause")}}},W=(0,O.Z)(Q,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"cover-play"},[s("transition",{attrs:{name:"feed-transition"}},[t.showCover?s("van-image",{staticClass:"cover-play-cover",attrs:{width:"100%",height:"100%",fit:"cover",src:t.info.cover}}):t._e()],1),s("transition",{attrs:{name:"feed-transition"}},[t.showPlay?s("van-image",{staticClass:"cover-play-play",attrs:{width:t._f("pxTransToVw")(50),height:t._f("pxTransToVw")(50),fit:"cover",src:t.playIcon},on:{click:t.timeOutPause}}):t._e()],1),"video"===t.resourceType?s("div",{staticClass:"cover-play-playbg",on:{click:t.timeOutPause}}):t._e()],1)}),[],!1,null,"90261a0c",null).exports,K=s(71522),J={components:{[n.Z.name]:n.Z},props:{source:{type:Object,default:()=>{}}},data:()=>({realCover:""}),mounted(){"ALIBABA_PRIVATE"===this.source.storage_type?this.handleError():this.realCover=this.source.cover},methods:{clickSwitch(){this.$emit("clickSwitch")},handleError(){const{source:t}=this;"ALIBABA_PRIVATE"===t.storage_type&&K.Z.getPrivateImgUrl(t.video_id).then((({data:t})=>{0===t.code&&(this.realCover=t.data.docResourceDownloadUrl)}))}}},Y=(0,O.Z)(J,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.realCover?s("div",[s("van-image",{staticClass:"micro-watch-audio-opacity",attrs:{width:"100%",height:"100%",fit:"cover",src:t.realCover},on:{error:t.handleError}}),s("van-image",{staticClass:"micro-watch-audio-cover",attrs:{width:"100%",height:"100%",fit:"contain",src:t.realCover},on:{click:t.clickSwitch}})],1):t._e()}),[],!1,null,"1662f470",null).exports,X={name:"MicroAudio",components:{[l.Z.name]:l.Z,[c.Z.name]:c.Z,[n.Z.name]:n.Z,SwiperImage:Y},props:{courseInfo:{type:Object,default:()=>{}},currentImage:{type:Number,default:0},currentAudio:{type:Number,default:0},playOrPause:{type:Boolean,default:!1},studyType:{type:String,default:""}},computed:(0,i.Z)({},(0,m.mapGetters)({primaryColor:"getPrimaryColor"})),mounted(){},methods:{onChange(t){this.$emit("changeImage",t)},clickSwitch(){this.$emit("clickSwitch")},swipeToNext(){this.$refs.swipe.next()},funInitData(){if(!this.courseInfo||!this.courseInfo.resources)return"";this.courseInfo.resources.forEach((t=>{"ALIBABA_PRIVATE"===t.storage_type&&K.Z.getPrivateImgUrl(t.video_id).then((({data:e})=>{0===e.code&&(t.cover=e.data.docResourceDownloadUrl)}))}))}}},tt=(0,O.Z)(X,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("van-swipe",{ref:"swipe",attrs:{width:"100%",height:"100%","initial-swipe":t.currentImage,loop:!1,"indicator-color":t.primaryColor},on:{change:t.onChange}},t._l(t.courseInfo.resources,(function(e,a){return s("van-swipe-item",{key:a,staticClass:"common-swiper"},[s("div",{staticClass:"micro-watch-audio-background"},[s("SwiperImage",{key:e.video_id,attrs:{source:e},on:{clickSwitch:t.clickSwitch}}),s("div",{staticClass:"micro-watch-audio-content"},t._l(e.audios,(function(e,i){return s("div",{key:i,staticClass:"micro-watch-audio-content-player"},[s("div",{class:"voice-bg "+(t.playOrPause&&a===t.currentImage&&i===t.currentAudio?"voicePlay":"")}),s("p",[t._v(t._s(e.duration))]),"preview"!==t.studyType&&"review"!==t.studyType&&"false"===e.state?s("span",{staticClass:"micro-watch-audio-content-player-pointer"}):t._e()])})),0)],1)])})),1)}),[],!1,null,"369de8b2",null),et=tt.exports,st={name:"MicroAction",components:{[h.Z.name]:h.Z},props:{studyType:{type:String,default:""},queryInfo:{type:Object,default:()=>{}}},computed:(0,i.Z)({},(0,m.mapGetters)({primaryColor:"getPrimaryColor"})),methods:{releaseAudio(){this.$emit("releaseAudio")},deal(t){this.$emit("clear"),this.$router.push({path:j.Z.course.courseApproval(),query:{type:t,operationId:this.queryInfo.approvalId}})}}},at=(0,O.Z)(st,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"micro-action"},["preview"===t.studyType?s("van-button",{staticClass:"micro-action-button",attrs:{type:"primary",block:"",color:t.primaryColor},on:{click:t.releaseAudio}},[t._v(t._s(t.$t("common.release")))]):t._e(),"review"===t.studyType?s("van-button",{staticClass:"micro-action-button micro-action-danger",attrs:{type:"primary",block:"",color:"#D64F4F"},on:{click:function(e){return t.deal("deny")}}},[t._v(t._s(t.$t("common.turnDown")))]):t._e(),"review"===t.studyType?s("van-button",{staticClass:"micro-action-button micro-action-pass",attrs:{type:"primary",block:"",color:"#465DCD"},on:{click:function(e){return t.deal("pass")}}},[t._v(t._s(t.$t("common.pass")))]):t._e()],1)}),[],!1,null,"0204f3b4",null).exports,it=s(94864),ot=s(88095),rt=s(68728);const nt=["studyType","resourceId","currentType"];var ct={name:"MicroWatch",components:{[h.Z.name]:h.Z,[d.Z.name]:d.Z,[u.Z.name]:u.Z,[l.Z.name]:l.Z,[c.Z.name]:c.Z,[n.Z.name]:n.Z,VanPopup:r.Z,MicroWatchInfo:H,CommonAudio:w.Z,MicroAudio:et,CoverPlay:W,MicroAction:at,ClWaterMark:$.Z,ApprovalProcess:ot.default,ClResult:k.Z,ClShare:S.Z},data:function(){return{current:0,currentType:"",isNewVersion:"true",processInterval:null,list:[],microCoursesParams:{page_number:1,page_size:3,sort:"newest"},finished:!1,courseInfo:{resources:[]},showCover:!0,showPlay:!1,playOrPause:!1,videoProcess:0,playerUrl:"",currentAudio:0,currentImage:0,everyPlay:!1,studyType:"",queryInfo:{},videoPlayProgres:0,showProgress:!1,ua:(0,C.ij)(),system:(0,C.Os)(),learningTimer:null,batchNumber:"",courseId:"",funRepeatGetPrivateCount:0,privateUrlTimer:null,showApprovalProcess:!1,businessId:"",title:"",templates:"",versions:"",releaseBtn:0,showShare:!1,isShowResult:!1,resultParams:{},loading:!0,shareFrom:rt.ud}},watch:{fresh(t){t&&(this.getOneCourse(!0),this.$store.commit("microCourse/updateFresh",!1))},appVisible(t){t?this.playingRecordLearningTime():this.pauseRecordLearningTime()}},mounted(){const t=(0,y.DP)(),{studyType:e="list",resourceId:s,currentType:a}=t,i=(0,o.Z)(t,nt);this.studyType=e,this.queryInfo=i,this.courseId=this.$route.params.id,"review"===e||"study"===e||"study_project"===e||"certification"===e?("review"===e&&(document.title=this.$t("pageTitle.microCourseReview")),this.getOneCourse()):"preview"===e?(document.title=this.$t("pageTitle.microCoursePreview"),this.currentType=a,this.previewAndPlay(this.microCourseInfo,a)):"list"!==e&&"my_course"!==e&&"scanCode"!==e&&"other"!==e||(this.getMicroList(!0),I.Z.addPlayCount({courseId:this.courseId}),I.Z.addScanCount({courseId:this.courseId}))},beforeDestroy(){clearInterval(this.learningTimer),this.learningTimer=null,this.playOrPause&&this.recordLearningTime(),clearInterval(this.processInterval),this.stopAudioDing(),this.commonClear(),clearInterval(this.privateUrlTimer),this.privateUrlTimer=null,this.funRepeatGetPrivateCount=0},computed:(0,i.Z)((0,i.Z)({},(0,m.mapGetters)({primaryColor:"getPrimaryColor",env:"getEnv",isPure:"getIsPure",fresh:"microCourse/getFreshStatus",microCourseInfo:"microCourse/getMicroCourseInfo"})),(0,m.mapState)(["appVisible"])),methods:{async getMicroList(t=!1){this.microCoursesParams.courseId=this.courseId,this.microCoursesParams.sort=this.$route.params.sort||"newest",this.queryInfo.creator&&(this.microCoursesParams.creator=this.queryInfo.creator),this.queryInfo.keyword&&(this.microCoursesParams.keyword=this.queryInfo.keyword);const e=await I.Z.getMicroCoursesList(this.microCoursesParams),s=e.data.list;this.list="list"===this.studyType?[...this.list,...s]:s.filter((t=>t.id===this.courseId)),this.finished="list"!==this.studyType||"false"===e.data.has_next_page,this.list.length>0&&t&&(this.currentType=this.list[this.current].resource_type,this.isNewVersion=this.list[this.current].is_new_version),t&&this.getOneCourse()},async getOneCourse(t=!1){const{app_type:e}=(0,y.DP)(),s="review"===this.studyType||"study"===this.studyType||"study_project"===this.studyType||"certification"===this.studyType;try{const i=await I.Z.getStudyMicroCourse({studyType:this.studyType,studyId:this.queryInfo.studyId,courseId:this.courseId,app_type:e});if(this.loading=!1,s&&(this.isNewVersion="review"===this.studyType?"true":i.data.is_new_version,this.list=[{cover:i.data.cover,resource_type:i.data.resource_type,is_new_version:this.isNewVersion}],this.currentType=i.data.resource_type,this.finished=!0),this.getPrivateResource(i.data),!t)if(this.showCover=!1,"video"===this.currentType){const{url:t,storage_type:e,video_id:s}=i.data.resources[0];this.playerUrl=-1===t.indexOf("https")?t.replace("http","https"):t,"ALIBABA_PRIVATE"===e&&(a.Z.loading({duration:0,forbidClick:!0,message:"",overlay:!0}),this.funRepeatGetPrivate(s)),this.playAudio(i)}else"image"===this.currentType&&("h5"===this.env?this.showPlay=!0:this.voicePlay())}catch(t){console.error(t),this.loading=!1,this.isShowResult=!0,t.data&&"enterpriseapi.4003"===t.data.code?this.resultParams={type:"403",title:this.$t("share.noPermission"),description:this.$t("share.noPermissionTip")}:"enterpriseapi.4001"===t.data.code?this.resultParams={type:"404",title:this.$t("course.resourceNotFound"),buttons:[{type:"text",text:this.$t("common.back"),callBack:()=>{this.$router.go(-1)}}]}:"enterpriseapi.503010"===t.data.code?this.resultParams={type:"404",description:this.$t("share.courseRemoved")}:this.resultParams={type:"error",title:this.$t("promptMessage.systemError"),description:t.data.message}}},async getPrivateResource(t){"image"===this.currentType&&t.resources.forEach((t=>{"ALIBABA_PRIVATE"===t.storage_type&&K.Z.getPrivateImgUrl(t.video_id).then((({data:e})=>{0===e.code&&(t.cover=e.data.docResourceDownloadUrl)}))})),this.courseInfo=t},async funRepeatGetPrivate(t,e){let{data:s}=await it.Z.privateVodDownloadUrl({videoId:t});if(0===s.code){if(a.Z.clear(),e)return s.data.videoPlayInfo;this.playerUrl=s.data.videoPlayInfo,this.playAudio()}else{if(404!==s.code)return a.Z.clear(),void this.$toast(this.$t("micro.voiceDownloadError"));this.funRepeatGetPrivateCount=this.funRepeatGetPrivateCount+1,this.funRepeatGetPrivateCount<6?this.privateUrlTimer=setTimeout((()=>{this.funRepeatGetPrivate(t)}),1e3):(this.funRepeatGetPrivateCount=0,a.Z.clear(),this.$toast(this.$t("micro.voiceDownloadError")))}},async funGetImage(t){K.Z.getPrivateImgUrl(t).then((({data:t})=>{if(0===t.code)return a.Z.clear(),t.data.docResourceDownloadUrl;a.Z.clear()}))},playAudio(t){this.$nextTick((()=>{if("h5"===this.env){a.Z.clear(),this.showPlay=!0;const{isPlaying:t}=this.$refs.video[0];this.playOrPause=t}else this.timeOutPause();"review"!==this.studyType&&this.saveProgress(t.data.resources[0].recent_start,t.data.resources[0].progress)}))},async previewAndPlay(t,e){if(this.list=[{cover:t.cover,resource_type:e,is_new_version:"image"===e?this.queryInfo.isNewVersion:"true"}],this.loading=!1,this.currentType=e,this.isNewVersion="image"===e?this.queryInfo.isNewVersion:"true",this.finished=!0,this.courseInfo=t,this.showCover=!1,"video"===e){let e;if("ALIBABA_PRIVATE"===(t.resources[0].storageType||t.resources[0].storage_type))a.Z.loading({duration:0,forbidClick:!0,message:"",overlay:!0}),e=await this.funRepeatGetPrivate(t.resources[0].video_id,!0);else{e=(await I.Z.getResourceStatusVideo(t.resources[0].id)).data.url}if(!e)return;this.playerUrl=-1===e.indexOf("https")?e.replace("http","https"):e,this.$nextTick((()=>{"h5"===this.env?(a.Z.clear(),this.showPlay=!0):this.timeOutPause()}))}else"image"===e&&("h5"===this.env?this.showPlay=!0:this.voicePlay())},onChange(t){let e="video"===this.currentType?this.$refs.video[0].getPlayer():document.getElementById(`player${this.current}`);e&&e.pause(),clearInterval(this.learningTimer),this.learningTimer=null,this.playOrPause&&this.recordLearningTime(),this.stopAudioDing(),clearInterval(this.processInterval),this.playerUrl="",this.showProgress=!1,this.videoProcess=0,this.videoPlayProgres=0,this.playOrPause=!1,this.showPlay=!1,this.showCover=!0,this.currentAudio=0,this.currentImage=0,this.current=t,this.currentType=this.list[this.current].resource_type,this.isNewVersion=this.list[this.current].is_new_version,this.courseId=this.list[this.current].id,this.getOneCourse(),t!==this.list.length-1||this.finished||(this.microCoursesParams.page_number+=1,this.getMicroList())},timeOutPause(){setTimeout((()=>{this.pausePlayer()}),0)},stopAudioDing(){if("image"===this.currentType&&"false"===this.isNewVersion){if(this.courseInfo.resources[this.currentImage].audios[this.currentAudio].sub_id)return;"dingtalk_miniprogram"===this.ua?v.Z.audioStop({url:this.playerUrl}):"dingtalk_browser"===this.ua&&p.device.audio.stop({localAudioId:this.playerUrl})}},async voicePlay(){const t=this.courseInfo.resources[this.currentImage].audios[this.currentAudio].sub_id;if("true"===this.isNewVersion||t){if(!t)return void this.$toast(this.$t("micro.voiceGetError"));const e=await I.Z.getResourceStatus({resourceId:t}),{transcoding_result:s,resources:i}=e.data;if("true"===s){let t="";if("ALIBABA_PRIVATE"===(i[0].storageType||i[0].storage_type)?(a.Z.loading({duration:0,forbidClick:!0,message:"",overlay:!0}),t=await this.funRepeatGetPrivate(i[0].video_id,!0)):t=i[0].url,!t)return;this.playerUrl=-1===t.indexOf("https")?t.replace("http","https"):t,this.timeOutPause()}else this.$toast(this.$t("micro.voiceTranscode")),this.showPlay=!0}else{const{url:t}=this.courseInfo.resources[this.currentImage].audios[this.currentAudio];if("dingtalk_miniprogram"===this.ua)v.Z.audioDownload({url:t},(t=>{this.playerUrl=t,this.everyPlay=!1,this.playOrPause=!0,this.playingRecordLearningTime(),v.Z.audioPlayEnd({url:this.playerUrl},(t=>{v.Z.audioStop({url:t}),this.pauseRecordLearningTime(),this.onPlayerEnded()}))}),(()=>{this.$toast(this.$t("micro.voiceDownloadError"))}));else{if("dingtalk_browser"!==this.ua)return this.showPlay=!0,this.$toast(this.$t("micro.notPlayInH5"));p.device.audio.download({mediaId:t,onSuccess:t=>{this.playerUrl=t.localAudioId,p.device.audio.play({localAudioId:this.playerUrl,onSuccess:()=>{this.everyPlay=!1,this.playOrPause=!0,this.playingRecordLearningTime(),p.device.audio.onPlayEnd({onSuccess:t=>{p.device.audio.stop({localAudioId:t.localAudioId}),this.pauseRecordLearningTime(),this.onPlayerEnded()}})}})},onFail:()=>{this.$toast(this.$t("micro.voiceTranscode"))}})}}const e=this.courseInfo.resources[this.currentImage];"review"!==this.studyType&&"preview"!==this.studyType&&this.saveProgress(e.recent_start,e.progress)},commonPlay(){let t=null;if("image"===this.currentType&&(t=this.courseInfo.resources[this.currentImage].audios[this.currentAudio].sub_id),"video"===this.currentType)this.timeOutPause();else if("true"===this.isNewVersion||t)this.showPlay=!this.showPlay,this.voicePlay();else{if(-1===navigator.userAgent.toLowerCase().indexOf("dingtalk"))return this.$toast(this.$t("micro.notPlayInH5"));this.showPlay=!this.showPlay,this.everyPlay?this.voicePlay():this.audioOldPlay()}},pausePlayer(){let t="video"===this.currentType?this.$refs.video[0].getPlayer():document.getElementById(`player${this.current}`);this.playOrPause?(t.pause(),"video"===this.currentType&&clearInterval(this.processInterval)):(t.play(),"video"===this.currentType&&100!==this.courseInfo.progress&&(this.processInterval=setInterval((()=>{this.changeProcess()}),3e3)))},audioOldPlay(){this.playOrPause?("dingtalk_miniprogram"===this.ua?v.Z.audioPause({url:this.playerUrl}):p.device.audio.pause({localAudioId:this.playerUrl}),this.pauseRecordLearningTime()):("dingtalk_miniprogram"===this.ua?v.Z.audioResume({url:this.playerUrl}):p.device.audio.resume({localAudioId:this.playerUrl}),this.playingRecordLearningTime()),this.playOrPause=!this.playOrPause},changeProcess(t){if("preview"===this.studyType||"review"===this.studyType)return;const{resources:e}=this.courseInfo;let s="";if("image"===this.currentType)this.videoProcess=(0,_.M$)(this.courseInfo,e[this.currentImage].id),s=this.videoProcess;else{const t=this.$refs.video[0].getPlayer();s=t.currentTime().toFixed(0),this.videoProcess=parseInt(100*(t.currentTime().toFixed(1)/t.duration().toFixed(1)).toFixed(2),10)}"list"!==this.studyType&&"list"===this.studyType||!this.videoProcess||this.saveProgress(s,t||this.videoProcess)},async saveProgress(t,e){const s=this.courseInfo.resources["video"===this.currentType?0:this.currentImage].id,a=await I.Z.saveVideoProgress({courseId:this.courseId,resourceId:s,studyType:this.studyType,studyId:this.queryInfo.studyId,mapId:this.queryInfo.mapId},{progress:e,recent_start:t}),{progress:i,integral_info:o}=a.data;Number(i)>=100&&o&&this.$toast(o)},commonClear(){let t="video"===this.currentType?this.$refs.video[0].getPlayer():document.getElementById(`player${this.current}`);t&&t.pause(),this.videoProcess=0,this.playOrPause=!1,this.showPlay=!0,this.currentAudio=0,this.currentImage=0,this.everyPlay=!0},async onPlayerEnded(){if("image"===this.currentType){const t="study_project"===this.studyType||"study"===this.studyType||"certification"===this.studyType,{resources:e}=this.courseInfo,{audios:s}=e[this.currentImage],a=this.currentImage===e.length-1,i=this.currentAudio===s.length-1;this.courseInfo.resources[this.currentImage].audios[this.currentAudio].state="true",this.playOrPause=!1,this.changeProcess(),"preview"!==this.studyType&&"review"!==this.studyType&&await I.Z.saveAudioRecord({resourceId:e[this.currentImage].id,subResourceId:s[this.currentAudio].id,planId:this.queryInfo.studyId,isTask:t}),a&&i?(this.commonClear(),this.everyPlay=!0):!a&&i?this.$refs.swiper[this.current].swipeToNext():(this.currentAudio+=1,this.voicePlay())}else this.changeProcess(100),this.videoPlayProgres=100,clearInterval(this.processInterval),this.commonClear(),this.timeOutPause();"preview"!==this.studyType&&"review"!==this.studyType&&100!==this.courseInfo.progress&&this.getOneCourse(!0)},changeImage(t){const e=this.courseInfo.resources[this.currentImage].audios[this.currentAudio].sub_id;if("true"===this.isNewVersion||e){let t=document.getElementById(`player${this.current}`);t&&t.pause()}else"dingtalk_miniprogram"===this.ua?v.Z.audioPause({url:this.playerUrl}):"dingtalk_browser"===this.ua&&p.device.audio.pause({localAudioId:this.playerUrl});this.showPlay=!1,this.playOrPause=!1,this.currentImage=t,this.currentAudio=0,this.voicePlay()},onPlay(){this.showProgress=!1,this.showPlay=!1,this.playOrPause=!0,this.playingRecordLearningTime()},onPause(){"video"===this.currentType&&(this.showProgress=!0,this.showPlay=!0,this.changeProcess()),this.pauseRecordLearningTime(),this.playOrPause=!1},async releaseAudio(){if(this.releaseBtn>0)return;this.releaseBtn+=1,this.playOrPause=!1;const{editType:t}=this.queryInfo;a.Z.loading({duration:0,forbidClick:!0,message:this.$t("common.loading"),overlay:!0});const{data:e}=await I.Z.publishMicroCourse({editType:t,courseInfo:this.courseInfo,courseId:this.courseId,editStatus:"release",operateType:"image"===this.currentType?"voice":this.currentType}),{state:s,course:o,approval_template:r}=e.data;"true"===s?(this.businessId=o[0].course_id,this.title=o[0].course_name,this.templates=r.template_id,this.versions=r.template_version,this.showApprovalProcess=!0,this.$toast({message:this.$t("micro.releaseSuccessful2"),position:"top",className:"top10"}),this.releaseBtn=0,t||(this.courseId=o[0].course_id,this.queryInfo.editType="edit",this.$store.commit("microCourse/updateMicroCourse",(0,i.Z)((0,i.Z)({},this.courseInfo),{},{id:o[0].course_id,name:o[0].course_name})))):(this.commonClear(),a.Z.clear(),this.$toast(this.$t("common.releaseSuccess")),this.$router.go(-2))},refreshProgress(t){this.videoPlayProgres=t},onStopPlay(){if("video"===this.currentType){let t=this.$refs.video[0].getPlayer();t&&t.pause()}},playingRecordLearningTime(){clearInterval(this.learningTimer),this.learningTimer=null,this.learningTimer||(this.batchNumber=(0,g.Z)(),this.recordLearningTime(),clearInterval(this.learningTimer),this.learningTimer=null,this.learningTimer=setInterval((()=>{this.playOrPause?this.recordLearningTime():(clearInterval(this.learningTimer),this.learningTimer=null)}),f.If))},pauseRecordLearningTime(){clearInterval(this.learningTimer),this.learningTimer=null,this.playOrPause&&this.recordLearningTime()},async recordLearningTime(){const t=this.studyType,e={courseId:this.courseId,resourceId:this.courseInfo.resources["video"===this.currentType?0:this.currentImage].id,studyId:this.queryInfo.studyId},s={batchNumber:this.batchNumber};try{await b.Z.postClassHourTiming(t,e,s)}catch(t){console.warn(t)}},hideApprovalProcessPopup(){this.showApprovalProcess=!1},goBack(){this.$router.go(-2)},onShowShare(){this.showShare=!0},onCloseShareSheet(){this.showShare=!1}}},lt=ct,ut=(0,O.Z)(lt,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"micro-watch"},[t.loading?s("van-loading",{staticClass:"cl-page-container-loading",attrs:{size:"36"}}):[t.isShowResult?s("cl-result",{attrs:{title:t.resultParams.title,description:t.resultParams.description,buttons:t.resultParams.buttons}}):[s("van-swipe",{staticClass:"micro-watch-swipe",attrs:{width:"100%",height:"100%",vertical:"","initial-swipe":t.current,loop:!1,"show-indicators":!1},on:{change:t.onChange}},t._l(t.list,(function(e,a){return s("van-swipe-item",{key:a,staticClass:"common-swiper"},["image"===e.resource_type?s("div",{staticClass:"micro-watch-audio"},[t.current===a?s("common-audio",{attrs:{"player-id":"player"+a,"player-url":t.playerUrl},on:{onPlayerEnded:t.onPlayerEnded,onPlay:t.onPlay,onPause:t.onPause}}):t._e(),s("micro-audio",{ref:"swiper",refInFor:!0,attrs:{"study-type":t.studyType,"course-info":t.courseInfo,"current-image":t.currentImage,"current-audio":t.currentAudio,"play-or-pause":t.playOrPause},on:{changeImage:t.changeImage,clickSwitch:t.commonPlay}})],1):s("div",{staticClass:"micro-watch-video"},[t.current===a?s("cool-video",{ref:"video",refInFor:!0,attrs:{"player-id":"player"+a,src:t.playerUrl,controls:!1,"content-type":t.currentType,"show-big-play-btn":!1},on:{onPlayerEnded:t.onPlayerEnded,onPlay:t.onPlay,onPause:t.onPause,onClick:t.commonPlay,refreshProgress:t.refreshProgress}}):t._e(),s("cl-water-mark",{attrs:{scenes:"video"}})],1),s("cover-play",{attrs:{info:e,"resource-type":e.resource_type,"show-cover":t.current===a&&t.showCover||t.current!==a,"show-play":t.showPlay},on:{timeOutPause:t.commonPlay}}),"preview"!==t.studyType&&("image"===e.resource_type&&t.showPlay||"video"===e.resource_type)?s("micro-watch-info",{attrs:{info:e,"study-type":t.studyType,"course-info":t.courseInfo},on:{getOneCourse:t.getOneCourse,onStopPlay:t.onStopPlay,onShowShare:t.onShowShare}}):t._e(),t.showProgress&&"video"===e.resource_type&&!t.playOrPause?s("div",{staticClass:"micro-watch-progress"},[s("van-progress",{attrs:{"show-pivot":!1,percentage:t.videoPlayProgres,"stroke-width":"4",color:"#fff","track-color":"rgba(255, 255, 255, 0.45)"}})],1):t._e()],1)})),1),"preview"===t.studyType&&"image"===t.currentType||"review"===t.studyType?s("micro-action",{attrs:{"study-type":t.studyType,"query-info":t.queryInfo},on:{releaseAudio:t.releaseAudio,clear:t.commonClear}}):t._e(),s("cl-share",{attrs:{from:t.shareFrom,show:t.showShare,"share-params":{pc_url:"/miniCourse/watch?courseId="+t.courseInfo.id+"&isNewVersion="+t.isNewVersion+"&classifyId="+t.courseInfo.course_classify,mobile_url:"/micro-watch/"+t.courseInfo.id+"/newest?studyType="+t.studyType,pc_type:"student",mobile_type:"h5",is_auth_enterprise:!0},title:t.courseInfo.title,desc:t.courseInfo.summary,site1:{type:"resource_count",label:t.$t("course.courseware"),value:t.courseInfo.resourceCount},"image-url":t.courseInfo.cover,isShareMsg:"list"===t.studyType||"my_course"===t.studyType||"other"===t.studyType||"scanCode"===t.studyType},on:{closeShareSheet:t.onCloseShareSheet}})]],s("van-popup",{style:{height:"80%"},attrs:{position:"bottom","close-on-click-overlay":!1},model:{value:t.showApprovalProcess,callback:function(e){t.showApprovalProcess=e},expression:"showApprovalProcess"}},[t.showApprovalProcess?s("approval-process",{attrs:{"biz-type":"course_task","business-id":t.businessId,title:t.title,content:JSON.stringify({courseId:t.businessId,classifyType:"micro_course"}),templates:t.templates,versions:t.versions},on:{onCancel:t.hideApprovalProcessPopup,onSuccess:t.goBack}}):t._e()],1)],2)}),[],!1,null,"8a756a58",null).exports},62051:(t,e,s)=>{s.r(e),s.d(e,{default:()=>d});s(58052);var a=s(68286),i=(s(47238),s(75167)),o=(s(47601),s(44951)),r=(s(20581),s(50914)),n=s(75230),c=s(55595),l=s(78368),u={components:{[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,[a.Z.name]:a.Z,noData:n.Z},data:()=>({defaultAvatar:l,loading:!1,finished:!1,pageSize:20,pageNumber:1,dataList:[],courseId:"",type:"microClass",refreshing:!1,isHaveData:""}),mounted(){this.courseId=this.$route.query.courseId,this.type=this.$route.query.type,this.courseId&&this.funGetList()},methods:{funGetList(){this.loading=!0;const t={page_size:this.pageSize,page_number:this.pageNumber};c.Z.courseViewers(this.courseId,t).then((t=>{this.refreshing=!1,this.loading=!1,this.dataList=1===this.pageNumber?t.data.list:this.dataList.concat(t.data.list),this.finished=this.dataList.length===t.data.total,this.isHaveData=0!==this.dataList.length}))},handleLoad(){this.pageNumber+=1,this.funGetList()},onRefresh(){this.finished=!0,this.pageNumber=1,this.funGetList()}}},d=(0,s(1001).Z)(u,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"viewers-container"},[s("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[t.dataList.length?s("van-list",{attrs:{finished:t.finished,"finished-text":t.$t("community.isBottom")},on:{load:t.handleLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.dataList,(function(e){return s("div",{key:e.id,staticClass:"item-one"},[s("van-image",{attrs:{round:"",src:e.avatar||t.defaultAvatar,width:"40",height:"40"}}),s("div",{staticClass:"user-info"},[s("div",{staticClass:"user-name"},[t._v(" "+t._s(e.name)+" "),"quit"===e.dimission_status?s("span",{staticClass:"quit-user"},[t._v(t._s(t.$t("course.quitted")))]):t._e()]),s("div",{staticClass:"user-department"},[t._v(" "+t._s(e.departments.join(" / "))+" ")])]),s("div",{staticClass:"status"},[e.progress<100?s("div",{staticClass:"progress-info"},[s("van-progress",{attrs:{percentage:e.progress,"stroke-width":"6","show-pivot":!1,color:"#465dcd"}})],1):s("div",{staticClass:"done"},[t._v(t._s(t.$t("common.finished")))])]),e.progress<100?s("span",{staticClass:"progress-count"},[t._v(t._s(e.progress)+"%")]):t._e()],1)})),0):t._e()],1),!1===t.isHaveData?s("noData",{attrs:{"tip-text":t.$t("community.noData")}}):t._e()],1)}),[],!1,null,"0148e62e",null).exports},41372:(t,e,s)=>{s.r(e),s.d(e,{default:()=>i});s(33948);var a={components:{ClUpload:s(64404).Z},data:()=>({attachmentList:[],edit:!1}),computed:{},created(){},mounted(){},methods:{beforeUpload(t){console.warn(t)},onSuccess(t){this.attachmentList=[...this.attachmentList,...t]}}},i=(0,s(1001).Z)(a,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},[s("cl-upload",{attrs:{"list-type":["photo","video","dingPlate"],"disk-name":"operation"},on:{onSuccess:t.onSuccess}})],1)}),[],!1,null,"1bdd9636",null).exports},54821:(t,e,s)=>{s.r(e),s.d(e,{default:()=>l});var a=s(95082),i=(s(25773),s(35791)),o=s(26294),r=s(72091),n=s(78e3),c={components:{[i.Z.name]:i.Z,ScoreMark:r.Z},data:()=>({userId:"",evaluateVo:{},resources:[],limit:5,questionnaireResultVo:{},params:{},edit:!1,isRefresh:!0}),computed:(0,a.Z)({},(0,o.mapGetters)({getResources:"offLineCourse/getResources"})),mounted(){document.title=this.$t("pageTitle.examineGrade");const{edit:t,passing_score:e,total_score:s,score:a,remark:i}=this.$route.query;this.edit="true"===t,this.edit?this.evaluateVo={passing_score:Number(e),total_score:Number(s)}:(this.resources=this.getResources,this.evaluateVo={passing_score:Number(e),score:Number(a),total_score:Number(s),comments:i})},methods:{onSubmit(t,e){const{courseId:s,userId:a}=this.$route.query,i={courseId:s,score:t.score,remark:t.comments,resource_ids:e.map((t=>t.id)),userId:a};n.Z.scoreSubmit(i).then((()=>{this.$toast.success(),this.$router.go(-1)}))}}},l=(0,s(1001).Z)(c,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"my-score-form"},[s("score-mark",{attrs:{edit:t.edit,limit:t.limit,"evaluate-vo":t.evaluateVo,resources:t.resources,"on-submit":t.onSubmit}})],1)}),[],!1,null,"78468d3c",null).exports},5299:(t,e,s)=>{s.r(e),s.d(e,{default:()=>y});var a=s(95082),i=(s(82500),s(49414)),o=(s(82522),s(10342)),r=(s(20581),s(50914)),n=(s(47601),s(44951)),c=(s(49153),s(5944)),l=(s(69710),s(57609)),u=(s(52355),s(29233)),d=(s(33948),s(57658),s(26294)),h=s(22648),p=s(78e3),m=s(78368),g=s(45877),v={components:{[u.Z.name]:u.Z,[l.Z.name]:l.Z,[c.Z.name]:c.Z,[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,ClCustomUser:g.Z},filters:{formatDate:t=>(0,h.p6)(t,"yyyy.MM.dd hh:mm")},data:()=>({activeTab:"0",tabs:[{title:"scoring",name:"scoring"},{title:"scored",name:"scored"}],list:[],loading:!1,finished:!1,params:{user_status:"",page_number:0,page_size:10},defaultAvatar:m}),computed:(0,a.Z)({},(0,d.mapGetters)({primaryColor:"getPrimaryColor"})),created(){},mounted(){document.title=this.$t("pageTitle.examineGrade"),this.courseId=this.$route.params.courseId,this.params=(0,a.Z)((0,a.Z)({},this.params),{},{user_status:this.$route.query.activeTab})},methods:{onTabChange(t){this.list=[],this.params=(0,a.Z)((0,a.Z)({},this.params),{},{user_status:t,page_number:0}),this.loading=!0,this.finished=!1,this.onLoad()},async onLoad(){this.params.page_number+=1;const t=await p.Z.getGradeUsers((0,a.Z)((0,a.Z)({},this.params),{},{courseId:this.courseId})),{list:e,has_next_page:s}=t.data.data;this.list=[...this.list,...e],this.loading=!1,s||(this.finished=!0)},toDetail(t){const{passing_score:e,total_score:s}=this.$route.query;"scored"===this.activeTab&&this.$store.dispatch("offLineCourse/saveResourcesAction",t.resources),this.$router.push({path:"/examine-grade-detail",query:{courseId:t.course_id,userId:t.user_id,edit:"scoring"===this.activeTab,passing_score:e,total_score:s,remark:"scored"===this.activeTab?t.remark:"",score:"scored"===this.activeTab?t.score:""}})}}},f=v,y=(0,s(1001).Z)(f,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"sign-list"},[s("van-tabs",{attrs:{color:t.primaryColor,"line-width":24,sticky:""},on:{change:t.onTabChange},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},t._l(t.tabs,(function(e){return s("van-tab",{key:e.name,attrs:{title:t.$t("offline."+e.title),name:e.name}})})),1),s("van-list",{staticClass:"user-list",attrs:{"loading-text":t.$t("common.loading"),finished:t.finished,"finished-text":t.finished&&0===t.list.length?"":t.$t("common.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[t._l(t.list,(function(e){return s("van-cell",{key:e.id,staticClass:"user-item",attrs:{"is-link":""},on:{click:function(s){return t.toDetail(e)}},scopedSlots:t._u([{key:"title",fn:function(){return[s("van-image",{staticClass:"avatar",attrs:{src:e.user_info.avatar||t.defaultAvatar,fit:"fill"}}),s("cl-custom-user",{attrs:{type:e.user_info.source_type,"data-type":"userName",value:e.user_info.user_id,name:e.user_info.name}}),e.user_info.quit?s("span",[t._v("（"+t._s(t.$t("common.quit"))+"）")]):t._e()]},proxy:!0}],null,!0)})})),t.finished&&0===t.list.length?s("van-empty",{attrs:{description:t.$t("common.noDataTextTip")}}):t._e()],2)],1)}),[],!1,null,"12706446",null).exports},72091:(t,e,s)=>{s.d(e,{Z:()=>_});var a=s(95082),i=(s(23307),s(81392)),o=(s(93787),s(20090)),r=(s(77141),s(30960)),n=(s(69710),s(57609)),c=(s(25773),s(35791)),l=(s(74916),s(77601),s(33948),s(26294)),u=s(39145),d={components:{},props:{title:{type:String,default:""},count:{type:Number,default:0},unit:{type:String,default:""},size:{type:String,default:"medium"}},data:()=>({}),computed:{},created(){},mounted(){},methods:{}},h=s(1001),p=(0,h.Z)(d,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"score-box",class:t.size},[s("p",{staticClass:"title text"},[t._v(t._s(t.title))]),s("p",[s("span",{staticClass:"count"},[t._v(t._s(t.count))]),s("span",{staticClass:"unit text"},[t._v(t._s(t.unit))])])])}),[],!1,null,"25bea88f",null).exports,m=s(51173),g=s(64404),v=s(95084);const{noop:f}=u.Y;var y={components:{[c.Z.name]:c.Z,[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,ScoreBox:p,ClUpload:g.Z,ClAttachment:v.Z},filters:{formatByte(t){const{value:e,unit:s}=(0,m.Z)(t);return`${e} ${s}`}},props:{edit:{type:Boolean,default:!0},evaluateVo:{type:Object,default:()=>({})},resources:{type:Array,default:()=>[]},limit:{type:Number,default:5},onSubmit:{type:Function,default:f}},data:()=>({formData:{},attachmentList:[]}),computed:(0,a.Z)({},(0,l.mapGetters)({primaryColor:"getPrimaryColor"})),watch:{evaluateVo:{handler(t){this.formData=t},deep:!0,immediate:!0},resources(t){this.attachmentList=t}},created(){},mounted(){},methods:{validatorScore(t){return!!(/^(0|[1-9][0-9]*)$/.test(t)&&t<=Number(this.evaluateVo.total_score))},onSuccess(t){this.attachmentList=[...this.attachmentList,...t]},deleteFile(t){this.attachmentList.splice(t,1)}}},_=(0,h.Z)(y,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("van-form",{staticClass:"score-mark-form",style:{paddingTop:t.edit?0:"10px"},on:{submit:function(e){return t.onSubmit(e,t.attachmentList)}}},[t.edit?s("van-field",{attrs:{"label-align":"top",placeholder:t.$t("myRating.searchScorePlaceholder",{totalScore:t.formData.total_score,passingScore:t.formData.passing_score}),name:"score",rules:[{required:!0},{validator:t.validatorScore,message:t.$t("myRating.validatorScore")}]},scopedSlots:t._u([{key:"label",fn:function(){return[s("div",[t._v(" "+t._s(t.$t("myRating.score"))),s("span",{style:{color:"#969799"}},[t._v("("+t._s(t.$t("common.required"))+")")])])]},proxy:!0},{key:"extra",fn:function(){return[s("div",[t._v(t._s(t.$t("myRating.points")))])]},proxy:!0}],null,!1,83855364),model:{value:t.formData.score,callback:function(e){t.$set(t.formData,"score",e)},expression:"formData.score"}}):s("div",{staticClass:"score-card"},[s("p",[s("score-box",{attrs:{title:t.$t("myRating.score"),count:t.formData.score,unit:t.$t("myRating.point"),size:"large"}})],1),s("p",[s("score-box",{staticClass:"bl",attrs:{title:t.$t("myRating.fullScore"),count:t.formData.total_score,unit:t.$t("myRating.point")}}),s("score-box",{attrs:{title:t.$t("myRating.passingScore"),count:t.formData.passing_score,unit:t.$t("myRating.point")}})],1)]),s("van-field",{attrs:{"label-align":"top",label:t.edit?t.$t("common.passIntroduction"):t.$t("common.introduction"),rows:"3",autosize:"",name:"comments",maxlength:240,type:"textarea","show-word-limit":t.edit,placeholder:t.edit?t.$t("myRating.searchCommentsPlaceholder"):"",readonly:!t.edit},model:{value:t.formData.comments,callback:function(e){t.$set(t.formData,"comments",e)},expression:"formData.comments"}}),t.attachmentList.length>0?s("cl-attachment",{staticClass:"attachment-padding",attrs:{"attachment-list":t.attachmentList,"is-delete":t.edit},on:{delete:t.deleteFile}}):t._e(),t.edit?s("cl-upload",{attrs:{"list-type":["photo","video","dingPlate"],"disk-name":"my-rating"},on:{onSuccess:t.onSuccess}}):t._e(),t.edit?s("p",{staticClass:"anonymous"},[t._v(t._s(t.$t("myRating.attachmentLimitTip",{limit:t.limit})))]):t._e(),t.edit?s("div",{staticClass:"footer"},[s("van-button",{attrs:{type:"primary",block:"",color:t.primaryColor}},[t._v(t._s(t.$t("common.submit")))])],1):t._e()],1)}),[],!1,null,"bebe1a82",null).exports},56691:(t,e,s)=>{s.r(e),s.d(e,{default:()=>_});var a=s(95082),i=(s(82500),s(49414)),o=(s(82522),s(10342)),r=(s(86039),s(20495)),n=(s(31968),s(3809)),c=(s(20581),s(50914)),l=(s(49153),s(5944)),u=(s(69710),s(57609)),d=(s(52355),s(29233)),h=(s(33948),s(57658),s(26294)),p=s(22648),m=s(78e3),g=s(62527),v=s(45877),f={components:{[d.Z.name]:d.Z,[u.Z.name]:u.Z,[l.Z.name]:l.Z,[c.Z.name]:c.Z,[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,RatingModal:g.Z,ClCustomUser:v.Z},filters:{formatDate:t=>(0,p.p6)(t,"yyyy-MM-dd  hh:mm")},data:()=>({activeTab:"myEvaluate",tabs:[{title:"toEvaluate",name:"myEvaluate"},{title:"beEvaluated",name:"evaluateMy"}],activeTab2:"trainee",tabs2:[],list:[],loading:!1,finished:!1,showRating:!1,star:5,is_evaluated:!1,params:{keyword:"",evaluate_type:"myEvaluate",type:"trainee",page_number:0,page_size:10}}),computed:(0,a.Z)({},(0,h.mapGetters)({primaryColor:"getPrimaryColor",userId:"getUserId"})),created(){},mounted(){this.initTab2(this.activeTab)},methods:{onTabChange(t,e,s){"1"===s&&this.initTab2(t),this.resetQuery()},resetQuery(){this.params=(0,a.Z)((0,a.Z)({},this.params),{},{evaluate_type:this.activeTab,type:this.activeTab2,page_number:0}),this.loading=!0,this.finished=!1,this.list=[],this.loading&&this.onLoad()},initTab2(t){"myEvaluate"===t?this.tabs2=[{title:"evaluateStudent",name:"trainee"},{title:"evaluateLecturer",name:"lecturer"},{title:"evaluateCourse",name:"course"}]:"evaluateMy"===t&&(this.tabs2=[{title:"studentEvaluate",name:"trainee"},{title:"lecturerEvaluate",name:"lecturer"}]),this.activeTab2="trainee"},async onLoad(){this.params.page_number+=1;const t=await m.Z.getMyEvaluateList(this.params),{list:e,has_next_page:s}=t.data.data;this.list=[...this.list,...e],this.loading=!1,s||(this.finished=!0)},async toEvaluate(t){let{id:e,evaluate_id:s,evaluate_rule_vo:a,is_evaluated:i,status:o}=t;const{evaluate_type:r}=a;this.courseId=e,this.evaluate_id=s,this.evaluate_type=r,this.is_evaluated=i;if("trainee"!==this.activeTab2)if(this.evaluate_object_id=t.id,"star"===r){if(i){const t=await m.Z.getMyEvaluateInfo({courseId:e,evaluate_id:s,is_evaluated:i,evaluate_object_id:this.evaluate_object_id}),{evaluate_vo:a}=t.data.data;this.star=a.star}else this.star=5;this.showRating=!0}else this.$router.push({path:`/my-rating-form/${e}`,query:{scoreType:"0",edit:!i,evaluate_id:s,evaluate_type:r,is_evaluated:i,evaluate_object_id:this.evaluate_object_id}});else this.$router.push({path:`/my-rating-student/${e}`,query:{evaluate_id:s,evaluate_type:r,activeTab:i?"1":"0",is_evaluated:i,status:o}})},toEvaluateResult(t){let{id:e,evaluate_id:s,evaluate_rule_vo:a,lecturer_id:i}=t;const o=this.activeTab2,{evaluate_type:r}=a;"trainee"===o?this.$router.push({path:`/my-rating-lecturer/${e}`,query:{evaluate_id:s,lecturer_id:i,evaluate_type:r,role:o}}):"lecturer"===o&&this.$router.push({path:`/my-rating-form/${e}`,query:{scoreType:"1",edit:"false",role:o,evaluate_id:s,evaluate_type:r,evaluate_user_id:this.userId}})},async submitStar(t){"success"===(await m.Z.submitEvaluateContent({courseId:this.courseId,evaluate_id:this.evaluate_id,evaluate_type:this.evaluate_type,evaluate_object_id:this.evaluate_object_id,evaluate_content_vo:{evaluateVo:{star:t}}})).data.data&&(this.$toast.success(this.$t("common.submitSuccess")),this.showRating=!1,this.resetQuery())}}},y=f,_=(0,s(1001).Z)(y,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"offline-wrap"},[s("van-tabs",{attrs:{color:t.primaryColor,"line-width":24,sticky:""},on:{change:function(e,s,a){return t.onTabChange(e,s,"1")}},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},t._l(t.tabs,(function(e){return s("van-tab",{key:e.name,attrs:{title:t.$t("myRating."+e.title),name:e.name}})})),1),s("van-tabs",{attrs:{"title-active-color":t.primaryColor,"title-inactive-color":"#7F849A","line-width":"0","line-height":"0",sticky:""},on:{change:function(e,s,a){return t.onTabChange(e,s,"2")}},model:{value:t.activeTab2,callback:function(e){t.activeTab2=e},expression:"activeTab2"}},t._l(t.tabs2,(function(e){return s("van-tab",{key:e.name,attrs:{title:t.$t("myRating."+e.title),name:e.name}})})),1),s("van-divider",{style:{margin:"0"}}),s("van-search",{attrs:{placeholder:t.$t("myRating.searchPlaceholder")},on:{search:function(e){return t.resetQuery()},clear:function(e){return t.resetQuery()}},model:{value:t.params.keyword,callback:function(e){t.$set(t.params,"keyword",e)},expression:"params.keyword"}}),s("van-divider",{style:{margin:"0"}}),s("van-list",{staticClass:"course-list",attrs:{"loading-text":t.$t("common.loading"),finished:t.finished,"finished-text":t.finished&&0===t.list.length?"":t.$t("common.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[t._l(t.list,(function(e){return s("van-cell",{key:e.id,staticClass:"course-item",attrs:{center:"","is-link":"evaluateMy"===t.activeTab&&e.is_evaluated,clickable:!1},on:{click:function(s){"evaluateMy"===t.activeTab&&e.is_evaluated&&t.toEvaluateResult(e)}},scopedSlots:t._u([{key:"title",fn:function(){return[s("div",{staticClass:"top-info"},[s("p",{staticClass:"status"},[t._v(t._s(t.$t("study.offline")))]),s("p",{staticClass:"title"},[t._v(t._s(e.title))]),"myEvaluate"===t.activeTab?["trainee"!==t.activeTab2?s("p",{staticClass:"text"},[t._v(t._s(t.$t("common.teacher"))+"： "),"inside"===e.teacher_sync_type?s("span",[s("cl-custom-user",{attrs:{type:e.teacher_sync_source_type,"data-type":"userName",value:e.teacher_sync_user_id,name:e.lecturer_name}})],1):s("span",[t._v(t._s(e.lecturer_name))])]):t._e()]:t._e(),"trainee"===t.activeTab2&&"myEvaluate"===t.activeTab?s("p",{staticClass:"text"},[t._v(t._s(t.$t("offline.joiner"))+"："+t._s(e.evaluate_count))]):t._e(),s("p",{staticClass:"text"},[t._v(t._s(t.$t("common.trainingTime"))+"："+t._s(t._f("formatDate")(e.begin_time))+" ~ "+t._s(t._f("formatDate")(e.end_time)))]),s("p",{staticClass:"text"},[t._v(t._s(t.$t("common.trainingAddress"))+"："+t._s(e.address))])],2),"myEvaluate"===t.activeTab?s("div",{staticClass:"bottom-info"},["trainee"===t.activeTab2?s("span",{on:{click:function(s){return t.toEvaluate(e)}}},[t._v(t._s(e.is_evaluated||!e.is_evaluated&&"settled"===e.status?t.$t("myRating.viewRatings"):t.$t("myRating.evaluateStudent")))]):t._e(),"lecturer"===t.activeTab2?s("span",{class:{disabled:"settled"===e.status&&!e.is_evaluated},on:{click:function(s){("settled"!==e.status||e.is_evaluated)&&t.toEvaluate(e)}}},[t._v(t._s(e.is_evaluated?t.$t("myRating.viewRatings"):t.$t("myRating.evaluateLecturer")))]):t._e(),"course"===t.activeTab2?s("span",{class:{disabled:"settled"===e.status&&!e.is_evaluated},on:{click:function(s){("settled"!==e.status||e.is_evaluated)&&t.toEvaluate(e)}}},[t._v(t._s(e.is_evaluated?t.$t("myRating.viewRatings"):t.$t("myRating.evaluateCourse")))]):t._e()]):t._e()]},proxy:!0}],null,!0)})})),t.finished&&0===t.list.length?s("van-empty",{attrs:{description:t.$t("common.noDataTextTip")}}):t._e()],2),t.showRating?s("rating-modal",{attrs:{star:t.star,edit:!t.is_evaluated},on:{onSubmit:t.submitStar,cancelModal:function(e){t.showRating=!1}}}):t._e()],1)}),[],!1,null,"9e4393a0",null).exports},11092:(t,e,s)=>{s.r(e),s.d(e,{default:()=>l});var a=s(95082),i=(s(25773),s(35791)),o=(s(57658),s(72091)),r=s(35253),n=s(78e3),c={name:"MyRatingForm",components:{[i.Z.name]:i.Z,ScoreMark:o.Z,Questionnaire:r.Z},beforeRouteLeave(t,e,s){"course-reader"===t.name&&"myRatingForm"===e.name?this.isRefresh=!1:(this.isRefresh=!0,this.evaluateVo={},this.resources=[],this.questionnaireResultVo={}),s()},data:()=>({evaluate_type:"score",userId:"",evaluateVo:{},resources:[],limit:5,questionnaireResultVo:{},params:{},edit:!1,isRefresh:!0}),computed:{},created(){},mounted(){},activated(){if(!this.isRefresh)return;this.courseId=this.$route.params.courseId;const{scoreType:t,edit:e,evaluate_id:s,is_evaluated:a,evaluate_type:i,evaluate_object_id:o,evaluate_user_id:r,role:n}=this.$route.query;"questionnaire"===i&&(document.title=this.$t("pageTitle.questionnaireRating")),this.evaluate_type=i,this.edit=JSON.parse(e),"0"===t?this.params={evaluate_id:s,is_evaluated:a,evaluate_object_id:o}:"1"===t&&(this.params={evaluate_id:s,type:n,evaluate_user_id:r}),this.init(t)},deactivated(){this.$toast.clear()},methods:{async init(t){let e={};this.$toast.loading({duration:0,message:this.$t("common.loading"),loadingType:"spinner",forbidClick:!0});try{e="0"===t?await n.Z.getMyEvaluateInfo((0,a.Z)((0,a.Z)({},this.params),{},{courseId:this.courseId})):await n.Z.getEvaluateMyInfo((0,a.Z)((0,a.Z)({},this.params),{},{courseId:this.courseId})),this.$toast.clear();const{evaluate_vo:s,questionnaire_result_vo:i,resources:o}=e.data.data;this.evaluateVo=s,this.resources=o,this.questionnaireResultVo=i}catch(t){"576021"===t.data.code&&this.$toast.clear()}},questionsFormResult(t){let e=[];return Object.keys(t).forEach((s=>{let i=t[s],o={options:"",other_answer:""};if(i instanceof Object)if(i.length>0){let t=[];i.forEach((e=>{t.push(e.id),"true"===e.is_other&&(o.other_answer=e.other_answer?e.other_answer:e.title)})),o.options=t.join(",")}else i.num?(o.options=i.num,o.instruction_content=i.instruction_content):(o=(0,a.Z)((0,a.Z)({},o),{},{options:i.id}),"true"===i.is_other&&(o.other_answer=i.other_answer?i.other_answer:i.title));else o.options=i;e.push({id:s,solution:o})})),e},async startStudy(){const{from:t,studyId:e,isStartStudy:s}=this.$route.query;"false"===s&&"project"===t&&await n.Z.startStudy(e)},async onSubmit(t,e){if(e&&e.length>this.limit)return this.$toast(this.$t("myRating.attachmentLimitTip",{limit:this.limit})),!1;const{evaluate_id:s,evaluate_object_id:i}=this.params,{evaluate_type:o}=this;let r={};"score"===o?r={evaluateVo:(0,a.Z)((0,a.Z)((0,a.Z)({},this.evaluateVo),t),{},{content:e.length>0?e.map((t=>t.id)).join(","):""})}:"questionnaire"===o&&(r={evaluateVo:this.evaluateVo,questions:this.questionsFormResult(t)}),this.startStudy();"success"===(await n.Z.submitEvaluateContent({courseId:this.courseId,evaluate_id:s,evaluate_type:o,evaluate_object_id:i,evaluate_content_vo:r})).data.data&&(this.$toast.success(this.$t("common.submitSuccess")),this.$router.go(-1))}}},l=(0,s(1001).Z)(c,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"my-score-form"},["score"===t.evaluate_type?s("score-mark",{attrs:{edit:t.edit,limit:t.limit,"evaluate-vo":t.evaluateVo,resources:t.resources,"on-submit":t.onSubmit}}):"questionnaire"===t.evaluate_type?s("questionnaire",{attrs:{edit:t.edit,rule:t.questionnaireResultVo,"on-submit":t.onSubmit}}):t._e()],1)}),[],!1,null,"1e8eab5f",null).exports},6160:(t,e,s)=>{s.r(e),s.d(e,{default:()=>y});var a=s(95082),i=(s(82500),s(49414)),o=(s(82522),s(10342)),r=(s(31968),s(3809)),n=(s(20581),s(50914)),c=(s(47601),s(44951)),l=(s(49153),s(5944)),u=(s(52355),s(29233)),d=(s(33948),s(57658),s(26294)),h=s(22648),p=s(78e3),m=s(78368),g=s(45877),v={name:"MyRatingLecturer",components:{[u.Z.name]:u.Z,[l.Z.name]:l.Z,[c.Z.name]:c.Z,[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,ClCustomUser:g.Z},filters:{formatDate:t=>(0,h.p6)(t,"yyyy.MM.dd hh:mm")},data:()=>({star_average:0,star_average_half:0,list:[],loading:!1,finished:!1,params:{evaluate_id:"",lecturer_id:"",page_number:0,page_size:10},evaluate_type:"",defaultAvatar:m}),computed:(0,a.Z)({},(0,d.mapGetters)({primaryColor:"getPrimaryColor"})),watch:{star_average(t){let e=t;-1!==t.indexOf(".")&&(e=Math.floor(t)+.5),this.star_average_half=Number(e)}},created(){},mounted(){this.courseId=this.$route.params.courseId;const{evaluate_id:t,evaluate_type:e,lecturer_id:s,role:i}=this.$route.query;this.evaluate_type=e,this.role=i,this.params=(0,a.Z)((0,a.Z)({},this.params),{},{evaluate_id:t,lecturer_id:s})},methods:{async onLoad(){this.params.page_number+=1;const t=await p.Z.getUserEvaluateLecturerList((0,a.Z)({courseId:this.courseId},this.params)),{page_data:e,star_average:s}=t.data.data,{list:i,has_next_page:o}=e;this.list=[...this.list,...i],this.star_average=s,this.loading=!1,o||(this.finished=!0)},toEvaluateResult(t){const{evaluate_id:e,lecturer_id:s}=this.params;let i={scoreType:"1",edit:"false",evaluate_id:e,evaluate_type:this.evaluate_type};i="0"===i.scoreType?(0,a.Z)((0,a.Z)({},i),{},{is_evaluated:"true"!==this.edit,evaluate_object_id:s}):(0,a.Z)((0,a.Z)({},i),{},{evaluate_user_id:t,role:this.role}),this.$router.push({path:`/my-rating-form/${this.courseId}`,query:i})}}},f=v,y=(0,s(1001).Z)(f,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"my-score-lecturer"},["star"===t.evaluate_type?s("div",{staticClass:"rating-box"},[s("p",{staticClass:"text"},[s("span",{staticClass:"num"},[t._v(t._s(t.star_average))]),s("span",{staticClass:"unit"},[t._v(t._s(t.$t("myRating.point")))])]),s("van-rate",{attrs:{"allow-half":"",size:24,color:"#FFA818","void-icon":"star","void-color":"#D8DFF3",readonly:""},model:{value:t.star_average_half,callback:function(e){t.star_average_half=e},expression:"star_average_half"}})],1):t._e(),s("van-list",{staticClass:"user-list",attrs:{"loading-text":t.$t("common.loading"),finished:t.finished,"finished-text":t.finished&&0===t.list.length?"":t.$t("common.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[t._l(t.list,(function(e){return s("van-cell",{key:e.id,staticClass:"user-item",attrs:{value:e.time,size:"large","is-link":"star"!==t.evaluate_type},on:{click:function(s){"star"!==t.evaluate_type&&t.toEvaluateResult(e.user_id)}},scopedSlots:t._u([{key:"title",fn:function(){return[s("van-image",{staticClass:"avatar",attrs:{src:e.user_info.avatar||t.defaultAvatar,fit:"fill"}}),s("span",{staticClass:"user"},[s("cl-custom-user",{attrs:{type:e.user_info.source_type,"data-type":"userName",value:e.user_info.user_id,name:e.user_info.name}})],1),"star"===t.evaluate_type?s("van-rate",{attrs:{size:10,color:"#FFA818","void-icon":"star","void-color":"#D8DFF3",readonly:""},model:{value:e.course_evaluate_vo.star,callback:function(s){t.$set(e.course_evaluate_vo,"star",s)},expression:"item.course_evaluate_vo.star"}}):t._e()]},proxy:!0}],null,!0)})})),t.finished&&0===t.list.length?s("van-empty",{attrs:{description:t.$t("common.noDataTextTip")}}):t._e()],2),s("van-cell",{staticClass:"course-item"})],1)}),[],!1,null,"21c6a53b",null).exports},34971:(t,e,s)=>{s.r(e),s.d(e,{default:()=>y});var a=s(95082),i=(s(82500),s(49414)),o=(s(82522),s(10342)),r=(s(20581),s(50914)),n=(s(47601),s(44951)),c=(s(49153),s(5944)),l=(s(69710),s(57609)),u=(s(52355),s(29233)),d=(s(33948),s(57658),s(26294)),h=s(22648),p=s(78e3),m=s(78368),g=s(45877),v={components:{[u.Z.name]:u.Z,[l.Z.name]:l.Z,[c.Z.name]:c.Z,[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,ClCustomUser:g.Z},filters:{formatDate:t=>(0,h.p6)(t,"yyyy.MM.dd hh:mm")},data:()=>({activeTab:"0",tabs:[{title:"toBeEvaluated",name:"0"},{title:"evaluated",name:"1"}],list:[],loading:!1,finished:!1,params:{evaluate_id:"",is_evaluated:!1,page_number:0,page_size:10},defaultAvatar:m}),computed:(0,a.Z)({},(0,d.mapGetters)({primaryColor:"getPrimaryColor"})),created(){},mounted(){this.courseId=this.$route.params.courseId;const{evaluate_id:t,evaluate_type:e,activeTab:s,is_evaluated:i,status:o}=this.$route.query;this.activeTab=s,this.evaluate_type=e,this.status=o,this.params=(0,a.Z)((0,a.Z)({},this.params),{},{evaluate_id:t,is_evaluated:i})},methods:{onTabChange(t){this.params=(0,a.Z)((0,a.Z)({},this.params),{},{is_evaluated:"0"!==t,page_number:0}),this.loading=!0,this.finished=!1,this.list=[],this.loading&&this.onLoad()},async onLoad(){this.params.page_number+=1;const t=await p.Z.getLecturerEvaluateUserList((0,a.Z)((0,a.Z)({},this.params),{},{courseId:this.courseId})),{list:e,has_next_page:s}=t.data.data;this.list=[...this.list,...e],this.loading=!1,s||(this.finished=!0)},toEvaluateStudent(t,e){const{evaluate_id:s}=this.params;this.$router.push({path:`/my-rating-form/${this.courseId}`,query:{scoreType:"0",edit:!e,evaluate_id:s,is_evaluated:e,evaluate_type:this.evaluate_type,evaluate_object_id:t}})}}},f=v,y=(0,s(1001).Z)(f,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"offline-sign-list"},[s("van-tabs",{attrs:{color:t.primaryColor,"line-width":24,sticky:""},on:{change:t.onTabChange},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},t._l(t.tabs,(function(e){return s("van-tab",{key:e.name,attrs:{title:t.$t("myRating."+e.title),name:e.name}})})),1),s("van-divider",{style:{margin:"0"}}),s("van-list",{staticClass:"course-list",attrs:{"loading-text":t.$t("common.loading"),finished:t.finished,"finished-text":t.finished&&0===t.list.length?"":t.$t("common.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[t._l(t.list,(function(e){return s("van-cell",{key:e.id,staticClass:"course-item",scopedSlots:t._u([{key:"title",fn:function(){return[s("van-image",{staticClass:"avatar",attrs:{src:e.user_info.avatar||t.defaultAvatar,fit:"fill"}}),s("cl-custom-user",{attrs:{type:e.user_info.source_type,"data-type":"userName",value:e.user_info.user_id,name:e.user_info.name}}),e.user_info.quit?s("span",[t._v("（"+t._s(t.$t("common.quit"))+"）")]):t._e()]},proxy:!0},{key:"default",fn:function(){return["0"===t.activeTab?s("span",{staticClass:"status",class:{disabled:"settled"===t.status},on:{click:function(s){"settled"!==t.status&&t.toEvaluateStudent(e.user_id,!1)}}},[t._v(t._s(t.$t("myRating.evaluateStudent")))]):t._e(),"1"===t.activeTab?s("span",{staticClass:"status",on:{click:function(s){return t.toEvaluateStudent(e.user_id,!0)}}},[t._v(t._s(t.$t("myRating.viewRatings")))]):t._e()]},proxy:!0}],null,!0)})})),t.finished&&0===t.list.length?s("van-empty",{attrs:{description:t.$t("common.noDataTextTip")}}):t._e()],2)],1)}),[],!1,null,"4913d12b",null).exports},42818:(t,e,s)=>{s.r(e),s.d(e,{default:()=>g});var a=s(95082),i=(s(82500),s(49414)),o=(s(82522),s(10342)),r=(s(20581),s(50914)),n=(s(49153),s(5944)),c=(s(69710),s(57609)),l=(s(52355),s(29233)),u=(s(33948),s(57658),s(26294)),d=s(22648),h=s(78e3),p={components:{[l.Z.name]:l.Z,[c.Z.name]:c.Z,[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z},filters:{formatDate:t=>(0,d.p6)(t,"yyyy-MM-dd  hh:mm")},data:()=>({activeTab:"0",tabs:[{title:"notStarted",type:"0"},{title:"ongoing",type:"1"},{title:"finished",type:"2"}],list:[],loading:!1,finished:!1,params:{type:"0",pageNumber:0,pageSize:10}}),computed:(0,a.Z)({},(0,u.mapGetters)({primaryColor:"getPrimaryColor"})),created(){},mounted(){},methods:{onTabChange(t){this.params=(0,a.Z)((0,a.Z)({},this.params),{},{type:t,pageNumber:0}),this.loading=!0,this.finished=!1,this.list=[],this.loading&&this.onLoad()},async onLoad(){this.$toast.loading({duration:0,message:"加载中...",forbidClick:!0}),this.params.pageNumber=1+this.params.pageNumber;const t=await h.Z.getOfflineSignList((0,a.Z)({},this.params)),{list:e,total:s}=t.data;this.$toast.clear(),this.list=[...this.list,...e],this.loading=!1,this.list.length>=s&&(this.finished=!0)},toOfflineCourseDetail(t){this.$router.push({path:`/offline-course-detail/${t}`})}}},m=p,g=(0,s(1001).Z)(m,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"offline-wrap"},[s("van-tabs",{attrs:{color:t.primaryColor,"line-width":24,sticky:""},on:{change:t.onTabChange},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},t._l(t.tabs,(function(e){return s("van-tab",{key:e.name,attrs:{title:t.$t("offline."+e.title),name:e.type}})})),1),s("van-list",{staticClass:"course-list",attrs:{finished:t.finished,"finished-text":t.$t("common.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e){return s("div",{key:e.id,staticClass:"course-item",on:{click:function(s){return t.toOfflineCourseDetail(e.id)}}},[s("div",{staticClass:"card-padding"},[s("p",{staticClass:"status"},[t._v(t._s(t.$t("study.offline")))]),s("p",{staticClass:"title"},[t._v(t._s(e.title))]),s("p",{staticClass:"text"},[t._v(t._s(t.$t("common.teacher"))+"："+t._s(e.name))]),s("p",{staticClass:"text"},[t._v(t._s(t.$t("common.address"))+"："+t._s(e.address))])]),s("van-divider",{style:{margin:"0"}}),s("div",{staticClass:"bottom-info card-padding"},[s("span",{staticClass:"create"},[t._v(t._s(e.create_user))]),s("span",{staticClass:"time"},[t._v(t._s(t._f("formatDate")(e.begin_time))+" ~ "+t._s(t._f("formatDate")(e.end_time)))])])],1)})),0),t.finished&&0===t.list.length?s("van-empty",{attrs:{description:t.$t("common.noDataTextTip")}}):t._e()],1)}),[],!1,null,"d57cb708",null).exports},36129:(t,e,s)=>{s.d(e,{Z:()=>n});s(25773);var a=s(35791),i=s(22648),o=s(45877),r={components:{[a.Z.name]:a.Z,ClCustomUser:o.Z},props:{info:{type:Object,default:()=>{}}},data(){return{signStatus:{missing:this.$t("signIn.missing"),normal:this.$t("signIn.normal"),leaved:this.$t("signIn.leaved"),late:this.$t("signIn.late"),leaveEarly:this.$t("signIn.early"),noIn:this.$t("signIn.unsigned"),noOut:this.$t("signIn.unsignedOut")},statusColor:"#B2B2B2"}},computed:{getInfo(){return this.info}},methods:{renderData:t=>(0,i.p6)(Number(t),"hh:mm"),getDirector:t=>t.map((t=>t.userName)).join(","),getDuration(t,e){return` （${(Number(e)-Number(t))/6e4}${this.$t("mineScore.minutes")}）`},renderSignStatus(){const{sign_record:t}=this.info.sign_detail;if(t){let e="sign_in"===this.info.sign_type?t.signInStatus:t.signOutStatus;return"abnormal"===e&&(e="sign_in"===this.info.sign_type?"late":"leaveEarly",this.statusColor="red"),"missing"===e&&(e="sign_in"===this.info.sign_type?"noIn":"noOut"),"normal"===e&&(this.statusColor="#00C800"),"late"===e&&(this.statusColor="red"),this.signStatus[e]}return"sign_in"===this.info.sign_type?this.signStatus.noIn:this.signStatus.noOut}}},n=(0,s(1001).Z)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"sign"},[s("div",{staticClass:"sign-title"},[s("div",{staticClass:"time"},["sign_in"===t.getInfo.sign_type?s("div",[t._v(t._s(t.renderData(t.getInfo.sign_detail.sign_info.signInBeginTime))+" - "+t._s(t.renderData(t.getInfo.sign_detail.sign_info.signInEndTime)))]):s("div",[t._v(t._s(t.renderData(t.getInfo.sign_detail.sign_info.signOutBeginTime))+" - "+t._s(t.renderData(t.getInfo.sign_detail.sign_info.signOutEndTime)))]),"sign_in"===t.getInfo.sign_type?s("div",{staticClass:"time-text"},[t._v(t._s(t.getDuration(t.getInfo.sign_detail.sign_info.signInBeginTime,t.getInfo.sign_detail.sign_info.signInEndTime)))]):s("div",{staticClass:"time-text"},[t._v(t._s(t.getDuration(t.getInfo.sign_detail.sign_info.signOutBeginTime,t.getInfo.sign_detail.sign_info.signOutEndTime))+" ")])]),s("div",{staticClass:"status"},[s("van-button",{attrs:{size:"mini",color:t.statusColor,plain:""}},[t._v(t._s(t.renderSignStatus()))])],1)]),s("div",{staticClass:"sign-info"},[s("div",{staticClass:"left"},[t._v(t._s("sign_in"===t.getInfo.sign_type?t.$t("signIn.signIn"):t.$t("signIn.signOut")))]),s("div",{staticClass:"right"},[s("h1",[t._v(t._s(t.getInfo.sign_detail.sign_info.name))]),s("p",[t._v(t._s(t.$t("signIn.principal"))+"： "),t._l(t.getInfo.sign_detail.sign_info.director,(function(e,a){return s("span",{key:e.userId},[s("cl-custom-user",{attrs:{type:e.sync_source_type,"data-type":"userName",value:e.sync_user_id,name:e.userName}}),a<t.getInfo.sign_detail.sign_info.director.length-1?s("span",[t._v(",")]):t._e()],1)}))],2)])])])}),[],!1,null,"4d0dbca0",null).exports},67241:(t,e,s)=>{s.r(e),s.d(e,{default:()=>V});var a=s(95082),i=(s(76424),s(41942)),o=(s(71404),s(57141)),r=(s(21790),s(24031)),n=(s(82500),s(49414)),c=(s(82522),s(10342)),l=(s(20581),s(50914)),u=(s(47601),s(44951)),d=(s(49153),s(5944)),h=(s(29941),s(64168)),p=(s(52355),s(29233)),m=(s(56629),s(55165)),g=(s(25773),s(35791)),v=(s(57658),s(26699),s(32023),s(74916),s(4723),s(26294)),f=s(22648),y=s(98512),_=s(68092),C=s(27632),I=s(78e3),b=s(25042),w=s(85384),$=s(61564),k=s(78551),S=s(78368),T=s(74612),Z=s(57020),x=s(36129),P=(s(23307),s(81392)),D=(s(47238),s(75167)),L=s(39145),A=s(95084),E=s(62527),R=s(45877);const{noop:F}=L.Y;var q={components:{[g.Z.name]:g.Z,[D.Z.name]:D.Z,[P.Z.name]:P.Z,VanImage:u.Z,ClAttachment:A.Z,RatingModal:E.Z,ClCustomUser:R.Z},props:{info:{type:Object,default:()=>{}},reload:{type:Function,default:F},isStartStudy:{type:Boolean,default:!1}},data:()=>({defaultAvatar:S,showRating:!1,star:5,is_evaluated:!1,evaluateContent:{}}),computed:{getInfo(){return this.info},scoreVisible(){return this.getInfo.offline_course_vo.is_open_offline_assessment&&this.getInfo.offline_course_vo.course_monitor&&"scoring"!==this.getInfo.offline_course_vo.course_monitor.status},beginTime(){return this.renderData(this.getInfo.offline_course_vo.begin_time)},endTime(){return this.renderData(this.getInfo.offline_course_vo.end_time)},leavedVisible(){return this.getInfo.offline_course_vo.course_monitor&&"leaved"===this.getInfo.offline_course_vo.course_monitor.signStatus&&0===this.getInfo.study_progress},themeColor(){return this.$store.state.themeColor}},methods:{renderData:t=>(0,f.p6)(Number(t),"hh:mm"),async submitStar(t){this.startStudy();"success"===(await I.Z.submitEvaluateContent((0,a.Z)((0,a.Z)({},this.evaluateContent),{},{evaluate_content_vo:{evaluateVo:{star:t}}}))).data.data&&(this.$toast.success(this.$t("common.submitSuccess")),this.showRating=!1,this.reload())},async startStudy(){const{from:t,studyId:e}=this.$route.query;this.isStartStudy||"project"!==t||await I.Z.startStudy(e)},async toEvaluate(t){const{evaluate_type:e}="lecturer"===t?this.getInfo.offline_course_vo.student_lecturer_evaluate_content:this.getInfo.offline_course_vo.student_course_evaluate_content,s="lecturer"===t?this.getInfo.offline_course_vo.student_lecturer_evaluated:this.getInfo.offline_course_vo.student_course_evaluated,a="lecturer"===t?this.getInfo.offline_course_vo.student_lecturer_evaluate_id:this.getInfo.offline_course_vo.student_course_evaluate_id,i=this.getInfo.offline_course_vo.id;if(this.is_evaluated=s,this.evaluateContent={courseId:i,evaluate_id:a,evaluate_type:e,evaluate_object_id:i,evaluate_content_vo:{evaluateVo:{star:this.star}}},"star"===e){if(s){const e=await I.Z.getMyEvaluateInfo(this.evaluateContent);"lecturer"===t?this.getInfo.offline_course_vo.student_lecturer_evaluated=!0:this.getInfo.offline_course_vo.student_course_evaluated=!0;const{evaluate_vo:s}=e.data.data;this.star=Number(s.star)}else this.star=5;this.showRating=!0}else{const{from:t,studyId:o}=this.$route.query;this.$router.push({path:`/my-rating-form/${i}?from=${t}&studyId=${o}&isStartStudy=${this.isStartStudy}`,query:{scoreType:"0",edit:!s,evaluate_id:a,evaluate_type:e,is_evaluated:s,evaluate_object_id:i}})}}}},N=s(1001),O=(0,N.Z)(q,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"offline"},[s("div",{staticClass:"offline-title"},[s("div",{staticClass:"time"},[t._v(t._s(t.beginTime)+" - "+t._s(t.endTime)+" "),s("span",[t._v("("+t._s(t.getInfo.offline_course_vo.course_duration+t.$t("mineScore.minutes"))+")")])]),t.leavedVisible?s("div",{staticClass:"status"},[s("van-button",{attrs:{size:"mini",color:"red",plain:""}},[t._v(t._s(t.$t("signIn.leaved")))])],1):s("div",{staticClass:"status"},[s("van-progress",{attrs:{color:t.themeColor.primaryColor,percentage:t.getInfo.study_progress,"show-pivot":!1}}),s("div",{staticClass:"process"},[100===t.getInfo.study_progress?s("div",{staticClass:"icon"},[s("van-icon",{attrs:{name:"success",size:"10",color:"#ffffff"}})],1):t._e(),100!==t.getInfo.study_progress?s("span",[t._v(t._s(t.getInfo.study_progress)+"%")]):t._e()])],1)]),s("div",{staticClass:"offline-info"},[s("div",{staticClass:"left"},[s("VanImage",{staticClass:"course-avatar",attrs:{round:"",fit:"cover",src:t.getInfo.offline_course_vo.lecturer_avatar||t.defaultAvatar}})],1),s("div",{staticClass:"right"},[s("h1",[t._v(t._s(t.getInfo.offline_course_vo.title))]),s("p",["inside"===t.getInfo.offline_course_vo.teacher_sync_type?s("span",[s("cl-custom-user",{attrs:{type:t.getInfo.offline_course_vo.teacher_sync_source_type,"data-type":"userName",value:t.getInfo.offline_course_vo.teacher_sync_user_id,name:t.getInfo.offline_course_vo.lecturer_name}})],1):s("span",[t._v(t._s(t.getInfo.offline_course_vo.lecturer_name))])])])]),t.getInfo.offline_course_vo.address?s("div",{staticClass:"address"},[s("van-icon",{attrs:{name:"location-o"}}),s("div",{staticClass:"address-text"},[t._v(t._s(t.getInfo.offline_course_vo.address))])],1):t._e(),t.getInfo.offline_course_vo.lecturer_describe?s("div",{staticClass:"desc van-multi-ellipsis--l2"},[t._v(" "+t._s(t.getInfo.offline_course_vo.introduction)+" ")]):t._e(),t.getInfo.offline_course_vo.attachment.length>0?s("cl-attachment",{staticClass:"attachment",attrs:{"attachment-list":t.getInfo.offline_course_vo.attachment}}):t._e(),s("div",{staticClass:"footer"},[t.scoreVisible?s("div",{staticClass:"score"},[t._v(t._s(t.$t("offline.assessment"))+"："+t._s(t.getInfo.offline_course_vo.course_monitor.score))]):t._e(),s("div",{staticClass:"buttons"},[t.getInfo.offline_course_vo.is_student_lecturer_evaluate?s("van-button",{class:{disabled:"settled"===t.getInfo.offline_course_vo.status&&!t.getInfo.offline_course_vo.student_lecturer_evaluated},on:{click:function(e){return t.toEvaluate("lecturer")}}},[t.getInfo.offline_course_vo.student_lecturer_evaluated?s("span",[t._v(t._s(t.$t("myRating.evaluateLecturered")))]):s("span",[t._v(t._s(t.$t("myRating.evaluateLecturer")))])]):t._e(),t.getInfo.offline_course_vo.is_student_course_evaluate?s("van-button",{class:{disabled:"settled"===t.getInfo.offline_course_vo.status&&!t.getInfo.offline_course_vo.student_course_evaluated},on:{click:function(e){return t.toEvaluate("course")}}},[t.getInfo.offline_course_vo.student_course_evaluated?s("span",[t._v(t._s(t.$t("myRating.evaluateCoursed")))]):s("span",[t._v(t._s(t.$t("myRating.evaluateCourse")))])]):t._e()],1)]),t.showRating?s("rating-modal",{attrs:{star:t.star,edit:!t.is_evaluated},on:{onSubmit:t.submitStar,cancelModal:function(e){t.showRating=!1}}}):t._e()],1)}),[],!1,null,"2a103d78",null).exports,M=s(55602),B={components:{[g.Z.name]:g.Z,[m.Z.name]:m.Z,[p.Z.name]:p.Z,[h.Z.name]:h.Z,[d.Z.name]:d.Z,[u.Z.name]:u.Z,[l.Z.name]:l.Z,[c.Z.name]:c.Z,[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,CourseCover:$.Z,SvgIcon:k.Z,Sign:x.Z,OffLine:O,OverlayLoading:w.Z},filters:{formatDate:t=>(0,f.p6)(t,"yyyy.MM.dd hh:mm")},data:()=>({activeTab:0,basicInfo:{arrangement:{attendance_schedules:[],course_schedules:[]},lecturer:{}},attachmentList:[],courseId:"",defaultAvatar:S,manIcon:T,womanIcon:Z,specialEnv:"",isCalendar:!1,offline_course_details:[],loading:!1,is_start_study:!1,allId:[]}),computed:(0,a.Z)((0,a.Z)({},(0,v.mapState)("user",["appType"])),(0,v.mapGetters)({primaryColor:"getPrimaryColor",env:"getEnv",fresh:"microCourse/getFreshStatus"})),watch:{fresh(t){t&&(this.refresh(),this.$store.commit("microCourse/updateFresh",!1))}},mounted(){document.title=this.$t("pageTitle.offlineCourseDetail"),this.courseId=this.$route.params.courseId,this.specialEnv=C.Z.specialEnv,"wx_app"===this.appType&&(0,_.UI)("OFFLINE_COURSE_SCHEDULE")&&(this.isCalendar=!0),this.refresh()},methods:{refresh(){this.loading=!0,this.init()},async init(){const{stageId:t,studyId:e,studyId:s,from:a}=this.$route.query,i=await I.Z.getOfflineCourseInfo(this.courseId);this.basicInfo=i.data.data;const o="project"===a?await I.Z.getOfflineProjectCourseInfo({project_course_id:e,stage_id:t}):await I.Z.getOfflinetaskCourseInfo({planId:s,stage_id:t});if(this.offline_course_details=o.data.offline_course_details,this.getAllId(o.data.offline_course_details),this.loading=!1,"project"===a){const{getProjectDetail:t}=b.Z,s=await t({studyId:e});this.is_start_study="true"===s.data.is_start_study}},getAllId(t){let e=[];t.forEach((t=>{t.am_data&&t.am_data.data_list.forEach((t=>{13===t.data_type&&e.push(t.sign_detail.sign_info.id),7===t.data_type&&e.push(t.offline_course_vo.id)})),t.pm_data&&t.pm_data.data_list.forEach((t=>{13===t.data_type&&e.push(t.sign_detail.sign_info.id),7===t.data_type&&e.push(t.offline_course_vo.id)}))})),this.allId=e},async changeSchedule(t){let e={};e=t?await I.Z.cancelSchedule(this.courseId):await I.Z.addSchedule(this.courseId),e.data.success&&(this.basicInfo.joined_calendar=!t)},handleScan(){const{env:t,specialEnv:e}=C.Z;"dingTalk"===t||"dingTalk_h5"===e||"app"===t||"app"===e||"lark"===t||"zhiYuan"===t||"whLink"===t?C.Z.scan({type:"qrCode"},(s=>{const a=s.code;if(a.includes("/assets-share.html"))(0,M.tD)(a,((t,e)=>{if("h5"===e){const e=(0,y.dL)(t);this.jumpSignPage(e)}}));else if("alipay"===t||"dingTalk_h5"===e||"zhiYuan"===t||"zhiYuan"===e){if(a.match(/^dingtalk:\/\//)){const t=decodeURIComponent(a.split("page=")[1].split("&")[0]),e=(0,y.dL)(t);this.jumpSignPage(e)}}else if("app"===t||"app"===e||"whLink"===t){const t=(0,y.dL)(a);"true"===t.fromApp&&"offline"===t.flag&&this.jumpSignPage(t)}else if("lark"===t||"lark"===e){const t=decodeURIComponent(a),e=(0,y.dL)(t);this.jumpSignPage(e)}}),(t=>{console.error(t),this.$toast.fail(this.$t("signIn.saveQRCodeFail"))})):"zhuomuniao"===t?C.Z.scan({type:"test"},(t=>{const e=Object.values(t);let s="";for(let t=0;t<e.length-3;t++)s+=e[t];(0,M.tD)(s,((t,e)=>{if("h5"===e){const e=(0,y.dL)(t);this.jumpSignPage(e)}}))})):"wechat_h5"===t||"wechat_h5"===e||"wechat_qy"===t||"wechat_qy"===e?this.$dialog({message:this.$t("login.wxScanTips")}):this.$dialog({message:this.$t("login.h5ScanTips")})},jumpSignPage({clockTimeId:t,qcTime:e="",signStyle:s}){let a="";this.allId.forEach((e=>{e===t&&(a=e)}));const i=`/offline-result?clockTimeId=${a}&qcTime=${e}&signStyle=${s}&studyType=${this.basicInfo.source_type}&status=true`;t===a?this.$router.push({path:i}):this.$toast(this.$t("offline.checkInMatchTips"))},getAdeptField:t=>t.split(","),getSignStatus(t,e){return"missing"===t?"in"===e?this.$t("signIn.unsigned"):this.$t("signIn.unsignedOut"):"abnormal"===t?"in"===e?this.$t("signIn.late"):this.$t("signIn.early"):"leaved"===t?this.$t("signIn.leaved"):"normal"===t?this.$t("signIn.normal"):void 0},renderData:t=>(0,f.p6)(Number(t),"MM-dd")}},V=(0,N.Z)(B,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"offline-course-detail"},[s("div",{staticClass:"course-info"},[s("course-cover",[s("van-image",{attrs:{fit:"fill",src:"https://oss.coolcollege.cn/1818197339236601856.png",width:"100%",height:"100%"}})],1),s("div",{staticClass:"cbottom"},[s("p",{staticClass:"cbtn",class:{isCalendar:t.isCalendar}},[t.isCalendar?s("van-button",{attrs:{type:"default",text:t.basicInfo.joined_calendar?t.$t("offline.removeCalendar"):t.$t("offline.addCalendar")},on:{click:function(e){return t.changeSchedule(t.basicInfo.joined_calendar)}},scopedSlots:t._u([{key:"icon",fn:function(){return[s("svg-icon",{staticClass:"iconfont",attrs:{size:14,"icon-class":"icon-meiriqiandao-PC",color:"#7F849A"}})]},proxy:!0}],null,!1,1690900703)}):t._e(),s("van-button",{attrs:{type:"default",text:t.$t("offline.scanSignIn")},on:{click:t.handleScan},scopedSlots:t._u([{key:"icon",fn:function(){return[s("svg-icon",{staticClass:"iconfont",attrs:{size:14,"icon-class":"icon-saoyisao",color:"#7F849A"}})]},proxy:!0}])})],1)])],1),s("div",{staticClass:"course-detail"},t._l(t.offline_course_details,(function(e,a){return s("div",{key:a.toString(),staticClass:"item"},[e.am_data?s("div",[s("div",{staticClass:"title"},[t._v(t._s(t.renderData(e.am_data.timestamp))+" "+t._s(t.$t("offline.am")))]),t._l(e.am_data.data_list,(function(e,a){return s("div",{key:a.toString(),staticClass:"list-item"},[13===e.data_type?s("Sign",{attrs:{info:e}}):t._e(),7===e.data_type?s("OffLine",{attrs:{info:e,"is-start-study":t.is_start_study,reload:t.refresh}}):t._e()],1)}))],2):t._e(),e.pm_data?s("div",[s("div",{staticClass:"title"},[t._v(t._s(t.renderData(e.pm_data.timestamp))+" "+t._s(t.$t("offline.pm")))]),t._l(e.pm_data.data_list,(function(e,a){return s("div",{key:a.toString(),staticClass:"list-item"},[13===e.data_type?s("Sign",{attrs:{info:e}}):t._e(),7===e.data_type?s("OffLine",{attrs:{info:e,"is-start-study":t.is_start_study,reload:t.refresh}}):t._e()],1)}))],2):t._e()])})),0),s("overlay-loading",{attrs:{show:t.loading}})],1)}),[],!1,null,"ef29614a",null).exports},12731:(t,e,s)=>{s.r(e),s.d(e,{default:()=>v});var a=s(95082),i=(s(47601),s(44951)),o=(s(25773),s(35791)),r=(s(57658),s(33948),s(26699),s(32023),s(74916),s(4723),s(26294)),n=s(22648),c=s(98512),l=s(27632),u=s(78e3),d=s(61564),h=s(85384),p=s(55602),m=s(36129),g={components:{[o.Z.name]:o.Z,[i.Z.name]:i.Z,CourseCover:d.Z,Sign:m.Z,OverlayLoading:h.Z},filters:{formatDate:t=>(0,n.p6)(t,"yyyy.MM.dd hh:mm")},data:()=>({basicInfo:[],attachmentList:[],courseId:"",specialEnv:"",signDate:[],loading:!1,allId:[]}),computed:(0,a.Z)((0,a.Z)({},(0,r.mapState)("user",["appType"])),(0,r.mapGetters)({primaryColor:"getPrimaryColor",env:"getEnv",fresh:"microCourse/getFreshStatus"})),watch:{fresh(t){t&&(this.refresh(),this.$store.commit("microCourse/updateFresh",!1))}},mounted(){this.courseId=this.$route.params.courseId,this.refresh()},methods:{refresh(){this.loading=!0,this.init()},async init(){const t=await u.Z.getOfflineSign(this.courseId);this.basicInfo=t,this.basicInfo.forEach((t=>{this.allId.push(t.sign_detail.sign_info.id),this.signDate.push("sign_in"===t.sign_type?(0,n.p6)(t.sign_detail.sign_info.signInBeginTime,"MM-dd hh"):(0,n.p6)(t.sign_detail.sign_info.signOutBeginTime,"MM-dd hh"))})),this.loading=!1,this.signDate=this.signDate.map((t=>Number(t.slice(6))>12?`${t.slice(0,5)} ${this.$t("offline.pm")}`:`${t.slice(0,5)} ${this.$t("offline.am")}`)),this.signDate=[...new Set(this.signDate)]},handleScan(){const{env:t,specialEnv:e}=l.Z;"dingTalk"===t||"dingTalk_h5"===e||"app"===t||"app"===e||"lark"===t||"zhiYuan"===t||"whLink"===t?l.Z.scan({type:"qrCode"},(s=>{const a=s.code;if(a.includes("/assets-share.html"))(0,p.tD)(a,((t,e)=>{if("h5"===e){const e=(0,c.dL)(t);this.jumpSignPage(e)}}));else if("alipay"===t||"dingTalk_h5"===e||"zhiYuan"===t||"zhiYuan"===e){if(a.match(/^dingtalk:\/\//)){const t=decodeURIComponent(a.split("page=")[1].split("&")[0]),e=(0,c.dL)(t);this.jumpSignPage(e)}}else if("app"===t||"app"===e||"whLink"===t){const t=(0,c.dL)(a);"true"===t.fromApp&&"offline"===t.flag&&this.jumpSignPage(t)}else if("lark"===t||"lark"===e){const t=decodeURIComponent(a),e=(0,c.dL)(t);this.jumpSignPage(e)}}),(t=>{console.error(t),this.$toast.fail(this.$t("signIn.saveQRCodeFail"))})):"zhuomuniao"===t?l.Z.scan({type:"test"},(t=>{const e=Object.values(t);let s="";for(let t=0;t<e.length-3;t++)s+=e[t];(0,p.tD)(s,((t,e)=>{if("h5"===e){const e=(0,c.dL)(t);this.jumpSignPage(e)}}))})):"wechat_h5"===t||"wechat_h5"===e||"wechat_qy"===t||"wechat_qy"===e?this.$dialog({message:this.$t("login.wxScanTips")}):this.$dialog({message:this.$t("login.h5ScanTips")})},jumpSignPage({clockTimeId:t,qcTime:e="",signStyle:s}){const{from:a}=this.$route.query,i="project"===a?"study_project":"study_plan";let o="";this.allId.forEach((e=>{e===t&&(o=e)}));const r=`/offline-result?clockTimeId=${o}&qcTime=${e}&signStyle=${s}&studyType=${i}&status=true`;t===o?this.$router.push({path:r}):this.$toast(this.$t("offline.checkSign"))}}},v=(0,s(1001).Z)(g,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"offline-course-detail"},[s("div",{staticClass:"course-info"},[s("course-cover",[s("van-image",{attrs:{fit:"fill",src:"https://oss.coolcollege.cn/1818453621612875776.png",width:"100%",height:"100%"}})],1),s("div",{staticClass:"cbottom"},[s("p",{staticClass:"cbtn"},[s("van-button",{attrs:{type:"default",text:t.$t("offline.scanSignIn")},on:{click:t.handleScan},scopedSlots:t._u([{key:"icon",fn:function(){return[s("svg-icon",{staticClass:"iconfont",attrs:{size:14,"icon-class":"icon-saoyisao",color:"#7F849A"}})]},proxy:!0}])})],1)])],1),t.basicInfo.length>0?s("div",{staticClass:"sign-list"},t._l(t.basicInfo,(function(e,a){return s("div",{key:a.toString(),staticClass:"sign-item"},[t.signDate[a]?s("div",{staticClass:"title"},[t._v(t._s(t.signDate[a]))]):t._e(),s("Sign",{attrs:{info:e}})],1)})),0):t._e(),s("overlay-loading",{attrs:{show:t.loading}})],1)}),[],!1,null,"96f204e0",null).exports},32275:(t,e,s)=>{s.r(e),s.d(e,{default:()=>g});var a=s(95082),i=(s(34837),s(39146)),o=(s(21790),s(24031)),r=(s(25773),s(35791)),n=(s(74916),s(15306),s(22648)),c=s(78e3),l=s(95969),u=s(27632),d=s(48041),h=s(78551),p=s(96838),m={components:{[r.Z.name]:r.Z,Tag:o.Z,SvgIcon:h.Z},data:()=>({signInResult:{},signInfo:{},planId:"",studyType:"",loading:!0,qcTime:"",errorMsg:"",errorCode:"",showConfirmBtn:!0,address:"",longitude:"",latitude:"",showAddress:!1,backBtnVisible:!1,locationUnbound:!1,locationAuth:!0,sign_style:"",hasSigned:!1,inScope:!1,showTime:!0}),computed:{getSrc(){const{signInResult:{sign_status:t},errorCode:e}=this;let s="error_404";return"sign_out_late"===t||"leaved"===t||"signed_exists"===t||"late_signed"===t||"sign_out_early"===t?s="arrive_early":"signed"===t||"signed_out"===t?s="signed_out":"arrive_early"===t||"404"===e?s="error_404":"500"===e&&(s="error_500"),`https://gsdn.coolcollege.cn/assets/offline/${s}.png`},themeColor(){return this.$store.state.themeColor},signTypeLabel(){return"sign_in"===this.sign_style?"signIn.signIn":"signIn.signOut"},signTime(){return"sign_in"===this.sign_style?(0,n.yM)(this.signInfo.sign_in_begin_time,this.signInfo.sign_in_end_time):(0,n.yM)(this.signInfo.sign_out_begin_time,this.signInfo.sign_out_end_time)},signStatus(){const{signInResult:{sign_status:t},errorCode:e}=this;let s={status:{name:"late_signed",value:""}},a="";switch(a="404"===e?"error404":"500"===e?"error500":t,a){case"arrive_early":s=this.renderStatus({status:s,value:"signIn.checkInFailed",isColor:!0,tip:this.$t("signIn.pleaseSignInCorrectDate"),showTime:!1});break;case"sign_out_late":s=this.renderStatus({status:s,value:"signIn.cannotCheckout",isColor:!0,showTime:!1});break;case"signed":s=this.renderStatus({status:s,value:"signIn.checkSuccess",isColor:!0,color:"#3bee3b",text:this.$t("signIn.onTime"),timeKey:"sign_in_time"});break;case"signed_exists":s=this.renderStatus({status:s,value:"signIn.repeatCheckin",isColor:!0,timeKey:"sign_in_time"});break;case"signed_out":s=this.renderStatus({status:s,value:"signIn.checkOutSuccess",isColor:!0,tag:!0,color:"#3bee3b",text:this.$t("signIn.onTime"),timeKey:"sign_out_time"});break;case"late_signed":s=this.renderStatus({statusClass:"late_signed",status:s,value:"signIn.late",color:"#f1bd5e",text:this.$t("signIn.late"),timeKey:"sign_in_time"});break;case"sign_out_early":s=this.renderStatus({statusClass:"late_signed",status:s,value:"signIn.early",color:"#f1bd5e",text:this.$t("signIn.early"),timeKey:"sign_out_time"});break;case"leaved":s.status.value="signIn.leave",s.status.name="late_signed";break;case"error404":this.renderErrorStatus(s,"sign_in"===this.sign_style?"signIn.checkInFailed":"signIn.checkOutFailed");break;case"error500":this.renderErrorStatus(s,"signIn.systemError");break;default:s.status.value="sign_in"===this.sign_style?"signIn.checkInFailed":"signIn.checkOutFailed"}return s}},mounted(){p.Z.logger({moduleName:"mountedGoInSignPage"}),this.getAttendanceLocation()},activated(){p.Z.logger({moduleName:"activatedGoInSignPage"}),this.getAttendanceLocation()},beforeDestroy(){this.$toast.clear(),sessionStorage.setItem("isOpenScan",!1)},methods:{viewDetails(){const{studyType:t}=this;"study_project"===t?this.projectViewDetails():"study_plan"===t&&this.studyViewDetails()},studyViewDetails(){c.Z.postStudyViewDetails(this.planId).then((t=>{let e="";e="success"===t.data.status?l.Z.home.studyDetail({studyId:this.planId}):l.Z.home.studyList(),this.$router.replace({path:e})})).catch((t=>{console.error(t),this.$router.replace({path:l.Z.home.studyList()})}))},projectViewDetails(){c.Z.postLoadProjectResources(this.planId).then((()=>{this.$router.replace({path:l.Z.studyProject.toStudyProject({query_source:"sign",studyProjectId:this.planId})})})).catch((()=>{this.$router.replace({path:l.Z.resource.trainingProject()})}))},reverseBack(){history.go(-1)},renderErrorStatus(t,e){const{errorMsg:s}=this;t.status.value=e,t.status.name="fail_signed",t.otherStatus={value:s,name:"marked_words"}},renderStatus({statusClass:t="signed",status:e,value:s,isColor:a=!1,color:i,text:o,tip:r,showTime:c=!0,timeKey:l}){const{signInResult:u}=this;return e.status.name=t,a&&(e.status.color=this.themeColor.primaryColor),e.status.value=s,e.otherStatus={name:"sign_date",signTime:c&&(0,n.p6)(u[l],"yyyy-MM-dd hh:mm"),color:i,text:o,value:r},e},callbackJump(){const{signInResult:{sign_status:t}}=this,e=["need_enroll","no_purchased","enroll_wait"];-1!==e.indexOf(t)?this.viewDetails():-1===e.indexOf(t)&&(this.loading=!1,this.backBtnVisible=!0)},catchAction(t){i.Z.clear();let e="";switch(t.data.code){case"enterpriseapi.542009":e=this.$t("signIn.notRegisteredTips");break;case"enterpriseapi.542007":case"577023":e=this.$t("signIn.notVisibleTips");break;case"577017":e=this.$t("project.register");break;case"577018":e=this.$t("project.registerRefused");break;case"577019":e=this.$t("project.quotaFull");break;case"577020":e=this.$t("project.approving");break;case"577021":e=this.$t("signIn.registeError");break;case"577022":e=this.$t("order.openOrders")}return this.loading=!1,e?(this.errorCode="404",this.errorMsg=e,!1):404===t.status||"404002"===t.data.code?(this.errorCode="404",this.errorMsg=this.$t("signIn.notExistTips"),!1):void(this.errorCode="500")},getSignInResult(){i.Z.loading({forbidClick:!0,duration:8e3,message:"Loading"});const{address:t,longitude:e,latitude:s}=this,{query:o}=this.$route,{getSignInResult:r}=c.Z;p.Z.logger({module:"offlineCourseSign",data:(0,a.Z)({address:t,longitude:e,latitude:s},o)}),r((0,a.Z)((0,a.Z)({},o),{},{address:t,longitude:e,latitude:s})).then((t=>{const{data:e}=t.data;this.updateData(e,null)})).catch((t=>{this.catchAction(t)}))},judgeLocation(t,e,s=!0){u.Z.getLocation({type:"dingTalk"===u.Z.env?1:"gcj02"},(o=>{if(i.Z.clear(),"success"===o.status){const{latitude:r,longitude:n,sign_range:c}=e;if((0,d.bp)({latitude:r,longitude:n},{latitude:o.latitude,longitude:o.longitude},c))this.longitude=o.longitude,this.latitude=o.latitude,this.address=o.address,this.inScope=!0,this.locationUnbound=!1,this.locationAuth=!0,s&&(this.inScope=!1,this.getSignInResult());else{i.Z.loading({forbidClick:!0,duration:2e3,message:this.$t("signIn.rangeOutOfRange")}),this.locationUnbound=!0,this.locationAuth=!0,this.inScope=!1,this.updateData(t,e);const s=(0,d.Sp)(e.latitude,e.longitude,o.latitude,o.longitude);p.Z.logger({moduleName:"attendanceNotInScope",data:{currentRes:(0,a.Z)({},o),signStyle:this.sign_style,clockTimeId:this.$route.query.clockTimeId,dis:1e3*s,config:(0,a.Z)({},e)}})}}else"wechat_qy"!==u.Z.env||s||i.Z.loading({forbidClick:!0,duration:3e3,message:this.$t("signIn.locationNotOpen")}),this.locationUnbound=!1,this.locationAuth=!1,this.inScope=!1,this.updateData(t,e)}))},getSignStatus(){const{sign_status:t}=this.signInResult;"signed"!==t&&"signed_exists"!==t&&"signed_out"!==t&&"leaved"!==t&&"late_signed"!==t&&"sign_out_early"!==t&&"sign_out_late"!==t||(this.hasSigned=!0),"signed"!==t&&"signed_exists"!==t&&"signed_out"!==t&&"leaved"!==t&&"late_signed"!==t&&"sign_out_early"!==t||(this.showTime=!1),"arrive_early"===t&&this.qcTime&&(this.hasSigned=!0)},updateData(t,e){const{query:s}=this.$route;this.signInResult=(0,a.Z)((0,a.Z)({},t),{},{status:s.status}),e&&(this.signInfo=e),this.planId=t.plan_id,this.studyType=t.source_type,this.$nextTick((()=>{this.callbackJump()})),this.getSignStatus(),i.Z.clear()},getAttendanceLocation(){sessionStorage.setItem("isOpenScan",!0),this.locationUnbound=!1,this.locationAuth=!0,this.inScope=!1;const{query:t}=this.$route,{clockTimeId:e,qcTime:s,signStyle:a}=t;this.sign_style=a,this.qcTime=s,i.Z.loading({forbidClick:!0,duration:8e3,message:"Loading"}),p.Z.logger({moduleName:"getSignDetail",data:{query:t}}),c.Z.getSignDetail(e,{qc_time:s,sign_style:a}).then((t=>{const{data:{sign_record:e,course_config:s}}=t.data;if(!e.sign_status)return s.address?void this.judgeLocation(e,s):void this.getSignInResult();this.updateData(e,s)})).catch((t=>{this.catchAction(t)}))}}},g=(0,s(1001).Z)(m,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.loading?t._e():s("div",{staticClass:"signInResult_container"},["qrcode_invalid"!==t.signInResult.sign_status?s("div",{staticClass:"signInResult"},[s("div",{staticClass:"sign_img"},[s("img",{attrs:{src:t.getSrc}})]),s("div",{staticClass:"sign_result"},[s("div",{class:t.signStatus.status.name,style:{color:t.signStatus.status.color||"inherit"}},[s("span",[t._v(t._s(t.$t(""+t.signStatus.status.value)))])]),t.signStatus.otherStatus?s("div",{class:t.signStatus.otherStatus.name},[t.signStatus.otherStatus.signTime?s("span",[t._v(" "+t._s(t.$t(t.signTypeLabel))+t._s(t.$t("ddLive.time"))+"： ")]):t._e(),t.signStatus.otherStatus.signTime?s("span",[t._v(" "+t._s(t.signStatus.otherStatus.signTime)+" ")]):t._e(),t.signStatus.otherStatus.color?s("Tag",{attrs:{color:t.signStatus.otherStatus.color,plain:""}},[t._v(" "+t._s(t.signStatus.otherStatus.text))]):t._e(),t.signStatus.otherStatus.value?s("span",{staticClass:"tip"},[t._v(" "+t._s(t.$t(""+t.signStatus.otherStatus.value))+" ")]):t._e()],1):t._e()]),!t.locationAuth||t.locationUnbound||t.inScope?s("div",{staticClass:"auth-location"},[s("div",{staticClass:"tip"},[t.locationAuth?t._e():s("span",[t._v(t._s(t.$t("signIn.openAuth")))]),t.locationUnbound?s("span",[t._v(t._s(t.$t("signIn.rangeOutOfRange")))]):t._e(),t.inScope?s("span",[t._v(t._s(t.$t("signIn.rangeInScope")))]):t._e(),t.locationUnbound?s("span",{staticClass:"auth-action",on:{click:function(e){return t.judgeLocation(t.signInResult,t.signInfo,!1)}}},[s("svgIcon",{attrs:{"icon-class":"icon-shuaxin",size:14,color:t.themeColor.primaryColor}}),t._v(" "+t._s(t.$t("signIn.refresh")))],1):t._e()]),t.locationUnbound?s("div",{staticClass:"range"},[t._v(" "+t._s("sign_in"===t.sign_style?t.$t("signIn.addressIs"):t.$t("signIn.addressSignOutIs"))+" "),s("span",{staticClass:"range-number"},[t._v(t._s(t.signInfo.sign_range)+" "+t._s(t.$t("signIn.meter")))]),t._v(" "+t._s(t.$t("signIn.rangePunch")))]):t._e()]):t._e(),t.showTime&&(t.signInfo.address||t.signTime)?s("div",{class:{"sign-config":!0,"only-time":!t.signInfo.address}},[s("div",{staticClass:"sign_item"},[s("span",{staticClass:"item-label"},[t._v(t._s(t.$t(t.signTypeLabel))+t._s(t.$t("ddLive.time"))+"：")]),s("span",{staticClass:"item-value"},[t._v(t._s(t.signTime))])]),t.signInfo.address?s("div",{staticClass:"sign_item address"},[s("span",{staticClass:"item-label"},[t._v(" "+t._s(t.$t(t.signTypeLabel))+t._s(t.$t("common.address"))+"： ")]),s("span",{staticClass:"item-value"},[t._v(" "+t._s(t.signInfo.address)+" "+t._s(t.signInfo.address_detail)+" ")])]):t._e()]):t._e()]):s("div",{staticClass:"invalid-qr-code"},[s("div",{staticClass:"qrcode-box"},[s("img",{attrs:{src:"https://oss.coolcollege.cn/1790938364975910912.png"}}),s("div",{staticClass:"tips"},[t._v(t._s(t.$t("signIn.QrCodeInvalid")))])])]),"qrcode_invalid"!==t.signInResult.sign_status?s("div",{class:{"sign-action":!0,single:!(!t.hasSigned&&t.backBtnVisible),"ios-bottom":t.isIpx}},[t.signInResult.status?s("van-button",{class:[t.showConfirmBtn?"reverseBack active":"reverseBack"],attrs:{type:!t.hasSigned&&t.backBtnVisible?"default":"primary",color:!t.hasSigned&&t.backBtnVisible?"":t.themeColor.primaryColor},on:{click:t.reverseBack}},[t._v(t._s(t.$t("buttons.confirm")))]):t._e(),!t.signInResult.status&&t.signInResult.source_type&&t.backBtnVisible?s("van-button",{staticClass:"view_details",attrs:{type:t.hasSigned?"primary":"default",color:!t.hasSigned&&t.backBtnVisible?"":t.themeColor.primaryColor},on:{click:t.viewDetails}},[t._v(t._s(t.$t("signIn.seeDetails")))]):t._e(),!t.hasSigned&&t.backBtnVisible?s("van-button",{staticClass:"view_details",attrs:{type:"primary",color:t.themeColor.primaryColor},on:{click:t.getAttendanceLocation}},[t._v(t._s(t.$t("signIn.rePunch")))]):t._e()],1):t._e()])}),[],!1,null,"7be53101",null).exports},57530:(t,e,s)=>{s.r(e),s.d(e,{default:()=>_});var a=s(95082),i=(s(25773),s(35791)),o=(s(23307),s(81392)),r=(s(82500),s(49414)),n=(s(82522),s(10342)),c=(s(86039),s(20495)),l=(s(20581),s(50914)),u=(s(49153),s(5944)),d=(s(69710),s(57609)),h=(s(52355),s(29233)),p=(s(33948),s(57658),s(26294)),m=s(22648),g=s(78e3),v=s(78551),f={components:{[h.Z.name]:h.Z,[d.Z.name]:d.Z,[u.Z.name]:u.Z,[l.Z.name]:l.Z,[c.Z.name]:c.Z,[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,SvgIcon:v.Z},data:()=>({activeTab:"unfinished",tabs:[{title:"unfinished",name:"unfinished"},{title:"finished",name:"finished"}],list:[],loading:!1,finished:!1,params:{keyword:"",train_status:"unfinished",page_number:0,page_size:10}}),computed:(0,a.Z)({},(0,p.mapGetters)({primaryColor:"getPrimaryColor"})),created(){},mounted(){},methods:{onTabChange(){this.resetQuery()},resetQuery(){this.params=(0,a.Z)((0,a.Z)({},this.params),{},{train_status:this.activeTab,page_number:0}),this.loading=!0,this.finished=!1,this.list=[],this.loading&&this.onLoad()},async onLoad(){this.params.page_number+=1;const t=await g.Z.getSignCoursesList(this.params),{list:e,has_next_page:s}=t.data.data;this.list=[...this.list,...e],this.loading=!1,s||(this.finished=!0)},toSignCourseDetail(t){0===t.course_num?this.$router.push({path:`/sign-list/0/${t.id}?type=${t.source_type}&&signIn=${t.exist_sign_in_config}&signOut=${t.exist_sign_out_config}`}):this.$router.push({path:`/sign-detail/${t.id}`})},renderData:t=>(0,m.p6)(t,"yyyy-MM-dd hh:mm"),toSignIn(t){this.$router.push({path:`/sign-qrcode/${t.id}`,query:{hasSignIn:t.exist_sign_in_config,hasSignOut:t.exist_sign_out_config,qrcode_type:t.qrcode_type,source_type:t.source_type}})}}},y=f,_=(0,s(1001).Z)(y,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"offline-wrap"},[s("van-tabs",{attrs:{color:t.primaryColor,"line-width":24,sticky:""},on:{change:t.onTabChange},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},t._l(t.tabs,(function(e){return s("van-tab",{key:e.name,attrs:{title:t.$t("signIn."+e.title),name:e.name}})})),1),s("van-divider",{style:{margin:"0"}}),s("van-search",{attrs:{placeholder:t.$t("offline.signPlaceHolder")},on:{search:function(e){return t.resetQuery()},clear:function(e){return t.resetQuery()}},model:{value:t.params.keyword,callback:function(e){t.$set(t.params,"keyword",e)},expression:"params.keyword"}}),s("van-divider",{style:{margin:"0"}}),s("div",{staticClass:"reminder-info"},[s("van-icon",{attrs:{name:"info",size:"14",color:"#FFA000"}}),t._v(t._s(t.$t("offline.signBeforeInfo")))],1),s("van-list",{staticClass:"course-list",attrs:{"loading-text":t.$t("common.loading"),finished:t.finished,"finished-text":t.finished&&0===t.list.length?"":t.$t("common.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[t._l(t.list,(function(e){return s("div",{key:e.id,staticClass:"course-item"},[s("div",{staticClass:"card-padding",on:{click:function(s){return t.toSignCourseDetail(e)}}},[s("p",{staticClass:"title"},[s("span",{staticClass:"van-ellipsis"},[t._v(t._s(e.name))]),s("van-icon",{attrs:{name:"arrow"}})],1),e.exist_sign_in_config?s("p",{staticClass:"text"},[s("span",[t._v(t._s(t.$t("signIn.signInTime")))]),t._v("："+t._s(t.renderData(e.sign_in_begin_time)+" ~ "+t.renderData(e.sign_in_end_time)))]):t._e(),e.exist_sign_out_config?s("p",{staticClass:"text"},[s("span",[t._v(t._s(t.$t("signIn.signOutTime")))]),t._v("："+t._s(t.renderData(e.sign_out_begin_time)+" ~ "+t.renderData(e.sign_out_end_time)))]):t._e()]),s("van-divider",{style:{margin:"0"}}),s("div",{staticClass:"qr-button"},[s("div",{staticClass:"text relevance"},[s("svg-icon",{attrs:{"icon-class":"icon-guanlian",color:"#C0C2CB",size:14}}),s("div",[t._v(t._s(t.$t("offline.aboutOffline"))+"：")]),s("div",{staticClass:"relevance-content"},[t._v(t._s(e.course_num))])],1),s("van-button",{attrs:{plain:""},on:{click:function(s){return t.toSignIn(e)}}},[t._v(t._s(t.$t("pageTitle.attendanceQRCode")))])],1)],1)})),t.finished&&0===t.list.length?s("van-empty",{attrs:{description:t.$t("common.noDataTextTip")}}):t._e()],2)],1)}),[],!1,null,"6ed35d02",null).exports},94057:(t,e,s)=>{s.r(e),s.d(e,{default:()=>f});var a=s(95082),i=(s(23307),s(81392)),o=(s(25773),s(35791)),r=(s(30653),s(57370)),n=(s(20581),s(50914)),c=(s(29941),s(64168)),l=(s(52355),s(29233)),u=(s(56629),s(55165)),d=(s(57658),s(26294)),h=s(22648),p=s(78e3),m=s(85384),g=s(45877),v={components:{[u.Z.name]:u.Z,[l.Z.name]:l.Z,[c.Z.name]:c.Z,[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,OverlayLoading:m.Z,ClCustomUser:g.Z},filters:{formatDate:t=>(0,h.p6)(t,"yyyy.MM.dd hh:mm")},data:()=>({basicInfo:{},list:[],signId:"",loading:!1}),computed:(0,a.Z)({},(0,d.mapGetters)({primaryColor:"getPrimaryColor"})),created(){},mounted(){this.signId=this.$route.params.signId,this.init()},methods:{async init(){this.loading=!0;const t=await p.Z.getOfflineSignBasic(this.signId),e={signId:this.signId,keyword:"",page_number:1,page_size:999999},s=await p.Z.getOfflineCourseSign(e);this.basicInfo=t.data.data,this.list=s.data.data.list,this.loading=!1},toSignIn(){const{signId:t}=this.$route.params;this.$router.push({path:`/sign-qrcode/${t}`,query:{hasSignIn:this.basicInfo.exist_sign_in_config,hasSignOut:this.basicInfo.exist_sign_out_config,qrcode_type:this.basicInfo.qrcode_type}})},toUpload(t){this.$router.push(`/home-module/lecturer-upload?activity_attachment_id=${t.summary.activity_attachment_id}`)},checkGrade(t){this.$router.push(`/examine-grade/${t.id}?passing_score=${t.config.assessment_pass_score}&total_score=${t.config.assessment_total_score}`)},toSignList(t){const{signId:e}=this.$route.params,{exist_sign_in_config:s,exist_sign_out_config:a}=this.basicInfo;(s||a)&&this.$router.push(`/sign-list/${t.id}/${e}?signIn=${s}&&signOut=${a}`)}}},f=(0,s(1001).Z)(v,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"sign-detail"},[s("overlay-loading",{attrs:{show:t.loading,text:t.$t("common.loading")}}),s("div",{staticClass:"sign-info card-padding"},[s("p",{staticClass:"title van-multi-ellipsis--l3"},[t._v(t._s(t.basicInfo.name))]),t.basicInfo.exist_sign_in_config?s("p",{staticClass:"text"},[t._v(t._s(t.$t("signIn.signInTime"))+"："+t._s(t._f("formatDate")(t.basicInfo.sign_in_begin_time))+" ~ "+t._s(t._f("formatDate")(t.basicInfo.sign_in_end_time)))]):t._e(),t.basicInfo.exist_sign_out_config?s("p",{staticClass:"text"},[t._v(t._s(t.$t("signIn.signOutTime"))+"："+t._s(t._f("formatDate")(t.basicInfo.sign_out_begin_time))+" ~ "+t._s(t._f("formatDate")(t.basicInfo.sign_out_end_time)))]):t._e(),s("van-button",{on:{click:t.toSignIn},scopedSlots:t._u([{key:"icon",fn:function(){},proxy:!0}])},[s("svg-icon",{staticClass:"iconfont",attrs:{size:14,"icon-class":"icon-saoyisao",color:"#7F849A"}}),t._v(t._s(t.$t("pageTitle.attendanceQRCode")))],1)],1),s("van-notice-bar",{attrs:{color:"#2d3040",background:"transparent","left-icon":"info-o",text:t.$t("signIn.signInTips")}}),s("van-cell-group",{staticClass:"analysis-list"},t._l(t.list,(function(e){return s("van-cell",{key:e.id,staticClass:"analysis-item card-padding",scopedSlots:t._u([{key:"title",fn:function(){return[s("div",[s("div",{staticClass:"content-info",on:{click:function(s){return t.toSignList(e)}}},[s("p",{staticClass:"title"},[s("span",{staticClass:"title-text"},[t._v(t._s(e.title))]),s("van-icon",{attrs:{name:"arrow"}})],1),s("p",{staticClass:"text"},[t._v(t._s(t.$t("initCourse.lecturer"))+"： "),"inside"===e.teacher_sync_type?s("cl-custom-user",{attrs:{type:e.teacher_sync_source_type,"data-type":"userName",value:e.teacher_sync_user_id,name:e.lecturer_name}}):s("span",[t._v(t._s(e.lecturer_name))])],1),s("p",{staticClass:"text"},[t._v(t._s(t.$t("offline.classTime"))+"："+t._s(t._f("formatDate")(e.begin_time))+" ~ "+t._s(t._f("formatDate")(e.end_time)))]),s("p",{staticClass:"text"},[t._v(t._s(t.$t("offline.classAddr"))+"："+t._s(e.address||"--"))]),t.basicInfo.exist_sign_in_config?s("p",{staticClass:"text"},[s("span",[t._v(t._s(t.$t("signIn.signIns"))+"："+t._s(e.sign_in_user_count))])]):t._e(),t.basicInfo.exist_sign_out_config?s("p",{staticClass:"text"},[s("span",[t._v(t._s(t.$t("signIn.signOffs"))+"："+t._s(e.sign_out_user_count))])]):t._e()]),e.config?s("div",{staticClass:"qr-button van-hairline--top"},[e.config.is_open_upload?s("van-button",{attrs:{plain:""},on:{click:function(s){return t.toUpload(e)}}},[t._v(t._s(t.$t("pageTitle.lecturerUpload")))]):t._e(),e.config.is_open_offline_assessment?s("van-button",{attrs:{plain:""},on:{click:function(s){return t.checkGrade(e)}}},[t._v(t._s(t.$t("signIn.evaluationScore")))]):t._e()],1):t._e()])]},proxy:!0}],null,!0)})})),1)],1)}),[],!1,null,"0ddd532b",null).exports},21324:(t,e,s)=>{s.r(e),s.d(e,{default:()=>y});var a=s(95082),i=(s(82500),s(49414)),o=(s(82522),s(10342)),r=(s(20581),s(50914)),n=(s(47601),s(44951)),c=(s(49153),s(5944)),l=(s(69710),s(57609)),u=(s(52355),s(29233)),d=(s(33948),s(26294)),h=s(22648),p=s(78e3),m=s(78368),g=s(45877),v={components:{[u.Z.name]:u.Z,[l.Z.name]:l.Z,[c.Z.name]:c.Z,[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,ClCustomUser:g.Z},filters:{formatDate:t=>(0,h.p6)(t,"yyyy.MM.dd hh:mm")},data:()=>({activeTab:"0",activeTabType:"0",tabs:[{title:"signIn",name:"signIn"},{title:"signOut",name:"signOut"}],tabVisible:!1,tabsType:[],list:[],loading:!1,finished:!1,params:{sign_status:"",page_number:0,page_size:10},defaultAvatar:m,statusColor:"#B2B2B2"}),computed:(0,a.Z)({},(0,d.mapGetters)({primaryColor:"getPrimaryColor"})),watch:{},created(){},mounted(){document.title=this.$t("pageTitle.checkInDetail"),this.courseId=this.$route.params.courseId,this.signId=this.$route.params.signId,this.setTabs()},methods:{setTabs(){const{signIn:t,signOut:e}=this.$route.query;this.activeTab="true"===t?"signIn":"signOut",this.tabVisible="true"===t&&"true"===e,this.setTabsType(),this.params=(0,a.Z)((0,a.Z)({},this.params),{},{sign_status:this.tabsType[0].name||""})},setTabsType(){this.tabsType=[{title:"signIn"===this.activeTab?"unsigned":"unsignedOut",name:"signIn"===this.activeTab?"un_sign_in":"un_sign_out"},{title:"signIn"===this.activeTab?"signed":"signedOut",name:"signIn"===this.activeTab?"sign_in":"sign_out"}],this.$refs.listBox&&this.$refs.listBox.check()},changeTabs(t){this.onTabChange(t)},onTabChange(t){this.params=(0,a.Z)((0,a.Z)({},this.params),{},{sign_status:t,page_number:0}),this.loading=!1,this.list=[],this.finished?this.finished&&(this.finished=!1):(this.onLoad(),this.finished=!1)},async onLoad(){this.params.page_number+=1;let t={};t="0"===this.courseId?await p.Z.getSignMonitors((0,a.Z)((0,a.Z)({},this.params),{},{signId:this.signId})):await p.Z.getSignUsers((0,a.Z)((0,a.Z)({},this.params),{},{courseId:this.courseId,signId:this.signId}));const{list:e,has_next_page:s}=t.data.data;this.list=[...this.list,...e],this.loading=!1,s||(this.finished=!0)},renderSignStatus(t){const e={missing:this.$t("signIn.missing"),normal:this.$t("signIn.normal"),leaved:this.$t("signIn.leaved"),late:this.$t("signIn.late"),leaveEarly:this.$t("signIn.early"),noIn:this.$t("signIn.unsigned"),noOut:this.$t("signIn.unsignedOut")};let s="signIn"===this.activeTab?t.sign_in_status:t.sign_out_status,a="";return"abnormal"===s&&(s="signIn"===this.activeTab?"late":"leaveEarly",a="red"),"missing"===s&&(s="signIn"===this.activeTab?"noIn":"noOut",a="red"),"normal"===s&&(a="#00C800"),"late"===s&&(a="red"),{name:e[s],color:a}}}},f=v,y=(0,s(1001).Z)(f,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"sign-list"},[t.tabVisible?s("van-tabs",{staticClass:"van-hairline--bottom",attrs:{color:t.primaryColor,"line-width":24,sticky:""},on:{change:t.setTabsType},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},t._l(t.tabs,(function(e){return s("van-tab",{key:e.name,attrs:{title:t.$t("signIn."+e.title),name:e.name}})})),1):t._e(),t.tabsType.length?s("van-tabs",{attrs:{color:t.primaryColor,"line-width":24,sticky:""},on:{change:t.changeTabs},model:{value:t.activeTabType,callback:function(e){t.activeTabType=e},expression:"activeTabType"}},t._l(t.tabsType,(function(e){return s("van-tab",{key:e.name,attrs:{title:t.$t("signIn."+e.title),name:e.name}})})),1):t._e(),s("van-list",{ref:"listBox",staticClass:"user-list",attrs:{"loading-text":t.$t("common.loading"),finished:t.finished,"finished-text":t.finished&&0===t.list.length?"":t.$t("common.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[t._l(t.list,(function(e){return s("van-cell",{key:e.id,staticClass:"user-item",scopedSlots:t._u([{key:"title",fn:function(){return[s("van-image",{staticClass:"avatar",attrs:{src:e.user.avatar||t.defaultAvatar,fit:"fill"}}),s("cl-custom-user",{attrs:{type:e.user.source_type,"data-type":"userName",value:e.user.user_id,name:e.user.name}})]},proxy:!0},"sign_in"===t.activeTabType||"sign_out"===t.activeTabType?{key:"default",fn:function(){return["sign_in"===t.activeTabType?s("span",[e.sign_in_status?s("span",{staticClass:"status",style:{color:t.renderSignStatus(e).color}},[t._v(t._s(t.renderSignStatus(e).name))]):t._e(),s("span",[t._v(t._s(t._f("formatDate")(e.sign_in_time)))])]):s("span",[e.sign_out_status?s("span",{staticClass:"status",style:{color:t.renderSignStatus(e).color}},[t._v(t._s(t.renderSignStatus(e).name))]):t._e(),s("span",[t._v(t._s(t._f("formatDate")(e.sign_out_time)))])])]},proxy:!0}:null],null,!0)})})),t.finished&&0===t.list.length?s("van-empty",{attrs:{description:t.$t("common.noDataTextTip")}}):t._e()],2)],1)}),[],!1,null,"6e8bc0e5",null).exports},73363:(t,e,s)=>{s.r(e),s.d(e,{default:()=>y});var a=s(95082),i=(s(25773),s(35791)),o=(s(82522),s(10342)),r=(s(82500),s(49414)),n=(s(30653),s(57370)),c=(s(20581),s(50914)),l=(s(47601),s(44951)),u=(s(29941),s(64168)),d=(s(52355),s(29233)),h=(s(56629),s(55165)),p=(s(57658),s(26294)),m=s(46764),g=s(78e3),v=s(22648),f={components:{[h.Z.name]:h.Z,[d.Z.name]:d.Z,[u.Z.name]:u.Z,[l.Z.name]:l.Z,[c.Z.name]:c.Z,[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,MultiQrCode:m.Z},data:()=>({activeTab:"sign_in",tabs:[],basicInfo:{},signId:"",signInfo:{}}),computed:(0,a.Z)((0,a.Z)({},(0,p.mapState)("user",["appId"])),(0,p.mapGetters)({primaryColor:"getPrimaryColor"})),created(){},mounted(){document.title=this.$t("pageTitle.attendanceQRCode"),this.courseId=this.$route.params.courseId,this.signId=this.$route.params.signId;const{qrcode_type:t}=this.$route.query;this.setTabs(),this.basicInfo={qrcode_type:t},this.init()},methods:{setTabs(){const{hasSignIn:t,hasSignOut:e}=this.$route.query;this.activeTab="true"===t?"sign_in":"sign_out","true"===t&&this.tabs.push({title:"signInQRCode",name:"sign_in"}),"true"===e&&this.tabs.push({title:"signOutQRCode",name:"sign_out"})},async init(){const t=await g.Z.getOfflineSignBasic(this.signId);this.signInfo=t.data.data},setFormattingTime:(t,e)=>(0,v.yM)(Number(new Date(t)),Number(new Date(e))),saveQrcodePoster(){const{url:t,type:e}=this.$refs.qrCode.getCodeInfo();let s=(0,v.yM)(Number(new Date(this.signInfo.sign_in_begin_time)),Number(new Date(this.signInfo.sign_in_end_time)));"sign_out"===this.activeTab&&(s=(0,v.yM)(Number(new Date(this.signInfo.sign_out_begin_time)),Number(new Date(this.signInfo.sign_out_end_time))));let a=this.$t("signIn.signInTime");"sign_out"===this.activeTab&&(a=this.$t("signIn.signOutTime"));let i="";(this.signInfo.address||this.signInfo.address_detail)&&(i=`${this.signInfo.address}${this.signInfo.address_detail}`);const o="weixin"===e&&"9005"!==this.appId,r={headline:"sign_in"===this.activeTab?this.$t("signIn.signInQRCode"):this.$t("signIn.signOutQRCode"),path:"wx"===e||o?"":t,primary_color:"sign_in"===this.activeTab?"#516AE6":"#52C41A",site1:{label:a,value:s},template:[5],title:this.signInfo.course_name||"",from:"offline",wx_qr_code:"wx"===e||o?t:"",requestHttp:!0};i&&(r.site2={label:this.$t("signIn.address"),value:i}),this.$router.push({name:"Poster",params:r})}}},y=(0,s(1001).Z)(f,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"sign-qrcode"},[s("van-tabs",{attrs:{color:t.primaryColor,"line-width":24,sticky:""},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},t._l(t.tabs,(function(e){return s("van-tab",{key:e.name,attrs:{title:t.$t("signIn."+e.title),name:e.name}})})),1),t.signId?s("multi-qr-code",{ref:"qrCode",attrs:{"qr-type":t.basicInfo.qrcode_type,flag:"offline",transfer:!t.signInfo.open_transfer_student,"source-type":t.signInfo.source_type,query:"clockTimeId="+t.signId+"&signStyle="+t.activeTab}}):t._e(),s("div",{staticClass:"sign-content"},[s("div",{staticClass:"sign-content-box"},[t.signInfo.course_name?s("div",{staticClass:"content-text"},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("signIn.signCourse"))+"：")]),s("div",{staticClass:"content"},[t._v(t._s(t.signInfo.course_name))])]):t._e(),t.signInfo.exist_sign_in_config&&"sign_in"===t.activeTab?s("div",{staticClass:"content-text"},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("signIn.signInTime"))+"：")]),s("div",{staticClass:"content"},[t._v(t._s(t.setFormattingTime(Number(new Date(t.signInfo.sign_in_begin_time)),Number(new Date(t.signInfo.sign_in_end_time)))))])]):t._e(),t.signInfo.exist_sign_out_config&&"sign_out"===t.activeTab?s("div",{staticClass:"content-text"},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("signIn.signOutTime"))+"：")]),s("div",{staticClass:"content"},[t._v(t._s(t.setFormattingTime(Number(new Date(t.signInfo.sign_out_begin_time)),Number(new Date(t.signInfo.sign_out_end_time)))))])]):t._e(),t.signInfo.address||t.signInfo.address_detail?s("div",{staticClass:"content-text"},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("signIn.address"))+"：")]),s("div",{staticClass:"content"},[t._v(t._s(""+t.signInfo.address+t.signInfo.address_detail))])]):t._e(),t.signInfo.address||t.signInfo.address_detail?s("div",{staticClass:"content-text"},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("signIn.attendancemethod"))+"：")]),s("div",{staticClass:"content"},[t._v(t._s(t.$t("signIn.attendancemethodTip",{meter:t.signInfo.sign_range})))])]):t._e()])]),"statics"===t.basicInfo.qrcode_type?s("van-button",{staticClass:"sign-qrcode-btn",attrs:{color:t.primaryColor},on:{click:function(e){return e.stopPropagation(),t.saveQrcodePoster.apply(null,arguments)}}},[t._v(t._s(t.$t("signIn.saveCodePoster")))]):t._e()],1)}),[],!1,null,"2d687634",null).exports},82689:(t,e,s)=>{s.r(e),s.d(e,{default:()=>b});s(71322);var a=s(85471),i=(s(18144),s(65641)),o=(s(70885),s(6458)),r=(s(65069),s(57658),s(27632)),n=s(78551),c=(s(23307),s(81392)),l=(s(25773),s(35791)),u={name:"HeaderBox",components:{[l.Z.name]:l.Z,[c.Z.name]:c.Z},props:{postInfo:{type:String,default:"--"},buttonVisibile:{type:Boolean,default:!1},rankCurrent:{type:Object,default:()=>({})},modeType:{type:String,default:""}},data:()=>({show:!1}),computed:{mapPostInfo(){return this.postInfo}},methods:{changeVisibile(){this.$emit("post-picker")},toplan(){this.$emit("toPostStudyPlan")}}},d=s(1001),h=(0,d.Z)(u,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:["climb"!==t.modeType?"header-box":"header-box header-box-climb"]},[s("div",{staticClass:"flex align-center"},[s("div",{staticClass:"header-box-title"},[t._v(t._s(t.mapPostInfo))]),t.buttonVisibile?s("div",{staticClass:"header-box-title-desc flex align-center",on:{click:t.changeVisibile}},[t._v(t._s(t.$t("personnelDevelope.postChange"))),s("van-icon",{attrs:{name:"arrow"}})],1):t._e()]),"climb"!==t.modeType?[s("div",{staticClass:"header-box-text"},[s("span",[t._v(t._s(t.$t("personnelDevelope.rank"))+"："+t._s(t.rankCurrent.rank_name||"--"))])]),s("div",{staticClass:"header-box-button",on:{click:t.toplan}},[t._v(t._s(t.$t("personnelDevelope.openStudyPlan")))]),s("img",{staticClass:"header-box-bg",attrs:{src:"https://oss.coolcollege.cn/1810342596279668736.png"}})]:t._e()],2)}),[],!1,null,"90146b94",null).exports,p=s(19024),m=s(17452),g={components:{SvgIcon:n.Z},props:{detail:{type:Object,default:null},index:{type:Number,default:null},type:{type:String,default:""},postPassageInfo:{type:Object,default:()=>{}}},data:()=>({colors:{SUF_POST:"#F3CDAB",CURRENT_POST:"#BAC6FC",PRE_POST:"#AAEDE3"},defaultIcon:[{itemType:"SUF_POST",color:"#f3cdab",icon:"icon-jinshenggangwei"},{itemType:"CURRENT_POST",color:"#bac0fc",icon:"icon-dangqiangangwei"},{itemType:"PRE_POST",color:"#AAEDE3",icon:"icon-qianxugangwei"}],climbIcon:[{itemType:"SUF_POST",color:"#F3CDAB",icon:"icon-chengsequan"},{itemType:"CURRENT_POST",color:"#526BE7",icon:"icon-a-duihao1x"},{itemType:"PRE_POST",color:"#ECECEC",icon:"icon-huiquan"}]}),computed:{setClass(){let t=["box"],e=this.detail.passage_nodes[0].post_sequence_type;return"CURRENT_POST"===e?t.push("current"):"SUF_POST"===e?t.push("suf-post"):"PRE_POST"===e&&t.push("pre-post"),"climb"===this.type&&t.push("climb"),t.join(" ")},borderColor(){return this.props.borderColor?this.props.borderColor:""},mapDetail(){return this.detail},iconType(){let t="";const e=this.detail.passage_nodes[0].post_sequence_type;let s="climb"===this.type?this.climbIcon:this.defaultIcon;return"SUF_POST"===e&&(t=s[0]),"CURRENT_POST"===e&&(t=s[1]),"PRE_POST"===e&&(t=s[2]),t}},created(){this.detail.passage_nodes[0].current_post&&this.$emit("rankCurrentCB",this.index)},beforeUpdate(){this.detail.passage_nodes[0].current_post&&this.$emit("rankCurrentCB",this.index)},mounted(){this.getCurrentPostTopDis()},methods:{targetProjectDetail(t){const{all_checked:e,courseIds:s}=this.$route.query;let a=`/project-detail?studyId=${t[0].id}`;switch(t[0].style_type){case"normal":this.$router.push(a);break;case"star":(0,m.L)({path:`/project-sky/${t.id}/${t.task_id}/${e}/${s}`},"app1");break;case"desert":(0,m.L)({path:`/project-desert/${t.id}/${t.task_id}/${e}/${s}`},"app1")}},gotoProjectDetail(t){const{postIntroductionList:e}=p.Z;e({rank_id:t.rank_id,passage_id:this.postPassageInfo.post_passage_id,post_ids:t.passage_nodes.map((t=>t.post_id))}).then((t=>{if(0===t.data.code&&t.data.data){let e=t.data.data[0].Post_study_project_details;0===e.length?this.$toast.fail({message:this.$t("personnelDevelope.noStudyPlan"),duration:1500}):this.targetProjectDetail(e)}}))},gotoLearn(){this.$emit("targetClick",{detail:this.detail,type:"learnStudy"})},getCurrentPostTopDis(){this.detail.passage_nodes[0].current_post&&this.$emit("getCurrentPostTopDis",this.$refs.channelItem.getBoundingClientRect().top)},target(){this.$emit("targetClick",{detail:this.detail})}}},v=(0,d.Z)(g,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"channelItem",class:t.setClass},[s("div",{staticClass:"box-content",style:{borderColor:t.iconType.color},on:{click:t.gotoLearn}},[s("div",{staticClass:"box-content-title van-ellipsis"},[s("p",{class:[t.detail.passage_nodes.length>1?"post-name post-double":"post-name"]},[t._v(t._s(t.detail.passage_nodes[0].post_name))]),t.detail.passage_nodes.length>1?s("span",{on:{click:function(e){return e.stopPropagation(),t.target.apply(null,arguments)}}},[s("strong",[t._v(t._s(t.$t("personnelDevelope.posts")))]),s("SvgIcon",{attrs:{"icon-class":"icon-arrow-r1",size:"5",color:"#fff"}})],1):t._e()]),s("div",{class:[t.detail.passage_nodes[0].current_post?"box-content-desc current":"box-content-desc"]},[s("span",[t._v(t._s(t.$t("personnelDevelope.rankBelong"))+"："+t._s(t.detail.rank_name))]),t.detail.passage_nodes[0].current_post&&"climb"===t.type?s("span",{on:{click:function(e){return e.stopPropagation(),t.gotoProjectDetail(t.detail)}}},[t._v(t._s(t.$t("personnelDevelope.gotoLean"))+" "),s("SvgIcon",{attrs:{"icon-class":"icon-arrow-r1",size:"12",color:"#C4CFF9"}})],1):t._e()]),t.detail.passage_nodes[0].current_post?s("div",{staticClass:"box-content-current"},[t._v(t._s(t.$t("personnelDevelope.current_post")))]):t._e()]),s("span",{class:["climb"===t.type?"svg-icon-box climb":"svg-icon-box"]},[0===t.index&&"climb"!==t.type?s("img",{attrs:{src:"https://oss.coolcollege.cn/1810342786118062080.png"}}):t._e(),t._v(" "),0!==t.index||"climb"===t.type?s("SvgIcon",{attrs:{"icon-class":t.iconType.icon,size:18,color:t.iconType.color}}):t._e()],1)])}),[],!1,null,"3c958b0e",null).exports,f=(s(31930),s(94907)),y={components:{[f.Z.name]:f.Z},props:{list:{type:Array,default:()=>[]},title:{type:String,default:""},desc:{type:String,default:""}},data:()=>({show:!0}),methods:{close(){this.show=!1},confirm(t,e){this.$emit("callback",t,e)}}},_=(0,d.Z)(y,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("van-overlay",{staticStyle:{"background-color":"rgba(0,0,0,.3)"},attrs:{"z-index":"3","lock-scroll":!1,show:t.show}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"wrapper",on:{click:function(e){return t.confirm()}}},[s("div",{staticClass:"block",on:{click:function(t){t.stopPropagation()}}},[s("div",[s("div",{staticClass:"block-title"},[t._v(t._s(t.title))]),t.desc?s("div",{staticClass:"block-desc"},[t._v(t._s(t.desc))]):t._e()]),s("div",{staticClass:"block-list"},t._l(t.list,(function(e,a){return s("div",{key:a.toString(),staticClass:"block-list-item",on:{click:function(s){return t.confirm(e,a)}}},[t._v(t._s(e.name))])})),0)])])])}),[],!1,null,"dc5d6f68",null).exports,C=s(22648),I={name:"PostChanel",components:{HeaderBox:h,[o.Z.name]:o.Z,[i.Z.name]:i.Z,[a.Z.name]:a.Z,SvgIcon:n.Z,PostChannelItem:v,PupopPicker:_},data(){return{postVisibile:!0,show:!1,showPopover:!1,postList:[],postActive:0,postPickerVisibile:!1,popupPostList:[],channelList:[],channelActive:0,channelVisibile:!0,channelPickerVisibile:!1,popupChannelList:[],passageNodeList:[],passageNodeVisibile:!1,parentItem:{},noData:!1,rank_id:"",rank_current:{},postStudyPlan:{},system:(0,C.Os)(),postChannelHeight:0,currentPostDis:0,modeType:"",legendDefaultData:[{color:"#F3CDAB",icon:"icon-jinshenggangwei"},{color:"#BAC6FC",icon:"icon-dangqiangangwei"},{color:"#AAEDE3",icon:"icon-qianxugangwei"}],legendClimbData:[{color:"#F3CDAB",icon:"icon-chengsequan"},{color:"#526BE7",icon:"icon-a-duihao1x"},{color:"#ECECEC",icon:"icon-huiquan"}],legendName:[this.$t("personnelDevelope.suf_post"),this.$t("personnelDevelope.current_post"),this.$t("personnelDevelope.pre_post")],legendData:[]}},computed:{themeColor(){return this.$store.state.themeColor}},created(){this.getPost()},mounted(){document.title=this.$t("pageTitle.development"),this.env=r.Z.env,this.getPostPlanSet()},methods:{getPostPlanSet(){const{getConfigList:t}=p.Z;t().then((t=>{t.data.data.forEach((t=>{"app_mode"===t.keyword&&(this.modeType="1"===t.context?"":"climb",this.legendData="climb"===this.modeType?this.legendClimbData:this.legendDefaultData)}))})).catch((()=>{}))},getCurrentPostTopDis(t){this.currentPostDis=t},getAbilityModel(){const t=this.postList[this.postActive].post_id;p.Z.getAbilityModel(t).then((t=>{this.postStudyPlan=t.data.data})).catch((()=>{}))},getPost(){p.Z.getPostAisleClassifyList().then((t=>{t.data.data&&t.data.data.length>0?(this.postList=t.data.data||[],this.popupPostList=this.postList.map((t=>({name:t.post_name}))),this.getChannel(t.data.data[0]),this.getAbilityModel(t.data.data[0].post_id),this.postVisibile=!0):(this.postVisibile=!1,this.errorMsg=this.$t("personnelDevelope.postNo"),this.$toast(this.$t("personnelDevelope.postNo")))}))},getChannel({post_name:t,post_id:e}){p.Z.getChannelList({post_name:t,post_id:e}).then((t=>{this.channelList=t.data.data,this.popupChannelList=this.channelList.map((t=>(t.ranks=t.ranks.reverse(),{name:t.post_passage_name}))),this.channelActive=0,""===t.data.data[0].post_passage_name?(this.channelVisibile=!1,this.errorMsg=this.$t("personnelDevelope.postNoChannel")):this.channelVisibile=!0,this.$nextTick((()=>{let t=this.$refs.postChannel.clientHeight/2;this.$refs.postChannelBox.scrollTop=this.currentPostDis-t}))})).catch((()=>{}))},postPicker(){1!==this.postList.length&&(this.postPickerVisibile=!0)},confirmPost(t){this.postActive=t,this.postPickerVisibile=!1,this.getAbilityModel(this.postList[t].post_id),this.getChannel(this.postList[t].post_name)},cancelPost(){this.postPickerVisibile=!1},confirmChannel(t){this.channelActive=t,this.channelPickerVisibile=!1},cancelChannel(){this.channelPickerVisibile=!1},setchannelPickerVisibile(){this.channelList.length>1&&(this.channelPickerVisibile=!0)},postsCallback(t,e){this.postPickerVisibile=!1,t&&(this.postActive=e,this.getChannel(this.postList[e]),this.getAbilityModel(this.postList[e].post_id),this.rank_id="",this.rank_current={})},channelCallback(t,e){this.channelPickerVisibile=!1,t&&(this.channelActive=e)},rankCallback({detail:t,type:e}){if(this.parentItem=t,t.passage_nodes.length>1)"learnStudy"===e?this.passageNodeCallback(t.passage_nodes[0]):(this.passageNodeList=t.passage_nodes.map((t=>(t.name=t.post_name,t))),this.passageNodeVisibile=!0);else{const e=t.rank_id,s=t.passage_nodes[0].post_id;t.passage_nodes[0].project_assigned?(localStorage.postPlanTab&&(localStorage.postPlanTab="learn-conent"),"dingTalk"!==this.env&&"ios"===this.system?r.Z.navigateTo({url:`/pages/common-webview/index?type=postStudyPlan&postId=${s}&rankId=${e}`}):this.$router.push({path:"/post-study-plan",query:{postId:s,rankId:e}})):this.toastFalse()}},passageNodeCallback(t){this.passageNodeVisibile=!1;const{assigned:e,post_id:s}=t,{rank_id:a}=this.parentItem;e?(localStorage.postPlanTab&&(localStorage.postPlanTab="learn-conent"),"dingTalk"!==this.env&&"ios"===this.system?r.Z.navigateTo({url:`/pages/common-webview/index?type=postStudyPlan&postId=${s}&rankId=${a}`}):this.$router.push({path:"/post-study-plan",query:{postId:s,rankId:a}})):this.toastFalse()},toPostDetail(t){const{post_id:e}=this.postList[this.postActive];"responsibily"===t?this.$router.push(`/post-channel-detail?type=responsibily&postId=${e}&rankId=${this.rank_id}`):"requirement"===t&&this.$router.push(`/post-channel-detail?type=requirement&postId=${e}&rankId=${this.rank_id}`)},toPostStudyPlan(){const{post_id:t}=this.postList[this.postActive];let e=this.rank_id?this.rank_id:"";this.postStudyPlan.id&&0!==this.postStudyPlan.id?(localStorage.postPlanTab&&(localStorage.postPlanTab="learn-conent"),"dingTalk"!==this.env&&"ios"===this.system?r.Z.navigateTo({url:`/pages/common-webview/index?type=postStudyPlan&postId=${t}&rankId=${e}`}):this.$router.push({path:"/post-study-plan",query:{postId:t,rankId:e}})):this.toastFalse()},rankCurrentCallBack(t){this.rank_id=this.channelList[this.channelActive].ranks[t].rank_id,this.rank_current=this.channelList[this.channelActive].ranks[t]},toastFalse(){this.$toast(this.$t("personnelDevelope.postNoPlan"))}}},b=(0,d.Z)(I,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"postChannel",staticClass:"postChannel cl-page-container"},[t.postVisibile?s("div",{staticClass:"postChannel-container"},[s("div",[t.postList.length>0?s("HeaderBox",{attrs:{"rank-current":t.rank_current,"button-visibile":1!==t.postList.length,"post-info":t.postList[t.postActive].post_name,"mode-type":t.modeType},on:{toPostStudyPlan:t.toPostStudyPlan,"post-picker":t.postPicker}}):t._e(),s("div",{directives:[{name:"show",rawName:"v-show",value:t.channelVisibile&&t.channelList.length>0,expression:"channelVisibile && channelList.length > 0"}],staticClass:"postChannel-channel"},[s("div",{staticClass:"postChannel-channel-left",on:{click:function(e){return t.setchannelPickerVisibile()}}},[s("span",{staticClass:"svg-icon-box"},[s("SvgIcon",{attrs:{"icon-class":"icon-tongdaomingcheng",color:"#999999 ",size:14}})],1),s("div",{staticClass:"margin-xs postChannel-channel-left-select"},[t.channelList.length>0?s("span",[t._v(" "+t._s(t.channelList[t.channelActive].post_passage_name)+" ")]):t._e()]),t.channelList.length>1?s("SvgIcon",{attrs:{"icon-class":"icon-sanjiao",size:8}}):t._e()],1),s("div",{staticClass:"postChannel-channel-right"},[s("van-popover",{attrs:{trigger:"click",placement:"bottom-end"},scopedSlots:t._u([{key:"reference",fn:function(){return[s("span",{staticClass:"svg-icon-box"},[s("SvgIcon",{attrs:{"icon-class":"icon-tips",size:16}})],1),s("span",{staticClass:"margin-xs"},[t._v(t._s(t.$t("personnelDevelope.legend")))])]},proxy:!0}],null,!1,1035730138),model:{value:t.showPopover,callback:function(e){t.showPopover=e},expression:"showPopover"}},[s("ul",{staticClass:"postChannel-popover"},t._l(t.legendData,(function(e,a){return s("li",{key:a},[s("SvgIcon",{attrs:{"icon-class":e.icon,color:e.color,size:14}}),s("span",[t._v(t._s(t.legendName[a]))])],1)})),0)])],1)])],1),s("div",{staticClass:"postChannel-list"},[t.channelVisibile&&t.channelList.length>0?s("div",{ref:"postChannelBox",staticClass:"postChannel-list-box"},t._l(t.channelList[t.channelActive].ranks,(function(e,a){return s("div",{key:e.rank_id},[s("PostChannelItem",{ref:"channelItem",refInFor:!0,attrs:{type:t.modeType,detail:e,index:a,"post-passage-info":t.channelList[t.channelActive]},on:{rankCurrentCB:t.rankCurrentCallBack,getCurrentPostTopDis:t.getCurrentPostTopDis,targetClick:t.rankCallback}})],1)})),0):t._e(),t.channelVisibile?t._e():s("div",{staticClass:"postChannel-list-noData"},[s("img",{attrs:{src:"https://oss.coolcollege.cn/1810343865006297088.png"}}),s("p",[t._v(t._s(t.errorMsg))])])]),s("transition",{attrs:{name:"van-fade"}},[t.postPickerVisibile?s("PupopPicker",{attrs:{title:t.$t("personnelDevelope.postChange"),list:t.popupPostList},on:{callback:t.postsCallback}}):t._e(),t.channelPickerVisibile?s("PupopPicker",{attrs:{title:t.$t("personnelDevelope.seletorChanne"),list:t.popupChannelList},on:{callback:t.channelCallback}}):t._e(),t.passageNodeVisibile?s("PupopPicker",{attrs:{title:t.$t("personnelDevelope.choosePost"),desc:t.$t("personnelDevelope.nodeExplain"),list:t.passageNodeList},on:{callback:t.passageNodeCallback}}):t._e()],1)],1):t._e(),t.postVisibile?t._e():s("div",{staticClass:"postChannel-list-noData"},[s("img",{attrs:{src:"https://oss.coolcollege.cn/1810343865006297088.png"}}),s("p",[t._v(t._s(t.errorMsg))])])])}),[],!1,null,"5be522df",null).exports},23182:(t,e,s)=>{s.r(e),s.d(e,{default:()=>l});var a=s(95082),i=(s(82522),s(10342)),o=(s(82500),s(49414)),r=s(19024),n=s(22648),c={components:{[o.Z.name]:o.Z,[i.Z.name]:i.Z},data(){return{content:"",errorMsg:"",visible:!1,jobRequirements:"",jobResponsibilities:"",type:"responsibily",tabData:[{title:this.$t("personnelDevelope.jobResponsibilities"),content:"",errorMsg:""},{title:this.$t("personnelDevelope.jobRequirements"),content:"",errorMsg:""}]}},computed:{themeColor(){return this.$store.state.themeColor}},mounted(){const{type:t}=this.$route.query,e="requirement"===t?this.$t("pageTitle.jobRequirements"):this.$t("pageTitle.jobResponsibilities");(0,n.Td)(e),this.getData()},methods:{getData(){const{postId:t,type:e,rankId:s}=this.$route.query;r.Z.getAbilityModelDetail(t,s).then((t=>{const{post_description:e,qualification_description:s}=t.data.data;let i=this.tabData.map(((t,i)=>(0,a.Z)((0,a.Z)({},t),{},{content:0===i?e:s,errorMsg:0===i?this.$t("personnelDevelope.jobResponsibilities"):this.$t("personnelDevelope.jobRequirements")})));this.tabData=i})).catch((()=>{this.visible=!0,this.errorMsg="responsibily"===e?this.$t("personnelDevelope.jobResponsibilities"):this.$t("personnelDevelope.jobRequirements")}))}}},l=(0,s(1001).Z)(c,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"desc-text cl-page-container"},[s("van-tabs",{attrs:{color:t.themeColor.primaryColor},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},t._l(t.tabData,(function(e,a){return s("van-tab",{key:a,attrs:{title:e.title}},[e.content?s("div",{staticClass:"responsibily-tab-content",domProps:{innerHTML:t.xss(t._s(e.content))}}):s("div",{staticClass:"noData"},[s("img",{attrs:{src:"https://oss.coolcollege.cn/1810343865006297088.png"}}),s("p",[t._v(t._s(t.$t("personnelDevelope.noData"))+t._s(e.errorMsg))])])])})),1)],1)}),[],!1,null,"5242dddf",null).exports},68862:(t,e,s)=>{s.r(e),s.d(e,{default:()=>u});var a=s(95082),i=(s(21790),s(24031)),o={components:{[i.Z.name]:i.Z},props:{showLable:{type:Boolean,default:!0},lableStyle:{type:String,default:""},titleStyle:{type:Object,default:()=>{}},abilityInfo:{type:Object,default:()=>{}},source:{type:String,default:""},level:{type:String,default:""},type:{type:String,default:""},name:{type:String,default:""}},computed:{abilityType(){return"common"===this.abilityInfo.ability_type?this.$t("personnelDevelope.generalCapability"):this.$t("personnelDevelope.professionalAbility")}}},r=s(1001),n=(0,r.Z)(o,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"ability-detail-item"},[s("div",{staticClass:"title"},[s("h3",{staticClass:"van-ellipsis"},[t._v(t._s(t.abilityInfo.ability_name))]),""===t.lableStyle?s("van-tag",{attrs:{type:"primary"}},[t._v(t._s(t.abilityType))]):t._e()],1),s("span",{staticClass:"desc"},[t._v(t._s(t.abilityInfo.ability_desc))])]),t._l(t.abilityInfo.ability_desc_list,(function(e,a){return s("div",{key:a,staticClass:"ability-detail-item"},[s("div",{staticClass:"title"},[s("h3",[t._v(t._s(e.level_name)+"("+t._s(e.ability_level)+")")]),e.qualification_level?s("van-tag",{attrs:{type:"primary",plain:""}},[t._v(t._s(t.$t("personnelDevelope.qualificationRequire")))]):t._e()],1),s("span",{staticClass:"desc"},[s("strong",[t._v(t._s(t.$t("personnelDevelope.behaviorDesc"))+"：")]),t._v(t._s(e.ability_behavior_desc))]),s("span",{staticClass:"desc"},[s("strong",[t._v(t._s(t.$t("personnelDevelope.levelDesc"))+"：")]),t._v(t._s(e.ability_desc))])])}))],2)}),[],!1,null,"1716d03b",null).exports,c=s(26294),l={components:{Abilitycard:n,SvgIcon:s(78551).Z},data:()=>({plain:"plain",currentPage:1}),computed:(0,a.Z)({},(0,c.mapState)("personnelDevelopment",["abilityInfo"])),mounted(){document.title=this.$t("pageTitle.abilityDetail"),this.currentPage=this.abilityInfo.index},methods:{nextPage(){this.currentPage++,this.currentPage===this.abilityInfo.data.length&&(this.currentPage=0)},prevPage(){this.currentPage--,this.currentPage<0&&(this.currentPage=this.abilityInfo.data.length-1)}}},u=(0,r.Z)(l,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ability-detail"},[s("Abilitycard",{attrs:{"show-lable":!0,"label-style":"plain","ability-info":t.abilityInfo.data[t.currentPage]}}),s("div",{staticClass:"post-pagination-wapper"},[s("div",{staticClass:"post-pagination-prev post-pagination-toggle",on:{click:t.prevPage}},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-arrow-l1",color:"#7F849A",size:12}}),s("span",[t._v(t._s(t.$t("personnelDevelope.previousPage")))])],1),s("div",{staticClass:"post-pagination-next post-pagination-toggle",on:{click:t.nextPage}},[s("span",[t._v(t._s(t.$t("personnelDevelope.nextPage")))]),s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-arrow-r1",color:"#7F849A",size:12}})],1)])],1)}),[],!1,null,"1d653b62",null).exports},52837:(t,e,s)=>{s.r(e),s.d(e,{default:()=>f});s(34837);var a=s(39146),i=s(19024),o=(s(30033),s(87837)),r=(s(74916),s(15306),s(57658),s(33948),s(70492)),n=s.n(r),c=(s(48927),s(78511),s(22648)),l={name:"Radar",components:{[o.Z.name]:o.Z},filters:{formatDate:function(t){return(0,c.p6)(t,"yyyy-MM-dd  hh:mm")}},props:{reportInfo:{type:Object,required:!0,default:()=>({})}},data(){return{self:!0,other:!0,option:{legend:{data:[this.$t("evaluation.jobRequirements"),this.$t("evaluation.assessment")],bottom:0,icon:"circle"},radar:{shape:"circle",splitArea:{show:!0,areaStyle:{color:["#fafafa"]}},name:{textStyle:{color:"#2D3040"},formatter:t=>t.length>11?`${(t=t.slice(0,11)).replace(/\S{6}/g,(t=>`${t}\n`))}...`:t.replace(/\S{6}/g,(t=>`${t}\n`))},radius:70,indicator:[]},series:[{type:"radar",data:[]}]},seriesData:[],showList:[]}},mounted(){const t=document.getElementById("radar"),e=n().init(t);this.reportInfo.list.length>10?this.showList=this.reportInfo.list.slice(0,10):this.showList=this.reportInfo.list;const s=this.showList.map((t=>({name:t.abilityName,max:5})));let a=[],i=[];this.showList.forEach((t=>{t.abilityLevel&&a.push(t.abilityLevelScore),t.levelScore&&i.push(t.levelScore)})),this.seriesData=[{name:this.$t("evaluation.jobRequirements"),value:a},{name:this.$t("evaluation.assessment"),value:i}].filter((t=>t.value.length>0)),this.option.series[0].data=[...this.seriesData],this.option.radar.indicator=s,e.setOption(this.option)}},u=s(1001),d=(0,u.Z)(l,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"report-top-container"},[s("div",{staticClass:"title"},[t._v(" "+t._s(t.reportInfo.title||t.$t("evaluation.evaluationReports"))+" ")]),s("div",{staticClass:"user-name"},[t._v(t._s(t.$t("evaluation.evaluatedPerson"))+"："+t._s(t.reportInfo.user_name))]),s("div",{staticClass:"report-time"},[t._v(t._s(t.$t("evaluation.reportTime"))+"："+t._s(t._f("formatDate")(t.reportInfo.report_time)))]),t._m(0)])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"radar-container"},[e("div",{attrs:{id:"radar"}})])}],!1,null,"8b865884",null).exports,h=s(24004),p={name:"AbilityScoreList",props:{reportInfo:{type:Object,required:!0,default:()=>({})}},methods:{postScroe:t=>t.levelName&&"--"!==t.levelName?`${t.levelName}(${t.abilityLevel})`:"--",finalScroe:t=>t.levelScoreName&&"--"!==t.levelScoreName?`${t.levelScoreName}(${t.levelId})`:"--"}},m=(0,u.Z)(p,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ability-score-container"},[s("div",{staticClass:"table-head"},[s("div",{staticClass:"head-item"},[t._v(t._s(t.$t("evaluation.abilityOptionName")))])]),s("div",{staticClass:"table-header"},[s("div",{staticClass:"item"},[t._v(t._s(t.$t("pageTitle.capabilityItem")))]),s("div",{staticClass:"item"},[t._v(t._s(t.$t("evaluation.jobRequirements")))]),s("div",{staticClass:"item"},[t._v(t._s(t.$t("evaluation.assessment")))])]),t.reportInfo.list.length>0?s("div",t._l(t.reportInfo.list,(function(e){return s("div",{key:e.ability_id,staticClass:"table-body"},[s("div",{staticClass:"power-body-top van-hairline--bottom"},[s("div",{staticClass:"item van-multi-ellipsis--l2"},[t._v(t._s(e.abilityName))]),s("div",{staticClass:"item"},[t._v(t._s(t.postScroe(e)))]),s("div",{staticClass:"item"},[t._v(t._s(t.finalScroe(e)))])])])})),0):t._e()])}),[],!1,null,"86fc47b4",null).exports,g=s(38174),v={name:"EvaluationTool",components:{Radar:d,RadarPlan:h.Z,AbilityScoreList:m,AbilityScoreListPlan:g.Z,[a.Z.name]:a.Z},data(){return{evaluationReportUrl:"",reportType:this.$route.query.source,reportInfo:{list:[]}}},computed:{userInfo(){return this.$store.state.commonParams}},created(){a.Z.loading({duration:0,forbidClick:!0,message:this.$t("common.loading")}),this.getHistoricalEvaDetails()},methods:{getHistoricalEvaDetails(){const{post_id:t,plan_id:e,source:s}=this.$route.query;"import"===s?i.Z.getHistoricalEvaDetails({post_id:t,plan_id:e}).then((t=>{this.reportInfo={list:t.data.data.EvaDetails,user_name:t.data.data.userName,report_time:t.data.data.reportTime}})):i.Z.getEvaluationReportModel({plan_id:e}).then((t=>{this.reportInfo=t.data})),a.Z.clear()}}},f=(0,u.Z)(v,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"evaluation-report-container"},[s("div",{staticClass:"model-report"},[t.reportInfo.list.length>0?s("div",{staticClass:"radar-content"},["import"===t.reportType?s("radar",{attrs:{"report-info":t.reportInfo}}):s("RadarPlan",{attrs:{"report-info":t.reportInfo}})],1):t._e(),t.reportInfo.list.length>0?s("div",{staticClass:"list-content"},["import"===t.reportType?s("ability-score-list",{attrs:{"report-info":t.reportInfo}}):s("ability-score-list-plan",{attrs:{"report-info":t.reportInfo}})],1):t._e()])])}),[],!1,null,"81cc9ce8",null).exports},98194:(t,e,s)=>{s.r(e),s.d(e,{default:()=>c});s(70885);var a=s(6458),i=(s(18144),s(65641)),o=(s(57658),s(19024)),r=s(22648),n={components:{[i.Z.name]:i.Z,[a.Z.name]:a.Z},filters:{formatDate:function(t){return(0,r.p6)(t,"yyyy-MM-dd")}},data:()=>({historyEvaluationList:[]}),created(){this.getHistoricalEva()},methods:{getHistoricalEva(){const{post_id:t}=this.$route.query;o.Z.getHistoricalEva({post_id:t}).then((t=>{this.historyEvaluationList=t.data.data}))},toDetail(t){const{post_id:e}=this.$route.query;this.$router.push({path:`/history-evalution-detail?post_id=${e}&plan_id=${t.planId}&source=${t.source}`})}}},c=(0,s(1001).Z)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container cl-page-container"},[s("div",{staticClass:"header item"},[s("div",{staticClass:"item1"},[t._v(t._s(t.$t("training.type")))]),s("div",{staticClass:"item2"},[t._v(t._s(t.$t("personnelDevelope.capability")))]),s("div",{staticClass:"item3"},[t._v(t._s(t.$t("personnelDevelope.evaluateTime")))]),s("div",{staticClass:"item4"},[t._v(t._s(t.$t("common.operate")))])]),t._l(t.historyEvaluationList,(function(e){return s("div",{key:e.planId,staticClass:"van-hairline--bottom item"},[s("div",{staticClass:"item1"},[t._v(t._s(e.type))]),s("div",{staticClass:"item2"},[t._v(t._s(e.abilityNum))]),s("div",{staticClass:"item3"},[t._v(t._s(t._f("formatDate")(e.createTime)))]),s("div",{staticClass:"item4",on:{click:function(s){return t.toDetail(e)}}},[t._v(t._s(t.$t("micro.view")))])])}))],2)}),[],!1,null,"023ef8f4",null).exports},93810:(t,e,s)=>{s.r(e),s.d(e,{default:()=>P});var a=s(95082),i=(s(31146),s(41610)),o=(s(28301),s(45644)),r=(s(3791),s(93432)),n=(s(34837),s(39146)),c=(s(47601),s(44951)),l=(s(47238),s(75167)),u=(s(25773),s(35791)),d=(s(82500),s(49414)),h=(s(82522),s(10342)),p=(s(74916),s(15306),s(57658),s(33948),s(94864)),m=s(71522),g=s(78551),v=s(70492),f=s.n(v),y=(s(48927),s(78511),s(14638)),_=s(19024),C=(s(70885),s(6458)),I=(s(18144),s(65641)),b=s(27632),w={components:{[c.Z.name]:c.Z,[I.Z.name]:I.Z,[C.Z.name]:C.Z,[u.Z.name]:u.Z,SvgIcon:g.Z},props:{postId:{type:String,default:""},themeColor:{type:String,default:""}},data:()=>({recommendData:[],isLoadMore:!0,page_num:""}),mounted(){this.getRecommendCourse()},methods:{getRecommendCourse(){const{getRecommendCourse:t}=_.Z;let e={post_id:this.postId};this.page_num&&(e.page_num=this.page_num),t(e).then((t=>{this.recommendData=t.data.data.list,this.isLoadMore=t.data.data.replaceable,this.page_num=t.data.data.page_num}))},changeBath(){this.isLoadMore?this.getRecommendCourse():this.$toast(this.$t("personnelDevelope.noRecommendCourse"))},gotoProjectDetail(t){let e=`/pages/courseModules/course/enterprise/detail/index?courseResource=enterprise&courseId=${t}&originType=corpCourse`;b.Z.navigateTo({url:e})}}},$=s(1001),k=(0,$.Z)(w,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return 0!==t.recommendData.length?s("div",{staticClass:"recommend-learn"},[s("h3",{staticClass:"recommend-title"},[t._v(t._s(t.$t("personnelDevelope.recommendCourse")))]),s("div",{staticClass:"recommend-item-content"},[s("div",[s("van-row",{attrs:{type:"flex",justify:"space-between"}},t._l(t.recommendData,(function(e,a){return s("van-col",{key:a,attrs:{span:"12"},on:{click:function(s){return t.gotoProjectDetail(e.id)}}},[s("div",{staticClass:"img-cover"},[s("van-image",{attrs:{src:e.cover,fit:"contain"}})],1),s("span",{staticClass:"recommend-name van-ellipsis"},[t._v(t._s(e.title))]),s("div",{staticClass:"scan-count-content"},[s("span",{staticClass:"scan-count"},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-xianshimima",color:"#D0D1D6",size:12}}),t._v(" "+t._s(e.playCount)+" ")],1),s("div",{staticClass:"count-star-content"},t._l(Object.keys(Array.from({length:5})),(function(a,i){return s("span",{key:i,staticClass:"count-star"},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-xing",color:e.score<(0==e.score?5:e.score)?t.themeColor:"#C0C2CB",size:9}})],1)})),0)]),t._v(" "+t._s(e.comment_count)+" ")])})),1)],1)]),s("van-button",{attrs:{type:"info",plain:"",block:!0,color:t.themeColor},on:{click:t.changeBath}},[t._v(" "+t._s(t.$t("personnelDevelope.changeBatch"))+" ")])],1):t._e()}),[],!1,null,"37097b0d",null).exports,S=s(26294),T=s(98512),Z=s(17452),x={name:"PostStudyPlan",components:{[h.Z.name]:h.Z,[d.Z.name]:d.Z,[u.Z.name]:u.Z,[l.Z.name]:l.Z,[c.Z.name]:c.Z,[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,SvgIcon:g.Z,RecommedCourse:k,CoolVideo:y.Z},data(){return{data:[{key:"learn-conent",name:this.$t("personnelDevelope.learningContent")}],postDetails:"",projectInfo:"",showVisible:!1,videoHeight:211,option:{color:["#5291FF","#FF724E","#2FC25B"],legend:{data:[this.$t("personnelDevelope.postStandard"),this.$t("personnelDevelope.importResults"),this.$t("personnelDevelope.taskResults")],bottom:0,icon:"circle"},radar:{shape:"circle",splitArea:{show:!0,areaStyle:{color:["#fafafa"]}},name:{textStyle:{color:"#2D3040"},formatter:t=>t.length>11?`${(t=t.slice(0,11)).replace(/\S{6}/g,(t=>`${t}\n`))}...`:t.replace(/\S{6}/g,(t=>`${t}\n`))},radius:70,indicator:[]},series:[{type:"radar",data:[]}]},seriesData:[],evaluationInfo:[],initActiveTab:"",isShow:!0,newPostId:"",newRankId:"",projectId:"",isShowDialog:!1,historyEvaluationList:[],player:null}},computed:(0,a.Z)({renderRankName(){return this.postDetails.rank_name?this.postDetails.rank_name:"--"},getCurrentLevel(){return(t,e,s)=>{const{evaluationInfo:a}=this;if(0===a.length)return!1;let i="";return"import"===t?i="ability_level_standards_import":"task"===t&&(i="ability_level_standards_task"),a.post_eva_result[e][i][s].ability_level}},themeColor(){return this.$store.state.themeColor},renderStartBtn(){const{projectInfo:t}=this;let e="";return 0===t.process?e=this.$t("project.startStudy"):t.process<100&&t.process>0?e=this.$t("project.continueStudy"):100===t.process&&(e=this.$t("project.againStudy")),e}},(0,S.mapGetters)({fresh:"microCourse/getFreshStatus"})),watch:{fresh(t){t&&(this.getInitData(),this.$store.commit("microCourse/updateFresh",!1))}},mounted(){this.getInitData()},methods:{async onPlayerError(){const{getLocalDocAuth:t}=m.Z;let{url:e}=this.postDetails.video_introduction,s=(0,T.dL)(e);const{playId:a,storage_type:i}=s,o=this.player.currentTime();if("LOCAL"===i){let s=e.indexOf("expire_time")>-1?e.split("&")[1].split("=")[1]:"";if(!s||Number(s)>(new Date).getTime())return void this.$toast.fail(this.$t("course.playTips"));const{data:i}=await t(a);0===i.code&&(this.postDetails.video_introduction.url=`${e}&auth_key=${i.data.auth_key}`)}else if("ALIBABA_PRIVATE"===i){if(!a)return;const{data:t}=await p.Z.privateVodDownloadUrl({videoId:a});0===t.code&&(this.postDetails.video_introduction.url=t.data.videoPlayInfo)}this.player.currentTime(Number(o)),this.player.play()},confirmDialog(){this.showVisible=!1,setTimeout((()=>{this.isShowDialog=!1}),500)},async showVideo(){const{privateVodDownloadUrl:t}=p.Z,{getLocalDocAuth:e}=m.Z;this.isShowDialog=!0;let s=(0,T.dL)(this.postDetails.video_introduction.url),a=this.postDetails.video_introduction.url.split("?")[0];const{playId:i,storage_type:o}=s;let r=this.postDetails.video_introduction.url;if("ALIBABA_PRIVATE"===o){const{data:e}=await t({videoId:i});0===e.code&&(r=e.data.videoPlayInfo)}else if("LOCAL"===o){const{data:t}=await e(i);0===t.code&&(r=`${a}&auth_key=${t.data.auth_key}`)}this.postDetails.video_introduction.url=r,this.showVisible=!0,this.$nextTick((()=>{this.$refs.video&&(this.player=this.$refs.video.getPlayer())}))},gotoDetail(){this.$router.push({path:"/post-channel-detail",query:{postId:this.newPostId,rankId:this.newRankId}})},getScore(t){return t.map((t=>{if("tool"===t.ability_source){return this.changeAbilityLevel(t.ability_level)}return t.ability_level}))},gotoProjectDetail(){const{projectInfo:t}=this,{all_checked:e,courseIds:s}=this.$route.query;let a="";switch(t.style_type){case"normal":a=`/project-detail?studyId=${t.id}`;break;case"star":a=`/project-sky/${t.id}/${t.task_id}/${e}/${s}`;break;case"desert":a=`/project-desert/${t.id}/${t.task_id}/${e}/${s}`}(0,Z.L)({path:a},"star"===t.style_type||"desert"===t.style_type?"app1":"")},toPromotionSuggestions(){this.$store.dispatch("personnelDevelopment/saveInfoAction",this.evaluationInfo.improve_suggest),this.$router.push({path:"/post-common-detail"})},changeAbility(t){this.$nextTick((()=>{this.setEchars(t)}))},getInitData(){const{postId:t,rankId:e}=this.$route.query,{getAbilityModelDetail:s}=_.Z;t instanceof Array&&e instanceof Array?(this.newPostId=t[0],this.newRankId=e[0]):(this.newPostId=t,this.newRankId=e),this.getHistoricalEva(),this.$nextTick((()=>{s(this.newPostId,this.newRankId).then((t=>{this.postDetails=t.data.data;const e=t.data.data.project_ids.join(",");this.projectId=e,""===e&&(this.data=[],localStorage.postPlanTab="qualification",this.initActiveTab="qualification"),this.postDetails.qualification_id&&this.data.length<2&&this.data.push({key:"qualification",name:this.$t("personnelDevelope.qualification")}),""!==e?this.getStudyProjectsInfos(e):""===e&&this.getEvaluationResultFun()}))}))},getHistoricalEva(){const{postId:t}=this.$route.query;_.Z.getHistoricalEva({post_id:t}).then((t=>{this.historyEvaluationList=t.data.data}))},getEvaluationResultFun(){const{getEvaluationResult:t}=_.Z;t(this.newPostId).then((t=>{t.data.data&&(this.evaluationInfo=t.data.data),this.isShow=!1,"qualification"===localStorage.postPlanTab?(this.initActiveTab="qualification",this.$nextTick((()=>{this.setEchars(0)}))):this.initActiveTab="learn-conent"}))},getStudyProjectsInfos(t){const{getStudyProjectsInfo:e}=_.Z;e(t).then((t=>{t.data.data.length>0&&(this.projectInfo=t.data.data[0]),this.getEvaluationResultFun()}))},gotoTaskCertificate(t){"task"!==t||this.postDetails.task_size&&"0"!==this.postDetails.task_size?"certificate"!==t||this.postDetails.certificate_size&&"0"!==this.postDetails.certificate_size?"contribute"!==t||this.postDetails.contribute_size&&"0"!==this.postDetails.contribute_size?this.$router.push({path:"/post-task",query:{type:t,qualification_id:this.postDetails.qualification_id}}):(0,n.Z)(this.$t("personnelDevelope.noContribute")):(0,n.Z)(this.$t("personnelDevelope.noCertificate")):(0,n.Z)(this.$t("personnelDevelope.noKeyTasks"))},changeTab(t){"qualification"===t&&this.$nextTick((()=>{this.setEchars(0)})),""===this.projectId?localStorage.postPlanTab="qualification":localStorage.postPlanTab=t},gotoCapability(t,e){this.$store.dispatch("personnelDevelopment/abilityInfo",{data:t,index:e}),this.$router.push({path:"/ability-detail"})},changeAbilityLevel(t){let e="";switch(t){case 1:e=1;break;case 2:e=3;break;case 3:e=5}return e},setEchars(t){if(0===this.postDetails.post_ability_classifies.length)return;let e=this.postDetails.post_ability_classifies[t];const s=document.getElementById(`radar${t}`),a=f().init(s);e.ability_level_standards.length>10?this.showList=e.ability_level_standards.slice(0,10):this.showList=e.ability_level_standards;const i=this.showList.map((t=>({name:t.ability_name,max:5})));let o="";if(0===this.evaluationInfo.length)o=new Array(this.showList.length).fill(0);else{const e=this.evaluationInfo.post_eva_result[t].ability_level_standards_import;o=this.getScore(e)}let r=this.getScore(this.showList),n="";if(0===this.evaluationInfo.length)n=new Array(this.showList.length).fill(0);else{const e=this.evaluationInfo.post_eva_result[t].ability_level_standards_task;n=this.getScore(e)}let c={value:[],name:""},l={value:[],name:""},u={value:[],name:""};c.value=r,l.value=o,u.value=n,c.name=this.$t("personnelDevelope.postStandard"),l.name=this.$t("personnelDevelope.importResults"),u.name=this.$t("personnelDevelope.taskResults"),this.seriesData=[],this.seriesData.push(c),this.seriesData.push(l),this.seriesData.push(u),this.option.series[0].data=[...this.seriesData],this.option.radar.indicator=i,a.setOption(this.option)},toHistoryEvaluationList(){const{postId:t}=this.$route.query;this.$router.push({path:`/history-evalution?post_id=${t}`})}}},P=(0,$.Z)(x,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"post-study-plan cl-page-container"},[t.isShow?t._e():s("div",[s("div",{staticClass:"post-study-learn-banner-wapper"},[s("div",{staticClass:"post-study-learn-banner"},[s("div",{staticClass:"post-study-learn-desc"},[s("h3",[t._v(t._s(t.postDetails.post_name))]),s("div",{staticClass:"post-study-rank",on:{click:t.gotoDetail}},[s("span",[t._v(t._s(t.$t("personnelDevelope.rank"))+"："+t._s(t.renderRankName))]),s("div",[s("SvgIcon",{staticClass:"icon-right",attrs:{"icon-class":"icon-arrow-r1",color:"#fff",size:14}})],1)])]),t.postDetails.video_introduction&&t.postDetails.video_introduction.url?s("div",{staticClass:"post_description-label-wapper",on:{click:t.showVideo}},[s("SvgIcon",{staticClass:"icon-left",attrs:{"icon-class":"icon-shipin",color:"#fff",size:14}}),s("span",{staticClass:"post-video-text"},[t._v(t._s(t.$t("personnelDevelope.video")))])],1):t._e()])]),t.data.length?s("div",{class:[1==t.data.length?"post-study-learn-info-active":""]},[s("van-tabs",{attrs:{sticky:"",color:t.themeColor.primaryColor},on:{change:t.changeTab},model:{value:t.initActiveTab,callback:function(e){t.initActiveTab=e},expression:"initActiveTab"}},t._l(t.data,(function(e,a){return s("van-tab",{key:a,attrs:{title:e.name,name:e.key,"title-class":"learn-content-tabs"}},[s("div",{class:[1==t.data.length?"learn-qualification-content active":"learn-qualification-content"]},[0===a&&t.projectId?s("div",{staticClass:"learn-content"},[s("div",{staticClass:"learn-content-img"},[s("van-image",{attrs:{fit:"contain",src:t.projectInfo.cover}})],1),s("div",{staticClass:"project-info"},[s("strong",{staticClass:"project-name"},[t._v(t._s(t.projectInfo.project_name))]),s("div",{staticClass:"learning-course"},[t._v(t._s(t.$t("personnelDevelope.qualificationCriteria"))+"："+t._s(t.projectInfo.qualified_standard))]),s("div",{staticClass:"current-progress"},[s("span",[t._v(t._s(t.$t("common.learningProgress"))+"：")]),s("div",{staticClass:"progress-content"},[s("van-progress",{attrs:{percentage:t.projectInfo.process||0,"show-pivot":!1}})],1),s("span",[t._v(t._s(t.projectInfo.process+"%"))])]),s("div",{staticClass:"post-project-btn",on:{click:t.gotoProjectDetail}},[s("van-button",{attrs:{type:"primary",block:!0,color:t.themeColor.primaryColor}},[t._v(" "+t._s(t.renderStartBtn)+" ")])],1)])]):s("div",{staticClass:"qualification-content"},[s("div",{staticClass:"qualificationinfo-card"},[s("div",{staticClass:"common-task-certificate task-content"},[s("div",{staticClass:"left",on:{click:function(e){return t.gotoTaskCertificate("task")}}},[s("span",[t._v(t._s(t.$t("pageTitle.keyTasks"))+" "),s("a",{staticClass:"post-arrow"},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-arrow-r1",size:8,color:"#fff"}})],1)]),s("span",[t._v(t._s(t.postDetails.task_size))])])]),s("div",{staticClass:"common-task-certificate certificate-content"},[s("div",{staticClass:"left",on:{click:function(e){return t.gotoTaskCertificate("certificate")}}},[s("span",[t._v(t._s(t.$t("pageTitle.requiredCertificates"))+" "),s("a",{staticClass:"post-arrow"},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-arrow-r1",size:8,color:"#fff"}})],1)]),s("span",[t._v(t._s(t.postDetails.certificate_size))])])]),s("div",{staticClass:"common-task-certificate organize-contribute"},[s("div",{staticClass:"left",on:{click:function(e){return t.gotoTaskCertificate("contribute")}}},[s("span",[t._v(t._s(t.$t("personnelDevelope.organizeContribute"))+" "),s("a",{staticClass:"post-arrow"},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-arrow-r1",size:8,color:"#fff"}})],1)]),s("span",[t._v(t._s(t.postDetails.contribute_size))])])])]),t.postDetails.post_ability_classifies&&t.postDetails.post_ability_classifies.length>0?s("div",{staticClass:"qualificationinfo-content"},[s("div",{class:[t.postDetails.post_ability_classifies&&t.postDetails.post_ability_classifies.length>1?"qualification-tabs active":"qualification-tabs"]},[s("van-tabs",{on:{change:t.changeAbility}},t._l(t.postDetails.post_ability_classifies,(function(e,a){return s("van-tab",{key:a,attrs:{title:e.post_ability_classify_desc,"title-class":"posts-ability-tab"}},[s("div",{staticClass:"radar-container"},[s("div",{attrs:{id:"radar"+a}})]),s("div",{staticClass:"qualification-table"},[s("div",{staticClass:"table-header"},[s("a",[t._v(t._s(t.$t("pageTitle.capabilityItem")))]),s("a",[t._v(t._s(t.$t("personnelDevelope.postStandard")))]),s("a",[t._v(t._s(t.$t("personnelDevelope.importResults")))]),s("a",[t._v(t._s(t.$t("personnelDevelope.taskResults")))])]),s("div",{staticClass:"table-body"},t._l(e.ability_level_standards,(function(i,o){return s("div",{key:o,staticClass:"table-row"},[s("span",{staticClass:"van-ellipsis",on:{click:function(s){return t.gotoCapability(e.ability_level_standards,o)}}},[t._v(t._s(i.ability_name))]),s("span",[t._v(t._s(i.ability_level))]),s("span",[t._v(t._s(0==t.getCurrentLevel("import",a,o)?"---":t.getCurrentLevel("import",a,o)))]),s("span",[t._v(t._s(0==t.getCurrentLevel("task",a,o)?"---":t.getCurrentLevel("task",a,o)))])])})),0)])])})),1)],1)]):t._e(),t.evaluationInfo.improve_suggest?s("div",{staticClass:"promotion-suggestions",on:{click:t.toPromotionSuggestions}},[s("van-button",{attrs:{type:"primary",block:!0,color:t.themeColor.primaryColor}},[t._v(t._s(t.$t("personnelDevelope.viewPromotionSuggestions")))])],1):t._e(),t.historyEvaluationList.length>1?s("div",{staticClass:"promotion-suggestions",on:{click:t.toHistoryEvaluationList}},[s("van-button",{attrs:{type:"primary",block:!0,color:t.themeColor.primaryColor}},[t._v(t._s(t.$t("personnelDevelope.historicalEva")))])],1):t._e()])])])})),1)],1):t._e(),s("RecommedCourse",{attrs:{"post-id":t.newPostId,"theme-color":t.themeColor.primaryColor}})],1),t.isShow?s("div",{staticClass:"post-study-loading"},[s("van-loading",{attrs:{size:"24px",vertical:""}},[t._v(t._s(t.$t("common.loading"))+"...")])],1):t._e(),s("van-action-sheet",{attrs:{actions:t.historyEvaluationList},on:{select:t.onSelect},model:{value:t.historyActionSheetshow,callback:function(e){t.historyActionSheetshow=e},expression:"historyActionSheetshow"}}),t.isShowDialog?s("div",[s("van-dialog",{attrs:{title:t.$t("personnelDevelope.playing")+"："+t.postDetails.video_introduction.name,"close-on-click-overlay":!0,"confirm-button-text":t.$t("common.close"),"class-name":"post-video-dialog","confirm-button-color":t.themeColor.primaryColor},on:{confirm:t.confirmDialog},model:{value:t.showVisible,callback:function(e){t.showVisible=e},expression:"showVisible"}},[s("cool-video",{ref:"video",attrs:{"player-id":"post-video",height:t.videoHeight,src:t.postDetails.video_introduction.url,controls:!0,autoplay:!1},on:{onError:t.onPlayerError}})],1)],1):t._e()],1)}),[],!1,null,"f048b77a",null).exports},78009:(t,e,s)=>{s.r(e),s.d(e,{default:()=>n});var a=s(95082),i=s(26294),o=s(22648),r={components:{},data:()=>({index:""}),computed:(0,a.Z)({},(0,i.mapGetters)({info:"personnelDevelopment/getInfo"})),created(){},mounted(){const{key:t,type:e}=this.$route.query;switch(this.index=t,e){case"task":(0,o.Td)(this.$t("pageTitle.taskDetail"));break;case"certificate":(0,o.Td)(this.$t("pageTitle.certificateDetail"));break;case"contribute":(0,o.Td)(this.$t("pageTitle.organizeContributeDetail"))}}},n=(0,s(1001).Z)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"post-common-detail cl-page-container"},[""!==t.index?s("div",{staticClass:"detail-item"},[s("span",{staticClass:"title"},[t._v(t._s(t.info[t.index].info_name))]),s("span",{staticClass:"desc"},[t._v(t._s(t.info[t.index].info_desc))])]):s("div",{staticClass:"detail-item"},[s("span",{staticClass:"desc"},[t._v(t._s(t.info))])])])}),[],!1,null,"0298ac68",null).exports},11177:(t,e,s)=>{s.r(e),s.d(e,{default:()=>c});s(21790);var a=s(24031),i=(s(47601),s(44951)),o=(s(57658),s(19024)),r=s(22648),n={components:{[i.Z.name]:i.Z,[a.Z.name]:a.Z},data:()=>({image:"",data:[],taskNum:"",type:""}),computed:{renderCertificateStudy(){return t=>{let e="";return"certificate"===t.type?e=this.$t("personnelDevelope.outSide"):"platform_certificate"===t.type&&(e=this.$t("personnelDevelope.platform")),e}},keyTasksOrQualification(){const{type:t}=this.$route.query;let e="";return e="task"===t?this.$t("pageTitle.keyTasks"):this.$t("pageTitle.requiredCertificates"),e}},mounted(){const{type:t,qualification_id:e}=this.$route.query,{certTaskInfo:s}=o.Z;this.type=t;let a="https://oss.coolcollege.cn";"task"===t?(this.image=`${a}/1810424885860765696.png`,(0,r.Td)(this.$t("pageTitle.keyTasks"))):"certificate"===t?(this.image=`${a}/1809904903733252096.png`,(0,r.Td)(this.$t("pageTitle.requiredCertificates"))):(this.image=`${a}/1809021997771001856.png`,(0,r.Td)(this.$t("personnelDevelope.organizeContribute"))),s(e,t).then((t=>{this.data=t.data.data,this.taskNum=this.data.length}))},methods:{gotoDetail(t){this.$store.dispatch("personnelDevelopment/saveInfoAction",this.data),this.$router.push({path:"/post-common-detail",query:{key:t,type:this.type}})}}},c=(0,s(1001).Z)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"cl-page-container"},[s("div",{staticClass:"task-img-content"},[s("van-image",{attrs:{fit:"contain",src:t.image}}),"task"===t.type?s("span",{staticClass:"task-desc"},[t._v(t._s(t.$t("personnelDevelope.taskTip",{taskNum:t.taskNum}))+t._s(t.$t("personnelDevelope.completeTip")))]):"certificate"===t.type?s("span",{staticClass:"task-desc"},[t._v(t._s(t.$t("personnelDevelope.certificateTip",{taskNum:t.taskNum}))+t._s(t.$t("personnelDevelope.completeTip")))]):s("span",{staticClass:"task-desc"},[t._v(t._s(t.$t("personnelDevelope.contributeTip",{taskNum:t.taskNum}))+t._s(t.$t("personnelDevelope.completeTip")))])],1),s("div",{staticClass:"post-task"},t._l(t.data,(function(e,a){return s("div",{key:a,staticClass:"task-item",on:{click:function(e){return t.gotoDetail(a)}}},[s("div",{staticClass:"task-item-content"},[null!==e.status?s("div",[!1===e.status?s("div",[s("van-tag",{attrs:{type:"primary"}},[t._v(t._s(t.$t("personnelDevelope.notObtained")))])],1):s("div",[s("van-tag",{attrs:{type:"primary"}},[t._v(t._s(t.$t("personnelDevelope.acquire")))])],1)]):t._e(),s("h2",[t._v(t._s(t.renderCertificateStudy(e))+t._s(e.info_name))]),s("span",{staticClass:"van-multi-ellipsis--l2 info_desc"},[t._v(t._s(e.info_desc))])])])})),0)])}),[],!1,null,"cb1cf1fa",null).exports},99872:(t,e,s)=>{s.r(e),s.d(e,{default:()=>S});var a=s(95082),i=(s(72975),s(98655)),o=(s(11155),s(91391)),r=(s(25773),s(35791)),n=(s(57658),s(26294)),c={name:"Skeleton",components:{},data:()=>({xxx:""}),computed:{},watch:{},created(){},mounted(){},methods:{}},l=s(1001);var u={name:"",components:{Skeleton:(0,l.Z)(c,(function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"skeleton"},[e("div",{staticClass:"top bg"}),e("div",{staticClass:"content"},[e("div",{staticClass:"row bg"}),e("div",{staticClass:"row bg"}),e("div",{staticClass:"row bg"})]),e("div",{staticClass:"footer"},[e("div",{staticClass:"left"},[e("div",{staticClass:"lecture"},[e("div",{staticClass:"avatar bg"}),e("div",{staticClass:"name bg"})]),e("div",{staticClass:"logo bg"})]),e("div",{staticClass:"right"},[e("div",{staticClass:"code bg"})])])])}],!1,null,"bd691d98",null).exports},directives:{press:{bind:function(t,e){if("function"!=typeof e.value)return;let s=null;let a=t=>{"click"===t.type&&0!==t.button||null===s&&(s=setTimeout((()=>{(t=>{e.value(t)})()}),2e3))},i=()=>{null!==s&&(clearTimeout(s),s=null)};t.addEventListener("mousedown",a),t.addEventListener("touchstart",a),t.addEventListener("click",i),t.addEventListener("mouseout",i),t.addEventListener("touchend",i),t.addEventListener("touchcancel",i)},componentUpdated(t,{value:e}){t.$value=e},unbind(t){t.removeEventListener("click",t.handler)}}},props:{posterInfo:{type:Object,default:()=>({})},current:{type:Number,default:0}},data:()=>({}),computed:(0,a.Z)({},(0,n.mapState)("user",["avatar","enterpriseLogo"])),watch:{},mounted(){},methods:{getPoster(){},setLoading(t){this.loading=t},handleLongPress(){this.$emit("long-press",this.posterInfo.template_type)},savePoster(){}}},d=(0,l.Z)(u,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"poster"},[t.posterInfo.data?s("img",{directives:[{name:"press",rawName:"v-press",value:t.handleLongPress,expression:"handleLongPress"}],staticClass:"detail",attrs:{src:t.posterInfo.data,alt:""}}):s("Skeleton")],1)}),[],!1,null,"7cc053dd",null).exports,h=(s(56977),s(74916),s(4723),{props:{autoPlay:{type:Boolean,default:!0},duration:{type:Number,default:500},interval:{type:Number,default:2500},showIndicator:{type:Boolean,default:!0},loop:{type:Boolean,default:!0},width:{type:Number,default:null}},data:()=>({slidesLength:1,distWidth:0,auto:!0,slideing:!0,timer1:"",className:"",dom:{},t:{sx:0,s:0,m:0,e:0},index:1}),mounted(){this.className="wh_swiper_"+1e3*Math.random().toFixed(3),setTimeout((()=>{this.starDom();let t=0;this.loop&&(t=-1),this.dom.transform=`translate3d(${this.distWidth*t}px, 0px, 0px)`,this.dom["-webkit-transform"]=`translate3d(${this.distWidth*t}px, 0px, 0px)`,this.dom["-ms-transform"]=`translate3d(${this.distWidth*t}px, 0px, 0px)`,this.autoPlay&&this.setTime()}),50)},methods:{onStart(t){this.slideing&&(this.clearTimeOut(),this.t.sx=this.getTransform(),this.t.s=t.touches[t.touches.length-1].clientX)},onMove(t){if(this.slideing&&-1!==this.t.s){if(this.clearTimeOut(),this.t.m=t.touches[t.touches.length-1].clientX-this.t.s,this.t.m<0&&this.index===this.slidesLength&&!this.loop)return;if(this.t.m>0&&1===this.index&&!this.loop)return;this.setTransform(this.t.m+this.t.sx)}},onEnd(){if(this.slideing&&-1!==this.t.s){if(this.clearTimeOut(),this.t.m<0&&this.index===this.slidesLength&&!this.loop)return;if(this.t.m>0&&1===this.index&&!this.loop)return;this.setTransform(this.t.m+this.t.sx);let t=this.getTransform();t+=this.t.m>0?.3*this.distWidth:-.3*this.distWidth;let e=-1*Math.round(t/this.distWidth);this.loop?this.index=e:this.index=e+1,this.wh("touch")}},setTransform(t){this.dom.transform=`translate3d(${t}px, 0px, 0px)`,this.dom["-webkit-transform"]=`translate3d(${t}px, 0px, 0px)`,this.dom["-ms-transform"]=`translate3d(${t}px, 0px, 0px)`},getTransform(){let t=this.dom.transform||this.dom["-webkit-transform"]||this.dom["-ms-transform"];return t=t.substring(12),t=t.match(/((?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)px/)[1],Number(t)},fn(t){t.preventDefault()},prevSlide(){this.clearTimeOut(),this.index--,this.wh()},nextSlide(){this.clearTimeOut(),this.index++,this.wh()},slideTo(t){this.clearTimeOut(),this.index=t+1,this.wh()},wh(t){this.slideing=!1,this.dom.transition="touch"===t?"250ms":`${this.duration}ms`,this.loop?this.setTransform(-1*this.index*this.distWidth):this.setTransform(-1*(this.index-1)*this.distWidth),this.t.m=0,this.t.s=-1,this.autoPlay&&this.setTime();let e="touch"===t?"250":this.duration;setTimeout((()=>{let t=0;this.loop&&(t=-1),this.dom.transition="0s",this.index>=this.slidesLength+1&&(this.index=1,this.setTransform(this.index*t*this.distWidth)),this.index<=0&&(this.index=this.slidesLength,this.setTransform(this.index*t*this.distWidth)),this.$emit("change",this.index-1||0),this.auto=!0,this.slideing=!0}),e)},setTime(){this.timer1=window.setTimeout((()=>{this.auto?(this.index++,this.wh()):window.clearTimeout(this.timer1)}),this.interval)},starDom(){let t=document.querySelector(`.${this.className}`).getElementsByClassName("wh_slide");if(this.slidesLength=t.length,this.slidesLength>1){let e=t[0].cloneNode(!0),s=t[this.slidesLength-1].cloneNode(!0);this.loop&&(document.querySelector(`.${this.className}`).insertBefore(s,t[0]),document.querySelector(`.${this.className}`).appendChild(e));const a=document.querySelector(`.${this.className}`);this.distWidth=this.width||a.firstChild.offsetWidth,this.dom=document.querySelector(`.${this.className}`).style}},clearTimeOut(){this.auto=!1,window.clearTimeout(this.timer1)}}}),p=(0,l.Z)(h,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"wh_content",on:{touchmove:t.fn}},[s("div",{staticClass:"wh_swiper",class:t.className,on:{touchstart:t.onStart,touchmove:t.onMove,touchend:t.onEnd}},[t._t("default")],2),t.showIndicator?s("div",{staticClass:"wh_indicator"},t._l(t.slidesLength,(function(e,a){return s("div",{key:a,staticClass:"wh_indicator_item",class:{wh_show_bgcolor:t.index-1===a}})})),0):t._e()])}),[],!1,null,"1a2743c8",null).exports,m={props:{width:{type:Number,default:null}},computed:{style(){return{width:`${this.width}px`}}},methods:{clickSlide(){this.$emit("click")}}},g=(0,l.Z)(m,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"wh_slide",style:t.style,on:{click:t.clickSlide}},[t._t("default")],2)}),[],!1,null,"a117be5e",null).exports,v=s(56955),f=s(78551),y=s(27632),_=s(5141),C=(s(91058),s(87714),s(82801),s(1174),s(39575),s(82472),s(48675),s(33105),s(63408),s(14590),s(3462),s(33824),s(12974),s(96838),s(57969)),I=s(28787);const b=async({name:t,id:e,source_type:s,fontSize:a="14",height:i=24,color:o="#000"})=>{let r=t;if("wx_sync"===s&&window.WWOpenData&&window.WWOpenData.initCanvas){window.WWOpenData.enableCanvasSharing(),window.WWOpenData.initCanvas();const t=await new Promise(((t,s)=>{const a=[{type:"userName",id:e}];window.WWOpenData.prefetch({items:a},((e,a)=>{if(e)return s(e);t(a)}))}));r=t.items.map((t=>t.data)).join("");const s=document.createElement("canvas"),n=s.getContext("2d"),c=(t=>{const e=t.backingStorePixelRatio||t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||1;return!window.devicePixelRatio||window.devicePixelRatio<1?1/e:window.devicePixelRatio/e})(n)||1;n.scale(c,c),n.font=`normal normal ${parseInt(a,10)}px sans-serif`;const{width:l,actualBoundingBoxAscent:u}=n.measureText(r),d=l||100,h=parseInt(i,10)||24;s.width=d*c,s.height=h*c,s.style.width=`${d}px`,s.style.height=`${h}px`,n.font=`normal normal ${parseInt(a,10)}px sans-serif`,n.fillStyle=o,n.textBaseline="alphabetic";const p=h/2+u/2;n.fillText(r,0,p*c);return s.toDataURL()}return r};var w=s(55602),$=s(25934),k={name:"Poster",components:{[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,Swiper:p,Slide:g,PosterContainer:d,SvgIcon:f.Z},data(){return{that:this,detail:{title:"",site1:{type:"",label:"",value:""},lecture:{name:"",avatar:"",id:"",source_type:""},path:""},template:[1,2,3,4],base64ImgArr:[{},{},{},{}],current:1,imgFileCache:[],isSharing:!1,template_type:""}},computed:(0,a.Z)((0,a.Z)({},(0,n.mapGetters)({userInfo:"user/getUserInfo"})),{},{primaryColor(){return this.$store.state.themeColor.primaryColor},showSaveBtn:()=>"dingTalk"===y.Z.env||"app"===y.Z.env,showShareBtn:()=>"dingTalk"===y.Z.env||"app"===y.Z.env,disabledBtn(){return!this.base64ImgArr[this.current-1]||!this.base64ImgArr[this.current-1].data}}),watch:{current(t){this.generatePoster(t)}},created(){},mounted(){const t=this.$route.params;window.sensors&&window.sensors.track("generatePoster_click",{business_type:t.from||""}),this.detail=t,this.template=t.template||[1,2,3,4],this.base64ImgArr=this.template.map((()=>({}))),t.requestHttp?this.$nextTick((()=>{this.generatePoster(0),this.generatePoster(1)})):this.generateShortLink()},methods:{async generateShortLink(){try{const t=await v.Z.generateShortLinkAjax(this.detail.path);t.data.short_link?(this.detail.path=(0,w.fZ)(t.data.short_link),this.$nextTick((()=>{this.generatePoster(0),this.generatePoster(1)}))):this.$toast.fail(this.$t("common.getLinkFailed"))}catch(t){this.$toast.fail(this.$t("common.getLinkFailed"))}},handleSave(){try{const{data:t,template_type:e}=this.base64ImgArr[this.current-1];y.Z.saveImage({url:t},(()=>{window.sensors&&window.sensors.track("savePoster_click",{business_type:this.detail.from||"",save_type:"saveBtnSave",template_type:e}),this.$toast.success(this.$t("attestation.saveSuccess"))}),(t=>{console.error(t),this.$toast.fail(this.$t("attestation.saveFail"))}))}catch(t){this.$toast.fail(this.$t("attestation.saveFail"))}},handleLongPress(t){this.showSaveBtn||window.sensors&&window.sensors.track("savePoster_click",{business_type:this.detail.from||"",save_type:"longPressSave",template_type:t})},async handleShare(){if(this.isSharing)return;this.isSharing=!0,this.$toast.loading({mask:!0,message:"分享中..."});const t=this.base64ImgArr[this.current-1],e=t.data;window.sensors&&window.sensors.track("sharePoster_click",{business_type:this.detail.from||"",template_type:t.template_type});let s=((t,e)=>{const s=t.split(","),a=s[0].match(/:((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?);/)[1],i=atob(s[1]);let o=i.length;const r=new Uint8Array(o);for(;o--;)r[o]=i.charCodeAt(o);const n=new Blob([r],{type:a});return new File([n],e,{type:a,lastModified:new Date})})(e,`${(new Date).getTime()}.png`);const a=this.imgFileCache.find((e=>e.id===t.id));if(a)(0,w.L$)({shareInfo:{imageUrl:a.imageUrl}});else{try{const{data:t}=await _.Z.inputCommonUploadImg(s,null);if(t.data){const{server:e,fileNewName:s}=t.data,a=`${e}/${s}`;this.imgFileCache.push({imageUrl:a,id:s}),(0,w.L$)({shareInfo:{imageUrl:a}})}}catch(t){this.$toast(this.$t("common.shareFailed"))}this.$toast.clear(),this.isSharing=!1}setTimeout((()=>{this.isSharing=!1}),2e3)},handleSwipe(t){this.current=t+1},async generatePoster(t=0){if(t>this.base64ImgArr.length-1)return;if(this.base64ImgArr[t].data)return;if(this.base64ImgArr[t].template_type)return;const e=this.template[t];this.template_type=e,this.$set(this.base64ImgArr,t,{template_type:e});const s=(0,a.Z)((0,a.Z)({primary_color:this.primaryColor},this.detail),{},{template_type:e,enterprise_logo:this.userInfo.enterpriseLogo}),i=await(async(t,e)=>{let s=(0,a.Z)({},t);if(3===t.template_type&&(s.invite_user={avatar:e.avatar,name:e.name,id:e.account,source_type:e.sourceType}),4===t.template_type){const e={offline:C.Z.t("pageTitle.offlineCourse"),investigate:C.Z.t("home.Survey"),course:C.Z.t("pageTitle.courseAll"),imageText:C.Z.t("pageTitle.courseAll"),microCourse:C.Z.t("pageTitle.microCourse"),studyProject:C.Z.t("pageTitle.trainingProgram"),liveCourse:I.Z.state.commonParams.isDingCompany?C.Z.t("ddLive.liveCourse"):C.Z.t("ddLive.live")};s.headline=e[t.from]&&`${e[t.from]}${C.Z.t("common.shareCode")}`}const{template_type:i}=s;let o=12,r="#000";return s.invite_user&&(r="rgba(0, 0, 0, 0.65)",s.invite_user.name=await b((0,a.Z)((0,a.Z)({},s.invite_user),{},{fontSize:o,color:r}))),s.lecture&&(1===i&&(r="rgba(0, 0, 0, 0.85)"),2===i&&(o=16,r="#fff"),s.lecture.name=await b((0,a.Z)((0,a.Z)({},s.lecture),{},{fontSize:o,color:r}))),s})(s,this.userInfo);try{const{data:{code:e,data:s}}=await v.Z.getPosterBase64(i);0===e&&s&&(s.id=(0,$.Z)(),this.$set(this.base64ImgArr,t,s))}catch(t){}}}},S=(0,l.Z)(k,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},[s("div",{staticClass:"content"},[s("div",{staticClass:"top"},[s("Swiper",{staticClass:"swipe",attrs:{loop:!1,"auto-play":!1,"show-indicator":!1},on:{change:t.handleSwipe}},t._l(t.template,(function(e,a){return s("Slide",{key:a},[s("div",{class:t.current===a+1?"active-box":"box"},[s("PosterContainer",{ref:"posterRef",refInFor:!0,attrs:{current:t.current,"poster-info":t.base64ImgArr[a]},on:{"long-press":t.handleLongPress}})],1)])})),1)],1),s("div",{staticClass:"bottom"},[t.showSaveBtn||5===t.template_type?t._e():s("div",{staticClass:"desc row"},[t._v(t._s(t.$t("buttons.saveImageToalbum")))]),s("div",{staticClass:"btn-row row"},[t.showSaveBtn?s("van-button",{staticClass:"save-btn",attrs:{disabled:t.disabledBtn,type:"default"},on:{click:t.handleSave}},[s("svg-icon",{attrs:{"icon-class":"icon-baocunerweima",size:14,color:"rgba(0, 0, 0, 0.85)"},on:{click:t.handleSave}}),t._v(" "+t._s(t.$t("buttons.saveImage")))],1):t._e(),t.showShareBtn?s("van-button",{staticClass:"share-btn",attrs:{disabled:t.disabledBtn,type:"info"},on:{click:t.handleShare}},[s("svg-icon",{attrs:{"icon-class":"icon-huifu1",color:"#fff",size:14}}),t._v(" "+t._s(t.$t("pageTitle.share")))],1):t._e()],1)])])])}),[],!1,null,"49ca8f01",null).exports},87877:(t,e,s)=>{s.r(e),s.d(e,{default:()=>O});var a=s(56955),i=s(17563),o=s(17266),r={name:"ScormReader",data:()=>({scormReaderUrl:""}),mounted(){this.$nextTick((()=>{this.init()}))},methods:{init(){const{from:t,studyId:e,courseId:s,resourceId:a,url:r,title:n,mapId:c}=this.$route.query,{userId:l,enterpriseId:u,accessToken:d}=this.$store.state.commonParams,h={source:t,studyId:e,courseId:s,resourceId:a,mapId:c,scormUrl:r,scormTitle:n,userId:l,enterpriseId:u,platform:"mobile",enterpriseApi:`${CL_API}`,access_token:d},p=(0,o.Nt)(h),m=decodeURIComponent(p.scormUrl),g=this.getScormUrl(m),v="other"===t?`${g}/unzip_file/coolcollege-scorm/prod/preview.html?scormUrl=${m}`:`${g}${SCORM_URL}?${i.stringify(p)}`;this.scormReaderUrl=v},getScormUrl(t){const e=t.split("//"),s=e[1].split("/");return[e[0],s[0]].join("//")}}},n=r,c=s(1001),l=(0,c.Z)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"scorm-reader"},[s("iframe",{ref:"scormWebview",attrs:{id:"scorm-reader-webview",src:t.scormReaderUrl,frameborder:"0",width:"100%",height:"100%",allowFullScreen:""}})])}),[],!1,null,"24f4391e",null).exports,u=(s(31960),s(10993)),d=(s(47601),s(44951)),h=(s(26699),s(32023),s(14790)),p=s(71522),m=s(24357),g=s(27632),v={name:"ImageReader",components:{VanImage:d.Z,ClWaterMark:m.Z},data:()=>({url:""}),computed:{user(){return this.$store.state.user}},mounted(){this.getImgUrl()},methods:{async getImgUrl(){let{storageType:t,url:e,videoId:s}=this.$route.query,a="";if("ALIBABA_PRIVATE"===t){const{data:t}=await p.Z.getPrivateImgUrl(s);0===t.code&&t.data?a=t.data.docResourceDownloadUrl:this.$toast(this.$t("course.playerError"))}else a="LOCAL"===t?await(0,h.m)(decodeURIComponent(e),s):decodeURIComponent(e);this.url=a},async handleError(){const{storageType:t,videoId:e}=this.$route.query;if("LOCAL"===t){let t="";if(this.url.includes("expire_time")&&(t=this.url.split("&")[1],t=t.split("=")[1]),!t||Number(t)>(new Date).getTime());else{let t=await(0,h.m)(this.url,e);this.url=t}}},previewImage(){"dingTalk"===g.Z.env?g.Z.previewImage({urls:[this.url]}):(0,u.Z)({images:[this.url],showIndex:!1})},onEnsure(){this.isNetwork=!1}}},f=v,y=(0,c.Z)(f,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"image-reader"},[s("cl-water-mark",{attrs:{scenes:"image"}}),s("van-image",{attrs:{src:t.url,alt:"",fit:"contain",width:"100%"},on:{click:t.previewImage,error:t.handleError}})],1)}),[],!1,null,"0c09eff6",null).exports,_={name:"HtmlReader",computed:{htmlReaderUrl(){const{url:t}=this.$route.query;return decodeURIComponent(t)}}},C=_,I=(0,c.Z)(C,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"html-reader"},[s("iframe",{ref:"htmlWebview",attrs:{id:"html-reader-webview",src:t.htmlReaderUrl,frameborder:"0",width:"100%",height:"100%",allowFullScreen:""}})])}),[],!1,null,"2f26d22f",null).exports,b=s(45854),w=s(98512),$={name:"DocPreview",components:{DocReader:b.Z},props:{queryData:{type:Object,default:()=>({})}},data:()=>({}),created(){const{title:t="",type:e=""}=(0,w.DP)();g.Z.setTitle?g.Z.setTitle(`${t}.${e}`):document.title=`${t}.${e}`}},k=(0,c.Z)($,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"doc-reader"},[s("DocReader",{attrs:{"query-data":t.queryData}})],1)}),[],!1,null,"4c9fc898",null).exports,S=s(95082),T=s(26294),Z=s(55602),x={name:"ArticleReader",components:{ClWaterMark:m.Z},data(){},computed:(0,S.Z)((0,S.Z)({},(0,T.mapGetters)({user:"user/getUserInfo",qyWechatBook:"setting/getQyWechatBook"})),{},{userInfo(){return this.$store.state.commonParams},url(){const{from:t,resourceId:e,studyId:s,courseId:a,studyType:r,mapId:n,readerType:c,gotoType:l}=this.$route.query,{accessToken:u}=this.userInfo,d={planId:s,courseId:a,studyType:r,mapId:n,from:t,gotoType:l,articleId:e,access_token:u},h=(0,o.Nt)(d);return c&&"article"===c?`${MOBILE_H5}${OUTSIDE_H5_PATH}#/${c}?${i.stringify(h)}`:""}}),mounted(){window.addEventListener("message",this.onMessage)},destroyed(){window.removeEventListener("message",this.onMessage)},methods:{onMessage(t){if((0,Z.IC)(t),t.data&&"previewImage"===t.data.type){const{urls:e,current:s}=t.data;"dingTalk"===g.Z.env?g.Z.previewImage({urls:e,index:s}):(0,u.Z)({images:e,startPosition:s})}}}},P=(0,c.Z)(x,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"article-reader"},[s("iframe",{ref:"articleWebview",attrs:{id:"article-reader-webview",src:t.url,frameborder:"0",width:"100%",height:"100%",allowFullScreen:""}}),s("cl-water-mark",{attrs:{scenes:"image"}})],1)}),[],!1,null,"fb13bd1e",null).exports,D=s(94864),L=s(22648),A={name:"MediaPlayer",components:{},data:()=>({playerUrl:"",player:null,contentType:""}),computed:{autoplay:()=>"ios"!==(0,L.Os)()},mounted(){this.initVideo()},methods:{async initVideo(){const{storageType:t,videoId:e,url:s,contentType:a}=this.$route.query;this.contentType=a,this.playerUrl="LOCAL"===t?await(0,h.m)(s,e):s,this.$nextTick((()=>{this.$refs.video&&(this.player=this.$refs.video.getPlayer())}))},async onPlayerError(){const{storageType:t,videoId:e,url:s}=this.$route.query,a=this.player.currentTime();if(this.loading=!1,"LOCAL"===t){let t=s.indexOf("expire_time")>-1?s.split("&")[1].split("=")[1]:"";if(!t||Number(t)>(new Date).getTime())return void this.$toast.fail(this.$t("course.playTips"));this.playerUrl=await(0,h.m)(s,e)}else if("ALIBABA_PRIVATE"===t){if(!e)return;const{data:t}=await D.Z.privateVodDownloadUrl({videoId:e});0===t.code&&(this.playerUrl=t.data.videoPlayInfo)}this.player.currentTime(Number(a)),this.player.play()}}},E=A,R=(0,c.Z)(E,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"media-reader"},[s("div",{staticClass:"media-player"},[s("cool-video",{ref:"video",attrs:{"player-id":"media","enable-progress-gesture":!0,autoplay:t.autoplay,src:t.playerUrl,"content-type":t.contentType,controls:!0,"show-fullscreen-btn":!0,height:211,"show-speed-button":!1},on:{onError:t.onPlayerError}})],1)])}),[],!1,null,"5ccb6237",null).exports,F=s(63874),q={name:"Reader",components:{ScormReader:l,ImageReader:y,HtmlReader:I,DocReader:k,ArticleReader:P,MediaReader:R},data(){return{type:"",timerId:null,queryData:this.$route.query}},mounted(){this.init()},beforeDestroy(){const{planId:t,courseId:e,studyType:s,resourceId:a,readerType:i}=this.queryData;"article"!==i&&"player"!==i||(s!==o.Si&&s!==o.z5||(0,o.qJ)({resourceId:a,planId:t,courseId:e,type:"stop",planType:s,isInterval:!1}),clearInterval(this.timerId))},methods:{async init(){const{readerType:t,title:e,storageType:s,isSaveRecord:a,url:i,videoId:o}=this.queryData;if(this.type=t,document.title=e||"","true"===a&&this.handleSaveStudyRecord(),"image"!==t||"LOCAL"!==s)"doc"!==t&&this.handleSaveProgress(),"link"===t&&(0,F.N8)({url:i,title:e});else{const t=await(0,h.m)(i,o);(0,L.p)(t).then((()=>{this.handleSaveProgress()}))}},async handleSaveProgress(){const{studyId:t,courseId:e,resourceId:s,progressType:i,progress:o,isSaveProgress:r,mapId:n}=this.queryData;if("true"!==r)return;const c={studyId:t,courseId:e,resourceId:s,mapId:n},l={progress:o?Number(o):100};await a.Z.saveProgress(i,c,l,null,!0)},handleSaveStudyRecord(){const{resourceId:t,planId:e,courseId:s,studyType:a}=this.queryData;a!==o.Si&&a!==o.z5||(0,o.qJ)({planId:e,courseId:s,resourceId:t,type:o.Si,planType:a,isInterval:!0}).then((t=>{this.timerId=t}))}}},N=q,O=(0,c.Z)(N,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"reader"},["scorm"===t.type?s("ScormReader"):"image"===t.type?s("ImageReader"):"html"===t.type?s("HtmlReader"):"article"===t.type?s("ArticleReader"):"doc"===t.type?s("DocReader",{attrs:{"query-data":t.queryData}}):"media"===t.type?s("MediaReader"):s("div",{staticClass:"no-support"})],1)}),[],!1,null,"55461a22",null).exports},82324:(t,e,s)=>{s.r(e),s.d(e,{default:()=>y});var a=s(95082),i=s(26294),o=s(25934),r=s(17563),n=s(27632),c=s(69119),l=s(55602),u=s(22648),d=s(96838),h=s(94864),p=s(56955),m=s(67185),g=s(28512),v=s(17266),f={name:"Player",components:{CoursePlayer:m.Z,SubsidyPlayer:g.Z},data:()=>({mediaInfo:{},timerId:null,learningTimer:null,batchNumber:""}),computed:(0,a.Z)((0,a.Z)((0,a.Z)({},(0,i.mapState)("setting",["showRandomWindow","dragSwitch","preventHangSwitch","resourceShareSwitch"])),(0,i.mapState)(["commonParams"])),{},{draggable(){return this.mediaInfo.progress>=100||"true"===this.mediaInfo.draggable},isHangSwitch(){return this.mediaInfo.preventHangSwitch?"true"===this.mediaInfo.preventHangSwitch:this.preventHangSwitch},autoplay:()=>"ios"!==(0,u.Os)()}),beforeDestroy(){clearInterval(this.learningTimer),this.learningTimer=null,this.$refs.coursePlayerRef&&this.$refs.coursePlayerRef.getCommonVideoPlayer().isPlaying&&this.recordLearningTime()},destroyed(){"dingTalk"===n.Z.env&&(0,l.vD)({shareInfo:{}});const{recordType:t}=this.mediaInfo;t!==v.Si&&t!==v.z5||(0,v.qJ)({resourceId:this.queryData.resourceId,planId:this.queryData.studyId,courseId:this.queryData.courseId,type:"stop",planType:t,isInterval:!1}),clearInterval(this.timerId)},mounted(){this.init()},methods:{async init(){if(this.queryData=this.$route.query,this.mediaInfo={courseId:this.queryData.courseId,resourceId:this.queryData.resourceId,studyId:this.queryData.studyId,progressType:this.queryData.progressType,recordType:this.queryData.recordType,syncProgress:this.queryData.syncProgress,progress:this.queryData.progress,recentStart:this.queryData.recentStart,url:this.queryData.url,planId:this.queryData.studyId,title:this.queryData.title,draggable:this.queryData.draggable,cover:this.queryData.cover,storageType:this.queryData.storageType,videoId:this.queryData.videoId,id:this.queryData.id,contentType:this.queryData.contentType,duration:"undefined"===this.queryData.duration?0:Number(this.queryData.duration),auditionLength:"undefined"===this.queryData.auditionLength?0:Number(this.queryData.auditionLength),auditionType:"undefined"===this.queryData.auditionType?-1:Number(this.queryData.auditionType),videoFaceRecognition:this.queryData.videoFaceRecognition,needVideoFaceRecognition:this.queryData.needVideoFaceRecognition,hasSetFace:this.queryData.hasSetFace,preventHangSwitch:this.queryData.preventHangSwitch,speedPlaySwitch:this.queryData.speedPlaySwitch},this.handleSaveStudyRecord(),this.mediaInfo.url=decodeURIComponent(this.mediaInfo.url),"ALIBABA_PRIVATE"===this.mediaInfo.storageType){if(!this.mediaInfo.videoId)return;const{data:t}=await h.Z.privateVodDownloadUrl({videoId:this.mediaInfo.videoId});0===t.code&&(this.mediaInfo.url=t.data.videoPlayInfo)}if(this.$nextTick((()=>{this.getEnterpriseDrag()})),"dingTalk"===n.Z.env&&this.resourceShareSwitch&&"project"===this.mediaInfo.recordType){const t={resourceId:this.mediaInfo.resourceId,flag:"share_resource"},{title:e="",cover:s=""}=this.mediaInfo;(0,l.vD)({shareInfo:{title:"",desc:e,path:`pages/messageRedirect/messageRedirect?${r.stringify(t)}`,imageUrl:s}})}},async getEnterpriseDrag(){const t=await h.Z.enterprise.queryEnterpriseVideoDrag();if(0===t.code){const{enterpriseId:e}=this.commonParams;t.data.indexOf(e)>-1&&(this.mediaInfo.draggable=!0)}},onEnded(){this.timerId&&clearInterval(this.timerId),this.learningTimer&&(clearInterval(this.learningTimer),this.learningTimer=null)},onPause(t){this.handleSaveProgress(t),this.timerId&&clearInterval(this.timerId),this.learningTimer&&(clearInterval(this.learningTimer),this.learningTimer=null),this.recordLearningTime()},async handleSaveProgress({currentTime:t,progress:e,requestId:s}){const{progressType:a,courseId:i,resourceId:o,studyId:r,mapId:n}=this.queryData,c={courseId:i,resourceId:o,studyId:r},l={progress:e,recent_start:t,mapId:n};try{const i=await p.Z.saveProgress(a,c,l,s,!1);d.Z.logger({moduleName:"playerProgressSuccess",data:{currentTime:t,progress:e,res:i}})}catch(s){d.Z.logger({moduleName:"playerProgressFailed",data:{currentTime:t,progress:e,err:s}})}},onPlay(){if(this.timerId&&clearInterval(this.timerId),this.handleSaveProgress({currentTime:this.mediaInfo.recentStart,progress:this.mediaInfo.progress,requestId:(0,o.Z)()}),this.handleSaveStudyRecord(),!this.learningTimer){this.batchNumber=(0,o.Z)(),this.recordLearningTime();const t=this;clearInterval(t.learningTimer),t.learningTimer=setInterval((()=>{t.recordLearningTime()}),c.If)}},handleSaveStudyRecord(){const{recordType:t}=this.mediaInfo;t!==v.Si&&t!==v.z5||(0,v.qJ)({planId:this.queryData.studyId,courseId:this.queryData.courseId,resourceId:this.queryData.resourceId,planType:this.queryData.recordType,type:v.Si,isInterval:!0}).then((t=>{this.timerId=t}))},async recordLearningTime(){const{progressType:t,courseId:e,resourceId:s,studyId:a}=this.queryData,i={courseId:e,resourceId:s,studyId:a},o={batchNumber:this.batchNumber};try{await p.Z.postClassHourTiming(t,i,o)}catch(t){console.warn(t)}}}},y=(0,s(1001).Z)(f,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.mediaInfo.url?s("div",{staticClass:"player-container"},["true"===t.mediaInfo.isSubsidyCourse?s("subsidy-player",{attrs:{"enter-type":"study",cover:t.mediaInfo.cover,draggable:t.draggable,"is-fixed":!1,autoplay:t.autoplay,"playing-video":t.mediaInfo,"prevent-hang-flag":t.isHangSwitch,"show-random-window":t.showRandomWindow},on:{"update:playingVideo":function(e){t.mediaInfo=e},"update:playing-video":function(e){t.mediaInfo=e},handleSaveProgress:t.handleSaveProgress}}):s("course-player",{ref:"coursePlayerRef",attrs:{"enter-type":"study",draggable:t.draggable,autoplay:t.autoplay,"playing-video":t.mediaInfo,cover:t.mediaInfo.cover,"is-playing-video":!0,"is-fixed":!1,"prevent-hang-flag":t.isHangSwitch,"show-random-window":t.showRandomWindow},on:{onPlay:t.onPlay,onPause:t.onPause,onTimerEvent:t.handleSaveProgress,onEnded:t.onEnded}})],1):t._e()}),[],!1,null,"21b75652",null).exports},63936:(t,e,s)=>{s.r(e),s.d(e,{default:()=>u});var a=s(95082),i=(s(25773),s(35791)),o=(s(26699),s(74916),s(15306),s(57658),s(22648)),r=s(40848),n=s(56955),c=s(27632),l={name:"ShareTransit",components:{Button:i.Z},data:()=>({TASKS:["studyProject","studyTask","newEmployeeTask"],tipBackgroundImage:r.qv,listConfig:r.GA,listConfigSpecial:r.Xd,source:"",type:"",id:"",course_id:"",error:{},resourceInfo:{},examVo:{}}),computed:{primaryColor(){return this.$store.state.themeColor.primaryColor}},mounted(){const{source:t,type:e,course_id:s,id:a}=this.$route.query;this.source=t,this.type="string"==typeof e?e:e[0],this.course_id=s,this.id=a,this.setDefaultTitle(),this.getShareInfo()},methods:{isOpenRecognition(t){const{face_recognition:e,exam_vo:s}=t||{},{face_recognition:a}=s||{};return!e||"on"!==e&&!0!==e?!!a&&"exam":"task"},getShareInfo(){n.Z.getShareCheckInfo({source:this.source,type:this.type,id:this.id,course_id:this.course_id}).then((t=>{const{data:{code:e,data:s={}}}=t;if("200000"!==e)this.handleServiceError(t);else if("exam"===this.source||"task"!==this.isOpenRecognition(s)||"app"!==c.Z.env&&"dingTalk"!==c.Z.env){const t=["studyProject","studyTask","newEmployeeTask"].includes(this.source)&&s.exam_vo||s;this.$router.replace(r.km[this.source][this.type]((0,a.Z)((0,a.Z)({},t),{},{resource_id:this.course_id}),s,this.source))}else this.resourceInfo=(0,a.Z)((0,a.Z)({},s),{},{resource_id:this.course_id}),this.examVo=(0,a.Z)({},s.exam_vo||{}),this.error=r.wx})).catch((t=>{t.response&&t.response.data&&this.handleServiceError(t.response),t.data&&this.handleServiceError(t)})).finally((()=>{}))},handleServiceError(t){const e=(0,r.ZP)({},{source:this.source,type:this.type}),{data:s}=t,{code:i,data:o={}}=s,n=o&&o.exam_vo,c=["studyProject","studyTask","newEmployeeTask"].includes(this.source)&&n||o;if(i&&e[i]&&!e[i].showErrorMessage){const t=("exam"===this.type?(0,r.ZP)(c,{source:this.source,type:this.type}):e)[i],{autoJumpToDetail:s}=t;if(s){if("exam"===this.type){const t=(0,r.yf)((0,a.Z)((0,a.Z)({},c),{},{resource_id:this.course_id}),o,this.source);if(t)return void this.$router.replace(t)}this.handleToDetail((0,a.Z)((0,a.Z)({},c),{},{resource_id:this.course_id}))}else this.resourceInfo=(0,a.Z)((0,a.Z)({},o),{},{resource_id:this.course_id}),this.examVo=(0,a.Z)({},n||{}),this.error=(0,r.ZP)(c,{source:this.source,type:this.type})[i]}},handleToHome(){this.$router.replace("/home-module"),(0,o.o2)(),localStorage.removeItem("fullPath"),c.Z.goHome()},handleToDetail(t){this.$router.replace(r.zl[this.source]((0,a.Z)({},t)))},setDefaultTitle(){(0,o.Td)(this.$t(r.v7[this.source]))},handleToList(){let t=r.GA;this.error.isSpecial&&(t=r.Xd),t[this.source].backToList?this.$router.push({path:r.ix[this.source]}):this.handleToDetail((0,a.Z)({},this.resourceInfo))},getTime({resourceInfo:t,examVo:e},s="yyyy.MM.dd hh:mm"){const{end_time:a,endTime:i,begin_time:r,beginTime:n}=t,c=Number(a||i),l=Number(r||n);if(c||l)return{end_time:(0,o.p6)(c,s),begin_time:(0,o.p6)(l,s)};const{end_time:u,begin_time:d}=e;return{end_time:(0,o.p6)(Number(u||c),s),begin_time:(0,o.p6)(Number(d||l),s)}}}},u=(0,s(1001).Z)(l,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"share-transit"},[s("img",{staticClass:"imgs",attrs:{src:t.tipBackgroundImage[t.error.bgName]}}),t.error.endTime?s("div",{staticClass:"tips"},[t._v(t._s(t.$t(t.error.content,{time:t.getTime({resourceInfo:t.resourceInfo,examVo:t.examVo}).end_time})))]):t.error.startTime?s("div",{staticClass:"tips"},[t._v(t._s(t.$t(t.error.content,{time:t.getTime({resourceInfo:t.resourceInfo,examVo:t.examVo}).begin_time})))]):s("div",{staticClass:"tips"},[t._v(t._s(t.$t(t.error.content))+" ")]),t.error.goToDetail?s("div",{staticClass:"detail-btn",on:{click:function(){t.handleToDetail(t.resourceInfo)}}},[t._v(t._s(t.$t("signIn.seeDetails")))]):t._e(),t.error.backToHome?s("Button",{attrs:{color:t.primaryColor},on:{click:t.handleToHome}},[t._v(t._s(t.$t("share.homeBack")))]):t._e(),t.error.showList?s("Button",{attrs:{color:t.primaryColor},on:{click:t.handleToList}},[t._v(t._s(t.error.isSpecial?t.$t(t.listConfigSpecial[t.source].buttonText):t.$t(t.listConfig[t.source].buttonText)))]):t._e()],1)}),[],!1,null,"2703c2fa",null).exports},7814:(t,e,s)=>{s.r(e),s.d(e,{default:()=>h});s(20581);var a=s(50914),i=s(27484),o=s.n(i),r=s(25042),n=s(4852),c=s(27479),l=s(45877),u=s(67875),d={name:"StudyList",components:{List:a.Z,EmptyBox:c.Z,Avatar:n.Z,ClCustomUser:l.Z,ClCustomDepartment:u.Z},data:function(){return{pageSize:10,pageNumber:1,scrollHeight:0,tabs:[],planInfo:{},loading:!1,showLoading:!1,peopleList:[],hasNextPage:!0,current:0}},computed:{themeColor(){return this.$store.state.themeColor.primaryColor}},mounted(){const{type:t}=this.$route.query;this.getStudy("init",(e=>{const s="end"===t?`${this.$t("home.overdue")}(${e.overdue_count})`:`${this.$t("data.ongoing")}(${e.ongoing_count})`;this.tabs=[{title:`${this.$t("home.finished")}(${e.finished_count})`,status:"finished"},{title:s,status:"end"===t?"overdue":"unfinished"}]}))},methods:{getStudy(t,e){const{query:s}=this.$route,{planId:a}=s,{pageSize:i,pageNumber:n,tabs:c,current:l,peopleList:u}=this,d={page_size:i,page_number:n,status:"init"===t?"finished":c[l].status};r.Z.getStudyPlanPeople(a,d).then((t=>{t.data.plan_base.startTimeLabel=o()(t.data.plan_base.begin_time).format("YYYY/MM/DD"),t.data.plan_base.endTimeLabel=o()(t.data.plan_base.end_time).format("YYYY/MM/DD"),e&&e(t.data.plan_base),this.planInfo=t.data.plan_base,this.peopleList=u.concat(t.data.data.list),this.showLoading=!1,this.loading=!1,this.hasNextPage="true"===t.data.data.has_next_page})).catch((()=>{this.loading=!1,this.showLoading=!1}))},handleClick(t){this.current=t,this.peopleList=[],this.handleTabClick()},handleTabClick(){this.loading=!0,this.pageNumber=1,this.getStudy()},lowerCbk(){this.pageNumber+=1,this.loading=!0,this.getStudy()}}},h=(0,s(1001).Z)(d,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"study-plan-people cl-page-container"},[s("div",{staticClass:"list-container"},[s("div",{staticClass:"plan-info"},[s("div",{staticClass:"title"},[t._v(t._s(t.planInfo.title))]),s("div",{staticClass:"info-column"},[s("div",{staticClass:"info-one"},[s("div",{staticClass:"label"},[t._v(" "+t._s(t.$t("common.assignor"))+" ")]),s("div",{staticClass:"value"},[s("ClCustomUser",{attrs:{"data-type":"userName",value:t.planInfo.creator_sync_user_id,name:t.planInfo.create_user_name,type:t.planInfo.creator_sync_source_type}})],1)]),s("div",{staticClass:"info-one",style:"display: "+("neo"!==t.planInfo.type?"block":"none")},[s("div",{staticClass:"label"},[t._v(" "+t._s(t.$t("home.startTime"))+" ")]),s("div",{staticClass:"value"},[t._v(" "+t._s(t.planInfo.startTimeLabel)+" ")])]),s("div",{staticClass:"info-one",style:"display: "+("neo"!==t.planInfo.type?"block":"none")},[s("div",{staticClass:"label"},[t._v(" "+t._s(t.$t("home.endTime"))+" ")]),s("div",{staticClass:"value"},[t._v(" "+t._s(t.planInfo.endTimeLabel)+" ")])])])]),s("div",{staticClass:"tab-content"},[s("div",{staticClass:"tabs-list"},t._l(t.tabs,(function(e,a){return s("div",{key:a,class:t.current===a?"active":"",style:"color: "+(t.current===a?t.themeColor:""),on:{click:function(e){return t.handleClick(a)}}},[t._v(" "+t._s(e.title)+" "),s("div",{class:t.current===a?"active_bag":"",style:"backgroundColor: "+(t.current===a?t.themeColor:"")})])})),0),0===t.peopleList.length?s("EmptyBox"):t._e(),s("List",{attrs:{finished:!t.hasNextPage,"immediate-check":!1},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.peopleList,(function(e){return s("div",{key:e.id,staticClass:"item-one"},[s("div",{staticClass:"img"},[s("Avatar",{attrs:{width:40,height:40,src:e.avatar}})],1),s("div",{staticClass:"detail"},[e.sync_user_info&&e.sync_user_info.name?s("div",{staticClass:"name"},[s("ClCustomUser",{attrs:{"data-type":"userName",value:e.sync_user_info.userId,name:e.sync_user_info.name,type:e.sync_user_info.sourceType}})],1):s("div",{staticClass:"name"},[t._v(" "+t._s(e.name)+" ")]),s("div",{staticClass:"info"},[e.sync_user_info&&e.sync_user_info.department_infos?s("div",{staticClass:"dept"},[s("ClCustomDepartment",{attrs:{"display-all":!0,list:e.sync_user_info.department_infos}})],1):s("div",{staticClass:"dept"},[t._v(t._s(e.departments.join(" / ")))]),s("div",{staticClass:"progress"},[t._v(" "+t._s(e.progress)+"% ")])])])])})),0)],1)])])}),[],!1,null,"1b3b5939",null).exports},80971:(t,e,s)=>{s.r(e),s.d(e,{default:()=>m});s(82500);var a=s(49414),i=(s(82522),s(10342)),o=(s(20581),s(50914)),r=(s(57658),s(27484)),n=s.n(r),c=s(25042),l=s(27479),u=s(95969),d=s(45877),h={name:"StudyList",components:{List:o.Z,Tab:i.Z,Tabs:a.Z,EmptyBox:l.Z,ClCustomUser:d.Z},data:function(){return{tabArr:[],courseId:"",projectId:"",dataList:[],activeTab:1,loading:!1,hasNextPage:!0,pageSize:10,pageNumber:1}},computed:{themeColor(){return this.$store.state.themeColor.primaryColor}},mounted(){this.tabArr=[{title:this.$t("data.notStarted"),status:"1"},{title:this.$t("data.ongoing"),status:"2"},{title:this.$t("data.over"),status:"3"}];const{courseId:t,projectId:e}=this.$route.query;this.courseId=t,this.projectId=e,this.loading=!0,this.loadData()},methods:{onTabChange(t){this.activeTab=t,this.pageNumber=1,this.hasNextPage=!0,this.dataList=[],this.loadData()},loadData(){this.loadStudyData()},loadStudyData(){const{pageNumber:t,pageSize:e,activeTab:s,projectId:a}=this;this.loading=!0;const i={keyword:"",onlySeeMe:"",queryIntervalType:s,pageSize:e,pageNumber:t,projectId:a};c.Z.studyAssignedTrack(i).then((t=>{t.data.list.forEach((t=>{t.startTimeLabel=n()(t.beginTime).format("YYYY/MM/DD"),t.endTimeLabel=n()(t.endTime).format("YYYY/MM/DD")})),this.dataList=this.dataList.concat(t.data.list),this.hasNextPage=!0===t.data.hasNextPage,this.loading=!1}))},onLoad(){if(!1===this.hasNextPage)return!1;this.pageNumber+=1,this.loading=!0,this.loadData()},handleToDetail(t){const{tabArr:e,activeTab:s}=this,a="3"===e[s-1].status?"end":"";this.$router.push(u.Z.studyProject.taskAssignDetail({planId:t.id,type:a}))}}},p=(0,s(1001).Z)(h,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"project-assign-list cl-page-container"},[s("Tabs",{attrs:{"line-width":24,color:"white","title-active-color":t.themeColor,sticky:""},on:{change:t.onTabChange},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},t._l(t.tabArr,(function(e){return s("Tab",{key:e.title,attrs:{title:e.title,name:e.status}},[t.loading||0!==t.dataList.length?s("div",{staticClass:"study-list-content"},[s("List",{attrs:{finished:!t.hasNextPage,"immediate-check":!1,"finished-text":t.$t("common.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.dataList,(function(e){return s("div",{key:e.id,staticClass:"ProjectAssignedList_list_item",on:{click:function(s){return t.handleToDetail(e)}}},[s("div",{staticClass:"title"},[t._v(" "+t._s(e.title)+" ")]),s("div",{staticClass:"info"},[s("div",{staticClass:"info-one"},[s("div",{staticClass:"label"},[t._v(t._s(t.$t("common.assignor")))]),s("div",{staticClass:"value"},[s("cl-custom-user",{attrs:{type:e.creator_source_type,"data-type":"userName",value:e.creator_sync_user_id,name:e.creatorName}})],1)]),s("div",{staticClass:"info-one"},[s("div",{staticClass:"label"},[t._v(t._s(t.$t("home.startTime")))]),s("div",{staticClass:"value"},[t._v(t._s(e.startTimeLabel))])]),s("div",{staticClass:"info-one"},[s("div",{staticClass:"label"},[t._v(t._s(t.$t("home.endTime")))]),s("div",{staticClass:"value"},[t._v(t._s(e.endTimeLabel))])])])])})),0)],1):s("EmptyBox")],1)})),1)],1)}),[],!1,null,"45e80d57",null),m=p.exports},79079:(t,e,s)=>{s.r(e),s.d(e,{default:()=>x});var a=s(95082),i=(s(25773),s(35791)),o=(s(28301),s(45644)),r=(s(86039),s(20495)),n=(s(23307),s(81392)),c=(s(47238),s(75167)),l=(s(39610),s(2163)),u=(s(82500),s(49414)),d=(s(82522),s(10342)),h=(s(20581),s(50914)),p=(s(47601),s(44951)),m=(s(49153),s(5944)),g=(s(69710),s(57609)),v=(s(52355),s(29233)),f=(s(57658),s(33948),s(78551)),y=s(26294),_=s(22648),C=s(78368),I=s(45877),b=s(95969),w=s(18715),$=s(61913),k=s(4374),S=s(57969),T={name:"ProjectAssignList",components:{[v.Z.name]:v.Z,[g.Z.name]:g.Z,[m.Z.name]:m.Z,[p.Z.name]:p.Z,[h.Z.name]:h.Z,[d.Z.name]:d.Z,[u.Z.name]:u.Z,[l.Z.name]:l.Z,[c.Z.name]:c.Z,[n.Z.name]:n.Z,VanSearch:r.Z,ClCustomUser:I.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,ClSelectDepartment:$.Z,SvgIcon:f.Z},beforeRouteLeave(t,e,s){"/project-detail"===t.path&&"dataMonitor"!==t.query.sourcePage&&this.$store.commit("studyProject/setProjectAssignStatus",{study_type:"task",study_status:"unfinished",keyword:""}),s()},data(){return{activeTab:"monitoring",activeTabType:"",tabs:[{title:this.$t("project.taskMonitoring"),name:"task",number:0},{title:this.$t("project.selfRecord"),name:"self_study",number:0}],tabsType:[{title:this.$t("offline.ongoing"),name:"unfinished",number:0},{title:this.$t("common.finished"),name:"finished",number:0},{title:this.$t("common.overdue"),name:"overdue",number:0}],list:[],loading:!1,finished:!1,params:{study_type:"task",study_status:"unfinished",keyword:"",page_number:1,page_size:10,department_id:""},hideTipInfo:!0,defaultAvatar:C,showModal:!1,random:(new Date).valueOf()}},computed:(0,a.Z)((0,a.Z)({},(0,y.mapGetters)({primaryColor:"getPrimaryColor"})),(0,y.mapState)("studyProject",["projectAssignStatus"])),mounted(){const{study_type:t,study_status:e,keyword:s}=this.projectAssignStatus;this.params=(0,a.Z)((0,a.Z)({},this.params),{},{study_type:t,study_status:e,keyword:s}),this.activeTab=t,this.activeTabType=e,"self_study"===t&&this.tabsType.pop()},methods:{onOk(t){this.showModal=!1,this.list=[],this.params.page_number=1,this.params.department_id=t,this.$nextTick((()=>{this.onLoad()}))},showDepartment(){this.showModal=!0},hideModal(){this.showModal=!1},viewProjectDetail(t){const{courseId:e}=this.$route.query;this.$router.push({path:b.Z.studyProject.toStudyProject({studyProjectId:e,sourcePage:"dataMonitor",student_id:t})})},hideTip(){this.hideTipInfo=!1},handleJump(){const{projectId:t}=this.$route.query;this.$router.push(b.Z.studyProject.projectData({courseType:"project",projectId:t}))},handleDate:(t,e)=>(0,_.yM)(t,e),showTotalIntro(t){t.isShowMore=!t.isShowMore},onClear(){this.params.keyword="",this.onSearch()},onSearch(){this.list=[],this.params.page_number=1,this.onLoad()},setTabsType(t){"self_study"===t?this.tabsType.pop():this.tabsType.push({title:this.$t("common.overdue"),name:"overdue",number:0}),this.list=[],this.activeTabType=this.tabsType[0].name||"",this.params=(0,a.Z)((0,a.Z)({},this.params),{},{study_type:t,study_status:this.tabsType[0].name||"",page_number:1,page_size:10}),this.random=(new Date).valueOf(),this.onLoad()},onTabChange(t){this.params=(0,a.Z)((0,a.Z)({},this.params),{},{study_type:this.activeTab,study_status:t,page_number:1}),this.list=[],this.random=(new Date).valueOf(),this.onLoad()},async onLoad(){try{const{courseId:t}=this.$route.query;this.loading=!0;const{random:e}=this;this.finished=!1;const s=await w.Z.getMonitorData(t,this.params);(0,_.Td)(s.data.study_project.title);const{total:i,list:o,has_next_page:r}=s.data.monitor_list,{overdue_count:n,unfinished_count:c,finished_count:l}=s.data;if(this.random!==e)return;this.tabsType=this.tabsType.map((t=>{switch(t.name){case"unfinished":t.number=c;break;case"finished":t.number=l;break;case"overdue":t.number=n}return t}));let u=o.map((t=>(0,a.Z)((0,a.Z)({},t),{},{avatar:t.user_info.avatar,userName:t.user_name,source_type:"",user_id:t.user_id,star_time:t.task_begin_time,end_time:t.task_end_time,department:t.department_name})));this.list=0===i?[]:this.introduce(this.list.concat(u)),this.finished=0===i||"false"===r,this.loading=!1,this.params.page_number+=1,this.$store.commit("studyProject/setProjectAssignStatus",{study_type:this.params.study_type,study_status:this.params.study_status,keyword:this.params.keyword})}catch(t){this.catchError({errorInfo:t.data}),this.loading=!1,this.finished=!0}},catchError({errorInfo:t}){try{if(t.code){let e="";if(k.Z[t.code]){let{content:s}=k.Z[t.code];e=s[S.Z.locale]}else e=this.$t("promptMessage.systemError");this.$toast(e)}}catch(t){console.error(t)}},introduce:t=>(t.forEach((t=>{t.department.length>40?(t.isShowMore=!0,t.showExchangeButton=!0):(t.isShowMore=!1,t.showExchangeButton=!1)})),[...t])}},Z=T,x=(0,s(1001).Z)(Z,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"sign-list"},[t.hideTipInfo?s("div",{staticClass:"top-info-tips",on:{click:t.handleJump}},[s("div",[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-gonggao1",color:"#EC6830",size:14}}),s("span",[t._v(t._s(t.$t("project.toOldMonitoringTip")))])],1),s("div",[s("van-icon",{attrs:{name:"arrow",size:"15"}})],1)]):t._e(),s("van-sticky",[s("van-tabs",{staticClass:"sticky-box",attrs:{color:t.primaryColor,"line-width":24,sticky:""},on:{change:t.setTabsType},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},t._l(t.tabs,(function(t){return s("van-tab",{key:t.name,attrs:{title:t.title,name:t.name}})})),1),s("van-tabs",{staticClass:"type_box",attrs:{color:t.primaryColor,"line-width":24,sticky:""},on:{change:t.onTabChange},model:{value:t.activeTabType,callback:function(e){t.activeTabType=e},expression:"activeTabType"}},t._l(t.tabsType,(function(t){return s("van-tab",{key:t.name,attrs:{title:t.title+"("+t.number+")",name:t.name}})})),1),s("div",{staticClass:"config-params-box"},[s("VanSearch",{staticClass:"search-box",attrs:{placeholder:t.$t("project.monitoringSearchTip")},on:{search:t.onSearch,clear:t.onClear},model:{value:t.params.keyword,callback:function(e){t.$set(t.params,"keyword",e)},expression:"params.keyword"}}),s("div",{staticClass:"department-box",on:{click:t.showDepartment}},[t.params.department_id?s("SvgIcon",{attrs:{color:t.primaryColor,size:12,"icon-class":"icon-shaixuan1"}}):s("SvgIcon",{attrs:{size:12,"icon-class":"icon-shaixuan1",color:"#BFBFBF"}}),s("span",{class:[t.params.department_id?"department-title active":"department-title"]},[t._v(t._s(t.$t("project.department")))])],1)],1)],1),s("van-list",{ref:"listBox",staticClass:"user-list",attrs:{finished:t.finished,"finished-text":t.finished&&0===t.list.length?"":t.$t("common.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[t._l(t.list,(function(e){return s("van-cell",{key:e.user_id,staticClass:"user-item",on:{click:function(s){return t.viewProjectDetail(e.user_id)}}},[s("div",{staticClass:"list-top"},[s("div",{staticClass:"avatar"},[s("van-image",{staticClass:"avatar",attrs:{src:e.user_info.avatar||t.defaultAvatar,fit:"fill",round:""}})],1),s("div",{staticClass:"content-title"},[s("div",{staticClass:"title-top"},[s("div",{staticClass:"title-top-left"},[s("cl-custom-user",{attrs:{type:e.user_info.sourceType,"data-type":"userName",value:e.user_info.userId,name:e.user_info.name}})],1),s("div",{staticClass:"title-top-right"},[s("van-progress",{staticClass:"progress-box",attrs:{percentage:e.process,"stroke-width":"4","show-pivot":!1}}),s("div",{staticClass:"progress-content-title"},[t._v(t._s(e.process)+"%")])],1)]),s("div",{staticClass:"title-bottom"},[s("div",{ref:"department",refInFor:!0,class:e.isShowMore?"content ellipsis":"content"},[t._v(t._s(e.department))]),e.showExchangeButton?s("div",{staticClass:"packUp"},[s("div",{on:{click:function(s){return s.stopPropagation(),t.showTotalIntro(e)}}},[s("span",{staticClass:"packUp-title"},[t._v(t._s(e.isShowMore?t.$t("attestation.open"):t.$t("attestation.retract")))]),e.isShowMore?s("van-icon",{attrs:{name:"arrow-down"}}):t._e(),e.isShowMore?t._e():s("van-icon",{attrs:{name:"arrow-up"}})],1)]):t._e()])])]),"task"===t.activeTab?s("div",{staticClass:"list-bottom"},[s("SvgIcon",{attrs:{size:12,"icon-class":"icon-datishichang1",color:"#BFBFBF"}}),s("span",{staticClass:"time-title"},[t._v(t._s(t.$t("project.learnLimit"))+":")]),s("span",{staticClass:"time-start-end"},[t._v(t._s(t.handleDate(+new Date(e.star_time),+new Date(e.end_time))))])],1):t._e()])})),t.finished&&0===t.list.length?s("van-empty",{attrs:{description:t.$t("common.noDataTextTip")}}):t._e()],2),s("clSelectDepartment",{attrs:{show:t.showModal},on:{hide:t.hideModal,onOk:t.onOk}})],1)}),[],!1,null,"64babd3f",null).exports},54964:(t,e,s)=>{s.r(e),s.d(e,{default:()=>v});var a=s(95082),i=(s(73474),s(74755)),o=(s(47163),s(21469)),r=(s(25773),s(35791)),n=(s(74916),s(15306),s(92130)),c=s(76953),l=s(27484),u=s.n(l),d=s(25042),h=s(94864),p=s(26294),m=s(70315),g={name:"StudyList",components:{[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,ClDateSelect:n.Z,ClChooseUser:c.Z},data:function(){return{departments:[],learners:[],qy_we_chat_vo:"",operateStatus:"loading",showOperateTip:!1,remainAssignNumber:-1,selectedCount:0,showOrg:!1,config:{multiple:!0,pickedUsers:[],disabledUsers:[],pickedDepartments:[],disabledDepartments:[],requiredDepartments:[],requiredUsers:[],responseUserOnly:!1},loading:!1,timeValue:new Date,showModal:!1,selfChoosedDate:"",choosedDateRange:-1,courseId:"",projectId:"",queryType:""}},computed:(0,a.Z)({themeColor(){return this.$store.state.themeColor.primaryColor},paramsLegal(){return this.selectedCount>0&&(-1!==this.choosedDateRange||this.selfChoosedDate)}},(0,p.mapGetters)({userInfo:"user/getUserInfo",qyWechatBook:"setting/getQyWechatBook"})),mounted(){const{courseId:t,project_id:e,queryType:s}=this.$route.query;this.courseId=t,this.queryType=s,this.projectId=e},methods:{closeDateSelect(){this.showModal=!1},selectDate(t){t.getTime()<(new Date).getTime()?this.$toast(this.$t("course.invalidTimeSetting")):(this.selfChoosedDate=u()(t).format("YYYY-MM-DD HH:mm"),this.timeValue=t,this.choosedDateRange=-1,this.closeDateSelect())},showDateModal(){this.showModal=!0},chooseDateRange(t){this.choosedDateRange=Number(t),this.timeValue=new Date,this.selfChoosedDate=""},handelOk(t){const e=t.selectedCount||0;this.departments=t.departments,this.learners=t.users,this.qy_we_chat_vo=t.qyWeChatVo||"",this.selectedCount=e,this.remainAssignNumber-=e,this.showOrg=!1},handleCancel(){this.showOrg=!1},async getAssignedUser(){const t=await d.Z.courseAssignedUser(this.courseId);0!==t.data.remainder_count?(this.remainAssignNumber=t.data.remainder_count,this.showChoosePeople(t.data)):this.$toast(this.$t("course.assignQuotaTips"))},showChoosePeople(t){const e={requiredUsers:t.learners,pickedUsers:this.learners,pickedDepartments:this.departments};-1!==t.remainder_count&&(e.maxUsers=t.remainder_count,e.limitTips=this.$t("course.assignQuotaTips")),"wx_app"===this.userInfo.appType&&"1"===this.userInfo.authorityType?this.handleSelectWx():(this.config=(0,a.Z)((0,a.Z)({},this.config),e),this.showOrg=!0)},handleSelectWx(){const t=(this.learners||[]).map((t=>t.unionid||t.openUserId||t.id));m.Z.chooseUserByWx({userIds:t}).then((t=>{m.Z.userHandler(t).then((({users:t,departments:e,selectedCount:s,qyWeChatVo:a})=>{this.handelOk({users:t,departments:e,selectedCount:s,qyWeChatVo:a})}))}))},async assignPeople(){let t="";t=-1===this.choosedDateRange?this.selfChoosedDate:this.getFewWeekDay();if(u()(t).valueOf()<(new Date).getTime())return void this.$toast(this.$t("course.invalidTimeSetting"));this.$toast.loading({duration:0,message:this.$t("common.uploading"),loadingType:"spinner",forbidClick:!0});const e=this.departments.map((t=>t.id)),s=this.learners.map((t=>t.id)),a="wx_app"===this.userInfo.appType&&"1"===this.userInfo.authorityType;try{if("course"===this.queryType)await h.Z.courseAssign(this.courseId,{end_time:t,departments:e,learners:s,qy_we_chat_vo:this.qy_we_chat_vo,qy_we_supe_vo:a?{userList:[{unionid:this.userInfo.unionid,id:this.userInfo.userId,openUserid:this.userInfo.unionid,sourceType:"wx_sync"}],selectedUserCount:1,selectedTicket:"0"}:""});else{const i={assign_config:{begin_time:(new Date).getTime(),end_time:new Date(t.replace(/-/g,"/")).getTime()},assign_object:{user_list:a?[]:s,post_list:[],department_list:e,group_list:[]}};await d.Z.projectAssign(this.projectId,i)}this.$toast.clear(),this.$toast(this.$t("course.assignSuccess")),this.$router.go(-1)}catch(t){this.$toast(this.$t("course.assignFail"))}},getFewWeekDay(){const t=7*(this.choosedDateRange+1)*24*3600*1e3,e=(new Date).getTime();return u()(e+t).format("YYYY-MM-DD HH:mm")}}},v=(0,s(1001).Z)(g,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"projectAssign_assignLearner_bg cl-page-container"},[s("div",{staticClass:"ProjectAssign_assignLearner"},[s("div",[t._v(t._s(t.$t("course.assignStudents")))]),s("div",{staticClass:"direction-icon",on:{click:function(e){return t.getAssignedUser()}}},[s("span",{staticClass:"selected-count",style:"color: "+t.themeColor},[t._v(t._s(t.selectedCount)+t._s(t.$t("course.people")))]),s("svg-icon",{attrs:{"icon-class":"icon-chakanpaiming",color:"#B1B5C6",size:12}})],1)]),s("div",{staticClass:"assign-container"},[s("div",{staticClass:"top-time-choose"},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("course.selectExecutionInterval")))]),s("div",{staticClass:"time-choose-container"},t._l([1,2,3],(function(e,a){return s("div",{key:String(a),class:"time-choose-one "+(t.choosedDateRange===a?"active":""),style:t.choosedDateRange===a?{border:"1px solid "+t.themeColor,background:""+t.themeColor,color:"#ffffff"}:{},on:{click:function(e){return t.chooseDateRange(a)}}},[t._v(" "+t._s(e)+t._s(t.$t("course.week"))+" ")])})),0)]),s("div",{staticClass:"self-choose-time",on:{click:t.showDateModal}},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("course.end")))]),t.selfChoosedDate?s("div",{class:"time "+(-1!==t.choosedDateRange?"disabled":""),style:"color: "+t.themeColor.primaryColor},[t._v(" "+t._s(t.selfChoosedDate)+" ")]):t._e(),s("div",{staticClass:"direction-icon"},[s("svg-icon",{attrs:{"icon-class":"icon-chakanpaiming",color:"#B1B5C6",size:12}})],1)]),s("div",{staticClass:"bottom-operate"},[t.remainAssignNumber>=0?s("div",{staticClass:"tip"},[t._v(t._s(t.$t("course.assignTips"))+":"+t._s(t.remainAssignNumber))]):t._e(),s("van-button",{staticClass:"bottom-btn",attrs:{plain:!t.paramsLegal,type:"info",disabled:!t.paramsLegal,color:t.themeColor},on:{click:function(e){return t.assignPeople()}}},[t._v(" "+t._s(t.$t("buttons.confirm"))+" ")])],1),s("Cl-date-select",{attrs:{"show-modal":t.showModal,"time-value":t.timeValue},on:{onCancel:t.closeDateSelect,onConfirm:t.selectDate}}),s("van-popup",{style:{height:"100%"},attrs:{position:"bottom","close-on-popstate":!0,"close-on-click-overlay":!1,"safe-area-inset-bottom":!0},model:{value:t.showOrg,callback:function(e){t.showOrg=e},expression:"showOrg"}},[t.showOrg?s("Cl-choose-user",{attrs:{config:t.config},on:{onSuccess:t.handelOk,cancel:t.handleCancel}}):t._e()],1)],1)])}),[],!1,null,"aa23878e",null).exports},83867:(t,e,s)=>{s.d(e,{Z:()=>o});var a=s(14171),i={components:{},props:{info:{type:Object,default:()=>{}},isEllipsis:{type:String,default:""}},computed:{learningRequirementsTips:()=>t=>a.Z.project.learningRequirementsTips(t)}},o=(0,s(1001).Z)(i,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return""!==t.learningRequirementsTips(t.info)?s("div",{staticClass:"container"},[s("span",{staticClass:"learn-name"},[t._v(t._s(t.$t("project.learningRequirementsTips"))+"：")]),s("span",{class:[t.isEllipsis?"word-ellipsis":"learn-ellipsis"]},[t._v(t._s(t.learningRequirementsTips(t.info)))])]):t._e()}),[],!1,null,"44fcaca4",null).exports},81559:(t,e,s)=>{s.r(e),s.d(e,{default:()=>H});s(31960);var a=s(10993),i=(s(31146),s(41610)),o=(s(34837),s(39146)),r=s(95082),n=(s(73474),s(74755)),c=(s(52355),s(29233)),l=(s(26699),s(32023),s(74916),s(15306),s(85827),s(33948),s(30541),s(57658),s(26294)),u=s(62527),d=s(78551),h=(s(31968),s(3809)),p=(s(47601),s(44951)),m=(s(56977),s(95969)),g=s(83867),v=s(78368),f=s(25042),y=s(27632),_=s(45877),C=s(22648),I=s(49642),b=s(17780),w=s(68092),$={components:{[p.Z.name]:p.Z,[h.Z.name]:h.Z,SvgIcon:d.Z,LearnRequireTip:g.Z,ClCustomUser:_.Z,privateRatingModal:I.Z},props:{dataInfo:{type:Object,default:()=>({})},themeColor:{type:String,default:""},courseType:{type:String,default:""},studyId:{type:String,default:""},conversationId:{type:String,default:""},isView:{type:Boolean,default:!1}},data:()=>({defaultAvatar:v,studyTip:"",examTip:"",operationTip:"",evaluationTip:"",env:"",studyRecordTotal:"",hideTipInfo:!0,isWuhan:["medu.wuhanrt.com"].includes(location.host),canShowWuhanModal:!1,showSubmit:!0}),computed:{saveMoney(){return(100*Number(this.dataInfo.official_price_str)-100*Number(this.dataInfo.preferential_price_str))/100},formatTime:()=>t=>(0,C.p6)(t,"yyyy-MM-dd  hh:mm"),isShowLearnRequire:()=>(0,w.eY)("HIDE_QUALIFICATION_CRITERIA"),rateNumber(){return this.isWuhan?(this.dataInfo.score/100).toFixed()/2:0===this.dataInfo.score?5:this.dataInfo.score},wuhanScore(){return(this.dataInfo.score/100).toFixed(2)}},watch:{studyId(){this.studyId&&this.getStudyRecord(this.studyId)}},mounted(){this.env=y.Z.env},methods:{hideTip(){this.hideTipInfo=!1},getStudyRecord(t){const{studyRecords:e}=f.Z;e(t).then((t=>{this.studyRecordTotal=t.data.total}))},previewCertificate(){this.$emit("previewCertificate")},showAppraiseModal(){this.isWuhan?this.canShowWuhanModal=!0:this.$emit("showRatingModel")},toStudyingPeopleList(){this.$router.push(m.Z.studyProject.studyingPeopleList({courseId:this.studyId,courseResource:"project"}))},checkOfflineCouse(){let t=!1;const{dataInfo:{stages:e}}=this;let s=!1;for(let a=0;a<e.length&&!s;a++)for(let i=0;i<e[a].resources.length;i++){const{courseType:o}=e[a].resources[i];if(13===o||7===o){t=!0,s=!0;break}}return t},assignPeople(){const{studyId:t,dataInfo:e}=this;this.$router.push(m.Z.studyProject.taskAssign({courseId:t,project_id:e.project_id}))},assignedList(){const{dataInfo:t,courseType:e}=this;let s={courseId:this.studyId};"project"===e?(s.courseType="project",s.projectId=t.project_id):s.courseType=e,this.$router.push(m.Z.studyProject.projectNewData(s))},onShareInfo(){this.$emit("onShareInfo")},submitWuhanStar(t){this.$emit("submitStar",200*t),this.showSubmit=!1},isMicroApp:()=>(0,b.xX)()}},k=$,S=s(1001),T=(0,S.Z)(k,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"top-info"},[s("div",{staticClass:"top-info-cover",style:{backgroundImage:"url("+t.dataInfo.cover+")"}},["dingTalk"!==t.env||t.isView||t.isMicroApp()?t._e():s("div",{staticClass:"top-info-share",on:{click:t.onShareInfo}},[s("div",{staticClass:"top-info-share-content"},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-wodefenxiang",color:"#fff",size:14}}),s("div",{staticClass:"top-info-share-word"},[t._v(t._s(t.$t("marketing.shareNumber")))])],1)])]),s("div",{staticClass:"top-info-title"},[t._v(" "+t._s(t.dataInfo.title)+" ")]),"study_project"!==t.dataInfo.type||"false"!==t.dataInfo.have_purchased||t.dataInfo.is_free?t._e():s("div",{staticClass:"top-info-price"},[s("div",{staticClass:"top-info-price-new"},[s("div",{staticClass:"top-info-price-new-single"},[t._v("￥")]),s("div",{staticClass:"top-info-price-new-large"},[t._v(t._s(t.dataInfo.preferential_price_str))])]),Number(t.dataInfo.official_price_str)>0?s("div",{staticClass:"top-info-price-old"},[t._v(" ￥"+t._s(t.dataInfo.official_price_str)+" ")]):t._e(),t.saveMoney>0?s("div",{staticClass:"top-info-price-offline"},[t._v(" "+t._s(t.$t("project.provincial"))+t._s(t.saveMoney.toFixed(2))+t._s(t.$t("payment.yuan"))+" ")]):t._e()]),s("div",{staticClass:"top-info-other"},[s("div",{staticClass:"top-info-other-left"},[t.dataInfo.assignor_name?s("div",{staticClass:"top-info-other-creator"},[s("van-image",{attrs:{round:"",width:"24px",height:"24px",src:t.dataInfo.avatar||t.defaultAvatar}}),s("div",{staticClass:"teacher"},[s("cl-custom-user",{attrs:{type:t.dataInfo.assignor_sync_source_type,"data-type":"userName",value:t.dataInfo.assignor_sync_user_id,name:t.dataInfo.assignor_name}})],1)],1):t._e(),s("div",{staticClass:"top-info-other-count"},[t._v(" "+t._s(t.$t("project.trainingContent"))+" "+t._s(t.dataInfo.resource_count)+" ")]),"normal"!==t.dataInfo.status||t.isView?t._e():s("div",{staticClass:"studying",on:{click:t.toStudyingPeopleList}},[s("div",{staticClass:"count"},[s("span",[t._v(t._s(t.$t("discovery.peopleLearning"))+" "+t._s(t.studyRecordTotal))]),s("svg-icon",{staticClass:"iconfont info_studying",attrs:{"icon-class":"icon-chakanpaiming",color:"#D9DBE4",size:12}})],1)])]),t.dataInfo&&0!==t.dataInfo.award_score?s("div",{staticClass:"top-info-other-right"},[t._v(" "+t._s(t.dataInfo.award_score)+t._s(t.$t("pointsMall.credits"))+" ")]):t._e()]),s("div",{staticClass:"appraise"},[t.dataInfo.score>=0?s("div",{staticClass:"appraise-score"},[s("van-rate",{attrs:{"allow-half":"",size:"15",color:t.isWuhan?"#ffa818":t.themeColor,"void-icon":"star","void-color":"#C0C2CB",readonly:""},model:{value:t.rateNumber,callback:function(e){t.rateNumber=e},expression:"rateNumber"}})],1):t._e(),t.isWuhan?s("div",{staticClass:"appraise-rate-text"},[t._v(" "+t._s(t.wuhanScore)+" "+t._s(t.$t("studyProject.score"))+" ")]):t._e(),"false"!=t.dataInfo.graded||t.isView?t._e():s("div",{staticClass:"appraise-text",on:{click:t.showAppraiseModal}},[t._v(" "+t._s(t.$t("course.toRate"))+" "),s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-chakanpaiming",color:"#D9DBE4",size:12}})],1)]),t.isShowLearnRequire?s("div",{staticClass:"top-info-standard"},[s("LearnRequireTip",{attrs:{info:t.dataInfo}})],1):t._e(),t.dataInfo.summary?s("div",{staticClass:"top-info-summary"},[t._v(t._s(t.$t("task.projectInstruction"))+"："+t._s(t.dataInfo.summary))]):t._e(),!t.dataInfo.award_score&&!t.dataInfo.certificate_name||t.isView?t._e():s("div",{staticClass:"top-info-reward"},[t._v(t._s(t.$t("project.qualifyingRewards"))+"："),0!==t.dataInfo.award_score?s("span",[t._v(t._s(t.dataInfo.award_score)+t._s(t.$t("pointsMall.credits")))]):t._e(),0!==t.dataInfo.award_score&&t.dataInfo.certificate_name?s("span",[t._v("，")]):t._e(),t.dataInfo.certificate_name?s("span",{staticClass:"top-info-reward-certi",on:{click:t.previewCertificate}},[t._v("《"+t._s(t.dataInfo.certificate_name)+"》")]):t._e()]),"camp_period"===t.dataInfo.type&&"false"===t.dataInfo.is_registration&&"true"===t.dataInfo.in_registration_time?s("div",{staticClass:"top-info-apply-time"},[t._v(" "+t._s(t.$t("project.registrationTime"))+"："+t._s(t.dataInfo.registration_start_time)+" - "+t._s(t.dataInfo.registration_end_time)+" ")]):t._e(),s("div",["true"===t.dataInfo.is_task?s("p",{staticClass:"top-info-time-limit"},[t._v(t._s(t.$t("project.learnLimit"))+"："+t._s(t.formatTime(t.dataInfo.task_begin_time))+" ~ "+t._s(t.formatTime(t.dataInfo.task_end_time)))]):t._e(),"open"===t.dataInfo.enroll_opened_status?s("p",{staticClass:"top-info-time-limit"},[t._v(t._s(t.$t("project.registrationLimit"))+"："),t.dataInfo.enrollment_begin_time&&t.dataInfo.enrollment_end_time?s("span",[t._v(t._s(t.formatTime(t.dataInfo.enrollment_begin_time))+" ~ "+t._s(t.formatTime(t.dataInfo.enrollment_end_time)))]):t._e(),t.dataInfo.enrollment_begin_time&&t.dataInfo.enrollment_end_time?t._e():s("span",[t._v(t._s(t.$t("project.noLimit")))])]):t._e()]),t.conversationId||"true"!==t.dataInfo.assign&&"true"!==t.dataInfo.track||t.isView?t._e():s("div",{staticClass:"course-track-assign"},[s("div",{staticClass:"assign",on:{click:t.assignPeople}},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-track",color:"#7F849A",size:14}}),s("span",[t._v(t._s(t.$t("project.taskMonitor")))])],1),s("div",{staticClass:"track",on:{click:t.assignedList}},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-doning2",color:"#7F849A",size:14}}),s("span",[t._v(t._s(t.$t("project.dataMonitor")))])],1)]),t.dataInfo.ding_img_url?s("div",{staticClass:"qr-img"},[s("div",{staticClass:"qr-img-left"},[t._v(t._s(t.$t("course.communication"))+" "),s("div",{staticClass:"qr-img-left-tips"},[t._v(t._s(t.$t("course.joinCommunication")))])]),t.isView?t._e():s("div",{staticClass:"qr-img-right",on:{click:t.handlePreviewExchangeGroup}},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-erweima",color:"#7F849A",size:30}}),s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-chakanpaiming",color:"#4D536E",size:12}})],1)]):t._e(),"true"===t.dataInfo.sync_progress?s("div",{staticClass:"sync-tip"},[t._v(t._s(t.$t("common.openSync")))]):t._e(),t.canShowWuhanModal?s("private-rating-modal",{attrs:{edit:t.showSubmit},on:{onSubmit:t.submitWuhanStar,cancelModal:function(e){t.canShowWuhanModal=!1}}}):t._e()],1)}),[],!1,null,"43da6a68",null).exports,Z=s(73641),x=(s(25773),s(35791)),P=s(57969),D=s(23279),L=s.n(D),A={components:{SvgIcon:d.Z,[x.Z.name]:x.Z},props:{dataInfo:{type:Object,default:()=>{}},whiteList:{type:Object,default:()=>{}},wxContext:{type:String,default:""},accountConfigured:{type:String,default:""},studyId:{type:String,default:""},isView:{type:Boolean,default:!1},showRegister:{type:Boolean,default:!1}},data:()=>({totalComments:0,tag:"stop",isDisabled:!1,fadeIn:!1}),computed:{renderOption(){let t="option-btn";const{dataInfo:{is_start_study:e},whiteList:s,wxContext:a}=this;return e&&"true"===e||s.teamBuy&&"miniProgram"===a?t:"option-btn more-padding"},showDisabled(){return this.isDisabled?"#BDC0CE":this.themeColor},isIpx:()=>(0,C.Rq)(),themeColor(){return this.$store.state.themeColor.primaryColor},setButtonText(){const{project_id:t,limit_count:e}=this.dataInfo;let s=e?`(${P.Z.t("project.limitPeopleNum",{key:e})})`:"",a={name:`${this.$t("project.register")}${s}`,class:"action-bar__study",click:null};switch(this.getTag(),this.tag){case"registercampPay":a.click=this.freeOrPay;break;case"registerNow":a.type="registerNow";break;case"registerFreeOrPay":a.type="campPeriodsPay";break;case"registerClosed":a.name=this.$t("project.registrationEnded"),a.class="action-bar__waiting";break;case"againStudy":a.name=this.$t("project.againStudy"),a.type="againToStudy";break;case"continueStudy":a.name=this.$t("project.continueStudy"),a.type="continueToStudy";break;case"startStudy":a.name=this.$t("project.startStudy"),a.type="startLinkTo";break;case"registerStatusReject":a.name=this.$t("project.registerRefused"),a.class="action-bar__waiting",a.type="registerStatusReject";break;case"registrationApproval":a.name=this.$t("project.approving"),a.class="action-bar__waiting";break;case"registrationIsFull":a.name=this.$t("project.quotaFull"),a.class="action-bar__waiting";break;case"registrationNotStart":a.name=this.$t("project.registrationNotStarted"),a.click=this.onRegistrationTip,a.params=this.$t("project.enrollNotStartTip");break;case"registrationEnd":a.name=this.$t("project.registrationEnd"),a.click=this.onRegistrationTip,a.params=this.$t("project.enrollEndTip");break;case"stop":a.name=this.$t("project.deactivated");break;case"buyNow":a.name=this.$t("discovery.buyNow"),a.click=this.payStudyProject,a.params={project_id:t,payType:"STUDY_PROJECT"},this.$emit("showPayModel",!0)}return a}},watch:{studyId(){this.studyId&&this.getCommentList()},showRegister:{handler(t){t&&setTimeout((()=>{this.fadeIn=!0}),10)}}},methods:{hiddenTip(){this.fadeIn=!1,this.$emit("hideRegisterTip",!1)},getCommentList(){f.Z.initGetCourseComment({courseId:this.studyId}).then((t=>{this.totalComments=t.data.total}))},onRegistrationTip(t){this.$toast({message:t})},toCommonTarget(t){"function"==typeof t.click?t.click(t.params?t.params:null):this.$emit("clickAction",{type:t.type})},getTag(){const{status:t,type:e}=this.dataInfo;"normal"===t&&("study_project"===e?this.renderProjectButton():this.renderCampButton())},renderStartOrContinue(){const{is_start_study:t,study_progress:e,is_task:s,task_begin_time:a,task_end_time:i}=this.dataInfo;s&&(new Date).getTime()<a&&(this.isDisabled=!0),s&&(new Date).getTime()>i&&(this.isDisabled=!0),this.tag="false"===t?"startStudy":e<100?"continueStudy":"againStudy"},renderCampButton(){const{have_purchased:t,in_registration_time:e,is_registration:s}=this.dataInfo;"true"===t||"true"===s?this.renderStartOrContinue():this.tag="false"===e?"registerClosed":"registercampPay"},renderProjectButton(){const{camp_periods:t,is_free:e,enroll_status:s,have_purchased:a,enrollment_begin_time:i,enrollment_end_time:o,enroll_opened_status:r}=this.dataInfo;let n=e&&"pass"===s||"true"===a;0!==t.length?this.tag="registerFreeOrPay":n&&"pass"===s?this.renderStartOrContinue():"pass"!==s?"reject"===s?this.tag="registerStatusReject":"wait"===s?this.tag="registrationApproval":"stop"===s?this.tag="registrationIsFull":i&&i>(new Date).getTime()?(this.isDisabled=!0,this.tag="registrationNotStart"):o&&(new Date).getTime()>o?(this.isDisabled=!0,this.tag="registrationEnd"):(r&&(i&&(new Date).getTime()<i&&(this.isDisabled=!0),o&&(new Date).getTime()>o&&(this.isDisabled=!0)),this.tag="registerNow"):e||(this.tag="buyNow")},onTeamBuyClick(){this.$emit("onTeamBuyClick")},payStudyProject({project_id:t,payType:e}){let s="wx"===this.accountConfigured&&"alipay"===y.Z.env;"STUDY_PROJECT"!==e||"alipay"===y.Z.env?("noBind"===this.accountConfigured||s)&&(this.$total(this.$t("payment.notAccount")),this.$emit("campGoodsPay",{type:e,campId:t})):this.$emit("clickAction",{type:"studyProjectPay",payType:e})},freeOrPay(){const{is_free:t,project_id:e}=this.dataInfo;t?this.$emit("clickAction",{type:"campFreeOperate",project_id:e}):this.payStudyProject(this.dataInfo.project_id,"STUDY_PROJECT_CAMP_PERIOD")},handlePraise:L()((function(){const{dataInfo:t,studyId:e,$emit:s}=this;let a=t;const{EnterpriseCourseCommentPraise:i}=f.Z;i(e,"like"===t.like_status?"unlike":"like").then((t=>{"like"===t.data.status?(a.like_count+=1,a.like_status="like"):(a.like_count-=1,a.like_status="unlike"),s("changeProjectInfo",a)}))}),1e3),pageScrollComment(){let t=document.querySelector(".project-detail").getBoundingClientRect().bottom;window.scrollTo(0,t)}}},E=(0,S.Z)(A,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.isView?t._e():s("div",{staticClass:"study-project-action-bar"},[s("div",{staticClass:"action-bar-container"},[t.dataInfo&&t.dataInfo.is_start_study?s("div",{class:[t.isIpx?"action-bar active":"action-bar"]},[s("div",{staticClass:"counts",on:{click:t.pageScrollComment}},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-talk",color:"#7F849A",size:18}}),s("span",{staticClass:"num"},[t._v(" "+t._s(t.totalComments))])],1),s("div",{staticClass:"counts",on:{click:t.handlePraise}},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-zan",color:"like"===t.dataInfo.like_status?"#df6666":"#7F849A",size:18}}),s("span",{staticClass:"num"},[t._v(t._s(t.dataInfo.like_count))])],1),t.dataInfo.is_start_study&&"true"===t.dataInfo.is_start_study?s("div",{staticClass:"action-bar__progress"},[s("span",[t._v(t._s(t.$t("attestation.progress"))+"：")]),s("span",{staticClass:"percent"},[t._v(t._s(t.dataInfo.study_progress)+"%")])]):t._e(),t.whiteList.teamBuy&&"miniProgram"===t.wxContext?s("div",{staticClass:"option-btn"},[s("van-button",{style:{color:t.themeColor,borderColor:t.themeColor},attrs:{type:"default"},on:{click:t.onTeamBuyClick}},[t._v(t._s(t.$t("project.teamPayBut")))])],1):t._e(),s("div",{class:t.renderOption},[s("van-button",{attrs:{color:t.showDisabled},on:{click:function(e){return t.toCommonTarget(t.setButtonText)}}},[t._v(t._s(t.setButtonText.name))])],1)]):t._e(),t.showRegister?s("div",{class:[t.fadeIn?"register-success-tip active":"register-success-tip"]},["wait"===t.dataInfo.enroll_status?s("div",{staticClass:"register-name"},[t._v(t._s(t.$t("project.registerWaitTip")))]):s("div",{staticClass:"register-name"},[t._v(t._s(t.$t("project.registerPassTip")))]),s("div",{staticClass:"register-know",on:{click:t.hiddenTip}},[t._v(t._s(t.$t("practice.gotIt")))])]):t._e()])])}),[],!1,null,"3741d9c1",null).exports,R=s(99803),F=s(14171),q=s(46730),N={components:{SvgIcon:d.Z},props:{dataInfo:{type:Object,default:()=>{}}},data:()=>({campIndex:0}),computed:{themeColor(){return this.$store.state.themeColor.primaryColor},countTime:()=>t=>`${(0,C.p6)(t.start_time,"yyyy-MM-dd  hh:mm")}～${(0,C.p6)(t.end_time,"yyyy-MM-dd  hh:mm")}`},methods:{closeCamp(){this.$emit("closeCamp")},selectCampFn(){this.$emit("onSelectCamp",this.dataInfo.camp_periods[this.campIndex])},setCamp(t){this.campIndex=t}}},O=(0,S.Z)(N,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"select-camp-mask"},[s("div",{staticClass:"select-camp-inner"},[s("div",{staticClass:"select-camp-title"},[s("div",[t._v(t._s(t.$t("course.chooseCamp")))]),s("div",{on:{click:t.closeCamp}},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-fault",color:"#9C9C9F",size:12}})],1)]),s("div",{staticClass:"select-camp-scroll"},t._l(t.dataInfo.camp_periods,(function(e,a){return s("div",{key:a,class:[t.dataInfo.camp_periods[t.campIndex].id===e.id?"select-camp-scroll-box select-camp-scroll-box-active":"select-camp-scroll-box"],on:{click:function(e){return t.setCamp(a)}}},[s("div",{staticClass:"select-camp-scroll-box-top"},[s("div",{staticClass:"select-camp-scroll-box-top-left"},[t._v(t._s(e.title))]),e.is_free?s("div",{staticClass:"select-camp-scroll-box-top-price"},[t._v(t._s(t.$t("course.free")))]):s("div",{staticClass:"select-camp-scroll-box-top-price"},[t._v(t._s("￥"+(e.preferential_price/100).toFixed(2)))])]),s("div",{staticClass:"select-camp-scroll-box-time"},[t._v(t._s(t.$t("signIn.schoolTime"))+"："+t._s(t.countTime(e)))])])})),0),s("div",{staticClass:"select-camp-button"},[s("div",{staticClass:"select-camp-button-real",style:{background:t.themeColor},on:{click:t.selectCampFn}},[t._v(" "+t._s(t.$t("buttons.confirm"))+" ")])])])])}),[],!1,null,"2f205a22",null).exports,M=s(68915),B=s(67992),V=s(1313),U=s(17452),j=s(85566),z={name:"ProjectDetail",components:{TopInfo:T,Stages:Z.Z,ActionBar:E,SvgIcon:d.Z,CourseComment:R.Z,RatingModal:u.Z,PayModal:q.Z,SelectCamp:O,[c.Z.name]:c.Z,[n.Z.name]:n.Z},beforeRouteEnter(t,e,s){"/face-jump"===e.path||"success"===e.query.faceStatus?s((t=>{t.$store.commit("face/updateUrl",{fromSource:"vue",faceStatus:"success"}),t.$store.commit("studyProject/setAlertPreventHangModal",!0)})):s()},beforeRouteLeave(t,e,s){if("/home-module/home-search"===t.path||"/home-module/search-result"===t.path||t.path.includes("/project-sky")||t.path.includes("/project-desert")||"/course-all"===t.path||"/course-search"===t.path||"/comment-all"===t.path||"/home-module"===t.path||"/knowledge"===t.path||"/mine/myself-study"===t.path||"/mine/mine-notice/message-page"===t.path||"/classify-course"===t.path||"/home-module/training-program"===t.path||"/face"===t.path||"/home-module/task/list"===t.path||"/post-study-plan"===t.path||"/points-detail"===t.path)e.meta.studyId="",this.$store.commit("noKeepAlive","ProjectDetail"),this.$store.commit("face/updateUrl",{fromSource:"vue",faceStatus:"idle"}),this.routeChange=!0,this.$store.commit("studyProject/setAlertPreventHangModal",!0);else{e.meta.studyId=this.studyId,this.$store.commit("isKeepAlive","ProjectDetail");const t=document.querySelector(".project-detail"),s=t?t.scrollTop:0;e.meta.scrollTop=s,this.$store.commit("studyProject/setAlertPreventHangModal",!1)}s()},data:()=>({studyId:"",dataInfo:{},studyRecordTotal:0,commentInfo:{list:[],total:0},wxContext:"",accountConfigured:"",showRating:!1,star:"",studyStatus:"",hasTipPreventHangModal:!1,fromType:"",showProjectGuide:!1,assignProjectCheck:!1,showAssignedGuide:!1,showSelectCampPeriod:!1,loading:!1,appraiseFlag:!1,showPayModal:!1,teamPayFlag:!1,whiteList:{},showPayType:"all",conversationId:"",campOrderPayStatus:"",integralInfo:"",payResult:"",resourceItem:"",isPrueH5:"h5"===y.Z.pureEnv&&"app"!==y.Z.env,hasSetFace:!1,studySetData:{},routeChange:!1,isShowPayModel:!1,showPicker:!1,isRegister:!1,showRegister:!1,filterType:["xlsx","pdf","doc","pptx","txt","article","png","mp4","mp3","image","scorm","html","link","liveClass","course","evaluation","docx","micro_course","imageText","xls","jpeg","jpg","h5","ppt","ddi"]}),computed:(0,r.Z)((0,r.Z)((0,r.Z)((0,r.Z)((0,r.Z)({themeColor(){return this.$store.state.themeColor.primaryColor},userInfo(){return this.$store.state.commonParams}},(0,l.mapState)("setting",["enterpriseWhiteAndBlackList"])),(0,l.mapState)("face",["faceStatus"])),(0,l.mapState)("studyProject",["isAlertPreventHangModal"])),(0,l.mapGetters)({fresh:"microCourse/getFreshStatus"})),{},{isView(){return"dataMonitor"===this.$route.query.sourcePage}}),watch:{fresh(t){t&&"/project-detail"===this.$route.path&&(this.$nextTick((()=>{this.initLoadData()})),this.$store.commit("microCourse/updateFresh",!1))},studyId(t){t&&this.initTopThreeComment()}},activated(){const{isGo:t}=this.$route.query;"1"===t&&history.go(-3),this.$nextTick((()=>{this.initLoadData(),setTimeout((()=>{const{scrollTop:t}=this.$route.meta,e=document.querySelector(".project-detail");t&&e&&(e.scrollTop=t)}),200)}))},mounted(){const{studyStatus:t,fromType:e="",conversationId:s,studyId:a}=this.$route.query;if(this.whiteList={teamBuy:(0,w.UI)("STUDY_PROJECT_TEEM_BUY"),list:this.enterpriseWhiteAndBlackList},!this.initVerificate())return!1;this.accountInfoConfigured(),this.studyId=a,this.$nextTick((()=>{this.$route.meta.studyId&&(this.studyId=this.$route.meta.studyId)})),this.studyStatus=t,this.fromType=e,this.loading=!0,this.conversationId=s,this.initLoadData()},beforeDestroy(){this.$toast.clear(),this.$dialog.close()},methods:{showPayModel(t){this.isShowPayModel=t},initLoadData(){const{conversationId:t}=this;this.showPicker=!1,"checking"!==this.faceStatus&&o.Z.loading({message:this.$t("common.loading")}),this.$nextTick((()=>{t?this.getGroupTaskDetail(!0):this.initData(!0)}))},initVerificate(){const{eid:t}=this.$route.query,{isPrueH5:e}=this,{enterpriseId:s}=this.userInfo;let a=!0;if(e){let e=navigator.userAgent.toLowerCase().indexOf("dingtalk")>-1,i=navigator.userAgent.toLowerCase().indexOf("micromessenger")>-1;if((e||i)&&(t||window.location.replace(`${window.location.href}&eid=${s}`)),i){let t="officialAccounts";"wechat_h5"===y.Z.env&&y.Z.getEnv({},(e=>{t=e.miniprogram?"miniProgram":"officialAccounts",this.wxContext=t}))}s||(y.Z.navigateTo({url:m.Z.common.toLogin()}),a=!1),t&&s!==t&&(y.Z.navigateTo({url:m.Z.common.toLogin()}),a=!1)}return a},onRegistrationTip(t){this.$toast({message:t})},clickAction(t){switch(t.type){case"registerNow":this.handleRegisterNow();break;case"campPeriodsPay":this.onCampPeriodsPay();break;case"againToStudy":this.onAgainToStudy();break;case"continueToStudy":this.onContinueToStudy();break;case"startLinkTo":this.onStartAndLinkTo();break;case"campFreeOperate":this.campFreeOperate();break;case"studyProjectPay":this.onStudyProjectPay();break;case"registrationNotStart":this.onRegistrationTip(this.$t("project.enrollNotStartTip"));break;case"registrationEnd":this.onRegistrationTip(this.$t("project.enrollEndTip"))}},catchError({errorInfo:t,cb:e}){if(t&&t.code){let s="";if(t[t.code])if("en"===this.$i18n.locale){let{message:e}=t[t.code];s=e}else{let{content:e}=t[t.code];s=e}else s=this.$t("promptMessage.systemError");i.Z.alert({title:this.$t("promptMessage.warmTips"),message:s}).then((()=>{e&&e()}))}},targetPayResult(t){this.campOrderPayStatus,setTimeout((()=>{m.Z.studyProject.targetPayResult(this.campOrderPayStatus)}),200),this.campOrderPayStatus=t},campGoodsPay({type:t,campId:e}){const{campGoodsPay:s}=f.Z;s(t,e).then((t=>{y.Z.pay({info:t.data.jump_url,success:t=>{"9000"===t.resultStatus?this.targetPayResult("success"):this.targetPayResult("fail")},fail:()=>{this.targetPayResult("fail")}})})).catch((t=>{this.catchError({errorInfo:t.data})}))},onSelectCamp(t){this.showSelectCampPeriod=!1,t.is_free?this.campFreeOperate(t.id):this.campGoodsPay({type:"STUDY_PROJECT_CAMP_PERIOD",campId:t.id})},previewCertificate(){const{getCertificate:t}=f.Z;t(this.dataInfo.certificate_id).then((t=>{(0,a.Z)([t.data.preview_url])}))},closeCamp(){this.showSelectCampPeriod=!1},onTeamBuyClick(){const{showPayType:t}=this.beforePayModal();this.showPayModal=!0,this.teamPayFlag=!0,this.showPayType=t},beforePayModal(){const{accountConfigured:t}=this;let e="all";if("noBind"!==t)return"ali"===this.accountConfigured||y.Z.specialEnv.indexOf("dingTalk")>-1?e="ali":("wx"===this.accountConfigured||y.Z.specialEnv.indexOf("wechat")>-1)&&(e="wx"),{showPayType:e};this.$toast(this.$t("payment.notAccount"))},onStudyProjectPay(){const{showPayType:t}=this.beforePayModal();this.showPayModal=!0,this.teamPayFlag=!1,this.showPayType=t},campFreeOperate(t){const{campFreePay:e}=f.Z;e(t).then((()=>{(0,o.Z)({type:"success",message:this.$t("course.successfulRegistration"),onClose:()=>{const{query:t}=this.$route;t.conversationId?this.getGroupTaskDetail():this.initData()}})}))},onAgainToStudy(){const{dataInfo:t}=this;let e="",s=0,a=0,i=!1;100===t.study_progress&&(new Date).getTime()>t.task_end_time?o.Z.fail(this.$t("project.overdueLearnable")):(t.stages.find(((t,i)=>(e=t.course_list.find(((t,e)=>{let s=("exam"===t.type||"newExam"===t.type)&&t.show_repeat_exam,i="pending"===t.status||"scoring"===t.status;return s&&"failed"===t.status?(a=e,("exam"===t.type||"newExam"===t.type)&&t.show_repeat_exam&&("failed"===t.status||!i)):s?(a=e,("exam"===t.type||"newExam"===t.type)&&t.show_repeat_exam):("exam"===t.type||"newExam"===t.type)&&"inProgress"===t.status})),e&&(s=i),!e))),t.stages.forEach((t=>{i=t.course_list.every((t=>"investigate"===t.type))})),i?o.Z.fail(this.$t("study.notAllowViewTips")):e?this.resourceOnTap((0,r.Z)((0,r.Z)({},e),{},{courseId:e.id,currentStage:t.stages[s],currentResourceIndex:a,currentStageIndex:s})):this.onContinueToStudy(!0))},onCampPeriodsPay(){this.showSelectCampPeriod=!0},onContinueToStudy(t=!1){const{dataInfo:e}=this;let s="",a=0,i=0;if(e.stages.find(((e,o)=>(s=e.course_list.find(((e,s)=>t?("investigate"!==e.type&&"exam"!==e.type&&"newExam"!==e.type&&(i=s),"investigate"!==e.type&&"exam"!==e.type&&"newExam"!==e.type):(e.canStudy&&e.progress<100&&(i=s),("liveClass"!==e.type||"expired"!==e.live_lesson.live_status)&&e.progress<100))),s&&(a=o),void 0!==s))),s){const{task_end_time:n}=e;let c=e.is_task&&(new Date).getTime()>n;if(("exam"===s.type||"newExam"===s.type)&&t&&!c)return void o.Z.fail(this.$t("course.examTips"));this.resourceOnTap((0,r.Z)((0,r.Z)({},s),{},{courseId:s.id,currentStage:e.stages[a],currentResourceIndex:i,currentStageIndex:a}))}else o.Z.fail(this.$t("projectTip.noResource"))},startStudy(t){const{dataInfo:e}=this,{startStudyProject:s}=f.Z;if("camp_period"===e.type){if(!e.stages.map((t=>t.course_list)).reduce(((t,e)=>[...t,...e])).map((t=>t.canStudy)).includes(!0))return void this.$toast(this.$t("course.notUnlocked"))}s(this.studyId).then((s=>{"true"===s.data.result&&(e.is_start_study="true",t&&"function"==typeof t&&t())}))},onStartAndLinkTo(){const{dataInfo:t}=this,{task_end_time:e,task_begin_time:s}=t;return t.is_task&&(new Date).getTime()<s?(this.$toast(this.$t("project.learnNotStartTip")),!1):t.is_task&&(new Date).getTime()>e?(this.$toast(this.$t("project.learnEndTip")),!1):void this.startStudy((()=>{this.onContinueToStudy()}))},handleRegisterNow(){const{dataInfo:t}=this,{enrollment_begin_time:e,enrollment_end_time:s}=t,{query:a}=this.$route,{registerNow:i}=f.Z;if(t.enroll_opened_status){if(e&&(new Date).getTime()<e)return this.$toast(this.$t("project.learnNotStartTip")),!1;if(s&&(new Date).getTime()>s)return this.$toast(this.$t("project.learnEndTip")),!1}i(t.enroll_id).then((()=>{a.conversationId?this.getGroupTaskDetail():(this.isRegister=!0,this.$nextTick((()=>{this.initData()})))}))},closeModal(){this.showPayModal=!1,this.teamPayFlag=!1},showRatingModel(){this.showRating=!0,this.star=5},submitStar(t){const{comment:e}=f.Z;e(this.studyId,t).then((()=>{this.showRating=!1,this.queryProjectDetail()}))},async initData(t){await this.initGetData({isFirst:t})},showPreventHangModal(){const{themeColor:t}=this;this.hasTipPreventHangModal||(this.hasTipPreventHangModal=!0,i.Z.alert({title:this.$t("promptMessage.warmTips"),message:this.$t("promptMessage.preventHangTips"),confirmButtonText:this.$t("promptMessage.roger"),confirmButtonColor:t.primaryColor}).then((()=>{setTimeout((()=>{this.showFaceModel()}),500)})))},showFaceModel(){const{dataInfo:t,faceStatus:e,routeChange:s}=this;if("checking"===e)return!1;"on"!==t.face_recognition||"idle"!==this.faceStatus||s||this.enterFaceTIp()},enterFaceTIp(){(0,B.YQ)({successPath:"",tip1:this.$t("faceKnow.taskFaceKnowTip"),tip2:this.$t("faceKnow.taskFaceKnowTip2"),hasSetFace:this.hasSetFace,typeTip:"studyProject"})},async saveStudyInfo(t){const{student_id:e}=this.$route.query,{getProjectDetail:s}=F.Z.project,{data:a}=s(t.data),i={studyInfo:a},r=(t,e)=>t.findIndex(((t,s)=>s>e&&"latoja"!==t.type));if(i.studyInfo.stages.forEach((t=>{let e=-1;t.course_list.forEach(((s,a)=>{s.formatDuration=0!==s.duration?(0,C.WJ)(s.duration):"",s.canStudy="true"===s.can_start_study,"true"===t.in_order&&("latoja"===s.type?0===a&&(e=r(t.course_list,a)):s.progress>=100?e=r(t.course_list,a):0!==a&&e!==a||(e=a))})),t.canStudyIndex=e})),"checking"!==this.faceStatus&&o.Z.clear(),this.dataInfo=i.studyInfo,this.dataInfo.studentId=e,"camp_period"===this.dataInfo.type&&(this.studyId=this.dataInfo.id),this.integralInfo=i.studyInfo.integral_info,"studyProject"===a.pageSourceType){let t=await this.queryProjectSetting();const{speed_play:e,prevent_drag:s,prevent_cut_screen:a,course_download:i}=t;let o={prevent_drag:s,speed_play:e,prevent_cut_screen:a,course_download:i};this.dataInfo.studyProjectSetData=o}this.conversationId&&(this.studyId=a.course_id)},getGroupTask(){try{const{getGroupTask:t}=f.Z;t(this.conversationId).then((t=>{this.saveStudyInfo(t)}))}catch(t){o.Z.clear()}},async getGroupTaskDetail(t){try{await this.getGroupTask(this.conversationId);const e=this.dataInfo.stages[0].course_list,{id:s}=this.dataInfo;this.studyId=s;const a=e.some((t=>"mp4"===t.type));this.dataInfo.studyProjectSetData.prevent_cut_screen&&a&&t&&this.showPreventHangModal()}catch(t){this.catchError({errorInfo:t.data,cb:()=>y.Z.navigateBack()}),o.Z.clear()}},accountInfoConfigured(){const{accountInfoConfigured:t}=f.Z;t().then((t=>{const e=t.data.data;let s="all";"false"===e.wxpay&&"false"===e.alipay&&(s="noBind"),"false"===e.wxpay&&"true"===e.alipay&&(s="ali"),"true"===e.wxpay&&"false"===e.alipay&&(s="wx"),this.accountConfigured=s}))},submitComment(t){const{submitCourseComment:e}=f.Z;e({courseId:this.studyId,comment:t}).then((t=>{const e=this.commentInfo.list.length;e>=3&&this.commentInfo.list.splice(e-1,1),this.commentInfo.list.unshift((0,r.Z)((0,r.Z)({},t.data),{},{syncSourceType:t.data.sync_source_type,syncUserId:t.data.sync_user_id})),this.commentInfo.total=1+this.commentInfo.total,this.courseDetails.commentCount=1+this.courseDetails.commentCount,this.$toast.success(this.$t("promptMessage.sendSuccessfully"))}))},async initTopThreeComment(){let t=await f.Z.initGetCourseComment({courseId:this.studyId});this.commentInfo={list:t.data.list.map((t=>(0,r.Z)((0,r.Z)({},t),{},{syncSourceType:t.sync_source_type,syncUserId:t.sync_user_id}))),total:t.data.total}},goStudyProjectModuleBus(t,e){const s=t&&t.toLowerCase(),a=!!String(e.all_checked).length&&e.all_checked,i=e.from&&"faceJump"===e.from?this.faceStatus:"";"star"===s?(o.Z.clear(),(0,U.B)({path:`/project-sky/${e.studyId}/${e.projectId}/${a}/${e.courseIds||0}`,query:{faceStatus:i}},"app1")):"desert"===s?(o.Z.clear(),(0,U.B)({path:`/project-desert/${e.studyId}/${e.projectId}/${a}/${e.courseIds||0}`,query:{faceStatus:i}},"app1")):this.$router.replace({path:"/project-detail",query:(0,r.Z)((0,r.Z)({},e),{},{resourceId:e.studyId})})},getProjectReward(t){const{getProjectReward:e}=f.Z;e(t).then((t=>{if(t&&t.data){const{data:e}=t.data;let s={};e&&e.length&&e.forEach(((t,e)=>{let a=`${0!==t.score?`+${t.score}`:""}${t.score?this.$t("pointsMall.points"):""}\n          ${t.certificate_name&&`   +《${t.certificate_name}》`} `;s[e]=setTimeout((()=>{(t.certificate_name||t.score)&&(0,o.Z)(a),clearTimeout(s[e])}),1e3*e,e)}))}})).catch((t=>{console.error(t)}))},getPayResult(){const{dataInfo:t}=this,{enterpriseId:e}=this.userInfo,{getPayResult:s}=f.Z;s(e,t.project_id).then((t=>{"SUCCESS"===t.data.data&&(clearInterval(this.payResult),location.reload())}))},async queryFace(){const t=await V.Z.queryFace();this.hasSetFace="true"===t.data.result},async queryProjectDetail(){const{appType:t,student_id:e,query_source:s=""}=this.$route.query,{getProjectDetail:a}=f.Z;let i=await a({studyId:this.studyId,app_type:t||"",student_id:e,query_source:s});await this.saveStudyInfo(i)},async queryProjectSetting(){const{queryProjectSetting:t}=f.Z;let e=await t({projectId:this.dataInfo.projectId});const{speed_play:s,prevent_drag:a,prevent_cut_screen:i,course_download:o}=e.data.data;return{speed_play:s,prevent_drag:a,prevent_cut_screen:i,course_download:o}},async initGetData({isFirst:t}){try{const{getSubsidyClassRule:e,queryProjectMode:s}=f.Z,{userId:a}=this.userInfo,{courseIds:i,all_checked:r,pathTo:n,from:c}=this.$route.query;if(this.isView)return await this.queryProjectDetail(),!1;let l=(0,w.UI)("GD_BT_REQUEST"),u=await s(this.studyId);const{type:d,project_id:h,course_id:p}=u.data.data;if("normal"!==d&&"detail"!==n)this.goStudyProjectModuleBus(d,{projectId:h,studyId:p,courseIds:i,all_checked:r,from:c});else{await this.queryProjectDetail(),await this.queryFace(),"app"!==y.Z.env||this.dataInfo.is_free||"false"!==this.dataInfo.have_purchased||(this.payResult=setInterval(this.getPayResult,1e3));const s=this.dataInfo.stages[0].course_list;l&&e({projectId:h,userId:a}).then((t=>{this.dataInfo.stages.map((e=>(e.course_list.map((e=>(e.subsidy=t.data,e.subsidy.project_id=this.dataInfo.project_id,e))),e)))}));const i=s.some((t=>"mp4"===t.type));this.dataInfo.studyProjectSetData.prevent_cut_screen&&i&&t&&this.isAlertPreventHangModal?await this.showPreventHangModal():this.showFaceModel(),this.integralInfo&&(0,o.Z)(this.integralInfo),!this.isRegister||"pass"!==this.dataInfo.enroll_status&&"wait"!==this.dataInfo.enroll_status||!0!==this.dataInfo.add_task_control||(this.showRegister=!0)}}catch(t){setTimeout((()=>{y.Z.navigateBack()}),2e3)}},checkChange(){this.assignProjectCheck=!this.assignProjectCheck},handleAbandon(){const{abandonCreate:t}=f.Z;t({params:{boot_name:"create_project",no_remind:this.assignProjectCheck}}),this.showProjectGuide=!1},handleAssignPeople(){this.showProjectGuide=!1,this.topInfo.assignPeople()},onShareInfo(){this.$router.push({name:"project-share-info",params:{summary:this.dataInfo.summary,title:this.dataInfo.title,id:this.dataInfo.id,cover:this.dataInfo.cover,conversationId:this.conversationId}})},changeProjectInfo(t){this.dataInfo=t},async getSyncRecourse(t){const{getSingleResource:e}=f.Z;if("true"===this.dataInfo.sync_progress){const s=await e({planId:this.studyId,courseId:t.id,resourceId:t.id,studyType:"study_project"});return 0===s.data.code&&s.data.data?(0,r.Z)((0,r.Z)({},t),{},{progress:s.data.data.progress,recent_start:s.data.data.recent_start,study_time_limit:s.data.data.study_time_limit}):t}return t},isContinuePlay(t){const{study_progress:e}=this.dataInfo,{type:s}=t;let a=!0;return 100===e&&-1!==this.filterType.indexOf(s)&&(a=!1),a},resourceOnTap(t){this.resourceItem=t;const{studyId:e,studyStatus:s,dataInfo:a}=this,{canStudy:i,resource_status:r,progress:n,type:c,initType:l,unlocking_time:u,sourceType:d,spaceId:h,fileId:p,fileName:m,fileSize:g,fileType:v,exam_plan_detail_v2:_,status:C,show_result:I,show_repeat_exam:b}=t,{addPlayCount:w}=f.Z;let $="";if(this.isView&&($="operation"===c&&0!==r?"viewOperationResult":"view"),"view"===$)return!1;if("viewOperationResult"===$)return M.Z.init(this.dataInfo,t,e),!1;let k=0,S="absence"===C||"unfinished"===C,T="exam"!==c&&"newExam"!==c&&"latoja"!==c,Z="absence"===C&&"exam"===c;if("newExam"===c&&!I&&!b&&!(S||"inProgress"===C))return;"true"===a.is_task&&("newExam"===c&&(new Date).getTime()>Number(_.examEndTime)&&S||(new Date).getTime()>a.task_end_time&&(T||Z)?k=1:(new Date).getTime()<a.task_begin_time&&(k=2));let x=!("operation"===c&&0!==r&&2!==r);if(1===k&&this.isContinuePlay(t)&&x)return this.$toast(this.$t("project.learnEndTip")),!1;if(2===k)return this.$toast(this.$t("project.learnNotStartTip")),!1;if("pass"!==a.enroll_status&&a.enrollment_end_time&&(new Date).getTime()>a.enrollment_end_time&&"newExam"!==c)return this.$toast(this.$t("project.enrollEndTip")),!1;if("on"===a.face_recognition&&"success"!==this.faceStatus&&("dingTalk"===y.Z.env||"app"===y.Z.env))return this.enterFaceTIp(),!1;let P=!1;if("study_project"===a.type&&0!==a.camp_periods.length?P=!0:"study_project"!==a.type||0!==a.camp_periods.length||"false"!==a.have_purchased||a.is_free?("study_project"===a.type&&0===a.camp_periods.length&&"false"===a.have_purchased&&a.is_free&&"pass"!==a.enroll_status||"camp_period"===a.type&&"false"===a.have_purchased&&"false"===a.is_registration&&"true"===a.in_registration_time)&&(P=!0):P=!0,P&&"reject"===a.enroll_status)(0,o.Z)(this.$t("project.registerStatusRejectTip"));else if(!P||a.is_free)if(P)(0,o.Z)(this.$t("project.signUpWaitApproval"));else if("camp_period"!==a.type||"false"!==a.have_purchased||"false"!==a.is_registration||"false"!==a.in_registration_time)if("pass"===a.enroll_status||"latoja"===t.type)if(i)"overdue"!==s?3===Number(r)||"operation"===c?"investigate"!==c||100!==n?"practice"!==c?8!==d||"dingTalk"!==y.Z.env?(3===l&&w("enterprise",e),"pass"===r||"latoja"!==c?("newExam"===c&&this.$store.dispatch("studyProject/getProjectId",e),"false"===a.is_start_study?this.startStudy((()=>M.Z.init(this.dataInfo,t,e))):M.Z.init(this.dataInfo,t,e)):M.Z.init(this.dataInfo,t,e)):y.Z.previewFileInDingTalk({spaceId:h,fileId:p,fileName:m,fileSize:g,fileType:v}):this.showPicker=!0:(0,o.Z)(this.$t("study.notAllowViewTips")):(0,o.Z)(this.$t("study.transCoding")):(0,o.Z)(this.$t("promptMessage.overdueTask"));else{let t=u?this.$t("course.taskNotUnlocked"):this.$t("promptMessage.unlockPreviousTask");(0,o.Z)(t)}else(0,o.Z)(this.$t("project.failedRegistrationTips"));else(0,o.Z)(this.$t("project.registrationClosed"));else(0,o.Z)(this.$t("project.buyTip"))},handlePractice(){this.showPicker=!1;const{studyId:t,dataInfo:e}=this;"false"===e.is_start_study?this.startStudy((()=>M.Z.init(this.dataInfo,this.resourceItem,t))):M.Z.init(this.dataInfo,this.resourceItem,t)},closeDialog(){this.showPicker=!1},async queryQuestionCount(t){const{data:e}=await j.Z.queryQuestionCount({practiceId:t.id,type:"wrong",isContinue:"true",questionId:""});return"number"==typeof e&&e>0||((0,o.Z)(this.$t("practice.noQuestion")),!1)},async handleError(){const t=this.resourceItem.practice,{practice_infos:e}=t;if(Array.isArray(e)&&e.length>0){const{error_count:t}=e[0];if(!(t>0))return void(0,o.Z)(this.$t("practice.noWrongQuestion"))}await this.queryQuestionCount(t)&&this.playGame(t.id,"wrong","true","")},playGame(t,e,s){this.showPicker=!1,this.$router.push({path:"/study-resource/practice/practice-game",query:{practiceId:t,type:e,isContinue:s,questionId:""}})},hideRegisterTip(t){this.showRegister=t}}},H=(0,S.Z)(z,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"project-detail"},[s("TopInfo",{attrs:{"data-info":t.dataInfo,"study-record-total":t.studyRecordTotal,"theme-color":t.themeColor,"course-type":"project","study-id":t.studyId,"is-view":t.isView},on:{previewCertificate:t.previewCertificate,showRatingModel:t.showRatingModel,onShareInfo:t.onShareInfo,submitStar:t.submitStar}}),"normal"===t.dataInfo.status?[s("Stages",{attrs:{"data-info":t.dataInfo,"study-id":t.studyId},on:{resourceOnTap:t.resourceOnTap}})]:t._e(),"disabled"===t.dataInfo.status?s("div",{staticClass:"project-detail-off-tip"},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-icon_attention",color:"#7F849A",size:12}}),s("div",[t._v(t._s(t.$t("project.isStop")))])],1):t._e(),s("ActionBar",{attrs:{"data-info":t.dataInfo,"theme-color":t.themeColor,"study-id":t.studyId,"account-configured":t.accountConfigured,"white-list":t.whiteList,"wx-context":t.wxContext,"conversation-id":t.conversationId,"is-view":t.isView,"show-register":t.showRegister},on:{hideRegisterTip:t.hideRegisterTip,clickAction:t.clickAction,changeProjectInfo:t.changeProjectInfo,onTeamBuyClick:t.onTeamBuyClick,campGoodsPay:t.campGoodsPay,showPayModel:t.showPayModel}}),t.showSelectCampPeriod?s("div",[s("SelectCamp",{attrs:{"data-info":t.dataInfo},on:{onSelectCamp:t.onSelectCamp,closeCamp:t.closeCamp}})],1):t._e(),t.isView?t._e():s("div",{staticClass:"project-course-comment"},[s("course-comment",{ref:"myCourseComment",attrs:{"comment-info":t.commentInfo,"course-id":t.studyId,"course-source":"enterprise","submit-comment":t.submitComment}})],1),t.isShowPayModel?s("div",[s("PayModal",{attrs:{"show-pay-modal":t.showPayModal,"team-pay-flag":t.teamPayFlag,"show-pay-type":t.showPayType,"goods-type":t.teamPayFlag?"STUDY_PROJECT_GROUP_BUY":"STUDY_PROJECT","data-info":t.dataInfo,"wx-context":t.wxContext},on:{closeModal:t.closeModal,catchError:t.catchError}})],1):t._e(),t.showRating?s("rating-modal",{attrs:{star:t.star,edit:!0},on:{onSubmit:t.submitStar,cancelModal:function(e){t.showRating=!1}}}):t._e(),s("van-popup",{staticClass:"project-course-popup",attrs:{round:"",position:"bottom","get-container":"body","safe-area-inset-bottom":""},on:{"click-overlay":t.closeDialog},model:{value:t.showPicker,callback:function(e){t.showPicker=e},expression:"showPicker"}},[s("van-cell",{attrs:{title:t.$t("practice.intelligentPractice")},on:{click:function(e){return t.handlePractice()}}}),s("van-cell",{attrs:{title:t.$t("practice.eliminationWrongQuestion")},on:{click:function(e){return t.handleError()}}})],1)],2)}),[],!1,null,"d58b9518",null).exports},67200:(t,e,s)=>{s.r(e),s.d(e,{default:()=>n});var a=s(27632),i=s(92592),o=s(22648),r={name:"ProjectShare",data:function(){return{signUrl:"",imgUrl:"",studyInfo:{}}},computed:{themeColor(){return this.$store.state.themeColor.primaryColor},userInfo(){return this.$store.state.user},isIpx:()=>(0,o.Rq)()},mounted(){this.studyInfo=this.$route.params,this.createQrCode()},methods:{createQrCode(){let t=encodeURIComponent(`pages/camp/camp?pluginType=task&conversationId=${this.studyInfo.conversationId}`);this.studyInfo.conversationId||(t=encodeURIComponent(`pages/messageRedirect/messageRedirect?projectId=${this.studyInfo.id}&flag=study_project`));const e=`dingtalk://dingtalkclient/action/open_micro_app?corpId=${this.userInfo.corpId}&appId=${E_APP_ID}&pVersion=1&miniAppId=${MINI_APP_ID}&packageType=1&ddJointNavi=2&ddMode=push&page=${t}`;i.toDataURL(e,{width:180}).then((t=>{this.imgUrl=t})).catch((()=>{this.$toast.fail(this.$t("signIn.failedGenerateCode"))}))},download(){a.Z.saveImage({url:this.imgUrl},(()=>{this.$toast.success(this.$t("attestation.saveSuccess"))}),(()=>{this.$toast.success(this.$t("attestation.saveFail"))}))}}},n=(0,s(1001).Z)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"share-info"},[s("div",{staticClass:"share-info-qrcode"},[s("img",{staticClass:"share-info-avatar",attrs:{src:t.userInfo.avatar||t.defaultUserImg}}),s("div",{staticClass:"share-info-name"},[t._v(t._s(t.userInfo.name))]),s("div",{staticClass:"share-info-join"},[t._v(t._s(t.$t("course.invite")))]),s("div",{staticClass:"share-info-title"},[t._v(t._s(t.studyInfo.title))]),s("div",{staticClass:"share-info-img"},[s("img",{staticClass:"share-info-img-some",attrs:{src:t.studyInfo.cover}})]),t.studyInfo.summary&&""!==t.studyInfo.summary?s("div",{staticClass:"share-info-summary"},[t._v(t._s(t.studyInfo.summary))]):t._e(),s("div",{staticClass:"share-info-tip"},[t._v(t._s(t.$t("course.useDD")))]),s("div",{staticClass:"share-info-code"},[s("img",{staticClass:"small-canvas",attrs:{src:t.imgUrl}})]),s("div",{staticClass:"share-info-source"},[t._v(t._s(t.$t("approval.from"))+t._s(t.userInfo.enterpriseName))])]),s("div",{staticClass:"share-info-download",style:"color: "+t.themeColor,on:{click:t.download}},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-erweima",color:t.themeColor,size:16}}),t._v(" "+t._s(t.$t("signIn.saveQRCode"))+" ")],1)])}),[],!1,null,"1a0a653e",null).exports},25470:(t,e,s)=>{s.r(e),s.d(e,{default:()=>h});s(47238);var a=s(75167),i=(s(20581),s(50914)),o=(s(57658),s(25042)),r=s(27479),n=s(4852),c=s(95969),l=s(45877),u=s(67875),d={name:"StudyList",components:{List:i.Z,EmptyBox:r.Z,Avatar:n.Z,Progress:a.Z,ClCustomUser:l.Z,ClCustomDepartment:u.Z},data:function(){return{courseId:"",dataList:[],scrollHeight:0,loading:!1,hasNextPage:!1,pageSize:20,pageNumber:1,courseResource:""}},computed:{themeColor(){return this.$store.state.themeColor.primaryColor}},mounted(){const{courseId:t,courseResource:e}=this.$route.query;this.courseId=t,this.courseResource=e,this.loadData()},methods:{onTabChange(t){this.activeTab=t,this.pageNumber=1,this.hasNextPage=!0,this.dataList=[],this.loadData()},loadData(){this.loadStudyData()},async loadStudyData(){const{courseResource:t,courseId:e,pageSize:s,pageNumber:a}=this,i={page_size:s,page_number:a},r=await o.Z.getStudentList(t,e,i);"project"===t&&(r.data.list=r.data.list.map((t=>({avatar:t.avatar,id:t.id,name:t.user_name,dimission_status:"",departments:t.department_name.split(","),progress:t.process,user_info:t.user_info||t.sync_user_info})))),this.dataList=this.dataList.concat(r.data.list),this.hasNextPage="true"===r.data.has_next_page,this.loading=!1},onLoad(){if(!1===this.hasNextPage)return!1;this.pageNumber+=1,this.loading=!0,this.loadData()},handleToDetail(t){const{tabArr:e,activeTab:s}=this,a="3"===e[s-1].status?"end":"";this.$router.push(c.Z.studyProject.taskAssignDetail({planId:t.id,type:a}))}}},h=(0,s(1001).Z)(d,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"viewers_container"},[t.loading||0!==t.dataList.length?s("div",[s("List",{attrs:{finished:!t.hasNextPage,"immediate-check":!1,"finished-text":t.$t("common.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.dataList,(function(e){return s("div",{key:e.id,staticClass:"item-one"},[s("div",{staticClass:"item-user"},[s("Avatar",{attrs:{src:e.avatar,width:"40",height:"40"}}),s("div",{staticClass:"user-info"},[s("div",{staticClass:"user-name"},[e.user_info?s("span",[s("cl-custom-user",{attrs:{type:e.user_info.sourceType,"data-type":"userName",value:e.user_info.userId,name:e.user_info.name}})],1):s("span",[t._v(t._s(e.name))]),"quit"===e.dimission_status?s("span",{staticClass:"quit-user",staticStyle:{color:"#7f849a","margin-left":"10px"}},[t._v(" "+t._s("("+t.$t("course.quitted")+")")+" ")]):t._e()]),e.user_info?s("div",{staticClass:"user-department"},[s("cl-custom-department",{attrs:{"display-all":!0,list:e.user_info.department_info}})],1):s("div",{staticClass:"user-department"},[t._v(" "+t._s(e.departments.join(" / "))+" ")])])],1),s("div",{staticClass:"status"},[e.progress<100?s("div",{staticClass:"progress"},[s("div",{staticClass:"progress-info"},[s("Progress",{attrs:{"pivot-text":"",color:"themeColor",percentage:e.progress}}),s("span",{staticClass:"progress-text"},[t._v(t._s(e.progress)+"%")])],1)]):s("div",{staticClass:"done"},[t._v(" "+t._s(t.$t("course.finished"))+" ")])])])})),0)],1):s("EmptyBox")],1)}),[],!1,null,"7ca81562",null).exports},21575:(t,e,s)=>{s.r(e),s.d(e,{default:()=>_});var a=s(95082),i=(s(39610),s(2163)),o=(s(72975),s(98655)),r=(s(11155),s(91391)),n=(s(49153),s(5944)),c=s(26294),l=(s(33948),{name:"ExamDetailInfo",data(){return{statusTabs:[{name:this.$t("examination.all"),key:"all",active:!0}],answerParsing:this.$route.query.answerParsing}},computed:(0,a.Z)((0,a.Z)({},(0,c.mapState)("exam",["questionIndex","questionList"])),(0,c.mapState)(["language"])),watch:{questionList:{handler(t){const e=t.filter((t=>"true"===t.result)),s=t.filter((t=>{const{answer:e=[]}=t.answerResult;return"false"===t.result&&e.length>0&&e.every((t=>""!==t))})),a=t.filter((t=>{const{answer:e=[],answerImage:s=[]}=t.answerResult;return"false"===t.result&&(0===e.length||e.every((t=>""===t)))&&0===s.length}));if(e.length>0&&(this.statusTabs=[...this.statusTabs,{name:this.$t("examination.correct"),key:"success",active:!1,num:e.length}]),"onlyError"===this.answerParsing)return this.statusTabs=[{name:this.$t("examination.error"),key:"error",active:!0,num:s.length}],void this.onTabChange(0);s.length>0&&(this.statusTabs=[...this.statusTabs,{name:this.$t("examination.error"),key:"error",active:!1,num:s.length}]),a.length>0&&(this.statusTabs=[...this.statusTabs,{name:this.$t("examination.unAnswer"),key:"unAnswer",active:!1,num:a.length}])},deep:!0,immediate:!0}},methods:(0,a.Z)((0,a.Z)({},(0,c.mapMutations)("exam",["setQuestionList","setFilterList","setQuestionIndex","setCurrentTab"])),{},{onTabChange(t){this.statusTabs.forEach((t=>t.active=!1)),this.statusTabs[t].active=!0;const e=this.statusTabs[t];this.setCurrentTab(e.key);const s=this.questionList.filter((t=>{const{answer:s=[],answerImage:a=[]}=t.answerResult;return{all:!0,success:"true"===t.result,error:"false"===t.result&&s.length>0&&s.every((t=>""!==t)),unAnswer:"false"===t.result&&(0===s.length||s.every((t=>""===t)))&&0===a.length}[e.key]}));this.setFilterList(s)}})}),u=s(1001),d=(0,u.Z)(l,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"exam-detail-info"},[s("div",{staticClass:"status-tabs"},t._l(t.statusTabs,(function(e,a){return s("span",{key:e.key,staticClass:"tab",class:e.active?"active":"",on:{click:function(e){return t.onTabChange(a)}}},[t._v(" "+t._s(e.name)+t._s(e.num&&"en-us"!==t.language?"("+e.num+")":"")+" ")])})),0),s("div",{staticClass:"topic-number"},[t._v(" "+t._s(t.$t("examination.topicTime"))),s("span",{staticClass:"count active"},[t._v(t._s(t.questionIndex))]),t._v("/"),s("span",{staticClass:"count"},[t._v(t._s(t.questionList.length))]),t._v(" "+t._s(t.$t("examination.topicUnit"))+" ")])])}),[],!1,null,"eb787c26",null).exports,h=s(6132),p=s(84553),m=s(58453),g=s(24357),v=s(85566),f=s(14027),y={name:"Exam",components:{ExamDetailInfo:d,QuestionSelector:h.Z,Question:p.Z,ClWaterMark:g.Z,SkeletonScreen:m.Z,Empty:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z},data:()=>({loading:!0,showPaper:!1,timeout:null}),computed:(0,a.Z)((0,a.Z)({},(0,c.mapState)("exam",["questionIndex","questionList","filterList"])),{},{query(){const{examId:t,taskId:e,submitId:s}=this.$route.query;return{examId:t,taskId:e,submitId:s}}}),watch:{questionIndex(t){const e=this.filterList.findIndex((e=>e.orderId===t));this.$nextTick((()=>{const s=document.querySelector(`.topic-wrapper.swipe-${t}`);s&&s.scrollTo({top:0}),this.timeout&&clearTimeout(this.timeout),this.$refs.swipe&&(this.timeout=setTimeout((()=>{this.$refs.swipe.swipeTo(e,{immediate:!0})}),20))}))}},beforeDestroy(){this.timeout&&clearTimeout(this.timeout)},mounted(){this.getPaperInfo(),this.disableCopy()},methods:(0,a.Z)((0,a.Z)({},(0,c.mapMutations)("exam",["setQuestionIndex","setQuestionList","setFilterList","setPaperInfo"])),{},{getPaperInfo(){this.loading=!0;const t={examId:this.query.examId,submitId:this.query.submitId,taskId:this.query.taskId};v.Z.getExamSubmitList(t).then((t=>{this.loading=!1;const{questionList:e}=t.data;this.showPaper=e.length>0,this.setPaperInfo((0,a.Z)((0,a.Z)({},t.data),{},{showTag:"true"})),this.setQuestionList(e),this.setFilterList(e),this.showPaper&&this.setQuestionIndex(1)})).catch((t=>{this.handleError(t)}))},handleError(t){this.loading=!1,this.$toast.clear();const{code:e}=t;e&&f.CR[e]&&this.$dialog.confirm({title:f.CR[e],message:"",getContainer:()=>document.querySelector(".exam-detail"),confirmButtonColor:this.primaryColor,confirmButtonText:this.$t("common.close"),showCancelButton:!1}).then((()=>{this.$dialog.close(),this.$router.go(-1)}))},setQuestionOrderId(t){const{orderId:e}=this.filterList[t];e&&this.setQuestionIndex(e)},disableCopy(){this.$nextTick((()=>{const{examRef:t}=this.$refs;t.oncontextmenu=new Function("event.returnValue=false"),t.onselectstart=new Function("event.returnValue=false"),t.oncontextmenu=function(t){t.preventDefault()},t.onselectstart=function(t){t.preventDefault()},t.addEventListener("contextmenu",(t=>{t.preventDefault()})),t.ontouchend=function(){}}))}})},_=(0,u.Z)(y,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"examRef",staticClass:"exam-detail"},[t.loading?s("SkeletonScreen"):t._e(),t.showPaper?s("div",[s("van-sticky",[s("div",{staticClass:"sticky-container"},[s("ExamDetailInfo"),s("question-selector",{attrs:{"show-type":"detail"}})],1)]),s("van-swipe",{ref:"swipe",attrs:{width:"100%",height:"100%","lazy-render":!0,"initial-swipe":0,loop:!1,"show-indicators":!1},on:{change:t.setQuestionOrderId}},t._l(t.filterList,(function(t){return s("van-swipe-item",{key:t.id},[s("div",{key:t.id,staticClass:"topic-wrapper",class:["swipe-"+t.orderId]},[s("Question",{attrs:{result:t,"show-type":"detail"}}),s("cl-water-mark",{attrs:{scenes:"exam"}})],1)])})),1),0==t.filterList.length?s("Empty"):t._e()],1):t._e()],1)}),[],!1,null,"19b27f90",null).exports},6132:(t,e,s)=>{s.d(e,{Z:()=>_});var a=s(95082),i=(s(25773),s(35791)),o=(s(73474),s(74755)),r=(s(82500),s(49414)),n=(s(82522),s(10342)),c=(s(26699),s(26294)),l=s(14027),u=s(89734),d=s.n(u),h=s(7739),p=s.n(h),m=s(61378),g=s(6106),v=s(96838),f=s(22648),y={name:"QuestionSelector",components:{[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z},props:{showType:{type:String,default:"exam"}},data:()=>({expand:!1,activeTab:1,timeout:null}),computed:(0,a.Z)((0,a.Z)((0,a.Z)({},(0,c.mapState)("exam",["questionIndex","answerVos","questionList","filterList"])),(0,c.mapGetters)({userInfo:"user/getUserInfo"})),{},{list(){return"detail"===this.showType?this.filterList:this.questionList},sortList(){return this.list.length?d()(this.list,(t=>t.orderId)):[]},groupList(){const t=this.list.length?p()(this.list,"type"):{},e={};return["single","multiple","trueOrFalse","fillBlank","shortAnswer"].forEach((s=>{t[s]&&t[s].length&&(e[s]=t[s])})),e},examTopic:()=>l.iD,isAnswered(){return t=>{if("detail"===this.showType)return!1;const e=this.answerVos.find((e=>e.id===t.id));return 0!==e.answer.length&&(["fillBlank","shortAnswer"].includes(t.type)?e.answer_image.length||e.answer.some((t=>""!==t)):e.answer.every((t=>""!==t)))}},isSuccess(){return t=>{let e="";if("detail"===this.showType&&("true"===t.result&&(e="success"),"false"===t.result)){e="error";const{answer:s=[],answerImage:a=[]}=t.answerResult;0!==s.length&&!s.every((t=>""===t))||0!==a.length||(e="no-answered")}return e}}}),watch:{filterList:{handler(t){this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout((()=>{Array.isArray(t)&&t[0]&&t[0].orderId&&this.setQuestionIndex(t[0].orderId)}),0)},immediate:!0,deep:!0},questionIndex(t){this.activeTab=t}},beforeDestroy(){this.timeout&&clearTimeout(this.timeout)},mounted(){this.handleIntroJS()},methods:(0,a.Z)((0,a.Z)({},(0,c.mapMutations)("exam",["setQuestionIndex","setSubmitStatus"])),{},{getContainer(){return this.$refs.numberRef},onTopicItemClick(t){this.expand=!1,this.setQuestionIndex(t.orderId)},onTabsChange(t){this.setQuestionIndex(t)},onPaperSubmit(){this.$toast.loading({forbidClick:!0,duration:0}),setTimeout((()=>{let t=0;this.answerVos.forEach((e=>{(0===e.answer.length||e.answer.every((t=>""===t)))&&0===e.answer_image.length&&t++}));const e={scene:"question-selector",answerVos:this.answerVos,unAnsweredCount:t,questionIndex:this.questionIndex};v.Z.logger({moduleName:"examSubmitClick",data:(0,a.Z)((0,a.Z)({},e),{},{currentTime:(0,f.p6)((new Date).getTime(),"yyyy/MM/dd  hh:mm")})});const s=t>0?`${this.$t("examination.unAnsweredTips",{count:`<span class="count">${t}</span>`})}\n${this.$t("examination.submitPaperTips")}`:this.$t("examination.submitPaperTips");this.$toast.clear(),this.$dialog.confirm({title:"",message:s,className:"submit-dialog",getContainer:()=>document.querySelector(".exam-detail"),confirmButtonText:this.$t("common.confirm"),cancelButtonText:this.$t("common.cancel"),confirmButtonColor:"#FF4D4F"}).then((()=>{this.$dialog.close(),v.Z.logger({moduleName:"submitOK",data:(0,a.Z)((0,a.Z)({},e),{},{currentTime:(0,f.p6)((new Date).getTime(),"yyyy/MM/dd  hh:mm")})}),this.setSubmitStatus("manual"),this.$emit("submit")}))}),1e3)},async judgeShowFirstGuide(){try{const{userId:t}=this.userInfo,e={userId:t,type:9},s=await g.Z.getUserGuideCheck(e),{guide_view:a}=s.data.data;return a}catch(t){return console.error(t),!1}},async handleIntroJS(){if(await this.judgeShowFirstGuide()){document.documentElement.style.setProperty("--mainColor",this.$store.state.themeColor.primaryColor);const t=`<span style="font-size: 3.7vw;">${this.$t("examGuide.expandGuide")}</span>`;(0,m.Z)().setOptions({prevLabel:"",nextLabel:"",doneLabel:this.$t("buttons.know"),exitOnOverlayClick:!1,disableInteraction:!0,tooltipClass:"intro-step-one",steps:[{title:this.$t("common.expandMore"),element:document.querySelector(".new-exam-expand"),intro:t,position:"bottom"}]}).start().oncomplete((()=>{setTimeout((()=>{this.$emit("showScrollIntro")}),200)}))}}})},_=(0,s(1001).Z)(y,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"question-selector"},[s("div",{ref:"numberRef",staticClass:"number"},[s("van-tabs",{staticClass:"number-tabs",on:{change:t.onTabsChange},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},t._l(t.sortList,(function(e){return s("van-tab",{key:e.orderId,attrs:{name:e.orderId,title:e.orderId+"","title-class":[t.isAnswered(e)?"answered":"",t.isSuccess(e)]}})})),1),s("span",{staticClass:"expand-button new-exam-expand",on:{click:function(){return t.expand=!t.expand}}},[t._v(" "+t._s(t.expand?t.$t("attestation.retract"):t.$t("attestation.open"))+" "),s("svg-icon",{attrs:{"icon-class":t.expand?"icon-datiqiashouqi":"icon-datiqiazhankai",color:"rgba(0, 0, 0, 0.65)",size:12}})],1)],1),s("div",{staticClass:"shadow"}),s("van-popup",{attrs:{position:"top","get-container":t.getContainer,transition:"fade"},model:{value:t.expand,callback:function(e){t.expand=e},expression:"expand"}},[s("div",{staticClass:"topic-wrapper"},t._l(Object.keys(t.groupList),(function(e,a){return s("div",{key:a,staticClass:"topic"},[s("div",{staticClass:"topic-name"},[t._v(t._s(t.examTopic[e]))]),s("div",{staticClass:"topic-list"},t._l(t.groupList[e],(function(e,a){return s("span",{key:a,staticClass:"list-item",class:[t.isAnswered(e)?"answered":"",e.orderId===t.questionIndex?"active":"",t.isSuccess(e)],on:{click:function(){return t.onTopicItemClick(e)}}},[t._v(" "+t._s(e.orderId)+" ")])})),0)])})),0),"exam"===t.showType?s("div",{staticClass:"topic-wrapper-submit"},[s("van-button",{on:{click:t.onPaperSubmit}},[t._v(t._s(t.$t("buttons.submitExams")))])],1):t._e()])],1)}),[],!1,null,"9ebb383e",null).exports},84553:(t,e,s)=>{s.d(e,{Z:()=>U});var a=s(95082),i=(s(26699),s(26294)),o=s(14027),r={name:"TopicTitle",props:{result:{type:Object,default:()=>{}},showType:{type:String,default:"exam"}},computed:(0,a.Z)((0,a.Z)({},(0,i.mapState)("exam",["paperInfo"])),{},{totalScore(){const{type:t,score:e,scoreType:s,options:a}=this.result;return["fillBlank","shortAnswer"].includes(t)&&"wordSpace"===s?e*a.length:e},title(){return o.iD[this.result.type]},scoreClass(){const{actualScore:t}=this.result;return 0===t?"error":t===this.totalScore?"success":t<this.totalScore?"warning":""},defaultScore(){const{type:t,score:e,scoreType:s}=this.result;if("wordSpace"===s){if("fillBlank"===t)return`（${this.$t("examination.blankUnit")} ${e}${this.$t("examination.scoreNum")}）`;if("shortAnswer"===t)return`（${this.$t("examination.wordUnit")} ${e}${this.$t("examination.scoreNum")}）`}return`（${e}${this.$t("examination.scoreNum")}）`}})},n=s(1001),c=(0,n.Z)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"topic-title"},[s("div",{staticClass:"title"},[s("span",{staticClass:"title-type"},[t._v(t._s(t.title))]),"detail"===t.showType?s("span",{staticClass:"get-score"},[["fillBlank","shortAnswer"].includes(t.result.type)?s("span",[t._v(" ("+t._s(t.$t("examination.is"))+" "),s("span",{class:[t.scoreClass,"score"]},[t._v(" "+t._s(t.result.actualScore)+" ")]),"true"===t.paperInfo.showAnalysis?s("span",[t._v("/"+t._s(t.totalScore))]):t._e(),t._v(" "+t._s(t.$t("examination.scoreNum"))+") ")]):["multiple"].includes(t.result.type)?s("span",[t.result.missScore?s("span",[t._v(" ("+t._s(t.$t("examination.is"))+" "),s("span",{class:[t.scoreClass,"score"]},[t._v(" "+t._s(t.result.actualScore)+" ")]),"true"===t.paperInfo.showAnalysis?s("span",[t._v("/"+t._s(t.totalScore))]):t._e(),t._v(" "+t._s(t.$t("examination.scoreNum"))+") ")]):s("span",[t._v("("+t._s(t.$t("examination.is"))),s("span",{class:[t.scoreClass,"score"]},[t._v(t._s(t.result.actualScore))]),t._v(t._s(t.$t("examination.scoreNum"))+")")])]):["single","trueOrFalse"].includes(t.result.type)?s("span",[t._v(" ("+t._s(t.$t("examination.is"))),s("span",{class:[t.scoreClass,"score"]},[t._v(t._s(t.result.actualScore))]),t._v(t._s(t.$t("examination.scoreNum"))+") ")]):t._e()]):s("span",{staticClass:"title-score"},[t._v(t._s(t.defaultScore))])])])}),[],!1,null,"bc8cb700",null).exports,l=(s(93787),s(20090)),u=s(8202),d=s(65184),h={name:"QuestionStem",components:{PictureSquares:u.Z},props:{title:{type:String,default:""},media:{type:Object,default:()=>{}},result:{type:Object,default:()=>{}},answers:{type:Array,default:()=>[]},type:{type:String,default:""},showType:{type:String,default:"exam"}},data:()=>({allAnswers:[]}),computed:(0,a.Z)((0,a.Z)({},(0,i.mapState)("exam",["questionIndex","paperInfo"])),{},{images(){const{image:t=[]}=this.media;return t.map((t=>({url:t})))},isSystem(){return"0"===this.result.markerId||""===this.result.markerId},stemTitle(){if("fillBlank"===this.type){let t=this.answers;return"detail"!==this.showType&&(t=this.answers.map((t=>({answer:t,result:"normal"})))),"detail"===this.showType&&("false"!==this.paperInfo.showAnalysis&&this.isSystem||(t=this.answers.map((t=>({answer:t.answer,result:"normal"}))))),(0,d._z)(this.title,t)}return this.title}})},p=(0,n.Z)(h,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"question-stem"},[s("div",{staticClass:"stem-content",domProps:{innerHTML:t.xss(t._s(t.stemTitle))}}),t.images.length?s("div",{staticClass:"stem-images"},[s("picture-squares",{attrs:{pictures:t.images},on:{preview:function(e){return t.$store.commit("exam/setIsCutScreen",!1)}}})],1):t._e()])}),[],!1,null,"533b3918",null).exports,m=s(56994),g={name:"ShortAnswer",components:{ClImageUpload:m.Z,QuestionStem:p,[l.Z.name]:l.Z},props:{result:{type:Object,default:()=>{}},showType:{type:String,default:"exam"}},data:()=>({answer:"",answer_image:[],timer:null}),computed:(0,a.Z)((0,a.Z)({},(0,i.mapState)("exam",["answerVos","questionIndex","questionList"])),{},{showUploadImage(){return"detail"===this.showType?"true"===this.result.isAnswerUploadImage&&this.answer_image.length:"true"===this.result.isAnswerUploadImage}}),watch:{questionIndex(){document.activeElement.blur()}},mounted(){if(this.result.answerResult){const{answer:t,answerImage:e}=this.result.answerResult;this.answer=t[0],this.$set(this,"answer_image",e.map((t=>({url:t}))))}},methods:(0,a.Z)((0,a.Z)((0,a.Z)({},(0,i.mapMutations)("exam",["setAnswerVos","setIsFocus","setQuestionList"])),(0,i.mapActions)("exam",["saveQuestion"])),{},{async saveAnswer(){if("detail"===this.showType)return;if(this.onInputBlur(),""===this.answers&&0===this.answer_image.length)return;const{id:t}=this.result,e=this.questionList.findIndex((e=>e.id===t));this.answerVos.length&&(this.answerVos[e].answer=(0,d._1)([this.answer]),this.answerVos[e].answer_image=this.answer_image.map((t=>t.url))),this.setAnswerVos(this.answerVos),this.questionList.length&&(this.questionList[e].answerResult.answer=(0,d._1)([this.answer]),this.questionList[e].answerResult.answerImage=this.answer_image.map((t=>t.url))),this.setQuestionList(this.questionList),await this.saveQuestion({answerVos:this.answerVos[e]})},onTextAreaInput(){this.saveAnswer()},onTextAreaClear(){this.answer="",this.saveAnswer()},onImageChange(t){this.answer_image=t,this.saveAnswer()},onFocus(){navigator&&navigator.clipboard&&navigator.clipboard.writeText(" ").then((()=>{}),(()=>{}))},onInputFocus(){this.setIsFocus(!0)},onInputBlur(){this.setIsFocus(!1)},onHandlePaste:t=>(t.preventDefault(),!1)})},v=(0,n.Z)(g,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"short-answer"},[s("div",{staticClass:"answer-wrapper"},[s("question-stem",{attrs:{title:t.result.title,media:t.result.summary,"show-type":t.showType}}),s("div",{staticClass:"answer-textarea"},["detail"===t.showType?s("div",{staticClass:"form-item",class:[t.answer?"":"un-answered"]},[t._v(" "+t._s(t.answer||t.$t("examination.unAnswered"))+" ")]):s("van-field",{attrs:{rows:"5",autosize:!1,type:"textarea",maxlength:"1000",placeholder:t.$t("examination.shortAnswerPlaceholder"),"show-word-limit":"detail"!==t.showType,disabled:"detail"===t.showType},on:{click:t.onFocus,change:t.onTextAreaInput,clear:t.onTextAreaClear,focus:t.onInputFocus,paste:t.onHandlePaste},model:{value:t.answer,callback:function(e){t.answer=e},expression:"answer"}})],1)],1),t.showUploadImage?s("div",{staticClass:"answer-upload"},[s("cl-image-upload",{ref:"imgUpload",attrs:{"show-upload":"detail"!==t.showType,"image-list":t.answer_image},on:{change:t.onImageChange,preview:function(e){return t.$store.commit("exam/setIsCutScreen",!1)}}})],1):t._e()])}),[],!1,null,"6be55dc0",null).exports,f=(s(32023),s(33948),s(44908)),y=s.n(f),_=(s(31960),s(10993)),C=(s(47601),s(44951)),I=s(27632),b={name:"PictureRow",components:{[C.Z.name]:C.Z},props:{images:{type:Array,default:()=>[]}},methods:{previewImage(t,e){this.$store.commit("exam/setIsCutScreen",!1),"dingTalk"!==I.Z.env?(0,_.Z)({images:this.images,startPosition:e}):I.Z.previewImage({urls:this.images,current:e})}}},w=(0,n.Z)(b,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"picture-row"},t._l(t.images,(function(e,a){return s("div",{key:a,staticClass:"picture"},[a<6?s("van-image",{attrs:{fit:"cover",src:e,width:"100%",height:"100%"},on:{click:function(s){return t.previewImage(e,a)}}}):t._e(),5===a?s("div",{staticClass:"more-picture",on:{click:function(s){return t.previewImage(e,a)}}},[t._v("+"+t._s(t.images.length-6))]):t._e()],1)})),0)}),[],!1,null,"a5a0ad14",null).exports,$={name:"SelectAnswer",components:{PictureRow:w},props:{answers:{type:Array,default:()=>[]},type:{type:String,default:"single"},result:{type:Object,default:()=>{}},showType:{type:String,default:"exam"}},data:()=>({current:[]}),computed:(0,a.Z)((0,a.Z)({},(0,i.mapState)("exam",["paperInfo"])),{},{createOptionOrder:()=>d.NK,answerClass(){return t=>{if("detail"===this.showType){const{correctAnswer:e,answerResult:s}=this.result,{answer:a}=s;return"false"===this.paperInfo.showAnalysis?a.includes(t.option)?"active":"":a.includes(t.option)?e.indexOf(t.option)>-1?"success":"error":e.indexOf(t.option)>-1?"current":""}return this.current.includes(t.option)?"active":""}}}),mounted(){if(this.result.answerResult){const{answer:t}=this.result.answerResult;this.current=t}},methods:{onSelect(t){const e=this.current.includes(t.option);if("detail"!==this.showType){switch(this.type){case"single":this.current=e?[]:[t.option];break;case"multiple":this.current=e?this.current.filter((e=>e!==t.option)):y()([...this.current,t.option])}this.$emit("change",this.current)}}}},k=(0,n.Z)($,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"select-answer"},t._l(t.answers,(function(e,a){return s("div",{key:a,staticClass:"answer-option"},[s("button",{class:["answer-item",t.answerClass(e)],on:{click:function(s){return s.preventDefault(),t.onSelect(e,a)}}},[s("span",{staticClass:"label"},[t._v(t._s(t.createOptionOrder(a)))]),s("span",{staticClass:"value"},[t._v(t._s(e.title))]),"detail"===t.showType?s("div",{staticClass:"item-icon"},["error"===t.answerClass(e)?s("SvgIcon",{attrs:{"icon-class":"icon-icon_close",size:16,color:"#FF4D4F"}}):t._e(),"success"===t.answerClass(e)?s("SvgIcon",{attrs:{"icon-class":"icon-danxuanxuanzhong1",size:16,color:"#52C41A"}}):t._e()],1):t._e()]),e.image.length?s("picture-row",{attrs:{images:e.image}}):t._e()],1)})),0)}),[],!1,null,"7271bcda",null).exports,S={name:"Multiple",components:{QuestionStem:p,SelectAnswer:k},props:{result:{type:Object,default:()=>{}},showType:{type:String,default:"exam"}},computed:(0,a.Z)((0,a.Z)({},(0,i.mapState)("exam",["answerVos","questionList","questionIndex"])),{},{images(){const{image:t=[]}=this.result.summary;return t.map((t=>({url:t})))},answers(){const{options:t=[]}=this.result;return t}}),methods:(0,a.Z)((0,a.Z)((0,a.Z)({},(0,i.mapActions)("exam",["saveQuestion"])),(0,i.mapMutations)("exam",["setAnswerVos","setQuestionList"])),{},{async saveAnswer(t){const{id:e}=this.result,s=this.questionList.findIndex((t=>t.id===e));this.answerVos.length&&(this.answerVos[s].answer=(0,d._1)(t)),this.setAnswerVos(this.answerVos),this.questionList.length&&(this.questionList[s].answerResult.answer=(0,d._1)(t)),this.setQuestionList(this.questionList),await this.saveQuestion({answerVos:this.answerVos[s]})}})},T=(0,n.Z)(S,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"multiple"},[s("question-stem",{attrs:{title:t.result.title,media:t.result.summary,"show-type":t.showType}}),s("div",{staticClass:"multiple-options"},[s("select-answer",{attrs:{answers:t.answers,type:"multiple","show-type":t.showType,result:t.result},on:{change:t.saveAnswer}})],1)],1)}),[],!1,null,"27e7de0a",null).exports,Z=s(23493),x=s.n(Z),P={name:"Single",components:{QuestionStem:p,SelectAnswer:k},props:{result:{type:Object,default:()=>{}},showType:{type:String,default:"exam"}},computed:(0,a.Z)((0,a.Z)({},(0,i.mapState)("exam",["questionIndex","answerVos","questionList"])),{},{images(){const{image:t=[]}=this.result.summary;return t.map((t=>({url:t})))},answers(){const{options:t=[]}=this.result;return t}}),methods:(0,a.Z)((0,a.Z)((0,a.Z)({},(0,i.mapMutations)("exam",["setAnswerVos","setQuestionIndex","setQuestionList"])),(0,i.mapActions)("exam",["saveQuestion"])),{},{saveAnswer:x()((function(t){const{id:e}=this.result,s=this.questionList.findIndex((t=>t.id===e));this.answerVos.length&&(this.answerVos[s].answer=(0,d._1)(t)),this.setAnswerVos(this.answerVos),this.questionList.length&&(this.questionList[s].answerResult.answer=(0,d._1)(t)),this.setQuestionList(this.questionList),this.saveQuestion({answerVos:this.answerVos[s]}).then((()=>{}))}),200)})},D=(0,n.Z)(P,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"single"},[s("question-stem",{attrs:{title:t.result.title,media:t.result.summary,"show-type":t.showType}}),s("div",{staticClass:"single-options"},[s("select-answer",{attrs:{answers:t.answers,type:"single","show-type":t.showType,result:t.result},on:{change:t.saveAnswer}})],1)],1)}),[],!1,null,"28175ad8",null).exports,L={name:"TrueOrFalse",components:{QuestionStem:p},props:{result:{type:Object,default:()=>{}},showType:{type:String,default:"exam"}},data:()=>({answer:""}),computed:(0,a.Z)((0,a.Z)({},(0,i.mapState)("exam",["questionIndex","answerVos","questionList","paperInfo"])),{},{answers(){const{options:t=[]}=this.result;return t},judgeClass(){return t=>{if("detail"===this.showType){const{correctAnswer:e,answerResult:s}=this.result,{answer:a}=s;return"false"===this.paperInfo.showAnalysis?a.includes(t.option)?"active":"":a.length&&t.option===a[0]?a[0]===e?"success":"error":t.option===e?"success-answer":"detail"}return this.answer===t.option?"active":""}}}),mounted(){if(this.result.answerResult){const{answer:t}=this.result.answerResult;this.answer=t[0]}},methods:(0,a.Z)((0,a.Z)((0,a.Z)({},(0,i.mapMutations)("exam",["setAnswerVos","setQuestionIndex","setQuestionList"])),(0,i.mapActions)("exam",["saveQuestion"])),{},{saveAnswer:x()((function(t){if("detail"===this.showType)return;this.answer=t;const{id:e}=this.result,s=this.questionList.findIndex((t=>t.id===e));this.answerVos.length&&(this.answerVos[s].answer=(0,d._1)([t])),this.setAnswerVos(this.answerVos),this.questionList.length&&(this.questionList[s].answerResult.answer=(0,d._1)([t])),this.setQuestionList(this.questionList),this.saveQuestion({answerVos:this.answerVos[s]}).then((()=>{}))}),200)})},A=(0,n.Z)(L,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"true-false"},[s("question-stem",{attrs:{title:t.result.title,media:t.result.summary,"show-type":t.showType}}),s("div",{staticClass:"judge-group"},t._l(t.answers,(function(e,a){return s("button",{key:a,staticClass:"judge-item",class:[t.judgeClass(e)],on:{click:function(s){return s.preventDefault(),t.saveAnswer(e.option)}}},[t._v(" "+t._s(e.title)+" "),"detail"===t.showType?s("div",{staticClass:"item-icon"},["error"===t.judgeClass(e)?s("SvgIcon",{attrs:{"icon-class":"icon-icon_close",size:16,color:"#FF4D4F"}}):t._e(),"success"===t.judgeClass(e)?s("SvgIcon",{attrs:{"icon-class":"icon-danxuanxuanzhong1",size:16,color:"#52C41A"}}):t._e()],1):t._e()])})),0)],1)}),[],!1,null,"456d70b8",null).exports,E=(s(29941),s(64168)),R=(s(74916),s(4723),{name:"FillBlank",components:{QuestionStem:p,ClImageUpload:m.Z,[l.Z.name]:l.Z,[E.Z.name]:E.Z},props:{result:{type:Object,default:()=>{}},showType:{type:String,default:"exam"}},data(){return{answers:this.result.title.match(/\【.*?\】/g).fill(""),answer_image:[],timer:null}},computed:(0,a.Z)((0,a.Z)({},(0,i.mapState)("exam",["answerVos","paperInfo","questionList","questionIndex"])),{},{showUploadImage(){return"detail"===this.showType?"true"===this.result.isAnswerUploadImage&&this.answer_image.length:"true"===this.result.isAnswerUploadImage},getItemClass(){return t=>"false"!==this.paperInfo.showAnalysis&&this.isSystem?[t.answer?"":"un-answered","true"===t.result?"success":"error"]:[t.answer?"":"un-answered","normal"]},isSystem(){return"0"===this.result.markerId||""===this.result.markerId}}),watch:{questionIndex(){document.activeElement.blur()}},mounted(){if(this.result.answerResult){const{answer:t,answerImage:e}=this.result.answerResult,s=this.result.title.match(/\【.*?\】/g).fill("");if("detail"===this.showType)this.answers=t.length?t.map((t=>JSON.parse(t))):this.answers;else{let e=[];t.length&&s.forEach(((s,a)=>{a<t.length?e[a]=t[a]:e[a]=""})),this.answers=e.length?e:s}this.$forceUpdate(),this.$set(this,"answer_image",e.map((t=>({url:t}))))}},methods:(0,a.Z)((0,a.Z)((0,a.Z)({},(0,i.mapMutations)("exam",["setAnswerVos","setQuestionList","setIsFocus"])),(0,i.mapActions)("exam",["saveQuestion"])),{},{async saveAnswer(){if(this.onInputBlur(),"detail"===this.showType)return;if(this.answers.every((t=>""===t))&&0===this.answer_image.length)return;const{id:t}=this.result,e=this.questionList.findIndex((e=>e.id===t));this.answerVos.length&&(this.answerVos[e].answer=(0,d._1)(this.answers),this.answerVos[e].answer_image=this.answer_image.map((t=>t.url))),this.setAnswerVos(this.answerVos),this.questionList.length&&(this.questionList[e].answerResult.answer=(0,d._1)(this.answers),this.questionList[e].answerResult.answerImage=this.answer_image.map((t=>t.url))),this.setQuestionList(this.questionList),await this.saveQuestion({answerVos:this.answerVos[e]})},onItemInput(t,e){this.timer&&clearTimeout(this.timer),this.timer=setTimeout((()=>{this.answers[e]&&this.saveAnswer()}),500)},onImageChange(t){this.answer_image=t,this.saveAnswer()},onFocus(){window.navigator&&window.navigator.clipboard&&window.navigator.clipboard.writeText(" ").then((()=>{}),(()=>{}))},onInputFocus(){this.setIsFocus(!0)},onInputBlur(){this.setIsFocus(!1)},onHandlePaste:t=>(t.preventDefault(),!1)})}),F=(0,n.Z)(R,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"fill-blank"},[s("div",{staticClass:"answer-container"},[s("question-stem",{attrs:{title:t.result.title,media:t.result.summary,answers:t.answers,result:t.result,type:"fillBlank","show-type":t.showType}}),s("div",{staticClass:"fill-blank-form"},["detail"===t.showType?s("van-cell-group",{attrs:{border:!1}},t._l(t.answers,(function(e,a){return s("div",{key:a,staticClass:"form-item",class:t.getItemClass(e)},[t._v(" "+t._s(e.answer||t.$t("examination.unAnswered"))+" "),e.answer&&"true"===t.paperInfo.showAnalysis&&t.isSystem?s("div",{staticClass:"item-icon"},["false"===e.result?s("SvgIcon",{attrs:{"icon-class":"icon-icon_close",size:16,color:"#FF4D4F"}}):t._e(),"true"===e.result?s("SvgIcon",{attrs:{"icon-class":"icon-danxuanxuanzhong1",size:16,color:"#52C41A"}}):t._e()],1):t._e()])})),0):s("van-cell-group",{attrs:{border:!1}},t._l(t.answers,(function(e,a){return s("van-field",{key:a,attrs:{clearable:!0,label:"",border:!1,placeholder:""+t.$t("examination.blankItem")+(a+1),maxlength:"200"},on:{click:t.onFocus,focus:t.onInputFocus,change:function(e){return t.onItemInput(e,a)},paste:t.onHandlePaste},model:{value:t.answers[a],callback:function(e){t.$set(t.answers,a,e)},expression:"answers[index]"}})})),1)],1)],1),t.showUploadImage?s("div",{staticClass:"answer-upload"},[s("cl-image-upload",{ref:"imgUpload",attrs:{"show-upload":"detail"!==t.showType,"image-list":t.answer_image},on:{change:t.onImageChange,preview:function(e){return t.$store.commit("exam/setIsCutScreen",!1)}}})],1):t._e()])}),[],!1,null,"3fb2a484",null).exports,q={name:"KnowLedge",props:{knowledgeList:{type:Array,default:()=>["代理商靠的就是来得快福建省建省","代理商靠的就是来得","代理商靠的就是来得快福建省建","代理商"]}}},N=(0,n.Z)(q,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"knowledge"},[s("div",{staticClass:"knowledge-title"},[s("svg-icon",{attrs:{"icon-class":"icon-zhishidian",color:"#52C41A",size:16}}),s("span",{staticClass:"title-text"},[t._v(t._s(t.$t("aiStudy.knowledgePoints")))])],1),s("div",{staticClass:"knowledge-content"},t._l(t.knowledgeList,(function(e,a){return s("div",{key:a,staticClass:"point"},[s("span",{staticClass:"point-icon"},[t._v("#")]),s("span",{staticClass:"point-text"},[t._v(t._s(e))])])})),0)])}),[],!1,null,"327b7aa8",null).exports,O={name:"QuestionAnalysis",components:{PictureRow:w},props:{title:{type:String,default:"解析"},content:{type:String|Array,default:""},analysis:{type:Object,default:()=>({image:[]})},desc:{type:String,default:"关键词"},autoHeight:{type:Boolean,default:!1}},computed:{images(){return this.analysis&&this.analysis.image?this.analysis.image:[]}}},M=(0,n.Z)(O,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"question-analysis"},[s("div",{staticClass:"analysis-title"},[t._t("icon"),s("span",{staticClass:"title"},[t._v(t._s(t.title))])],2),t.content&&"string"==typeof t.content?s("div",{staticClass:"analysis-content"},[t._v(t._s(t.content))]):t._e(),Array.isArray(t.content)?s("div",{staticClass:"analysis-content",class:t.autoHeight?"autoHeight":""},t._l(t.content,(function(e,a){return s("div",{key:a,staticClass:"content"},[s("span",{staticClass:"label"},[t._v(t._s(t.desc)+t._s(a+1)+":")]),s("div",{staticClass:"value"},[t._v(" "+t._s(e.title.split("/").filter((function(t){return t})).join("、"))+" ")])])})),0):t._e(),t.images.length?s("picture-row",{attrs:{images:t.images}}):t._e()],1)}),[],!1,null,"44a126c5",null).exports,B=(s(2707),{name:"AnswerCard",props:{result:{type:Object,default:()=>{}}},data:()=>({}),computed:(0,a.Z)((0,a.Z)({},(0,i.mapState)("exam",["paperInfo"])),{},{selectOptions(){const{options:t,type:e,answerResult:s,correctAnswer:a}=this.result,i=[{label:this.$t("examination.successAnswer"),title:"",color:"#52C41A"},{label:this.$t("examination.userAnswer"),title:"",color:""}],{answer:o}=s;return"multiple"===e?(i[0].title=a.split(",").map((e=>({color:"#52C41A",name:(0,d.NK)(t.findIndex((t=>t.option===e)))}))).sort(((t,e)=>t.name.localeCompare(e.name))),i[1].title=o.map((e=>({color:a.indexOf(e)>-1?"#52C41A":"#FF4D4F",name:(0,d.NK)(t.findIndex((t=>t.option===e)))}))).sort(((t,e)=>t.name.localeCompare(e.name)))):(i[1].color=a===o[0]?"#52C41A":"#FF4D4F",t.forEach(((t,s)=>{const r={trueOrFalse:t.title,single:(0,d.NK)(s)};a.indexOf(t.option)>-1&&(i[0].title=r[e]),o.includes(t.option)&&(i[1].title=r[e])}))),0===o.length||o.every((t=>""===t))?"false"===this.paperInfo.showAnalysis?[]:[i[0]]:"false"===this.paperInfo.showAnalysis&&"false"===this.paperInfo.onlyWrongAnalysis?("multiple"===e&&i[1].title.forEach((t=>t.color="#516AE6")),i[1].color="#516AE6",[i[1]]):i},label(){const{answerResult:t}=this.result,{answer:e}=t,s={true:{label:this.$t("examination.success"),color:"#52C41A"},false:{label:this.$t("examination.error"),color:"#FF4D4F"},unAnswered:{label:this.$t("examination.unSelect"),color:"#A6A6A6"}};return 0===e.length||e.every((t=>""===t))?s.unAnswered:s[this.result.result]}})}),V={name:"TopicInfo",components:{TopicTitle:c,ShortAnswer:v,Multiple:T,Single:D,TrueFalse:A,FillBlank:F,Knowledge:N,QuestionAnalysis:M,AnswerCard:(0,n.Z)(B,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"answer-card"},[s("div",{staticClass:"title",style:{color:t.label.color}},[t._v(t._s(t.label.label))]),t.selectOptions.length?s("div",{staticClass:"answer"},t._l(t.selectOptions,(function(e,a){return s("div",{key:a,staticClass:"card-item"},[s("div",{staticClass:"label"},[t._v(t._s(e.label))]),"multiple"===t.result.type?s("div",{staticClass:"multiple-value"},t._l(e.title,(function(e,a){return s("span",{key:a,staticClass:"value",style:{color:e.color}},[t._v(" "+t._s(e.name)+" ")])})),0):s("div",{staticClass:"value",style:{color:e.color}},[t._v(t._s(e.title))])])})),0):t._e()])}),[],!1,null,"1ee807a8",null).exports},props:{result:{type:Object,default:()=>{}},showType:{type:String,default:"exam"}},computed:(0,a.Z)({},(0,i.mapState)("exam",["paperInfo"])),methods:{}},U=(0,n.Z)(V,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"question",class:t.showType},[s("TopicTitle",{attrs:{result:t.result,"show-type":t.showType}}),"shortAnswer"===t.result.type?s("ShortAnswer",{attrs:{result:t.result,"show-type":t.showType}}):t._e(),"multiple"===t.result.type?s("Multiple",{attrs:{result:t.result,"show-type":t.showType}}):t._e(),"trueOrFalse"===t.result.type?s("TrueFalse",{attrs:{result:t.result,"show-type":t.showType}}):t._e(),"single"===t.result.type?s("Single",{attrs:{result:t.result,"show-type":t.showType}}):t._e(),"fillBlank"===t.result.type?s("FillBlank",{attrs:{result:t.result,"show-type":t.showType}}):t._e(),"detail"===t.showType?s("div",{staticClass:"question-detail"},[["single","multiple","trueOrFalse"].includes(t.result.type)?s("AnswerCard",{attrs:{result:t.result}}):t._e(),["fillBlank","shortAnswer"].includes(t.result.type)&&t.result.options.length?s("QuestionAnalysis",{attrs:{title:t.$t("examination.standardAnswer"),desc:"shortAnswer"===t.result.type?t.$t("examination.keyword"):t.$t("examination.blankItem"),content:t.result.options,"auto-height":!0}},[s("SvgIcon",{attrs:{slot:"icon","icon-class":"icon-biaozhundaan",size:14,color:"#1890FF"},slot:"icon"})],1):t._e(),"true"===t.paperInfo.showAnalysis&&t.result.markerComment?s("QuestionAnalysis",{attrs:{title:t.$t("examination.comment"),content:t.result.markerComment}},[s("SvgIcon",{attrs:{slot:"icon","icon-class":"icon-pingyu",size:14,color:"#FFBA04"},slot:"icon"})],1):t._e(),"true"===t.paperInfo.showAnalysis&&(t.result.analysis.title||t.result.analysis.image.length)?s("QuestionAnalysis",{attrs:{title:t.$t("examination.parse"),content:t.result.analysis.title,analysis:t.result.analysis}},[s("SvgIcon",{attrs:{slot:"icon","icon-class":"icon-jiexi",size:14,color:"#FF7130"},slot:"icon"})],1):t._e(),"true"===t.paperInfo.onlyWrongAnalysis&&(t.result.analysis.title||t.result.analysis.image.length)?s("QuestionAnalysis",{attrs:{title:t.$t("examination.parse"),content:t.result.analysis.title,analysis:t.result.analysis}},[s("SvgIcon",{attrs:{slot:"icon","icon-class":"icon-jiexi",size:14,color:"#FF7130"},slot:"icon"})],1):t._e()],1):t._e(),"true"===t.paperInfo.showTag&&t.result.tags&&t.result.tags.length?s("Knowledge",{attrs:{"knowledge-list":t.result.tags}}):t._e()],1)}),[],!1,null,"3f0cf535",null).exports},58453:(t,e,s)=>{s.d(e,{Z:()=>r});var a={name:"DivItem",props:{width:{type:String,default:"100%"},height:{type:String,default:"100%"},className:{type:String,default:""}}},i=s(1001),o={name:"SkeletonScreen",components:{DivItem:(0,i.Z)(a,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"div-item",class:[t.className],style:{width:t.width,height:t.height}})}),[],!1,null,"3ca7da82",null).exports}},r=(0,i.Z)(o,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"skeleton-screen"},[s("div",{staticClass:"flex-between pb-16"},[s("div-item",{attrs:{width:"218px",height:"14px"}}),s("div-item",{attrs:{width:"68px",height:"14px"}})],1),s("div-item",{attrs:{width:"100%",height:"46px"}}),s("div",{staticClass:"shadow"}),s("div-item",{attrs:{width:"79px",height:"14px","class-name":"pb-16"}}),s("div-item",{attrs:{width:"100%",height:"22px","class-name":"pb-12"}}),s("div-item",{attrs:{width:"218px",height:"22px","class-name":"pb-16"}}),s("div",{staticClass:"flex-between pb-24"},t._l(2,(function(t){return s("div-item",{key:t,attrs:{width:"169px",height:"194px"}})})),1),t._l(4,(function(t){return s("div-item",{key:t,attrs:{width:"100%",height:"46px","class-name":"pb-16"}})})),s("div-item",{attrs:{width:"100%",height:"40px"}})],2)}),[],!1,null,"38822e67",null).exports},80176:(t,e,s)=>{s.r(e),s.d(e,{default:()=>O});s(34837);var a=s(39146),i=s(95082),o=(s(31146),s(41610)),r=(s(39610),s(2163)),n=(s(26699),s(56977),s(57658),s(2707),s(32023),s(26294)),c=(s(23711),s(98244)),l={name:"ExamInfo",components:{[c.Z.name]:c.Z},props:{isCutValidate:{type:Boolean,default:!0}},computed:(0,i.Z)((0,i.Z)({},(0,n.mapState)("exam",["questionIndex","cutScreenInfo","questionList","remainingTime"])),{},{completeCutScreenCount(){const{completeCutScreenCount:t,cutScreenCount:e}=this.cutScreenInfo;return t>e?e:t},countTime(){return Number(this.remainingTime)||0}}),methods:{pauseCountTime(){this.$refs.countDown.pause()},startCountTime(){this.$refs.countDown.start()}}},u=s(1001),d=(0,u.Z)(l,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"exam-info"},[s("div",{staticClass:"exam-timer"},[s("span",{staticClass:"title"},[t._v(" "+t._s(t.$t("examination.interval"))+"：")]),s("van-count-down",{ref:"countDown",attrs:{time:t.countTime,"auto-start":!1}})],1),"custom"===t.cutScreenInfo.cutScreenRule&&t.isCutValidate?s("div",{staticClass:"exam-cunt"},[s("span",{staticClass:"title"},[t._v(" "+t._s(t.$t("examination.cutScreenCount"))+"：")]),s("span",{staticClass:"count"},[s("span",{staticClass:"already-count active"},[t._v(t._s(t.completeCutScreenCount))]),t._v("/"),s("span",[t._v(t._s(t.cutScreenInfo.cutScreenCount))])])]):t._e(),s("div",{staticClass:"topic-number"},[t._v(" "+t._s(t.$t("examination.topicTime"))),s("span",{staticClass:"count active"},[t._v(t._s(t.questionIndex))]),t._v("/"),s("span",{staticClass:"count"},[t._v(t._s(t.questionList.length))]),t._v(t._s(t.$t("examination.topicUnit"))+" ")])])}),[],!1,null,"d294c60e",null).exports,h=s(6132),p=s(84553),m=(s(25773),s(35791)),g=s(22648),v=s(96838),f=s(23493),y=s.n(f),_={name:"ExamAction",components:{[m.Z.name]:m.Z},data:()=>({docmHeight:window.innerHeight,showHeight:window.innerHeight,showFooter:!0}),computed:(0,i.Z)((0,i.Z)((0,i.Z)({},(0,n.mapState)("exam",["questionIndex","answerVos","questionList","isFocus"])),(0,n.mapState)(["themeColor"])),{},{nextVisible(){return this.questionIndex<this.questionList.length},prevVisible(){return this.questionIndex>1},primaryColor(){return this.themeColor.primaryColor},isIpx:()=>"ios"===(0,g.Os)()}),watch:{showHeight:function(t){this.showFooter=this.docmHeight<=t}},beforeDestroy(){this.$dialog.close()},mounted(){window.onresize=()=>(()=>{this.showHeight=window.innerHeight})()},methods:(0,i.Z)((0,i.Z)({},(0,n.mapMutations)("exam",["setQuestionIndex","setSubmitStatus"])),{},{onPaperChange:y()((function(t){const e=this.questionIndex+t;this.setQuestionIndex(e)}),200),onPaperSubmit(){this.$toast.loading({forbidClick:!0,duration:0}),setTimeout((()=>{let t=0;this.answerVos.forEach((e=>{(0===e.answer.length||e.answer.every((t=>""===t)))&&0===e.answer_image.length&&t++}));const e={scene:"exam-action",answerVos:this.answerVos,unAnsweredCount:t,questionIndex:this.questionIndex};v.Z.logger({moduleName:"examSubmitClick",data:(0,i.Z)((0,i.Z)({},e),{},{currentTime:(0,g.p6)((new Date).getTime(),"yyyy/MM/dd  hh:mm")})});const s=t>0?`${this.$t("examination.unAnsweredTips",{count:`<span class="count">${t}</span>`})}\n${this.$t("examination.submitPaperTips")}`:this.$t("examination.submitPaperTips");this.$toast.clear(),this.$dialog.confirm({title:"",message:s,className:"submit-dialog",getContainer:()=>document.querySelector(".exam-detail"),confirmButtonText:this.$t("common.confirm"),cancelButtonText:this.$t("common.cancel"),confirmButtonColor:"#FF4D4F"}).then((()=>{this.$dialog.close(),v.Z.logger({moduleName:"submitOK",data:(0,i.Z)((0,i.Z)({},e),{},{currentTime:(0,g.p6)((new Date).getTime(),"yyyy/MM/dd  hh:mm")})}),this.setSubmitStatus("manual"),this.$emit("submit")}))}),1e3)}})},C=(0,u.Z)(_,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.showFooter?s("div",{class:{"exam-action":!0,"ios-bottom":t.isIpx&&!t.isFocus}},[1!==t.questionList.length?s("div",{staticClass:"page-action prev",class:{disabled:!t.prevVisible},on:{click:function(){return t.onPaperChange(-1)}}},[s("svg-icon",{attrs:{"icon-class":"icon-arrow-l1",size:12,color:t.prevVisible?t.primaryColor:"#d8d7d7"}}),t._v(" "+t._s(t.$t("examination.prevExam"))+" ")],1):t._e(),t.nextVisible?t._e():s("van-button",{class:{only:1===t.questionList.length},attrs:{color:t.primaryColor},on:{click:function(e){return e.preventDefault(),t.onPaperSubmit.apply(null,arguments)}}},[t._v(" "+t._s(t.$t("buttons.submitExams"))+" ")]),t.nextVisible?s("div",{staticClass:"page-action next",on:{click:function(){return t.onPaperChange(1)}}},[t._v(" "+t._s(t.$t("examination.nextExam"))+" "),s("svg-icon",{attrs:{"icon-class":"icon-arrow-r1",size:12,color:t.primaryColor}})],1):t._e()],1):t._e()}),[],!1,null,"46ca8f81",null).exports,I=s(24357),b={name:"CustomToast",props:{config:{type:Object,default:()=>({visible:!1,status:"cut"})}},data:()=>({isTimeOut:!1,toastTimeOut:null}),computed:(0,i.Z)((0,i.Z)({},(0,n.mapState)("exam",["cutScreenInfo"])),{},{count(){const{completeCutScreenCount:t=0,cutScreenCount:e=0}=this.cutScreenInfo,s=e-t;return s<0?0:s}}),watch:{config:{handler(){this.toastTimeOut&&clearTimeout(this.toastTimeOut),this.config.visible&&(this.toastTimeOut=setTimeout((()=>{this.isTimeOut=!0}),5e3))},deep:!0,immediate:!0}},methods:{hideToast(){this.isTimeOut&&this.$emit("close")}}},w=(0,u.Z)(b,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"custom-toast",on:{click:function(e){return e.target!==e.currentTarget?null:function(){return t.hideToast()}.apply(null,arguments)}}},[s("div",{staticClass:"toast"},["cutting"===t.config.status?s("div",{staticClass:"toast-content"},[t._v(" "+t._s(t.$t("examination.cutTips1"))),s("span",{staticStyle:{margin:"0 4px"}},[t._v(t._s(t.count))]),t._v(t._s(t.$t("examination.times"))+" ")]):t._e(),"cut"===t.config.status?s("div",[t._v(" "+t._s(t.$t("examination.cutTips2"))),s("span",{staticStyle:{margin:"0 4px"}},[t._v(t._s(t.count))]),t._v(t._s(t.$t("examination.cutTipsSubmit"))+" ")]):t._e(),"disable"===t.config.status?s("div",[t._v(" "+t._s(t.$t("home.exam"))),s("span",[t._v(t._s(t.$t("examination.examCutDisabled")))]),t._v("，"+t._s(t.$t("examination.cutResult"))+" ")]):t._e(),s("div",{staticClass:"toast-icon",on:{click:function(){return t.$emit("close")}}},[s("svg-icon",{attrs:{"icon-class":"icon-guanbi",size:24,color:"#FFF"}})],1)])])}),[],!1,null,"0e18d48e",null).exports,$=s(58453),k=s(83337),S=s.n(k),T={data:()=>({}),computed:(0,i.Z)({},(0,n.mapState)("exam",["questionIndex","questionList"])),mounted(){this.$nextTick((()=>{this.initFinger()}))},methods:(0,i.Z)((0,i.Z)({},(0,n.mapMutations)("exam",["setQuestionIndex"])),{},{getContainer(){return this.$refs.touchRef},initFinger(){const t=this;new(S())(this.$refs.touchRef,{swipe:function(e){if(["Left","Right"].includes(e.direction)){const s="Left"===e.direction?1:-1,a=t.questionIndex+s;a<=t.questionList.length&&a>0&&t.setQuestionIndex(a)}}})}})},Z=(0,u.Z)(T,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{ref:"touchRef",staticClass:"touch-wrapper"},[t._t("default")],2)}),[],!1,null,"95c019b4",null).exports,x=s(85566),P=s(95969),D=s(27632),L=s(61378),A=s(43286),E=s(14027),R=s(65184),F=s(67992),q=s(68092),N={name:"Exam",components:{ExamInfo:d,QuestionSelector:h.Z,Question:p.Z,ExamAction:C,ClWaterMark:I.Z,SkeletonScreen:$.Z,TouchWrapper:Z,CutToast:w,[r.Z.name]:r.Z},beforeRouteLeave(t,e,s){const{completeCutScreenCount:a,cutScreenCount:i}=this.cutScreenInfo;let r=!1;if(this.paperInfo){const{endTime:t,unlimited:e}=this.paperInfo;r="false"===e&&Number(t)<=Date.now()}const n=this.remainingTime<=0,c=a>i,l="/exam-result"===t.path;this.$toast.clear(),l||!this.showPaper||n||c||r?s():(this.leaveTimeout&&clearTimeout(this.leaveTimeout),this.leaveTimeout=setTimeout((()=>{this.$dialog.confirm({title:this.$t("examination.exitExamTitleTips"),message:this.$t("examination.exitExamContentTips"),getContainer:()=>document.querySelector(".exam-detail"),confirmButtonColor:"#FF4D4F",confirmButtonText:this.$t("common.confirm"),cancelButtonText:this.$t("common.cancel")}).then((()=>{this.$dialog.close(),this.isCutValidate&&this.handleCutScreen(),s()})).catch((()=>{s(!1),this.$dialog.close(),(0,g.Td)(this.$t("pageTitle.examIng")),this.recognitionFlag&&o.Z.confirm({message:"init"===this.prepareStatus?this.$t("faceKnow.taskFaceTip"):this.$t("faceKnow.checkFailTip"),confirmButtonText:"init"===this.prepareStatus?this.$t("faceKnow.gotoKnow"):this.$t("faceKnow.reCheck"),showCancelButton:!1,beforeClose:(t,e)=>{"confirm"===t&&(e(!1),this.handleChooseImg())}})}))}),200))},data:()=>({cutToastInfo:{visible:!1,status:"cut",interval:0},loading:!0,showPaper:!1,isDisable:!1,leaveTimeout:null,redirectTimeout:null,remainingTimeout:null,examFaceType:"",randomTimeList:[],recognitionFlag:!1,prepareStatus:"",timeLimit:0,numTimes:0,showIntro:!1,startx:0,endx:0,showMask:!1,questionItem:null,transformClass:"",bs:null,preExamEndTime:0}),computed:(0,i.Z)((0,i.Z)((0,i.Z)({},(0,n.mapState)("exam",["questionIndex","answerVos","submitStatus","questionList","isCutScreen","cutScreenInfo","isFocus","requireBankIds","currentViewQuestion","remainingTime"])),(0,n.mapState)(["appVisible","themeColor"])),{},{query(){const{examId:t,taskId:e,selfChooseBank:s}=this.$route.query;return{examId:t,taskId:e,selfChooseBank:s}},isCutValidate:()=>["dingTalk","app","wechat_qy"].includes(D.Z.env)||"app"===D.Z.specialEnv,primaryColor(){return this.themeColor.primaryColor}}),watch:{questionIndex(t,e){const s=this.questionList.findIndex((e=>e.orderId===t));this.$nextTick((()=>{this.questionItem=this.questionList[s],document.querySelector(".touch-wrapper").scrollTop=0,this.transformClass=t>e?"slide-left":"slide-right"}))},questionItem(){this.initScroll()},remainingTime(){this.remainingTime<=0&&(clearTimeout(this.remainingTimeout),document.removeEventListener("visibilitychange",this.handlePageVisible),this.showMask=!0),this.autoSubmitListener()},cutScreenInfo(t){const{completeCutScreenCount:e,cutScreenCount:s,cutScreenRule:a}=t;"unlimited"!==a&&e>s&&(this.setSubmitStatus("screenAuto"),this.onPaperSubmit())},appVisible(t){this.isCutValidate&&this.handleRemainingTime(!t),"unlimited"!==this.cutScreenInfo.cutScreenRule&&(this.isCutScreen||!t?t&&(this.autoSubmitListener(),this.isCutValidate&&this.handleCutScreen()):this.setIsCutScreen(!0))},recognitionFlag(){this.showMask=(0,F.i3)()&&this.recognitionFlag}},mounted(){this.getPaperInfo()},beforeDestroy(){document.removeEventListener("visibilitychange",this.handlePageVisible),this.$toast.clear(),this.$dialog.close(),(0,L.Z)().exit(!0),this.remainingTimeout&&clearTimeout(this.remainingTimeout),this.leaveTimeout&&clearTimeout(this.leaveTimeout),this.redirectTimeout&&clearTimeout(this.redirectTimeout),localStorage.setItem("examHideTime",0),this.$refs.examInfo&&this.$refs.examInfo.pauseCountTime(),"app"===D.Z.env&&D.Z.onActiveChange((()=>{})),this.bs&&this.bs.destroy()},methods:(0,i.Z)((0,i.Z)({},(0,n.mapMutations)("exam",["setPaperInfo","setAnswerVos","setQuestionIndex","setCutScreenInfo","setSubmitStatus","setQuestionList","setIsCutScreen","setRemainingTime"])),{},{handlePageVisible(){if(!this.isCutValidate&&this.remainingTime>0){const t="hidden"===document.visibilityState;this.handleRemainingTime(t)}},handleRemainingTime(t){if(t)clearTimeout(this.remainingTimeout),localStorage.setItem("examHideTime",Date.now());else{const t=localStorage.getItem("examHideTime"),e=Date.now(),s=e-t;let a=0,{remainingTime:i}=this;const{completeCutScreenCount:o,cutScreenCount:r,cutScreenRule:n}=this.cutScreenInfo||{};if(v.Z.logger({moduleName:"cutScreenInterval",data:{cutScreenInterval:s/1e3+"s",cutScreenIntervalSettingValue:`${this.cutToastInfo.interval}s`,endCutScreenTimeStamp:e,startCutScreenTimeStamp:t,completeCutScreenCount:o,cutScreenCount:r,cutScreenRule:n}}),s<=1e3*this.cutToastInfo.interval&&this.setIsCutScreen(!1),i>0&&(a=s<i?i-s:0,this.setRemainingTime(a),this.startExam(),!this.recognitionFlag)){const t=Number(Math.fround(this.remainingTime/1e3).toFixed(0));"frequency"===this.examFaceType?this.setRandomList(t):"interval"===this.examFaceType&&this.setFaceNumList(t,this.timeLimit)}}},getPaperInfo(){const{examId:t,taskId:e,selfChooseBank:s}=this.query;let a={};a=(0,q.UI)("EXAM_BANK_CONFIG")&&"true"===s?{bankIds:this.requireBankIds,examId:t,taskId:e,isMaiTian:!0}:{examId:t,taskId:e},x.Z.loadPaper(a).then((t=>{this.loading=!1,this.paperInfo=t.data,this.setPaperInfo(t.data);const{cutScreenVo:e,remainingTime:s,faceSnapshotRule:a,entryPopup:o,snapshotSuccessCount:r}=t.data,n=Date.now()+1e3*s;this.preExamEndTime=n;const c=t.data.questionList.map((t=>(0,i.Z)((0,i.Z)({},t),{},{answerResult:t.answerResult?t.answerResult:{answer:[],answerImage:[]}}))),l=c.map((t=>({answer_id:t.answerId,id:t.id,answer:Array.isArray(t.answerResult.answer)?(0,R._1)(t.answerResult.answer):[],answer_image:Array.isArray(t.answerResult.answerImage)?(0,R._1)(t.answerResult.answerImage):[]})));this.setQuestionList(c),this.questionItem=c[0],this.setCutScreenInfo({cutScreenCount:e.cutScreenCount,cutScreenRule:e.cutScreenRule,completeCutScreenCount:e.completeCutScreenCount}),this.isCutValidate&&("custom"===e.cutScreenRule&&(this.$set(this.cutToastInfo,"visible",!0),this.$set(this.cutToastInfo,"status","cut"),this.$set(this.cutToastInfo,"interval",e.cutScreenInterval)),"disable"===e.cutScreenRule&&(this.$set(this.cutToastInfo,"visible",!0),this.$set(this.cutToastInfo,"status","disable"),this.$set(this.cutToastInfo,"interval",e.cutScreenInterval))),this.setAnswerVos(l),"true"===o&&this.getPaperFaceInfo(),this.computeRemainingTime(n,s,"loadPaper"),a&&"true"===a.faceProcessSwitch?"frequency"===a.faceProcessType?(this.examFaceType="frequency",this.numTimes=a.faceProcessValue-r,"true"!==o&&this.setRandomList(s)):"interval"===a.faceProcessType&&(this.examFaceType="interval",this.timeLimit=a.faceProcessValue,"true"!==o&&this.setFaceNumList(s,a.faceProcessValue)):this.examFaceType="",this.showPaper=c.length>0,this.showPaper&&this.setQuestionIndex(1),this.startExam(),document.addEventListener("visibilitychange",this.handlePageVisible),this.handleTextCopyDisabled()})).catch((t=>{this.loading=!1,this.$toast.clear();const{code:e}=t;e&&E.CR[e]&&this.$dialog.confirm({title:E.CR[e],message:"",getContainer:()=>document.querySelector(".exam-detail"),confirmButtonColor:this.primaryColor,confirmButtonText:this.$t("common.close"),showCancelButton:!1}).then((()=>{const{pageSource:t,pageSourceId:e}=this.$route.query;switch(this.$dialog.close(),t){case"studyProject":P.Z.exam.redirectToProjectDetail(e);break;case"task":P.Z.exam.redirectToStudyDetail({studyId:e,origin:"vue"});break;case"certificationDetails":P.Z.exam.redirectToCertificationDetail(e);break;default:P.Z.exam.redirectToExamList()}}))}))},initScroll(){this.$nextTick((()=>{this.bs?this.bs.refresh():this.bs=new A.ZP(document.querySelector(".touch-wrapper"),{probeType:3,click:!0,tap:!0,scrollY:!0})}))},getPaperFaceInfo(){this.recognitionFlag=!0,this.prepareStatus="init",this.showFaceKnowTip()},setRandomList(t){const e=t;if(e>60){const t=Math.floor((e-60)/130);let s=this.numTimes;t<this.numTimes&&(s=t);const a=[];for(let t=0;t<s;t++){let t=this.newNumber(e);if(this.isSatisfyCondition(a,t))for(;this.isSatisfyCondition(a,t);)t=this.newNumber(e);a.push(t)}this.randomTimeList=a.sort(((t,e)=>e-t)),this.getConsole()}},isSatisfyCondition(t,e){for(let s=0;s<t.length;s++)if(Math.abs(e-t[s])<=120)return!0;return!1},newNumber(t){let e=t-61;return Math.round(Math.random()*e)+61},setFaceNumList(t,e=2){const s=60*e;let a=t;const i=Math.floor(a/s),o=[];for(let t=0;t<i;t++)a-s>30&&(o.push(a-s),a-=s);this.randomTimeList=o.sort(((t,e)=>e-t)),this.getConsole()},getConsole(){const t=[];this.randomTimeList.forEach((e=>{const s=this.timeTranslate(e);t.push(s)})),v.Z.logger({moduleName:"process_face",data:{exam_id:this.query.examId,submit_id:this.paperInfo.submitId,user_id:this.$store.state.commonParams.userId,remainingTime:this.timeTranslate(this.remainingTime/1e3),list:t,dataKey:"process_face"}})},timeTranslate:t=>`${Math.floor(t/60)}:${t%60}`,computeRemainingTime(t=this.preExamEndTime,e=this.remainingTime,s="startExam"){const a=Date.now(),i=(t-a).toFixed(0);this.setRemainingTime(i),i<=0&&v.Z.logger({moduleName:`${s}RecordRemainingTimeInfo`,data:{preExamEndTime:t,currentTimeStamp:a,computeRemainingTime:i,remainingTime:e}})},startExam(){this.$refs.examInfo&&this.$refs.examInfo.startCountTime(),this.remainingTimeout&&clearTimeout(this.remainingTimeout),this.remainingTimeout=setTimeout((()=>{this.computeRemainingTime();const t=Number(Math.fround(this.remainingTime/1e3).toFixed(0));if(!this.recognitionFlag&&this.randomTimeList.length)for(let e=0;e<this.randomTimeList.length;e++)if(t-this.randomTimeList[e]==0){this.recognitionFlag=!0,this.prepareStatus="init",this.showFaceKnowTip();break}this.remainingTime<=0?clearTimeout(this.remainingTimeout):this.startExam()}),1e3)},showFaceKnowTip(){(0,F.i3)()&&(this.$store.commit("face/setFaceStatus","idle"),x.Z.setFaceStatus({examId:this.query.examId,userId:this.$store.state.commonParams.userId,submitId:this.paperInfo.submitId,status:"init"}),o.Z.confirm({title:this.$t("common.reminder"),message:this.$t("faceKnow.taskFaceTip"),confirmButtonText:this.$t("faceKnow.gotoKnow"),showCancelButton:!1,beforeClose:(t,e)=>{"confirm"===t&&(e(!1),this.handleChooseImg())}}))},handleChooseImg(){(0,F.ch)({successPath:t=>{this.recognitionFlag=!1,this.prepareStatus="",a.Z.success(`${this.$t("faceKnow.checkPass")}\n${this.$t("faceKnow.pleaseAnswer")}`),x.Z.setFaceStatus({examId:this.query.examId,userId:this.$store.state.commonParams.userId,submitId:this.paperInfo.submitId,snapshotUrl:t,status:"success"});const e=Number(Math.fround(this.remainingTime/1e3).toFixed(0));"frequency"===this.examFaceType?(this.numTimes&&(this.numTimes-=1),this.setRandomList(e)):"interval"===this.examFaceType&&this.setFaceNumList(e,this.timeLimit)},failRequest:t=>{this.prepareStatus="during",x.Z.setFaceStatus({examId:this.query.examId,userId:this.$store.state.commonParams.userId,submitId:this.paperInfo.submitId,snapshotUrl:t,status:"failed"})},failDiscernPath:()=>{this.prepareStatus="during"},hasSetFace:!0})},submitLogger(){v.Z.logger({moduleName:"examSubmit",examId:this.paperInfo.id,taskId:this.paperInfo.taskId,submitStatus:this.submitStatus,submitId:this.paperInfo.submitId,answerVos:this.answerVos})},redirectToExamData(){const{pageSource:t,pageSourceId:e}=this.$route.query;P.Z.exam.enterExamData({examId:this.paperInfo.id,taskId:this.paperInfo.taskId,submitId:this.paperInfo.submitId,from:"result",pageSource:t,pageSourceId:e})},autoSubmitListener(){const{endTime:t,unlimited:e}=this.paperInfo,s=Date.now(),a={endTime:t,unlimited:e,remainingTime:this.remainingTime,currentTime:s};this.remainingTime<=0&&(v.Z.logger({moduleName:"autoSubmitRecord",data:(0,i.Z)((0,i.Z)({},a),{},{scene:"timeAuto"})}),this.setSubmitStatus("timeAuto"),this.onPaperSubmit()),"false"===e&&Number(t)<=s&&(v.Z.logger({moduleName:"autoSubmitRecord",data:(0,i.Z)((0,i.Z)({},a),{},{scene:"durationAuto"})}),this.setSubmitStatus("durationAuto"),this.onPaperSubmit())},async handleCutScreen(){const{completeCutScreenCount:t,cutScreenCount:e,cutScreenRule:s}=this.cutScreenInfo;if("unlimited"===s)return;if("disable"===s)return this.setSubmitStatus("screenAuto"),void this.onPaperSubmit();const{code:a}=await x.Z.saveScreenCut({examId:this.query.examId,taskId:this.paperInfo.taskId||this.query.taskId,submitId:this.paperInfo.submitId});if("200000"===a){if(this.setCutScreenInfo((0,i.Z)((0,i.Z)({},this.cutScreenInfo),{},{completeCutScreenCount:t+1})),v.Z.logger((0,i.Z)({moduleName:"examCutting",completeCutScreenCount:t+1,cutScreenCount:e,currentTime:(0,g.p6)((new Date).getTime(),"yyyy/MM/dd  hh:mm")},this.query)),t>e)return this.setSubmitStatus("screenAuto"),void this.onPaperSubmit();this.$set(this.cutToastInfo,"visible",!0),this.$set(this.cutToastInfo,"status","cutting")}},handleTextCopyDisabled(){this.$nextTick((()=>{const{examRef:t}=this.$refs;t.oncontextmenu=new Function("event.returnValue=false"),t.onselectstart=new Function("event.returnValue=false"),t.oncontextmenu=function(t){t.preventDefault()},t.onselectstart=function(t){t.preventDefault()},t.addEventListener("contextmenu",(t=>{t.preventDefault()})),t.ontouchend=function(){}}))},onPaperSubmit:y()((function(){this.$toast.loading({duration:0,message:this.$t("examination.submitPapers"),forbidClick:!0}),x.Z.submitPaper({examId:this.paperInfo.id,taskId:this.paperInfo.taskId,submitStatus:this.submitStatus.includes("Auto")?"automatic":"manual",submitId:this.paperInfo.submitId,answerVos:this.answerVos}).then((()=>{o.Z.close(),this.handleExamDataClear(),this.submitLogger(),this.redirectToExamData()})).catch((t=>{const{code:e}=t;if(this.handleExamDataClear(),e){if(["600010","600015"].includes(e))return this.setSubmitStatus(e),this.submitLogger(),this.redirectTimeout&&clearTimeout(this.redirectTimeout),void(this.redirectTimeout=setTimeout((()=>{this.redirectToExamData()}),1500));this.setSubmitStatus(""),this.$toast({message:this.$t("examination.submitError"),duration:2e3,forbidClick:!0})}}))}),500),handleExamDataClear(){clearTimeout(this.remainingTimeout),localStorage.setItem("examHideTime",0),this.$refs.examInfo.pauseCountTime(),this.$set(this.cutToastInfo,"visible",!1),this.$toast.clear()},onScrollIntroShow(){this.showIntro=!0,document.hasOwnProperty("ontouchstart")?(document.body.addEventListener("touchstart",(t=>{this.startx=t.touches[0].pageX})),document.body.addEventListener("touchend",(t=>{this.endx=t.touches[0].pageX,this.endx-this.startx>10&&(this.showIntro=!1)}))):document.body.addEventListener("click",(()=>{this.showIntro=!1}))}})},O=(0,u.Z)(N,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"examRef",staticClass:"exam-detail",class:{isFocus:t.isFocus}},[t.loading?s("SkeletonScreen"):t._e(),t.showMask?s("div",{staticClass:"full-mask"}):t._e(),t.showPaper?s("div",{staticClass:"detail-wrapper"},[s("van-sticky",[s("div",{staticClass:"sticky-container"},[s("exam-info",{ref:"examInfo",attrs:{"is-cut-validate":t.isCutValidate}}),s("question-selector",{on:{submit:t.onPaperSubmit,showScrollIntro:t.onScrollIntroShow}})],1)]),s("touch-wrapper",{directives:[{name:"show",rawName:"v-show",value:t.questionItem,expression:"questionItem"}],ref:"touchWrapperRef"},[s("div",{key:t.questionItem.id,class:[t.transformClass,t.questionItem.id,"topic-wrapper"],attrs:{id:t.questionItem.id}},[s("Question",{attrs:{result:t.questionItem}}),t.showIntro?s("div",{staticClass:"scroll-intro"},[s("svg-icon",{attrs:{"icon-class":"icon-shoushihuadong",color:"#fff",size:50}}),s("span",[t._v(t._s(t.$t("examGuide.switchQuestionGuide")))])],1):t._e(),s("cl-water-mark",{attrs:{scenes:"exam"}}),t.showIntro?s("div",{staticClass:"scroll-intro"},[s("svg-icon",{attrs:{"icon-class":"icon-shoushihuadong",color:"#fff",size:50}}),s("span",[t._v(t._s(t.$t("examGuide.switchQuestionGuide")))])],1):t._e()],1)]),s("exam-action",{on:{submit:t.onPaperSubmit}}),t.cutToastInfo.visible?s("CutToast",{attrs:{config:t.cutToastInfo},on:{close:function(e){return t.$set(t.cutToastInfo,"visible",!1)}}}):t._e()],1):t._e()],1)}),[],!1,null,"5bcca217",null).exports},15395:(t,e,s)=>{s.r(e),s.d(e,{default:()=>d});var a=s(95082),i=(s(25773),s(35791)),o=(s(33948),s(26294)),r=s(95969),n=s(46933),c=s(40848),l=s(22648),u={name:"ExamTransit",components:{Button:i.Z},data:()=>({error:null}),computed:(0,a.Z)({},(0,o.mapGetters)({primaryColor:"getPrimaryColor"})),mounted(){this.init()},methods:{async init(){const{examId:t="2289859960315711488",taskId:e=""}=this.$route.query,[s,a]=await(0,l.Kb)(n.Z.checkStatus({examId:t}));if(s&&s.data){const{code:t}=s.data,e=(0,c.ZP)({},{});return this.$toast({message:this.$t(e[t].content||"examAnswerDevice.checkError"),duration:2e3}),void setTimeout(this.handleToExamList(),1500)}const{data:{can_exam:i,has_submited:o,show_result:u},code:d}=a.data||{};"200000"===d?"true"===u?"true"===i&&"false"===o?r.Z.exam.enterExamInstruction({examId:t,taskId:e}):r.Z.exam.enterExamData({examId:t,taskId:e}):"true"===i?r.Z.exam.enterExamInstruction({examId:t,taskId:e}):this.handleToExamList():this.handleToExamList()},handleToExamList(){r.Z.exam.redirectToExamList()}}},d=(0,s(1001).Z)(u,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"exam-transit"},[t.error?s("img",{staticClass:"imgs",attrs:{src:"https://oss.coolcollege.cn/1826609511331401728.png"}}):t._e(),t.error?s("div",{staticClass:"tips"},[t._v(t._s(t.$t(t.error.content))+" ")]):t._e(),t.error?s("Button",{attrs:{color:t.primaryColor},on:{click:t.handleToExamList}},[t._v(t._s(t.$t("share.backExamList")))]):t._e()],1)}),[],!1,null,"61df67da",null).exports},99007:(t,e,s)=>{s.r(e),s.d(e,{default:()=>y});s(31146);var a=s(41610),i=s(95082),o=(s(49153),s(5944)),r=(s(74916),s(15306),s(57658),s(33948),s(26699),s(26294)),n=s(22648),c=s(78551),l=s(67992),u=s(95969),d=s(1313),h=s(46933),p=s(27632),m=s(5633),g=s(68092),v=s(96838),f={components:{SvgIcon:c.Z,Empty:o.Z},beforeRouteLeave(t,e,s){this.$toast.clear(),s()},data(){return{ASSETS_OSS_HOST,examInfo:{},examInfosData:[],cardLists:[{title:this.$t("examination.examTotalScore"),type:"total_score",icon:"icon-kaoshizongfen",val:"",units:this.$t("myRating.point"),color:"#FF7130"},{title:this.$t("examination.passScore"),type:"passing_score",icon:"icon-jigefenshu",val:"",units:this.$t("myRating.point"),color:"#70B78E"},{title:this.$t("examination.examDuration"),type:"exam_duration",icon:"icon-datishichang",val:"",units:this.$t("mineScore.minutes"),color:"#C08564"},{title:this.$t("examination.passGetScore"),type:"passed",icon:"icon-jigehuodexuefen",val:"",units:this.$t("myRating.point"),color:"#6DD400"},{title:this.$t("examination.failGetScore"),type:"failed",icon:"icon-bujigehuodexuefen",val:"",units:this.$t("myRating.point"),color:"#FF4D4F"},{title:this.$t("examination.absenceGetScore"),type:"absence",icon:"icon-quekaohuodexuefen",val:"",units:this.$t("myRating.point"),color:"#FAAD14"},{title:this.$t("examination.examItems"),type:"exam_times_vo",icon:"icon-kaoshicishu",val:"",units:this.$t("common.times"),color:"#4268FF"},{title:this.$t("examination.cutScreenCount"),type:"cut_screen_vo",icon:"icon-qiepingcishu",val:"",units:this.$t("common.frequency"),color:"#40CBE0"},{title:this.$t("examination.passGetCer"),type:"certificate_vo",icon:"icon-xingzhuangjiehe",val:"",units:"",color:"#9766CD"}],showContent:"",isSelfSelectedBank:!1}},computed:(0,i.Z)((0,i.Z)({},(0,r.mapGetters)({primaryColor:"getPrimaryColor",userInfo:"user/getUserInfo"})),{},{isIpx:()=>"ios"===(0,n.Os)()}),mounted(){this.funGetInfos()},methods:{formatDateRange(t){return"true"===t.unlimited?this.$t("examination.notLimitLabel"):(0,n.t6)(t.begin_time,t.end_time)},formatClass(t,e){let s="three";switch(t){case 1:s="one";break;case 2:case 4:s="four";break;case 3:case 6:case 7:case 8:case 9:s="three";break;case 5:s=e<3?"three":"three-two"}return s},getFaceInfoAuthorization(){const{scan:t}=this.$route.query;"true"===localStorage.getItem("faceAuthorization")||"app"!==p.Z.env&&"dingTalk"!==p.Z.env&&"wechat_qy"!==p.Z.env||a.Z.confirm({title:this.$t("common.reminder"),message:this.$t("faceKnow.authorizationTip"),confirmButtonText:this.$t("attestation.agree"),cancelButtonText:this.$t("common.cancel")}).then((()=>{localStorage.setItem("faceAuthorization","true")})).catch((()=>{t?this.$router.replace(u.Z.message.homeModule()):history.go(-1)}))},async funGetInfos(){const{examId:t,taskId:e}=this.$route.query;try{let s=await h.Z.getExamTaskInfo({examId:t,taskId:e});"200000"===s.data.code?(this.showContent=!0,this.examInfo=(0,i.Z)({},s.data.data),"true"===this.examInfo.face_recognition&&this.getFaceInfoAuthorization(),this.formatCardData(s.data.data),(0,g.UI)("EXAM_BANK_CONFIG")&&this.selfSelectedBank(s.data.data)):this.showContent=!1}catch(t){this.showContent=!1}},formatCardData(){const{examInfo:t,cardLists:e}=this;let s=[];e.forEach((e=>{if("cut_screen_vo"===e.type){let s=t.cut_screen_vo.cut_screen_rule;if("unlimited"===s)e.val=this.$t("examination.unlimitedTimes"),e.units="";else if("disable"===s)e.val=this.$t("examination.notAllow"),e.units="";else if("custom"===s){let s=t.cut_screen_vo.complete_cut_screen_count;t.cut_screen_vo.complete_cut_screen_count>t.cut_screen_vo.cut_screen_count&&(s=t.cut_screen_vo.cut_screen_count),e.val=`${s}/${t.cut_screen_vo.cut_screen_count}`}}else if("exam_times_vo"===e.type){let s=t.exam_times_vo.answer_rule;"unlimited"===s?(e.val=this.$t("examination.unlimitedTimes"),e.units=""):"stopWhenPassed"===s?(e.val=this.$t("examination.terminationAfterPassing"),e.units=""):"custom"===s&&(e.val=`${t.exam_times_vo.complete_makeup_count}/${t.exam_times_vo.makeup_count}`)}else if("certificate_vo"===e.type)"true"===t.certificate_vo.show?e.val=t.certificate_vo.certificate_name:e.val="";else if("passed"===e.type||"failed"===e.type||"absence"===e.type){let{absence:s,passed:a,failed:i,type:o}=t.reward_rule_vo;"score"===o?"passed"===e.type&&"true"===a.checked?e.val=a.score:"failed"===e.type&&"true"===i.checked?e.val=i.score:"absence"===e.type&&"true"===s.checked?e.val=s.score:e.val=null:e.val=null}else e.val=t[e.type];if(null!==e.val&&""!==e.val){if(("total_score"===e.type||"passing_score"===e.type)&&0===e.val)return;s.push(e)}})),this.examInfosData=[...s]},checkExamSupport(){const{examInfo:t}=this,{cut_screen_vo:e,answer_device:s}=t,a=s&&"pc"===s;if(!(0,g.UI)("EXAM_ANSWER_IN_PC")&&!a){{const t=e&&"unlimited"!==e.cut_screen_rule,s=["dingTalk","app"].includes(p.Z.env)||"app"===p.Z.specialEnv;if(t&&!s)return void this.$toast(this.$t("examAnswerDevice.cutScreenTip"))}return!0}this.$toast({duration:3e3,message:(0,g.UI)("EXAM_ANSWER_IN_PC")?this.$t("examination.examAnswerInPC"):this.$t("examAnswerDevice.onlyPCTip"),forbidClick:!0})},async handleCheckExam(){const t=this.$createElement;try{const{examId:e,taskId:s}=this.$route.query;let{data:o}=await h.Z.checkStatus({examId:e,taskId:s});if("200000"===o.code){this.examInfo=(0,i.Z)((0,i.Z)({},this.examInfo),{},{face_recognition:o.data&&o.data.need_face_popup,answer_device:o.data&&o.data.answer_device});const t=this.checkExamSupport();if(console.warn({isSupport:t}),!t)return;const e=o.data&&o.data.exam_result;d.Z.queryFace().then((t=>{console.warn(t,"response"),this.funToExam("true"===t.data.result,e)}))}else a.Z.alert({title:t("p",{class:"exam-dialog-title"},[this.$t("examination.groupFailed")]),message:this.$t("examination.linkManager"),confirmButtonText:this.$t("common.close"),confirmButtonColor:"rgba(0, 0, 0, 0.85)"}).then((()=>{}))}catch(t){let{code:e}=t.data,s=m.Z[e]?m.Z[e].content[this.$store.state.language]:"";s&&!m.Z[e].showErrorMessage&&a.Z.alert({message:s,confirmButtonText:this.$t("common.close"),confirmButtonColor:"rgba(0, 0, 0, 0.85)"}).then((()=>{}))}},funToExam(t,e){const{face_recognition:s,paper_version:i,paper_id:o}=this.examInfo,{examId:r,taskId:n,pageSource:c,pageSourceId:d}=this.$route.query,{enterpriseId:h}=this.userInfo;if("1440537622480031849"===h){const t={moduleName:"maiTianExam",isMaiTian:(0,g.UI)("EXAM_BANK_CONFIG"),canSelectedBank:this.isSelfSelectedBank,examResult:e,minBankCount:this.minBankCount,paperId:o,paperVersion:i,faceRecognition:s};this.uploadMaiTianLogger(t)}"true"===s?(0,l.YQ)({successPath:()=>{this.isSelfSelectedBank&&"inProgress"!==e?u.Z.exam.enterSelfSelectedBank({examId:r,taskId:n,pageSource:c,pageSourceId:d,minBankCount:this.minBankCount,paper_id:o,paper_version:i}):u.Z.exam.toExam({examId:r,taskId:n,pageSource:c,pageSourceId:d})},cancel:()=>{a.Z.close()},tip1:this.$t("faceKnow.examFaceKnowTip"),tip2:this.$t("faceKnow.examFaceKnowTip2"),hasSetFace:t,typeTip:"exam"}):this.isSelfSelectedBank&&"inProgress"!==e?u.Z.exam.enterSelfSelectedBank({examId:r,taskId:n,pageSource:c,pageSourceId:d,minBankCount:this.minBankCount,paper_id:o,paper_version:i}):u.Z.exam.toExam({examId:r,taskId:n,pageSource:c,pageSourceId:d})},async selfSelectedBank(t){const e=await h.Z.getMaiTianExamStatus(t),s=e.data&&e.data.data;"random"===s.type&&"self_choose_bank"===s.extract_rules.extract_type&&(this.isSelfSelectedBank=!0,this.minBankCount=s.extract_rules.self_choose_bank_rules.self_choose_bank_num)},uploadMaiTianLogger(t){v.Z.logger(t)}}},y=(0,s(1001).Z)(f,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:{"exam-instruction":!0,"ios-exam-instruction":t.isIpx}},[t.showContent?s("div",[s("div",{staticClass:"exam-title"},[t._v(t._s(t.examInfo.title))]),s("div",{staticClass:"exam-date-range"},[t._v(t._s(t.formatDateRange(t.examInfo)))]),s("div",{staticClass:"exam-cards-list"},[t._l(t.examInfosData,(function(e,a){return s("div",{key:e.type,class:["common-style",t.formatClass(t.examInfosData.length,a)]},[s("svg-icon",{attrs:{"icon-class":e.icon,size:18,color:e.color}}),s("div",{staticClass:"val cl-ellipsis"},[t._v(t._s(e.val)+t._s(e.units))]),s("div",{staticClass:"title"},[t._v(t._s(e.title))])],1)})),8===t.examInfosData.length?s("div",{staticClass:"eight-position-box"}):t._e()],2),t.examInfo.description?s("div",{staticClass:"exam-explain"},[t._v(t._s(t.examInfo.description))]):t._e(),s("div",{staticClass:"exam-tips"},[t._v("*"+t._s(t.$t("examination.autoSubmit")))]),s("div",{class:{"bottom-btns":!0,"ios-bottom":t.isIpx}},[s("div",{staticClass:"btn",style:{backgroundColor:t.primaryColor},on:{click:function(e){return e.stopPropagation(),t.handleCheckExam.apply(null,arguments)}}},[t._v(t._s(t.$t("examination.enterExam")))])])]):t._e(),!1===t.showContent?s("Empty",{attrs:{image:t.ASSETS_OSS_HOST+"/1821562722400210944.png"}}):t._e()],1)}),[],!1,null,"7718e16b",null).exports},89311:(t,e,s)=>{s.r(e),s.d(e,{default:()=>l});var a=s(95082),i=s(26294),o=s(22648),r=s(49115),n=s(27793),c={components:{Ranking:r.Z,RadioBtn:n.Z},data(){return{ASSETS_OSS_HOST,type:"score",radioList:[{name:this.$t("examination.byScore"),key:"score"},{name:this.$t("examination.byScoreRate"),key:"scoreRate"}]}},computed:(0,a.Z)({},(0,i.mapGetters)({primaryColor:"getPrimaryColor"})),created(){(0,o.vk)("#0188FC")},methods:{changeType(t){this.type=t}}},l=(0,s(1001).Z)(c,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"exam-ranking-whole"},[s("div",{staticClass:"top"},[s("img",{staticClass:"img",attrs:{src:t.ASSETS_OSS_HOST+"/1821084056264249344.png"}}),s("div",{staticClass:"title"},[t._v(t._s(t.$t("examination.onRanking")))])]),s("div",{staticClass:"content-list"},[s("div",{staticClass:"tips"},[t._v("*"+t._s(t.$t("examination.rankingTips")))]),s("div",{staticClass:"search-content"},[s("span",{staticClass:"all-rank"},[t._v(t._s(t.$t("examination.allRank")))]),s("span",{staticClass:"type-tabs"},[s("RadioBtn",{attrs:{list:t.radioList,"active-key":t.type},on:{changeType:t.changeType}})],1)]),s("Ranking",{attrs:{type:t.type,from:"all"}})],1)])}),[],!1,null,"2f1e3795",null).exports},49115:(t,e,s)=>{s.d(e,{Z:()=>y});s(34837);var a=s(39146),i=s(95082),o=(s(23307),s(81392)),r=(s(92282),s(53828)),n=(s(18144),s(65641)),c=(s(70885),s(6458)),l=(s(30541),s(33948),s(26294)),u=s(22648),d=s(46933),h=s(78551),p=s(78368),m=s(95969),g=s(56857),v=s(29032),f={components:{Row:c.Z,Col:n.Z,Pagination:r.Z,Icon:o.Z,SvgIcon:h.Z,AllPathDepartmentNames:v.P,ClUserName:g.Z},props:{from:{type:String,default:""},type:{type:String,default:"score"}},data:()=>({defaultAvatar:p,rankingList:[],total:0,pages:0,param:{page_size:10,page_number:1,type:"score"},imgList:[`${ASSETS_OSS_HOST}/1819588246108246016.png`,`${ASSETS_OSS_HOST}/1819588250994610176.png`,`${ASSETS_OSS_HOST}/1819588255306354688.png`]}),computed:(0,i.Z)((0,i.Z)({},(0,l.mapGetters)({primaryColor:"getPrimaryColor"})),{},{isIpx:()=>"ios"===(0,u.Os)()}),watch:{type(t,e){t!==e&&(this.param.page_number=1,this.param.type=t,this.getRankingLists())}},mounted(){this.param.type=this.type,this.getRankingLists()},methods:{async getRankingLists(){a.Z.loading({forbidClick:!0,duration:10,message:this.$t("common.loading")});try{const{examId:t}=this.$route.query,e=await d.Z.getRankingLists((0,i.Z)((0,i.Z)({},this.param),{},{examId:t}));if("200000"===e.data.code){let{list:t}=e.data.data.all_ranking;1===this.param.page_number&&e.data.data.my_ranking&&t.unshift((0,i.Z)((0,i.Z)({},e.data.data.my_ranking),{},{mySelf:!0})),this.rankingList=[...t],this.pages=Number(e.data.data.all_ranking.pages),this.total=Number(e.data.data.all_ranking.total),this.$refs.rankingScrollRef.scrollTop=0}a.Z.clear()}catch(t){a.Z.clear()}},changePage(t){this.param.page_number=t,this.getRankingLists()},handAllRank(){const{examId:t}=this.$route.query;m.Z.exam.enterExamRank({examId:t})}}},y=(0,s(1001).Z)(f,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"rankingScrollRef",staticClass:"ranking-list-wrap",style:{paddingBottom:"all"===t.from&&t.total>t.param.page_size?t.isIpx?"80px":"50px":""}},[s("Row",{staticClass:"table-header"},[s("Col",{staticClass:"rank-num",attrs:{span:"4"}},[t._v(t._s(t.$t("examination.rank")))]),s("Col",{staticClass:"rank-nameDept",attrs:{span:"13"}},[t._v(t._s(t.$t("examination.nameDept")))]),s("Col",{staticClass:"align-middle",attrs:{span:"3"}},[t._v(t._s(t.$t("examination.fraction")))]),s("Col",{staticClass:"align-middle",attrs:{span:"4"}},[t._v(t._s(t.$t("examination.scoringRate")))])],1),t._l(t.rankingList,(function(e,a){return s("Row",{key:e.mySelf?e.user_id+a:e.user_id,class:["table-row",e.mySelf?"mySelf-item":""]},[s("Col",{staticClass:"rank-num-val",attrs:{span:"4"}},[1===e.ranking||2===e.ranking||3===e.ranking?s("img",{staticClass:"ranking-img",attrs:{src:t.imgList[e.ranking-1],alt:""}}):s("span",[t._v(t._s(e.ranking))])]),s("Col",{staticClass:"img-name-dept",attrs:{span:"13"}},[s("img",{staticClass:"avatar",attrs:{src:e.user_info&&e.user_info.avatar?e.user_info.avatar:t.defaultAvatar}}),s("div",{staticClass:"name-dept"},[s("div",{staticClass:"cl-ellipsis name"},[e.mySelf?[t._v(" "+t._s(t.$t("mineScore.myRanking"))+" ")]:e.user_info?[s("cl-user-name",{attrs:{"user-id":e.user_info.id,"user-name":e.user_info.name}})]:[t._v("--")]],2),s("div",{staticClass:"cl-ellipsis dept"},[e.user_info?[s("all-path-department-names",{attrs:{"all-departments-list":e.user_info.department_infos}})]:[t._v("--")]],2)])]),s("Col",{staticClass:"line-heights align-middle",attrs:{span:"3"}},[t._v(t._s(e.score))]),s("Col",{staticClass:"line-heights align-middle",attrs:{span:"4"}},[t._v(t._s(e.scor_rate))])],1)})),"data"===t.from&&t.total>t.param.page_size?s("div",{staticClass:"complete-list",style:{color:t.primaryColor},on:{click:t.handAllRank}},[t._v(" "+t._s(t.$t("examination.allRank"))+" "),s("svg-icon",{attrs:{"icon-class":"icon-chakanpaiming",color:t.primaryColor,size:10}})],1):t._e(),"all"===t.from&&t.param.page_number===t.pages?s("div",{class:{"no-more":!0,"ios-bottom":t.isIpx}},[t._v(t._s(t.$t("examination.noMore")))]):t._e(),"all"===t.from&&t.total>t.param.page_size?s("div",{class:{"pagination-bottom":!0,"ios-bottom":t.isIpx}},[s("Pagination",{attrs:{"total-items":t.total,"items-per-page":t.param.page_size},on:{change:t.changePage},scopedSlots:t._u([{key:"prev-text",fn:function(){return[s("Icon",{attrs:{name:"arrow-left"}})]},proxy:!0},{key:"next-text",fn:function(){return[s("Icon",{attrs:{name:"arrow"}})]},proxy:!0},{key:"page",fn:function(e){var a=e.text;return[s("span",{staticClass:"pagination-card"},[t._v(t._s(a))])]}}],null,!1,3471890337),model:{value:t.param.page_number,callback:function(e){t.$set(t.param,"page_number",e)},expression:"param.page_number"}},[s("Pagination")],1)],1):t._e()],2)}),[],!1,null,"435f2c20",null).exports},1130:(t,e,s)=>{s.r(e),s.d(e,{default:()=>C});var a=s(95082),i=(s(20581),s(50914)),o=s(26294),r=s(46933),n=s(27484),c=s.n(n),l=s(22648),u=s(95969),d=(s(57658),s(33948),s(65069),s(70492)),h=s.n(d),p=(s(46295),s(83062),s(57969)),m={props:{params:{type:Object,default:()=>({page_size:30,page_number:1})}},data:()=>({recordList:[],loading:!1,myChart:null,option:{},screenWidth:null}),computed:(0,a.Z)({},(0,o.mapGetters)({primaryColor:"getPrimaryColor"})),mounted(){this.getRecordInfoList(),window.onresize=()=>{this.myChart.resize(),setTimeout((()=>{const t=this.recordList.findIndex((({score_record_type:t})=>"latest"===t||"highest"===t));this.myChart.dispatchAction({type:"showTip",seriesIndex:0,dataIndex:t})}))}},methods:{async getRecordInfoList(){this.loading=!0;const{examId:t,taskId:e}=this.$route.query;try{let s=await r.Z.getRecordInfoList((0,a.Z)((0,a.Z)({},this.params),{},{page_size:30,page_number:1,userId:this.$store.state.commonParams.userId,examId:t,task_id:e}));"200000"===s.data.code&&(this.recordList=s.data.data.list||[],this.createEcharts(this.recordList)),this.loading=!1}catch(t){this.loading=!1}},createEcharts(t){const e=[],s=[],a=[];for(let i=0;i<t.length;i++){const o=t[t.length-1-i];s.push(o.score),e.push(o.submit_time),a.push(Number(o.total_score))}this.option={grid:{top:12,bottom:32,left:40,right:24},xAxis:{type:"category",data:e,axisTick:{alignWithLabel:!0},axisLabel:{formatter:t=>t&&(0,l.p6)(Number(t),new Date(Number(t)).getFullYear()===(new Date).getFullYear()?"MM/dd":"yyyy/MM/dd")},splitNumber:t.length<=7?t.length:7},yAxis:{boundaryGap:!1,type:"value",min:0,max:Math.max(...a),splitNumber:4},tooltip:{trigger:"axis",backgroundColor:"#ffff",formatter:e=>e.length>0&&`<div class='custom-content-container' style="\n              background: #FFFFFF;\n              box-shadow: 0px 2px 4px 0px rgba(0, 0, 0, 0.1);\n              border-radius: 5px;\n              border: 1px solid rgba(69, 69, 69, 0.24);\n              padding:6px 8px;\n              ">\n                <div class='top'>\n                  <span class='score' style="color: #516AE6">${e[0].data} ${p.Z.t("mineScore.points")}</span>\n                  ${"latest"===t[e[0].dataIndex].score_record_type||"highest"===t[e[0].dataIndex].score_record_type?`<span style="\n                    display: inline-block;\n                    height: 22px;\n                    margin-left: 8px;\n                    padding: 0 8px;\n                    color: #f5222d;\n                    font-size: 12px;\n                    line-height: 20px;\n                    background: #ffeeef;\n                    border: 1px solid #f5222d;\n                    border-radius: 2px;\n                  ">${"latest"===t[e[0].dataIndex].score_record_type?p.Z.t("micro.latest"):p.Z.t("examination.highest")}</span>`:""}\n                </div>\n                <div class='bottom' style="color: rgba(0, 0, 0, 0.45)">${(0,l.p6)(Number(e[0].name),new Date(Number(e[0].name)).getFullYear()===(new Date).getFullYear()?"MM/dd hh:mm":"yyyy/MM/dd hh:mm")}</div>\n              </div>`},series:[{type:"line",name:"score",data:s,smooth:!0,lineStyle:{color:"#516AE6",width:1},itemStyle:{color:"#516AE6"}}]},this.myChart=h().init(document.querySelector("#recordChart")),this.myChart.setOption(this.option),setTimeout((()=>{const e=t.reverse().findIndex((({score_record_type:t})=>"latest"===t||"highest"===t));this.myChart.dispatchAction({type:"showTip",seriesIndex:0,dataIndex:e})}))}}},g=m,v=s(1001),f=(0,v.Z)(g,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"record-chart-container"},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("recordCharts.title")))]),s("div",{attrs:{id:"recordChart"}})])}),[],!1,null,"54007836",null).exports,y={filters:{formatDuration:t=>t?(0,l.xj)(t):""},components:{[i.Z.name]:i.Z,RecordChart:f},data(){return{examResult:{pending:{text:this.$t("examination.resultStatus.marking"),color:"#FFB56F"},passed:{text:this.$t("examination.resultStatus.pass"),color:"#52C41A"},failed:{text:this.$t("examination.resultStatus.fail"),color:"#F5222D"},full:{text:this.$t("examination.resultStatus.full"),color:"#417DC2"}},showRepeatExam:"false",recordList:[],params:{scene:"user",task_type:"all",page_size:20,page_number:0},finished:!1,loading:!1}},computed:(0,a.Z)((0,a.Z)({},(0,o.mapGetters)({primaryColor:"getPrimaryColor"})),{},{isIpx:()=>"ios"===(0,l.Os)()}),mounted(){this.showRepeatExam=this.$route.query.showRepeatExam},methods:{onLoadMore(){this.params.page_number+=1,this.loading=!0,this.getRecordInfoList()},async getRecordInfoList(){this.loading=!0;const{examId:t,taskId:e}=this.$route.query;try{let s=await r.Z.getRecordInfoList((0,a.Z)((0,a.Z)({},this.params),{},{userId:this.$store.state.commonParams.userId,examId:t,task_id:e}));"200000"===s.data.code&&(this.recordList=this.recordList.concat(s.data.data.list),this.finished="false"===s.data.data.has_next_page),this.loading=!1}catch(t){this.loading=!1}},formatTime(t){return c()(Number(t)).format(this.$t("examination.dateFormate"))},formatStatus(t){let e=t.exam_result;return t.total_score===t.score&&(e="full"),e},handToRedo(){const{examId:t,taskId:e,pageSource:s,pageSourceId:a}=this.$route.query;u.Z.exam.enterExamInstruction({examId:t,taskId:e,from:"data",pageSource:s,pageSourceId:a})},handDetail(t){if("true"===t.show_record&&"pending"!==t.exam_result){const{examId:e,pageSource:s,pageSourceId:a,answerParsing:i}=this.$route.query;u.Z.exam.toExamDetail({examId:e,taskId:t.task_id,submitId:t.submit_id,pageSource:s,pageSourceId:a,answerParsing:i})}}}},_=y,C=(0,v.Z)(_,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:{"exam-record-list":!0,"ios-exam-record-list":t.isIpx&&"true"===t.showRepeatExam}},[s("div",{staticClass:"tips"},[t._v("*"+t._s(t.$t("examination.examRecordTips")))]),t.recordList.length>=3?s("record-chart",{attrs:{params:t.params}}):t._e(),s("van-list",{class:["true"===t.showRepeatExam?"have-btn-list":""],attrs:{finished:t.finished,"finished-text":t.$t("examination.noMore")},on:{load:t.onLoadMore},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[s("div",t._l(t.recordList,(function(e){return s("div",{key:e.id,staticClass:"card-item",on:{click:function(s){return t.handDetail(e)}}},[s("div",{staticClass:"top"},[s("div",{class:["time","false"===e.show_record||"pending"===e.exam_result?"no-click":""]},["latest"===e.score_record_type||"highest"===e.score_record_type?s("span",{class:["latest-highest-flag",e.score_record_type]},[t._v(t._s("latest"===e.score_record_type?t.$t("micro.latest"):t.$t("examination.highest")))]):t._e(),t._v(" "+t._s(t.formatTime(e.submit_time)))]),s("div",{staticClass:"status"},[s("span",{staticClass:"badge-point",style:{backgroundColor:t.examResult[t.formatStatus(e)].color}}),s("span",{staticClass:"status-text"},[t._v(t._s(t.examResult[t.formatStatus(e)].text))])])]),s("div",{staticClass:"infos"},[s("div",{staticClass:"items"},[s("span",{staticClass:"labels"},[t._v(t._s(t.$t("examination.answerTime"))+"：")]),s("span",{staticClass:"content"},[t._v(t._s(t._f("formatDuration")(e.answer_duration)))])]),s("div",{staticClass:"items"},[s("span",{staticClass:"labels"},[t._v(t._s(t.$t("examination.scoreAll"))+"：")]),s("span",{staticClass:"content"},[t._v(t._s(e.total_score)+"/"+t._s("pending"===e.exam_result?"--":e.score))])]),"pending"!==e.exam_result?s("div",{staticClass:"items"},[s("span",{staticClass:"labels"},[t._v(t._s(t.$t("examination.scoringRate"))+"：")]),s("span",{staticClass:"content"},[t._v(t._s(e.score_rate))])]):t._e()])])})),0)]),"true"===t.showRepeatExam?s("div",{class:{"bottom-btn":!0,"ios-bottom":t.isIpx}},[s("div",{staticClass:"btn",style:{backgroundColor:t.primaryColor},on:{click:t.handToRedo}},[t._v(t._s(t.$t("examination.reTest")))])]):t._e()],1)}),[],!1,null,"d8944c4a",null).exports},87244:(t,e,s)=>{s.r(e),s.d(e,{default:()=>b});s(34837);var a=s(39146),i=(s(31146),s(41610)),o=s(95082),r=(s(49153),s(5944)),n=s(14027),c={props:{baseInfos:{type:Object,default:()=>{}},from:{type:String,default:""}},data:()=>({ASSETS_OSS_HOST,examResult:n.bm,showFireworks:!1,failLight:"",newHighImg:n.nR,status:"submit"}),mounted(){this.formatStatus(),"true"===this.baseInfos.show_result&&"passed"===this.baseInfos.status&&"result"===this.from&&this.play(),"failed"===this.baseInfos.status&&(this.failLight="filter:grayscale(100%);opacity:0.6")},methods:{formatStatus(){"false"!==this.baseInfos.show_result||"pending"===this.baseInfos.status?this.baseInfos.score!==this.baseInfos.total_score?this.status=this.baseInfos.status:this.status="full":this.status="submit"},play(){setTimeout((()=>{this.showFireworks=!0}),100),setTimeout((()=>{setTimeout((()=>{this.showFireworks=!1}),500)}),2200)}}},l=s(1001),u=(0,l.Z)(c,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"exam-result-data-wrap"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.status,expression:"status"}],staticClass:"exam-img-wrap"},["pending"!==t.status?s("img",{staticClass:"ani-star1",style:t.failLight,attrs:{src:t.ASSETS_OSS_HOST+"/1821167513971593216.png"}}):t._e(),"pending"!==t.status?s("img",{staticClass:"ani-star2",style:t.failLight,attrs:{src:t.ASSETS_OSS_HOST+"/1821167519751344128.png"}}):t._e(),"pending"!==t.status?s("img",{staticClass:"ani-star3",style:t.failLight,attrs:{src:t.ASSETS_OSS_HOST+"/1821168569765990400.png"}}):t._e(),t.showFireworks&&"pending"!==t.status&&"result"===t.from&&"true"===t.baseInfos.show_result&&"passed"===t.baseInfos.status?s("div",{staticClass:"confetti",style:{backgroundImage:"url("+t.ASSETS_OSS_HOST+"/1821284563620597760.gif?a="+(new Date).getTime()+")"}}):t._e(),s("img",{staticClass:"starts",attrs:{src:t.examResult[t.status].src}}),"pending"!==t.status?s("img",{staticClass:"light-img",style:t.failLight,attrs:{src:t.examResult[t.status].lightSrc}}):t._e(),t.baseInfos.score_record_type&&"pending"!==t.status&&"true"===t.baseInfos.show_result?s("img",{staticClass:"streamer",attrs:{src:t.newHighImg[t.baseInfos.score_record_type].src}}):t._e(),t.baseInfos.score_record_type&&"pending"!==t.status&&"true"===t.baseInfos.show_result?s("div",{staticClass:"streamer-type-val",style:{textShadow:t.newHighImg[t.baseInfos.score_record_type].shadow}},[t._v(t._s(t.newHighImg[t.baseInfos.score_record_type].text))]):t._e(),"pending"!==t.status&&"true"===t.baseInfos.show_result?s("div",{staticClass:"status-score",style:{textShadow:t.examResult[t.status].shadow}},[s("span",{staticClass:"scores"},[t._v(t._s(t.baseInfos.score||0)),s("span",{staticClass:"score-point"},[t._v(t._s(t.$t("myRating.point")))])]),s("div",{staticClass:"status-val"},[t._v(t._s(t.examResult[t.status].val))])]):t._e(),s("div",{class:["text-tips","pending"===t.status?"pending-text-tips":""]},[t._v(t._s(t.examResult[t.status].text))])])])}),[],!1,null,"13dd36b6",null).exports,d=(s(31960),s(10993)),h=(s(57658),s(33948),s(22648)),p=s(46933),m={props:{baseInfos:{type:Object,default:()=>{}},from:{type:String,default:""}},data:()=>({cardList:n.le,temCardList:[]}),mounted(){this.getExamsResultInfo()},methods:{getExamsResultInfo(){const t=(0,o.Z)({},this.baseInfos);if("pending"===t.status||"false"===t.show_result)return void(this.temCardList=[{title:this.$t("examination.answerTime"),type:"exam_time",icon:"icon-datishichang",val:(0,h.xj)(t.exam_time),units:"",color:"#C08564"}]);let e=[];this.cardList.forEach((s=>{"result"===this.from&&"reward_rule_vo"===s.type||("certificate_vo"===s.type?t.certificate_vo&&"true"===t.certificate_vo.show&&(s.val=t.certificate_vo.certificate_name,e.push(s)):"reward_rule_vo"===s.type?t.reward_rule_vo&&"score"===t.reward_rule_vo.type&&(s.val=t.reward_rule_vo.award_credit,e.push(s)):(s.val=t[s.type],null!==t[s.type]&&""!==t[s.type]&&("exam_time"===s.type&&(s.val=(0,h.xj)(t[s.type])),e.push(s))))})),this.temCardList=[...e]},formatClass(t,e){let s="";switch(t){case 1:s="one";break;case 2:s="two";break;case 3:case 6:s="";break;case 4:s="four";break;case 5:s=e<3?"":"five-two"}return s},async handClickItem(t){if("certificate_vo"===t.type&&"true"===this.baseInfos.certificate_vo.show){const{examId:t}=this.$route.query;let e=await p.Z.getCertificateImage(t);if("200000"===e.data.code)switch(e.data.data.result){case"pending":(0,a.Z)(this.$t("examination.certificateImagePending"));break;case"failed":(0,a.Z)(this.$t("examination.certificateImageFail"));break;case"success":(0,d.Z)({images:[e.data.data.image_url],showIndex:!1})}}}}},g=(0,l.Z)(m,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"exam-set-card"},[s("div",{class:["card-list",1===t.temCardList.length?"one-card":""]},t._l(t.temCardList,(function(e,a){return s("div",{key:e.type,class:["exam-cards",t.formatClass(t.temCardList.length,a)],on:{click:function(s){return t.handClickItem(e)}}},[s("div",{class:["val","cl-ellipsis","certificate_vo"===e.type?"certificate-name":""]},[t._v(t._s(e.val))]),s("div",{staticClass:"title"},[t._v(t._s(e.title))])])})),0),s("div",{staticClass:"paper-infos"},[s("span",[s("span",{staticClass:"title"},[t._v(t._s(t.$t("mineScore.totalScores"))+"：")]),t._v(t._s(t.baseInfos.total_score))]),s("span",{staticClass:"after-line"}),s("span",[s("span",{staticClass:"title"},[t._v(t._s(t.$t("myRating.passingScore"))+"：")]),t._v(t._s(t.baseInfos.passing_score))]),s("span",{staticClass:"after-line"}),s("span",[s("span",{staticClass:"title"},[t._v(t._s(t.$t("examination.examDuration"))+"：")]),t._v(t._s(t.baseInfos.exam_duration)+t._s(t.$t("mineScore.minutes")))]),s("span",{staticClass:"after-line"}),s("span",[s("span",{staticClass:"title"},[t._v(t._s(t.$t("examination.questionNum"))+"：")]),t._v(t._s(t.baseInfos.total_count))])])])}),[],!1,null,"61bff99c",null).exports,v=s(26294),f={components:{Ranking:s(49115).Z},props:{baseInfos:{type:Object,default:()=>{}},from:{type:String,default:""}},data:()=>({ASSETS_OSS_HOST}),computed:(0,o.Z)({},(0,v.mapGetters)({primaryColor:"getPrimaryColor"}))},y=(0,l.Z)(f,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"exam-ranking"},[s("div",{staticClass:"top"},[s("img",{staticClass:"ranking-img",attrs:{src:t.ASSETS_OSS_HOST+"/1821074247422971904.png"}}),s("div",{staticClass:"ranking-title"},[t._v(t._s(t.$t("examination.onRanking")))]),s("img",{staticClass:"ranking-img",attrs:{src:t.ASSETS_OSS_HOST+"/1821074239499931648.png"}})]),s("Ranking",{attrs:{from:t.from}})],1)}),[],!1,null,"9e1c2c46",null).exports,_=s(95969),C={components:{Result:u,SetCard:g,Ranking:y,Empty:r.Z},data:()=>({ASSETS_OSS_HOST,fromPage:"",baseInfos:null,recordListLen:0,recordList:[],rankingListLen:0,loadError:!1}),computed:(0,o.Z)((0,o.Z)((0,o.Z)((0,o.Z)({},(0,v.mapState)("exam",["submitStatus"])),(0,v.mapState)("face",["checkStatus"])),(0,v.mapGetters)({primaryColor:"getPrimaryColor"})),{},{isIpx:()=>"ios"===(0,h.Os)(),renderBackBtn(){const{pageSource:t}=this.$route.query;let e="";return e=t?this.$t("common.confirm"):this.$t("examination.backExamList"),e}}),watch:{checkStatus(){i.Z.close()}},beforeDestroy(){this.$store.commit("exam/setSubmitStatus","")},mounted(){this.baseInfos=null;const{examId:t,from:e=""}=this.$route.query;(0,h.Td)("result"===e?this.$t("pageTitle.examResult"):this.$t("pageTitle.examData")),this.fromPage=e,i.Z.close(),this.getExamsResultInfo(),this.getRecordInfoList(t)},methods:{showDetailBtn(){return 1===this.recordListLen&&"true"===this.baseInfos.show_result&&("false"!==this.recordList[0].show_record&&"pending"!==this.recordList[0].exam_result)},showRecordBtn(){const{baseInfos:t,recordListLen:e}=this;return"true"===t.show_result&&e>1},showBackBtn(){const{baseInfos:t}=this;return"false"===t.show_repeat_exam&&"false"===t.show_result||"false"===t.show_repeat_exam&&"true"===t.show_result&&!this.showDetailBtn()&&!this.showRecordBtn()},async getExamsResultInfo(){const{examId:t,taskId:e,submitId:s=""}=this.$route.query;a.Z.loading({message:this.$t("common.loading"),duration:0,forbidClick:!0});try{let i=await p.Z.getExamsResult({examId:t,taskId:e,submitId:s});"200000"===i.data.code?(this.loadError=!1,this.baseInfos=i.data.data,this.setBarColor(),a.Z.clear()):(this.baseInfos=null,this.loadError=!0,a.Z.clear()),this.handleSubmitTips()}catch(t){this.baseInfos=null,this.loadError=!0,a.Z.clear(),this.handleSubmitTips(),console.error(t)}},handleSubmitTips(){const{from:t=""}=this.$route.query,e=n.Tm[this.submitStatus];this.submitStatus&&"result"===t&&e&&setTimeout((()=>{this.$toast({message:e,duration:3e3,forbidClick:!0})}),500)},async getRecordInfoList(t){const{taskId:e}=this.$route.query;this.loading=!0;let s=await p.Z.getRecordInfoList({scene:"user",task_type:"all",page_size:10,page_number:1,userId:this.$store.state.commonParams.userId,examId:t,task_id:e});"200000"===s.data.code&&(this.recordList=s.data.data.list,this.recordListLen=Number(s.data.data.total))},handToRecord(){const{examId:t,taskId:e,pageSource:s,pageSourceId:a}=this.$route.query;if(1===this.recordListLen){const{exam_result:o,show_record:r,submit_id:n}=this.recordList[0];var i;if("true"===r&&"pending"!==o)_.Z.exam.toExamDetail({examId:t,taskId:e,submitId:n,pageSource:s,pageSourceId:a,answerParsing:null===(i=this.baseInfos)||void 0===i?void 0:i.answer_parsing})}else{var o;_.Z.exam.enterExamRecord({examId:t,taskId:e,showRepeatExam:this.baseInfos.show_repeat_exam,pageSource:s,pageSourceId:a,answerParsing:null===(o=this.baseInfos)||void 0===o?void 0:o.answer_parsing})}},handToRedo(){const{examId:t,taskId:e,from:s,pageSource:a,pageSourceId:i}=this.$route.query;_.Z.exam.enterExamInstruction({examId:t,taskId:e,from:s,pageSource:a,pageSourceId:i})},handBackList(){const{pageSource:t,pageSourceId:e}=this.$route.query;switch(t){case"studyProject":_.Z.exam.redirectToProjectDetail(e);break;case"task":_.Z.exam.redirectToStudyDetail({studyId:e,origin:"vue"});break;case"certificationDetails":_.Z.exam.redirectToCertificationDetail(e);break;default:_.Z.exam.redirectToExamList()}},setBarColor(){"pending"===this.baseInfos.status?(0,h.vk)("#ffffff"):(0,h.vk)("#352585")}}},I=C,b=(0,l.Z)(I,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:["exam-result-wrap",t.baseInfos&&"pending"!==t.baseInfos.status?"":"exam-result-wrap-gray-background",t.isIpx?"ios-exam-result-wrap":""]},[t.baseInfos?s("div",[s("Result",{attrs:{"base-infos":t.baseInfos,from:t.fromPage}}),s("SetCard",{attrs:{"base-infos":t.baseInfos,from:t.fromPage}}),"true"===t.baseInfos.show_result&&"true"===t.baseInfos.show_ranking?s("Ranking",{attrs:{"base-infos":t.baseInfos,from:"data"}}):t._e()],1):t._e(),t.loadError?s("Empty",{attrs:{image:t.ASSETS_OSS_HOST+"/1821562722400210944.png",description:t.$t("examination.loadDataError")}}):t._e(),s("div",{class:{"bottom-btn":!0,"ios-bottom":t.isIpx}},[t.baseInfos&&t.showDetailBtn()?s("div",{class:{"record-btn":!0,"whole-btn":"false"===t.baseInfos.show_repeat_exam},style:{backgroundColor:"false"===t.baseInfos.show_repeat_exam?t.primaryColor:"#ffffff"},on:{click:t.handToRecord}},[t._v(" "+t._s(t.$t("examination.answerDetail"))+" ")]):t._e(),t.baseInfos&&t.showRecordBtn()?s("div",{class:{"record-btn":!0,"whole-btn":"false"===t.baseInfos.show_repeat_exam},style:{backgroundColor:"false"===t.baseInfos.show_repeat_exam?t.primaryColor:"#ffffff"},on:{click:t.handToRecord}},[t._v(" "+t._s(t.$t("examination.examRecord"))+" ")]):t._e(),t.baseInfos&&"true"===t.baseInfos.show_repeat_exam?s("div",{class:["redo-btn","false"===t.baseInfos.show_result||!t.showDetailBtn()&&!t.showRecordBtn()?"whole-btn":""],style:{backgroundColor:t.primaryColor},on:{click:t.handToRedo}},[t._v(" "+t._s(t.$t("examination.reTest"))+" ")]):t._e(),t.baseInfos&&t.showBackBtn()?s("div",{staticClass:"back-list-btn",style:{backgroundColor:t.primaryColor},on:{click:t.handBackList}},[t._v(" "+t._s(t.renderBackBtn)+" ")]):t._e()])],1)}),[],!1,null,"a40ef1c4",null).exports},6263:(t,e,s)=>{s.r(e),s.d(e,{default:()=>C});var a=s(95082),i=(s(70885),s(6458)),o=(s(18144),s(65641)),r=(s(23307),s(81392)),n=(s(40962),s(41956)),c=(s(30033),s(87837)),l=(s(48444),s(84014)),u=(s(52355),s(29233)),d=(s(25773),s(35791)),h=(s(20581),s(50914)),p=(s(76832),s(18537)),m=(s(77934),s(63980)),g=(s(86039),s(20495)),v=(s(57658),s(39714),s(30541),s(46933)),f=s(95969),y=s(26294),_={components:{[g.Z.name]:g.Z,[m.Z.name]:m.Z,[p.Z.name]:p.Z,[h.Z.name]:h.Z,[d.Z.name]:d.Z,[u.Z.name]:u.Z,[l.Z.name]:l.Z,[c.Z.name]:c.Z,[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z},data:()=>({searchVal:"",resouceId:"",examId:"",selectedResouces:[{val:""}],resouceOptions:[],selectedBankVals:[],selectedBanks:[],bankList:[],minBankCount:0,maxBankCount:20,loading:!1,finished:!0,page_number:1,page_size:20}),computed:{commonParams(){return this.$store.state.commonParams}},async created(){this.examId=this.$route.query.examId;const t=await v.Z.getResourceTree({}),e=this.formatResouceOption(t.data&&t.data.list,"");this.resouceOptions.push(e),this.getBackList()},methods:(0,a.Z)((0,a.Z)({},(0,y.mapMutations)("exam",["setRequireBankIds"])),{},{onSearch(t){this.searchVal=t,this.page_number=1,this.getBackList()},onClear(){this.searchVal="",this.page_number=1,this.getBackList()},async handleSelectedResouce(t,e){this.resouceId=e;const s=await v.Z.getResourceTree({parentId:e});if(s.data&&s.data.list){this.selectedResouces.splice(t+1,100,{val:e});const a=this.formatResouceOption(s.data&&s.data.list,e);this.resouceOptions.splice(t+1,100,a)}else this.selectedResouces.splice(t+1),this.resouceOptions.splice(t+1);this.page_number=1,this.getBackList()},handleSelectedBank(t,e){this.$refs.checkboxRef[t].toggle();const s=this.selectedBankVals.indexOf(e.id);if(s>=0)this.selectedBanks.splice(s,1),this.selectedBankVals.splice(s,1);else{if(this.selectedBankVals.length===this.maxBankCount)return void this.$toast(this.$t("examination.maxBankCountTip",{maxBankCount:this.maxBankCount}));this.selectedBanks.push(e),this.selectedBankVals.push(e.id)}},handleCloseTag(t){this.selectedBanks.splice(t,1),this.selectedBankVals.splice(t,1)},clearSelectedBank(){this.selectedBanks.splice(0),this.selectedBankVals.splice(0)},confirmToExam(){if(this.selectedBanks.length<this.minBankCount)return void this.$toast(this.$t("examination.minBankCountTip",{minBankCount:this.minBankCount}));this.setRequireBankIds(this.selectedBankVals.toString());const{examId:t,taskId:e,pageSource:s,pageSourceId:a}=this.$route.query;f.Z.exam.toExam({examId:t,taskId:e,pageSource:s,pageSourceId:a,selfChooseBank:"true"})},formatResouceOption:(t,e)=>(t.hasFormat||(t.forEach((t=>{t.text=t.name,t.value=t.id})),t.unshift({text:"全部",value:e}),t.hasFormat=!0),t),onLoadMore(){this.page_number+=1,this.getBackList("loadMore")},async getBackList(t){const{paper_id:e,minBankCount:s,paper_version:a}=this.$route.query,{page_number:i,page_size:o}=this;this.loading=!0;const r=await v.Z.getSelfSelectedBanks({page_number:i,page_size:o,all_data:"no",classify_id:this.resouceId,keyword:this.searchVal,paper_id:e,paper_version:a,search_type:"mobile"}),n=r&&r.data&&r.data.data;this.finished="false"===n.has_next_page,this.loading=!1,this.bankList=t?this.bankList.concat(n.list):n.list,this.minBankCount=s}})},C=(0,s(1001).Z)(_,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"self-selected-bank"},[s("form",{attrs:{action:"/"}},[s("van-search",{attrs:{placeholder:t.$t("examination.searchPlaceholder")},on:{search:t.onSearch,clear:t.onClear},model:{value:t.searchVal,callback:function(e){t.searchVal=e},expression:"searchVal"}})],1),s("div",{staticClass:"resource-box"},[s("van-dropdown-menu",{attrs:{"active-color":"#1989fa"}},t._l(t.selectedResouces,(function(e,a){return s("div",{key:a.id},[s("van-dropdown-item",{attrs:{options:t.resouceOptions[a]},on:{change:function(e){return t.handleSelectedResouce(a,e)}},model:{value:e.val,callback:function(s){t.$set(e,"val",s)},expression:"item.val"}})],1)})),0)],1),s("van-list",{staticClass:"resource-list",attrs:{finished:t.finished,"finished-text":t.$t("examination.noMore")},on:{load:t.onLoadMore},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[s("van-checkbox-group",{attrs:{max:3},model:{value:t.selectedBankVals,callback:function(e){t.selectedBankVals=e},expression:"selectedBankVals"}},t._l(t.bankList,(function(e,a){return s("van-cell",{key:e.id,attrs:{size:"large"},on:{click:function(s){return t.handleSelectedBank(a,e)}},scopedSlots:t._u([{key:"title",fn:function(){return[s("van-checkbox",{ref:"checkboxRef",refInFor:!0,attrs:{name:e.id,shape:"square"}},[t._v(t._s(e.title))])]},proxy:!0}],null,!0)})})),1)],1),s("div",{staticClass:"bottom-box"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.selectedBanks.length>0,expression:"selectedBanks.length>0"}],staticClass:"selected-bank"},t._l(t.selectedBanks,(function(e,a){return s("van-badge",{key:e.value,attrs:{color:"#bfbfbf"},scopedSlots:t._u([{key:"content",fn:function(){return[s("van-icon",{staticClass:"badge-icon",attrs:{name:"cross"},on:{click:function(e){return t.handleCloseTag(a)}}})]},proxy:!0}],null,!0)},[s("div",{staticClass:"child"},[t._v(" "+t._s(e.title)+" ")])])})),1),s("van-row",{attrs:{type:"flex",justify:"space-between"}},[s("van-col",{staticClass:"tip",attrs:{span:"13"}},[t._v("最少选择"+t._s(t.minBankCount)+"个题库")]),s("van-col",{staticClass:"btn-group",attrs:{span:"11"}},[s("van-button",{attrs:{type:"default"},on:{click:t.clearSelectedBank}},[t._v("清空")]),s("van-button",{attrs:{type:"info"},on:{click:t.confirmToExam}},[t._v("确定")])],1)],1)],1)],1)}),[],!1,null,"e9ca37a2",null).exports},99420:(t,e,s)=>{s.r(e),s.d(e,{default:()=>f});var a=s(95082),i=(s(25773),s(35791)),o=(s(93787),s(20090)),r=(s(57658),s(33948),s(74916),s(4723),s(15306),s(38862),s(27632)),n=s(72311),c=s(95084),l=s(68163),u=s(78551),d=s(27083),h=s(26294),p=s(95969),m=s(68092),g=s(16603),v={components:{[o.Z.name]:o.Z,[i.Z.name]:i.Z,ClAttachment:c.Z,OssUpload:l.Z,SvgIcon:u.Z,TutorBomb:d.Z},beforeRouteLeave(t,e,s){"course-reader"===t.name?(this.autoSave(),s()):this.backEstimate(s)},data:()=>({iconList:[],data:{resources:[]},checkedId:"",checkedName:"",saveCheckedId:"",saveCheckedName:"",tutorsList:[],stepsList:[],initResources:"",isSubmit:!1,showtutorsModal:!1,isSaveDrafts:!0,isHuaLaiShi:(0,m.UI)("PRIVACY_HLS_APPROVAL_MANAGE"),nonrestrictiveTip:(0,m.UI)("OSS_UPLOAD_NO_LIMIT")}),computed:(0,a.Z)((0,a.Z)((0,a.Z)((0,a.Z)({},(0,h.mapState)("setting",["dingDiskChoose"])),(0,h.mapState)("user",["dingUserId","corpId","userId"])),(0,h.mapState)(["themeColor"])),{},{query(){const{id:t,mapId:e,operationSource:s,fromRouter:a}=this.$route.query;return{id:t,mapId:e,operationSource:s,fromRouter:a}},canSubmit(){return this.isSubmit&&!("tutor"===this.data.approval_type&&!this.checkedId)}}),mounted(){this.setIconList(),this.initData(),this.$nextTick((()=>{const t=this;this.uploader=new g.Z({setQueues:e=>{const s=[];Object.values(e).forEach((t=>{s.push((0,a.Z)((0,a.Z)({},t),{},{content_type:t.content_type||t.type}))})),t.onUploadSuccess([...s])},onUploadProgress:({fileId:e,loadedPercent:s})=>{t.onUploadProgress(e,s)},onUploadSucceed:({uploadSucceedItem:e})=>{t.onUpdateSuccess(e)},onUploadWarning:({type:e,content:s})=>{"warning"===e&&t.$toast({message:s})},onUploadFailed:({fileId:e})=>{t.onUpdateFaile(e)}}),this.uploader.initUploader()}))},methods:{setIconList(){"dingTalk"===r.Z.env?this.iconList=["photo","video","dingPlate"]:this.iconList=["camera","album","video"]},handleChooseFiles(t,e){t.stepIndex=e,t.choosedFiles.forEach((t=>{t.status=11})),this.uploader.chooseFiles(t)},async initData(){try{const{data:t}=this.isHuaLaiShi&&"qualification"===this.query.operationSource?await n.Z.operationsCustomInfo(this.query.id):await n.Z.operationsInfo(this.query.id);this.data=t.data,this.saveCheckedId=t.data.tutor_user_id||"",this.saveCheckedName=t.data.tutor_user_name||"",this.checkedId=t.data.tutor_user_id||"",this.checkedName=t.data.tutor_user_name||"";let e=[];0===t.data.steps.length?e=[{content:"",resources:[]}]:(t.data.steps.forEach((t=>{t.content||(t.content=""),t.resources&&t.resources.forEach((t=>{t.type=t.type&&t.type.match(/^(image\/)/)?t.type.split("/")[1]:t.type,t.disblock="none",t.uploadStatus="success"}))})),e=t.data.steps||[]),this.stepsList=e,this.inputMonitor(e),this.initResources=this.handleResourceInit(),this.handleUploadList()}catch(t){this.$toast.fail(t.data)}},handleResourceInit(){let t="";return this.stepsList.forEach((e=>{t+=e.resources.filter((t=>5!==t.status&&t.id)).map((t=>t.id)).join(",")})),t},handleUploadList(){const t=[];this.stepsList.forEach(((e,s)=>{e.resources.forEach((e=>{t.push((0,a.Z)((0,a.Z)({},e),{},{stepIndex:s}))}))})),this.uploader.setList(t)},inputMonitor(t){let e=0;t.forEach((t=>{0!==t.resources.filter((t=>5!==t.status&&""!==t.status&&t.id)).length||t.content||(e+=1)})),e===t.length?this.isSubmit=!1:this.isSubmit=!0},inputEvent(t,e){this.stepsList[e].content=t,this.inputMonitor(this.stepsList)},onUploadAgain(t){t.binaryFile.status=11,this.uploader.deleteUploadFile({fileId:t.id}),this.uploader.chooseFiles({choosedFiles:[t],isUpdate:!0,notLibrary:!0})},onUploadProgress(t,e){this.stepsList.forEach(((s,a)=>{if(s.resources&&s.resources.length){const i=[...s.resources],o=i.find((e=>e.id===t));o&&(o.currentRate=e,o.uploadStatus="upload",this.stepsList[a].resources=[...i])}})),this.handleUploadList()},onUploadSuccess(t,e="none"){if("none"===e){const e={};t.forEach((t=>{e[t.stepIndex]?e[t.stepIndex].push(t):e[t.stepIndex]=[t]})),Object.keys(e).forEach((t=>{this.stepsList[t].resources=e[t]}))}else t.forEach((t=>{t.disblock="none"})),this.stepsList[e].resources.push(...t);this.inputMonitor(this.stepsList),this.handleUploadList()},onUpdateFaile(t){this.stepsList.forEach(((e,s)=>{if(e.resources&&e.resources.length){const a=[...e.resources],i=a.find((e=>e.id===t||e.path===t));i&&(i.status=5,i.disblock="none",this.stepsList[s].resources=[...a])}})),this.inputMonitor(this.stepsList)},onUpdateSuccess(t){this.stepsList.forEach(((e,s)=>{if(e.resources&&e.resources.length){const a=[...e.resources],i=a.find((e=>e.id===t.path||e.path===t.path));i&&(i.uploadStatus="success",Object.assign(i,t),this.stepsList[s].resources=[...a])}})),this.inputMonitor(this.stepsList),this.handleUploadList(),this.handleSuccessTip(t)},handleSuccessTip(t){setTimeout((()=>{this.stepsList.forEach(((e,s)=>{if(e.resources&&e.resources.length){const a=[...e.resources],i=a.find((e=>e.id===t.path||e.path===t.path));i&&(i.disblock="none",this.stepsList[s].resources=[...a])}})),this.handleUploadList()}),3e3)},onDeleteResources(t,e){this.$dialog.confirm({title:this.$t("promptMessage.warmTips"),message:this.$t("promptMessage.delete"),confirmButtonText:this.$t("buttons.confirm"),cancelButtonText:this.$t("buttons.cancel")}).then((()=>{this.operationFileDelete(t,e)}))},async operationFileDelete(t,e){const s=this.stepsList[e].resources[t].id,a=this.stepsList[e].resources[t].status;try{5!==a&&11!==a&&await n.Z.operationFileMaterialDelete(s),this.stepsList[e].resources.splice(t,1),this.uploader.cbkUploadCanceled({id:s}),this.uploader.deleteUploadFile({fileId:s}),this.inputMonitor(this.stepsList),this.handleUploadList(),setTimeout((()=>{this.autoSave()}),50)}catch(t){t&&t.data&&this.$toast({type:"fail",message:t.data})}},handleAddStep(){this.stepsList.push({content:"",resources:[]}),this.inputMonitor(this.stepsList)},stepsDelete(t){this.stepsList[t].resources.forEach((t=>{this.uploader.removeQueueItemById({fileId:t.id})})),this.stepsList.splice(t,1),this.inputMonitor(this.stepsList),this.handleUploadList()},async handleGetTutorList(){this.$toast.loading();const t={user_id:this.userId,status:"on",filter_user_quit:"true",filter_user_tutor:"true"};try{const{data:e={}}=await n.Z.getTutorsList(t);this.$toast.clear();const{list:s=[]}=e.data;s.length?(this.tutorsList=s,this.showtutorsModal=!0):this.$dialog({title:this.$t("study.tutorNoTitle"),message:this.$t("study.tutorNoDesc")})}catch(t){this.$toast.clear()}},onTutorCancel(){this.showtutorsModal=!1,this.checkedId=this.saveCheckedId,this.checkedName=this.saveCheckedName,this.inputMonitor(this.stepsList)},onTutorConfirm(){this.showtutorsModal=!1,this.inputMonitor(this.stepsList)},onSingleChange(t){this.checkedId=t.user_id,this.checkedName=t.user_name},backEstimate(t){const e=this.handleResourceInit();this.initResources!==e?this.backTip(t):t()},backTip(t){setTimeout((()=>{this.$dialog.confirm({message:this.$t("attestation.submittedBackTip"),confirmButtonText:this.$t("buttons.confirm"),cancelButtonText:this.$t("buttons.cancel")}).then((()=>{this.stepsList.forEach((t=>{t.resources.forEach((t=>{11===t.status&&(this.uploader.cbkUploadCanceled({id:t.id}),this.uploader.deleteUploadFile({fileId:t.id}))}))})),t()})).catch((()=>{t(!1)}))}),100)},autoSave(){this.initResources=this.handleResourceInit();const t=this.stepsList.map(((t,e)=>({content:t.content,step:e+1,resources:t.resources.filter((t=>5!==t.status&&11!==t.status&&""!==t.status&&t.id)).map(((t,e)=>({resourceId:t.id,sort:e+1})))})));this.isHuaLaiShi&&"qualification"===this.query.operationSource?n.Z.speakingCustomToSave(this.query.id,this.query.mapId,0,t,this.query.operationSource,this.checkedId):n.Z.speakingToSave(this.query.id,this.query.mapId,0,t,this.query.operationSource,this.checkedId)},handleUploadStatus(){let t=!1;return this.stepsList.forEach((e=>{e.resources.forEach((e=>{11===e.status&&(t=!0)}))})),t},async submit(t){if(this.handleUploadStatus())return void this.$toast({message:this.$t("attestation.uploadIngStatus"),forbidClick:!0});if(!this.canSubmit)return;let e=0;this.initResources=this.handleResourceInit();const s=this.stepsList.map(((t,s)=>(0!==t.resources.length||t.content||(e+=1),{content:t.content,step:s+1,resources:t.resources.filter((t=>5!==t.status&&11!==t.status&&""!==t.status&&t.id)).map(((t,e)=>({resourceId:t.id,sort:e+1})))})));if(e>0&&"1"===t)this.$dialog({message:this.$t("attestation.fillPracticalOperationTips")});else{"1"===t&&this.$toast({type:"loading",message:this.$t("attestation.submit"),forbidClick:!0});try{const{data:e}=this.isHuaLaiShi&&"qualification"===this.query.operationSource?await n.Z.speakingCustomToSave(this.query.id,this.query.mapId,t,s,this.query.operationSource,this.checkedId):await n.Z.speakingToSave(this.query.id,this.query.mapId,t,s,this.query.operationSource,this.checkedId);this.$toast.clear(),0===e.code?(this.isSaveDrafts=!1,"0"===t?this.$toast.success({message:this.$t("attestation.saveSuccess"),forbidClick:!0,onClose:()=>{this.isHuaLaiShi&&"qualification"===this.query.operationSource&&"operation-result"===this.query.fromRouter?this.$router.go(-2):this.$router.go(-1)}}):this.$toast({type:"success",message:this.$t("promptMessage.submitSuccessfully"),forbidClick:!0,onClose:()=>{const t=p.Z.taskResource.operationResult({courseId:this.query.id,studyType:this.query.operationSource});this.$router.replace(t)}})):"100000"===String(e.code)?this.$toast({type:"fail",message:this.$t("attestation.saveOperationFail")}):this.$toast({type:"fail",message:this.$t("attestation.saveFail")})}catch(t){this.$toast.clear(),this.$toast({type:"fail",message:t.data}),console.warn(t,JSON.stringify(t),"error")}}}}},f=(0,s(1001).Z)(v,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"operation-container"},[s("div",{staticClass:"operation-content"},[s("div",{staticClass:"operation-top"},[t.data.title?s("div",{staticClass:"operation-title"},[t._v(" "+t._s(t.data.title)+" ")]):t._e(),t.data.content?s("div",{staticClass:"operation-context"},[s("div",{staticClass:"context-label"},[t._v(t._s(t.$t("approval.workRequirements"))+"：")]),s("div",{staticClass:"context-content"},[t._v(t._s(t.data.content))])]):t._e(),t.data.resources.length?s("cl-attachment",{attrs:{"attachment-list":t.data.resources,"is-preview":!0}}):t._e()],1),t._l(t.stepsList,(function(e,a){return s("div",{key:a,staticClass:"operation-step"},[s("div",{staticClass:"step-title"},[s("span",[t._v(t._s(t.$t("approval.step",{step:a+1})))]),0!==a?s("div",{staticClass:"delete-icon",on:{click:function(e){return t.stepsDelete(a)}}},[s("svg-icon",{attrs:{"icon-class":"icon-guanbi",color:"#7F849A",size:24}})],1):t._e()]),s("van-field",{staticClass:"step-section-textarea",attrs:{value:e.content,rows:"5",type:"textarea",maxlength:"1200",placeholder:t.$t("attestation.practicalExamTips")},on:{input:function(e){return t.inputEvent(e,a)}}}),s("div",{staticClass:"step-attachment"},[s("cl-attachment",{attrs:{"attachment-list":e.resources,"steps-list":t.stepsList,"is-preview":!0,"is-delete":!0},on:{delete:function(e){return t.onDeleteResources(e,a)},uploadAgain:function(e){return t.onUploadAgain(e,a)}}})],1),s("oss-upload",{attrs:{"list-type":t.iconList,"disk-name":"operation"},on:{chooseFiles:function(e){return t.handleChooseFiles(e,a)},onSuccess:function(e){return t.onUploadSuccess(e,a)}}})],1)})),t.nonrestrictiveTip?t._e():s("div",{staticClass:"context-tip"},[s("svg-icon",{attrs:{"icon-class":"icon-icon_attention",size:12,color:"rgba(0, 0, 0, 0.25)"}}),t._v(" "+t._s(t.$t("approval.videoLimitTip"))+" ")],1),s("div",{staticClass:"operation-add-step",on:{click:t.handleAddStep}},[t._v(" "+t._s(t.$t("attestation.addSteps"))+" ")]),"tutor"===t.data.approval_type?s("div",{staticClass:"operation-tutor",on:{click:t.handleGetTutorList}},[s("div",{staticClass:"tutor-name"},[s("span",[t._v(t._s(t.$t("attestation.chooseTutor")))]),s("span",{staticClass:"name-data"},[t._v(t._s(t.checkedName))])]),s("svg-icon",{attrs:{"icon-class":"icon-chakanpaiming",color:"#B0B4C8",size:14}})],1):t._e(),s("div",{staticClass:"operation-footer"},[s("van-button",{staticClass:"footer-btn",attrs:{color:t.themeColor.primaryColor,plain:"",disabled:1===t.data.status||3===t.data.status||!t.canSubmit},on:{click:function(e){return t.submit("0")}}},[t._v(t._s(t.$t("buttons.save")))]),s("van-button",{staticClass:"footer-btn",attrs:{color:t.themeColor.primaryColor,disabled:1===t.data.status||3===t.data.status||!t.canSubmit},on:{click:function(e){return t.submit("1")}}},[t._v(t._s(t.$t("buttons.submit")))])],1)],2),t.showtutorsModal?s("tutor-bomb",{attrs:{"no-show-desc":"","tutors-list":t.tutorsList,"checked-id":t.checkedId},on:{cancel:t.onTutorCancel,confirm:t.onTutorConfirm,change:t.onSingleChange}}):t._e()],1)}),[],!1,null,"3ac721d4",null).exports},63700:(t,e,s)=>{s.r(e),s.d(e,{default:()=>A});var a=s(95082),i=(s(25773),s(35791)),o=(s(3791),s(93432)),r=(s(74916),s(4723),s(57658),s(72311)),n=s(78551),c=s(22648),l=(s(71404),s(57141)),u=(s(76424),s(41942)),d=s(4852),h=s(26294),p={components:{ClCustomUser:s(45877).Z},props:{item:{type:Object,default:()=>{}}},computed:{statusTip(){return{creation:this.$t("attestation.initiateApproval"),pass:this.$t("attestation.passed"),pending:this.$t("attestation.waiting"),reject:this.$t("attestation.reject"),leave:this.$t("attestation.approverDeparture"),un_pending:""}},renderMe(){const{studentId:t}=this.$route.query;return e=>{let s=!1;return"creation"===e.node_type&&(t?this.$store.state.commonParams.userId===t&&(s=!0):s=!0),s}}},methods:{renderStatus(t){return"pending"===t.node_type?1===t.user_list.length?this.$t("attestation.approve"):this.$t("attestation.andOthersApproval"):this.statusTip[t.node_type]}}},m=s(1001),g=(0,m.Z)(p,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"operation-status-container"},["creation"===t.item.node_type||"pass"===t.item.node_type||"reject"===t.item.node_type?s("span",{staticClass:"info-name"},[t.renderMe(t.item)?s("span",[t._v(t._s(t.$t("attestation.me")))]):s("cl-custom-user",{attrs:{type:t.item.sync_source_type,"data-type":"userName",value:t.item.sync_user_id,name:t.item.approver_user_name}})],1):t._e(),"pending"===t.item.node_type||"leave"===t.item.node_type?s("span",[t._v(" "+t._s(t.statusTip[t.item.node_type])+" ")]):t._e(),"pending"===t.item.node_type||"un_pending"===t.item.node_type?s("span",{staticClass:"user-name"},[s("cl-custom-user",{attrs:{type:t.item.user_list[0].sync_source_type,"data-type":"userName",value:t.item.user_list[0].sync_user_id,name:t.item.user_list[0].name}}),t._v(" "+t._s(t.item.user_list.length>1?t.$t("attestation.or"):"")+" "),t.item.user_list.length>=2?s("cl-custom-user",{attrs:{type:t.item.user_list[1].sync_source_type,"data-type":"userName",value:t.item.user_list[1].sync_user_id,name:t.item.user_list[1].name}}):t._e(),t._v(" "+t._s(t.item.user_list.length>2?t.$t("attestation.andOther"):"")+" ")],1):t._e(),"creation"===t.item.node_type||"pass"===t.item.node_type||"reject"===t.item.node_type||"pending"===t.item.node_type?s("span",{staticClass:"status-label",class:"status-label__"+t.item.node_type},[t._v(" "+t._s(t.renderStatus(t.item))+" ")]):t._e()])}),[],!1,null,"37c3b132",null).exports,v=s(95084),f={components:{[u.Z.name]:u.Z,[l.Z.name]:l.Z,Avatar:d.Z,SvgIcon:n.Z,Status:g,ClAttachment:v.Z},filters:{formatDate:t=>(0,c.p6)(t,"MM-dd  hh:mm")},props:{approvalRecord:{type:Array,default:()=>[]},hasScore:{type:Boolean,default:!1}},computed:(0,a.Z)({},(0,h.mapState)(["themeColor"]))},y=(0,m.Z)(f,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("van-steps",{staticClass:"operation-steps-container",attrs:{direction:"vertical",active:-1}},t._l(t.approvalRecord,(function(e){return s("van-step",{key:e.id,staticClass:"step-item"},[s("div",{staticClass:"info-active"},[s("div",{staticClass:"left"},[s("Avatar",{attrs:{src:"pass"===e.node_type||"reject"===e.node_type?e.approval_user_avatar:e.user_list[0].approval_user_avatar,width:"24",height:"24"}}),s("Status",{attrs:{item:e}}),t.hasScore&&e.score?s("div",{staticClass:"score-text"},[t._v(t._s(e.score)+" "+t._s(t.$t("mineScore.points")))]):t._e(),"leave"===e.node_type?s("div",{staticClass:"leave-btn",on:{click:function(e){return t.$emit("handover")}}},[t._v(" "+t._s(t.$t("attestation.handOverAdministrator"))+" "),s("svg-icon",{attrs:{"icon-class":"icon-jinrujiantou",color:t.themeColor.primaryColor,size:"12"}})],1):t._e()],1),"creation"===e.node_type||"pass"===e.node_type||"reject"===e.node_type?s("div",{staticClass:"right"},[t._v(t._s(t._f("formatDate")(e.update_time)))]):t._e()]),"pass"===e.node_type||"reject"===e.node_type?s("div",{staticClass:"info-introduce"},[t._v(t._s(e.opinion))]):t._e(),e.resources?s("cl-attachment",{attrs:{"attachment-list":e.resources,"is-preview":!0}}):t._e()],1)})),1)}),[],!1,null,"33f725ee",null).exports,_=s(95969),C=(s(73474),s(74755)),I=(s(93787),s(20090)),b=(s(47601),s(44951)),w=(s(23307),s(81392)),$=(s(33948),s(28387)),k=s(52835),S=s(74022),T=s(78368),Z={components:{[i.Z.name]:i.Z,[w.Z.name]:w.Z,[b.Z.name]:b.Z,[I.Z.name]:I.Z,[C.Z.name]:C.Z,[l.Z.name]:l.Z,[u.Z.name]:u.Z,Approver:S.Z},filters:{formatDate:function(t){return(0,c.p6)(t,"yyyy.MM.dd hh:mm")}},props:{approvalType:{type:String,default:""},instanceId:{type:String,default:""}},data:()=>({content:"",bizType:"",status:"",defaultAvatar:T,workflowInfo:{status:"",list:[]},showPopup:!1,formData:{status:1,suggest:""},valueWithdraw:"",approvalStatus:k.t,showAll:!1,currentFlowObj:{},scoreSetting:{scoreSwitch:!1,score:0}}),computed:(0,a.Z)({},(0,h.mapGetters)({primaryColor:"getPrimaryColor"})),created(){},mounted(){this.getWorkflowInfo(this.instanceId)},methods:{initScoreData(){let t=this.workflowInfo.content?JSON.parse(this.workflowInfo.content):{};"object"==typeof t&&t&&(this.scoreSetting={scoreSwitch:t.score_switch,score:t.score_limit})},async getWorkflowInfo(t){this.$toast.loading({duration:0,forbidClick:!0,message:this.$t("common.loading")});const{data:e}=await $.Z.approvalsApi.getWorkflowInfo(t);this.workflowInfo=e.data,this.status=this.workflowInfo.status,this.bizType=this.workflowInfo.bizType,this.content=this.workflowInfo.content,this.initScoreData(),this.$toast.clear()},getSignTypeDesc(t,e){if(e>0)for(const s of k.H)if(s.name===t)return this.$t(s.lang,{param:e});return""},hidePopup(){this.show=!1},handleAll(t){this.currentFlowObj=t,this.showAll=!0}}},x=(0,m.Z)(Z,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"new-steps"},[s("div",{staticClass:"my-flow"},[s("h5",[t._v(t._s(t.$t("approvals.flow")))]),s("div",{staticClass:"my-steps"},[s("van-steps",{attrs:{direction:"vertical",active:t.workflowInfo.list.length-1}},t._l(t.workflowInfo.list,(function(e,a){return s("van-step",{key:e.id,staticClass:"flow-step",scopedSlots:t._u([{key:"active-icon",fn:function(){return[s("div",{staticClass:"step-icon"},[s("van-image",{attrs:{round:"",src:e.users&&1===e.users.length&&e.users[0].avatar?e.users[0].avatar:t.defaultAvatar,fit:"fill",width:"100%",height:"100%"}})],1)]},proxy:!0},{key:"inactive-icon",fn:function(){return[s("div",{staticClass:"step-icon"},[s("van-image",{attrs:{round:"",src:e.users&&1===e.users.length&&e.users[0].avatar?e.users[0].avatar:t.defaultAvatar,fit:"fill",width:"100%",height:"100%"}})],1)]},proxy:!0}],null,!0)},[s("div",{staticStyle:{flex:"1"}},[s("p",{staticClass:"title"},[t._v(t._s("approval_revoked"===e.status?t.$t("approvals.revoked"):a>0?t.$t("approvals.approver"):t.$t("approvals.apply")))]),"true"!==e.autoPass&&e.users&&1===e.users.length?[s("p",{staticClass:"name"},[t._v(" "+t._s(e.users[0].userName)+" "),0!==a?s("span",{style:{color:t.approvalStatus[e.status].color}},[t._v("("+t._s(t.$t(t.approvalStatus[e.status].otherLang))+")")]):t._e(),"true"===String(t.scoreSetting.scoreSwitch)&&e.users[0].extendInfo&&String(e.users[0].extendInfo.score)?s("span",[s("span",{staticClass:"score",domProps:{textContent:t._s(e.users[0].extendInfo&&e.users[0].extendInfo.score)}}),s("span",{domProps:{textContent:t._s(t.$t("myRating.point"))}})]):t._e()]),e.users[0].formMsg?s("p",{staticClass:"text"},[t._v(t._s(e.users[0].formMsg))]):t._e()]:t._e(),"true"!==e.autoPass&&e.users&&e.users.length>1?s("p",{staticClass:"name"},[t._v(t._s(t.getSignTypeDesc(e.signType,e.users.length)))]):t._e(),"true"===e.autoPass?s("p",{staticClass:"name"},[t._v(t._s(t.$t("approvals.autoPass")))]):t._e(),e.users&&e.users.length>1?s("div",{staticClass:"user"},[s("Approver",{attrs:{"is-fold":!0,users:e.users&&e.users.map((function(t){return Object.assign({},t,{id:t.userId,name:t.userName})})),"sign-type":e.signType,edit:!1,max:4},on:{onAll:function(s){return t.handleAll(e)}}})],1):t._e()],2),e.users&&e.users.length>0&&0!==e.users[0].approvalTime?s("span",{staticClass:"time"},[t._v(t._s(t._f("formatDate")(e.users[0].approvalTime)))]):t._e()])})),1)],1)]),s("van-popup",{staticClass:"my-popup-all",style:{height:"80%"},attrs:{position:"bottom"},model:{value:t.showAll,callback:function(e){t.showAll=e},expression:"showAll"}},[s("Approver",{attrs:{"is-fold":!1,users:t.currentFlowObj.users&&t.currentFlowObj.users.map((function(t){return Object.assign({},t,{id:t.userId,name:t.userName})})),"sign-type":t.currentFlowObj.signType,edit:!1,joint:!1}})],1)],1)}),[],!1,null,"15a23f20",null).exports,P=s(68092),D={components:{[o.Z.name]:o.Z,[i.Z.name]:i.Z,SvgIcon:n.Z,Steps:y,ClAttachment:v.Z,NewSteps:x},filters:{formatDate:t=>(0,c.p6)(t,"yyyy-MM-dd  hh:mm"),approvalTypeFormate:t=>{switch(String(t)){case"0":return"0";case"1":default:return"pending";case"3":return"processed"}}},data:()=>({loading:!0,statusText:{1:"approvalPending",2:"rejected",3:"approved"},iconType:{1:"icon-shenpizhong",2:"icon-guanbi",3:"icon-duigou"},iconTypeColor:{1:"#B1B5C6",2:"#fff",3:"#fff"},isHuaLaiShi:(0,P.UI)("PRIVACY_HLS_APPROVAL_MANAGE"),approvalType:"",instanceId:""}),computed:{query(){const{id:t,pageFrom:e,rootInPage:s="go",operationSource:a}=this.$route.query;return{id:t,pageFrom:e,origin:s,operationSource:a}},renderSubmit(){let t=!1;const{studentId:e}=this.$route.query;return t=!e&&(2===this.data.status&&"microcourseList"!==this.query.pageFrom),t}},mounted(){this.initData()},methods:{initData(){"microcourseList"===this.query.pageFrom?this.getMicroCourseInfo():this.getOperationInfo()},async getMicroCourseInfo(){const{data:t}=await r.Z.microCoursesOperationsInfo(this.query.id);this.loading=!1;const e=(0,a.Z)((0,a.Z)({},t),{},{score_setting:{score_switch:"off"}});this.data=e,this.stepsList=t.steps||[],this.approvalRecord=t.approval_record},async getOperationInfo(){const{studentId:t}=this.$route.query,{data:e}=this.isHuaLaiShi&&"qualification"===this.query.operationSource?await r.Z.operationsCustomInfo(this.query.id):await r.Z.operationsInfo(this.query.id,t);this.loading=!1;const s=e.data;s.steps&&s.steps.forEach((t=>{t.resources&&t.resources.forEach((t=>{t.type=t.type&&t.type.match(/^(image\/)/)?t.type.split("/")[1]:t.type}))})),this.stepsList=s.steps||[],this.operationSource=s.operation_source,this.approvalRecord=s.approval_record,this.data=s},resubmit(){const{id:t,mapId:e,operationSource:s}=this.$route.query;this.$router.push(_.Z.taskResource.operationDetail({courseId:t,studyType:s||this.operationSource,mapId:e,fromRouter:"operation-result"}))},async handOver(){const{data:t}=await r.Z.adminApproval(this.data.instance_id);"true"===t.status&&this.initData()}}},L=(0,m.Z)(D,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"operation-result-container"},[t.loading?s("van-loading",{staticClass:"operation-center"}):s("div",{staticClass:"operation-content",class:2===t.data.status?"btn-padding":""},[s("div",{staticClass:"status-box"},[t.iconTypeColor[t.data.status]&&t.iconType[t.data.status]?s("div",{staticClass:"status-icon",class:"status-icon__"+t.statusText[t.data.status]},[s("svg-icon",{attrs:{"icon-class":t.iconType[t.data.status],color:t.iconTypeColor[t.data.status],size:3===t.data.status?28:54}})],1):t._e(),s("div",{staticClass:"status-text",class:"status-text__"+t.statusText[t.data.status]},[t._v(t._s(t.$t("attestation."+t.statusText[t.data.status])))]),1!==t.data.status?s("div",{staticClass:"time-text"},[t._v(t._s(t._f("formatDate")(t.data.approval_time)))]):t._e(),t.data.score?s("div",{staticClass:"score-text"},[t._v(t._s(t.$t("project.averageScore"))+": "+t._s(t.data.score))]):t._e()]),"true"===String(t.isHuaLaiShi)&&"0"!==String(t.data.status)&&"qualification"===t.query.operationSource?s("NewSteps",{attrs:{"approval-type":t._f("approvalTypeFormate")(t.data.status),"instance-id":t.data.instance_id}}):s("Steps",{attrs:{"approval-record":t.approvalRecord,"has-score":"on"===t.data.score_setting.score_switch},on:{handover:t.handOver}}),"microcourseList"!==t.query.pageFrom?s("div",{staticClass:"operation-field"},t._l(t.stepsList,(function(e,a){return s("div",{key:a,staticClass:"step-item"},[s("div",{staticClass:"step-item-title"},[t._v(t._s(t.$t("approval.step",{step:a+1})))]),s("div",{staticClass:"step-item-describe"},[t._v(t._s(e.content))]),s("cl-attachment",{attrs:{"attachment-list":e.resources,"is-preview":!0}})],1)})),0):t._e(),t.renderSubmit?s("van-button",{staticClass:"resubmit-btn",attrs:{block:""},on:{click:t.resubmit}},[t._v(t._s(t.$t("attestation.resubmit")))]):t._e()],1)],1)}),[],!1,null,"18ac196f",null),A=L.exports},43356:(t,e,s)=>{s.r(e),s.d(e,{default:()=>g});var a=s(95082),i=(s(25773),s(35791)),o=(s(93787),s(20090)),r=(s(3791),s(93432)),n=(s(74916),s(4723),s(57658),s(33948),s(27632)),c=s(72311),l=s(95084),u=s(78551),d=s(27083),h=s(26294),p=s(68092),m={components:{[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,ClAttachment:l.Z,SvgIcon:u.Z,TutorBomb:d.Z},data(){return{loading:!0,iconList:[],data:{},checkedId:"",checkedName:"",saveCheckedId:"",saveCheckedName:"",tutorsList:[],stepsList:[],isSubmit:!1,showtutorsModal:!1,isSaveDrafts:!0,isHuaLaiShi:(0,p.UI)("PRIVACY_HLS_APPROVAL_MANAGE"),viewFlag:this.$route.query.viewFlag}},computed:(0,a.Z)((0,a.Z)((0,a.Z)((0,a.Z)({},(0,h.mapState)("setting",["dingDiskChoose"])),(0,h.mapState)("user",["dingUserId","corpId","userId"])),(0,h.mapState)(["themeColor"])),{},{query(){const{id:t,mapId:e,operationSource:s,userId:a}=this.$route.query;return{id:t,mapId:e,operationSource:s,userId:a}},canSubmit(){return this.isSubmit&&!("tutor"===this.data.approval_type&&!this.checkedId)}}),mounted(){this.setIconList(),this.initData()},methods:{setIconList(){"dingTalk"===n.Z.env?this.iconList=["camera","video","dingPlate"]:this.iconList=["camera","album","video"]},async initData(){try{const{data:t}=await c.Z.operationsViewCustomInfo(this.query.userId,this.query.id);this.loading=!1,this.data=t.data,this.saveCheckedId=t.data.tutor_user_id||"",this.saveCheckedName=t.data.tutor_user_name||"",this.checkedId=t.data.tutor_user_id||"",this.checkedName=t.data.tutor_user_name||"";let e=[];0===t.data.steps.length?e=[{content:"",resources:[]}]:(t.data.steps.forEach((t=>{t.content||(t.content=""),t.resources&&t.resources.forEach((t=>{t.type=t.type.match(/^(image\/)/)?t.type.split("/")[1]:t.type}))})),e=t.data.steps),this.stepsList=e,this.inputMonitor(e)}catch(t){this.loading=!1,this.$toast.fail(t.data)}},inputMonitor(t){let e=0;t.forEach((t=>{0!==t.resources.length||t.content||(e+=1)})),e===t.length?this.isSubmit=!1:this.isSubmit=!0},inputEvent(t,e){this.stepsList[e].content=t,this.inputMonitor(this.stepsList)},onUploadSuccess(t,e){this.stepsList[e].resources.push(...t),this.inputMonitor(this.stepsList)},onDeleteResources(t,e){this.$dialog.confirm({title:this.$t("promptMessage.warmTips"),message:this.$t("promptMessage.delete"),confirmText:this.$t("buttons.confirm"),cancelText:this.$t("buttons.cancel")}).then((()=>{this.operationFileDelete(t,e)}))},async operationFileDelete(t,e){const s=this.stepsList[e].resources[t].id;try{await c.Z.operationFileDelete(s),this.stepsList[e].resources.splice(t,1),this.inputMonitor(this.stepsList)}catch(t){this.$toast.fail(t.data)}},handleAddStep(){this.stepsList.push({content:"",resources:[]}),this.inputMonitor(this.stepsList)},stepsDelete(t){this.stepsList.splice(t,1),this.inputMonitor(this.stepsList)},async handleGetTutorList(){this.$toast.loading();const t={user_id:this.userId,status:"on",filter_user_quit:"true",filter_user_tutor:"true"};try{const{data:e={}}=await c.Z.getTutorsList(t);this.$toast.clear();const{list:s=[]}=e.data;s.length?(this.tutorsList=s,this.showtutorsModal=!0):this.$dialog({title:this.$t("study.tutorNoTitle"),message:this.$t("study.tutorNoDesc")})}catch(t){this.$toast.clear()}},onTutorCancel(){this.showtutorsModal=!1,this.checkedId=this.saveCheckedId,this.checkedName=this.saveCheckedName,this.inputMonitor(this.stepsList)},onTutorConfirm(){this.showtutorsModal=!1,this.inputMonitor(this.stepsList)},onSingleChange(t){this.checkedId=t.user_id,this.checkedName=t.user_name}}},g=(0,s(1001).Z)(m,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"operation-container"},[t.loading?s("van-loading",{staticClass:"operation-center"}):s("div",{staticClass:"operation-content"},[s("div",{staticClass:"operation-top"},[t.data.title?s("div",{staticClass:"operation-title"},[t._v(" "+t._s(t.data.title)+" ")]):t._e(),t.data.content?s("div",{staticClass:"operation-context"},[s("div",{staticClass:"context-label"},[t._v(t._s(t.$t("approval.workRequirements"))+"：")]),s("div",{staticClass:"context-content"},[t._v(t._s(t.data.content))])]):t._e(),t.data.resources.length?s("cl-attachment",{attrs:{"attachment-list":t.data.resources,"is-preview":!0}}):t._e()],1),t._l(t.stepsList,(function(e,a){return s("div",{key:a,staticClass:"operation-step"},[s("div",{staticClass:"step-title"},[s("span",[t._v(t._s(t.$t("approval.step",{step:a+1})))])]),s("van-field",{staticClass:"step-section-textarea",attrs:{value:e.content,disabled:"",rows:"5",type:"textarea",maxlength:"1200",placeholder:t.$t("attestation.practicalExamTips")},on:{input:function(e){return t.inputEvent(e,a)}}}),s("div",{staticClass:"step-attachment"},[s("cl-attachment",{attrs:{"attachment-list":e.resources,"is-preview":!0,"is-delete":!1},on:{delete:function(e){t.onDeleteResources(e,a)}}})],1)],1)})),"tutor"===t.data.approval_type?s("div",{staticClass:"operation-tutor"},[s("div",{staticClass:"tutor-name"},[s("span",[t._v(t._s(t.$t("attestation.chooseTutor")))]),s("span",{staticClass:"name-data"},[t._v(t._s(t.checkedName))])]),s("svg-icon",{attrs:{"icon-class":"icon-chakanpaiming",color:"#B0B4C8",size:14}})],1):t._e()],2),t.showtutorsModal?s("tutor-bomb",{attrs:{"no-show-desc":"","tutors-list":t.tutorsList,"checked-id":t.checkedId},on:{cancel:t.onTutorCancel,confirm:t.onTutorConfirm,change:t.onSingleChange}}):t._e()],1)}),[],!1,null,"0eb63147",null).exports},68665:(t,e,s)=>{s.r(e),s.d(e,{default:()=>p});s(34837);var a=s(39146),i=s(95082),o=(s(31146),s(41610)),r=(s(3791),s(93432)),n=(s(47601),s(44951)),c=(s(57658),s(26294)),l=s(45877),u=s(85566),d=s(78368),h={name:"PracticeDetail",components:{VanImage:n.Z,Loading:r.Z,ClCustomUser:l.Z,[o.Z.Component.name]:o.Z.Component},data:()=>({defaultAvatar:d,practicId:"",biz_type:"",practiceInfo:{completeQuestionCount:0,id:"",lastQuestionBank:"0",status:0,totalQuestionCount:0,wrongQuestionCount:0},banner1:`${PRACTICE_GAME_HOST}/images/banner1.png`,banner2:`${PRACTICE_GAME_HOST}/images/banner2.png`,banner3:`${PRACTICE_GAME_HOST}/images/banner3.png`,icon1:`${PRACTICE_GAME_HOST}/images/icon1.png`,icon2:`${PRACTICE_GAME_HOST}/images/icon2.png`,icon3:`${PRACTICE_GAME_HOST}/images/icon3.png`,practiceBackBg:`${PRACTICE_GAME_HOST}/images/indexbg.png`,topBackBg:`${PRACTICE_GAME_HOST}/images/topbg.png`,standard_icon:`${ASSETS_OSS_HOST}/1826556538156879872.png`,start:!1,gameDate:{},isLoading:!1,showMaskFixed:!1,showMaskRandom:!1,showMaskBank:!1,isPlaying:!1,isContinue:!1}),computed:(0,i.Z)({},(0,c.mapGetters)({userInfo:"user/getUserInfo",primaryColor:"getPrimaryColor"})),mounted(){let{id:t,biz_type:e=""}=this.$route.query;this.practicId=t,this.biz_type=e||"",this.getPracticeById(),this.$store.commit("practice/refreshGame",!1)},methods:{enter(t){if(0!==this.practiceInfo.completeQuestionCount||0!==this.practiceInfo.totalQuestionCount)if("true"===this.practiceInfo.showNew)this.enterQuestion("false",t);else switch(t){case"fixed":this.showMaskFixed=!0,this.showMaskRandom=!1,this.showMaskBank=!1;break;case"random":this.showMaskFixed=!1,this.showMaskRandom=!0,this.showMaskBank=!1;break;case"bank":this.showMaskFixed=!1,this.showMaskRandom=!1,this.showMaskBank=!0}else(0,a.Z)(this.$t("practice.noQuestion"))},enterQuestion(t,e){"false"===t&&"bank"===e?(this.practiceInfo.isContinue=!1,this.$router.push({path:"/study-resource/practice/select-practice",query:this.practiceInfo})):"true"===t&&"bank"===this.practiceInfo.lastPracticeType?(this.practiceInfo.isContinue=!0,this.$router.push({path:"/study-resource/practice/select-practice",query:this.practiceInfo})):("true"===t&&(e=this.practiceInfo.lastPracticeType),this.getQuestion(t,e))},getRate(){return this.practiceInfo.completeQuestionCount>0?Math.round(1e3*(this.practiceInfo.completeQuestionCount-this.practiceInfo.wrongQuestionCount)/this.practiceInfo.completeQuestionCount)/10:0},getQuestion(t,e){this.playGame(this.practiceInfo.id,e,t,"")},async getPracticeById(){this.isLoading=!0;const{code:t,data:e}=await u.Z.getPracticeDetailById({practiceId:this.practicId,biz_type:this.biz_type});0===t&&(this.practiceInfo=e,document.title=this.practiceInfo.title,this.isLoading=!1)},async queryQuestionCount(t,e,s,i){const{data:o}=await u.Z.queryQuestionCount({practiceId:t,type:e,isContinue:s,questionId:i});return"number"==typeof o&&o>0||((0,a.Z)(this.$t("practice.noQuestion")),!1)},async playGame(t,e,s,a){await this.queryQuestionCount(t,e,s,a)&&this.$router.push({path:"/study-resource/practice/practice-game",query:{practiceId:t,type:e,isContinue:s,questionId:a,biz_type:this.biz_type||""}})}}},p=(0,s(1001).Z)(h,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"practice cl-page-container",style:{backgroundImage:"url("+t.practiceBackBg+")"}},[t.isLoading?s("Loading",{staticClass:"loading"},[t._v(t._s(t.$t("common.loading")))]):s("div",[s("div",{staticClass:"top",style:{backgroundImage:"url("+t.topBackBg+")"}},[s("div",{staticClass:"avatar"},[s("div",{staticClass:"title van-ellipsis"},[t._v(t._s(t.practiceInfo.title))]),s("van-image",{staticClass:"avatar-icon",attrs:{round:"",alt:"avatar",fit:"cover",height:"64px",width:"64px",src:t.userInfo.avatar||t.defaultAvatar}}),s("div",{staticClass:"user-name van-ellipsis"},[s("cl-custom-user",{attrs:{type:t.userInfo.sourceType,"data-type":"userName",value:t.userInfo.account,name:t.userInfo.name||""}})],1)],1),s("div",{staticClass:"practice-info"},[t.biz_type?s("div",{staticClass:"practice-info-item"},[s("van-image",{attrs:{alt:"icon1",fit:"contain",height:"50px",width:"50px",src:t.standard_icon}}),s("div",{staticClass:"icon-value"},[t._v(t._s(t.practiceInfo.passLine||0)+"%")]),s("div",{staticClass:"icon-desc"},[t._v(t._s(t.$t("project.learningRequirementsTips")))])],1):t._e(),s("div",{staticClass:"practice-info-item"},[s("van-image",{attrs:{alt:"icon1",fit:"contain",height:"50px",width:"50px",src:t.icon1}}),s("div",{staticClass:"icon-value"},[t._v(t._s(t.practiceInfo.completeQuestionCount))]),s("div",{staticClass:"icon-desc"},[t._v(t._s(t.$t("practice.totalAnswer")))])],1),s("div",{staticClass:"practice-info-item"},[s("van-image",{attrs:{alt:"icon2",fit:"contain",height:"50px",width:"50px",src:t.icon2}}),s("div",{staticClass:"icon-value"},[t._v(t._s(t.practiceInfo.completeQuestionCount-t.practiceInfo.wrongQuestionCount))]),s("div",{staticClass:"icon-desc"},[t._v(t._s(t.$t("practice.correctAnswer")))])],1),t.biz_type?t._e():s("div",{staticClass:"practice-info-item"},[s("van-image",{attrs:{alt:"icon3",fit:"contain",height:"50px",width:"50px",src:t.icon3}}),s("div",{staticClass:"icon-value"},[t._v(t._s(t.getRate())+"%")]),s("div",{staticClass:"icon-desc"},[t._v(t._s(t.$t("practice.correctRate")))])],1)])]),s("div",{staticClass:"banner-div"},[s("div",{staticClass:"banner",on:{click:function(e){return t.enter("fixed")}}},[s("van-image",{attrs:{alt:"icon",fit:"contain",height:"100%",width:"100%",src:t.banner1}}),s("div",{staticClass:"txt"},[t._v(t._s(t.$t("practice.sequentialQuestionBank")))]),t.showMaskFixed?s("div",{staticClass:"mask"},[s("div",{staticClass:"button van-ellipsis",staticStyle:{color:"#1E89F5"},on:{click:function(e){return t.enterQuestion("true","fixed")}}},[t._v(t._s(t.$t("practice.continueQuestion")))]),s("div",{staticClass:"button van-ellipsis",staticStyle:{color:"#17C289"},on:{click:function(e){return t.enterQuestion("false","fixed")}}},[t._v(t._s(t.$t("practice.startNewQuestion")))])]):t._e()],1),s("div",{staticClass:"banner",on:{click:function(e){return t.enter("random")}}},[s("van-image",{attrs:{alt:"icon",fit:"contain",height:"100%",width:"100%",src:t.banner2}}),s("div",{staticClass:"txt"},[t._v(t._s(t.$t("practice.randomQuestionBank")))]),t.showMaskRandom?s("div",{staticClass:"mask"},[s("div",{staticClass:"button van-ellipsis",staticStyle:{color:"#1E89F5"},on:{click:function(e){return t.enterQuestion("true","random")}}},[t._v(t._s(t.$t("practice.continueQuestion")))]),s("div",{staticClass:"button van-ellipsis",staticStyle:{color:"#17C289"},on:{click:function(e){return t.enterQuestion("false","random")}}},[t._v(t._s(t.$t("practice.startNewQuestion")))])]):t._e()],1),s("div",{staticClass:"banner2",staticStyle:{height:"80%"},on:{click:function(e){return t.enter("bank")}}},[s("van-image",{attrs:{alt:"icon",height:"100%",width:"93.8%",src:t.banner3}}),s("div",{staticClass:"txt"},[t._v(t._s(t.$t("practice.selectQuestionBank")))]),t.showMaskBank?s("div",{staticClass:"mask"},[s("div",{staticClass:"button van-ellipsis",staticStyle:{color:"#1E89F5"},on:{click:function(e){return t.enterQuestion("true","bank")}}},[t._v(t._s(t.$t("practice.continueQuestion")))]),s("div",{staticClass:"button van-ellipsis",staticStyle:{color:"#17C289"},on:{click:function(e){return t.enterQuestion("false","bank")}}},[t._v(t._s(t.$t("practice.startNewQuestion")))])]):t._e()],1)])])],1)}),[],!1,null,"da5db230",null).exports},12541:(t,e,s)=>{s.r(e),s.d(e,{default:()=>p});s(34837);var a=s(39146),i=s(95082),o=(s(31146),s(41610)),r=(s(3791),s(93432)),n=(s(74916),s(15306),s(26294)),c=s(27632),l=s(78368),u=s(22648),d=s(85566),h={name:"PracticeGame",components:{[r.Z.name]:r.Z,[o.Z.Component.name]:o.Z.Component},data:()=>({practiceId:"",questionId:"",isContinue:!0,type:"",start:!0,practiceBackBg:`${PRACTICE_GAME_HOST}/images/indexbg.png`,gameData:null,defalutAvatar:l,iframeWin:{},title:"",isGameLoaded:!1,isPageLoaded:!1,gameDataOk:!1,msgData:{},url:"",t:null}),computed:(0,i.Z)({},(0,n.mapGetters)({userInfo:"user/getUserInfo",primaryColor:"getPrimaryColor"})),watch:{start:{handler:function(){this.startGame()},deep:!0},isGameLoaded:{handler:function(){this.startGame()},deep:!0},isPageLoaded:{handler:function(){this.postGameData()},deep:!0},gameData(t){t&&(this.gameDataOk=!0,this.postGameData())}},beforeDestroy(){window.removeEventListener("message",this.messageFun,!1)},mounted(){document.title=this.$t("pageTitle.questionPractice");let t=this.$route.query;this.practiceId=t.practiceId,this.type=t.type,this.questionId=t.questionId,this.isContinue="true"===t.isContinue,this.$store.commit("practice/refreshGame",!0),this.init();let e="zh_cn";this.$i18n.locale&&(e=this.$i18n.locale.replace("-","_")),this.url=`${PRACTICE_GAME_HOST}/mobile/index.html?loglvl=0&lang=${e}&t=${(new Date).getTime()}`,window.addEventListener("message",this.messageFun,!1)},methods:{init(){"wrong"===this.type?this.getWrongQuestion(this.practiceId):this.getQuestion(this.practiceId,this.isContinue,this.type,this.questionId)},messageFun(t){try{let{data:e}=t;"practice_game"===e.from&&("cheer"===e.name?this.playAudio("cheer"):"fail"===e.name?this.playAudio("fail"):"stamp-delayed"===e.name?this.playAudio("stamp-delayed"):"stamp"===e.name?this.playAudio("stamp"):"page_loaded"===e.name?this.isPageLoaded=!0:"download_success"===e.name?this.isGameLoaded=!0:"download_fail"===e.name?document.getElementById("gameFrame").contentWindow.postMessage({name:"reload_page",from:"practice_game_container",data:null},"*"):"end_game"===e.name&&this.goBack())}catch(t){console.error(t)}},async getQuestion(t,e,s,i){const{code:o,data:r}=await d.Z.getPracticesQuestion({practiceId:t,type:s,isContinue:e,questionId:i});if(0===o){if(this.gameData=r,!r.questions||0===r.questions.length)return void(0,a.Z)(this.$t("practice.noQuestion"));this.playGame()}},async getWrongQuestion(t){const{code:e,data:s}=await d.Z.getPracticesWrongQuestion({practiceId:t});0===e&&(this.gameData=s,this.playGame())},playGame(){this.start=!0,this.postGameData()},reload(){},postGameData(){if(this.isPageLoaded&&this.gameData){if("remove"===this.gameData.status)return void o.Z.alert({message:this.$t("practice.removeTip")}).then((()=>{this.$router.go(-1)}));if("not_enabled"===this.gameData.status)return void o.Z.alert({message:this.$t("practice.unenableTip")}).then((()=>{this.$router.go(-1)}));let t={data:(0,u.Tq)(this.gameData,"toLine"),accessToken:this.userInfo.accessToken,enterpriseApi:`${CL_API}/training-manage-api`,env:c.Z.env,practiceId:this.practiceId,enterprise_id:this.userInfo.enterpriseId,user_id:this.userInfo.userId,lang:this.$i18n.locale,continue_last:this.isContinue};this.msgData={name:"game_data",from:"practice_game_container",data:t},document.getElementById("gameFrame").contentWindow.postMessage(this.msgData,this.url)}},startGame(){this.start&&this.isGameLoaded&&this.gameDataOk&&(document.getElementById("gameFrame").style.opacity="1",document.getElementById("gameFrame").contentWindow.postMessage({name:"start_game",from:"practice_game_container",data:null},this.url))},goBack(){this.isPageLoaded=!1,this.gameDataOk=!1,this.start=!1,this.$router.go(-1)},playAudio(t){let e=`${PRACTICE_GAME_HOST}/audio/${t}.mp3`;if(e){let t=new Audio;t.src=e,t.play()}}}},p=(0,s(1001).Z)(h,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"practice cl-page-container",style:{backgroundImage:"url("+t.practiceBackBg+")"}},[t.isGameLoaded?t._e():s("van-loading",{staticClass:"loading",attrs:{type:"spinner",size:"36",vertical:""}},[t._v(t._s(t.$t("common.loading")))]),s("iframe",{staticClass:"iframe",attrs:{id:"gameFrame",frameborder:"0",src:t.url}})],1)}),[],!1,null,"d8c56240",null).exports},94986:(t,e,s)=>{s.r(e),s.d(e,{default:()=>g});s(34837);var a=s(39146),i=s(95082),o=(s(31146),s(41610)),r=(s(3791),s(93432)),n=(s(49153),s(5944)),c=(s(20581),s(50914)),l=(s(58052),s(68286)),u=(s(33948),s(57658),s(26294)),d=s(85566),h=s(78368),p={name:"SelectPractice",components:{PullRefresh:l.Z,List:c.Z,Empty:n.Z,Loading:r.Z,[o.Z.Component.name]:o.Z.Component},data:()=>({defaultAvatar:h,isLoading:!0,start:!1,reflushGame:!1,gameDate:{},list:[],pageNumber:1,pageSize:20,loading:!1,refreshing:!1,finished:!1,isPlaying:!1,practiceInfo:{},practiceBackBg:`${PRACTICE_GAME_HOST}/images/detailbg.png`,bannerBackBg:`${PRACTICE_GAME_HOST}/images/bannerbg.png`}),computed:(0,i.Z)({},(0,u.mapGetters)({userInfo:"user/getUserInfo",primaryColor:"getPrimaryColor"})),mounted(){document.title=this.$t("pageTitle.selectQuestionBank"),this.practiceInfo=this.$route.query,this.$store.state.practice.refreshGame&&(this.practiceInfo.isContinue="true"),this.getList()},methods:{enter(t){if(0===t.questionNumber)return void(0,a.Z)(this.$t("practice.noQuestion"));let e=document.getElementById("practiceList");e.style.transition="all 0.3s ease-in 0s;",e.style.marginTop="-5vh",e.style.transition="all 0.5s ease-out 0s;",e.style.marginTop="120vh",this.playGame(this.practiceInfo.id,"bank",this.practiceInfo.isContinue,t.questionBankId)},getRate:t=>t.questionNumber>0?Math.round(1e3*t.practiceNumber/t.questionNumber)/10:0,onLoad(){this.refreshing?(this.isLoading=!0,this.list=[],this.refreshing=!1,this.pageNumber=1):this.pageNumber+=1,this.getList()},onRefresh(){this.finished=!1,this.loading=!0,this.refreshing=!0,setTimeout((()=>{this.onLoad()}),100)},async getList(){const{code:t,data:{list:e,hasNextPage:s}}=await d.Z.getPracticesQuestionList({practiceId:this.practiceInfo.id,isContinue:this.practiceInfo.isContinue,pageNumber:this.pageNumber,pageSize:this.pageSize});0===t&&e&&(this.list=[...this.list,...e],this.loading=!1,this.isLoading=!1,this.finished="false"===s)},async queryQuestionCount(t,e,s,i){const{data:o}=await d.Z.queryQuestionCount({practiceId:t,type:e,isContinue:s,questionId:i});return"number"==typeof o&&o>0||((0,a.Z)(this.$t("practice.noQuestion")),!1)},async playGame(t,e,s,a){await this.queryQuestionCount(t,e,s,a)&&setTimeout((()=>{this.$router.push({path:"/study-resource/practice/practice-game",query:{practiceId:t,type:e,isContinue:s,questionId:a}})}),300)}}},m=p,g=(0,s(1001).Z)(m,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"practice cl-page-container",style:{backgroundImage:"url("+t.practiceBackBg+")"},attrs:{id:"practiceList"}},[t.isLoading?s("Loading",{staticClass:"loading"},[t._v(t._s(t.$t("common.loading")))]):s("div",[s("div",{staticClass:"title van-ellipsis"},[t._v(t._s(t.practiceInfo.title))]),s("PullRefresh",{on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[t.list.length>0?s("list",{attrs:{"immediate-check":!1,finished:t.finished,"finished-text":t.$t("common.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[s("div",{staticClass:"banner-div"},t._l(t.list,(function(e){return s("div",{key:e.questionBankId,ref:"item"+e.questionBankId,refInFor:!0,staticClass:"banner",style:{backgroundImage:"url("+t.bannerBackBg+")"},on:{click:function(s){return t.enter(e)}}},[s("div",{staticClass:"title van-multi-ellipsis--l3"},[t._v(t._s(e.questionBankName))]),s("div",{staticClass:"item-info-div"},[s("div",[s("div",{staticClass:"txt1"},[t._v(t._s(e.practiceNumber)+"/"+t._s(e.questionNumber))]),s("div",{staticClass:"txt2"},[t._v(t._s(t.$t("practice.answerCount")))])]),s("div",[t._v("|")]),s("div",[s("div",{staticClass:"txt1"},[t._v(t._s(t.getRate(e))+"%")]),s("div",{staticClass:"txt2"},[t._v(t._s(t.$t("practice.answerProcess")))])])]),s("div",{staticClass:"item-button",style:{color:t.primaryColor}},[t._v(" "+t._s(t.$t("practice.answerQuestion"))+" ")])])})),0)]):t._e(),0!==t.list.length||t.refreshing||t.isLoading?t._e():s("Empty",{attrs:{description:t.$t("common.noDataTextTip")}})],1)],1)],1)}),[],!1,null,"948610c0",null).exports},57146:(t,e,s)=>{s.r(e),s.d(e,{default:()=>h});var a=s(95082),i=(s(57658),s(74916),s(15306),s(27632)),o=s(30097),r=s(85384),n=s(35253),c=s(22648),l=s(17780),u=s(95969),d={components:{OverlayLoading:r.Z,Questionnaire:n.Z},data:()=>({investigateId:"",questionnaireResultVo:{},dataLoading:!0}),computed:{urlQuery(){const{investigateId:t,questionnaireId:e,studyType:s="",planId:a="",mapId:i=""}=this.$route.query;return{investigateId:t,questionnaireId:e,studyType:s,planId:a,mapId:i}}},mounted(){this.getResearchData()},methods:{async getResearchData(){const{investigateId:t,questionnaireId:e,studyType:s}=this.urlQuery,{status:a,data:i}=await o.Z.getResearchData({investigateId:t,questionnaireId:e,studyType:s});200===a&&(this.questionnaireResultVo=i,this.questionnaireResultVo.questions=i.question,this.investigateId=i.id),this.dataLoading=!1},questionsFormResult(t){let e=[];return Object.keys(t).forEach((s=>{let i=t[s],o={options:"",other_answer:""};if(i instanceof Object)if(i.length>0){let t=[];i.forEach((e=>{t.push(e.id),"true"===e.is_other&&(o.other_answer=e.other_answer?e.other_answer:e.title)})),o.options=t.join(",")}else i.num?(o.options=i.num,o.instruction_content=i.instruction_content):(o=(0,a.Z)((0,a.Z)({},o),{},{options:i.id}),"true"===i.is_other&&(o.other_answer=i.other_answer?i.other_answer:i.title));else o.options=i;e.push({id:s,solution:o})})),e},async onSubmit(t){this.dataLoading=!0;const{planId:e,studyType:s,mapId:a}=this.urlQuery,i=this.questionsFormResult(t),r={urlData:{investigateId:this.investigateId,planId:e},params:{study_type:s,map_id:a},questions:i};try{const{status:t,data:e}=await o.Z.submitResearch(r);this.dataLoading=!1,200===t&&"success"===e.operate_result?this.submitToast("success",this.$t("promptMessage.submitSuccessfully")):this.submitToast("fail",e.operate_data)}catch(t){this.dataLoading=!1,this.submitToast("fail",t.data.message)}},submitToast(t,e){const{showHomeLink:s}=this.$store.state,{fromPage:a,studyType:o,planId:r,study_model:n,all_checked:d,courseIds:h,task_id:p}=this.$route.query;this.$toast({type:t,duration:1e3,forbidClick:!0,message:e,onClose:()=>{if((0,l.xX)())(0,c.o2)(),s?this.$router.replace("/home-module"):this.$router.back(-1);else if(p){let t="";switch(o){case"study_project":t="free_mode"===n?u.Z.studyProject.toStudyProject({studyProjectId:r}):`/project-desert/${r}/${p}/${d}/${h}`;break;case"study":t=u.Z.home.studyDetail({studyId:r,origin:"vue"});break;default:t=""}t?((0,c.o2)(),this.$router.replace(t)):this.$router.go(-1)}else s?((0,c.o2)(),this.$router.replace({path:"/home-module"})):"taro"===a?i.Z.navigateBack():this.$router.go(-1)}})}}},h=(0,s(1001).Z)(d,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"research-start-container"},[s("overlay-loading",{attrs:{show:t.dataLoading}}),t.dataLoading?t._e():s("questionnaire",{attrs:{edit:!0,rule:t.questionnaireResultVo,"on-submit":t.onSubmit}})],1)}),[],!1,null,"3a832340",null).exports},19421:(t,e,s)=>{s.r(e),s.d(e,{default:()=>n});var a=s(30097),i=s(85384),o=s(11651),r={components:{OverlayLoading:i.Z},data:()=>({question:[],dataLoading:!0}),mounted(){this.getResearchResult()},methods:{async getResearchResult(){const{investigateId:t}=this.$route.query;if(!t)return!1;const{status:e,data:s}=await a.Z.getResearchResult(t);200===e&&(this.question=s.statistics),this.dataLoading=!1},proportionWidth(t){const e=t/100*332;return(0,o.W)(e)}}},n=(0,s(1001).Z)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"research-result-container"},[s("overlay-loading",{attrs:{show:t.dataLoading}}),t.dataLoading?t._e():s("div",t._l(t.question,(function(e){return s("div",{key:e.id,staticClass:"research-result-item"},[s("div",{staticClass:"result-title"},[t._v(" "+t._s(e.order_id)+". "),s("span",[t._v("【"+t._s(t.$t("research."+e.type))+"】")]),t._v(" "+t._s(e.title)+" ")]),t._l(e.result,(function(a){return s("div",{key:a.order_id,staticClass:"result-options"},[s("div",{staticClass:"result-options-head"},["score"===e.type?s("span",t._l(Number(a.order_id),(function(t){return s("svg-icon",{key:t,staticClass:"icon-xing",attrs:{"icon-class":"icon-xingxingchengcopy",color:"#FFA818",size:14}})})),1):s("span",[t._v(t._s(a.title))])]),s("div",{staticClass:"result-options-datas"},[a.proportion>0?s("div",{staticClass:"result-options-proportion",style:{width:t.proportionWidth(a.proportion)}}):t._e(),s("span",{staticClass:"result-options-num"},[t._v(t._s(a.total_count))])])])}))],2)})),0)],1)}),[],!1,null,"edb67774",null).exports},31021:(t,e,s)=>{s.r(e),s.d(e,{default:()=>d});s(31146);var a=s(41610),i=s(95082),o=(s(47601),s(44951)),r=(s(25773),s(35791)),n=(s(38862),s(55602)),c=s(27632),l=s(26294),u={name:"Home",components:{[r.Z.name]:r.Z,[o.Z.name]:o.Z},data:function(){return{scanResult:"",imgResult:[],videoResult:[]}},computed:(0,i.Z)({},(0,l.mapGetters)({env:"getEnv"})),mounted(){"wechat_h5"!==c.Z.env&&"wechat_qy"!==c.Z.env&&"dingTalk"!==c.Z.env||(0,n.vD)({shareInfo:{title:"测试VUE分享",desc:"这是一个测试VUE分享的描述",path:"dingTalk"===c.Z.env?"/pages/messageRedirect/messageRedirect?flag=testVueShare":`/pages/login/login?flag=testVueShare&enterpriseId=${this.$store.state.commonParams.enterpriseId}`,imageUrl:"https://oss.coolcollege.cn/1805837075426185216.png"}})},methods:{handleScan(){c.Z.scan({type:"qr"},(t=>{JSON.stringify(t),this.scanResult=JSON.stringify(t)}),(t=>{JSON.stringify(t)}))},handleImg(){const t={count:2,sourceType:{dingTalk:["camera","album"],app:["camera","album"]}[c.Z.env]||[],compressed:!0,percent:80};c.Z.chooseImage(t,(t=>{"app"!==c.Z.env&&c.Z.compressImage({filePaths:t.filePaths,compressLevel:2},(t=>{}));let e={access_token:this.$store.state.commonParams.accessToken};c.Z.uploadFile({url:`${CL_API}/knowledge-api/common/upload`,fileName:"file",fileType:"image",formData:e,filePath:t.filePaths[0]},(t=>{(0,a.Z)({title:JSON.stringify(t)})}),(t=>{(0,a.Z)({title:JSON.stringify(t)})})),this.imgResult=t.filePaths}))},handleVideo(){const t={dingTalk:["camera","album"],app:["camera","album"]}[c.Z.env]||[];c.Z.chooseVideo({count:1,sourceType:t,maxDuration:10,compressed:!0},(t=>{const{filePath:e}=t;this.videoResult=[e];let s={access_token:this.$store.state.commonParams.accessToken};c.Z.uploadFile({url:`${CL_API}/knowledge-api/v2/${this.$store.state.commonParams.enterpriseId}/vods/upload`,fileName:"file",formData:s,filePath:e,fileType:"video"},(t=>{}),(t=>{}))}),(t=>{}))},handleShare(){"wechat"!==c.Z.env&&"dingTalk"!==c.Z.env&&(0,n.vD)({shareInfo:{title:"测试VUE分享",desc:"这是一个测试VUE分享的描述",path:"wechat_browser"===c.Z.env?"https://sdn.coolcollege.cn/coolcollege-h5/test2/#/pages/login/login?msgSource=emailMessage&flag=testNative":"https://dtsdn.coolcollege.cn/team-b/coolcollege-h5/#/pages/login/login?msgSource=emailMessage&flag=testNative",imageUrl:"https://oss.coolcollege.cn/1805837075426185216.png"}})},handleSaveImage(){c.Z.saveImage({url:"https://img.alicdn.com/tps/TB1sXGYIFXXXXc5XpXXXXXXXXXX.jpg"},(t=>{this.$toast.success("保存成功")}),(t=>{this.$toast.success("保存失败")}))},chooseAttachmentFromDingTalk(){c.Z.uploadAttachmentToDingTalk({types:["space"]},(t=>{this.$toast(JSON.stringify(t))}),(t=>{this.$toast(JSON.stringify(t))}))}}},d=(0,s(1001).Z)(u,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"native-test"},[s("van-button",{attrs:{color:"#7A76FB",block:""},on:{click:t.handleScan}},[t._v("扫码")]),s("van-button",{attrs:{color:"#FD793C",block:""},on:{click:t.handleImg}},[t._v("选择图片")]),t._l(t.imgResult,(function(t,e){return s("img",{key:e,attrs:{width:"100",height:"100",src:t}})})),s("van-button",{attrs:{color:"#25B0F3",block:""},on:{click:t.handleVideo}},[t._v("选择视频")]),t._l(t.videoResult,(function(t,e){return s("video",{key:e,attrs:{width:"200",height:"100","show-fullscreen-btn":!1,autoplay:"",controls:"",src:t}})})),s("van-button",{attrs:{color:"#40CC55",block:""},on:{click:t.handleShare}},[t._v("分享")]),s("van-button",{attrs:{color:"palegoldenrod",block:""},on:{click:t.handleSaveImage}},[t._v("保存图片")]),s("van-button",{attrs:{color:"peru",block:""},on:{click:t.chooseAttachmentFromDingTalk}},[t._v("钉盘")])],2)}),[],!1,null,null,null).exports},47441:(t,e,s)=>{s.r(e),s.d(e,{default:()=>i});var a={name:"Visitor",mixins:[s(87463).Z],computed:{active(){let t="homePage";switch(this.$route.path){case"/visitor":t="homePage";break;case"/visitor/mine":t="me"}return t}}},i=(0,s(1001).Z)(a,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"visitor-layout"},[s("router-view"),s("BottomTarbar",{attrs:{active:t.active}})],1)}),[],!1,null,null,null).exports},87080:(t,e,s)=>{s.r(e),s.d(e,{default:()=>m});s(18144);var a=s(65641),i=(s(70885),s(6458)),o=(s(29941),s(64168)),r=(s(52355),s(29233)),n=(s(53743),s(59978)),c=(s(629),s(67763)),l=s(4852),u=s(78368),d=s(78551),h=s(11046),p={name:"Mine",components:{[c.Z.name]:c.Z,[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[l.Z.name]:l.Z,[i.Z.name]:i.Z,[a.Z.name]:a.Z,[d.Z.name]:d.Z},data(){return{avatarImage:u,userInfos:[{icon:"icon-leijijifen",title:this.$t("mine.accumulativePoints"),color:"#5DBD66",value:0},{icon:"icon-leijixuefen",title:this.$t("mine.accumulativeCredits"),color:"#FFA000",value:0},{icon:"icon-yihuozhengshu",title:this.$t("mine.obtainedCredits"),color:"#9766CD",value:0},{icon:"icon-yihuorenzheng",title:this.$t("mine.certified"),color:"#4268FF",value:0},{icon:"icon-baomingshenhedengdai",title:this.$t("mine.accumulativeLearningHours"),color:"#D08B16",value:0}],middleInfo:[{icon:"icon-wodezixue",title:this.$t("mine.mySelfStudy"),color:"#666666"},{icon:"icon-yigoukecheng",title:this.$t("mine.boughtCourses"),color:"#666666"},{icon:"icon-wodedingdan-xin",title:this.$t("mine.orders"),color:"#666666"}],settings:[{title:this.$t("mine.faceRecognition")},{title:this.$t("mine.CheckInDaily")},{title:this.$t("mine.feedback")},{title:this.$t("mine.settings")}]}},methods:{gotoLogin(){(0,h.rf)({flag:""})}}},m=(0,s(1001).Z)(p,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"visitor-mine",on:{click:function(e){return e.preventDefault(),t.gotoLogin.apply(null,arguments)}}},[s("div",{staticClass:"visitor-mine-header"},[s("van-row",{staticClass:"visitor-mine-header-user"},[s("van-col",{attrs:{span:"6"}},[s("Avatar",{attrs:{width:"60",height:"60",src:t.avatarImage}})],1),s("van-col",{staticClass:"visitor-mine-header-user-info",attrs:{span:"18"}},[s("div",{staticClass:"visitor-mine-header-user-info-name"},[t._v(t._s(t.$t("mine.login")))]),s("div",{staticClass:"visitor-mine-header-user-info-position"},[t._v(t._s(t.$t("mine.loginTips")))])])],1),s("div",{staticClass:"visitor-mine-header-info"},t._l(t.userInfos,(function(e,a){return s("div",{key:a,staticClass:"visitor-mine-header-info-item"},[s("div",{staticClass:"visitor-mine-header-info-item-logo"},[s("SvgIcon",{attrs:{"icon-class":e.icon,color:e.color}})],1),s("div",{staticClass:"visitor-mine-header-info-item-title"},[t._v(t._s(e.title))]),s("div",{staticClass:"visitor-mine-header-info-item-value"},[t._v(t._s(e.value))])])})),0)],1),s("van-grid",{staticClass:"visitor-mine-middle",attrs:{"column-num":3,clickable:!0}},t._l(t.middleInfo,(function(e,a){return s("van-grid-item",{key:a,attrs:{text:e.title},scopedSlots:t._u([{key:"icon",fn:function(){return[s("SvgIcon",{attrs:{"icon-class":e.icon,color:e.color}})]},proxy:!0}],null,!0)})})),1),s("van-cell-group",{staticClass:"visitor-mine-setting"},t._l(t.settings,(function(t,e){return s("van-cell",{key:e,attrs:{title:t.title,"is-link":""}})})),1)],1)}),[],!1,null,"1b7c9333",null).exports},70175:(t,e,s)=>{s.r(e),s.d(e,{default:()=>S});s(47601);var a=s(44951),i=s(95082),o=s(78551),r=s(78368),n=s(26294),c={components:{VanImage:a.Z,SvgIcon:o.Z},props:{courseDetails:{type:Object,default:function(){return{awardScore:0,assign:"",graded:"",learners:null,lecturer:null,resourceCount:0,score:0,showScore:"",teacherAvatar:"",teacherName:"",title:"",track:""}}},enterpriseId:{type:String,default:""}},data:()=>({defaultUserImg:r,appraiseFlag:!1}),computed:(0,i.Z)((0,i.Z)((0,i.Z)({},(0,n.mapGetters)({primaryColor:"getPrimaryColor"})),(0,n.mapState)(["commonParams"])),{},{isToStudyList(){return"1012529708090396676"!==this.commonParams.enterpriseId}}),methods:{}},l=s(1001),u=(0,l.Z)(c,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"course-info"},[s("div",{staticClass:"title"},[t._v(t._s(t.courseDetails.title)+" ")]),s("div",{staticClass:"price-free",style:{color:t.primaryColor}},[t._v(" "+t._s(t.$t("course.free"))+" ")]),s("div",{staticClass:"appraise"},[t.courseDetails.score>=0?s("div",{staticClass:"appraise-score"},t._l(Object.keys(Array.from({length:5})),(function(e){return s("svg-icon",{key:e,staticClass:"iconfont",attrs:{"icon-class":"icon-xingxingchengcopy",size:12,color:e<(0===t.courseDetails.score?5:t.courseDetails.score)?t.primaryColor:"#C0C2CB"}})})),1):t._e(),s("div",{staticClass:"appraise-text"},[t._v(" "+t._s(t.$t("course.toRate"))+" "),s("svg-icon",{attrs:{"icon-class":"icon-chakanpaiming",color:"#D9DBE4",size:10}})],1)]),s("div",{staticClass:"free"},[t.courseDetails.lecturer||""===t.courseDetails.teacher_name?t._e():s("div",{staticClass:"name"},[s("van-image",{staticClass:"avatar",attrs:{fit:"fill",src:t.courseDetails.teacher_avatar||t.defaultUserImg}}),s("span",{staticClass:"teacher"},[t._v(t._s(t.courseDetails.teacher_name))])],1),s("div",{staticClass:"courseware-count"},[t._v(" "+t._s(t.$t("course.courseware"))+" "),s("span",[t._v(t._s(t.courseDetails.resource_num))])]),s("div",{staticClass:"studying"},[s("span",[t._v(t._s(t.courseDetails.study_count)+t._s(t.$t("course.peopleLearning")))]),t.isToStudyList?s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-chakanpaiming",color:"#D9DBE4",size:10}}):t._e()],1),"true"===t.courseDetails.showScore?s("span",{staticClass:"awardScore"},[t._v(" "+t._s(t.courseDetails.awardScore)+t._s(t.$t("pointsMall.credits"))+" ")]):t._e()]),t.courseDetails.lecturer?s("div",{staticClass:"lecturer"},[s("div",{staticClass:"name"},[s("van-image",{staticClass:"avatar",attrs:{fit:"aspectFill",src:t.courseDetails.teacher_avatar||t.defaultUserImg}}),s("span",{staticClass:"teacher"},[t._v(t._s(t.courseDetails.teacher_name))])],1),s("div",{staticClass:"toinfo"},[s("span",[t._v(t._s(t.$t("course.lecturerDetails")))]),s("svg-icon",{attrs:{"icon-class":"icon-chakanpaiming",color:"#D9DBE4",size:10}})],1)]):t._e()])}),[],!1,null,"9f6cdefc",null).exports,d=(s(26699),s(84533)),h=s(22648),p={name:"CourseWare",components:{SvgIcon:o.Z},props:{resources:{type:Array,default:()=>[]},isFree:{type:String,default:""},showStatus:{type:String,default:""},currentPlay:{type:Number,default:-1},isOutCourse:{type:Boolean,default:!1}},data:()=>({}),computed:{getIconAndColor:()=>t=>{if("mp4"===t.type)return t.contentType.indexOf("video")>-1?d.e.mp4:d.e.mp3;if(["ppt","pptx","doc","docx","pdf","xls","xlsx","txt","article","link","h5","ddi","mp3"].includes(t.type))return d.e[t.type];return["html","picture","scorm"].includes(t.contentType)?d.e[t.contentType]:d.e.others},hasAnswered:()=>t=>t.answer_record_count>0||!!(t.resource_quiz_vo&&t.resource_quiz_vo.question_count>0&&t.resource_quiz_vo.answer_record_count===t.resource_quiz_vo.question_count),disallowPlay(){return"false"===this.isFree&&"buy"===this.showStatus},isShowImportant(){return t=>{const{resourceIds:e,all_checked:s}=this.$route.query,a=e&&-1!==e.indexOf(t.id);return"true"===s||a}}},mounted(){},methods:{durationFormat(t){return(0,h.WJ)(t,this)}}},m=(0,l.Z)(p,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"cl-courseware-list"},[t.resources.length?t._e():s("div",{staticClass:"resources-tip"},[t._v(t._s(t.$t("course.emptyCourse")))]),t._l(t.resources,(function(e,a){return s("div",{key:a,staticClass:"courseware",class:[t.currentPlay===a?"active":"",t.isOutCourse?"course-out-some":""]},[s("div",{staticClass:"courseware-top"},[e.can_study||void 0===e.can_study?t._e():s("div",{staticClass:"not-study"}),t.isOutCourse?t._e():s("div",{staticClass:"resource-icon"},[s("div",{staticClass:"icon-label",style:{color:t.disallowPlay&&0===e.audition_type?"#B7BAC8":t.getIconAndColor(e).color}},[s("SvgIcon",{attrs:{"icon-class":""+t.getIconAndColor(e).type,size:18,color:t.disallowPlay&&0===e.audition_type?"#B7BAC8":t.getIconAndColor(e).color}}),t._v(" "+t._s(t.getIconAndColor(e).typeName)+" ")],1),s("div",{staticClass:"resource-duration"},[t._v(t._s("mp4"===e.type||"mp3"===e.type?e.duration_str:null))]),t.isShowImportant(e)?s("span",{staticClass:"knowledge-point"},[t._v(t._s(t.$t("course.importantCourse")))]):t._e(),"mp4"===e.type&&"finish"===e.aiUpgradeStatus?s("span",{staticClass:"knowledge-point"},[t._v(t._s(t.$t("aiStudy.knowledgePoints")))]):t._e()]),t.isOutCourse?t._e():s("div",{staticClass:"resource-title",class:[t.disallowPlay?"disallowPlay":""]},[s("div",{staticClass:"resource-title-info "},[t._v(t._s(e.name))])]),t.isOutCourse?s("div",{staticClass:"resource-title-outs resource-title",class:[t.disallowPlay?"disallowPlay":""]},[s("div",{staticClass:"icon-label",style:{color:t.disallowPlay&&0===e.audition_type?"#B7BAC8":t.getIconAndColor(e).color}},[s("SvgIcon",{attrs:{"icon-class":""+t.getIconAndColor(e).type,size:18,color:t.disallowPlay&&0===e.audition_type?"#B7BAC8":t.getIconAndColor(e).color}})],1),s("div",{staticClass:"resource-title-info resource-title-outs-info"},[t._v(t._s(e.name))])]):t._e(),e.question_count>0||e.resource_quiz_vo&&e.resource_quiz_vo.question_count>0?s("div",{staticClass:"test"},[s("div",{staticClass:"real"},[s("SvgIcon",{attrs:{"icon-class":"icon-text",size:14,color:"#7F849A"}}),t.hasAnswered(e)?s("div",{staticClass:"tested"},[s("SvgIcon",{attrs:{"icon-class":"icon-done",size:16,color:"#FFFFFF"}})],1):t._e(),s("span",{staticClass:"test_text"},[t._v(t._s(t.$t("course.test")))])],1)]):t._e()])])}))],2)}),[],!1,null,"89329c3e",null).exports,g={name:"CourseIntroduce",props:{introduction:{type:String,default:""}}},v=(0,l.Z)(g,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"course-introduce"},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("course.detailDesc")))]),t.introduction?s("div",{staticClass:"text_play",domProps:{innerHTML:t.xss(t._s(t.introduction))}}):s("div",{staticClass:"introduce-tip"},[t._v(t._s(t.$t("course.emptyDetail")))])])}),[],!1,null,null,null).exports,f={name:"CourseEnd"},y=(0,l.Z)(f,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"course-end"},[t._v(" END ")])}),[],!1,null,"82a9cbf6",null).exports,_=(s(25773),s(35791)),C={components:{SvgIcon:o.Z,VanButton:_.Z},props:{courseSource:{type:String,default:""},courseDetails:{type:Object,default:()=>{}},isOutCourse:{type:Boolean,default:!1}},computed:(0,i.Z)({},(0,n.mapGetters)({primaryColor:"getPrimaryColor"}))},I=(0,l.Z)(C,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"course-action"},["approvalList"===t.courseSource?s("div",{staticClass:"approval"},[s("van-button",{style:{backgroundColor:"#d64f4f",borderColor:"#d64f4f"},attrs:{type:"primary",block:""}},[t._v(" "+t._s(t.$t("course.reject"))+" ")]),s("van-button",{style:{backgroundColor:t.primaryColor,borderColor:t.primaryColor},attrs:{type:"primary",block:""}},[t._v(" "+t._s(t.$t("course.pass"))+" ")])],1):s("div",{staticClass:"course-action-more"},[s("div",{staticClass:"evaluate-all"},[s("div",{staticClass:"evaluate"},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-talk",color:"#7F849A",size:18}}),t.courseDetails.comment_count>0?s("span",{staticClass:"num"},[t._v(t._s(t.courseDetails.comment_count))]):t._e()],1),s("div",{staticClass:"evaluate",class:t.isOutCourse?"praise-more":""},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-zan",color:"like"===t.courseDetails.like_status?"#df6666":"#7F849A",size:21}}),t.courseDetails.like_count>0?s("span",{staticClass:"num"},[t._v(t._s(t.courseDetails.like_count))]):t._e()],1)]),s("van-button",{staticClass:"ddi-study-btn",style:{backgroundColor:t.primaryColor},attrs:{round:"",type:"primary",size:"mini"}},[t._v(" "+t._s(t.$t("project.register"))+" ")])],1)])}),[],!1,null,"54d1b68e",null).exports,b=s(20243),w=s(7294),$=s(11046),k={name:"EnterpriseDetail",components:{CourseInfo:u,CourseWare:m,CourseIntroduce:v,CourseEnd:y,CourseAction:I,VanImage:a.Z},data:()=>({courseDetails:{}}),computed:{isOutCourse(){return(0,w.ZG)(this.courseDetails.source)}},mounted(){this.init()},methods:{async init(){try{await b.Z.courseDetailCanSee();const{id:t}=this.$route.query,e=await b.Z.getEnterpriseCourseDetail({id:t});this.courseDetails=e.data}catch(t){this.$toast.fail(this.$t("home.bannerNoRightView")),this.goLogin()}},goLogin(){const{id:t}=this.$route.query;(0,$.rf)({flag:"course_study",id:t})}}},S=(0,l.Z)(k,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"enterprise_course_details_container",on:{click:t.goLogin}},[s("div",{staticClass:"course_details_container"},[s("div",{staticClass:"video-cover"},[s("van-image",{attrs:{fit:"cover",src:t.courseDetails.cover}})],1),s("course-info",{attrs:{"course-details":t.courseDetails}}),s("div",{staticClass:"courseware-list"},[s("div",{staticClass:"title"},[t._v(" "+t._s(t.$t("course.courseCatalog"))+" "),"onlyOne"===t.courseDetails.finishStandardStr?s("span",[s("SvgIcon",{attrs:{"icon-class":"icon-tips",color:"#D5D8DE",size:14}}),t._v(t._s(t.$t("course.finishStandard")))],1):t._e()]),s("course-ware",{attrs:{resources:t.courseDetails.course_resource_list,"is-free":t.courseDetails.free,"show-status":t.courseDetails.show_status,"is-out-course":t.isOutCourse,"current-play":0},on:{onCourseTest:function(){},onPlayResource:function(){}}})],1),s("course-introduce",{attrs:{introduction:t.courseDetails.introduction}}),s("course-end"),s("course-action",{attrs:{"course-details":t.courseDetails,"is-out-course":t.isOutCourse}})],1)])}),[],!1,null,"2738c47a",null).exports},26956:(t,e,s)=>{s.d(e,{Z:()=>p});var a=s(95082),i=(s(49153),s(5944)),o=(s(20581),s(50914)),r={name:"CourseList",components:{},props:{column:{type:Number,default:2},source:{type:Array,default:()=>[]}},data:()=>({}),computed:{primaryColor(){return this.$store.state.themeColor.primaryColor}},methods:{onItemClick(t){this.$emit("click",t)},dealPrise(t){return 3===t.bizType&&!t.free&&t.preferentialPrice>0?`￥${t.preferentialPriceStr}`:this.$t("course.free")},dealOfficialPrise:t=>0!==t.officialPrice?`￥${t.officialPriceStr}`:""}},n=s(1001),c=(0,n.Z)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"course-list",class:"col-"+t.column},t._l(t.source,(function(e,a){return s("div",{key:a,staticClass:"course-card",on:{click:function(s){return t.onItemClick(e)}}},[s("div",{staticClass:"card-image"},[s("img",{attrs:{src:e.cover||"https://oss.coolcollege.cn/1811631315267751936.png",width:"100%",height:"100%"}})]),s("div",{staticClass:"card-content"},[s("div",{staticClass:"card-title"},[t._v(t._s(e.title))]),s("div",{staticClass:"card-desc"},[s("div",{staticClass:"card-desc-prise"},[s("span",{staticClass:"course-price-preferential"},[t._v(t._s(t.dealPrise(e)))]),s("span",{staticClass:"course-price-official"},[t._v(t._s(t.dealOfficialPrise(e)))])]),s("div",{staticClass:"card-desc-top"},[s("div",{staticClass:"count"},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-e-view",color:"#C0C2CB",size:12}}),s("span",{staticClass:"desc-text num"},[t._v(t._s(e.playCount||0))])],1),s("div",{staticClass:"lecturer"},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-Eren",color:"#C0C2CB",size:12}}),s("span",{staticClass:"desc-text name"},[t._v(t._s(e.teacherName||t.$t("micro.noLecturer")))])],1)]),s("div",{staticClass:"card-desc-bottom"},[s("div",{staticClass:"star"},t._l([1,2,3,4,5],(function(a,i){return s("svg-icon",{key:i,staticClass:"iconfont",attrs:{"icon-class":"icon-xingxingchengcopy",color:a<=(0===e.starLevel?5:e.starLevel)?t.primaryColor:"#C0C2CB",size:14}})})),1),e.showScore?s("div",{staticClass:"score"},[t._v(" "+t._s(e.awardScore)+t._s(t.$t("pointsMall.credits"))+" ")]):t._e()])])]),3===e.bizType?s("div",{staticClass:"card-tag"},[t._v(" "+t._s(t.$t("project.studyProject"))+" ")]):t._e(),"package"===e.resourceType?s("div",{staticClass:"card-tag package"},[t._v(" "+t._s(t.$t("course.coursePackage"))+" ")]):t._e()])})),0)}),[],!1,null,"c82c90ba",null).exports,l=s(20243),u=s(11046),d={name:"CourseList",components:{CourseItem:c,[o.Z.name]:o.Z,[i.Z.name]:i.Z},props:{emptyText:{type:String,default:""},pageSize:{type:Number,default:20},column:{type:Number,default:2},keywords:{type:String,default:""},classifyId:{type:String,default:""},isSearch:{type:Boolean,default:!1}},data(){return{courseList:[],showLoading:!1,canLoading:!1,params:{enterpriseId:this.$route.query.enterpriseId||"",sort_type:this.$route.query.sortType||"",classify_id:this.$route.query.classifyId||"",course_type:this.$route.query.courseType||"",ids:this.$route.query.ids&&JSON.parse(this.$route.query.ids),language:"",exclude_course_type:["micro_course","live","image_text"],order:"desc",keyword:"",page_number:1,page_size:this.pageSize}}},watch:{classifyId(t){this.params.classify_id=t,this.params.page_number=1,this.list=[],this.init()},keywords(t){this.params.keyword=t,this.init()}},mounted(){this.isSearch||this.init()},methods:{init(){this.getCourseList()},onLoadMore(){this.params.page_number+=1,this.$nextTick((()=>{this.getCourseList()}))},getCourseList:async function(){try{this.showLoading=!0,this.$toast.loading({overlay:!0});const t=await l.Z.getVisitorCourseListByIds(this.params);this.$toast.clear(),this.showLoading=!1;const{list:e,pageNum:s,pages:a}=t.data;this.courseList=s<=1?e:this.courseList.concat(e),this.canLoading=Boolean(s<a)}catch(t){this.showLoading=!1,console.error(t)}},onCourseClick(t){const e=(0,u.ju)(t),{id:s,projectId:a,styleType:i}=t,o={course:{id:s,project_id:a,style_type:i},type:e};(0,u.RJ)(o)},onSearch(t){this.params.keyword=t,this.params.page_number=1,this.list=[],this.$emit("afterSearch",!0),this.init()},onClear(){this.clear()},paramsClear(){this.params=(0,a.Z)((0,a.Z)({},this.params),{},{keyword:"",pageSize:20,pageNumber:1})},clear(){this.paramsClear(),this.list=[],this.$emit("afterSearch",!1)}}},h=d,p=(0,n.Z)(h,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"course-module"},[t.courseList.length?s("div",{staticClass:"module-list"},[s("van-list",{attrs:{finished:!t.canLoading,"immediate-check":!1,"finished-text":t.$t("common.noMore")},on:{load:t.onLoadMore},model:{value:t.showLoading,callback:function(e){t.showLoading=e},expression:"showLoading"}},[s("course-item",{attrs:{column:t.column,source:t.courseList},on:{click:t.onCourseClick}})],1)],1):s("div",{staticClass:"module-empty"},[s("van-empty",{attrs:{description:t.emptyText||t.$t("common.noDataTextTip")}})],1)])}),[],!1,null,"78e323eb",null).exports},4119:(t,e,s)=>{s.d(e,{Z:()=>r});s(39610);var a=s(2163),i=(s(86039),s(20495)),o={components:{[i.Z.name]:i.Z,[a.Z.name]:a.Z},props:{placeholder:{type:String,default:""},disabled:{type:Boolean,default:!1},actionText:{type:String,default:""},showAction:{type:Boolean,default:!1},data:{type:String,default:""}},data:()=>({value:""}),computed:{actionVisible(){return this.showAction||Boolean(this.value)}},methods:{onSearch(t){this.$emit("search",this.value,t)},onSearchClick(){this.$emit("click")},onFocus(){this.$emit("focus")},onBlur(){this.$emit("blur")},onClear(){this.$emit("clear")}}},r=(0,s(1001).Z)(o,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"search-box",on:{click:t.onSearchClick}},[s("van-search",{attrs:{"show-action":t.actionVisible,placeholder:t.placeholder||t.$t("knowledge.searchPlaceholder"),disabled:t.disabled,"action-text":t.actionText},on:{search:function(){return t.onSearch("enter")},focus:t.onFocus,blur:t.onBlur,clear:t.onClear},scopedSlots:t._u([{key:"action",fn:function(){return[s("div",{on:{click:function(){return t.onSearch("click")}}},[t._v(t._s(t.actionText||t.$t("common.search")))])]},proxy:!0}]),model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1)}),[],!1,null,"6c76e399",null).exports},84936:(t,e,s)=>{s.r(e),s.d(e,{default:()=>n});s(39610);var a=s(2163),i=s(4119),o=s(26956),r={name:"CourseSearch",components:{SearchBox:i.Z,CourseList:o.Z,[a.Z.name]:a.Z},data:()=>({keyword:"",isAfterSearch:!1}),computed:{emptyText(){return this.isAfterSearch?this.$t("common.noDataTextTip"):this.$t("course.searchTips")}},mounted(){this.initSearch()},beforeDestroy(){this.isAfterSearch=!1},methods:{initSearch(){const{keyword:t}=this.$route.query;t&&this.onSearch(t)},onSearch(t){this.keyword=t,this.$refs.courseRef.onSearch(t)},onClear(){this.$refs.courseRef.onClear()},afterSearch(t){this.isAfterSearch=t}}},n=(0,s(1001).Z)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"course-search"},[s("van-sticky",[s("search-box",{ref:"searchRef",attrs:{placeholder:t.$t("discovery.searchPlaceholder"),"show-action":!0},on:{search:t.onSearch,clear:t.onClear}})],1),s("div",{staticClass:"search-content"},[s("course-list",{ref:"courseRef",attrs:{"empty-text":t.emptyText,keyword:t.keyword,"is-search":!0},on:{afterSearch:t.afterSearch}})],1)],1)}),[],!1,null,"9c50ff32",null).exports},14873:(t,e,s)=>{s.r(e),s.d(e,{default:()=>_});s(39610);var a=s(2163),i=s(4119),o={name:"Commontitle",props:{title:{type:String,default:""},actionText:{type:String,default:""},showActionText:{type:Boolean,default:!0}},methods:{moreAction(){this.$emit("click")}}},r=s(1001),n=(0,r.Z)(o,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"common-title"},[s("span",{staticClass:"all"},[t._v(t._s(t.title||""))]),t.showActionText?s("span",{staticClass:"more",on:{click:t.moreAction}},[t._v(t._s(t.actionText||t.$t("knowledge.more")))]):t._e(),t._t("right")],2)}),[],!1,null,"3d440baa",null).exports,c=s(26956),l=s(95082),u=(s(82500),s(49414)),d=(s(82522),s(10342)),h=(s(30541),s(26294)),p=s(50361),m=s.n(p),g=s(20243),v={name:"CourseClassify",components:{[d.Z.name]:d.Z,[u.Z.name]:u.Z},props:{classifyId:{type:String,default:""}},data:()=>({levelOneList:[],levelTwoList:[],levelThreeList:[[],[],[]],activeLevelOne:0,activeLevelTwo:0,activeLevelThree:[0,0,0],showThreeModal:!1,showTabs:!1}),computed:(0,l.Z)({},(0,h.mapGetters)({primaryColor:"getPrimaryColor"})),watch:{showThreeModal(t){this.$emit("visible",t)}},mounted(){this.init()},methods:{async init(){const t=await g.Z.getVisitorClassify({parent_id:this.classifyId});this.showTabs=!0,this.levelOneList=this.handleAllCreate(t.data.classify)},handleClickLevelOne(t){const e=this.levelOneList[t];this.handleItemEmit(e),this.levelTwoList=this.handleAllCreate(e.children),this.levelThreeList=[[],[],[]],this.activeLevelTwo=0,this.activeLevelThree=[0,0,0]},handleClickLevelTwo(t){const e=this.levelTwoList[t];if("all"===e.id){const t=this.levelOneList[this.activeLevelOne];return this.activeLevelThree=[0,0,0],void this.handleItemEmit(t)}if(0===e.children.length)return this.activeLevelThree=[0,0,0],void this.handleItemEmit(e);this.showThreeModal=e.children.length>0;const s=this.handleAllCreate(e.children),a=s[this.activeLevelThree[0]],i=a&&a.children.length?this.handleAllCreate(a.children):[],o=i[this.activeLevelThree[1]],r=o&&o.children.length?this.handleAllCreate(o.children):[];this.levelThreeList=[s,i,r]},handleClickLevelSub(t,e,s){if(t<2){const s=this.handleAllCreate(e.children);this.$set(this.levelThreeList,t+1,s)}if(this.$set(this.activeLevelThree,t,s),"all"!==e.id)0===e.children.length&&this.handleItemEmit(e);else{const e=t>0?this.levelThreeList[t-1][this.activeLevelThree[t-1]]:this.levelTwoList[this.activeLevelTwo];this.handleItemEmit(e)}},handleItemEmit(t){this.showThreeModal=!1;const e={name:"all"===t.id?this.$t("course.allCourse"):t.name,id:"all"===t.id?this.classifyId:t.id};this.$emit("select",e)},handleAllCreate(t){const e=m()(t);return-1===e.findIndex((t=>"all"===t.id))&&e.unshift({name:this.$t("course.all"),id:"all",children:[]}),e}}},f=(0,r.Z)(v,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.showTabs?s("div",{staticClass:"course-classify"},[s("div",{staticClass:"classify-tabs-one"},[s("van-tabs",{attrs:{"line-height":"0","line-width":"0",sticky:!0},on:{click:t.handleClickLevelOne},model:{value:t.activeLevelOne,callback:function(e){t.activeLevelOne=e},expression:"activeLevelOne"}},t._l(t.levelOneList,(function(e,a){return s("van-tab",{key:e.id,attrs:{title:e.name,"title-class":t.activeLevelOne===a?"primary":"default"}})})),1)],1),t.levelTwoList.length>1?s("div",{staticClass:"classify-tabs-two"},[s("van-tabs",{attrs:{"line-height":"0","line-width":"0",sticky:!0},on:{click:t.handleClickLevelTwo},model:{value:t.activeLevelTwo,callback:function(e){t.activeLevelTwo=e},expression:"activeLevelTwo"}},t._l(t.levelTwoList,(function(e,a){return s("van-tab",{key:a,attrs:{"title-class":t.activeLevelTwo===a?"primary":"default"},scopedSlots:t._u([{key:"title",fn:function(){return[s("span",{staticClass:"tab-title"},[t._v(t._s(e.name))]),s("span",{class:[t.activeLevelTwo===a?"down":"",e.children.length?"triangle":"","tab-icon"]})]},proxy:!0}],null,!0)})})),1)],1):t._e(),t.showThreeModal?s("div",{staticClass:"classify-modal"},t._l(t.levelThreeList,(function(e,a){return s("div",{key:a,staticClass:"classify-column"},t._l(e,(function(e,i){return s("div",{key:i,staticClass:"column-item",class:[t.activeLevelThree[a]===i?"active":""],on:{click:function(s){return t.handleClickLevelSub(a,e,i)}}},[s("span",{staticClass:"item-name"},[t._v(t._s(e.name))]),t.activeLevelThree[a]===i?s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-duigou",color:t.primaryColor}}):t._e()],1)})),0)})),0):t._e(),t.showThreeModal?s("div",{staticClass:"classify-mask"}):t._e()]):t._e()}),[],!1,null,"44b22ac7",null).exports,y={name:"CourseAll",components:{SearchBox:i.Z,CommonTitle:n,CourseList:c.Z,CourseClassify:f,[a.Z.name]:a.Z},data(){return{column:2,keywords:"",classifyData:{name:this.$t("course.allCourse"),id:this.$route.query.classifyId||""},classifyId:this.$route.query.classifyId}},methods:{onSearchClick(t){this.keywords=t},toggleColumn(){this.column=1===this.column?2:1},handleClassifyChange(t){this.classifyData=t}}},_=(0,r.Z)(y,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"course-all"},[s("van-sticky",[s("search-box",{attrs:{placeholder:t.$t("discovery.searchPlaceholder")},on:{search:t.onSearchClick,clear:t.onSearchClick}}),t.classifyId?s("course-classify",{attrs:{"classify-id":t.classifyId},on:{select:t.handleClassifyChange}}):t._e()],1),s("div",{staticClass:"course-all-core"},[s("div",{staticClass:"course-list-wrapper"},[s("common-title",{attrs:{title:t.classifyData.name,"show-action-text":!1}},[s("span",{attrs:{slot:"right"},on:{click:t.toggleColumn},slot:"right"},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":2===t.column?"icon-liebiaoshitu":"icon-gonggeshitu",size:16,color:"#2D3040"}})],1)]),s("course-list",{attrs:{keywords:t.keywords,column:t.column,"classify-id":t.classifyData.id}})],1)])],1)}),[],!1,null,"4c663b7b",null).exports},59520:(t,e,s)=>{s.r(e),s.d(e,{default:()=>c});var a=s(16701),i=s(20243),o=s(27632),r=s(87463),n={name:"VisitorPage",components:{HomeLink:a.Z},mixins:[r.Z],methods:{async goHome(){const t=await i.Z.getVisitorInfo({domain_url:localStorage.getItem("domain")}),{page_id:e,enterprise_id:s}=t.data;o.Z.navigateTo({url:`/pages/visitor/index?enterpriseId=${s}&pageId=${e}&type=home`})}}},c=(0,s(1001).Z)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"visitor-page"},[s("home-link",{on:{click:function(e){return t.goHome()}}}),s("router-view")],1)}),[],!1,null,null,null).exports},34140:(t,e,s)=>{s.r(e),s.d(e,{default:()=>g});s(34837);var a=s(39146),i=(s(21790),s(24031)),o=(s(23307),s(81392)),r=(s(70885),s(6458)),n=(s(18144),s(65641)),c=(s(47601),s(44951)),l=(s(52355),s(29233)),u=(s(20581),s(50914)),d=s(20243),h=s(4852),p=s(11046);var m={components:{[u.Z.name]:u.Z,[l.Z.name]:l.Z,[c.Z.name]:c.Z,[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,[a.Z.name]:a.Z,avatar:h.Z},data:()=>({lectureInfo:{},courseInfo:{},loading:!0,finished:!1,pageLoading:!0}),computed:{tagList(){return this.lectureInfo.adept_field?this.lectureInfo.adept_field.split(","):[this.$t("lecturer.noMore")]}},mounted(){let t=this.$route.query.lecturerId;this.$toast.loading({duration:0,forbidClick:!0,message:this.$t("common.loading")}),d.Z.getVisitorLecturerDetails(t).then((t=>{this.$toast.clear(),this.pageLoading=!1,this.loading=!1,this.finished=!0,this.lectureInfo=t.data.lecturer,this.courseInfo=t.data.courses.list,this.courseInfo.forEach((t=>{t.score=0===t.score?5:t.score}))})).catch((()=>{this.pageLoading=!1}))},methods:{courseDetail({visible:t,type:e,courseId:s}){var i;"true"===t?"project"===(i={type:e,courseId:s}).type?(0,p.RJ)({type:"study_project",course:{id:i.courseId}}):(0,p.RJ)({type:"course",course:{id:i.courseId}}):(0,a.Z)(this.$t("lecturer.noRightView"))}}},g=(0,s(1001).Z)(m,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.pageLoading?t._e():s("div",{staticClass:"lecturer-detail"},[s("van-row",[s("van-col",{staticClass:"lecturer-img",attrs:{span:"6"}},[s("avatar",{attrs:{src:t.lectureInfo.avatar,sex:t.lectureInfo.sex,width:65,height:65,"sex-width":20,"sex-height":20}})],1),s("van-col",{staticClass:"lecturer-text",attrs:{span:"18"}},[s("p",{staticClass:"name"},[t._v(t._s(t.lectureInfo.lecturer_name))]),s("p",{staticClass:"level"},[t._v(t._s(t.lectureInfo.level_name))]),s("p",{staticClass:"tags"},t._l(t.tagList,(function(e,a){return s("van-tag",{key:a,attrs:{default:t.$t("lecturer.NoTags")}},[t._v(t._s(e))])})),1)])],1),s("van-cell",[s("div",{domProps:{innerHTML:t.xss(t._s(t.lectureInfo.lecturer_describe))}})]),s("van-cell",{staticClass:"course-title"},[t._v(" "+t._s("课程("+t.courseInfo.length+")")+" ")]),s("van-list",{staticClass:"lecture-list-wrap",attrs:{finished:t.finished,"finished-text":t.$t("lecturer.noMore")},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.courseInfo,(function(e){return s("van-row",{key:e.id,staticClass:"home-lecturer-card",on:{click:function(s){return t.courseDetail({courseId:e.id,visible:e.is_visible,type:e.course_type,resourceType:e.resource_type})}}},[s("van-col",{attrs:{span:"10"}},[s("van-image",{staticClass:"cover",attrs:{src:e.cover}})],1),s("van-col",{staticClass:"course-text",attrs:{span:"13",offset:"1"}},[s("p",{staticClass:"title"},[t._v(t._s(e.title))]),s("p",{staticClass:"count"},[s("van-icon",{staticClass:"eye",attrs:{name:"eye",color:"#D1D2D6",size:18}}),s("span",[t._v(t._s(e.play_count))])],1),s("ul",{staticClass:"star"},t._l(e.score,(function(t){return s("li",{key:t},[s("van-icon",{attrs:{name:"star",color:"#3751D9",size:16}})],1)})),0)])],1)})),1)],1)}),[],!1,null,"6c40a4bd",null).exports},50082:(t,e,s)=>{s.r(e),s.d(e,{default:()=>v});s(39610);var a=s(2163),i=(s(58052),s(68286)),o=(s(29941),s(64168)),r=(s(52355),s(29233)),n=(s(20581),s(50914)),c=(s(37138),s(2113)),l=(s(74268),s(55948)),u=(s(53743),s(59978)),d=(s(629),s(67763)),h=(s(86039),s(20495)),p=(s(57658),s(20243)),m=s(4852),g={components:{[h.Z.name]:h.Z,[d.Z.name]:d.Z,[u.Z.name]:u.Z,[l.Z.name]:l.Z,[c.Z.name]:c.Z,[n.Z.name]:n.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[i.Z.name]:i.Z,[a.Z.name]:a.Z,avatar:m.Z},data:()=>({params:{keyword:"",lecturer_ids:[],level_id:"",page_number:1,page_size:20},lectureLevel:[],lectureLevelSimple:[],lectureList:[],activeNames:"",loading:!1,finished:!1,refreshing:!1,checkAll:!0}),computed:{themeColor(){return this.$store.state.themeColor.primaryColor}},mounted(){const{ids:t=""}=this.$route.query;this.params.lecturer_ids=JSON.parse(t),p.Z.getLecturerLevel().then((t=>{this.lectureLevel=[].concat(t.data.list),this.lectureLevelSimple=t.data.list.slice(0,3),this.handleSearch()}))},methods:{handleSearch(t){this.refreshing&&(this.lectureList=[],this.refreshing=!1),this.loading=!0,this.activeNames="",p.Z.getVisitorLecturerList(this.params).then((e=>{this.loading=!1,"false"===e.data.has_next_page&&(this.finished=!0),this.lectureList="add"===t?this.lectureList.concat(e.data.list):[].concat(e.data.list)}))},clickMenu(t){this.lectureLevelSimple.forEach((e=>{e.id===t?e.selected=!0:e.selected=!1})),this.lectureLevel.forEach((e=>{e.id===t?e.selected=!0:e.selected=!1})),this.checkAll=""===t,this.finished=!1,this.params.page_number=1,this.params.level_id=t,this.handleSearch()},onload(){this.params.page_number++,this.handleSearch("add")},handleTolecturerDetail(t){this.$router.push({path:"/visitor-page/lecturer-detail",query:{lecturerId:t,renderType:"visitor"}})}}},v=(0,s(1001).Z)(g,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"lecturer-wrap"},[s("van-sticky",[s("van-search",{attrs:{placeholder:t.$t("lecturer.search")},on:{search:t.handleSearch},model:{value:t.params.keyword,callback:function(e){t.$set(t.params,"keyword",e)},expression:"params.keyword"}}),s("van-collapse",{staticClass:"lecture-level-wrap",attrs:{border:!1,accordion:""},model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[s("van-grid",{directives:[{name:"show",rawName:"v-show",value:"1"!==t.activeNames,expression:"activeNames !== '1'"}],staticClass:"level-default",attrs:{clickable:""}},[s("van-grid-item",{style:{color:t.checkAll?t.themeColor:""},on:{click:function(e){return t.clickMenu("")}}},[t._v(" "+t._s(t.$t("lecturer.All"))+" ")]),t._l(t.lectureLevelSimple,(function(e){return s("van-grid-item",{key:e.id,style:{color:e.selected?t.themeColor:""},on:{click:function(s){return t.clickMenu(e.id)}}},[t._v(" "+t._s(e.name)+" ")])}))],2),s("van-collapse-item",{attrs:{name:"1"}},[s("van-grid",[s("van-grid-item",{style:{color:t.checkAll?t.themeColor:""},on:{click:function(e){return t.clickMenu("")}}},[t._v(" "+t._s(t.$t("lecturer.All"))+" ")]),t._l(t.lectureLevel,(function(e){return s("van-grid-item",{key:e.id,style:{color:e.selected?t.themeColor:""},on:{click:function(s){return t.clickMenu(e.id)}}},[t._v(" "+t._s(e.name)+" ")])}))],2)],1)],1)],1),s("van-list",{staticClass:"lecture-list-wrap",attrs:{offset:50,"immediate-check":!1,finished:t.finished,"finished-text":t.$t("lecturer.noMore")},on:{load:t.onload},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[s("van-cell-group",t._l(t.lectureList,(function(e){return s("van-cell",{key:e.id,staticClass:"home-lecturer-card",on:{click:function(s){return t.handleTolecturerDetail(e.id)}},scopedSlots:t._u([{key:"icon",fn:function(){return[s("avatar",{attrs:{src:e.avatar,sex:e.sex,width:45,height:45}})]},proxy:!0},{key:"title",fn:function(){return[s("span",{staticClass:"name"},[t._v(t._s(e.lecturer_name))]),s("span",{staticClass:"level"},[t._v(t._s(e.level_name))]),e.level_name?t._e():s("span",{staticClass:"level default"},[t._v(t._s(t.$t("lecturer.NoGrade")))])]},proxy:!0}],null,!0)})})),1)],1)],1)}),[],!1,null,"16ce2516",null).exports},11584:(t,e,s)=>{s.r(e),s.d(e,{default:()=>$});var a=s(95082),i=(s(2707),s(65069),s(26294));const o={DESERT_OASIS:{backGround:"desert_map.png",startMask:["start_left.png","start_right.png"],checkPoints:{lock:["unlock2.png","unlock3.png","unlock4.png","unlock5.png","unlock6.png","unlock7.png","unlock8.png","unlock9.png","unlock10.png"],unlock:["pass1.png","pass2.png","pass3.png","pass4.png","pass5.png","pass6.png","pass7.png","pass8.png","pass9.png","pass10.png"]},score_bg:"#00B853",score_ava:"rgba(0, 184, 83, 0.7)",begin_bg:"begin_bg.png",summary_bg:"#F2BA66",summary_border:"6px solid #FBCC86",begin_btn:"begin_btn.png",sucess_bg:"sucess_bg.png",summary_bgpic:"summary_bg.png",summary_shadow:"0px 14px 26px 0px rgba(224,166,80,1)",begin_title:"52"},$schema:{}};var r=s(85384),n=s(20243),c=s(56359),l=s(29332),u=s(15480),d=s(24142);const h=t=>`https://gsdn.coolcollege.cn/assets/kuxueyuan/postmap/mobile/${t}`;var p={name:"ProjectDesert",components:{OverlayLoading:r.Z,Info:u.Z,PlanetList:c.Z,StartMask:l.Z,SuccessModal:d.Z},beforeRouteLeave(t,e,s){if(e.meta.keepAlive){const t=document.querySelector("#project-desert"),s=t?t.scrollTop:0;e.meta.scrollTop=s}s()},props:{projectId:{type:String,required:!0}},data:function(){return{stagePass:!1,loading:!1,template:"DESERT_OASIS",resolveImg:h,mapConfig:o,progress:1,score:2,num:1,summary:"10",studyInfo:{award_score:0,certificate_name:""},first:1,rocketIn:!1,list:[{name:"",photoList:[],process:0,score:0,sort:1,status:"",lock:"",unlockNum:0}],mapId:"",avatar:"",giftId:"",hasRewards:!0,checkpointNum:7,shouldRender:!0,gitfVisible:!1,rewardCount:10,showSuccess:!1,certificateName:"",certificateScore:10,currntTop:0}},computed:(0,a.Z)({},(0,i.mapGetters)({fresh:"microCourse/getFreshStatus"})),watch:{fresh(t){t&&(this.initData(),this.$store.commit("microCourse/updateFresh",!1))}},mounted(){this.initData()},activated(){},methods:{initScroll(){const{mapContentRef:t}=this.$refs,{first:e,list:s}=this,a=1!==e&&s&&s.length?e/s.length*t.scrollHeight:0;this.$nextTick((()=>{t&&(t.scrollTop=t.scrollHeight-a),t.addEventListener("scroll",this.scrollCallFun)}))},initData(){this.dualInitDataBus(),this.getSuccessModalData(),this.scrollCallFun()},async dualInitDataBus(){let t=this;try{this.loading=!0;const e=await n.Z.getCourseTaskMapDetail({id:this.$props.projectId});if(e&&e.data){const{data:s}=e.data;t.list=s.stageList.sort(((t,e)=>t.sort-e.sort)),t.list.reverse(),t.first=3,t.avatar=s.avatar,t.rocketIn=Boolean(1===t.first),t.progress=s.process,t.score=s.score,t.num=s.num,t.summary=s.summary,t.title=s.title}this.initScroll(),this.loading=!1}catch(t){return this.loading=!1,console.error(t),Promise.reject(t)}},getCurrentIndex(t){const e=t&&t.length&&t.filter((t=>t.status&&"current"===t.status.toLowerCase()))[0];return e&&e.sort},handleReceiveReward(){this.gitfVisible=!0},handleCloseGift(){this.gitfVisible=!1},getSuccessModalData(){let t=[{name:"AAA测试的证书数据名字123345465mock"}];if(t.length)if(t.length>1)this.certificateName=`+${t.length}`;else{let e=t[0].name;this.certificateName=e.length>15?`《${e.substr(0,15)}...》`:`《${e}》`}else this.showSuccess=!1},handleSuccessModalClose(){this.showSuccess=!1},scrollCallFun(t){const e=t&&t.target&&t.target.scrollTop;this.currntTop=e}},beforeDestroyed(){const{mapContentRef:t}=this.$refs;t.removeEventListener("scroll",this.scrollCallFun)}},m=s(1001),g=(0,m.Z)(p,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"project-desert",attrs:{id:"project-desert"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],ref:"mapContentRef",staticClass:"desert-container"},[s("Info",{attrs:{progress:t.progress,score:t.score,num:t.num,summary:t.summary,avatar:t.avatar,"map-config":t.mapConfig[t.template],"study-info":t.studyInfo}}),s("div",{staticClass:"desert-content-containers",style:{background:"url("+t.resolveImg(t.mapConfig[t.template].backGround)+") repeat","background-size":"100%",height:t.list.length<3?192:100*t.list.length*.64+"vw","background-position":"bottom"}},[s("PlanetList",{ref:"planetListRef",attrs:{"currnt-top":t.currntTop,"map-id":t.mapId,list:t.list,first:t.first,"rocket-in":t.first===t.list.length-1,avatar:t.avatar,"all-completed":t.first===t.list.length,"map-config":t.mapConfig[t.template],"stage-pass":t.stagePass}}),s("StartMask",{attrs:{"map-config":t.mapConfig[t.template]}})],1),s("SuccessModal",{attrs:{"map-config":t.mapConfig[t.template],"show-success":t.showSuccess,"certificate-name":t.certificateName,"certificate-score":t.certificateScore,"handle-success-modal-close":t.handleSuccessModalClose}})],1),s("OverlayLoading",{attrs:{show:t.loading}})],1)}),[],!1,null,null,null).exports,v=s(54759),f=s(76426),y=s(62143),_=s(96202),C=s(39069),I=s(91529),b={name:"ProjectMap",components:{OverlayLoading:r.Z,Rocket:f.Z,PlanetList:y.Z,Sun:_.Z,Info:C.Z,SuccessModal:I.Z},beforeRouteLeave(t,e,s){if(e.meta.keepAlive){const t=document.querySelector("#project-sky"),s=t?t.scrollTop:0;e.meta.scrollTop=s}s()},props:{projectId:{type:String,required:!0}},data:function(){return{stagePass:!1,loading:!1,progress:1,score:2,num:1,summary:"10",certificate_id:"",studyInfo:{award_score:0,certificate_name:""},first:0,rocketIn:!1,list:[],mapId:"",avatar:"",giftId:"",hasRewards:!0,checkpointNum:7,shouldRender:!0,gitfVisible:!1,rewardCount:10,showSuccess:!1,certificateName:"",certificateScore:10,currntTop:0}},computed:(0,a.Z)({},(0,i.mapGetters)({projectInfo:"projectMap/getProjectInfo",fresh:"microCourse/getFreshStatus"})),watch:{fresh(t){t&&((0,v.g)(".sky-container"),this.initData(),this.$store.commit("microCourse/updateFresh",!1))}},mounted(){(0,v.g)(".sky-container"),this.initData()},activated(){},methods:{initScroll(){const{mapContentRef:t}=this.$refs,{first:e,list:s}=this,a=1!==e&&s&&s.length?e/s.length*t.scrollHeight:0;this.$nextTick((()=>{t&&(t.scrollTop=t.scrollHeight-a,t.addEventListener("scroll",this.scrollCallFun))}))},initData(){this.dualInitDataBus(),this.getSuccessModalData()},getCurrentIndex(t){const e=t&&t.length&&t.filter((t=>"current"===t.status))[0];return e&&e.length&&e[0].sort},async dualInitDataBus(){let t=this;try{this.loading=!0;const e=await n.Z.getCourseTaskMapDetail({id:this.$props.projectId});if(e&&e.data){const{data:s}=e.data;t.list=s.stageList.sort(((t,e)=>t.sort-e.sort)),t.list.reverse(),t.first=t.getCurrentIndex(t.list)||1,t.avatar=s.avatar,t.rocketIn=Boolean(1===t.first),t.progress=s.process,t.score=s.score,t.num=s.num,t.summary=s.summary,t.title=s.title}this.initScroll(),this.loading=!1}catch(t){return this.loading=!1,console.error(t),Promise.reject(t)}},handleReceiveReward(){this.gitfVisible=!0},handleCloseGift(){this.gitfVisible=!1},getSuccessModalData(){let t=[{name:"AAA测试的证书数据名字123345465mock"}];if(t.length)if(t.length>1)this.certificateName=`+${t.length}`;else{let e=t[0].name;this.certificateName=e.length>15?`《${e.substr(0,15)}...》`:`《${e}》`}else this.showSuccess=!1},handleSuccessModalClose(){this.showSuccess=!1},scrollCallFun(t){const e=t&&t.target&&t.target.scrollTop;this.currntTop=e}},beforeDestroyed(){const{mapContentRef:t}=this.$refs;t.removeEventListener("scroll",this.scrollCallFun)}},w={components:{DesertMap:g,SkytMap:(0,m.Z)(b,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"project-sky"},[s("div",{staticClass:"sky-container"},[s("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],ref:"mapContentRef",staticClass:"sky-content-container"},[s("Info",{attrs:{progress:t.progress,score:t.score,num:t.num,summary:t.summary,avatar:t.avatar,"study-info":t.studyInfo}}),s("Sun"),s("PlanetList",{attrs:{"currnt-top":t.currntTop,"map-id":t.mapId,list:t.list,first:t.first,"rocket-in":t.first===t.list.length-1,avatar:t.avatar,"all-completed":t.first===t.list.length,"stage-pass":t.stagePass}}),s("Rocket",{ref:"initRocketRef",attrs:{"rocket-in":t.rocketIn,"keep-alive":Boolean(t.list.length&&t.first!==t.list.length-1)}}),s("SuccessModal",{attrs:{"show-success":t.showSuccess,"certificate-name":t.certificateName,"certificate-score":t.certificateScore,"handle-success-modal-close":t.handleSuccessModalClose}})],1),s("OverlayLoading",{attrs:{show:t.loading}})],1)])}),[],!1,null,null,null).exports},data(){return{projectInfo:this.$route.query}},computed:{},created(){},mounted(){},methods:{}},$=(0,m.Z)(w,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},["desert"===t.projectInfo.styleType?s("DesertMap",{attrs:{"project-id":t.projectInfo.id}}):s("SkytMap",{attrs:{"project-id":t.projectInfo.id}})],1)}),[],!1,null,"1cc3b470",null).exports},63263:(t,e,s)=>{s.r(e),s.d(e,{default:()=>S});var a=s(95082),i=(s(34837),s(39146)),o=(s(2707),s(47601),s(44951)),r=s(78551),n=s(78368),c={components:{[o.Z.name]:o.Z,SvgIcon:r.Z},props:{projectInfo:{type:Object,default:()=>({})},themeColor:{type:String,default:""}},data:()=>({defaultAvatar:n,studyTip:"",examTip:"",operationTip:"",evaluationTip:""}),computed:{saveMoney(){return(100*Number(this.projectInfo.official_price_str)-100*Number(this.projectInfo.preferential_price_str))/100}},mounted(){},methods:{toLogin(){this.$emit("toLogin")}}},l=s(1001),u=(0,l.Z)(c,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"top-info"},[s("div",{staticClass:"top-info-cover"},[s("van-image",{attrs:{fit:"cover",src:t.projectInfo.cover}})],1),s("div",{staticClass:"top-info-content"},[s("div",{staticClass:"top-info-title"},[t._v(" "+t._s(t.projectInfo.title)+" ")]),s("div",{staticClass:"top-info-price"},[t.projectInfo.is_free?s("div",{staticClass:"top-info-price-free",style:{color:t.themeColor}},[t._v(" 免费 ")]):s("div",{staticClass:"top-info-price-nofree"},[s("div",{staticClass:"top-info-price-new",style:{color:t.themeColor}},[s("div",{staticClass:"top-info-price-new-single"},[t._v("￥")]),s("div",{staticClass:"top-info-price-new-large"},[t._v(t._s(t.projectInfo.preferential_price_str))])]),parseInt(t.projectInfo.official_price_str)>0?s("div",{staticClass:"top-info-price-old"},[t._v(" ￥"+t._s(t.projectInfo.official_price_str)+" ")]):t._e(),t.saveMoney>0?s("div",{staticClass:"top-info-price-offline"},[t._v(" 立省"+t._s(t.saveMoney.toFixed(2))+"元 ")]):t._e()])]),s("div",{staticClass:"top-info-other"},[s("div",{staticClass:"top-info-other-left"},[t.projectInfo.create_user_name?s("div",{staticClass:"top-info-other-creator"},[s("van-image",{attrs:{round:"",width:"24px",height:"24px",src:t.projectInfo.avatar||t.defaultAvatar}}),s("span",{staticClass:"teacher"},[t._v(t._s(t.projectInfo.create_user_name))])],1):t._e(),s("div",{staticClass:"top-info-other-count",on:{click:t.toLogin}},[t._v(" "+t._s(t.$t("project.stageCount"))+" "+t._s(t.projectInfo.resource_count)+" ")]),s("div",{staticClass:"top-info-other-see",on:{click:t.toLogin}},[s("span",{staticClass:"top-info-other-see-right"},[t._v(t._s(t.$t("course.peopleLearning"))+" "+t._s(t.projectInfo.study_record))]),s("svg-icon",{staticClass:"iconfont info_studying",attrs:{"icon-class":"icon-chakanpaiming",color:"#D9DBE4",size:12}})],1)]),s("div",{staticClass:"top-info-other-right"},[t.projectInfo.award_score>0?s("div",[t._v(" "+t._s(t.projectInfo.award_score)+" 学分 ")]):t._e()])]),s("div",{staticClass:"appraise"},[t.projectInfo.score>=0?s("div",{staticClass:"appraise-score"},t._l(Object.keys(Array.from({length:5})),(function(e,a){return s("span",{key:a,staticClass:"start-item"},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-xingxingchengcopy",color:e<(0==t.projectInfo.score?5:t.projectInfo.score)?t.themeColor:"#C0C2CB",size:14}})],1)})),0):t._e(),"true"===t.projectInfo.graded?s("div",{staticClass:"appraise-text",on:{click:t.toLogin}},[t._v(" "+t._s(t.$t("course.toRate"))+" "),s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-chakanpaiming",color:"#D9DBE4",size:12}})],1):t._e()]),t.projectInfo.summary?s("div",{staticClass:"top-info-summary"},[s("div",{staticClass:"top-info-summary-title"},[t._v("学习项目描述：")]),s("div",{staticClass:"top-info-summary-content"},[t._v(t._s(t.projectInfo.summary))])]):t._e()])])}),[],!1,null,"6b19799e",null).exports,d=(s(31960),s(10993)),h=(s(37138),s(2113)),p=(s(74268),s(55948)),m=(s(39714),s(47238),s(75167)),g={components:{SvgIcon:r.Z,[m.Z.name]:m.Z,[i.Z.name]:i.Z},props:{item:{type:Object,default:()=>{}},themeColor:{type:String,default:""},projectInfo:{type:Object,default:()=>{}}},data:()=>({color:"",iconClass:"",name:""}),watch:{projectInfo(){this.renderResourceLabel()}},mounted(){this.renderResourceLabel()},methods:{renderResourceLabel(){const{item:t}=this;switch(t.type){case"exam":this.color="#D8403D",this.iconClass="icon-kaoshirenwu",this.name="考试";break;case"course":this.color="#465dcd",this.iconClass="icon-lesson",this.name=`课程（${t.resource_count}）`;break;case"ppt":case"pptx":this.color="#fc8033",this.iconClass="icon-ppt1",this.name="PPT";break;case"pdf":this.color="#d64f4f",this.iconClass="icon-pdf1",this.name="PDF";break;case"doc":case"docx":this.color="#008BFF",this.iconClass="icon-word",this.name="WORD";break;case"xls":case"xlsx":this.color="#70B78E",this.iconClass="icon-excel",this.name="EXCEL";break;case"html":this.color="#65a6f3",this.iconClass="icon-HTML",this.name="HTML";break;case"jpg":case"png":case"jpeg":this.color="#65a6f3",this.iconClass="icon-tupian",this.name="图片";break;case"scorm":this.color="#5ACC9B",this.iconClass="icon-scorm",this.name="SCORM";break;case"latoja":this.color="#465dcd",this.iconClass="icon-downline",this.name="线下课";break;case"investigate":this.color="#3AC4CC",this.iconClass="icon-tiaoyanrenwu",this.name="调研";break;case"micro_course":this.color="#465dcd",this.iconClass="icon-weik",this.name="微课";break;case"txt":this.color="#727896",this.iconClass="icon-ematter-txt",this.name="文本";break;case"article":case"link":case"h5":this.color="#88A3CB",this.iconClass="icon-Ekejian1",this.name="文章";break;case"operation":this.color="#D64F4F",this.iconClass="icon-shicaokaohexin",this.name="实操作业";break;case"evaluation":this.color="#5dbd66",this.iconClass="icon-gangweiceping",this.name="测评"}"mp4"===t.type&&"mp3"!==t.original_type&&(this.color="#465dcd",this.iconClass="icon-play",this.name="视频"),"mp3"!==t.type&&"mp4"!==t.type||"mp3"!==t.original_type||(this.color="#ff5e94",this.iconClass="icon-music",this.name="音频")},courseTap(){this.$emit("toLogin")}}},v=(0,l.Z)(g,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"course-one",on:{click:t.courseTap}},[s("div",{staticClass:"course-one-left"},[s("div",{staticClass:"course-type"},[s("div",[s("div",{staticClass:"icon"},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":t.iconClass,color:t.color,size:15}})],1),t._v(" "+t._s(t.name)+" ")]),8===t.item.sourceType||"mp3"!==t.item.type&&"mp4"!==t.item.type&&"course"!==t.item.type&&"micro_course"!==t.item.type&&"exam"!==t.item.type&&"newExam"!==t.item.type?t._e():s("span",{staticClass:"course-duration"},[t._v(" "+t._s(t.item.formatDuration)+" ")]),"mp4"===t.item.type&&"finish"===t.item.ai_upgrade_status?s("span",{staticClass:"ai-deal-success"},[t._v(" "+t._s(t.$t("course.aiDealSuccess"))+" ")]):t._e()]),s("div",{staticClass:"course-title"},[t._v(t._s(t.item.title))])])])}),[],!1,null,"79a8e444",null).exports,f={components:{[p.Z.name]:p.Z,[h.Z.name]:h.Z,[d.Z.name]:d.Z,StagesItem:v},props:{projectInfo:{type:Object,default:()=>{}},stagesList:{type:Array,default:()=>[]}},data:()=>({activeNames:[]}),watch:{stagesList(t){this.activeNames=Array.from(t,((t,e)=>e.toString()))}},mounted(){this.activeNames=Array.from(this.stagesList,((t,e)=>e.toString()))},methods:{toLogin(){this.$emit("toLogin")}}},y=(0,l.Z)(f,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"project-detail-stages-content"},[t.projectInfo&&t.stagesList.length>0?s("van-collapse",{model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},t._l(t.stagesList,(function(e,a){return s("van-collapse-item",{key:a,attrs:{title:e.stage_name,name:a.toString()}},[s("div",[s("div",{staticClass:"stages-desc-title"},[s("p",{class:[(e.is_get_score||e.certificate_name||e.content)&&t.stagesList[a]&&!t.stagesList[a].more?"van-ellipsis":""]},[s("span",[t._v(t._s(t.$t("project.learningRequirementsTips"))+"：")]),t._v(" "+t._s(e.study_progress_standard)+" "),e.progress?s("span",[t._v(t._s(t.$t("project.studyTip",{progress:e.progress}))+" ")]):t._e()])]),s("div",{staticClass:"course-container"},t._l(e.course_list,(function(e,a){return s("StagesItem",{key:a,ref:"stagesItem",refInFor:!0,attrs:{item:e,"project-info":t.projectInfo},on:{toLogin:t.toLogin}})})),1)])])})),1):t._e()],1)}),[],!1,null,"479d5d49",null).exports,_=s(22648),C={components:{SvgIcon:r.Z},props:{projectInfo:{type:Object,default:()=>{}},themeColor:{type:String,default:""}},data:()=>({totalComments:""}),computed:{isIpx:()=>(0,_.Rq)()},created(){},mounted(){},methods:{startAndLinkTo(){this.$emit("toLogin")}}},I=(0,l.Z)(C,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"study-project-action-bar"},[s("div",{staticClass:"action-bar-container"},[s("div",{class:[t.isIpx?"action-bar active":"action-bar"]},[s("div",{staticClass:"counts",on:{click:t.startAndLinkTo}},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-talk",color:"#7F849A",size:18}}),s("span",{staticClass:"num"},[t._v(" "+t._s(t.projectInfo.comment_count))])],1),s("div",{staticClass:"counts",on:{click:t.startAndLinkTo}},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-zan",color:"like"===t.projectInfo.like_status?"#df6666":"#7F849A",size:18}}),s("span",{staticClass:"num"},[t._v(t._s(t.projectInfo.like_count))])],1),s("div",[s("div",{staticClass:"action-bar__study",style:{background:t.themeColor},on:{click:t.startAndLinkTo}},[t._v(" "+t._s(t.projectInfo.is_free?t.$t("project.register"):t.$t("discovery.buyNow"))+" ")])])])])])}),[],!1,null,"af8be85c",null).exports,b=s(20243),w=s(11046),$={components:{TopInfo:u,Stages:y,ActionBar:I},data:()=>({studyId:"1812096506006736896",projectInfo:{},stagesList:[],learningRequirementsTips:""}),computed:{themeColor(){return this.$store.state.themeColor.primaryColor},userInfo(){return this.$store.state.commonParams}},mounted(){this.loading=!0,i.Z.loading({message:"加载中..."}),this.$nextTick((()=>{this.init()}))},methods:{async init(){try{await b.Z.courseDetailCanSee();const{id:t}=this.$route.query;this.studyId=t,this.initGetData()}catch(t){this.$toast.fail(this.$t("home.bannerNoRightView")),this.toLogin()}},async initGetData(){const{getCourseTaskDetail:t}=b.Z;let e=await t({id:this.studyId});this.saveStudyInfo(e)},getNextCanStudy:(t,e)=>t.findIndex(((t,s)=>s>e&&"latoja"!==t.type)),saveStudyInfo(t){const e=t.data;e.learningRequirementsTips=this.renderLearningTips(t.data.study_progress_standard,t.data.exam_times,t.data.operation_times,t.data.finish_evaluation);const s=this.dealStage(e.stages);i.Z.clear(),this.projectInfo=e,this.learningRequirementsTips=e.learningRequirementsTips,this.stagesList=s},dealStage:t=>t.map((t=>{const{resources:e}=t;return(0,a.Z)((0,a.Z)({},t),{},{content:t.content,id:t.id,in_order:t.is_order_str,order:t.sort,stage_name:t.stage_name,course_list:e.map((t=>{let e="";switch(t.type){case 1:e="micro_course"===t.biz_type?"micro_course":"course";break;case 2:case 3:e=t.content_type;break;case 6:e="exam";break;case 7:e="latoja";break;case 9:e="investigate";break;case 10:e="operation";break;case 11:e="evaluation"}const s=3===t.type||2===t.type;return{cover:s?t.resource.cover:"",duration:s?t.resource.duration:1===t.type||6===t.type?t.duration:"",id:t.course_id,biz_type:t.biz_type,resourceId:t.resourceId||"",original_type:t.content_type,path:s?t.resource.path:"",progress:t.study_progress,questionnaire_id:t.questionnaire_id,recent_start:s?t.recent_start:0,resource_count:0,resource_quiz_vo:t.resource_quiz_vo,score:t.exam?t.exam.exam_score:0,show_repeat_exam:t.exam?t.exam.show_re_exam:"false",size:s?t.resource.path:"",sort:0,resource_status:s||10===t.type?t.resource_status:3,title:9===t.type?t.title:t.resource_name,url:s?t.resource.url:"",type:e,show_result:"exam"===e?t.exam.show_result:"",status:t.exam?t.exam.exam_status:"",can_start_study:t.can_start_study,unlocking_time:t.unlocking_time?(0,_.p6)(t.unlocking_time,"yyyy-MM-dd hh:mm"):null,resource_type:t.resource_type||"",sourceType:t.resource?t.resource.sourceType:"",spaceId:t.resource?t.resource.path:"",fileId:t.resource?t.resource.url:"",fileName:t.resource?t.resource.name:"",fileSize:t.resource?t.resource.size:"",fileType:t.resource?t.resource.type:"",initType:t.type,ai_upgrade_status:t.ai_upgrade_status,storage_type:t.resource?t.resource.storage_type:"",link_switch:t.link_switch,video_id:t.resource?t.resource.video_id||t.resource.videoId:""}}))})})),toLogin(){(0,w.rf)({flag:"study_project",id:this.studyId,styleType:this.projectInfo.style_type})},renderLearningTips(t,e,s,a){const i=t>0?this.$t("project.studyTip",t):"",o=e>0?this.$t("project.examTip",e):"",r=s>0?this.$t("project.operationTip",s):"",n="true"===a?this.$t("project.evaluationTip"):"";return`${this.$t("project.learningRequirementsTips")}: ${i}${o}${r}${n}`}}},k=$,S=(0,l.Z)(k,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"project-detail"},[s("TopInfo",{attrs:{"project-info":t.projectInfo,"theme-color":t.themeColor},on:{toLogin:t.toLogin}}),s("Stages",{ref:"stages",attrs:{"project-info":t.projectInfo,"theme-color":t.themeColor,"stages-list":t.stagesList},on:{toLogin:t.toLogin}}),s("ActionBar",{attrs:{"project-info":t.projectInfo,"theme-color":t.themeColor},on:{toLogin:t.toLogin}})],1)}),[],!1,null,"88b8b2f2",null).exports},52835:(t,e,s)=>{s.d(e,{H:()=>a,t:()=>i});const a=[{name:"all",lang:"approvals.allApproval",moreLang:"approvals.moreAllApproval"},{name:"any",lang:"approvals.anyApproval",moreLang:"approvals.moreAnyApproval"}],i={approval_pass:{color:"#5DBD66",lang:"approvals.passed",otherLang:"approvals.passed",icon:"icon-shenpitongguo"},agree:{color:"#5DBD66",lang:"approvals.passed",otherLang:"approvals.passed",icon:"icon-shenpitongguo"},refuse:{color:"#D8403D",lang:"approvals.rejected",otherLang:"approvals.rejected",icon:"icon-shenpijujue"},approval_reject:{color:"#D8403D",lang:"approvals.rejected",otherLang:"approvals.rejected",icon:"icon-shenpijujue"},approval_going:{color:"#B1B5C6",lang:"approvals.going",otherLang:"attestation.inReview"},underway:{color:"#B1B5C6",lang:"approvals.going",otherLang:"attestation.inReview"},approval_revoked:{color:"#FFA000",lang:"approvals.revoked",otherLang:"approvals.revoked",icon:"icon-shenpichexiao"},abolish:{color:"#FFA000",lang:"approvals.revoked",otherLang:"approvals.revoked",icon:"icon-shenpichexiao"}}},72525:(t,e,s)=>{s.d(e,{G:()=>a});const a=t=>{var e;const{type:s,content:a}=t,i=null==a||null===(e=a.content)||void 0===e?void 0:e.split("<br/>");return"mobile"===s&&Array.isArray(i)?i:[]}},52196:(t,e,s)=>{s.d(e,{XS:()=>f,f2:()=>y,h2:()=>_});s(34837);var a=s(39146),i=(s(21703),s(57658),s(26699),s(32023),s(25295)),o=s(6106),r=s(27632),n=s(55602),c=s(63874),l=s(17563),u=s(95969),d=s(22648),h=s(56955),p=s(15123),m=s(7294),g=s(68092),v=s(82291);async function f({courseData:t}){const e=(0,d.L7)(t),{courseType:s,bizType:a,isJumpDirect:i,id:r}=e;let n="";"true"===i?n="image_text":"course"===s?n=6===a?"image_text":3===a?"project":"course":"micro_course"===s&&(n="course");const c=await o.Z.checkVisible({resourceId:r,type:n});return c.data.success?c:Promise.reject(new Error("fail"))}async function y({courseData:t}){const e=(0,g.UI)("FXKT_WHITE_FLAG"),s=(0,d.L7)(t),{id:n,courseType:l,notShowSeeMsg:f,courseSource:y,bizType:_,projectCourseId:C,isJumpDirect:I,h5ResourceId:b,liveType:w,liveStatus:$}=s;if(i.Z.addScanCount({id:n}),f)(0,a.Z)({type:"text",message:f,duration:3e3});else if("true"===I)p.ZP.push({path:u.Z.resource.toImageTextCourse({from:"course",courseId:n,resourceId:b})});else if("course"===l){if(6===_){const t=await i.Z.getImageTextResource({courseId:n});let{resourceId:s,url:a,linkSwitch:o}=t.data.data;return void("true"===o?(await h.Z.saveProgress("enterprise",{resourceId:s,courseId:n},{progress:100},null,!1),e&&a.includes(v.V.host)?v.V.pointCourseDetail(a):(0,c.N8)({url:a})):p.ZP.push({path:u.Z.resource.toImageTextCourse({from:"course",courseId:n,resourceId:s})}))}if(3===_)return void p.ZP.push({path:u.Z.studyProject.toStudyProject({studyProjectId:C||n})});if(8===_){if("dingTalk"===r.Z.env&&"live_course"===w){const t=await o.Z.getLiveDetailUrl(n),{jumpUrl:e}=t.data.data;r.Z.openLink({url:e})}else"poly_wei"===w?(0,m.K7)(n,$):(0,m.It)(n,$);return}if(9===_)return void(0,m.CS)(n,$);"enterprise"!==y&&"platform"!==y||p.ZP.push({path:`/course-${y}-detail`,query:{courseResource:y,courseId:n,originType:"corpCourse"}})}else"micro_course"===l&&p.ZP.push({path:`/micro-watch/${n}/newest`,query:{studyType:"other"}})}const _=({flag:t,courseId:e,title:s,imageUrl:a,desc:i})=>{if("dingTalk"===r.Z.env){const o={courseId:e,flag:t};(0,n.vD)({shareInfo:{title:s,desc:i,path:`pages/messageRedirect/messageRedirect?${l.stringify(o)}`,imageUrl:a}})}}},67992:(t,e,s)=>{s.d(e,{RT:()=>p,YQ:()=>_,ZZ:()=>m,ch:()=>y,i3:()=>C,n:()=>d});s(31146);var a=s(41610),i=(s(34837),s(39146)),o=(s(57658),s(26699),s(27632)),r=s(28787),n=s(1313),c=s(57969),l=s(15123),u=s(96838);const d=()=>{r.Z.commit("face/setFaceStatus","idle"),r.Z.commit("face/updateUrl",{url:"",result:!1}),history.go(-1)},h=(t={})=>{const{memory:e}=window.performance;u.Z.logger({moduleName:"faceStack",data:{jsHeapSizeLimit:e.jsHeapSizeLimit,totalJSHeapSize:e.totalJSHeapSize,usedJSHeapSize:e.usedJSHeapSize,model:t.model||"",version:t.version||"",storage:t.storage||"",system:t.system||"",platform:t.platform||"",brand:t.brand||""}})},p=({successPath:t,failRequest:e,hasSetFace:s,showToast:a=!0})=>{o.Z.chooseImage({count:1,sourceType:["camera"],compressed:!0,percent:80},(l=>{"success"===l.status&&(i.Z.loading({duration:0,forbidClick:!0,message:c.Z.t("common.uploading")}),o.Z.uploadFile({url:n.Z.uploadFace(s),fileName:"file",fileType:"image",formData:{access_token:r.Z.state.commonParams.accessToken},filePath:l.filePaths[0]},(({data:o})=>{i.Z.clear();try{const a=`${o.data.server}/${o.data.fileNewName}`,l={image_url:a.ossimg()};i.Z.loading({duration:0,forbidClick:!0,message:c.Z.t("faceKnow.checking")}),n.Z.checkFace(l,s).then((s=>{i.Z.clear(),r.Z.commit("face/updateUrl",{url:a.ossimg(),result:"true"===s.data.result}),"true"===s.data.result?t&&"function"==typeof t&&t(a):e&&"function"==typeof e&&e(a)})).catch((()=>{r.Z.commit("face/updateUrl",{url:a.ossimg(),result:!1}),e&&"function"==typeof e&&e(a)}))}catch(t){a&&i.Z.fail({message:c.Z.t("common.uploadFail")}),e&&"function"==typeof e&&e()}}),(()=>{i.Z.clear(),a&&i.Z.fail({message:c.Z.t("common.uploadFail")}),e&&"function"==typeof e&&e()})))})),window&&window.performance&&window.performance.memory&&(o.Z.getSystemInfo?o.Z.getSystemInfo({},(t=>{h(t)})):h())},m=()=>{const{isShowPreventHangModal:t}=r.Z.state.study;if(!t)return;const{showRandomWindow:e}=r.Z.state.setting;return a.Z.alert({title:c.Z.t("common.reminder"),message:e?c.Z.t("component.preventAlertTip"):c.Z.t("promptMessage.preventHangTips"),confirmButtonText:c.Z.t("promptMessage.roger"),cancelButtonText:c.Z.t("common.cancel")})},g=(t,e,s)=>{r.Z.commit("face/updateUrl",{url:t.ossimg(),result:e,successPath:s}),l.ZP.push({path:"/face"})},v=(t,e)=>{if(r.Z.commit("face/setFaceStatus","idle"),t&&"function"==typeof t)t();else{if("true"===localStorage.getItem("showHomeLink")&&e&&"function"==typeof e)return void e();const{fromSource:t}=r.Z.state.face;if("taro"===t)return void o.Z.navigateBack();history.go(-1)}},f=(t,e,s,l,u,d)=>{o.Z.chooseImage({count:1,sourceType:["camera"],compressed:!0,percent:80},(h=>{"success"===h.status?(r.Z.commit("face/setFaceStatus","checking"),a.Z.close(),i.Z.loading({duration:0,forbidClick:!0,message:c.Z.t("common.uploading"),overlay:!0}),o.Z.uploadFile({url:n.Z.uploadFace(l),fileName:"file",fileType:"image",file:"wechat_qy"===o.Z.env?h.files[0]:null,formData:{access_token:r.Z.state.commonParams.accessToken},filePath:h.filePaths[0]},(({data:o})=>{try{r.Z.commit("face/setFaceStatus","checking");const h=`${o.data.server}/${o.data.fileNewName}`,p={image_url:h.ossimg()};i.Z.loading({duration:0,forbidClick:!0,message:c.Z.t("faceKnow.checking"),overlay:!0}),n.Z.checkFace(p,l).then((o=>{a.Z.close(),i.Z.clear(),l?"true"===o.data.result?(a.Z.close(),(0,i.Z)(c.Z.t("faceKnow.checkPass")),r.Z.commit("face/setFaceStatus","success"),e&&"function"==typeof e&&e()):(r.Z.commit("face/setFaceStatus","failed"),a.Z.confirm({title:c.Z.t("common.reminder"),message:c.Z.t("faceKnow.checkFailTip"),confirmButtonText:c.Z.t("faceKnow.reCheck"),cancelButtonText:c.Z.t("common.cancel"),beforeClose:(a,i)=>{"confirm"===a?(f(t,e,s,l,u,d),i(!1)):"cancel"===a&&(v(s,t),i())}})):g(h,"true"===o.data.result,e)})).catch((o=>{i.Z.clear();let n=c.Z.t("faceKnow.checkFailTip");"enterpriseapi.568007"===o.data.code&&(n=c.Z.t("faceKnow.notCompliant")+n),l?(r.Z.commit("face/setFaceStatus","failed"),a.Z.confirm({title:c.Z.t("common.reminder"),message:n,confirmButtonText:c.Z.t("faceKnow.reCheck"),cancelButtonText:c.Z.t("common.cancel"),beforeClose:(a,i)=>{"confirm"===a?(f(t,e,s,l,u,d),i(!1)):"cancel"===a&&(v(s,t),i())}})):g(h,!1,e)}))}catch(o){i.Z.clear(),r.Z.commit("face/setFaceStatus","failed"),a.Z.confirm({title:c.Z.t("common.reminder"),message:c.Z.t("faceKnow.checkFailTip"),confirmButtonText:c.Z.t("faceKnow.reCheck"),cancelButtonText:c.Z.t("common.cancel"),beforeClose:(a,i)=>{"confirm"===a?(f(t,e,s,l,u,d),i(!1)):"cancel"===a&&(v(s,t),i())}})}}),(()=>{i.Z.clear(),i.Z.fail({message:c.Z.t("common.uploadFail")}),r.Z.commit("face/setFaceStatus","failed"),setTimeout((()=>{a.Z.confirm({title:c.Z.t("common.reminder"),message:c.Z.t("faceKnow.checkFailTip"),confirmButtonText:c.Z.t("faceKnow.reCheck"),cancelButtonText:c.Z.t("common.cancel"),beforeClose:(a,i)=>{"confirm"===a?(f(t,e,s,l,u,d),i(!1)):"cancel"===a&&(v(s,t),i())}})}),500)}))):r.Z.commit("face/setFaceStatus","idle")})),window&&window.performance&&window.performance.memory&&(o.Z.getSystemInfo?o.Z.getSystemInfo({},(t=>{h(t)})):h())},y=({successPath:t,failDiscernPath:e,failRequest:s,hasSetFace:l})=>{r.Z.commit("exam/setIsCutScreen",!1),o.Z.chooseImage({count:1,sourceType:["camera"],compressed:!0,percent:80},(u=>{"success"===u.status?(a.Z.close(),i.Z.loading({duration:0,forbidClick:!0,message:c.Z.t("common.uploading"),overlay:!0}),r.Z.commit("face/setFaceStatus","checking"),o.Z.uploadFile({url:n.Z.uploadFace(),fileName:"file",fileType:"image",formData:{access_token:r.Z.state.commonParams.accessToken},file:"wechat_qy"===o.Z.env?u.files[0]:null,filePath:u.filePaths[0]},(({data:o})=>{try{const u=`${o.data.server}/${o.data.fileNewName}`,d={image_url:u.ossimg()};i.Z.loading({duration:0,forbidClick:!0,message:c.Z.t("faceKnow.checking"),overlay:!0}),n.Z.checkFace(d,l).then((o=>{i.Z.clear(),l?"true"===o.data.result?(a.Z.close(),(0,i.Z)(c.Z.t("faceKnow.checkPass")),r.Z.commit("face/setFaceStatus","success"),t&&"function"==typeof t&&t(u)):(r.Z.commit("face/setFaceStatus","failed"),s&&"function"==typeof s&&s(u),a.Z.confirm({message:c.Z.t("faceKnow.checkFailTip"),confirmButtonText:c.Z.t("faceKnow.reCheck"),showCancelButton:!1,beforeClose:(a,i)=>{"confirm"===a&&(i(!1),e&&"function"==typeof e&&e(),y({successPath:t,failDiscernPath:e,failRequest:s,hasSetFace:l}))}}),setTimeout((()=>{r.Z.commit("face/setCheckStatus")}),100)):g(u,"true"===o.data.result,t)})).catch((o=>{i.Z.clear(),r.Z.commit("face/setFaceStatus","failed"),s&&"function"==typeof s&&s(u);let n=c.Z.t("faceKnow.checkFailTip");"enterpriseapi.568007"===o.data.code&&(n=c.Z.t("faceKnow.notCompliant")+n),l?(a.Z.confirm({message:n,confirmButtonText:c.Z.t("faceKnow.reCheck"),showCancelButton:!1,beforeClose:(a,i)=>{"confirm"===a&&(i(!1),e&&"function"==typeof e&&e(),y({successPath:t,failDiscernPath:e,failRequest:s,hasSetFace:l}))}}),setTimeout((()=>{r.Z.commit("face/setCheckStatus")}),100)):g(u,!1,t)}))}catch(o){i.Z.clear(),r.Z.commit("face/setFaceStatus","failed"),s&&"function"==typeof s&&s(),a.Z.confirm({message:c.Z.t("faceKnow.checkFailTip"),confirmButtonText:c.Z.t("faceKnow.reCheck"),showCancelButton:!1,beforeClose:(a,i)=>{"confirm"===a&&(i(!1),e&&"function"==typeof e&&e(),y({successPath:t,failDiscernPath:e,failRequest:s,hasSetFace:l}))}}),setTimeout((()=>{r.Z.commit("face/setCheckStatus")}),100)}}),(()=>{i.Z.clear(),i.Z.fail({message:c.Z.t("common.uploadFail")}),s&&"function"==typeof s&&s(),r.Z.commit("face/setFaceStatus","failed"),setTimeout((()=>{a.Z.confirm({message:c.Z.t("faceKnow.checkFailTip"),confirmButtonText:c.Z.t("faceKnow.reCheck"),showCancelButton:!1,beforeClose:(a,i)=>{"confirm"===a&&(i(!1),e&&"function"==typeof e&&e(),y({successPath:t,failDiscernPath:e,failRequest:s,hasSetFace:l}))}}),r.Z.commit("face/setCheckStatus")}),500)}))):r.Z.commit("face/setFaceStatus","idle")})),window&&window.performance&&window.performance.memory&&(o.Z.getSystemInfo?o.Z.getSystemInfo({},(t=>{h(t)})):h())},_=({messageCancel:t,successPath:e,cancel:s,hasSetFace:i,tip1:n,tip2:l})=>{r.Z.commit("face/setFaceStatus","idle"),window&&window.performance&&window.performance.memory&&(o.Z.getSystemInfo?o.Z.getSystemInfo({},(t=>{h(t)})):h());const u=`<div style="display: flex; flex-direction: column;">\n       <div>${l}</div>\n       <div style="font-size: 12px;">1.${c.Z.t("faceKnow.faceKnowTip1")}</div>\n       <div style="font-size: 12px;">2.${c.Z.t("faceKnow.faceKnowTip2")}</div>\n       <div style="font-size: 12px;">3.${c.Z.t("faceKnow.faceKnowTip3")}</div>\n     </div>`,d=`<div style="display: flex; flex-direction: column;">\n     <div>${n}</div>\n     <div style="font-size: 12px;">1.${c.Z.t("faceKnow.faceKnowTip2")}</div>\n     <div style="font-size: 12px;">2.${c.Z.t("faceKnow.faceKnowTip3")}</div>\n   </div>`;return a.Z.confirm({title:c.Z.t("common.reminder"),message:i?d:u,allowHtml:!0,messageAlign:"left",confirmButtonText:i?c.Z.t("faceKnow.gotoKnow"):c.Z.t("faceKnow.gotoUpload"),cancelButtonText:c.Z.t("common.cancel"),beforeClose:(a,o)=>{"confirm"===a?(f(t,e,s,i,d,u),o(!1)):"cancel"===a&&(v(s,t),o())}})};function C(){return["dingTalk","app","wechat_qy","wechat_browser"].includes(o.Z.env)||"app"===o.Z.specialEnv}},41996:(t,e,s)=>{s.d(e,{x:()=>i});s(57658);var a=s(15123);const i=t=>{t.flag?a.ZP.push({path:`/discovery/course-package-detail?coursepackageId=${t.id}`}):a.ZP.push({path:`/course-platform-detail?courseId=${t.id}&courseResource=platform`})}},82291:(t,e,s)=>{s.d(e,{V:()=>n});s(57658);var a=s(60470),i=s(28787),o=s(25295),r=s(98512);const n={host:"pcias.amestech.cn",list:({auth:t="",userId:e=""})=>`https://pcias.amestech.cn/html/peixun/#/commonList?auth=${t}&userId=${e}`,detail:({auth:t="",userId:e="",id:s=""})=>`https://pcias.amestech.cn/html/peixun/#/commonDetail?id=${s}&auth=${t}&userId=${e}`,async getAuthData(){var t;let e="";const s=await o.Z.getCustomAuth();return null!=s&&null!==(t=s.data)&&void 0!==t&&t.data&&(e=s.data.data,a.Z.$store.commit("knowledge/setAuth",e)),e},toPointCoursePage:({type:t="list",id:e="",auth:s=""})=>{const{userId:o=""}=i.Z.state.commonParams;a.Z.$router.push({path:"/custom-course",query:{iframeUrl:encodeURIComponent(n[t]({auth:s||i.Z.state.knowledge.auth,userId:o,id:e})),type:t}})},pointCourseDetail:async t=>{const{id:e=""}=(0,r.dL)(t);let{auth:s}=i.Z.state.knowledge;s||(s=await n.getAuthData()),n.toPointCoursePage({type:"detail",auth:s,id:e})}}},97927:(t,e,s)=>{s.d(e,{K:()=>n,z:()=>r});var a=s(57969),i=s(55595),o=s(49017);function r(){return""===this.aiCourseInfo.title?(this.$toast(a.Z.t("micro.aiCourse.titleRequired")),!1):this.aiCourseInfo.title.length>20?(this.$toast(a.Z.t("micro.aiCourse.titleMaxLength")),!1):""===this.aiCourseInfo.content?(this.$toast(a.Z.t("micro.aiCourse.contentRequired")),!1):this.aiCourseInfo.content.length<20?(this.$toast(a.Z.t("micro.aiCourse.contentMinLength")),!1):this.aiCourseInfo.content.length>1e3?(this.$toast(a.Z.t("micro.aiCourse.contentMaxLength")),!1):this.aiCourseInfo.classify_id&&""!==this.aiCourseInfo.classify_id&&""!==this.aiCourseInfo.classify_name?""!==this.aiCourseInfo.visible_count||(this.$toast(a.Z.t("micro.aiCourse.visibleRangeRequired")),!1):(this.$toast(a.Z.t("micro.aiCourse.classifyRequired")),!1)}async function n({status:t}){this.updateAiCourseAction({publishButtonDisable:!0});const e={id:this.aiCourseInfo.courseId,title:this.aiCourseInfo.title,summary:this.aiCourseInfo.summary,avatar:"",name:"",credit:this.aiCourseInfo.credit,cover:this.aiCourseInfo.cover,department_ids:this.aiCourseInfo.department_ids,user_ids:this.aiCourseInfo.user_ids,teacher_id:this.aiCourseInfo.teacher_id,teacher_name:this.aiCourseInfo.teacher_name,teacher_avatar:this.aiCourseInfo.teacher_avatar,course_classify:this.aiCourseInfo.classify_id,visible_count:this.aiCourseInfo.visible_count,course_classify_name:this.aiCourseInfo.classify_name,comment_count:0,like_count:0,has_praised:"unlike",resources:[{index:0,cover:"0",parameter:null,size:0,id:"",url:"",name:"",video_id:"",resource_id:"",duration:0,audios:[],ai_content:{ai_lecture_json:{background_url:this.aiCourseInfo.currentBackground.is_default?this.aiCourseInfo.currentBackground.default_enum:this.aiCourseInfo.currentBackground.url,font:{font_size:`${o.UY[this.aiCourseInfo.font_size_index]}px`,font_weight:this.aiCourseInfo.font_family,font_color:this.aiCourseInfo.font_color},sound:{voice:this.aiCourseInfo.currentVoice.default_enum,volume:"50",speech_rate:"0"},character_url:this.aiCourseInfo.currentPortrait.is_default?this.aiCourseInfo.currentPortrait.default_enum:this.aiCourseInfo.currentPortrait.url},content:this.aiCourseInfo.content}}],qy_we_chat_vo:"",user_list:[{}],sync_progress:this.aiCourseInfo.is_sync?1:0,sync_user_id:"",source_type:"",status:t||"draft",base_cover:this.aiCourseInfo.cover,cover_type:"1"},s=await i.Z.postAiCourse(e),{course:a}=s.data.data;return this.updateAiCourseAction({publishButtonDisable:!1,courseId:a[0].course_id}),s.data}},73306:(t,e,s)=>{s.d(e,{I:()=>n,P:()=>c});s(33948),s(60285),s(41637);var a=s(55595),i=s(5141),o=s(49017),r=s(27632);function n(t){r.Z.chooseImage({count:1,sourceType:["album","camera"],compressed:!1},(e=>{if("success"===e.status){const s=e.filePaths;"app"===r.Z.env?(this.$toast.loading({duration:0,message:this.$t("common.uploading"),loadingType:"spinner",forbidClick:!0}),i.Z.uploadImg(s[0]).then((e=>{t(e.url)})).finally((()=>{this.$toast.clear()}))):t(s[0])}}))}function c(t,e){this.$toast.loading({duration:0,message:this.$t("common.uploading"),loadingType:"spinner",forbidClick:!0}),this.confirmDisabled=!0,this.$refs.cropper.getCropBlob((async s=>{let i=await a.Z.postAiCourseImage(s);if(i.data.code!==o.Y.success)return this.$toast.clear(),this.$toast(i.data.message),void(this.confirmDisabled=!1);if(i.data.data.file_url){if(i=await a.Z.postAiCourseResource({config_type:t,url_list:[i.data.data.file_url]}),i.data.code!==o.Y.success)return this.$toast.clear(),this.$toast(i.data.message),void(this.confirmDisabled=!1);e(i.data.data[0])}URL.revokeObjectURL(this.sourceUrl),this.$emit("confirm"),this.$toast.clear()}),"image/jpeg")}},56767:(t,e,s)=>{s.d(e,{M:()=>r,x:()=>o});s(34837);var a=s(39146),i=(s(33948),s(60285),s(41637),s(16603));const o=({onUpdateSuccess:t=(()=>{}),onUploadFailed:e=(()=>{}),onUploadWarning:s=(()=>{})})=>new i.Z({onUploadWarning:({type:t,content:e})=>{console.warn(t,e),function(t,e){switch(a.Z.clear(),t){case"success":a.Z.success(e);break;case"warning":default:(0,a.Z)(e);break;case"error":a.Z.fail(e)}}(t,e),s(t,e)},onUploadSucceed:({uploadSucceedItem:e,choosedFiles:s})=>{t(e,s)},onUploadFailed:({fileId:t})=>{console.error("error",t),e()}});function r(t){return new Promise((e=>{window.URL=window.URL||window.webkitURL;const s=window.URL.createObjectURL(t),a=new Audio(s);try{a.addEventListener("loadedmetadata",(()=>{const{duration:t}=a;console.warn(t,"duration"),e(t)}))}catch(t){console.warn("getVideoDuration",t),e(0)}}))}},40848:(t,e,s)=>{s.d(e,{GA:()=>d,Xd:()=>h,ZP:()=>f,ix:()=>p,km:()=>m,qv:()=>o,v7:()=>i,wx:()=>v,yf:()=>u,zl:()=>g});var a=s(95969);const i={studyProject:"pageTitle.trainingProgram",studyTask:"pageTitle.studyDetail",questionnaire:"search.researchTask",newEmployeeTask:"guideBanner.newEmployeeTasks"},o={book:"https://oss.coolcollege.cn/1826609511331401728.png","non-book":"https://oss.coolcollege.cn/1826609511339790336.png"},r={studyProject:"studyProject",studyTask:"task",newEmployeeTask:"task"},n=(t,e)=>`/exam-instruction?examId=${t.resource_id||""}&taskId=${t.task_id||""}&pageSource=${r[e]||""}&pageSourceId=${t.planId||""}`,c=t=>`/exam-result?examId=${t.resource_id||""}&taskId=${t.task_id||""}`,l=()=>a.Z.resource.newExamList(),u=(t={},e={},s="")=>{const{can_exam:a,show_result:i,id:o,has_submited:r,exam_id:l}=t||{};if(i&&r)return c({resource_id:l,task_id:o});if(a){const t="studyProject"===s?e.course_id:e.id;return n({resource_id:l,task_id:o,planId:t},s)}return""},d={studyProject:{buttonText:"signIn.seeDetails",backToList:!1},studyTask:{buttonText:"signIn.seeDetails",backToList:!1},newEmployeeTask:{buttonText:"share.backList",backToList:!0},questionnaire:{buttonText:"share.backList",backToList:!0},exam:{buttonText:"share.backExamList",backToList:!0}},h={studyProject:{buttonText:"signIn.seeDetails",backToList:!1},studyTask:{buttonText:"share.backList",backToList:!0},questionnaire:{buttonText:"share.backList",backToList:!0}},p={questionnaire:"/research",studyTask:a.Z.home.studyList(),newEmployeeTask:a.Z.home.studyList(),exam:l()},m={studyProject:{offlineCourse:t=>a.Z.taskResource.latoja({courseId:t.resource_id,stageId:t.stage_id,studyId:t.course_id,from:"project"}),questionnaire:t=>a.Z.taskResource.researchDetail({investigateId:t.resource_id,questionnaireId:t.questionnaire_id,planId:t.course_id,studyType:"study_project",mapId:"",study_model:t.study_model,task_id:t.id}),exam:(t,e,s)=>u(t,e,s)},studyTask:{offlineCourse:t=>a.Z.taskResource.latoja({courseId:t.resource_id,stageId:t.stage_id,studyId:t.id,from:"task"}),questionnaire:t=>a.Z.taskResource.researchDetail({investigateId:t.resource_id,questionnaireId:t.questionnaire_id,planId:t.id,studyType:"study",mapId:"",study_model:"",task_id:t.id}),exam:(t,e,s)=>u(t,e,s)},newEmployeeTask:{exam:(t,e,s)=>u(t,e,s)},exam:{exam:(t,e,s)=>u(t,e,s)},questionnaire:{questionnaire:t=>a.Z.taskResource.researchDetail({investigateId:t.id,questionnaireId:t.questionnaire_id,planId:"",studyType:"",mapId:"",study_model:"",task_id:""})}},g={studyProject:t=>`${a.Z.studyProject.toStudyProject({studyProjectId:t.course_id})}`,studyTask:t=>`${a.Z.home.studyDetail({studyId:t.id,origin:"vue"})}`,newEmployeeTask:t=>`${a.Z.home.studyDetail({studyId:t.id,origin:"vue"})}`,questionnaire:t=>a.Z.taskResource.researchDetail({investigateId:t.resource_id,questionnaireId:t.questionnaire_id,planId:"",studyType:"",mapId:"",study_model:"",task_id:""}),exam:()=>l()},v={content:"share.faceOpen",showErrorMessage:!1,backToHome:!1,goToDetail:!0,bgName:"non-book"};function f(t={},{source:e,type:s}){const{show_result:a,has_submited:i,can_exam:o}=t,r=a&&i||o;return{"enterpriseapi.4001":{content:"share.resourceNotEXit",showErrorMessage:!1,backToHome:!0,goToDetail:!1,bgName:"book"},542032:{content:"share.resourceNotPublish",showErrorMessage:!1,backToHome:!0,goToDetail:!1,bgName:"book"},"enterpriseapi.542047":{content:"share.resourceNotPermission",showErrorMessage:!1,backToHome:!0,goToDetail:!1,bgName:"non-book"},542033:{content:"share.resourceHasNotStarted",showErrorMessage:!1,backToHome:!1,goToDetail:!0,bgName:"book",startTime:!0},542034:{content:"share.previousResourceLocked",showErrorMessage:!1,backToHome:!1,goToDetail:!0,bgName:"non-book"},542035:{content:"share.resourceHasEnded",showErrorMessage:!1,backToHome:!1,goToDetail:!0,bgName:"book",endTime:!0},542036:{showErrorMessage:!1,autoJumpToDetail:!0},542037:{showErrorMessage:!1,autoJumpToDetail:!0},542038:{content:"share.resourceNotEXit",showErrorMessage:!1,backToHome:!0,goToDetail:!1,bgName:"book"},542039:{content:"share.resourceNotPermission",showErrorMessage:!1,backToHome:!0,goToDetail:!1,bgName:"non-book"},542041:{content:"share.resourceHasNotStarted",showErrorMessage:!1,backToHome:!1,goToDetail:!0,bgName:"book",startTime:!0},542043:{content:"share.previousResourceLocked",showErrorMessage:!1,backToHome:!1,goToDetail:!0,bgName:"non-book"},542044:{content:"share.resourceNotPublish",showErrorMessage:!1,backToHome:!0,goToDetail:!1,bgName:"book"},542042:{content:"share.resourceHasEnded",showErrorMessage:!1,backToHome:!1,goToDetail:!0,bgName:"book",endTime:!0},542040:{showErrorMessage:!1,autoJumpToDetail:!0},"enterpriseapi.517004":{content:"share.resourceNotPublish",showErrorMessage:!1,backToHome:!0,goToDetail:!1,bgName:"book"},"enterpriseapi.517007":{content:"share.resourceNotPermission",showErrorMessage:!1,backToHome:!0,goToDetail:!1,bgName:"non-book"},"enterpriseapi.517003":{content:"share.resourceNotEXit",showErrorMessage:!1,backToHome:!0,goToDetail:!1,bgName:"book"},"enterpriseapi.517005":{content:"share.resourceHasNotStarted",showErrorMessage:!1,backToHome:!1,goToDetail:!1,bgName:"book",startTime:!0,showList:!0},"enterpriseapi.517006":{content:"share.resourceHasEnded",showErrorMessage:!1,backToHome:!1,goToDetail:!1,bgName:"book",endTime:!0,showList:!0},"enterpriseapi.517008":{content:"share.finishedResource",showErrorMessage:!1,backToHome:!1,goToDetail:!1,bgName:"non-book",showList:!0},542045:{content:"share.resourceHasNotStarted",showErrorMessage:!1,backToHome:!1,goToDetail:!1,bgName:"book",showList:!0,startTime:!0,isSpecial:!0},542046:{content:"share.taskHasEnded",showErrorMessage:!1,backToHome:!1,goToDetail:!1,bgName:"book",showList:!0,endTime:!0},600011:{content:"share.resourceHasNotStarted",showErrorMessage:!1,showList:"exam"===e&&"exam"===s,goToDetail:!("exam"===e&&"exam"===s),bgName:"book",startTime:!0,distinguishFace:!1,autoJumpToDetail:r},600012:{content:"share.taskHasEnded",showErrorMessage:!1,showList:"exam"===e&&"exam"===s,goToDetail:!("exam"===e&&"exam"===s),bgName:"book",endTime:!0,distinguishFace:!1,autoJumpToDetail:r},600014:{content:"share.complete",showErrorMessage:!1,showList:"exam"===e&&"exam"===s,goToDetail:!("exam"===e&&"exam"===s),backToHome:!1,bgName:"book",startTime:!1,distinguishFace:!1,autoJumpToDetail:r},600016:{content:"share.notIn",showErrorMessage:!1,showList:!0,goToDetail:!1,bgName:"book",endTime:!1,distinguishFace:!1},600001:{content:"share.taskCanceled",showErrorMessage:!1,showList:!0,goToDetail:!1,bgName:"book",endTime:!1,distinguishFace:!1},600006:{content:"share.markPending",showErrorMessage:!1,showList:!r&&"exam"===e&&"exam"===s,goToDetail:!(r||"exam"===e&&"exam"===s),bgName:"book",endTime:!1,distinguishFace:!1,autoJumpToDetail:r}}}},14027:(t,e,s)=>{s.d(e,{CR:()=>c,Tm:()=>n,bm:()=>o,iD:()=>l,le:()=>r,nR:()=>i});var a=s(57969);const i={latest:{src:`${ASSETS_OSS_HOST}/1820947227531677696.png`,shadow:"0px 2px 4px rgba(0, 0, 0, 0.1)",text:a.Z.t("examination.newRecord")},highest:{src:`${ASSETS_OSS_HOST}/1820951114263171072.png`,shadow:"0px 2px 4px rgba(110, 105, 8, 0.3)",text:a.Z.t("examination.topRecord")}},o={passed:{src:`${ASSETS_OSS_HOST}/1820965314314244096.png`,lightSrc:`${ASSETS_OSS_HOST}/1821167534683066368.png`,val:a.Z.t("examination.resultStatus.pass"),shadow:"0 0 8px rgba(66, 159, 75, 0.85)",text:a.Z.t("examination.scoreWordsPassed")},failed:{src:`${ASSETS_OSS_HOST}/1820965395209785344.png`,lightSrc:`${ASSETS_OSS_HOST}/1821167534683066368.png`,val:a.Z.t("examination.resultStatus.fail"),shadow:"0 0 8px rgba(192, 39, 37, 0.85)",text:a.Z.t("examination.scoreWordsFailed")},full:{src:`${ASSETS_OSS_HOST}/1820963903924998144.png`,lightSrc:`${ASSETS_OSS_HOST}/1821167534683066368.png`,val:a.Z.t("examination.resultStatus.full"),shadow:"0 0 8px #E2AD14",text:a.Z.t("examination.scoreWordsFull")},pending:{src:`${ASSETS_OSS_HOST}/1820951414323679232.png`,lightSrc:"",val:a.Z.t("examination.resultStatus.marking"),shadow:"transparent",text:a.Z.t("examination.scoreWordsPending")},submit:{src:`${ASSETS_OSS_HOST}/1820967438834077696.png`,lightSrc:`${ASSETS_OSS_HOST}/1821167534683066368.png`,shadow:"transparent",text:a.Z.t("examination.scoreWordsSubmit")}},r=[{title:a.Z.t("examination.scoringRate"),type:"score_rate",icon:"icon-defenshuai",val:"",units:"",color:"#516AE6"},{title:a.Z.t("examination.correctlyNumber"),type:"correct_count",icon:"icon-daduitimushu",val:"",units:a.Z.t("examination.questionsUnit"),color:"#6DD400"},{title:a.Z.t("examination.accuracy"),type:"correct_rate",icon:"icon-zhengqueshuai",val:"",units:"",color:"#40CBE0"},{title:a.Z.t("examination.answerTime"),type:"exam_time",icon:"icon-datishichang",val:"",units:"",color:"#C08564"},{title:a.Z.t("examination.bonusCredits"),type:"reward_rule_vo",icon:"icon-leijixuefen",val:"",units:a.Z.t("myRating.point"),color:"#FFA000"},{title:a.Z.t("examination.obtainCertificate"),type:"certificate_vo",icon:"icon-xingzhuangjiehe",val:"",units:"",color:"#9766CD"}],n={screenAuto:a.Z.t("examination.overScreenCount"),timeAuto:a.Z.t("examination.overTime"),durationAuto:a.Z.t("examination.overDuration"),600010:a.Z.t("examination.examHasSubmittedError"),600015:a.Z.t("examination.examTaskCanceledError")},c={600011:a.Z.t("examination.examNotStart"),600012:a.Z.t("examination.examIsEnding"),600010:a.Z.t("examination.examHasSubmittedError"),600009:a.Z.t("examination.examTaskStatusError"),600008:a.Z.t("examination.examSubmitInfoNotExistError"),600007:a.Z.t("examination.examLoadingError"),600006:a.Z.t("examination.examPendingError"),600005:a.Z.t("examination.examTaskNotExistError"),600004:a.Z.t("examination.examCountNotEnoughError"),600003:a.Z.t("examination.ExamInfoNotExistError"),600002:a.Z.t("examination.examRecordNotExistError"),600001:a.Z.t("examination.examTaskCanceledError"),600014:a.Z.t("examination.examCountFull"),600015:a.Z.t("examination.examTaskCanceledError"),600016:a.Z.t("examination.examTaskCanceledError"),600017:a.Z.t("examination.examSubmitNotExist"),600018:a.Z.t("examination.canNotExam"),400009:a.Z.t("examination.questionBankNotExist"),400049:a.Z.t("examination.questionFileParseFile")},l={single:a.Z.t("examination.single"),multiple:a.Z.t("examination.multiple"),fillBlank:a.Z.t("examination.blank"),trueOrFalse:a.Z.t("examination.tof"),shortAnswer:a.Z.t("examination.describe")};a.Z.t("examination.success"),a.Z.t("examination.error"),a.Z.t("examination.error")},65184:(t,e,s)=>{s.d(e,{NK:()=>a,_1:()=>o,_z:()=>i});s(74916),s(15306),s(27632);function a(t){return String.fromCharCode("A".codePointAt(0)+t)}const i=(t,e=[])=>{if(e.length){let s=t;return e.forEach((t=>{s="true"===t.result?s.replace(/\【.*?\】/,t.answer?` (<b>${t.answer}</b>) `:" (       ) "):"false"===t.result?s.replace(/\【.*?\】/,t.answer?` (<i>${t.answer}</i>) `:" (       ) "):s.replace(/\【.*?\】/,t.answer?` (<span>${t.answer}</span>) `:" (       ) ")})),s.replace(/\【.*?\】/g," (       ) ")}return t.replace(/\【.*?\】/g," (       ) ")},o=t=>{for(let e=0;e<t.length;e++)t[e]||(t[e]="");return t.join("").split("").length>0?t:[]}},87463:(t,e,s)=>{var a=s(20243),i=s(11046),o=s(28787);e.Z={beforeCreate(){const t=this.$route.query.enterpriseId||"";t&&o.Z.commit("saveUserInfo",{enterpriseId:t}),a.Z.getVisitorInfo({enterprise_id:t,page_id:this.$route.query.pageId||""}).then((t=>{"true"===t.data.open_visitor_page?(localStorage.setItem("domain",t.data.mobile_domain),o.Z.dispatch("setting/getHomePageDetail",{type:"visitor"})):(console.error("无权限访问游客页，重定向到登录页"),(0,i.rf)({flag:"login"}))})).catch((()=>{console.error("访问游客页出错，重定向到登录页"),(0,i.rf)({flag:"login"})}))}}}}]);