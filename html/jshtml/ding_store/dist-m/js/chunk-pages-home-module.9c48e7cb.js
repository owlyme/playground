"use strict";(self.webpackChunkvue_h5_template=self.webpackChunkvue_h5_template||[]).push([[156],{47478:(t,e,s)=>{s.r(e),s.d(e,{default:()=>v});s(31960);var a=s(10993),i=s(95082),n=(s(25773),s(35791)),o=(s(3791),s(93432)),r=(s(47601),s(44951)),l=(s(57658),s(6106)),c=s(26294),d=s(27632),m=s(4852),h=s(46009),u=s(45877),p=s(17563),g=s(22648),f={components:{[r.Z.name]:r.Z,[o.Z.name]:o.Z,[n.Z.name]:n.Z,Avatar:m.Z,ClCustomUser:u.Z},data:()=>({loading:!0,pageType:"",certificateImg:"",unauthorizedDetail:{},certificateDetail:{},PassImg:h}),computed:(0,i.Z)({},(0,c.mapGetters)({qyWechatBook:"setting/getQyWechatBook",userInfoVue:"user/getUserInfo"})),mounted(){this.checkCertificate()},methods:{async checkCertificate(){const{id:t}=this.$route.query;try{const{data:e}=await l.Z.checkCertificate(t);if(this.loading=!1,1===e.code)return void this.$toast.fail({message:this.$t("attestation.deletedAuthentication"),onClose:()=>{this.$router.go(-1)}});if(2===e.code&&null===e.data)return void this.$toast.fail({message:this.$t("attestation.deactivatedAuthentication"),onClose:()=>{this.$router.go(-1)}});100===e.data?this.getAuthenticatedDetail():this.getUnauthorizedDetail()}catch(t){this.loading=!1,this.$toast.fail(t.data)}},async getAuthenticatedDetail(){const{id:t}=this.$route.query;try{const{data:e}=await l.Z.getAuthenticatedDetail(t);null===e.id?(this.certificateImg="https://oss.coolcollege.cn/1790774478314278912.png",this.pageType="revokeImg"):(e.create_time=(0,g.p6)(e.create_time,"yyyy-MM-dd"),e.overdue_date=e.overdue_date?(0,g.p6)(e.overdue_date,"yyyy-MM-dd"):this.$t("evaluation.permanent"),this.certificateDetail=e,this.certificateImg=e.image_url,this.pageType="authorized")}catch(t){this.$toast.fail(t.data)}},async getUnauthorizedDetail(){const{id:t}=this.$route.query;try{const{data:e}=await l.Z.getUnauthorizedDetail(t);this.certificateDetail=e,this.pageType="unAuthorized"}catch(t){this.$toast.fail(t.data)}},preview(){if("authorized"!==this.pageType)return;const t="wx_app"===this.userInfoVue.appType&&this.qyWechatBook&&"9005"===this.userInfoVue.appId;if("dingTalk"===d.Z.env)d.Z.previewImage({urls:[this.certificateImg]});else if("h5"===d.Z.pureEnv&&t){const t={enterpriseId:this.userInfoVue.enterpriseId,certificateId:this.certificateDetail.id,accessToken:this.userInfoVue.accessToken,imageUrl:encodeURIComponent(this.certificateImg),from:"vue"},e=`${PUBLIC_H5}${ENTERPRISE_PATH}#/certificate?${p.stringify(t)}`;window.location.href=e}else(0,a.Z)({images:[this.certificateImg],showIndex:!1})},handleBtn(){if("unAuthorized"===this.pageType){const{id:t}=this.$route.query;this.$router.push(`/home-module/certification-detail?id=${t}`)}else this.preview()}}},v=(0,s(1001).Z)(f,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"certification-desc-container"},[s("van-loading",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"certificate-center"}),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}]},["unAuthorized"===t.pageType||"authorized"===t.pageType?s("div",{staticClass:"detail-container"},[s("div",{staticClass:"information-container"},[s("div",{staticClass:"information-header"},[s("div",{staticClass:"information-title"},[t._v(t._s(t.certificateDetail.title))]),s("div",{staticClass:"information-desc"},[t._v(t._s(t.certificateDetail.summary))])]),s("div",{staticClass:"information-content"},[s("div",{staticClass:"content-avatar"},[s("Avatar",{attrs:{src:t.certificateDetail.avatar,width:"42",height:"42"}})],1),s("div",{staticClass:"content-info"},[s("div",{staticClass:"content-info-userName"},[s("cl-custom-user",{attrs:{type:t.certificateDetail.sync_source_type,"data-type":"userName",value:t.certificateDetail.sync_user_id,name:t.certificateDetail.name||t.certificateDetail.user_name}})],1),"unAuthorized"===t.pageType?s("div",{staticClass:"content-info-progress"},[t._v(t._s(t.$t("attestation.attestationProgress"))+"："+t._s(t.certificateDetail.progress)+"%")]):t._e()])]),"unAuthorized"===t.pageType&&t.certificateDetail.qualification_user&&t.certificateDetail.qualification_user.length>0?s("div",{staticClass:"information-user"},[s("div",{staticClass:"user-tip"},[t._v(t._s(t.$t("attestation.latestAuthenticated")))]),s("div",{staticClass:"user-img-list"},t._l(t.certificateDetail.qualification_user,(function(e){return s("div",{key:e.id,staticClass:"img-item"},[e.avatar?s("Avatar",{attrs:{src:e.avatar,width:"24",height:"24"}}):t._e()],1)})),0)]):t._e(),"authorized"===t.pageType?s("div",{staticClass:"information-card"},[s("div",{staticClass:"information-code"},[s("div",{staticClass:"information-code-row"},[t._v(t._s(t.$t("attestation.certificateNumber"))+"： "+t._s(t.certificateDetail.certificate_code))]),s("div",{staticClass:"information-code-row"},[t._v(t._s(t.$t("attestation.issueDate"))+"： "+t._s(t.certificateDetail.create_time))]),s("div",{staticClass:"information-code-row"},[t._v(t._s(t.$t("attestation.validityPeriod"))+"： "+t._s(t.certificateDetail.overdue_date))])]),s("div",{staticClass:"information-img"},[s("van-image",{staticClass:"appraise-img",attrs:{src:t.PassImg}})],1)]):t._e()]),s("div",{staticClass:"detail-footer"},[s("van-button",{staticClass:"detail-footer-btn",attrs:{block:""},on:{click:t.handleBtn}},["unAuthorized"===t.pageType?s("span",[t._v(" "+t._s(0===t.certificateDetail.progress?t.$t("attestation.startAttestation"):t.$t("attestation.continueAttestation"))+" ")]):s("span",[t._v(t._s(t.$t("attestation.viewCertificate")))])])],1)]):t._e(),t.pageType&&"revokeImg"===t.pageType?s("div",{staticClass:"certificate-img-container",on:{click:t.preview}},[t.certificateImg?s("van-image",{staticClass:"certificate-img",attrs:{fit:"authorized"===t.pageType?"contain":"fill","lazy-load":"",src:t.certificateImg}}):s("div",[t._v(t._s(t.$t("attestation.generateCertificateError")))])],1):t._e()])],1)}),[],!1,null,"5d9326e2",null).exports},56519:(t,e,s)=>{s.r(e),s.d(e,{default:()=>_});var a=s(95082),i=(s(47238),s(75167)),n=(s(3791),s(93432)),o=s(26294),r=s(27632),l=s(6106),c=s(18715),d=s(4852),m=s(73641),h=s(60274),u=s(68915),p=s(45877),g=s(68092),f={name:"CertificationDetail",components:{[n.Z.name]:n.Z,[i.Z.name]:i.Z,Avatar:d.Z,Stages:m.Z,ClCustomUser:p.Z},data:()=>({query:{},loading:!0,details:{},hasShowPreventTip:!1,isHuaLaiShi:(0,g.UI)("PRIVACY_HLS_APPROVAL_MANAGE")}),computed:(0,a.Z)({themeColor(){return this.$store.state.themeColor}},(0,o.mapGetters)({fresh:"microCourse/getFreshStatus"})),watch:{fresh(t){t&&(this.refresh(),this.$store.commit("microCourse/updateFresh",!1))}},mounted(){"h5"===r.Z.env&&"1357169267530928217"===this.$store.state.commonParams.enterpriseId&&(localStorage.getItem("rongChengIsReload")?localStorage.removeItem("rongChengIsReload"):(localStorage.setItem("rongChengIsReload",!0),location.reload()))},activated(){const{id:t,originalPage:e="",mapId:s=""}=this.$route.query;this.query.id!==t&&(this.hasShowPreventTip=!1),this.query={id:t,originalPage:e,mapId:s},localStorage.setItem("studyingPostMapId",s),this.refresh()},methods:{refresh(){this.loading=!0,this.details={},this.loadData()},async loadData(){try{const{data:t}=this.isHuaLaiShi?await l.Z.getCustomCertificationDetails(this.query.id):await l.Z.getCertificationDetails(this.query.id);c.Z.loadStudyResource({},this.query.id);const e=(0,h.r)(t);this.loading=!1,this.details=e,e.integral_info&&setTimeout((()=>{this.$toast.success({message:e.integral_info,duration:3e3})}),500),"true"===e.include_audio&&this.showPreventHangModal()}catch(t){this.loading=!1,this.$toast.fail(t.data)}},showPreventHangModal(){if(this.hasShowPreventTip)return;const{showRandomWindow:t,preventHangSwitch:e}=this.$store.state.setting;(t||e)&&(this.hasShowPreventTip=!0,this.$dialog.confirm({title:this.$t("promptMessage.warmTips"),showCancelButton:!1,confirmButtonText:this.$t("promptMessage.roger"),message:t?this.$t("course.randomWindowTip"):this.$t("promptMessage.preventHangTips")}))},detailClick(t){const{canStudy:e,type:s,progress:a,status:i,resource_status:n,exam_plan_detail_v2:o,show_repeat_exam:r,show_result:l}=t;if(e)if("investigate"!==s||100!==a)if("transcoding"!==i&&"transcoding"!==n){if("newExam"===s){let t="absence"===o.exam_result||"unfinished"===o.exam_result;if((new Date).getTime()>Number(o.examEndTime)&&t)return void this.$toast(this.$t("promptMessage.overdueTask"));let e=t||"inProgress"===o.exam_result;if(o&&!l&&!r&&!e)return}u.Z.init(this.details,t,t.plan_id,this.query.mapId)}else this.$toast(this.$t("attestation.transcoding"));else this.$toast(this.$t("study.notAllowViewTips"));else this.$toast(this.$t("promptMessage.unlockPreviousTask"))}}},v=f,_=(0,s(1001).Z)(v,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"certificate-detail-container"},[t.loading?s("van-loading",{staticClass:"certificate-center"}):s("div",[s("div",{staticClass:"certification-details-header"},[s("div",{staticClass:"certification-details-title"},[t._v(t._s(t.details.title))]),s("div",{staticClass:"certification-details-info"},[s("div",{staticClass:"user-info"},[s("Avatar",{attrs:{src:t.details.avatar,width:"24",height:"24"}}),s("span",{staticClass:"user-name"},[s("cl-custom-user",{attrs:{type:t.details.sync_source_type,"data-type":"userName",value:t.details.sync_user_id,name:t.details.name}})],1)],1),s("div",{staticClass:"progress-label"},[t._v(t._s(t.$t("attestation.progress"))+t._s(t.details.progress)+"%")])]),s("van-progress",{attrs:{"show-pivot":!1,percentage:t.details.progress,"stroke-width":"20",color:t.themeColor.primaryColor,"track-color":"#EBECF3"}})],1),"true"===t.details.sync_progress?s("div",{staticClass:"sync-progress"},[t._v(t._s(t.$t("common.openSync")))]):t._e(),s("div",{staticClass:"certification-details-body"},[s("Stages",{attrs:{"data-info":t.details},on:{resourceOnTap:t.detailClick}})],1),s("div",{staticClass:"certification-details-end"},[t._v("END")])])],1)}),[],!1,null,"17ff4676",null).exports},55445:(t,e,s)=>{s.r(e),s.d(e,{default:()=>y});var a=s(95082),i=(s(70885),s(6458)),n=(s(82500),s(49414)),o=(s(82522),s(10342)),r=(s(86039),s(20495)),l=(s(20581),s(50914)),c=(s(49153),s(5944)),d=(s(69710),s(57609)),m=(s(18144),s(65641)),h=(s(33948),s(57658),s(26294)),u=s(6106),p=s(1001),g=(0,p.Z)({},(function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"certificate"},[t._t("default")],2)}),[],!1,null,"0f8f75ca",null).exports,f=s(78551),v={components:{[m.Z.name]:m.Z,[d.Z.name]:d.Z,[c.Z.name]:c.Z,[l.Z.name]:l.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[n.Z.name]:n.Z,[i.Z.name]:i.Z,Certificate:g,SvgIcon:f.Z},data:function(){return{activeTab:1,tabs:[{name:"1",lang:"attestation.uncertificated"},{name:"2",lang:"attestation.authenticated"}],list:[],loading:!1,finished:!1,params:{status:1,pageNumber:0,pageSize:10}}},computed:(0,a.Z)({},(0,h.mapGetters)({primaryColor:"getPrimaryColor"})),mounted(){this.$route.query.activeTab&&(this.activeTab=this.$route.query.activeTab),this.onRefresh()},methods:{onTabChange(){this.onRefresh()},onRefresh(){this.params=(0,a.Z)((0,a.Z)({},this.params),{},{status:this.activeTab,pageNumber:0}),this.loading=!0,this.finished=!1,this.list=[],this.loading&&this.onLoad()},async onLoad(){this.params.pageNumber+=1;const{data:t}=await u.Z.getQualifications((0,a.Z)({},this.params)),{list:e,hasNextPage:s}=t;this.list=[...this.list,...e],this.loading=!1,"false"===s&&(this.finished=!0)},toDetail(t){this.$router.push(`/home-module/certification-desc?id=${t}`)}}},_=v,y=(0,p.Z)(_,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"certification"},[s("van-tabs",{attrs:{color:t.primaryColor,"line-width":24,sticky:""},on:{change:t.onTabChange},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},t._l(t.tabs,(function(e){return s("van-tab",{key:e.name,attrs:{title:t.$t(e.lang),name:e.name}})})),1),s("van-divider",{style:{margin:"0"}}),s("van-list",{staticClass:"certification-list",attrs:{"loading-text":t.$t("common.loading"),finished:t.finished,"finished-text":t.finished&&0===t.list.length?"":t.$t("common.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[s("van-row",t._l(t.list,(function(e,a){return s("van-col",{key:e.id,staticStyle:{marginBottom:"16px"},attrs:{span:"12"}},[s("certificate",{style:{float:a%2==0?"left":"right"},nativeOn:{click:function(s){return t.toDetail(e.id)}}},[s("h4",{staticClass:"title"},[t._v(t._s(e.title))]),s("p",{staticClass:"status",style:{color:"1"===t.activeTab?"#7f849a":t.primaryColor}},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-tongguo",size:13,color:""+("1"===t.activeTab?"#7f849a":t.primaryColor)}}),t._v(" "+t._s("1"===t.activeTab?t.$t("attestation.uncertificated"):t.$t("attestation.authenticated"))+" ")],1),s("p",{staticClass:"progress"},[t._v(t._s(t.$t("attestation.attestationProgress"))+": "+t._s(e.progress)+"%")])])],1)})),1),t.finished&&0===t.list.length?s("van-empty",{attrs:{description:t.$t("common.noDataTextTip")}}):t._e()],1)],1)}),[],!1,null,"11850c75",null).exports},18805:(t,e,s)=>{s.d(e,{Z:()=>r});var a=s(95082),i=s(26294),n=s(27632),o={name:"DingGroup",components:{},data:function(){return{showAll:!1,ASSETS_OSS_HOST}},computed:(0,a.Z)({},(0,i.mapGetters)({pageFrom:"getPageFrom",userInfo:"user/getUserInfo"})),mounted(){window.addEventListener("click",this.clickOther)},beforeDestroy(){window.removeEventListener("click",this.clickOther)},methods:{handleClick(){this.showAll=!0},onServicesGroup(){const{corpId:t}=this.userInfo;n.Z.openLink({url:`https://page.dingtalk.com/wow/dingtalk/act/serviceconversation?ddtab=true&wh_biz=tm&showmenu=false&goodsCode=${CL_GOODS_CODE_APP}&corpId=${t}&token=${CL_COOL_SERVICES_TOKEN}`})},clickOther(t){this.showAll&&"ding-group_id-img"!==t.target.id&&(this.showAll=!1)}}},r=(0,s(1001).Z)(o,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return"dingPersonnel"===t.pageFrom?s("div",{staticClass:"home-ding-personnel"},[t.showAll?s("div",{staticClass:"home-ding-personnel-services",on:{click:t.onServicesGroup}},[s("img",{attrs:{id:"ding-group_id-img",src:t.ASSETS_OSS_HOST+"/1856117984125390848.png",alt:""}})]):s("div",{staticClass:"home-ding-personnel-services-half",on:{click:t.handleClick}},[s("img",{attrs:{src:t.ASSETS_OSS_HOST+"/1856117984125390848.png",alt:""}})])]):t._e()}),[],!1,null,"1ec13410",null).exports},95902:(t,e,s)=>{s.d(e,{Z:()=>o});s(73474);var a=s(74755),i=s(27632),n={name:"LearnCourse",components:{VanPopup:a.Z},data:function(){return{show:!0}},computed:{},mounted(){i.Z.hideLoading()},methods:{closeSkeleton(){this.show=!1}}},o=(0,s(1001).Z)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("van-popup",{style:{height:"100%"},attrs:{duration:0,"close-on-click-overlay":!1},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[s("div",{staticClass:"skeleton-content"},[s("div",{staticClass:"skeleton-header"},[s("div",{staticClass:"skeleton-header-search"}),s("div",{staticClass:"skeleton-header-banner"})]),s("div",{staticClass:"image-row"},t._l(new Array(5).fill("test"),(function(t,e){return s("div",{key:e,staticClass:"circle"},[s("div",{staticClass:"circle-item"}),s("div",{staticClass:"circle-item-text"})])})),0),s("div",{staticClass:"image-row"},t._l(new Array(5).fill("test"),(function(t,e){return s("div",{key:e,staticClass:"circle"},[s("div",{staticClass:"circle-item"}),s("div",{staticClass:"circle-item-text"})])})),0),s("div",{staticClass:"change-row"},[s("div",{staticClass:"btn"})]),s("div",{staticClass:"content-item"}),s("div",{staticClass:"content-space"},[s("div",{staticClass:"content-left"}),s("div",{staticClass:"content-right"})]),s("div",{staticClass:"content-image-text"},t._l(new Array(2).fill("test"),(function(t,e){return s("div",{key:e,staticClass:"content-image-content"},[s("div",{staticClass:"content-one"}),s("div",{staticClass:"content-two"}),s("div",{staticClass:"content-three"})])})),0)])])}),[],!1,null,"9e86cb56",null).exports},77217:(t,e,s)=>{s.d(e,{Z:()=>l});var a=s(95082),i=(s(25773),s(35791)),n=s(27632),o=s(26294),r={name:"InterceptPage",components:{[i.Z.name]:i.Z},data:function(){return{show:!0,ASSETS_OSS_HOST,loading:!1}},computed:(0,a.Z)({},(0,o.mapGetters)({primaryColor:"getPrimaryColor"})),mounted(){n.Z.hideLoading()},methods:{closeSkeleton(){this.show=!1},async fetchUserData(){try{this.loading=!0,await this.$store.dispatch("getBasePortalData",{isCurrentLimiting:"false"}),this.loading=!1}catch(t){this.loading=!1,this.$toast(this.$t("common.getUserInfoFail"))}}}},l=(0,s(1001).Z)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"intercept-page"},[s("img",{staticClass:"intercept-page-image",attrs:{src:t.ASSETS_OSS_HOST+"/1828761680004386816.png"}}),s("p",[t._v(t._s(t.$t("common.everyDay")))]),s("van-button",{staticClass:"btn",attrs:{type:"primary",loading:t.loading,color:t.primaryColor},on:{click:t.fetchUserData}},[t._v(" "+t._s(t.$t("promptMessage.immediatelyCheck"))+" ")])],1)}),[],!1,null,"3088fed2",null).exports},65317:(t,e,s)=>{s.r(e),s.d(e,{default:()=>y});var a=s(95082),i=(s(3791),s(93432)),n=(s(47601),s(44951)),o=(s(49153),s(5944)),r=(s(20581),s(50914)),l=(s(58052),s(68286)),c=(s(82500),s(49414)),d=(s(82522),s(10342)),m=(s(33948),s(26294)),h=s(27426),u=s(22648),p=s(95969),g=s(78368),f=s(56857),v={name:"ExamList",components:{Tab:d.Z,Tabs:c.Z,PullRefresh:l.Z,List:r.Z,Empty:o.Z,VanImage:n.Z,Loading:i.Z,ClUserName:f.Z},data:()=>({active:"",tabs:[{id:"all",name:""},{id:"unfinished",name:"unfinished"},{id:"finished",name:"finished"},{id:"absence",name:"absence"}],params:{status:"",keyword:"",page_number:1,page_size:20},list:[],isLoading:!0,loading:!1,finished:!1,refreshing:!1,defaultAvatar:g,scoreList:[]}),computed:(0,a.Z)({},(0,m.mapGetters)({primaryColor:"getPrimaryColor",env:"getEnv",isPure:"getIsPure",fresh:"microCourse/getFreshStatus"})),mounted(){this.getExamList()},methods:{onLoad(){this.refreshing?(this.isLoading=!0,this.list=[],this.refreshing=!1,this.params.page_number=1):this.params.page_number+=1,this.getExamList()},onRefresh(){this.finished=!1,this.loading=!0,setTimeout((()=>{this.onLoad()}),100)},async getExamList(){const{data:{code:t,data:{task_list:{has_next_page:e,list:s}},success:a}}=await h.tK.getExamList(this.params);"200000"===t&&"true"===a&&(this.list=[...this.list,...s],this.loading=!1,this.isLoading=!1,this.finished="false"===e)},onTabClick(){this.$refs.item0[0]&&this.$refs.item0[0].scrollIntoView(!0)},onTabChange(t){this.isLoading=!0,this.list=[],this.params.status=t,this.params.page_number=1,this.getExamList()},getStatus(t){let e="",s="";const{exam_result:a,status:i,show_result:n,total_score:o,score:r,begin_time:l,unlimited:c}=t;if("false"===n&&"finished"===i)return null;if("unfinished"===i)s="#2F61F6",e=this.$t("examination.wait"),"inProgress"===a&&(e=this.$t("examination.ongoing"));else if("absence"===i)s="#A6A6A6",e=this.$t("examination.absence");else if("finished"===i)if(o===r&&"pending"!==a)s="#69A4E7",e=this.$t("examination.full");else switch(a){case"passed":s="#44b975",e=this.$t("examination.pass");break;case"failed":s="#FF4D4F",e=this.$t("examination.fail");break;case"pending":s="#FF9F00",e=this.$t("examination.marking")}return l>(new Date).getTime()&&"false"===c&&(e=this.$t("examination.unStart")),{label:e,color:s}},enterExam(t){this.canEnter(t)&&("true"===t.show_result&&"finished"===t.status?p.Z.exam.enterExamData({examId:t.id,taskId:t.task_id,from:"data"}):p.Z.exam.enterExamInstruction({examId:t.id,taskId:t.task_id,from:"list"}))},handToExam(t){this.canEnter(t)&&p.Z.exam.enterExamInstruction({examId:t.id,taskId:t.task_id,from:"list"})},getDate(t){return"true"===t.unlimited?this.$t("examination.noLimitedDate"):(0,u.t6)(t.begin_time,t.end_time)},getExamButton(t){let e="";const{exam_result:s,repeat_exam:a,replenish_exam:i,status:n}=t;return"passed"===s&&"true"===a&&(e=this.$t("examination.reTest")),"failed"!==s||"true"!==a&&"true"!==i||("true"===a&&(e=this.$t("examination.reTest")),"true"===i&&(e=this.$t("examination.replenishExam"))),"pending"===s&&"true"===a&&(e=this.$t("examination.reTest")),"absence"===n&&"true"===i&&(e=this.$t("examination.replenishExamLabel")),"unfinished"===n&&(e=this.$t("examination.starTest")),e},canEnter:t=>"true"===t.show_result&&"finished"===t.status||"unfinished"===t.status||"true"===t.repeat_exam||"true"===t.replenish_exam}},_=v,y=(0,s(1001).Z)(_,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"exam-list-wrapper"},[s("Tabs",{staticClass:"micro-own-wrap-tabs",attrs:{sticky:"",swipeable:"",color:t.primaryColor,"line-width":24},on:{change:t.onTabChange,click:t.onTabClick},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},t._l(t.tabs,(function(e){return s("Tab",{key:e.id,attrs:{"title-class":"top-tab",name:e.name,title:t.$t("examination."+e.id)}},[t.isLoading?s("Loading",[t._v(t._s(t.$t("promptMessage.loading")))]):s("div",{staticClass:"exam-list"},[s("PullRefresh",{staticStyle:{"min-height":"100vh"},on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[t.list.length>0?s("list",{attrs:{"immediate-check":!1,finished:t.finished,"finished-text":t.$t("examination.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e,a){return s("div",{key:e.id,ref:"item"+a,refInFor:!0,staticClass:"list-item"},[s("div",{staticClass:"basic-info",on:{click:function(s){return t.enterExam(e)}}},[s("div",{staticClass:"title-section"},[s("p",{class:["van-multi-ellipsis--l2",t.canEnter(e)?"":"disable"]},[t._v(t._s(e.title))]),t.getStatus(e)?s("span",{staticClass:"exam-status"},[s("span",{staticClass:"pre-status",style:{backgroundColor:t.getStatus(e).color}}),t._v(" "+t._s(t.getStatus(e).label)+" ")]):t._e()]),s("span",{class:["score-section","finished"===e.status?"finished":""]},[s("span",{staticClass:"total-score score-item"},[t._v(" "+t._s(t.$t("mineScore.totalScores"))+"："),s("span",{staticClass:"score-value"},[t._v(t._s(e.total_score||"--"))])]),"finished"!==e.status&&e.award_score&&0!==e.award_score?s("span",{staticClass:"get-score score-item"},[t._v(" "+t._s(t.$t("approval.bonusScore"))+"："),s("span",{staticClass:"score-value"},[t._v(t._s(e.award_score))])]):t._e(),"finished"===e.status&&"true"===e.show_result&&"pending"!==e.exam_result?s("span",{staticClass:"award-score score-item"},[t._v(" "+t._s(t.$t("myRating.score"))+"："),s("span",{staticClass:"score-value"},[t._v(t._s(e.score))])]):t._e()]),s("div",{staticClass:"timer-section"},[t._v(" "+t._s(t.getDate(e))+" ")])]),s("div",{staticClass:"bottom-info"},[s("div",{staticClass:"per-info"},[s("VanImage",{attrs:{src:e.avatar||t.defaultAvatar,width:"20",height:"20",fit:"cover",round:""}}),s("div",[s("cl-user-name",{staticClass:"custom-title",attrs:{"user-id":e.create_user,"user-name":e.create_user_name}}),t._v(" "+t._s(t.$t("common.assign"))+" ")],1)],1),""!==t.getExamButton(e)?s("div",{staticClass:"opt-btn",on:{click:function(s){return t.handToExam(e)}}},[t._v(t._s(t.getExamButton(e)))]):t._e()])])})),0):t._e(),0!==t.list.length||t.refreshing?t._e():s("Empty",{attrs:{description:t.$t("common.noDataTextTip")}})],1)],1)],1)})),1)],1)}),[],!1,null,"4e7c06c8",null).exports},26321:(t,e,s)=>{s.r(e),s.d(e,{default:()=>i});var a={name:"FeedList",components:{Feed:s(15829).default},props:{},data:function(){return{}},computed:{},mounted(){},methods:{}},i=(0,s(1001).Z)(a,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"feed-page"},[e("Feed",{attrs:{"show-all-data":""}})],1)}),[],!1,null,"9ad0288a",null).exports},98520:(t,e,s)=>{s.r(e),s.d(e,{default:()=>G});var a=s(95082),i=(s(74916),s(15306),s(26294)),n=s(27632),o=s(93437),r=s(19978),l=s(96646),c=s(28497),d=s(28387),m=s(22648),h=(s(57658),s(30541),s(51527));const u={banner:"banner",graphicNavigation:"graphic-nav",enterpriseNotice:"notice",myTasks:"task",search:"search",creditsRankings:"ranking",pointsMall:"points-mall",lecturers:"lecturers",customModule:"custom-module",newsFeed:"feed",community:"community",micro:"micro",SysLearningPath:"sys-learning-path",course:"course",boutiquecourse:"boutique-course"};var p={name:"HomeOld",components:{BottomTarbar:h.Z},data:()=>({active:"homePage",componentData:[]}),computed:(0,a.Z)({},(0,i.mapGetters)({homeSetting:"setting/getHomeSetting",primaryColor:"getPrimaryColor",pageFrom:"getPageFrom"})),watch:{homeSetting:{handler(t){this.initHomeSetting(t)},deep:!0}},mounted(){this.initHomeSetting(this.homeSetting),(0,m.vk)(this.primaryColor)},methods:{initHomeSetting(t){let e=[];t.forEach((t=>{t.checked&&u[t.key]&&e.push({app:s(86066)(`./${u[t.key]}`).default,models:t,key:t.key,id:t.id})})),e.unshift({app:s(86066)(`./${u.search}`).default,key:"search"}),this.componentData=e}}},g=s(1001),f=(0,g.Z)(p,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t._l(t.componentData,(function(t){return s(t.app,{key:t.id,tag:"component",attrs:{models:t.models||{},"is-old":!0}})})),s("BottomTarbar",{attrs:{active:t.active}})],2)}),[],!1,null,"ee040ece",null).exports,v=(s(25773),s(35791)),_=s(74074),y=(s(25946),{name:"DingTalkTip",components:{Button:v.Z},props:{tipsText:{type:String,default:""},btnText:{type:String,default:""},type:{type:String,default:""}},computed:(0,a.Z)({},(0,i.mapGetters)({primaryColor:"getPrimaryColor",userInfo:"user/getUserInfo"})),methods:{handleEvent(){switch(this.type){case"personalVersion":(0,_.pd)({id:E_APP_ID,corpId:this.userInfo.mainCorpId}).catch((t=>{console.error(t)}));break;case"freeSpecifications":n.Z.openLink({url:"http://h5.dingtalk.com/open-purchase/mobileUrl.html?redirectUrl=https%3A%2F%2Fh5.dingtalk.com%2Fopen-market%2Fshare.html%3FshareGoodsCode%3DAADDC36E1A6481001C305D0B215B272491DB0B8B6FAAFE8434F72D97F3D3A9FB608BAD1C2A09D307%26token%3D938928f41c76e81e25a36d451671b61b%26shareUid%3D6BA16720285C2196A2D58853D5063F3D&dtaction=os"})}}}}),C=(0,g.Z)(y,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ding-talk-tips-wrap"},[s("div",{staticClass:"tip-text-wrap"},[s("div",{staticClass:"tip-text-icon"},[s("SvgIcon",{attrs:{"icon-class":"icon-xiaoxi",size:22,color:t.primaryColor}})],1),s("div",{staticClass:"tip-text",style:{color:t.primaryColor}},[t._v(" "+t._s(t.tipsText)+" ")])]),s("Button",{staticClass:"contact-manage-btn",attrs:{size:"mini",type:"primary",color:t.primaryColor},on:{click:t.handleEvent}},[t._v(" "+t._s(t.btnText)+" ")])],1)}),[],!1,null,"bc368128",null).exports,k=(s(47601),s(44951)),b=s(25295),$=s(95969),T={name:"LearnCourse",components:{VanImage:k.Z},data:function(){return{show:!1,courseInfo:{}}},computed:(0,a.Z)({},(0,i.mapGetters)({primaryColor:"getPrimaryColor",userInfo:"user/getUserInfo"})),mounted(){this.showLearningCourse()},methods:{showLearningCourse(){const t=window.localStorage.getItem("showCourseDetail");if(t){JSON.parse(t).enterpriseId===this.$store.state.commonParams.enterpriseId?(this.show=!0,this.courseInfo=JSON.parse(t)):(this.show=!1,this.courseInfo={},window.localStorage.removeItem("showCourseDetail"),this.$emit("nextModal"))}else this.$emit("nextModal")},closeFloatingCourse(){window.localStorage.removeItem("showCourseDetail"),this.show=!1,this.$emit("nextModal")},playFloatingCourse(){const{courseSource:t,courseId:e}=this.courseInfo;if(b.Z.addScanCount({id:e}),"microCourse"===t||"microVideoCourse"===t){const t=`/pages/common-webview/index?type=watchMicroCourse&courseId=${e}&studyType=other`;n.Z.navigateTo({url:t})}else this.$router.push($.Z.course.commonCourse(this.courseInfo))}}},x=(0,g.Z)(T,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.show?s("div",{staticClass:"suspend_course"},[s("VanImage",{staticClass:"close",attrs:{src:"https://oss.coolcollege.cn/1790235063502376960.png",fit:"fill"},on:{click:t.closeFloatingCourse}}),s("div",{staticClass:"info",on:{click:t.playFloatingCourse}},[s("VanImage",{staticClass:"info-image",attrs:{src:t.courseInfo.courseCover,fit:"fill"}}),s("span",{staticClass:"info-text"},[t._v(t._s(t.courseInfo.courseTitle))])],1),s("VanImage",{staticClass:"player",attrs:{src:"https://oss.coolcollege.cn/1790235060809633792.png",fit:"fill"},on:{click:t.playFloatingCourse}})],1):t._e()}),[],!1,null,"4e6dd1be",null).exports,Z=(s(22894),s(83608)),w=(s(23307),s(81392)),S=(s(73474),s(74755)),L=(s(29941),s(64168)),I=(s(93787),s(20090)),R=(s(77141),s(30960)),P=(s(31930),s(94907)),D=(s(77601),s(73210),s(6106)),E={name:"FSReversed",components:{Overlay:P.Z,VanImage:k.Z,Form:R.Z,Field:I.Z,CellGroup:L.Z,Popup:S.Z,Button:v.Z,Icon:w.Z,Picker:Z.Z},data:function(){return{step:1,show:!1,enterprise_name:"",investigate_num:"",phone:"",code:"",showPicker:!1,coList:[{text:"100以下",value:"100以下"},{text:"100-500",value:"100-500"},{text:"500以上",value:"500以上"}],pattern:/^(13[0-9]|14[014-9]|15[0-35-9]|16[25-7]|17[0-8]|18[0-9]|19[0-35-9])[0-9]{8}$/,showTime:!1,time:60,enterpriseName:""}},computed:(0,a.Z)((0,a.Z)({},(0,i.mapGetters)({userInfo:"user/getUserInfo"})),{},{isCanUseCode(){return 0===this.phone.length||!this.pattern.test(this.phone)}}),mounted(){this.isShowReservedCapital()},beforeDestroy(){clearInterval(this.timer)},methods:{async isShowReservedCapital(){var t;const e=null===(t=(await D.Z.getEnterpriseWhiteAndBlackList()).data)||void 0===t?void 0:t.CLOSE_FORCE_LEAVE_INFOCLOSE_FORC;if(e&&e.type&&"white"===e.type.toLowerCase())return this.show=!1,void this.$emit("nextModal");const{userId:s}=this.userInfo,a={userId:s},{data:i}=await D.Z.getReservedCapital(a);if("true"===i.pop){const{enterprise_name:t}=i;this.show=!0,this.enterpriseName=t||"",this.enterprise_name=t,window.sensors&&window.sensors.track("acquisitionPopup_enter_click")}else this.show=!1,this.$emit("nextModal")},handleCancel(){this.$emit("nextModal"),this.show=!1,3===this.step?window.sensors&&window.sensors.track("receiveSuccessPopup_close_click"):window.sensors&&window.sensors.track("acquisitionPopup_close_click")},handleFreeGet(){this.step=2},handleNextStep(){this.$refs.formData.submit()},async handleSend(){const t={phone:this.phone},{data:e}=await D.Z.getPhoneMessage(t);2e4===e.code&&(this.showTime=!0,this.timer=setInterval((()=>{0===this.time?(clearInterval(this.timer),this.showTime=!1,this.time=60):this.time-=1}),1e3))},async submit(t){const{userId:e}=this.userInfo,s=(0,a.Z)({},t);try{const{data:t}=await D.Z.postSubmitReversed(e,s);"true"===t.submited&&(this.step=3)}catch(t){const{data:{code:e}}=t;"platformapi.521010"===e&&this.$toast({message:this.$t("reversed.codeInvalid"),position:"top",className:"tips-layer"})}window.sensors&&window.sensors.track("informationPopup_submit_click",{marketing_enterprise_name:t.enterprise_name,marketing_enterprise_scale:t.investigate_num,marketing_admin_phone:t.phone})},onConfirm(t){this.investigate_num=t.text,this.showPicker=!1},handleScan(){this.show=!1,this.$router.push({path:"/knowledge"}),window.sensors&&window.sensors.track("receiveSuccessPopup_check_click")},validatorMax:t=>!(t.length>50),validatorSpace:t=>!(0===t.trim().length)}},M=(0,g.Z)(E,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Overlay",{staticClass:"fs_reversed_container",attrs:{show:t.show}},[1===t.step?s("div",{staticClass:"fs_reversed_step1"},[s("VanImage",{staticClass:"img_bg",attrs:{"lazy-load":"",src:"https://oss.coolcollege.cn/1836313243761643520.png".ossimg(),fit:"fill"}}),s("VanImage",{staticClass:"img_bg_btn",attrs:{"lazy-load":"",src:"https://oss.coolcollege.cn/1836312821416202240.png".ossimg(),fit:"fill"},on:{click:t.handleFreeGet}}),s("Icon",{staticClass:"img_bg_icon",attrs:{name:"cross",size:"40"},on:{click:t.handleCancel}})],1):t._e(),2===t.step?s("div",{staticClass:"fs_reversed_step2"},[2===t.step?s("VanImage",{staticClass:"img_top",attrs:{"lazy-load":"",src:"https://oss.coolcollege.cn/1836315481624154112.png".ossimg(),fit:"fill"}}):t._e(),s("Icon",{staticClass:"img_bg_icon",attrs:{name:"cross",size:"40"},on:{click:t.handleCancel}}),s("Form",{ref:"formData",staticClass:"fs_reversed_step2_form",on:{submit:t.submit}},[s("CellGroup",{attrs:{inset:""}},[s("Field",{staticClass:"enterprise_name_input",attrs:{name:"enterprise_name",label:"",placeholder:t.$t("reversed.pleaseInputEName"),border:"",disabled:t.enterpriseName.length>0,rules:[{required:!0,message:t.$t("reversed.pleaseInputEName")},{validator:t.validatorMax,message:t.$t("reversed.cmpNameLimit")},{validator:t.validatorSpace,message:t.$t("reversed.pleaseWholeCName")}]},model:{value:t.enterprise_name,callback:function(e){t.enterprise_name=e},expression:"enterprise_name"}}),s("Field",{attrs:{name:"investigate_num","is-link":"",readonly:"",label:"",placeholder:t.$t("reversed.pleaseInputENum"),border:"",rules:[{required:!0,message:t.$t("reversed.pleaseInputENum")}]},on:{click:function(e){t.showPicker=!0}},model:{value:t.investigate_num,callback:function(e){t.investigate_num=e},expression:"investigate_num"}}),s("Field",{attrs:{name:"phone",label:"",placeholder:t.$t("reversed.pleaseInputPhone"),border:"",type:"number",maxlength:"11",rules:[{required:!0,message:t.$t("reversed.pleaseInputPhone")},{pattern:t.pattern,message:t.$t("reversed.pleaseCorrectPhone")}]},model:{value:t.phone,callback:function(e){t.phone=e},expression:"phone"}}),s("Field",{attrs:{name:"code",label:"",placeholder:t.$t("reversed.pleaseInputCode"),border:"",type:"number",maxlength:"6",disabled:t.isCanUseCode,rules:[{required:!0,message:t.$t("reversed.pleaseInputCode")}]},scopedSlots:t._u([{key:"button",fn:function(){return[t.isCanUseCode?s("Button",{attrs:{size:"small","native-type":"button",round:"",color:"#B76A49",plain:"",disabled:""}},[t._v("获取验证码")]):t.showTime?s("Button",{staticClass:"code_btn1",attrs:{size:"small","native-type":"button",round:"",color:"#B76A49",plain:"",disabled:""}},[t._v(t._s(t.time))]):s("Button",{staticClass:"code_btn",attrs:{size:"small",round:"","native-type":"button"},on:{click:t.handleSend}},[t._v("获取验证码")])]},proxy:!0}],null,!1,1732166824),model:{value:t.code,callback:function(e){t.code=e},expression:"code"}})],1),s("VanImage",{staticClass:"img_top_btn",attrs:{"lazy-load":"",src:"https://oss.coolcollege.cn/1836317874747215872.png".ossimg(),fit:"fill"},on:{click:t.handleNextStep}})],1)],1):t._e(),3===t.step?s("div",{staticClass:"fs_reversed_step3"},[s("VanImage",{staticClass:"img_bg",attrs:{"lazy-load":"",src:"https://oss.coolcollege.cn/1836317463160164352.png".ossimg(),fit:"fill"}}),s("VanImage",{staticClass:"img_bg_btn",attrs:{"lazy-load":"",src:"https://oss.coolcollege.cn/1830206623277256704.png".ossimg(),fit:"fill"},on:{click:t.handleScan}}),s("Icon",{staticClass:"img_bg_icon",attrs:{name:"cross",size:"40"},on:{click:t.handleCancel}})],1):t._e(),s("Popup",{attrs:{position:"bottom"},model:{value:t.showPicker,callback:function(e){t.showPicker=e},expression:"showPicker"}},[s("Picker",{attrs:{"show-toolbar":"",columns:t.coList},on:{confirm:t.onConfirm,cancel:function(e){t.showPicker=!1}}})],1)],1)}),[],!1,null,"5cb5e892",null).exports,N={name:"HomeModule",components:{SignIn:o.default,CommonRender:c.Z,HomeOld:f,DingTalkTip:C,LearnCourse:x,UpdateVersion:l.default,FirstGuide:r.default,FSReversed:M},beforeRouteLeave(t,e,s){(0,m.vk)("#FFFFFF"),s()},data:function(){return{dialogType:"versionUpdate"}},computed:(0,a.Z)((0,a.Z)({refreshFocus(){return this.$store.state.homeModule.refreshFocus}},(0,i.mapGetters)({selectPortal:"setting/getSelectPortal",customHomeComponent:"setting/getCustomHomeComponent",qyWechatBook:"setting/getQyWechatBook",userInfo:"user/getUserInfo",needUpdateVersion:"getNeedUpdateVersion"})),{},{showFreeTip(){const{isOriginVip:t,isAdmin:e}=this.userInfo;return"dingTalk"===n.Z.env&&e&&8===t},showPersionalTip(){const{mainCorpId:t}=this.userInfo;return"dingTalk"===n.Z.env&&t},showUpdate(){const{isAdmin:t}=this.userInfo;return"versionUpdate"===this.dialogType&&t}}),watch:{selectPortal(){(0,m.Td)(this.selectPortal.name||this.userInfo.enterpriseName)}},async mounted(){(0,m.Td)(this.selectPortal.name||this.userInfo.enterpriseName),this.needUpdateVersion&&await this.$store.dispatch("getEnterpriseVersion",{userId:this.userInfo.userId}),this.refreshFocus||this.getHomeForce()},beforeDestroy(){(0,m.vk)("#FFFFFF"),this.driver&&(this.driver=null)},methods:{async getHomeForce(){try{"true"===(await d.Z.getHomeForce()).data.force_fill&&this.$router.replace({path:"/mine-info?fromHome=home"}),this.$store.commit("homeModule/refreshFocus",!0)}catch(t){}},handleRefreshRedirect(){const t=localStorage.getItem("fullPath");t&&-1===t.indexOf("home-module")&&(localStorage.setItem("showHomeLink",!0),this.$router.replace(t))}}},G=(0,g.Z)(N,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"home-module",attrs:{id:"homeModule"}},[t.showFreeTip?s("DingTalkTip",{attrs:{type:"freeSpecifications","tips-text":t.$t("home.upgradeTipsText"),"btn-text":t.$t("home.upgradeBtnText")}}):t._e(),t.showPersionalTip?s("DingTalkTip",{attrs:{type:"personalVersion","tips-text":t.$t("home.contractAdminTips"),"btn-text":t.$t("home.contractAdmin")}}):t._e(),t.selectPortal&&"true"===t.selectPortal.is_new_version?s("CommonRender",{attrs:{type:"homePage","is-render":!0,data:t.customHomeComponent}}):s("HomeOld"),"versionUpdate"===t.dialogType?s("UpdateVersion",{on:{nextModal:function(e){t.dialogType="fsReverse"}}}):t._e(),"fsReverse"===t.dialogType?s("FSReversed",{on:{nextModal:function(e){t.dialogType="learnCourse"}}}):t._e(),"learnCourse"===t.dialogType?s("LearnCourse",{on:{nextModal:function(e){t.dialogType="firstGuide"}}}):t._e(),"firstGuide"===t.dialogType?s("FirstGuide",{attrs:{"show-guide":!0},on:{nextModal:function(e){t.dialogType="signIn"}}}):t._e(),"signIn"===t.dialogType?s("SignIn"):t._e()],1)}),[],!1,null,"3e5f742c",null).exports},81155:(t,e,s)=>{s.r(e),s.d(e,{default:()=>G});var a=s(95082),i=(s(21790),s(24031)),n=(s(82500),s(49414)),o=(s(82522),s(10342)),r=(s(39610),s(2163)),l=(s(86039),s(20495)),c=(s(70885),s(6458)),d=(s(20581),s(50914)),m=(s(47601),s(44951)),h=(s(23307),s(81392)),u=(s(69710),s(57609)),p=(s(18144),s(65641)),g=(s(52355),s(29233)),f=(s(26699),s(33948),s(26294)),v=s(2068),_=s(4852),y=s(85384),C=(s(25773),s(35791)),k=s(27632),b=s(25295),$=s(22648),T=s(52196),x=s(7294),Z=s(26325),w={components:{[C.Z.name]:C.Z,[g.Z.name]:g.Z,[m.Z.name]:m.Z,[p.Z.name]:p.Z,[c.Z.name]:c.Z,[h.Z.name]:h.Z},props:{item:{type:Object,default:()=>{}},isCoursesLecturer:{type:Boolean,default:!1}},methods:{timestampToTime:t=>(0,$.p6)(t,"yyyy.MM.dd hh:mm"),courseDetail(t){if("true"===t.is_visible){if(8===t.biz_type||9===t.biz_type)return void("expired"===t.live_status?this.$toast({type:"text",message:this.$t("ddLive.liveClassEnd"),duration:3e3}):"poly_wei"===t.live_type?(0,x.K7)(t.id,t.live_status):9===t.biz_type?(0,x.CS)(t.id,t.live_status):(0,x.It)(t.id));"study_project"!==t.course_type&&"image_text"!==t.course_type||(t.course_type="course"),(0,T.f2)({courseData:t})}else this.$toast(this.$t("lecturer.noRightView"))},startLive(t){"poly_wei"===t.live_type?this.isTeacher(t):9===t.biz_type?(0,x.g3)(t.id,(()=>{this.$emit("refresh")})):"dingTalk"===k.Z.env?this.isTeacher(t):this.$toast({type:"text",message:this.$t("ddLive.tip"),duration:3e3})},async isTeacher(t){const{data:e}=await b.Z.getLiveCheckCourseAnchor({courseId:t.id});e.data.isCourseAnchor?"poly_wei"===t.live_type?(0,x.Vo)(t.id):(0,Z.default)({url:t.live_link}):this.$toast({type:"text",message:this.$t("ddLive.anchorInfo"),duration:3e3})}}},S=s(1001),L=(0,S.Z)(w,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("van-row",{staticClass:"home-lecturer-card",on:{click:function(e){return t.courseDetail(t.item)}}},[s("van-col",{attrs:{span:"10"}},[s("van-image",{staticClass:"cover",attrs:{src:t.item.cover}})],1),s("van-col",{staticClass:"course-text",attrs:{span:"13",offset:"1"}},[s("p",{staticClass:"title van-multi-ellipsis--l2"},[t._v(t._s(t.item.title))]),!t.isCoursesLecturer||8!==t.item.biz_type&&9!==t.item.biz_type||"prepartion"!==t.item.live_status&&"live"!==t.item.live_status&&"expired"!==t.item.live_status?[s("p",{staticClass:"count"},[s("van-icon",{staticClass:"eye",attrs:{name:"eye",color:"#D1D2D6",size:18}}),s("span",[t._v(t._s(t.item.play_count))])],1),s("ul",{staticClass:"star"},t._l(t.item.score,(function(t){return s("li",{key:t},[s("van-icon",{attrs:{name:"star",color:"#3751D9",size:16}})],1)})),0)]:[s("div",{staticClass:"text"},[s("van-icon",{attrs:{name:"clock-o",size:"10"}}),s("span",[t._v(" "+t._s(t.timestampToTime(Number(t.item.start_time))))])],1),"prepartion"===t.item.live_status?s("van-button",{staticClass:"live-btn",attrs:{type:"primary",size:"mini"},on:{click:function(e){return e.stopPropagation(),t.startLive(t.item)}}},[t._v(" "+t._s(t.$t(8===t.item.biz_type?"ddLive.startLive":"ddLive.startConference"))+" ")]):t._e()]],2)],1)}),[],!1,null,"411c44ae",null).exports,I=(s(31146),s(41610)),R=(s(28301),s(45644)),P=(s(57658),{components:{[C.Z.name]:C.Z,[R.Z.name]:R.Z,[h.Z.name]:h.Z,[m.Z.name]:m.Z,[I.Z.name]:I.Z},props:{info:{type:Array,default:()=>{}},lectureId:{type:String,default:""}},data:()=>({show:!1,activeObj:{},attachmentList:[]}),computed:{themeColor(){return this.$store.state.themeColor},getInfo(){return this.info}},methods:{timestampToTime:t=>(0,$.p6)(t,"yyyy.MM.dd hh:mm"),buttonClick(t,e,s){"reject"===t&&I.Z.confirm({message:`${this.$t("offline.confirmRefused")}`,confirmButtonColor:"red"}).then((()=>{const{course_id:t}=e.summary;v.Z.lecturerRefuse(t).then((()=>{this.$toast.success(this.$t("minePoints.reject")),this.getInfo[s].lecturer_status="rejected"}))})).catch((()=>{})),"grade"===t&&this.$router.push(`/examine-grade/${e.id}?passing_score=${e.config.assessment_pass_score}&total_score=${e.config.assessment_total_score}`),"evalute"===t&&this.evalute(e),"upload"===t&&this.$router.push(`/home-module/lecturer-upload?activity_attachment_id=${e.summary.activity_attachment_id}`)},evalute(t){this.$router.push(`/my-rating-student/${t.id}?evaluate_id=${t.config.evaluate_rule_vo.evaluate_id}&evaluate_type=${t.config.evaluate_rule_vo.evaluate_type}&activeTab=0&is_evaluated=false&status=${t.status}`)},rejectGive:t=>t.begin_time<(new Date).getTime()||"rejected"===t.lecturer_status,buttonVisible(t){if(t.is_lecturer_confirm)return!0;if(t.config){if(t.config.is_open_upload||t.config.is_open_offline_assessment)return!0;if(t.config.lecturer_student_evaluate&&t.lecturer_id===this.lectureId)return!0}return!1}}}),D=(0,S.Z)(P,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"home-offlecture"},t._l(t.getInfo,(function(e,a){return s("div",{key:a.toString(),staticClass:"home-offlecture-card"},[s("div",{staticClass:"info"},[s("van-image",{attrs:{src:e.cover||"https://oss.coolcollege.cn/1818197339236601856.png"}}),s("div",{staticClass:"info-text"},[s("div",{staticClass:"title van-multi-ellipsis--l2"},[t._v(t._s(e.title))]),e?s("div",{staticClass:"text"},[s("van-icon",{attrs:{name:"clock-o",size:"10"}}),s("span",[t._v(" "+t._s(t.timestampToTime(Number(e.begin_time))+"~"+t.timestampToTime(Number(e.end_time))))])],1):t._e(),e?s("div",{staticClass:"text "},[s("van-icon",{attrs:{name:"location-o"}}),s("span",{staticClass:"van-multi-ellipsis--l2"},[t._v(t._s(t.$t("common.address")+"："+e.address))])],1):t._e()])],1),t.buttonVisible(e)?s("div",{staticClass:"footer"},[e.is_lecturer_confirm?s("div",{staticClass:"footer-reject"},[s("van-button",{class:t.rejectGive(e)?"font-gray":"font-red",attrs:{size:"mini",plain:"",disabled:t.rejectGive(e)},on:{click:function(s){return t.buttonClick("reject",e,a)}}},[t._v(t._s(t.$t("offline.Refuse")))])],1):t._e(),s("div",{staticClass:"footer-opeart"},[e.config&&e.config.is_open_upload?s("van-button",{attrs:{type:"default",size:"mini",plain:"",hairline:""},on:{click:function(s){return t.buttonClick("upload",e)}}},[s("div",{staticClass:"button"},[t._v(t._s(t.$t("pageTitle.lecturerUpload")))])]):t._e(),e.config&&e.config.is_open_offline_assessment?s("van-button",{attrs:{type:"default",size:"mini",plain:"",hairline:""},on:{click:function(s){return t.buttonClick("grade",e)}}},[s("div",{staticClass:"button"},[t._v(t._s(t.$t("offline.grade")))])]):t._e(),e.config&&e.config.lecturer_student_evaluate&&e.lecturer_id===t.lectureId?s("van-button",{attrs:{type:"default",size:"mini",plain:"",hairline:""},on:{click:function(s){return t.buttonClick("evalute",e)}}},[s("div",{staticClass:"button"},[t._v(t._s(t.$t("myRating.evaluateStudent")))])]):t._e()],1)]):t._e()])})),0)}),[],!1,null,"abe8be2a",null).exports,E=s(45877),M={name:"LecturerDetail",components:{[g.Z.name]:g.Z,[p.Z.name]:p.Z,[u.Z.name]:u.Z,[h.Z.name]:h.Z,[m.Z.name]:m.Z,[d.Z.name]:d.Z,[c.Z.name]:c.Z,[l.Z.name]:l.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[n.Z.name]:n.Z,[i.Z.name]:i.Z,avatar:_.Z,OverlayLoading:y.Z,Lecture:L,offLineList:D,ClCustomUser:E.Z},beforeRouteLeave(t,e,s){if(["/mine","/home-module","/home-module/lecturer","/home-module/search-result","/course-enterprise-detail"].includes(t.path)?(e.meta.keepAlive=!1,this.$store.commit("noKeepAlive","LecturerDetail")):(e.meta.keepAlive=!0,this.$store.commit("isKeepAlive","LecturerDetail")),e.meta.keepAlive){const t=document.querySelector("#lecturer-detail"),s=t?t.scrollTop:0;e.meta.scrollTop=s}s()},data(){return{tabList:[{title:"home.Course",name:"other_course",count:0},{title:this.$store.state.commonParams.isDingCompany?"ddLive.liveCourse":"ddLive.live",name:"live_course",count:0},{title:"pageTitle.offlineCourse",name:"offline_course",count:0}],tabListOffLine:[{type:"ongoing",name:this.$t("offline.ongoing"),count:0},{type:"unstarted",name:this.$t("offline.notStarted"),count:0},{type:"finished",name:this.$t("offline.over"),count:0}],tabListLive:[{name:"prepartion",lang:"home.notStarted",count:0},{name:"live",lang:"ddLive.living",count:0},{name:"end",lang:"data.over",count:0},{name:"expired",lang:"minePoints.expiredTime",count:0}],liveTabActive:"prepartion",startLoading:!1,page:{train_status:"ongoing",keyword:"",pageSize:10,pageNumber:1,classifyType:"other_course",liveStatus:"prepartion"},container:null,lectureInfo:{},courseInfo:[],courseCount:0,lectureCourseInfo:[],loading:!1,finished:!1,lecturerId:"",coursesTotalObj:{liveCourse:0,liveEndCourse:0,liveExpiredCourse:0,liveIngCourse:0,liveStartCourse:0,otherCourse:0}}},computed:(0,a.Z)({tagList(){return this.lectureInfo.adept_field?this.lectureInfo.adept_field.split(","):[this.$t("lecturer.NoTags")]}},(0,f.mapGetters)({primaryColor:"getPrimaryColor",userInfo:"user/getUserInfo"})),watch:{coursesTotalObj(t){this.tabList.map((e=>("other_course"===e.name?e.count=t.otherCourse:"live_course"===e.name&&(e.count=t.liveCourse),e)))}},activated(){this.$nextTick((()=>{const{scrollTop:t}=this.$route.meta,e=document.querySelector("#lecturer-detail");t&&e&&(e.scrollTop=t)}))},created(){const{from:t,tab:e,tabStatus:s}=this.$route.query;t&&(document.title=this.$t("mine.lessons")),e&&(this.page.classifyType=e),"will"===s&&(this.page.train_status="unstarted")},mounted(){const{lecturerId:t}=this.$route.query;this.startLoading=!0,t?(this.lecturerId=t,this.getLecturerQuery(),this.getLecturerCourseTotal()):this.whetherLecture()},methods:{async getLecturerQuery(){const{data:t}=await v.Z.getLecturerQuery(this.lecturerId);this.lectureInfo=t},async getLecturerCourseTotal(){let{data:t}=await v.Z.getLecturerCourseCount(this.lecturerId);this.coursesTotalObj=t},onLoad(){"offline_course"===this.page.classifyType?(this.getOffLineLecturer(),this.getTeachingsCount()):this.getLecturer()},tabChange(t,e){"offTab"===e?this.page.train_status=t:"liveTab"===e&&(this.page.liveStatus=t),this.resetQuery()},resetQuery(){this.list=[],this.loading=!0,this.courseInfo=[],this.lectureCourseInfo=[],this.page.pageNumber=1,this.finished=!1,this.loading&&(this.onLoad(),this.getLecturerCourseTotal(),"offline_course"===this.page.classifyType&&this.getTeachingsCount())},getLecturer(){const t=(0,a.Z)({lecturerId:this.lecturerId},this.page);v.Z.getLecturerCourseList(t).then((t=>{const{course:e,count:s}=t.data;this.loading=!1,"true"!==e.is_last_page&&0!==e.list.length||(this.finished=!0),this.page.pageNumber+=1,this.startLoading=!1,this.courseInfo=[...this.courseInfo,...e.list],this.courseCount=e.total,this.courseInfo.forEach((t=>{t.score=0===t.score?5:t.score})),this.tabListLive.map((t=>("prepartion"===t.name?t.count=s.liveStartCourse:"live"===t.name?t.count=s.liveIngCourse:"end"===t.name?t.count=s.liveEndCourse:"expired"===t.name&&(t.count=s.liveExpiredCourse),t)))}))},getOffLineLecturer(){const{train_status:t,keyword:e,pageSize:s,pageNumber:a}=this.page;v.Z.getTeachings({train_status:t,keyword:e,page_size:s,page_number:a}).then((t=>{!0!==t.data.data.is_last_page&&0!==t.data.data.list.length||(this.finished=!0),this.page.pageNumber+=1,this.startLoading=!1,this.lectureCourseInfo=[...this.lectureCourseInfo,...t.data.data.list],this.loading=!1}))},getTeachingsCount(){v.Z.getTeachingsCount(this.page.keyword).then((t=>{const{data:e}=t.data;let s=0;this.tabListOffLine.forEach((t=>{t.count=e[`${t.type}_count`],s+=t.count})),this.tabList.forEach((t=>{"offline_course"===t.name&&(t.count=s)}))}))},whetherLecture(){v.Z.whetherLecture().then((t=>{this.lecturerId=t.data.data,this.getLecturerQuery(),this.getLecturerCourseTotal()})).catch((t=>{console.error(t)}))},renderTabTitle(t){let e=this.$t(t.title);return"offline_course"!==t.name&&(e+=`(${t.count})`),e}}},N=M,G=(0,S.Z)(N,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"lecturer-detail",attrs:{id:"lecturer-detail"}},[s("OverlayLoading",{attrs:{show:t.startLoading}}),s("div",{staticClass:"lecturer-info"},[s("div",{staticClass:"self-info"},[s("van-row",[s("van-col",{staticClass:"lecturer-img",attrs:{span:"6"}},[s("avatar",{attrs:{src:t.lectureInfo.avatar,sex:t.lectureInfo.sex,width:65,height:65,"sex-width":20,"sex-height":20}})],1),s("van-col",{staticClass:"lecturer-text",attrs:{span:"18"}},[s("p",{staticClass:"name"},[s("cl-custom-user",{attrs:{type:t.lectureInfo.lecturer_source_type,"data-type":"userName",value:t.lectureInfo.lecturer_sync_user_id,name:t.lectureInfo.lecturer_name}})],1),s("p",{staticClass:"level"},[t._v(t._s(t.lectureInfo.level_name))]),s("p",{staticClass:"tags"},t._l(t.tagList,(function(e,a){return s("van-tag",{key:a,attrs:{default:t.$t("lecturer.NoTags")}},[t._v(t._s(e))])})),1)])],1)],1),t.lectureInfo.lecturer_describe?s("van-cell",[s("div",{domProps:{innerHTML:t.xss(t._s(t.lectureInfo.lecturer_describe))}})]):t._e()],1),s("van-sticky",{staticClass:"lecturer-tabs"},[s("van-tabs",{attrs:{"line-width":24,color:t.primaryColor},on:{change:function(e){return t.tabChange(e,"tab")}},model:{value:t.page.classifyType,callback:function(e){t.$set(t.page,"classifyType",e)},expression:"page.classifyType"}},t._l(t.tabList,(function(e){return s("van-tab",{key:e.name,attrs:{title:t.renderTabTitle(e),name:e.name}})})),1),s("van-tabs",{directives:[{name:"show",rawName:"v-show",value:"offline_course"===t.page.classifyType,expression:"page.classifyType === 'offline_course'"}],staticClass:"levelTwoTab",attrs:{"title-active-color":t.primaryColor,"title-inactive-color":"#7F849A","line-width":"0","line-height":"0"},on:{change:function(e){return t.tabChange(e,"offTab")}},model:{value:t.page.train_status,callback:function(e){t.$set(t.page,"train_status",e)},expression:"page.train_status"}},t._l(t.tabListOffLine,(function(t){return s("van-tab",{key:t.type,attrs:{name:t.type,title:t.name+"("+t.count+")"}})})),1),s("van-tabs",{directives:[{name:"show",rawName:"v-show",value:"live_course"===t.page.classifyType,expression:"page.classifyType === 'live_course'"}],staticClass:"levelTwoTab",attrs:{"title-active-color":t.primaryColor,"title-inactive-color":"#7F849A","line-width":"0","line-height":"0"},on:{change:function(e){return t.tabChange(e,"liveTab")}},model:{value:t.page.liveStatus,callback:function(e){t.$set(t.page,"liveStatus",e)},expression:"page.liveStatus"}},t._l(t.tabListLive,(function(e){return s("van-tab",{key:e.name,attrs:{name:e.name,title:t.$t(e.lang)+"("+e.count+")"}})})),1),s("van-divider",{style:{margin:"0"}}),s("van-search",{attrs:{placeholder:t.$t("knowledge.searchPlaceholder")},on:{search:function(e){return t.resetQuery()},clear:function(e){return t.resetQuery()}},model:{value:t.page.keyword,callback:function(e){t.$set(t.page,"keyword",e)},expression:"page.keyword"}}),s("van-divider",{style:{margin:"0"}})],1),s("van-list",{staticClass:"lecturer-list",attrs:{finished:t.finished,"finished-text":t.$t("lecturer.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},["offline_course"===t.page.classifyType?[s("offLineList",{attrs:{info:t.lectureCourseInfo,"lecture-id":t.lecturerId}})]:t._l(t.courseInfo,(function(e){return s("div",{key:e.id},[s("Lecture",{attrs:{item:e,"is-courses-lecturer":t.lectureInfo.user_id===t.userInfo.userId},on:{refresh:t.getLecturer}})],1)}))],2)],1)}),[],!1,null,"7e2b217e",null).exports},9852:(t,e,s)=>{s.r(e),s.d(e,{default:()=>v});s(39610);var a=s(2163),i=(s(58052),s(68286)),n=(s(29941),s(64168)),o=(s(52355),s(29233)),r=(s(20581),s(50914)),l=(s(37138),s(2113)),c=(s(74268),s(55948)),d=(s(53743),s(59978)),m=(s(629),s(67763)),h=(s(86039),s(20495)),u=(s(57658),s(2068)),p=s(4852),g=s(45877),f={name:"DocPreview",components:{[h.Z.name]:h.Z,[m.Z.name]:m.Z,[d.Z.name]:d.Z,[c.Z.name]:c.Z,[l.Z.name]:l.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[n.Z.name]:n.Z,[i.Z.name]:i.Z,[a.Z.name]:a.Z,avatar:p.Z,ClCustomUser:g.Z},beforeRouteLeave(t,e,s){"/home-module/lecturer-detail"===t.path&&(t.meta.keepAlive=!1,this.$store.commit("noKeepAlive","LecturerDetail")),s()},data:()=>({params:{level:"",keyword:"",status:1,page_size:20,page_number:1},lectureLevel:[],lectureLevelSimple:[],lectureList:[],activeNames:"",loading:!1,finished:!1,refreshing:!1,checkAll:!0}),computed:{themeColor(){return this.$store.state.themeColor.primaryColor}},mounted(){u.Z.getLecturerLevel().then((t=>{this.lectureLevel=[].concat(t.data.list),this.lectureLevelSimple=t.data.list.slice(0,3),this.onSearch()}))},methods:{onSearch(t){this.refreshing&&(this.lectureList=[],this.refreshing=!1),this.loading=!0,this.activeNames="",u.Z.getLecturerList(this.params).then((e=>{this.loading=!1,"false"===e.data.has_next_page&&(this.finished=!0),this.lectureList="add"===t?this.lectureList.concat(e.data.list):[].concat(e.data.list)}))},onRefresh(t){this.finished=!1,this.loading=!0,this.params.page_number=1,this.params.level=t,this.onSearch(t)},clickMenu(t){this.lectureLevelSimple.forEach((e=>{e.id===t?e.selected=!0:e.selected=!1})),this.lectureLevel.forEach((e=>{e.id===t?e.selected=!0:e.selected=!1})),this.checkAll=""===t,this.onRefresh(t)},onload(){this.params.page_number++,this.onSearch("add")},lecturerDetail(t){this.$router.push({path:"/home-module/lecturer-detail",query:{lecturerId:t}})}}},v=(0,s(1001).Z)(f,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"lecturer-wrap"},[s("van-search",{staticClass:"lecture-search",attrs:{placeholder:t.$t("lecturer.search")},on:{search:t.onSearch},model:{value:t.params.keyword,callback:function(e){t.$set(t.params,"keyword",e)},expression:"params.keyword"}}),s("van-collapse",{staticClass:"lecture-level-wrap",attrs:{border:!1,accordion:""},model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[s("van-grid",{directives:[{name:"show",rawName:"v-show",value:"1"!==t.activeNames,expression:"activeNames !== '1'"}],staticClass:"level-default",attrs:{clickable:""}},[s("van-grid-item",{style:{color:t.checkAll?t.themeColor:""},on:{click:function(e){return t.clickMenu("")}}},[t._v(" "+t._s(t.$t("lecturer.All"))+" ")]),t._l(t.lectureLevelSimple,(function(e){return s("van-grid-item",{key:e.id,style:{color:e.selected?t.themeColor:""},on:{click:function(s){return t.clickMenu(e.id)}}},[t._v(" "+t._s(e.name)+" ")])}))],2),s("van-collapse-item",{attrs:{name:"1"}},[s("van-grid",[s("van-grid-item",{style:{color:t.checkAll?t.themeColor:""},on:{click:function(e){return t.clickMenu("")}}},[t._v(" "+t._s(t.$t("lecturer.All"))+" ")]),t._l(t.lectureLevel,(function(e){return s("van-grid-item",{key:e.id,style:{color:e.selected?t.themeColor:""},on:{click:function(s){return t.clickMenu(e.id)}}},[t._v(" "+t._s(e.name)+" ")])}))],2)],1)],1),s("van-pull-refresh",{staticClass:"lecture-refresh",on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[s("van-list",{staticClass:"lecture-list-wrap",attrs:{offset:50,"immediate-check":!1,finished:t.finished,"finished-text":t.$t("lecturer.noMore")},on:{load:t.onload},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[s("van-cell-group",t._l(t.lectureList,(function(e){return s("van-cell",{key:e.id,staticClass:"home-lecturer-card",on:{click:function(s){return t.lecturerDetail(e.id)}},scopedSlots:t._u([{key:"icon",fn:function(){return[s("avatar",{attrs:{src:e.avatar,sex:e.sex,width:45,height:45}})]},proxy:!0},{key:"title",fn:function(){return[s("span",{staticClass:"name"},[s("cl-custom-user",{attrs:{type:e.source_type,"data-type":"userName",value:e.sync_user_id,name:e.lecturer_name}})],1),s("span",{staticClass:"level"},[t._v(t._s(e.level_name))]),e.level_name?t._e():s("span",{staticClass:"level default"},[t._v(t._s(t.$t("lecturer.NoGrade")))])]},proxy:!0}],null,!0)})})),1)],1)],1)],1)}),[],!1,null,"dfb2ead8",null).exports},58847:(t,e,s)=>{s.r(e),s.d(e,{default:()=>p});var a=s(95082),i=(s(31930),s(94907)),n=(s(25773),s(35791)),o=(s(33948),s(26294)),r=s(64404),l=s(95084),c=s(27479),d=s(22648),m=s(78e3),h=s(2068),u={components:{[n.Z.name]:n.Z,[i.Z.name]:i.Z,ClUpload:r.Z,ClAttachment:l.Z,EmptyBox:c.Z},data:()=>({attachmentList:[],loading:!1}),computed:(0,a.Z)({},(0,o.mapGetters)({primaryColor:"getPrimaryColor",access_token:"getToken"})),created(){this.getResource()},methods:{async getResource(){const{activity_attachment_id:t}=this.$route.query,e=await m.Z.getOfflineCourseResource(t);this.attachmentList=e&&e.data.map((t=>(0,d.Tq)(t,"toLine")))},onSuccess(t){if(this.attachmentList.length>=10)return this.$toast(this.$t("offline.uploadWaining")),!1;this.attachmentList=[...this.attachmentList,...t]},deleteFile(t){this.attachmentList.splice(t,1)},uploadFile(){this.$toast({type:"loading",overlay:!0,forbidClick:!0});const{activity_attachment_id:t}=this.$route.query,e={access_token:this.access_token,bizResourceList:[{bizCode:t,resourceIdList:this.attachmentList.map((t=>t.id)),isCovered:!0}]};h.Z.resouceAdd(e).then((()=>{this.loading=!1,this.$toast.clear(),this.$toast({type:"success",message:this.$t("attestation.saveSuccess"),onClose:()=>{this.$router.go(-1)}})})).catch((()=>{this.loading=!1}))}}},p=(0,s(1001).Z)(u,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[s("div",{staticClass:"attachList"},[0===t.attachmentList.length?s("EmptyBox",{staticClass:"course-empty"}):t._e(),t.attachmentList.length>0?s("div",[s("p",[t._v(t._s(t.$t("offline.uploadWaining")))]),s("cl-attachment",{attrs:{"attachment-list":t.attachmentList,"is-delete":!0},on:{delete:t.deleteFile}})],1):t._e()],1),s("div",{staticClass:"van-hairline--bottom"},[s("cl-upload",{attrs:{"list-type":["photo","video"]},on:{onSuccess:t.onSuccess}})],1),s("div",{staticClass:"foot"},[s("van-button",{attrs:{color:t.primaryColor},on:{click:t.uploadFile}},[t._v(t._s(t.$t("common.submit")))])],1)])}),[],!1,null,"5268908f",null).exports},49576:(t,e,s)=>{s.r(e),s.d(e,{default:()=>C});var a=s(95082),i=(s(3791),s(93432)),n=(s(47601),s(44951)),o=(s(23307),s(81392)),r=(s(86039),s(20495)),l=(s(49153),s(5944)),c=(s(20581),s(50914)),d=(s(58052),s(68286)),m=(s(33948),s(26294)),h=s(22648),u=s(32625),p=(s(39714),s(41817),{name:"MyPrizeDetail",components:{[o.Z.name]:o.Z},filters:{formatDate:function(t){return(0,h.p6)(t,"yyyy-MM-dd  hh:mm")}},props:{item:{type:Object,required:!0,default:()=>({})},isShow:{type:Boolean,required:!0,default:!1}},data:()=>({backBg:"",titleImg:"",closeImg:"",ruleHtml:{}}),computed:(0,a.Z)({},(0,m.mapGetters)({primaryColor:"getPrimaryColor",userInfo:"user/getUserInfo"})),watch:{isShow:{handler:function(){this.show()},deep:!0}},mounted(){this.backBg=`${LOTTERY_GAME_HOST}/images/${this.typeStyle}/bg.png`,this.titleImg=`${LOTTERY_GAME_HOST}/images/${this.typeStyle}/rule_top.png`,this.closeImg=`${LOTTERY_GAME_HOST}/images/${this.typeStyle}/close.png`,this.show()},methods:{cancel(t){this.$emit("cancel",t)},show(){this.isShow?(this.getRule(),setTimeout((()=>{document.getElementById("myPrizeRule").style.bottom="0px"}),0)):document.getElementById("myPrizeRule").style.bottom="-150vh"},getRule(){u.Z.getLotteryRule({lotteryId:this.item.plan_id}).then((t=>{"true"===t.data.success?this.ruleHtml=this.setRuleHtml(t.data.data):console.error(t)}))},setRuleHtml(t){let e=t.lottery_limit_type?`${t.lottery_limit_num.toString()} ${this.$t("lottery.times")}`:this.$t("lottery.nonLimit"),s="";s+=`<div>1、${this.$t("lottery.limitPrizeNum")}：${e}</div>`,s+=`<div>2、${this.$t("lottery.prizeList")}：</div>`;return t.all_prizes.split(",").forEach(((t,e)=>{s+=`<div><span>${String.fromCharCode(97+e)}.</span><span>${t};</span></div>`})),s+=`<div>3、${this.$t("lottery.activityDesc")}：${t.description}</div>`,s}}}),g=s(1001),f=(0,g.Z)(p,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"mask"},[s("div",{staticClass:"page",attrs:{id:"myPrizeRule"}},[s("div",{staticClass:"default-title"},[t._v(" "+t._s(t.$t("lottery.defaultTitle"))+" "),s("div",{staticClass:"close-btn"},[s("van-icon",{attrs:{name:"cross",size:"14"},on:{click:function(e){return t.cancel(t.item)}}})],1)]),s("div",{staticClass:"rule-content"},[s("div",{staticClass:"rule-detail"},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("lottery.lotteryName")))]),s("div",{staticClass:"txt",domProps:{innerHTML:t.xss(t._s(t.item.lottery_title))}}),s("div",{staticClass:"title"},[t._v(t._s(t.$t("lottery.prizeName")))]),s("div",{staticClass:"txt",domProps:{innerHTML:t.xss(t._s(t.item.title))}}),s("div",{staticClass:"title"},[t._v(t._s(t.$t("lottery.cashingContact")))]),s("div",{staticClass:"txt",domProps:{innerHTML:t.xss(t._s(t.item.lottery_cashing_contact))}}),s("div",{staticClass:"title"},[t._v(t._s(t.$t("lottery.cashingContactMobile")))]),s("div",{staticClass:"txt",domProps:{innerHTML:t.xss(t._s(t.item.lottery_cashing_contact_mobile))}}),s("div",{staticClass:"title"},[t._v(t._s(t.$t("lottery.time")))]),s("div",{staticClass:"txt"},[t._v(t._s(t._f("formatDate")(Number(t.item.start_time)))+"～"+t._s(t._f("formatDate")(Number(t.item.end_time))))]),s("div",{staticClass:"title"},[t._v(t._s(t.$t("lottery.rule")))]),s("div",{staticClass:"txt",staticStyle:{"margin-bottom":"50px","line-height":"26px"},domProps:{innerHTML:t.xss(t._s(t.ruleHtml))}})])])])])}),[],!1,null,"604372bd",null).exports,v=s(78368),_={name:"PrizeList",components:{PullRefresh:d.Z,List:c.Z,Empty:l.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,VanImage:n.Z,Loading:i.Z,MyPrizeDetail:f},filters:{formatDate:function(t){return(0,h.p6)(t,"yyyy-MM-dd  hh:mm")}},data:()=>({params:{title:"",page_number:1,page_size:10},oldTitle:"",curItem:{},isShowDetail:!1,showTitle:!0,list:[],isLoading:!0,loading:!1,finished:!1,refreshing:!1,defaultAvatar:v,stampImg:"",prizeInfo:{},scoreList:[]}),computed:(0,a.Z)({},(0,m.mapGetters)({primaryColor:"getPrimaryColor"})),mounted(){document.title=this.$t("pageTitle.winningRecord"),this.stampImg=`${LOTTERY_GAME_HOST}/images/stamp.png`,this.getList()},methods:{onLoad(){this.refreshing?(this.isLoading=!0,this.list=[],this.refreshing=!1,this.params.page_number=1):this.params.page_number+=1,this.getList()},onSearch(t){this.params.title=t,this.onRefresh()},onRefresh(){this.finished=!1,this.loading=!0,this.refreshing=!0,this.params.title&&(this.showTitle=!1),setTimeout((()=>{this.onLoad()}),100)},onClear(){this.params.title="",this.showTitle=!0,this.onRefresh()},show(t){this.curItem=t,this.isShowDetail=!this.isShowDetail},async getList(){const t=await u.Z.getMyLotteryList(this.params);if("true"===t.data.success&&t.data.data.list){const{list:e,has_next_page:s}=t.data.data;this.list=[...this.list,...e],this.loading=!1,this.isLoading=!1,this.finished="false"===s}}}},y=_,C=(0,g.Z)(y,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"prize-list-wrapper cl-page-container"},[s("van-search",{staticClass:"prize-search",attrs:{placeholder:t.$t("lottery.searchPlaceHolder")},on:{search:t.onSearch},model:{value:t.params.title,callback:function(e){t.$set(t.params,"title",e)},expression:"params.title"}}),s("div",{staticClass:"prize-list",attrs:{id:"list-container"}},[t.isLoading?s("Loading",{staticClass:"loading"},[t._v(t._s(t.$t("common.loading")))]):t._e(),s("PullRefresh",{on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[t.list.length>0?s("list",{attrs:{"immediate-check":!1,finished:t.finished,"finished-text":t.$t("common.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e){return s("div",{key:e.id,staticClass:"list",on:{click:function(s){return t.show(e)}}},[s("div",{staticClass:"list-item"},[s("VanImage",{staticClass:"cover-img",attrs:{src:e.cover,fit:"cover",radius:"4"}}),s("div",{staticClass:"item-info"},[s("div",{staticClass:"item-prize-name van-ellipsis"},[t._v(t._s(e.title))]),s("div",{staticClass:"item-title van-ellipsis"},[t._v(t._s(e.lottery_title))]),s("div",{staticClass:"item-time van-ellipsis"},[t._v(t._s(t._f("formatDate")(Number(e.create_time))))])]),e.cash_prize||2===e.type?s("VanImage",{staticClass:"stamp",attrs:{src:t.stampImg,width:"60",height:"52"}}):t._e()],1)])})),0):t._e(),0!==t.list.length||t.refreshing||t.isLoading?t._e():s("Empty",{attrs:{description:t.$t("common.noDataTextTip")}})],1)],1),t.isShowDetail?s("MyPrizeDetail",{attrs:{item:t.curItem,"is-show":t.isShowDetail},on:{cancel:t.show}}):t._e()],1)}),[],!1,null,"69276305",null).exports},48006:(t,e,s)=>{s.r(e),s.d(e,{default:()=>$});var a=s(95082),i=(s(31146),s(41610)),n=(s(3791),s(93432)),o=(s(74916),s(15306),s(41817),s(26294)),r=s(22648),l=s(27632),c=s(32625),d=(s(49153),s(5944)),m=(s(20581),s(50914)),h=(s(58052),s(68286)),u=(s(34837),s(39146)),p=(s(33948),{name:"MyPrizeItem",filters:{formatDate:function(t){return(0,r.p6)(t,"yyyy-MM-dd  hh:mm")}},props:{item:{type:Object,required:!0,default:()=>({})},typeStyle:{type:String,required:!0,default:""}},data:()=>({stampImg:""}),mounted(){this.stampImg=`${LOTTERY_GAME_HOST}/images/${this.typeStyle}/stamp.png`},methods:{}}),g=s(1001),f=(0,g.Z)(p,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:["prize-item-content","prize-item-content-"+t.typeStyle]},[s("div",{staticClass:"prize-cover"},[s("img",{staticClass:"head-img",attrs:{src:t.item.cover}})]),s("div",[s("div",{staticClass:"prize-name hidetxt"},[t._v(t._s(t.item.title))]),s("div",{staticClass:"prize-create-time"},[t._v(t._s(t._f("formatDate")(Number(t.item.create_time))))])]),t.item.cash_prize||2===t.item.type?s("img",{staticClass:"stamp",attrs:{src:t.stampImg}}):t._e()])}),[],!1,null,"772f6e28",null).exports,v={name:"MyLotteryPrizeList",components:{[u.Z.name]:u.Z,[n.Z.name]:n.Z,PullRefresh:h.Z,List:m.Z,Empty:d.Z,MyPrizeItem:f},filters:{formatDate:function(t){return(0,r.p6)(t,"yyyy-MM-dd  hh:mm")}},props:{lotteryId:{type:String,required:!0,default:""},typeStyle:{type:String,required:!0,default:""},isShow:{type:Boolean,required:!0,default:!1}},data:()=>({isLoading:!0,list:[],pageNumber:1,pageSize:10,loading:!1,refreshing:!1,finished:!1,backBg:"",titleImg:"",closeImg:""}),computed:(0,a.Z)({},(0,o.mapGetters)({primaryColor:"getPrimaryColor",userInfo:"user/getUserInfo"})),mounted(){this.backBg=`${LOTTERY_GAME_HOST}/images/${this.typeStyle}/bg.png`,this.titleImg=`${LOTTERY_GAME_HOST}/images/${this.typeStyle}/list_top.png`,this.closeImg=`${LOTTERY_GAME_HOST}/images/${this.typeStyle}/close.png`,this.show()},methods:{onLoad(){this.refreshing?(this.isLoading=!0,this.list=[],this.refreshing=!1,this.pageNumber=1):this.pageNumber+=1,this.getList()},onRefresh(){this.finished=!1,this.loading=!0,this.refreshing=!0,setTimeout((()=>{this.onLoad()}),100)},show(){this.isShow?(this.onRefresh(),document.getElementById("myPrizeList").style.bottom="0px"):document.getElementById("myPrizeList").style.bottom="-150vh"},getList(){let t={page_number:this.pageNumber,page_size:this.pageSize,lotteryId:this.lotteryId};c.Z.getMyPrizeList(t).then((t=>{const{list:e,has_next_page:s}=t.data.data;this.list=[...this.list,...e],this.loading=!1,this.isLoading=!1,this.finished="false"===s,this.list&&0!==this.list.length||(this.isEmpty=!0)}))},cancel(){this.$emit("cancel")}}},_=v,y=(0,g.Z)(_,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"mask"},[s("div",{staticClass:"page",attrs:{id:"myPrizeList"}},[s("div",{staticClass:"title"},[s("img",{attrs:{src:""+t.titleImg}}),s("div",{staticClass:"close-btn"},[s("img",{attrs:{src:""+t.closeImg},on:{click:function(e){return t.cancel()}}})])]),s("div",{staticClass:"my-prize-content",style:{backgroundImage:"url("+t.backBg+")"}},[s("div",{staticClass:"prize-list"},[s("PullRefresh",{staticStyle:{height:"470px"},on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[t.list.length>0?s("list",{attrs:{"immediate-check":!1,finished:t.finished,"finished-text":t.$t("common.noMore"),offset:100},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[s("div",{staticClass:"prize-list-item"},t._l(t.list,(function(e,a){return s("MyPrizeItem",{key:a,attrs:{item:e,"type-style":t.typeStyle}})})),1)]):t._e(),0!==t.list.length||t.refreshing||t.isLoading?t._e():s("Empty",{attrs:{description:t.$t("common.noDataTextTip")}})],1)],1)])])])}),[],!1,null,"726a628b",null).exports,C=(s(39714),{name:"MyLotteryRule",components:{},filters:{formatDate:function(t){return t?(0,r.p6)(Number(t),"yyyy-MM-dd  hh:mm"):""}},props:{lotteryId:{type:String,required:!0,default:""},typeStyle:{type:String,required:!0,default:""},title:{type:String,required:!0,default:""},isShow:{type:Boolean,required:!0,default:!1}},data:()=>({backBg:"",titleImg:"",closeImg:"",item:{},ruleHtml:""}),computed:(0,a.Z)({},(0,o.mapGetters)({primaryColor:"getPrimaryColor",userInfo:"user/getUserInfo"})),mounted(){this.backBg=`${LOTTERY_GAME_HOST}/images/${this.typeStyle}/bg.png`,this.titleImg=`${LOTTERY_GAME_HOST}/images/${this.typeStyle}/rule_top.png`,this.closeImg=`${LOTTERY_GAME_HOST}/images/${this.typeStyle}/close.png`,this.show(),this.getRule()},methods:{cancel(){this.$emit("cancel")},show(){this.isShow?setTimeout((()=>{document.getElementById("myPrizeRule").style.bottom="0px"}),0):document.getElementById("myPrizeRule").style.bottom="-150vh"},getRule(){c.Z.getLotteryRule({lotteryId:this.lotteryId}).then((t=>{"true"===t.data.success?(this.item=t.data.data,this.ruleHtml=this.setRuleHtml(t.data.data)):console.error(t)}))},setRuleHtml(t){let e=t.lottery_limit_type?`${t.lottery_limit_num.toString()} ${this.$t("lottery.times")}`:this.$t("lottery.nonLimit"),s="";s+=`<div>1、${this.$t("lottery.limitPrizeNum")}：${e}</div>`,s+=`<div>2、${this.$t("lottery.prizeList")}：</div>`;return t.all_prizes.split(",").forEach(((t,e)=>{s+=`<div><span>${String.fromCharCode(97+e)}.</span><span>${t};</span></div>`})),s+=`<div>3、${this.$t("lottery.cashingContact")}：${t.cashing_contact}</div>`,s+=`<div>4、${this.$t("lottery.cashingContactMobile")}：${t.cashing_contact_mobile}</div>`,s+=`<div>5、${this.$t("lottery.activityDesc")}：${t.description}</div>`,s}}}),k=(0,g.Z)(C,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"mask"},[s("div",{staticClass:"page",attrs:{id:"myPrizeRule"}},[s("div",{staticClass:"title"},[s("img",{attrs:{src:""+t.titleImg}}),s("div",{staticClass:"close-btn"},[s("img",{attrs:{src:""+t.closeImg},on:{click:function(e){return t.cancel()}}})])]),s("div",{staticClass:"rule-content",style:{backgroundImage:"url("+t.backBg+")"}},[s("div",{class:["rule-detail",""+t.typeStyle]},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("lottery.lotteryName")))]),s("div",{staticClass:"txt"},[t._v(t._s(t.title))]),s("div",{staticClass:"title"},[t._v(t._s(t.$t("lottery.time")))]),s("div",{staticClass:"txt"},[t._v(t._s(t._f("formatDate")(t.item.start_time))+"～"+t._s(t._f("formatDate")(t.item.end_time)))]),s("div",{staticClass:"title"},[t._v(t._s(t.$t("lottery.rule")))]),s("div",{staticClass:"txt",staticStyle:{"margin-bottom":"50px","line-height":"26px"},domProps:{innerHTML:t.xss(t._s(t.ruleHtml))}})])])])])}),[],!1,null,"684326af",null).exports,b={name:"Lottery",components:{[n.Z.name]:n.Z,[i.Z.Component.name]:i.Z.Component,MyLotteryPrizeList:y,MyLotteryRule:k},data:()=>({lotteryId:"",gameData:null,iframeWin:{},title:"",isGameLoaded:!1,isPageLoaded:!1,gameDataOk:!1,url:"",isShowMyLotteryPrizeList:!1,isShowRule:!1,typeStyle:"turn-table",bgAudio:null,isPlayAudio:!1,progress:0,iconLoading:"",progressBarBg:"",gameBg:"",t:null}),computed:(0,a.Z)({},(0,o.mapGetters)({userInfo:"user/getUserInfo",primaryColor:"getPrimaryColor"})),watch:{isGameLoaded:{handler:function(){this.startGame()},deep:!0},isPageLoaded:{handler:function(){this.postGameData()},deep:!0},gameData(t){t&&(this.gameDataOk=!0,this.postGameData())}},beforeDestroy(){window.removeEventListener("message",this.messageFun,!1),document.removeEventListener("visibilitychange",this.handlePageVisible),this.stopAudio()},created(){},mounted(){const{lotteryId:t,gameType:e}=this.$route.query;this.lotteryId=t,this.typeStyle=this.setTypeStyle(e),this.init();let s="zh_cn";this.$i18n.locale&&(s=this.$i18n.locale.replace("-","_")),this.url=`${LOTTERY_GAME_HOST}/mobile/index.html?loglvl=0&lang=${s}&t=${(new Date).getTime()}`,this.iconLoading=`${LOTTERY_GAME_HOST}/images/${this.typeStyle}/icon_loading.png`,this.progressBarBg=`${LOTTERY_GAME_HOST}/images/${this.typeStyle}/bg_progress.png`,this.gameBg=`${LOTTERY_GAME_HOST}/images/${this.typeStyle}/bg_game.png`,window.addEventListener("message",this.messageFun,!1),document.addEventListener("visibilitychange",this.handlePageVisible)},methods:{init(){this.getLotteryInfo();let t=0;this.t=setInterval((()=>{if(t<99){const e=document.getElementById("percent");e&&(e.style.width=t+++"%",this.progress=t+++"%")}else clearInterval(this.t)}),100)},handlePageVisible(){"hidden"===document.visibilityState?this.stopAudio():this.isPlayAudio&&this.playAudio("play_bg_music"),this.$nextTick((()=>{setTimeout((()=>{(0,r.Td)(this.title)}),2e3)}))},messageFun(t){try{let{data:e}=t;"luckdraw_game"===e.from&&("play_bg_music"===e.name?(this.playAudio("play_bg_music"),this.isPlayAudio=!0):"stop_bg_music"===e.name?(this.stopAudio(),this.isPlayAudio=!1):"page_loaded"===e.name?this.isPageLoaded=!0:"download_success"===e.name?this.isGameLoaded=!0:"download_fail"===e.name?document.getElementById("gameFrame").contentWindow.postMessage({name:"reload_page",from:"luckdraw_game_container",data:null},"*"):"end_game"===e.name?this.goBack():"myPrizes"===e.name?this.showMyPrizeFrame():"showRule"===e.name&&this.showRule())}catch(t){console.error(t)}},getLotteryInfo(){c.Z.getLotteryInfo({lotteryId:this.lotteryId}).then((t=>{this.setData(t.data)}),(()=>{i.Z.alert({message:this.$t("common.serverFailure")}),clearInterval(this.t),this.goBack()}))},setData(t){"true"!==t.success&&(t.message?i.Z.alert({message:t.message}):i.Z.alert({message:this.$t("common.serverFailure")}));const e=t.data||{lottery_prizes:[]};this.title=e.title,(0,r.Td)(this.title);let s={user_token:this.userInfo.accessToken,api_base:`${CL_API}/interaction-api`,env:l.Z.env,id:this.lotteryId,lottery_limit_num:e.lottery_limit_num,lottery_limit_type:e.lottery_limit_type,surplus_lottery_times:e.surplus_lottery_times,type:e.type,rules:e.description,enterprise_id:this.userInfo.enterpriseId,user_id:this.userInfo.userId,lang:this.$i18n.locale,lottery_prizes:e.lottery_prizes};this.gameData=s},postGameData(){if(this.isPageLoaded&&this.gameData){let t={name:"game_data",from:"luckdraw_game_container",data:this.gameData};document.getElementById("gameFrame").contentWindow.postMessage(t,this.url)}},startGame(){this.isGameLoaded&&this.gameDataOk&&(document.getElementById("gameFrame").style.opacity="1",document.getElementById("gameFrame").contentWindow.postMessage({name:"start_game",from:"luckdraw_game_container",data:null},this.url))},goBack(){this.isPageLoaded=!1,this.gameDataOk=!1,this.$router.go(-1)},setTypeStyle(t){switch(t){case"blindBox":case"gashapon":return"blind-box";default:return"turn-table"}},showMyPrizeFrame(){this.isShowRule||(this.isShowMyLotteryPrizeList=!this.isShowMyLotteryPrizeList)},showRule(){this.isShowMyLotteryPrizeList||(this.isShowRule=!this.isShowRule)},playAudio(t){let e=`${LOTTERY_GAME_HOST}/audio/${t}.mp3`;e&&(this.bgAudio=new Audio,this.bgAudio.src=e,this.bgAudio.play(),this.bgAudio.loop=!0)},stopAudio(){this.bgAudio&&this.bgAudio.pause()}}},$=(0,g.Z)(b,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"page cl-page-container",style:{backgroundImage:"url('"+t.gameBg+"')"}},[!1===t.isGameLoaded?s("div",{staticClass:"loading"},[s("div",{staticClass:"progress"},[s("div",{staticClass:"progress-bar",style:{backgroundImage:"url('"+t.progressBarBg+"')"},attrs:{id:"percent"}},[s("img",{attrs:{src:t.iconLoading}})])]),s("div",{staticClass:"icon-gifts"},[s("span",{class:t.typeStyle},[t._v(t._s(t.$t("lottery.loading"))+":"+t._s(t.progress))])])]):t._e(),s("iframe",{staticClass:"iframe",attrs:{id:"gameFrame",frameborder:"0",src:t.url}}),t.isShowMyLotteryPrizeList?s("MyLotteryPrizeList",{attrs:{"lottery-id":t.lotteryId,"type-style":t.typeStyle,"is-show":t.isShowMyLotteryPrizeList},on:{cancel:function(e){return t.showMyPrizeFrame()}}}):t._e(),t.isShowRule?s("MyLotteryRule",{attrs:{"lottery-id":t.lotteryId,"type-style":t.typeStyle,title:t.title,"is-show":t.isShowRule},on:{cancel:function(e){return t.showRule()}}}):t._e()],1)}),[],!1,null,"6b510707",null).exports},37111:(t,e,s)=>{s.d(e,{Z:()=>d});s(31146);var a=s(41610),i=(s(23307),s(81392)),n=s(45877),o=s(86207),r=s(78551),l=s(78368),c={components:{[i.Z.name]:i.Z,ClCustomUser:n.Z,SvgIcon:r.Z},props:{item:{type:Object,default:()=>{}}},data:()=>({defaultAvatar:l}),methods:{removeComments(t){const{type:e}=t;let s="";s="comment"===e?this.$t("notice.removeCommentMore"):this.$t("notice.removeComment"),a.Z.confirm({title:"",message:s,confirmButtonText:this.$t("common.confirm"),cancelButtonText:this.$t("common.cancel")}).then((()=>{this.removeCommentsHandler(t)})).catch((()=>{console.error("showModal fail")}))},async removeCommentsHandler(t){const e={comment_id:t.comment.id,reply_id:"reply"===t.type?t.reply.id:null};let s={};try{s="comment"===t.type?await o.Z.removeComment(e):await o.Z.removeReply(e),s.data&&0===s.data.code&&(this.$toast({message:this.$t("notice.removeSuccessfully")}),this.$emit("refreshComments"))}catch(t){console.error(t)}},showTextarea(t){this.$emit("show",t)}}},d=(0,s(1001).Z)(c,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"comments-list-items"},[s("div",{staticClass:"comments-list-avatar"},[s("img",{attrs:{src:t.item.author&&t.item.author.avatar||t.defaultAvatar}})]),s("div",{staticClass:"comments-list-item"},[s("div",{staticClass:"comments-list-item-username"},[t.item.author?s("cl-custom-user",{attrs:{type:t.item.author.source_type,"data-type":"userName",value:t.item.author.user_id,name:t.item.author.name}}):t._e()],1),s("div",{staticClass:"comments-list-item-comment"},[t._v(t._s(t.item.content))]),s("div",{staticClass:"comments-list-item-info"},[s("div",{staticClass:"comments-list-item-info-left"},[t._v(t._s(t.item.date_str))]),s("div",{staticClass:"comments-list-item-info-right"},[t.item.self?s("span",{on:{click:function(e){return t.removeComments({comment:t.item,type:"comment"})}}},[s("SvgIcon",{attrs:{color:"#c0c2cb",size:14,"icon-class":"icon-icon_delex"}}),t._v(" "+t._s(t.$t("notice.remove"))+" ")],1):t._e(),s("span",{on:{click:function(e){return t.showTextarea(t.item)}}},[s("SvgIcon",{attrs:{color:"#c0c2cb",size:14,"icon-class":"icon-huifu1"}}),t._v(" "+t._s(t.$t("notice.reply"))+" ")],1)])]),t.item.replyVoList?t._l(t.item.replyVoList,(function(e,a){return s("div",{key:a,staticClass:"comments-list-item-answer"},[s("div",{staticClass:"comments-list-item-answer-title"},[s("span",[s("cl-custom-user",{attrs:{type:e.author.source_type,"data-type":"userName",value:e.author.user_id,name:e.author.name}})],1),t._v(t._s(" ")+" "+t._s(t.$t("notice.reply"))+" "),s("span",[s("cl-custom-user",{attrs:{type:e.target.source_type,"data-type":"userName",value:e.target.user_id,name:e.target.name}})],1),t._v(t._s(" ")+" ："),s("span",[t._v(t._s(e.content))])]),s("div",{staticClass:"comments-list-item-answer-sub"},[s("div",{staticClass:"comments-list-item-answer-sub-left"},[t._v(t._s(e.date_str))]),s("div",{staticClass:"comments-list-item-answer-sub-right"},[e.self?s("span",{on:{click:function(s){return t.removeComments({comment:t.item,reply:e,type:"reply"})}}},[s("SvgIcon",{attrs:{color:"#c0c2cb",size:14,"icon-class":"icon-icon_delex"}}),t._v(" "+t._s(t.$t("notice.remove"))+" ")],1):t._e(),s("span",{on:{click:function(e){return t.showTextarea(t.item)}}},[s("SvgIcon",{attrs:{color:"#c0c2cb",size:14,"icon-class":"icon-huifu1"}}),t._v(" "+t._s(t.$t("notice.reply"))+" ")],1)])])])})):t._e()],2)])}),[],!1,null,"3c611f14",null).exports},32097:(t,e,s)=>{s.r(e),s.d(e,{default:()=>$});var a=s(95082),i=(s(31960),s(10993)),n=(s(3791),s(93432)),o=s(26294),r={components:{},props:{info:{type:Object,default:function(){return{title:"",createTime:""}}},countAccessRecord:{type:Number,default:0}},computed:(0,a.Z)({},(0,o.mapGetters)({primaryColor:"getPrimaryColor"}))},l=s(1001),c=(0,l.Z)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"notice-info"},[s("div",{staticClass:"title"},[t._v(t._s(t.info.title))]),s("div",{staticClass:"subTitle"},[s("span",{staticClass:"time"},[t._v(t._s(t.info.createTime))]),s("span",{staticClass:"user"},[t._v(" "+t._s(t.countAccessRecord)+" "+t._s(t.$t("course.scan"))+" ")])])])}),[],!1,null,"6d61a200",null).exports,d=s(39819),m=s(86207),h=s(22648),u=(s(57658),s(37111)),p=s(81533),g=s(78551),f={components:{CommentList:u.Z,CommentTextarea:p.Z,SvgIcon:g.Z},props:{articleId:{type:String,default:""},commentsCount:{type:Number,default:0}},data:()=>({commentList:[],showTextArea:!1,isReply:!1,replyPlaceholder:"",replyItem:{}}),mounted(){this.getCommentList()},methods:{async getCommentList(){const t=await m.Z.getCommentsList({resource_id:this.articleId,page_number:1,page_size:3});this.commentList=t.data.data.list},show(t){this.showTextArea=!0,t?(this.isReply=!0,this.replyPlaceholder=this.$t("notice.reply")+("wx_sync"===t.author.source_type?"":t.author.name),this.replyItem=t):(this.isReply=!1,this.replyPlaceholder=this.$t("notice.textareaPlaceholder"),this.replyItem={})},editValueCbk(t,e){this.showTextArea=!1,t&&this.submitComment(e)},async submitComment(t){let e={};e=this.isReply?{comment_id:this.replyItem.id,content:t,target_user:{id:this.replyItem.author.id,avatar:this.replyItem.author.avatar,name:this.replyItem.author.name,department:this.replyItem.department}}:{resource_id:this.articleId,content:t};try{0===(this.isReply?await m.Z.commentsReply(e):await m.Z.commentsSave(e)).data.code&&(this.$toast({message:this.isReply?this.$t("notice.replySuccessfully"):this.$t("notice.commentSuccessfully")}),this.refreshComments())}catch(t){console.error(t)}},allComments(){this.$router.push({path:`/home-module/notice-comment-all?resourceId=${this.articleId}`})},refreshComments(){this.getCommentList(),this.$emit("refreshComments",this.articleId)}}},v=(0,l.Z)(f,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"notice-comments-container"},[s("div",{staticClass:"headline"},[s("span",[t._v(t._s(t.$t("course.latestComments")))]),t.commentsCount>0?s("div",{on:{click:t.allComments}},[t._v(t._s(t.$t("course.allComments"))+"("+t._s(t.commentsCount)+")")]):t._e()]),s("div",{staticClass:"typing"},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-morecopy",size:14,color:"#7F849A"}}),s("span",{staticClass:"placeholderClass",on:{click:function(e){return t.show("")}}},[t._v(t._s(t.$t("course.comment"))+"...")])],1),0===t.commentsCount?s("div",{staticClass:"no-comment"},[t._v(" "+t._s(t.$t("course.noComment"))+" ")]):[s("div",{staticClass:"comments-list"},t._l(t.commentList,(function(e,a){return s("comment-list",{key:a,attrs:{item:e},on:{show:t.show,refreshComments:t.refreshComments}})})),1)],t.showTextArea?s("comment-textarea",{attrs:{value:"",char:"","max-length":2e3,placeholder:t.replyPlaceholder},on:{onUpdate:t.editValueCbk}}):t._e()],2)}),[],!1,null,"2a7b5d6e",null).exports,_=(s(23307),s(81392)),y={components:{SvgIcon:g.Z,[_.Z.name]:_.Z},props:{commentsCount:{type:Number,default:0},articleId:{type:String,default:""}},data:()=>({countStar:0,isStar:!1}),computed:(0,a.Z)({},(0,o.mapGetters)({primaryColor:"getPrimaryColor"})),mounted(){this.getCountStar(),this.getIsStar()},methods:(0,a.Z)((0,a.Z)({},(0,o.mapActions)("course/imageText",["changePraise"])),{},{async getCountStar(){const t=await m.Z.getCountStar(this.articleId);this.countStar=t.data.data},async getIsStar(){const t=await m.Z.getIsStar(this.articleId);this.isStar=t.data.data},async praise(){try{this.isStar?(await m.Z.cancelCommentStar(this.articleId),this.isStar=!1,this.countStar-=1):(await m.Z.setCommentStar(this.articleId),this.isStar=!0,this.countStar+=1)}catch(t){console.error(t)}}})},C=(0,l.Z)(y,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"notice-action"},[s("div",{staticClass:"notice-action-more"},[s("div",{staticClass:"evaluate",on:{click:function(e){return t.$emit("scrollToComment")}}},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-talk",color:"#7F849A",size:18}}),t.commentsCount>0?s("span",{staticClass:"num"},[t._v(t._s(t.commentsCount))]):t._e()],1),s("div",{staticClass:"evaluate",on:{click:t.praise}},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-zan",color:t.isStar?"#df6666":"#7F849A",size:21}}),t.countStar>0?s("span",{staticClass:"num"},[t._v(t._s(t.countStar))]):t._e()],1)])])}),[],!1,null,"10032db7",null).exports,k=s(24357),b={components:{[n.Z.name]:n.Z,[i.Z.name]:i.Z,NoticeInfo:c,BraftEditPreview:d.Z,NoticeComment:v,NoticeAction:C,ClWaterMark:k.Z},data:()=>({fullLoading:!0,articleId:"",noticeDetails:{},countAccessRecord:0,commentsCount:0}),computed:(0,a.Z)({},(0,o.mapGetters)({user:"user/getUserInfo"})),mounted(){this.init()},methods:{init(){const{articleId:t}=this.$route.query;this.articleId=t,this.getNoticeDetails(t),this.addAccessRecord(t),this.getCommentsCount(t)},async getNoticeDetails(t){try{const e=await m.Z.getNoticeDetails(t);this.fullLoading=!1,this.noticeDetails=(0,a.Z)((0,a.Z)({},e.data),{},{content:e.data.context,createTime:(0,h.p6)(e.data.create_time,"yyyy-MM-dd hh:mm")})}catch(t){this.fullLoading=!1,console.error(t)}},async addAccessRecord(t){const e=await m.Z.addAccessRecord(t);this.countAccessRecord=e.data.data},async getCommentsCount(t){const e=await m.Z.getCommentsCount(t);this.commentsCount=Number(e.data.data)},scrollToComment(){this.$refs.myCourseComment.$el.scrollIntoView({behavior:"smooth"})},refreshComments(t){this.getCommentsCount(t)}}},$=(0,l.Z)(b,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"cl-page-container notice-detail-container"},[t.fullLoading?s("van-loading",{staticClass:"notice-detail-loading"}):[s("notice-info",{attrs:{info:t.noticeDetails,"count-access-record":t.countAccessRecord}}),s("div",{staticClass:"notice-braft-container"},[s("BraftEditPreview",{attrs:{data:t.noticeDetails.content}}),s("cl-water-mark",{attrs:{scenes:"notice"}})],1),s("notice-comment",{ref:"myCourseComment",attrs:{"article-id":t.articleId,"comments-count":t.commentsCount},on:{refreshComments:t.refreshComments}}),s("notice-action",{attrs:{"article-id":t.articleId,"comments-count":t.commentsCount},on:{scrollToComment:t.scrollToComment}})]],2)}),[],!1,null,"469cfb3d",null).exports},91922:(t,e,s)=>{s.r(e),s.d(e,{default:()=>d});var a=s(95082),i=(s(49153),s(5944)),n=(s(20581),s(50914)),o=(s(33948),s(57658),s(6106)),r=s(22648),l=s(95969),c={components:{[n.Z.name]:n.Z,[i.Z.name]:i.Z},filters:{formatDate:t=>(0,r.p6)(t,"yyyy.MM.dd hh:mm")},data:()=>({dataList:[],loading:!1,finished:!1,page:{page_number:0,page_size:20}}),methods:{renderClass:t=>({"notice-item__no-read":"UNREAD"===t.read_status,"notice-item__read":"READ"===t.read_status,"notice-item__top":"true"===t.stick_status_str}),async getData(){const t=(0,a.Z)({},this.page),[e,s]=await o.Z.getNoticeList(t);if(e)return this.finished=!0,this.loading=!1,void this.$toast.fail(this.$t("promptMessage.error"));const i=s.data.pageInfo;this.dataList=this.dataList.concat(i.list),this.finished="false"===i.has_next_page,this.loading=!1},onLoadMore(){this.page.page_number+=1,this.getData()},handleToDetail(t){this.$router.push({path:l.Z.home.noticeDetail({articleId:t})})}}},d=(0,s(1001).Z)(c,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"notice-container"},[t.finished&&!t.dataList.length?s("van-empty",{staticClass:"notice-empty",attrs:{description:t.$t("common.noDataTextTip")}}):s("van-list",{attrs:{"loading-text":t.$t("common.loading"),finished:t.finished,"finished-text":t.$t("common.noMore")},on:{load:t.onLoadMore},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.dataList,(function(e){return s("div",{key:e.id,staticClass:"notice-item",class:t.renderClass(e),on:{click:function(s){return t.handleToDetail(e.id)}}},[s("div",{staticClass:"item-info"},[s("div",{staticClass:"item-info-title van-ellipsis"},["true"===e.stick_status_str?s("span",{staticClass:"title-top"},[t._v(t._s(t.$t("common.top")))]):t._e(),t._v(t._s(e.title))]),s("div",{staticClass:"item-info-time"},[t._v(t._s(t._f("formatDate")(e.update_time)))])])])})),0)],1)}),[],!1,null,"1055b8d1",null).exports},3820:(t,e,s)=>{s.r(e),s.d(e,{default:()=>d});s(20581);var a=s(50914),i=s(81533),n=s(27479),o=s(37111),r=s(86207),l=s(78551),c={name:"StudyList",components:{EmptyBox:n.Z,commentTextarea:i.Z,[a.Z.name]:a.Z,CommentList:o.Z,SvgIcon:l.Z},data:function(){return{commentList:[],loading:!1,pageSize:10,pageNumber:1,finished:!1,showTextArea:!1,isReply:!1,replyPlaceholder:"",replyItem:{}}},computed:{themeColor(){return this.$store.state.themeColor.primaryColor}},mounted(){const{resourceId:t}=this.$route.query;this.resourceId=t,this.getCommentList()},methods:{getCommentList(){this.loading=!0;const{resourceId:t,pageSize:e,pageNumber:s}=this;this.$toast.loading({message:this.$t("minePoints.isLoading")}),r.Z.getCommentsList({resource_id:t,page_number:s,page_size:e}).then((t=>{this.$toast.clear(),this.commentList=this.commentList.concat(t.data.data.list),this.finished=!t.data.data.has_next,this.loading=!1,this.pageNumber+=1}))},onLoad(){this.getCommentList()},show(t){this.showTextArea=!0,t?(this.isReply=!0,this.replyPlaceholder=this.$t("notice.reply")+("wx_sync"===t.author.source_type?"":t.author.name),this.replyItem=t):(this.isReply=!1,this.replyPlaceholder=this.$t("notice.textareaPlaceholder"),this.replyItem={})},editValueCbk(t,e){this.showTextArea=!1,t&&this.submitComment(e)},async submitComment(t){let e={};e=this.isReply?{comment_id:this.replyItem.id,content:t,target_user:{id:this.replyItem.author.id,avatar:this.replyItem.author.avatar,name:this.replyItem.author.name,department:this.replyItem.department}}:{resource_id:this.resourceId,content:t};try{0===(this.isReply?await r.Z.commentsReply(e):await r.Z.commentsSave(e)).data.code&&(this.$toast({message:this.isReply?this.$t("notice.replySuccessfully"):this.$t("notice.commentSuccessfully")}),this.refreshComments())}catch(t){console.error(t)}},refreshComments(){this.pageNumber=1,this.commentList=[],this.getCommentList()}}},d=(0,s(1001).Z)(c,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"notice-comment-all-container cl-page-container"},[t.commentList.length<=0?s("EmptyBox"):[s("van-list",{attrs:{finished:t.finished,"finished-text":t.$t("mine.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[s("div",{staticClass:"comment-list"},t._l(t.commentList,(function(e,a){return s("comment-list",{key:a,attrs:{item:e},on:{show:t.show,refreshComments:t.refreshComments}})})),1)])],s("div",{staticClass:"comment_area"},[t.showTextArea?s("comment-textarea",{attrs:{value:"",char:"","max-length":2e3,placeholder:t.replyPlaceholder},on:{onUpdate:t.editValueCbk}}):t._e(),s("div",{staticClass:"typing",on:{click:function(e){return t.show("")}}},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-morecopy",size:14,color:"#7F849A"}}),s("span",{staticClass:"placeholderClass",on:{click:function(e){return t.show("")}}},[t._v(t._s(t.$t("course.comment"))+"...")])],1)],1)],2)}),[],!1,null,"4f915cde",null).exports},82653:(t,e,s)=>{s.r(e),s.d(e,{default:()=>_});var a=s(95082),i=(s(34837),s(39146)),n=(s(20581),s(50914)),o=(s(82500),s(49414)),r=(s(82522),s(10342)),l=(s(33948),s(26294)),c=s(59688),d=s(27479),m=s(22648),h=s(44908),u=s.n(h),p=s(98512),g=s(27550),f={name:"Ranking",components:{[r.Z.name]:r.Z,[o.Z.name]:o.Z,[n.Z.name]:n.Z,[i.Z.name]:i.Z,EmptyBox:d.Z,AnswerRecordSingleDetail:g.Z},filters:{formatDate:function(t){return(0,m.p6)(Number(t),"yyyy-MM-dd  hh:mm")}},data:()=>({pkId:"",title:"",isEmpty:!1,isFinished:!1,isLoading:!1,isShowDetail:!0,list:[],curItem:null,curResultTxt:"",params:{page_number:0,page_size:20}}),computed:(0,a.Z)({},(0,l.mapGetters)({primaryColor:"getPrimaryColor",userInfo:"user/getUserInfo"})),mounted(){const t=(0,p.DP)();this.pkId=t.pkId,this.title=t.title,this.pkType=t.pkType,(0,m.Td)(this.$t("pkGame.answerRecord")),this.onLoad(),localStorage.getItem("recordTips")||(setTimeout((()=>{(0,i.Z)({message:this.$t("pkGame.recordTips"),duration:3e3})}),1e3),localStorage.setItem("recordTips",!0))},methods:{getResultTxt(t){return t.receiver.user_id===this.userInfo.userId?(t.instanceId=t.receiver.instance_id,Number(t.receiver.score)>Number(t.initiator.score)?(t.resultTxt=this.$t("pkGame.meetSuccess"),t.resultCss="success"):Number(t.receiver.score)<Number(t.initiator.score)?(t.resultTxt=this.$t("pkGame.meetFail"),t.resultCss="fail"):(t.resultTxt=this.$t("pkGame.draw"),t.resultCss="success")):(t.instanceId=t.initiator.instance_id,Number(t.receiver.score)>Number(t.initiator.score)?(t.resultTxt=this.$t("pkGame.challengerFail"),t.resultCss="fail"):Number(t.receiver.score)<Number(t.initiator.score)?(t.resultTxt=this.$t("pkGame.challengerSuccess"),t.resultCss="success"):(t.resultTxt=this.$t("pkGame.draw"),t.resultCss="success")),t},showDetail(t){this.curItem=t,this.curItem.title=this.title,this.curItem.pkId=this.pkId,this.curItem.userId=this.userInfo.userId,this.curItem.isShare=!1,this.$refs.detail.$el.style.top="0",this.$refs.detail.$el.style.left="0"},hideDetail(){this.$refs.detail.$el.style.top="0",this.$refs.detail.$el.style.left="100vw",setTimeout((()=>{this.curItem=null}),500)},onLoad(){this.params.page_number+=1,this.params.type=this.pkType,c.Z.getAnswerRecordList(this.params,this.pkId).then((t=>{const{list:e,is_last_page:s}=t.data.data;if(e&&e.length>0){for(let t=0;t<e.length;t++)e[t]=this.getResultTxt(e[t]);let t=[...this.list,...e];this.list=u()(t)}this.list&&0!==this.list.length||(this.isEmpty=!0),this.isLoading=!1,"true"===s&&(this.isFinished=!0)}))}}},v=f,_=(0,s(1001).Z)(v,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"page cl-page-container"},[s("div",{staticClass:"title hidetxt"},[t._v(t._s(t.title))]),t.isEmpty?s("EmptyBox",{staticClass:"empty"}):s("div",{staticClass:"tab-content"},[s("van-list",{attrs:{"immediate-check":!1,"loading-text":t.$t("common.loading"),finished:t.isFinished,"finished-text":t.isFinished&&0===t.list.length?"":t.$t("common.noMore"),offset:100},on:{load:t.onLoad},model:{value:t.isLoading,callback:function(e){t.isLoading=e},expression:"isLoading"}},t._l(t.list,(function(e,a){return s("div",{key:a,staticClass:"van-tab-content",on:{click:function(s){return t.showDetail(e)}}},[s("div",{staticClass:"info"},[s("div",{staticClass:"info-challenger hidetxt"},[t._v(t._s(t.$t("pkGame.challenger"))+": "+t._s(e.initiator.user_name))]),s("div",{staticClass:"info-score hidetxt"},[t._v(t._s(t.$t("pkGame.scoreThisGame"))+": "+t._s(e.initiator.score))]),s("div",{staticClass:"info-meeter hidetxt"},[t._v(t._s(t.$t("pkGame.meeter"))+": "+t._s(e.receiver.user_name))]),s("div",{staticClass:"info-score hidetxt"},[t._v(t._s(t.$t("pkGame.meeterScore"))+": "+t._s(e.receiver.score))])]),s("div",{staticClass:"info"},[s("div",{staticClass:"info-time hidetxt"},[t._v(t._s(t._f("formatDate")(Number(e.time))))]),s("div",{staticClass:"info-state hidetxt"},[s("span",{class:e.resultCss},[t._v(t._s(e.resultTxt))])])]),s("div",{staticClass:"line"})])})),0)],1),t.isShowDetail?s("answer-record-single-detail",{ref:"detail",staticClass:"detail",attrs:{item:t.curItem}}):t._e()],1)}),[],!1,null,"9d43e5bc",null).exports},92275:(t,e,s)=>{s.r(e),s.d(e,{default:()=>p});var a=s(95082),i=(s(3791),s(93432)),n=(s(20581),s(50914)),o=(s(82500),s(49414)),r=(s(82522),s(10342)),l=(s(57658),s(33948),s(26294)),c=s(59688),d=s(22648),m=s(27479),h={name:"Ranking",components:{[r.Z.name]:r.Z,[o.Z.name]:o.Z,[n.Z.name]:n.Z,[i.Z.name]:i.Z,EmptyBox:m.Z},filters:{formatDate:function(t){return(0,d.p6)(Number(t),"yyyy-MM-dd  hh:mm")}},beforeRouteEnter(t,e,s){-1===e.path.indexOf("/pk/")&&(localStorage.removeItem("pkAnswerRecordActiveName"),localStorage.removeItem("pkMultiRankingActiveName"),localStorage.removeItem("pkTeamRankingActiveName"),localStorage.removeItem("pkRankingActiveName")),s()},beforeRouteLeave(t,e,s){if(e.meta.keepAlive){const t=document.querySelector(`#${this.activeName}`),s=t?t.scrollTop:0;e.meta.scrollTop=s}s()},data:()=>({activeName:"",loading:!0,isEmptyMulti:!1,isEmptyTeam:!1,isFinishedOngoingMultiPK:!1,isFinishedOngoingTeamPK:!1,isFinishedCompleteMultiPK:!1,isFinishedCompleteTeamPK:!1,isLoadingMultiPK:!1,isLoadingTeamPK:!1,multiPKList:[],teamPKList:[],onGoingMultiParams:{status:"processing",page_number:0,page_size:50,attend:"1",type:"multiple"},completeMultiParams:{status:"end",page_number:0,page_size:50,attend:"1",type:"multiple"},onGoingTeamParams:{status:"processing",page_number:0,page_size:50,attend:"1",type:"team"},completeTeamParams:{status:"end",page_number:0,page_size:50,attend:"1",type:"team"}}),computed:(0,a.Z)({},(0,l.mapGetters)({primaryColor:"getPrimaryColor",userInfo:"user/getUserInfo"})),watch:{activeName(t){t&&localStorage.setItem("pkAnswerRecordActiveName",t)}},mounted(){(0,d.Td)(this.$t("pkGame.answerRecord")),this.activeName=localStorage.getItem("pkAnswerRecordActiveName"),this.activeName||(this.activeName="multiPK",localStorage.setItem("pkAnswerRecordActiveName","multiPK")),this.onLoadMultiPK(),this.onLoadTeamPK()},methods:{scroll(){const{scrollTop:t}=this.$route.meta,e=document.querySelector(`#${this.activeName}`);t&&e&&(e.scrollTop=t)},showAnswerRecord(t,e,s){this.$router.push({path:`/home-module/pk/answer-record-single?pkId=${t}&pkType=${s}&title=${encodeURIComponent(e)}`})},onLoadMultiPK(){this.isFinishedOngoingMultiPK?this.onLoadMultiComplete():(this.onGoingMultiParams.page_number+=1,c.Z.getMyPkList(this.onGoingMultiParams).then((t=>{const{list:e,is_last_page:s}=t.data.data;e&&e.length>0&&(e.forEach((t=>{t.status=this.$t("pkGame.onGoing")})),this.multiPKList=[...this.multiPKList,...e]),"true"===s||""===s?(this.isFinishedOngoingMultiPK=!0,this.onLoadMultiComplete()):(this.isLoadingMultiPK=!1,this.loading=!1)})))},onLoadMultiComplete(){this.isFinishedCompleteMultiPK?this.isLoadingMultiPK=!1:(this.completeMultiParams.page_number+=1,c.Z.getMyPkList(this.completeMultiParams).then((t=>{const{list:e,is_last_page:s}=t.data.data;e&&e.length>0&&(e.forEach((t=>{t.status=this.$t("pkGame.complete")})),this.multiPKList=[...this.multiPKList,...e]),this.isLoadingMultiPK=!1,"true"!==s&&""!==s||(this.isFinishedCompleteMultiPK=!0),this.loading=!1,this.multiPKList&&0!==this.multiPKList.length||(this.isEmptyMulti=!0)})))},onLoadTeamPK(){this.isFinishedOngoingTeamPK?this.onLoadTeamComplete():(this.onGoingTeamParams.page_number+=1,c.Z.getMyPkList(this.onGoingTeamParams).then((t=>{const{list:e,is_last_page:s}=t.data.data;e&&e.length>0&&(e.forEach((t=>{t.status=this.$t("pkGame.onGoing")})),this.teamPKList=[...this.teamPKList,...e]),"true"===s||""===s?(this.isFinishedOngoingTeamPK=!0,this.onLoadTeamComplete()):(this.isLoadingTeamPK=!1,this.loading=!1)})))},onLoadTeamComplete(){this.isFinishedCompleteTeamPK?this.isLoadingTeamPK=!1:(this.completeTeamParams.page_number+=1,c.Z.getMyPkList(this.completeTeamParams).then((t=>{const{list:e,is_last_page:s}=t.data.data;e&&e.length>0&&(e.forEach((t=>{t.status=this.$t("pkGame.complete")})),this.teamPKList=[...this.teamPKList,...e]),this.isLoadingTeamPK=!1,"true"!==s&&""!==s||(this.isFinishedCompleteTeamPK=!0),this.loading=!1,this.teamPKList&&0!==this.teamPKList.length||(this.isEmptyTeam=!0)})))}}},u=h,p=(0,s(1001).Z)(u,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"page cl-page-container"},[t.loading?s("van-loading",{staticClass:"init-loading",attrs:{size:"36"}}):s("van-tabs",{attrs:{color:"var(--primary-color)","title-inactive-color":"#2D3040",sticky:""},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[s("van-tab",{attrs:{title:t.$t("pkGame.multiPk"),name:"multiPK"}},[t.isEmptyMulti?s("EmptyBox",{staticClass:"empty"}):s("div",{staticClass:"tab-content",attrs:{id:"multiPK"}},[s("van-list",{attrs:{"immediate-check":!1,"loading-text":t.$t("common.loading"),finished:t.isFinishedCompleteMultiPK,"finished-text":t.isFinishedCompleteMultiPK&&0===t.multiPKList.length?"":t.$t("common.noMore"),offset:100},on:{load:t.onLoadMultiPK},model:{value:t.isLoadingMultiPK,callback:function(e){t.isLoadingMultiPK=e},expression:"isLoadingMultiPK"}},t._l(t.multiPKList,(function(e){return s("div",{key:e.id,staticClass:"van-tab-content"},[s("div",{staticClass:"title hidetxt"},[t._v(t._s(e.title))]),s("div",{staticClass:"info"},[s("div",{staticClass:"info-type hidetxt"},[t._v(t._s(t.$t("pkGame.participants"))+": "+t._s(e.join_count))]),s("div",{staticClass:"info-time hidetxt"},[t._v(t._s(t.$t("pkGame.beginDate"))+": "+t._s(t._f("formatDate")(Number(e.start_time))))]),s("div",{staticClass:"info-num hidetxt",style:{color:e.status===t.$t("pkGame.onGoing")?"#24C17E":"#D8403D"}},[t._v(t._s(e.status))]),s("div",{staticClass:"info-time hidetxt"},[t._v(t._s(t.$t("pkGame.endDate"))+": "+t._s(t._f("formatDate")(Number(e.end_time))))])]),s("div",{staticClass:"line"}),s("div",{staticClass:"button",on:{click:function(s){return t.showAnswerRecord(e.id,e.title,"multiple")}}},[t._v(t._s(t.$t("pkGame.showAnswerRecord")))])])})),0)],1)],1),s("van-tab",{attrs:{title:t.$t("pkGame.teamPk"),name:"teamPK"}},[t.isEmptyTeam?s("EmptyBox",{staticClass:"empty"}):s("div",{staticClass:"tab-content",attrs:{id:"teamPK"}},[s("van-list",{attrs:{"immediate-check":!1,"loading-text":t.$t("common.loading"),finished:t.isFinishedCompleteTeamPK,"finished-text":t.isFinishedCompleteTeamPK&&0===t.teamPKList.length?"":t.$t("common.noMore"),offset:100},on:{load:t.onLoadTeamPK},model:{value:t.isLoadingTeamPK,callback:function(e){t.isLoadingTeamPK=e},expression:"isLoadingTeamPK"}},t._l(t.teamPKList,(function(e){return s("div",{key:e.id,staticClass:"van-tab-content"},[s("div",{staticClass:"title hidetxt"},[t._v(t._s(e.title))]),s("div",{staticClass:"info"},[s("div",{staticClass:"info-type hidetxt"},[t._v(t._s(t.$t("pkGame.participants"))+": "+t._s(e.join_count))]),s("div",{staticClass:"info-time hidetxt"},[t._v(t._s(t.$t("pkGame.beginDate"))+": "+t._s(t._f("formatDate")(Number(e.start_time))))]),s("div",{staticClass:"info-num hidetxt",style:{color:e.status===t.$t("pkGame.onGoing")?"#24C17E":"#D8403D"}},[t._v(t._s(e.status))]),s("div",{staticClass:"info-time hidetxt"},[t._v(t._s(t.$t("pkGame.endDate"))+": "+t._s(t._f("formatDate")(Number(e.end_time))))])]),s("div",{staticClass:"line"}),s("div",{staticClass:"button",on:{click:function(s){return t.showAnswerRecord(e.id,e.title,"team")}}},[t._v(t._s(t.$t("pkGame.showAnswerRecord")))])])})),0)],1)],1)],1)],1)}),[],!1,null,"4c1c836a",null).exports},27550:(t,e,s)=>{s.d(e,{Z:()=>h});var a=s(95082),i=s(26294),n=s(27479),o=s(22648),r=s(17563),l=s(27632),c=s(55602),d=s(78368),m={name:"AnswerRecordSingleDetail",components:{EmptyBox:n.Z},filters:{formatDate:function(t){return(0,o.p6)(Number(t),"yyyy-MM-dd  hh:mm")},plus:function(t){return t&&Number(t)<0?`${t}`:`+${t}`}},props:{item:{type:Object,required:!1,default:()=>({})}},data:()=>({me:{},vs:{},first:{},second:{},defalutAvatar:d,resHost:"https://gsdn.coolcollege.cn/coolcollege-vue-h5/pk-games/pk/",isShare:!1,t:null}),computed:(0,a.Z)({},(0,i.mapGetters)({primaryColor:"getPrimaryColor"})),watch:{item(t){this.initItem(t)}},mounted(){this.isShare="dingTalk"===l.Z.env,this.initItem(this.item)},methods:{shareMessage(t){if(console.warn("newItem=",t),"dingTalk"===l.Z.env){const e={user_id:t.userId,instance_id:t.instanceId,competition_id:t.pkId,flag:"pk_share"};(0,c.vD)({shareInfo:{title:this.item.title,desc:"我的PK赛",path:`/pages/messageRedirect/messageRedirect?${r.stringify(e)}`,imageUrl:`${this.resHost}share1.png`}})}},initItem(t){t&&t.initiator&&(t.userId===t.initiator.user_id?(this.me={user_name:t.initiator.user_name,avatar:t.initiator.avatar,score:t.initiator.score},this.vs=t.receiver,"success"===t.resultCss?(this.first=this.me,this.second=this.vs):(this.first=this.vs,this.second=this.me)):(this.me={user_name:t.receiver.user_name,avatar:t.receiver.avatar,score:t.receiver.score},this.vs=t.initiator,"success"===t.resultCss?(this.first=this.me,this.second=this.vs):(this.first=this.vs,this.second=this.me)),this.shareMessage(t))},share(){"dingTalk"===l.Z.env&&(this.t&&clearTimeout(this.t),document.getElementById("shareTips").style.opacity="1",this.t=setTimeout((()=>{document.getElementById("shareTips").style.opacity="0"}),5e3))},goPk(){l.Z.navigateTo({url:"/pages/pk-game/home/index"})}}},h=(0,s(1001).Z)(m,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"page"},[t.item?s("div",[s("div",{staticClass:"head-img"},[s("img",{attrs:{src:t.me.avatar||t.defalutAvatar}}),s("div",{staticClass:"name hidetxt"},[t._v(t._s(t.me.user_name))])]),s("div",{staticClass:"score-tab"},[s("div",{staticClass:"pk-name hidetxt"},[t._v(t._s(t.item.title))]),s("div",{staticClass:"state"},[t._v(t._s(t.item.resultTxt))]),s("div",{staticClass:"experience"},[s("div",[t._v(t._s(t.$t("pointsMall.points"))+"："+t._s(t._f("plus")(t.item.gain_point)))]),s("div",[t._v(t._s(t.$t("pkGame.experience"))+"："+t._s(t._f("plus")(t.item.experience_score)))])]),s("div",{staticClass:"score"},[t._v(t._s(t.$t("pkGame.scoreThisGame"))+"："+t._s(t.me.score))]),s("div",{staticClass:"line"}),s("div",{staticClass:"info"},[s("div",{staticClass:"info1 hidetxt"},[s("img",{staticClass:"rank-img",attrs:{src:t.resHost+"1@3x.png"}})]),s("div",{staticClass:"info2 hidetxt"},[s("img",{attrs:{src:t.first.avatar||t.defalutAvatar}})]),s("div",{staticClass:"info3 hidetxt"},[t._v(" "+t._s(t.first.user_name)+" ")]),s("div",{staticClass:"info4 hidetxt"},[t._v(t._s(t.first.score)+t._s(t.$t("pkGame.mark")))])]),s("div",{staticClass:"info"},[s("div",{staticClass:"info1 hidetxt"},[s("img",{staticClass:"rank-img",attrs:{src:t.first.score===t.second.score?t.resHost+"1@3x.png":t.resHost+"2@3x.png"}})]),s("div",{staticClass:"info2 hidetxt"},[s("img",{attrs:{src:t.second.avatar||t.defalutAvatar}})]),s("div",{staticClass:"info3 hidetxt"},[t._v(" "+t._s(t.second.user_name)+" ")]),s("div",{staticClass:"info4 hidetxt"},[t._v(t._s(t.second.score)+t._s(t.$t("pkGame.mark")))])]),t.item&&t.item.time?s("div",{staticClass:"begin-time"},[t._v(t._s(t._f("formatDate")(Number(t.item.time))))]):t._e()]),t.item.isShare?s("div",{staticClass:"bottom-btn"},[s("div",{staticClass:"btn",on:{click:t.goPk}},[t._v(t._s(t.$t("pkGame.iWantPk")))])]):s("div",{staticClass:"bottom-btn"},[t.isShare?s("div",{staticClass:"btn",on:{click:t.share}},[t._v(t._s(t.$t("pkGame.share")))]):t._e()])]):s("EmptyBox",{staticClass:"empty"}),s("div",{staticClass:"share-tips",attrs:{id:"shareTips"}},[t._v(t._s(t.$t("pkGame.shareTips")))])],1)}),[],!1,null,"5e0e8042",null).exports},56646:(t,e,s)=>{s.d(e,{Z:()=>m});var a=s(95082),i=(s(3791),s(93432)),n=(s(74916),s(15306),s(26294)),o=s(17563),r=s(27632),l=s(55602),c=s(78368),d={name:"GameFrame",components:{[i.Z.name]:i.Z},props:{pkId:{type:String,required:!0,default:""},pkType:{type:String,required:!0,default:""},matchData:{type:Object,required:!1,default:()=>({})}},data:()=>({defalutAvatar:c,iframeWin:{},reMatchTxt:"",title:"",isGameLoaded:!1,isPageLoaded:!1,msgData:{},url:"",instanceId:"",t:null,resHost:"https://gsdn.coolcollege.cn/coolcollege-vue-h5/pk-games/pk/"}),computed:(0,a.Z)({},(0,n.mapGetters)({primaryColor:"getPrimaryColor",userInfo:"user/getUserInfo"})),watch:{isGameLoaded:{handler:function(){this.startGame()},deep:!0},isPageLoaded:{handler:function(){this.postGameData()},deep:!0}},beforeDestroy(){window.removeEventListener("message",this.messageFun,!1)},mounted(){this.reMatchTxt=this.$t("pkGame.reMatch"),this.url=`${GAME_HOST}/index.html?gameType=pk-game-mobile&loglvl=0&t=${(new Date).getTime()}`,window.addEventListener("message",this.messageFun,!1)},methods:{messageFun(t){try{let{data:e}=t;"pk_game"===e.from&&("right"===e.name?this.playAudio("right"):"wrong"===e.name?this.playAudio("wrong"):"click"===e.name?this.playAudio("click"):"page_loaded"===e.name?this.isPageLoaded=!0:"download_success"===e.name?this.isGameLoaded=!0:"download_failure"===e.name?document.getElementById("pkGameFrame").contentWindow.postMessage({name:"reload_page",from:"pk_game_container",data:null},"*"):"continue_pk"===e.name?this.goBack():"show_score"===e.name&&this.share())}catch(t){console.error(t)}},reload(){this.$emit("reMatch")},setAvatar:t=>t.indexOf("https://static-legacy.dingtalk.com")>-1?t.replace("https://static-legacy.dingtalk.com","https://pk-proxy.coolcollege.cn"):t.indexOf("https://wework.qpic.cn")>-1?t.replace("https://wework.qpic.cn","https://pk-proxy.coolcollege.cn"):t,postGameData(){let t=this.matchData;this.isPageLoaded&&t&&t.pk_game_info&&(this.matchData&&this.matchData.avatar&&(t.avatar=this.setAvatar(this.matchData.avatar)),this.matchData&&this.matchData.vs_user&&this.matchData.vs_user.avatar&&(t.vs_user.avatar=this.setAvatar(this.matchData.vs_user.avatar)),t.accessToken=this.userInfo.accessToken,t.enterpriseApi=`${CL_API}/interaction-api`,t.env=r.Z.env,t.isShare="dingTalk"===r.Z.env,this.title=this.matchData.pk_game_info.title,this.instanceId=this.matchData.pk_game_info.instance_id,this.msgData={name:"match_data",from:"pk_game_container",data:t},document.getElementById("pkGameFrame").contentWindow.postMessage(this.msgData,"*"),this.shareMessage(this.matchData))},shareMessage(t){if("dingTalk"===r.Z.env){const e={user_id:t.user_id,instance_id:t.pk_game_info.instance_id,competition_id:t.pk_game_info.id,flag:"pk_share"};(0,l.vD)({shareInfo:{title:t.pk_game_info.title,desc:"我的PK赛",path:`/pages/messageRedirect/messageRedirect?${o.stringify(e)}`,imageUrl:`${this.resHost}share1.png`}})}},startGame(){this.isGameLoaded&&(document.getElementById("pkGameFrame").style.opacity="1",document.getElementById("pkGameFrame").contentWindow.postMessage({name:"start_game",from:"pk_game_container",data:null},"*"))},goBack(){this.$emit("hide")},share(){"dingTalk"===r.Z.env&&(this.t&&clearTimeout(this.t),document.getElementById("shareTips").style.opacity="1",document.getElementById("shareTips").style.top="12px",this.t=setTimeout((()=>{document.getElementById("shareTips").style.opacity="0",document.getElementById("shareTips").style.top="-120px"}),5e3))},playAudio(t){let e="";switch(t){case"right":e=`${this.resHost}right.mp3`;break;case"wrong":e=`${this.resHost}wrong.mp3`;break;case"click":e=`${this.resHost}click.mp3`}if(e){let t=new Audio;t.src=e,t.play(),console.warn("audio.src",t.src)}}}},m=(0,s(1001).Z)(d,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"fixed-page"},[t.isGameLoaded?t._e():s("van-loading",{attrs:{type:"spinner",size:"36"}}),s("iframe",{staticClass:"iframe",attrs:{id:"pkGameFrame",frameborder:"0",src:t.url}}),s("div",{staticClass:"share-tips",attrs:{id:"shareTips"}},[t._v(t._s(t.$t("pkGame.shareTips")))])],1)}),[],!1,null,"539d589a",null).exports},41354:(t,e,s)=>{s.d(e,{Z:()=>l});var a=s(95082),i=(s(66528),s(74916),s(15306),s(26294)),n=s(22648),o=s(78368),r={name:"MyRank",components:{},props:{myRankInfo:{type:Object,required:!1,default:()=>({})},isTeam:{type:Boolean,required:!1,default:!1},isTeamTeam:{type:Boolean,required:!1,default:!1}},data:()=>({isIpx:(0,n.Rq)(),defalutAvatar:o,myScore:"",myRankTxt:""}),computed:(0,a.Z)({},(0,i.mapGetters)({primaryColor:"getPrimaryColor",userInfo:"user/getUserInfo"})),mounted(){this.myRankTxt=this.$t("pkGame.unrated"),this.myRankInfo&&this.myRankInfo.rank&&(this.myRankTxt=this.getRanking(this.myRankInfo.rank),!0===this.isTeamTeam?this.myScore=this.formatScore(this.myRankInfo.average_score):this.myScore=this.myRankInfo.score)},methods:{formatScore(t){let e=t.split(".");if(1===e.length)return`${e[0]}.00`;if(2===e.length){let t=e[1].padEnd(2,"0");return`${e[0]}.${t}`}return t},getRanking(t){return"0"===t?this.$t("pkGame.entered"):this.$t("pkGame.ranking").replace("#",t)}}},l=(0,s(1001).Z)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.isTeam?s("div",{staticClass:"my-rank-div",style:{height:t.isIpx?"11vh":"8vh"}},[s("div",{staticClass:"my-rank"},[s("div",{staticClass:"info1 hidetxt"},[t._v(t._s(t.myRankTxt))]),t.isTeamTeam?t._e():s("div",{staticClass:"info2 hidetxt"},[s("img",{staticClass:"head-img",attrs:{src:t.userInfo.avatar||t.defalutAvatar}})]),t.isTeamTeam?t._e():s("div",{staticClass:"info3 hidetxt"},[t._v(" "+t._s(t.myRankInfo.name)+" ")]),s("div",{staticClass:"info3 hidetxt"},[t._v(" "+t._s(t.myRankInfo.group_name)+" ")]),s("div",{staticClass:"info4 hidetxt"},[t._v(t._s(t.myScore))])]),t.isIpx?s("div",{staticClass:"ios-bottom"}):t._e()]):s("div",{staticClass:"my-rank-div",style:{height:t.isIpx?"11vh":"8vh"}},[s("div",{staticClass:"my-rank"},[s("div",{staticClass:"info1 hidetxt"},[t._v(t._s(t.myRankTxt))]),s("div",{staticClass:"info2 hidetxt"},[s("img",{staticClass:"head-img",attrs:{src:t.userInfo.avatar||t.defalutAvatar}})]),s("div",{staticClass:"info3 hidetxt"},[t._v(" "+t._s(t.myRankInfo.name)+" ")]),s("div",{staticClass:"info4 hidetxt"},[t._v(t._s(t.myScore))])]),t.isIpx?s("div",{staticClass:"ios-bottom"}):t._e()])])}),[],!1,null,"04f23a60",null).exports},872:(t,e,s)=>{s.d(e,{Z:()=>n});var a=s(78368),i={name:"RankItem",props:{item:{type:Object,required:!0,default:()=>({})},pkType:{type:String,required:!0,default:""}},data:()=>({defalutAvatar:a,resHost:"https://gsdn.coolcollege.cn/coolcollege-vue-h5/pk-games/pk/"})},n=(0,s(1001).Z)(i,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"info"},[Number(t.item.rank)>3?s("div",{staticClass:"info1 hidetxt"},[t._v(t._s(t.item.rank))]):t._e(),Number(t.item.rank)<4?s("div",{staticClass:"info1 hidetxt"},[s("img",{staticClass:"rank-img",attrs:{src:t.resHost+t.item.rank+"@3x.png"}})]):t._e(),s("div",{staticClass:"info2 hidetxt"},[s("img",{staticClass:"head-img",attrs:{src:t.item.avatar||t.defalutAvatar}})]),s("div",{staticClass:"info3 hidetxt"},[s("div",{staticClass:"name  hidetxt"},[t._v(t._s(t.item.name))]),t.item.department_name&&""!=t.item.department_name?s("div",{staticClass:"depart  hidetxt"},[t._v(t._s(t.item.department_name))]):t._e()]),t.pkType.indexOf("team")>-1?s("div",{staticClass:"info4 hidetxt"},[t._v(t._s(t.item.group_name))]):t._e(),s("div",{staticClass:"info4 hidetxt"},[t._v(t._s(t.item.score))])])}),[],!1,null,"0871ec3d",null).exports},41264:(t,e,s)=>{s.r(e),s.d(e,{default:()=>d});s(74916),s(15306),s(57658);var a=s(59688),i=s(22648),n={name:"Info",props:{item:{type:Object,required:!0,default:()=>({})}},data:()=>({})},o=s(1001),r=(0,o.Z)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"pk_info"},[s("div",{staticClass:"image"},[s("img",{staticClass:"image_icon",attrs:{mode:"aspectFit",src:t.item.image}})]),s("div",{staticClass:"title"},[t._v(t._s(t.item.title))]),s("div",{staticClass:"score"},[t._v(t._s(t.item.score))])])}),[],!1,null,"be76f1ba",null).exports,l=s(78368),c={name:"MyPk",components:{Info:r},data:()=>({defalutAvatar:l,isEn:!1,myPkData:{},list:[]}),computed:{},created(){},mounted(){(0,i.Td)(this.$t("pkGame.myPk")),this.init()},methods:{init(){if(this.$i18n.locale){let t=this.$i18n.locale.replace("-","_");this.isEn="en_us"===t}a.Z.getPkData().then((t=>{"true"===t.data.success&&t.data.data&&(this.myPkData=t.data.data,this.list=[{image:"https://oss.coolcollege.cn/1798602342275354624.png",title:this.$t("pkGame.totalNumber"),score:this.myPkData.total,key:1},{image:"https://oss.coolcollege.cn/1798602346348023808.png",title:this.$t("pkGame.victory"),score:this.myPkData.win_count,key:2},{image:"https://oss.coolcollege.cn/1798602347828613120.png",title:this.$t("pkGame.getPoints"),score:this.myPkData.experience_point,key:3}])}))},linkToPage(t){let e="";switch(t){case"practice":e="/home-module/practice";break;case"ranking":e="/home-module/pk/ranking";break;case"record":e="/home-module/pk/answer-record";break;case"team":e="/home-module/pk/team-pk/team-pk";break;case"multi":e="/home-module/pk/multi-pk/multi-pk"}e&&this.$router.push({path:e})}}},d=(0,o.Z)(c,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"page cl-page-container pk_game_container"},[s("div",{staticClass:"user_info"},[s("div",{staticClass:"head"},[s("div",{staticClass:"avatar"},[s("img",{attrs:{src:t.myPkData.avatar||t.defalutAvatar,mode:"aspectFit"}})]),s("div",{staticClass:"name"},[t._v(t._s(t.myPkData.name))])]),s("div",{staticClass:"rate"},[t._v(t._s(t.$t("pkGame.winRate"))+": "+t._s(t.myPkData.win_rate))])]),s("div",{staticClass:"userData"},t._l(t.list,(function(t){return s("Info",{key:t.key,attrs:{item:t}})})),1),s("div",{staticClass:"pk_tips"},[t._v(" "+t._s(t.$t("pkGame.homeTip"))+" ")]),s("div",{staticClass:"competition"},[s("div",{staticClass:"text"},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("pkGame.quizShow")))]),s("div",{staticClass:"desc"},[t._v(t._s(t.$t("pkGame.PKSkills")))])]),s("div",{staticClass:"my_pk",on:{click:function(e){return t.linkToPage("record")}}},[t._v(" "+t._s(t.$t("pkGame.answerRecord"))+" ")])]),s("div",{staticClass:"card"},[s("div",{staticClass:"card-row1"},[s("div",{staticClass:"card-row1-col1",on:{click:function(e){return t.linkToPage("team")}}},[s("img",{staticClass:"card_img",attrs:{src:t.isEn?"https://oss.coolcollege.cn/1831133284705374208.png":"https://oss.coolcollege.cn/1798604759356280832.png"}})]),s("div",{staticClass:"card-row1-col2"},[s("img",{attrs:{src:t.isEn?"https://oss.coolcollege.cn/1831133179449315328.png":"https://oss.coolcollege.cn/1798604765056339968.png"},on:{click:function(e){return t.linkToPage("multi")}}}),s("img",{attrs:{src:t.isEn?"https://oss.coolcollege.cn/1831133228539449344.png":"https://oss.coolcollege.cn/1798604799470604288.png"},on:{click:function(e){return t.linkToPage("practice")}}})])]),s("div",{staticClass:"card-row2",on:{click:function(e){return t.linkToPage("ranking")}}},[s("img",{staticClass:"card_img",attrs:{src:t.isEn?"https://oss.coolcollege.cn/1831133307505610752.png":"https://oss.coolcollege.cn/1823878847993614336.png"}})])])])}),[],!1,null,"bda40100",null).exports},74188:(t,e,s)=>{s.r(e),s.d(e,{default:()=>Z});var a=s(95082),i=(s(47601),s(44951)),n=(s(31146),s(41610)),o=(s(34837),s(39146)),r=(s(3791),s(93432)),l=(s(23307),s(81392)),c=(s(41817),s(74916),s(15306),s(4723),s(26294)),d=s(59688),m=s(22648),h=s(98512),u=s(27632),p=(s(58052),s(68286)),g=(s(20581),s(50914)),f=(s(33948),s(27479)),v=s(78368),_={name:"MasterRankingItem",props:{item:{type:Object,required:!0,default:()=>({})},pkType:{type:String,required:!0,default:""}},data:()=>({defalutAvatar:v,resHost:"https://gsdn.coolcollege.cn/coolcollege-vue-h5/pk-games/pk/"}),methods:{change(){this.$emit("select",this.item)}}},y=s(1001),C=(0,y.Z)(_,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"info",on:{click:t.change}},[Number(t.item.rank)>3?s("div",{staticClass:"info1 hidetxt"},[t._v(t._s(t.item.rank))]):t._e(),Number(t.item.rank)<4?s("div",{staticClass:"info1 hidetxt"},[s("img",{staticClass:"rank-img",attrs:{src:t.resHost+t.item.rank+"@3x.png"}})]):t._e(),s("div",{staticClass:"info2 hidetxt"},[s("img",{staticClass:"head-img",attrs:{src:t.item.avatar||t.defalutAvatar}})]),s("div",{staticClass:"info3 hidetxt"},[s("div",{staticClass:"name hidetxt"},[t._v(t._s(t.item.name))]),t.item.department_name&&""!=t.item.department_name?s("div",{staticClass:"depart hidetxt"},[t._v(t._s(t.item.department_name))]):t._e()]),t.pkType.indexOf("team")>-1?s("div",{staticClass:"info4 hidetxt"},[t._v(t._s(t.item.group_name))]):t._e(),s("div",{staticClass:"info4 hidetxt"},[t._v(t._s(t.item.score))])])}),[],!1,null,"5dee1bab",null).exports,k={name:"MasterRankingList",components:{[g.Z.name]:g.Z,[o.Z.name]:o.Z,[l.Z.name]:l.Z,[r.Z.name]:r.Z,[p.Z.name]:p.Z,[n.Z.Component.name]:n.Z.Component,EmptyBox:f.Z,MasterRankingItem:C},filters:{formatDate:function(t){return(0,m.p6)(t,"yyyy-MM-dd  hh:mm")}},props:{pkId:{type:String,required:!0,default:""},pkType:{type:String,required:!0,default:""}},data:()=>({pullingTxt:"",loosingTxt:"",loadingTxt:"",isFinished:!1,isLoading:!1,isFreshLoading:!1,loading:!1,isEmpty:!1,curItem:"",myTeam:null,invalid_time_stamp:"",time_stamp:"",list:[],params:{score_type:"single",user_type:"",page_number:1,page_size:20,query_tops:!0},isBlockClick:!1,resHost:"https://gsdn.coolcollege.cn/coolcollege-vue-h5/pk-games/pk/",interval:null,showRule:!1,ruleMsg:"",refreshTxt:""}),computed:(0,a.Z)({},(0,c.mapGetters)({primaryColor:"getPrimaryColor",userInfo:"user/getUserInfo"})),beforeDestroy(){this.interval&&clearInterval(this.interval)},mounted(){this.onLoad(),this.getMyTeam(),this.interval=setInterval((()=>{let t=(new Date).getTime();this.invalid_time_stamp&&Number(this.invalid_time_stamp)<t?(this.loosingTxt=this.$t("pkGame.refreshNow"),this.loadingTxt=this.$t("pkGame.refreshNow")):(this.loosingTxt=`${this.$t("pkGame.refreshTime")}:${(0,m.p6)(Number(this.invalid_time_stamp),"yyyy-MM-dd  hh:mm")}`,this.loadingTxt="")}),1e3),localStorage.getItem("masterRankingRefreshTips")||localStorage.setItem("masterRankingRefreshTips",!0)},methods:{onRefresh(){let t=(new Date).getTime();this.invalid_time_stamp&&Number(this.invalid_time_stamp)<t&&(this.list=[],this.onLoad()),this.isFreshLoading=!1},getMyTeam(){d.Z.getMyTeam(this.pkId).then((t=>{t.data&&"true"===t.data.success?this.myTeam=t.data.data:o.Z.fail(this.$t("promptMessage.systemError"))}))},onLoad(){switch(this.pkType){case"multi":this.params.user_type="multiple",this.params.page_size=10;break;case"team":this.params.user_type="team",this.params.page_size=20}d.Z.getRankingList(this.params,this.pkId).then((t=>{const{list:e,me:s}=t.data.data;this.list=[...this.list,...e],this.isLoading=!1,this.isFinished=!0,s&&(this.invalid_time_stamp=s.invalid_time_stamp,this.time_stamp=s.time_stamp,this.refreshTxt=this.$t("pkGame.pullRefresh").replace("%d",`${(0,m.p6)(Number(this.invalid_time_stamp),"hh:mm")}`),this.pullingTxt=`${this.$t("pkGame.recordTime")}:${(0,m.p6)(Number(this.time_stamp),"yyyy-MM-dd  hh:mm")}`,this.loosingTxt=`${this.$t("pkGame.refreshTime")}:${(0,m.p6)(Number(this.invalid_time_stamp),"yyyy-MM-dd  hh:mm")}`),this.loading=!1,this.isFreshLoading=!1,this.list&&0!==this.list.length||(this.isEmpty=!0)}))},cancel(){this.$emit("handleCancel",!1)},changeCuid(t){this.curItem=t},doMatching(){if(!this.isBlockClick){if(this.isBlockClick=!0,setTimeout((()=>{this.isBlockClick=!1}),3e3),!this.curItem)return o.Z.fail(this.$t("pkGame.pleaseChooseVsuser")),!1;this.curItem.user_id!==this.userInfo.userId?this.pkType.indexOf("team")>-1&&this.curItem.group_name===this.myTeam.team_name?o.Z.fail(this.$t("pkGame.noCompetitionWithTeammates")):this.$emit("handleMatching",this.curItem):o.Z.fail(this.$t("pkGame.noCompetitionWithYourself"))}},doShowRule(){this.ruleMsg=-1===this.pkType.indexOf("team")?this.$t("pkGame.masterMultRule"):this.$t("pkGame.masterTeamRule"),this.showRule=!0}}},b=k,$=(0,y.Z)(b,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"mask"},[s("div",{staticClass:"master-page"},[s("div",{staticClass:"top-btn"},[s("img",{attrs:{src:t.resHost+"icon_down@2x.png"},on:{click:function(e){return t.cancel()}}}),s("van-icon",{staticClass:"close",attrs:{name:"cross",size:"6vw"},on:{click:function(e){return t.cancel()}}})],1),s("div",{staticClass:"title"},[t._v(t._s(t.$t("pkGame.masterRanking")))]),s("div",{staticClass:"promote-txt"},[s("div",[t._v(t._s(t.refreshTxt))]),s("div",{style:{color:t.primaryColor},on:{click:t.doShowRule}},[t._v(t._s(t.$t("pkGame.rule")))])]),t.loading?s("van-loading",{staticClass:"init-loading",attrs:{size:"36"}}):t._e(),s("div",{staticClass:"tab-content"},[s("div",{staticClass:"van-tab-content"},[s("van-pull-refresh",{staticClass:"refresh",attrs:{"pulling-text":t.pullingTxt,"loosing-text":t.loosingTxt,"loading-text":t.loadingTxt},on:{refresh:t.onRefresh},model:{value:t.isFreshLoading,callback:function(e){t.isFreshLoading=e},expression:"isFreshLoading"}},[t.isEmpty?s("EmptyBox",{staticClass:"empty"}):t._e(),s("van-list",{attrs:{"immediate-check":!1,"loading-text":t.$t("common.loading"),finished:t.isFinished,"finished-text":t.isFinished&&0===t.list.length?"":t.$t("common.noMore"),offset:100},on:{load:t.onLoad},model:{value:t.isLoading,callback:function(e){t.isLoading=e},expression:"isLoading"}},t._l(t.list,(function(e,a){return s("master-ranking-item",{key:a,style:{backgroundColor:e.user_id===t.curItem.user_id?"#E1E7FC":"#FFFFFF"},attrs:{item:e,"pk-type":t.pkType},on:{select:function(e){return t.changeCuid(e)}}})})),1)],1)],1)]),s("div",{staticClass:"btn-div"},[t.list&&0!==t.list.length?s("div",{staticClass:"button",on:{click:t.doMatching}},[t._v(t._s(t.$t("pkGame.startChallenge")))]):s("div",{staticClass:"button",staticStyle:{"background-color":"#ABB2BA"}},[t._v(t._s(t.$t("pkGame.startChallenge")))])])],1),s("van-dialog",{attrs:{"confirm-button-text":t.$t("common.confirm"),"message-align":"left"},model:{value:t.showRule,callback:function(e){t.showRule=e},expression:"showRule"}},[s("div",{staticClass:"dialog"},[s("div",{staticClass:"txt",domProps:{innerHTML:t.xss(t._s(t.ruleMsg))}})])])],1)}),[],!1,null,"0b64ca7e",null).exports,T=s(56646),x={name:"Ranking",components:{[l.Z.name]:l.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[n.Z.Component.name]:n.Z.Component,MasterRanking:$,GameFrame:T.Z,VanImage:i.Z},beforeRouteLeave(t,e,s){this.hideGameFrame(),s()},data:()=>({interval:null,defaultAvatar:v,pkId:"",continuePkId:"",continueInstanceId:"",netWorkState:!0,ruleMsgTxt:"",pkType:"",isShowRule:!1,isShowMaster:!1,isShowContinue:!1,params:{vs_user_id:""},matchData:{},start:!1,resHost:"",isBlockClick:!1,ruleNum:6,showHome:!1}),computed:(0,a.Z)({},(0,c.mapGetters)({primaryColor:"getPrimaryColor",userInfo:"user/getUserInfo"})),beforeDestroy(){this.interval&&clearInterval(this.interval)},created(){const t=(0,h.DP)();this.pkId=t.pkId,this.pkType=t.pkType,this.msg=t.msg},mounted(){"true"===this.msg&&(this.showHome=!0),"multi"===this.pkType?(0,m.Td)(this.$t("pkGame.multiPk")):"team"===this.pkType&&(0,m.Td)(this.$t("pkGame.teamPk")),this.isContinue();let t=localStorage.getItem("pkRuleIds");t&&-1!==t.indexOf(this.pkId)||(t+=`${this.pkId},`,localStorage.setItem("pkRuleIds",t),this.showRule(!0)),this.resHost="https://gsdn.coolcollege.cn/coolcollege-vue-h5/pk-games/pk/",this.getRuleTxt(),this.interval=setInterval((()=>{this.onLine().then((t=>{this.netWorkState=t}))}),4e3)},methods:{isContinue(){d.Z.unfinish().then((t=>{let{data:e}=t;e&&e.me&&e.pk_game_info&&(this.matchData=e,this.continuePkId=e.pk_game_info.id,this.continueInstanceId=this.matchData.pk_game_info.instance_id,this.isShowContinue=!0)}))},onLine(){let t=new Image;return t.src=`${this.defaultAvatar}?t=${Date.now()}`,new Promise((e=>{t.onload=function(){e(!0)},t.onerror=function(){e(!1)}}))},getRuleTxt(){d.Z.getPkRule(this.pkId).then((t=>{if(t.data&&"true"===t.data.success){let{data:e}=t.data;e.description&&e.description.length>0&&(this.ruleMsgTxt+=`<p>${this.$t("pkGame.challengeRule")}：</p><p>${e.description}</p><br/>`);let s=this.$t("pkGame.ruleMsg");s="no"===e.limit_type?s.replace("%d0",this.$t("pkGame.limitNo")):"all"===e.limit_type?s.replace("%d0",this.$t("pkGame.limitAll").replace("%d",e.limit_times)):s.replace("%d0",this.$t("pkGame.limitDay").replace("%d",e.limit_times)),s=s.replace("%d1",e.question_num),s=s.replace("%d2",e.expect_correct_score),s=s.replace("%d3",e.answer_time),s=s.replace("%d4",e.score),s=s.replace("%d5",e.answer_time_score),s=s.replace("%d6",e.gain_point),s=s.replace("%d7",e.gain_experience_point),s=s.replace("%d8",e.deduction_point),s=s.replace("%d9",e.deduction_experience_point),s=s.replace("%da",e.left_time),this.ruleMsgTxt+=s,this.ruleMsgTxt+=this.getLeaderboardRewards(e.leaderboard_rewards_total,"pkGame.leaderboardRewardsTotal"),this.ruleMsgTxt+=this.getLeaderboardRewards(e.leaderboard_rewards_high,"pkGame.leaderboardRewardsHigh"),this.ruleMsgTxt+=this.getLeaderboardRewards(e.leaderboard_rewards_group_average,"pkGame.leaderboardRewardsGroupAverage")}}))},getLeaderboardRewards(t,e){let s="";if(t&&t.length>0){this.ruleNum++,s=`<p>${this.ruleNum+this.$t(e)}</p>`;for(let e=0;e<t.length;e++){let a=t[e],i=this.$t("pkGame.leaderboardRewards");i=i.replace("%d1",a.reward_order),i=i.replace("%d2",a.gain_point),i=i.replace("%d3",a.gain_experience_point),s+=i}}return s},showRule(t){this.isShowRule=t},showMaster(t){!0===t?(this.isShowMaster=!0,setTimeout((()=>{this.$refs.masterRanking.$el.style.opacity=1}),100)):(this.$refs.masterRanking.$el.style.opacity=0,setTimeout((()=>{this.isShowMaster=!1}),1e3))},doMatch(t){if(this.isBlockClick)return;this.isBlockClick=!0,setTimeout((()=>{this.isBlockClick=!1}),3e3);let e={};if(t){if(t.user_id===this.userInfo.userId)return void o.Z.fail(this.$t("pkGame.noCompetitionWithYourself"));this.showMaster(!1),e={pk_type:"masterDuel",vs_instance_id:t.instance_id,vs_user_id:t.user_id,timestamp:Date.now()}}else e={pk_type:"random",timestamp:Date.now()};d.Z.match(e,this.pkId).then((t=>{t.data&&t.data.pk_game_info?(this.matchData=t.data,this.showGameFrame()):!t.data||"false"!==t.data.success&&!1!==t.data.success?o.Z.fail(this.$t("common.serverFailure")):n.Z.alert({title:this.$t("common.reminder"),message:t.data.message}).then((()=>{}))}))},playGame(){this.showHome=!1,this.isShowContinue=!1,this.pkId=this.continuePkId,this.start=!0},giveUp(){this.matchData&&this.matchData.pk_game_info?d.Z.gameOver(this.continuePkId,this.continueInstanceId).then((()=>{this.isShowContinue=!1})):this.isShowContinue=!1},showGameFrame(){this.$nextTick((()=>{this.start=!0,this.showHome=!1}))},hideGameFrame(){this.$nextTick((()=>{this.start=!1})),"true"===this.msg&&(this.showHome=!0)},linkToHome(){(0,m.o2)(),localStorage.removeItem("fullPath"),this.$router.replace({path:"/home-module"}),u.Z.goHome()}}},Z=(0,y.Z)(x,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page cl-page-container"},[t.showHome?a("div",{staticClass:"home-link-msg",on:{click:t.linkToHome}},[a("van-image",{staticClass:"home-link-image",attrs:{src:s(12548)}})],1):t._e(),a("div",{ref:"rule",staticClass:"rule-icon",on:{click:function(e){return t.showRule(!0)}}},[a("van-icon",{attrs:{name:"info-o",size:"3.6vw",color:"#FFFFFF"}}),a("span",{staticClass:"txt"},[t._v(t._s(t.$t("pkGame.rule")))])],1),a("div",{staticClass:"head-img"},[a("img",{attrs:{src:t.userInfo.avatar||t.defaultAvatar}}),a("div",{staticClass:"name van-ellipsis"},[t._v(t._s(t.userInfo.name))])]),a("div",{staticClass:"vs"},[a("img",{attrs:{src:t.resHost+"vs@2x.png"}})]),a("div",{staticClass:"btn-div"},[a("div",{staticClass:"btn",on:{click:function(e){return t.showMaster(!0)}}},[a("img",{attrs:{src:t.resHost+"killer@2x.png"}}),a("div",{staticClass:"txt"},[t._v(t._s(t.$t("pkGame.challengeMaster")))])]),a("div",{staticClass:"btn",on:{click:function(e){return t.doMatch(null)}}},[a("img",{attrs:{src:t.resHost+"match@2x.png"}}),a("div",{staticClass:"txt"},[t._v(t._s(t.$t("pkGame.randomMatching")))])])]),a("div",{staticClass:"bottom"},[a("div",{staticClass:"txt",class:"dot-"+t.netWorkState},[t._v(t._s(t.netWorkState?t.$t("pkGame.yourNetworkIsUnblocked"):t.$t("pkGame.yourNetworkIsBlocked")))]),a("div",{staticClass:"txt"},[t._v(t._s(t.$t("pkGame.keepGoodNetwork")))])]),t.isShowRule?a("div",{staticClass:"rule-info"},[a("div",{staticClass:"content"},[a("div",{staticClass:"title"},[t._v(t._s(t.$t("pkGame.rule")))]),a("div",{staticClass:"txt",domProps:{innerHTML:t.xss(t._s(t.ruleMsgTxt))}})]),a("div",{staticClass:"close-rule",on:{click:function(e){return t.showRule(!1)}}})]):t._e(),t.isShowMaster?a("master-ranking",{ref:"masterRanking",staticClass:"master-ranking",attrs:{"pk-type":t.pkType,"pk-id":t.pkId},on:{handleMatching:function(e){return t.doMatch(e)},handleCancel:function(e){return t.showMaster(e)}}}):t._e(),t.isShowContinue?a("div",{staticClass:"ongoing-game"},[a("img",{attrs:{src:t.resHost+"ongoing_game@2x.png"}}),a("div",{staticClass:"bottom-btn"},[a("div",{staticClass:"btn",on:{click:t.giveUp}},[t._v(t._s(t.$t("pkGame.giveUp")))]),a("div",{staticClass:"btn",on:{click:t.playGame}},[t._v(t._s(t.$t("pkGame.continue")))])])]):t._e(),t.start?a("game-frame",{staticClass:"gframe",attrs:{"pk-type":t.pkType,"pk-id":t.pkId,"match-data":t.matchData},on:{hide:function(e){return t.hideGameFrame()}}}):t._e()],1)}),[],!1,null,"438a5a4b",null).exports},18734:(t,e,s)=>{s.r(e),s.d(e,{default:()=>b});var a=s(95082),i=(s(31146),s(41610)),n=(s(58052),s(68286)),o=(s(20581),s(50914)),r=(s(34837),s(39146)),l=(s(82500),s(49414)),c=(s(82522),s(10342)),d=(s(3791),s(93432)),m=(s(33948),s(74916),s(15306),s(26294)),h=s(98512),u=s(22648),p=s(44908),g=s.n(p),f=s(59688),v=s(27479),_=s(41354),y=s(872),C={name:"MultiRankingList",components:{[d.Z.name]:d.Z,[c.Z.name]:c.Z,[l.Z.name]:l.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[n.Z.name]:n.Z,[i.Z.Component.name]:i.Z.Component,EmptyBox:v.Z,MyRank:_.Z,RankItem:y.Z},data:()=>({pkId:"",activeName:"totalScore",loading:!0,invalid_time_stamp_t:"",time_stamp_t:"",invalid_time_stamp_s:"",time_stamp_s:"",isFreshLoadingTotalScore:!1,pullingTxtTotalScore:"",loosingTxtTotalScore:"",loadingTxtTotalScore:"",isFreshLoadingSingleRound:!1,pullingTxtSingleRound:"",loosingTxtSingleRound:"",loadingTxtSingleRound:"",isEmptyTotalScore:!1,isEmptySingleRound:!1,isFinishedTotalScore:!1,isFinishedSingleRound:!1,curTotalScorePage:0,curSingleRound:0,isLoadingTotalScore:!1,isLoadingSingleRound:!1,totalScoreParams:{score_type:"total",user_type:"multiple",page_number:0,page_size:20,query_tops:!1},singleRoundParams:{score_type:"single",user_type:"multiple",page_number:0,page_size:20,query_tops:!1},myTotalScoreRank:{},mySingleRoundRank:{},singleRoundRankList:[],totalScoreRankList:[],interval:null,ruleMsg:"",showRule:!1,refreshTxt:""}),computed:(0,a.Z)({},(0,m.mapGetters)({primaryColor:"getPrimaryColor",userInfo:"user/getUserInfo"})),watch:{activeName(t){t&&localStorage.setItem("pkMultiRankingActiveName",t)}},mounted(){(0,u.Td)(this.$t("pkGame.rankList"));const t=(0,h.DP)();this.pkId=t.pkId,this.onLoadTotalScore(),this.onLoadSingleRound(),this.interval=setInterval((()=>{let t=(new Date).getTime();this.invalid_time_stamp_t&&Number(this.invalid_time_stamp_t)<t?(this.loosingTxtTotalScore=this.$t("pkGame.refreshNow"),this.loadingTxtTotalScore=this.$t("pkGame.refreshNow")):(this.loosingTxtTotalScore=`${this.$t("pkGame.refreshTime")}:${(0,u.p6)(Number(this.invalid_time_stamp_t),"yyyy-MM-dd  hh:mm")}`,this.loadingTxtTotalScore=""),this.invalid_time_stamp_s&&Number(this.invalid_time_stamp_s)<t?(this.loosingTxtSingleRound=this.$t("pkGame.refreshNow"),this.loadingTxtSingleRound=this.$t("pkGame.refreshNow")):(this.loosingTxtSingleRound=`${this.$t("pkGame.refreshTime")}:${(0,u.p6)(Number(this.invalid_time_stamp_s),"yyyy-MM-dd  hh:mm")}`,this.loadingTxtSingleRound="")}),1e3),localStorage.getItem("multiRankingRefreshTips")||localStorage.setItem("multiRankingRefreshTips",!0)},methods:{onRefreshTotalScore(){let t=(new Date).getTime();(!this.invalid_time_stamp_t||Number(this.invalid_time_stamp_t)<t)&&(this.totalScoreParams={score_type:"total",user_type:"multiple",page_number:0,page_size:20,query_tops:!1},this.myTotalScoreRank={},this.totalScoreRankList=[],this.onLoadTotalScore()),this.isFreshLoadingTotalScore=!1},onRefreshSingleRound(){let t=(new Date).getTime();(!this.invalid_time_stamp_s||Number(this.invalid_time_stamp_s)<t)&&(this.singleRoundParams={score_type:"single",user_type:"multiple",page_number:0,page_size:20,query_tops:!1},this.mySingleRoundRank={},this.singleRoundRankList=[],this.onLoadSingleRound()),this.isFreshLoadingSingleRound=!1},onLoadTotalScore(){this.totalScoreParams.page_number+=1,f.Z.getRankingList(this.totalScoreParams,this.pkId).then((t=>{if(t.data&&t.data.data){const{list:e,is_last_page:s,me:a}=t.data.data;this.myTotalScoreRank=a;let i=[...this.totalScoreRankList,...e];this.totalScoreRankList=g()(i),this.isLoadingTotalScore=!1,"true"===s&&(this.isFinishedTotalScore=!0),this.loading=!1,this.isFreshLoadingTotalScore=!1,this.totalScoreRankList&&0!==this.totalScoreRankList.length||(this.isEmptyTotalScore=!0),a&&(this.invalid_time_stamp_t=a.invalid_time_stamp,this.time_stamp_t=a.time_stamp,this.refreshTxt=this.$t("pkGame.pullRefresh").replace("%d",`${(0,u.p6)(Number(this.invalid_time_stamp_t),"hh:mm")}`),this.pullingTxtTotalScore=`${this.$t("pkGame.recordTime")}:${(0,u.p6)(Number(this.time_stamp),"yyyy-MM-dd  hh:mm")}`,this.loosingTxtTotalScore=`${this.$t("pkGame.refreshTime")}:${(0,u.p6)(Number(this.invalid_time_stamp_t),"yyyy-MM-dd  hh:mm")}`)}}))},onLoadSingleRound(){this.singleRoundParams.page_number+=1,f.Z.getRankingList(this.singleRoundParams,this.pkId).then((t=>{if(t.data&&t.data.data){const{list:e,is_last_page:s,me:a}=t.data.data;this.mySingleRoundRank=a;let i=[...this.singleRoundRankList,...e];this.singleRoundRankList=g()(i),this.isLoadingSingleRound=!1,"true"===s&&(this.isFinishedSingleRound=!0),this.loading=!1,this.isFreshLoadingSingleRound=!1,this.singleRoundRankList&&0!==this.singleRoundRankList.length||(this.isEmptySingleRound=!0),a&&(this.invalid_time_stamp_s=a.invalid_time_stamp,this.time_stamp_s=a.time_stamp,this.refreshTxt=this.$t("pkGame.pullRefresh").replace("%d",`${(0,u.p6)(Number(this.invalid_time_stamp_s),"hh:mm")}`),this.pullingTxtSingleRound=`${this.$t("pkGame.recordTime")}:${(0,u.p6)(Number(this.time_stamp_s),"yyyy-MM-dd  hh:mm")}`,this.loosingTxtSingleRound=`${this.$t("pkGame.refreshTime")}:${(0,u.p6)(Number(this.invalid_time_stamp_s),"yyyy-MM-dd  hh:mm")}`)}}))},doShowRule(){this.ruleMsg=this.$t("pkGame.rankMultRule"),this.showRule=!0}}},k=C,b=(0,s(1001).Z)(k,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"page cl-page-container"},[s("div",{staticClass:"promote-txt"},[s("div",[t._v(t._s(t.refreshTxt))]),s("div",{style:{color:t.primaryColor},on:{click:t.doShowRule}},[t._v(t._s(t.$t("pkGame.rule")))])]),t.loading?s("van-loading",{staticClass:"init-loading",attrs:{size:"36"}}):s("van-tabs",{attrs:{color:"var(--primary-color)","title-inactive-color":"#2D3040",sticky:""},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[s("van-tab",{attrs:{title:t.$t("pkGame.totalScoreRanking"),name:"totalScore","line-height":"40px"}},[s("div",{staticClass:"tab-content",attrs:{id:"totalScore"}},[s("div",{staticClass:"van-tab-content"},[s("van-pull-refresh",{staticClass:"refresh",attrs:{"pulling-text":t.pullingTxtTotalScore,"loosing-text":t.loosingTxtTotalScore,"loading-text":t.loadingTxtTotalScore},on:{refresh:t.onRefreshTotalScore},model:{value:t.isFreshLoadingTotalScore,callback:function(e){t.isFreshLoadingTotalScore=e},expression:"isFreshLoadingTotalScore"}},[t.isEmptyTotalScore?s("EmptyBox",{staticClass:"empty"}):s("van-list",{attrs:{"immediate-check":!1,"loading-text":t.$t("common.loading"),finished:t.isFinishedTotalScore,"finished-text":t.isFinishedTotalScore&&0===t.totalScoreRankList.length?"":t.$t("common.noMore"),offset:100},on:{load:t.onLoadTotalScore},model:{value:t.isLoadingTotalScore,callback:function(e){t.isLoadingTotalScore=e},expression:"isLoadingTotalScore"}},t._l(t.totalScoreRankList,(function(t,e){return s("rank-item",{key:e,attrs:{"pk-type":"multi-pk",item:t}})})),1)],1)],1)]),t.totalScoreRankList&&t.totalScoreRankList.length>0?s("my-rank",{attrs:{"is-team":!1,"my-rank-info":t.myTotalScoreRank}}):t._e()],1),s("van-tab",{attrs:{title:t.$t("pkGame.singleRoundRanking"),name:"singleRound","line-height":"10vh"}},[s("div",{staticClass:"tab-content",attrs:{id:"singleRound"}},[s("div",{staticClass:"van-tab-content"},[s("van-pull-refresh",{staticClass:"refresh",attrs:{"pulling-text":t.pullingTxtSingleRound,"loosing-text":t.loosingTxtSingleRound,"loading-text":t.loadingTxtSingleRound},on:{refresh:t.onRefreshSingleRound},model:{value:t.isFreshLoadingSingleRound,callback:function(e){t.isFreshLoadingSingleRound=e},expression:"isFreshLoadingSingleRound"}},[t.isEmptySingleRound?s("EmptyBox",{staticClass:"empty"}):s("van-list",{attrs:{"immediate-check":!1,"loading-text":t.$t("common.loading"),finished:t.isFinishedSingleRound,"finished-text":t.isFinishedSingleRound&&0===t.singleRoundRankList.length?"":t.$t("common.noMore")},on:{load:t.onLoadSingleRound},model:{value:t.isLoadingSingleRound,callback:function(e){t.isLoadingSingleRound=e},expression:"isLoadingSingleRound"}},t._l(t.singleRoundRankList,(function(t,e){return s("rank-item",{key:e,attrs:{"pk-type":"multi-pk",item:t}})})),1)],1)],1)]),t.singleRoundRankList&&t.singleRoundRankList.length>0?s("my-rank",{attrs:{"is-team":!1,"my-rank-info":t.mySingleRoundRank}}):t._e()],1)],1),s("van-dialog",{attrs:{"confirm-button-text":t.$t("common.confirm"),"message-align":"left"},model:{value:t.showRule,callback:function(e){t.showRule=e},expression:"showRule"}},[s("div",{staticClass:"dialog"},[s("div",{staticClass:"txt",domProps:{innerHTML:t.xss(t._s(t.ruleMsg))}})])])],1)}),[],!1,null,"80334d3a",null).exports},45914:(t,e,s)=>{s.r(e),s.d(e,{default:()=>g});var a=s(95082),i=(s(20581),s(50914)),n=(s(33948),s(26294)),o=s(59688),r=s(22648),l=s(27479),c=(s(26699),s(32023),s(57658),{name:"PKList",components:{},filters:{formatDate:function(t){return(0,r.p6)(t,"yyyy-MM-dd  hh:mm")}},props:{item:{type:Object,required:!0,default:()=>({})},pkType:{type:String,required:!1,default:""}},data:()=>({}),computed:(0,a.Z)({},(0,n.mapGetters)({primaryColor:"getPrimaryColor",userInfo:"user/getUserInfo"})),mounted(){},methods:{goRanking(t,e){t.includes("multi")?this.$router.push({path:`/home-module/pk/multi-ranking?pkId=${e}`}):t.includes("team")&&this.$router.push({path:`/home-module/pk/team-ranking?pkId=${e}`})},goMatching(t,e){t.includes("multi")?this.$router.push({path:`/home-module/pk/matching/multi?pkType=multi&pkId=${e}`}):t.includes("team")&&this.$router.push({path:`/home-module/pk/matching/team?pkType=team&pkId=${e}`})}}}),d=s(1001),m=(0,d.Z)(c,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"van-tab-content"},[s("div",{staticClass:"title hidetxt"},[t._v(t._s(t.item.title))]),s("div",{staticClass:"info"},[s("div",{staticClass:"info-type hidetxt"},[t._v(t._s(t.$t("pkGame.type"))+":"+t._s("multiple"===t.item.type?t.$t("pkGame.multiPk"):t.$t("pkGame.teamPk")))]),s("div",{staticClass:"info-time hidetxt"},[t._v(t._s(t.$t("pkGame.beginDate"))+": "+t._s(t._f("formatDate")(Number(t.item.start_time))))]),s("div",{staticClass:"info-num hidetxt"},[t._v(t._s(t.$t("pkGame.participants"))+": "+t._s(t.item.join_count))]),s("div",{staticClass:"info-time hidetxt"},[t._v(t._s(t.$t("pkGame.endDate"))+": "+t._s(t._f("formatDate")(Number(t.item.end_time))))])]),s("div",{staticClass:"line"}),s("div",{staticClass:"btn-div"},[s("div",{staticClass:"button",on:{click:function(e){return t.goRanking(t.pkType,t.item.id)}}},[t._v(t._s(t.$t("pkGame.showRanking")))]),"multi-pk"===t.pkType||"team-pk"===t.pkType?s("div",{staticClass:"button",on:{click:function(e){return t.goMatching(t.pkType,t.item.id)}}},[t._v(t._s(t.$t("pkGame.startChallenge")))]):t._e()])])}),[],!1,null,"deed689a",null).exports,h=s(56646),u={name:"Ranking",components:{[i.Z.name]:i.Z,EmptyBox:l.Z,PkList:m,GameFrame:h.Z},beforeRouteLeave(t,e,s){this.hideGameFrame(),s()},data:()=>({isFinished:!1,curPage:0,isLoading:!1,isEmpty:!1,pkType:"",continueGame:{},continuePkId:"",continueInstanceId:"",isShowContinue:!1,list:[],params:{status:"processing",page_number:0,page_size:20,type:""},matchData:{},resHost:"https://gsdn.coolcollege.cn/coolcollege-vue-h5/pk-games/pk/",start:!1}),computed:(0,a.Z)({},(0,n.mapGetters)({primaryColor:"getPrimaryColor",userInfo:"user/getUserInfo"})),created(){this.pkType=this.$route.params.pkType},mounted(){this.params.page_number=0,this.onLoad(),"multi-pk"===this.pkType?(0,r.Td)(this.$t("pkGame.multiPk")):"team-pk"===this.pkType&&(0,r.Td)(this.$t("pkGame.teamPk")),this.isContinue()},methods:{isContinue(){o.Z.unfinish().then((t=>{let{data:e}=t;e&&e.me&&e.pk_game_info&&(this.continueGame=e,this.continuePkId=e.pk_game_info.id,this.continueInstanceId=this.continueGame.pk_game_info.instance_id,this.isShowContinue=!0)}))},playGame(){this.isShowContinue=!1,this.start=!0},giveUp(){this.continueGame&&this.continueGame.pk_game_info?o.Z.gameOver(this.continuePkId,this.continueInstanceId).then((()=>{this.isShowContinue=!1})):this.isShowContinue=!1},onLoad(){switch(this.params.page_number+=1,this.pkType){case"multi-pk":this.params.type="multiple";break;case"team-pk":this.params.type="team"}o.Z.getMyPkList(this.params).then((t=>{if(t.data.data){const{list:e,is_last_page:s}=t.data.data;this.list=[...this.list,...e],this.list&&0!==this.list.length||(this.isEmpty=!0),this.isLoading=!1,"true"===s&&(this.isFinished=!0)}else this.list&&0!==this.list.length||(this.isEmpty=!0,this.isLoading=!1,this.isFinished=!0)}))},hideGameFrame(){this.start=!1}}},p=u,g=(0,d.Z)(p,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"page cl-page-container"},[t.isEmpty?s("EmptyBox",{staticClass:"empty"}):s("div",{staticClass:"tab-content"},[s("van-list",{attrs:{"immediate-check":!1,"loading-text":t.$t("common.loading"),finished:t.isFinished,"finished-text":t.isFinished&&0===t.list.length?"":t.$t("common.noMore"),offset:100},on:{load:t.onLoad},model:{value:t.isLoading,callback:function(e){t.isLoading=e},expression:"isLoading"}},t._l(t.list,(function(e,a){return s("pk-list",{key:a,attrs:{"pk-type":t.pkType,item:e}})})),1)],1),t.isShowContinue?s("div",{staticClass:"ongoing-game"},[s("img",{attrs:{src:t.resHost+"ongoing_game@2x.png"}}),s("div",{staticClass:"bottom-btn"},[s("div",{staticClass:"btn",on:{click:t.giveUp}},[t._v(t._s(t.$t("pkGame.giveUp")))]),s("div",{staticClass:"btn",on:{click:t.playGame}},[t._v(t._s(t.$t("pkGame.continue")))])])]):t._e(),t.start?s("game-frame",{staticClass:"gframe",attrs:{"pk-type":t.pkType,"pk-id":t.continuePkId,"match-data":t.continueGame},on:{hide:function(e){return t.hideGameFrame()}}}):t._e()],1)}),[],!1,null,"7b7774e2",null).exports},66290:(t,e,s)=>{s.r(e),s.d(e,{default:()=>h});var a=s(95082),i=(s(34837),s(39146)),n=(s(74916),s(15306),s(26294)),o=s(28787),r=s(22648),l=s(98512),c=s(59688),d=s(78368),m={name:"AnswerRecordSingleDetail",components:{[i.Z.name]:i.Z},filters:{formatDate:function(t){return(0,r.p6)(Number(t),"yyyy-MM-dd  hh:mm")},plus:function(t){return t&&Number(t)<0?`${t}`:`+${t}`}},data:()=>({pkId:"",time:"",defalutAvatar:d,resHost:"https://gsdn.coolcollege.cn/coolcollege-vue-h5/pk-games/pk/",awards:{},high:null,total:null,groupAverage:null,isUpdate:!1,t:null}),computed:(0,a.Z)({},(0,n.mapGetters)({primaryColor:"getPrimaryColor",userInfo:"user/getUserInfo"})),created(){const t=(0,l.DP)();this.pkId=t.pkId,this.time=t.time},mounted(){(0,r.Td)(this.$t("pkGame.rankingAwards")),this.load()},methods:{load(){c.Z.getMyRank(this.pkId).then((t=>{t.data&&("580009"===t.data.result_code?this.isUpdate=!0:t.data.data?(this.awards=t.data.data,this.initItem(this.awards)):(0,i.Z)(t.data.message))}))},initItem(t){t&&t.record_list&&t.record_list.forEach((t=>{"high"===t.board_type?(this.high=t,this.high.rankTxt=this.getRankTxt(t.rank)):"total"===t.board_type?(this.total=t,this.total.rankTxt=this.getRankTxt(t.rank)):"group_average"===t.board_type&&(this.groupAverage=t,this.groupAverage.rankTxt=this.getRankTxt(t.rank))}))},getRankTxt(t){return t>3?this.$t("pkGame.ranking").replace("#",`<span class="info2">${t}</span>`):t>0&&t<=3?this.$t("pkGame.ranking").replace("#",`<img class="rank-img" src="${this.resHost+t}@3x.png" />`):""},back(){o.Z.state.routeStack.length>1?this.$router.go(-1):this.$router.replace({path:"/home-module/pk/ranking"})}}},h=(0,s(1001).Z)(m,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"page cl-page-container"},[s("div",{staticClass:"head-img"},[s("img",{attrs:{src:t.userInfo.avatar||t.defalutAvatar}}),s("div",{staticClass:"name hidetxt"},[t._v(t._s(t.awards.user_name))])]),t.isUpdate?s("div",{staticClass:"score-tab update-info"},[t._v(t._s(t.$t("pkGame.rewardsAreBeingSettled")))]):s("div",{staticClass:"score-tab"},[s("div",{staticClass:"pk-name hidetxt"},[t._v(t._s(t.awards.pk_name))]),s("div",{staticClass:"line"}),t.total?s("div",[s("div",{staticClass:"info"},[s("div",{staticClass:"info1 hidetxt"},[t._v(t._s(t.$t("pkGame.totalAwards")))]),s("div",{staticClass:"info2 hidetxt"},[t._v(t._s(t.total.score)+t._s(t.$t("pkGame.mark")))]),t.total.rank>3?s("div",{staticClass:"info3 hidetxt",domProps:{innerHTML:t.xss(t._s(t.total.rankTxt))}}):t._e(),t.total.rank>0&&t.total.rank<4?s("div",{staticClass:"info3"},[t._v("第 "),s("img",{staticClass:"rank-img",attrs:{src:t.resHost+t.total.rank+"@3x.png"}}),t._v(" 名")]):t._e()]),s("div",{staticClass:"info"},[s("div",{staticClass:"info4 hidetxt"},[t._v(t._s(t.$t("pkGame.awards"))+": "+t._s(t.$t("pkGame.experience"))+" "+t._s(t._f("plus")(t.total.experience_point)))]),s("div",{staticClass:"info5 hidetxt"},[t._v(t._s(t.$t("pointsMall.points"))+" "+t._s(t._f("plus")(t.total.point)))])])]):t._e(),t.total?s("div",{staticClass:"line"}):t._e(),t.high?s("div",[s("div",{staticClass:"info"},[s("div",{staticClass:"info1 hidetxt"},[t._v(t._s(t.$t("pkGame.highAwards")))]),s("div",{staticClass:"info2 hidetxt"},[t._v(t._s(t.high.score)+t._s(t.$t("pkGame.mark")))]),t.high.rank>3?s("div",{staticClass:"info3 hidetxt",domProps:{innerHTML:t.xss(t._s(t.high.rankTxt))}}):t._e(),t.high.rank>0&&t.high.rank<4?s("div",{staticClass:"info3"},[t._v("第 "),s("img",{staticClass:"rank-img",attrs:{src:t.resHost+t.high.rank+"@3x.png"}}),t._v(" 名")]):t._e()]),s("div",{staticClass:"info"},[s("div",{staticClass:"info4 hidetxt"},[t._v(t._s(t.$t("pkGame.awards"))+": "+t._s(t.$t("pkGame.experience"))+" "+t._s(t._f("plus")(t.high.experience_point)))]),s("div",{staticClass:"info5 hidetxt"},[t._v(t._s(t.$t("pointsMall.points"))+" "+t._s(t._f("plus")(t.high.point)))])])]):t._e(),t.high?s("div",{staticClass:"line"}):t._e(),t.groupAverage?s("div",[s("div",{staticClass:"info"},[s("div",{staticClass:"info1 hidetxt"},[t._v(t._s(t.$t("pkGame.groupAwards")))]),s("div",{staticClass:"info2 hidetxt"},[t._v(t._s(t.groupAverage.score)+t._s(t.$t("pkGame.mark")))]),t.groupAverage.rank>3?s("div",{staticClass:"info3 hidetxt",domProps:{innerHTML:t.xss(t._s(t.groupAverage.rankTxt))}}):t._e(),t.groupAverage.rank>0&&t.groupAverage.rank<4?s("div",{staticClass:"info3"},[t._v("第 "),s("img",{staticClass:"rank-img",attrs:{src:t.resHost+t.groupAverage.rank+"@3x.png"}}),t._v(" 名")]):t._e()]),s("div",{staticClass:"info"},[s("div",{staticClass:"info4 hidetxt"},[t._v(t._s(t.$t("pkGame.awards"))+": "+t._s(t.$t("pkGame.experience"))+" "+t._s(t._f("plus")(t.groupAverage.experience_point)))]),s("div",{staticClass:"info5 hidetxt"},[t._v(t._s(t.$t("pointsMall.points"))+" "+t._s(t._f("plus")(t.groupAverage.point)))])])]):t._e(),t.groupAverage?s("div",{staticClass:"line"}):t._e(),s("div",{staticClass:"begin-time"},[t._v(t._s(t._f("formatDate")(Number(t.awards.pk_end_time))))])]),s("div",{staticClass:"bottom-btn"},[s("div",{staticClass:"btn",on:{click:t.back}},[t._v(t._s(t.$t("common.confirm")))])])])}),[],!1,null,"eb92afd2",null).exports},30518:(t,e,s)=>{s.r(e),s.d(e,{default:()=>g});var a=s(95082),i=(s(3791),s(93432)),n=(s(20581),s(50914)),o=(s(82500),s(49414)),r=(s(82522),s(10342)),l=(s(57658),s(33948),s(26294)),c=s(22648),d=s(59688),m=s(27479),h=s(56646),u={name:"Ranking",components:{[r.Z.name]:r.Z,[o.Z.name]:o.Z,[n.Z.name]:n.Z,[i.Z.name]:i.Z,EmptyBox:m.Z,GameFrame:h.Z},filters:{formatDate:function(t){return(0,c.p6)(Number(t),"yyyy-MM-dd  hh:mm")}},beforeRouteEnter(t,e,s){-1===e.path.indexOf("/pk/")&&(localStorage.removeItem("pkAnswerRecordActiveName"),localStorage.removeItem("pkMultiRankingActiveName"),localStorage.removeItem("pkTeamRankingActiveName"),localStorage.removeItem("pkRankingActiveName")),s()},beforeRouteLeave(t,e,s){if(e.meta.keepAlive){const t=document.querySelector(`#${this.activeName}`),s=t?t.scrollTop:0;e.meta.scrollTop=s}this.hideGameFrame(),s()},data:()=>({activeName:"",loading:!0,isEmptyNotStart:!1,isEmptyOnGoing:!1,isEmptyComplete:!1,isFinishedOnGoing:!1,isFinishedComplete:!1,isFinishedNotStart:!1,isLoadingOnGoing:!1,isLoadingComplete:!1,isLoadingNotStart:!1,onGoingList:[],completeList:[],notStartList:[],onGoingParams:{status:"processing",page_number:0,page_size:20},completeParams:{status:"end",page_number:0,page_size:20},notStartParams:{status:"not_start",page_number:0,page_size:20},continueGame:{},continuePkId:"",continueInstanceId:"",isShowContinue:!1,pkType:"",curItem:null,matchData:{},resHost:"https://gsdn.coolcollege.cn/coolcollege-vue-h5/pk-games/pk/",start:!1}),computed:(0,a.Z)({},(0,l.mapGetters)({primaryColor:"getPrimaryColor",userInfo:"user/getUserInfo"})),watch:{activeName(t){t&&localStorage.setItem("pkRankingActiveName",t)}},mounted(){this.activeName=localStorage.getItem("pkRankingActiveName"),this.activeName||(this.activeName="complete",localStorage.setItem("pkRankingActiveName","complete")),(0,c.Td)(this.$t("pkGame.myPk")),this.onGoingParams={status:"processing",page_number:0,page_size:20},this.completeParams={status:"end",page_number:0,page_size:20},this.notStartParams={status:"not_start",page_number:0,page_size:20},this.onLoadOnGoing(),this.onLoadComplete(),this.onLoadNotStart()},methods:{scroll(){const{scrollTop:t}=this.$route.meta,e=document.querySelector(`#${this.activeName}`);t&&e&&(e.scrollTop=t)},goMatching(t){t.type.indexOf("multi")>-1?this.$router.push({path:`/home-module/pk/matching/multi?pkType=multi&pkId=${t.id}`}):t.type.indexOf("team")>-1&&this.$router.push({path:`/home-module/pk/matching/team?pkType=team&pkId=${t.id}`})},goRanking(t){t.type.indexOf("multi")>-1?this.goMultiRanking(t.id):t.type.indexOf("team")>-1&&this.goTeamRanking(t.id)},goRankingAwards(t){this.$router.push({path:`/home-module/pk/ranking-result?pkId=${t.id}&time=${t.end_time}`})},goTeamRanking(t){this.$router.push({path:`/home-module/pk/team-ranking?pkId=${t}`})},goMultiRanking(t){this.$router.push({path:`/home-module/pk/multi-ranking?pkId=${t}`})},getPkType(t){return"multiple"===t?this.$t("pkGame.multiPk"):"team"===t?this.$t("pkGame.teamPk"):""},onLoadOnGoing(){this.onGoingParams.page_number+=1,d.Z.getMyPkList(this.onGoingParams).then((t=>{if(t.data&&t.data.data){const{list:e,is_last_page:s}=t.data.data;this.onGoingList=[...this.onGoingList,...e],this.isLoadingOnGoing=!1,"true"===s&&(this.isFinishedOnGoing=!0),this.loading=!1,this.onGoingList&&0!==this.onGoingList.length||(this.isEmptyOnGoing=!0)}}))},onLoadComplete(){this.completeParams.page_number+=1,d.Z.getMyPkList(this.completeParams).then((t=>{if(t.data&&t.data.data){const{list:e,is_last_page:s}=t.data.data;this.completeList=[...this.completeList,...e],this.isLoadingComplete=!1,"true"===s&&(this.isFinishedComplete=!0),this.loading=!1,this.completeList&&0!==this.completeList.length||(this.isEmptyComplete=!0)}}))},onLoadNotStart(){this.notStartParams.page_number+=1,d.Z.getMyPkList(this.notStartParams).then((t=>{if(t.data&&t.data.data){const{list:e,is_last_page:s}=t.data.data;this.notStartList=[...this.notStartList,...e],this.isLoadingNotStart=!1,"true"===s&&(this.isFinishedNotStart=!0),this.loading=!1,this.notStartList&&0!==this.notStartList.length||(this.isEmptyNotStart=!0)}}))},isContinue(t){this.curItem=t,d.Z.unfinish().then((e=>{let{data:s}=e;s&&s.me&&s.pk_game_info?(this.continueGame=s,this.continuePkId=s.pk_game_info.id,this.continueInstanceId=this.continueGame.pk_game_info.instance_id,t.type.indexOf("multi")>-1?this.pkType="multi":t.type.indexOf("team")>-1&&(this.pkType="team"),this.isShowContinue=!0):this.goMatching(this.curItem)}))},playGame(){this.isShowContinue=!1,this.start=!0},giveUp(){this.continueGame&&this.continueGame.pk_game_info?d.Z.gameOver(this.continuePkId,this.continueInstanceId).then((()=>{this.isShowContinue=!1,this.goMatching(this.curItem)})):(this.isShowContinue=!1,this.goMatching(this.curItem))},hideGameFrame(){this.start=!1}}},p=u,g=(0,s(1001).Z)(p,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"page cl-page-container"},[t.loading?s("van-loading",{staticClass:"init-loading",attrs:{size:"36"}}):s("van-tabs",{attrs:{color:"var(--primary-color)","title-inactive-color":"#2D3040",sticky:""},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[s("van-tab",{attrs:{title:t.$t("pkGame.complete"),name:"complete"}},[t.isEmptyComplete?s("EmptyBox",{staticClass:"empty"}):s("div",{staticClass:"tab-content",attrs:{id:"complete"}},[s("van-list",{attrs:{"immediate-check":!1,"loading-text":t.$t("common.loading"),finished:t.isFinishedComplete,"finished-text":t.isFinishedComplete&&0===t.completeList.length?"":t.$t("common.noMore"),offset:100},on:{load:t.onLoadComplete},model:{value:t.isLoadingComplete,callback:function(e){t.isLoadingComplete=e},expression:"isLoadingComplete"}},t._l(t.completeList,(function(e){return s("div",{key:e.id,staticClass:"van-tab-content"},[s("div",{staticClass:"title hidetxt"},[t._v(t._s(e.title))]),s("div",{staticClass:"info"},[s("div",{staticClass:"info-type hidetxt"},[t._v(t._s(t.$t("pkGame.type"))+":"+t._s(t.getPkType(e.type)))]),s("div",{staticClass:"info-time hidetxt"},[t._v(t._s(t.$t("pkGame.beginDate"))+": "+t._s(t._f("formatDate")(Number(e.start_time))))]),s("div",{staticClass:"info-num hidetxt"},[t._v(t._s(t.$t("pkGame.participants"))+": "+t._s(e.join_count))]),s("div",{staticClass:"info-time hidetxt"},[t._v(t._s(t.$t("pkGame.endDate"))+": "+t._s(t._f("formatDate")(Number(e.end_time))))])]),s("div",{staticClass:"line"}),s("div",{staticClass:"button-div"},[s("div",{staticClass:"button",on:{click:function(s){return t.goRanking(e)}}},[t._v(t._s(t.$t("pkGame.showRanking")))]),s("div",{staticClass:"button",on:{click:function(s){return t.goRankingAwards(e)}}},[t._v(t._s(t.$t("pkGame.rankingAwards")))])])])})),0)],1)],1),s("van-tab",{attrs:{title:t.$t("pkGame.onGoing"),name:"ongoing"}},[t.isEmptyOnGoing?s("EmptyBox",{staticClass:"empty"}):s("div",{staticClass:"tab-content",attrs:{id:"ongoing"}},[s("van-list",{attrs:{"immediate-check":!1,"loading-text":t.$t("common.loading"),finished:t.isFinishedOnGoing,"finished-text":t.isFinishedOnGoing&&0===t.onGoingList.length?"":t.$t("common.noMore"),offset:100},on:{load:t.onLoadOnGoing},model:{value:t.isLoadingOnGoing,callback:function(e){t.isLoadingOnGoing=e},expression:"isLoadingOnGoing"}},t._l(t.onGoingList,(function(e){return s("div",{key:e.id,staticClass:"van-tab-content"},[s("div",{staticClass:"title hidetxt"},[t._v(t._s(e.title))]),s("div",{staticClass:"info"},[s("div",{staticClass:"info-type hidetxt"},[t._v(t._s(t.$t("pkGame.type"))+":"+t._s(t.getPkType(e.type)))]),s("div",{staticClass:"info-time hidetxt"},[t._v(t._s(t.$t("pkGame.beginDate"))+": "+t._s(t._f("formatDate")(Number(e.start_time))))]),s("div",{staticClass:"info-num hidetxt"},[t._v(t._s(t.$t("pkGame.participants"))+": "+t._s(e.join_count))]),s("div",{staticClass:"info-time hidetxt"},[t._v(t._s(t.$t("pkGame.endDate"))+": "+t._s(t._f("formatDate")(Number(e.end_time))))])]),s("div",{staticClass:"line"}),s("div",{staticClass:"button-div"},[s("div",{staticClass:"button",on:{click:function(s){return t.goRanking(e)}}},[t._v(t._s(t.$t("pkGame.showRanking")))]),s("div",{staticClass:"button",on:{click:function(s){return t.isContinue(e)}}},[t._v(t._s(t.$t("pkGame.startChallenge")))])])])})),0)],1)],1),s("van-tab",{attrs:{title:t.$t("pkGame.notStart"),name:"notstart"}},[t.isEmptyNotStart?s("EmptyBox",{staticClass:"empty"}):s("div",{staticClass:"tab-content",attrs:{id:"notstart"}},[s("van-list",{attrs:{"immediate-check":!1,"loading-text":t.$t("common.loading"),finished:t.isFinishedNotStart,"finished-text":t.isFinishedNotStart&&0===t.notStartList.length?"":t.$t("common.noMore"),offset:100},on:{load:t.onLoadNotStart},model:{value:t.isLoadingNotStart,callback:function(e){t.isLoadingNotStart=e},expression:"isLoadingNotStart"}},t._l(t.notStartList,(function(e){return s("div",{key:e.id,staticClass:"van-tab-content",staticStyle:{height:"112.5px"}},[s("div",{staticClass:"title hidetxt"},[t._v(t._s(e.title))]),s("div",{staticClass:"info"},[s("div",{staticClass:"info-type hidetxt"},[t._v(t._s(t.$t("pkGame.type"))+":"+t._s(t.getPkType(e.type)))]),s("div",{staticClass:"info-time hidetxt"},[t._v(t._s(t.$t("pkGame.beginDate"))+": "+t._s(t._f("formatDate")(Number(e.start_time))))]),s("div",{staticClass:"info-num hidetxt"},[t._v(t._s(t.$t("pkGame.participants"))+": "+t._s(e.join_count))]),s("div",{staticClass:"info-time hidetxt"},[t._v(t._s(t.$t("pkGame.endDate"))+": "+t._s(t._f("formatDate")(Number(e.end_time))))])])])})),0)],1)],1)],1),t.isShowContinue?s("div",{staticClass:"ongoing-game"},[s("img",{attrs:{src:t.resHost+"ongoing_game@2x.png"}}),s("div",{staticClass:"bottom-btn"},[s("div",{staticClass:"btn",on:{click:t.giveUp}},[t._v(t._s(t.$t("pkGame.giveUp")))]),s("div",{staticClass:"btn",on:{click:t.playGame}},[t._v(t._s(t.$t("pkGame.continue")))])])]):t._e(),t.start?s("game-frame",{staticClass:"gframe",attrs:{"pk-type":t.pkType,"pk-id":t.continuePkId,"match-data":t.continueGame},on:{hide:function(e){return t.hideGameFrame()}}}):t._e()],1)}),[],!1,null,"26e0aa97",null).exports},72963:(t,e,s)=>{s.r(e),s.d(e,{default:()=>c});var a=s(59688),i=s(27479),n=s(22648),o=s(98512),r=s(27550),l={name:"Share",components:{EmptyBox:i.Z,AnswerRecordSingleDetail:r.Z},filters:{formatDate:function(t){return(0,n.p6)(Number(t),"yyyy-MM-dd  hh:mm")}},data:()=>({instanceId:"",pkId:"",userId:"",challengerSuccessTxt:"",challengerFailTxt:"",meeterTxt:"",challengerTxt:"",showAnswerRecordTxt:"",scoreThisGameTxt:"",challengerScoreTxt:"",meeterScoreTxt:"",isEmpty:!1,curItem:null,curResultTxt:""}),computed:{},created(){const t=(0,o.DP)();this.instanceId=t.instanceId,this.pkId=t.competitionId,this.userId=t.userId},mounted(){(0,n.Td)(this.$t("pkGame.myPk")),this.onLoad()},methods:{getResultTxt(t){return t.receiver.user_id===this.userId?Number(t.receiver.score)>Number(t.initiator.score)?(t.resultTxt=this.$t("pkGame.meetSuccess"),t.resultCss="success"):Number(t.receiver.score)<Number(t.initiator.score)?(t.resultTxt=this.$t("pkGame.meetFail"),t.resultCss="fail"):(t.resultTxt=this.$t("pkGame.draw"),t.resultCss="success"):Number(t.receiver.score)>Number(t.initiator.score)?(t.resultTxt=this.$t("pkGame.challengerFail"),t.resultCss="fail"):Number(t.receiver.score)<Number(t.initiator.score)?(t.resultTxt=this.$t("pkGame.challengerSuccess"),t.resultCss="success"):(t.resultTxt=this.$t("pkGame.draw"),t.resultCss="success"),t},showDetail(){this.$refs.detail.$el.style.top="0",this.$refs.detail.$el.style.left="0"},hideDetail(){this.$refs.detail.$el.style.top="0",this.$refs.detail.$el.style.left="100vw"},onLoad(){let t={instance_id:this.instanceId};a.Z.getAnswerRecordDetail(t,this.pkId).then((t=>{if("true"===t.data.success&&t.data.data){let e={experience_score:"",gain_point:"",title:"",pkId:"",instanceId:"",userId:"",initiator:{avatar:"",instance_id:"",score:"",user_id:"",user_name:""},receiver:{avatar:"",instance_id:"",score:"",user_id:"",user_name:""},time:""},s=t.data.data[0];e.experience_score=s.experience_point,e.gain_point=s.gain_point,e.title=s.title,e.pkId=this.pkId,e.instanceId=this.instanceId,e.userId=this.userId,e.isShare=!0,e.time=s.time,e.initiator=t.data.data[1],e.receiver=t.data.data[2],this.curItem=this.getResultTxt(e),this.showDetail()}else this.isEmpty=!0}))}}},c=(0,s(1001).Z)(l,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"page cl-page-container"},[t.isEmpty?s("EmptyBox",{staticClass:"empty"}):s("answer-record-single-detail",{ref:"detail",staticClass:"detail",attrs:{item:t.curItem},on:{handleConfirm:t.hideDetail}})],1)}),[],!1,null,"2a08b71e",null).exports},4584:(t,e,s)=>{s.r(e),s.d(e,{default:()=>Z});var a=s(95082),i=(s(31146),s(41610)),n=(s(58052),s(68286)),o=(s(3791),s(93432)),r=(s(20581),s(50914)),l=(s(34837),s(39146)),c=(s(82500),s(49414)),d=(s(82522),s(10342)),m=(s(33948),s(74916),s(15306),s(26294)),h=s(98512),u=s(22648),p=s(44908),g=s.n(p),f=s(59688),v=s(27479),_=s(41354),y=s(872),C=(s(66528),s(78368)),k={name:"TeamRankItem",filters:{formatScore:function(t){let e=t.split(".");if(1===e.length)return`${e[0]}.00`;if(2===e.length){let t=e[1].padEnd(2,"0");return`${e[0]}.${t}`}return t}},props:{item:{type:Object,required:!0,default:()=>({})},pkType:{type:String,required:!0,default:""}},data:()=>({defalutAvatar:C,resHost:"https://gsdn.coolcollege.cn/coolcollege-vue-h5/pk-games/pk/"})},b=s(1001),$=(0,b.Z)(k,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"info"},[Number(t.item.rank)>3?s("div",{staticClass:"info1 hidetxt"},[t._v(t._s(t.item.rank))]):t._e(),Number(t.item.rank)<4?s("div",{staticClass:"info1 hidetxt"},[s("img",{staticClass:"rank-img",attrs:{src:t.resHost+t.item.rank+"@3x.png"}})]):t._e(),s("div",{staticClass:"info3 hidetxt"},[s("div",{staticClass:"name hidetxt"},[t._v(t._s(t.item.group_name))])]),s("div",{staticClass:"info4 hidetxt"},[t._v(t._s(t._f("formatScore")(t.item.average_score)))])])}),[],!1,null,"562432c6",null).exports,T={name:"TeamRankingList",components:{[d.Z.name]:d.Z,[c.Z.name]:c.Z,[l.Z.name]:l.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[n.Z.name]:n.Z,[i.Z.Component.name]:i.Z.Component,EmptyBox:v.Z,MyRank:_.Z,RankItem:y.Z,TeamRankItem:$},data:()=>({activeName:"totalScore",invalid_time_stamp_t:"",time_stamp_t:"",invalid_time_stamp_s:"",time_stamp_s:"",invalid_time_stamp_team:"",time_stamp_team:"",isFreshLoadingTotalScore:!1,pullingTxtTotalScore:"",loosingTxtTotalScore:"",loadingTxtTotalScore:"",isFreshLoadingSingleRound:!1,pullingTxtSingleRound:"",loosingTxtSingleRound:"",loadingTxtSingleRound:"",isFreshLoadingTeam:!1,pullingTxtTeam:"",loosingTxtTeam:"",loadingTxtTeam:"",isFinishedTotalScore:!1,isFinishedSingleRound:!1,isFinishedTeam:!1,isLoadingTotalScore:!1,isLoadingSingleRound:!1,isLoadingTeam:!1,myTotalScoreRank:{},mySingleRoundRank:{},myTeamRank:{},teamRankingList:[],singleRoundRankList:[],totalScoreRankList:[],loading:!0,isEmptyTotalScore:!1,isEmptySingleRound:!1,isEmptyTeam:!1,totalScoreParams:{score_type:"total",user_type:"team",page_number:0,page_size:20,query_tops:!1},singleRoundParams:{score_type:"single",user_type:"team",page_number:0,page_size:20,query_tops:!1},teamParams:{page_number:0,page_size:20},interval:null,ruleMsg:"",showRule:!1,refreshTxt:""}),computed:(0,a.Z)({},(0,m.mapGetters)({primaryColor:"getPrimaryColor",userInfo:"user/getUserInfo"})),watch:{activeName(t){t&&localStorage.setItem("pkTeamRankingActiveName",t)}},mounted(){(0,u.Td)(this.$t("pkGame.rankList"));const t=(0,h.DP)();this.pkId=t.pkId,this.onLoadTotalScore(),this.onLoadSingleRound(),this.onLoadTeam(),this.interval=setInterval((()=>{let t=(new Date).getTime();this.invalid_time_stamp_t&&Number(this.invalid_time_stamp_t)<t?(this.loosingTxtTotalScore=this.$t("pkGame.refreshNow"),this.loadingTxtTotalScore=this.$t("pkGame.refreshNow")):(this.loosingTxtTotalScore=`${this.$t("pkGame.refreshTime")}:${(0,u.p6)(Number(this.invalid_time_stamp_t),"yyyy-MM-dd  hh:mm")}`,this.loadingTxtTotalScore=""),this.invalid_time_stamp_s&&Number(this.invalid_time_stamp_s)<t?(this.loosingTxtSingleRound=this.$t("pkGame.refreshNow"),this.loadingTxtSingleRound=this.$t("pkGame.refreshNow")):(this.loosingTxtSingleRound=`${this.$t("pkGame.refreshTime")}:${(0,u.p6)(Number(this.invalid_time_stamp_s),"yyyy-MM-dd  hh:mm")}`,this.loadingTxtSingleRound=""),this.invalid_time_stamp_team&&Number(this.invalid_time_stamp_team)<t?(this.loosingTxtTeam=this.$t("pkGame.refreshNow"),this.loadingTxtTeam=this.$t("pkGame.refreshNow")):(this.loosingTxtTeam=`${this.$t("pkGame.refreshTime")}:${(0,u.p6)(Number(this.invalid_time_stamp_team),"yyyy-MM-dd  hh:mm")}`,this.loadingTxtTeam="")}),1e3),localStorage.getItem("teamRankingRefreshTips")||localStorage.setItem("teamRankingRefreshTips",!0)},methods:{onRefreshTotalScore(){let t=(new Date).getTime();(!this.invalid_time_stamp_t||Number(this.invalid_time_stamp_t)<t)&&(this.totalScoreParams={score_type:"total",user_type:"team",page_number:0,page_size:20,query_tops:!1},this.myTotalScoreRank={},this.totalScoreRankList=[],this.onLoadTotalScore()),this.isFreshLoadingTotalScore=!1},onRefreshSingleRound(){let t=(new Date).getTime();(!this.invalid_time_stamp_s||Number(this.invalid_time_stamp_s)<t)&&(this.singleRoundParams={score_type:"single",user_type:"team",page_number:0,page_size:20,query_tops:!1},this.mySingleRoundRank={},this.singleRoundRankList=[],this.onLoadSingleRound()),this.isFreshLoadingSingleRound=!1},onRefreshTeam(){let t=(new Date).getTime();(!this.invalid_time_stamp_team||Number(this.invalid_time_stamp_team)<t)&&(this.teamParams={page_number:0,page_size:20},this.myTeamRank={},this.teamRankingList=[],this.onLoadTeam()),this.isFreshLoadingTeam=!1},onLoadTotalScore(){this.totalScoreParams.page_number+=1,f.Z.getRankingList(this.totalScoreParams,this.pkId).then((t=>{const{list:e,is_last_page:s,me:a}=t.data.data;let i=[...this.totalScoreRankList,...e];this.totalScoreRankList=g()(i),this.isLoadingTotalScore=!1,this.myTotalScoreRank=a,"true"===s&&(this.isFinishedTotalScore=!0),this.loading=!1,this.totalScoreRankList&&0!==this.totalScoreRankList.length||(this.isEmptyTotalScore=!0),a&&(this.invalid_time_stamp_t=a.invalid_time_stamp,this.time_stamp_t=a.time_stamp,this.refreshTxt=this.$t("pkGame.pullRefresh").replace("%d",`${(0,u.p6)(Number(this.invalid_time_stamp_t),"hh:mm")}`),this.pullingTxtTotalScore=`${this.$t("pkGame.recordTime")}:${(0,u.p6)(Number(this.time_stamp),"yyyy-MM-dd  hh:mm")}`,this.loosingTxtTotalScore=`${this.$t("pkGame.refreshTime")}:${(0,u.p6)(Number(this.invalid_time_stamp_t),"yyyy-MM-dd  hh:mm")}`)}))},onLoadSingleRound(){this.singleRoundParams.page_number+=1,f.Z.getRankingList(this.singleRoundParams,this.pkId).then((t=>{const{list:e,is_last_page:s,me:a}=t.data.data;let i=[...this.singleRoundRankList,...e];this.singleRoundRankList=g()(i),this.isLoadingSingleRound=!1,this.mySingleRoundRank=a,"true"===s&&(this.isFinishedSingleRound=!0),this.loading=!1,this.singleRoundRankList&&0!==this.singleRoundRankList.length||(this.isEmptySingleRound=!0),a&&(this.invalid_time_stamp_s=a.invalid_time_stamp,this.time_stamp_s=a.time_stamp,this.refreshTxt=this.$t("pkGame.pullRefresh").replace("%d",`${(0,u.p6)(Number(this.invalid_time_stamp_s),"hh:mm")}`),this.pullingTxtSingleRound=`${this.$t("pkGame.recordTime")}:${(0,u.p6)(Number(this.time_stamp_s),"yyyy-MM-dd  hh:mm")}`,this.loosingTxtSingleRound=`${this.$t("pkGame.refreshTime")}:${(0,u.p6)(Number(this.invalid_time_stamp_s),"yyyy-MM-dd  hh:mm")}`)}))},onLoadTeam(){this.teamParams.page_number+=1,f.Z.getTeamRankingList(this.teamParams,this.pkId).then((t=>{const{list:e,is_last_page:s,me:a}=t.data.data;let i=[...this.teamRankingList,...e];this.teamRankingList=g()(i),this.isLoadingTeam=!1,this.myTeamRank=a,"true"===s&&(this.isFinishedTeam=!0),this.loading=!1,this.teamRankingList&&0!==this.teamRankingList.length||(this.isEmptyTeam=!0),a&&(this.invalid_time_stamp_team=a.invalid_time_stamp,this.time_stamp_team=a.time_stamp,this.refreshTxt=this.$t("pkGame.pullRefresh").replace("%d",`${(0,u.p6)(Number(this.invalid_time_stamp_team),"hh:mm")}`),this.pullingTxtTeam=`${this.$t("pkGame.recordTime")}:${(0,u.p6)(Number(this.time_stamp_team),"yyyy-MM-dd  hh:mm")}`,this.loosingTxtTeam=`${this.$t("pkGame.refreshTime")}:${(0,u.p6)(Number(this.invalid_time_stamp_team),"yyyy-MM-dd  hh:mm")}`)}))},doShowRule(){this.ruleMsg=this.$t("pkGame.rankTeamRule"),this.showRule=!0}}},x=T,Z=(0,b.Z)(x,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"page cl-page-container"},[s("div",{staticClass:"promote-txt"},[s("div",[t._v(t._s(t.refreshTxt))]),s("div",{style:{color:t.primaryColor},on:{click:t.doShowRule}},[t._v(t._s(t.$t("pkGame.rule")))])]),t.loading?s("van-loading",{staticClass:"init-loading",attrs:{size:"36"}}):s("van-tabs",{attrs:{color:"var(--primary-color)","title-inactive-color":"#2D3040",sticky:""},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[s("van-tab",{attrs:{title:t.$t("pkGame.individualTotalScoreRanking"),name:"totalScore","line-height":"40px"}},[s("div",{staticClass:"tab-content",attrs:{id:"totalScore"}},[s("div",{staticClass:"van-tab-content"},[s("van-pull-refresh",{staticClass:"refresh",attrs:{"pulling-text":t.pullingTxtTotalScore,"loosing-text":t.loosingTxtTotalScore,"loading-text":t.loadingTxtTotalScore},on:{refresh:t.onRefreshTotalScore},model:{value:t.isFreshLoadingTotalScore,callback:function(e){t.isFreshLoadingTotalScore=e},expression:"isFreshLoadingTotalScore"}},[t.isEmptyTotalScore?s("EmptyBox",{staticClass:"empty"}):s("van-list",{attrs:{"immediate-check":!1,"loading-text":t.$t("common.loading"),finished:t.isFinishedTotalScore,"finished-text":t.isFinishedTotalScore&&0===t.totalScoreRankList.length?"":t.$t("common.noMore"),offset:100},on:{load:t.onLoadTotalScore},model:{value:t.isLoadingTotalScore,callback:function(e){t.isLoadingTotalScore=e},expression:"isLoadingTotalScore"}},t._l(t.totalScoreRankList,(function(t,e){return s("rank-item",{key:e,attrs:{"pk-type":"team-pk",item:t}})})),1)],1)],1)]),t.myTotalScoreRank&&t.totalScoreRankList.length>0?s("my-rank",{attrs:{"is-team":!0,"is-team-team":!1,"my-rank-info":t.myTotalScoreRank}}):t._e()],1),s("van-tab",{attrs:{title:t.$t("pkGame.individualsingleRoundRanking"),name:"singleRound","line-height":"10vh"}},[s("div",{staticClass:"tab-content",attrs:{id:"singleRound"}},[s("div",{staticClass:"van-tab-content"},[s("van-pull-refresh",{staticClass:"refresh",attrs:{"pulling-text":t.pullingTxtSingleRound,"loosing-text":t.loosingTxtSingleRound,"loading-text":t.loadingTxtSingleRound},on:{refresh:t.onRefreshSingleRound},model:{value:t.isFreshLoadingSingleRound,callback:function(e){t.isFreshLoadingSingleRound=e},expression:"isFreshLoadingSingleRound"}},[t.isEmptySingleRound?s("EmptyBox",{staticClass:"empty"}):s("van-list",{attrs:{"immediate-check":!1,"loading-text":t.$t("common.loading"),finished:t.isFinishedSingleRound,"finished-text":t.isFinishedSingleRound&&0===t.singleRoundRankList.length?"":t.$t("common.noMore")},on:{load:t.onLoadSingleRound},model:{value:t.isLoadingSingleRound,callback:function(e){t.isLoadingSingleRound=e},expression:"isLoadingSingleRound"}},t._l(t.singleRoundRankList,(function(t,e){return s("rank-item",{key:e,attrs:{"pk-type":"team-pk",item:t}})})),1)],1)],1)]),t.singleRoundRankList&&t.singleRoundRankList.length>0?s("my-rank",{attrs:{"is-team":!0,"is-team-team":!1,"my-rank-info":t.mySingleRoundRank}}):t._e()],1),s("van-tab",{attrs:{title:t.$t("pkGame.teamRanking"),name:"team","line-height":"10vh"}},[s("div",{staticClass:"tab-content",attrs:{id:"team"}},[s("div",{staticClass:"van-tab-content"},[s("van-pull-refresh",{staticClass:"refresh",attrs:{"pulling-text":t.pullingTxtTeam,"loosing-text":t.loosingTxtTeam,"loading-text":t.loadingTxtTeam},on:{refresh:t.onRefreshTeam},model:{value:t.isFreshLoadingTeam,callback:function(e){t.isFreshLoadingTeam=e},expression:"isFreshLoadingTeam"}},[t.isEmptyTeam?s("EmptyBox",{staticClass:"empty"}):s("van-list",{attrs:{"immediate-check":!1,"loading-text":t.$t("common.loading"),finished:t.isFinishedTeam,"finished-text":t.isFinishedTeam&&0===t.teamRankingList.length?"":t.$t("common.noMore")},on:{load:t.onLoadTeam},model:{value:t.isLoadingTeam,callback:function(e){t.isLoadingTeam=e},expression:"isLoadingTeam"}},t._l(t.teamRankingList,(function(t,e){return s("team-rank-item",{key:e,attrs:{"pk-type":"team-pk",item:t}})})),1)],1)],1)]),t.teamRankingList&&t.teamRankingList.length>0?s("my-rank",{attrs:{"is-team":!0,"is-team-team":!0,"my-rank-info":t.myTeamRank}}):t._e()],1)],1),s("van-dialog",{attrs:{"confirm-button-text":t.$t("common.confirm"),"message-align":"left"},model:{value:t.showRule,callback:function(e){t.showRule=e},expression:"showRule"}},[s("div",{staticClass:"dialog"},[s("div",{staticClass:"txt",domProps:{innerHTML:t.xss(t._s(t.ruleMsg))}})])])],1)}),[],!1,null,"25f5ff7c",null).exports},54143:(t,e,s)=>{s.r(e),s.d(e,{default:()=>C});s(34837);var a=s(39146),i=s(95082),n=(s(3791),s(93432)),o=(s(47601),s(44951)),r=(s(23307),s(81392)),l=(s(30033),s(87837)),c=(s(31146),s(41610)),d=(s(86039),s(20495)),m=(s(49153),s(5944)),h=(s(20581),s(50914)),u=(s(58052),s(68286)),p=(s(33948),s(74916),s(15306),s(57658),s(26294)),g=s(85566),f=s(78368),v=s(78551),_={name:"PracticeList",components:{PullRefresh:u.Z,List:h.Z,Empty:m.Z,[d.Z.name]:d.Z,[c.Z.Component.name]:c.Z.Component,[l.Z.name]:l.Z,[r.Z.name]:r.Z,VanImage:o.Z,Loading:n.Z,SvgIcon:v.Z},beforeRouteLeave(t,e,s){const a=document.querySelector("#list-container"),i=a?a.scrollTop:0;e.meta.scrollTop=i,s()},data:()=>({params:{keyword:"",page_number:1,page_size:20},oldKeyword:"",curErrItem:{},alertChecked:!1,showAlert:!1,showKeyword:!0,list:[],isLoading:!0,loading:!1,finished:!1,refreshing:!1,defaultAvatar:f,practiceInfo:{},scoreList:[]}),computed:(0,i.Z)({},(0,p.mapGetters)({primaryColor:"getPrimaryColor"})),mounted(){document.title=this.$t("pageTitle.questionPractice"),this.getList(),this.getAlertStatus()},methods:{scrollTop(){this.$nextTick((()=>{const{scrollTop:t}=this.$route.meta,e=document.querySelector("#list-container");t&&e&&(e.scrollTop=t)}))},onLoad(){this.refreshing?(this.isLoading=!0,this.list=[],this.refreshing=!1,this.params.page_number=1):this.params.page_number+=1,this.getList()},onRefresh(){this.finished=!1,this.loading=!0,this.refreshing=!0,this.params.keyword&&(this.showKeyword=!1),setTimeout((()=>{this.onLoad()}),100)},onFocus(){this.oldKeyword=this.params.keyword,this.params.keyword&&(this.showKeyword=!0)},onBlur(){this.params.keyword&&this.oldKeyword!==this.params.keyword&&(this.showKeyword=!0)},onClear(){this.params.keyword="",this.showKeyword=!0,this.onRefresh()},async getList(){const{code:t,data:{hasNextPage:e,list:s}}=await g.Z.getPracticesList(this.params);0===t&&s&&(this.list=[...this.list,...s],this.loading=!1,this.isLoading=!1,this.finished="false"===e)},getWrongQuestion(t){this.playGame(t.id,"wrong","true","")},async getAlertStatus(){const{code:t,data:{status:e}}=await g.Z.getAlertStatus("practice");0===t&&(this.alertStatus="true"===e)},getRateTxt(t){return this.$t("practice.rateTxt").replace("#1",t.totalQuestionCount).replace("#2",t.completeQuestionCount)},getCompletionRate(t){if(t.totalQuestionCount>0){let e=Math.round(1e3*t.completeQuestionCount/t.totalQuestionCount)/10;return`${this.$t("practice.completionRate")} ${e}%`}return`${this.$t("practice.completionRate")} 0%`},confirmAlertTips(){this.alertChecked&&(g.Z.setCheckShowWrongTip(this.curErrItem.id),this.alertStatus=!1),this.getWrongQuestion(this.curErrItem)},async enterErr(t){0!==t.wrongQuestionCount?await this.queryQuestionCount(t,"err")&&(this.alertStatus?(this.curErrItem=t,this.showAlert=!0):this.getWrongQuestion(t)):(0,a.Z)(this.$t("practice.noWrongQuestion"))},enterPractice(t){const{id:e}=t;this.$router.push({path:"/study-resource/practice",query:{id:e}})},async enterContinuePractice(t){await this.queryQuestionCount(t,"other")&&("bank"===t.lastPracticeType?(t.isContinue=!0,this.$router.push({path:"/study-resource/practice/select-practice",query:t})):this.playGame(t.id,t.lastPracticeType,"true",""))},async queryQuestionCount(t,e){const{id:s,lastPracticeType:i,last_question_bank:n}=t,{data:o}=await g.Z.queryQuestionCount({practiceId:s,type:"err"===e?"wrong":i,isContinue:"true",questionId:"err"===e?"":n});return"number"==typeof o&&o>0||((0,a.Z)(this.$t("practice.noQuestion")),!1)},playGame(t,e,s,a){this.$router.push({path:"/study-resource/practice/practice-game",query:{practiceId:t,type:e,isContinue:s,questionId:a}})}}},y=_,C=(0,s(1001).Z)(y,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"exam-list-wrapper cl-page-container"},[s("form",{attrs:{action:"/"}},[s("van-search",{staticClass:"practice-search",attrs:{"show-action":"",placeholder:t.$t("practice.searchName")},on:{focus:t.onFocus,blur:t.onBlur},scopedSlots:t._u([{key:"action",fn:function(){return[t.showKeyword?s("div",{on:{click:t.onRefresh}},[t._v(t._s(t.$t("common.search")))]):s("div",{on:{click:t.onClear}},[t._v(t._s(t.$t("common.cancel")))])]},proxy:!0}]),model:{value:t.params.keyword,callback:function(e){t.$set(t.params,"keyword",e)},expression:"params.keyword"}})],1),s("div",{staticClass:"exam-list",attrs:{id:"list-container"}},[t.isLoading?s("Loading",{staticClass:"loading"},[t._v(t._s(t.$t("common.loading")))]):t._e(),s("PullRefresh",{staticClass:"practice-pull-refresh",on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[t.list.length>0?s("list",{attrs:{"immediate-check":!1,finished:t.finished,"finished-text":t.$t("common.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e){return s("div",{key:e.id,staticClass:"list"},[s("div",{staticClass:"list-item"},[s("VanImage",{staticClass:"cover-img",attrs:{src:e.cover,fit:"cover"}}),s("div",{staticClass:"item-info"},[s("div",{staticClass:"item-title van-ellipsis"},[t._v(t._s(e.title))]),s("div",{staticClass:"item-rate"},[t._v(t._s(t.getRateTxt(e))),s("span",{staticStyle:{"padding-left":"12px"}},[t._v(t._s(t.getCompletionRate(e)))])])])],1),s("div",{staticClass:"list-btn",on:{click:function(s){return t.enterPractice(e)}}},[s("svg-icon",{staticClass:"iconfont",attrs:{size:24,"icon-class":"icone-intelligent-exercise",color:"#47a0ef"}}),s("div",{staticClass:"txt"},[t._v(t._s(t.$t("practice.intelligentPractice")))]),s("van-icon",{staticStyle:{"margin-right":"12px"},attrs:{name:"arrow",color:"#bbbbbb",size:"20"}})],1),"false"===e.showNew?s("div",{staticClass:"list-btn",on:{click:function(s){return t.enterContinuePractice(e)}}},[s("svg-icon",{staticClass:"iconfont",attrs:{size:24,"icon-class":"icone-sequence",color:"#efd947"}}),s("div",{staticClass:"txt"},[t._v(t._s(t.$t("practice.continuePractice")))]),s("van-icon",{staticStyle:{"margin-right":"12px"},attrs:{name:"arrow",color:"#bbbbbb",size:"20"}})],1):t._e(),s("div",{staticClass:"list-btn",on:{click:function(s){return t.enterErr(e)}}},[s("svg-icon",{staticClass:"iconfont",attrs:{size:24,"icon-class":"icone-fault-eliminate",color:"#3ab46e"}}),s("div",{staticClass:"txt"},[s("div",[t._v(t._s(t.$t("practice.eliminationWrongQuestion")))]),s("div",{staticClass:"wrong-question-count"},[t._v(t._s(0===e.wrongQuestionCount?"":e.wrongQuestionCount))])]),s("van-icon",{staticStyle:{"margin-right":"12px"},attrs:{name:"arrow",color:"#bbbbbb",size:"20"}})],1)])})),0):t._e(),0!==t.list.length||t.refreshing||t.isLoading?t._e():s("Empty",{attrs:{description:t.$t("common.noDataTextTip")}})],1),s("van-dialog",{attrs:{"confirm-button-text":t.$t("practice.gotIt"),message:t.$t("practice.wrongQuestionConfirmTip"),"message-align":"left"},on:{confirm:t.confirmAlertTips},model:{value:t.showAlert,callback:function(e){t.showAlert=e},expression:"showAlert"}},[s("div",{staticClass:"dialog"},[s("div",{staticClass:"txt"},[t._v(t._s(t.$t("practice.wrongQuestionConfirmTip")))]),s("div",{staticClass:"checkbox"},[s("van-checkbox",{attrs:{"checked-color":t.primaryColor,"icon-size":"23px"},model:{value:t.alertChecked,callback:function(e){t.alertChecked=e},expression:"alertChecked"}},[s("div",{staticClass:"txt",staticStyle:{"margin-left":"2%"}},[t._v(t._s(t.$t("practice.noTips")))])])],1)])])],1)])}),[],!1,null,"64743fa9",null).exports},93005:(t,e,s)=>{s.d(e,{Z:()=>c});s(21790);var a=s(24031),i=(s(70885),s(6458)),n=(s(69710),s(57609)),o=(s(18144),s(65641)),r=s(22648),l={components:{[o.Z.name]:o.Z,[n.Z.name]:n.Z,[i.Z.name]:i.Z,[a.Z.name]:a.Z},filters:{formatDate:function(t){return(0,r.p6)(t,"yyyy/MM/dd")}},props:{activeTabName:{type:String,default:""},title:{type:String,default:""},type:{type:String,default:""},createUserName:{type:String,default:""},beginTime:{type:Number,default:0},endTime:{type:Number,default:0},trainLimit:{type:Number,default:0},count:{type:Array,default:()=>[]}},data:()=>({}),computed:{},created(){},mounted(){},methods:{}},c=(0,s(1001).Z)(l,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"report-box"},[s("h4",[t._v(t._s(t.title)+" "),"neo"===t.type?s("van-tag",{staticClass:"tTag",attrs:{plain:"",round:"",type:"primary",size:"medium",color:"#f5a623","text-color":"#f5a623"}},[t._v(t._s(t.$t("study.newEmployee")))]):t._e()],1),s("van-row",[s("van-col",{attrs:{span:"6"}},[s("p",{staticClass:"label"},[t._v(t._s(t.$t("task.assignor")))]),s("p",[t._v(t._s(t.createUserName))])]),t.trainLimit>0?[s("van-col",{staticClass:"trainLimit",attrs:{span:"8"}},[s("p",[t._v(t._s(t.trainLimit)+t._s(t.$t("data.day")))])])]:[s("van-col",{attrs:{span:"8"}},[s("p",{staticClass:"label"},[t._v(t._s(t.$t("task.startTime")))]),s("p",{staticClass:"lable-primary"},[t._v(t._s(t._f("formatDate")(t.beginTime)))])]),s("van-col",{attrs:{span:"8"}},[s("p",{staticClass:"label"},[t._v(t._s(t.$t("task.endTime")))]),s("p",{staticClass:"lable-danger"},[t._v(t._s(t._f("formatDate")(t.endTime)))])])]],2),"unstarted"!==t.activeTabName?[s("van-divider"),s("ul",{staticClass:"item-tool"},t._l(t.count,(function(e,a){return s("li",{key:a,style:{color:e.color}},[s("span",{style:{backgroundColor:e.color}}),t._v(t._s(e.lang)+" ")])})),0)]:t._e()],2)}),[],!1,null,"d9614d96",null).exports},74579:(t,e,s)=>{s.d(e,{Z:()=>c});s(21790);var a=s(24031),i=(s(70885),s(6458)),n=(s(69710),s(57609)),o=(s(18144),s(65641)),r=s(22648),l={components:{[o.Z.name]:o.Z,[n.Z.name]:n.Z,[i.Z.name]:i.Z,[a.Z.name]:a.Z},filters:{formatDate:function(t){return(0,r.p6)(t,"yyyy/MM/dd")}},props:{activeTabName:{type:String,default:""},title:{type:String,default:""},type:{type:String,default:""},createUserName:{type:String,default:""},beginTime:{type:Number,default:0},endTime:{type:Number,default:0},trainLimit:{type:Number,default:0},count:{type:Array,default:()=>[]}},data:()=>({}),computed:{},created(){},mounted(){},methods:{}},c=(0,s(1001).Z)(l,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"report-item-box"},[s("h4",[t._v(t._s(t.title))]),s("van-row",[s("van-col",{attrs:{span:"3"}},[s("p",{staticClass:"label"},[t._v(t._s(t.$t("task.assignor")))]),s("p",[t._v(t._s(t.createUserName))])]),t.trainLimit>0?[s("van-col",{staticClass:"trainLimit",attrs:{span:"6"}},[s("p",[t._v(t._s(t.trainLimit)+t._s(t.$t("data.day")))])])]:[s("van-col",{attrs:{span:"6"}},[s("p",{staticClass:"label"},[t._v(t._s(t.$t("task.startTime")))]),s("p",{staticClass:"lable-primary"},[t._v(t._s(t._f("formatDate")(t.beginTime)))])]),s("van-col",{attrs:{span:"6"}},[s("p",{staticClass:"label"},[t._v(t._s(t.$t("task.endTime")))]),s("p",{staticClass:"lable-danger"},[t._v(t._s(t._f("formatDate")(t.endTime)))])])],t._l(t.count,(function(e,a){return s("van-col",{key:a,class:0===a?"left-border":null,attrs:{span:t.count.length>2?"3":"4"}},[s("p",{staticClass:"label"},[t._v(t._s(e.lang))]),s("p",{staticClass:"lable-danger"},[t._v(t._s(e.name))])])}))],2)],1)}),[],!1,null,"645a315a",null).exports},85165:(t,e,s)=>{s.r(e),s.d(e,{default:()=>_});var a=s(95082),i=(s(82500),s(49414)),n=(s(82522),s(10342)),o=(s(86039),s(20495)),r=(s(20581),s(50914)),l=(s(47601),s(44951)),c=(s(49153),s(5944)),d=(s(69710),s(57609)),m=(s(52355),s(29233)),h=(s(33948),s(26294)),u=s(6106),p=s(74579),g=s(78368),f={components:{[m.Z.name]:m.Z,[d.Z.name]:d.Z,[c.Z.name]:c.Z,[l.Z.name]:l.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[n.Z.name]:n.Z,[i.Z.name]:i.Z,ReportItemBox:p.Z},data:function(){return{activeTab:"absence",tabs:[{name:"absence",lang:"data.waited"},{name:"passed",lang:"data.passed"},{name:"failed",lang:"data.failed"},{name:"scoring",lang:"data.scoring"},{name:"absence",lang:"data.absence"}],list:[],loading:!1,finished:!1,params:{keyword:"",status:"absence",page_number:0,page_size:10},basicInfo:{},defaultAvatar:g,examStatus:""}},computed:(0,a.Z)({},(0,h.mapGetters)({primaryColor:"getPrimaryColor"})),mounted(){this.examId=this.$route.params.examId;const{examStatus:t}=this.$route.query;this.examStatus=t,this.initTabs(t)},methods:{initTabs(t){let e=[];const s=this.tabs;"unfinished"===t?e=s.slice(0,4):"finished"===t&&(e=s.slice(1,5)),this.activeTab=e[0].name,this.tabs=e,this.params.status=e[0].name},onTabChange(){this.onRefresh()},renderUserItemValue(t){const{activeTab:e,examStatus:s}=this;return"passed"===e||"failed"===e?t.score+this.$t("studyProject.score"):"scoring"===e?this.$t("data.scoring"):"absence"===e&&"finished"===s?this.$t("data.absence"):null},onRefresh(){this.params=(0,a.Z)((0,a.Z)({},this.params),{},{status:this.activeTab,page_number:0}),this.loading=!0,this.finished=!1,this.list=[],this.loading&&this.onLoad()},async onLoad(){this.params.page_number+=1;const{data:t}=await u.Z.getCockpitsExam((0,a.Z)((0,a.Z)({},this.params),{},{examId:this.examId}));this.basicInfo=t.exam_base;const{list:e,has_next_page:s}=t.data;this.list=[...this.list,...e],this.loading=!1,"false"!==s&&""!==s||(this.finished=!0)}}},v=f,_=(0,s(1001).Z)(v,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"report-exam"},[s("van-search",{attrs:{placeholder:t.$t("data.searchName")},on:{search:t.onRefresh,clear:t.onRefresh},model:{value:t.params.keyword,callback:function(e){t.$set(t.params,"keyword",e)},expression:"params.keyword"}}),s("van-divider",{style:{margin:"0"}}),s("report-item-box",{attrs:{title:t.basicInfo.title,"create-user-name":t.basicInfo.create_user_name,"begin-time":t.basicInfo.begin_time,"end-time":t.basicInfo.end_time,"train-limit":t.basicInfo.train_limit,count:[{name:t.basicInfo.pass_count,lang:t.$t("data.passed")},{name:t.basicInfo.unpass_count,lang:t.$t("data.failed")}]}}),s("van-tabs",{attrs:{color:t.primaryColor,"line-width":24,sticky:""},on:{change:t.onTabChange},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},t._l(t.tabs,(function(e){return s("van-tab",{key:e.name,attrs:{title:t.$t(e.lang),name:e.name}})})),1),s("van-list",{staticClass:"user-list",attrs:{"loading-text":t.$t("common.loading"),finished:t.finished,"finished-text":t.finished&&0===t.list.length?"":t.$t("common.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[t._l(t.list,(function(e){return s("van-cell",{key:e.id,staticClass:"user-item",attrs:{icon:e.avatar||t.defaultAvatar,center:"",title:e.name,label:e.departments.join(" / "),value:t.renderUserItemValue(e)}})})),t.finished&&0===t.list.length?s("van-empty",{attrs:{description:t.$t("common.noDataTextTip")}}):t._e()],2)],1)}),[],!1,null,"0a23ce64",null).exports},9274:(t,e,s)=>{s.r(e),s.d(e,{default:()=>f});var a=s(95082),i=(s(82500),s(49414)),n=(s(82522),s(10342)),o=(s(86039),s(20495)),r=(s(20581),s(50914)),l=(s(49153),s(5944)),c=(s(69710),s(57609)),d=(s(33948),s(57658),s(26294)),m=s(6106),h=s(5648),u=s(93005),p={components:{[c.Z.name]:c.Z,[l.Z.name]:l.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[n.Z.name]:n.Z,[i.Z.name]:i.Z,ReportBox:u.Z},beforeRouteLeave(t,e,s){"Report"===t.name&&"ReportExams"===e.name&&localStorage.removeItem("examsTabName"),s()},data:function(){return{activeTab:h.r[0].name,tabs:h.r,list:[],loading:!1,finished:!1,params:{keyword:"",status:h.r[0].name,page_number:0,page_size:10}}},computed:(0,a.Z)({},(0,d.mapGetters)({primaryColor:"getPrimaryColor"})),mounted(){localStorage.getItem("examsTabName")&&(this.activeTab=localStorage.getItem("examsTabName"),this.params.status=this.activeTab)},methods:{onTabChange(t){this.onRefresh(),localStorage.setItem("examsTabName",t)},onRefresh(){this.params=(0,a.Z)((0,a.Z)({},this.params),{},{status:this.activeTab,page_number:0}),this.loading=!0,this.finished=!1,this.list=[],this.loading&&this.onLoad()},async onLoad(){this.params.page_number+=1;const{data:t}=await m.Z.getCockpitsExams((0,a.Z)({},this.params)),{list:e,has_next_page:s}=t;this.list=[...this.list,...e],this.loading=!1,"false"===s&&(this.finished=!0)},toDetail(t){this.$router.push({path:`/home-module/report/exam/${t}`,query:{examStatus:this.activeTab}})}}},g=p,f=(0,s(1001).Z)(g,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"report-exams"},[s("van-search",{attrs:{placeholder:t.$t("task.searchTask")},on:{search:t.onRefresh,clear:t.onRefresh},model:{value:t.params.keyword,callback:function(e){t.$set(t.params,"keyword",e)},expression:"params.keyword"}}),s("van-divider",{style:{margin:"0"}}),s("van-tabs",{attrs:{color:t.primaryColor,"line-width":24,sticky:""},on:{change:t.onTabChange},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},t._l(t.tabs,(function(e){return s("van-tab",{key:e.name,attrs:{title:t.$t(e.lang),name:e.name}})})),1),s("van-list",{staticClass:"exam-list",attrs:{"loading-text":t.$t("common.loading"),finished:t.finished,"finished-text":t.finished&&0===t.list.length?"":t.$t("common.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[t._l(t.list,(function(e){return s("report-box",{key:e.id,attrs:{"active-tab-name":t.activeTab,title:e.title,type:e.type,"create-user-name":e.create_user_name,"begin-time":e.begin_time,"end-time":e.end_time,"train-limit":e.train_limit,count:[{lang:t.$t("data.passedNumber",{param:e.pass_count}),color:"#465dcd"},{lang:t.$t("data.failedNumber",{param:e.unpass_count}),color:"#d64f4f"},{lang:t.$t("unfinished"===t.activeTab?"data.waitedNumber":"data.unExamNumber",{param:e.unexam_count}),color:"#f5a623"}]},nativeOn:{click:function(s){"unstarted"!==t.activeTab&&t.toDetail(e.id)}}})})),t.finished&&0===t.list.length?s("van-empty",{attrs:{description:t.$t("common.noDataTextTip")}}):t._e()],2)],1)}),[],!1,null,"5ac7cc1d",null).exports},45488:(t,e,s)=>{s.r(e),s.d(e,{default:()=>g});var a=s(95082),i=(s(20581),s(50914)),n=(s(47601),s(44951)),o=(s(29941),s(64168)),r=(s(52355),s(29233)),l=(s(70885),s(6458)),c=(s(18144),s(65641)),d=(s(57658),s(6106)),m=s(68092),h=s(78551),u=s(26294),p={components:{[c.Z.name]:c.Z,[l.Z.name]:l.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[n.Z.name]:n.Z,[i.Z.name]:i.Z,SvgIcon:h.Z},props:{showCover:{type:Boolean,default:!0}},data:()=>({basicInfo:{}}),computed:(0,a.Z)((0,a.Z)({},(0,u.mapState)("user",["isAdmin"])),(0,u.mapGetters)({pageFrom:"getPageFrom"})),created(){},mounted(){this.init()},methods:{async init(){this.$toast.loading({duration:0,message:this.$t("common.loading"),loadingType:"spinner",forbidClick:!0});const{data:t}=await d.Z.getCockpits();this.basicInfo=t,this.$toast.clear()},goDetail(t){(this.isAdmin||(0,m.UI)("MOBILE_EXPORT_WHITE_FLAG"))&&("plan"===t?this.toPlans():"exam"===t&&this.toExams())},toPlans(){this.$router.push("/home-module/report/plans")},toExams(){this.$router.push("/home-module/report/exams")}}},g=(0,s(1001).Z)(p,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"report"},[t.showCover?s("van-image",{attrs:{fit:"contain",src:"http://oss.coolcollege.cn/1790114027146448896.png"}}):t._e(),s("div",{staticClass:"report-item",on:{click:function(){return t.goDetail("plan")}}},[s("div",{staticClass:"left-box"},[s("van-image",{attrs:{src:"https://gsdn.coolcollege.cn/assets/kuxueyuan/mobile/icon/learn-data.png",width:"42",height:"42"}}),s("div",{staticClass:"detail"},[s("h4",[t._v(t._s(t.$t("data.learningTasks"))),t.isAdmin?s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-chakanpaiming",color:"#b0b4c8",size:13}}):t._e()],1),s("van-row",[s("van-col",{attrs:{span:"8"}},[s("p",{staticClass:"label"},[t._v(t._s(t.$t("data.notStarted")))]),s("p",{staticClass:"label"},[t._v(t._s(t.basicInfo.plan_unstart_conut))])]),s("van-col",{attrs:{span:"8"}},[s("p",{staticClass:"label"},[t._v(t._s(t.$t("data.ongoing")))]),s("p",{staticClass:"lable-primary"},[t._v(t._s(t.basicInfo.plan_ongoing_count))])]),s("van-col",{attrs:{span:"8"}},[s("p",{staticClass:"label"},[t._v(t._s(t.$t("data.over")))]),s("p",{staticClass:"lable-danger"},[t._v(t._s(t.basicInfo.plan_finish_count))])])],1)],1)],1),s("div",{staticClass:"sum"},[s("p",[t._v(t._s(t.basicInfo.plan_count))]),s("p",{staticClass:"label"},[t._v(t._s(t.$t("data.totalTasks")))])])]),s("div",{staticClass:"report-item",on:{click:function(){return t.goDetail("exam")}}},[s("div",{staticClass:"left-box"},[s("van-image",{attrs:{src:"https://gsdn.coolcollege.cn/assets/kuxueyuan/mobile/icon/exam-data.png",width:"42",height:"42"}}),s("div",{staticClass:"detail"},[s("h4",[t._v(t._s(t.$t("data.examTasks"))),t.isAdmin?s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-chakanpaiming",color:"#b0b4c8",size:13}}):t._e()],1),s("van-row",[s("van-col",{attrs:{span:"8"}},[s("p",{staticClass:"label"},[t._v(t._s(t.$t("data.notStarted")))]),s("p",{staticClass:"label"},[t._v(t._s(t.basicInfo.exam_plan_unstart_conut))])]),s("van-col",{attrs:{span:"8"}},[s("p",{staticClass:"label"},[t._v(t._s(t.$t("data.ongoing")))]),s("p",{staticClass:"lable-primary"},[t._v(t._s(t.basicInfo.exam_plan_ongoing_count))])]),s("van-col",{attrs:{span:"8"}},[s("p",{staticClass:"label"},[t._v(t._s(t.$t("data.over")))]),s("p",{staticClass:"lable-danger"},[t._v(t._s(t.basicInfo.exam_plan_finish_count))])])],1)],1)],1),s("div",{staticClass:"sum"},[s("p",[t._v(t._s(t.basicInfo.exam_plan_count))]),s("p",{staticClass:"label"},[t._v(t._s(t.$t("data.totalTasks")))])])]),s("div",{staticClass:"report-item"},[s("div",{staticClass:"left-box"},[s("van-image",{attrs:{src:"https://gsdn.coolcollege.cn/assets/kuxueyuan/mobile/icon/course-data.png",width:"42",height:"42"}}),s("div",{staticClass:"detail"},[s("h4",[t._v(t._s(t.$t("data.coursesStatistics")))]),s("van-row",[s("van-col",{attrs:{span:"12"}},[s("p",{staticClass:"label"},[t._v(t._s(t.$t("data.outsourcing")))]),s("p",{staticClass:"lable-primary"},[t._v(t._s(t.basicInfo.platform_course_count))])]),s("van-col",{attrs:{span:"12"}},[s("p",{staticClass:"label"},[t._v(t._s(t.$t("data.selfCreated")))]),s("p",{staticClass:"lable-danger"},[t._v(t._s(t.basicInfo.enterprise_course_count))])])],1)],1)],1),s("div",{staticClass:"sum"},[s("p",[t._v(t._s(t.basicInfo.course_count))]),s("p",{staticClass:"label"},[t._v(t._s(t.$t("data.totalCourses")))])])])],1)}),[],!1,null,"8b379736",null).exports},81399:(t,e,s)=>{s.r(e),s.d(e,{default:()=>f});var a=s(95082),i=(s(82500),s(49414)),n=(s(82522),s(10342)),o=(s(86039),s(20495)),r=(s(20581),s(50914)),l=(s(49153),s(5944)),c=(s(69710),s(57609)),d=(s(33948),s(57658),s(26294)),m=s(6106),h=s(5648),u=s(93005),p={components:{[c.Z.name]:c.Z,[l.Z.name]:l.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[n.Z.name]:n.Z,[i.Z.name]:i.Z,ReportBox:u.Z},beforeRouteLeave(t,e,s){"Report"===t.name&&"ReportPlans"===e.name&&localStorage.removeItem("plansTabName"),s()},data:function(){return{activeTab:h.r[0].name,tabs:h.r,list:[],loading:!1,finished:!1,params:{keyword:"",status:h.r[0].name,page_number:0,page_size:10}}},computed:(0,a.Z)({},(0,d.mapGetters)({primaryColor:"getPrimaryColor"})),mounted(){localStorage.getItem("plansTabName")&&(this.activeTab=localStorage.getItem("plansTabName"),this.params.status=this.activeTab)},methods:{onTabChange(t){this.onRefresh(),localStorage.setItem("plansTabName",t)},onRefresh(){this.params=(0,a.Z)((0,a.Z)({},this.params),{},{status:this.activeTab,page_number:0}),this.loading=!0,this.finished=!1,this.list=[],this.loading&&this.onLoad()},async onLoad(){this.params.page_number+=1;const{data:t}=await m.Z.getCockpitsPlans((0,a.Z)({},this.params)),{list:e,has_next_page:s}=t;this.list=[...this.list,...e],this.loading=!1,"false"===s&&(this.finished=!0)},toDetail(t){this.$router.push({path:`/home-module/report/plan/${t}`,query:{planStatus:this.activeTab}})}}},g=p,f=(0,s(1001).Z)(g,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"report-plans"},[s("van-search",{attrs:{placeholder:t.$t("task.searchTask")},on:{search:t.onRefresh,clear:t.onRefresh},model:{value:t.params.keyword,callback:function(e){t.$set(t.params,"keyword",e)},expression:"params.keyword"}}),s("van-divider",{style:{margin:"0"}}),s("van-tabs",{attrs:{color:t.primaryColor,"line-width":24,sticky:""},on:{change:t.onTabChange},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},t._l(t.tabs,(function(e){return s("van-tab",{key:e.name,attrs:{title:t.$t(e.lang),name:e.name}})})),1),s("van-list",{staticClass:"plan-list",attrs:{"loading-text":t.$t("common.loading"),finished:t.finished,"finished-text":t.finished&&0===t.list.length?"":t.$t("common.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[t._l(t.list,(function(e){return s("report-box",{key:e.id,attrs:{"active-tab-name":t.activeTab,title:e.title,type:e.type,"create-user-name":e.create_user_name,"begin-time":e.begin_time,"end-time":e.end_time,"train-limit":e.train_limit,count:[{lang:t.$t("task.completedNumber",{param:e.finished_count}),color:"#465dcd"},{lang:t.$t("task.underwayNumber",{param:e.ongoing_count}),color:"#d64f4f"},{lang:t.$t("task.overdueNumber",{param:e.overdue_count}),color:"#f5a623"}]},nativeOn:{click:function(s){"unstarted"!==t.activeTab&&t.toDetail(e.id)}}})})),t.finished&&0===t.list.length?s("van-empty",{attrs:{description:t.$t("common.noDataTextTip")}}):t._e()],2)],1)}),[],!1,null,"3bbed10a",null).exports},91666:(t,e,s)=>{s.r(e),s.d(e,{default:()=>_});var a=s(95082),i=(s(82500),s(49414)),n=(s(82522),s(10342)),o=(s(86039),s(20495)),r=(s(20581),s(50914)),l=(s(47601),s(44951)),c=(s(49153),s(5944)),d=(s(69710),s(57609)),m=(s(52355),s(29233)),h=(s(33948),s(57658),s(26294)),u=s(6106),p=s(74579),g=s(78368),f={components:{[m.Z.name]:m.Z,[d.Z.name]:d.Z,[c.Z.name]:c.Z,[l.Z.name]:l.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[n.Z.name]:n.Z,[i.Z.name]:i.Z,ReportItemBox:p.Z},data:function(){return{activeTab:"finished",tabs:[{name:"finished",lang:"data.finished"},{name:"unfinished",lang:"data.ongoing"},{name:"overdue",lang:"data.overdue"}],list:[],loading:!1,finished:!1,params:{status:"finished",page_number:0,page_size:10},basicInfo:{finished_count:0,ongoing_count:0,overdue_count:0},defaultCount:[],defaultAvatar:g,status:"unstarted",planStatus:""}},computed:(0,a.Z)({},(0,h.mapGetters)({primaryColor:"getPrimaryColor"})),mounted(){this.planId=this.$route.params.planId;const{planStatus:t}=this.$route.query;this.planStatus=t},methods:{onTabChange(){this.onRefresh()},onRefresh(){this.params=(0,a.Z)((0,a.Z)({},this.params),{},{status:this.activeTab,page_number:0}),this.loading=!0,this.finished=!1,this.list=[],this.loading&&this.onLoad()},async onLoad(){this.params.page_number+=1;const{data:t}=await u.Z.getCockpitsPlan((0,a.Z)((0,a.Z)({},this.params),{},{planId:this.planId}));this.basicInfo=t.plan_base,this.renderCount(this.basicInfo.type);const{list:e,has_next_page:s}=t.data;this.list=[...this.list,...e],this.loading=!1,"false"!==s&&""!==s||(this.finished=!0)},renderCount(t){this.defaultCount=[{name:this.basicInfo.finished_count,lang:this.$t("data.finished")},{name:this.basicInfo.ongoing_count,lang:this.$t("data.ongoing")}],"neo"===t?this.defaultCount.push({name:this.basicInfo.overdue_count,lang:this.$t("data.overdue")}):"finished"===this.planStatus&&(this.defaultCount=[{name:this.basicInfo.finished_count,lang:this.$t("data.finished")},{name:this.basicInfo.overdue_count,lang:this.$t("data.overdue")}])}}},v=f,_=(0,s(1001).Z)(v,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"report-plan"},[s("report-item-box",{attrs:{title:t.basicInfo.title,"create-user-name":t.basicInfo.create_user_name,"begin-time":t.basicInfo.begin_time,"end-time":t.basicInfo.end_time,"train-limit":t.basicInfo.train_limit,count:t.defaultCount}}),s("van-tabs",{attrs:{color:t.primaryColor,"line-width":24,sticky:""},on:{change:t.onTabChange},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},t._l(t.tabs,(function(e){return s("van-tab",{key:e.name,attrs:{title:t.$t(e.lang),name:e.name}})})),1),s("van-divider",{style:{margin:"0"}}),s("van-list",{staticClass:"user-list",attrs:{"loading-text":t.$t("common.loading"),finished:t.finished,"finished-text":t.finished&&0===t.list.length?"":t.$t("common.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[t._l(t.list,(function(e){return s("van-cell",{key:e.id,staticClass:"user-item",attrs:{icon:e.avatar||t.defaultAvatar,center:"",title:e.name,label:e.departments.join(" / "),value:e.progress+"%"}})})),t.finished&&0===t.list.length?s("van-empty",{attrs:{description:t.$t("common.noDataTextTip")}}):t._e()],2)],1)}),[],!1,null,"7b08f8ce",null).exports},76119:(t,e,s)=>{s.r(e),s.d(e,{default:()=>f});var a=s(95082),i=(s(3791),s(93432)),n=(s(39610),s(2163)),o=(s(47601),s(44951)),r=(s(49153),s(5944)),l=(s(20581),s(50914)),c=(s(57658),s(23493)),d=s.n(c),m=s(30097),h=s(22648),u=s(95969),p=s(78368),g={components:{[l.Z.name]:l.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[n.Z.name]:n.Z,[i.Z.name]:i.Z},data:()=>({activeTab:0,dataLoading:!0,researchList:[],loading:!1,finished:!0,page:{page_number:1,page_size:10},defaultAvatar:p,timestamp:(new Date).getTime()}),computed:{tabs(){return[{title:this.$t("common.unfinished"),status:"unfinished"},{title:this.$t("common.finished"),status:"finished"},{title:this.$t("common.overdue"),status:"overdue"}]}},mounted(){this.$route.query.activeTab&&(this.activeTab=Number(this.$route.query.activeTab)),this.getResearchList()},methods:{handleTabClick(t){this.activeTab=t,this.dataLoading=!0,this.page.page_number=1,this.researchList=[],this.getResearchList()},async getResearchList(){const t=(0,a.Z)({status:this.tabs[this.activeTab].status},this.page),{status:e,data:s}=await m.Z.getResearchList(t);200===e&&(this.researchList=this.researchList.concat(s.list),this.finished="false"===s.has_next_page),this.dataLoading=!1,this.loading=!1},onLoadMore(){this.page.page_number+=1,this.loading=!0,this.getResearchList()},formatDate:t=>t?(0,h.p6)(t,"yyyy-MM-dd hh:mm"):"",onCardClick(t){d()((()=>{const{id:e,questionnaire_id:s,begin_time:a,open_result:i,end_time:n,term_type:o}=t,{status:r}=this.tabs[this.activeTab];let l="";if("unfinished"===r){if("permanent"===o)return this.$router.push({path:u.Z.taskResource.researchDetail({investigateId:e,questionnaireId:s})}),!1;if((new Date).getTime()<a)l=this.$t("home.researchNotStartTips");else{if(!(n&&(new Date).getTime()>n))return this.$router.push({path:u.Z.taskResource.researchDetail({investigateId:e,questionnaireId:s})}),!1;l=this.$t("home.researchEndedTips")}}else if("finished"===r){if("true"===i)return this.$router.push({path:u.Z.taskResource.researchResult({investigateId:e})}),!1;l=this.$t("home.resultDisclosureTips")}else l=this.$t("home.researchEndedTips");this.$toast(l)}),1e3)()}}},f=(0,s(1001).Z)(g,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"research-container"},[s("van-sticky",[s("div",{staticClass:"research-tab-content"},t._l(t.tabs,(function(e,a){return s("div",{key:e.status,staticClass:"research-tab-item",class:a===t.activeTab?"research-tab-active-item":"",on:{click:function(e){return t.handleTabClick(a)}}},[a===t.activeTab?s("div",{staticClass:"research-tab-item-line"}):t._e(),s("div",[t._v(" "+t._s(e.title)+" ")])])})),0)]),s("van-loading",{directives:[{name:"show",rawName:"v-show",value:t.dataLoading,expression:"dataLoading"}],staticClass:"research-list-center"}),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.dataLoading,expression:"!dataLoading"}]},[t.researchList.length?s("van-list",{staticClass:"research-list-content",attrs:{finished:t.finished,"finished-text":t.$t("common.noMore")},on:{load:t.onLoadMore},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.researchList,(function(e){return s("div",{key:e.id,staticClass:"research-list-card",on:{click:function(s){return t.onCardClick(e)}}},[s("div",{staticClass:"research-card-info"},[s("div",{staticClass:"research-card-title"},[t._v(" "+t._s(e.title)+" ")]),"finished"===t.tabs[t.activeTab].status?s("div",{staticClass:"research-card-validity-period"},["true"===e.open_result?s("div",{staticClass:"research-card-result"},[s("span",[t._v(" "+t._s(t.$t("research.statisticalResults"))+" ")]),s("svg-icon",{staticClass:"icon-font",attrs:{color:"#7F849A","icon-class":"icon-jinrujiantou",size:10}})],1):s("span",[t._v(" "+t._s(t.$t("research.submitTime"))+": "+t._s(t.formatDate(e.commit_time))+" ")])]):s("div",{staticClass:"research-card-validity-period"},["effective"===e.type?s("span",[t._v(" "+t._s(t.$t("research.permanentValid"))+" ")]):s("div",[t.timestamp<e.begin_time?s("span",[t._v(" "+t._s(t.$t("home.startTime"))+": "+t._s(t.formatDate(e.begin_time))+" ")]):s("span",[t._v(" "+t._s(t.$t("common.deadline"))+": "+t._s(t.formatDate(e.end_time))+" ")])])])]),s("div",{staticClass:"research-card-assign"},[s("van-image",{staticClass:"research-card-avatar",attrs:{src:e.create_user_avatar||t.defaultAvatar,round:""}}),e.departments&&e.departments.length>0?s("div",{staticClass:"research-card-department van-ellipsis"},[t._v(" ("+t._s(e.departments.join("/"))+") ")]):t._e(),s("div",[t._v(t._s(e.create_user_name)+" "+t._s(t.$t("common.assign")))])],1)])})),0):s("van-empty",{staticClass:"research-list-center",attrs:{description:t.$t("common.noDataTextTip")}})],1)],1)}),[],!1,null,"a27129a0",null).exports},13372:(t,e,s)=>{s.r(e),s.d(e,{default:()=>d});s(39610);var a=s(2163),i=(s(74916),s(64765),s(73210),s(15306),s(64508)),n=(s(33948),s(6106)),o={name:"SearchFilter",data:()=>({historyList:[],likeList:[]}),computed:{result(){return[{name:"history",noDataText:this.$t("search.noHistory"),title:this.$t("search.searchHistory"),list:this.historyList},{name:"like",noDataText:this.$t("search.noLike"),title:this.$t("search.guessYouLike"),list:this.likeList}]}},mounted(){this.init()},methods:{init(){Promise.all([n.Z.getHistoryList({top:10}),n.Z.getLikeList({top:10})]).then((t=>{this.historyList=t[0].data.data,this.likeList=t[1].data.data}))},onItemClick(t){this.$emit("change",t)}}},r=s(1001),l=(0,r.Z)(o,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"search-filter"},t._l(t.result,(function(e,a){return s("div",{key:a.toString()},[s("div",{staticClass:"filter-title",class:e.name},[t._v(" "+t._s(e.title)+" ")]),s("div",{staticClass:"search-content",class:e.name},[e.list.length?t._l(e.list,(function(e,a){return s("div",{key:a.toString(),staticClass:"content-text",on:{click:function(){return t.onItemClick(e)}}},[t._v(t._s(e))])})):s("div",{staticClass:"no-result"},[t._v(" "+t._s(e.noDataText))])],2)])})),0)}),[],!1,null,null,null).exports,c={name:"HomeSearch",components:{SearchBox:i.Z,SearchFilter:l,[a.Z.name]:a.Z},data:()=>({}),computed:{keyword(){return this.$store.state.search.keyword}},mounted(){this.$store.commit("search/setKeyword",""),this.$store.commit("search/setActive","synthesize")},methods:{onSearch(t){this.$store.commit("search/setKeyword",t),this.onSubmit(t)},onSubmit(t){""!==t.trim()?this.$router.replace("/home-module/search-result"):this.$toast(this.$t("search.searchTip"))},onClear(){this.$store.commit("search/setKeyword",""),this.$store.commit("search/setActive","synthesize")}}},d=(0,r.Z)(c,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"home-search",style:{backgroundColor:"#FFF"}},[s("van-sticky",[s("search-box",{attrs:{placeholder:t.$t("common.search"),"show-action":!0,"action-text":t.$t("common.search"),data:t.keyword,"max-length":50},on:{search:t.onSearch,clear:t.onClear}})],1),s("search-filter",{on:{change:t.onSearch}})],1)}),[],!1,null,"822f02e2",null).exports},48025:(t,e,s)=>{s.r(e),s.d(e,{default:()=>J});s(39610);var a=s(2163),i=(s(74916),s(64765),s(73210),s(15306),s(64508)),n=s(57969);const o=[{title:n.Z.t("search.synthesize"),name:"synthesize",active:!1},{title:n.Z.t("search.course"),name:"course",active:!1},{title:n.Z.t("search.lecturer"),name:"lecturer",active:!1},{title:n.Z.t("search.task"),name:"task",active:!1}];var r={name:"SearchTab",data:()=>({list:o}),computed:{active(){return this.$store.state.search.active}},watch:{active(t){this.$emit("change",t)}},methods:{handleTabChange(t){this.$store.commit("search/setActive",t.name)}}},l=s(1001),c=(0,l.Z)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"search-tab"},t._l(t.list,(function(e,a){return s("div",{key:a.toString(),class:[e.name===t.active?"active":"","tab-item"],on:{click:function(){return t.handleTabChange(e)}}},[t._v(" "+t._s(e.title)+" ")])})),0)}),[],!1,null,"75b16370",null).exports,d=(s(49153),s(5944)),m=(s(3791),s(93432)),h=(s(20581),s(50914)),u=(s(57658),s(29941),s(64168)),p=(s(52355),s(29233)),g={name:"ModuleTitle",components:{[p.Z.name]:p.Z,[u.Z.name]:u.Z},props:{title:{type:String,default:""},total:{type:Number,default:0}}},f=(0,l.Z)(g,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"module-title",on:{click:function(e){return t.$emit("click")}}},[s("van-cell",{attrs:{title:t.title,"is-link":""},scopedSlots:t._u([{key:"default",fn:function(){return[s("div",{staticClass:"cell-desc"},[t._v(" "+t._s(t.$t("search.all"))),s("span",{staticClass:"text"},[t._v(t._s(t.total))]),t._v(t._s(t.$t("search.a"))+" ")])]},proxy:!0}])})],1)}),[],!1,null,"091f6d17",null).exports,v=s(95082);const _={unfinished:{title:n.Z.t("home.unfinished"),status:"unfinished"},passed:{title:n.Z.t("home.passed"),status:"passed"},failed:{title:n.Z.t("home.failed"),status:"failed"},scoring:{title:n.Z.t("home.scoring"),status:"scoring"},absence:{title:n.Z.t("home.absence"),status:"absence"}},y={unfinished:{title:n.Z.t("home.unfinished"),status:"unfinished"},finished:{title:n.Z.t("home.finished"),status:"finished"},overdue:{title:n.Z.t("home.overdue"),status:"overdue"}};n.Z.t("search.researchTask"),n.Z.t("search.examTask"),n.Z.t("search.studyTask");s(47238);var C=s(75167),k=s(4852),b=s(26294),$=s(45877),T={name:"CardBottom",components:{[C.Z.name]:C.Z,avatar:k.Z,ClCustomUser:$.Z},props:{item:{type:Object,default:()=>{}},isHome:{type:Boolean,default:!1}},computed:(0,v.Z)({},(0,b.mapGetters)({primaryColor:"getPrimaryColor"}))},x=(0,l.Z)(T,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card-bottom"},[s("div",{staticClass:"bottom-avatar"},[s("avatar",{attrs:{src:t.item.createUserAvatar,width:"18",height:"18"}}),s("div",{staticClass:"appoint-user"},[s("span",{staticClass:"user-name"},[s("cl-custom-user",{attrs:{type:t.item.creatorSourceType,"data-type":"userName",value:t.item.creatorSyncUserId,name:t.item.createUserName}})],1),Array.isArray(t.item.departments)&&t.item.departments.length?s("span",{staticClass:"dept"},[s("span",{staticClass:"departments-name",class:[t.isHome?"all":""]},[t._v("( "+t._s(t.item.departments.join("/")))]),s("span",{staticClass:"single-symbol"},[t._v(")")])]):t._e(),s("span",{staticClass:"assign"},[t._v(t._s(t.$t("common.assign")))])])],1),t.item.progress<100&&"unfinished"===t.item.status?s("div",{staticClass:"percent"},[s("van-progress",{attrs:{"show-pivot":!1,percentage:+t.item.progress,"stroke-width":"4",color:t.primaryColor}}),s("div",{staticClass:"resource-progress"},[t._v(" "+t._s(+t.item.progress+"%")+" ")])],1):t._e(),t._t("right")],2)}),[],!1,null,"52337c2a",null).exports,Z=s(22648),w={name:"TaskCard",components:{CardBottom:x},props:{item:{type:Object,default:()=>{}},isHome:{type:Boolean,default:!1},timestamp:{type:Number,default:(new Date).getTime()}},computed:{status(){return _[this.item.taskStatus]},source(){return(0,v.Z)((0,v.Z)({},this.item),{},{createUserName:this.item.creatorName})},formattedBeginTime(){return this.item.beginTime?(0,Z.p6)(Number(this.item.beginTime),"yyyy-MM-dd hh:mm"):""}}},S=(0,l.Z)(w,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"task-card card-box",on:{click:function(e){return t.$emit("click")}}},[s("div",{staticClass:"card-title"},[s("div",{staticClass:"icon-title"},[s("span",{staticClass:"icon study-icon"}),s("span",{staticClass:"title"},[t._v(t._s(t.$t("search.examTask")))])]),!0===t.item.showResult?s("div",{staticClass:"icon-status"},[t._v(t._s(t.item.statusName))]):t._e()]),s("div",{staticClass:"card-body"},[s("div",{staticClass:"task-card-title",class:[t.status.status]},[t._v(t._s(t.item.title))]),"unfinished"===t.status.status?s("div",{staticClass:"begin-time"},["true"===t.item.showScore?s("span",{staticClass:"award-score"},[t._v(t._s(t.item.awardScore)+t._s(t.$t("pointsMall.credits")))]):t._e(),s("span",[t._v(t._s(t.$t("search.startTime"))+": "),s("span",{class:[t.status.status]},[t._v(t._s(t.formattedBeginTime))])])]):!0===t.item.showResult?s("div",{staticClass:"task-card-score"},[["failed","passed","perfect"].includes(t.status.status)?s("span",[t._v(" "+t._s(t.$t("search.points"))+": "+t._s(t.item.score)+" ")]):t._e(),["scoring","absence"].includes(t.status.status)?s("span",[t._v(" "+t._s(t.$t("search.noScore"))+" ")]):t._e()]):t._e()]),s("card-bottom",{attrs:{item:t.source}},[s("div",{staticClass:"exam-end",attrs:{slot:"right"},slot:"right"},["true"===t.item.repeatExam?s("span",{staticClass:"can-repeat-exam"},[t._v(t._s(t.$t("search.retake")))]):t._e(),"true"===t.item.replenishExam?s("span",{staticClass:"can-repeat-exam"},[t._v(t._s(t.$t("search.replenishExam")))]):t._e()])])],1)}),[],!1,null,"111e4ad6",null).exports,L={name:"TaskCard",components:{CardBottom:x},props:{item:{type:Object,default:()=>{}},isHome:{type:Boolean,default:!1},timestamp:{type:Number,default:(new Date).getTime()}},computed:(0,v.Z)({status(){return y[this.item.status]},formattedCommitTime(){return this.item.commitTime?(0,Z.p6)(Number(this.item.commitTime),"yyyy-MM-dd hh:mm"):""},formattedEndTime(){return this.item.endTime?(0,Z.p6)(Number(this.item.endTime),"yyyy-MM-dd hh:mm"):""},formattedBeginTime(){return this.item.beginTime?(0,Z.p6)(Number(this.item.beginTime),"yyyy-MM-dd hh:mm"):""}},(0,b.mapGetters)({primaryColor:"getPrimaryColor"}))},I=(0,l.Z)(L,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"investigate-card card-box",on:{click:function(e){return t.$emit("click")}}},[s("div",{staticClass:"card-title"},[s("div",{staticClass:"icon-title"},[s("span",{staticClass:"icon study-icon"}),s("span",{staticClass:"title"},[t._v(t._s(t.$t("search.researchTask")))])]),s("div",{staticClass:"icon-status"},[t._v(t._s(t.status.title))])]),s("div",{staticClass:"card-body"},[s("span",{staticClass:"body-title"},[t._v(t._s(t.item.title))]),s("div",{staticClass:"end-time"},["finished"===t.item.status?s("div",["true"===t.item.openResult?s("div",{staticClass:"effective"},[t._v(" "+t._s(t.$t("research.statisticalResults"))+" "),s("svg-icon",{staticClass:"icon-font",attrs:{color:t.primaryColor,"icon-class":"icon-jinrujiantou",size:10}})],1):s("span",[t._v(" "+t._s(t.$t("research.submitTime"))+":"+t._s(t.formattedCommitTime)+" ")])]):s("div",["effective"===t.item.type?s("span",[t._v(t._s(t.$t("research.permanentValid")))]):s("div",[t.timestamp<t.item.beginTime?s("span",[t._v(t._s(t.$t("search.startTime"))+"："+t._s(t.formattedBeginTime))]):s("span",[t._v(t._s(t.$t("search.deadline"))+"："+t._s(t.formattedEndTime))])])])])]),s("card-bottom",{attrs:{item:t.item}})],1)}),[],!1,null,"d7f7f83e",null).exports,R={name:"StudyCard",components:{CardBottom:x},props:{item:{type:Object,default:()=>{}},timestamp:{type:Number,default:(new Date).getTime()},isHome:{type:Boolean,default:!1}},data:()=>({}),computed:(0,v.Z)({formattedFinishedTime(){return this.item.taskEndTime?(0,Z.p6)(Number(this.item.taskEndTime),"yyyy-MM-dd hh:mm"):""},formattedEndTime(){return this.item.endTime?(0,Z.p6)(Number(this.item.endTime),"yyyy-MM-dd hh:mm"):""},formattedBeginTime(){return this.item.beginTime?(0,Z.p6)(Number(this.item.beginTime),"yyyy-MM-dd hh:mm"):""},status(){return y[this.item.status]}},(0,b.mapGetters)({primaryColor:"getPrimaryColor"}))},P=(0,l.Z)(R,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"study-card card-box",on:{click:function(e){return t.$emit("click")}}},[s("div",{staticClass:"card-title"},[s("div",{staticClass:"icon-title"},[s("span",{staticClass:"icon study-icon"}),s("span",{staticClass:"title"},[t._v(t._s(t.$t("search.studyTask")))])]),s("div",{staticClass:"icon-status"},[t._v(t._s(t.status.title))])]),s("div",{staticClass:"card-body"},[s("span",{staticClass:"body-title"},[t._v(t._s(t.item.title))]),s("div",{staticClass:"end-time"},[t.timestamp<t.item.beginTime&&"unfinished"===t.item.status?s("span",[t._v(t._s(t.$t("search.startTime"))+"："+t._s(t.formattedBeginTime))]):t._e(),"finished"===t.item.status?s("span",[t._v(t._s(t.$t("search.finishTime"))+"："+t._s(t.formattedFinishedTime))]):s("div",["true"===t.item.showScore?s("span",{staticClass:"award-score"},[t._v(t._s(t.item.awardScore)+t._s(t.$t("search.credits")))]):t._e(),s("span",[t._v(t._s(t.$t("search.deadline"))+"："+t._s(t.formattedEndTime))])])])]),s("card-bottom",{attrs:{item:t.item}})],1)}),[],!1,null,"0b296967",null).exports,D=s(6106),E=s(95969),M=s(27632),N={name:"Task",components:{[h.Z.name]:h.Z,[d.Z.name]:d.Z,[m.Z.name]:m.Z,ModuleTitle:f,TaskCard:S,InvestigateCard:I,StudyCard:P},props:{showTotal:{type:Boolean,default:!0}},data(){return{list:[],loading:!1,finished:!1,finishedText:this.$t("common.noMore"),showEmpty:!1,fullLoading:!0,total:0,params:{pageNo:1,pageSize:10,keyword:"",source:"dingTalk"===M.Z.env?"dingding":"app"}}},computed:{keyword(){return this.$store.state.search.keyword},active(){return this.$store.state.search.active}},watch:{active(t,e){t!==e&&(this.params.pageNo=1,this.list=[],this.init())}},mounted(){this.params.pageNo=1,this.init()},beforeDestroy(){this.list=[]},methods:{async init(){try{this.fullLoading=1===this.params.pageNo,this.params.keyword=this.keyword;const t=await D.Z.searchTask(this.params),{total:e,list:s,hasNextPage:a}=t.data;if(this.hideLoading(),this.showTotal)return this.list=s.slice(0,2),this.finished=!0,this.finishedText="",this.showEmpty=!1,this.total=e,void this.$emit("changeCount",{show:!0,total:e});this.finished=0===e||"false"===a,this.showEmpty=0===e,this.hideLoading(),this.finishedText=this.$t("common.noMore"),this.list=0===e?[]:this.list.concat(s),this.$forceUpdate()}catch(t){this.hideLoading(),this.$emit("changeCount",{show:!0,total:0})}},goMore(){this.$store.commit("search/setActive","task")},onLoad(){this.params.pageNo+=1,this.init()},search(){this.list=[],this.params.pageNo=1,this.init()},hideLoading(){this.loading=!1,this.fullLoading=!1},handleExamTaskRedirect(t){E.Z.exam.toExamOldNew(t)},handleStudyTaskRedirect(t){const{id:e,status:s,beginTime:a}=t;if((new Date).getTime()<a)return void this.$toast(this.$t("task.taskNotStarted"));const i=E.Z.home.studyDetail({studyId:e,studyStatus:s,origin:"vue"});this.$router.push({path:i})},handleInvestigateTaskRedirect(t){const{id:e,status:s,questionnaireId:a,startTime:i,endTime:n,openResult:o}=t;let r="";if("unfinished"===s)if((new Date).getTime()<i)r=this.$t("home.researchNotStartTips");else{if(!(n&&(new Date).getTime()>n)){const t=E.Z.taskResource.researchDetail({investigateId:e,questionnaireId:a});return this.$router.push({path:t}),!1}r=this.$t("home.researchEndedTips")}else if("finished"===s){if("true"===o){const t=E.Z.taskResource.researchResult({investigateId:e});return this.$router.push({path:t}),!1}r=this.$t("home.resultDisclosureTips")}else r=this.$t("home.researchEndedTips");this.$toast(r)},handleCardClick(t){const{searchType:e}=t;"examTask"===e?this.handleExamTaskRedirect(t):"studyTask"===e?this.handleStudyTaskRedirect(t):this.handleInvestigateTaskRedirect(t)}}},G=N,A=(0,l.Z)(G,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"task-module",class:[t.fullLoading?"loading":""]},[t.fullLoading?s("van-loading",{staticClass:"loading-center"}):t._e(),t.list.length?s("div",{staticClass:"task"},[t.showTotal&&t.list.length?s("module-title",{attrs:{title:t.$t("search.task"),total:t.total},on:{click:t.goMore}}):t._e(),s("div",{staticClass:"module-list"},[s("van-list",{attrs:{"immediate-check":!1,finished:t.finished,"finished-text":t.finishedText},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e,a){return s("div",{key:a.toString()},["examTask"===e.searchType?s("task-card",{attrs:{item:e,"is-home":t.showTotal},on:{click:function(){return t.handleCardClick(e)}}}):t._e(),"investigateTask"===e.searchType?s("investigate-card",{attrs:{item:e,"is-home":t.showTotal},on:{click:function(){return t.handleCardClick(e)}}}):t._e(),"studyTask"===e.searchType?s("study-card",{attrs:{item:e,"is-home":t.showTotal},on:{click:function(){return t.handleCardClick(e)}}}):t._e()],1)})),0)],1)],1):t._e(),t.showEmpty?s("div",{staticClass:"module-empty"},[s("van-empty",{attrs:{description:t.$t("common.noDataTextTip")}})],1):t._e()],1)}),[],!1,null,"2f2b04c2",null).exports,F={name:"LecturerCard",components:{[p.Z.name]:p.Z,[u.Z.name]:u.Z,avatar:k.Z,ClCustomUser:$.Z},props:{list:{type:Array,default:()=>[]}},methods:{handleToLecturerDetail(t){const e=E.Z.home.lecturerDetail(t.id);this.$router.push({path:e})}}},z=(0,l.Z)(F,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"lecturer-card"},[s("van-cell-group",t._l(t.list,(function(e){return s("van-cell",{key:e.id,staticClass:"lecturer-card-item",on:{click:function(s){return t.handleToLecturerDetail(e)}},scopedSlots:t._u([{key:"icon",fn:function(){return[s("avatar",{attrs:{src:e.avatar,sex:e.sex,width:"45",height:"45"}})]},proxy:!0},{key:"title",fn:function(){return["inside"===e.type?s("span",{staticClass:"name"},[s("cl-custom-user",{attrs:{type:e.lecturerSourceType,"data-type":"userName",value:e.lecturerSyncUserId,name:e.lecturerName}})],1):s("span",{staticClass:"name"},[t._v(t._s(e.lecturerName))]),s("span",{staticClass:"level"},[t._v(t._s(e.levelName))]),e.levelName?t._e():s("span",{staticClass:"level default"},[t._v(t._s(t.$t("lecturer.NoGrade")))])]},proxy:!0}],null,!0)})})),1)],1)}),[],!1,null,"506a18c3",null).exports,O={name:"Lecturer",components:{[h.Z.name]:h.Z,[d.Z.name]:d.Z,[m.Z.name]:m.Z,LecturerCard:z,ModuleTitle:f},props:{showTotal:{type:Boolean,default:!0}},data(){return{list:[],loading:!1,finished:!1,finishedText:this.$t("common.noMore"),showEmpty:!1,fullLoading:!0,params:{keyword:"",pageNo:1,source:"dingTalk"===M.Z.env?"dingding":"app",pageSize:10}}},computed:{keyword(){return this.$store.state.search.keyword},active(){return this.$store.state.search.active}},watch:{active(t,e){t!==e&&(this.params.pageNo=1,this.list=[],this.init())}},mounted(){this.init()},beforeDestroy(){this.list=[]},methods:{async init(){try{this.fullLoading=1===this.params.pageNo,this.params.keyword=this.keyword;const t=await D.Z.searchLecturer(this.params),{total:e,list:s,hasNextPage:a}=t.data;if(this.hideLoading(),this.showTotal)return this.list=s.slice(0,3),this.finished=!0,this.finishedText="",this.showEmpty=!1,this.total=e,void this.$emit("changeCount",{show:!0,total:e});this.finished=0===e||"false"===a,this.showEmpty=0===e,this.list=0===e?[]:this.list.concat(s),this.finishedText=this.$t("common.noMore")}catch(t){this.hideLoading(),this.$emit("changeCount",{show:!0,total:0})}},goMore(){this.$store.commit("search/setActive","lecturer")},onLoad(){this.params.pageNo+=1,this.init()},search(){this.list=[],this.params.pageNo=1,this.init()},hideLoading(){this.loading=!1,this.fullLoading=!1}}},B=O,j=(0,l.Z)(B,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"lecturer-module",class:[t.fullLoading?"loading":""]},[t.fullLoading?s("van-loading",{staticClass:"loading-center"}):t._e(),t.list.length?s("div",{staticClass:"lecturer"},[t.showTotal&&t.list.length?s("module-title",{attrs:{title:t.$t("common.teacher"),total:t.total},on:{click:t.goMore}}):t._e(),s("van-list",{staticClass:"lecture-list-wrap",attrs:{"immediate-check":!1,finished:t.finished,"finished-text":t.finishedText},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[s("lecturer-card",{attrs:{list:t.list}})],1)],1):t._e(),t.showEmpty?s("div",{staticClass:"module-empty"},[s("van-empty",{attrs:{description:t.$t("common.noDataTextTip")}})],1):t._e()],1)}),[],!1,null,"414c58b2",null).exports,q=s(50459),H=s(52196),U={name:"Course",components:{CourseList:q.Z,ModuleTitle:f,[h.Z.name]:h.Z,[d.Z.name]:d.Z,[m.Z.name]:m.Z},props:{showTotal:{type:Boolean,default:!0}},data(){return{list:[],loading:!1,finished:!1,finishedText:this.$t("common.noMore"),showEmpty:!1,fullLoading:!0,params:{pageNo:1,pageSize:10,keyword:"",source:"dingTalk"===M.Z.env?"dingding":"app"},total:0}},computed:{keyword(){return this.$store.state.search.keyword},active(){return this.$store.state.search.active}},watch:{active(t,e){t!==e&&(this.params.pageNo=1,this.list=[],this.init())}},mounted(){this.init()},beforeDestroy(){this.list=[]},methods:{onCourseClick(t){(0,H.f2)({courseData:t})},goMore(){this.$store.commit("search/setActive","course")},async init(){try{this.fullLoading=1===this.params.pageNo,this.params.keyword=this.keyword;const t=await D.Z.searchCourse(this.params),{total:e,list:s,hasNextPage:a}=t.data;if(this.total=e,this.hideLoading(),this.showTotal)return this.list=s.slice(0,2),this.finished=!0,this.finishedText="",this.showEmpty=!1,void this.$emit("changeCount",{show:!0,total:e});this.finished=0===e||"false"===a,this.showEmpty=0===e,this.finishedText=this.$t("common.noMore"),this.list=0===e?[]:this.list.concat(s)}catch(t){this.hideLoading(),this.$emit("changeCount",{show:!0,total:0})}},onLoad(){this.params.pageNo+=1,this.init()},search(){this.list=[],this.params.pageNo=1,this.init()},hideLoading(){this.loading=!1,this.fullLoading=!1}}},V=U,K={name:"Synthesize",components:{Task:A,Course:(0,l.Z)(V,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"course-module"},[t.fullLoading?s("van-loading",{staticClass:"loading-center"}):t._e(),t.list.length?s("div",{staticClass:"course"},[t.showTotal?s("module-title",{attrs:{title:t.$t("common.course"),total:t.total},on:{click:t.goMore}}):t._e(),s("div",{staticClass:"module-list",class:[t.showTotal?"allSearch":""]},[s("van-list",{attrs:{"immediate-check":!1,finished:t.finished,"finished-text":t.finishedText},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[s("course-list",{attrs:{column:1,source:t.list},on:{click:t.onCourseClick}})],1)],1)],1):t._e(),t.showEmpty?s("div",{staticClass:"module-empty"},[s("van-empty",{attrs:{description:t.$t("common.noDataTextTip")}})],1):t._e()],1)}),[],!1,null,"ea959f76",null).exports,Lecturer:j,[m.Z.name]:m.Z,[d.Z.name]:d.Z},data:()=>({count:{course:{show:!1,total:0},lecturer:{show:!1,total:0},task:{show:!1,total:0}},total:0,fullLoading:!0,showCourse:!0,showLecturer:!0,showTask:!0,showTotal:!0,showEmpty:!1}),computed:{active(){return this.$store.state.search.active}},watch:{active(){this.renderCard()},count:{immediate:!0,handler:function(t){const{course:e,lecturer:s,task:a}=t;this.total=e.total+s.total+a.total,this.showEmpty=e.show&&s.show&&a.show&&0===this.total},deep:!0}},mounted(){this.renderCard()},methods:{changeCount(t,e){const{total:s,show:a}=e;this.$set(this.count,[t],{total:s,show:a}),this.fullLoading=!1},init(){this.showCourse&&this.$refs.courseRef.search(),this.showLecturer&&this.$refs.lecturerRef.search(),this.showTask&&this.$refs.taskRef.search()},onClear(){this.$emit("clear")},renderCard(){this.showTotal="synthesize"===this.active,this.showCourse=this.showTotal||"course"===this.active,this.showLecturer=this.showTotal||"lecturer"===this.active,this.showTask=this.showTotal||"task"===this.active,this.showTotal||(this.fullLoading=!1)}}},Q=K,W=(0,l.Z)(Q,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"synthesize",class:[t.showTotal?"owner":""]},[t.fullLoading?s("van-loading",{staticClass:"loading-center"}):t._e(),t.showTotal?s("div",[t.total>0?s("div",{staticClass:"total"},[t._v(" "+t._s(t.$t("search.allFind"))+" "),s("span",{staticClass:"num"},[t._v(t._s(t.total))]),t._v(" "+t._s(t.$t("search.resultNumber")))]):t._e(),t.showEmpty?s("div",{staticClass:"module-empty"},[s("van-empty",{attrs:{description:t.$t("common.noDataTextTip")}})],1):t._e()]):t._e(),s("div",{staticClass:"synthesize-content"},[t.showCourse?s("course",{ref:"courseRef",attrs:{"show-total":t.showTotal},on:{clear:t.onClear,changeCount:function(e){return t.changeCount("course",e)}}}):t._e(),t.showLecturer?s("lecturer",{ref:"lecturerRef",attrs:{"show-total":t.showTotal},on:{changeCount:function(e){return t.changeCount("lecturer",e)}}}):t._e(),t.showTask?s("task",{key:t.showTotal,ref:"taskRef",attrs:{"show-total":t.showTotal},on:{changeCount:function(e){return t.changeCount("task",e)}}}):t._e()],1)],1)}),[],!1,null,"0713a9ba",null).exports,Y={name:"HomeSearchList",components:{SearchBox:i.Z,SearchTab:c,SearchList:W,[a.Z.name]:a.Z},data:()=>({}),computed:{keyword(){return this.$store.state.search.keyword}},watch:{keyword(t){t||this.onClear()}},methods:{onTabChange(t){this.$store.commit("search/setActive",t)},onSearch(t,e){"click"===e?this.onClear():(this.$store.commit("search/setKeyword",t),this.onSubmit(t))},onSubmit(t){""!==t.trim()?this.$refs.listRef&&this.$refs.listRef.init():this.$toast(this.$t("search.searchTip"))},onClear(){this.$router.replace("/home-module/home-search"),this.$store.commit("search/setKeyword",""),this.$store.commit("search/setActive","synthesize")},onClearTab(){this.$store.commit("search/setActive","synthesize")}}},J=(0,l.Z)(Y,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"home-search"},[s("van-sticky",[s("search-box",{attrs:{placeholder:t.$t("common.search"),"show-action":!0,"action-text":t.$t("common.cancel"),data:t.keyword,"max-length":50},on:{search:t.onSearch,clear:t.onClear}}),s("search-tab",{on:{change:t.onTabChange}})],1),s("search-list",{ref:"listRef",on:{clear:t.onClearTab}})],1)}),[],!1,null,"b67a2412",null).exports},15420:(t,e,s)=>{s.r(e),s.d(e,{default:()=>$});var a=s(95082),i=(s(82500),s(49414)),n=(s(82522),s(10342)),o=(s(20581),s(50914)),r=(s(33948),s(27479)),l=s(96680),c=s(26294),d=(s(47238),s(75167)),m=(s(69710),s(57609)),h=(s(52355),s(29233)),u=(s(47601),s(44951)),p=(s(57658),s(22648)),g=s(78368),f=s(95969),v=s(45877),_=s(67875),y={name:"FeedItem",components:{VanImage:u.Z,Cell:h.Z,Divider:m.Z,Progress:d.Z,ClCustomUser:v.Z,ClCustomDepartment:_.Z},props:{data:{type:Object,default:()=>({})},status:{type:String,default:""}},data(){return{taskType:{exam:{title:this.$t("study.exam")},neo:{title:this.$t("study.newEmployee")},online:{title:this.$t("study.online")},offline:{title:this.$t("study.offline")},mix:{title:this.$t("study.hybrid")},course:{title:this.$t("study.course")}},defaultAvatar:g}},computed:{themeColor(){return this.$store.state.themeColor},formattedEndTime(){return(0,p.p6)(this.data.end_time,"yyyy-MM-dd hh:mm")},formattedBeginTime(){return(0,p.p6)(this.data.begin_time,"yyyy-MM-dd hh:mm")},formattedFinishedTime(){return"finished"===this.status?(0,p.p6)(this.data.task_end_time,"yyyy-MM-dd hh:mm"):""},typeTitle(){return this.taskType[this.data.type].title}},created(){},mounted(){},methods:{renderDate(){const t=(new Date).getTime();let e=`${this.$t("common.deadline")}:${this.formattedEndTime}`;return t<this.data.begin_time&&"unfinished"===this.status?`${this.$t("home.startTime")}: ${this.formattedBeginTime}`:"finished"===this.status?`${this.$t("study.finishTime")}: ${this.formattedFinishedTime}`:e},cardClick(){if((new Date).getTime()<this.data.begin_time)return void this.$toast(this.$t("home.taskNotStarted"));let t=f.Z.home.studyDetail({studyId:this.data.id,studyStatus:this.status,origin:"vue"});this.$router.push({path:t})}}},C=s(1001),k=(0,C.Z)(y,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"study-card",on:{click:t.cardClick}},[s("Cell",{staticClass:"type",attrs:{center:"",border:!1},scopedSlots:t._u([{key:"title",fn:function(){return[s("i",{class:t.data.type}),s("span",{staticClass:"van-ellipsis"},[t._v(t._s(t.typeTitle))])]},proxy:!0}])}),s("Cell",{attrs:{"value-class":"van-ellipsis title",border:!1,value:t.data.title}}),s("Cell",{attrs:{"value-class":"van-ellipsis date",border:!1},scopedSlots:t._u([{key:"title",fn:function(){return["true"===t.data.show_score?s("span",{staticClass:"credit"},[t._v(" "+t._s(t.data.award_score)+" "+t._s(t.$t("pointsMall.credits")))]):t._e(),s("span",{staticClass:"date"},[t._v(t._s(t.renderDate()))])]},proxy:!0}])}),s("Divider",{staticStyle:{margin:"5px 0 10px","border-color":"#dbdcde"}}),s("div",{staticClass:"bottom-info"},[s("div",{staticClass:"user"},[s("VanImage",{attrs:{round:"",src:t.data.create_user_avatar||t.defaultAvatar}}),s("span",{staticClass:"name van-ellipsis"},[s("ClCustomUser",{attrs:{type:t.data.creator_source_type,"data-type":"userName",value:t.data.creator_sync_user_id,name:t.data.create_user_name||t.$t("common.no")}})],1),t._v(" ("),s("span",{staticClass:"dept van-ellipsis"},[t.data.user_info&&Array.isArray(t.data.user_info.department_infos)&&t.data.user_info.department_infos.length>0?s("ClCustomDepartment",{attrs:{"display-all":!0,list:t.data.user_info.department_infos}}):t._e()],1),t._v(") "+t._s(t.$t("common.assign"))+" ")],1),"unfinished"===t.status?s("div",{staticClass:"progress"},[s("Progress",{attrs:{percentage:t.data.progress,color:t.themeColor.primaryColor,"show-pivot":!1}}),s("span",{style:{color:t.themeColor.primaryColor}},[t._v(t._s(t.data.progress)+"%")])],1):t._e()])],1)}),[],!1,null,"c7061566",null).exports,b={name:"StudyList",components:{List:o.Z,Tab:n.Z,Tabs:i.Z,EmptyBox:r.Z,StudyCard:k},beforeRouteLeave(t,e,s){"/home-module"===t.path&&this.$store.commit("study/updateStudyStatus","unfinished"),s()},data:function(){return{tabs:[{id:"unfinished",name:"unfinished"},{id:"finished",name:"finished"},{id:"overdue",name:"overdue"}],loading:!0,finished:!1,list:[],params:{page_size:10,page_number:1,status:"unfinished"}}},computed:(0,a.Z)({themeColor(){return this.$store.state.themeColor}},(0,c.mapState)("study",["studyStatus"])),mounted(){this.getStudyList()},methods:{async getStudyList(){const{getStudyList:t}=l.Z;this.params.status=this.studyStatus;const[e,s]=await t(this.params);!e&&s.data.list&&(this.list=[...this.list,...s.data.list],this.loading=!1,this.finished="false"===s.data.has_next_page)},onLoad(){this.params.page_number+=1,this.getStudyList()},onTabChange(t){this.list=[],this.loading=!0,this.finished=!1,this.params.page_number=1,this.params.status=t,this.$store.commit("study/updateStudyStatus",t),this.getStudyList()}}},$=(0,C.Z)(b,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"study-list"},[s("Tabs",{attrs:{"line-width":24,color:"white",sticky:""},on:{change:t.onTabChange},model:{value:t.studyStatus,callback:function(e){t.studyStatus=e},expression:"studyStatus"}},t._l(t.tabs,(function(e){return s("Tab",{key:e.name,attrs:{title:t.$t("common."+e.name),name:e.id}})})),1),t.loading||0!==t.list.length?s("div",{staticClass:"study-list-content"},[s("List",{attrs:{finished:t.finished,"immediate-check":!1,"finished-text":t.$t("common.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e){return s("StudyCard",{key:e.id,attrs:{data:e,status:t.studyStatus}})})),1)],1):s("EmptyBox")],1)}),[],!1,null,"7e61c4cc",null).exports},65103:(t,e,s)=>{s.r(e),s.d(e,{default:()=>Q});var a={};s.r(a),s.d(a,{accountInfoConfigured:()=>$,getType:()=>T,updateContext:()=>b});var i={};s.r(i),s.d(i,{goToCommunity:()=>w,handleCourseTap:()=>S});var n=s(95082),o=(s(74916),s(15306),s(27083)),r=s(1313),l=s(27632),c=s(28787),d=s(26294),m=s(67992),h=s(95969),u=s(4374),p=(s(52355),s(29233)),g=(s(57658),s(45877)),f={name:"DetailTop",components:{Cell:p.Z,ClCustomUser:g.Z},props:{studyInfo:{type:Object,default:()=>({})}},data:function(){return{standered:[],tip:""}},computed:{themeColor(){return this.$store.state.themeColor}},watch:{studyInfo(t){this.getLabel(t)}},methods:{getLabel(t){let e=[],s=`${this.$t("common.passingCriteria")}: `;t.study_progress_standard>0&&(s+=`${this.$t("study.studyTip",{progress:t.study_progress_standard})} `),t.exam_times>0&&(s+=`${this.$t("study.examTip",{examCount:t.exam_times})} `,e.push({title:this.$t("common.examPassed"),value:`${t.exam_pass_count}/${t.exam_times+this.$t("common.times")} `})),t.operation_times>0&&(s+=`${this.$t("study.operationTip",{operationCount:t.operation_times})} `,e.push({title:this.$t("attestation.practicalExams"),value:`${t.pass_operation_count}/${t.operation_times+this.$t("common.times")} `})),"true"===t.finish_evaluation&&(s+=`${this.$t("common.completeJobEvaluation")}`,e.push({title:this.$t("common.postEvaluation"),value:`${1===t.status?this.$t("common.finished"):this.$t("common.unfinished")}`})),this.tip=s,this.standered=e}}},v=s(1001),_=(0,v.Z)(f,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"study-detail-top"},[s("div",{staticClass:"top-progress"},[s("span",{staticClass:"study-progress-title"},[t._v(t._s(t.$t("common.taskProgress")))]),s("span",{staticClass:"study-progress-info"},[t._v(t._s(t.studyInfo.progress)+"%")])]),s("div",{staticClass:"top-other-info"},[s("Cell",{attrs:{center:"",title:t.$t("common.assignor"),value:""},scopedSlots:t._u([{key:"label",fn:function(){return[s("ClCustomUser",{attrs:{type:t.studyInfo.assignor_sync_source_type,"data-type":"userName",value:t.studyInfo.assignor_sync_user_id,name:t.studyInfo.assignor_name||""}})]},proxy:!0}])}),s("Cell",{attrs:{center:"",title:t.$t("common.learningProgress"),value:"",label:(void 0!==t.studyInfo.study_progress?t.studyInfo.study_progress:"")+"%"}}),t._l(t.standered,(function(t){return s("Cell",{key:t.title,attrs:{center:"",value:"",title:t.title,label:t.value}})}))],2),t.studyInfo.type&&"course"!==t.studyInfo.type?s("div",{staticClass:"top-info-tip"},[t._v(t._s(t.tip))]):t._e()])}),[],!1,null,"55ccc198",null).exports,y=s(22648),C=s(96680),k=s(57969);const b=t=>{let e="";return"h5"===l.Z.env&&((navigator.userAgent.toLowerCase().indexOf("dingtalk")>-1||navigator.userAgent.toLowerCase().indexOf("micromessenger")>-1)&&(t||window.location.replace(`${window.location.href}&eid=${t}`)),navigator.userAgent.toLowerCase().indexOf("micromessenger")>-1&&(e="officialAccounts",wx.miniProgram&&wx.miniProgram.getEnv((t=>{e=t.miniprogram?"miniProgram":"officialAccounts"})))),e},$=async()=>{const{data:{data:t}}=await C.Z.getAccountInfo();let e="all";return"false"===t.wxpay&&"false"===t.alipay&&(e="noBind"),"false"===t.wxpay&&"true"===t.alipay&&(e="ali"),"true"===t.wxpay&&"false"===t.alipay&&(e="wx"),e},T=t=>{let e="";switch(t){case"exam":e=k.Z.t("study.exam");break;case"neo":e=k.Z.t("study.newEmployee");break;case"online":e=k.Z.t("study.online");break;case"offline":e=k.Z.t("study.offline");break;case"mix":e=k.Z.t("study.hybrid");break;case"course":e=k.Z.t("study.course")}return e};s(34837);var x=s(39146),Z=s(68915);const w=async()=>{const{title:t,isPreview:e}=c.Z.state.study.studyInfo;if(e)return;const s=encodeURI(t),a={tagName:s},{data:i}=await C.Z.searchTargetExist(a);if(0===i.code){const t=h.Z.resource.enterCommunityDetail({newTitle:s});if(i.data){const{data:e}=await C.Z.getTopicStatus(a);0===e.code&&e.data?(0,x.Z)(k.Z.t("study.topicIsDisabled")):h.Z.navigateTo(t)}else{const{data:e}=await C.Z.setTopicData({tags:[s],type:"question"});0===e.code&&0===e.data&&h.Z.navigateTo(t)}}},S=t=>{const{studyInfo:e,studyId:s,student_id:a,unpaidCharge:i,studyStatus:o,isPreview:r,hasSetFace:d}=c.Z.state.study;if(r)return;const{type:m,status:h,progress:u,canStudy:p,unlocking_time:g,replenish_exam:f,exam_plan_detail_v2:v}=t;if(i)return void(0,x.Z)(k.Z.t("study.pay"));if(a)return;if(!p&&"true"!==f)return void(0,x.Z)(g?k.Z.t("study.notUnlockedTime"):k.Z.t("promptMessage.unlockPreviousTask"));let _=!("operation"===m&&"0"!==h&&"2"!==h);if(("overdue"===o||e&&e.end_time&&(new Date).getTime()>e.end_time)&&"exam"!==m&&"true"!==f&&"newExam"!==m&&((t,e)=>{const{progress:s}=t,{type:a}=e;let i=!0;return 100===s&&-1!==["xlsx","pdf","doc","pptx","txt","article","png","mp4","mp3","image","scorm","html","link","liveClass","course","imageText","evaluation","docx","micro_course","xls","jpeg","jpg","h5","ppt","ddi"].indexOf(a)&&(i=!1),i})(e,t)&&"latoja"!==m&&_)return void(0,x.Z)(k.Z.t("promptMessage.overdueTask"));if("transcoding"===h)return void(0,x.Z)(k.Z.t("attestation.transcoding"));if("investigate"===m&&100===u)return void(0,x.Z)(k.Z.t("study.notAllowViewTips"));if(8===t.source_type&&"alilpay"===l.Z.env)return void l.Z.previewFileInDingTalk({spaceId:t.path,fileId:t.url,fileName:t.title,fileSize:t.size,fileType:t.type});let y="absence"===h||"unfinished"===h;if("newExam"===m&&(new Date).getTime()>Number(v.examEndTime)&&y)return void(0,x.Z)(k.Z.t("promptMessage.overdueTask"));let C=y||"inProgress"===h;(!v||t.show_result||t.show_repeat_exam||C)&&Z.Z.init((0,n.Z)((0,n.Z)({},e),{},{hasSetFace:d}),t,s)};var L=s(50630);const I=a,R=i,P=L;var D={name:"DetailTitle",components:{},filters:{formatDate:t=>(0,y.p6)(t,"yyyy.MM.dd hh:mm")},props:{studyInfo:{type:Object,default:()=>({})}},computed:{themeColor(){return this.$store.state.themeColor}},methods:{getType:t=>I.getType(t),goToCommunity(){R.goToCommunity()}}},E=(0,v.Z)(D,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"detail-title-section"},[s("div",{staticClass:"title"},[t._v(t._s(t.studyInfo.title))]),s("div",{staticClass:"other-info"},[s("div",{staticClass:"study-time"},["true"===t.studyInfo.show_score?s("span",{staticClass:"score"},[t._v(" "+t._s(t.studyInfo.award_score+t.$t("pointsMall.credits"))+" ")]):t._e(),t._v(" "+t._s(t._f("formatDate")(t.studyInfo.begin_time))+" ~ "+t._s(t._f("formatDate")(t.studyInfo.end_time))+" ")]),s("div",{class:["study-type",""+t.studyInfo.type]},[t._v(t._s(t.getType(t.studyInfo.type)))])]),t.studyInfo.summary?s("div",{staticClass:"summary"},[t._v(" "+t._s(t.$t("study.missionStatement"))+": "+t._s(t.studyInfo.summary)+" ")]):t._e()])}),[],!1,null,"34efa00e",null).exports,M=(s(31960),s(10993)),N=(s(69710),s(57609)),G=(s(47601),s(44951)),A=s(73641),F={name:"StudyList",components:{VanImage:G.Z,Stages:A.Z,Divider:N.Z},props:{studyInfo:{type:Object,default:()=>({})},itemClick:{type:Function,default:()=>{}},isPreview:{type:Boolean,default:!1}},data:function(){return{showStageTag:!1,showExamResult:!0}},computed:{themeColor(){return this.$store.state.themeColor}},methods:{getTag(t){return t.course_list.find((t=>"false"===t.can_start_study))?t.course_list.find((t=>t.unlocking_time))?this.$t("study.unlockMode"):this.$t("study.recruitModel"):""},onPreviewExchangeGroup(){"dingTalk"!==l.Z.env?(0,M.Z)({images:[this.studyInfo.ding_img_url],showIndex:!1}):l.Z.previewImage({urls:[this.studyInfo.ding_img_url]})},detailClick(t){R.handleCourseTap(t)},refreshData(){this.$emit("onRefresh")}}},z=(0,v.Z)(F,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"stage-container"},[s("div",{staticClass:"stage"},[s("Stages",{attrs:{"data-info":t.studyInfo,"is-preview":t.isPreview},on:{onRefresh:t.refreshData,resourceOnTap:t.detailClick}})],1),t.studyInfo.ding_img_url?s("div",{staticClass:"exchange-group"},[s("VanImage",{staticClass:"exchange-group-qrcode",attrs:{src:t.studyInfo.ding_img_url,fit:"fill"},on:{click:t.onPreviewExchangeGroup}}),s("div",{staticClass:"exchange-group-tip"},[t._v(t._s(t.$t("study.joinTaskGroup")))])],1):t._e(),s("div",{staticClass:"end"},[s("Divider",[t._v("END")])],1)])}),[],!1,null,"1940325e",null).exports,O=(s(31146),s(41610)),B=(s(25773),s(35791)),j=s(46730),q={name:"StudyList",components:{Button:B.Z,PayModal:j.Z},props:{studyInfo:{type:Object,default:()=>({})},disabledTip:{type:String,default:""},accountConfigured:{type:Object,default:()=>({})},wxContext:{type:String,default:""}},data:function(){return{showPayModal:!1,showPayType:"all",whiteList:{teamBuy:(0,y.UI)("STUDY_PROJECT_TEEM_BUY")}}},computed:{themeColor(){return this.$store.state.themeColor.primaryColor},projectInfo(){return{project_id:this.studyInfo.id,preferential_price_str:this.official_price}}},mounted(){},methods:{closeModal(){this.showPayModal=!1},onPay(){if(this.disabledTip)return void this.$toast(this.disabledTip);if("miniProgram"===this.wxContext)return void this.$dialog.alert({title:this.$t("mine.loginOutTips"),message:this.$t("payment.goPcPay")});let t="all";"noBind"!==this.accountConfigured?("ali"===this.accountConfigured||l.Z.specialEnv.indexOf("dingTalk")>-1?t="ali":("wx"===this.accountConfigured||l.Z.specialEnv.indexOf("wechat")>-1)&&(t="wx"),this.showPayModal=!0,this.showPayType=t):this.$toast(this.$t("payment.notAccount"))},catchError({errorInfo:t,cb:e}){if(t.code){let s="";if(t[t.code])if("en"===this.$i18n.locale){let{message:e}=t[t.code];s=e}else{let{content:e}=t[t.code];s=e}else s=this.$t("promptMessage.systemError");O.Z.alert({title:this.$t("promptMessage.warmTips"),message:s}).then((()=>{e&&e()}))}}}},H=(0,v.Z)(q,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"pay-button-container"},[s("Button",{staticClass:"pay-button",class:t.disabledTip?"disabled-button":"",attrs:{block:""},on:{click:t.onPay}},[t._v(t._s(t.$t("project.register"))+" (￥"+t._s(t.studyInfo.official_price)+") ")])],1),s("PayModal",{attrs:{"show-pay-modal":t.showPayModal,"show-pay-type":t.showPayType,"goods-type":"STUDY_TASK","data-info":t.studyInfo,"wx-context":t.wxContext},on:{closeModal:t.closeModal,catchError:t.catchError}})],1)}),[],!1,null,"896942e2",null).exports;const U=["/course-player","/pages/doc-reader/index","/offline-course-detail","/micro-watch","/course-reader","/study-resource/research/detail","/pages/sub-modules/certification/practice/index","/pages/sub-modules/certification/practice-result/index","/pages/campModules/evaluation-mobile-web/index","/pages/exam-bag/instructor-area/student-edit/index","/pages/exam-bag/instructor-area/student-result/index","/pages/exam-bag/exam/exam-details/index","/pages/exam-bag/exam/exam-result/index","/face","/evaluation-tool","/course-task-detail","/study-resource/operation/view","/study-resource/operation/detail","/study-resource/operation/result","/image-text-detail"];var V=s(77522),K={name:"StudyDetail",components:{DetailTop:_,DetailTitle:E,DetailList:z,PayButton:H,TutorBomb:o.Z,ClResult:V.Z},beforeRouteEnter(t,e,s){-1===U.findIndex((t=>e.path.indexOf(t)>-1))&&c.Z.commit("face/updateUrl",{faceStatus:"idle"}),-1!==U.findIndex((t=>e.path.indexOf(t)>-1))&&s((t=>{t.openFaceVarify=!1})),s((t=>{t.$store.commit("study/clearState",{}),t.initData(),t.loadData()}))},beforeRouteLeave(t,e,s){-1===U.findIndex((e=>t.path.indexOf(e)>-1))&&this.$store.commit("face/updateUrl",{faceStatus:"idle"}),s()},data:function(){return{unpaidCharge:!1,accountConfigured:"",wxContext:"",isOpenCommunity:!1,onTutorCancel:P.onTutorCancel,onTutorConfirm:()=>{P.onTutorConfirm(this.loadData)},handleSingleChange:P.handleSingleChange,openFaceVarify:!0,isShowResult:!1,resultParams:{}}},computed:(0,n.Z)((0,n.Z)((0,n.Z)((0,n.Z)((0,n.Z)({},(0,d.mapGetters)({primaryColor:"getPrimaryColor",selectPortal:"setting/getSelectPortal",customHomeComponent:"setting/getCustomHomeComponent",homeSetting:"setting/getHomeSetting"})),(0,d.mapState)("setting",["showRandomWindow","dragSwitch","preventHangSwitch"])),(0,d.mapState)("study",["studyId","studyStatus","student_id","isPreview","isShowPreventHangModal","tutorsList","hasSetFace","showtutorsModal","checkedId","tutorials_model","studyInfo"])),(0,d.mapState)("face",["faceStatus"])),(0,d.mapGetters)({fresh:"microCourse/getFreshStatus"})),watch:{fresh(t){t&&(this.$store.commit("study/clearState",{}),this.openFaceVarify=!1,this.initData(),this.loadData(),this.$store.commit("microCourse/updateFresh",!1))}},beforeDestroy(){this.$toast.clear(),this.$dialog.close()},mounted(){const{isGo:t}=this.$route.query;"1"===t&&history.go(-3)},methods:{initData(){const{query:t}=this.$route;t.origin&&"vue"===t.origin?this.$store.commit("face/updateUrl",{fromSource:"vue"}):this.$store.commit("face/updateUrl",{fromSource:"taro"}),this.$store.commit("study/initState",{query:t}),this.wxContext=I.updateContext(this.$router.params),this.accountConfigured=I.accountInfoConfigured(),this.student_id||this.isPreview||this.queryFace()},async queryFace(){const t=await r.Z.queryFace();this.$store.commit("study/setHasSetFace","true"===t.data.result)},enterFaceTIp(){(0,m.YQ)({messageCancel:()=>{this.$router.replace({path:h.Z.home.studyList()})},successPath:"",tip1:this.$t("faceKnow.taskFaceKnowTip"),tip2:this.$t("faceKnow.taskFaceKnowTip2"),hasSetFace:this.hasSetFace})},loadData(){this.$dialog.close(),"checking"!==this.faceStatus&&this.$toast.loading({duration:0,message:this.$t("common.loading"),loadingType:"spinner",forbidClick:!0,overlay:!0}),this.$store.dispatch("study/getStudyInfo",{success:({data:t,unpaidCharge:e})=>{this.unpaidCharge=e,t.studyInfo.integral_info&&setTimeout((()=>{this.$toast.success({message:t.studyInfo.integral_info,duration:3e3})}),500),"checking"!==this.faceStatus&&(this.$toast.clear(),(this.openFaceVarify||"idle"===this.faceStatus)&&(t.isFaceRecognition?this.isShowPreventHangModal?(0,m.ZZ)().then((()=>{this.enterFaceTIp()})):this.enterFaceTIp():this.openFaceVarify&&(0,m.ZZ)()))},failCb:t=>{const{code:e}=t.data;if(this.$toast.clear(),u.Z[e])return this.isShowResult=!0,void(this.resultParams={type:"error",title:this.$t("study.cannotViewTask"),description:this.$t("study.cannotViewTaskTip")});this.$dialog.alert({title:this.$t("common.reminder"),message:this.$t("promptMessage.systemError"),confirmButtonText:this.$t("common.back"),confirmButtonColor:this.primaryColor}).then((()=>{const{fromSource:t}=this.$store.state.face;"taro"!==t?this.$router.go(-1):l.Z.navigateBack()}))}})}}},Q=(0,v.Z)(K,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.isShowResult?s("cl-result",{attrs:{title:t.resultParams.title,description:t.resultParams.description,buttons:t.resultParams.buttons}}):s("div",{staticClass:"study-detail"},[s("DetailTop",{attrs:{"study-info":t.studyInfo}}),s("DetailTitle",{attrs:{"study-info":t.studyInfo}}),"true"===t.studyInfo.sync_progress?s("div",{staticClass:"sync-tip"},[t._v(t._s(t.$t("common.openSync")))]):t._e(),s("DetailList",{attrs:{"study-info":t.studyInfo,"is-preview":t.isPreview}}),t.unpaidCharge&&!t.isPreview?s("PayButton",{attrs:{"study-info":t.studyInfo,"wx-context":t.wxContext,"disabled-tip":"overdue"===t.studyStatus?""+t.$t("study.taskDue"):"","account-configured":t.accountConfigured},on:{refreshData:t.loadData}}):t._e(),t.showtutorsModal?s("TutorBomb",{attrs:{"tutors-list":t.tutorsList,"checked-id":t.checkedId,"tutorials-model":t.tutorials_model},on:{cancel:t.onTutorCancel,confirm:t.onTutorConfirm,change:t.handleSingleChange}}):t._e()],1)}),[],!1,null,"d6df5b3c",null).exports},53395:(t,e,s)=>{s.r(e),s.d(e,{default:()=>z});s(82500);var a=s(49414),i=(s(82522),s(10342)),n=(s(38862),s(74916),s(15306),s(95082)),o=(s(20581),s(50914)),r=(s(33948),s(27479)),l=s(18715),c=(s(47238),s(75167)),d=(s(69710),s(57609)),m=(s(52355),s(29233)),h=(s(47601),s(44951)),u=(s(57658),s(22648)),p=s(78368),g=s(95969),f=s(67875),v=s(25295),_={name:"FeedItem",components:{VanImage:h.Z,Cell:m.Z,Divider:d.Z,Progress:c.Z,ClCustomDepartment:f.Z},props:{data:{type:Object,default:()=>({})},projectActive:{type:String,default:""}},data:()=>({defaultAvatar:p}),computed:{themeColor(){return this.$store.state.themeColor},formattedEndTime(){return(0,u.p6)(this.data.task_end_time,"yyyy-MM-dd hh:mm")},formattedCompleteTime(){return(0,u.p6)(this.data.finish_time,"yyyy-MM-dd hh:mm")}},created(){},mounted(){},methods:{cardClick(){v.Z.addScanCount({id:this.data.id}),this.$router.push({path:g.Z.studyProject.toStudyProject({studyProjectId:this.data.id})})}}},y=s(1001),C=(0,y.Z)(_,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"project-card",on:{click:t.cardClick}},[s("Cell",{attrs:{"value-class":"van-ellipsis title",border:!1,value:t.data.title}}),s("Cell",{attrs:{"value-class":"van-ellipsis date",border:!1},scopedSlots:t._u([{key:"title",fn:function(){return[s("div",[t.data.credit&&0!==t.data.credit?s("span",{staticClass:"credit"},[t._v(" "+t._s(t.data.credit)+t._s(t.$t("pointsMall.credits")))]):t._e(),"finished"!==t.projectActive?s("span",{staticClass:"date"},[t._v(" "+t._s(t.$t("task.endTime"))+": "+t._s(t.formattedEndTime)+" ")]):s("span",{staticClass:"date"},[t._v(" "+t._s(t.$t("study.finishTime"))+": "+t._s(t.formattedCompleteTime)+" ")])])]},proxy:!0}])}),s("Divider",{staticStyle:{margin:"5px 0 10px","border-color":"#dbdcde"}}),s("div",{staticClass:"bottom-info"},[s("div",{staticClass:"user"},[s("VanImage",{attrs:{round:"",src:t.data.create_user_info.avatar||t.defaultAvatar}}),s("span",{staticClass:"name van-ellipsis"},[t._v(" "+t._s(t.data.create_user_name)+" ")]),t._v(" ("),s("span",{staticClass:"dept van-ellipsis"},[t.data.create_user_info&&Array.isArray(t.data.create_user_info.department_infos)&&t.data.create_user_info.department_infos.length>0?s("ClCustomDepartment",{attrs:{"display-all":!0,list:t.data.create_user_info.department_infos}}):t._e()],1),t._v(") "+t._s(t.$t("myTask.create"))+" ")],1),"unfinished"===t.projectActive?s("div",{staticClass:"progress"},[s("Progress",{attrs:{percentage:t.data.progress,color:t.themeColor.primaryColor,"show-pivot":!1}}),s("span",{staticClass:"process-num",style:{color:t.themeColor.primaryColor}},[t._v(t._s(t.data.progress)+"%")])],1):t._e()])],1)}),[],!1,null,"73772a19",null).exports,k={name:"ProjectList",components:{List:o.Z,Tab:i.Z,Tabs:a.Z,EmptyBox:r.Z,ProjectCard:C},data:function(){return{tabs:[{id:"unfinished",name:"unfinished"},{id:"finished",name:"finished"},{id:"overdue",name:"overdue"}],loading:!0,finished:!1,list:[],params:{page_size:10,page_number:1,study_type:"task",status:"unfinished"},projectActive:"unfinished"}},computed:{themeColor(){return this.$store.state.themeColor}},mounted(){const t=this.$route.query;this.projectActive=t.status||"unfinished",this.getProjectList()},methods:{async getProjectList(){const{getTrainingProgram:t}=l.Z;"overdue"===this.projectActive?(this.params.status="all",this.params.overdue_status="overdue"):this.params.status=this.projectActive,"unfinished"===this.projectActive&&(this.params.overdue_status="unOverdue");const{status:e,data:s}=await t((0,n.Z)({},this.params));if(200===e){const{list:t,has_next_page:e}=s.data;this.list=[...this.list,...t],this.loading=!1,this.finished="false"===e}},onLoad(){this.params.page_number+=1,this.getProjectList()},onTabChange(t){this.list=[],this.loading=!0,this.finished=!1,this.params.page_number=1,this.projectActive=t,"finished"===t&&delete this.params.overdue_status,this.onChangeQuery(t),this.getProjectList()},onChangeQuery(t){let{query:e}=this.$router.history.current,{path:s}=this.$router.history.current,a=JSON.parse(JSON.stringify(e));a.status=t,delete a.status,this.$router.replace({path:s,query:a})}}},b=k,$=(0,y.Z)(b,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"project-list-wrapper"},[s("Tabs",{attrs:{"line-width":24,color:"white",sticky:""},on:{change:t.onTabChange},model:{value:t.projectActive,callback:function(e){t.projectActive=e},expression:"projectActive"}},t._l(t.tabs,(function(e){return s("Tab",{key:e.name,attrs:{title:t.$t("common."+e.name),name:e.id}})})),1),t.loading||0!==t.list.length?s("div",{staticClass:"project-list-content"},[s("List",{attrs:{finished:t.finished,"immediate-check":!1,"finished-text":t.$t("common.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e){return s("ProjectCard",{key:e.id,attrs:{data:e,"project-active":t.projectActive}})})),1)],1):s("EmptyBox")],1)}),[],!1,null,"08dfccaa",null).exports,T=s(68092),x=s(65317),Z=s(46933),w=s(45877),S=s(23493),L=s.n(S),I=s(27632),R={name:"OldExamCard",components:{VanImage:h.Z,Cell:m.Z,Divider:d.Z,ClCustomUser:w.Z,ClCustomDepartment:f.Z},props:{data:{type:Object,default:()=>({})},examActive:{type:String,default:""}},data:()=>({defaultAvatar:p}),computed:{themeColor(){return this.$store.state.themeColor},formattedBeginTime(){return"unfinished"===this.data.status?(0,u.p6)(this.data.begin_time,"yyyy-MM-dd hh:mm"):""}},created(){},mounted(){},methods:{cardClick:L()((function(){this.handleExamDetail()}),1e3),async handleExamDetail(){const{checkOldExamStatus:t}=Z.Z,{status:e,data:s}=await t(this.data.id);if(200===e){let t="";t="false"===s.has_submited&&"true"===s.can_exam||"false"===s.has_submited&&"exam_not_start"===s.status?g.Z.message.examDetail({examId:this.data.id,originType:this.examActive,examType:this.data.type}):g.Z.message.examResult({examId:this.data.id,originType:this.examActive,examType:this.data.type,routeStack:1}),t&&I.Z.navigateTo({url:t})}}}},P=(0,y.Z)(R,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"old-exam-card",on:{click:t.cardClick}},[s("Cell",{attrs:{"value-class":"van-ellipsis title",border:!1,value:t.data.title}}),s("Cell",{attrs:{"value-class":"van-ellipsis date",border:!1},scopedSlots:t._u([{key:"title",fn:function(){return["unfinished"===t.data.status?s("div",["true"===t.data.show_score?s("span",{staticClass:"credit"},[t._v(" "+t._s(t.data.award_score)+t._s(t.$t("pointsMall.credits")))]):t._e(),s("span",{staticClass:"date"},[t._v(t._s(t.$t("home.startTime"))+": "+t._s(t.formattedBeginTime))])]):t._e(),!t.data.show_result||"passed"!==t.data.status&&"perfect"!==t.data.status&&"failed"!==t.data.status?t._e():s("div",[s("span",{staticClass:"no-score"},[t._v(" "+t._s(t.$t("search.points"))+": "+t._s(t.data.show_result?t.data.score:"--")+" ")])]),"scoring"===t.data.status||"absence"===t.data.status?s("div",[s("span",{staticClass:"no-score"},[t._v(" "+t._s(t.$t("search.noScore"))+" ")])]):t._e()]},proxy:!0}])}),s("Divider",{staticStyle:{margin:"5px 0 10px","border-color":"#dbdcde"}}),s("div",{staticClass:"bottom-info"},[s("div",{staticClass:"user"},[s("VanImage",{attrs:{round:"",src:t.data.avatar||t.defaultAvatar}}),s("span",{staticClass:"name van-ellipsis"},[s("ClCustomUser",{attrs:{type:t.data.creator_source_type,"data-type":"userName",value:t.data.creator_sync_user_id,name:t.data.create_user_name||t.$t("common.no")}})],1),t._v(" ("),s("span",{staticClass:"dept van-ellipsis"},[t.data.user_info&&Array.isArray(t.data.user_info.department_infos)&&t.data.user_info.department_infos.length>0?s("ClCustomDepartment",{attrs:{"display-all":!0,list:t.data.user_info.department_infos}}):t._e()],1),t._v(") "+t._s(t.$t("common.assign"))+" ")],1),s("div",{staticClass:"operate-btn"},["true"===t.data.repeat_exam?s("span",{staticStyle:{"{color":"themeColor.primaryColor}"}},[t._v(" "+t._s(t.$t("study.retake"))+" ")]):t._e(),"true"===t.data.replenishExam?s("span",{style:{color:t.themeColor.primaryColor}},[t._v(" "+t._s(t.$t("examination.replenishExam"))+" ")]):t._e()])])],1)}),[],!1,null,"8f353efa",null).exports,D={name:"OldExamList",components:{List:o.Z,Tab:i.Z,Tabs:a.Z,EmptyBox:r.Z,ExamCard:P},data:function(){return{tabs:[{id:"unfinished",name:"unfinished"},{id:"passed",name:"passed"},{id:"failed",name:"failed"},{id:"scoring",name:"scoring"},{id:"absence",name:"absence"}],loading:!0,finished:!1,list:[],params:{page_size:10,page_number:1,status:"unfinished"},examActive:"unfinished"}},computed:{themeColor(){return this.$store.state.themeColor}},mounted(){const t=this.$route.query;this.examActive=t.status||"unfinished",this.getExamList()},methods:{async getExamList(){const{getOldExamList:t}=Z.Z;this.params.status=this.examActive;const{status:e,data:s}=await t(this.params);200===e&&(this.list=[...this.list,...s.list],this.loading=!1,this.finished="false"===s.has_next_page)},onLoad(){this.params.page_number+=1,this.getExamList()},onTabChange(t){this.list=[],this.loading=!0,this.finished=!1,this.params.page_number=1,this.params.status=t,this.examActive=t,this.onChangeQuery(t),this.getExamList()},onChangeQuery(t){let{query:e}=this.$router.history.current,{path:s}=this.$router.history.current,a=JSON.parse(JSON.stringify(e));a.status=t,this.$router.replace({path:s,query:a})}}},E=(0,y.Z)(D,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"old-exam-list-wrapper"},[s("Tabs",{attrs:{"line-width":24,color:"white",sticky:""},on:{change:t.onTabChange},model:{value:t.examActive,callback:function(e){t.examActive=e},expression:"examActive"}},t._l(t.tabs,(function(e){return s("Tab",{key:e.name,attrs:{title:t.$t("oldExam."+e.name),name:e.id}})})),1),t.loading||0!==t.list.length?s("div",{staticClass:"exam-list-content"},[s("List",{attrs:{finished:t.finished,"immediate-check":!1,"finished-text":t.$t("common.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e){return s("ExamCard",{key:e.id,attrs:{data:e,"exam-active":t.examActive}})})),1)],1):s("EmptyBox")],1)}),[],!1,null,"3ec258d2",null).exports,M={name:"ExamMiddle",components:{Tab:i.Z,Tabs:a.Z,ExamList:x.default,OldExamList:E},data:function(){return{currentComponent:"",newExamEnterprise:!1}},mounted(){this.judgeExamEnterprise()},methods:{async judgeExamEnterprise(){const t=await(0,T.dP)(0);this.currentComponent="new"===t?x.default:E}}},N=(0,y.Z)(M,(function(){var t=this,e=t.$createElement;return(t._self._c||e)(t.currentComponent,{key:(new Date).getTime(),tag:"component"})}),[],!1,null,null,null).exports,G=s(15420),A=s(76119),F={name:"MyTaskList",components:{Tab:i.Z,Tabs:a.Z,projectList:$,examMiddle:N,studyList:G.default,researchList:A.default},data:function(){return{tabs:[{id:"projectList",name:"projectList"},{id:"examMiddle",name:"examMiddle"},{id:"studyList",name:"studyList"},{id:"researchList",name:"researchList"}],active:"projectList",typeMap:{0:"examMiddle",1:"studyList",2:"researchList"}}},computed:{themeColor(){return this.$store.state.themeColor}},mounted(){const t=this.$route.query;this.typeMap[t.active]?this.active=this.typeMap[t.active]:this.active=t.active||"projectList"},methods:{onTabChange(t){this.active=t,this.onChangeQuery(t)},onChangeQuery(t){let{query:e}=this.$router.history.current,{path:s}=this.$router.history.current,a=JSON.parse(JSON.stringify(e));a.active=t,delete a.status,this.$router.replace({path:s,query:a})}}},z=(0,y.Z)(F,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"myTask-list"},[s("Tabs",{attrs:{"line-width":24,color:t.themeColor.primaryColor,sticky:""},on:{change:t.onTabChange},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},t._l(t.tabs,(function(e){return s("Tab",{key:e.name,attrs:{"title-class":t.active===e.name?"myTask-selected-title":"myTask-title",title:t.$t("myTask."+e.name),name:e.id}})})),1),s("div",{staticClass:"list-content"},[s(t.active,{key:(new Date).getTime(),tag:"component"})],1)],1)}),[],!1,null,"75957bb5",null).exports},34699:(t,e,s)=>{s.r(e),s.d(e,{default:()=>x});var a=s(95082),i=(s(86039),s(20495)),n=(s(73474),s(74755)),o=(s(39610),s(2163)),r=(s(20581),s(50914)),l=(s(82500),s(49414)),c=(s(82522),s(10342)),d=(s(57658),s(78551)),m=(s(47601),s(44951)),h=s(65971),u=s(4852),p=s(95969),g=s(22648),f=s(61378),v=s(25295),_={components:{SvgIcon:d.Z,ProgressBar:h.Z,[m.Z.name]:m.Z,avatar:u.Z},props:{item:{type:Object,default:()=>{}},themeColor:{type:String,default:""},type:{type:String,default:"task"}},data:()=>({viewData:[]}),computed:{formatTime:()=>t=>(0,g.p6)(t,"yyyy-MM-dd  hh:mm"),renderStatus(){return t=>{let e={type:"string"};return"overdue"===t?(e.name=this.$t("project.overdue"),e.class="project-overdue"):"unstarted"===t?e.name=this.$t("offline.notStarted"):e.type="progress",e}}},mounted(){const{item:{like_count:t,comment_count:e,scan_count:s}}=this;let a=[{count:s,icon:"icon-xianshimima"},{count:e,icon:"icon-pinglunguanli"},{count:t,icon:"icon-zan2"}];this.viewData=a},methods:{gotoTrainingDetail(t){v.Z.addScanCount({id:t.id}),this.$router.push({path:p.Z.studyProject.toStudyProject({studyProjectId:t.id})})},handleIntroJS(){(0,f.Z)().setOptions({prevLabel:"上一步",nextLabel:"下一步",doneLabel:"知道了",exitOnOverlayClick:!1,disableInteraction:!0,steps:[{title:"新建培训项目",element:document.getElementById("study-project-card"),intro:'<span style="font-size: 3.7vw;">有学习任务时，点击卡⽚可以进⼊任务学习哦～</span>',position:"bottom"}]}).start()}}},y=s(1001),C=(0,y.Z)(_,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card",attrs:{id:"study-project-card"},on:{click:function(e){return t.gotoTrainingDetail(t.item)}}},[s("van-image",{attrs:{width:"100%",height:"94px",fit:"cover",src:t.item.cover}}),s("div",{staticClass:"box"},[s("h2",{staticClass:"van-ellipsis"},["open"===t.item.enrollmentStatus?s("div",{staticClass:"sign-up"},[t._v(t._s(t.$t("approval.registration")))]):t._e(),t._v(t._s(t.item.title))]),"task"===t.type?s("p",[t._v(t._s(t.$t("home.startTime"))+"："+t._s(t.formatTime(t.item.task_begin_time)))]):t._e(),"task"===t.type?s("p",[t._v(t._s(t.$t("task.endTime"))+"："+t._s(t.formatTime(t.item.task_end_time)))]):t._e(),s("div",{staticClass:"appraise-score"},t._l(Object.keys(Array.from({length:5})),(function(e,a){return s("span",{key:a,staticClass:"start-item"},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":"icon-xingxingchengcopy",color:e<(0==t.item.score?5:t.item.score)?"#FFBE51":"#C0C2CB",size:8}})],1)})),0),s("div",{staticClass:"info"},t._l(t.viewData,(function(e,a){return s("div",{key:a.toString(),staticClass:"info-item"},[s("svg-icon",{staticClass:"iconfont",attrs:{"icon-class":e.icon,color:"#B1B5C6",size:10}}),s("span",{staticClass:"info-item-num"},[t._v(t._s(e.count))])],1)})),0)]),s("div",{staticClass:"footer van-hairline--top"},[s("div",{staticClass:"footer-left"},[s("avatar",{attrs:{src:t.item.create_user_info.avatar,width:16,height:16}}),s("span",{staticClass:"footer-left-name van-ellipsis"},[t._v(t._s(t.item.create_user_name))])],1),s("div",{staticClass:"footer-right"},["progress"===t.renderStatus(t.item.status).type?s("span",[s("progress-bar",{attrs:{color:t.themeColor,progress:t.item.progress,"text-color":t.themeColor}})],1):s("span",{class:t.renderStatus(t.item.status).class},[t._v(t._s(t.renderStatus(t.item.status).name))])])])],1)}),[],!1,null,"d4ddf10e",null).exports,k=s(18715),b=s(26294),$={components:{TrainingCard:C,[c.Z.name]:c.Z,[l.Z.name]:l.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[n.Z.name]:n.Z,VanSearch:i.Z,SvgIcon:d.Z},beforeRouteLeave(t,e,s){"/home-module"===t.path&&this.$store.dispatch("studyProject/getProjectStatus",{study_type:"",status:"all",keyword:""}),s()},data(){return{show:!1,page:{page_number:1,page_size:20,keyword:"",study_type:"",status:"all",overdue_status:"",enrollment_status:"",qualified_status:""},dataList:[],loading:!1,finished:!1,isOnLoad:!0,selectData:[],studyTypeData:[{name:this.$t("project.all"),key:"all",checked:!1},{name:this.$t("search.mustStudy"),key:"task",checked:!1},{name:this.$t("project.optionalStudy"),key:"self_study",checked:!1}],selectOverdue:[{name:this.$t("project.all"),key:"all",checked:!1},{name:this.$t("home.overdue"),key:"overdue",checked:!1},{name:this.$t("project.notOverdue"),key:"unOverdue",checked:!1}],qualifiedData:[{name:this.$t("project.all"),key:"all",checked:!1},{name:this.$t("practice.failed"),key:"unqualified",checked:!1},{name:this.$t("practice.pass"),key:"qualified",checked:!1}],registrationData:[{name:this.$t("project.all"),key:"all",checked:!1},{name:this.$t("project.needRegistration"),key:"need",checked:!1},{name:this.$t("project.noRegistration"),key:"unNeed",checked:!1}],selectType:"",random:(new Date).valueOf(),childSelect:[{name:this.$t("project.studyType"),iconName:"icon-sanjiao",type:"study_type",checked:!1,selectTypeIndex:-1,noRotate:!1},{name:this.$t("project.overdueStatus"),iconName:"icon-sanjiao",type:"overdue_status",checked:!1,selectTypeIndex:-1,noRotate:!1},{name:this.$t("project.qualifiedStatus"),iconName:"icon-sanjiao",type:"qualified_status",checked:!1,selectTypeIndex:-1,noRotate:!1},{name:this.$t("project.registrationStatus"),iconName:"icon-sanjiao",type:"enrollment_status",checked:!1,selectTypeIndex:-1,noRotate:!1}],currentTabName:"all"}},computed:(0,a.Z)({renderSelectClass:()=>t=>{let e=["expend-icon"];return t.checked&&e.push("active"),t.noRotate&&e.push("noRotate"),e.join(" ")},renderClass:()=>t=>{let e=["select-item"];return-1!==t.selectTypeIndex?e.push("active"):!0===t.disabled&&e.push("disabled"),e.join(" ")},primaryColor(){return this.$store.state.themeColor.primaryColor},renderStyle(){return t=>({fontSize:8/3.75+"vw",color:t?this.primaryColor:"#DCDEE0"})}},(0,b.mapState)("studyProject",["projectStatus"])),created(){},mounted(){const{study_type:t,status:e,keyword:s}=this.projectStatus,{studyType:a,studyStatus:i}=this.$route.query;let n=a||t,o=i||e;this.page.study_type=n,this.page.status=o,this.page.keyword=s,this.copyChildSelect=this.childSelect.slice()},methods:{checkSelect(t){let e={changeData:[]};switch(this.selectType){case"study_type":e=this.transData("studyTypeData",t);break;case"overdue_status":e=this.transData("selectOverdue",t);break;case"qualified_status":e=this.transData("qualifiedData",t);break;case"enrollment_status":e=this.transData("registrationData",t)}this.selectData=e.changeData,0!==e.chooseData.length&&(this.page[this.selectType]=e.chooseData.key,"overdue_status"===this.selectType&&""!==e.chooseData.key?(this.studyTypeData=this.studyTypeData.map((t=>"task"===t.key?(0,a.Z)((0,a.Z)({},t),{},{checked:!0}):(0,a.Z)((0,a.Z)({},t),{},{checked:!1}))),this.childSelect[0].checked=!0,this.childSelect[0].selectTypeIndex=0,this.page.study_type="task"):"study_type"===this.selectType&&("self_study"!==e.chooseData.key&&"all"!==e.chooseData.key||"finished"===this.page.status||(this.page.overdue_status="",this.childSelect[1].checked=!1,this.childSelect[1].selectTypeIndex=-1,this.selectOverdue=this.selectOverdue.map((t=>(0,a.Z)((0,a.Z)({},t),{},{checked:!1})))),"self_study"===e.chooseData.key&&"finished"!==this.page.status?this.childSelect[1].disabled=!0:this.childSelect[1].disabled=!1),this.page.page_number=1,this.finished=!1,this.isOnLoad=!1,this.random=(new Date).valueOf(),this.getMyEvaluationList()),this.show=!1},hidePopUp(){this.show=!1;let t=[];t="finished"===this.currentTabName?["studyTypeData","qualifiedData"]:["studyTypeData","selectOverdue","qualifiedData","registrationData"];let e=[];t.forEach((t=>{e.push(this[t].findIndex((t=>!0===t.checked)))})),this.childSelect=this.childSelect.map(((t,s)=>(0,a.Z)((0,a.Z)({},t),{},{checked:!(0===e[s]||-1===e[s]),selectTypeIndex:0===e[s]||-1===e[s]?-1:t.selectTypeIndex,noRotate:!0})))},transData(t,e){let s=-1,i={},n=this[t].map(((t,i)=>e===i?(s=e,(0,a.Z)((0,a.Z)({},t),{},{checked:!0})):(0,a.Z)((0,a.Z)({},t),{},{checked:!1})));return-1!==s&&(i.chooseData=n[s]),i.changeData=n,this[t]=n,i},resetCheckData(){["studyTypeData","selectOverdue","qualifiedData","registrationData"].forEach((t=>{this[t]=this[t].map((t=>(0,a.Z)((0,a.Z)({},t),{},{checked:!1})))}))},showSelect(t,e){if("self_study"===this.page.study_type&&"overdue_status"===t&&"finished"!==this.page.status)return void this.$toast(this.$t("project.selectedNoOverdue"));switch(this.childSelect=this.childSelect.map(((t,s)=>(0,a.Z)((0,a.Z)({},t),{},{noRotate:e!==s&&t.noRotate}))),this.selectType=t,t){case"study_type":this.selectData=this.studyTypeData;break;case"overdue_status":this.selectData=this.selectOverdue;break;case"qualified_status":this.selectData=this.qualifiedData;break;case"enrollment_status":this.selectData=this.registrationData}let s=[];s="finished"===this.currentTabName?["studyTypeData","qualifiedData"]:["studyTypeData","selectOverdue","qualifiedData","registrationData"];let i=[];s.forEach((t=>{i.push(this[t].findIndex((t=>!0===t.checked)))})),this.childSelect=this.childSelect.map(((e,s)=>e.type===t?(0,a.Z)((0,a.Z)({},e),{},{checked:!0,selectTypeIndex:s,noRotate:!1}):(0,a.Z)((0,a.Z)({},e),{},{checked:!(0===i[s]||-1===i[s]),selectTypeIndex:0===i[s]||-1===i[s]?-1:e.selectTypeIndex,noRotate:!0}))),this.show=!0},onClear(){this.page.keyword="",this.page.page_number=1,this.getMyEvaluationList()},onSearch(){this.dataList=[],this.page.page_number=1,this.getMyEvaluationList()},changeTab(t){if(t===this.currentTabName)return!1;this.currentTabName=t,this.show=!1,"finished"===t?(this.childSelect.pop(),this.childSelect.splice(1,1)):this.childSelect=this.copyChildSelect.slice(),this.finished=!1,this.isOnLoad=!1,this.random=(new Date).valueOf(),this.page=(0,a.Z)((0,a.Z)({},this.page),{},{page_number:1,status:t,study_type:"",overdue_status:"",enrollment_status:"",qualified_status:""}),this.selectData=[],this.resetCheckData(),this.childSelect=this.childSelect.map((t=>(0,a.Z)((0,a.Z)({},t),{},{checked:!1,selectTypeIndex:-1,noRotate:!1}))),this.getMyEvaluationList()},onLoad(){this.isOnLoad&&this.getMyEvaluationList()},async getMyEvaluationList(){this.loading=!0;const{random:t}=this;1===this.page.page_number&&(this.dataList=[]);try{const e=await k.Z.getTrainingProgram((0,a.Z)({},this.page)),{total:s,list:i,has_next_page:n}=e.data.data;if(this.random!==t)return;this.finished=0===s||"false"===n,this.dataList=0===s?[]:this.dataList.concat(i),this.loading=!1,this.isOnLoad=!0,this.page.page_number+=1,this.$store.dispatch("studyProject/getProjectStatus",{status:this.page.status,keyword:this.page.keyword})}catch(t){this.isOnLoad=!0,this.loading=!1,this.finished=!0}}}},T=$,x=(0,y.Z)(T,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"cl-page-container training-program"},[s("div",[s("div",{staticClass:"select-content"},[s("van-sticky",[s("VanSearch",{attrs:{placeholder:t.$t("project.projectListSearchTip")},on:{search:t.onSearch,clear:t.onClear},model:{value:t.page.keyword,callback:function(e){t.$set(t.page,"keyword",e)},expression:"page.keyword"}}),s("van-tabs",{attrs:{color:t.primaryColor},on:{click:t.changeTab},model:{value:t.page.status,callback:function(e){t.$set(t.page,"status",e)},expression:"page.status"}},[s("van-tab",{attrs:{title:t.$t("project.all"),name:"all"}}),s("van-tab",{attrs:{title:t.$t("study.unfinished"),name:"unfinished"}}),s("van-tab",{attrs:{title:t.$t("study.finished"),name:"finished"}})],1),s("div",{staticClass:"select-type"},t._l(t.childSelect,(function(e,a){return s("div",{key:a,class:t.renderClass(e),on:{click:function(s){return t.showSelect(e.type,a)}}},[s("span",{staticClass:"select-item-name"},[t._v(t._s(e.name))]),s("svg",{class:t.renderSelectClass(e,a),style:t.renderStyle(e.checked),attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#icon-sanjiao"}})])])})),0)],1)],1),s("van-popup",{staticStyle:{height:"'74.1vw'"},attrs:{position:"top"},on:{close:t.hidePopUp},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[s("div",{staticClass:"select-option-content"},t._l(t.selectData,(function(e,a){return s("div",{key:a,class:[e.checked?"select-option-item active":"select-option-item"],on:{click:function(e){return t.checkSelect(a)}}},[s("span",[t._v(t._s(e.name))]),e.checked?s("span",[s("SvgIcon",{attrs:{size:14,color:t.primaryColor,"icon-class":"icon-done1"}})],1):t._e()])})),0)])],1),s("van-list",{attrs:{finished:t.finished,"finished-text":t.$t("promptMessage.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[s("div",{staticClass:"list"},t._l(t.dataList,(function(e){return s("training-card",{key:e.id,attrs:{item:e,"theme-color":t.primaryColor,type:e.studyType}})})),1)])],1)}),[],!1,null,"fc2792f0",null).exports},23497:(t,e,s)=>{s.r(e),s.d(e,{default:()=>S});var a=s(95082),i=(s(31146),s(41610)),n=(s(29941),s(64168)),o=(s(25964),s(66996)),r=(s(3791),s(93432)),l=(s(25773),s(35791)),c=(s(23307),s(81392)),d=(s(69710),s(57609)),m=(s(47163),s(21469)),h=(s(73474),s(74755)),u=(s(93787),s(20090)),p=(s(57658),s(33948),s(74916),s(15306),s(27484)),g=s.n(p),f=s(26294),v=s(78551),_=s(64404),y=s(95084),C=s(17011),k=s(22648),b=s(41833),$=s(68092),T={components:{[h.Z.name]:h.Z,[l.Z.name]:l.Z,[r.Z.name]:r.Z,PermissionClassify:b.Z},props:{visible:{type:Boolean,default:!1}},data:()=>({classiftInfo:{},loading:!0}),computed:{themeColor(){return this.$store.state.themeColor},popupVisible:{get(){return this.visible},set:t=>t},classifyId(){const{classifyId:t}=this.$route.query;return t},showPermission:()=>(0,$.eY)("COLLECTIVIZATION")},methods:{onClassifySelect(t){this.classiftInfo=t},submit(){this.$emit("success",this.classiftInfo)},cancel(){this.$emit("cancel")}}},x=s(1001),Z=(0,x.Z)(T,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("van-popup",{attrs:{position:"bottom"},on:{"click-overlay":function(e){return t.cancel()}},model:{value:t.popupVisible,callback:function(e){t.popupVisible=e},expression:"popupVisible"}},[s("div",{staticClass:"container"},[s("permission-classify",{attrs:{"classify-id":t.classifyId},on:{select:t.onClassifySelect,loadEnd:function(e){t.loading=!1}}}),t.loading?t._e():s("div",{staticClass:"container-column"},[s("div",{staticClass:"column column-level1"}),s("div",{staticClass:"column column-level2"}),s("div",{staticClass:"column column-level3"})]),t.loading?s("div",{staticClass:"loading-box"},[s("van-loading",[t._v(" "+t._s(t.$t("common.loading"))+" ")])],1):t._e()],1),s("div",{staticClass:"buttons"},[s("van-button",{staticClass:"button",on:{click:function(e){return t.cancel()}}},[t._v(t._s(t.$t("common.cancel")))]),s("van-button",{staticClass:"button",attrs:{color:t.themeColor.primaryColor},on:{click:function(e){return t.submit()}}},[t._v(t._s(t.$t("common.confirm")))])],1)])}),[],!1,null,"ed45d17c",null).exports,w={components:{SvgIcon:v.Z,[u.Z.name]:u.Z,[h.Z.name]:h.Z,[m.Z.name]:m.Z,[d.Z.name]:d.Z,[c.Z.name]:c.Z,[l.Z.name]:l.Z,[r.Z.name]:r.Z,[o.Z.name]:o.Z,[n.Z.name]:n.Z,[i.Z.Component.name]:i.Z.Component,ClUpload:_.Z,ClAttachment:y.Z,SelectClassify:Z},data:()=>({ua:(0,k.ij)(),form:{title:"",participation_time:"",classify_id:"",duration:"",head:"",address:"",content:"",resource_ids:"",submit_status:""},loading:!1,classify_name:"",currentDate:new Date,showPicker:!1,showDialog:!1,dialogList:[],dialogValue:"",saveLoading:!1,submitLoading:!1,attachmentList:[],selectClassifyVisible:!1}),computed:(0,a.Z)((0,a.Z)((0,a.Z)({},(0,f.mapState)("user",["appType"])),(0,f.mapGetters)({primaryColor:"getPrimaryColor"})),{},{transParticipationTime(){return this.formatTime(this.form.participation_time)},count(){let t=9;return this.ua.indexOf("wechat")>-1&&(t=1),t}}),beforeDestroy(){this.$toast.clear()},mounted(){const{submitId:t}=this.$route.query;t&&this.getData()},methods:{formatTime:t=>t?g()(Number(t)).format("YYYY/MM/DD HH:mm"):"",onConfirm(t){this.$set(this.form,"participation_time",new Date(t).getTime()),this.onCancel()},onOpen(){this.showPicker=!0},onCancel(){this.showPicker=!1},openDialog(){this.dialogValue="",this.showDialog=!0,this.$nextTick((()=>{this.$refs.managerDialog.focus()}))},configDialog(){this.dialogList.length<5?(this.dialogList.push(this.dialogValue),this.$set(this.form,"head",this.dialogList.join(","))):this.$toast(this.$t("trainingReport.notMorePeople"),{num:5})},deleteDialog(t){this.dialogList.splice(t,1),this.$set(this.form,"head",this.dialogList.join(","))},durationChange(t){this.$set(this.form,"duration",Number(t))},onSuccess(t){const e=[...this.attachmentList,...t];if(e.length>50)return this.$toast(this.$t("trainingReport.resourceLimitTip",{limit:50})),!1;this.attachmentList=e,this.$set(this.form,"resource_ids",this.attachmentList.map((t=>t.id)).join())},deleteFile(t){this.attachmentList.splice(t,1),this.$set(this.form,"resource_ids",this.attachmentList.map((t=>t.id)).join())},selectClassifyCallback(t){this.classify_name=t.id?t.name:this.$t("trainingReport.notClassified"),this.$set(this.form,"classify_id",t.id),this.selectClassifyVisible=!1},checkForm(){const{title:t,participation_time:e,address:s,content:a}=this.form,i={title:t,participation_time:e,address:s,content:a},n=[this.$t("trainingReport.projectName"),this.$t("trainingReport.joinDate"),this.$t("trainingReport.address"),this.$t("trainingReport.content")];let o=!0;return Object.entries(i).forEach(((t,e)=>{if(!t[1]&&o&&(o=!1,setTimeout((()=>{this.$toast.fail(this.$t("trainingReport.notFilledIn")+n[e])}),100),!o))return!1})),o},async submit(t){if(!this.checkForm())return!1;this.$set(this.form,"submit_status",t);const{form:{status:e}}=this;"draft"===t?this.saveLoading=!0:this.submitLoading=!0,"reject"===e&&"submitted"===t&&(t="reject"),this.$set(this.form,"submit_status",t);const[s,a]="reject"===t?await(0,k.Kb)(C.Z.reportResubmit(this.form)):await(0,k.Kb)(C.Z.reportAdd(this.form));s?(this.saveLoading=!1,this.submitLoading=!1,this.$toast({message:this.$t("promptMessage.systemError"),type:"fail"})):a&&(0===a.data.code?(this.$toast({type:"success",message:"draft"===t?this.$t("trainingReport.saveSuccess"):this.$t("trainingReport.submitSuccess"),overlay:!0}),this.saveLoading=!1,this.submitLoading=!1,setTimeout((()=>{switch(t){case"submitted":localStorage.setItem("submitReportNav","wait"),this.$router.replace(`/homeModule/training-report/detail?submitId=${a.data.data.id}&instanceId=${a.data.data.instance_id}`);break;case"reject":localStorage.setItem("submitReportNav","wait"),this.$router.replace(`/homeModule/training-report/detail?submitId=${this.form.id}&instanceId=${this.form.instance_id}`);break;case"draft":localStorage.setItem("submitReportNav","draft"),this.$router.go(-1);break;default:return!1}}),1500)):this.$toast({message:a.data.msg,icon:"none"}))},getData(){this.loading=!0;const{submitId:t}=this.$route.query;C.Z.reportDetail(t).then((t=>{const{data:e}=t.data;this.form=(0,a.Z)((0,a.Z)({},this.form),e),this.dialogList=e.head?e.head.split(","):[],this.classify_name=e.classifyName,this.attachmentList=e.resources,this.$set(this.form,"resource_ids",e.resources.map((t=>t.id)).join()),this.loading=!1}))}}},S=(0,x.Z)(w,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},[t.loading?s("div",{staticClass:"loading-panel"},[s("van-loading",{attrs:{vertical:"",size:"32"}},[t._v(" "+t._s(t.$t("promptMessage.loading"))+" ")])],1):t._e(),s("div",{staticClass:"box"},[s("div",{staticClass:"training-cut"}),s("van-cell-group",[s("van-field",{attrs:{label:t.$t("trainingReport.projectName"),placeholder:t.$t("trainingReport.projectPlaceholder"),maxlength:"60",autosize:"",type:"textarea",required:""},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}}),s("div",{staticClass:"training-cut"}),s("van-field",{attrs:{required:"",label:t.$t("trainingReport.joinDate"),readonly:""},on:{click:function(e){return t.onOpen()}},model:{value:t.transParticipationTime,callback:function(e){t.transParticipationTime=e},expression:"transParticipationTime"}}),s("van-field",{attrs:{label:t.$t("trainingReport.classify"),readonly:""},on:{click:function(e){t.selectClassifyVisible=!0}},model:{value:t.classify_name,callback:function(e){t.classify_name=e},expression:"classify_name"}}),s("div",{staticClass:"training-cut"}),s("div",{staticClass:"content-box"},[s("div",{staticClass:"content-box-label"},[s("div",{staticClass:"content-box-label-man"},[t._v(" "+t._s(t.$t("trainingReport.manager"))+" ")]),s("div",{staticClass:"content-box-principal"},t._l(t.dialogList,(function(e,a){return s("div",{key:a,staticClass:"content-box-principal-item"},[s("div",{staticClass:"content-box-principal-item-flex"},[s("span",{staticClass:"content-box-principal-item-flex-name"},[t._v(t._s(e))]),s("div",{on:{click:function(e){return t.deleteDialog(a)}}},[s("SvgIcon",{staticClass:"iconfont",attrs:{"icon-class":"icon-icon_close",color:"#7F849A",size:12}})],1)])])})),0),s("span",{on:{click:t.openDialog}},[s("SvgIcon",{staticClass:"iconfont",attrs:{"icon-class":"icon-tianjiarenyuan",color:"465dcd",size:18}})],1)])]),s("div",{staticClass:"training-cut"}),s("van-field",{attrs:{label:t.$t("trainingReport.duration"),type:"digit",maxlength:"5",placeholder:t.$t("trainingReport.durationTime")},on:{input:t.durationChange},model:{value:t.form.duration,callback:function(e){t.$set(t.form,"duration",e)},expression:"form.duration"}}),s("div",{staticClass:"training-cut"}),s("van-field",{attrs:{autosize:"",required:"",label:t.$t("trainingReport.address"),type:"textarea",maxlength:"50",placeholder:t.$t("trainingReport.addrPlaceholder"),"show-word-limit":""},model:{value:t.form.address,callback:function(e){t.$set(t.form,"address",e)},expression:"form.address"}}),s("div",{staticClass:"training-cut"}),s("van-field",{attrs:{autosize:"",required:"",label:t.$t("trainingReport.content"),type:"textarea",maxlength:"1200",placeholder:t.$t("trainingReport.contentPlaceholder"),"show-word-limit":""},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1),s("div",{staticClass:"attachment-bg"},[t.attachmentList.length>0?s("cl-attachment",{attrs:{"attachment-list":t.attachmentList,"is-delete":"","is-preview":!0},on:{delete:t.deleteFile}}):t._e()],1),s("cl-upload",{attrs:{"list-type":["photo","video"],count:t.count},on:{onSuccess:t.onSuccess}})],1),s("div",{staticClass:"training-buttons"},[s("van-button",{staticClass:"training-button training-button-save",style:{borderColor:t.primaryColor,color:t.primaryColor},attrs:{loading:t.saveLoading},on:{click:function(e){return t.submit("draft")}}},[t._v(t._s(t.$t("buttons.save")))]),s("van-button",{staticClass:"training-button training-button-submit",style:{borderColor:t.primaryColor},attrs:{color:t.primaryColor,loading:t.submitLoading},on:{click:function(e){return t.submit("submitted")}}},[t._v(t._s(t.$t("common.submit")))])],1),s("van-popup",{attrs:{position:"bottom"},model:{value:t.showPicker,callback:function(e){t.showPicker=e},expression:"showPicker"}},[s("van-datetime-picker",{attrs:{type:"datetime"},on:{confirm:t.onConfirm,cancel:t.onCancel},model:{value:t.currentDate,callback:function(e){t.currentDate=e},expression:"currentDate"}})],1),s("van-dialog",{attrs:{"confirm-button-color":t.primaryColor,width:"260",title:t.$t("trainingReport.manager"),"show-cancel-button":"","confirm-button-text":t.$t("common.confirm"),"cancel-button-text":t.$t("common.cancel")},on:{confirm:t.configDialog},model:{value:t.showDialog,callback:function(e){t.showDialog=e},expression:"showDialog"}},[s("div",[s("div",{staticClass:"dialog-title"},[t._v(t._s(t.$t("trainingReport.alertReportDesc")))]),s("div",{staticClass:"dialog-input-box"},[s("van-field",{ref:"managerDialog",staticClass:"dialog-input",attrs:{maxlength:"20",label:"",placeholder:t.$t("common.name")},model:{value:t.dialogValue,callback:function(e){t.dialogValue=e},expression:"dialogValue"}})],1)])]),s("SelectClassify",{directives:[{name:"show",rawName:"v-show",value:t.selectClassifyVisible,expression:"selectClassifyVisible"}],attrs:{visible:t.selectClassifyVisible},on:{cancel:function(e){t.selectClassifyVisible=!1},success:t.selectClassifyCallback}})],1)}),[],!1,null,"1bb75594",null).exports},32933:(t,e,s)=>{s.r(e),s.d(e,{default:()=>f});s(3791);var a=s(93432),i=(s(29941),s(64168)),n=(s(52355),s(29233)),o=(s(23307),s(81392)),r=s(95084),l=s(4852),c=s(45877),d=s(22648),m={components:{ClAttachment:r.Z,Avatar:l.Z,ClCustomUser:c.Z},props:{list:{type:Array,default:()=>[]},hasScore:{type:Boolean,default:!1}},data:()=>({statusTip:{}}),created(){this.statusTip={creation:this.$t("attestation.initiateApproval"),pass:this.$t("attestation.agree"),pending:this.$t("attestation.waiting"),reject:this.$t("attestation.reject"),leave:this.$t("attestation.approverDeparture"),un_pending:""}},methods:{getTime:t=>(0,d.ZM)(Number(t))}},h=s(1001),u=(0,h.Z)(m,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"cl-approval"},t._l(t.list,(function(e){return s("div",{key:e.id,staticClass:"cl-approval-info last"},[s("div",{staticClass:"info-active"},[s("div",{staticClass:"left"},[s("div",{staticClass:"info-portrait portrait-pass"},[s("div",{staticClass:"taro-img"},[s("Avatar",{staticClass:"avatar",attrs:{src:e.user_avatar,width:"24",height:"24"}})],1)]),s("div",{staticClass:"status-info"},[s("span",{staticClass:"taro-text info-name"},[s("cl-custom-user",{attrs:{type:e.source_type,"data-type":"userName",value:e.sync_user_id,name:e.userName}})],1),s("span",{class:"taro-text status-label info-status-"+e.operation+" "+e.operation},[t._v(t._s(t.statusTip[e.operation]))])]),e.score&&"pass"===e.operation?s("div",{staticClass:"score_text"},[t._v(t._s("("+(e.score+t.$t("myRating.point"))+")"))]):t._e()]),s("div",{staticClass:"right"},[t._v(t._s(t.getTime(e.createTime)))])]),e.opinion?s("span",{staticClass:"taro-text info-introduce ",staticStyle:{height:"auto",overflow:"inherit",display:"inline-block"}},[t._v(t._s(e.opinion))]):t._e(),e.resources&&e.resources.length>0?s("cl-attachment",{staticClass:"attachment",attrs:{"is-delete":!1,"attachment-list":e.resources}}):t._e()],1)})),0)}),[],!1,null,"9bd0de8e",null).exports,p=s(17011),g={components:{[o.Z.name]:o.Z,[n.Z.name]:n.Z,[i.Z.name]:i.Z,[a.Z.name]:a.Z,ApprovalInfo:u,ClAttachment:r.Z,ClCustomUser:c.Z},data:()=>({info:{},record:[],iconType:{wait:"icon-shenpizhong",pass:"icon-duigou",reject:"icon-fault"},iconTypeColor:{wait:"#B1B5C6",reject:"#ffffff",pass:"#ffffff"},infoList:[],loading:!1}),computed:{passItem(){return this.record.find((t=>"pass"===t.operation))},statusText(){let t="";switch(this.info.status){case"wait":t=this.$t("attestation.approvalPending");break;case"pass":t=this.$t("attestation.approved");break;case"reject":t=this.$t("attestation.rejected");break;default:t=""}return t},statusTextClass(){let t="";switch(this.info.status){case"reject":t="reject-text";break;case"wait":t="wait-text";break;default:t="pass-text"}return t},iconName(){let t="";switch(this.info.status){case"wait":t="manager-o";break;case"pass":t="success";break;case"reject":t="cross"}return t}},created(){this.getData(),this.getRecord()},methods:{getTime:t=>t?(0,d.ZM)(Number(t)):"--",getData(){this.loading=!0;const{submitId:t}=this.$route.query;p.Z.reportDetail(t).then((t=>{const{data:e}=t.data;this.info=e,this.info.resources.length>0&&this.info.resources.forEach((t=>{t.content_type=t.contentType})),this.infoList=[{name:this.$t("trainingReport.projectName"),data:e.title||"--"},{name:this.$t("common.creator"),source_type:e.source_type,dataType:"userName",sync_user_id:e.sync_user_id,submit_user:e.submit_user},{name:this.$t("trainingReport.manager"),data:e.head||"--"},{name:this.$t("trainingReport.joinTime"),data:(0,d.ZM)(Number(e.participation_time))||"--"},{name:this.$t("trainingReport.classify"),data:e.classifyName||this.$t("trainingReport.notClassified")},{name:this.$t("trainingReport.duration"),data:e.duration?`${e.duration}${this.$t("trainingReport.minutes")}`:"--"},{name:this.$t("trainingReport.submitTime"),data:(0,d.ZM)(Number(e.submit_report_time))||"--"},{name:this.$t("trainingReport.updateTime"),data:(0,d.ZM)(Number(e.update_time))||"--"},{name:this.$t("trainingReport.address"),data:e.address||"--"}],this.loading=!1}))},getRecord(){const{submitId:t,instanceId:e}=this.$route.query;e&&p.Z.mineAuditDetail({submitId:t,instanceId:e}).then((t=>{this.record=t.data.data}))}}},f=(0,h.Z)(g,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},[t.loading?s("div",{staticClass:"loading-panel"},[s("van-loading",{attrs:{vertical:"",size:"32"}},[t._v(" "+t._s(t.$t("promptMessage.loading"))+" ")])],1):t._e(),s("div",{staticClass:"container-box"},["darft"!==t.info.status?s("div",{staticClass:"status-box"},[s("div",{class:"status-icon "+t.info.status},[s("van-icon",{attrs:{name:t.iconName,size:"40",color:"#fff"}})],1),s("span",{class:t.statusTextClass},[t._v(" "+t._s(t.statusText)+" ")]),"pass"===t.info.status||"reject"===t.info.status?s("span",{staticClass:"time-text"},[t._v(t._s(t.getTime(t.info.update_time)))]):t._e(),"pass"===t.info.status?s("span",{staticClass:"score-text"},[t._v(t._s(t.$t("trainingReport.score")+"："+(t.passItem&&t.passItem.score||0)+" "+t.$t("myRating.point")))]):t._e()]):t._e(),s("ApprovalInfo",{attrs:{list:t.record}}),s("div",{staticClass:"text-cut"}),s("div",{staticClass:"report-detail-content"},[s("van-cell-group",t._l(t.infoList,(function(e,a){return s("van-cell",{key:a.toString(),attrs:{title:e.name}},[s("span",[e.dataType?s("cl-custom-user",{attrs:{type:e.source_type,"data-type":e.dataType,value:e.sync_user_id,name:e.submit_user}}):s("span",[t._v(t._s(e.data))])],1)])})),1),s("div",{staticClass:"content-box"},[s("div",{staticClass:"title"},[t._v(" "+t._s(t.$t("trainingReport.content"))+" ")]),s("div",{staticClass:"content"},[t._v(" "+t._s(t.info.content)+" ")])]),t.info.resources&&t.info.resources.length>0?s("cl-attachment",{attrs:{"attachment-list":t.info.resources,"is-delete":!1}}):t._e()],1)],1)])}),[],!1,null,"1051c6d2",null).exports},4131:(t,e,s)=>{s.r(e),s.d(e,{default:()=>p});s(49153);var a=s(5944),i=(s(20581),s(50914)),n=(s(3791),s(93432)),o=(s(82522),s(10342)),r=(s(82500),s(49414)),l=(s(33948),s(57658),s(17011)),c=s(22648),d={props:{info:{type:Object,default:()=>{}},activeTab:{type:String,default:""}},computed:{toDate(){return(0,c.ZM)(Number(this.info.participation_time))},updateTime(){return(0,c.ZM)(Number(this.info.update_time))},themeColor(){return this.$store.state.themeColor}},methods:{toDetail(t){"draft"!==this.activeTab&&this.$router.push(`/homeModule/training-report/detail?submitId=${t.id}&&instanceId=${t.instance_id}`)},deleteItem(t){this.$dialog.confirm({title:this.$t("common.reminder"),message:this.$t("promptMessage.delete"),confirmButtonText:this.$t("buttons.confirm"),confirmButtonColor:this.themeColor.primaryColor}).then((e=>{"confirm"===e&&this.$emit("deleteItem",t)}))},toEdit(t){this.$router.push(`/homeModule/training-report/add?submitId=${t}`)}}},m=s(1001),h=(0,m.Z)(d,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"item-box"},[s("div",{staticClass:"item-box-1",on:{click:function(e){return t.toDetail(t.info)}}},[s("div",{staticClass:"item-title"},[t._v(t._s(t.info.title))]),s("div",{staticClass:"item-addr"},[t._v(t._s(t.$t("trainingReport.address"))+"："+t._s(t.info.address))]),s("div",{staticClass:"item-addr"},[t._v(t._s(t.$t("trainingReport.joinTime"))+"："+t._s(t.toDate))]),"approved"===t.activeTab?s("div",{class:[("pass"===t.info.status?"color-green":"color-red")+" item-type"]},[t._v(" "+t._s("pass"==t.info.status?t.$t("trainingReport.pass"):t.$t("trainingReport.reject"))+" ")]):t._e()]),s("div",{staticClass:"item-box-2"},[s("div",{staticClass:"item-time"},[t._v(t._s(t.$t("trainingReport.updateTime"))+"："+t._s(t.updateTime))]),"pass"!==t.info.status&&"wait"!==t.info.status?s("div",{staticClass:"item-buttons"},[s("div",{staticClass:"item-buttons-button",on:{click:function(e){return t.deleteItem(t.info.id,t.index)}}},[t._v(t._s(t.$t("trainingReport.delete")))]),s("div",{staticClass:"item-cut"}),s("div",{staticClass:"item-buttons-button",on:{click:function(e){return t.toEdit(t.info.id)}}},[t._v(t._s(t.$t("trainingReport.edit")))])]):t._e()])])}),[],!1,null,"78eaa7de",null).exports,u={name:"TrainingReport",components:{[r.Z.name]:r.Z,[o.Z.name]:o.Z,[n.Z.name]:n.Z,[i.Z.name]:i.Z,[a.Z.name]:a.Z,listItem:h},beforeRouteLeave(t,e,s){if("/home-module"===t.path)this.$store.commit("noKeepAlive","TrainingReport");else{const t=this.$refs.trainingList,s=t?t.scrollTop:0;e.meta.scrollTop=s,this.$store.commit("isKeepAlive","TrainingReport")}s()},data(){return{tabs:[{title:this.$t("trainingReport.approved"),key:"approved"},{title:this.$t("micro.approval"),key:"wait"},{title:this.$t("attestation.draft"),key:"draft"}],active:0,dataList:[],page:{page_number:1,page_size:10,status:"approved"},loading:!1,finished:!1}},computed:{themeColor(){return this.$store.state.themeColor}},activated(){this.$nextTick((()=>{const{scrollTop:t}=this.$route.meta,e=this.$refs.trainingList;t&&e&&(e.scrollTop=t)}));const t=localStorage.getItem("submitReportNav");"draft"===t&&(localStorage.setItem("submitReportNav",""),this.active=2,this.tabChange(2)),"wait"===t&&(localStorage.setItem("submitReportNav",""),this.active=1,this.tabChange(1))},created(){const{type:t=null}=this.$route.query;t&&this.tabs.forEach(((e,s)=>{e.type===t&&(this.active=s)}))},methods:{async getData(){try{let t=await l.Z.reportHistory(this.page);this.$set(this.page,"page_number",this.page.page_number+1),this.dataList=[...this.dataList,...t.data.data.page.list],this.loading=!1,t.data.data.page.isLastPage&&(this.finished=!0)}catch(t){return this.loading=!1,Promise.reject(t)}},onLoad(){this.getData()},tabChange(t){this.$set(this.page,"status",this.tabs[t].key),this.page.page_number=1,this.finished=!1,this.dataList=[],this.getData(),this.loading=!0},add(){this.$router.push("/homeModule/training-report/add")},deleteItem(t){l.Z.reportDelete({submitId:t}).then((()=>{this.$toast.success(this.$t("micro.deleteSuccessful")),this.dataList=this.dataList.filter((e=>e.id!==t))})).catch((()=>{}))}}},p=(0,m.Z)(u,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"training-report-container"},[s("div",{staticClass:"tab-box"},[s("van-tabs",{attrs:{color:t.themeColor.primaryColor},on:{change:t.tabChange},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},t._l(t.tabs,(function(t){return s("van-tab",{key:t.key,attrs:{title:t.title}})})),1)],1),s("div",{staticClass:"content"},[s("div",{ref:"trainingList",staticClass:"content-box"},[s("van-list",{attrs:{finished:t.finished,"finished-text":t.finished&&0===t.dataList.length?"":t.$t("micro.noMore")},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[t._l(t.dataList,(function(e,a){return s("div",{key:e.id},[s("listItem",{attrs:{info:e,"active-tab":t.tabs[t.active].key,index:a},on:{deleteItem:t.deleteItem}})],1)})),t.finished&&0===t.dataList.length?s("van-empty",{attrs:{description:t.$t("common.noDataTextTip")}}):t._e()],2)],1)]),s("div",{staticClass:"report-submit"},[s("div",{staticClass:"report-submit-button",style:{backgroundColor:t.themeColor.primaryColor},on:{click:function(e){return t.add()}}},[t._v(t._s(t.$t("trainingReport.add")))])])])}),[],!1,null,"0dccedaa",null).exports},5648:(t,e,s)=>{s.d(e,{r:()=>a});const a=[{name:"unstarted",lang:"data.notStarted"},{name:"unfinished",lang:"data.ongoing"},{name:"finished",lang:"data.over"}]},50630:(t,e,s)=>{s.r(e),s.d(e,{getTutorsList:()=>l,handleSingleChange:()=>c,onTutorCancel:()=>d,onTutorConfirm:()=>m});s(31146);var a=s(41610),i=s(96680),n=s(27632),o=s(57969),r=s(28787);const l=async({courseId:t,tutorials_model:e})=>{const{userId:s}=r.Z.state.user,n={user_id:s,status:"on",filter_user_quit:"true",filter_user_tutor:"true"},l=await i.Z.getTutorsList(n),{data:c={}}=l.data,{list:d=[]}=c;d.length?r.Z.commit("study/setTutorInfo",{tutorsList:d,showtutorsModal:!0,tutorialsId:t,tutorials_model:e}):a.Z.alert({title:o.Z.t("study.tutorNoTitle"),message:o.Z.t("study.tutorNoDesc")})},c=t=>{r.Z.commit("study/setCheckId",t.user_id)},d=()=>{r.Z.commit("study/setTutorInfo",{tutorsList:[],showtutorsModal:!1,tutorialsId:"",tutorials_model:""}),r.Z.commit("study/setCheckId","")},m=async t=>{const{studyId:e,tutorialsId:s,checkedId:a,tutorials_model:o}=r.Z.state.study,l={planId:e,tutorialsId:s,tutorUserId:a};await i.Z.chooseTutor(l),r.Z.commit("study/setTutorInfo",{tutorsList:[],showtutorsModal:!1,tutorialsId:"",tutorials_model:""}),r.Z.commit("study/setCheckId",""),"resource_evaluation"===o?t():n.Z.navigateTo({url:`/pages/exam-bag/instructor-area/student-edit/index?tutor_user_id=${a}&tutorials_id=${s}&switch=on&planId=${e}`})}}}]);